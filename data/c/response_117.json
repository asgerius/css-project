[{"tags": ["c", "memory-leaks", "linked-list"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 3, "creation_date": 1491464843, "post_id": 43243456, "comment_id": 73566857, "body": "About half of all linked-list posts on SO have the same problem - changing a local copy of &#39;head&#39; and expecting that to propagate out of the function.  It will not.  Fix all your code that does this by either returning the new head as a function result or by passing in a double pointer."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1491437301, "creation_date": 1491437301, "answer_id": 43243570, "question_id": 43243456, "link": "https://stackoverflow.com/questions/43243456/memory-leak-in-my-c-program/43243570#43243570", "title": "Memory Leak in my C program", "body": "<p>In <code>freeNodeList</code>, you only free the student record nodes, not the student records they contain, which means all of the records are still allocated at the end of your program, though they're unreachable since you destroyed the list.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1491437593, "creation_date": 1491437593, "answer_id": 43243607, "question_id": 43243456, "link": "https://stackoverflow.com/questions/43243456/memory-leak-in-my-c-program/43243607#43243607", "title": "Memory Leak in my C program", "body": "<p>This code does not initialize <code>tmp</code>:</p>\n\n<pre><code>void freeNodeList(struct student_record_node* head) {\n    student_record_node *tmp;\n    while(tmp != NULL) {\n        tmp=head;\n        head=head-&gt;next_;   \n        free(tmp);\n    }\n    head=NULL;\n}\n</code></pre>\n\n<p>Consequently, you have undefined behavior when reading from an uninitialized variable.</p>\n\n<p>You probably meant to use <code>head != NULL</code> as your <code>while</code> condition.</p>\n"}], "owner": {"reputation": 21, "user_id": 7578234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131758056ab0c6f96c089e8ca2837e94?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/7578234/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491437593, "creation_date": 1491436505, "last_edit_date": 1491437195, "question_id": 43243456, "link": "https://stackoverflow.com/questions/43243456/memory-leak-in-my-c-program", "title": "Memory Leak in my C program", "body": "<p>The following code is working, but I am getting a memory leak.\nThe program is using linked list and dynamic memory function.\nThe Program excepts a .txt file as a command line argument.</p>\n\n<p><strong>Example file:</strong><br></p>\n\n<blockquote>\n  <p>Jacob Miller 832323244 21<br>\n  Tom Darren 8931701830 19<br>\n  Paul Mitchell 329797231 20<br>\n  Here the output from Valgrind</p>\n</blockquote>\n\n<pre><code>==5742== HEAP SUMMARY:\n==5742==     in use at exit: 324 bytes in 9 blocks\n==5742==   total heap usage: 11 allocs, 2 frees, 908 bytes allocated\n==5742== \n==5742== 52 bytes in 1 blocks are definitely lost in loss record 2 of 4\n==5742==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)\n==5742==    by 0x400A2C: student_record_allocate (new.c:106)\n==5742==    by 0x4007EB: main (new.c:46)\n==5742== \n==5742== 272 (16 direct, 256 indirect) bytes in 1 blocks are definitely lost in loss record 4 of 4\n==5742==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)\n==5742==    by 0x400A1E: student_record_allocate (new.c:104)\n==5742==    by 0x4008D1: parseFile (new.c:74)\n==5742==    by 0x400803: main (new.c:47)\n==5742== \n==5742== LEAK SUMMARY:\n==5742==    definitely lost: 68 bytes in 2 blocks\n==5742==    indirectly lost: 256 bytes in 7 blocks\n==5742==      possibly lost: 0 bytes in 0 blocks\n==5742==    still reachable: 0 bytes in 0 blocks\n==5742==         suppressed: 0 bytes in 0 blocks\n==5742== \n==5742== For counts of detected and suppressed errors, rerun with: -v\n==5742== ERROR SUMMARY: 66 errors from 21 contexts (suppressed: 4 from 4)\n</code></pre>\n\n<blockquote>\n  <p>There is some problem here code snippet.</p>\n</blockquote>\n\n<pre><code>    void parseFile(char* filename, struct student_record_node** head)\n    {\n    FILE *fp;\n    student_record_node *sn;\n\n    fp = fopen(filename, \"r\");\n    if (!fp) {\n        fprintf(stderr, \"Can't Open file %s\\n\", filename);\n        exit(EXIT_FAILURE);\n    }\n\n    while(!feof(fp)) {\n        sn = student_record_allocate();\n\n        fscanf(fp, \"%20s\", sn-&gt;record_-&gt;first_name_);\n        fscanf(fp, \"%20s\", sn-&gt;record_-&gt;last_name_);\n        fscanf(fp, \"%d\", &amp;(sn-&gt;record_-&gt;student_id_));\n        fscanf(fp, \"%d\", &amp;(sn-&gt;record_-&gt;student_age_));\n\n        appendNode(*head, sn);\n    }\n\n    fclose(fp);\n    }\n\n    void printNode(struct student_record_node* node)\n    {\n        printf(\"\\nstruct student_record_node:\\n\");\n        if (node) {\n        printf(\"\\tstudent first name: %s\\n\",node-&gt;record_-&gt;first_name_);\n        printf(\"\\tstudent second name: %s\\n\",node-&gt;record_-&gt;last_name_);\n        printf(\"\\tstudent id: %d\\n\", node-&gt;record_-&gt;student_id_);\n        printf(\"\\tstudent age: %d\", node-&gt;record_-&gt;student_age_);\n\n    }\n    }\n\n    struct student_record_node* student_record_allocate()\n    {\n    student_record_node *newNode=NULL;\n    student_record *newRecord=NULL;\n\n    newNode = (student_record_node *)malloc(sizeof(student_record_node));\n    newRecord = (student_record *)malloc(sizeof(student_record));\n    newNode-&gt;record_ = newRecord;\n    newNode-&gt;next_ = NULL;\n\n    return newNode;\n    free(newNode-&gt;record_);\n    }    \n\n    {\n        free(node-&gt;record_);\n    free(node-&gt;next_);\n\n    }\n</code></pre>\n\n<p><strong>I am freeing the above through this method</strong></p>\n\n<pre><code>    void freeNodeList(struct student_record_node* head)\n    {\n    student_record_node *tmp;\n     while(tmp != NULL) {\n     tmp=head;\n     head=head-&gt;next_;   \n     free(tmp);\n    }\n    head=NULL;\n    }\n</code></pre>\n\n<blockquote>\n  <p><strong>Here is my full code</strong></p>\n</blockquote>\n\n<pre><code> #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n\n    struct student_record\n    {\n    int student_id_;\n    int student_age_;\n    char first_name_[21];\n    char last_name_[21];\n    }s;\n\n    struct student_record_node\n    {    \n    struct student_record* record_;\n    struct student_record_node* next_;\n    };\n    typedef struct student_record student_record;\n    typedef struct student_record_node student_record_node;\n\n    void parseFile(char* filename, struct student_record_node** head);\n    void printNode(struct student_record_node* node);\n    struct student_record_node* student_record_allocate();\n    void student_record_node_deallocate(struct student_record_node* node);\n    void sortByAge(struct student_record_node** recordsHead);\n    void sortById(struct student_record_node** recordsHead);\n    void swap(struct student_record_node** node1, struct student_record_node** node2);\n    void freeNodeList(struct student_record_node* head);\n    void appendNode(struct student_record_node* head, struct student_record_node* newNode);\n    void printNodeList(struct student_record_node* head);\n    int main(int argc, char **argv)\n    {\n    student_record_node *head;\n    if (argc != 2) {\n        fprintf(stderr, \"Error: expected input file\");\n        exit(EXIT_FAILURE);\n    }\n    /*  student_record *newRecord=NULL;\n    recordsHead-&gt;record_ = newRecord;\n    recordsHead-&gt;next_ = NULL;\n    */\n    head = student_record_allocate();\n    parseFile(argv[1], &amp;head);\n    printf(\"Before sorting...\");\n    printNodeList(head);\n    printf(\"Sorting by age...\");\n    sortByAge(&amp;head);\n    printNodeList(head);\n    printf(\"Sorting by id...\");\n    sortById(&amp;head);\n    printNodeList(head); \n    freeNodeList(head);\n    free(head);\n\n    return 0;\n    }\n\n    void parseFile(char* filename, struct student_record_node** head)\n    {\n    FILE *fp;\n    student_record_node *sn;\n\n    fp = fopen(filename, \"r\");\n    if (!fp) {\n        fprintf(stderr, \"Can't Open file %s\\n\", filename);\n        exit(EXIT_FAILURE);\n    }\n\n    while(!feof(fp)) {\n        sn = student_record_allocate();\n\n        fscanf(fp, \"%20s\", sn-&gt;record_-&gt;first_name_);\n        fscanf(fp, \"%20s\", sn-&gt;record_-&gt;last_name_);\n        fscanf(fp, \"%d\", &amp;(sn-&gt;record_-&gt;student_id_));\n        fscanf(fp, \"%d\", &amp;(sn-&gt;record_-&gt;student_age_));\n\n        appendNode(*head, sn);\n    }\n\n    fclose(fp);\n    }\n\n    void printNode(struct student_record_node* node)\n    {\n        printf(\"\\nstruct student_record_node:\\n\");\n        if (node) {\n        printf(\"\\tstudent first name: %s\\n\",node-&gt;record_-&gt;first_name_);\n        printf(\"\\tstudent second name: %s\\n\",node-&gt;record_-&gt;last_name_);\n        printf(\"\\tstudent id: %d\\n\", node-&gt;record_-&gt;student_id_);\n        printf(\"\\tstudent age: %d\", node-&gt;record_-&gt;student_age_);\n\n    }\n    }\n\n    struct student_record_node* student_record_allocate()\n    {\n    student_record_node *newNode=NULL;\n    student_record *newRecord=NULL;\n\n    newNode = (student_record_node *)malloc(sizeof(student_record_node));\n    newRecord = (student_record *)malloc(sizeof(student_record));\n    newNode-&gt;record_ = newRecord;\n    newNode-&gt;next_ = NULL;\n\n    return newNode;\n    free(newNode-&gt;record_);\n    }    \n\n    {\n        free(node-&gt;record_);\n    free(node-&gt;next_);\n\n    }\n\n    void sortByAge(struct student_record_node **recordsHead)\n    {\n    int swapped, i;\n    struct student_record_node *ptr1;\n    struct student_record_node *lptr = NULL;\n\n    do\n    {\n        swapped = 0;\n        ptr1 = *recordsHead;\n\n        while (ptr1-&gt;next_ != lptr)\n        {\n            if (ptr1-&gt;record_-&gt;student_age_ &gt; ptr1-&gt;next_-&gt;record_-&gt;student_age_)\n            {\n                swap(&amp;ptr1, &amp;ptr1-&gt;next_);\n                swapped = 1;\n            }\n            ptr1 = ptr1-&gt;next_;\n        }\n        lptr = ptr1;\n    }\n    while (swapped);\n    }\n\n    void sortById(struct student_record_node** recordsHead)\n    {\n    int swapped, i;\n    struct student_record_node *ptr1;\n    struct student_record_node *lptr = NULL;\n\n    do\n    {\n        swapped = 0;\n        ptr1 = *recordsHead;\n\n        while (ptr1-&gt;next_ != lptr)\n        {\n            if (ptr1-&gt;record_-&gt;student_id_ &gt; ptr1-&gt;next_-&gt;record_-&gt;student_id_)\n            {\n                swap(&amp;ptr1, &amp;ptr1-&gt;next_);\n                swapped = 1;\n            }\n            ptr1 = ptr1-&gt;next_;\n        }\n        lptr = ptr1;\n    }\n    while (swapped);\n    }\n\n    void swap(struct student_record_node** node1, struct student_record_node** node2)\n    {\n    student_record_node *tmp, *n1, *n2;\n\n    n1 = *node1;\n    n2 = *node2;\n    tmp-&gt;record_= n1-&gt;record_;\n    n1-&gt;record_= n2-&gt;record_;\n    n2-&gt;record_ = tmp-&gt;record_;\n\n    }\n\n    void freeNodeList(struct student_record_node* head)\n    {\n    student_record_node *tmp;\n     while(tmp != NULL) {\n     tmp=head;\n     head=head-&gt;next_;   \n     free(tmp);\n    }\n    head=NULL;\n    }\n\n    void appendNode(struct student_record_node* head, struct \n    student_record_node* newNode)\n    {    \n    student_record_node *prev, *next;\n\n    if(head == NULL) {\n        head = newNode;\n        return;\n    }\n\n    next = head;\n    while(next != NULL) {\n        prev = next;\n        next = next-&gt;next_;\n    }\n    prev-&gt;next_ = newNode;\n    }\n\n    void printNodeList(struct student_record_node* head)\n    {\n    student_record_node *tmp = head;\n\n    while(tmp != NULL) {\n        tmp = tmp-&gt;next_;\n        printNode(tmp);\n    }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "realloc"], "answers": [{"tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 1, "last_activity_date": 1491435489, "creation_date": 1491435489, "answer_id": 43243321, "question_id": 43243296, "link": "https://stackoverflow.com/questions/43243296/reallocating-a-two-dimensional-array-in-c/43243321#43243321", "title": "Reallocating a two-dimensional array in C", "body": "<p>The error message you're getting is pretty nice:</p>\n\n<pre><code>pointer being realloc'd was not allocated\n</code></pre>\n\n<p>If you are going to use <code>realloc</code>, you need to pass it either a NULL pointer or a pointer that was dynamically allocated using a function like <code>malloc</code> or <code>realloc</code>.  The pointer you passed is to an array that is stored on the stack, which is a different from the heap and does not have a reallocation feature.</p>\n\n<p>I also see you are calling <code>realloc</code> with an argument of 4.  The <code>realloc</code> function has no way to know about the structure of your array or how big its elements are, so you need to pass the number of bytes you want instead.</p>\n\n<p>Also, you need to store the pointer returned by <code>realloc</code> somewhere, preferably after you check that it is not NULL.  If realloc returns a non-NULL pointer, you should forget about the original pointer you passed to it.</p>\n"}], "owner": {"reputation": 13, "user_id": 7452260, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Y1jga.png?s=128&g=1", "display_name": "ImpossibleMushroom", "link": "https://stackoverflow.com/users/7452260/impossiblemushroom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 43243321, "answer_count": 1, "score": 0, "last_activity_date": 1491435666, "creation_date": 1491435300, "last_edit_date": 1491435666, "question_id": 43243296, "link": "https://stackoverflow.com/questions/43243296/reallocating-a-two-dimensional-array-in-c", "title": "Reallocating a two-dimensional array in C", "body": "<p>So i've seen a few questions relating to this but none really too descriptive or that explains it to me\nSo i'm trying to change how many strings are in an array of strings eg array[3][155]\nrealloc() into array[4][155]\nto create 4 strings that hold 155 chars each which can then be modified by doing fgets(array[4], 155, stdin);\nand then print out the new array</p>\n\n<p>My attempt here </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\nint main () {\n    int arrays = 3;\n    int pnm = 0;\n    char array[arrays][155]; //Default size is 3 you can change the size\n    strcpy(array[0], \"Hello from spot 0\\n\");\n    strcpy(array[1], \"Sup from spot 1\\b\");\n    strcpy(array[2], \"Sup from spot 2\");\n    while(pnm != arrays) {\n        printf(\"Word %d: %s\", pnm, array[pnm]);\n        pnm++;\n    }\n    realloc(array, 4);\n    strcpy(array[3], \"Sup from spot 3!\");\n    printf(\"The array is now.\\n\");\n    pnm = 0;\n    while(pnm != 4) {\n        printf(\"%s\", array[pnm]);\n        pnm++;\n    }\n\n}\n</code></pre>\n\n<p>which in console outputs</p>\n\n<pre><code>bash-3.2$ ./flash\nWord 0: Hello from spot 0\nflash(1968,0x7fff70639000) malloc: *** error for object 0x7fff5828f780: pointer being realloc'd was not allocated\n*** set a breakpoint in malloc_error_break to debug\nWord 1: Sup from spot Word 2: Sup from spot 2Abort trap: 6\nbash-3.2$\n</code></pre>\n"}, {"tags": ["c", "struct"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491447370, "post_id": 43243331, "comment_id": 73559628, "body": "Thanks Barmar. That helps. Just out of box question, is there a way to get the offset of the field by passing the structure variable as an argument. For instance Input : cat[37]: offset of cat[37] is XXXX ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491498112, "post_id": 43243331, "comment_id": 73591601, "body": "You could use <code>(char *)&amp;a.cat[37] - char(*)&amp;a</code>"}, {"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491501131, "post_id": 43243331, "comment_id": 73593381, "body": "Thanks a lot again. Is there a way to get the offset of the field pig[2] relative to the struct A and not using struct B information at all, something like, offsetof ( struct A, pig[2] ) is ??"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491504260, "post_id": 43243331, "comment_id": 73595196, "body": "That doesn&#39;t make sense. There are multiple B elements in A, so you need to provide the index, e.g. <code>a.dog[10].pig[2]</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1491498252, "last_edit_date": 1491498252, "creation_date": 1491435574, "answer_id": 43243331, "question_id": 43243263, "link": "https://stackoverflow.com/questions/43243263/generate-an-array-with-offset-of-structure-fields/43243331#43243331", "title": "Generate an array with offset of structure fields", "body": "<p>You can convert the addresses of the array elements to <code>char *</code> and then subtract the address of the structure.</p>\n\n<pre><code>struct A a;\nfor (int i = 0; i &lt; 100; i++) {\n    offset[i] = (char*)&amp;a.ant[i] - (char*)&amp;a;\n}\nfor (int i = 0; i &lt; 38; i++) {\n    offset[100 + i] = (char*)&amp;a.cat[i] - (char*)&amp;a;\n}\nfor (int i = 0; i &lt; 78; i++) {\n    offset[100 + 38 + i] = (char*)&amp;a.dog[i] - (char*)&amp;a;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491498252, "creation_date": 1491435062, "question_id": 43243263, "link": "https://stackoverflow.com/questions/43243263/generate-an-array-with-offset-of-structure-fields", "title": "Generate an array with offset of structure fields", "body": "<p>I am interested in generating an array with offset of structure fields.</p>\n\n<pre><code>struct B\n{\n  int pig[100];\n  bool donkey[100];\n}\n\nstruct A\n{\n   int ant[100];\n   bool cat[38];\n   struct B dog[78];\n}\n\nmain ()\n{\n   int offset[100+38+78] /* ant offsets + cat offsets + dog offsets */\n   /* How do I fill up these offset array to fill in with offsets of ant, cat, dog */\n}\n\nOutput should be something like:\noffset[0] = 0;\noffset[1] = 4;\n......\n......\noffset[99]= 4*99;\n.......\noffset[100+38+78-1] = ? ;\n</code></pre>\n\n<p>I know C doesn't support reflection and we can make use of X_MACROS to some extent, but my structures are really complex. I would like to kickstart with basic simple structure that I had posted in this question.</p>\n"}, {"tags": ["c", "gcc", "vectorization", "sse", "simd"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 2, "creation_date": 1491463903, "post_id": 43243244, "comment_id": 73566299, "body": "<code>-fopt-info-all-vec</code> (see doc for details about it) gives more information. One key element in the output of <code>-fopt-info-missed-vec</code> is &quot;reduction: unsafe fp math optimization: tmp_40 = _16 + tmp_49;&quot; which essentially means you need -ffast-math (or something slightly weaker) to vectorize."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1057, "user_id": 4153464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D55Mz.jpg?s=128&g=1", "display_name": "Work of Artiz", "link": "https://stackoverflow.com/users/4153464/work-of-artiz"}, "edited": false, "score": 0, "creation_date": 1502153153, "post_id": 43243605, "comment_id": 78075121, "body": "@WorkofArtiz and Martin: <code>gcc -O3</code> enables <code>-ftree-vectorize</code> and some other things.  Note that <code>-Ofast</code> is <code>-O3 -ffast-math</code>, not <code>-O2</code>.  Anyway, I&#39;d recommend comparing <code>-O3 -ffast-math -march=native</code> vs. <code>O3 -ffast-math  -march=native -fno-tree-vectorize</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1502153299, "post_id": 43243605, "comment_id": 78075151, "body": "Good point about constant vs. variable loop counts.  gcc and clang usually can vectorize as long as the loop iteration count is known before the first iteration.  (But they can never vectorize search-loops like <code>while(a[i++] != 2){}</code>).  You&#39;re right that they usually do better with compile-time constant loop counts, though."}], "tags": [], "owner": {"reputation": 2109, "user_id": 7030791, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/pIsKF.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/7030791/martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1491518300, "last_edit_date": 1491518300, "creation_date": 1491437580, "answer_id": 43243605, "question_id": 43243244, "link": "https://stackoverflow.com/questions/43243244/automatic-vectorization-of-matrix-multiplication/43243605#43243605", "title": "Automatic vectorization of matrix multiplication", "body": "<p>There is no message for vectorization done in you command! You can use <code>-fopt-info-vec</code> to turn the vectorization report on. But, do not rely on it. Compiler sometimes lies (They vectorize and report it but don't use it!) you can chek the improvements!For this purpose, you can measure the speedup. First, disable vectorization and measure the time t1. Then enable and measure the time t2. The speed up will be t1/t2 if it's bigger than 1 it says compiler improved if 1 no improvement if less than one it says compiler auto-vectorizer ruined that for you! Another way you can add <code>-S</code> to your command and see the assembly codes in a separated <code>.s</code> file. </p>\n\n<p><strong>NOTE:</strong> if you want to see the autovectorization power add <code>-march=native</code> and delete that <code>-msse2</code>.</p>\n\n<p><strong>UPDATE:</strong> When you use a variable such a <code>N</code>,<code>M</code>, etc. as the loop counter you might not see vectorization. Thus, you should have used <code>constants</code> instead. In my experience, the matrix-matrix multiplication is vectorizable using <code>gcc 4.8, 5.4 and 6.2</code>. Other compilers such as <code>clang-LLVM</code>, <code>ICC</code> and <code>MSVC</code> vectorize it as well. As mentioned in comments if you use <code>double</code> or <code>float</code> datatypes you might need to use <code>-ffast-math</code> which is an enabled flag in <code>-Ofast</code> optimization level, to say you don't need a high-accuracy result (It's OK most of the times). Its because ompilers are more carful about floting-point operations. </p>\n"}], "owner": {"reputation": 1057, "user_id": 4153464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D55Mz.jpg?s=128&g=1", "display_name": "Work of Artiz", "link": "https://stackoverflow.com/users/4153464/work-of-artiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 1, "accepted_answer_id": 43243605, "answer_count": 1, "score": 0, "last_activity_date": 1502020657, "creation_date": 1491434924, "last_edit_date": 1495542737, "question_id": 43243244, "link": "https://stackoverflow.com/questions/43243244/automatic-vectorization-of-matrix-multiplication", "title": "Automatic vectorization of matrix multiplication", "body": "<p>I'm fairly new with SIMD and wanted to try to see if I could get GCC to vectorise a simple action for me.</p>\n\n<p>So I looked at <a href=\"https://stackoverflow.com/questions/33965319/c-auto-vectorize-matrix-multiplication-loop\">this post</a> and wanted to do more or less the same thing. (but with gcc 5.4.0 on Linux 64bit, for a KabyLake processor)</p>\n\n<p>I essentially have this function:</p>\n\n<pre><code>/* m1 = N x M matrix, m2 = M x P matrix, m3 = N x P matrix &amp; output */\nvoid mmul(double **m1, double **m2, double **m3, int N, int M, int P)\n{\n    for (i = 0; i &lt; N; i++)\n        for (j = 0; j &lt; P; j++)\n        {\n            double tmp = 0.0;\n\n            for (k = 0; k &lt; M; k++)\n                tmp += m1[i][k] * m2[k][j];\n\n            tmp = m3[i][j];\n        }\n    return m3;\n}\n</code></pre>\n\n<p>Which I compile with <code>-O2 -ftree-vectorize -msse2 -ftree-vectorizer-verbose=5</code>, however I don't see any message that the vectorization was done.</p>\n\n<p>If anyone could help me out, that would be very much appreciated. </p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1491435903, "post_id": 43243215, "comment_id": 73556779, "body": "I&#39;m not sure I understand. Are you just looking for a macro like <code>#define TMR_IO T2CONbits.w</code>?"}, {"owner": {"reputation": 634, "user_id": 2066010, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RrcxN.png?s=128&g=1", "display_name": "b degnan", "link": "https://stackoverflow.com/users/2066010/b-degnan"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1491436538, "post_id": 43243215, "comment_id": 73556936, "body": "@Barmar  The issue is that there are different ICs, which a very similar code base.  For instance, on one IC, we have T5CONbits, and on another, it&#39;s T2CONbits, so I want to have something like a #define as you suggest but to address it as TMR_IO.w    All of those externs are causing GCC to be really picky and I&#39;m not sure how to proceed. :/"}, {"owner": {"reputation": 634, "user_id": 2066010, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RrcxN.png?s=128&g=1", "display_name": "b degnan", "link": "https://stackoverflow.com/users/2066010/b-degnan"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1491436653, "post_id": 43243215, "comment_id": 73556974, "body": "@Barmar actually, your #define suggestion will work fine it seems.   I don&#39;t know what I did wrong before.  Write it up and I&#39;ll accept the answer."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1491436703, "creation_date": 1491436703, "answer_id": 43243489, "question_id": 43243215, "link": "https://stackoverflow.com/questions/43243215/aliasing-a-name-of-a-structure/43243489#43243489", "title": "Aliasing a name of a structure", "body": "<p>Use a macro:</p>\n\n<pre><code>#define TMR_IO T2CONbits.w\n</code></pre>\n\n<p>Then you can write:</p>\n\n<pre><code>TMR_IO = 0x12345678;\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 2066010, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RrcxN.png?s=128&g=1", "display_name": "b degnan", "link": "https://stackoverflow.com/users/2066010/b-degnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 43243489, "answer_count": 1, "score": 0, "last_activity_date": 1491436703, "creation_date": 1491434734, "question_id": 43243215, "link": "https://stackoverflow.com/questions/43243215/aliasing-a-name-of-a-structure", "title": "Aliasing a name of a structure", "body": "<p>I have a structure that defines a timer, and I would like to have a generic name for the elements in the structure.  I want to create an alias so that I can use a generic name, such as TMR_IO, instead of T2CONbits.  This structure is attached to some control bits on a MCU, but I've had a really terrible time getting a redefinition.  The following is a small subset of the actual structure.</p>\n\n<pre><code>extern volatile unsigned int T2CON __attribute__((section(\"sfrs\")));\ntypedef union {\n  struct {\n    unsigned w:32;\n  };\n} __T2CONbits_t;\nextern volatile __T2CONbits_t T2CONbits __asm__ (\"T2CON\") __attribute__((section(\"sfrs\")));\n</code></pre>\n\n<p>T2CONbits.w=0x12345678 is how I use this in the code, and I would really like a way to alias to this structure without explicitly using the the __T2CONbits_t assignment.  I would really like to have something where I could just make an alias of sorts to T2CONbits, so I can just use a generic name, such as TMR_IO.  </p>\n\n<p>Any guidance is greatly appreciated.</p>\n"}, {"tags": ["c", "strcpy"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1491434833, "post_id": 43243197, "comment_id": 73556500, "body": "The problem code uses <code>strcpy_s()</code>, which needs another argument."}, {"owner": {"reputation": 43, "user_id": 7669230, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1807797602579227/picture?type=large", "display_name": "Jakob Eklund", "link": "https://stackoverflow.com/users/7669230/jakob-eklund"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1491435678, "post_id": 43243197, "comment_id": 73556729, "body": "Oh right! I tried using that because my environment prompted me to. I got the warning &quot;This function or variable may be unsafe. Consider using strcpy_s instead.&quot;, and it wouldn&#39;t compile unless I disabled some kind of deprication. Is that worth doing then?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1491436099, "post_id": 43243197, "comment_id": 73556817, "body": "All the <code>strXXX_s()</code> functions are useful to make buffer overflows less likely, so your code will be safer. So it&#39;s not a bad idea to use them, except they&#39;re not portable."}], "owner": {"reputation": 43, "user_id": 7669230, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1807797602579227/picture?type=large", "display_name": "Jakob Eklund", "link": "https://stackoverflow.com/users/7669230/jakob-eklund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491434579, "creation_date": 1491434579, "question_id": 43243197, "link": "https://stackoverflow.com/questions/43243197/why-does-strcpy-work-in-the-first-for-loop-but-not-the-second", "title": "Why does strcpy work in the first for-loop, but not the second?", "body": "<p>So to start this off, this is not the complete program. I am working on it and just ran into this problem. The first 3 times I call strcpy (in the first for-loop) it compiles without problem. However, the fourth through sixth times (in the second for-loop) I get the error message \"too few arguments in function to call\", even though the arguments are the same as in the first for-loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n\n#define ESC 27\n\nstruct lag {\nchar namn[20];\nint gjorda;\nint inslappta;\nint poang;\n};\n\nint main(void) {\n    struct lag temp, serie[] = {\n    { \"Bryn\\204s\", 0, 0, 0 },\n    { \"Djurg\\206rden\", 0, 0, 0 },\n    { \"Fr\\224lunda\", 0, 0, 0 },\n    { \"F\\204rjestad\", 0, 0, 0 },\n    { \"HV 71\", 0, 0, 0 },\n    { \"Link\\224ping\", 0, 0, 0 },\n    { \"Lule\\206     \", 0, 0, 0 },\n    { \"MODO    \", 0, 0, 0 },\n    { \"R\\224gle\", 0, 0, 0 },\n    { \"Skellefte\\206\", 0, 0, 0 },\n    { \"S\\224dert\\204lje\", 0, 0, 0 },\n    { \"Timr\\206\", 0, 0, 0 }\n};\nint i, j, k, hemma, borta;\n\n\nsrand((unsigned)time(NULL));\n\ndo {\n\n\n    for (k = 0; k &lt;= 10; k += 2)\n    {\n        hemma = rand() % 8;\n        borta = rand() % 8;\n        serie[k].gjorda = +hemma;\n        serie[k].inslappta = +borta;\n        serie[k + 1].gjorda = +borta;\n        serie[k + 1].inslappta = +hemma;\n\n        printf(\"%s - %s \\t \\t %d - %d \\n\", serie[k].namn, serie[k + 1].namn, hemma, borta);\n    }\n\n        if (hemma &gt; borta)\n            serie[i].poang = +3;\n\n        else if (hemma == borta)\n        {\n            serie[i].poang = +1;\n            serie[i + 1].poang = +1;\n        }\n\n        else if (hemma &lt; borta)\n            serie[i + 1].poang = +3;\n\n\n        for (i= 0; i &lt; 11; i++)\n            for (j = i+1;j&lt; 12; j++)\n                if (serie[j].poang &lt; serie[i].poang)\n                {\n                    temp.poang = serie[i].poang;\n                    serie[i].poang = serie[j].poang;\n                    serie[j].poang = temp.poang;\n\n                    temp.gjorda = serie[i].gjorda;\n                    serie[i].gjorda = serie[j].gjorda;\n                    serie[j].gjorda = temp.gjorda;\n\n                    temp.inslappta = serie[i].inslappta;\n                    serie[i].inslappta = serie[j].inslappta;\n                    serie[j].inslappta = temp.inslappta;\n\n                    strcpy(temp.namn, serie[i].namn);     //These compile\n                    strcpy(serie[i].namn, serie[j].namn);  \n                    strcpy(serie[j].namn, temp.namn);      \n                }\n\n\n\n        for (i = 0; i &lt; 11; i++)\n            for (j = i + 1; j&lt; 12; j++)\n                if (serie[j].poang == serie[i].poang)\n                    if ((serie[j].gjorda - serie[j].inslappta) &lt; (serie[i].gjorda - serie[i].inslappta))\n                    {\n                        temp.poang = serie[i].poang;\n                        serie[i].poang = serie[j].poang;\n                        serie[j].poang = temp.poang;\n\n                        temp.gjorda = serie[i].gjorda;\n                        serie[i].gjorda = serie[j].gjorda;\n                        serie[j].gjorda = temp.gjorda;\n\n                        temp.inslappta = serie[i].inslappta;\n                        serie[i].inslappta = serie[j].inslappta;\n                        serie[j].inslappta = temp.inslappta;\n\n                        strcpy_s(temp.namn, serie[i].namn);   //These don't\n                        strcpy_s(serie[i].namn, serie[j].namn);\n                        strcpy_s(serie[j].namn, temp.namn);\n                    }\n\n\n\n\n\n    } while (_getch() != ESC);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "loops", "if-statement", "while-loop", "conditional-statements"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1491436365, "post_id": 43242757, "comment_id": 73556888, "body": "Test the return value of scanf too. You might be doing comparisons with an undefined value."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1491432835, "post_id": 43242840, "comment_id": 73555937, "body": "It doesn&#39;t hurt anything, but the leading whitespace in the <code>scanf()</code> format string is unnecessary for <code>%d</code>."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 1, "last_activity_date": 1491434210, "last_edit_date": 1491434210, "creation_date": 1491432290, "answer_id": 43242840, "question_id": 43242757, "link": "https://stackoverflow.com/questions/43242757/how-to-make-code-loop-back-around-after-a-condition-of-if-c-guessing-game/43242840#43242840", "title": "How to make code loop back around after a condition of if, C guessing game", "body": "<ul>\n<li><code>continue;</code> will skip the rest of the loop body and reiterate the loop</li>\n<li><code>break;</code> will jump out of a loop and to just after the loop body.</li>\n</ul>\n\n<hr>\n\n<pre><code> int secretnumber;\n int guesses;\n\nwhile (1)  {\n  printf(\"Player 1: Type a number between 0 and 99 and press return:\\n\");\n  scanf(\" %d\",&amp;secretnumber);\n\n  if (secretnumber &gt; 99 || secretnumber &lt; 0) {\n    printf(\"Secret number cannot be greater than 99 or below 0.\\n\");\n    continue;\n    }\n break;\n }\n\nprintf( \"Type the number of guesses that player 2 gets and press return: \\n\");\nscanf(\" %d\",&amp;guesses);\n</code></pre>\n\n<hr>\n\n<p>BTW: you should also test the return value you get from <code>scanf()</code>, it is the number of successful assignments, or -1 for EOF.</p>\n\n<p>And: you can simplify the above loop by inverting the condition.</p>\n\n<hr>\n"}], "owner": {"reputation": 47, "user_id": 7767787, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8fde19c1073b1311f48dba288dc2b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Coffee Mug", "link": "https://stackoverflow.com/users/7767787/coffee-mug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 43242840, "answer_count": 1, "score": 1, "last_activity_date": 1491446438, "creation_date": 1491431775, "question_id": 43242757, "link": "https://stackoverflow.com/questions/43242757/how-to-make-code-loop-back-around-after-a-condition-of-if-c-guessing-game", "title": "How to make code loop back around after a condition of if, C guessing game", "body": "<p>I'm stuck on the problem of trying to make my code loop back around after a condition.</p>\n\n<p>I'm asking player 1 to enter a number between 0 and 99, if they enter anything outside of that the code should ask them to retry this. The problem is I honestly have no idea how to enable that from my code. This is what I have so far, I don't understand how to throw a while loop in here to have it circle back:</p>\n\n<pre><code>  int secretnumber;\n  int guesses;\n\n  printf(\"Player 1: Type a number between 0 and 99 and press return:\\n\");\n  scanf(\"%d\",&amp;secretnumber);\n\n  if (secretnumber &gt; 99 || secretnumber &lt; 0)\n    printf(\"Secret number cannot be greater than 99 or below 0.\");\n\n  else\n      printf(\"Type the number of guesses that player 2 gets and press return: \\n\");\n      scanf(\"%d\",&amp;guesses);\n</code></pre>\n\n<p>I'm new to this and fully aware of how incompetent I probably sound, so I apologize in advance for that.</p>\n"}, {"tags": ["c", "serial-port", "uart"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491465495, "post_id": 43242628, "comment_id": 73567316, "body": "&#39;So i am thinking to read the data byte by byte and determine the end of the packet&#39; sure, that is certainly one protocol that should work, assuming you have an unambiguous end-of-packet marker byte."}, {"owner": {"reputation": 605, "user_id": 940662, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9795c33498695e4c01e61e1a3a43c8ee?s=128&d=identicon&r=PG", "display_name": "sachin", "link": "https://stackoverflow.com/users/940662/sachin"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491576927, "post_id": 43242628, "comment_id": 73630536, "body": "I found something interesting here with the setting. <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xbd/termios.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/7908799/xbd/termios.html</a>"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1491602122, "post_id": 43242628, "comment_id": 73643409, "body": "See <a href=\"http://stackoverflow.com/questions/43280740/parsing-complete-messages-from-serial-port/43287464#43287464\" title=\"parsing complete messages from serial port\">stackoverflow.com/questions/43280740/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7823207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42b2a721938fca3a3e2d7024793a622?s=128&d=identicon&r=PG&f=1", "display_name": "Gene Lee", "link": "https://stackoverflow.com/users/7823207/gene-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1491432799, "creation_date": 1491432799, "answer_id": 43242931, "question_id": 43242628, "link": "https://stackoverflow.com/questions/43242628/reading-data-on-serial-port-byte-by-byte/43242931#43242931", "title": "Reading data on serial port - byte by byte", "body": "<p>A good approach for for processing serial data is to Read chunks of data from port the into a buffer and then pull byte by byte from the buffer.</p>\n\n<p>Serial port reading is affected by the timeout settings and incoming data flow, so the number of bytes per read are not guaranteed to be consistent. For example, if you knew that packets were always going to be 46 bytes, then you might think to set Vmin to 46 and expect to get 46 bytes per read. However, if the sending source sends multiple packets without delays between, then you might get all of one and part of another packet. If the sending source were to delay during the transmission of a packet for longer than the receiving port's timeout, then you would get fewer than Vmin bytes.</p>\n\n<p>Be sure to code for the possibility of lost data. For example, let's say that packets start with  and ends with . You start pulling data from the buffer and the first byte is , but 49 bytes later you encounter  meaning a new packet, but without having seen the  from the previous packet. There should of course also be a CRC for the packet, or at least a checksum.</p>\n"}, {"tags": [], "owner": {"reputation": 373, "user_id": 13613118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e1b6c0858170fd6c62b1ddc03c02c6?s=128&d=identicon&r=PG", "display_name": "Catch22", "link": "https://stackoverflow.com/users/13613118/catch22"}, "is_accepted": false, "score": 0, "last_activity_date": 1590474301, "creation_date": 1590474301, "answer_id": 62015893, "question_id": 43242628, "link": "https://stackoverflow.com/questions/43242628/reading-data-on-serial-port-byte-by-byte/62015893#62015893", "title": "Reading data on serial port - byte by byte", "body": "<p>Since you are reading data that is structured into packets of variable size, you should add a 2 byte header for each packet and set it to the packet size. </p>\n\n<p>In the reader you would read 2 bytes first and then decide how many bytes to read to receive the whole packet.</p>\n"}], "owner": {"reputation": 605, "user_id": 940662, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9795c33498695e4c01e61e1a3a43c8ee?s=128&d=identicon&r=PG", "display_name": "sachin", "link": "https://stackoverflow.com/users/940662/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1624, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1590474301, "creation_date": 1491431003, "question_id": 43242628, "link": "https://stackoverflow.com/questions/43242628/reading-data-on-serial-port-byte-by-byte", "title": "Reading data on serial port - byte by byte", "body": "<p>How to read data on serial port in byte by byte fashion.</p>\n\n<p>I have a source which sends out packets of varying packet size. I am reading the data in raw mode(non-canonical). When i set VMIN, i am able to get packet of that size or slightly larger.\nfor ex: If the received packet size is 46 bytes, and if i set VMIN to say '1'. I receive the data in 2 chunks(meaning 2 read calls were needed to get the complete data with one fetching first 32 and next fetching the rest 14 bytes).\nIf i set VMIN to 46, complete packet is fetched. </p>\n\n<p>But the problem here is <strong>varying packet size</strong>. If the data packet size is more(say 70 bytes), it will mess up the buffer and following reads as it reads 60+ bytes in first read and rest in next read.</p>\n\n<p>So i am thinking to read the data byte by byte and determine the end of the packet. </p>\n\n<p>Does anyone know if it is do-able. Or any suggestion on how to read the complete data packet in one read operation.</p>\n\n<p>UART setting:\nBaud: 115200\nNo parity.\n1 stop bit.\n8N1.\nNo flow control.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1491429702, "post_id": 43242350, "comment_id": 73554871, "body": "<code>while(fscanf(fPtr, &quot;%49s&quot;, wordList) == 1) {</code> --&gt; <code>int i=0; while(i &lt; 200 &amp;&amp; fscanf(fPtr, &quot;%49s&quot;, words[i]) == 1) { ++i; }</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1491430419, "post_id": 43242350, "comment_id": 73555153, "body": "You haven&#39;t allocated any memory for <code>wordList</code> to point to."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1491430470, "post_id": 43242350, "comment_id": 73555171, "body": "As it stands, <code>wordList</code> is just an uninitialized pointer. Follow <a href=\"http://stackoverflow.com/questions/43242350/using-fscanf-to-input-words-into-a-2d-array#comment73554871_43242350\">@BLUEPIXY</a>, and comments from the previous question."}, {"owner": {"reputation": 139, "user_id": 4683175, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-WJeFH_wvGQ8/AAAAAAAAAAI/AAAAAAAAABc/M-F1uNUB7cs/photo.jpg?sz=128", "display_name": "C.j.", "link": "https://stackoverflow.com/users/4683175/c-j"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491431412, "post_id": 43242350, "comment_id": 73555493, "body": "Thank you for all the guidance @BLUEPIXY and those that commented on my previous post. With <code>words[][]</code> being a 2d array, i was under the impression they couldn&#39;t be assigned using only one dimension. I feel much better about it, thank you everyone!"}], "owner": {"reputation": 139, "user_id": 4683175, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-WJeFH_wvGQ8/AAAAAAAAAAI/AAAAAAAAABc/M-F1uNUB7cs/photo.jpg?sz=128", "display_name": "C.j.", "link": "https://stackoverflow.com/users/4683175/c-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491429492, "creation_date": 1491429492, "question_id": 43242350, "link": "https://stackoverflow.com/questions/43242350/using-fscanf-to-input-words-into-a-2d-array", "title": "Using fscanf() to input words into a 2d array", "body": "<p>I'm having some issues regarding the use of <code>fscanf()</code>. My main objective is to take each word from an input file, and place them sequentially into a 2d array of <code>char</code>, like so:</p>\n\n<pre><code>Ex:\nwords[0][] = The\nwords[1][] = Quick\nwords[2][] = Brown\nwords[3][] = Fox\n...\n</code></pre>\n\n<p>I've tried some other methods, such as <code>fgetc()</code> and placing each character in their spot with nested <code>for</code> loops. This seems like overkill when there is obviously more streamlined methods. The way it stands, at each iteration, <code>wordList</code> contains the next word to be read. How would I go about assigning the current value of wordList(at each iteration) sequentially into a 2d array? </p>\n\n<p>My current (relevant) code:</p>\n\n<pre><code>int main (int argc, char *argv[]) {\nFILE *fPtr;\nchar words[200][50];\nchar *wordList;\n\n    if (fPtr = fopen(argv[2], \"r\")) {                          // If the file exists, open it for reading\n            while(fscanf(fPtr, \"%49s\", wordList) == 1) {            // Read in strings from main file into wordList\n         // strcpy(words, wordList);\n    } else {       \n        fprintf(stderr, \"%s\", \"ERROR: File could not be opened.\\n\");\n        return 0;\n    }\n    fclose(fPtr);\n    return 0;\n}   \n</code></pre>\n\n<p>The maximum words to be read can safely be assumed to be less than 200. The length of each word can be assumed to be less than 50 characters. </p>\n"}, {"tags": ["c", "linked-list", "insert", "tail"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1491429314, "post_id": 43242261, "comment_id": 73554718, "body": "This loop serves little purpose: <code>while(temp!=NULL){ temp=temp-&gt;next; }</code>. You might as well just replace it with <code>temp = NULL;</code>"}, {"owner": {"reputation": 499, "user_id": 5339899, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ebf68221eb3e8ff1037314f300217549?s=128&d=identicon&r=PG&f=1", "display_name": "TheQAGuy", "link": "https://stackoverflow.com/users/5339899/theqaguy"}, "edited": false, "score": 0, "creation_date": 1491429414, "post_id": 43242261, "comment_id": 73554766, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Dont cast return of malloc</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1491431581, "last_edit_date": 1491431581, "creation_date": 1491431075, "answer_id": 43242639, "question_id": 43242261, "link": "https://stackoverflow.com/questions/43242261/linked-list-insert-and-delete/43242639#43242639", "title": "Linked List Insert and Delete", "body": "<p>For starters the pointer <code>newnode</code> has indeterminate value. Thus these statements </p>\n\n<pre><code>strcpy(newnode-&gt;name, n);\nnewnode-&gt;age=a;\n</code></pre>\n\n<p>result in undefined behavior.</p>\n\n<p>This loop</p>\n\n<pre><code>while(temp!=NULL){\n    temp=temp-&gt;next;\n}\n</code></pre>\n\n<p>does not make sense because it is evident that after the loop the pointer <code>temp</code> will be equal to <code>NULL</code>.</p>\n\n<p>And you have to change the last pointer in the list after which the new node is inserted.</p>\n\n<p>The function can look at least the following way (though using the function <code>scanf</code> with a character array as it is used in your program is unsafe)</p>\n\n<pre><code>void InsetEnd()\n{\n    stud *newnode;\n    stud **temp;   \n    char n[15];\n    int a;\n\n    printf(\"Student: \\n\");\n    printf(\"Name: \");\n    scanf(\"%s\", n);\n    printf(\"Age: \");\n    scanf(\"%d\", &amp;a);\n\n    newnode = ( stud * )malloc( sizeof( stud ) );\n\n    strcpy( newnode-&gt;name, n );\n    newnode-&gt;age = a;\n    newnode-&gt;next = NULL;\n\n    temp = &amp;head;\n\n    while ( *temp != NULL ) temp = &amp;( *temp )-&gt;next;\n\n    *temp = newnode;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1491432306, "post_id": 43242812, "comment_id": 73555757, "body": "While this code may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> of how and why this solves the problem would really help to improve the quality of your post. Remember that you are answering the question for readers in the future, not just the person asking now! Please edit your answer to add explanation, and give an indication of what limitations and assumptions apply."}, {"owner": {"reputation": 19, "user_id": 6672027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b680196cf468c3cba7d57b95c4ef2226?s=128&d=identicon&r=PG&f=1", "display_name": "Erkan Liman", "link": "https://stackoverflow.com/users/6672027/erkan-liman"}, "reply_to_user": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1491434055, "post_id": 43242812, "comment_id": 73556291, "body": "@Makyen  I&#39;ve started using StackOverflow yet. So I answered late. thank you for your interest. I will pay attention to the rules."}], "tags": [], "owner": {"reputation": 19, "user_id": 6672027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b680196cf468c3cba7d57b95c4ef2226?s=128&d=identicon&r=PG&f=1", "display_name": "Erkan Liman", "link": "https://stackoverflow.com/users/6672027/erkan-liman"}, "is_accepted": false, "score": -1, "last_activity_date": 1491434632, "last_edit_date": 1491434632, "creation_date": 1491432104, "answer_id": 43242812, "question_id": 43242261, "link": "https://stackoverflow.com/questions/43242261/linked-list-insert-and-delete/43242812#43242812", "title": "Linked List Insert and Delete", "body": "<p>I will try to explain it from the following example</p>\n\n<pre><code>  #include &lt;iostream&gt;\n\n    /* run this program using the console pauser or add your own getch, system(\"pause\") or input loop */\n    class Node {\n    public:\n        double  data;       // data\n        Node*   next;       // pointer\n    };\n\n    class List {\n    public:\n        List(void) { head = NULL; } // constructor\n        ~List(void);                // destructor\n\n        bool IsEmpty() { return head == NULL; } //bo\u015f kontrol\u00fc\n        Node* InsertNode(int index, double x);  //node ekle\n        int FindNode(double x);  //node bul\n        int DeleteNode(double x); //node sil\n        void DisplayList(void); //liste g\u00f6r\u00fcnt\u00fcle\n    private:\n        Node* head; //ba\u015f k\u0131sm\u0131\n    };\n\n    Node* List::InsertNode(int index, double x) {\n\n        if (index &lt; 0) return NULL; \n\n        int currIndex   =   1;\n        Node* currNode  =   head;\n        while (currNode &amp;&amp; index &gt; currIndex) {\n            currNode    =   currNode-&gt;next;\n            currIndex++;\n        }\n        if (index &gt; 0 &amp;&amp; currNode == NULL) return NULL;\n\n        Node* newNode   =   new Node;\n        newNode-&gt;data   =   x;  \n        if (index == 0) {\n            newNode-&gt;next   =   head;\n            head        =   newNode;\n        }\n        else{\n            newNode-&gt;next   =   currNode-&gt;next;\n            currNode-&gt;next  =   newNode;\n        }\n        return newNode;\n    }\n\n\n    int List::FindNode(double x) {\n        Node* currNode  =   head;\n        int currIndex   =   1;\n        while (currNode &amp;&amp; currNode-&gt;data != x) {\n            currNode    =   currNode-&gt;next;\n            currIndex++;\n        }\n        if (currNode) return currIndex;\n        return 0;\n    }\n    int List::DeleteNode(double x) {\n        Node* prevNode  =   NULL;\n        Node* currNode  =   head;\n        int currIndex   =   1;\n        while (currNode &amp;&amp; currNode-&gt;data != x) {\n            prevNode    =   currNode;\n            currNode    =   currNode-&gt;next;\n            currIndex++;\n        }\n        if (currNode) {\n            if (prevNode) {\n                prevNode-&gt;next  =   currNode-&gt;next;\n                delete currNode;\n            }\n            else {\n                head        =   currNode-&gt;next;\n                delete currNode;\n            }\n            return currIndex;\n        }\n        return 0;\n    }\n\n    void List::DisplayList()\n    {\n       int num      =   0;\n       Node* currNode   =   head;\n       while (currNode != NULL)\n       {\n        printf(\"\\n%lf\",currNode-&gt;data);\n\n        currNode    =   currNode-&gt;next;\n        num++;\n       }\n       printf(\"\\nNumber of nodes in the list: %d\",num);\n    }\n    List::~List(void) {\n       Node* currNode = head, *nextNode = NULL;\n       while (currNode != NULL)\n       {\n        nextNode    =   currNode-&gt;next;\n        // destroy the current node\n        delete currNode;    \n        currNode    =   nextNode;\n       }\n    }\n\n    int main(int argc, char** argv) {\n\n        List list;\n        list.InsertNode(0,5.4); //ba\u015far\u0131l\u0131\n        list.InsertNode(1,6.5); //ba\u015far\u0131l\u0131\n        list.InsertNode(-2,5.5);//ba\u015fars\u0131z\n        list.InsertNode(2,10.0);//ba\u015far\u0131l\u0131\n        list.DisplayList();\n        list.DeleteNode(5.4);\n        list.DisplayList();\n        return 0;\n    }\n</code></pre>\n\n<p>Now edit node part</p>\n\n<pre><code>class Node {\npublic:\n    int no;\n    char name[15];\n    char surname[15];\n    int age;\n    Node* next; \n};\n</code></pre>\n\n<p>and insert function. Flow chart is <a href=\"https://i.stack.imgur.com/AXWPV.png\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>Node* List::InsertNode(int index, int no,char name[15],char surname[15],int age){\n    if (index &lt; 0) return NULL;\n    int currIndex = 1;\n    Node* currNode = head;\n    while (currNode &amp;&amp; index &gt; currIndex) {\n        currNode = currNode-&gt;next;\n        currIndex++;\n    }\n    if (index &gt; 0 &amp;&amp; currNode == NULL) return NULL;\n    Node* newNode = new Node;\n    newNode-&gt;no = no;\n    strcpy_s(newNode-&gt;name, name);\n    strcpy_s(newNode-&gt;surname, surname);\n    strcpy_s(newNode-&gt;age, age);\n    if (index == 0) {\n        newNode-&gt;next = head;\n        head = newNode;\n    }\n    else {\n        newNode-&gt;next = currNode-&gt;next;\n        currNode-&gt;next = newNode;\n    }\n    return newNode;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 6312698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cuZvodx4zpQ/AAAAAAAAAAI/AAAAAAAAAiI/vnFEkbm5H58/photo.jpg?sz=128", "display_name": "Yacine", "link": "https://stackoverflow.com/users/6312698/yacine"}, "is_accepted": false, "score": 0, "last_activity_date": 1491526508, "creation_date": 1491526508, "answer_id": 43268013, "question_id": 43242261, "link": "https://stackoverflow.com/questions/43242261/linked-list-insert-and-delete/43268013#43268013", "title": "Linked List Insert and Delete", "body": "<p>I was able to solve the problem. It was just the allocation place in the function. I actually had to allocate memory before creating the node, which if you inverse it will not create anything and it will only display garbage. </p>\n\n<pre><code>void InsetEnd(){\n\nstud *temp, *newnode;   \nchar n[15];\nint a;\n\nprintf(\"Student: \\n\");\nprintf(\"Name: \");\nscanf(\"%s\", n);\nprintf(\"Age: \");\nscanf(\"%d\", &amp;a);\n\nnewnode = (stud *) malloc (sizeof(stud));\nstrcpy(newnode-&gt;name, n);\nnewnode-&gt;age=a;\n\ntemp=head;\n\nwhile(temp-&gt;next!=NULL){\n    temp=temp-&gt;next;\n}\n\nnewnode-&gt;next = NULL;\ntemp-&gt;next = newnode;   }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 6683957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40855285ac0c8cfa0fe8c62a61e9ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "V. Sim", "link": "https://stackoverflow.com/users/6683957/v-sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1491858379, "last_edit_date": 1491858379, "creation_date": 1491528370, "answer_id": 43268208, "question_id": 43242261, "link": "https://stackoverflow.com/questions/43242261/linked-list-insert-and-delete/43268208#43268208", "title": "Linked List Insert and Delete", "body": "<p>Seems like you caught your own issue. Allocating memory before trying to access or set data is essential! There are a few more things I felt like I need to mention to help you in the future.</p>\n\n<pre><code>void InsetEnd(stud *head) { // pass head pointer, becomes local pointer so its not overriden\n    if (!head) \n        return; // dont do anything if list does not exist\n\n    stud *newnode; // no need for tmp anymore\n    char n[15] = \"\"; // initialize\n    int a;\n\n    printf(\"Student: \\n\");\n    printf(\"Name: \");\n    scanf(\"%14s\", n); // take only 14 chars, leaving the 15th '\\0' or you'll have problems reading long names after\n    printf(\"Age: \");\n    scanf(\"%d\", &amp;a);\n\n    newnode = calloc(1,sizeof(*newnode)); // use calloc to avoid junk\n    // ^ type casting a return of void* is not necessary in c\n\n    strcpy(newnode-&gt;name, n);\n    newnode-&gt;age=a;\n\n    while(head-&gt;next) // NULL is pretty much false\n        head=head-&gt;next;\n\n    // no need to set newnode next to null, its already null from calloc\n    head-&gt;next = newnode;   \n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 9, "user_id": 6312698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cuZvodx4zpQ/AAAAAAAAAAI/AAAAAAAAAiI/vnFEkbm5H58/photo.jpg?sz=128", "display_name": "Yacine", "link": "https://stackoverflow.com/users/6312698/yacine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 620, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1491858379, "creation_date": 1491429119, "question_id": 43242261, "link": "https://stackoverflow.com/questions/43242261/linked-list-insert-and-delete", "title": "Linked List Insert and Delete", "body": "<p>I'm trying to do a program that inserts and deletes students from a linked list and when I try to insert a student at the end of the list but it doesn't work. I'm pretty sur that I the function algorithm is right, but still. Anyways, here's the code: </p>\n\n<pre><code>void InsetEnd(){\n\nstud *temp, *newnode;   \nchar n[15];\nint a;\n\nprintf(\"Student: \\n\");\nprintf(\"Name: \");\nscanf(\"%s\", n);\nprintf(\"Age: \");\nscanf(\"%d\", &amp;a);\n\nstrcpy(newnode-&gt;name, n);\nnewnode-&gt;age=a;\n\ntemp=head;\n\nwhile(temp!=NULL){\n    temp=temp-&gt;next;\n}\ntemp = (stud *) malloc (sizeof(stud));\n\nnewnode-&gt;next = NULL;   \ntemp-&gt;next = newnode; }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1491428607, "post_id": 43242082, "comment_id": 73554415, "body": "1. &quot;it won&#39;t work&quot; is not a sufficient description of the situation. Doesn&#39;t the program compile or doesn&#39;t it run properly? 2. ID and n are declared as ints, yet your scanf treats them as floats. Pretty amazing that that went well anywhere. 3. Can you add the definition of cordx and cordy?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491428649, "post_id": 43242082, "comment_id": 73554430, "body": "Don&#39;t read floats into ints - it won&#39;t go well."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1491428859, "post_id": 43242082, "comment_id": 73554515, "body": "printf() out the ID and n as you read them.  That&#39;s a  sorta &#39;standard&#39; test/debug check.   Unless you do those sort of things, or use an actual debugger, you will not progress.."}, {"owner": {"reputation": 39, "user_id": 7128837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44mJbH0n-pM/AAAAAAAAAAI/AAAAAAAAEb8/OLvgoCqfwpU/photo.jpg?sz=128", "display_name": "Jonahatan pe&#241;a", "link": "https://stackoverflow.com/users/7128837/jonahatan-pe%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1491429051, "post_id": 43242082, "comment_id": 73554590, "body": "The program runs properly as sequential algorithm in my operating system, my problem is I cannot use &quot;fscanf&quot; for reading data  in a cluster for testing parallel programming like openmp."}, {"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 1, "creation_date": 1491429164, "post_id": 43242082, "comment_id": 73554628, "body": "It may give the impression of running properly, but your program is not <b>correct</b>. Also, does your progam fail to <b>compile</b> or <b>run</b>?"}, {"owner": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "edited": false, "score": 0, "creation_date": 1491434139, "post_id": 43242082, "comment_id": 73556315, "body": "Please include a sample input from the file so it&#39;s clear what the data is supposed to look like."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491465980, "post_id": 43242082, "comment_id": 73567640, "body": "You want to read the file in parallel on clusters? What?"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1491471657, "post_id": 43247596, "comment_id": 73571652, "body": "@Seb Thanks, good additional info. (And it probably led some reputation my way.)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1491473127, "post_id": 43247596, "comment_id": 73572783, "body": "Your answer is good, good enough to earn the tick in my books; no point rewriting it to add details. Besides, I don&#39;t really need the rep. I&#39;m chasing badges atm ;)"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 1, "last_activity_date": 1491465729, "last_edit_date": 1491465729, "creation_date": 1491460889, "answer_id": 43247596, "question_id": 43242082, "link": "https://stackoverflow.com/questions/43242082/read-a-file-txt-in-a-c-program/43247596#43247596", "title": "read a file .txt in a C program", "body": "<p><code>fscanf()</code>returns something. It is supposed to help you detect problems and special situations. Your cluster is configured to complain about that. Your own PC is not configured like that, hence it does not warn.  </p>\n\n<p>In order to avoid the warning on the cluster, do not ignore the return value. I.e. check whether you successfully matched.</p>\n\n<p>Alternatively do <code>(void) fsanf...</code> which tells the compiler \"I intentionally ignore the helpful return value.\".</p>\n\n<p>According to the <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/fscanf.html\" rel=\"nofollow noreferrer\">opengroup <code>fscanf</code> manpages</a> (within the <em>RETURN VALUE</em> section), you should expect your call to <code>fscanf</code> to return 2 when it's successful at reading your two <code>float</code> values:</p>\n\n<blockquote>\n  <p>Upon successful completion, these functions return the number of successfully matched and assigned input items; this number can be 0 in the event of an early matching failure.</p>\n</blockquote>\n\n<p>If it returns less than two, extra work will be required to discard erroneous input (see below for a nice example of this), exit the process or otherwise handle the error in some other manner. Otherwise, your future calls to <code>fscanf</code> will fail due to the same garbage left unread from <code>stdin</code>.</p>\n\n<pre><code>if (fscanf(data, \"%f %f\", &amp;ID, &amp;n) != 2) {\n    fscanf(data, \"%*[^\\n]\"); // read and discard up to the next newline character\n    fgetc(data);             // ... and discard the newline character, too\n    /* XXX: What to do with cordx[i] and cordy[i]? */\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7128837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44mJbH0n-pM/AAAAAAAAAAI/AAAAAAAAEb8/OLvgoCqfwpU/photo.jpg?sz=128", "display_name": "Jonahatan pe&#241;a", "link": "https://stackoverflow.com/users/7128837/jonahatan-pe%c3%b1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 43247596, "answer_count": 1, "score": 0, "last_activity_date": 1491465729, "creation_date": 1491428318, "last_edit_date": 1491428899, "question_id": 43242082, "link": "https://stackoverflow.com/questions/43242082/read-a-file-txt-in-a-c-program", "title": "read a file .txt in a C program", "body": "<p>I am programing a parallel openmp in C language and I using this code to read one million of data from a .txt file.</p>\n\n<pre><code> FILE *data = NULL;\n data = fopen(\"1millon.txt\",\"r\");\n\nfloat ID, n, cord[1000000],cordy[1000000];\nint ale = 1000000;  \nfor(i=0;i&lt;ale;i++){\n\nfscanf (data, \"%f %f\", &amp;ID, &amp;n);\n    cordx[i]=ID;\n    cordy[i]=n;\n} \n</code></pre>\n\n<p>Actually this \"fscanf\" is doing well when I run my program in my normal computer. But if  I would like to run it in a cluster for parallelization it will show me the next warning <strong>( warning: ignoring return value of \u2018fscanf\u2019, declared with attribute warn_unused_result [-Wunused-result]\n  fscanf (data, \"%f %f\", &amp;ID, &amp;n);\n)</strong> \nand it won't run.\" </p>\n\n<p>Do you know another way how to read a .txt file instead of \"fscanf\", \"fread\"?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 191, "user_id": 2789489, "user_type": "registered", "profile_image": "https://graph.facebook.com/1411712659/picture?type=large", "display_name": "Josh Rodstein", "link": "https://stackoverflow.com/users/2789489/josh-rodstein"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1491431754, "post_id": 43242061, "comment_id": 73555608, "body": "noted:  Update: Fixed..  Moved &quot;free(token_array)&quot; outside of my shell while loop."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 2, "creation_date": 1491436327, "post_id": 43242061, "comment_id": 73556872, "body": "<code>token_array = malloc(sizeof(char)*strlen(input))</code> should be <code>sizeof(char *)</code>, since you&#39;re allocating an array of pointers."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1491451122, "post_id": 43242061, "comment_id": 73560566, "body": "If <code>chdir</code> fails due to a permission error, an error message of the form &#39;No such file or directory&#39; (written to stdout!) is less than helpful.  <code>man perror</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1541000799, "post_id": 43242061, "comment_id": 93071506, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>. Learn also to use <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a>, in particular to understand what <i>existing</i> shells are doing. Study the source code of free software shells, such as <code>sash</code> or <code>bash</code>, for inspiration"}, {"owner": {"reputation": 1409, "user_id": 759446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebb21a6a72a053c7f325f953962f13d?s=128&d=identicon&r=PG", "display_name": "chrisdowney", "link": "https://stackoverflow.com/users/759446/chrisdowney"}, "edited": false, "score": 0, "creation_date": 1547415311, "post_id": 43242061, "comment_id": 95175765, "body": "You&#39;re not adding a NULL value at the end of the array of tokens, as required by execvp."}], "owner": {"reputation": 191, "user_id": 2789489, "user_type": "registered", "profile_image": "https://graph.facebook.com/1411712659/picture?type=large", "display_name": "Josh Rodstein", "link": "https://stackoverflow.com/users/2789489/josh-rodstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1541000554, "creation_date": 1491428180, "last_edit_date": 1541000554, "question_id": 43242061, "link": "https://stackoverflow.com/questions/43242061/execvp-with-ls-not-working-in-custom-shell", "title": "execvp with &quot;ls&quot; not working in custom shell", "body": "<p><strong>What I am doing</strong>: Creating a custom shell for a class project. Just started implementing my fork and exec features.</p>\n\n<p><strong>My Issue</strong>:  <code>ls</code> works fine until I change directories with <code>cd</code>. After the first <code>cd</code>, <code>ls</code> requires the <code>.</code> to list files in current directory. After that, it seems to lose all functionality. </p>\n\n<p>I've included my code below. Any help (including pointing out obvious newb mistakes) is appreciated. I am in the early stages of grasping these concepts.</p>\n\n<pre><code>int main(){\n  char *input = malloc(sizeof(char*) * BUFFERSIZE);\n  char *token;\n  char **token_array;\n  int i;\n  int return_status;\n\n  printf(\"%s\", BOILERPLATE);  \n  if (input == NULL){\n    printf(\"JASH: Buffer Allocation Failed\");\n    return 1;\n  }\n\n  // Shell Loop\n  while(1){\n    i = 0;\n\n    printf(\"JASH:&gt;  \");\n    fgets(input, BUFFERSIZE, stdin);\n    token_array = malloc(sizeof(char)*strlen(input));\n\n    token = strtok(input, \" \\n()&lt;&gt;|&amp;;\");\n    while(token != NULL){\n      token_array[i] = token;\n      token = strtok(NULL, \" \\n()&lt;&gt;|&amp;;\");\n      i++;\n    }\n\n    // print tokens to confirm correct parsing of input\n    printf(\"%s : %s\\n\", token_array[0], token_array[1]);\n\n    //printf(\"%s\\n\", token_array[0]);\n    if(exec_args(token_array) == 0){\n      // programm exit successfully\n      free(token_array);\n      free(input);\n      return 0;;\n    }\n\n  } // Loop End\n\n\n\n\n  // free input buffer before exit\n  free(token_array);\n  free(input);\n  return 0;\n\n}\n\n\nint exec_args(char ** t){\n  int i;\n\n  if(strcmp(t[0], \"exit\") == 0\n     || strcmp(t[0], \"quit\") == 0\n     || strcmp(t[0], \"logout\") == 0){\n    // call built in function for exit\n    exit(0);\n  }\n\n  if (strcmp(t[0], \"cd\") == 0){\n    // call built in function for chdir\n    if(chdir(t[1]) == 0){\n      printf(\"Successfully changed directories to %s\\n\", t[1]);\n      return 1;\n    } else {\n      printf(\"-JASH: cd: %s: No such file or directory\\n\", t[1]);\n      return 1;\n    }\n  } \n\n  if (strcmp(t[0], \"pwd\") == 0) {\n    char * p = malloc(sizeof(char*) * 100);\n    getcwd(p, 100);\n    printf(\"%s\\n\", p);\n    free(p);\n    return 1;\n  } \n\n  if(strcmp(t[0], \"help\") == 0){\n    printf(\"\\n%s\\n Help Documentation Coming soon!\\n\\n\", BOILERPLATE);\n    return 1;\n  } \n\n\n  if(fork() == 0){\n   if(execvp(t[0], t)){\n     perror(\"JASH\");\n   } \n\n  } else {\n    int status;\n    wait(&amp;status);\n    printf(\"%d\", status);\n  }\n  return 1;\n\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "profiling", "cpu-cache", "cachegrind"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 2, "creation_date": 1491429021, "post_id": 43241895, "comment_id": 73554577, "body": "&#39;the OS should automatically close the file at the end of the program anyway&#39; - well in C, that&#39;s optimistic...  It will free the fd etc, sure, but it will probably not flush buffered data as close() would do."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1491429124, "post_id": 43241895, "comment_id": 73554614, "body": "&quot;[..] the speed at which the <code>.</code> are printed out is visibly faster [..]&quot; o.O is this a joke? The speed at which those characters are printed depends not directly on your program but rather on the buffering of the standard library and the terminal... Do you have any ... better suitable measurement which indicates that the difference in runtime is <i>really</i> <b>not</b> at the end of the program?"}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 3, "creation_date": 1491430125, "post_id": 43241895, "comment_id": 73555025, "body": "@DanielJour: Good point. In the original version of the program there was an fflush after each printf that I forgot to include in this question (I edited to include that now). But even then, the fact that changing the size of the <code>large_buffer</code> array had an effect in the runtime suggests that this is some sort of memory issue and not just an output buffering artifact. I used <code>&#47;usr&#47;bin&#47;time</code> to measure how long each program took to run."}, {"owner": {"reputation": 1121, "user_id": 7002215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e309bad5f11999bc0785b0b357ce22?s=128&d=identicon&r=PG&f=1", "display_name": "Isuru H", "link": "https://stackoverflow.com/users/7002215/isuru-h"}, "edited": false, "score": 2, "creation_date": 1491468738, "post_id": 43241895, "comment_id": 73569515, "body": "I don&#39;t think this has anything to do with caches or memory alignment. fclose is a library(system) call and will certainly take certain number of cycles to complete. If the rest of your program happens to be less than or equal to this cycle count, it will look like a 2X improvement. Try increasing you loop limit to, 10000. Now the effect of fclose wont be 2X!"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 1121, "user_id": 7002215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e309bad5f11999bc0785b0b357ce22?s=128&d=identicon&r=PG&f=1", "display_name": "Isuru H", "link": "https://stackoverflow.com/users/7002215/isuru-h"}, "edited": false, "score": 2, "creation_date": 1491480210, "post_id": 43241895, "comment_id": 73577869, "body": "@IsuruH the curiosity seems to be that the code runs faster <i>with</i> the <code>fclose</code>, not slower."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 1121, "user_id": 7002215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e309bad5f11999bc0785b0b357ce22?s=128&d=identicon&r=PG&f=1", "display_name": "Isuru H", "link": "https://stackoverflow.com/users/7002215/isuru-h"}, "edited": false, "score": 0, "creation_date": 1491487298, "post_id": 43241895, "comment_id": 73583493, "body": "@IsuruH: In addition to what Daniel said, the program already already has a big loop inside the do_lots_of_stuff function. It takes multiple seconds to run, which is orders of magnitude more than a single system call."}, {"owner": {"reputation": 1121, "user_id": 7002215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e309bad5f11999bc0785b0b357ce22?s=128&d=identicon&r=PG&f=1", "display_name": "Isuru H", "link": "https://stackoverflow.com/users/7002215/isuru-h"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1491494554, "post_id": 43241895, "comment_id": 73589238, "body": "@DanielJour my apologies. read it too quickly. In that case, it is strange!!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1491666998, "post_id": 43241895, "comment_id": 73659020, "body": "I&#39;d be interested to see how you <code>do_lots_of_stuff()</code>"}, {"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 1, "creation_date": 1491671546, "post_id": 43241895, "comment_id": 73661642, "body": "Can&#39;t reproduce on windows, i&#39;ve measured with&amp;without fclose and the elapsed time is the same. What is that <code>do_lots_of_stuff()</code> doing?"}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 0, "creation_date": 1491676821, "post_id": 43241895, "comment_id": 73663396, "body": "@BPL: I doubt anyone will be able to reproduce this unless they run the exact same program, compiler version, CPU hardware and operating system as  I did. And I can&#39;t make a minimal example because tiny seemingly inconsequential changes make the weird behavior disappear. This is why I am asking about what profiling or diagnostic tools I can use on Linux to figure out what is going on."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1491676857, "post_id": 43241895, "comment_id": 73663412, "body": "But if you are curious, the original program was a brainfuck interpreter running a particular brainfuck benchmark."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 1, "creation_date": 1491745468, "post_id": 43241895, "comment_id": 73679435, "body": "So you&#39;re asking why a language that was designed to mess with your brain, is doing exactly that?"}], "answers": [{"comments": [{"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1491748392, "post_id": 43305766, "comment_id": 73680355, "body": "Thanks, I&#39;ll check this on monday when I can reproduce this again."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1491877387, "post_id": 43305766, "comment_id": 73735409, "body": "More testing also revealed that the weird behavior only happens on -O3, when everything gets inlined inside the main function. I double checked the generated assembly and both cases are very similar except that one of the programs has an extra block of code in the middle for the fclose. I ran the programs under <code>perf</code> (thanks for the recommendation, I wasn&#39;t aware of it) and posted the results on an edit to my question. Tomorrow, I&#39;ll try to do some experiments with the alignment, didn&#39;t get a chance to do that yet."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1491883920, "post_id": 43305766, "comment_id": 73736998, "body": "Given the data, that&#39;s almost certainly branch prediction. You can profile to see which branches are getting mispredicted and how often. If something vast majority of the time, you can annotate it with putting the condition within __builtin_expect((condition), 1) (or 0). The real fix consists of having fewer branches though (e.g. maybe you have a branch in a loop, but you can move it outside and have 2 variants of the body instead)."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1491884953, "post_id": 43305766, "comment_id": 73737243, "body": "What can I use to find out what branches are getting mispredicted? <code>perf stat</code> only reports the total number of mispredictions."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 2, "creation_date": 1491984818, "post_id": 43305766, "comment_id": 73789474, "body": "@hugomg Use <code>perf record</code> instead, then <code>perf report --stdio</code>"}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": 3, "last_activity_date": 1491734455, "creation_date": 1491734455, "answer_id": 43305766, "question_id": 43241895, "link": "https://stackoverflow.com/questions/43241895/how-can-i-pinpoint-if-the-slowness-in-my-program-is-a-cpu-cache-issue-on-linux/43305766#43305766", "title": "How can I pinpoint if the slowness in my program is a CPU cache issue (on Linux)?", "body": "<p>First you want to sanity check by disassembling all funcs and making sure the only difference is in main. You can disassemble with objdump -d and hack around to compare with diff.</p>\n\n<p>The addition of fclose pulls in a new symbol (thus part of the file is already modified) and after that the main func is also modified. This in turn changes addresses and offsets.</p>\n\n<p>So the suspicion is that you get excessive cache trashing not present in the previous version of the program.</p>\n\n<p>In your question you state that cachegrind was executed, but it reported 0%. This does not add up. Even if the aforementioned suspicion is incorrect, you are bound to get several misses anyway. Please paste both results.</p>\n\n<p>The canonical tool to play with on linux is perf ( <a href=\"https://perf.wiki.kernel.org/index.php/Tutorial\" rel=\"nofollow noreferrer\">https://perf.wiki.kernel.org/index.php/Tutorial</a> ). Make sure to run it several times as for such short runtimes you will get a lot of variance.</p>\n\n<p>You can play with explicit alignment of both variables and functions by annotating them with</p>\n\n<pre><code>  __attribute__((aligned(64)))\n</code></pre>\n\n<p>Play with the number.</p>\n"}, {"comments": [{"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1491877567, "post_id": 43312899, "comment_id": 73735443, "body": "I don&#39;t think breaking into smaller functions is an option here. After further analysis, it seems that this  weird  behavior only happens on -O3 optimization level, when pretty much the entirety of my code ends up inlined inside the main function. Anyway, I ran my code under perf-tools and posted the resuls as an edit to my question. Do you think we can conclude something based on those numbers?"}, {"owner": {"reputation": 34875, "user_id": 72508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698e94ec61aae18a4cae067ad645b3fb?s=128&d=identicon&r=PG", "display_name": "Jeremy W. Sherman", "link": "https://stackoverflow.com/users/72508/jeremy-w-sherman"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1492010009, "post_id": 43312899, "comment_id": 73809053, "body": "Branch misses are like six times higher in the slow run case. The next question is what branches are being missed so much for virtually the same code. And how much run time is actually attributable to (a) misses and (b) different code paths. You might be able to get line level cost info out of gprof, which might give a very clear picture of where time is being spent."}], "tags": [], "owner": {"reputation": 34875, "user_id": 72508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698e94ec61aae18a4cae067ad645b3fb?s=128&d=identicon&r=PG", "display_name": "Jeremy W. Sherman", "link": "https://stackoverflow.com/users/72508/jeremy-w-sherman"}, "is_accepted": false, "score": 3, "last_activity_date": 1491779533, "creation_date": 1491779533, "answer_id": 43312899, "question_id": 43241895, "link": "https://stackoverflow.com/questions/43241895/how-can-i-pinpoint-if-the-slowness-in-my-program-is-a-cpu-cache-issue-on-linux/43312899#43312899", "title": "How can I pinpoint if the slowness in my program is a CPU cache issue (on Linux)?", "body": "<p>The visible change is a change in timing, so you'd want to start by aiming a time profiler at runs that both exhibit and do not exhibit the behavior to see what changes in where the time is spent. If you're lucky, you can compile for tracing and see what gprof can spit out without perturbing the behavior.</p>\n\n<p>If you truly have just one humongous function making up most of your program, anything that does time roll-up by function is not going to give terribly granular results. In that case, you might try breaking up the one mega-function into a network of smaller functions in order to get more granular time cost statistics.</p>\n\n<p>If you're unlucky, and compiling for profiling makes it so the behavior difference disappears, then skip to profiling kernel function calls (which can be done dynamically) and look for time differences with regard to the kernel function call trace rather than the user function call trace.</p>\n\n<p>Once you know where the time is going, you should have more precise questions to ask and possibly be able to rule out some factors. At that point, you might want to break out <a href=\"https://github.com/brendangregg/perf-tools\" rel=\"nofollow noreferrer\">perf-tools</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1492193500, "post_id": 43380929, "comment_id": 73892740, "body": "Thanks for the math! That is really good evidence that it was the branch prediction all along. And I made some extra tests (see my edits) that indeed suggest that it was just the branch prediction and that memory locality had nothing to do with it."}], "tags": [], "owner": {"reputation": 1138, "user_id": 7520014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcf449b3c969eec0c3ce496b4c8c3d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Apperson", "link": "https://stackoverflow.com/users/7520014/nick-apperson"}, "is_accepted": true, "score": 9, "last_activity_date": 1492187095, "last_edit_date": 1495540946, "creation_date": 1492037903, "answer_id": 43380929, "question_id": 43241895, "link": "https://stackoverflow.com/questions/43241895/how-can-i-pinpoint-if-the-slowness-in-my-program-is-a-cpu-cache-issue-on-linux/43380929#43380929", "title": "How can I pinpoint if the slowness in my program is a CPU cache issue (on Linux)?", "body": "<p><strong>The Key Metric</strong></p>\n\n<p>Your culprit is branch misses:</p>\n\n<pre><code>440,171,927      branch-misses             #   13.85% of all branches\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>71,034,122      branch-misses             #    2.24% of all branches\n</code></pre>\n\n<p>I'm not sure which processor your'e running, but if you are hypothetically running a 2.5 GHz processor on Haswell, you'll see that each branch prediction miss costs around 15 cycles (usually a bit more because other stuff stalls too), and each cycle is 0.4ns. So, 0.4ns/cycle * 15 cycles/missed branch * (440,171,927 - 71,034,122) branch misses = 2.2 seconds. It will depend on your exact processor and the machine code, but this explains the bulk of the difference right there.</p>\n\n<p><strong>Cause</strong></p>\n\n<p>The branch prediction algorithms of different chips are proprietary, but if you research here ( <a href=\"http://www.agner.org/optimize/microarchitecture.pdf\" rel=\"nofollow noreferrer\">http://www.agner.org/optimize/microarchitecture.pdf</a>) you can learn more about different processors and there limitations. Essentially, what you'll find is that certain processors do a better job of avoiding collisions in the branch prediction tables that they store to make predictions about branches taken or not.</p>\n\n<p>So, why is that relevant? Well, what has happened (99% chance) is that by rearranging your program very slightly, you change where exactly different branches are in terms of memory locations. There are too many that map to the same bucket in the branch prediction tables for the processor. By changing the executable slightly, this problem goes away. You have to have a very specific distance between the two branch points to trigger this issue. You have unluckily managed to do that.</p>\n\n<p><strong>Simple Solution</strong></p>\n\n<p>As you found, many changes will in fact cause the program to not hit this degraded performance. Essentially, anything that changes the distance between the two critical branch points will fix the problem. You can accomplish this by literally inserting 16 bytes (or enough to move the branch points to different buckets) of machine code nops somewhere between the two places. You can also do as you did and change something that will disrupt this distance to a non-pathological case.</p>\n\n<p><strong>Digging Deeper</strong></p>\n\n<p>If you want to truly understand what causes it in this situation, you'll need to get your hands dirty. Fun! You will need to select one of many tools to find the specific branch that is being mispredicted. Here is one way: <a href=\"https://stackoverflow.com/questions/33523301/how-to-measure-mispredictions-for-a-single-branch-on-linux\">How to measure mispredictions for a single branch on Linux?</a></p>\n\n<p>After you identify the mispredicted branch, you can figure out if there is a way to remove the branch (almost always a good idea for performance anyway). If not, you can place a hint for it or, worst case, just move things around to ensure that the same entry isn't shared as previously suggested.</p>\n\n<p><strong>Broader lessons</strong></p>\n\n<p>Programmers underestimate the cost of branching (when the compiler is unable to remove the branches at compile time). As you've discovered, each branch puts more strain on the branch prediction buffers of a processor and increases the chance of mispredictions. So, even branches that are 100% predictable to the processor can degrade performance by reducing the resources available for predicting other branches. Further, when a branch is mispredicted, it costs a minimum of 12-15 cycles and can be much more if the needed instructions aren't in the L1 cache, L2 cache, L3 cache, or heaven help you, main memory. Additionally, the compiler can't make all optimizations across branches.</p>\n"}], "owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 6, "accepted_answer_id": 43380929, "answer_count": 3, "score": 11, "last_activity_date": 1492197583, "creation_date": 1491427489, "last_edit_date": 1492197583, "question_id": 43241895, "link": "https://stackoverflow.com/questions/43241895/how-can-i-pinpoint-if-the-slowness-in-my-program-is-a-cpu-cache-issue-on-linux", "title": "How can I pinpoint if the slowness in my program is a CPU cache issue (on Linux)?", "body": "<p>I'm currently trying to understand some very very strange behavior in one of my C programs. Apparently, adding or removing a seemingly inconsequential line at the end of it drastically affects the performance in the rest of the program.</p>\n\n<p>My program looks a bit like this:</p>\n\n<pre><code>int large_buffer[10000];\n\nvoid compute(FILE * input) {\n    for(int i=0; i&lt;100; i++) {\n        do_lots_of_stuff();\n        printf(\".\");\n        fflush(stdout);\n    }\n}\n\nint main() {\n    FILE *input = fopen(\"input.txt\", \"r\");\n    compute(input);\n    fclose(input); // &lt;--- everything gets 2x slower if I comment this out (!)\n    return 0;\n}\n</code></pre>\n\n<p>In theory, that <code>fclose(input)</code> line at the end of the main function should not matter, since the OS should automatically close the file at the end of the program anyway. However I observed that my program took 2.5 seconds to run when I included the fclose statement and 5s when I commented it out. A factor of 2 difference! And this was not due to latency at the start or end of the program: the speed at which the <code>.</code> are printed out is visibly faster in the version with the fclose statement.</p>\n\n<p>I suspect that this might have to do with some memory alignment or cache miss issue. If I replace the fclose with another function such as ftell it also takes 5s to run and if I reduce the size of the <code>large_buffer</code> to &lt;= 8000 elements then it always runs in 2.5 seconds, regardless of the fclose statement being there or not.</p>\n\n<p>But I would really like to be able to 100% sure of what is the culprit behind this strange behavior. Would it be possible to run my program under some sort of profiler or other tool that would give me that information? So far I tried running both versions under <code>valgrind --tool=cachegrind</code> but it reported the same amount of cache miss (0%) for both versions of my program.</p>\n\n<hr>\n\n<p>edit 1: After running both versions of my program under <code>perf stat -d -d -d</code> I got the following results:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> Performance counter stats for './no-fclose examples/bench.o':\n\n       5625.535086      task-clock (msec)         #    1.000 CPUs utilized          \n                38      context-switches          #    0.007 K/sec                  \n                 0      cpu-migrations            #    0.000 K/sec                  \n                54      page-faults               #    0.010 K/sec                  \n    17,851,853,580      cycles                    #    3.173 GHz                      (53.23%)\n     6,421,955,412      stalled-cycles-frontend   #   35.97% frontend cycles idle     (53.23%)\n     4,919,383,925      stalled-cycles-backend    #   27.56% backend cycles idle      (53.23%)\n    13,294,878,129      instructions              #    0.74  insn per cycle         \n                                                  #    0.48  stalled cycles per insn  (59.91%)\n     3,178,485,061      branches                  #  565.010 M/sec                    (59.91%)\n       440,171,927      branch-misses             #   13.85% of all branches          (59.92%)\n     4,778,577,556      L1-dcache-loads           #  849.444 M/sec                    (60.19%)\n           125,313      L1-dcache-load-misses     #    0.00% of all L1-dcache hits    (60.22%)\n            12,110      LLC-loads                 #    0.002 M/sec                    (60.25%)\n   &lt;not supported&gt;      LLC-load-misses                                             \n   &lt;not supported&gt;      L1-icache-loads                                             \n        20,196,491      L1-icache-load-misses                                         (60.22%)\n     4,793,012,927      dTLB-loads                #  852.010 M/sec                    (60.18%)\n               683      dTLB-load-misses          #    0.00% of all dTLB cache hits   (60.13%)\n             3,443      iTLB-loads                #    0.612 K/sec                    (53.38%)\n                90      iTLB-load-misses          #    2.61% of all iTLB cache hits   (53.31%)\n   &lt;not supported&gt;      L1-dcache-prefetches                                        \n            51,382      L1-dcache-prefetch-misses #    0.009 M/sec                    (53.24%)\n\n       5.627225926 seconds time elapsed\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code> Performance counter stats for './yes-fclose examples/bench.o':\n\n       2652.609254      task-clock (msec)         #    1.000 CPUs utilized          \n                15      context-switches          #    0.006 K/sec                  \n                 0      cpu-migrations            #    0.000 K/sec                  \n                57      page-faults               #    0.021 K/sec                  \n     8,277,447,108      cycles                    #    3.120 GHz                      (53.39%)\n     2,453,171,903      stalled-cycles-frontend   #   29.64% frontend cycles idle     (53.46%)\n     1,235,728,409      stalled-cycles-backend    #   14.93% backend cycles idle      (53.53%)\n    13,296,127,857      instructions              #    1.61  insn per cycle         \n                                                  #    0.18  stalled cycles per insn  (60.20%)\n     3,177,698,785      branches                  # 1197.952 M/sec                    (60.20%)\n        71,034,122      branch-misses             #    2.24% of all branches          (60.20%)\n     4,790,733,157      L1-dcache-loads           # 1806.046 M/sec                    (60.20%)\n            74,908      L1-dcache-load-misses     #    0.00% of all L1-dcache hits    (60.20%)\n            15,289      LLC-loads                 #    0.006 M/sec                    (60.19%)\n   &lt;not supported&gt;      LLC-load-misses                                             \n   &lt;not supported&gt;      L1-icache-loads                                             \n           140,750      L1-icache-load-misses                                         (60.08%)\n     4,792,716,217      dTLB-loads                # 1806.793 M/sec                    (59.93%)\n             1,010      dTLB-load-misses          #    0.00% of all dTLB cache hits   (59.78%)\n               113      iTLB-loads                #    0.043 K/sec                    (53.12%)\n               167      iTLB-load-misses          #  147.79% of all iTLB cache hits   (53.44%)\n   &lt;not supported&gt;      L1-dcache-prefetches                                        \n            29,744      L1-dcache-prefetch-misses #    0.011 M/sec                    (53.36%)\n\n       2.653584624 seconds time elapsed\n</code></pre>\n\n<p>Looks like there were few data-cache misses in both cases, as kcachegrind had reported, but the slower version of the program had worse branch prediction and  more instruction cache misses and iTLB loads. Which of these differences would be the most likely to be responsible for the 2x difference in runtime between the test cases?</p>\n\n<hr>\n\n<p>edit 2: Fun fact, apparently I can still keep the strange behavior if I replace the \"fclose\" call by a single NOP instruction.</p>\n\n<hr>\n\n<p>edit 3: My processor is an Intel i5-2310 (Sandy Bridge)</p>\n\n<hr>\n\n<p>Edit 4: Turns out that if I resize the arrays by editing the assembly file it does <em>not</em> get faster. Apparetly the reason it got faster when I changed their sizes in the C code was because gcc decided to rearange the order of the stuff in the binary.</p>\n\n<hr>\n\n<p>Edit 5: More evidence that what matters was the precise addresses of the JMP instructions: If I add a single NOP (instead of a printf) at the start of my code it gets faster. Similarly, if I remove an useless instruction from the start of my code it also gets faster. And when I compiled my code on a different version of gcc it also got faster, despite the generated assembly code being the same. The only difference was debug info at the start and that the sections of the binary file were in a different order.</p>\n"}, {"tags": ["c", "linux", "signals", "fgets"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491427387, "post_id": 43241779, "comment_id": 73553917, "body": "<code>volatile</code> is not sufficient for multithreaded programming. Use atomics."}, {"owner": {"reputation": 125, "user_id": 7067958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XaJ9e.jpg?s=128&g=1", "display_name": "sbstnssndn", "link": "https://stackoverflow.com/users/7067958/sbstnssndn"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491428628, "post_id": 43241779, "comment_id": 73554424, "body": "I actually don&#39;t know how to do that. I&#39;ve been struggling to get to this point and I know some things just partially."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491458041, "post_id": 43241779, "comment_id": 73562907, "body": "@Olaf: signals are not threads.  <code>volatile</code> is sufficient."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1491486324, "post_id": 43241779, "comment_id": 73582649, "body": "@BenVoigt: I wonder why there is <code>sig_atomic_t</code> with additional guarantees then. Interestingly this type existed <i>before</i> C11&#39;s atomics support already. Note: <code>volatile</code> does not guarantee atomic access."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1491458070, "post_id": 43246738, "comment_id": 73562928, "body": "This doesn&#39;t help with signal handling, which is the point of the question."}, {"owner": {"reputation": 125, "user_id": 7067958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XaJ9e.jpg?s=128&g=1", "display_name": "sbstnssndn", "link": "https://stackoverflow.com/users/7067958/sbstnssndn"}, "edited": false, "score": 0, "creation_date": 1491463869, "post_id": 43246738, "comment_id": 73566275, "body": "CTRL+D is not actually a signal, so that doesn&#39;t help me in this case. But I already solved it, thanks anyway."}], "tags": [], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1491457950, "creation_date": 1491457950, "answer_id": 43246738, "question_id": 43241779, "link": "https://stackoverflow.com/questions/43241779/how-to-stop-reading-from-keyboard-once-a-signal-is-handled/43246738#43246738", "title": "How to stop reading from keyboard once a signal is handled?", "body": "<p>You get a NULL from fgets when it reaches EOF. From the keyboard, that's usually signalled with CTRL-D (Linux/Unix/MacOS X) or CTRL-Z (DOS/Windows and I think MacOS before X)</p>\n"}, {"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 1, "last_activity_date": 1491458417, "last_edit_date": 1592644375, "creation_date": 1491458417, "answer_id": 43246858, "question_id": 43241779, "link": "https://stackoverflow.com/questions/43241779/how-to-stop-reading-from-keyboard-once-a-signal-is-handled/43246858#43246858", "title": "How to stop reading from keyboard once a signal is handled?", "body": "<p>The Linux manual page for signals says that</p>\n<blockquote>\n<p><strong>Interruption of system calls and library functions by signal handlers</strong></p>\n<p>If a signal handler is invoked while a system call or library function call is blocked, then either:</p>\n<ul>\n<li><p>the call is automatically restarted after the signal handler returns; or</p>\n</li>\n<li><p>the call fails with the error <code>EINTR</code>.</p>\n</li>\n</ul>\n<p>Which of these two behaviors occurs depends on the interface and whether or not the signal handler was established using the <code>SA_RESTART</code> flag (see <code>sigaction</code>(2)).</p>\n</blockquote>\n<p>You may use either the <code>siginterrupt()</code> function together with <code>signal()</code>, or use <code>sigaction()</code> instead of <code>signal()</code> for registering your signal handler, in order to disable restarting a <code>read()</code> system call after a signal.</p>\n<p>Note however that <code>fgets()</code> from the C library might call <code>read()</code> multiple times until a newline character is found, therefore you may also need to switch to using the lower-level functions instead of <code>stdio.h</code> APIs.</p>\n"}], "owner": {"reputation": 125, "user_id": 7067958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XaJ9e.jpg?s=128&g=1", "display_name": "sbstnssndn", "link": "https://stackoverflow.com/users/7067958/sbstnssndn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1562, "favorite_count": 0, "accepted_answer_id": 43246858, "answer_count": 2, "score": 1, "last_activity_date": 1491458417, "creation_date": 1491426990, "question_id": 43241779, "link": "https://stackoverflow.com/questions/43241779/how-to-stop-reading-from-keyboard-once-a-signal-is-handled", "title": "How to stop reading from keyboard once a signal is handled?", "body": "<p>I'm writing a program where the SIGINT signal is handled the first time it is sent, but set to default after that. So, for example, I have this:</p>\n\n<pre><code>static volatile int stop_terminating = 1;\n\nvoid handler(int dummy) {\n    stop_terminating = 0;\n}\n\nint main(){\n    signal(SIGINT, handler);\n    char input[256];\n    while(1){\n        if(stop_terminating == 0){\n            // reset the action of the signal to default\n            signal(SIGINT, SIG_DFL);\n            printf(\"Message sent.\\n\");\n            // increment counter so it doesn't enter this condition again\n            stop_terminating++;\n        }\n        printf(\"User input:\\n\");\n        fgets(input, sizeof(input), stdin);\n        // In this stage, I wanna press CTRL+C and print a message, stopping the fgets\n        // but what happens is: I press CTRL+C, the signal is catched, but fgets\n        // is still asking for an input, and after I send something, the my message is printed\n        // because it looped through the while(1) again.\n    }\n}\n</code></pre>\n\n<p>How can I stop fgets from asking for an input and just print the message and then ask again for an input?</p>\n"}, {"tags": ["c++", "c", "winapi"], "comments": [{"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491426978, "post_id": 43241627, "comment_id": 73553735, "body": "why vote my post - ?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491426997, "post_id": 43241627, "comment_id": 73553745, "body": "How do you know it worked if you don&#39;t check the returned value?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1491427036, "post_id": 43241627, "comment_id": 73553760, "body": "This could change at any time. Memory is allocated and deallocation dynamically. What are you trying to do."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491427071, "post_id": 43241627, "comment_id": 73553776, "body": "I mean, the above code looks just like an MSDN dump..."}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491427122, "post_id": 43241627, "comment_id": 73553801, "body": "hi David Heffernan , i know its change - i just want to get the last offset"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491427219, "post_id": 43241627, "comment_id": 73553845, "body": "hi ThingyWotsit - i just try to make it sample and short"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491427397, "post_id": 43241801, "comment_id": 73553926, "body": "hi , &quot;here are much better IPC APIs to do these things!&quot; ?? like what ?"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491427686, "post_id": 43241801, "comment_id": 73554065, "body": "It depends on what you have to do... if you have to just exchange data between two processes, you have shared memories, pipes, sockets, and many others..."}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491427969, "post_id": 43241801, "comment_id": 73554171, "body": "no no - i just want to get last ( used ) offset  of processmemory  - nothing else"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491428224, "post_id": 43241801, "comment_id": 73554276, "body": "but inside your process or inside another process??"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491428445, "post_id": 43241801, "comment_id": 73554356, "body": "another process - readprocess its work great ! now you know what i want - yes ? - see the picture  : <a href=\"https://i.stack.imgur.com/ukpZq.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/ukpZq.png</a>"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491429059, "post_id": 43241801, "comment_id": 73554593, "body": "I repeat that unless you are writing a debugger or similar, you probably on the wrong way... anyway, you could try with VirtualQueryEx to inspect the allocated memory. See here <a href=\"https://www.codeproject.com/kb/threads/mdumpall.aspx\" rel=\"nofollow noreferrer\">codeproject.com/kb/threads/mdumpall.aspx</a> and also <a href=\"http://stackoverflow.com/questions/10372872/read-process-memory-of-a-process-does-not-return-everything\" title=\"read process memory of a process does not return everything\">stackoverflow.com/questions/10372872/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491429271, "post_id": 43241801, "comment_id": 73554691, "body": "if you mean &quot;si.lpMaximumApplicationAddress&quot; - its for max address     &gt;&gt;&gt;&gt;&gt;its not for last address used"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491429428, "post_id": 43241801, "comment_id": 73554769, "body": "no that is the maximum address for your system, like 2^32 if you have 4GB of RAM or something like that. See <a href=\"http://stackoverflow.com/questions/10372872/read-process-memory-of-a-process-does-not-return-everything\" title=\"read process memory of a process does not return everything\">stackoverflow.com/questions/10372872/&hellip;</a> where it uses info.RegionSize"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491429605, "post_id": 43241801, "comment_id": 73554841, "body": "ok tnx - i will see it - and try it and will back to you - tnx again man"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491430000, "post_id": 43241801, "comment_id": 73554988, "body": "please upvote and mark resolved if you found an answer :-)"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491430184, "post_id": 43241801, "comment_id": 73555043, "body": "i stil trying to understand how use it - if its work - i will mark it"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491438958, "post_id": 43241801, "comment_id": 73557563, "body": "can i use it to find string without check all process memory ? - how ?"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491461872, "post_id": 43241801, "comment_id": 73564988, "body": "<a href=\"http://stackoverflow.com/questions/28231054/how-can-i-search-for-a-string-in-the-memory-of-another-process\" title=\"how can i search for a string in the memory of another process\">stackoverflow.com/questions/28231054/&hellip;</a>  and   <a href=\"http://stackoverflow.com/questions/36878017/searching-for-every-occurrence-of-a-string-in-another-processs-memory\" title=\"searching for every occurrence of a string in another processs memory\">stackoverflow.com/questions/36878017/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491588827, "post_id": 43241801, "comment_id": 73637456, "body": "man - its long code to i want - i need to a small code to do what is ask - to can understand it . and what is VirtualQueryEx is do ???"}, {"owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "reply_to_user": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491645457, "post_id": 43241801, "comment_id": 73652372, "body": "just take the answer here <a href=\"http://stackoverflow.com/questions/28231054/how-can-i-search-for-a-string-in-the-memory-of-another-process\" title=\"how can i search for a string in the memory of another process\">stackoverflow.com/questions/28231054/&hellip;</a>, you have a working solution. Smaller than this is not possible. Life of a programmer is hard, man."}, {"owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "edited": false, "score": 0, "creation_date": 1491660309, "post_id": 43241801, "comment_id": 73656863, "body": "ok i want to understand how code work ? - it is for find variable or find string or what ?? - what is VirtualQueryEx do ?"}], "tags": [], "owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "is_accepted": false, "score": 0, "last_activity_date": 1491427092, "creation_date": 1491427092, "answer_id": 43241801, "question_id": 43241627, "link": "https://stackoverflow.com/questions/43241627/c-how-to-find-last-offset-adress-used-in-processmemory-with-use-readproces/43241801#43241801", "title": "C++ how to find last (offset - adress) used in processmemory with use readprocessmemory", "body": "<p>Well it MAY work if you are absolutely sure that you CAN read the memory of the other process... anyway it is a quite dangerous method, there are much better IPC APIs to do these things!</p>\n\n<p>Unless you are writing a debugger yourself... in fact ReadProcessMemory is cited here \"Process Functions for Debugging\" <a href=\"https://msdn.microsoft.com/it-it/library/windows/desktop/ms680549(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/it-it/library/windows/desktop/ms680549(v=vs.85).aspx</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5807813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e309e6b0c9889985b8baa5b09183a55?s=128&d=identicon&r=PG&f=1", "display_name": "king of the king", "link": "https://stackoverflow.com/users/5807813/king-of-the-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1491428972, "creation_date": 1491426388, "last_edit_date": 1491428972, "question_id": 43241627, "link": "https://stackoverflow.com/questions/43241627/c-how-to-find-last-offset-adress-used-in-processmemory-with-use-readproces", "title": "C++ how to find last (offset - adress) used in processmemory with use readprocessmemory", "body": "<p>i use this code to <code>readprocessmemory</code>  :</p>\n\n<pre><code>  BOOL WINAPI ReadProcessMemory(\n    _In_  HANDLE  hProcess,\n    _In_  LPCVOID lpBaseAddress,\n    _Out_ LPVOID  lpBuffer,\n    _In_  SIZE_T  nSize,\n    _Out_ SIZE_T  *lpNumberOfBytesRead\n    );\nchar value[5]; \nHANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, 0, 6500);\n{\n    ReadProcessMemory(hProcess, (LPVOID)105477, value, 5, 0);\n}\n</code></pre>\n\n<h2>its work 100%</h2>\n\n<p>but i want to know how know last Offset used in processmemory - before i read it</p>\n\n<p>see the picture : <a href=\"https://i.stack.imgur.com/ukpZq.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>the last offset in this processmemory is 7FFE0FFF - but how can i get it before i  read the processmemory</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491426363, "post_id": 43241594, "comment_id": 73553448, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1491426872, "post_id": 43241594, "comment_id": 73553677, "body": "You didn&#39;t show any code calling <code>free</code>, which the error message seems to have come from. We also don&#39;t know what <code>tmp</code>, <code>field</code> and some other things are. Please post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1491426953, "post_id": 43241594, "comment_id": 73553720, "body": "<code>data[i] = value;</code> is copying a pointer to the same input string whose content gets overwritten in every loop. Try the non-standard <code>data[i] = strdup(value);</code> which might fix it. The function <code>strdup</code> calls <code>malloc</code> so you&#39;ll have to <code>free</code> each element of the array of pointers later."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491426972, "post_id": 43241594, "comment_id": 73553731, "body": "is it segfault, &quot;malloc error for object .., pointer being freed is not allocated&quot;, or both alternatively with a 43% probability for the segfault ? :) anyway your code is very very buggy."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491427145, "post_id": 43241594, "comment_id": 73553812, "body": "@WeatherVane +1 if OP tries to free the pointers of the array, that could explain a lot because freeing auto (invalidated) memory is rarely appreciated by the system."}, {"owner": {"reputation": 901, "user_id": 1030294, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a6d23ebc68b11282abea7c0d51ded53d?s=128&d=identicon&r=PG", "display_name": "marc", "link": "https://stackoverflow.com/users/1030294/marc"}, "edited": false, "score": 0, "creation_date": 1491427248, "post_id": 43241594, "comment_id": 73553860, "body": "I free the  data[][], I&#39;ve modified the code"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491427303, "post_id": 43241594, "comment_id": 73553882, "body": "@kris and that is why we always ask for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>..."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1491427593, "post_id": 43241594, "comment_id": 73554031, "body": "In C, it is not appropriate to use assert to check the return value of a function.  <code>assert</code> is for things which are logically necessary.   <code>fopen</code> can return NULL, and it is not correct to <code>assert</code> otherwise."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491427743, "post_id": 43241594, "comment_id": 73554095, "body": "Allocate and copy: <code>data[i] = strdup(value);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1491426619, "post_id": 43241662, "comment_id": 73553560, "body": "Very true, I was that too. But isn&#39;t there other errors? like number of lines too low (ok: telepathy :))? because the &quot;pointer being freed&quot; is probably not because of that error. Well, you never know with UB :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491426755, "post_id": 43241662, "comment_id": 73553626, "body": "@Jean-Fran&#231;oisFabre Does the expansion cover this, or you meant anything else? :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1491426901, "post_id": 43241662, "comment_id": 73553689, "body": "your answer is well documented (and you got my vote). I was just wondering if OP gets segfault or &quot;malloc error for object .., pointer being freed is not allocated&quot;, which could only occur when freeing memory, and probably not because of a printf present or not. Memory corruption + free can lead to that all right."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491426960, "post_id": 43241662, "comment_id": 73553725, "body": "@Jean-Fran&#231;oisFabre Agreed, but with this snippet, above is what we got. :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491427079, "post_id": 43241662, "comment_id": 73553782, "body": "Weather Vane has a point when he says that OP puts a local array in the pointer array (and the same array!!) so probably crashes when attempting to free the pointers in the array when they haven&#39;t been allocated in the firtst place."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491427238, "post_id": 43241662, "comment_id": 73553851, "body": "@Jean-Fran&#231;oisFabre Very probable, my answer just follows the comment present in OP&#39;s snippet, whatever is shown here."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491427272, "post_id": 43241662, "comment_id": 73553865, "body": "@Jean-Fran&#231;oisFabre and there you go...check OP&#39;s edit. :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491427490, "post_id": 43241662, "comment_id": 73553982, "body": "crystal ball strikes again :) also <code>data</code> isn&#39;t even valid memory since it copied an auto variable which went out of scope. You can add that (but I cannot upvote once more :))"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1491427389, "last_edit_date": 1495539999, "creation_date": 1491426511, "answer_id": 43241662, "question_id": 43241594, "link": "https://stackoverflow.com/questions/43241594/malloc-error-when-reading-from-file/43241662#43241662", "title": "Malloc error when reading from file", "body": "<p>The problem as I see it is, before</p>\n\n<pre><code>  printf(\"%s %s\\n\", value, data[i]);\n</code></pre>\n\n<p>this line, you're doing <code>i++</code> which changes the value of <code>i</code>. Then <code>data[i]</code> points to an uninitialized memory. Passing that as argument to <code>%s</code> causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>[<em>Edit:</em>]</p>\n\n<p>Then again, you're doing</p>\n\n<pre><code> free(data[i]);\n</code></pre>\n\n<p>whereas, <code>data[i]</code> is not a pointer returned by a memory allocator function. That's another cause for UB.</p>\n\n<p>That said, </p>\n\n<ul>\n<li>You never bound <code>i</code> with <code>lines</code>, which is the one-over the maximum allowed index. You need to keep a check such that <code>i &lt; lines</code> satisfies at all times.</li>\n<li>You did not check for the success of <code>sscanf()</code> call, failure to this call may lead to reading of invalid memory too.</li>\n<li><a href=\"https://stackoverflow.com/q/605845/2173917\">See this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>. You should also check for the success of <code>malloc()</code> before dereferencing the returned pointer.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 1030294, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a6d23ebc68b11282abea7c0d51ded53d?s=128&d=identicon&r=PG", "display_name": "marc", "link": "https://stackoverflow.com/users/1030294/marc"}, "edited": false, "score": 1, "creation_date": 1491435238, "post_id": 43242026, "comment_id": 73556603, "body": "Thanks, accepting this answer as it has example to understand better."}], "tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": true, "score": 0, "last_activity_date": 1491428052, "creation_date": 1491428052, "answer_id": 43242026, "question_id": 43241594, "link": "https://stackoverflow.com/questions/43241594/malloc-error-when-reading-from-file/43242026#43242026", "title": "Malloc error when reading from file", "body": "<p>The direct cause of the observed error is:</p>\n\n<pre><code>char value[256];\n//....\ndata[i] = value;\n</code></pre>\n\n<p>and later (in a subsequent loop):</p>\n\n<pre><code>free(data[i]);\n</code></pre>\n\n<p>You are freeing the statically allocated array.</p>\n\n<p>You want:</p>\n\n<pre><code>char *value=malloc(sizeof(char)*256);\n</code></pre>\n\n<p>I know <code>sizeof(char)==1</code> by definition. It's just good practice.</p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 1030294, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a6d23ebc68b11282abea7c0d51ded53d?s=128&d=identicon&r=PG", "display_name": "marc", "link": "https://stackoverflow.com/users/1030294/marc"}, "edited": false, "score": 0, "creation_date": 1491435194, "post_id": 43242031, "comment_id": 73556592, "body": "Excellent ! Thanks for a detailed explanation."}], "tags": [], "owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "is_accepted": false, "score": 0, "last_activity_date": 1491428075, "creation_date": 1491428075, "answer_id": 43242031, "question_id": 43241594, "link": "https://stackoverflow.com/questions/43241594/malloc-error-when-reading-from-file/43242031#43242031", "title": "Malloc error when reading from file", "body": "<p>Declaring <code>char value[256]</code> reserves some room on the function stack. Your <code>data[i]</code> keeps pointing to that same place on the stack, for different <code>i</code>. Note that you have a possible overflow problem on the stack when <code>value</code> is too small, unless there is a fixed limit to its size. This stack region is not alloced so cannot be freed, hence the error.</p>\n\n<p>A consequence is that <code>data[i]</code> gets overwitten by all further lines after its first asignment. You get a (non-freeable) pointer to the same region every time. You need to copy that value to tyour own pointer:. What you also need to do is free the variable <code>line</code> in the end (as it gets a malloc-ed pointer value and gets realloc-ed to make it fit the line.), and for every line do a <code>malloc</code> to make a pointer to <em>copy</em> <code>value</code> into and set <code>data[i]</code> to that new pointer. So there are all sorts of problems in your code.</p>\n"}], "owner": {"reputation": 901, "user_id": 1030294, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a6d23ebc68b11282abea7c0d51ded53d?s=128&d=identicon&r=PG", "display_name": "marc", "link": "https://stackoverflow.com/users/1030294/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 43242026, "answer_count": 3, "score": -1, "last_activity_date": 1491428075, "creation_date": 1491426253, "last_edit_date": 1491427199, "question_id": 43241594, "link": "https://stackoverflow.com/questions/43241594/malloc-error-when-reading-from-file", "title": "Malloc error when reading from file", "body": "<p>I have a file with each line of strings is in this format</p>\n\n<pre><code>key1 = value1\nkey2 = value2\n....\n</code></pre>\n\n<p>I need to extract the strings in third column. The code I've written so far is</p>\n\n<pre><code>    fp = fopen(file, \"r\");\n    assert(fp &amp;&amp; \"checkpoint file not found  \\n\");\n\n    char **data = (char **) malloc(sizeof (char*) * lines ); // lines=100\n    size_t i = 0;\n\n    while ((read = getline(&amp;line, &amp;len, fp)) != -1){\n        size_t l = strlen(line);\n\n        char value[256];\n        sscanf( line, \"%s %s %s\", field, tmp, value); // field stores 'key1', tmp stores '+', value stores 'value1'\n\n        data[i] = value;\n        i++;\n        printf(\"%s \\n\", value);\n        // printf(\"%s %s\\n\", value, data[i]); -- when this line is uncommented, it leads to a seg-fault.\n    }\n    fclose(fp);\n\n\n      for (int i=0; i &lt; lines; ++i)\n        free(data[i]);\n      free(data);\n</code></pre>\n\n<p>I get an error \"malloc error for object .., pointer being freed is not allocated\".</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1491425623, "post_id": 43241399, "comment_id": 73553012, "body": "<code>tk[i] = token;</code> your copy of the string <code>char a[size];</code> is in automatic storage. So after return, your tk array will contain pointers to this old memory."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1491425680, "post_id": 43241399, "comment_id": 73553044, "body": "The return value of <code>strtok</code> is a pointer into the string being parsed.  Since <code>a</code>&#39;s lifetime is limited to <code>boom</code>, so are the pointers you&#39;re copying into <code>tk</code>."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1491425731, "post_id": 43241399, "comment_id": 73553073, "body": "Also, <code>boom</code> never changes <code>lng</code>, so the <code>for</code> loop tries to print <code>LENGTH</code> strings even if you found fewer."}, {"owner": {"reputation": 11, "user_id": 7823098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2a2b737d178b1749339278b5c0bd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Kosale", "link": "https://stackoverflow.com/users/7823098/kosale"}, "edited": false, "score": 0, "creation_date": 1491425901, "post_id": 43241399, "comment_id": 73553167, "body": "so I should memcpy(tk[i], token, strlen(token)+1) ?"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1491425705, "creation_date": 1491425705, "answer_id": 43241449, "question_id": 43241399, "link": "https://stackoverflow.com/questions/43241399/c-i-keep-getting-segmantation-fault-with-strtok/43241449#43241449", "title": "C - I keep getting segmantation fault with strtok()", "body": "<p>You let <code>strtok</code> operate on local variable <code>char a[size]</code>, so <code>char* token = strtok(a, d)</code> will point into memory allocated on the stack. Once function <code>boom</code> has finished, this memory will not be valid any more, and that's the reason for the segfault.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1491427400, "last_edit_date": 1491427400, "creation_date": 1491425827, "answer_id": 43241478, "question_id": 43241399, "link": "https://stackoverflow.com/questions/43241399/c-i-keep-getting-segmantation-fault-with-strtok/43241478#43241478", "title": "C - I keep getting segmantation fault with strtok()", "body": "<p><code>char a[size];</code> is an array allocated with automatic storage duration, meaning once you return from that function, <code>a</code> is deallocated. Since you use <code>a</code> rather than <code>line</code> with <code>strtok</code>, the value returned by function <code>boom</code> is an array of pointers to a section of memory that is no longer able to be accessed.</p>\n\n<p>Edit: <code>strtok</code> is meant to work with writable strings, so <code>char * string = \"...\";</code> in your <code>main</code> function isn't really correct (string literals are not writable), which is probably why you need <code>a</code> in the first place. If you use <code>char string[] = \"...\";</code> instead, things will work without any need for array <code>a</code> because the characters in the string literal would be copied to an array of sufficient size. You'd simply use <code>line</code> instead of <code>a</code> in your <code>boom</code> function.</p>\n\n<p>If you want it to work with read-only strings as well, you'd need to also allocate every item in the <code>tk</code> array as an array of <code>char</code> (i.e. <code>tk[i] = malloc(toklen * sizeof *tk[i]);</code> in a loop over i=0 to <code>tksize</code>):</p>\n\n<pre><code>char ** boom(char * line, int * lng){\n    size_t toklen;\n    int tksize = *lng;\n    const char d[2] = \" \";\n\n    char ** tk = (char**) malloc(tksize*sizeof(char*));\n    int i=0;\n    char* token = line;\n    while(*token!=0){\n        toklen = strcspn(token, d) + 1;\n        tk[i] = malloc(toklen * sizeof *tk[i]);\n        memcpy(tk[i], token, toklen * sizeof *tk[i]);\n        i++;\n        token += toklen;\n        token += strspn(token, d);\n    }\n    // If we don't use the entire array, set the length.\n    *lng = i;\n    return tk;\n }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7823098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2a2b737d178b1749339278b5c0bd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Kosale", "link": "https://stackoverflow.com/users/7823098/kosale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491427400, "creation_date": 1491425449, "question_id": 43241399, "link": "https://stackoverflow.com/questions/43241399/c-i-keep-getting-segmantation-fault-with-strtok", "title": "C - I keep getting segmantation fault with strtok()", "body": "<p>I want to make a function that takes a char *, tokenizes it with strtok() and returns a char ** with all the arguements. I keep getting the Segmentation Fault error every time I try to execute.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\n\n#define LENGTH  10\n\nchar ** boom(char * line, int * lng){\n    size_t size = strlen(line )+1;\n    int tksize = *lng;\n    const char d[2] = \" \";  \n    char a[size];\n    memcpy(a, line , size);\n\n    char ** tk = (char**) malloc(tksize*sizeof(char*));\n    int i=0;\n    char* token = strtok(a, d);\n    while(token!=NULL){\n        tk[i] = token;\n        i++;        \n        token = strtok(NULL, d);\n    }\n    return tk;\n }\n\nint main(void){\n\n    int i, lng = LENGTH;\n    char * string = \"this is a beutiful message.\\0\";\n    char ** tk = boom(string , &amp;lng);\n\n    for (i=0; i&lt;lng; i++){  \n        printf(\"%s\\n\", tk[i]);      \n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I need the return type of boom() to be char** so I haven't used a return type of char * []. I suspect it's something the the char** malloc.Thanks for your help.</p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "edited": false, "score": 0, "creation_date": 1491427846, "post_id": 43241238, "comment_id": 73554130, "body": "If you want to have communication between two processes, look into IPC, i.e., pipes or sockets.  Look at <a href=\"http://stackoverflow.com/questions/5285414/signal-queuing-in-c\">signal queuing in C</a>"}], "owner": {"reputation": 21, "user_id": 7823014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a181da91d2f4fef77a99efdf2bde2315?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Wator", "link": "https://stackoverflow.com/users/7823014/greg-wator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1491424865, "creation_date": 1491424865, "question_id": 43241238, "link": "https://stackoverflow.com/questions/43241238/c-real-time-signals-are-not-received-correctly", "title": "C Real time signals are not received correctly", "body": "<p>I write some code, which should works as follow: I am creating a child process, then send to him N real time signals (e.g. SIGRTMIN) and after it other real time signal (e.g. SIGRTMAX). Child process should have suitable signal handler which send back SIGRTMIN signals, and after SIGRTMAX, he should end. My problem is, if I send to child 10 signals, one time i receive in parent 10 signals , one time 0 and one time just 1 signal. I expect to receive always as many signals as I send. Can somebody please advice? \nParent:</p>\n\n<pre><code>#define _BSD_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nint requests, child_pid, income_signal_counter = 0;\nstruct sigaction new;\nunion sigval sigval_tmp;\n\n\nvoid generateChild(){\n    int pid = fork();\n    if (pid == 0){\n        if(execvp(\"./child\", NULL) == -1){\n            printf(\"Sth goes wrong\\n\");\n            exit(1);\n        }\n        exit(0);\n    }else if(pid &gt; 0){\n        usleep(100000);\n        child_pid = pid;\n    }\n}      \n\nvoid sendSignalsByKillWithRTSignals(){\n    int signal_sent = 0;\n    for(int i =0; i&lt;requests; i++){\n        if(kill(child_pid, SIGRTMIN)== 0){\n            signal_sent ++;\n        }\n    }\n    printf(\"(parent)Wyslanych sygnalow SIGRTMIN: %d\\n\", signal_sent);\n    kill(child_pid, SIGRTMAX);\n}\n  void RTMinSignalHandler(){\n    income_signal_counter++;\n   // printf(\"(parent)Liczba otrzymanych SIGRTMIN: %d/%d\\n\", income_signal_counter, requests);\n}\n\n\nint main(int argc, char *argv[]){\n    requests = atoi(argv[1]);\n    int  func_type = atoi(argv[2]);\n\n    generateChild();\n    struct sigaction new;\n    new.sa_handler = &amp;RTMinSignalHandler;\n    new.sa_flags = 0;\n    sigaction(SIGRTMIN, &amp;new, NULL);\n\n\n    sendSignalsByKillWithRTSignals();\n\n    int wstatus;\n    wait(&amp;wstatus);\n    if(WIFEXITED(wstatus) &amp;&amp; WEXITSTATUS(wstatus) != 0){\n        printf(\"Proces potomny zdechl\\n\");\n        exit(2);\n    }\n\n    printf(\"(parent)Signal SIGRTMIN received: %d/%d\\n\", income_signal_counter, requests);\n    return 0;\n}\n</code></pre>\n\n<p>Child:</p>\n\n<pre><code>#define _BSD_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n\nvolatile int parent_id;\n\nvoid signalHandler(int signal){\n    kill(parent_id, signal);\n}\n\nvoid exitSignalHandler(int signal){\n    _exit(0); \n}\n\nint main(int argc, char *argv[]){\n    parent_id = getppid();\n    struct sigaction new;\n\n    new.sa_handler = &amp;signalHandler;\n    new.sa_flags = 0;\n    sigaction(SIGRTMIN, &amp;new, NULL);\n\n    new.sa_handler = &amp;exitSignalHandler;\n    new.sa_flags = 0;\n    sigaction(SIGRTMAX, &amp;new, NULL);\n\n    while(1){\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "math", "floating-point"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1491424108, "post_id": 43240983, "comment_id": 73552196, "body": "cannot reproduce with gcc 4.9.4. I get 0.000000. Have you tried swapping <code>a</code> and <code>b</code> values? swapping values gives me <code>-0.0000000</code> BTW."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491424279, "post_id": 43240983, "comment_id": 73552283, "body": "no-repro on gcc 5.4.0 either."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 3, "creation_date": 1491424331, "post_id": 43240983, "comment_id": 73552301, "body": "+0 and -0 compare equal in IEEE-754, so this implementation is probably just picking an arbitrary argument as its output."}, {"owner": {"reputation": 63083, "user_id": 471795, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b2bd81c28bcafeea19ac72e554859ec0?s=128&d=identicon&r=PG", "display_name": "kanaka", "link": "https://stackoverflow.com/users/471795/kanaka"}, "edited": false, "score": 0, "creation_date": 1491424500, "post_id": 43240983, "comment_id": 73552383, "body": "I&#39;m using gcc 5.4.0 (64-bit)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491424582, "post_id": 43240983, "comment_id": 73552431, "body": "MSVC reports <code>0.000000</code> no matter which way round."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491425671, "post_id": 43240983, "comment_id": 73553038, "body": "@weathervane I&#39;d like to have a robust conversation with the team that decided on that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425793, "post_id": 43240983, "comment_id": 73553116, "body": "@Bathsheba you mean the team should not have written code to make <code>+0.000000</code> greater than <code>-0.000000</code>, thus avoiding questions like this?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425909, "post_id": 43240983, "comment_id": 73553175, "body": "I mean the first argument should be returned in the case of equality. I wish that made it into the C and C++ standards."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491426150, "post_id": 43240983, "comment_id": 73553317, "body": "@Bathsheba if they are truly <b>identical</b> as distinct from <b>same value</b>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491427642, "post_id": 43240983, "comment_id": 73554054, "body": "@Bathsheba I do not understand why it matters <i>which</i> argument is returned if their values are equal. Sounds like nonsense to me."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491446610, "post_id": 43240983, "comment_id": 73559422, "body": "@WeatherVane Try <code>atan2(+0.0, -1.0)</code> vs. <code>atan2(-0.0, -1.0)</code> for a candidate difference. Not specified to be different by C, but by other various FP standards."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491489475, "post_id": 43240983, "comment_id": 73585313, "body": "@chux yes, <code>atan2</code> uses the arguments&#39; sign to determine the quadrant. Similarly <code>atan2(-0.0, +1.0)</code> returns <code>-0.000000</code> and this is the only way I have found so far to obtain the &quot;minus zero&quot; value, apart from assigning it directly as in the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491490408, "post_id": 43240983, "comment_id": 73586035, "body": "@WeatherVane &quot;... only way I have found so far to obtain the &quot;minus zero&quot; value&quot; might make for an interesting post for terse alternatives.  <code>strtod(&quot;-0&quot;,...)</code> should work too.  Maybe <code>1&#47;log(0)</code> or <code>-DBL_TRUE_MIN&#47;256</code> or <code>...</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491502132, "post_id": 43240983, "comment_id": 73593968, "body": "@chux <code>scanf</code> too, but <code>-1.0 - -1.0</code> does not. If a subtraction did, would it make the <code>atan2</code> you mention more useful?"}, {"owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "edited": false, "score": 0, "creation_date": 1491603637, "post_id": 43240983, "comment_id": 73643912, "body": "Can someone explain the purpose of a negative zero?"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425090, "post_id": 43241106, "comment_id": 73552722, "body": "That&#39;s certainly the way I prefer: the convention of the first argument being returned if the arguments are equal. Nice explanation."}, {"owner": {"reputation": 63083, "user_id": 471795, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b2bd81c28bcafeea19ac72e554859ec0?s=128&d=identicon&r=PG", "display_name": "kanaka", "link": "https://stackoverflow.com/users/471795/kanaka"}, "edited": false, "score": 0, "creation_date": 1491425152, "post_id": 43241106, "comment_id": 73552754, "body": "That works for the specific case I posted, but I&#39;m also wanting to have -0.0 returned if they are both -0.0."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425569, "post_id": 43241106, "comment_id": 73552983, "body": "Well use the c standard library function signbit to distinguish. Valid from C99."}, {"owner": {"reputation": 63083, "user_id": 471795, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b2bd81c28bcafeea19ac72e554859ec0?s=128&d=identicon&r=PG", "display_name": "kanaka", "link": "https://stackoverflow.com/users/471795/kanaka"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425717, "post_id": 43241106, "comment_id": 73553063, "body": "Simplify using @Bathsheba&#39;s suggestion and I&#39;ll mark this as correct."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1491425750, "post_id": 43241106, "comment_id": 73553088, "body": "Your solution would be portable if you used signbit. Would you mind reworking it? I&#39;ve already upvoted."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1491426800, "post_id": 43241106, "comment_id": 73553649, "body": "@Bathsheba done, it&#39;s much much simpler with <code>signbit</code>, you&#39;re right. And thanks for the upvote. I try not to let supporters down :)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 7, "last_activity_date": 1491426344, "last_edit_date": 1491426344, "creation_date": 1491424433, "answer_id": 43241106, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar/43241106#43241106", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<p>The \"problem\" is that <code>a == b</code>. The sign doesn't matter because mantissa (sign put aside) is purely 0. I get <code>0x80000000</code> vs <code>0</code></p>\n\n<p>So <code>fmax</code> just checks if <code>a &lt; b</code> or <code>b &lt; a</code> (depending on the implementation), and both are false, so either answer is a potential match.</p>\n\n<p>On my gcc version I get <code>fmax(0.0,-0.0)</code> at <code>0.0</code>, but <code>fmax(-0.0,0.0)</code> is <code>-0.0</code>.</p>\n\n<p>My attempt at a full workaround, using <code>memcmp</code> to compare data binary wise in the case of a 0 result.</p>\n\n<p>Even better as suggested, using <code>signbit</code> which tests if number has negative bit set (regardless of the value):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\nfloat my_fmax(float a,float b)\n{\n   float result = fmax(a,b);\n   if ((result==0) &amp;&amp; (a==b))\n   {\n       /* equal values and both zero\n          the only case of potential wrong selection of the negative \n          value. Only in that case, we tamper with the result of fmax,\n          and just return a unless a has negative bit set */\n\n       result = signbit(a) ? b : a;\n   }\n   return result;\n}\n\nint main () {\n    float a = -0.0, b = 0.0;\n\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n    a = 0.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n    a = b = -0.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n    a = 1.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n    a = -1.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n    b = 0.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a,b, my_fmax(a, b));\n}\n</code></pre>\n\n<p>result (I think I covered all the cases):</p>\n\n<pre><code>fmax(-0.000000, 0.000000) = 0.000000\nfmax(0.000000, 0.000000) = 0.000000\nfmax(-0.000000, -0.000000) = -0.000000\nfmax(1.000000, -0.000000) = 1.000000\nfmax(-1.000000, -0.000000) = -0.000000\nfmax(-1.000000, 0.000000) = 0.000000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1491425824, "last_edit_date": 1491425824, "creation_date": 1491424637, "answer_id": 43241160, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar/43241160#43241160", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<p>It's life I'm afraid. IEEE754 allows either -0.0 or +0.0 to be returned.</p>\n\n<p>(Forgive me for assuming your implementation uses that scheme for floating point.)</p>\n\n<p>More often than not, the first argument will be returned if the two values are equal. That could form the basis of a workaround, but it is not strictly portable.</p>\n\n<p>You can use the C99 function signbit to distinguish a negative from a positive zero.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 3, "last_activity_date": 1491424827, "creation_date": 1491424827, "answer_id": 43241227, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar/43241227#43241227", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<p>From <a href=\"http://en.cppreference.com/w/c/numeric/math/fmax\" rel=\"nofollow noreferrer\">fmax cppreference</a>:</p>\n\n<blockquote>\n  <p>This function is not required to be sensitive to the sign of zero,\n  although some implementations additionally enforce that if one\n  argument is +0 and the other is -0, then +0 is returned.</p>\n</blockquote>\n\n<p>So I suppose it's up to you to specially handle the case that <code>-0.0</code> is returned.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491498742, "post_id": 43241562, "comment_id": 73591971, "body": "When <code>b</code> is <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">not-a-number</a>, this code returns <code>b</code>.  <code>fmaxf(1.0, 0.0&#47;0.0)</code> returns 1.0. Perhaps not an issue for OP."}], "tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 0, "last_activity_date": 1491464894, "last_edit_date": 1491464894, "creation_date": 1491426122, "answer_id": 43241562, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar/43241562#43241562", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<p>Here's a version of <code>fmaxf()</code> that looks at the <code>signbit()</code> in tie-breaking situations.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nfloat fmaxfs(float a,float b){\n    if(a&gt;b){\n        return a;\n    }\n    if(b!=a){\n        return b;\n    }\n    if(signbit(a)==0){\n        return a;\n    }\n    return b;\n}\n\nint test(float a,float b,float e){\n    float r=fmaxfs(a,b);\n    printf(\"fmaxfs(%f, %f) = %f\", a, b, r);\n    if(r!=e||signbit(r)!=signbit(e)){\n        printf(\" ERROR\\n\");\n        return 1;\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\nint main () {\n    int errors=0;\n    errors+=test(0.0f,-0.0f,0.0f);\n    errors+=test(-0.0f,0.0f,0.0f);\n    errors+=test(-0.0f,-0.0f,-0.0f);\n    errors+=test(-0.7f,-0.8f,-0.7f);\n    errors+=test(987.485f,100.0f,987.485f);\n    errors+=test(987.485f,1000000.0f,1000000.0f);\n    errors+=test(-987.485f,-100.0f,-100.0f);\n    errors+=test(-1.3678f,-19999.6789f,-19999.6789f);\n\n    if(errors&gt;0){\n        printf(\"%d ERRORS\\n\",errors);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>NB 1: Also note that if you are using <code>float</code> the best practice is to put <code>f</code> on the suffix or they will be interpreted as <code>double</code>.</p>\n\n<p>I'll leave <code>fminfs</code> and a type generic macro as an exercise.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1491446119, "last_edit_date": 1495535452, "creation_date": 1491445793, "answer_id": 43244657, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar/43244657#43244657", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<blockquote>\n  <p>Why does fmax(a, b) return the smaller (negative) zero </p>\n</blockquote>\n\n<p><code>fmax()</code> compares <em>values</em>.  +0.0 and -0.0 have the same <em>value</em>.  Returning <code>a</code> or <code>b</code> meets the <code>fmax()</code> spec.  A spec footnote specifically addressing this:</p>\n\n<blockquote>\n  <p>Ideally, <code>fmax</code> would be sensitive to the sign of zero, for example <code>fmax(\u22120. 0, +0. 0)</code> would return <code>+0</code>; however, implementation in software might be impractical. C11 #361</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>how to cleanly workaround it?</p>\n</blockquote>\n\n<p>Use <code>signbit()</code> to distinguish <code>+0.0</code> from <code>-0.0</code>.  <a href=\"https://stackoverflow.com/q/25332133/2410359\">Other ways to distinguish +/-0.0</a></p>\n\n<blockquote>\n  <p>The <code>signbit</code> macro returns a nonzero value if and only if the sign of its argument value is negative C1dr \u00a77.12.3.6 3</p>\n</blockquote>\n\n<p>In addition to signed zeros, many floating point implementations allow <em>de-normal</em> or <em>not-a-numbers</em> (NaN).  In such cases, the usual preferred action is to return the \"normal\" number if any.  </p>\n\n<p>With <code>&gt; &lt; &gt;= &lt;=</code>, the result is false if at least one of the operands are NaN.<br>\n<code>a &gt; b</code> is <em>not</em> the opposite of <code>a &lt;= b</code>.  Both could be false.</p>\n\n<p>Combing this with OP's zero compare goal of +0.0 beats -0.0:</p>\n\n<pre><code>#include &lt;math.h&gt;\n\nfloat fmaxf_sz(float a,float b){\n  if(!(a&lt;b)) return b;  // a is known to be less than b, both are normal\n  if(!(b&lt;a)) return a;  // b is known to be less than a, both are normal\n\n\n  if (a == b) {  // a is known to be equal in value to b, both are normal\n    return signbit(a) ? b : a;\n  }\n\n  // One or both a,b are NaN\n  return isfinite(a) ? a : b;\n}\n</code></pre>\n\n<p>Or perhaps simply detect the special condition else use <code>fmaxf()</code> - similar to <a href=\"https://stackoverflow.com/a/43241106/2410359\">@Jean-Fran\u00e7ois Fabre</a>.  Note: use <code>fmaxf()</code> for maximum <code>float</code>.</p>\n\n<pre><code>float fmaxf_sz(float a,float b){\n  if(a==0.0 &amp;&amp; b==0.0) {\n    return signbit(a) ? b : a;\n  }\n  return fmaxf(a,b);\n}\n</code></pre>\n"}], "owner": {"reputation": 63083, "user_id": 471795, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b2bd81c28bcafeea19ac72e554859ec0?s=128&d=identicon&r=PG", "display_name": "kanaka", "link": "https://stackoverflow.com/users/471795/kanaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "accepted_answer_id": 43241106, "answer_count": 5, "score": 4, "last_activity_date": 1491464894, "creation_date": 1491423935, "last_edit_date": 1491426804, "question_id": 43240983, "link": "https://stackoverflow.com/questions/43240983/why-does-fmaxa-b-return-the-smaller-negative-zero-and-how-to-cleanly-workar", "title": "Why does fmax(a, b) return the smaller (negative) zero and how to cleanly workaround it?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main () {\n    float a = 0.0, b = -0.0;\n    printf(\"fmax(%f, %f) = %f\\n\", a, b, fmax(a, b));\n}\n</code></pre>\n\n<p>I get the following result:</p>\n\n<pre><code>gcc f.c -o f -lm\n./f\nfmax(0.000000, -0.000000) = -0.000000\n</code></pre>\n\n<p>This (mis)behavior is not documented in the fmax man page. Is there a reasonable explanation for it? And is there a clean (concise) workaround? Also, if both are -0.0, I would like to get -0.0 as the max.</p>\n"}, {"tags": ["c", "arrays", "cs50"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491423872, "post_id": 43240949, "comment_id": 73552073, "body": "<code>i &lt;= 100</code> --&gt; <code>i &lt; 100</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1491423943, "post_id": 43240949, "comment_id": 73552117, "body": "Ah, the off-by-one error strikes again!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491423994, "post_id": 43240949, "comment_id": 73552146, "body": "best way <code>i &lt; sizeof(fill_array)&#47;sizeof(fill_array[0])</code>"}, {"owner": {"reputation": 701, "user_id": 3983756, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/966fffbafc3c218b194488772be93d6c?s=128&d=identicon&r=PG", "display_name": "ThunderWiring", "link": "https://stackoverflow.com/users/3983756/thunderwiring"}, "edited": false, "score": 0, "creation_date": 1491424525, "post_id": 43240949, "comment_id": 73552395, "body": "you need <code>return 0;</code>"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 1, "creation_date": 1491424751, "post_id": 43240949, "comment_id": 73552518, "body": "This is not an exact duplicate. It also contains an error in <code>fill_array[99] = i;</code> which should be <code>fill_array[i] = i;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7624012, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjvKnByaDsM/AAAAAAAAAAI/AAAAAAAAAEA/QK_kWktBgTw/photo.jpg?sz=128", "display_name": "Glenn Oberlander", "link": "https://stackoverflow.com/users/7624012/glenn-oberlander"}, "edited": false, "score": 0, "creation_date": 1491426514, "post_id": 43240981, "comment_id": 73553509, "body": "Got it. Okay... Now... How do I fill it with characters? I have   <code>int main(void) {  char i; char array[26];  for(i = &#39;A&#39;; i &lt;= &#39;Z&#39;; i++)      {         array[i] = i;         printf(&quot;%c \\n&quot;, array[i]);     } }</code>  Gives me error: <code>fillingarray.c:16:14: error: array subscript is of type &#39;char&#39; [-Werror,-Wchar-subscripts]         array[i] = i;              ^~ fillingarray.c:17:30: error: array subscript is of type &#39;char&#39; [-Werror,-Wchar-subscripts]         printf(&quot;%c \\n&quot;, array[i]); </code> It&#39;s telling me literally what it is... (idk how to make my code appear as yours)"}, {"owner": {"reputation": 443, "user_id": 5471920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6ETjh.jpg?s=128&g=1", "display_name": "Adds", "link": "https://stackoverflow.com/users/5471920/adds"}, "reply_to_user": {"reputation": 23, "user_id": 7624012, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjvKnByaDsM/AAAAAAAAAAI/AAAAAAAAAEA/QK_kWktBgTw/photo.jpg?sz=128", "display_name": "Glenn Oberlander", "link": "https://stackoverflow.com/users/7624012/glenn-oberlander"}, "edited": false, "score": 0, "creation_date": 1491484587, "post_id": 43240981, "comment_id": 73581305, "body": "The easiest way right now is      char array[] = { &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;,&#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;,&#39;y&#39;, &#39;z&#39; } ;"}], "tags": [], "owner": {"reputation": 443, "user_id": 5471920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6ETjh.jpg?s=128&g=1", "display_name": "Adds", "link": "https://stackoverflow.com/users/5471920/adds"}, "is_accepted": true, "score": 2, "last_activity_date": 1491424518, "last_edit_date": 1491424518, "creation_date": 1491423926, "answer_id": 43240981, "question_id": 43240949, "link": "https://stackoverflow.com/questions/43240949/populating-an-array-with-100-integers-in-c/43240981#43240981", "title": "Populating an array with 100 integers in C", "body": "<p>It should be : </p>\n\n<pre><code>for(int i = 0; i &lt; 100; i++)\n</code></pre>\n\n<p>there is one more error in your for loop, To fill the array you should : </p>\n\n<pre><code>fill_array[i] = i;\n</code></pre>\n\n<p>The code should look like </p>\n\n<pre><code>int fill_array[100];\n\nfor(int i = 0; i &lt; 100; i++)\n{\nfill_array[i] = i;\nprintf(\"%i\", fill_array[i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 1, "last_activity_date": 1491423952, "creation_date": 1491423952, "answer_id": 43240988, "question_id": 43240949, "link": "https://stackoverflow.com/questions/43240949/populating-an-array-with-100-integers-in-c/43240988#43240988", "title": "Populating an array with 100 integers in C", "body": "<p>An  </p>\n\n<pre><code>int fill_array[100];\n</code></pre>\n\n<p>has indexed 0-99.\nStop the for loop in time.</p>\n\n<pre><code>for(int i = 0; i &lt; 100; i++)\n</code></pre>\n\n<p>Also you probably want to fill different indexes than always 99.</p>\n"}], "owner": {"reputation": 23, "user_id": 7624012, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjvKnByaDsM/AAAAAAAAAAI/AAAAAAAAAEA/QK_kWktBgTw/photo.jpg?sz=128", "display_name": "Glenn Oberlander", "link": "https://stackoverflow.com/users/7624012/glenn-oberlander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5897, "favorite_count": 1, "closed_date": 1491423922, "accepted_answer_id": 43240981, "answer_count": 2, "score": 1, "last_activity_date": 1491597051, "creation_date": 1491423790, "last_edit_date": 1491597051, "question_id": 43240949, "link": "https://stackoverflow.com/questions/43240949/populating-an-array-with-100-integers-in-c", "closed_reason": "Duplicate", "title": "Populating an array with 100 integers in C", "body": "<p>I am taking the free CS50 online class. In one of the video tutorials, the teacher mentions the ability to fill an array with 100 integers, and that it is good practice. I am trying to do that exact thing right now and I am having a difficult time figuring it out.</p>\n\n<p>Note: I have only seen answers including scanf functions and pointers. Is that the only way to solve it, or can it be solved without scanf and pointer?</p>\n\n<p>This is barely the closest I can get...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n\nint fill_array[100];\n\nfor(int i = 0; i &lt;= 100; i++)\n{\n    fill_array[99] = i;\n    printf(\"%i\", fill_array[i]);\n}\n}\n</code></pre>\n\n<p>Prints out a ton of random numbers and this error:</p>\n\n<pre><code>fillingarray.c:14:18: runtime error: index 100 out of bounds for type 'int [100]'\n665999424\n</code></pre>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 3, "creation_date": 1491423547, "post_id": 43240804, "comment_id": 73551898, "body": "Run it through a compiler and enable assembly listing"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1491423672, "post_id": 43240804, "comment_id": 73551970, "body": "for <code>gcc</code> that would be the <code>-S</code> option"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1491423754, "post_id": 43240804, "comment_id": 73552012, "body": "Use the <code>-S</code> option of your favourite C compiler."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1491423791, "post_id": 43240804, "comment_id": 73552030, "body": "Use this <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 5, "creation_date": 1491423938, "post_id": 43240804, "comment_id": 73552115, "body": "Isn&#39;t it kind of redundant to try and convert invalid <code>C</code> to any asm language?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491709949, "post_id": 43240804, "comment_id": 73670941, "body": "Is this MPLAB C?"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7838175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a4aaee862ad6d092312b73fd517d?s=128&d=identicon&r=PG&f=1", "display_name": "Ashland Simpson", "link": "https://stackoverflow.com/users/7838175/ashland-simpson"}, "is_accepted": false, "score": -1, "last_activity_date": 1491684614, "creation_date": 1491684614, "answer_id": 43300210, "question_id": 43240804, "link": "https://stackoverflow.com/questions/43240804/convert-c-program-into-assembly/43300210#43300210", "title": "Convert C program into assembly?", "body": "<p>If you want the machine code, use a debugger like OllyDbg. Try disassembling your program.</p>\n"}], "owner": {"reputation": 1, "user_id": 4247970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2f6c2b235c147f7e0a1f56f854b20c?s=128&d=identicon&r=PG&f=1", "display_name": "hadi noroozi", "link": "https://stackoverflow.com/users/4247970/hadi-noroozi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 637, "favorite_count": 0, "closed_date": 1614137728, "answer_count": 1, "score": -4, "last_activity_date": 1491684614, "creation_date": 1491423281, "question_id": 43240804, "link": "https://stackoverflow.com/questions/43240804/convert-c-program-into-assembly", "closed_reason": "Duplicate", "title": "Convert C program into assembly?", "body": "<p>how exactly do I convert this C program into assembly code?`</p>\n\n<pre><code>  void main(){\n    for(i=100;i&lt;2000;i++)\n{\n\n    While(PORTA==12)\n    {\n    PORTB++;\n    PORTC=i%200;\n    if(PORTB==77)\n    Break;\n    }\n    }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "memory-management", "stack", "automatic-storage"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491423001, "post_id": 43240668, "comment_id": 73551574, "body": "It&#39;s returning a a copy of num by value.  Presumably, the &#39;some IO operations&#39; loads num with the address of some data whose lifetime can exceed that of &#39;nifti_image_read()&#39;.  That&#39;s just fine, and then, so is returning its address."}, {"owner": {"reputation": 25, "user_id": 1914356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c7944b529de19d33dc14b85377fbd3?s=128&d=identicon&r=PG", "display_name": "Sourena", "link": "https://stackoverflow.com/users/1914356/sourena"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491424064, "post_id": 43240668, "comment_id": 73552178, "body": "@ThingyWotsit I did some research on returning by value vs. by reference  and got the point now. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1491422916, "creation_date": 1491422916, "answer_id": 43240710, "question_id": 43240668, "link": "https://stackoverflow.com/questions/43240668/function-returning-a-pointer-to-automatic-variable/43240710#43240710", "title": "function returning a pointer to automatic variable", "body": "<p>It's just returning the value of the nim pointer.<br>\nDuring the &lt;&lt; some IO operations >> part I assume nim is set to point at some permanent memory in the heap or global. </p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1491422980, "creation_date": 1491422980, "answer_id": 43240727, "question_id": 43240668, "link": "https://stackoverflow.com/questions/43240668/function-returning-a-pointer-to-automatic-variable/43240727#43240727", "title": "function returning a pointer to automatic variable", "body": "<p>You're not returning a pointer to a local variable.  You're returning the <strong>value</strong> of a local variable which happens to be a pointer.</p>\n\n<p>Assuming the pointer is not pointing to another local variable itself, this is a safe operation.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 1914356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c7944b529de19d33dc14b85377fbd3?s=128&d=identicon&r=PG", "display_name": "Sourena", "link": "https://stackoverflow.com/users/1914356/sourena"}, "edited": false, "score": 0, "creation_date": 1491424153, "post_id": 43240805, "comment_id": 73552223, "body": "So I guess the same function but which returns by reference like:  nifti_image*&amp; nifti_image_read() would be wrong?"}, {"owner": {"reputation": 566, "user_id": 4667104, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-rGRu3uu46Vg/AAAAAAAAAAI/AAAAAAAAAS4/sFeLdQuPwdU/photo.jpg?sz=128", "display_name": "Elvis Teixeira", "link": "https://stackoverflow.com/users/4667104/elvis-teixeira"}, "reply_to_user": {"reputation": 25, "user_id": 1914356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c7944b529de19d33dc14b85377fbd3?s=128&d=identicon&r=PG", "display_name": "Sourena", "link": "https://stackoverflow.com/users/1914356/sourena"}, "edited": false, "score": 0, "creation_date": 1491426630, "post_id": 43240805, "comment_id": 73553565, "body": "References with the &amp; notation are a C++ feature, I it is strict C you ca&#39;nt use them. The fact here is, the pointer cease to exist after the function, but the caller receives it&#39;s value in another variable, which is enough."}], "tags": [], "owner": {"reputation": 566, "user_id": 4667104, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-rGRu3uu46Vg/AAAAAAAAAAI/AAAAAAAAAS4/sFeLdQuPwdU/photo.jpg?sz=128", "display_name": "Elvis Teixeira", "link": "https://stackoverflow.com/users/4667104/elvis-teixeira"}, "is_accepted": true, "score": 0, "last_activity_date": 1491423282, "creation_date": 1491423282, "answer_id": 43240805, "question_id": 43240668, "link": "https://stackoverflow.com/questions/43240668/function-returning-a-pointer-to-automatic-variable/43240805#43240805", "title": "function returning a pointer to automatic variable", "body": "<p>This function is returning the value stored in the pointer and it is ok. The pointer value is the address of an object which is probably a allocated dynamically and is NOT deleted at the end, even if it was C++. The only possible issue is the case where the pointer points to another local variable, not allocated dynamically. So even though the pointer itself goes out of scope, the caller that receives the return value gets a copy of the address of a valid object.</p>\n"}], "owner": {"reputation": 25, "user_id": 1914356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c7944b529de19d33dc14b85377fbd3?s=128&d=identicon&r=PG", "display_name": "Sourena", "link": "https://stackoverflow.com/users/1914356/sourena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 43240805, "answer_count": 3, "score": -1, "last_activity_date": 1491423540, "creation_date": 1491422764, "question_id": 43240668, "link": "https://stackoverflow.com/questions/43240668/function-returning-a-pointer-to-automatic-variable", "title": "function returning a pointer to automatic variable", "body": "<p>So I am working with a \"standard\" library with more than a decade of history for brain image I/O. I encountered this function:</p>\n\n<pre><code>   nifti_image* nifti_image_read( const char *hname , int read_data ){\n\n   nifti_image* nim;\n...\n\n&lt;&lt;&lt;some IO operations&gt;&gt;&gt;\n\n...\n\nreturn nim;\n}\n</code></pre>\n\n<p>My question is, how come this function is returning a local pointer to an automatic variable? Isn't this practice prohibited since the nim pointer goes out of scope and is supposed to be deleted after completion of the function?</p>\n\n<p>I have already read <a href=\"https://stackoverflow.com/questions/1224042/returning-a-pointer-to-an-automatic-variable\">this</a> question but couldn't get my answer:</p>\n"}, {"tags": ["c", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4105744, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d16b818ecf44d9971004e4ad6c4a7c24?s=128&d=identicon&r=PG&f=1", "display_name": "Fabi_Z", "link": "https://stackoverflow.com/users/4105744/fabi-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1503428107, "creation_date": 1503428107, "answer_id": 45825000, "question_id": 43240563, "link": "https://stackoverflow.com/questions/43240563/building-postgresql-c-function-with-multidimensional-array-as-input/45825000#45825000", "title": "Building Postgresql C function with Multidimensional Array as input", "body": "<p>You can try using the deconstruct_array (..) function to extract the values. This function will give you a Datum type pointer.</p>\n\n<p>Example of the book:</p>\n\n<pre><code>deconstruct_array(input_array, //one-dimensional array\n                  INT4OID, //of integers\n                  4,//size of integer in bytes\n                  true,//int4 is pass-by value\n                  'i',//alignment type is 'i'\n                  &amp;datums, &amp;nulls, &amp;count); // result here       \n</code></pre>\n\n<p>\"The datums pointer will be set to point to an array filled with actual elements.\"</p>\n\n<p>You can access the values using:</p>\n\n<pre><code>DatumGetInt32(datums[i]);\n</code></pre>\n"}], "owner": {"reputation": 134, "user_id": 5124103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yHUtCcohxEs/AAAAAAAAAAI/AAAAAAAACGA/4iFOw0wKrrM/photo.jpg?sz=128", "display_name": "samkreter", "link": "https://stackoverflow.com/users/5124103/samkreter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503428107, "creation_date": 1491422402, "question_id": 43240563, "link": "https://stackoverflow.com/questions/43240563/building-postgresql-c-function-with-multidimensional-array-as-input", "title": "Building Postgresql C function with Multidimensional Array as input", "body": "<p>I am extending the Postgresql functions using the C SPI. The function needs to be able to take in a Postgres N-Dim Array and get the data out of it. I am able to get the data from a 1D array but I get a segfault when trying to access a N-Dim array. </p>\n\n<p>My first try to just access an element was simply</p>\n\n<pre><code>PG_FUNCTION_INFO_V1(sum_elements);\nDatum\nmatmul(PG_FUNCTION_ARGS)\n{\n\n    ArrayType *anyArray = PG_GETARG_ARRAYTYPE_P(0);\n    int32 **a = (int32 **)  ARR_DATA_PTR(anyArray);\n\n\n\n    PG_RETURN_INT64(a[1][1]);\n}\n</code></pre>\n\n<p>I also tried as if it flattened the matrix into a 1D array but the values that came out were just garbage. </p>\n\n<p>Thanks for the help! </p>\n"}, {"tags": ["c", "optimization", "openmp"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 3, "creation_date": 1491421069, "post_id": 43240076, "comment_id": 73550453, "body": "It&#39;ll be practical to see an <a href=\"http://stackoverflow.com/help/mcve\">MVCE</a>. It may just be undefined behaviour you&#39;re running into, such as not initializing a starting variable."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1491426281, "post_id": 43240076, "comment_id": 73553388, "body": "If you use a compiler for which -Ofast implies simd reduction, each of your reduction methods with varying orders of summation would imply small (insignificant) differences."}, {"owner": {"reputation": 15, "user_id": 5556571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vY6O5.jpg?s=128&g=1", "display_name": "cla", "link": "https://stackoverflow.com/users/5556571/cla"}, "edited": false, "score": 0, "creation_date": 1491428248, "post_id": 43240076, "comment_id": 73554284, "body": "@Evert, there I added the reduced example code."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 2, "creation_date": 1491458020, "post_id": 43244129, "comment_id": 73562897, "body": "Note that instead of explicitly declaring the variables private in the <code>pragma</code>, or making a new function, you can also declare the variables inside the parallel region, as locally as possible. This makes them private implicitly and is less prone to initialization issues and easier to reason about."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1491459784, "post_id": 43244129, "comment_id": 73563819, "body": "@Zulan Thanks; edited in. With C99 style variable declaration, this is easy (I may have never even run into this hurdle, since that is standard style for me nowadays). That also explains that a function call will work, since all those variables are declared inside the function, which is called inside the OpenMP loop."}, {"owner": {"reputation": 15, "user_id": 5556571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vY6O5.jpg?s=128&g=1", "display_name": "cla", "link": "https://stackoverflow.com/users/5556571/cla"}, "edited": false, "score": 0, "creation_date": 1491489232, "post_id": 43244129, "comment_id": 73585108, "body": "Your suggestion of making all the inner variables as local as possible solves the problem. The question of why Ofast leads to the correct answer remains unclear to me, but your guess has a lot of sense and it should be proved. Thank you very much for all your comments and the help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "is_accepted": true, "score": 3, "last_activity_date": 1491459555, "last_edit_date": 1592644375, "creation_date": 1491441645, "answer_id": 43244129, "question_id": 43240076, "link": "https://stackoverflow.com/questions/43240076/about-the-combination-of-openmp-and-ofast/43244129#43244129", "title": "About the combination of OpenMP and -Ofast", "body": "<p>Disclaimer: I have little to no experience with OpenMP</p>\n<h2>It's probably a race condition you run into when using OpenMP.</h2>\n<p>You'll need to declare all those variables inside the OpenMP loop to be <em>private</em>. One core may calculate their values for a certain value of <code>index</code>, which gets promptly recalculated to different values on a core that uses another value of <code>index</code>: the variables such as <code>k</code>, <code>j</code>, <code>rrx</code>, <code>rry</code> etc are shared between the compute nodes.</p>\n<p>Instead of using a pragma like</p>\n<pre><code>#pragma omp parallel for private(k,j,zz,rx,ry,rrx,rry,r,Cpm,Cmm,Cpp,Cmp,Energy) reduction (+:D\\\n</code></pre>\n<p>(credits to comment by Zulan below:) you can also declare the variables inside the parallel region, as locally as possible. This makes them private implicitly and is less prone to initialization issues and easier to reason about.</p>\n<p>(You could even consider putting everything inside the outer for-loop (over <code>index</code>) in a function: the function call overhead is minimal compared to the calculations.)</p>\n<h2>As to why <code>-Ofast</code> together with OpenMP does actually produce correct output.</h2>\n<p>My guess is: mostly luck. Here's what <code>-Ofast</code> does (gcc manual):</p>\n<blockquote>\n<p>Disregard strict standards compliance.  -Ofast enables all -O3 optimizations.  It also enables optimizations that are not valid for all standard-compliant programs. It turns on -ffast-math [...]</p>\n</blockquote>\n<p>Here's the section on <code>-ffast-math</code>:</p>\n<blockquote>\n<p>This option is not turned on by any -O option besides -Ofast since it can result in incorrect output for programs that depend on an exact implementation of IEEE or ISO rules/specifications for math functions. It may, however, yield faster code for programs that do not require the guarantees of these specifications.</p>\n</blockquote>\n<p>Thus, the <code>sqrt</code>, <code>cos</code> and <code>sin</code> will likely be a lot speedier. My guess is, that in this case, the calculations of the variables inside the outer loop don't bite each other, since the individual threads are so fast, they don't conflict. But that is a very handwavingly explanation and guess.</p>\n"}], "owner": {"reputation": 15, "user_id": 5556571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vY6O5.jpg?s=128&g=1", "display_name": "cla", "link": "https://stackoverflow.com/users/5556571/cla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 43244129, "answer_count": 1, "score": 0, "last_activity_date": 1491459555, "creation_date": 1491420760, "last_edit_date": 1491428081, "question_id": 43240076, "link": "https://stackoverflow.com/questions/43240076/about-the-combination-of-openmp-and-ofast", "title": "About the combination of OpenMP and -Ofast", "body": "<p>I implemented <strong>OpenMP parallelization in a for loop</strong> where I have a <strong>sum</strong> that is the principal cause of slowing down my code. When I did so, I found out that the final results were not the same that I obtained for the non-parallelize code (which is written in C). So first, one might think \"well, I just didn't implemented well the parallelization\" but the curious thing is that when I run the parallelized code with the <strong>-Ofast</strong> optimization suddenly the results are correct.</p>\n\n<p>That would be:</p>\n\n<ul>\n<li>-O0 correct</li>\n<li>-Ofast correct</li>\n<li>OMP -O0 wrong </li>\n<li>OMP -O1 wrong</li>\n<li>OMP -O2 wrong</li>\n<li>OMP -O3 wrong</li>\n<li>OMP -Ofast correct!</li>\n</ul>\n\n<p>What could -Ofast be doing that solves an error that only appears when I implement openmp? \nAny recommendation of what could I check or test?\nThanks!</p>\n\n<p><strong>EDIT</strong>\nHere I include the smallest version of my code that still reproduces the problem.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;gsl/gsl_rng.h&gt;\n#include &lt;gsl/gsl_randist.h&gt;\n\n#define LENGTH 100\n#define R 50.0\n#define URD 1.0/sqrt(2.0)\n#define PI (4.0*atan(1.0)) //pi\n\nconst gsl_rng_type * Type;\ngsl_rng * item;\n\ndouble CalcDeltaEnergy(double **M,int sx,int sy){\n    double DEnergy,r,zz;\n    int k,j;\n    double rrx,rry;\n    int rx,ry;\n    double Energy, Cpm, Cmm, Cmp, Cpp;\n    DEnergy = 0;\n\n    //OpenMP parallelization:\n    #pragma omp parallel for reduction (+:DEnergy)\n    for (int index = 0; index &lt; LENGTH*LENGTH; index++){\n        k = index % LENGTH;\n        j = index / LENGTH;\n\n    zz = 0.5*(1.0 - pow(-1.0, k + j + sx + sy));\n    for (rx = -1; rx &lt;= 1; rx++){\n        for (ry = -1; ry &lt;= 1; ry++){\n            rrx = (sx - k - rx*LENGTH)*URD;\n            rry = (sy - j - ry*LENGTH)*URD;\n\n            r = sqrt(rrx*rrx + rry*rry + zz);\n            if(r != 0 &amp;&amp; r &lt;= R){\n                Cpm = sqrt((rrx+0.5*(0.702*cos(M[k][j])-0.702*cos(M[sx][sy])))*(rrx+0.5*(0.702*cos(M[k][j])-0.702*cos(M[sx][sy]))) + (rry+0.5*(0.702*sin(M[k][j])-0.702*sin(M[sx][sy])))*(rry+0.5*(0.702*sin(M[k][j])-0.702*sin(M[sx][sy]))) + zz);\n                Cmm = sqrt((rrx-0.5*(0.702*cos(M[k][j])-0.702*cos(M[sx][sy])))*(rrx-0.5*(0.702*cos(M[k][j])-0.702*cos(M[sx][sy]))) + (rry-0.5*(0.702*sin(M[k][j])-0.702*sin(M[sx][sy])))*(rry-0.5*(0.702*sin(M[k][j])-0.702*sin(M[sx][sy]))) + zz);\n                Cpp = sqrt((rrx+0.5*(0.702*cos(M[k][j])+0.702*cos(M[sx][sy])))*(rrx+0.5*(0.702*cos(M[k][j])+0.702*cos(M[sx][sy]))) + (rry+0.5*(0.702*sin(M[k][j])+0.702*sin(M[sx][sy])))*(rry+0.5*(0.702*sin(M[k][j])+0.702*sin(M[sx][sy]))) + zz);\n                Cmp = sqrt((rrx-0.5*(0.702*cos(M[k][j])+0.702*cos(M[sx][sy])))*(rrx-0.5*(0.702*cos(M[k][j])+0.702*cos(M[sx][sy]))) + (rry-0.5*(0.702*sin(M[k][j])+0.702*sin(M[sx][sy])))*(rry-0.5*(0.702*sin(M[k][j])+0.702*sin(M[sx][sy]))) + zz);\n                Cpm = 1.0/Cpm;\n                Cmm = 1.0/Cmm;\n                Cpp = 1.0/Cpp;\n                Cmp = 1.0/Cmp;\n                Energy = (Cpm + Cmm - Cpp - Cmp)/(0.702*0.702); // S=cte=1\n\n                DEnergy -= 2.0*Energy;\n            }\n        }\n    }\n    }\nreturn DEnergy;\n}\n\nvoid Initialize(double **M){\ndouble random;\n    for(int i=0;i&lt;(LENGTH-1);i=i+2){\n          for(int j=0;j&lt;(LENGTH-1);j=j+2) {\n              random=gsl_rng_uniform(item);\n              if (random&lt;0.5) M[i][j]=PI/4.0;\n              else M[i][j]=5.0*PI/4.0;\n\n              random=gsl_rng_uniform(item);\n              if (random&lt;0.5) M[i][j+1]=3.0*PI/4.0;\n              else M[i][j+1]=7.0*PI/4.0;\n\n              random=gsl_rng_uniform(item);\n              if (random&lt;0.5) M[i+1][j]=3.0*PI/4.0;\n              else M[i+1][j]=7.0*PI/4.0;\n\n              random=gsl_rng_uniform(item);\n              if (random&lt;0.5) M[i+1][j+1]=PI/4.0;\n              else M[i+1][j+1]=5.0*PI/4.0;\n          }\n    }\n}\n\nint main(){\n    //Choose and initiaze the random number generator\n    gsl_rng_env_setup();\n    Type = gsl_rng_default; //default=mt19937, ran2, lxs0\n    item = gsl_rng_alloc (Type);\n\n    double **S; //site matrix\n    S = (double **) malloc(LENGTH*sizeof(double *));\n    for (int i = 0; i &lt; LENGTH; i++)\n        S[i] = (double *) malloc(LENGTH*sizeof(double ));\n\n    //Initialization\n    Initialize(S);\n\n    int l,m;\n    for (int cl = 0; cl &lt; LENGTH*LENGTH; cl++) {\n        l = gsl_rng_uniform_int(item, LENGTH); // RNG[0, LENGTH-1]\n        m = gsl_rng_uniform_int(item, LENGTH); // RNG[0, LENGTH-1]\n        printf(\"%lf\\n\", CalcDeltaEnergy(S, l, m));\n    }\n\n\n    //Free memory\n    for (int i = 0; i &lt; LENGTH; i++)\n        free(S[i]);\n    free(S);\n    return 0;\n} \n</code></pre>\n\n<p>I compile with: </p>\n\n<pre><code>g++ [optimization] -lm test.c -o test.x -lgsl -lgslcblas -fopenmp\n</code></pre>\n\n<p>and run with:</p>\n\n<pre><code>GSL_RNG_SEED=123; ./test.x &gt; test.dat\n</code></pre>\n\n<p>Comparing the outputs for different optimizations one can see what I stated before.</p>\n"}, {"tags": ["c", "types", "binary", "bit-shift"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1491420364, "post_id": 43239906, "comment_id": 73550028, "body": "Could you please reduce this to a <a href=\"http://stackoverflow.com/help/mcve\">minimal test-case</a>, so that people don&#39;t have to sticth together six bits of code in their head?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491420430, "post_id": 43239906, "comment_id": 73550071, "body": "I don&#39;t see why you have <code>#define u8 char</code> and not <code>#define u8 unsigned char</code>"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1491420490, "post_id": 43239906, "comment_id": 73550103, "body": "@WeatherVane: Or better, <code>typedef unsigned char u8;</code>, so the compiler knows the association, not just the preprocessor."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491422280, "post_id": 43239906, "comment_id": 73551147, "body": "Why do you assume <code>char</code> is unsigned<code>? And why not use </code>stdint.h` fixed width types, but homebrew types?"}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1491422409, "post_id": 43239906, "comment_id": 73551212, "body": "@OliverCharlesworth I compressed everything. Hope it&#39;s ok now."}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491422441, "post_id": 43239906, "comment_id": 73551231, "body": "@WeatherVane that was it, thank you !"}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491422659, "post_id": 43239906, "comment_id": 73551362, "body": "@Olaf I did not assume such thing. I even tried to do <code>first_part = first_part &gt;&gt; 4</code>  and then <code>inst.cond = first_part</code> but I still had the same problem."}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491422835, "post_id": 43239906, "comment_id": 73551473, "body": "@WeatherVane I didn&#39;t change the question to a solution, I just deleted some parts of my code and some sentences I had written, but there was still the question with the same problem in the code"}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491423401, "post_id": 43239906, "comment_id": 73551821, "body": "@WeatherVane First comment specifically asked me to make a more concise question. I thought  that would be better even for future viewers of my question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491423884, "post_id": 43239906, "comment_id": 73552078, "body": "Sorry, restored (I hope) and deleted some comments"}, {"owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491424452, "post_id": 43239906, "comment_id": 73552358, "body": "@WeatherVane thank you"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1491420892, "post_id": 43240092, "comment_id": 73550351, "body": "The best part is parenthesised."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1491422436, "post_id": 43240092, "comment_id": 73551224, "body": "Supporting @WeatherVane: Never use homebrew fixed-width types if there are standard types available."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 3, "last_activity_date": 1491420810, "creation_date": 1491420810, "answer_id": 43240092, "question_id": 43239906, "link": "https://stackoverflow.com/questions/43239906/shift-operator-in-c-prepends-ones-instead-of-zeros/43240092#43240092", "title": "Shift operator in C prepends ones instead of zeros", "body": "<p>Your <code>u8</code> type is using <code>char</code> without specifying signedness, which means it has undefined signedness. It's likely your compiler is using a <code>signed char</code> by default. Thus, you're subject to sign-extension during operations and during promotion.</p>\n\n<p>Change:</p>\n\n<pre><code>#define u8 char\n#define u32 unsigned int\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>typedef unsigned char u8;\ntypedef unsigned int u32;\n</code></pre>\n\n<p>(or use <code>stdint.h</code> types properly), and your storage should be actually unsigned.</p>\n\n<p>Using <code>typedef</code>s also means the compiler is involved with this aliasing, it's not just a preprocessor text replacement, eliminating a class of subtle errors.</p>\n"}], "owner": {"reputation": 99, "user_id": 5764681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/430409370494143/picture?type=large", "display_name": "Arthur Feldman", "link": "https://stackoverflow.com/users/5764681/arthur-feldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 43240092, "answer_count": 1, "score": 0, "last_activity_date": 1491423808, "creation_date": 1491420151, "last_edit_date": 1491423808, "question_id": 43239906, "link": "https://stackoverflow.com/questions/43239906/shift-operator-in-c-prepends-ones-instead-of-zeros", "title": "Shift operator in C prepends ones instead of zeros", "body": "<p>Here is the code:</p>\n\n<pre><code>#define u8 char\n#define u32 unsigned int\n\ntypedef struct {\n    //decoded instruction fields\n    u8 cond; // Condition (f.ex. 1110 for always true)\n    u8 instruction_code; // Is a constant since we only use branch\n    u32 offset; // Offset from current PC\n} dcdinst;\n\nu8 mem[1024];\n\nmem[0x0] = 0b11101010;\n\nu8* instruction_addr = &amp;mem[pc];\n\nif (instruction_addr == NULL) {\n    return false;\n}\n\nunsigned int first_part = instruction_addr[0];\n\n// Here is the code that presents a problem:\n// I try to get the upper part of the first byte\ninst.cond = first_part &gt;&gt; 4;\n</code></pre>\n\n<p><code>first_part</code> is the following byte: 11101010.\n<code>inst.cond</code> becomes 11111110, but I need it to be 00001110.</p>\n\n<p>So, my actual problem is that I want to get the first 4 bits of my instruction which starts at the address <code>instruction_addr</code>. I tried to do so by using the right shift operator <code>&gt;&gt;</code> but the problem is that instead of prepending 0s to the left of the byte, it prepends 1s. </p>\n\n<p>I found on stackoverflow that I first had to cast the value to a unsigned one, and that's what I did by using the variable <code>first_part</code>, but I still have the same problem. I don't understand why the shift seems to \"see\" my variable as a negative one while its type is specifically \"unsigned\".</p>\n\n<p>Does anybody have an idea?</p>\n"}, {"tags": ["c", "data-structures", "printing", "linked-list", "void-pointers"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1491419639, "post_id": 43239633, "comment_id": 73549623, "body": "well, you have already answered the question. Don&#39;t do <code>hashtable-&gt;v[i] = hashtable-&gt;v[i]-&gt;urm;</code> That destroys the head of the list. Use a temp variable instead."}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1491419998, "post_id": 43239633, "comment_id": 73549829, "body": "Oops, I was doing something pretty silly, actually. Thank you for your answer. While I was trying to use an auxiliary variable, I just destroyed the normal list as well. Thank you!"}], "owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491419185, "creation_date": 1491419185, "question_id": 43239633, "link": "https://stackoverflow.com/questions/43239633/losing-linked-list-after-printing", "title": "Losing linked list after printing", "body": "<p>I have the following code:</p>\n\n<pre><code>if (strcmp(method, \"print\") == 0){\n            for (i = 0; i &lt; hashtable-&gt;M; i++){\n                fprintf(fout,\"[%d] :\", i);\n                if (hashtable-&gt;v[i] != NULL)\n                    while(hashtable-&gt;v[i]){\n                        fprintf(fout,\" \");\n                        ((Pair*)hashtable-&gt;v[i]-&gt;info)-&gt;fp(hashtable-&gt;v[i], fout);\n                        hashtable-&gt;v[i] = hashtable-&gt;v[i]-&gt;urm;\n                    }\n                fprintf(fout,\"\\n\");\n            }\n        }\n</code></pre>\n\n<p>In my code, when I encounter a \"print\" from the file, I have to print out the values stored in my hashtable. M is the size of the hashtable, while v is a void* which points to a linked list. It's all good but if I have to add some values in the hashtable and then print them, after printing I lose all the previously stored values. I think this might have to do with the fact that I'm doing this: <code>hashtable-&gt;v[i] = hashtable-&gt;v[i]-&gt;urm;</code> but even so, I don't know how to recover the values. I was thinking about something as an auxiliary pointer to the hashtable, but that failed for me. Note, the structures are as follow</p>\n\n<pre><code>typedef struct celulag {\n  void *info;\n  struct celulag *urm;\n} TCelulaG, *TLG, **ALG;\n\ntypedef unsigned int (*TFHash)(const void*, size_t M, size_t range);\n\n/* structura tabela Hash */\ntypedef struct {\n    size_t M;\n    TFHash fh;\n    TLG *v;\n} TH;\n\ntypedef void (*TPrint)(TLG l, FILE *g);\n\ntypedef struct {\n    void *key;\n    void *value;\n    TPrint fp;\n    int frequency;\n} Pair;\n</code></pre>\n\n<p>Note that this is done in a while so the assignment would look as this: \nAdd 3 values, print, add another 4 values, print. After adding the first 3 values, if I prind, it's all good, after adding the next 4 values, if I print, only the last 4 values appear. \nCan anyone help? Thank you very much.</p>\n"}, {"tags": ["c", "signals", "fork", "kill", "zombie-process"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491418226, "post_id": 43239160, "comment_id": 73548784, "body": "<code>void my_handler()</code> --&gt;&gt; <code>void my_handler(int signum)</code> [With the wrong signature, the return from the signal handler effectively kills your child] And also: you should not call printf() from inside a signal handler."}, {"owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491418575, "post_id": 43239160, "comment_id": 73549000, "body": "@wildplasser The code is an example for a specific signal, so it has no argument.  The printf is also an example and is not the real problem :/"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491418647, "post_id": 43239160, "comment_id": 73549049, "body": "But it is <b>called</b> with an argument, which disrupts the stack (on return)"}, {"owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491418667, "post_id": 43239160, "comment_id": 73549055, "body": "@wildplasser So how to prevent them from dying? :("}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491418709, "post_id": 43239160, "comment_id": 73549082, "body": "By changing the function signature!"}, {"owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491419062, "post_id": 43239160, "comment_id": 73549288, "body": "@wildplasser i don&#39;t understand :("}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491419200, "post_id": 43239160, "comment_id": 73549374, "body": "Run the program with one child, and attach gdb to the child. (you should probably add some sleep to allow you to start gdb in an other terminal and attach ...)"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "edited": false, "score": 0, "creation_date": 1491421032, "post_id": 43239622, "comment_id": 73550434, "body": "I added a sleep and shows the message twice, if I add 4 it shows 4 times. How do I do for N sleeps ?.  Anyway, those sleep prevent me from killing the process so the SIGTERM signal does not work."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "edited": false, "score": 0, "creation_date": 1491421247, "post_id": 43239622, "comment_id": 73550544, "body": "Put the sleep in a loop. Your SIGTERM handler should set a global variable which indicates that the loop should terminate. (The variable should be volatile)"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1491423304, "post_id": 43239622, "comment_id": 73551763, "body": "Or check the return value of sleep.  It returns a value for a reason.   In fact, pretty much for this use case."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1491419158, "creation_date": 1491419158, "answer_id": 43239622, "question_id": 43239160, "link": "https://stackoverflow.com/questions/43239160/how-to-send-a-signal-to-a-child-several-times-avoiding-zombie-state-c-language/43239622#43239622", "title": "How to send a signal to a child several times avoiding zombie state? C language", "body": "<p>When the child receives the signal, it is probably waiting for the <code>sleep</code> to terminate. The first signal will interrupt the <code>sleep</code> even if the time hasn't expired, causing it to return with <code>errno</code> set to <code>EINTR</code>. If you want it to keep sleeping, you need to call <code>sleep</code> again.</p>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 1, "last_activity_date": 1491422413, "last_edit_date": 1491422413, "creation_date": 1491421987, "answer_id": 43240439, "question_id": 43239160, "link": "https://stackoverflow.com/questions/43239160/how-to-send-a-signal-to-a-child-several-times-avoiding-zombie-state-c-language/43240439#43240439", "title": "How to send a signal to a child several times avoiding zombie state? C language", "body": "<ul>\n<li>your parent process exited without wait()ing for the child</li>\n<li>The signals could be sent to fast, I added a short delay</li>\n<li>i added more delays</li>\n<li>the correct signature for a signal handler is <code>void handler(int signum)</code> This is crucial, because the handler is called with an argument, and the stack layout is different for signal handlers.</li>\n<li>you should not call printf() from a signal handler, it is not async safe.</li>\n</ul>\n\n<hr>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nchar pidstr[10];\nchar massage[]=\"        I'm the child and i received SIGUSR1\\n\";\n\n#define CNT 1\nvoid my_handler(int signum)\n{\nwrite(0, massage, strlen(massage));\n}\n\n\nint main (int argc, char **argv) {\n    int i , err, status;\n    pid_t pid1;\n    int array[CNT];\n\n    signal(SIGUSR1, my_handler);\n\n    for (i = 0; i&lt; CNT; i++) {\n        pid1 = fork();\n        if(pid1 &lt; 0) { exit(EXIT_FAILURE); }\n        else if (pid1 &gt; 0) {\n                printf(\"ChildPid=%d\\n\", pid1 );\n            array[i]= pid1;\n        }\n\n        else\n        {   // child\n                // signal(SIGUSR1, my_handler);\n            sprintf(pidstr,\"[%d]\", getpid() );\n            memcpy (massage,pidstr, strlen(pidstr));\n            sleep(10);\n                printf(\"Unslept\\n\");\n            sleep(10);\n                printf(\"Unslept\\n\");\n            sleep(10);\n                printf(\"Unslept\\n\");\n            exit(EXIT_SUCCESS);\n        }\n    }\n    sleep(10);\n    for (i=0; i&lt;3; i++) {\n        err = kill(array[0], SIGUSR1);\n        printf(\"Err=%d:%d\\n\", err, (err) ? errno: 0 );\n        sleep(1);\n    }\n\n    while ( (pid1=wait( &amp;status)) != -1){\n        printf(\"[Parent] Reaped %d\\n\", pid1);\n        }\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 43239622, "answer_count": 2, "score": 0, "last_activity_date": 1491422413, "creation_date": 1491417534, "question_id": 43239160, "link": "https://stackoverflow.com/questions/43239160/how-to-send-a-signal-to-a-child-several-times-avoiding-zombie-state-c-language", "title": "How to send a signal to a child several times avoiding zombie state? C language", "body": "<p>I need to send a signal to a child process 3 times.</p>\n\n<p>The problem is that the child only receives the signal once and then transforms into a zombie.</p>\n\n<p>The expected output would be:</p>\n\n<p>\u00a0I'm the child 11385 and i received SIGUSR1</p>\n\n<p>\u00a0I'm the child 11385 and i received SIGUSR1</p>\n\n<p>\u00a0I'm the child 11385 and i received SIGUSR1</p>\n\n<p>But the real output is:</p>\n\n<p>\u00a0I'm the child 11385 and i received SIGUSR1</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid my_handler()\n{\n  printf(\"\\n I'm the child %i and i received SIGUSR1\\n\", getpid());\n}\n\n\nint main (int argc, char **argv) {\n    int *array;\n    int N = 10;\n    int i;\n    pid_t pid1;\n    array=(int*)malloc(sizeof(int)*N);\n\n\n    signal(SIGUSR1,my_handler);\n\n    for (i = 0; i&lt; N; i++) \n    {\n        pid1 = fork();\n        if(pid1 &lt; 0)\n        {\n            exit(EXIT_FAILURE);\n        }\n        else if (pid1 &gt; 0)\n        {\n            array[i]= pid1;\n        }\n\n        else\n        {   \n            sleep(100);\n            exit(EXIT_SUCCESS);\n        }\n    }\n\n    i=0;\n    while(i&lt;3) // I need to call the son 3 times\n    {\n        kill(array[1], SIGUSR1);\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "timer", "signals", "getrusage"], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1491419496, "last_edit_date": 1491419496, "creation_date": 1491418182, "answer_id": 43239319, "question_id": 43239157, "link": "https://stackoverflow.com/questions/43239157/what-does-this-alarm-error-mean/43239319#43239319", "title": "What does this &quot;alarm&quot; error mean?", "body": "<p>First, setting an itimer to ring every 10 \u00b5s is optimistic, since ten microseconds is really a small interval of time. Try with 500 \u00b5s (or perhaps even 20 milliseconds, i.e. 20000 \u00b5s) instead of 10 \u00b5s first.</p>\n\n<blockquote>\n  <p>stop the execution in periods of 10 milliseconds</p>\n</blockquote>\n\n<p>You have coded for a period of 10 <em>micro</em>seconds, not milliseconds!</p>\n\n<p>Then, you should exchange the two lines and code:</p>\n\n<pre><code>signal(SIGALRM, medir_memoria);\nsetitimer(ITIMER_REAL, &amp;t,0);\n</code></pre>\n\n<p>so that a signal handler is set <em>before</em> the first itimer rings.</p>\n\n<p>I guess your first itimer rings before the signal handler was installed. Read carefully <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal(7)</a> and <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a>. The default handling of <code>SIGALRM</code> is termination.</p>\n\n<p>BTW, a better way to measure the time used by some function is <a href=\"http://man7.org/linux/man-pages/man2/clock_gettime.2.html\" rel=\"nofollow noreferrer\">clock_gettime(2)</a> or <a href=\"http://man7.org/linux/man-pages/man3/clock.3.html\" rel=\"nofollow noreferrer\">clock(3)</a>. Thanks to <a href=\"http://man7.org/linux/man-pages/man7/vdso.7.html\" rel=\"nofollow noreferrer\">vdso(7)</a> tricks, <code>clock_gettime</code> is able to get some clock in less than 50 nanoseconds on my i5-4690S desktop computer.</p>\n\n<blockquote>\n  <p>trying to get the memory consumed</p>\n</blockquote>\n\n<p>You could consider using <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">proc(5)</a> e.g. opening, reading, and closing <em>quickly</em> <code>/proc/self/status</code> or <code>/proc/self/statm</code>  etc....</p>\n\n<p><sup>(I guess you are on Linux)</sup></p>\n\n<p>BTW, your measurements will disappoint you: notice that quite often <a href=\"http://man7.org/linux/man-pages/man3/free.3.html\" rel=\"nofollow noreferrer\">free(3)</a> don't release memory to the kernel (thru <a href=\"http://man7.org/linux/man-pages/man2/munmap.2.html\" rel=\"nofollow noreferrer\">munmap(2)</a>...) but simply mark &amp; manage that zone to be reusable by <em>future</em> <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc(3)</a>. You might consider <a href=\"http://man7.org/linux/man-pages/man3/mallinfo.3.html\" rel=\"nofollow noreferrer\">mallinfo(3)</a> or <a href=\"http://man7.org/linux/man-pages/man3/malloc_info.3.html\" rel=\"nofollow noreferrer\">malloc_info(3)</a> but notice that it is not async-signal-safe so cannot be called from inside a signal handler.</p>\n\n<p><sup>(I tend to believe that your approach is deeply flawed)</sup></p>\n"}], "owner": {"reputation": 549, "user_id": 6237880, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b9476ed08c3626d74ec89c471dd3bf33?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime_mc2", "link": "https://stackoverflow.com/users/6237880/jaime-mc2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1491419496, "creation_date": 1491417530, "question_id": 43239157, "link": "https://stackoverflow.com/questions/43239157/what-does-this-alarm-error-mean", "title": "What does this &quot;alarm&quot; error mean?", "body": "<p>I am trying to get the memory consumed by an algorithm, so I have created a group of functions that would stop the execution in periods of 10 milliseconds to let me read the memory using the getrusage() function. The idea is to set a timer that will raise an alarm signal to the process which will be received by a handler medir_memoria().</p>\n\n<p>However, the program stops in the middle with this message:</p>\n\n<pre><code>[1]    3267 alarm    ./memory_test\n</code></pre>\n\n<p>The code for reading the memory is:</p>\n\n<pre><code>#include \"../include/rastreador_memoria.h\"\n\n#if defined(__linux__) || defined(__APPLE__) || (defined(__unix__) &amp;&amp; !defined(_WIN32))\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/resource.h&gt;\n\nstatic long max_data_size;\nstatic long max_stack_size;\n\nvoid medir_memoria (int sig)\n{\n    struct rusage info_memoria;\n\n    if (getrusage(RUSAGE_SELF, &amp;info_memoria) &lt; 0)\n    {\n        perror(\"Not reading memory\");\n    }\n\n    max_data_size = (info_memoria.ru_idrss &gt; max_data_size) ? info_memoria.ru_idrss : max_data_size;\n    max_stack_size = (info_memoria.ru_isrss &gt; max_stack_size) ? info_memoria.ru_isrss : max_stack_size;\n\n    signal(SIGALRM, medir_memoria);\n}\n\nvoid rastrear_memoria ()\n{\n    struct itimerval t;\n\n    t.it_interval.tv_sec = 0;\n    t.it_interval.tv_usec = 10;\n    t.it_value.tv_sec = 0;\n    t.it_value.tv_usec = 10;\n\n    max_data_size = 0;\n    max_stack_size = 0;\n\n    setitimer(ITIMER_REAL, &amp;t,0);\n    signal(SIGALRM, medir_memoria);\n}\n\nvoid detener_rastreo ()\n{\n    signal(SIGALRM, SIG_DFL);\n\n    printf(\"Data: %ld\\nStack: %ld\\n\", max_data_size, max_stack_size);\n}\n\n#else\n\n#endif\n</code></pre>\n\n<p>The main() function works calling all of them in this order:</p>\n\n<ol>\n<li>rastrear_memoria()</li>\n<li>Function of the algorithm I am testing</li>\n<li>detener_rastreo()</li>\n</ol>\n\n<p>How can I solve this? What does that alarm message mean?</p>\n"}, {"tags": ["c", "windows", "libxlsxwriter"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1491417445, "post_id": 43238767, "comment_id": 73548328, "body": "where did it put xlswriter.h?  Did you add that directory to your project properties?"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1491418396, "post_id": 43238767, "comment_id": 73548884, "body": "I didn&#39;t do anything with it, I thought it was supposed to be downloaded automatically?"}, {"owner": {"reputation": 28655, "user_id": 10238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c3b1025babebf20168dd90ea8f268c?s=128&d=identicon&r=PG", "display_name": "jmcnamara", "link": "https://stackoverflow.com/users/10238/jmcnamara"}, "edited": false, "score": 0, "creation_date": 1491420299, "post_id": 43238767, "comment_id": 73549997, "body": "Did you do the <a href=\"http://libxlsxwriter.github.io/getting_started.html#gsg_install\" rel=\"nofollow noreferrer\">&quot;install the library&quot;</a> step in those instructions?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1491422698, "post_id": 43238767, "comment_id": 73551383, "body": "You will definitely have to specify the include directory where xlswriter header files live in your project properties."}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1491432866, "post_id": 43238767, "comment_id": 73555948, "body": "I did a reinstallation and seems it&#39;s not going very well.  I edited the question"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1491582429, "post_id": 43253548, "comment_id": 73634161, "body": "Hey jmcnamara,  Thank you for your answer. I tried it again on another computer and it works. An now it is also working on my own computer! Maybe it needed a restart!   The library is very nice and even though I haven&#39;t fully finished my code yet, seems extremely promising.  Is there any way I can make it run through Devc++ though? I tried adding &#39;-lxlsxwriter -lz&#39; in Compiler options under the  &quot;Add the following commands when calling the linker:&quot; but it brings me  &#39;C:\\Program Files (x86)\\Dev-Cpp\\MinGW64\\x86_64-w64-mingw32\\bin\\ld.exe cannot find -lxlsxwriter&#39; and the same for -lz"}], "tags": [], "owner": {"reputation": 28655, "user_id": 10238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c3b1025babebf20168dd90ea8f268c?s=128&d=identicon&r=PG", "display_name": "jmcnamara", "link": "https://stackoverflow.com/users/10238/jmcnamara"}, "is_accepted": false, "score": 0, "last_activity_date": 1491477278, "creation_date": 1491477278, "answer_id": 43253548, "question_id": 43238767, "link": "https://stackoverflow.com/questions/43238767/xlsxwriter-installation-for-c-on-windows/43253548#43253548", "title": "xlsxwriter installation for C on windows", "body": "<p>It should work according to the <a href=\"https://libxlsxwriter.github.io/getting_started.html#gsg_ming\" rel=\"nofollow noreferrer\">instructions</a>. I re-ran them to check and everything worked:</p>\n\n<pre><code># Install MYSYS2 from http://www.msys2.org/\n# For the example below I used msys2-x86_64-20161025.exe\n\n# Run the MYSYS2 Shell and install the dependencies:\n$ cd /tmp\n$ pacman -S git gcc make zlib-devel\n\n# Clone, make, and install libxlswriter:\n$ git clone https://github.com/jmcnamara/libxlsxwriter.git\n$ cd libxlsxwriter/\n$ make\n$ make install\n\n# Create a sample C test file in another directory:\n$ cd ..\n$ mkdir mytmp\n$ cd mytmp\n$ vim myexcel.c\n$ cat myexcel.c\n#include \"xlsxwriter.h\"\n\nint main() {\n    lxw_workbook  *workbook  = workbook_new(\"myexcel.xlsx\");\n    lxw_worksheet *worksheet = workbook_add_worksheet(workbook, NULL);\n    int row = 0;\n    int col = 0;\n\n    worksheet_write_string(worksheet, row, col, \"Hello me!\", NULL);\n\n    return workbook_close(workbook);\n}\n\n# Compile and run the application:\n$ cc myexcel.c -o myexcel -lxlsxwriter -lz\n$ ./myexcel.exe\n\n$ ls -ltr\ntotal 1077\n-rw-r--r-- 1 jmcnamara Domain Users     313 Apr  6 19:02 myexcel.c\n-rwxr-xr-x 1 jmcnamara Domain Users 1093488 Apr  6 19:03 myexcel.exe\n-rw-r--r-- 1 jmcnamara Domain Users    5254 Apr  6 19:03 myexcel.xlsx\n</code></pre>\n\n<p>The issues that you are seeing are due to the header/library not been found so double check your installation stage.</p>\n\n<p>Also, this isn't the same issue as the other SO question that you linked to. In their case they had a mix or 32 and 64bit libraries that was causing link issues. I am the author of libxlsxwriter, btw.</p>\n"}], "owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1116, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1568898564, "creation_date": 1491416268, "last_edit_date": 1495541866, "question_id": 43238767, "link": "https://stackoverflow.com/questions/43238767/xlsxwriter-installation-for-c-on-windows", "title": "xlsxwriter installation for C on windows", "body": "<p>I am fairly new in C and I am trying to manipulate same data files and export them in an excel file.</p>\n\n<p>Similar to this case <a href=\"https://stackoverflow.com/questions/38464036/running-libxlsxwriter-on-window\">Running libxlsxwriter on Windows</a>, I am trying to install libxlsxwriter on windows usingMSYS2.</p>\n\n<p>I have done so far:</p>\n\n<p>1) Installed MSYS2 64 bit along with the installation instructions</p>\n\n<p>2) From MSYS2 terminal <code>pacman -S git gcc make zlib-devel</code></p>\n\n<p>3) And also:</p>\n\n<pre><code>git clone https://github.com/jmcnamara/libxlsxwriter.git\n\nMichKon@MichKon-PC MSYS ~\n$ cd libxlsxwriter\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ make\nmake[1]: Entering directory '/home/MichKon/libxlsxwriter/third_party/minizip'\nmake[1]: Leaving directory '/home/MichKon/libxlsxwriter/third_party/minizip'\nmake[1]: Entering directory '/home/MichKon/libxlsxwriter/third_party/tmpfileplus'\nmake[1]: Leaving directory '/home/MichKon/libxlsxwriter/third_party/tmpfileplus'\nmake[1]: Entering directory '/home/MichKon/libxlsxwriter/src'\nmake[1]: Leaving directory '/home/MichKon/libxlsxwriter/src'\n\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ make install\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ cc myexcel.c -o myexcel -lxlsxwriter\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1bc9): undefined reference to `crc32'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1bc9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `crc32'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1d1f): undefined reference to `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1d1f): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2280): undefined reference to `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2280): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x238a): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x238a): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x25e6): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x25e6): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2649): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2649): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2e06): undefined reference to `deflateInit2_'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2e06): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateInit2_'\ncollect2: error: ld returned 1 exit status\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ ./myexcel\nbash: ./myexcel: No such file or directory\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ cc myexcel.c -o myexcel -lxlsxwriter\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1bc9): undefined reference to `crc32'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1bc9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `crc32'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1d1f): undefined reference to `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x1d1f): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2280): undefined reference to `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2280): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflate'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x238a): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x238a): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x25e6): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x25e6): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2649): undefined reference to `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2649): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateEnd'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2e06): undefined reference to `deflateInit2_'\n/usr/lib/../lib/libxlsxwriter.a(zip.o):zip.c:(.text+0x2e06): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `deflateInit2_'\ncollect2: error: ld returned 1 exit status\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ ./myexcel\nbash: ./myexcel: No such file or directory\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ xdg-open myexcel.xlsx\nbash: xdg-open: command not found\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ cc myexcel.c -o myexcel -I /path/to/libxlsxwriter/include\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x15): undefined reference to `workbook_new'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x15): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_new'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x2a): undefined reference to `workbook_add_worksheet'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x2a): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_add_worksheet'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x64): undefined reference to `worksheet_write_string'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x64): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `worksheet_write_string'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x70): undefined reference to `workbook_close'\n/tmp/ccp8qMT9.o:myexcel.c:(.text+0x70): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_close'\ncollect2: error: ld returned 1 exit status\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ ./myexcel\nbash: ./myexcel: No such file or directory\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ cc myexcel.c -o myexcel -I /path/to/libxlsxwriter/lib/libxlsxwiter.a -lz\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x15): undefined reference to `workbook_new'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x15): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_new'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x2a): undefined reference to `workbook_add_worksheet'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x2a): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_add_worksheet'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x64): undefined reference to `worksheet_write_string'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x64): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `worksheet_write_string'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x70): undefined reference to `workbook_close'\n/tmp/ccgsiylm.o:myexcel.c:(.text+0x70): relocation truncated to fit: R_X86_64_PC 32 against undefined symbol `workbook_close'\ncollect2: error: ld returned 1 exit status\n\nMichKon@MichKon-PC MSYS ~/libxlsxwriter\n$ make myexcel\ncc     myexcel.c   -o myexcel\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x15): undefined reference to `workbook_new'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x15): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `workbook_new'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x2a): undefined reference to `workbook_add_worksheet'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x2a): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `workbook_add_worksheet'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x64): undefined reference to `worksheet_write_string'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x64): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `worksheet_write_string'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x70): undefined reference to `workbook_close'\n/tmp/ccMI33kF.o:myexcel.c:(.text+0x70): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `workbook_close'\n</code></pre>\n\n<p>collect2: error: ld returned 1 exit status\nmake: *** [: myexcel] Error 1</p>\n\n<pre><code>MichKon@MichKon-PC MSYS ~/libxlsxwriter\n$\n</code></pre>\n\n<p>So it doesn't seem to work at the end. There is no exe file created.\nIt seems that the last three commands are ordering a compileing, but something is wrong with the header files...</p>\n\n<p>Thank you for your time</p>\n\n<p>EDIT:</p>\n\n<p>So I have looked deeper into this solution: <a href=\"https://stackoverflow.com/questions/38464036/running-libxlsxwriter-on-windows\">Running libxlsxwriter on Windows</a> as it seems I have a similar problem as Carl.</p>\n\n<p>Make does not work except if I place the .c file inside one of the predefined files like examples, then through the command window I can compile and run it.\nBut I would like to know if there is anything that can be done in order to be able to compile and run the files normally, like any other C files through Devc++.</p>\n\n<p>I tried adding <code>C:\\msys64\\usr\\bin</code> in user and computer PATH (environment variables) but it doesn't seem to work.</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491596997, "post_id": 43238661, "comment_id": 73641403, "body": "this kind of expression: <code>write_msg[1]!=NULL)</code> will NEVER happen.  write_msg[] is an array of characters and NULL is a pointer to address 0.  A pointer is never a character."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597126, "post_id": 43238661, "comment_id": 73641457, "body": "tis line, near the top of main(), <code>close(4);</code> is trash because file descriptor 4 has not been opened"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597236, "post_id": 43238661, "comment_id": 73641501, "body": "this line: <code>read(3,output,BUFFER_SIZE);</code> is very suspect because no files have been opened (except the standard 0=stdin, 1=stdout, and 2=stderr.)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597351, "post_id": 43238661, "comment_id": 73641568, "body": "this expression: <code>output[1]==NULL)</code> will never happen (see my prior comment.  Perhaps you meant: <code>output[1]==&#39;\\0&#39;)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597523, "post_id": 43238661, "comment_id": 73641621, "body": "calls to system functions should always be checked for error indications.  The function: <code>read()</code>, if it read any characters, returns a count of the number characters read.  That should be checked rather than assuming that characters were actually read."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597596, "post_id": 43238661, "comment_id": 73641656, "body": "in C, buffer offsets start with 0 and end at (length of buffer -1).  So this line: <code>char write_msg[BUFFER_SIZE]=&quot;A&quot;;</code> is placing the char <code>A</code> one past the end of the buffer.  This results in undefined behavior and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597774, "post_id": 43238661, "comment_id": 73641724, "body": "code should not depend on the OS to cleanup.  Rather the code should cleanup (calls to <code>free()</code>, <code>close()</code>, etc.)  the exit point that displays the message &quot;Fork failed&quot; should be calling <code>close()</code> on each end of the pipe. I.E. <code>close(fd[0]);</code> and <code>close(fd[1]);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491597905, "post_id": 43238661, "comment_id": 73641777, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful.  When using the &quot;%s&quot; input/conversion specifier, always include a MAX CHARACTERS that is one less than the length of the input buffer to avoid any buffer overflow.  A buffer overflow is undefined behavior and can lead to a seg fault event"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491598615, "post_id": 43238661, "comment_id": 73642062, "body": "the parent process, if it exits before the child process will make the child process a zombie  zombie processes are very difficult to eliminate/kill without rebooting the computer.  Suggest at the end of the parent processing to insert the statements: <code>int status; wait( &amp;status );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7822391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91a6ee538f9a299ade4ba6b8fd986ec?s=128&d=identicon&r=PG&f=1", "display_name": "Yoohao", "link": "https://stackoverflow.com/users/7822391/yoohao"}, "edited": false, "score": 0, "creation_date": 1491419025, "post_id": 43238869, "comment_id": 73549258, "body": "oh, i got it. So in the beginning my idea is wrong. Thank you for your comment.  I have two more problem.   1) I tested that thepid of process running in xterm windows is not the original pid of child process. Is it one of the child of the parent process?   2) If i use the <code>system</code> to call the xterm and execute the program instead, can it running as this code similarly? Or there are something different between two way?   Sorry about that a lots question and Thank you agian!"}, {"owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "edited": false, "score": 0, "creation_date": 1491419027, "post_id": 43238869, "comment_id": 73549261, "body": "or use <code>strcmp(output, &quot;Q&quot;)</code>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 9, "user_id": 7822391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91a6ee538f9a299ade4ba6b8fd986ec?s=128&d=identicon&r=PG&f=1", "display_name": "Yoohao", "link": "https://stackoverflow.com/users/7822391/yoohao"}, "edited": false, "score": 0, "creation_date": 1491419880, "post_id": 43238869, "comment_id": 73549758, "body": "@Yoohao The child process is the one you exec&#39;ed which is <code>xterm</code> and <code>xterm</code> again forks and exec&#39;s <i>your</i> program (the one that writes to the x window). SO, obviously, the PID are different. <code>system()</code> instead of execl() can provide similar functionality way but isn&#39;t good approach because <code>system()</code> will fork again and execute the <i>command</i> via a shell you give  as a child and wait for the child to finish -- which, as you can see, involves unnecessary fork and exec&#39;ing a shell where a simple exec could do."}, {"owner": {"reputation": 9, "user_id": 7822391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91a6ee538f9a299ade4ba6b8fd986ec?s=128&d=identicon&r=PG&f=1", "display_name": "Yoohao", "link": "https://stackoverflow.com/users/7822391/yoohao"}, "edited": false, "score": 0, "creation_date": 1491470397, "post_id": 43238869, "comment_id": 73570726, "body": "Thanks a lots. And you mentioned that doing <code>system</code> involves unnecessary fork. If involving unnecessary fork, does it result in any consequence? Thank you for your help and answer, agiain."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 9, "user_id": 7822391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91a6ee538f9a299ade4ba6b8fd986ec?s=128&d=identicon&r=PG&f=1", "display_name": "Yoohao", "link": "https://stackoverflow.com/users/7822391/yoohao"}, "edited": false, "score": 0, "creation_date": 1491470901, "post_id": 43238869, "comment_id": 73571070, "body": "@Yoohao Any unnecessary operation adds overhead: wastes CPU cycles, memory, starves other processes for resources, etc. Inefficient code is the consequence ;-)"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1491416985, "last_edit_date": 1491416985, "creation_date": 1491416635, "answer_id": 43238869, "question_id": 43238661, "link": "https://stackoverflow.com/questions/43238661/how-does-this-code-work-between-two-process/43238869#43238869", "title": "How does this code work between two process?", "body": "<blockquote>\n  <p>But the child proccss in this execute the execlp function to open a new terminal window and run the same program sequentially. The new window isn't the child of the parent process. </p>\n</blockquote>\n\n<p>That's not right. The new window <em>is</em> the child process. <code>execl()</code> just replaces the child process with another process image but it's still the child process. So, the parent and child can communicate via the pipe. Your code is classic example and parent and child can communicate via unix pipe.</p>\n\n<p>The child process executes the <code>if (argc==2){ ... }</code> code because it's given an arugment (in <code>execl()</code> -- so its argc is 2). The parent process is intended to be run with no arguments.</p>\n\n<p>By the way, there are a couple of issues:</p>\n\n<p>1) You probably want to check if <code>output[1]</code> is <code>\\0</code> (null byte), not NULL. That'd make sense in order to terminate the communication (and the processes) by inputting <code>Q</code>.\nSo, this:</p>\n\n<pre><code> if(output[0]=='Q'&amp;&amp;output[1]==NULL){                    \n</code></pre>\n\n<p>should be:</p>\n\n<pre><code> if(output[0] == 'Q'&amp;&amp;output[1] == '\\0'){\n</code></pre>\n\n<p>2) Similarly,</p>\n\n<pre><code>  while (write_msg[0]!='Q'||write_msg[1]!=NULL){\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>  while (write_msg[0] != 'Q' || write_msg[1] != '\\0'){\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1491417538, "post_id": 43238905, "comment_id": 73548377, "body": "Note that POSIX requires the file descriptors are allocated sequentially. So, the given code is quite safe to assume 3 and 4 are fds of pipe. But I agree this may not be the best approach <i>in general</i> if there are going to fds closed/opened. One way to break is to run as: <code>.&#47;main &lt;&#47;dev&#47;null</code> ;-)"}, {"owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1491418753, "post_id": 43238905, "comment_id": 73549104, "body": "@usr, plain redirecting wouldn&#39;t affect the fd numbers, you&#39;d need to do something like <code>&lt;&amp;-</code> to close the fd or <code>3&lt;&#47;dev&#47;null</code> to open a new one. But yes, it works as long as the main program only inherits the usual three fd&#39;s."}], "tags": [], "owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "is_accepted": false, "score": 1, "last_activity_date": 1491418971, "last_edit_date": 1491418971, "creation_date": 1491416747, "answer_id": 43238905, "question_id": 43238661, "link": "https://stackoverflow.com/questions/43238661/how-does-this-code-work-between-two-process/43238905#43238905", "title": "How does this code work between two process?", "body": "<p>The <code>xterm</code> executed by the child <em>is</em> a child of the original program. The <code>fork</code>, then <code>exec</code> is the normal way to start another process on Unix-like systems.</p>\n\n<p>When the program forks, another copy of it appears. The only difference between them is the return value from <code>fork</code>. Here, the child then replaces itself with <code>xterm</code>, setting the arguments so that <code>xterm</code> starts another copy of the original program. As long as <code>xterm</code> doesn't mess with the file descriptors of the pipe, they stay open and are inherited to whatever process xterm runs.</p>\n\n<p>The one-argument version (<code>argc==2</code>) of the main program trusts that the pipe file descriptors get numbers 3 and 4, which would be the usual result, assuming the original program didn't have any fd's open apart from stdin, stdout and stderr. This isn't robust, though. To do it properly you'd want to give the fd numbers to the child as command line arguments or through the environment; or use <code>dup2()</code> in the parent to make sure the pipe is open on fd's 3 and 4.</p>\n"}], "owner": {"reputation": 9, "user_id": 7822391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91a6ee538f9a299ade4ba6b8fd986ec?s=128&d=identicon&r=PG&f=1", "display_name": "Yoohao", "link": "https://stackoverflow.com/users/7822391/yoohao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1491418971, "creation_date": 1491415936, "question_id": 43238661, "link": "https://stackoverflow.com/questions/43238661/how-does-this-code-work-between-two-process", "title": "How does this code work between two process?", "body": "<p>I am doing some practice and got this code recently.</p>\n\n<pre><code>#include&lt;sys/types.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;unistd.h&gt;\n\n#define BUFFER_SIZE 25\n#define READ_END 0\n#define WRITE_END 1\n\nint main(int argc,char *argv[]){                                    \n    if (argc==2){                                                   \n        char output[BUFFER_SIZE];                                   \n        close(4);                                                   \n        while(1){\n            read(3,output,BUFFER_SIZE);                             \n            if(output[0]=='Q'&amp;&amp;output[1]==NULL){                    \n                return 0;\n            }\n            printf(\"%s\\n\",output);                                  \n        }\n    }\n\n    if(argc==1){                                                    \n        char write_msg[BUFFER_SIZE]=\"A\";                            \n        int fd[2];                                                  \n        pid_t pid;                                                  \n\n        if(pipe(fd)==-1){                                           \n            fprintf(stderr,\"Pipe failed\");\n            return 1;\n        }\n\n        pid = fork();                                               \n\n        if(pid&lt;0){                                                  \n            fprintf(stderr,\"Fork failed\");\n            return 1;\n        }\n\n        if(pid&gt;0){                                                  \n            close(fd[READ_END]);                                    \n            while (write_msg[0]!='Q'||write_msg[1]!=NULL){          \n                scanf(\"%s\",write_msg);                              \n                write(fd[WRITE_END],write_msg,strlen(write_msg)+1); \n            }\n\n            close(fd[WRITE_END]);                                   \n        }\n        if(pid==0){                                                 \n            execl(\"/usr/bin/xterm\",\"xterm\",\"-e\",argv[0],\"1\",NULL); \n        }\n        return 0;\n        }\n}\n</code></pre>\n\n<p>I want to ask that how does this work. In my opinion, pipe can communicate between parent process and child process. But the chile proecss in this execute the <code>execlp</code> function to open a new terminal window and run the same program sequentially. The new window isn't the child of the parent process. However, it can receive the string from the pipe file descriptor. I can't understand why and wanna know that how does it work between two process. </p>\n\n<p>I've been confused for a while.\nHope someone could help me. Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491415172, "post_id": 43238423, "comment_id": 73546996, "body": "What&#39;s wrong with <code>scanf(&quot;%d&quot;, &amp;(a.ant));</code>?"}, {"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1491415369, "post_id": 43238423, "comment_id": 73547110, "body": "Are you saying if user input is <code>&quot;ant&quot;</code>, then you want to print the value of <code>a.ant</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491415508, "post_id": 43238423, "comment_id": 73547186, "body": "Post examples: pairs of text input and expected results."}, {"owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "edited": false, "score": 0, "creation_date": 1491416132, "post_id": 43238423, "comment_id": 73547519, "body": "please explain your question, what it is about ??"}, {"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491417088, "post_id": 43238423, "comment_id": 73548118, "body": "I have edited my question . Please check."}, {"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491417125, "post_id": 43238423, "comment_id": 73548137, "body": "Sourav. My structures are not as simple as above mentioned in my question. It is highly complex with lot of arrays and nested structures."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491418902, "post_id": 43238423, "comment_id": 73549195, "body": "@vip  I think you need to divide and conquer else you are asking for a general purpose data base engine.  Step 1, Get user input as text.  Step 2) parse input input into a query type based on variable name, {array index, member names}, (this part recursively) and step 3) accessing the data based on the query.  Perhaps steps 2/3 could be recursively.  All in all  this may be 10 to 100s of time more code than posted here given the far-reaching &quot;It is highly complex with lot of arrays and nested structures&quot;.  If this is too much, perhaps C is not the target language for your task."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491417303, "post_id": 43239013, "comment_id": 73548235, "body": "what is the output if my input is ant? I don&#39;t think above solution works"}, {"owner": {"reputation": 419, "user_id": 4060054, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000167524995/picture?type=large", "display_name": "Nirvedh Meshram", "link": "https://stackoverflow.com/users/4060054/nirvedh-meshram"}, "reply_to_user": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491417627, "post_id": 43239013, "comment_id": 73548433, "body": "ant is a variable name.  Your variable value is hi. So if you enter hi. you will get the value &quot;1&quot; allocated with your structure. I read your edited question now and I noticed you want to query a string with an integer. I dont  understand what you mean by that. Myabe you will have to give a more complex example and show where you are stuck."}, {"owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491417989, "post_id": 43239013, "comment_id": 73548649, "body": "Hi Nirvedh. All I need is a way to convert the user input query string to a variable name and get the value of the variable. If my input  is &quot;ant&quot; i need to get the value of variable ant. If my input is &quot;str&quot;, i need to get the value of char str[] ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "edited": false, "score": 0, "creation_date": 1491418502, "post_id": 43239013, "comment_id": 73548947, "body": "@vip &quot; my input is &quot;ant&quot; i need to get the value of variable ant.&quot; is unclear.  Posted code has variable <code>a</code>.  Variable <code>a</code> has an <code>int</code>  <i>member</i> <code>amt</code>.  Sounds like you want &quot;If my input is <code>&quot;ant&quot;</code> , I need to get the value of <code>a.ant</code>&quot;."}], "tags": [], "owner": {"reputation": 419, "user_id": 4060054, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000167524995/picture?type=large", "display_name": "Nirvedh Meshram", "link": "https://stackoverflow.com/users/4060054/nirvedh-meshram"}, "is_accepted": false, "score": 0, "last_activity_date": 1491417075, "creation_date": 1491417075, "answer_id": 43239013, "question_id": 43238423, "link": "https://stackoverflow.com/questions/43238423/query-the-structure-field-with-the-user-input-in-c/43239013#43239013", "title": "Query the structure field with the user input in C", "body": "<p>Do you just want to search the name and find the integer value on that name if it exists. this is how you can do it.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\ntypedef struct {\n  int ant;\n  char str[50];\n\n}Sample;\n\n void  main ()\n    {\n       Sample a = { 1, \"hi\" };\n       char query[50];\n       printf(\"enter the query object inside the Sample structure: \");\n       scanf (\"%s\", query );\n        if(strcmp(a.str,query)==0) printf(\"Matched values is %d\\n\",a.ant);\n        else printf(\"Not found\\n\");\n\n\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1491418974, "last_edit_date": 1491418974, "creation_date": 1491418220, "answer_id": 43239333, "question_id": 43238423, "link": "https://stackoverflow.com/questions/43238423/query-the-structure-field-with-the-user-input-in-c/43239333#43239333", "title": "Query the structure field with the user input in C", "body": "<p>Ask the user for the member name and then selectivity print its contents.</p>\n\n<p>Lots of additional possibilities to detect/ignore leading/trailing white-space, case insensitivity, EOF handling, etc., especially given the post's scant details.</p>\n\n<pre><code>   char query[50];\n   puts(\"enter the query object inside the Sample structure\");\n   fgets(query, sizeof query, stdin);\n   // trim potential \\n\n   query[strcspn(query, \"\\n\")] = 0;\n\n   if (strcmp(query, \"ant\")== 0) {\n     printf(\"%d\\n\", a.amt);\n   } else if (strcmp(query, \"str\")== 0) {\n     printf(\"%s\\n\", a.str); \n   } else {\n     puts(\"Field not present\"); \n   }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7788194, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3f4a019e027dd84f48cb7e517e177487?s=128&d=identicon&r=PG&f=1", "display_name": "vip", "link": "https://stackoverflow.com/users/7788194/vip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1491418974, "creation_date": 1491415100, "last_edit_date": 1491417707, "question_id": 43238423, "link": "https://stackoverflow.com/questions/43238423/query-the-structure-field-with-the-user-input-in-c", "title": "Query the structure field with the user input in C", "body": "<p>I am experimenting a new thing in C to convert the user input string to the structure field and then obtain the value of it.</p>\n\n<pre><code>typedef struct {\n  int ant;\n  char str[50];\n\n}Sample;\n\nmain ()\n    {\n       Sample a = { 1, \"hi\" };\n       char query[50];\n       scanf (\"enter the query object inside the Sample structure %s\", query );\n\n       /* Search and print function */\n       ex : now my query is for field ant \n       How do I convert the query string input \"ant\" to a.ant and print the value of ant ?\n    }  \n</code></pre>\n\n<p>Please pardon me If I am not clear in my explanation.</p>\n\n<pre><code>Input : ant  Output : 1\nInput: str   Output : hi\nINput: rat   Output: Field not present\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7012, "user_id": 1401019, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bD72E.jpg?s=128&g=1", "display_name": "Sundararaj Govindasamy", "link": "https://stackoverflow.com/users/1401019/sundararaj-govindasamy"}, "edited": false, "score": 1, "creation_date": 1491413857, "post_id": 43237996, "comment_id": 73546166, "body": "Refer <a href=\"http://stackoverflow.com/questions/20577557/whats-the-meaning-of-the-m-formatting-specifier\" title=\"whats the meaning of the m formatting specifier\">stackoverflow.com/questions/20577557/&hellip;</a>"}, {"owner": {"reputation": 19, "user_id": 7131717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303a314f3d71cc2650083f7fa53192b8?s=128&d=identicon&r=PG&f=1", "display_name": "thartvik", "link": "https://stackoverflow.com/users/7131717/thartvik"}, "edited": false, "score": 0, "creation_date": 1491414316, "post_id": 43237996, "comment_id": 73546474, "body": "The other thread is how to use it in a printf, for error handeling, i read it and the links it still doesent explain the usage in a scanf and how it works in a scanf."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491414482, "post_id": 43237996, "comment_id": 73546573, "body": "See <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">this part of  m modifier and example</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1491414509, "post_id": 43237996, "comment_id": 73546591, "body": "<a href=\"https://linux.die.net/man/3/sscanf\" rel=\"nofollow noreferrer\">This page</a> says <i>&quot;... An optional &#39;m&#39; character. This is used with string conversions (%s, %c, %[), and relieves the caller of the need to allocate a corresponding buffer to hold the input: instead, scanf() allocates a buffer of sufficient size, and assigns the address of this buffer to the corresponding pointer argument, which should be a pointer to a char * variable (this variable does not need to be initialized before the call). The caller should subsequently free(3) this buffer when it is no longer required.&quot;</i>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491414811, "post_id": 43237996, "comment_id": 73546788, "body": "@WeatherVane <i>It is specified in the POSIX.1-2008 standard.</i>"}, {"owner": {"reputation": 19, "user_id": 7131717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303a314f3d71cc2650083f7fa53192b8?s=128&d=identicon&r=PG&f=1", "display_name": "thartvik", "link": "https://stackoverflow.com/users/7131717/thartvik"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491415897, "post_id": 43237996, "comment_id": 73547384, "body": "@Weather Vane Thank you for the links, they didnt show up when i googled. They explained it very well."}, {"owner": {"reputation": 19, "user_id": 7131717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303a314f3d71cc2650083f7fa53192b8?s=128&d=identicon&r=PG&f=1", "display_name": "thartvik", "link": "https://stackoverflow.com/users/7131717/thartvik"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491415902, "post_id": 43237996, "comment_id": 73547387, "body": "@BLUEPIXY  Thank you for the links, they didnt show up when i googled. They explained it very well."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1491416653, "post_id": 43237996, "comment_id": 73547865, "body": "Not from knowledge but by googling &quot;C scanf gnu format specifier %m&quot; suggested by the first comment."}], "owner": {"reputation": 19, "user_id": 7131717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303a314f3d71cc2650083f7fa53192b8?s=128&d=identicon&r=PG&f=1", "display_name": "thartvik", "link": "https://stackoverflow.com/users/7131717/thartvik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1491414653, "answer_count": 0, "score": 0, "last_activity_date": 1491416955, "creation_date": 1491413738, "last_edit_date": 1491416955, "question_id": 43237996, "link": "https://stackoverflow.com/questions/43237996/could-someone-explain-m", "closed_reason": "Duplicate", "title": "Could someone explain &quot;%m&quot;", "body": "<p>Im pretty new to C. And i was stumbeling on %m in scanf when i was trying to build a function similar to input() in Python3.</p>\n\n<p>And i tried it and it worked i i dont know why. The code:</p>\n\n<pre><code>void *input(char *startStr){\n      char *str;\n      printf(startStr);\n      scanf(\"%m[^\\n]\", &amp;str);\nreturn str; }\n</code></pre>\n\n<p>The %m doesn't seem to be a standard specifier in C.\nMy dev environment is on Ubuntu with gcc 6.2.0?</p>\n\n<p>Any Captain here that could explain it for me?</p>\n\n<p>And thank you for being Awesome people on this community!</p>\n\n<p>EDIT:\nWe can close this question, all the links provided will explain it, and there's a similar question asked, that didn't show up when i searched StackOverflow for my problem. But now i'm enlightened in this question, and i hope all others in their hunt for enlightenment will follow the links provided to get their answer in this particular domain of specifiers for scanf. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/38685724/difference-between-ms-and-s-scanf\">difference between %ms and %s scanf</a></p>\n\n<p><a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/scanf</a></p>\n\n<p><a href=\"https://linux.die.net/man/3/sscanf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/sscanf</a></p>\n"}, {"tags": ["c", "string", "null", "strtok"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1491413510, "post_id": 43237830, "comment_id": 73545933, "body": "Read the docs?  (e.g. <a href=\"http://man7.org/linux/man-pages/man3/strtok.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/strtok.3.html</a>)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491413522, "post_id": 43237830, "comment_id": 73545940, "body": "This means continuing processing. Also <code>space = strtok(NULL,&quot; &quot;);puts(space);</code> --&gt; <code>puts(space);space = strtok(NULL,&quot; &quot;);</code>"}, {"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 0, "creation_date": 1491413570, "post_id": 43237830, "comment_id": 73545973, "body": "a) don&#39;t use <code>strtok()</code> in new code, there&#39;s a reason for <a href=\"http://man7.org/linux/man-pages/man3/strsep.3.html\" rel=\"nofollow noreferrer\"><code>strsep()</code></a>. b) What&#39;s unclear about <code>strtok()</code>? It internally stores tokenization context, so if you call it with <code>strtok(NULL, ...)</code>, it continues to operate on the most recent string."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491413645, "post_id": 43237830, "comment_id": 73546013, "body": "It is a confusing call because strtok() maintains internal state in statics - something that  makes it difficult to understand how subsequent calls work at all, (unless in multithreaded code, in which case they don&#39;t:)."}, {"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 0, "creation_date": 1491413693, "post_id": 43237830, "comment_id": 73546051, "body": "Your code is broken and it can crash, also, what part is unclear from <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\">docs</a>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1491413799, "post_id": 43237830, "comment_id": 73546123, "body": "<code>NULL</code> informs <code>strtok()</code> to continue tokenizing from where it last stopped.  A non-<code>NULL</code> value says to start anew."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1491414316, "post_id": 43237830, "comment_id": 73546477, "body": "Beware confusion between &quot;string&quot;, &quot;array&quot;, and &quot;pointer&quot;. <code>space</code> in your code is not a string: it&#39;s a pointer (pointing to (parts of) an array (each part being a string after strtok changed the array contents))."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1491415071, "last_edit_date": 1491415071, "creation_date": 1491414221, "answer_id": 43238140, "question_id": 43237830, "link": "https://stackoverflow.com/questions/43237830/why-i-need-to-use-null-pointer-when-using-strtok-in-c/43238140#43238140", "title": "Why I need to use NULL pointer when using strtok() in C?", "body": "<p>Quoting <code>C11</code>, chapter \u00a77.24.5.8, P4 (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The <code>strtok</code> function then searches from there for a character that is contained in the\n  current separator string. If no such character is found, the current token extends to the\n  end of the string pointed to by <code>s1</code>, and subsequent searches for a token will return a null\n  pointer. <strong>If such a character is found, it is overwritten by a null character, which\n  terminates the current token. The <code>strtok</code> function saves a pointer to the following\n  character, from which the next search for a token will start.</strong></p>\n</blockquote>\n\n<p>and P5,</p>\n\n<blockquote>\n  <p><strong>Each subsequent call, with a null pointer as the value of the first argument, starts\n  searching from the saved pointer</strong> [...]</p>\n</blockquote>\n\n<p>So, this is a feature which enables <code>strtok()</code> to continue parsing the <em>leftover</em> of the initially supplied string.</p>\n\n<p>To put it in other words, an input string, containing multiple instances of the delimiter can be parsed using a simple loop using this feature. For example, if a \"sentence\" is to be tokenized based on the \"whitespace\"s to separate out each \"word\" , then, after the first call, a simple loop, calling <code>strtok()</code> with <code>NULL</code> as first argument will make use of internal save pointer and require less explicit effort to manage the remainder of the actual sentence.</p>\n\n<p>Without this feature, manual effort would have been required to keep a tab of the <em>progress</em> made in search of the delimiter.</p>\n"}, {"tags": [], "owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "is_accepted": false, "score": 0, "last_activity_date": 1491414232, "last_edit_date": 1495540464, "creation_date": 1491414232, "answer_id": 43238144, "question_id": 43237830, "link": "https://stackoverflow.com/questions/43237830/why-i-need-to-use-null-pointer-when-using-strtok-in-c/43238144#43238144", "title": "Why I need to use NULL pointer when using strtok() in C?", "body": "<p>First of all, you should read again the <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\">docs</a> and make sure you understand each parameter and the return.</p>\n\n<p>Second, your code is broken, at certain point <code>puts</code> will use NULL as argument and it'll crash, you could fix it like this:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    char str[100] = \"nahin bin kaysar\";\n    const char s[2] = \" \";\n    char *token;\n\n    token = strtok(str, s);\n    printf(\"%s\", token);\n    while (token != NULL) {\n        puts(token);\n        token = strtok(NULL, s);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>In any case, if you have questions after reading carefully the documentation this other <a href=\"https://stackoverflow.com/questions/3889992/how-does-strtok-split-the-string-into-tokens-in-c\">thread</a> maybe can help you out.</p>\n"}], "owner": {"reputation": 1, "user_id": 7741007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ApIPw6XVDfI/AAAAAAAAAAI/AAAAAAAAAC0/er59ztCiZSQ/photo.jpg?sz=128", "display_name": "Nahin Bin Kaysar", "link": "https://stackoverflow.com/users/7741007/nahin-bin-kaysar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1491415071, "creation_date": 1491413216, "question_id": 43237830, "link": "https://stackoverflow.com/questions/43237830/why-i-need-to-use-null-pointer-when-using-strtok-in-c", "title": "Why I need to use NULL pointer when using strtok() in C?", "body": "<p>First my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char str[100]=\"nahin bin kaysar\";\n    char *space;\n\n    space = strtok(str,\" \");\n    while(space != NULL) {\n        space = strtok(NULL,\" \");\n        puts(space);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I know this program will split the string into three different parts. Before the loop I split the first word and assigned to the string <code>space</code>. But my question is why I had to use<code>NULL</code> pointer inside the loop as a parameter of the <code>strtok()</code> function. I have searched it for hours and no answer satisfied my needs.</p>\n"}, {"tags": ["c", "x11", "xlib"], "answers": [{"tags": [], "owner": {"reputation": 9597, "user_id": 730194, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/fb75af7a871d88919d9cc7c0c9e687e9?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/730194/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1491499343, "creation_date": 1491499343, "answer_id": 43261915, "question_id": 43237104, "link": "https://stackoverflow.com/questions/43237104/picture-format-for-net-wm-icon/43261915#43261915", "title": "Picture format for _NET_WM_ICON", "body": "<p>I have confirmed that the format is indeed BGRA with four extra bytes of padding. I enumerated through all the running applications and was able to extract the icons properly.</p>\n"}, {"tags": [], "owner": {"reputation": 1546, "user_id": 251448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f21fe8478dd06a43cba6dd810d2691?s=128&d=identicon&r=PG", "display_name": "doshea", "link": "https://stackoverflow.com/users/251448/doshea"}, "is_accepted": false, "score": 1, "last_activity_date": 1514548754, "creation_date": 1514548754, "answer_id": 48022282, "question_id": 43237104, "link": "https://stackoverflow.com/questions/43237104/picture-format-for-net-wm-icon/48022282#48022282", "title": "Picture format for _NET_WM_ICON", "body": "<p>From the <code>XGetWindowProperty(3)</code> man page on CentOS 7, this refers to the parameter for which you're passing the argument <code>data</code>:</p>\n\n<pre>\n       prop_return\n                 Returns the data in the specified format.  If the returned\n                 format is 8, the returned data is represented as a char\n                 array. If the returned format is 16, the returned data is\n                 represented as a array of short int type and should be cast\n                 to that type to obtain the elements. If the returned format\n                 is 32, the property data will be stored as an array of longs\n                 (which in a 64-bit application will be 64-bit values that are\n                 padded in the upper 4 bytes).\n</pre>\n\n<p>I assume you'd find that the <code>actual_format_return</code> is 32 (since the specification seems to indicate that this is the only valid format for <code>_NET_WM_ICON</code>), and presumably your application is 64-bit, meaning that your <code>long</code> type is 64 bits long, hence the padding.</p>\n\n<p>As for why the padding bits are all set to <code>1</code> instead of <code>0</code>, I'm not so sure.  The function signature in the man page shows <code>unsigned char **prop_return</code>, but the text quoted above says that it is an \"array of longs\", not \"an array of unsigned longs\", so perhaps this is intended to be taken literally (or was taken literally by the author of the application whose icon you are retrieving), and some sign extension has taken place somewhere prior to your application receiving the data.</p>\n"}], "owner": {"reputation": 9597, "user_id": 730194, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/fb75af7a871d88919d9cc7c0c9e687e9?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/730194/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 1, "accepted_answer_id": 43261915, "answer_count": 2, "score": 4, "last_activity_date": 1514548754, "creation_date": 1491410849, "last_edit_date": 1491410946, "question_id": 43237104, "link": "https://stackoverflow.com/questions/43237104/picture-format-for-net-wm-icon", "title": "Picture format for _NET_WM_ICON", "body": "<p>Environment: Ubuntu 16.04</p>\n\n<p>In my app, I get an application's icon by calling <code>XGetWindowProperty</code> with <code>_NET_WM_ICON</code> atom.</p>\n\n<pre><code>unsigned char* data;\nXGetWindowProperty(..., &amp;data);\nunsigned long* data1 = (unsigned long*) data;\nlong width = *data1;\nlong height = *(data1 + 1)\nunsigned char* imageData = (unsigned char*) (data1 + 2);\n</code></pre>\n\n<p>Here are the specs for the returned data:</p>\n\n<p><a href=\"https://specifications.freedesktop.org/wm-spec/wm-spec-1.3.html#idm140130317554480\" rel=\"nofollow noreferrer\">https://specifications.freedesktop.org/wm-spec/wm-spec-1.3.html#idm140130317554480</a></p>\n\n<p>According to the specs, the returned image must be in packed-32 ARGB format. However, the image I was getting did not seem right. I finally created a test application with my own icon. It is a solid icon with RGB value of 0x20, 0x40, and 0x80 respectively.</p>\n\n<p>When I examine my variable <code>imageData</code> in the debugger, here is what I see:</p>\n\n<pre><code>0x80, 0x40, 0x20, 0xff, 0xff, 0xff, 0xff, 0xff (repeat the pattern)\n</code></pre>\n\n<p>It appears the format is BGRA with extra four bytes of padding.</p>\n\n<p>I would appreciate it if anyone can explain this discrepancy. Regards.</p>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1491410068, "post_id": 43236830, "comment_id": 73543871, "body": "<code>double **</code> is <b>not</b> a 2D array and cannot point to one. A pointer is not array. And no, you cannot pass arrays to/from functions. But you can pass pointers to arrays."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1491413578, "post_id": 43237530, "comment_id": 73545979, "body": "Another problem with returning a pointer to a static object, as is done here, is the potential for unexpected aliasing.  That&#39;s a particular risk in the OP&#39;s case -- if the return value from one of those functions is passed back to that function as a parameter in a subsequent call, then the actual behavior is unlikely to be what was expected.  Or if a separate and independent call to either function is performed, it may come as a surprise that the pointer returned by a previous call afterward points to different data."}, {"owner": {"reputation": 91, "user_id": 7236295, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dWPbU.jpg?s=128&g=1", "display_name": "ROBlackSnail", "link": "https://stackoverflow.com/users/7236295/roblacksnail"}, "edited": false, "score": 0, "creation_date": 1491414285, "post_id": 43237530, "comment_id": 73546456, "body": "Thank you a lot  for the answer and for the time you took to write all this down. It&#39;s all clear now. I am sorry for the mistakes in the functions but, in my defence ,they are not mine. I copy-pasted them from the yesterday course of programming. Seems the teacher was not paying attention... ohh well."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 91, "user_id": 7236295, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dWPbU.jpg?s=128&g=1", "display_name": "ROBlackSnail", "link": "https://stackoverflow.com/users/7236295/roblacksnail"}, "edited": false, "score": 0, "creation_date": 1491414767, "post_id": 43237530, "comment_id": 73546754, "body": "@ROBlackSnail: C is almost uniformly taught poorly, by people who themselves were taught poorly, and array/pointer semantics are one of the places where a lot of misinformation and bad practice have metastasized.  It&#39;s not a great <i>learning</i> resource, but bookmark the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">current online draft</a> of the C language standard - if nothing else, it will tell you how stuff is <i>supposed</i> to work."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1491412180, "creation_date": 1491412180, "answer_id": 43237530, "question_id": 43236830, "link": "https://stackoverflow.com/questions/43236830/c-programming-pointers-used-in-functions-that-work-with-multidimensional-array/43237530#43237530", "title": "C programming - pointers used in functions that work with multidimensional arrays", "body": "<p>Both functions are attempting to return pointers to arrays.  Both are <em>doing it wrong</em> and fail to compile on my system.</p>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array.</p>\n\n<p>In the <code>transpose</code> function, we're returning the <em>expression</em> <code>trans</code>.  <code>trans</code> has type \"100-element array of <code>T</code>\", where <code>T</code> is \"100-element array of <code>double</code>\".  It's not the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, so it is converted (\"decays\") to an expression of type \"pointer to <code>T</code>\", which in this case is \"pointer to 100-element array of <code>double</code>\" (<code>double (*)[100]</code>), <strong><em>NOT</em></strong> \"pointer to pointer to <code>double</code>\", (<code>double **</code>).  </p>\n\n<p>The compiler <em>should</em> complain about that function.  Mine does, like so:</p>\n\n<pre><code>gcc -c -std=c99 -pedantic-errors -Wall transpose.c\ntranspose.c: In function \u00e2transpose\u00e2:\ntranspose.c:7: error: return from incompatible pointer type\n</code></pre>\n\n<p>In the <code>matrixMultiply</code> function, <code>c</code> has type \"10-element array of 10-element array of <code>double</code>\", which \"decays\" to \"pointer to 10-element array of <code>double</code>\" (<code>double (*)[10]</code>).  The second function has the right return type - <code>double (*)[10]</code> - but then they <strong><em>MESS IT UP</em></strong> by casting <code>c</code> to <code>double *</code> in the return statement, and we get the same error as before:</p>\n\n<pre><code>gcc -c -std=c99 -pedantic-errors -Wall matrixMultiply.c\nmatrixMultiply.c: In function \u00e2matrixMultiply\u00e2:\nmatrixMultiply.c:11: error: return from incompatible pointer type\n</code></pre>\n\n<p>They <em>should</em> have just written</p>\n\n<pre><code>return c;\n</code></pre>\n\n<p>and everything would have been alright.</p>\n\n<p>The way to read that second function definition is as follows:</p>\n\n<pre><code>        matrixMultiply                           -- matrixMultiply\n        matrixMultiply(                   )      -- is a function taking\n        matrixMultiply( /* some params */ )      -- some parameters (omitted for brevity)\n       *matrixMultiply( /* some params */ )      -- returning a pointer\n      (*matrixMultiply( /* some params */ ))[10] -- to a 10-element array\ndouble(*matrixMultiply( /* some params */ ))[10] -- of double\n</code></pre>\n\n<p>Note that the only reason either function has a hope of working (once the type issues are straightened out) is that both <code>trans</code> and <code>c</code> are declared <code>static</code>, meaning that their lifetimes extend over the entire program, not just the lifetimes of their respective functions. Without that <code>static</code> keyword, they would <em>cease to exist</em> after their enclosing functions return, and those pointers would become <em>invalid</em>.  </p>\n\n<p>This is not necessarily good practice - these functions are no longer re-entrant and not thread-safe.  It would be better to pass the target arrays as parameters to the functions, but be aware that a pointer to a 10-element array is a different, incompatible type from a pointer to an 11-element array - if you have to deal with arrays with different numbers of columns, that could get tricky.  VLAs can help with that:</p>\n\n<pre><code>void transpose( int r, int c, double arr[r][c], double trans[c][r] )\n{\n  ...\n}\n</code></pre>\n\n<p>assuming you have VLAs available (you should on C99 and C2011 systems, although they've been made optional in C2011).  If you don't ... this gets harder.  </p>\n"}], "owner": {"reputation": 91, "user_id": 7236295, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dWPbU.jpg?s=128&g=1", "display_name": "ROBlackSnail", "link": "https://stackoverflow.com/users/7236295/roblacksnail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 43237530, "answer_count": 1, "score": 1, "last_activity_date": 1491412180, "creation_date": 1491409915, "last_edit_date": 1491411887, "question_id": 43236830, "link": "https://stackoverflow.com/questions/43236830/c-programming-pointers-used-in-functions-that-work-with-multidimensional-array", "title": "C programming - pointers used in functions that work with multidimensional arrays", "body": "<p>I have the following 2 functions:</p>\n\n<pre><code>double** transpose(double **a, int r, int c){\n    static double trans[100][100];\n    int i,j;\n    for(i = 0; i &lt; r; i++)\n        for(j = 0; j &lt; c; j++)\n            trans[j][i] = a[i][j];\n    return trans;\n}\n\ndouble(*matrixMultiply(double a[10][10], double b[10][10],\n    int rowA, int colB, int colARowB))[10]{\n    static double c[10][10];\n    int i, j, k;\n    for(i = 0; i &lt; rowA; i++)\n        for(j = 0; j &lt; colB; j++){\n            c[i][j] = 0;\n            for(k = 0; k &lt; colARowB; k++)\n                c[i][j] += a[i][k]*b[k][j];\n        }\n    return (double*) c;\n}\n</code></pre>\n\n<p>While I do understand the algorithms, can someone explain me what these 2 functions return (types, pointers...) ? The second seems to return an array, but I thought that functions in C can't return arrays ...</p>\n\n<p>Getting really confused with these pointers...</p>\n\n<p>Also why are the arrays (<code>trans</code> and  <code>c</code> ) declared as static? As far as I get it, when you declare a variable or a function with static it can't be imported for use in another file, but that's defenetely not the case here  ... </p>\n"}, {"tags": ["c", "operating-system", "semaphore", "binary-semaphore"], "answers": [{"tags": [], "owner": {"reputation": 778, "user_id": 7315895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PTS6n.jpg?s=128&g=1", "display_name": "monster", "link": "https://stackoverflow.com/users/7315895/monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1498648199, "creation_date": 1498648199, "answer_id": 44800796, "question_id": 43236175, "link": "https://stackoverflow.com/questions/43236175/how-to-sync-processes-using-semaphore/44800796#44800796", "title": "How to sync processes using semaphore", "body": "<p>Here's pseudo code of how you can achieve order <strong>P3, P1, P2</strong></p>\n\n<pre><code>//semaphores for P1, P2, P3 respectively\nsemaphore s1=0;\nsemaphore s2=0;\nsemaphore s3=1;     //coz P3 needs to go first \n\n\n//for p3\nwait(s3)\n  //do p3 here\nsignal(s1)          //signal for P1 to start\n\n\n//for p1\nwait(s1)\n  //do p1\nsignal(s2)           // signal to start P2\n\n\n//for p2\nwait(s2)\n   //do p2\nsignal(s3)            //signal to start p3 again if that is required or you can omit this if not required\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7717837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5345e2d54ed5c9066dc6d5acc4342f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Mishra", "link": "https://stackoverflow.com/users/7717837/vaibhav-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1222, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1498648199, "creation_date": 1491407998, "last_edit_date": 1491418895, "question_id": 43236175, "link": "https://stackoverflow.com/questions/43236175/how-to-sync-processes-using-semaphore", "title": "How to sync processes using semaphore", "body": "<p>let's say I have 3 processes including a parent process I have to execute I program in sequence of P3,P1,P2. Guys please help me how I can start the computation from process P3.</p>\n\n<p>I need the out as {0,1,2,3,4,5,.. max}</p>\n\n<p>For the reference my code snapshot is :-</p>\n\n<pre><code> #define SEM_NAME \"//test.mutex\"\n//#define SEM_NAME2 \"//test2.mutex\"\n\nint main(int argc, char const *argv[]) {\n  int max = 0, i =0;\n  sem_t *sem;\n  sem_t *sem2;\n  pid_t  pid, pid2;\n  sem = sem_open(SEM_NAME, O_CREAT, O_RDWR, 1);\n  sem_unlink(SEM_NAME);\n  if (sem==SEM_FAILED) {\n    printf(\"%s sem_open failed!\", SEM_NAME);\n    return (-1);\n  }\n  // sem2 = sem_open(SEM_NAME2, O_CREAT, O_RDWR, 0);\n  // sem_unlink(SEM_NAME2);\n  // if (sem2==SEM_FAILED) {\n  //   printf(\"%s sem_open failed!\", SEM_NAME2);\n  //   return (-1);\n  // }\n  printf(\"Enter the maximum number\\n\");\n  scanf(\"%d\", &amp;max);\n  pid = fork();\n  if(pid == 0)\n  {\n    i = 2;\n    pid2 = fork();\n    if(pid2 == 0)\n    {\n      i = 0;\n    }\n    else\n    {\n      sleep(2);\n    }\n  }\n  else\n  {\n    i = 1;\n    sleep(1);\n  }\n  //do\n  {\n    sem_wait(sem);\n    for (; i &lt;= max;) {\n      printf(\"pid %d done and value is %d\\n\", getpid(),i);\n      i = i + 3;\n    }\n    sem_post(sem);\n  } //while(i &lt;= max);\n  wait(NULL);\n  return 0;\n}\n</code></pre>\n\n<p>when I run the program I get following output \n{0,3,,6,1,4,7,2,5,8}</p>\n\n<p>I need a way I which first process should print a number and it should let other process to print his number and at the last third should print.</p>\n\n<p>I need a way that each and get there turn sequentially.</p>\n\n<p>Hope I am clear with the question</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491406967, "post_id": 43235810, "comment_id": 73541780, "body": "Please format your code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1491406996, "post_id": 43235810, "comment_id": 73541796, "body": "When you pass arguments to a function, they are passed <i>by value</i>. That means the value is copied, and the function only modify the copy. The original variable will still keep its value."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491407105, "post_id": 43235810, "comment_id": 73541860, "body": "This has been asked 100s of times. What is the output of this program: <code>void Foo(bar) {bar = 4;} int main() {int x = 0; Foo(x); printf(&quot;%d\\n&quot;, x);}</code> ?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1491407136, "post_id": 43235810, "comment_id": 73541880, "body": "P.S. -&gt; do not cast the result of your memory allocations."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1491407199, "last_edit_date": 1491407199, "creation_date": 1491407097, "answer_id": 43235892, "question_id": 43235810, "link": "https://stackoverflow.com/questions/43235810/simple-linked-list-in-c/43235892#43235892", "title": "Simple Linked List in C", "body": "<p>C passes parameters by value. That means that the value of the variable passed to a function is copied into a new variable which is local to the function. No matter how much you change the local variable inside the function, it will never change the value of the variable passed to the function.</p>\n\n<p>In other words: <code>n</code> inside the function is <strong>not</strong> the same as <code>head</code> in <code>main</code>. The local variable <code>n</code> is just initialized to the same value as <code>head</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7821476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/442b1ce27d1b8e82d79ee74e9115ac77?s=128&d=identicon&r=PG&f=1", "display_name": "sherry", "link": "https://stackoverflow.com/users/7821476/sherry"}, "edited": false, "score": 0, "creation_date": 1491409207, "post_id": 43235992, "comment_id": 73543340, "body": "Thank you so much, you made it really clear for me. Now I understand that why I was being so stupid and didn&#39;t get that sooner."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1491407398, "creation_date": 1491407398, "answer_id": 43235992, "question_id": 43235810, "link": "https://stackoverflow.com/questions/43235810/simple-linked-list-in-c/43235992#43235992", "title": "Simple Linked List in C", "body": "<p>Variables are passed by value; this is also true for a variable whose value is a pointer:</p>\n\n<p>Suppose variable <code>head</code> of type <code>struct node*</code> points to a node, let's say a node at address <code>0x12345</code>.\nWhen you call <code>printList(head)</code>, whereas the signature of this function is <code>void printList(struct node *n)</code>, then the <em>value</em> of <code>head</code> is copied to the <em>value</em> of <code>n</code>; Hence, variable <code>n</code> and variable <code>head</code>, though being different variables,  will have the value <code>0x12345</code>. If <code>printList</code> then changes the value of <code>n</code>, e.g. by statement <code>n = n-&gt;next</code>, then only the value of variable <code>n</code> is changed; variable <code>head</code> will still have the value <code>0x12345</code>.</p>\n\n<p>Hope this helps...</p>\n"}], "owner": {"reputation": 1, "user_id": 7821476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/442b1ce27d1b8e82d79ee74e9115ac77?s=128&d=identicon&r=PG&f=1", "display_name": "sherry", "link": "https://stackoverflow.com/users/7821476/sherry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491409388, "creation_date": 1491406828, "last_edit_date": 1491409388, "question_id": 43235810, "link": "https://stackoverflow.com/questions/43235810/simple-linked-list-in-c", "title": "Simple Linked List in C", "body": "<p>Here is a C code which creates a simple linked list with three nodes. Afterward a function called <code>printList</code> traverses the created list and prints the data of each node.</p>\n\n<pre><code>    // A simple C program for traversal of a linked list\n    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n\n    struct node\n    {\n        int data;\n        struct node *next;\n    };\n\n    // This function prints contents of linked list starting from\n    // the given node\n    void printList(struct node *n)\n    {\n        while (n != NULL)\n        {\n            printf(\" %d \", n-&gt;data);\n            n = n-&gt;next;\n        }\n    }\n\nint main()\n{\n    struct node* head = NULL;\n    struct node* second = NULL;\n    struct node* third = NULL;\n\n// allocate 3 nodes in the heap\n    head = (struct node*)malloc(sizeof(struct node));\n    second = (struct node*)malloc(sizeof(struct node));\n    third = (struct node*)malloc(sizeof(struct node));\n\n    head-&gt;data = 1; //assign data in first node\n    head-&gt;next = second; // Link first node with second\n\n    second-&gt;data = 2; //assign data to second node\n    second-&gt;next = third;\n\n    third-&gt;data = 3; //assign data to third node\n    third-&gt;next = NULL;\n\n    printList(head);\n    printList(head); //question\n\n    return 0;\n}\n</code></pre>\n\n<p>Resource: <a href=\"http://quiz.geeksforgeeks.org/linked-list-set-1-introduction/\" rel=\"nofollow noreferrer\">http://quiz.geeksforgeeks.org/linked-list-set-1-introduction/</a></p>\n\n<p>My question is that, since the input argument of function <code>printList</code> is a pointer of type node, the value of the pointer seems to be changed after the function call. In other words, after calling <code>printList(head)</code>, it is reasonable to me that the pointer <code>head</code> must now point to a <code>NULL</code> value, therefore the second call to <code>printList</code> should print some irrelevant values. However, I am obviously wrong, since the output of this program is 1 2 3 1 2 3. </p>\n\n<p>Could you please shed some light on this?</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1491406792, "post_id": 43235725, "comment_id": 73541652, "body": "First google hit searching for &quot;_IMAGE_FILE_HEADER &quot;: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms680313(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN</a>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1491407345, "post_id": 43235725, "comment_id": 73542031, "body": "The docs say it is the low 32 bits of the timestamp, which is the number of seconds since midnight (00:00:00) on January 1, 1970, universal time. It will wrap around to 0 at 2106-02-07T06:28:16+00:00."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1491407553, "post_id": 43235725, "comment_id": 73542164, "body": "The TimeDateStamp 0x58e451ac corresponds to 2017-04-05T02:08:44+00:00."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 5104947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b0897398c4b473adce244a650f5cc36?s=128&d=identicon&r=PG&f=1", "display_name": "epoxxy", "link": "https://stackoverflow.com/users/5104947/epoxxy"}, "is_accepted": true, "score": 0, "last_activity_date": 1491409299, "creation_date": 1491409299, "answer_id": 43236644, "question_id": 43235725, "link": "https://stackoverflow.com/questions/43235725/how-to-determine-timedatestamp/43236644#43236644", "title": "How to determine TimeDateStamp", "body": "<p>I found solution like that.</p>\n\n<pre><code> time_t TimeX = (time_t)header.TimeDateStamp;\n tm* pGMT = gmtime(&amp;TimeX);\n char* pTime = asctime(pGMT);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491412900, "post_id": 43236713, "comment_id": 73545536, "body": "I got the multiplication and addition the wrong way round in <code>TimeDateStampToFileTime()</code>. I&#39;ve corrected it now."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 2, "last_activity_date": 1491412835, "last_edit_date": 1491412835, "creation_date": 1491409489, "answer_id": 43236713, "question_id": 43235725, "link": "https://stackoverflow.com/questions/43235725/how-to-determine-timedatestamp/43236713#43236713", "title": "How to determine TimeDateStamp", "body": "<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms680313(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN: IMAGE_FILE_HEADER structure</a>, the <code>TimeDateStamp</code> member of <code>IMAGE_FILE_HEADER</code> is the low 32 bits of the time stamp of the image. It represents the time that the image was created by the linker. The value is represented as the number of seconds since the start of January 1, 1970 in Universal Coordinated Time.</p>\n\n<p>It could be converted to a <code>FILETIME</code> value using the following function:</p>\n\n<pre><code>FILETIME TimeDateStampToFileTime(DWORD timeDateStamp)\n{\n    ULARGE_INTEGER ftu;\n    FILETIME ft;\n\n    ftu.QuadPart = (timeDateStamp + 11644473600ull) * 100000000ull;\n    ft.LowPart = ftu.u.LowPart;\n    ft.HighPart = ftu.u.Highpart;\n    return ft;\n}\n</code></pre>\n\n<p>Then you can convert the <code>FILETIME</code> to a broken-down <code>SYSTEMTIME</code> structure using the Windows <code>FileTimeToSystemTime</code> function.</p>\n"}], "owner": {"reputation": 109, "user_id": 5104947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b0897398c4b473adce244a650f5cc36?s=128&d=identicon&r=PG&f=1", "display_name": "epoxxy", "link": "https://stackoverflow.com/users/5104947/epoxxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 43236644, "answer_count": 2, "score": -3, "last_activity_date": 1491412835, "creation_date": 1491406571, "last_edit_date": 1491408372, "question_id": 43235725, "link": "https://stackoverflow.com/questions/43235725/how-to-determine-timedatestamp", "title": "How to determine TimeDateStamp", "body": "<p>I was coding something about windows PE header. I want determine Timestamp value. \nThis is _IMAGE_FILE_HEADER structure</p>\n\n<pre><code>typedef struct _IMAGE_FILE_HEADER {\n    WORD    Machine;\n    WORD    NumberOfSections;\n    DWORD   TimeDateStamp;\n    DWORD   PointerToSymbolTable;\n    DWORD   NumberOfSymbols;\n    WORD    SizeOfOptionalHeader;\n    WORD    Characteristics;\n} IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;\n</code></pre>\n\n<p>Value of this variable is TimeDateStamp: 0x58e451ac</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491409687, "post_id": 43235607, "comment_id": 73543644, "body": "C does not have a string type."}], "answers": [{"comments": [{"owner": {"reputation": 582, "user_id": 1627208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/cCT5H.jpg?s=128&g=1", "display_name": "bra_racing", "link": "https://stackoverflow.com/users/1627208/bra-racing"}, "edited": false, "score": 0, "creation_date": 1491406763, "post_id": 43235650, "comment_id": 73541627, "body": "I agree with you, that&#39;s the reason, but why there is not a crash in the loop?? When is reached the condition to leave the loop? What happen when the last character is evaluated?? It will try to access to a character in uppword that does not exit"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 582, "user_id": 1627208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/cCT5H.jpg?s=128&g=1", "display_name": "bra_racing", "link": "https://stackoverflow.com/users/1627208/bra-racing"}, "edited": false, "score": 2, "creation_date": 1491406787, "post_id": 43235650, "comment_id": 73541647, "body": "The loop ends when it reaches the nul-terimator in <code>uppword</code>."}, {"owner": {"reputation": 582, "user_id": 1627208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/cCT5H.jpg?s=128&g=1", "display_name": "bra_racing", "link": "https://stackoverflow.com/users/1627208/bra-racing"}, "edited": false, "score": 0, "creation_date": 1491406854, "post_id": 43235650, "comment_id": 73541689, "body": "Ahhh ok, it is appended the nul character automatically"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1491407018, "last_edit_date": 1491407018, "creation_date": 1491406383, "answer_id": 43235650, "question_id": 43235607, "link": "https://stackoverflow.com/questions/43235607/c-string-vs-array-in-for-condition/43235650#43235650", "title": "C - String vs. Array in for condition", "body": "<p><code>uppword[i]</code> will be 0 at the end of the string (<code>scanf</code> does that for you unless you've tried to read too many characters in which case the compiler might eat your cat). <code>i &lt; 0</code> will be 0 at that point. Subject to some assumptions, it is 0 <em>only</em> at that point: These assumptions are (i) <code>uppword</code> has at most less than 32 characters (you've allowed for 25 plus a nul-terminator), and (ii) in ASCII at least you <em>typically</em> don't encounter characters less than 32 (as they are the control set).</p>\n\n<p>Clever, if a little hard to read.</p>\n\n<p>The smart alec programmer might also want to consider the fact that this code assumes ASCII encoding, and is therefore not portable C.</p>\n\n<p>Consider using <code>strlen</code> instead, but <em>pre-compute</em> that: don't include it as the loop conditional as you'll then convert an O(N) process to an O(N*N) process - only a compiler from a divinity would know that <code>strlen</code> doesn't change between iterations, given that your loop body mutates the string.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 4180887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rg3h9fjtkRQ/AAAAAAAAAAI/AAAAAAAAFC0/UcpvfG39QSk/photo.jpg?sz=128", "display_name": "Chriz Chow", "link": "https://stackoverflow.com/users/4180887/chriz-chow"}, "is_accepted": false, "score": 0, "last_activity_date": 1491407549, "creation_date": 1491407549, "answer_id": 43236038, "question_id": 43235607, "link": "https://stackoverflow.com/questions/43235607/c-string-vs-array-in-for-condition/43236038#43236038", "title": "C - String vs. Array in for condition", "body": "<p><code>uppword[i]</code> works because when the <code>i</code> is small, it is referring to the strings formatted with ASCII, as 'A' in ASCII is 33 always greater than <code>26</code>, your array <code>uppword[26]</code>.</p>\n\n<p>When <code>i</code> is increasing until <code>uppword[i]</code> is pointing to the null-terminating character of your string, the condition will be false as <code>i</code> must be greater than 0 (the null character). Therefore it will leave the loop.</p>\n\n<p>That means this loop will stop when it reaches the null character.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1491407622, "creation_date": 1491407622, "answer_id": 43236057, "question_id": 43235607, "link": "https://stackoverflow.com/questions/43235607/c-string-vs-array-in-for-condition/43236057#43236057", "title": "C - String vs. Array in for condition", "body": "<blockquote>\n  <p>The \"i\" in array is on the beginning 0, so the condition is not TRUE, and it can't be proceeded.</p>\n</blockquote>\n\n<p>The condition is checking if <code>i</code> is less than <code>upword[i]</code>; at the beginning, you're checking to see if <code>0</code> is less than <code>upword[0]</code>, which is almost certainly true.  </p>\n\n<p>Suppose you enter the string <code>\"Hello\"</code>.  What gets stored in <code>upword</code> is the character sequence <code>{'H', 'e', 'l', 'l', 'o', 0 }</code>.  Each time through the loop, you're making the following comparisons:</p>\n\n<pre><code>0 &lt; 'H' (72)  true\n1 &lt; 'e' (101) true\n2 &lt; 'l' (108) true\n3 &lt; 'l' (108) true\n4 &lt; 'o' (111) true\n5 &lt; 0         false\n</code></pre>\n\n<p>The loop will exit when it hits the 0 terminator, because 0 will not be greater than the index value.  Like Bathsheba says, this code assumes the string will never contain any control characters.</p>\n\n<p>As written, this is not good code - it makes all kinds of assumptions about the underlying character set, it's not clear, and it's not safe.  A better version would be something like</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n...\nscanf( \"%25s\", upword );  // use an explicit field with modifier so that\n                          // we don't try to store more characters than\n                          // upword is sized to hold.  Leave room for trailing 0\n\nfor ( char *p = upword; *p != 0; p++ )\n  *p = toupper( *p );\n</code></pre>\n\n<p>This code iterates through the string using a pointer <code>p</code>, and loops until it sees the <code>0</code> string terminator.  It also uses the <code>toupper</code> library function, which a) takes the current character encoding (ASCII, EBCDIC, whatever) into account, and b) returns the original character if no uppercase equivalent is available (such as for punctuation characters).  </p>\n"}], "owner": {"reputation": 49, "user_id": 7182118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J5UnybC3Mh0/AAAAAAAAAAI/AAAAAAAAAP4/Qz5Pod2vSVM/photo.jpg?sz=128", "display_name": "Matej Bun\u010dek", "link": "https://stackoverflow.com/users/7182118/matej-bun%c4%8dek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 43235650, "answer_count": 3, "score": 2, "last_activity_date": 1491407622, "creation_date": 1491406222, "question_id": 43235607, "link": "https://stackoverflow.com/questions/43235607/c-string-vs-array-in-for-condition", "title": "C - String vs. Array in for condition", "body": "<p>today i was trying to make a simple \"program\" in C, and i want to do following: When you enter Uppercase string, the program will transform all characters to lowercase. But i stupped to curiosity.</p>\n\n<pre><code>char uppword[26];\nint i;\nprintf(\"Gimme a word in uppercase.: \");\nscanf(\"%s\", uppword);\nfor (i=0; i &lt; uppword[i]; i++){\n    uppword[i] = uppword[i] + 32;\n}\n\nprintf(\"%s\", uppword);\n\nreturn 0;\n</code></pre>\n\n<p>As you can see, in for loop is a condition <code>i &lt; uppword[i]</code>, but i dont know, why this is works. In other way, i can replace this condition by <code>i &lt; strlen(uppword)</code>, and it will be also works. But i don't think that this is same as array. Why this Array works? The \"i\" in array is on the beginning 0, so the condition is not TRUE, and it can't be proceeded. </p>\n"}, {"tags": ["c", "struct", "linked-list"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1491405149, "post_id": 43235121, "comment_id": 73540480, "body": "<code>val</code> is not allocated <code>int</code> pointer, yet you are trying to <code>scanf</code> into it some string..."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1491405828, "creation_date": 1491405828, "answer_id": 43235460, "question_id": 43235121, "link": "https://stackoverflow.com/questions/43235121/linkeds-list-using-strings/43235460#43235460", "title": "Linkeds List using strings", "body": "<pre><code>if ((temp=(struct node *)malloc(sizeof(struct node)))==NULL)\n{\n    printf(\"Memory allocation or node failed.\\n\");\n    exit(1);\n}\nstrcpy(temp-&gt;symbol,str);\n</code></pre>\n\n<p>You need to allocate memory for <code>temp-&gt;symbol</code>. The easiest way since you're copying an existing string is to use <code>strdup</code> like this instead of doing that <code>strcpy</code></p>\n\n<pre><code>temp-&gt;symbol=strdup(str);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1491407776, "creation_date": 1491407776, "answer_id": 43236111, "question_id": 43235121, "link": "https://stackoverflow.com/questions/43235121/linkeds-list-using-strings/43236111#43236111", "title": "Linkeds List using strings", "body": "<p>You also need to allocate memory for the variable symbol.\nMake your insert function as follows:</p>\n\n<pre><code>void insert(struct node **h, struct node **t, char * str)\n{\n\nstruct node *temp;\n\nif ((temp=(struct node *)malloc(sizeof(struct node)))==NULL)\n{\n    printf(\"Memory allocation or node failed.\\n\");\n    exit(1);\n}\nint count = 0;\ncount=strlen(str);\ntemp-&gt;symbol=malloc(count+1);\nstrcpy(temp-&gt;symbol,str);\ntemp-&gt;count= 1;\ntemp-&gt;next=NULL;\n\nif(*h == NULL)\n{\n    *h=*t=temp;\n}\n\nelse\n{\n(*t)-&gt;next = temp;\n*t = (*t)-&gt;next;\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7821321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1488c940930a56429d429ba58519152?s=128&d=identicon&r=PG&f=1", "display_name": "MSalvi", "link": "https://stackoverflow.com/users/7821321/msalvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491407776, "creation_date": 1491404933, "last_edit_date": 1491405838, "question_id": 43235121, "link": "https://stackoverflow.com/questions/43235121/linkeds-list-using-strings", "title": "Linkeds List using strings", "body": "<p>I get a segfault when I insert into my linked list and I just can't find it. At one point it would allow me to insert up to three nodes but now it segfaults after the first insertion and does not iterate through the while loop and for statements. Am I scanning the information into the array incorrectly? I have to be able to take in several input values because eventually I need to be able to delete and print nodes based on string and count values that will be given by the user.</p>\n\n<p>Input from the user would look like this:</p>\n\n<pre><code>ins books\nins table\nprl   // to print list\ndel v1 v5  //to delete nodes with count values that fall between 1 and 5\n</code></pre>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n struct node\n{\n    char *symbol;// each Node contains a array 'symbol'\n    int count; // each Node contains a symbol counter\n    struct node *next; \n    };// end struct\n\n\n\nvoid insert(struct node**,struct node **, char *str);\nvoid printL(struct node *);\n\n\n\n\nint main()\n{\n\n    struct node *head;\n    struct node *tail;\n\n    head = NULL;\n    tail = NULL;\n\n\n    //Declare variables needed for input and output\n    char input[15]={0};\n    char cmd [4]={0};\n    char info[11] = {0};\n    int *val={0};\n\n\n    //possible command strings\n    char ins[]= \"ins\";\n    char prl[]= \"prl\";\n    char end[]= \"end\";\n\n\n    // Prompt user for command and corresponding input\n    puts(\"Please enter a command with corresponding value(s) where necessary\");\n    scanf(\"%s%s%s\", cmd,info, val);\n\n\n//While command is not 'end':\n while (strcmp(end,cmd) != 0){\n         // Read value(s) for the command, in necessary\n         if (strcmp(ins,cmd)==0)\n         {\n            insert(&amp;head, &amp;tail, info);\n         }\n\n         if (strcmp(prl, cmd)==0)\n         {\n            printL(head);\n         }\n\n\n         puts(\"Please enter your next command and value where necessary:\");\n\n        scanf(\"%s%s%s\", cmd,info, val);\n\n\n\n\n    }\n    return 0;\n}\nvoid insert(struct node **h, struct node **t, char * str)\n{\n\n    struct node *temp;\n\n    if ((temp=(struct node *)malloc(sizeof(struct node)))==NULL)\n    {\n        printf(\"Memory allocation or node failed.\\n\");\n        exit(1);\n    }\n    strcpy(temp-&gt;symbol,str);\n    temp-&gt;count= 1;\n    temp-&gt;next=NULL;\n\n    if(*h == NULL)\n    {\n        *h=*t=temp;\n    }\n\n    else\n    {\n    (*t)-&gt;next = temp;\n    *t = (*t)-&gt;next;\n    }\n}\n\nvoid printL(struct node *h)\n{\n   // NodePtr hPtr = NULL;\n    //hPtr=malloc(sizeof(Node));\n    //hPtr=head;\n    if(h == NULL){\n        puts(\"The list is empty\");\n    }\n    else{\n\n        while(h != NULL){\n            printf(\"%s\", h-&gt;symbol);\n            printf(\"\\t %d\", h-&gt;count);\n            h= h-&gt;next;\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1491404715, "post_id": 43234915, "comment_id": 73540149, "body": "<code>using namespace std</code> is C++, not C.  These are different languages.  Which one are you actually using?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1491405367, "post_id": 43234915, "comment_id": 73540633, "body": "If you&#39;re being taught this is C++ I would suggest you learn C++ from somewhere else.  Besides <code>using namespace std;</code> your code is C code."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1491405495, "post_id": 43234915, "comment_id": 73540713, "body": "To be precise, <code>using namespace std;</code> is bad C++, the rest is C."}, {"owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "edited": false, "score": 0, "creation_date": 1491406038, "post_id": 43234915, "comment_id": 73541090, "body": "Thanks for your comments, the code is from someone else and is written in C but my all program is in C++ and I compile with g++"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "edited": false, "score": 0, "creation_date": 1491406316, "post_id": 43235029, "comment_id": 73541273, "body": "Okay thanks a lot, but what do you mean by &quot;initializing as an aggregate&quot;? If I&#39;m not wrong, fd is defined as a data member of the structure <code>struct func_params</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "edited": false, "score": 0, "creation_date": 1491406407, "post_id": 43235029, "comment_id": 73541356, "body": "@ludmi I mean using brace initialization."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1491405104, "last_edit_date": 1491405104, "creation_date": 1491404707, "answer_id": 43235029, "question_id": 43234915, "link": "https://stackoverflow.com/questions/43234915/error-message-error-variable-has-initializer-but-incomplete-type/43235029#43235029", "title": "error message error: variable &#39;...&#39; has initializer but incomplete type", "body": "<p>In this statement there are declared two entities. </p>\n\n<pre><code>struct fit_data     fd   = part-&gt;fd;\n</code></pre>\n\n<p>The first one is structure <code>fit_data</code>  that is not yet defined. And the second one is an object of the structure with name <code>fd</code> . The compiler is unable to perform the initialization because it does not know how the structure is defined.  </p>\n\n<p>You have to use a qualified name. For example</p>\n\n<pre><code>func_params::fit_data     fd   = part-&gt;fd;\n</code></pre>\n\n<p>because the structure <code>fit_data</code> is declared and defined as an internal member of the structure   <code>func_params</code>  </p>\n\n<p>Also it is not clear from your code snippets whether fd is defined as a separate global object or you mean a data member of the structure  <code>struct func_params</code>. In the last case you have to define an object of the type <code>struct func_params</code> and initialize it as an aggregate.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "edited": false, "score": 0, "creation_date": 1491409052, "post_id": 43235927, "comment_id": 73543215, "body": "I didn&#39;t know that... Indeed it&#39;s working now, thanks a lot!"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1491407539, "last_edit_date": 1491407539, "creation_date": 1491407234, "answer_id": 43235927, "question_id": 43234915, "link": "https://stackoverflow.com/questions/43234915/error-message-error-variable-has-initializer-but-incomplete-type/43235927#43235927", "title": "error message error: variable &#39;...&#39; has initializer but incomplete type", "body": "<p>As you were said in comment C and C++ are different languages!</p>\n\n<p>The C version is:</p>\n\n<pre><code>double calc_chi2(int iloop, void *params){\n\nstruct func_params *part = (struct func_params *)params;\nstruct fit_data     fd   = part-&gt;fd;\n...}\n</code></pre>\n\n<p>because there is no nesting of types in C, so it compiles fine as C but chokes as C++.</p>\n\n<p>But the C++ version is:</p>\n\n<pre><code>double calc_chi2(int iloop, void *params){\n\nstruct func_params *part = (struct func_params *)params;\nstruct funt_params::fit_data     fd   = part-&gt;fd;\n...}\n</code></pre>\n\n<p>because C++ being an OO language has the notion of type qualification. But this one will be rejected by a C compiler...</p>\n\n<p>TL/DR: even if C++ actually derives from C and if they share common elements, and if the C standard library is included in C++ standard library, which allows some trivial C program to also be C++ correct programs, <strong>C and C++ are different languages</strong>.</p>\n"}], "owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2704, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496237537, "creation_date": 1491404454, "last_edit_date": 1496237537, "question_id": 43234915, "link": "https://stackoverflow.com/questions/43234915/error-message-error-variable-has-initializer-but-incomplete-type", "title": "error message error: variable &#39;...&#39; has initializer but incomplete type", "body": "<p>When compiling my code \n</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"macro.h\"\n#ifndef FIT_IT\n#define FIT_IT\n#endif\n#define MAXPOINTS 10000\nusing namespace std;\ndouble calc_chi2(int iloop, void *params){\n\nstruct func_params *part = (struct func_params *)params;\nstruct fit_data     fd   = part-&gt;fd;\n...}\n\nint main(int argc, char **argv){\nFILE *fp;\nsize_t size;\nint i;\nstruct func_params part;\nsetbuf(stdout,NULL);\ninitialize(argc, argv,&amp;part);\n...\n}\n</code></pre>\n\n<p>I get the error message:  <code>error: variable \u2018fit_data fd\u2019 has initializer but incomplete type</code>. The structures are defined in the header 'macro.h':\n</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct func_params\n{   \n    ...\n    struct fit_data{\n    char   data_file[100];\n    size_t n;\n    double nu;\n    int    id;\n    double lognumin;\n    double lognumax;\n    double xval[1000];\n    double yval[1000];\n    double yerr[1000];\n          } fd;\n     };\n</code></pre>\n\n<p>Does anyone have an idea where it comes from...? I've been searching for hours...</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["c", "arrays", "string", "character", "concatenation"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 6, "creation_date": 1491403827, "post_id": 43234576, "comment_id": 73539402, "body": "SO is not a human-powered transpiler service. Show us what you&#39;ve tried in C so far. Right now, you have some Java pseudo-code, but you don&#39;t show us what you&#39;ve tried to acchieve the same thing in C. Read the help section on what makes a <i>&quot;good question&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1491404559, "creation_date": 1491404559, "answer_id": 43234956, "question_id": 43234576, "link": "https://stackoverflow.com/questions/43234576/character-insertion-in-character-array-c/43234956#43234956", "title": "Character Insertion in Character Array C", "body": "<p>You need to allocate space for the new string so don't forget to free it...</p>\n\n<pre><code>char * f(char *s1, char * s2)\n{\n    char *s3 = malloc(strlen(s2)+1);\n    char *ret = s3;\n\n    while (*s2)\n    {\n        if (*s1++ == *s2)\n            *s3 = *s2++;\n        else\n            *s3 = '-';\n        s3++;\n    }\n    *s3 = '\\0';\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7821328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DtFPaD1m2Y4/AAAAAAAAAAI/AAAAAAAAABU/rQGugvU8-m8/photo.jpg?sz=128", "display_name": "Omaid Ghayyur", "link": "https://stackoverflow.com/users/7821328/omaid-ghayyur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491404559, "creation_date": 1491403630, "question_id": 43234576, "link": "https://stackoverflow.com/questions/43234576/character-insertion-in-character-array-c", "title": "Character Insertion in Character Array C", "body": "<p>I am trying to insert a special character '-' in the character array and wants to save it in another string. The character to be inserted is done using a loop.</p>\n\n<p><strong>INPUT:</strong></p>\n\n<p>actgagc</p>\n\n<p>atgac</p>\n\n<p><strong>OUTPUT</strong></p>\n\n<p>actgagc</p>\n\n<p>a-tga-c</p>\n\n<p>In the second character array - is inserted in place of the missing characters.</p>\n\n<p>The program is being done in the JAVA using the simple string concatenation function but unable to do the character insertion for C Language.</p>\n\n<p>The Java Code is:</p>\n\n<pre><code>while (k &gt; 0 &amp;&amp; l &gt; 0) {\n            if (condition 1) {\n                r_string1 += string_1[k - 1];\n                r_string2 += string_2[l - 1];\n                k--;\n                l--;\n            } else if (condition) {\n                r_string1 += \"-\";\n                r_string2 += string_2[l - 1];\n                l--;\n            } else {\n                r_string1 += sring_1[k - 1];\n                r_string2 += \"-\";\n                k--;\n            }\n        }\n</code></pre>\n\n<p>In C language i am trying to do the same for the character insertion in the character array. Tried with the strcat, memmov function but no results are achieved.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1491404146, "post_id": 43234498, "comment_id": 73539699, "body": "based on all the previous versions of this homework, isn&#39;t the answer found in the arrays themselves?"}, {"owner": {"reputation": 2088, "user_id": 1535706, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fdbc5a75b701551a48a172a534c74e92?s=128&d=identicon&r=PG", "display_name": "rslemos", "link": "https://stackoverflow.com/users/1535706/rslemos"}, "edited": false, "score": 0, "creation_date": 1491404203, "post_id": 43234498, "comment_id": 73539747, "body": "I&#39;m afraid you cannot. Once converted to <code>int*</code> their sizes are irrevocably lost to the compiler. On runtime an array of ints has no concept of size. You should either: have their sizes recorded elsewhere, or code it implicitly (say, for example, the last element should always be some specified, otherwise non-used, constant, like <code>0</code> or <code>-1</code>)."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1491406343, "post_id": 43234498, "comment_id": 73541300, "body": "not quite a duplicate, but this question seems to have a better understanding of this homework <a href=\"http://stackoverflow.com/questions/43191792/sorting-5-arrays-in-one-function\" title=\"sorting 5 arrays in one function\">stackoverflow.com/questions/43191792/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1491403955, "post_id": 43234651, "comment_id": 73539526, "body": "I think OP wants the length of the arrays after they are in <code>arr6</code> (converted to pointers). Like, how many items are in <code>arr6[0]</code>?"}, {"owner": {"reputation": 13, "user_id": 7415633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea68a9cba1516dd30042cdef2836e4f?s=128&d=identicon&r=PG&f=1", "display_name": "user7415633", "link": "https://stackoverflow.com/users/7415633/user7415633"}, "edited": false, "score": 0, "creation_date": 1491404249, "post_id": 43234651, "comment_id": 73539784, "body": "yes, i want to know how many items their in arr6[0] or arr6[1]"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 13, "user_id": 7415633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea68a9cba1516dd30042cdef2836e4f?s=128&d=identicon&r=PG&f=1", "display_name": "user7415633", "link": "https://stackoverflow.com/users/7415633/user7415633"}, "edited": false, "score": 0, "creation_date": 1491408921, "post_id": 43234651, "comment_id": 73543137, "body": "@user7415633: Why would you not mention such a fundamental thing? :-S"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 0, "last_activity_date": 1491403812, "creation_date": 1491403812, "answer_id": 43234651, "question_id": 43234498, "link": "https://stackoverflow.com/questions/43234498/how-to-know-what-is-the-length-of-pointer-in-array-of-pointers/43234651#43234651", "title": "How to know what is the length of pointer in array of pointers?", "body": "<p>In C++17, it's easy: <code>std::size(arr)</code>, from <code>&lt;iterator&gt;</code>.</p>\n\n<p>Before that, use <code>std::distance(std::begin(arr), std::end(arr))</code> (using the same header).</p>\n"}, {"tags": [], "owner": {"reputation": 1221, "user_id": 2533734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066ad9fe2953f1bfded7cf950f8880ec?s=128&d=identicon&r=PG&f=1", "display_name": "msitt", "link": "https://stackoverflow.com/users/2533734/msitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1491404366, "creation_date": 1491404366, "answer_id": 43234861, "question_id": 43234498, "link": "https://stackoverflow.com/questions/43234498/how-to-know-what-is-the-length-of-pointer-in-array-of-pointers/43234861#43234861", "title": "How to know what is the length of pointer in array of pointers?", "body": "<p>What you have is a pointer to the first item of the array. From this, there is no way to tell how long the array is in general.</p>\n\n<p>You will have to keep track of the lengths as well.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1491404853, "creation_date": 1491404853, "answer_id": 43235098, "question_id": 43234498, "link": "https://stackoverflow.com/questions/43234498/how-to-know-what-is-the-length-of-pointer-in-array-of-pointers/43235098#43235098", "title": "How to know what is the length of pointer in array of pointers?", "body": "<p>Once an <em>array</em> has been converted into a pointer (like the elements of the array <code>arr6</code>), there's no way to find the number of elements in it (in the original array).\nA simplified version is:</p>\n\n<pre><code>int arr1[] = { 3, 9, 6, 7 };\nint *p = arr1;\n/* Now, there's no way to know the number of elements in arr1 solely\n   from the pointer 'p' */\n</code></pre>\n\n<p>Either you have keep size information yourself. One way is to have another array for sizes:</p>\n\n<pre><code>int* arr6[] = { arr1, arr2, arr3, arr4, arr5 };\nsize_t sz_arr6[] = {sizeof arr1/sizeof arr1[0], sizeof arr2/sizeof arr2[0], ...};\n</code></pre>\n\n<p>This you know index, you know <code>sz_arr6[i]</code> corresponds to the number of elements in <code>arr6[i]</code> and so on.</p>\n"}], "owner": {"reputation": 13, "user_id": 7415633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea68a9cba1516dd30042cdef2836e4f?s=128&d=identicon&r=PG&f=1", "display_name": "user7415633", "link": "https://stackoverflow.com/users/7415633/user7415633"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 43235098, "answer_count": 3, "score": 0, "last_activity_date": 1491404853, "creation_date": 1491403431, "last_edit_date": 1491403977, "question_id": 43234498, "link": "https://stackoverflow.com/questions/43234498/how-to-know-what-is-the-length-of-pointer-in-array-of-pointers", "title": "How to know what is the length of pointer in array of pointers?", "body": "<p>I have 5 arrays and one array of pointers, I need to know what is the length of each array in the array of pointers(not sizeof). \nHow i do it?</p>\n\n<pre><code>int arr1[] = { 3, 9, 6, 7 };\nint arr2[] = { 2, 5, 5 };\nint arr3[] = { 0 };\nint arr4[] = { 1, 6 };\nint arr5[] = { 4, 5, 6, 2, 1 };\nint* arr6[] = { arr1, arr2, arr3, arr4, arr5 };\n</code></pre>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1491403548, "post_id": 43234494, "comment_id": 73539158, "body": "Think about the definition of multiplication."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1491403583, "post_id": 43234494, "comment_id": 73539180, "body": "&quot;I think&quot; sounds like you need to learn how to use a debugger. Knowing how to debug a program is very handy, and part of the skill."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1491403970, "post_id": 43234494, "comment_id": 73539538, "body": "the <code>*</code> operator as in the arithmetic operator, or <code>*</code> as in: pointer/dereferencing operator?"}, {"owner": {"reputation": 11, "user_id": 7821291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6837d2a38f5d68436e1e248198c317a9?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Tabernig", "link": "https://stackoverflow.com/users/7821291/maria-tabernig"}, "edited": false, "score": 0, "creation_date": 1491404032, "post_id": 43234494, "comment_id": 73539593, "body": "as in the arithmetic operator"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1491404324, "post_id": 43234494, "comment_id": 73539844, "body": "Using <code>matrix2[c][b]--;</code> you are modifying the value in matrix, so next time that value will be 0..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1491404416, "post_id": 43234494, "comment_id": 73539921, "body": "Divide the program into functional units and test them separately. You can&#39;t use <code>*</code>? Then write a function<code>mul(a,b)</code> and use it instead."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1491404977, "creation_date": 1491404977, "answer_id": 43235140, "question_id": 43234494, "link": "https://stackoverflow.com/questions/43234494/c-matrix-multiplication-without-operator/43235140#43235140", "title": "c : matrix multiplication without * operator", "body": "<p>You have 2 main errors</p>\n\n<ol>\n<li>You must reset <code>multi</code> to <code>0</code> not <code>sum</code>, that is useless</li>\n<li>You must use a temp variable for your moltiplication,. Your code modify the original value of matrix using <code>matrix2[c][b]--;</code></li>\n</ol>\n\n<hr>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)\n{\n    int matrix1[4][4] = { {1,2,3,4},{5,6,7,8},{9,10,11,12},{13,14,15,16}};\n    int matrix2[4][4] = { {17,18,19,20},{21,22,23,24},{25,26,27,28},{29,30,31,32}};\n    int matrix3[4][4];\n    int a;\n    int b;\n    int c;\n    int multi = 0;\n\n    //Multiplication:\n    for (a = 0; a &lt; 4; a++)\n    {\n        for (b = 0; b &lt; 4; b++)\n        {\n            multi = 0;\n            for (c = 0; c &lt; 4; c++)\n            {\n                int temp = matrix2[c][b];\n                while (temp &gt; 0)\n                {\n                    multi += matrix1[a][c];\n                    temp--;\n                }\n            }\n            matrix3[a][b] = multi;\n        }\n    }\n\n    //result;\n    for (a = 0; a &lt; 4; a++)\n    {\n        for (b = 0; b &lt; 4; b++)\n        {\n            printf(\"%d\\t\", matrix3[a][b]);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>250  260  270  280  \n618  644  670  696  \n986  1028 1070 1112 \n1354 1412 1470 1528 \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7821291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6837d2a38f5d68436e1e248198c317a9?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Tabernig", "link": "https://stackoverflow.com/users/7821291/maria-tabernig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491404977, "creation_date": 1491403423, "last_edit_date": 1491403786, "question_id": 43234494, "link": "https://stackoverflow.com/questions/43234494/c-matrix-multiplication-without-operator", "title": "c : matrix multiplication without * operator", "body": "<p>I have to write a c program which multiplies two matrices without using the * operator. I wrote a code but the result is not correct I think something with the while loop is not correct. I hope someone can help. greetings M</p>\n\n<p>Here is my code:</p>\n\n<pre><code>  #include&lt;stdio.h&gt;\n\nint main()\n{\n  int matrix1[4][4];\n  int matrix2[4][4];\n  int matrix3[4][4];\n  int a;\n  int b;\n  int c;\n  int sum;\n  int multi = 0;\n\n  //first matrix\n  for(a=0; a&lt;4; a++)\n  {\n    for(b=0; b&lt;4; b++)\n    {\n      scanf(\"%d\", &amp;matrix1[a][b]);\n    }\n  }\n  //second matrix\n  for(a=0; a&lt;4; a++)\n  {\n    for(b=0; b&lt;4; b++)\n    {\n      scanf(\"%d\", &amp;matrix2[a][b]);\n    }\n  }\n//Multiplication:\n  for(a=0; a&lt;=3; a++)\n  {\n    for(b=0; b&lt;=3; b++)\n    {\n      sum=0;\n      for(c=0; c&lt;=3; c++)\n      {\n        while(matrix2[c][b]&gt;0)\n        {\n          multi += matrix1[a][c];\n          matrix2[c][b]--;\n        }\n      }\n      sum = sum+multi;\n      matrix3[a][b]=sum;\n    }\n  }\n\n  //result;\n  for(a=0; a&lt;4; a++)\n  {\n    for(b=0; b&lt;4; b++)\n    {\n      printf(\" %d \", matrix3[a][b]);\n    }\n    printf(\"\\n\");\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "struct", "julia"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2438196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e8aed878e79654221ed65d2f9ef857ea?s=128&d=identicon&r=PG", "display_name": "Max Behr", "link": "https://stackoverflow.com/users/2438196/max-behr"}, "edited": false, "score": 0, "creation_date": 1491470255, "post_id": 43244500, "comment_id": 73570619, "body": "Hi thanks you very much! It there any reason to use struct instead of type? Best Max"}, {"owner": {"reputation": 3789, "user_id": 508431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192f114babcc8c2f53936c145bbc502c?s=128&d=identicon&r=PG", "display_name": "Isaiah Norton", "link": "https://stackoverflow.com/users/508431/isaiah-norton"}, "reply_to_user": {"reputation": 55, "user_id": 2438196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e8aed878e79654221ed65d2f9ef857ea?s=128&d=identicon&r=PG", "display_name": "Max Behr", "link": "https://stackoverflow.com/users/2438196/max-behr"}, "edited": false, "score": 1, "creation_date": 1491480794, "post_id": 43244500, "comment_id": 73578331, "body": "Yes: <code>struct</code> (<code>immutable</code> before 0.6) has C-compatible memory layout and the member struct will be stored inline."}, {"owner": {"reputation": 55, "user_id": 2438196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e8aed878e79654221ed65d2f9ef857ea?s=128&d=identicon&r=PG", "display_name": "Max Behr", "link": "https://stackoverflow.com/users/2438196/max-behr"}, "edited": false, "score": 0, "creation_date": 1491499037, "post_id": 43244500, "comment_id": 73592172, "body": "Ah ok. I start understanding.  In Julia 0.5 i have to use immutable or type <a href=\"http://docs.julialang.org/en/stable/manual/calling-c-and-fortran-code/\" rel=\"nofollow noreferrer\">docs.julialang.org/en/stable/manual/calling-c-and-fortran-co&zwnj;&#8203;de</a>.  Now they have changed the keywords  <a href=\"https://github.com/yoda90/julia/blob/master/NEWS.md\" rel=\"nofollow noreferrer\">github.com/yoda90/julia/blob/master/NEWS.md</a>.  But how can i be sure to be compatible to 0.5 and 0.6 ?"}, {"owner": {"reputation": 3789, "user_id": 508431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192f114babcc8c2f53936c145bbc502c?s=128&d=identicon&r=PG", "display_name": "Isaiah Norton", "link": "https://stackoverflow.com/users/508431/isaiah-norton"}, "reply_to_user": {"reputation": 55, "user_id": 2438196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e8aed878e79654221ed65d2f9ef857ea?s=128&d=identicon&r=PG", "display_name": "Max Behr", "link": "https://stackoverflow.com/users/2438196/max-behr"}, "edited": false, "score": 0, "creation_date": 1491508461, "post_id": 43244500, "comment_id": 73597685, "body": "Right now <code>immutable</code> will work fine on both 0.5 and 0.6, without a deprecation warning. Eventually it will be deprecated and removed. <a href=\"https://github.com/JuliaLang/Compat.jl\" rel=\"nofollow noreferrer\">Compat.jl</a> is useful in some cases, but it might not be worth the trouble unless you have many structs (changing a few manually is not difficult)."}], "tags": [], "owner": {"reputation": 3789, "user_id": 508431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192f114babcc8c2f53936c145bbc502c?s=128&d=identicon&r=PG", "display_name": "Isaiah Norton", "link": "https://stackoverflow.com/users/508431/isaiah-norton"}, "is_accepted": true, "score": 3, "last_activity_date": 1491450694, "last_edit_date": 1491450694, "creation_date": 1491444640, "answer_id": 43244500, "question_id": 43233976, "link": "https://stackoverflow.com/questions/43233976/translate-recursive-defined-structs-to-julia-for-c-interface/43244500#43244500", "title": "Translate Recursive Defined Structs to Julia for C Interface", "body": "<p>Declare the inner struct first, then use it as a member:</p>\n\n<pre><code>struct A_st\n  c::Cint\n  f1::Ptr{Void}\n  f2::Ptr{Void}\n  f3::Ptr{Void}\nend\n\nstruct my_struct\n  child::Ptr{my_struct}\n  a::Cint\n  A::A_st\nend\n</code></pre>\n\n<p>Untested, but the Julia alignments look correct:</p>\n\n<pre><code>julia&gt; map(i -&gt; Int(fieldoffset(my_struct,i)), 1:3)\n3-element Array{Int64,1}:\n  0\n  8\n 16\n\njulia&gt; map(i -&gt; Int(fieldoffset(A_st,i)), 1:4)\n4-element Array{Int64,1}:\n  0\n  8\n 16\n 24\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>clang -cc1 -fdump-record-layouts t.cpp\n\n*** Dumping AST Record Layout\n         0 | struct my_struct\n         0 |   struct my_struct * child\n         8 |   int a\n        16 |   struct my_struct::A_st A\n        16 |     int c\n        24 |     int (*)(struct my_struct *) f1\n        32 |     int (*)(struct my_struct *) f2\n        40 |     int (*)(struct my_struct *) f3\n           | [sizeof=48, dsize=48, align=8,\n           |  nvsize=48, nvalign=8]\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2438196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e8aed878e79654221ed65d2f9ef857ea?s=128&d=identicon&r=PG", "display_name": "Max Behr", "link": "https://stackoverflow.com/users/2438196/max-behr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 43244500, "answer_count": 1, "score": 2, "last_activity_date": 1491450694, "creation_date": 1491402183, "last_edit_date": 1491402555, "question_id": 43233976, "link": "https://stackoverflow.com/questions/43233976/translate-recursive-defined-structs-to-julia-for-c-interface", "title": "Translate Recursive Defined Structs to Julia for C Interface", "body": "<p>I want to write a Julia interface to a C library. For me it is necessary to \ntranslate a C struct to a Julia type. This is necessary because i want to make \na call to a C function using ccall. </p>\n\n<pre><code>    struct my_struct {\n\n        struct my_struct * child; \n        int a;\n\n        struct A_st{\n            int c; \n            int (*f1) (struct my_struct * eqn); \n            int (*f2) (struct my_struct * eqn); \n            int (*f3) (struct my_struct * eqn); \n        } A; \n    };\n</code></pre>\n\n<p>I know that Julia has a problem with circular defined types\n<a href=\"https://github.com/JuliaLang/julia/issues/269\" rel=\"nofollow noreferrer\">https://github.com/JuliaLang/julia/issues/269</a>\n\"Simple\" defined structs i have already mapped to a julia type but with this one i have problems.    </p>\n"}, {"tags": ["c", "pointers", "syntax", "casting"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1491401345, "post_id": 43233506, "comment_id": 73537277, "body": "<code>x</code> is an <code>int</code>.  When you force the address to point to a <code>float</code>, it still contains the bits of an <code>int</code>.  That&#39;s not a <code>float</code>.  And, as explained in the answer, it&#39;s undefined behavior anyway as you&#39;re violating the strict aliasing rule.  Try doing that on some systems and you&#39;ll likely get a <code>SIGBUS</code> or similar that aborts your program."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1491401567, "post_id": 43233506, "comment_id": 73537471, "body": "Compare <code>p &#47;t x</code> and <code>p &#47;t *ptrF</code> instead. (Then think about the concepts of <i>representation</i> and <i>interpretation</i> until you get it.)"}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491408600, "post_id": 43233506, "comment_id": 73542911, "body": "@AndrewHenle Wow, thanks Andrew, that makes a world of sense.  I hadn&#39;t thought about the bit structure of an int vs. a float.  That also explains how I was able to do this earlier between an int and an unsigned short.  Much appreciated!"}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1491408629, "post_id": 43233506, "comment_id": 73542938, "body": "@molbdnilo.  Hmm, awesome suggestion, thanks, I&#39;ll try it"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1491402036, "post_id": 43233550, "comment_id": 73537842, "body": "The clause about alignment of the pointed-to type is certainly a consideration, and it <i>might</i> be relevant, but if there is any singular <i>the</i> relevant part of the standard then it is surely <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p7\" rel=\"nofollow noreferrer\">paragraph 6.5/7</a>, a.k.a. the Strict Aliasing Rule."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1491402692, "post_id": 43233550, "comment_id": 73538399, "body": "@JohnBollinger actually that makes much more sense, let me add that too alogside my own words. :)"}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "edited": false, "score": 0, "creation_date": 1491408511, "post_id": 43233550, "comment_id": 73542847, "body": "@SouravGhosh - Thanks Sourav, I wasn&#39;t familiar with the term &quot;strict aliasing&quot;  I&#39;m going to read up on your recommendations..."}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "edited": false, "score": 0, "creation_date": 1491408899, "post_id": 43233550, "comment_id": 73543125, "body": "@SouravGhosh - Thanks, your readings led me to the answer.  I&#39;ve modified my function to malloc() a float on the heap, then assign the value of the incoming int to the new float.  This ensures the returned float* points to something with the original data.... I just have to remember to free() the pointer in the main() function."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1491402826, "last_edit_date": 1491402826, "creation_date": 1491401150, "answer_id": 43233550, "question_id": 43233506, "link": "https://stackoverflow.com/questions/43233506/c-cast-a-pointer-in-a-function-lose-the-data/43233550#43233550", "title": "C :: Cast a pointer in a function, lose the data?", "body": "<p>In your code</p>\n\n<pre><code> return (float*)a;\n</code></pre>\n\n<p>is violation of strict aliasing rule. An <code>int *</code> and a <code>float *</code> do not alias each other, so the casting makes the code <em>invalid</em>.</p>\n\n<p><code>int</code> and <code>float</code> have different alignment requirements, so basically you cannot reference the memory location reserved for an <code>int</code> via a pointer to <code>float</code> (and vice-versa) and expect everything to fall into place.</p>\n\n<p>Quoting the relevant part of the standard, chapter \u00a76.5/P7</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue expression that has one of\n  the following types:88)</p>\n  \n  <p>\u2014 a type compatible with the effective type of the object,</p>\n  \n  <p>\u2014 a qualified version of a type compatible with the effective type of the object,</p>\n  \n  <p>\u2014 a type that is the signed or unsigned type corresponding to the effective type of the\n  object,</p>\n  \n  <p>\u2014 a type that is the signed or unsigned type corresponding to a qualified version of the\n  effective type of the object,</p>\n  \n  <p>\u2014 an aggregate or union type that includes one of the aforementioned types among its\n  members (including, recursively, a member of a subaggregate or contained union), or</p>\n  \n  <p>\u2014 a character type.</p>\n</blockquote>\n\n<p>and, more, chapter \u00a76.3.2.3/P7</p>\n\n<blockquote>\n  <p>A pointer to an object type may be converted to a pointer to a different object type. If the\n  resulting pointer is not correctly aligned<sup>68)</sup> for the referenced type, the behavior is\n  undefined. [....]</p>\n</blockquote>\n"}], "owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1491401465, "accepted_answer_id": 43233550, "answer_count": 1, "score": 0, "last_activity_date": 1491402826, "creation_date": 1491401041, "question_id": 43233506, "link": "https://stackoverflow.com/questions/43233506/c-cast-a-pointer-in-a-function-lose-the-data", "closed_reason": "Duplicate", "title": "C :: Cast a pointer in a function, lose the data?", "body": "<p>I have a C Syntax 101 question.  Suppose I have a function which takes one kind of pointer as a argument and returns a different type of pointer, and both pointers point to the same data from within the calling function.  For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nfloat* convertPtr(const int *a){\n  return (float*)a;\n}\n\nint main() {\n  float *ptrF;\n  int x = 5;\n\n  ptrF = convertPtr(&amp;x);\n  printf(\"%d ::converted to::  %f\\n\", x, *ptrF);\n  return 0;\n}\n</code></pre>\n\n<p>Output of this program is:</p>\n\n<pre><code>5 ::converted to::  0.000000\n</code></pre>\n\n<p>So I'm a bit baffled by this.  The original data is created within <strong>main()</strong> and is not changed.  The <strong>convertPtr()</strong> function never alters the data, but should only change the type of the pointer.</p>\n\n<p>I also note that when I step through the code on GDB, the pointer (the address itself) does not change:</p>\n\n<pre><code>Breakpoint 1, main () at exp.c:9\n9         int x = 5;\n(gdb) p &amp;x\n$3 = (int *) 0x7fffffffe224\n...continue to after calling convertPtr()...\n(gdb) p ptrF\n$4 = (float *) 0x7fffffffe224\n(gdb)\n</code></pre>\n\n<p>Yet the <strong><em>value</em></strong> pointed to that data has:</p>\n\n<pre><code>(gdb) p x\n$8 = 5\n(gdb) p *(&amp;x)       // sanity check\n$9 = 5\n(gdb) p *ptrF\n$10 = 7.00649232e-45\n(gdb)\n</code></pre>\n\n<p>So... what the heck?  After my convertPtr() function, the pointer has been recast but the value of the pointer has not changed... yet dereferencing the converted pointer seems to be pointing to garbage data.  (I'm assuming.)</p>\n\n<p>Does anyone see the issue here?  Supposed I HAD to fix my function; how do I do that?  Thanks...</p>\n\n<p>-ROA</p>\n\n<p>PS:  Apologies if this is a duplicate question.  I searched for about an hour for \"C\", \"pointer\", \"casting\", \"change value\", and the posts I pulled up were all over the map.  Sometimes its best to ask your question directly.</p>\n"}, {"tags": ["c++", "c", "arrays", "struct"], "comments": [{"owner": {"reputation": 3702, "user_id": 1059969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JKhUL.jpg?s=128&g=1", "display_name": "Agent_L", "link": "https://stackoverflow.com/users/1059969/agent-l"}, "edited": false, "score": 6, "creation_date": 1491400189, "post_id": 43233123, "comment_id": 73536267, "body": "Have you tried to actually compile it?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 6, "creation_date": 1491400221, "post_id": 43233123, "comment_id": 73536308, "body": "And do you really need code that compiles as C <i>and</i> C++?"}, {"owner": {"reputation": 3046, "user_id": 3013887, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1396249d91442e1dde6e93197c0b94a?s=128&d=identicon&r=PG&f=1", "display_name": "pingul", "link": "https://stackoverflow.com/users/3013887/pingul"}, "edited": false, "score": 0, "creation_date": 1491400768, "post_id": 43233123, "comment_id": 73536768, "body": "Not sure if applicable, but in case you aim to do heavy computations, you might want to consider <a href=\"https://en.wikipedia.org/wiki/AOS_and_SOA\" rel=\"nofollow noreferrer\">structures of arrays</a> instead."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1491401625, "post_id": 43233123, "comment_id": 73537516, "body": "It&#39;s valid C and ugly C++."}], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 1, "creation_date": 1491402433, "post_id": 43233812, "comment_id": 73538206, "body": "<code>printf(&quot;%d %d\\n&quot;, points[i]);</code> will not work use <code>printf(&quot;%d %d\\n&quot;, points[i].x, points[i].y);</code>"}, {"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "reply_to_user": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491402948, "post_id": 43233812, "comment_id": 73538646, "body": "@kaldoran It was working with vs2015 compiler, anyway, editing"}], "tags": [], "owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "is_accepted": false, "score": -1, "last_activity_date": 1491402960, "last_edit_date": 1491402960, "creation_date": 1491401747, "answer_id": 43233812, "question_id": 43233123, "link": "https://stackoverflow.com/questions/43233123/creating-array-of-points-in-c-and-c/43233812#43233812", "title": "Creating array of points in C and C++", "body": "<p>You got a syntax error when declaring your structure, you're missing a semicolon after <code>unsigned int y</code>, in any case, the best way to check if it's valid or not is using the c/c++ compiler, for instance, try to compile&amp;run this one:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct point_t {\n    unsigned int x;\n    unsigned int y;\n} point_t;\n\nint main(int argc, char *argv[]) {\n    point_t points[64] = {{23, 67}, {123, 9}, {55, 0}};\n\n    for (int i = 0; i &lt; 64; i++) {\n        printf(\"%d %d\\n\", points[i].x, points[i].y);\n    }\n}\n</code></pre>\n\n<p>You should see how you've filled up the 3 first points and the rest of your array of structures will be filled up by 0s.</p>\n"}], "owner": {"reputation": 1897, "user_id": 854183, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c1503cf70823c67b54c197559cc08c63?s=128&d=identicon&r=PG", "display_name": "quantum231", "link": "https://stackoverflow.com/users/854183/quantum231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 879, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1491402960, "creation_date": 1491400094, "last_edit_date": 1491400222, "question_id": 43233123, "link": "https://stackoverflow.com/questions/43233123/creating-array-of-points-in-c-and-c", "title": "Creating array of points in C and C++", "body": "<p>There are different ways to reach the same end but this is basically what I am trying to do:</p>\n\n<pre><code>typedef struct point_t {\n    unsigned int x;\n    unsigned int y\n} point_t;\n</code></pre>\n\n<p><code>point_t points[64] = { {23, 67}, {123, 9}, {55, 0} ... }</code></p>\n\n<p>I just want to create a constant array of xy coordinates and read them like this:</p>\n\n<pre><code>i = points[0].x\nj = points[0].y\n</code></pre>\n\n<p>Is this valid in C and C++?</p>\n"}, {"tags": ["c", "string", "pointers", "segmentation-fault", "strcpy"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1491400456, "post_id": 43233062, "comment_id": 73536512, "body": "In the 2nd example, the optimizer is free to eliminate the strcpy, since the next line replaces the value."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491400469, "post_id": 43233062, "comment_id": 73536529, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 1, "user_id": 3156746, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35a4fbd7fe52074e0156e98f3e2a0593?s=128&d=identicon&r=PG&f=1", "display_name": "Kranthi", "link": "https://stackoverflow.com/users/3156746/kranthi"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1491401036, "post_id": 43233062, "comment_id": 73537013, "body": "@stark :  the optimizer is free to eliminate the strcpy, can you please provide any link for further study and understanding"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491400193, "post_id": 43233093, "comment_id": 73536272, "body": "@ThingyWotsit maybe someone lost their key, or ....."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1491400277, "post_id": 43233093, "comment_id": 73536363, "body": "No, because the original version (containing only the first and last sentence) - while correct - really wasn&#39;t useful in any way. Now some content was added, but I ask myself, where the reason is to just spit out a sensess answer as fast as possible and then refining it step by step."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1491400324, "post_id": 43233093, "comment_id": 73536404, "body": "It looks like a homework dump anyway:("}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1491400430, "post_id": 43233093, "comment_id": 73536489, "body": "@Ctx Well, it was an answer, useful or not, up to you. The outcome of UB is explained in the link...so it was self sufficient. A bit of polish never hurts. :)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1491400713, "post_id": 43233093, "comment_id": 73536707, "body": "@SouravGhosh He asked, <i>why</i> the program gives a segmentation fault. The response &quot;it&#39;s UB&quot; just explains, why this behaviour is standard compliant, but it is not the reason for the segv itself. You now start to provide a real answer, so I&#39;ll retract the DV. But I personally do not like useless, early answers, just to be the first to go..."}, {"owner": {"reputation": 1, "user_id": 3156746, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35a4fbd7fe52074e0156e98f3e2a0593?s=128&d=identicon&r=PG&f=1", "display_name": "Kranthi", "link": "https://stackoverflow.com/users/3156746/kranthi"}, "edited": false, "score": 0, "creation_date": 1491400819, "post_id": 43233093, "comment_id": 73536829, "body": "@Sourav  attempt to write to non-writable memory, can you please explain it more. Where is this &#39;ptr&#39; stored in memory ? Data section or Code section."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1, "user_id": 3156746, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35a4fbd7fe52074e0156e98f3e2a0593?s=128&d=identicon&r=PG&f=1", "display_name": "Kranthi", "link": "https://stackoverflow.com/users/3156746/kranthi"}, "edited": false, "score": 0, "creation_date": 1491400895, "post_id": 43233093, "comment_id": 73536895, "body": "@Kranthi depends on the compiler, should be in read-only memory, for most of them. C only mandates that attempt to alter a string literal will cause UB."}, {"owner": {"reputation": 1, "user_id": 3156746, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35a4fbd7fe52074e0156e98f3e2a0593?s=128&d=identicon&r=PG&f=1", "display_name": "Kranthi", "link": "https://stackoverflow.com/users/3156746/kranthi"}, "edited": false, "score": 0, "creation_date": 1491400940, "post_id": 43233093, "comment_id": 73536923, "body": "Also what is the difference between assigning string literal to ptr and strcpy. What exactly happens in the compiler"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1491400743, "last_edit_date": 1495535449, "creation_date": 1491400002, "answer_id": 43233093, "question_id": 43233062, "link": "https://stackoverflow.com/questions/43233062/string-pointers-and-strcpy/43233093#43233093", "title": "String pointers and strcpy", "body": "<p>All of above scenarios cause <strong><a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a></strong>.</p>\n\n<p>For ease of explanation, let's call the four snippets as (I), (II), (III) and (IV), in order of appearance.</p>\n\n<ul>\n<li><p>So, in (I), <code>strcpy(ptr,\"String\");</code> is an attempt to write to non-writable memory (attempt to modification of string literal, put another way).</p></li>\n<li><p>In (II), <code>strcpy(ptr,\"String\");</code> causes memory overrun as the destination has lesser space than the source.</p></li>\n<li><p>In (III), <code>ptr[1] = 's';</code> is an attempt to modify (part of) string literal.</p></li>\n<li><p>In (IV), same as (II).</p></li>\n</ul>\n\n<p>You cannot reasonify the outcome of a program causing UB. Segmentation fault is <strong>one of the many possible side effects</strong> of UB, <strong>not the only one</strong>.</p>\n\n<p>That said, <a href=\"https://stackoverflow.com/q/605845/2173917\">please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 3156746, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35a4fbd7fe52074e0156e98f3e2a0593?s=128&d=identicon&r=PG&f=1", "display_name": "Kranthi", "link": "https://stackoverflow.com/users/3156746/kranthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "closed_date": 1491400796, "answer_count": 1, "score": -2, "last_activity_date": 1491400944, "creation_date": 1491399927, "last_edit_date": 1491400944, "question_id": 43233062, "link": "https://stackoverflow.com/questions/43233062/string-pointers-and-strcpy", "closed_reason": "Duplicate", "title": "String pointers and strcpy", "body": "<p>Why does this program give segmentation fault</p>\n\n<pre><code>int main()\n{\n    char *ptr;\n    ptr = (char *)malloc(15*sizeof(char));\n    ptr = \"string\";\n    strcpy(ptr,\"NewString\");\n}\n</code></pre>\n\n<p>while this does not</p>\n\n<pre><code>int main()\n{\n    char *ptr;\n    ptr = (char *)malloc(15*sizeof(char));\n    strcpy(ptr,\"String\");\n    ptr = \"Newstring\";\n}\n</code></pre>\n\n<p>OR the similar program when one literal in the string is to be modified</p>\n\n<pre><code>int main()\n{\n    char *ptr;\n    ptr = \"string\";\n    ptr[1] = 's';\n}\n</code></pre>\n\n<p>when this does not</p>\n\n<pre><code>int main()\n{\n    char *ptr;\n    ptr = (char *)malloc(15*sizeof(char));\n    strcpy(ptr,\"String\");\n    ptr[1] = 's';\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "heap"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1491399157, "post_id": 43232728, "comment_id": 73535388, "body": "What&#39;s so cool with typedefing pointers...really?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491399234, "post_id": 43232728, "comment_id": 73535446, "body": "@SouravGhosh - Income security. It makes ones code is so awful that no one can stand to debug it but oneself."}, {"owner": {"reputation": 1, "user_id": 7820890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9864a1364ac10ed2ce0b9fe58cefb764?s=128&d=identicon&r=PG&f=1", "display_name": "genericmathstudent", "link": "https://stackoverflow.com/users/7820890/genericmathstudent"}, "edited": false, "score": 0, "creation_date": 1491399241, "post_id": 43232728, "comment_id": 73535456, "body": "I have no idea lol, the skeleton code came like that, I thought it was really weird too"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491399437, "post_id": 43232728, "comment_id": 73535635, "body": "@StoryTeller I doubt about the validity to &quot;oneself&quot; also...:)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1491399440, "post_id": 43232728, "comment_id": 73535640, "body": "@genericmathstudent - It&#39;s not only weird, it&#39;s harmful. The person who provided you with this code thought they were doing &quot;abstraction&quot; when in fact they were preforming obfuscation."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1491399973, "post_id": 43232728, "comment_id": 73536081, "body": "it probably means that when you&#39;re doing <code>sizeof(cache_set_t)</code>, you&#39;re not getting what you expected"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491400278, "post_id": 43232728, "comment_id": 73536362, "body": "<code>curr.next  = malloc(...);</code> :: you are confusing <code>.</code> and <code>-&gt;</code> here ..."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1491488577, "post_id": 43232728, "comment_id": 73584544, "body": "Somebody please just delete this question if the current edit version is all that&#39;s left."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1491410225, "last_edit_date": 1491410225, "creation_date": 1491400566, "answer_id": 43233305, "question_id": 43232728, "link": "https://stackoverflow.com/questions/43232728/c-array-of-linked-list-struct-on-heap/43233305#43233305", "title": "C Array of Linked List Struct on Heap", "body": "<p>Well, the fact the code is terribly obfuscated with abuse of <code>typedef</code> probably goes a long way towards both yours and the compilers problems. I wouldn't have a single typedef in this program myself. It serves no real abstraction here. Here's what I'd suggest (with some omission of error checking):</p>\n\n<pre><code>struct cache_line {\n    char valid;\n    mem_addr_t tag;\n    struct cache_line* next;\n};\n\nstruct cache_line** cache;\n\nvoid initCache()\n{\n    cache = malloc (sizeof(*cache) * S);\n    for (int i = 0; i &lt; S; i ++ ){\n        struct cache_line** curr_p = &amp;cache[i];\n        for (int j = 1; j &lt; E; j++){\n            *curr_p = malloc(sizeof(**curr_p));\n            (*curr_p)-&gt;valid = 0;\n            (*curr_p)-&gt;tag = 0;\n            (*curr_p)-&gt;next = NULL;\n            curr_p = &amp;(*curr_p)-&gt;next;\n        }\n    }\n}\n</code></pre>\n\n<p>Key things to note:</p>\n\n<ol>\n<li><p>I removed all the typedefs. They served no real purpose here but an attempt to save typing. And they did it at the cost of code quality. I also removed it from the <code>struct</code>, since I believe the previous statement applies to it as well.</p></li>\n<li><p>I allocated memory canonically. By writing <code>malloc(sizeof(*pointer_variable))</code>, you allocate enough memory regardless of what <code>pointer_variable</code> points at. It's somewhat type agnostic.</p></li>\n<li><p>I traverse the linked list with the \"link traversal\" idiom. Instead of keeping track of the \"node\", I keep track of the pointer that is pointing at the node. In the beginning it's <code>cache[i]</code>, and at every iteration it becomes the pointer inside the newly allocated node.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 7820890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9864a1364ac10ed2ce0b9fe58cefb764?s=128&d=identicon&r=PG&f=1", "display_name": "genericmathstudent", "link": "https://stackoverflow.com/users/7820890/genericmathstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1491413391, "creation_date": 1491399086, "last_edit_date": 1491413391, "question_id": 43232728, "link": "https://stackoverflow.com/questions/43232728/c-array-of-linked-list-struct-on-heap", "title": "C Array of Linked List Struct on Heap", "body": "<p>printf(\"pointer = %p\\n\", line);</p>\n\n<blockquote>\n  <p>Blockquote</p>\n  \n  <p>Blockquote</p>\n</blockquote>\n"}, {"tags": ["c", "linux", "multithreading", "measurement"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1491398530, "post_id": 43232157, "comment_id": 73534859, "body": "&quot;Is there some other way to do this measurement within Linux&quot; <b>Yes</b>, clock_gettime with CLOCK_THREAD_CPUTIME_ID."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491402181, "post_id": 43232157, "comment_id": 73537986, "body": "This sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem.</a> What do you plan on doing with the values you get?  Measuring the time spent in a function is usually done with a purpose.  What is your purpose?  The best way to do that should be your question."}, {"owner": {"reputation": 31, "user_id": 7820359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57abee4ddd8afb694fd92dfafff19?s=128&d=identicon&r=PG&f=1", "display_name": "Mansena", "link": "https://stackoverflow.com/users/7820359/mansena"}, "edited": false, "score": 0, "creation_date": 1491455547, "post_id": 43232157, "comment_id": 73561845, "body": "The purpose is the following. I have a process that handles data traffic and then this traffic is delivered to a client via a callback function, i.e. it will execute within the same process. I want to measure how much of the capacity that the server part is using. One way I thought of would be to measure the time spent in the callback function and subtract that from the total execution time of the process."}], "answers": [{"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 0, "last_activity_date": 1491398762, "last_edit_date": 1491398762, "creation_date": 1491398421, "answer_id": 43232472, "question_id": 43232157, "link": "https://stackoverflow.com/questions/43232157/how-to-measure-total-execution-time-of-a-function-in-linux-multithreaded-environ/43232472#43232472", "title": "How to measure total execution time of a function in Linux multithreaded environment", "body": "<p>getting time from from <code>clock()</code> and <code>gettimeofday()</code> family functions are good for obtaining precise time difference between two consequent calls, but not good for obtaining time spent in functions, because of thread and process rescheduling of operating system and IO blocking, there isn't any guarantee which your thread/process could obtain CPU until finishes its operations, so you can't relay on time difference. \nYou have two choice for this</p>\n\n<ol>\n<li><p>Using profiling softwares such as Intel V-Tune and Intel Inspector which will utilize the hardware performance counters</p></li>\n<li><p>Using Realtime linux kernel, scheduling your process with FIFO scheduler and use time difference, in FIFO scheduler no one interrupt your program so you can safely use the time difference as time spent in functions, using clock(), gettimeofday() or even more precise rdtsc</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7820359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57abee4ddd8afb694fd92dfafff19?s=128&d=identicon&r=PG&f=1", "display_name": "Mansena", "link": "https://stackoverflow.com/users/7820359/mansena"}, "edited": false, "score": 0, "creation_date": 1491502678, "post_id": 43232557, "comment_id": 73594276, "body": "This would be a good way to do it but when I tried it I noticed I got the resolution in milliseconds and not microseconds. Then the start time and end time had the same value."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "reply_to_user": {"reputation": 31, "user_id": 7820359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57abee4ddd8afb694fd92dfafff19?s=128&d=identicon&r=PG&f=1", "display_name": "Mansena", "link": "https://stackoverflow.com/users/7820359/mansena"}, "edited": false, "score": 0, "creation_date": 1491503860, "post_id": 43232557, "comment_id": 73594956, "body": "According to <a href=\"http://elinux.org/Kernel_Timer_Systems#Old_timer_wheel.2Fjiffy_replacement_proposals\" rel=\"nofollow noreferrer\">elinux.org/&hellip;</a>, the Linux kernel tracks CPU time on milliseconds&#39; basis. The Linux kernel simply does not track CPU time at such a high level granularity."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 2, "last_activity_date": 1491398651, "creation_date": 1491398651, "answer_id": 43232557, "question_id": 43232157, "link": "https://stackoverflow.com/questions/43232157/how-to-measure-total-execution-time-of-a-function-in-linux-multithreaded-environ/43232557#43232557", "title": "How to measure total execution time of a function in Linux multithreaded environment", "body": "<p>Your question states that you are using Linux.</p>\n\n<p>You can use the <a href=\"http://manpages.courier-mta.org/htmlman2/getrusage.2.html\" rel=\"nofollow noreferrer\">getrusage(2)</a> system call with the <code>RUSAGE_THREAD</code> parameter, which will give you the accumulated statistics for the currently running thread.</p>\n\n<p>By comparing what's in <code>ru_utime</code>, and perhaps <code>ru_stime</code> also, before and after your function runs, you should be able to determine how much time the function has accumulated in CPU time, for the currently running thread.</p>\n\n<p>Lather, rinse, repeat, for all threads, and add them up.</p>\n"}, {"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 0, "last_activity_date": 1491399022, "creation_date": 1491399022, "answer_id": 43232706, "question_id": 43232157, "link": "https://stackoverflow.com/questions/43232157/how-to-measure-total-execution-time-of-a-function-in-linux-multithreaded-environ/43232706#43232706", "title": "How to measure total execution time of a function in Linux multithreaded environment", "body": "<p>A very good tool for performance analysis is <code>perf</code> (available with recent linux kernels):</p>\n\n<p>Record performance data with</p>\n\n<pre><code>perf record &lt;command&gt;\n</code></pre>\n\n<p>and then analyze it with</p>\n\n<pre><code>perf report\n</code></pre>\n\n<p>Compile your program with debug symbols for useful results.</p>\n"}], "owner": {"reputation": 31, "user_id": 7820359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57abee4ddd8afb694fd92dfafff19?s=128&d=identicon&r=PG&f=1", "display_name": "Mansena", "link": "https://stackoverflow.com/users/7820359/mansena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1491399040, "creation_date": 1491397569, "last_edit_date": 1495535450, "question_id": 43232157, "link": "https://stackoverflow.com/questions/43232157/how-to-measure-total-execution-time-of-a-function-in-linux-multithreaded-environ", "title": "How to measure total execution time of a function in Linux multithreaded environment", "body": "<p>I want to measure the total time spent in a C function within Linux. The function may be called at the same time from different threads, and the times spent should be summed together. How can I do this measurement from Linux? I have looked at the <code>clock()</code> function and to calculate the difference between the start and end of the function. </p>\n\n<p>I found one solution using <code>clock()</code> in this thread within Stackoverflow:\n<a href=\"https://stackoverflow.com/questions/23017519/how-to-measure-total-time-spent-in-a-function\">How to measure total time spent in a function?</a></p>\n\n<p>But from what I understand this will also include the CPU processing from  threads executes some other function during the time of measurement. Is that a correct assumption?</p>\n\n<p>Is there some other way to do this measurement within Linux?</p>\n"}, {"tags": ["c", "macros", "self"], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491397757, "post_id": 43232101, "comment_id": 73534182, "body": "And going a bit further, OP could eliminate the <code>M1</code> and <code>M2</code> macros, and define <code>int m1[] = EXPAND(M1), m2[] = EXPAND(M2);</code>."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1491397431, "creation_date": 1491397431, "answer_id": 43232101, "question_id": 43232032, "link": "https://stackoverflow.com/questions/43232032/using-name-of-macro-from-within-macro-in-c/43232101#43232101", "title": "Using name of macro from within macro in C", "body": "<p>Add a level of indirection with a function-like macro</p>\n\n<pre><code>#define EXPAND(name) { V_##name, A_##name }\n#define M1 EXPAND(M1)\n#define M2 EXPAND(M2)\n</code></pre>\n\n<p>The <code>##</code> is the token concatenation operator, that takes <code>V</code> and whatever you pass as <code>name</code> and glues them to form a single token. If the result is another macro, it's expanded further.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491397749, "creation_date": 1491397749, "answer_id": 43232220, "question_id": 43232032, "link": "https://stackoverflow.com/questions/43232032/using-name-of-macro-from-within-macro-in-c/43232220#43232220", "title": "Using name of macro from within macro in C", "body": "<p>Macros like these are often questionable practice. Consider grouping your values in const structs or similar, for better program design.</p>\n\n<p>That being said, everything in C is possible if you throw enough evil macros on it. Given no other choice but to use macros, I would do something like this:</p>\n\n<pre><code>#define M(n) { V_M ## n, A_M##n }\nint m1[]=M(1), m2[]=M(2);\n</code></pre>\n"}], "owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1491397749, "creation_date": 1491397294, "question_id": 43232032, "link": "https://stackoverflow.com/questions/43232032/using-name-of-macro-from-within-macro-in-c", "title": "Using name of macro from within macro in C", "body": "<pre><code>#define V_M1 10\n#define A_M1 60\n#define V_M2 15\n#define A_M2 56\n\n#define M1 { V_M1, A_M1 }\n#define M2 { V_M2, A_M2 }\nint m1[]=M1, m2[]=M2;\n</code></pre>\n\n<p>Is there a way to simplify the definition of the M1 and M2 macros so that I don't have to repeat their names inside (source of errors in my case due to the actual complexity of the macros) ? Something like:</p>\n\n<pre><code>#define M1 { V_MyOwnName, A_MyOwnName }\n#define M2 { V_MyOwnName, A_MyOwnName }\n</code></pre>\n"}, {"tags": ["c", "arrays", "initializer"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1491396986, "post_id": 43231879, "comment_id": 73533554, "body": "No, I don&#39;t think you can do it the way you want."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1491398233, "post_id": 43231929, "comment_id": 73534601, "body": "You have to be careful with <code>\\x</code> though. For example <code>char T[] = &quot;\\x10\\x0f\\xf0Byee!\\xc1\\xd0&quot;;</code> wouldn&#39;t work as expected. Using string literal concatenation would fix it: <code>char T[] = &quot;\\x10\\x0f\\xf0&quot; &quot;Byee!&quot; &quot;\\xc1\\xd0&quot;;</code>"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491399006, "post_id": 43231929, "comment_id": 73535254, "body": "@Ian, good point, have incorporated your info into the answer."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 4, "last_activity_date": 1491398989, "last_edit_date": 1491398989, "creation_date": 1491397056, "answer_id": 43231929, "question_id": 43231879, "link": "https://stackoverflow.com/questions/43231879/mixing-char-and-string-in-c-array-init/43231929#43231929", "title": "Mixing char and string in C array init", "body": "<p>You can't mix them like that. What you <em>can</em> do is to insert hex codes withing a string, such as with:</p>\n\n<pre><code>char T[] = \"\\x10\\x0f\\xf0\" \"Hello\" \"\\xc1\\xd0\";\n</code></pre>\n\n<p>Keep in mind this will put a <code>\\0</code> at the end of that array so you may need to adjust for that if you're using <code>sizeof</code> to get the byte count:</p>\n\n<pre><code>size_t bytesInT = sizeof(T) - 1;\n</code></pre>\n\n<p>Similarly, there <em>won't</em> be a null at the end of the <code>Hello</code> but you can fix that with:</p>\n\n<pre><code>char T[] = \"\\x10\\x0f\\xf0\" \"Hello\\0\" \"\\xc1\\xd0\";\n</code></pre>\n\n<p>You may wonder why the string is separated into three components. This is valid because a very early stage of the compilation process involves concatenating adjacent strings, meaning that <code>\"paxdiablo\"</code> and <code>\"pax\" \"diablo\"</code> are functionally equivalent.</p>\n\n<p>One reason is for readability, but the <em>important</em> one is to ensure that the hex specifications don't \"swallow\" the following characters. It won't matter for <code>Hello</code> since the <code>H</code> is not a valid hex character but you can see the problem here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    printf (\"%d %d\\n\", sizeof(\"\\x20Hi\"), sizeof(\"\\x20Bi\"));\n    return 0;\n}\n</code></pre>\n\n<p>This will output <code>4 3</code> despite the only difference (seemingly) in the two strings being a change of one character. The lengths are different because the <code>B</code> in <code>Bi</code> is actually consumed as a hex digit, being treated as <code>\\x20B</code> (although <code>gcc</code>, for one, will warn you that the resultant value is out of range).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491397299, "post_id": 43231951, "comment_id": 73533802, "body": "Perhaps separate the string literals when starting text after a hex escape <code>&quot;\\x10\\x0F\\xF0ByeBye\\xC1\\xD0&quot;;</code>is a problem.  <code>&quot;\\x10\\x0F\\xF0&quot; &quot;ByeBye\\xC1\\xD0&quot;;</code> is OK"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1491397999, "last_edit_date": 1491397999, "creation_date": 1491397098, "answer_id": 43231951, "question_id": 43231879, "link": "https://stackoverflow.com/questions/43231879/mixing-char-and-string-in-c-array-init/43231951#43231951", "title": "Mixing char and string in C array init", "body": "<p>You cannot mix the two styles, but you can include HEX characters inside a null-terminated string with <a href=\"https://en.wikipedia.org/wiki/Escape_sequences_in_C\" rel=\"nofollow noreferrer\">HEX escape sequences</a>:</p>\n\n<pre><code>// Instead of this\nchar T1[] = {0x10, 0xF, 0xF0, 'H', 'e', 'l', 'l', 'o', 0xC1, 0xD0};\n// Do this:\nchar T2[] = \"\\x10\\x0F\\xF0\" \"Hello\" \"\\xC1\\xD0\";\n// or even this:\nchar T3[] = \"\\x10\" \"\\x0F\" \"\\xF0\" \"Hello\" \"\\xC1\" \"\\xD0\";\n</code></pre>\n\n<p>The only difference between the above and the initializer that you have is that <code>T2</code> and <code>T3</code> are going to have one extra byte with null terminator at the end.</p>\n\n<p>The above syntax exploits the feature of C which automatically concatenates multiple string literals separated by whitespace.</p>\n"}], "owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491398989, "creation_date": 1491396935, "question_id": 43231879, "link": "https://stackoverflow.com/questions/43231879/mixing-char-and-string-in-c-array-init", "title": "Mixing char and string in C array init", "body": "<p>I know that the following 2 initializers are equivalent:</p>\n\n<pre><code>char T1[]=\"abc\";\nchar T2[]={'a', 'b', 'c', 0};\n</code></pre>\n\n<p>I have an array initializer like this:</p>\n\n<pre><code>char T[]={0x10, 0xF, 0xF0, 'H', 'e', 'l', 'l', 'o', 0xC1, 0xD0};\n</code></pre>\n\n<p>Leaving aside the signed/unsigned char potential problems, is there a way to mix the 2 styles of initializer, doing something like that (which doesn't work):</p>\n\n<pre><code>char T[]={0x10, 0xF, 0xF0, \"Hello\", 0xC1, 0xD0};\n</code></pre>\n"}, {"tags": ["c", "ubuntu", "terminal", "console"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491397017, "post_id": 43231827, "comment_id": 73533587, "body": "Is it really???"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1491402070, "post_id": 43231827, "comment_id": 73537876, "body": "You cannot run C files. You can compile C files into executables and run those. Calling an executable from shell is not related to the programming language that was initially used. The C tag is not required here."}], "answers": [{"comments": [{"owner": {"reputation": 771, "user_id": 234278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd4423085dd41b261516de246a21bfb?s=128&d=identicon&r=PG", "display_name": "spdaley", "link": "https://stackoverflow.com/users/234278/spdaley"}, "edited": false, "score": 2, "creation_date": 1491398819, "post_id": 43231914, "comment_id": 73535095, "body": "It&#39;s generally not recommended to add . to your path. See <a href=\"http://unix.stackexchange.com/questions/65700/is-it-safe-to-add-to-my-path-how-come\" title=\"is it safe to add to my path how come\">unix.stackexchange.com/questions/65700/&hellip;</a> for more information. If you do decide to add it though, it&#39;s probably better to add it at the end of the PATH instead of the beginning. See the accepted answer in that link for more details."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1491399125, "last_edit_date": 1491399125, "creation_date": 1491397011, "answer_id": 43231914, "question_id": 43231827, "link": "https://stackoverflow.com/questions/43231827/how-remove-need-of-using-before-running-a-file-in-ubuntu-terminal-window/43231914#43231914", "title": "How remove need of using &quot; ./ &quot; before running a file in ubuntu terminal window?", "body": "<p>You just need to add the current directory \".\" to your search path.  For example;</p>\n\n<pre><code>export PATH=./:$PATH\n</code></pre>\n\n<p>It's better to append it to the PATH like this</p>\n\n<pre><code>export PATH=$PATH:.\n</code></pre>\n"}], "owner": {"reputation": 248, "user_id": 3510989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2035d1005e330fee186fe124109c92d9?s=128&d=identicon&r=PG&f=1", "display_name": "Davis8988", "link": "https://stackoverflow.com/users/3510989/davis8988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 43231914, "answer_count": 1, "score": 0, "last_activity_date": 1491399125, "creation_date": 1491396816, "question_id": 43231827, "link": "https://stackoverflow.com/questions/43231827/how-remove-need-of-using-before-running-a-file-in-ubuntu-terminal-window", "title": "How remove need of using &quot; ./ &quot; before running a file in ubuntu terminal window?", "body": "<p>I am using ubuntu's terminal window to run some c files. after a gcc of a file I need to check the a.out output file and it's really annoying to type \" ./ \" each time.<br>\nI understand there is a way to lose it. How can I do it?</p>\n"}, {"tags": ["c", "linux", "unix", "terminal", "height"], "answers": [{"comments": [{"owner": {"reputation": 61508, "user_id": 78259, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/844c572938eaad1e44eb084fb39416f9?s=128&d=identicon&r=PG", "display_name": "Chas. Owens", "link": "https://stackoverflow.com/users/78259/chas-owens"}, "edited": false, "score": 0, "creation_date": 1491398800, "post_id": 43232465, "comment_id": 73535078, "body": "Thanks, this sounds exactly like what I need."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1491402508, "last_edit_date": 1491402508, "creation_date": 1491398409, "answer_id": 43232465, "question_id": 43231764, "link": "https://stackoverflow.com/questions/43231764/what-is-the-best-way-to-determine-terminal-height-dynamically-in-c-on-unix-linux/43232465#43232465", "title": "What is the best way to determine terminal height dynamically in C on Unix/Linux?", "body": "<p>You can read the current terminal height with TIOCGWINSZ:</p>\n\n<pre><code>#include &lt;sys/ioctl.h&gt; /* needed for lines */\n#include &lt;signal.h&gt;    /* needed for lines */\n#include &lt;stdio.h&gt;     /* needed for printf */\n#include &lt;time.h&gt;      /* needed for sleep */\n\nunsigned short lines;\nstatic void get_lines(int signo) {\n    struct winsize ws;\n    ioctl(fileno(stdout), TIOCGWINSZ, &amp;ws);\n    lines = ws.ws_row;\n}\n\nint main(int argc, char** argv) {\n    int i;\n    struct timespec ts;\n\n    get_lines(SIGWINCH);\n    signal(SIGWINCH, get_lines);\n\n    i = lines;\n    while (1) {\n        if (i &gt;= lines) {\n            printf(\"header\\n\");\n            i = 3; /* 3 not 1 because header + last empty line */\n        } else {\n            i++;\n        }\n        printf(\"line\\n\");\n        ts.tv_sec = 0;\n        ts.tv_nsec = 500000000;\n        nanosleep(&amp;ts, NULL);\n    }\n}\n</code></pre>\n\n<p>The number of lines is now in <code>ws.ws_row</code>.</p>\n\n<p>When the user changes the terminal size (i.e. resizes his terminal window), a <code>SIGWINCH</code> is sent to the foreground process. So you should establish a <em>signal handler</em> for this event and re-read the window size.</p>\n"}], "owner": {"reputation": 61508, "user_id": 78259, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/844c572938eaad1e44eb084fb39416f9?s=128&d=identicon&r=PG", "display_name": "Chas. Owens", "link": "https://stackoverflow.com/users/78259/chas-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43232465, "answer_count": 1, "score": 1, "last_activity_date": 1491402508, "creation_date": 1491396665, "question_id": 43231764, "link": "https://stackoverflow.com/questions/43231764/what-is-the-best-way-to-determine-terminal-height-dynamically-in-c-on-unix-linux", "title": "What is the best way to determine terminal height dynamically in C on Unix/Linux?", "body": "<p>I want to display a header every X lines where X makes the header show up as the last one scrolls off the screen.  The user may change the terminal size and the program should know the answer.  Something roughly like</p>\n\n<pre><code>i = get_lines()+1;\nwhile (1) {\n    if (i &gt; get_lines()) {\n        printf(\"header\");\n        i = 0;\n    } else {\n        i++;\n    }\n    do_stuff();\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "casting", "void-pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491395935, "post_id": 43231401, "comment_id": 73532741, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491395962, "post_id": 43231401, "comment_id": 73532761, "body": "Also, I have to say that there should be 4 functions, each of them allocating like this: 1 (key -- string, value -- TStudent), 1 (key -- int, value -- TStudent) and so on."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1491395964, "post_id": 43231401, "comment_id": 73532764, "body": "This is why I hate typedefing pointers.....sigh..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491396471, "post_id": 43231401, "comment_id": 73533138, "body": "Detail: &quot;last one is a generic list structure that will accept in the info any kind of structure.&quot; Disagree, <code>info</code> can save object pointers, not structures."}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491396473, "post_id": 43231401, "comment_id": 73533140, "body": "@SouravGhosh that still doesn&#39;t solve my problem. :( if I print the key in the function ( ((Pair*)cel-&gt;info)-&gt;key) it gives me the right value. But when I assign (((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie = value.materie) then the correct key value is gone."}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1491396529, "post_id": 43231401, "comment_id": 73533183, "body": "@chux, yes, you are right, I&#39;m sorry. Info will save pointers to structures."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491396621, "post_id": 43231401, "comment_id": 73533250, "body": "<code>key</code> seems a string. Use <code>strcpy()</code> to copy string to it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491396744, "post_id": 43231401, "comment_id": 73533342, "body": "<code>((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie = value.materie;</code> ----&gt;  <code>((TMaterie*)((Pair*)cel-&gt;info)-&gt;value)-&gt;materie = value.materie;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 566, "user_id": 4667104, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-rGRu3uu46Vg/AAAAAAAAAAI/AAAAAAAAAS4/sFeLdQuPwdU/photo.jpg?sz=128", "display_name": "Elvis Teixeira", "link": "https://stackoverflow.com/users/4667104/elvis-teixeira"}, "is_accepted": false, "score": 2, "last_activity_date": 1491396383, "creation_date": 1491396383, "answer_id": 43231635, "question_id": 43231401, "link": "https://stackoverflow.com/questions/43231401/trouble-with-void-casting-to-int-char-and-replacing-results/43231635#43231635", "title": "Trouble with Void * casting to int/char and replacing results", "body": "<p>The problem is you are overwriting the pointer value instead of writing to the buffer it points to. You are doing the following:</p>\n\n<pre><code>  ((Pair*)cel-&gt;info)-&gt;key = malloc(...);\n  ((Pair*)cel-&gt;info)-&gt;key = key;\n</code></pre>\n\n<p>In the second line you asign the pointer whatever is passed in the key argument, so you are not using the memory you have allocated above and it is being leaked.</p>\n\n<p>What you probably want is to copy the contents pointed by the key argument, you can use the <code>strcpy</code> function. Do something like:</p>\n\n<pre><code>  ((Pair*)cel-&gt;info)-&gt;key = malloc(...);\n  strcpy(((Pair*)cel-&gt;info)-&gt;key, key);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "edited": false, "score": 0, "creation_date": 1491397571, "post_id": 43231876, "comment_id": 73534031, "body": "@LPs Thank you so much! I have been wrapping my head around this for hours and now I finally understand. Great explanation. Thanks again!"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 2, "last_activity_date": 1491397805, "last_edit_date": 1491397805, "creation_date": 1491396930, "answer_id": 43231876, "question_id": 43231401, "link": "https://stackoverflow.com/questions/43231401/trouble-with-void-casting-to-int-char-and-replacing-results/43231876#43231876", "title": "Trouble with Void * casting to int/char and replacing results", "body": "<p>You have two main problems</p>\n\n<pre><code>((Pair*)cel-&gt;info)-&gt;value = (TMaterie*)malloc(sizeof(TMaterie));\n[...]\n((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie = value.materie;\n</code></pre>\n\n<p><code>TMaterie</code> member into <code>Cel-&gt;info</code> is <code>value</code>, so </p>\n\n<pre><code>((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie\n</code></pre>\n\n<p>must be</p>\n\n<pre><code>((TMaterie*)((Pair*)cel-&gt;info)-&gt;value)-&gt;materie\n</code></pre>\n\n<p>Moreover using</p>\n\n<pre><code>((Pair*)cel-&gt;info)-&gt;key = (char*)malloc(50*sizeof(char));\n[...]\n((Pair*)cel-&gt;info)-&gt;key = key;\n</code></pre>\n\n<p>You are overwriting memory <code>malloc</code>ated for key.\nIf, as I guess, key is a string, just use <code>strcpy</code></p>\n\n<pre><code>((Pair*)cel-&gt;info)-&gt;key = (char*)malloc(50*sizeof(char));\n[...]\nstrcpy(((Pair*)cel-&gt;info)-&gt;key, key);\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 43231876, "answer_count": 2, "score": 0, "last_activity_date": 1491397805, "creation_date": 1491395791, "last_edit_date": 1491395992, "question_id": 43231401, "link": "https://stackoverflow.com/questions/43231401/trouble-with-void-casting-to-int-char-and-replacing-results", "title": "Trouble with Void * casting to int/char and replacing results", "body": "<p>I have an assignment to do for my Data Structures class and I'm in a little bit of trouble. I have some structures, namely:</p>\n\n<pre><code>typedef struct {\n    char *materie;\n    int ore_curs;\n    int ore_lab;\n    int credit;\n    int teme;\n} TMaterie;\n\ntypedef struct {\n    char *nume;\n    float medie;\n    char grupa[6]; // 324CB + NULL\n    int varsta;\n} TStudent;\n\ntypedef struct {\n    void *key;\n    void *value;\n    int frequency;\n} Pair;\n\ntypedef struct celulag {\n  void *info;\n  struct celulag *urm;\n} TCelulaG, *TLG, **ALG;\n</code></pre>\n\n<p>The last one is a generic list structure that will accept in the info any kind of structure. The thing is that I need to convert it to the structure pair so that it will point out to a key (that will be either a char or an int) and a value (that will be of the type TMaterie or TStudent). I need to make functions that allocate that accordingly and I have managed to do this: </p>\n\n<pre><code>TLG aloca_string_materie(char *key, TMaterie value){\n    TLG cel = (TLG) malloc(sizeof(TCelulaG));\n    if(!cel)\n        return NULL;\n    cel-&gt;info = (Pair*)malloc(sizeof(Pair));\n    if( !cel-&gt;info){\n        free(cel);\n        return NULL;\n    }\n    cel-&gt;urm = NULL;\n    ((Pair*)cel-&gt;info)-&gt;value = (TMaterie*)malloc(sizeof(TMaterie));\n    ((Pair*)cel-&gt;info)-&gt;key = (char*)malloc(50*sizeof(char));\n    ((Pair*)cel-&gt;info)-&gt;frequency = 0;\n    ((Pair*)cel-&gt;info)-&gt;key = key;\n    ((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie = value.materie;\n    ((TMaterie*)(Pair*)cel-&gt;info)-&gt;ore_curs = value.ore_curs;\n    ((TMaterie*)(Pair*)cel-&gt;info)-&gt;ore_lab = value.ore_lab;\n    ((TMaterie*)(Pair*)cel-&gt;info)-&gt;credit = value.credit;\n    ((TMaterie*)(Pair*)cel-&gt;info)-&gt;teme = value.teme;\n    return cel;\n}\n</code></pre>\n\n<p>The problem that I am facing is that when I try to print out the key, namely </p>\n\n<pre><code>(((Pair*)cel-&gt;info)-&gt;key)\n</code></pre>\n\n<p>it gives me the same value as </p>\n\n<pre><code>((TMaterie*)(Pair*)cel-&gt;info)-&gt;materie \n</code></pre>\n\n<p>and I have no idea why. </p>\n\n<p>Can someone please tell me what I'm doing wrong?</p>\n"}, {"tags": ["c", "arrays", "struct", "instance"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491395801, "post_id": 43231381, "comment_id": 73532625, "body": "Welcome to Stack Overflow! <a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1491395824, "post_id": 43231381, "comment_id": 73532649, "body": "<code>sizeof(Test)</code> --&gt; <code>sizeof(struct Test)</code>"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1491395844, "post_id": 43231381, "comment_id": 73532665, "body": "Not sure what you are trying to achieve by assigning the pointer c_string to a random number, doesn&#39;t look to smart.  If you want to use sizeof(Test), prefix your structure with typedef and append the name to the structure."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491395878, "post_id": 43231381, "comment_id": 73532695, "body": "<code>NewInstance-&gt;c_string = rand();</code> is your compiler does not complain, you actually have a problem in your environment."}, {"owner": {"reputation": 13, "user_id": 7820550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cbdab141aaa3572004eec026456f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy589", "link": "https://stackoverflow.com/users/7820550/jimmy589"}, "edited": false, "score": 0, "creation_date": 1491396032, "post_id": 43231381, "comment_id": 73532806, "body": "Sorry I copied the wrong version there should not be a   New Instance -&gt;c_string = rand();"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1491396373, "post_id": 43231381, "comment_id": 73533060, "body": "Break the problem down into parts rather than viewing it as one large whole - like start of, by thinking how you&#39;d allocate the space for your array for example."}], "answers": [{"tags": [], "owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "is_accepted": false, "score": 0, "last_activity_date": 1491398550, "creation_date": 1491398550, "answer_id": 43232521, "question_id": 43231381, "link": "https://stackoverflow.com/questions/43231381/creating-an-array-that-creates-instance-of-a-struct/43232521#43232521", "title": "Creating an Array that creates instance of a struct", "body": "<p>I'm going to try to explain this without giving you the answer to your assignment verbatim ...</p>\n\n<p>First, you need to allocate <code>n</code> times as much memory. <code>malloc</code> can allocate any amount, so you just need to calculate the number.</p>\n\n<p>Second, you need to do the same initialization, but for each entry in the array. You'll need a loop for that.</p>\n\n<p>Hint: in C, a pointer to a single instance and a pointer to a dynamic array are indistinguishable. <code>ptr-&gt;value</code> is the same as <code>ptr[0].value</code>, and <code>ptr[1].value</code> is the next element in the array.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 1, "last_activity_date": 1491399061, "creation_date": 1491399061, "answer_id": 43232716, "question_id": 43231381, "link": "https://stackoverflow.com/questions/43231381/creating-an-array-that-creates-instance-of-a-struct/43232716#43232716", "title": "Creating an Array that creates instance of a struct", "body": "<p>It's fairly straightforward.  First, you'll need to allocate enough storage for <code>n</code> pointers to <code>struct Test</code>:</p>\n\n<pre><code>struct Test **array = malloc(n * sizeof *array);\nif (!array) return array;\n</code></pre>\n\n<p>And then assign each pointer, using the function you have:</p>\n\n<pre><code>for (size_t i = 0;  i &lt; n;  ++i)\n    array[i] = createNewTest();\n</code></pre>\n\n<p>Wrapping it all up, you get</p>\n\n<pre><code>struct Test **createNewArray(size_t n)\n{\n    struct Test **array = malloc(n * sizeof *array);\n    if (!array) return array;\n\n    for (size_t i = 0;  i &lt; n;  ++i)\n        array[i] = createNewTest();\n\n    return array;\n}\n</code></pre>\n\n<p>Don't forget to write a matching <code>free()</code> function!</p>\n\n<p>Also, consider whether you really want an array of pointers to <code>Test</code> - you may be better off with an array of <code>Test</code> objects instead.</p>\n"}], "owner": {"reputation": 13, "user_id": 7820550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cbdab141aaa3572004eec026456f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy589", "link": "https://stackoverflow.com/users/7820550/jimmy589"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503864184, "creation_date": 1491395743, "last_edit_date": 1491395980, "question_id": 43231381, "link": "https://stackoverflow.com/questions/43231381/creating-an-array-that-creates-instance-of-a-struct", "title": "Creating an Array that creates instance of a struct", "body": "<p>Hello everyone I got the following struct</p>\n\n<pre><code>struct Test\n{\n    unsigned char* c_string;\n    unsigned int value;\n};\n</code></pre>\n\n<p>I created a function that creates a new instance of this struct and initialize the attributes with random values like this</p>\n\n<pre><code>struct Test* createNewTest(){\nstruct Test *NewInstance = (Test * )malloc( sizeof(Test) );\nNewInstance-&gt;value = rand();\n</code></pre>\n\n<p>Now I have to create a function that creates n completely initialized instances of my struct.</p>\n\n<pre><code>struct Test** createNewArray(unsigned int n){\n};\n</code></pre>\n\n<p>Can anyone help me to do this? I dont really now how to start here</p>\n"}, {"tags": ["c", "gradient", "cairo", "tizen", "tizen-wearable-sdk"], "comments": [{"owner": {"reputation": 382, "user_id": 6497318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa77f317c9ab7eccb840dd907015175?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin shihab", "link": "https://stackoverflow.com/users/6497318/yasin-shihab"}, "edited": false, "score": 0, "creation_date": 1491541176, "post_id": 43230827, "comment_id": 73608412, "body": "What does red, yellow, blue mark for?"}, {"owner": {"reputation": 2029, "user_id": 3829267, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dc175416c254ce5cf220abe71426ce27?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Wisniewski", "link": "https://stackoverflow.com/users/3829267/jakub-wisniewski"}, "reply_to_user": {"reputation": 382, "user_id": 6497318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa77f317c9ab7eccb840dd907015175?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin shihab", "link": "https://stackoverflow.com/users/6497318/yasin-shihab"}, "edited": false, "score": 0, "creation_date": 1491551347, "post_id": 43230827, "comment_id": 73613185, "body": "green and red shouldhave been start and end points, yellow the gradient but I made them too big. Basicly I am looking for Conical gradient."}], "answers": [{"tags": [], "owner": {"reputation": 2029, "user_id": 3829267, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dc175416c254ce5cf220abe71426ce27?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Wisniewski", "link": "https://stackoverflow.com/users/3829267/jakub-wisniewski"}, "is_accepted": true, "score": 2, "last_activity_date": 1491558613, "creation_date": 1491558613, "answer_id": 43274996, "question_id": 43230827, "link": "https://stackoverflow.com/questions/43230827/dynamiclly-growing-gradient-on-a-circle/43274996#43274996", "title": "Dynamiclly growing gradient on a circle", "body": "<p>Ok, I found a way to create Conical gradient, and with little twists I managed to make it working as dynamic gradient. The solution is to create patches (triangle cuts of circle) and set theirs gradients.</p>\n\n<p>patch sector method:</p>\n\n<pre><code>static void sector_patch (cairo_pattern_t *pattern,\n      double angle_A,\n      double A_r, double A_g, double A_b,\n      double angle_B,\n      double B_r, double B_g, double B_b)\n{\n    double r_sin_A, r_cos_A;\n    double r_sin_B, r_cos_B;\n    double h;\n\n    r_sin_A = RADIUS * sin (angle_A);\n    r_cos_A = RADIUS * cos (angle_A);\n    r_sin_B = RADIUS * sin (angle_B);\n    r_cos_B = RADIUS * cos (angle_B);\n\n    h = 4.0/3.0 * tan ((angle_B - angle_A) / 4.0);\n\n    cairo_mesh_pattern_begin_patch (pattern);\n\n    cairo_mesh_pattern_move_to (pattern, CENTER_X, CENTER_Y);\n    cairo_mesh_pattern_line_to (pattern,\n            CENTER_X + r_cos_A,\n            CENTER_Y + r_sin_A);\n\n    cairo_mesh_pattern_curve_to (pattern,\n             CENTER_X + r_cos_A - h * r_sin_A,\n             CENTER_Y + r_sin_A + h * r_cos_A,\n             CENTER_X + r_cos_B + h * r_sin_B,\n             CENTER_Y + r_sin_B - h * r_cos_B,\n             CENTER_X + r_cos_B,\n             CENTER_Y + r_sin_B);\n\n    cairo_mesh_pattern_set_corner_color_rgb (pattern, 0, 1, 1, 1);\n    cairo_mesh_pattern_set_corner_color_rgb (pattern, 1, A_r, A_g, A_b);\n    cairo_mesh_pattern_set_corner_color_rgb (pattern, 2, B_r, B_g, B_b);\n\n    cairo_mesh_pattern_end_patch (pattern);\n}\n</code></pre>\n\n<p>and here is a method for crating gradient for full circle (if you want to draw the gradient add cairo_paint(cr); at the end of set gradient method)</p>\n\n<pre><code>static void set_conical_gradient(cairo_t *cr, int width, int height)\n{\n    cairo_pattern_t *pattern;\n\n    pattern = cairo_pattern_create_mesh ();\n    sector_patch (pattern,\n      0,         1, 1, 1,\n      M_PI/4,    0.9, 0.96, 0.87);\n    sector_patch (pattern,\n      M_PI/4,   0.9, 0.96, 0.87,\n      M_PI/2,    0.81, 0.91, 0.75);\n    sector_patch (pattern,\n      M_PI/2,    0.81, 0.91, 0.75,\n      3*M_PI/4,  0.7, 0.87, 0.63);\n    sector_patch (pattern,\n      3*M_PI/4,  0.7, 0.87, 0.63,\n      M_PI,      0.62, 0.83, 0.5);\n    sector_patch (pattern,\n      -M_PI,     0.62, 0.83, 0.5,\n      -3*M_PI/4, 0.53, 0.78, 0.38);\n    sector_patch (pattern,\n      -3*M_PI/4, 0.53, 0.78, 0.38,\n      -M_PI/2,   0.43, 0.74, 0.25);\n    sector_patch (pattern,\n      -M_PI/2,   0.43, 0.74, 0.25,\n      -M_PI/4,   0.38, 0.72, 0.18);\n    sector_patch (pattern,\n      -M_PI/4,   0.38, 0.72, 0.18,\n      0,        0.34, 0.7, 0.13);\n\n    cairo_set_source(cr, pattern);\n}\n</code></pre>\n"}], "owner": {"reputation": 2029, "user_id": 3829267, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dc175416c254ce5cf220abe71426ce27?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Wisniewski", "link": "https://stackoverflow.com/users/3829267/jakub-wisniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 2, "accepted_answer_id": 43274996, "answer_count": 1, "score": 2, "last_activity_date": 1491558613, "creation_date": 1491394293, "last_edit_date": 1491397481, "question_id": 43230827, "link": "https://stackoverflow.com/questions/43230827/dynamiclly-growing-gradient-on-a-circle", "title": "Dynamiclly growing gradient on a circle", "body": "<p>I started writing an application for <code>tizen wearable 2.3.1</code>. I wanted to add dynamically growing radiant on an arc (that grows until it becomes a circle). My circle is created using <code>cairo2d</code>.</p>\n\n<p>I have been following <a href=\"https://people-mozilla.org/~jmuizelaar/Riskus354.pdf\" rel=\"nofollow noreferrer\">this article</a> about the approximation of cubic bezier curve. I have made some progress. I have a dynamic gradient for the first half of circle - but the gradient doesn't start from my <code>X1,Y1</code>, but it seems to grow from the center.</p>\n\n<p>First step is to move the cairo center and rotate (so the center is in the middle of circle and <code>X,Y</code> are proper axis), then I count the angle based on the  percentage and initialize the variables:</p>\n\n<pre><code>double current_angle= (2 * M_PI * percent) / 100;\ndouble R = 74;\ndouble K = 0.5522847498; // - magic number from article\n\n// start and end point\ndouble X1 = 0;\ndouble Y1 = R;\ndouble X4 = R * sin(current_angle);\ndouble Y4 = R * cos(current_angle);\n// bezier points\ndouble X2 = X1 + K * R * sin(current_angle);\ndouble Y2 = Y1 - K * R * cos(current_angle);\ndouble X3 = X4 + K * R * sin(current_angle);\ndouble Y3 = Y4 + K * R * cos(current_angle);\n</code></pre>\n\n<p>Then at the end, I create my pattern and draw my arc:</p>\n\n<pre><code>Evas_Coord_Point P1 = {X1, Y1};\nEvas_Coord_Point P2 = {X2, Y2};\nEvas_Coord_Point P3 = {X3, Y3};\nEvas_Coord_Point P4 = {X4, Y4};\n\ncairo_pattern_t *dynamic_pattern = cairo_pattern_create_mesh ();\ncairo_mesh_pattern_begin_patch (dynamic_pattern);\ncairo_mesh_pattern_move_to (dynamic_pattern, P1.x, P1.y);\ncairo_mesh_pattern_curve_to (dynamic_pattern, P2.x, P2.y,  P3.x, P3.y, P4.x, P4.y);\ncairo_mesh_pattern_set_corner_color_rgb (dynamic_pattern, 1, 1, 1, 1);\ncairo_mesh_pattern_set_corner_color_rgb (dynamic_pattern, 0, 0, 1, 0);\ncairo_mesh_pattern_end_patch (dynamic_pattern);\ncairo_set_source(cairo, dynamic_pattern);\n\ncairo_arc(cairo, 0, 0, cairo_circle_radius, 0, current_angle);\ncairo_stroke(cairo);\n</code></pre>\n\n<p>and for the first few percentage values, I don't get anything, but then around 12% it starts to draw and expands in both directions. What am I doing wrong?</p>\n\n<blockquote>\n  <p>This graphics shows what I want to achieve (sorry for my not very professional image, but that's the best I can do).</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/pXWvx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pXWvx.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT: I did some testing and It starts working for angle >= 45.</p>\n"}, {"tags": ["c", "eclipse", "shell", "symbols", "stm32"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1491396146, "post_id": 43230656, "comment_id": 73532893, "body": "<a href=\"http://addisu.taddese.com/blog/inserting-svn-revision-number-in-your-cc-code/\" rel=\"nofollow noreferrer\">This page</a> has some hints for how to do this, through Eclipse&#39;s makefiles which seems a bit easier."}, {"owner": {"reputation": 59, "user_id": 1885541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JAqZr.png?s=128&g=1", "display_name": "i3luefire", "link": "https://stackoverflow.com/users/1885541/i3luefire"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1491400892, "post_id": 43230656, "comment_id": 73536890, "body": "Nice link, thx :) I try the eclipse way with the makefile.defs. It seams to work fine. I will add a answer to my question asap"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 1885541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JAqZr.png?s=128&g=1", "display_name": "i3luefire", "link": "https://stackoverflow.com/users/1885541/i3luefire"}, "is_accepted": true, "score": 1, "last_activity_date": 1491402064, "last_edit_date": 1495542334, "creation_date": 1491402064, "answer_id": 43233927, "question_id": 43230656, "link": "https://stackoverflow.com/questions/43230656/define-a-compiler-symbol-via-shellscript-in-eclipse-stm32-workbench/43233927#43233927", "title": "Define a compiler symbol via shellscript in eclipse (stm32 workbench)", "body": "<p><strong>Manual</strong></p>\n\n<p>Link to the used documentation: <a href=\"http://addisu.taddese.com/blog/inserting-svn-revision-number-in-your-cc-code/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/users/28169/unwind\">unwind</a> for showing me this link</p>\n\n<p><strong>Solution/Answer</strong></p>\n\n<ol>\n<li>create empty makefile.defs file in project root folder</li>\n</ol>\n\n<blockquote>\n  <p>Right-Click on projectroot folder -> New -> File</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>write needed command for svn revision in makefile.defs</li>\n</ol>\n\n<p><code>SVNREV:='\"$(shell ../svnversion.sh ../inc/ ../src/)\"'</code></p>\n\n<ol start=\"3\">\n<li>open c/c++ build settings, symbols</li>\n</ol>\n\n<blockquote>\n  <p>Project -> Properties -> C/C++ Build -> Settings -> Build Steps -> MCU GCC Compiler -> Symbols</p>\n</blockquote>\n\n<ol start=\"4\">\n<li>add symbol used in code</li>\n</ol>\n\n<blockquote>\n  <p>Add value SVNREPOVERSION=\"$(SVNREV)\" as Symbol</p>\n</blockquote>\n\n<ol start=\"5\">\n<li>Save the project settings and build</li>\n</ol>\n\n<p>The build is now working fine and I receive my svn revision number.\nThe makefile.defs is executed once. This will read the needed svnrevisions from the used folders. This value will be written into SVNREPOVERSION, which I use in my code.</p>\n"}], "owner": {"reputation": 59, "user_id": 1885541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JAqZr.png?s=128&g=1", "display_name": "i3luefire", "link": "https://stackoverflow.com/users/1885541/i3luefire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 43233927, "answer_count": 1, "score": 2, "last_activity_date": 1491402064, "creation_date": 1491393808, "last_edit_date": 1491395063, "question_id": 43230656, "link": "https://stackoverflow.com/questions/43230656/define-a-compiler-symbol-via-shellscript-in-eclipse-stm32-workbench", "title": "Define a compiler symbol via shellscript in eclipse (stm32 workbench)", "body": "<p>Since a longer time, I write software for an embedded system for a <code>stm32f4</code> processor.</p>\n\n<p>Until now, I worked with my own toolchain with my own makefiles to build the binary. To have the advantage of an IDE, I decided to integrate the project into Eclipse (stm32 workbench: eclipse for the stm32 controller). To stop having an own toolchain, I now use the integrated AC6 toolchain.</p>\n\n<p>Most of the things I have to do are working fine.</p>\n\n<p><strong>My Problem</strong></p>\n\n<p>In my own makefile, I have the following entries:</p>\n\n<pre><code>SVNREPREV := $(shell ./svnversion.sh ./inc/ ./Drivers/ ./libs/ ./linkerscripts/ ./makefsdata/ ./src/)\nXCFLAGS += -DSVNREPOVERSION=\\\"$(SVNREPREV)\\\"\n</code></pre>\n\n<p>(The shell script returns a value like that -> 1234:1234M and it will be converted to a string)</p>\n\n<p>I can use this value in my c code like this:</p>\n\n<pre><code>const char svnRepoRevision[] = SVNREPOVERSION;\n</code></pre>\n\n<p><strong>My Question</strong></p>\n\n<p>How can I realize a similar behavior in Eclipse/stm32 workbench with the AC6 toolchain and created makefiles?</p>\n\n<p><strong>My Tries</strong></p>\n\n<p>Add the symbols under Project -> Properties -> C/C++ Build -> Settings -> Build Steps -> Symbols</p>\n\n<pre><code>SVNREPREV=$(shell ../svnversion.sh ../inc/ ../Drivers/ ../libs/ ../linkerscripts/ ../makefsdata/ ../src/)\nSVNREPOVERSION=\"SVNREPREV\"\n</code></pre>\n\n<p>the build ends with the following error:</p>\n\n<pre><code>arm-none-eabi-gcc: error: ../src/): No such file or directory\n</code></pre>\n\n<p>I tried different versions of set the \"\", but it had no effect, alway received an error.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "linux", "kernel", "gpio"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1491392625, "post_id": 43230024, "comment_id": 73530189, "body": "It&#39;s setting the direction of a pin to input. It also clears the flag in desc to track the state. The rest is error checking and logging.  Export means the call is exported if you comply with GPL."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1491393204, "post_id": 43230024, "comment_id": 73530611, "body": "The sysfs file-handling code is in <a href=\"http://lxr.free-electrons.com/source/drivers/gpio/gpiolib-sysfs.c\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/drivers/gpio/gpiolib-sysfs.c</a> ."}, {"owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "edited": false, "score": 0, "creation_date": 1491394185, "post_id": 43230024, "comment_id": 73531382, "body": "Thx that makes things a little clearer, but im still stuck on the general flow : going from writing a value to a file to executing a func with the struct"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1491395703, "post_id": 43230024, "comment_id": 73532536, "body": "Writing to &quot;/sys/class/gpio/export&quot; causes <code>export_store()</code> to be called (it&#39;s a &quot;class attribute&quot; handling function registered by <code>class_register()</code> during initialization). That calls <code>gpiod_export()</code> which calls <code>device_create_with_groups()</code> to create the device in the sysfs tree with a set of &quot;device attribute&quot; files specified by <code>gpio_groups[]</code>. <code>dev_attr_value</code> is defined and initialized by <code>static DEVICE_ATTR_RW(value);</code>. <code>value_store()</code> is pointed to by <code>dev_attr_value.store</code> and is called when the &quot;store&quot; attribute file is written."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491396362, "post_id": 43230024, "comment_id": 73533054, "body": "It depends how far behind the scenes you want to go. You can follow the rabbit hole down the call to <code>device_create_with_groups()</code> to find out how the sysfs files are created and their file operations set up."}, {"owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "edited": false, "score": 0, "creation_date": 1491396435, "post_id": 43230024, "comment_id": 73533112, "body": "wow thx! I have zero exp with linux kernel. I found (<a href=\"https://static.lwn.net/images/pdf/LDD3/ch14.pdf\" rel=\"nofollow noreferrer\">static.lwn.net/images/pdf/LDD3/ch14.pdf</a>) because you mentioned class and i get it a little more. I think with more reading i will get it. You can post as answer if you want.  Any refs to docs/books you used to learn this stuff?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491396789, "post_id": 43230024, "comment_id": 73533379, "body": "It&#39;s the mysterious appearance of things like the <code>dev_attr_...</code> variables that catch people out, since their declarations are hidden by macros. It would probably be less confusing if there were also macros to point to and access these variables."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491397192, "post_id": 43230024, "comment_id": 73533721, "body": "There were plans for an LDD 4th edition. You can even see this mythical book as &quot;currently unavailable&quot; on Amazon!"}], "owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491392050, "creation_date": 1491392050, "question_id": 43230024, "link": "https://stackoverflow.com/questions/43230024/linux-kernel-gpio-code-behind-the-scenes", "title": "Linux kernel gpio code behind the scenes?", "body": "<p>I'm trying to understand what happens behind the scenes when you write to gpio \"files\".</p>\n\n<p>From what I found (<a href=\"https://stackoverflow.com/questions/19548449/linux-gpios-handling\">Linux GPIOs handling</a>), it is not really writing to a file but sysfs maps open/read/write to other functions.</p>\n\n<p>But the newer version (<a href=\"http://lxr.free-electrons.com/source/drivers/gpio/gpiolib.c\" rel=\"nofollow noreferrer\">http://lxr.free-electrons.com/source/drivers/gpio/gpiolib.c</a> ) doesn't  contain DEVICE_ATTR.\nInstead:</p>\n\n<pre><code>2242 int gpiod_direction_input(struct gpio_desc *desc)\n2243 {\n2244         struct gpio_chip        *chip;\n2245         int                     status = -EINVAL;\n2246 \n2247         VALIDATE_DESC(desc);\n2248         chip = desc-&gt;gdev-&gt;chip;\n2249 \n2250         if (!chip-&gt;get || !chip-&gt;direction_input) {\n2251                 gpiod_warn(desc,\n2252                         \"%s: missing get() or direction_input() operations\\n\",\n2253                         __func__);\n2254                 return -EIO;\n2255         }\n2256 \n2257         status = chip-&gt;direction_input(chip, gpio_chip_hwgpio(desc));\n2258         if (status == 0)\n2259                 clear_bit(FLAG_IS_OUT, &amp;desc-&gt;flags);\n2260 \n2261         trace_gpio_direction(desc_to_gpio(desc), 1, status);\n2262 \n2263         return status;\n2264 }\n2265 EXPORT_SYMBOL_GPL(gpiod_direction_input);\n</code></pre>\n\n<p>I've been going through the code for 3 hours and i still can't unsterstand what is happening</p>\n\n<ul>\n<li>Would it be possible to get a detailed flow of this mechanism?</li>\n<li>Starting from writing to export and read/write a value from a gpio what code is executed?</li>\n<li>How does the code go from a value to \"file\" to a function with a struct gpio_desc *desc param?</li>\n<li>Where does the mapping of functions happen? (I can't find the export macro)</li>\n</ul>\n"}, {"tags": ["c++", "c", "rtos", "freertos"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491392534, "post_id": 43229791, "comment_id": 73530114, "body": "Beats me.  The thread/s have stacks.  That&#39;s where the automatic storage vars go.  That&#39;s it for me.  I don&#39;t know what &#39;main stack space&#39; is either:)"}, {"owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "edited": false, "score": 0, "creation_date": 1491392755, "post_id": 43229791, "comment_id": 73530276, "body": "If by <i>main stack space</i> the stack space of the <code>Main</code> function is meant, then it is not stored in the main stack space."}], "answers": [{"tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1491395074, "creation_date": 1491395074, "answer_id": 43231129, "question_id": 43229791, "link": "https://stackoverflow.com/questions/43229791/main-stack-space-and-task-stack-space/43231129#43231129", "title": "Main stack space and task stack space", "body": "<p>The answer to the question is b.   Every thread that executed this function would have the variable i declared on the stack allocated for that thread.  Every thread would have a different stack.</p>\n\n<p>I think the test had some deliberate vague answers to catch out those people who don't know the answer and guessed.  </p>\n"}, {"comments": [{"owner": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1491405398, "post_id": 43232430, "comment_id": 73540649, "body": "It might be worth noting that on a Cortex-M interrupts also run in the main stack space (CSTACK)."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "reply_to_user": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1491413848, "post_id": 43232430, "comment_id": 73546160, "body": "Well, the Cortex-M Main Stack Pointer (MSP) is a different issue from what I&#39;ve described.  The Cortex-M supports two stack pointers, MSP and PSP.  If the RTOS makes use of the PSP for tasks then yes the processor switches to the MSP while handling interrupts.  But I don&#39;t think that is what this question is about."}], "tags": [], "owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "is_accepted": true, "score": 1, "last_activity_date": 1491398331, "creation_date": 1491398331, "answer_id": 43232430, "question_id": 43229791, "link": "https://stackoverflow.com/questions/43229791/main-stack-space-and-task-stack-space/43232430#43232430", "title": "Main stack space and task stack space", "body": "<p>Upon startup, there is startup code that runs before <code>main</code> gets called.  The startup code puts in place the run-time environment that is required by <code>main</code>.  This includes initializing initialized variables, zeroing out uninitialized variables, setting the stack pointer, and, for C++, calling the constructors for statically allocated objects.  So when <code>main</code> gets called there is already a stack setup and in use.  I presume this is what the quiz refers to as the \"main stack\".</p>\n\n<p>For Free-RTOS and other typical RTOS, the RTOS is not setup and running when <code>main</code> is called.  Rather, that is typically done within <code>main</code> by calling <code>xTaskCreate</code> and then <code>vTaskStartScheduler</code>.  Each time <code>main</code> calls <code>xTaskCreate</code> it creates a task and assigns a stack space for that task.  But while <code>main</code> is running it is still using the original stack created by the startup code.  Once <code>vTaskStartScheduler</code> is called, the RTOS scheduler will perform a context switch to one of the tasks.  The context switch includes changing the stack pointer to the task's stack.  So when the task starts executing it uses it's own stack.</p>\n\n<p>So yes, there is a main stack space that is separate from the tasks' stack spaces.  It is necessary so that <code>main</code> can do everything that it does before starting the RTOS scheduler.</p>\n"}], "owner": {"reputation": 47, "user_id": 6447961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/065e9fc6df5915367f8186ddb5464ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Furqan Qadri", "link": "https://stackoverflow.com/users/6447961/furqan-qadri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 43232430, "answer_count": 2, "score": 0, "last_activity_date": 1491398331, "creation_date": 1491391443, "last_edit_date": 1491391462, "question_id": 43229791, "link": "https://stackoverflow.com/questions/43229791/main-stack-space-and-task-stack-space", "title": "Main stack space and task stack space", "body": "<p>I want to know if there any difference between main stack space and a task's stack space. I have taken up a quiz on RTOS in which the following question was asked</p>\n\n<p><em>Suppose there is a non static local variable declared in the task function, where exactly the memory for the non static variable is allocated during the execution of task function  ?</em></p>\n\n<pre><code>void task_function(void *p)\n\n{\n\n /*this is task function */\n\nint i ; /* non static variable */\n}\n</code></pre>\n\n<p>The options given were: a. Main stack space of RAM.  b.Task's stack space.</p>\n\n<p>I want to know if there is a separate <strong>main stack space of RAM</strong> other than the stack space allocated for each task. And if it is then why?</p>\n"}, {"tags": ["c", "linux", "pipe"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1491390872, "post_id": 43229519, "comment_id": 73528887, "body": "that looks more like something you&#39;d see in a scripting language like Perl."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 2, "creation_date": 1491390919, "post_id": 43229519, "comment_id": 73528917, "body": "Did you mean <code>popen</code>?"}, {"owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "edited": false, "score": 2, "creation_date": 1491392451, "post_id": 43229519, "comment_id": 73530056, "body": "Your dream is here: <a href=\"https://perldoc.perl.org/functions/open.html\" rel=\"nofollow noreferrer\">perldoc.perl.org/functions/open.html</a> :-)"}, {"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 0, "creation_date": 1491402018, "post_id": 43229519, "comment_id": 73537831, "body": "<a href=\"https://www.gnu.org/software/libc/manual/html_node/Pipe-to-a-Subprocess.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/libc/manual/html_node/Pipe-to-a&zwnj;&#8203;-Subprocess.html</a>"}], "owner": {"reputation": 918, "user_id": 1221661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f768f92c968b59b599234d7b971d9b62?s=128&d=identicon&r=PG", "display_name": "Fritz", "link": "https://stackoverflow.com/users/1221661/fritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491390754, "creation_date": 1491390754, "question_id": 43229519, "link": "https://stackoverflow.com/questions/43229519/open-stdout-of-new-process-as-file-descriptor", "title": "Open stdout of new process as file descriptor", "body": "<p>Somewhere I've seen a method which lets you open the output of a program like a file. I vaguely remember that it involved opening a pseudo-filename which contains a pipe <code>|</code> symbol, but I was unable to find it on the internet. I think it looked something like this:</p>\n\n<pre><code>int fd = open(\"| some_program\", O_RDONLY);\nread(fd, buffer, 100);  // read 100 bytes of some_program output\n</code></pre>\n\n<p>This would:</p>\n\n<ol>\n<li>Start <code>some_program</code> as a new process</li>\n<li>Create a new pipe attached to the <code>stdout</code> of <code>some_program</code></li>\n<li>Return the other end of the pipe as a file descriptor</li>\n</ol>\n\n<p>Does this method exist somewhere (maybe only in a specific language, not C) or did I just dream it up?</p>\n"}, {"tags": ["c", "assembly", "inline"], "comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491389941, "post_id": 43229087, "comment_id": 73528189, "body": "a is not the same tye as the elements of str. What do you want to happen? That <code>(char)1</code> gets put in the string or <code>&#39;1&#39;</code> gets put in the string?"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491389966, "post_id": 43229087, "comment_id": 73528216, "body": "Also, what is your actual question? You haven&#39;t asked a question."}, {"owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491390569, "post_id": 43229087, "comment_id": 73528656, "body": "I already edited question."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491390672, "post_id": 43229087, "comment_id": 73528735, "body": "If someone gave that template to you I&#39;d be curious why they left out something important like the <code>memory</code> clobber (which is necessary in this case)"}, {"owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "edited": false, "score": 0, "creation_date": 1491390934, "post_id": 43229087, "comment_id": 73528926, "body": "No, i made that code. I am new to assembly. So I must add &quot;memory&quot; into clober list?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491391083, "post_id": 43229087, "comment_id": 73529043, "body": "You wouldn&#39;t have to use <code>memory</code> if you changed the input and output constraint for <code>str</code> to <code>m</code> and <code>=m</code> instead of <code>r</code> and <code>=r</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491391196, "post_id": 43229087, "comment_id": 73529109, "body": "@MichaelPetch I am not sure why would we have to output str? str is not changing. Do you mean *str?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491391268, "post_id": 43229087, "comment_id": 73529165, "body": "@AjayBrahmakshatriya The array <code>str</code> is having its elements changed (not the pointer) which is the problem with this template&#39;s input and output constraints."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491391441, "post_id": 43229087, "comment_id": 73529290, "body": "@MichaelPetch, Exactly. So as far as I understand, *str should be in clobber right? Pardon me if I am missing something."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491391510, "post_id": 43229087, "comment_id": 73529334, "body": "Shouldn&#39;t the template be <code>: : &quot;r&quot; (a), &quot;r&quot; (str), &quot;r&quot; (b) : &quot;m&quot; (*str)</code> ?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491391744, "post_id": 43229087, "comment_id": 73529520, "body": "@AjayBrahmakshatriya : since you are altering the contents of the array <code>str</code> you need to specify <code>=m</code> as an output constraint in this case. If you don&#39;t the optimizer can assume that the contents of the string array never changed."}, {"owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "edited": false, "score": 0, "creation_date": 1491394240, "post_id": 43229087, "comment_id": 73531420, "body": "Yeah, it&#39;s a school project."}, {"owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "edited": false, "score": 0, "creation_date": 1491395706, "post_id": 43229087, "comment_id": 73532540, "body": "Thanks for help! I think I am fine now."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491398109, "post_id": 43229087, "comment_id": 73534480, "body": "Alternatively this would work <code>__asm__ (&quot;movb %b2, %0\\n\\tmovb %b3, %1&quot; : &quot;=&amp;m&quot;(str[0]), &quot;=m&quot;(str[1]) : &quot;ri&quot;(a), &quot;ri&quot;(b));</code> or probably slightly better: <code>__asm__ (&quot;movw %w1, %0&quot; : &quot;=m&quot;(*str) : &quot;r&quot;((b &amp; 0xff)&lt;&lt;8 | (a &amp; 0xff)));</code>"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491400498, "post_id": 43229087, "comment_id": 73536549, "body": "Of course another way is to use individual <code>asm</code> statement to load each `    <code>__asm__ (&quot;movb %b1, %0&quot; : &quot;=m&quot;(str[0]) : &quot;ri&quot;(a));     __asm__ (&quot;movb %b1, %0&quot; : &quot;=m&quot;(str[1]) : &quot;ri&quot;(b));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1491393152, "post_id": 43229465, "comment_id": 73530582, "body": "he wants &quot;ust like i would do str[0] = a and str[1] = b in C&quot;, not &quot;str[b]=a;&quot;"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1491393379, "post_id": 43229465, "comment_id": 73530725, "body": "@Tommylee2k, I completely misread the question. Will fix this."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491393950, "post_id": 43229465, "comment_id": 73531182, "body": "If you are going to go do it this way you will require the <code>memory</code> clobber because you have created a side effect in memory the template doesn&#39;t know about. From the compilers perspective it can assume that the contents of <code>str</code> never changed and assume what was in it before is still in it after. This can lead to subtle bugs if this code is optimized and part of a larger program."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491394170, "post_id": 43229465, "comment_id": 73531368, "body": "No it isn&#39;t. This trivial question is a good reason people should not use inline assembly. The thing is that stuff like this will appear to work in a simple case with no optimizations in a small program. But with optimizations and part of a larger program this could cause some interesting and hard to track bugs."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1491394234, "post_id": 43229465, "comment_id": 73531417, "body": "@MichaelPetch Can you suggest the correct way? Else I will just remove the answer."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1491394096, "last_edit_date": 1491394096, "creation_date": 1491390588, "answer_id": 43229465, "question_id": 43229087, "link": "https://stackoverflow.com/questions/43229087/change-array-element-in-inline-assembly/43229465#43229465", "title": "Change array element in inline assembly", "body": "<p>I understand you want to do <code>str[0] = a; std[1] = b;</code></p>\n\n<p>You can do </p>\n\n<pre><code>__asm__ (\"movb %0, (%1)\\n\\tmovb %2, 1(%1)\" : : \"r\" ((char)a), \"r\" (str), \"r\" ((char)b) : \"m\"(*str));\n</code></pre>\n\n<p>This is of course the AT&amp;T style assembly.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "is_accepted": false, "score": -1, "last_activity_date": 1491394025, "creation_date": 1491394025, "answer_id": 43230740, "question_id": 43229087, "link": "https://stackoverflow.com/questions/43229087/change-array-element-in-inline-assembly/43230740#43230740", "title": "Change array element in inline assembly", "body": "<p>So I tried</p>\n\n<pre><code>        char str[] = \"9999\\n\"; \n        char a = '1';\n        asm volatile (\n           \"movb %0,%1;\"\n           :\n           : \"r\" (a), \"m\" (str[0])\n           : );\n</code></pre>\n\n<p>It works nice but I need work in this program with <strong>a</strong> as integer as well. So can I convert types in assembly (from int to char)?</p>\n"}], "owner": {"reputation": 13, "user_id": 6337793, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206708406772197/picture?type=large", "display_name": "Dominik Filyo", "link": "https://stackoverflow.com/users/6337793/dominik-filyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491394096, "creation_date": 1491389561, "last_edit_date": 1491390280, "question_id": 43229087, "link": "https://stackoverflow.com/questions/43229087/change-array-element-in-inline-assembly", "title": "Change array element in inline assembly", "body": "<p>I need to change two array elements in this code. Just like i would do <code>str[0] = a</code> and <code>str[1] = b</code> in C. It is inline assembler in C code, linux. </p>\n\n<pre><code>char str[] = \"9999\\n\"; \nint a = 1;\ninb b = 1;\nasm volatile (\n    //replace 1st element of str with a here\n    //replace 2st element of str with b here\n    : \"=r\" (str)\n    : \"r\" (a), \"r\" (b), \"r\" (str)\n    : );\n</code></pre>\n"}, {"tags": ["c", "arrays", "multithreading", "scope"], "comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491391135, "post_id": 43228933, "comment_id": 73529079, "body": "When you say &quot;n - 1&quot; size, do you mean size n index from 0 to n - 1?"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 1, "creation_date": 1491391787, "post_id": 43228933, "comment_id": 73529563, "body": "Unfortunately, you haven&#39;t specified which compiler, or platform, so it&#39;s hard to give an example that solves your problem.  I&#39;ve given my point to @andrew-henle as pthread is pretty common but not universal."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1491392014, "post_id": 43228933, "comment_id": 73529716, "body": "@Neil Thanks for pointing out this question isn&#39;t limited to POSIX.  I had my POSIX blinders on, apparently.... :-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491392487, "post_id": 43228933, "comment_id": 73530089, "body": "Every thread library I&#39;ve worked with works in pretty much the same manner. They allow a pointer parameter upon thread creation, which will get passed to the thread callback."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491402374, "post_id": 43228933, "comment_id": 73538152, "body": "@Lundin I guess someone should write an answer for the ISO C11 thread specification... although testing said answer might prove difficult"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491390788, "post_id": 43228994, "comment_id": 73528827, "body": "I&#39;m not sure why passing an integer value as a <code>void *</code> should be discouraged.  <code>intptr_t</code> is portable.  <code>pthread_create( &amp;tid[ i ], NULL, start_func, ( void * )( intptr_t ) i );</code> for passing a loop counter to <code>start_func( void *arg )</code> is perfectly fine.  <code>int myId = ( intptr_t ) arg;</code> will retrieve the <code>int</code> value."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491390963, "post_id": 43228994, "comment_id": 73528954, "body": "@AndrewHenle Normally I would really discourage such usage, but for threads I usually make this an exception to the rule. Other people might be more hard-line about it though."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1491391399, "post_id": 43228994, "comment_id": 73529253, "body": "@AndrewHenle Technically <code>intptr_t</code> is optional. An implementation does not have to define it. It&#39;s also not guaranteed that casting an arbitrary <code>intptr_t</code> gives a valid or well defined pointer, only that casting a pointer (to void) to <code>intprtr_t</code> and back again will compare equal to the original pointer. Of course, in real life, with most modern architectures, we all know, it will work."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491391733, "post_id": 43228994, "comment_id": 73529512, "body": "@JeremyP Doesn&#39;t that imply that for the casting to not work, that would mean converting an <code>int</code> to <code>intptr_t</code> would be irreversible.  Given the definition of <code>intptr_t</code>, I don&#39;t see how that could be possible, but I think I agree that&#39;s it&#39;s not <i>precluded</i> by the standard.  Seems like a good language-lawyer question."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491398789, "post_id": 43228994, "comment_id": 73535069, "body": "@AndrewHenle No my point was that not every possible value of an <code>intptr_t</code> needs to be a valid pointer, only values that were derived by casting a pointer to intptr_t."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1491389914, "last_edit_date": 1491389914, "creation_date": 1491389313, "answer_id": 43228994, "question_id": 43228933, "link": "https://stackoverflow.com/questions/43228933/multithreading-with-variables-unique-to-each-thread/43228994#43228994", "title": "Multithreading with variables unique to each thread", "body": "<p>While it is somewhat discouraged, you <em>can</em> pass the <em>value</em> of <code>k</code> to the thread function with some casting back and forth.</p>\n\n<p>Or you can allocate an <code>unsigned int</code> dynamically (one per thread) to store the value of <code>k</code> and pass that pointer to the thread function (which copies it and then free the allocated memory). This is safe and portable.</p>\n"}, {"comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491390076, "post_id": 43229115, "comment_id": 73528302, "body": "Note:  by &#39;Allocate&#39;, I assume you mean &#39;mallocate&#39;:)    Also note that the created thread should free the passed pointer before exiting.  Other bodges, like using an array of parameter structs, are just messy, inflexible and may introduce lifetime problems."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1491390170, "post_id": 43229115, "comment_id": 73528386, "body": "@ThingyWotsit &quot;mallocate&quot; isn&#39;t a word. There&#39;s also no reason why you can&#39;t allocate the variable on the stack as long as the main thread doesn&#39;t exit the scope in which it is allocated before the threads have completed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491392074, "post_id": 43229115, "comment_id": 73529751, "body": "@ThingyWotsit No, I don&#39;t mean that. As long as the variable does not turn invalid during the execution of the thread, it doesn&#39;t matter how it is allocated. The main thread which creates all the other threads should be the one freeing them, so there is no reason why such a variable would go out of scope even if it is local to the caller. The key here is to actually know what you are doing. Allocating dynamically in the caller and freeing in the thread is just bad program design - that doesn&#39;t make any sense."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491393150, "post_id": 43229115, "comment_id": 73530578, "body": "&#39;Allocating dynamically in the caller and freeing in the thread is just bad program design&#39; - we may have to agree to differ in this case.  The other approaches apply unnecessary constraints, (maybe the number of threads to be created is unknown at design time or varies at runtime..), introduce the lifetime risks you describe and adds unnecessary and avoidable scope to data that belongs to the created thread and only to that thread.  &#39;The main thread which creates all the other threads should be the one freeing them&#39; is another avoidable constraint: assumes the &#39;main thread&#39; is the creator.."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491393597, "post_id": 43229115, "comment_id": 73530892, "body": "@ThingyWotsit Dynamic allocation also has scalability issues."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491394257, "post_id": 43229115, "comment_id": 73531437, "body": "@AndrewHenle well, you might consider that is some cases. Usually, the stack allocation required by a new thread dwarfs the size of any struct that might be allocated to transfer config/startup info to the new thread, rendering that allocation size irrelevant."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491394905, "post_id": 43229115, "comment_id": 73531938, "body": "@ThingyWotsit And in general, the allocation of that small <code>struct</code> results in the same locking overhead as allocating the thread&#39;s stack does.  The allocation and the necessary freeing itself creates the overhead, and it&#39;s completely avoidable in the case of passing a simple <code>int</code> value to a thread.  Scalability is <i>hard</i> and every use of dynamic memory allocation limits it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491394944, "post_id": 43229115, "comment_id": 73531968, "body": "@&quot;maybe the number of threads to be created is unknown at design time or varies at runtime&quot; So you&#39;d then use an array of thread arguments, which in itself is either allocated as a VLA or dynamically. And freed by the code that allocated it, not by some thread callback. It all boils down to this: In a sane program design, your thread handles and thread arguments exist in the same program module, with the same scope. If you worry about scope of the arguments, you must also worry about the scope of the thread handle. So this is not even an issue."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491395046, "post_id": 43229115, "comment_id": 73532025, "body": "Example:  consider thread that waits on a queue for tasks.  If you want to terminate it, would you prefer to a) queue up a malloced termination-request task and then carry on, forgetting about the thread completely, knowing it will finish off all earlier tasks and free them as required, then free both the last termination message and the queue, or b) queue up a stack based termination struct, join with the thread and hope that it terminates soon so you can do more stuff?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491395190, "post_id": 43229115, "comment_id": 73532135, "body": "&#39;not by some thread callback&#39; - why would a callback be required?  free() does not need any callback.  Nor does a C++ or other OOP destructor, in general."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491395269, "post_id": 43229115, "comment_id": 73532197, "body": "&#39;worry about the scope of the thread handle&#39; - why would I worry about that?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491395355, "post_id": 43229115, "comment_id": 73532270, "body": "@AndrewHenle &#39;ame locking overhead&#39; - if you&#39;re even remotely worried about the lock overhead of a malloc, you should not be starting a new thread:)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491395747, "post_id": 43229115, "comment_id": 73532580, "body": "@ThingyWotsit The example you mention is, again, caused by poor program design. Why was the termination tasks/variables not passed to the thread upon creation? Why was it given different scope/storage duration than the thread handle? &quot;&#39;worry about the scope of the thread handle&#39; - why would I worry about that?&quot; Because when you call pthread_join, you kind of want this handle to be valid. If it has gone out of scope, your program will halt and catch fire. If it has not, then why do you worry that the thread arguments have done so?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491396073, "post_id": 43229115, "comment_id": 73532838, "body": "&#39;Because when you call pthread_join&#39; - oh, I don&#39;t ever do that unless absolutely unavoidable:)  Pool and/or app-lifetime threads usually don&#39;t need expicit termination.  Continual create/terminate/destroy threads, maintaining data that really belongs to other threads, and other such micro-management, are one of the main reasons that multithreading causes so many problems and is seen as &#39;difficult&#39;, &#39;error-prone&#39; and a &#39;black art&#39; :("}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491396426, "post_id": 43229115, "comment_id": 73533099, "body": "@Lundin <i>So you&#39;d then use an array of thread arguments, which in itself is either allocated as a VLA or dynamically. And freed by the code that allocated it, not by some thread callback.</i> That requires that the threads started communicate somehow to the parent thread that it&#39;s safe to either free the array or allow it to go out of scope.  The thread handle itself doesn&#39;t matter to the created thread, so it can go out of scope/be freed the moment <code>pthread_create()</code> returns.  The only concern would be leaking the thread ID - admittedly a concern, but that would have no impact on the new thread."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1491389651, "creation_date": 1491389651, "answer_id": 43229115, "question_id": 43228933, "link": "https://stackoverflow.com/questions/43228933/multithreading-with-variables-unique-to-each-thread/43229115#43229115", "title": "Multithreading with variables unique to each thread", "body": "<p>The correct way to do this is: </p>\n\n<ul>\n<li>Allocate the variable in the caller that creates the thread. </li>\n<li>Pass a pointer to the variable as parameter to the thread upon creation.</li>\n<li>Inside the thread callback, cast the pointer back to the correct pointer type.</li>\n<li>De-reference the pointer and read the contents.</li>\n</ul>\n\n<p>This approach is re-entrant, given that each thread gets its own variable.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491392293, "post_id": 43229721, "comment_id": 73529928, "body": "What&#39;s the point of this though, even if portable? &quot;It is possible to do obscure things so we must do it&quot; is not a sound rationale. Just pass a pointer, as is the intention of the thread API. Scope issues is not a valid rationale either, since any local variable declared in main() would have the same scope as your <code>pthread_t</code> handles. If those go out of scope, then bad things will happen."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491393381, "post_id": 43229721, "comment_id": 73530727, "body": "In this case, I have to agree with @Lundin, (strange, I know,  but he&#39;s right:)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491394002, "post_id": 43229721, "comment_id": 73531239, "body": "@Lundin The point is it&#39;s simple, concise, understandable, portable, standard-compliant, and works without any constraints or complications.  No scope problems, no possible scalability issues with dynamic memory allocation.  One could always write the caller and the start function in assembler, where bits are just bits to be used as desired instead of pointers or integers.  There are always platform-specific concerns in C code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491395343, "post_id": 43229721, "comment_id": 73532264, "body": "@AndrewHenle The POSIX standard kind of states that the parameter of pthread_create should be a pointer to an allocated object. To abusing this pointer and passing a value through it and then call it standard compliant is a stretch. To write code that passes a pointer to a variable would be simpler and more understandable. In fact, the very reason why we are having this debate is why I don&#39;t understand the logic behind &quot;we can do obscure things so we must do it&quot;. There is no performance benefit or anything with your method."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491395406, "post_id": 43229721, "comment_id": 73532315, "body": "I can see an obvious maintenance issue though: suppose someone maintaining the code must change the type of the variable. Then they have to rewrite the code."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491395644, "post_id": 43229721, "comment_id": 73532483, "body": "^^^^^ adding extra fields to a struct/object is easy - just add it and rebuild, it&#39;s almost sure to work just as well as before.  Messing with the casting is much less flexible:("}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491396051, "post_id": 43229721, "comment_id": 73532822, "body": "In fact, there&#39;s this hack-ish but safe trick where you can append trailing objects to a struct. Sometimes used in API hacking such as when you have a defined callback with a given parameter format and want to add more parameters. Suppose the API expects <code>struct stuff</code>. You then create a <code>struct stuff_ex { struct stuff; extra_things; }</code>, give the API the first member of your struct, then have the callback grab the things you sneaked in at the end."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491396562, "post_id": 43229721, "comment_id": 73533206, "body": "@Lundin <i>give the API the first member of your struct, then have the callback grab the things you sneaked in at the end.</i> :-o And you&#39;re criticizing my suggested use of casting an <code>int</code> to a <code>void *</code> through <code>intptr_t</code>?   ;-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491397243, "post_id": 43229721, "comment_id": 73533768, "body": "Rather, I have worked <i>with</i> Microsoft API:s :) But the form of hack I describe is also a common way to implement polymorphism in C, so it isn&#39;t unheard of. And it is safe in terms of strict aliasing."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1491402213, "post_id": 43229721, "comment_id": 73538014, "body": "<code>( void * )( intptr_t ) k</code> may be an alignment violation in ISO C (IDK whether POSIX defines this)"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1491391697, "last_edit_date": 1491391697, "creation_date": 1491391281, "answer_id": 43229721, "question_id": 43228933, "link": "https://stackoverflow.com/questions/43228933/multithreading-with-variables-unique-to-each-thread/43229721#43229721", "title": "Multithreading with variables unique to each thread", "body": "<p>This works (on POSIX platforms...) and is an implementation of the method @Some Programmer Dude mentioned in his answer.  It should be portable and standard-compliant, as long as the implementation provides <code>intptr_t</code> as a type (it's optional):</p>\n\n<pre><code>void *start_func( void *arg )\n{\n    int myID = ( intptr_t ) arg;\n       .\n       .\n       .\n    return( NULL );\n}\n\nint main( int argc, char **argv )\n{\n       .\n       .\n       .\n    pthread_t tid[ n ];\n    for ( int k = 0; k &lt; n; i++ )\n    {\n        pthread_create( &amp;tid[ k ], NULL, start_func, ( void * )( intptr_t ) k );\n    }\n       .\n       .\n       .\n    return( 0 );\n}\n</code></pre>\n\n<p>You'd need to be careful on any architecture where <code>sizeof( int )</code> is greater than <code>sizeof( intptr_t )</code> <em>and</em> your loop values would overflow an <code>intptr_t</code>, but as far as I know such architectures simply do not exist.</p>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 1, "last_activity_date": 1491401735, "creation_date": 1491401735, "answer_id": 43233810, "question_id": 43228933, "link": "https://stackoverflow.com/questions/43228933/multithreading-with-variables-unique-to-each-thread/43233810#43233810", "title": "Multithreading with variables unique to each thread", "body": "<p>Let me emphasize that the accepted answer by Andrew Henle is perfectly fine and will work in every single C environment I have ever used even though he is technically incorrect to say it is portable and standards compliant.</p>\n\n<p>I think I'd prefer either of the two following solutions</p>\n\n<ol>\n<li><p>Pass a direct pointer to the element</p>\n\n<pre><code>typedef /* whatever */ } MyType;\nMyType* array;\nint main(int argc, char*argv[])\n{\n    // find out what n is\n    array = calloc(n, sizeof *array);\n    // some stuff including filling in array\n    pthread_t tid[n];\n    for (int k = 0; k &lt; n; k++)\n    {\n        pthread_create( &amp;tid[k], NULL, startFunc, &amp;array[k]);\n    }\n    // do stuff including wait for the threads to finish\n}\n\nvoid startFunc(void* param)\n{\n    MyType* myObject = (MyType*)param;\n    // Do stuff directly on myObject\n    // or if you *really* need to recover k:\n    ptrdiff_t k = myObject - array;\n}\n</code></pre>\n\n<p>I like this solution because the thread does not need to know anything about the context of the single piece of data it is working on.</p></li>\n<li><p>Create a context type to pass to the thread start function and put everything you need in it.</p>\n\n<pre><code>typedef /* whatever */ } MyType;\nMyType* array;\nstruct ThreadContext\n{\n    pthread_t tid;\n    int k;\n    MyType *array;\n    size_t arraySize;\n}\n\nint main(int argc, char*argv[])\n{\n    // find out what n is\n    array = calloc(n, sizeof *array);\n    // some stuff including filling in the array\n    struct Context* contexts = calloc(n, sizeof *contexts);\n    for (int k = 0; k &lt; n; k++)\n    {\n        contexts[k].array = array;\n        contexts[k].arraySize = n;\n        contexts[k].k = k;\n        pthread_create( &amp;(contexts[k].tid), NULL, startFunc, &amp;contexts[k]);\n    }\n    // do stuff including wait for the threads to finish\n}\n\nvoid startFunc(void* param)\n{\n    struct Context* context= (struct Context*)param;\n    doSomethingWithArrayObject(context-&gt;array, context-&gt;k);\n}\n</code></pre>\n\n<p>This is more like the normal way of passign contextual data to a callback function. You can put everything you need in the thread in the Context struct instead of relying on globals.       </p></li>\n</ol>\n"}], "owner": {"reputation": 163, "user_id": 7776851, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9cebeccf787898d7593cb0882808ade2?s=128&d=identicon&r=PG&f=1", "display_name": "laroy", "link": "https://stackoverflow.com/users/7776851/laroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 43229721, "answer_count": 4, "score": 0, "last_activity_date": 1491401735, "creation_date": 1491389126, "question_id": 43228933, "link": "https://stackoverflow.com/questions/43228933/multithreading-with-variables-unique-to-each-thread", "title": "Multithreading with variables unique to each thread", "body": "<p>I'm trying to implement a multi-threaded solution to a problem that requires something like the following</p>\n\n<ul>\n<li>I create 'n' threads</li>\n<li>I have an array of 'n - 1' size</li>\n<li>Each thread should only access its according element of the array (i.e thread 0 should affect only element 0 of the array, thread 1 should only affect element 1, and so on.)</li>\n<li>each thread will execute the same function that references the array by index 'k'</li>\n</ul>\n\n<p>how can I change 'k' each time a thread is created in order to have it start at 0, and end at 'n - 1' such that each thread will only access its assigned array element?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 818, "user_id": 3966756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb9b20ead96aca0c12944cc8bf60a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian L", "link": "https://stackoverflow.com/users/3966756/sebastian-l"}, "edited": false, "score": 0, "creation_date": 1491387270, "post_id": 43228102, "comment_id": 73526228, "body": "You should scan a string and parse it according to your needs <a href=\"http://stackoverflow.com/questions/5406935/reading-a-string-with-scanf\">helpful link</a>"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1491388289, "post_id": 43228102, "comment_id": 73526965, "body": "&#39;if (scanf(&quot;%d&quot;, &amp;cinput) != 1)&#39; no.  cinput is a char, you read an int:("}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491389179, "post_id": 43228102, "comment_id": 73527597, "body": "You should initialize the counters to 0."}, {"owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491389389, "post_id": 43228102, "comment_id": 73527744, "body": "Counters initialized. <code>scanf(&quot;%d&quot;, &amp;cinput)</code> changed to <code>scanf(&quot;%d&quot;, &amp;input)</code>. Changed <code>even_p</code> and <code>odd_p</code> to <code>float</code> (from <code>int</code>). Now the calculation is working fine and the first value in <code>odd_array</code> is good to. Now any tips how to check if entered value is a whole number, break the loop if <code>\\n</code> is entered and quit if <code>exit</code> is entered?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491387812, "post_id": 43228183, "comment_id": 73526606, "body": "odd_counter is initialized at the beginning Changed even_p and odd_p to float and it worked."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491387869, "post_id": 43228183, "comment_id": 73526653, "body": "@KaralisArt\u016brs - No it isn&#39;t. It&#39;s declared, without any initialization."}, {"owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491388325, "post_id": 43228183, "comment_id": 73526995, "body": "Ok. So I changed int input, all [100], even[100], odd[100], even_counter=0, even_print=0, odd_counter=0, odd_print=0, total_counter=0, total_print=0;  But even without initializing the % calculation worked when I changed it even_p and odd_p to float.  That leaves just the &quot;Why is the first value in odd_array always a 0?&quot;"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491388602, "post_id": 43228183, "comment_id": 73527194, "body": "@KaralisArt\u016brs - hold on. This is also a big no no <code>scanf(&quot;%d&quot;, &amp;cinput)</code>. Conversion specifiers <i>must match</i> the types of the variables. Or the behavior of your program is undefined. Compile with all warnings enabled. And better yet, have the compiler treat them like errors, so you&#39;d be forced to address them."}, {"owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491389047, "post_id": 43228183, "comment_id": 73527522, "body": "Originally it was <code>scanf(&quot;%d&quot;, &amp;input)</code> but that would not work if I want the user to be able to enter &quot;exit&quot; to quit the program."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491389451, "post_id": 43228183, "comment_id": 73527804, "body": "@KaralisArt\u016brs What makes you think <code>scanf(&quot;%d&quot;, &amp;cinput);</code> would work? And <code>scanf(&quot;%d&quot;, &amp;input);</code> would return 0 if you entered &quot;exit&quot;."}, {"owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "edited": false, "score": 0, "creation_date": 1491390426, "post_id": 43228183, "comment_id": 73528557, "body": "I&#39;m a complete beginner here. When I changed <code>&amp;input</code> to <code>&amp;cinput</code> I just forgot to change <code>&quot;%d&quot;</code> to <code>&quot;%s&quot;</code>."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1491388308, "last_edit_date": 1491388308, "creation_date": 1491387157, "answer_id": 43228183, "question_id": 43228102, "link": "https://stackoverflow.com/questions/43228102/program-in-c-not-calculating-and-break-exit-on-specific-input/43228183#43228183", "title": "Program in C not calculating % and break/exit on specific input", "body": "<pre><code>even_p=(even_counter/total_counter)*100;\n</code></pre>\n\n<p>The above preforms <strong>integer division</strong>. You don't get an exact divisor, but the the integer immediately preceding it. Since <code>even_counter</code> is always less than <code>total_counter</code> you get zero.</p>\n\n<p>A simple fix is to multiply first, and divide second:</p>\n\n<pre><code>even_p = even_counter * 100 / total_counter;\n</code></pre>\n\n<p>But your program has undefined behavior all around regardless. You don't initialize all of your variables. For instance, <code>odd_counter</code> isn't initialized, and yet you confidently read its value here:</p>\n\n<pre><code>    if (input % 2 != 0)\n    {\n        odd[odd_counter]=input; //Insert number in odd numbers array\n        odd_counter++;\n        total_counter++;\n    }\n</code></pre>\n\n<hr>\n\n<p>The things you can't figure out can fill a post on their own. It's all about parsing. You need to read an entire line (say with <code>fgets</code>) and then try to parse it (for instance, with repeated applications of <code>sscanf</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1491389071, "last_edit_date": 1491389071, "creation_date": 1491387435, "answer_id": 43228282, "question_id": 43228102, "link": "https://stackoverflow.com/questions/43228102/program-in-c-not-calculating-and-break-exit-on-specific-input/43228282#43228282", "title": "Program in C not calculating % and break/exit on specific input", "body": "<p>There are several issues in the code.</p>\n\n<p>First, your variables, especially <code>odd_counter</code> and so on are not initialised. Hence, an expression like <code>odd[odd_counter]=input</code> yields undefined behaviour (and actually you have a good chance that the program crashes). Note that in C local variables of integral type are NOT by default initialized, neither with <code>0</code> nor with any other value. So you need to write <code>int odd_counter=0, even_counter=0, ...</code> and so on. Otherwise your program might yield a correct output (as a correct output is one of thousands of possible outputs due to undefined behaviour), but it is for sure not guaranteed.</p>\n\n<p>Second, <code>even_p=(even_counter/total_counter)*100</code> performs an integer division (nothing behind the comma), so <code>even_counter/total_counter</code> will always be <code>0</code> if <code>total_counter</code> is greater than <code>even_counter</code>. So you could write <code>even_p=((even_counter*100)/total_counter)</code>, or <code>(((float)even_counter)/total_counter)*100</code>. Decide if <code>even_p</code> should be <code>float</code> or <code>double</code> as well.</p>\n\n<p>Third, you use <code>%d</code> (i.e. int) to scan into a variable of type <code>signed char</code>. Use <code>scanf(\"%hhd\", &amp;cinput)</code> instead; Format specifier <code>%d</code> together with length sub-specifier <code>hh</code> tells <code>scanf</code> to scan a numerical value into a signed char target (confer <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">printf/scanf reference</a>). Or: change type of variable <code>cinput</code> to <code>int</code>.</p>\n\n<p>After fixing all these issues, the topic \"Why is the first value in odd_array always a 0\" should be solved as well.</p>\n"}, {"tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": false, "score": 0, "last_activity_date": 1491389476, "creation_date": 1491389476, "answer_id": 43229055, "question_id": 43228102, "link": "https://stackoverflow.com/questions/43228102/program-in-c-not-calculating-and-break-exit-on-specific-input/43229055#43229055", "title": "Program in C not calculating % and break/exit on specific input", "body": "<p>You declare</p>\n\n<pre><code>    char cinput;\n</code></pre>\n\n<p>and then use it in</p>\n\n<pre><code>    scanf(\"%d\", &amp;cinput)\n</code></pre>\n\n<p>That's bad, very bad... Format specifier <code>\"%d\"</code> expects a pointer to <code>int</code> as a corresponding parameter, not a pointer to <code>char</code>. And <code>int</code> is longer than <code>char</code> (typically 4 vs. 1 byte), so the input value gets stored <em>outside</em> the destination <code>cinput</code> variable.</p>\n\n<p>What happens next is Undefined Behavior.</p>\n"}], "owner": {"reputation": 3, "user_id": 7816066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TW1f03GXEgM/AAAAAAAAAAI/AAAAAAAAVzU/tE_MTipX27k/photo.jpg?sz=128", "display_name": "Karalis Art\u016brs", "link": "https://stackoverflow.com/users/7816066/karalis-art%c5%abrs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 43228183, "answer_count": 3, "score": 0, "last_activity_date": 1491389721, "creation_date": 1491386960, "last_edit_date": 1491389721, "question_id": 43228102, "link": "https://stackoverflow.com/questions/43228102/program-in-c-not-calculating-and-break-exit-on-specific-input", "title": "Program in C not calculating % and break/exit on specific input", "body": "<p>I'm trying to make a small program, where user enters a list of numbers and at the end it shows how much in % of the numbers are odd or even.</p>\n\n<p>If the user enters no value (just presses enter) it stops request a number and shows the calculation, but if the user enters <code>exit</code> it exits. Additionally I want to check if the entered number is a whole number.</p>\n\n<p>Here what I got so far:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int input, all [100], even[100], odd[100], even_counter, even_print, odd_counter, odd_print, total_counter, total_print, even_p, odd_p;\n    char cinput;\n    for (;;)\n    {\n        printf(\"Enter a number: \");\n        if (scanf(\"%d\", &amp;cinput) != 1) break;\n        input=(int)(cinput-0);\n        all[total_counter]=input; //Insert number in all numbers array\n\n        if (input % 2 == 0)\n        {\n            even[even_counter]=input; //Insert number in even numbers array\n            even_counter++;\n            total_counter++;\n        }\n        if (input % 2 != 0)\n        {\n            odd[odd_counter]=input; //Insert number in odd numbers array\n            odd_counter++;\n            total_counter++;\n        }\n    }\n\n    printf(\"\\n You entered the following numbers: \");\n    for (total_print=0; total_print&lt;total_counter; total_print++)\n    {\n        printf(\"%d \", all[total_print]); //Show all entered numbers\n    }\n    printf(\"\\n Even numbers are: \");\n    for (even_print=0; even_print&lt;even_counter; even_print++)\n    {\n        printf(\"%d \", even[even_print]); //Show even numbers only\n    }\n    printf(\"\\n Odd numbers are: \");\n    for (odd_print=0; odd_print&lt;odd_counter; odd_print++)\n    {\n        printf(\"%d \", odd[odd_print]); //show odd numbers only\n    }\n\n    printf(\"\\n\\n Total numbers entered: %d\", total_counter); //Show count of all numbers\n    printf(\"\\n Even numbers entered: %d\", even_counter); //Show count of even numbers\n    printf(\"\\n Odd numbers entered: %d\", odd_counter); //Show count of odd numbers\n\n    even_p=(even_counter/total_counter)*100; //Calculate % of even numbers\n    odd_p=(odd_counter/total_counter)*100; //Calculate % of odd numbers\n\n    printf(\"\\n\\n Even numbers are %d %% of total number (%d out of %d)\", even_p, even_counter, total_counter);\n    printf(\"\\n Odd numbers are %d %% of total number (%d out of %d)\", odd_p, odd_counter, total_counter);\n}\n</code></pre>\n\n<p>What works:</p>\n\n<ul>\n<li>It saves all entered numbers in one array, even and odd numbers in\nseparate arrays.</li>\n<li>It counts how many numbers were entered, how many    are even and how\nmany are odd.</li>\n<li>As soon as a non-numeric character is entered it goes to showing the\nresult.</li>\n</ul>\n\n<p>What doesn't work:</p>\n\n<ul>\n<li>The % calculation always says that it's 0%.</li>\n<li>The first number in the odd array is 0.</li>\n</ul>\n\n<p>What I can't figure out:</p>\n\n<ul>\n<li>How to make it go to the results if nothing is entered? Tried\n<code>if (scanf(\"%d\", &amp;cinput) != \"\\n\") break;</code>, but it just\ngot stuck in the loop request another number.</li>\n<li>How to make the program exit if <code>exit</code> is entered?</li>\n<li>How to check if a whole number is entered?</li>\n</ul>\n\n<p><strong>EDIT</strong></p>\n\n<p>Counters initialized. scanf(\"%d\", &amp;cinput) changed to scanf(\"%d\", &amp;input). Changed even_p and odd_p to float (from int). Now the calculation is working fine and the first value in odd_array is good to.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int input, all [100], even[100], odd[100], even_counter, even_print, odd_counter, odd_print, total_counter, total_print;\n\n    even_counter=0;\n    even_print=0;\n    odd_counter=0;\n    odd_print=0;\n    total_counter=0;\n    total_print=0;\n    for (;;)\n    {\n\n        printf(\"Enter a number: \");\n        if (scanf(\"%d\", &amp;input) != 1) break;\n        all[total_counter]=input; //Insert number in all numbers array\n\n        if (input % 2 == 0)\n        {\n            even[even_counter]=input; //Insert number in even numbers array\n            even_counter++;\n            total_counter++;\n        }\n        if (input % 2 != 0)\n        {\n            odd[odd_counter]=input; //Insert number in odd numbers array\n            odd_counter++;\n            total_counter++;\n        }\n    }\n\n    printf(\"\\n You entered the following numbers: \");\n    for (total_print=0; total_print&lt;total_counter; total_print++)\n    {\n        printf(\"%d \", all[total_print]); //Show all entered numbers\n    }\n    printf(\"\\n Even numbers are: \");\n    for (even_print=0; even_print&lt;even_counter; even_print++)\n    {\n        printf(\"%d \", even[even_print]); //Show even numbers only\n    }\n    printf(\"\\n Odd numbers are: \");\n    for (odd_print=0; odd_print&lt;odd_counter; odd_print++)\n    {\n        printf(\"%d \", odd[odd_print]); //show odd numbers only\n    }\n\n    printf(\"\\n\\n Total numbers entered: %d\", total_counter); //Show count of all numbers\n    printf(\"\\n Even numbers entered: %d\", even_counter); //Show count of even numbers\n    printf(\"\\n Odd numbers entered: %d\", odd_counter); //Show count of odd numbers\n\n    float even_p=((float)(even_counter)/total_counter)*100; //Calculate % of even numbers\n    float odd_p=((float)(odd_counter)/total_counter)*100; //Calculate % of odd numbers\n\n    printf(\"\\n\\n Even numbers are %f %% of total number (%d out of %d)\", even_p, even_counter, total_counter);\n    printf(\"\\n Odd numbers are %f %% of total number (%d out of %d)\", odd_p, odd_counter, total_counter);\n}\n</code></pre>\n\n<p>Now I just need the input to be checked if it's a whole number (display a message, but continue to ask for numbers), go to calculation if no value is entered, quit if <code>exit</code> is entered. And I forgot - the user should not be able to go to calculation if he enters less than 10 numbers. :(</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1491386902, "post_id": 43228055, "comment_id": 73525969, "body": "related: is floating point math broken?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1491390570, "post_id": 43228055, "comment_id": 73528657, "body": "Never use floating point to do currency calculations. Floating point is not designed to work for currency and will cause results that are wrong, inaccurate and sometimes even illegal. Use integers to count cents and check what your laws say about rounding. Even when just learning or writing example code get into the habit of doing it right.Trying to get numbers to add up correctly while an angry accountant yells at you 45 minutes before midnight at the turn of the month is not fun (especially when it&#39;s someone elses code)."}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 7819496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad93550f431a477da4beab3848225cad?s=128&d=identicon&r=PG&f=1", "display_name": "cashmisa", "link": "https://stackoverflow.com/users/7819496/cashmisa"}, "edited": false, "score": 0, "creation_date": 1491443016, "post_id": 43228332, "comment_id": 73558562, "body": "Thanks Codor for the explanation, I understand now and will not use float in this type of situations again :)"}], "tags": [], "owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "is_accepted": true, "score": 0, "last_activity_date": 1491387567, "creation_date": 1491387567, "answer_id": 43228332, "question_id": 43228055, "link": "https://stackoverflow.com/questions/43228055/c-while-loop-tricky-exceptions/43228332#43228332", "title": "C while loop tricky exceptions", "body": "<p>The is no bug in your code in the strictest sense as the underlying reasoning is correct; however note that the value <code>0.35</code> cannot be represented exactly in the <code>float</code> datatype, the same holds for <code>0.05</code>; as the division (what basically is the sematics of the code in the question) is implemented via repeated subtraction, the error caused by the inability to exactly represent the desired values accumulates. The result is that the number of subtractions is different from the analytically expected result, as the termination condition is reached too soon. The <code>float</code> datatype is not suitable for financial calculations, even in such a very small everyday example.</p>\n\n<p><em>This is terrible, but it is a matter of fact.</em></p>\n"}, {"comments": [{"owner": {"reputation": 38, "user_id": 7819496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad93550f431a477da4beab3848225cad?s=128&d=identicon&r=PG&f=1", "display_name": "cashmisa", "link": "https://stackoverflow.com/users/7819496/cashmisa"}, "edited": false, "score": 0, "creation_date": 1491442681, "post_id": 43228419, "comment_id": 73558470, "body": "I see, thanks Lyall Pearce, this is very helpful! I will bear in mind the floating point rounding for future :)"}, {"owner": {"reputation": 38, "user_id": 7819496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad93550f431a477da4beab3848225cad?s=128&d=identicon&r=PG&f=1", "display_name": "cashmisa", "link": "https://stackoverflow.com/users/7819496/cashmisa"}, "edited": false, "score": 0, "creation_date": 1491445961, "post_id": 43228419, "comment_id": 73559287, "body": "and if I were to edit I would have used int() instead of round(), but looking at your suggestion I looked up the differences and learned a little more. Thanks again."}], "tags": [], "owner": {"reputation": 131, "user_id": 7819744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iLVHi.jpg?s=128&g=1", "display_name": "Lyall Pearce", "link": "https://stackoverflow.com/users/7819744/lyall-pearce"}, "is_accepted": false, "score": 4, "last_activity_date": 1491401150, "last_edit_date": 1491401150, "creation_date": 1491387825, "answer_id": 43228419, "question_id": 43228055, "link": "https://stackoverflow.com/questions/43228055/c-while-loop-tricky-exceptions/43228419#43228419", "title": "C while loop tricky exceptions", "body": "<p>You are hitting up against floating point rounding.</p>\n\n<p>Floating points are never exactly accurate, try calculating </p>\n\n<pre><code>printf(\"one third 'ish' = %6.20lf\\n\", (double) 1.0/ (double) 3.0);\n</code></pre>\n\n<p>Look at the answer, it's not quite accurate. :)</p>\n\n<p>Your best bet is to accept the input, convert it to an integer (ie, cents) by multiplying by 100, removing any decimals using round() and assigning to a long.</p>\n\n<pre><code>    #include &lt;math.h&gt; // to get the round() function\n.\n.\n.\n    long amountInCents = round(amount * 100);\n</code></pre>\n\n<p>Then, change your code to compare against 5 cents, not $0.05, and to reduce by 5 cents, not $0.05</p>\n\n<p>This way, you get rid of all 'rounding' issues.</p>\n\n<p>EDIT: cmaster showed me that using floor() didn't work, using $0.57 as input, when using 'double' variables (not float), $0.57 converted to (long) 56! He supplied code and I couldn't believe my eyes! </p>\n"}, {"comments": [{"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1491393720, "post_id": 43229036, "comment_id": 73530991, "body": "This is a dirty, hacky workaround, not a fix!"}], "tags": [], "owner": {"reputation": 17, "user_id": 5864761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a490f94f65db2a117620015eaad83973?s=128&d=identicon&r=PG&f=1", "display_name": "shiyaz t", "link": "https://stackoverflow.com/users/5864761/shiyaz-t"}, "is_accepted": false, "score": -1, "last_activity_date": 1491389431, "creation_date": 1491389431, "answer_id": 43229036, "question_id": 43228055, "link": "https://stackoverflow.com/questions/43228055/c-while-loop-tricky-exceptions/43229036#43229036", "title": "C while loop tricky exceptions", "body": "<p>I found a fix. This is working </p>\n\n<pre><code>enter code here\n\nwhile ((amount - 0.0499) &gt;= 0)\n{\n    amount -= 0.05;\n    n ++;\n} \n</code></pre>\n\n<p>while scanning .35  amount as float the actual amount value is 0.3499</p>\n"}], "owner": {"reputation": 38, "user_id": 7819496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad93550f431a477da4beab3848225cad?s=128&d=identicon&r=PG&f=1", "display_name": "cashmisa", "link": "https://stackoverflow.com/users/7819496/cashmisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "closed_date": 1491401391, "accepted_answer_id": 43228332, "answer_count": 3, "score": 2, "last_activity_date": 1491401150, "creation_date": 1491386838, "question_id": 43228055, "link": "https://stackoverflow.com/questions/43228055/c-while-loop-tricky-exceptions", "closed_reason": "Duplicate", "title": "C while loop tricky exceptions", "body": "<p>I am a beginner and this is (a simplified version of) part of a code I am writing:</p>\n\n<p>1.prompt user to input a number (float dollar amount), lets say user will only key in amount which are multiples of 0.05 ;</p>\n\n<p>2.calculate the (int)number of nickels in that dollar amount.</p>\n\n<pre><code>int main(void)\n{\n    float amount = 0;\n    printf(\"$ \");\n    amount = get_float();\n\n    int n = 0;\n    while ((amount - 0.05) &gt;= 0)\n    {\n        amount -= 0.05;\n        n ++;\n    } \n    printf(\"%i nickels\\n\", n);\n\n}\n</code></pre>\n\n<p>It works for any amount &lt;=0.3 or >=1.2 (so $2 has 40 nickels, and $0.30 has 6 nickels);</p>\n\n<p>but one nickel less for any amount between/including 0.35 and 1.15 (so $0.35 has 6 nickels, and $1 has 19 nickels)</p>\n\n<p>I did step by step printing, and it turns out that for any amount between 0.35 and 1.15, the program stops at the last 0.050000, instead of going back to the loop and loop it one last time.</p>\n\n<p>What went wrong? Please help... Thanks so much for your time!</p>\n"}, {"tags": ["c", "linux", "struct", "error-handling", "segmentation-fault"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1491386364, "post_id": 43227700, "comment_id": 73525578, "body": "You haven&#39;t said where your code crashes - run it in a debugger and you&#39;ll see on what line it happens. Might also show you what you need to fix too."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1491391258, "post_id": 43227700, "comment_id": 73529159, "body": "[off-topic] Personally, I would use (variable sized) arrays, and not Linked Lists for the tables."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491404134, "post_id": 43227700, "comment_id": 73539690, "body": "for ease of readability and understanding: 1) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line. 2) separate functions by 2 or 3 blank lines (be consistent)  3) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491404521, "post_id": 43227700, "comment_id": 73539995, "body": "while the &#39;implicit conversion&#39; feature may save the code, it should not be relied upon.  There is a major difference in the meaning between NULL and 0 (although the bit values may be the same."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491404941, "post_id": 43227700, "comment_id": 73540322, "body": "When there is a problem with the command line parameters, (For instance there are none) The the code should output a <code>USAGE</code> statement to <code>stderr</code>,  similar to: <code>fprintf( stderr, &quot;USAGE: %s &lt;srcFileName1&gt; [[srcFileNameN]]\\n&quot;, argv[0] );</code>  Such a statement is usually followed by <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491405687, "post_id": 43227700, "comment_id": 73540841, "body": "the macro: <code>WORD_SIZE</code> not defined within the posted code."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "edited": false, "score": 0, "creation_date": 1491388581, "post_id": 43228554, "comment_id": 73527173, "body": "If i&#39;ll do so, doesn&#39;t it clears only the head, and not the nodes after it? How do I make sure the entire list is cleared, and the head nullified?"}, {"owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "edited": false, "score": 0, "creation_date": 1491388732, "post_id": 43228554, "comment_id": 73527304, "body": "I also want to make sure both the strings firstOperand and secondOperand are refering to are cleared."}, {"owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "edited": false, "score": 0, "creation_date": 1491388956, "post_id": 43228554, "comment_id": 73527463, "body": "I think the program is indeed the fact that I am not nullifying the heads, as later on I have a function that checks if the head == NULL, and allocates memory to a new node if that&#39;s the case."}, {"owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "edited": false, "score": 0, "creation_date": 1491396143, "post_id": 43228554, "comment_id": 73532889, "body": "problem* goddamnit"}], "tags": [], "owner": {"reputation": 3268, "user_id": 182634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5b602ab0bc363e3e990f2e904b671d?s=128&d=identicon&r=PG", "display_name": "eyalm", "link": "https://stackoverflow.com/users/182634/eyalm"}, "is_accepted": false, "score": 0, "last_activity_date": 1491388120, "creation_date": 1491388120, "answer_id": 43228554, "question_id": 43227700, "link": "https://stackoverflow.com/questions/43227700/getting-an-segmentation-fault-core-dumped-error-in-ubuntu/43228554#43228554", "title": "Getting an segmentation fault (core dumped) error in Ubuntu", "body": "<p>You do not free and nullifying the linked lists in the context struct (<code>programCore</code>). I suspect you are then using pointers to freed memory blocks.</p>\n\n<p>This line only copies the pointer:</p>\n\n<pre><code>struct MachineCode *machineHead = programCore-&gt;machineHead;\n</code></pre>\n\n<p>The while() loop is not clearing <code>programCore-&gt;machineHead</code></p>\n\n<p>To fix it, run directly on the head:</p>\n\n<pre><code>while(programCore-&gt;machineHead != NULL)\n{\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491405909, "post_id": 43228605, "comment_id": 73541010, "body": "the problem is some those fields are <code>unsigned int</code> and some are <code>int</code>  and the operations are performed from right to left, so some <code>unsigned int</code> values are being assigned from <code>int</code> values.  Suggest writing each assignment as a separate statement."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491405984, "post_id": 43228605, "comment_id": 73541046, "body": "the problem is that <code>protramCore</code> is a pointer, so must use <code>-&gt;</code> rather than <code>.</code>  ALSO, each of those pointers is a different type and the operations are performed from right to left, and different types of pointers cannot be assigned.  Suggest writing each assignment as a separate statement."}], "tags": [], "owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "is_accepted": false, "score": 0, "last_activity_date": 1491388263, "creation_date": 1491388263, "answer_id": 43228605, "question_id": 43227700, "link": "https://stackoverflow.com/questions/43227700/getting-an-segmentation-fault-core-dumped-error-in-ubuntu/43228605#43228605", "title": "Getting an segmentation fault (core dumped) error in Ubuntu", "body": "<p>Well, by getting rid of </p>\n\n<pre><code>   if(fMachineHead-&gt;structure-&gt;numOfOperands == 2)\n         free(fMachineHead-&gt;structure-&gt;secondOperand);\n   if(fMachineHead-&gt;structure-&gt;numOfOperands &gt; 0)\n         free(fMachineHead-&gt;structure-&gt;firstOperand);\n</code></pre>\n\n<p>I have managed to solve the error, but now I am getting a new one -</p>\n\n<pre><code>main.c:242:13: error: request for member \u2018symbolHead\u2019 in something not a structure or union\nmain.c:242:38: error: request for member \u2018externHead\u2019 in something not a structure or union\nmain.c:243:13: error: request for member \u2018dataHead\u2019 in something not a structure or union\nmain.c:244:13: error: request for member \u2018machineHead\u2019 in something not a structure or union\n</code></pre>\n\n<p>Referring to the next line -</p>\n\n<pre><code>        programCore.symbolHead = programCore.externHead = programCore.dataHead = programCore.machineHead = NULL;\n</code></pre>\n\n<p>Is there a problem with the way I wrote that? (Obviously yes, but I just don't see it).</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "is_accepted": false, "score": 0, "last_activity_date": 1491392197, "creation_date": 1491392197, "answer_id": 43230083, "question_id": 43227700, "link": "https://stackoverflow.com/questions/43227700/getting-an-segmentation-fault-core-dumped-error-in-ubuntu/43230083#43230083", "title": "Getting an segmentation fault (core dumped) error in Ubuntu", "body": "<p>Changed the clear() function again and it seems to be working fine now.</p>\n\n<pre><code>    /*Used to empty the linked lists and allocated memory after the program has finished one iteration. */\nvoid Clear(struct Operation *programCore) { \n    /*f(pointer name) is there to hold a pointer to the allocated memory which is about to be flushed. */\n    struct MachineCode *machineRowPointer = programCore-&gt;machineHead, *fMachineRow; \n    struct DataCode *dataRowPointer = programCore-&gt;dataHead, *fDataRow; \n        struct symbolStruct *externSymbolPointer = programCore-&gt;externHead, *fExtern;\n    struct symbolStruct *symbolPointer = programCore-&gt;symbolHead, *fSymbol;\n    if(machineRowPointer != NULL) {\n        while(machineRowPointer != NULL) {\n            if(machineRowPointer-&gt;structure != NULL)\n                free(machineRowPointer-&gt;structure);\n            fMachineRow = machineRowPointer;\n            machineRowPointer = machineRowPointer-&gt;next;\n            free(fMachineRow);\n        }\n        programCore-&gt;machineHead = NULL;\n    }\n    if(dataRowPointer != NULL) {\n        while(dataRowPointer != NULL) {\n            fDataRow = dataRowPointer;\n            dataRowPointer = dataRowPointer-&gt;next;\n            free(fDataRow);\n        }\n        programCore-&gt;dataHead = NULL;\n    }\n    if(externSymbolPointer != NULL) {\n        while(externSymbolPointer != NULL) {\n            fExtern = externSymbolPointer;\n            externSymbolPointer = externSymbolPointer-&gt;next;\n            free(fExtern-&gt;name);\n            free(fExtern);\n        }\n        programCore-&gt;externHead = NULL;\n    }\n    if(symbolPointer != NULL) {\n        while(symbolPointer != NULL) {\n            fSymbol = symbolPointer;\n            symbolPointer = symbolPointer-&gt;next;\n            free(fSymbol-&gt;name);\n            free(fSymbol);\n        }\n        programCore-&gt;symbolHead = NULL;\n    }\n    programCore-&gt;ic = programCore-&gt;dc = programCore-&gt;linenumber = programCore-&gt;errorflag = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 4908019, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10206790662624477/picture?type=large", "display_name": "Eddie Romanenco", "link": "https://stackoverflow.com/users/4908019/eddie-romanenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1491392197, "creation_date": 1491385888, "last_edit_date": 1491386774, "question_id": 43227700, "link": "https://stackoverflow.com/questions/43227700/getting-an-segmentation-fault-core-dumped-error-in-ubuntu", "title": "Getting an segmentation fault (core dumped) error in Ubuntu", "body": "<p>I am trying to build a program which will function as an assembler, it will be getting file name as command line arguments and translate them to machine code.</p>\n\n<p>The program compiles just fine and runs OK with 1 file name, but when I try to run with several, the error appears after the first iteration.</p>\n\n<p>I think there might be something withe the <code>Clear()</code> function (which flushes out all the data allocated in the previous iteration), but not sure why. Note that this is partial, but as I said, the program will run unless several files are used.</p>\n\n<pre><code>struct symbolStruct { // a structure which is used to absorb info about a tag, its place in memory and related flags\n    char *name;\n    int place;\n    unsigned int isEntry : 1;\n    unsigned int isData : 1;\n    unsigned int isExternal : 1;\n    struct symbolStruct *next;\n};\n\ntypedef struct { // a structure which is used to absorb info about the operand structure of an instruction line\n    unsigned int numOfOperands : 2;\n    unsigned int addrMethSou : 2;\n    unsigned int addrMethDest : 2;\n    unsigned int operation : 4;\n    unsigned int extraWords : 2;\n    char *firstOperand;\n    char *secondOperand;\n} OperandType;\n\ntypedef struct {\n    unsigned int row : WORD_SIZE;\n} int15;\n\nstruct MachineCode { // a structure which is used to absorb machine code lines, and their location in the assembly file\n    unsigned int row : WORD_SIZE;\n    unsigned int line;\n    OperandType *structure;\n    struct MachineCode *next;\n};\n\nstruct DataCode { // a structure which is used to absorb data and string elements (signed numbers and ascii characters)\n    unsigned int row : WORD_SIZE;\n    struct DataCode *next;\n};\n\nstruct Operation { /* the main operation structure, contains pointers to all used lists, the ic and dc counters, the\n    current line number which is dealt with and the error flag. */\n    unsigned int ic;\n    unsigned int dc;\n    struct symbolStruct *externHead; // a pointer to a linked list of extern tags used in the assembly file, and their locations\n    struct symbolStruct *symbolHead; // a pointer to a linked list of all tags\n    struct DataCode *dataHead; // a pointer to a linked list of all data/string elements\n    struct MachineCode *machineHead; // a pointer to a linked list of all machine code rows\n    int linenumber;\n    unsigned int errorflag : 1; // raised in case of an error which triggered a warning\n};\n\n#include \"header.h\"\n\nvoid FirstRun(struct Operation*, char *);\nvoid DataUpdate(struct symbolStruct*,int);\nvoid SecondRun(struct Operation *, char *);\nvoid Clear(struct Operation *);\n\nint main(int argc, char *argv[]) {\n    int i;\n    struct Operation programCore = {0,0,NULL,NULL,NULL,NULL,0,0};\n    for(i=1;i&lt;argc;i++) {\n        char *fn = argv[i];\n        FirstRun(&amp;programCore,fn);\n        DataUpdate(programCore.symbolHead,programCore.ic+INSTRUCTION_OFFSET);\n        SecondRun(&amp;programCore,fn);\n        Clear(&amp;programCore);\n        programCore.symbolHead = programCore.externHead = programCore.dataHead = programCore.machineHead = NULL;\n    }\n    if(argc &lt; 2) {\n        fprintf(stderr,\"No files selected.\\n\");\n    }\n    return 0;\n}\n\n/*Used to empty the linked lists and allocated memory after the program has finished one iteration. */\nvoid Clear(struct Operation *programCore) { \n    /*f(pointer name) is there to hold a pointer to the allocated memory which is about to be flushed. */\n    struct MachineCode *machineHead = programCore-&gt;machineHead, *fMachineHead; \n    struct DataCode *dataHead = programCore-&gt;dataHead, *fDataHead; \n        struct symbolStruct *externHead = programCore-&gt;externHead, *fExternHead;\n    struct symbolStruct *symbolHead = programCore-&gt;symbolHead, *fSymbolHead;\n    while(machineHead != NULL) {\n            fMachineHead = machineHead;\n        machineHead = machineHead-&gt;next;\n        if(fMachineHead-&gt;structure != NULL) {\n            if(fMachineHead-&gt;structure-&gt;numOfOperands == 2)\n                free(fMachineHead-&gt;structure-&gt;secondOperand);\n            if(fMachineHead-&gt;structure-&gt;numOfOperands &gt; 0)\n                free(fMachineHead-&gt;structure-&gt;firstOperand);\n            free(fMachineHead-&gt;structure);\n        }\n        free(fMachineHead);\n    }\n    while(dataHead != NULL) {\n        fDataHead = dataHead;\n        dataHead = dataHead-&gt;next;\n        free(fDataHead);\n    }\n    while(externHead != NULL) {\n        fExternHead = externHead;\n        externHead = externHead-&gt;next;\n        free(fExternHead-&gt;name);\n        free(fExternHead);\n    }\n    while(symbolHead != NULL) {\n        fSymbolHead = symbolHead;\n        symbolHead = symbolHead-&gt;next;\n        free(fSymbolHead-&gt;name);\n        free(fSymbolHead);\n    }\n    programCore-&gt;ic = programCore-&gt;dc = programCore-&gt;linenumber = programCore-&gt;errorflag = 0;\n}\n</code></pre>\n"}, {"tags": ["c", "do-while"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1491385532, "post_id": 43227502, "comment_id": 73524911, "body": "can&#39;t be done unless you&#39;re allowed to add more variables"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1491385549, "post_id": 43227502, "comment_id": 73524926, "body": "You need other 2 variables to do what you want."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491385634, "post_id": 43227502, "comment_id": 73525010, "body": "<i>if loops</i>....does not make any sense..."}, {"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1491385718, "post_id": 43227502, "comment_id": 73525075, "body": "You can use them later in IF loop or something like that but for inputing numbers you have to use only one because you don&#39;t have specific limit of how much numbers you can enter, you only have instruction to stop entering numbers when you enter 0..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491385740, "post_id": 43227502, "comment_id": 73525091, "body": "<code>scanf(&quot;%d\\n&quot;, &amp;a);</code> ---&gt; <code>scanf(&quot;%d&quot;, &amp;a);</code>... this is why you must input always a number after 0, or after each value..."}, {"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1491385839, "post_id": 43227502, "comment_id": 73525169, "body": "it worked, tnx..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491386024, "post_id": 43227502, "comment_id": 73525322, "body": "&quot;as I have only one variable to enter numbers into it&quot; Try sticking both your feet into one of your shoes. If you have limited success in that, it might be a good idea to question if the specification actually makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 1, "creation_date": 1491386408, "post_id": 43227799, "comment_id": 73525613, "body": "what this INT_MAX means, is that like a fixed value?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491386758, "post_id": 43227799, "comment_id": 73525882, "body": "Quite identical solutions ;) BTW why <code>&lt;=</code> ?? I think OP wants the smallest-s of the whole set, repeated numbers can be ignored, I guess."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491390099, "post_id": 43227799, "comment_id": 73528324, "body": "I believe it has to be <code>&lt;</code>only because if you type 2 times the same number, it will become smallest and second_smallest which is wrong I guess."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491399132, "post_id": 43227799, "comment_id": 73535366, "body": "@LPs Well, I assumed OP wanted to catch repeated numbers. Anyway, it doesn&#39;t matters whether the first if uses <code>&lt;=</code> or <code>&lt;</code>. Repeated numbers will be accepted in both cases. If repeated numbers is to be avoided both the first and the second <code>if</code> must be changed."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1491399269, "post_id": 43227799, "comment_id": 73535488, "body": "@SvenB - For INT_MAX see <a href=\"https://en.wikibooks.org/wiki/C_Programming/C_Reference/limits.h\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/C_Programming/C_Reference/limits.h</a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491399408, "post_id": 43227799, "comment_id": 73535611, "body": "@tilz0R - Changing <code>&lt;=</code> to <code>&lt;</code> does <b>not</b> avoid repeated smallest number. See my comment to LPs above."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491399540, "post_id": 43227799, "comment_id": 73535731, "body": "I don&#39;t understand. If I send 10, 10 in sequence, then <code>second_smallest = something; smallest = 10</code> and in next loop I enter this loop again and I have <code>second_smallest = 10, smallest = 10</code> So this is not ok?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491399709, "post_id": 43227799, "comment_id": 73535868, "body": "@tilz0R - It is not clear whether OP wants repeated numbers or not. My code allows repeated numbers. If you change <code>&lt;=</code> to <code>&lt;</code> it will **still accept` repeated numbers. It takes more than that to avoid repeated numbers."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491400561, "post_id": 43227799, "comment_id": 73536591, "body": "No, how can it accept. Imagine that <code>smallest = 10</code> and <code>previous_smallest = 11</code>: Sequence is <code>11, 10, 10</code>. When second <code>10</code> arrives, first <code>if</code>won&#39;t be executed."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491400751, "post_id": 43227799, "comment_id": 73536746, "body": "@tilz0R - You write: <code>When second 10 arrives, first ifwon&#39;t be executed</code> That is correct. But the <b>second <code>if</code> will execute</b> and then you&#39;ll have <code>10</code> for both <code>smallest</code> and <code>second_smallest</code>"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491400838, "post_id": 43227799, "comment_id": 73536843, "body": "What about this modification: change <code>else if (a &lt; second_smallest)</code> to <code>else if (a != smallest &amp;&amp; a &lt; second_smallest)</code> and remove <code>=</code>in first if."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491400998, "post_id": 43227799, "comment_id": 73536971, "body": "@tilz0R - With that update then repeated numbers are avoided. But my point was only that changing <code>&lt;=</code> to <code>&lt;</code> didn&#39;t."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491401018, "post_id": 43227799, "comment_id": 73536991, "body": "Yes, you are right."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1491386135, "creation_date": 1491386135, "answer_id": 43227799, "question_id": 43227502, "link": "https://stackoverflow.com/questions/43227502/i-have-to-find-two-smallest-numbers-without-arrays/43227799#43227799", "title": "I have to find two smallest numbers without arrays", "body": "<p>You need to add 2 variables to hold the smallest values detected so far. Like</p>\n\n<pre><code>int smallest = INT_MAX;\nint second_smallest = INT_MAX;\n</code></pre>\n\n<p>Then in the loop you need to test if the new input value is smaller than the values stored so far. Something like:</p>\n\n<pre><code>if (a &lt;= smallest)\n{\n    second_smallest = smallest;\n    smallest = a;\n}\nelse if (a &lt; second_smallest)\n{\n    second_smallest = a;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1491399533, "post_id": 43227921, "comment_id": 73535721, "body": "yep, Quite identical solutions ;) Also I&#39;ll +1 you for including stuff like <code>limits.h</code> and improved <code>scanf</code> handling"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1491386475, "creation_date": 1491386475, "answer_id": 43227921, "question_id": 43227502, "link": "https://stackoverflow.com/questions/43227502/i-have-to-find-two-smallest-numbers-without-arrays/43227921#43227921", "title": "I have to find two smallest numbers without arrays", "body": "<p>You can use two variables to do what you need</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void)\n{\n\n    int a = INT_MAX;\n    int min_1 = INT_MAX;\n    int min_2 = INT_MAX;\n\n    int valid;\n\n    do\n    {\n        if (a &lt; min_1)\n        {\n            min_2 = min_1;\n            min_1 = a;\n\n        }\n        else if (a &lt; min_2)\n        {\n            min_2 = a;\n        }\n\n        printf(\"Enter numbers: \");\n        valid = scanf(\"%d\", &amp;a);\n    }\n    while ((a != 0) &amp;&amp; (valid == 1));\n\n    if (valid == 1)\n    {\n        printf(\"Minimum numbers entered are: %d %d\\n\", min_1, min_2);\n    }\n    else\n    {\n        fprintf(stderr, \"Error in data input\\n\");\n    }\n}\n</code></pre>\n\n<p>So:</p>\n\n<ol>\n<li>use <code>limits.h</code> defines to init min variables to the highest value for <code>int</code> type <code>INT_MAX</code>. </li>\n<li>for each loop you must test if entered number is a minimum</li>\n<li>you must check that user input  is valid: check <code>scanf</code> return value.</li>\n<li>remove <code>\\n</code> in the format string of <code>scanf</code>.</li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "closed_date": 1491391252, "accepted_answer_id": 43227799, "answer_count": 2, "score": -1, "last_activity_date": 1491386842, "creation_date": 1491385403, "question_id": 43227502, "link": "https://stackoverflow.com/questions/43227502/i-have-to-find-two-smallest-numbers-without-arrays", "closed_reason": "Not suitable for this site", "title": "I have to find two smallest numbers without arrays", "body": "<p>So basicly I have this assignement in C, I have to input numbers until I enter 0, and after I enter 0 I have to print 1st and 2nd min number from all that numbers and I can't use arrays. I get that I have to use do-while loop for input but I can't figure out how to find two smallest from all of them. I think that thing can be done with if loops but don't know how to make it as I have only one variable to enter numbers into it (int a). And in input I have error when I enter 0 I'm able to enter one more number before program quits. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int main() {\n\n        int a;\n\n        do {\n            printf(\"Enter numbers: \");\n            scanf(\"%d\\n\", &amp;a);\n        //what to do here\n        }while(a != 0);\n</code></pre>\n"}, {"tags": ["c", "uint32", "uint32-t"], "comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1491384907, "post_id": 43227240, "comment_id": 73524438, "body": "The output of what code, exactly? Do you want to output a string, or an int? In other words: show us the code you have so far, if possible as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 1, "creation_date": 1491384931, "post_id": 43227240, "comment_id": 73524464, "body": "Are you saying that you want to shift the first value up 24 bits and the second value up 16 bits?  Even if that&#39;s what your asking, the displayed value would not be 1200 unless you are showing the hex value..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491384942, "post_id": 43227240, "comment_id": 73524473, "body": "What will the maximum (<i>and</i> minimum) values of e.g. <code>var1</code> and <code>var2</code> be? Will they always be in the range of a signed byte?"}, {"owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "edited": false, "score": 3, "creation_date": 1491384961, "post_id": 43227240, "comment_id": 73524485, "body": "an <code>int</code> is not 1 byte on most systems ..."}, {"owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "edited": false, "score": 0, "creation_date": 1491384999, "post_id": 43227240, "comment_id": 73524517, "body": "Well it is to write a file. So I&#39;m not sure if I should 1.) write var1 var2 0 0, or 2) I should combine them first and then write to the file."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1491385114, "post_id": 43227240, "comment_id": 73524590, "body": "And <code>1200</code> is not 4 bytes either. Is that an int, and you want the value 1000 + 200 (decimal), or a string with 4 characters, or hex 1200 or what exactly? Your question is not clear."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1491385169, "post_id": 43227240, "comment_id": 73524637, "body": "Combine how exactly? As string of x characters to a text file, or as bytes, combined in one way or another, to a binary file, or what? Please clarify."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1491385281, "post_id": 43227240, "comment_id": 73524737, "body": "In other words: try to realize what exactly you want to achieve. In that process, you may find an answer yourself. Most programming is exactly specifying what you want to do and then translating that into code."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1491385298, "post_id": 43227240, "comment_id": 73524750, "body": "You need to clarify for us the exact file format specifications"}, {"owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "edited": false, "score": 0, "creation_date": 1491385316, "post_id": 43227240, "comment_id": 73524762, "body": "Not as a string of characters. I need to store data blocks in a binary file like so &#39;var1 var2 0 0&#39;. I also need to be able to retrieve var1 &amp; var2. So, I&#39;m wondering what the best way to get this into a binary file is?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1491385412, "post_id": 43227240, "comment_id": 73524826, "body": "answer me this: do you think that the number 12345 (twelve thousands three hundred forty five) has 5 bytes?"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1491385470, "post_id": 43227240, "comment_id": 73524866, "body": "What do you mean with &quot;a data block like <code>var1 var2 0 0</code>&quot;? note that ints like var1 and var2 can have values well beyond 255, so how do you handle that? If you &quot;combine&quot; them, is the result little or big endian?"}, {"owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1491385500, "post_id": 43227240, "comment_id": 73524888, "body": "@RudyVelthuis sorry i should have said that the max value is 255"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1491385592, "post_id": 43227240, "comment_id": 73524967, "body": "Then write them as bytes. Or you can &quot;combine&quot; them by shifting the first value left by 24 and the second by 16 and then or-ing the results into a int, and then write that full int."}], "answers": [{"comments": [{"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1491387714, "post_id": 43227907, "comment_id": 73526520, "body": "There should be a couple of fputc(0, out); before the fclose(out); to completely answer the question (&quot; I&#39;d then fill the remaining space with 2 bytes of 0 padding.&quot;)"}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "reply_to_user": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "edited": false, "score": 0, "creation_date": 1491387738, "post_id": 43227907, "comment_id": 73526535, "body": "Note that an <code>int</code> can be &gt;255, and if you <code>fputc(256)</code> it will write <code>0</code>. @Alex - If your variables are meant to hold bytes, declare them as <code>byte</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1491391386, "post_id": 43227907, "comment_id": 73529244, "body": "@Neil True, that&#39;s pointless but what the OP wanted. I added them, thanks."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1491391369, "last_edit_date": 1491391369, "creation_date": 1491386443, "answer_id": 43227907, "question_id": 43227240, "link": "https://stackoverflow.com/questions/43227240/encode-and-combine-int-to-32bit-int-in-c-binary-file/43227907#43227907", "title": "Encode and combine int to 32bit int in C binary file", "body": "<p>There's no need to go the roundabout way of \"combining\" the values into an <code>uint32_t</code>. Binary files are streams of bytes, so writing single bytes is very possible:</p>\n\n<pre><code>FILE * const out = fopen(\"myfile.bin\", \"wb\");\nconst int val1 = 1;\nconst int val2 = 2;\nif(out != NULL)\n{\n  fputc(val1, out);\n  fputc(val2, out);\n  // Pad the file to four bytes, as originally requested. Not needed, though.\n  fputc(0, out);\n  fputc(0, out);\n  fclose(out);\n}\n</code></pre>\n\n<p>This uses <a href=\"https://linux.die.net/man/3/fputc\" rel=\"nofollow noreferrer\"><code>fputc()</code></a> to write single bytes to the file. It takes an integer argument for the value to write, but treats it as <code>unsigned char</code> internally, which is essentially \"a byte\".</p>\n\n<p>Reading back would be just as simple, using e.g. <code>fgetc()</code> to read out the two values, and of course checking for failure. You should check these writes too, I omitted it because error handling.</p>\n"}], "owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 43227907, "answer_count": 1, "score": -2, "last_activity_date": 1491391369, "creation_date": 1491384735, "question_id": 43227240, "link": "https://stackoverflow.com/questions/43227240/encode-and-combine-int-to-32bit-int-in-c-binary-file", "title": "Encode and combine int to 32bit int in C binary file", "body": "<p>Lets say I have 2 variables:</p>\n\n<pre><code>int var1 = 1; //1 byte\nint var2 = 2; //1 byte\n</code></pre>\n\n<p>I want to combine these and encode as a 32bit unsigned integer (uint32_t). By combining them, it would be 2 bytes. I'd then fill the remaining space with 2 bytes of 0 padding. This is to write to a file, hence the need for this specific type of encoding.</p>\n\n<p>So by combining the above example variables, the output I need is:</p>\n\n<pre><code>1200 //4 bytes\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 1, "user_id": 6554691, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258279597538496/picture?type=large", "display_name": "VIJ", "link": "https://stackoverflow.com/users/6554691/vij"}, "edited": false, "score": 0, "creation_date": 1491384150, "post_id": 43226797, "comment_id": 73523878, "body": "<code>gloBAL_a and  local_b</code>"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1491384249, "post_id": 43226797, "comment_id": 73523935, "body": "Probably nothing except a relative offset, or maybe sequence number, for the variable within the .o file."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1491384347, "creation_date": 1491384347, "answer_id": 43227094, "question_id": 43226797, "link": "https://stackoverflow.com/questions/43226797/want-to-understand-output-of-nm-for-static-variable-which-are-local-to-function/43227094#43227094", "title": "Want to understand output of nm for static variable which are local to function", "body": "<p>When you declare a variable at file scope, it will have an unique identifier <code>gloBAL_a</code>. But when you declare local static variable in local scope, it can use the same name as another variable allocated elsewhere.</p>\n\n<p>The compiler therefore uses something called \"name mangling\", to ensure that the variable name used internally is always unique. That is, it adds a dot and a serial number after the variable name.</p>\n\n<p>You could try to name both variables the same name and you should see the same kind of name mangling for both of them.</p>\n"}], "owner": {"reputation": 1, "user_id": 6554691, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258279597538496/picture?type=large", "display_name": "VIJ", "link": "https://stackoverflow.com/users/6554691/vij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491384347, "creation_date": 1491383643, "last_edit_date": 1491383854, "question_id": 43226797, "link": "https://stackoverflow.com/questions/43226797/want-to-understand-output-of-nm-for-static-variable-which-are-local-to-function", "title": "Want to understand output of nm for static variable which are local to function", "body": "<p>I declared two static variables. One is global and the other is local to a main function. After that I did <code>nm a.out</code></p>\n\n<p><strong>output:</strong></p>\n\n<pre><code>0000000000000000 l     O .data  0000000000000004 gloBAL_a   &lt;&lt;&lt;&lt;&lt; static outside main\n\n0000000000000004 l     O .data  0000000000000004 local_b.2127 &lt;&lt;&lt; static inside main\n</code></pre>\n\n<p>what does  .2127 mean ?</p>\n"}, {"tags": ["c", "command-line"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1491383729, "post_id": 43226779, "comment_id": 73523593, "body": "Use <code>strtod</code> and check the <code>*endptr</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1491383924, "post_id": 43226779, "comment_id": 73523721, "body": "The <a href=\"https://linux.die.net/man/3/strtol\" rel=\"nofollow noreferrer\">man page on GNU/Linux for strtol</a> has a (related) extended example."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491384008, "post_id": 43226779, "comment_id": 73523783, "body": "Also, <code>isdigit(atoi(argv[2]))</code> is wrong. That converts a string of characters into an integer, and then checks whether that integer is the code for a decimal digit, i.e. one of the values 48 to 57 inclusive, assuming ASCII. <code>isdigit(atof(argv[1]))</code> is incorrect for similar reasons, but involving <code>double</code> rather than <code>int</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491384462, "post_id": 43226779, "comment_id": 73524095, "body": "Also, the check <code>if (argc &gt;= 3)</code> is incorrect. It should be <code>if (argc != 3)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1491387360, "post_id": 43226863, "comment_id": 73526279, "body": "<code>if (end)</code> will always be true."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 2, "last_activity_date": 1491387428, "last_edit_date": 1491387428, "creation_date": 1491383818, "answer_id": 43226863, "question_id": 43226779, "link": "https://stackoverflow.com/questions/43226779/how-to-check-a-string-contains-a-valid-real-number/43226863#43226863", "title": "How to check a string contains a valid real number", "body": "<p><code>atof</code> does not return a status to indicate if the conversion was successful or not, you will need to use <code>strtod</code> for that. Check if <code>endptr</code> is <code>NULL</code> after it returns, also check for any overflow or underflow.</p>\n\n<pre><code>double strtod(const char *nptr, char **endptr);\n\nchar *end = NULL;\ndouble x0 = strtod(argv[1], &amp;end);\nif (*end) {\n      // error, not a valid floating point number\n}\nif (errno == ERANGE) {\n     // error, overflow or underflow\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 1, "last_activity_date": 1491387149, "creation_date": 1491387149, "answer_id": 43228178, "question_id": 43226779, "link": "https://stackoverflow.com/questions/43226779/how-to-check-a-string-contains-a-valid-real-number/43228178#43228178", "title": "How to check a string contains a valid real number", "body": "<p>The <code>strto...</code> family of functions such as <code>strtod</code> to convert a string to a <code>double</code> and <code>strtol</code> to convert a string to a <code>long int</code> can give you information about whereabouts in the string the conversion ended.</p>\n\n<p>If the string does not start with optional whitespace followed by a valid number, they will report the conversion ended at the beginning of the string.  Otherwise they will report the position of the character that caused the conversion to end.  So to check for error, check the position has \"moved on\" from the beginning of the string, and check the characters at the reported end position.</p>\n\n<p>The functions also check for out-of-range values, setting <code>errno</code> to <code>ERANGE</code> and returning specific values.</p>\n\n<p>The code below checks that the string ends with a null terminator after the number, but in some circumstances, for a string containing multiple separated values, you might want to check for a valid separation character.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char **argv)\n{\n    double x0;\n    long int N;\n    char *endptr;\n\n    if (argc != 3)\n    {\n        fprintf(stderr, \"usage: %s x0 N\\n\", argv[0]);\n        return 2;\n    }\n\n    errno = 0;\n    x0 = strtod(argv[1], &amp;endptr);\n    if (endptr == argv[1] || *endptr != '\\0')\n    {\n        fprintf(stderr, \"1st argument must be a real value\\n\");\n        return 2;\n    }\n    if (errno == ERANGE)\n    {\n        fprintf(stderr, \"1st argument out of range\\n\");\n        return 2;\n    }\n\n    errno = 0;\n    N = strtol(argv[2], &amp;endptr, 10);\n    if (endptr == argv[2] || *endptr != '\\0')\n    {\n        fprintf(stderr, \"2nd argument must be an integer value\\n\");\n        return 2;\n    }\n    if (errno == ERANGE)\n    {\n        fprintf(stderr, \"2nd argument out of range\\n\");\n        return 2;\n    }\n\n    printf(\"x0:%g; N:%ld\\n\", x0, N);\n    return 0;\n}\n</code></pre>\n\n<p>I changed the type of <code>N</code> to <code>long int</code> for convenience because there isn't a <code>strtoi</code> function that returns an <code>int</code>.</p>\n"}], "owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 43228178, "answer_count": 2, "score": 1, "last_activity_date": 1491387428, "creation_date": 1491383583, "last_edit_date": 1491384167, "question_id": 43226779, "link": "https://stackoverflow.com/questions/43226779/how-to-check-a-string-contains-a-valid-real-number", "title": "How to check a string contains a valid real number", "body": "<p>I need to check the 2nd command line argument to see if it's a valid floating point number.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nlong int fact(int n)\n{\n    if (n &gt;= 1)\n        return n*fact(n - 1);\n    else\n        return 1;\n}\n\ndouble func(int x0, int n)\n{\n    int p = 2 * n + 1;\n\n    return (double)pow(x0, p) / (double)fact(p);\n}\n\ndouble sinh_(int x0, int N)\n{\n    double sum = 0;\n    int i = 0;\n    for (i = 0; i &lt;= N; i++)\n    {\n        sum = sum + func(x0, i);\n    }\n\n    return sum;\n}\n\ndouble err(int x0, int N)\n{\n    return abs(sinh(x0) - sinh_(x0, N));\n}\n\nint main(int argc, char**argv)\n{\n    double x0 = 0;\n    int N = 0;\n\n    printf(\"No of args %d\\n\", argc);\n\n    //if CLA doesn't have exactly 4 arguments passed return -1\n    //1st argument is app-name\n    //2nd argument is x0\n    //4th argument is N\n    if (argc &gt;= 3)\n    {\n        printf(\"Err: no of arguments should be 2\");\n        return -1;\n    }\n    //if the 2nd CLA is not a number, return -1     \n    if (!isdigit(atof(argv[1])))\n    {\n        printf(\"1st argument must be a real value\");\n        return -1;\n    }\n    //if the 3rd CLA is not a number, return -1     \n    if (!isdigit(atoi(argv[2])))\n    {\n        printf(\"2nd argument must be an int value\");\n        return -1;\n    }\n\n    x0 = atof(argv[1]);\n    N = atoi(argv[2]);\n\n    printf(\"Builtin sinh = %f\", sinh(x0));\n    printf(\"Approx sinh = %f\", sinh_(x0, N));\n    printf(\"Err value = %f\", err(x0, N));\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1491382533, "post_id": 43226374, "comment_id": 73522745, "body": "Read a basic C book, please. <code>*c_ptr</code> != <code>c_ptr</code>, to start with."}, {"owner": {"reputation": 3416, "user_id": 2484972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea1c4b2c5aa3c7da2f2740bc1a643ee0?s=128&d=identicon&r=PG", "display_name": "Tatsuyuki Ishi", "link": "https://stackoverflow.com/users/2484972/tatsuyuki-ishi"}, "edited": false, "score": 0, "creation_date": 1491382658, "post_id": 43226374, "comment_id": 73522845, "body": "Read the warning. It&#39;s casting pointer-&gt;int-&gt;char."}, {"owner": {"reputation": 105, "user_id": 1639620, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o5pr6.png?s=128&g=1", "display_name": "Idan Banani", "link": "https://stackoverflow.com/users/1639620/idan-banani"}, "edited": false, "score": 0, "creation_date": 1491382839, "post_id": 43226374, "comment_id": 73522983, "body": "Why would I want to change where it points to? it&#39;s a constant pointer..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1491383054, "post_id": 43226374, "comment_id": 73523135, "body": "If the address held within the pointer cannot change (because the pointer is <code>const</code>), and said-address points to read only data (you first read-only string literal), you&#39;re not going to be legally changing <i>anything</i>. So the answer is, you can&#39;t get there from here."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1491383212, "post_id": 43226374, "comment_id": 73523240, "body": "So you want to change the contents, e.g. <code>*c_ptr=&#39;h&#39;;</code>, or <code>strcpy(c_ptr, &quot;hsdsdsd&quot;);</code>. That is also illegal in this case because <code>c_ptr</code> is currently pointing to a string literal, and storage for string literals is immutable. You could do it like this: <code>char c[] = &quot;firstvalue&quot;; char * const c_ptr = c; strcpy(c_ptr, &quot;hsdsdsd&quot;);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 1639620, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o5pr6.png?s=128&g=1", "display_name": "Idan Banani", "link": "https://stackoverflow.com/users/1639620/idan-banani"}, "edited": false, "score": 0, "creation_date": 1491384972, "post_id": 43226599, "comment_id": 73524494, "body": "Is the readonly memory section part of the stack?.  When we get out of the scope where the immutable string literal declared , does the memory it occupied turns reusable (statically allocateable) again? , or all the readonly data is set only at compilation time/beginning of execution"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 105, "user_id": 1639620, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o5pr6.png?s=128&g=1", "display_name": "Idan Banani", "link": "https://stackoverflow.com/users/1639620/idan-banani"}, "edited": false, "score": 1, "creation_date": 1491385127, "post_id": 43226599, "comment_id": 73524604, "body": "@IdanBanani There is no concept of &quot;stack&quot; required by C. And string literals have <code>static</code> storage, they don&#39;t go out of scope."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 105, "user_id": 1639620, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o5pr6.png?s=128&g=1", "display_name": "Idan Banani", "link": "https://stackoverflow.com/users/1639620/idan-banani"}, "edited": false, "score": 1, "creation_date": 1491385189, "post_id": 43226599, "comment_id": 73524657, "body": "@IdanBanani It is not a part of the stack. When the function returns it does not get popped out, but the pointer itself is on the stacked and got popped out."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 1, "last_activity_date": 1491385378, "last_edit_date": 1491385378, "creation_date": 1491383095, "answer_id": 43226599, "question_id": 43226374, "link": "https://stackoverflow.com/questions/43226374/how-to-change-content-of-char-const-after-it-has-been-set-c/43226599#43226599", "title": "How to change content of char * const after it has been set (C)", "body": "<p>First, C strings are null terminated char arrays, and you cannot assign arrays, you have to change each element of it.</p>\n\n<p>Also, generally the compiler put string literals like <code>\"firstValue\"</code> into a readonly memory section, so you cannot change it, you will have to use a char array to initialize the string.</p>\n\n<pre><code>char s[] = \"firstValue\";\nconst char*const ptr = s;\nptr[0] = 'z';  // change contents pointed by ptr, or:\nstrncpy(ptr, \"abc\", 3);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491383348, "post_id": 43226605, "comment_id": 73523333, "body": "Is the standard not being changed to make string literals to be of type const char* solely for legacy code reasons?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491385052, "post_id": 43226605, "comment_id": 73524544, "body": "@AjayBrahmakshatriya No, I don&#39;t think so."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491385299, "post_id": 43226605, "comment_id": 73524751, "body": "@AjayBrahmakshatriya Mostly it is not changed because the C committee is painfully conservative and would hate to improve the language. C++ changed it long time ago and it did not cause any major issues even for legacy code. This is because old rotten legacy code will be compiled with old rotten legacy compilers, and not with the latest and greatest standard-compliant compiler. So changes in a standard does not have nearly as much impact on old code as they fear."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491385418, "post_id": 43226605, "comment_id": 73524828, "body": "@Lundin would this change cascade into other changes being required? Any particular example?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491385665, "post_id": 43226605, "comment_id": 73525031, "body": "@AjayBrahmakshatriya Not really. The standard library is already using const correctness. It would mean that sloppily-written code such as <code>void print (char* str) {puts (str); }... print(&quot;hello&quot;);</code> would have to be rewritten, since it is not const-correct. Also there is old rotten code which is actually abusing the fact that string literals were writeable on old systems like MS DOS. But the C standard has never claimed that string literals would be writeable, so this should be of no concern to C."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1491383111, "creation_date": 1491383111, "answer_id": 43226605, "question_id": 43226374, "link": "https://stackoverflow.com/questions/43226374/how-to-change-content-of-char-const-after-it-has-been-set-c/43226605#43226605", "title": "How to change content of char * const after it has been set (C)", "body": "<p>Well, the data that the pointer points at can change for a constant pointer, but not when you initialize it using a string literal. They have the rather curious property of having type <code>char *</code>, but being unable to change.</p>\n\n<p>So, you can do:</p>\n\n<pre><code>char data[10] = \"foobar\";\nchar * const ptr = data;\n\nprintf(\"%s\\n\", ptr);  // prints foobar\n*ptr = 'z';\nprintf(\"%s\\n\", ptr);  // prints zoobar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491384957, "creation_date": 1491384957, "answer_id": 43227331, "question_id": 43226374, "link": "https://stackoverflow.com/questions/43226374/how-to-change-content-of-char-const-after-it-has-been-set-c/43227331#43227331", "title": "How to change content of char * const after it has been set (C)", "body": "<p><code>char * const c_ptr</code> means a non-const pointer to const data. Meaning that you made the pointer variable itself read-only, but not the pointed-at data.</p>\n\n<p>If you do <code>*c_ptr = 'a'</code> then the compiler wouldn't prevent it, because you told it that the pointed-at data is read/write. Which isn't true in this case, it is a string literal and writing to it will cause <em>undefined behavior</em>, which is why you get a crash. </p>\n\n<p>C11 6.4.5/7</p>\n\n<blockquote>\n  <p>If the program attempts to modify such an array, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>Fix the code by changing the declaration to <code>const char* c_ptr</code>.<br>\nOr alternatively <code>const char* const c_ptr</code>.</p>\n\n<p>Now as it turns out, this <em>is</em> immutable, because if you would now attempt <code>strcpy(c_ptr, \"str\")</code> you would get an invalid pointer conversion, since the function expects a <code>char*</code>.</p>\n\n<hr>\n\n<p><code>*c_ptr=\"hsdsdsd\";</code> is nonsense and will not compile on a compliant C compiler, because you try to assign an address to a single <code>char</code> variable, which is not allowed. (A constraint violation of the simple assignment rules).</p>\n"}], "owner": {"reputation": 105, "user_id": 1639620, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o5pr6.png?s=128&g=1", "display_name": "Idan Banani", "link": "https://stackoverflow.com/users/1639620/idan-banani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 1, "accepted_answer_id": 43226605, "answer_count": 3, "score": 1, "last_activity_date": 1491385909, "creation_date": 1491382433, "last_edit_date": 1491385909, "question_id": 43226374, "link": "https://stackoverflow.com/questions/43226374/how-to-change-content-of-char-const-after-it-has-been-set-c", "title": "How to change content of char * const after it has been set (C)", "body": "<p>We are dealing with a constant pointer,\nso the address it holds cannot change.\nBut the content of that referenced memory address is supposed to be mutable...</p>\n\n<p>Still,I get compilation/segmentation fault errors when trying to do so.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char * const c_ptr = \"firstValue\"; // now c_ptr is a const ptr to an immutable string literal, \n                                     //we can't change it unless we declare char [] instead \n    printf(\"%s\",c_ptr);\n\n    *c_ptr=\"hsdsdsd\"; // better to use strcpy(c_ptr, \"hsdsdsd\");   \n\n    printf(\"%s\",c_ptr);\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>main.c: In function 'main':<br>\n  main.c:8:8: warning: assignment makes integer from pointer without a cast [enabled by default]<br>\n    *c_ptr=\"hsdsdsd\";   </p>\n  \n  <p>Segmentation fault (core dumped)     </p>\n</blockquote>\n"}, {"tags": ["c", "kernel"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491382225, "post_id": 43226207, "comment_id": 73522529, "body": "Are you sure it is C++ or C? Anyway, assuming this is Linux kernel, float point operations are not supported. You can perform your operations in int or long long if the precision required in fixed."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491382389, "post_id": 43226207, "comment_id": 73522643, "body": "@AjayBrahmakshatriya: The Linux kernel doesn&#39;t support &quot;hard&quot; float, i.e. hardware-supported floating point. But especially for ARM, compilers are often capable of &quot;soft&quot; floating point, using library support. That&#39;s transparent to the CPU and thus to the kernel."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3731418"}, "edited": false, "score": 2, "creation_date": 1491382665, "post_id": 43226207, "comment_id": 73522848, "body": "Your compiler compiles your program as if it was regular user space program. Since you (probably) have no standard C library for your kernel mode program it is missing some symbols. One solution to that is to avoid using floats and doubles. In many cases it&#39;s possible to use integer or fixed point arithmetic instead. You can define <code>_fltused</code> as <code>extern &quot;C&quot; { unsigned int _fltused = 1; }</code> (you may have to experiment with the exact type) but you&#39;ll probably be getting more missing symbols when you write more code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3904909"}, "edited": false, "score": 0, "creation_date": 1491383109, "post_id": 43226207, "comment_id": 73523168, "body": "Thank you for your fast help! It&#39;s a C application, i&#39;m sorry. I started with C++ in this project, then moved to C. The kernel is Windows based.   And <code>extern &quot;C&quot; { unsigned int _fltused = 1; }</code> worked fine for me! Thank you all!"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1491384638, "post_id": 43226207, "comment_id": 73524240, "body": "&quot;The kernel is Windows based.&quot; ?? Kernel-mode WDM drivers for Windows must follow certain guidelines when using floating-point operations. These differ between x86 and x64 systems. By default, Windows turns off arithmetic exceptions for both systems.  This page: <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff565388(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/hardware/&hellip;</a> might give some hints."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491401514, "post_id": 43226207, "comment_id": 73537428, "body": "besides the lack of float support,  this statement: <code>float test = 1.2;</code> is trying to assign a <code>double</code> value into a <code>float</code> variable..  It is highly likely that <code>double</code> is also not supported in the kernel.  If <code>float</code> were supported, then the line should read: <code>float test = 1.2f;</code>  Note the trailing <code>f</code> on the literal"}], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 2, "last_activity_date": 1491382246, "creation_date": 1491382246, "answer_id": 43226310, "question_id": 43226207, "link": "https://stackoverflow.com/questions/43226207/c-kernel-mode-ring0-float-double-values/43226310#43226310", "title": "C Kernel Mode/ring0 - float/double values", "body": "<p>Your compiler inserts a dependency on <code>_fltused</code> to force you to link with a float support library. Do you have such a library capable of running in ring0? </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3904909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491383580, "creation_date": 1491381932, "last_edit_date": 1491383580, "question_id": 43226207, "link": "https://stackoverflow.com/questions/43226207/c-kernel-mode-ring0-float-double-values", "title": "C Kernel Mode/ring0 - float/double values", "body": "<p>I'm trying to use float or double values in my ring0 c application, but im getting the Linker ERRORs:</p>\n\n<p>Fehler  LNK1120 1 nicht aufgel\u00f6ste Externe</p>\n\n<p>Fehler  LNK2001 Nicht aufgel\u00f6stes externes Symbol \"_fltused\".</p>\n\n<pre><code>float test = 1.2;\n</code></pre>\n\n<p>How can i solve this error?</p>\n"}, {"tags": ["c", "gtk3"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491381827, "post_id": 43226159, "comment_id": 73522273, "body": "<code>will not compile</code>...how do you know?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1491382015, "post_id": 43226159, "comment_id": 73522392, "body": "If you ask questions about build errors, then please copy-paste the full build log (as text) into the body of the question. Then mark out which lines of code the errors are on, for example with comments in the code."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1491382134, "post_id": 43226159, "comment_id": 73522475, "body": "@Jean-Fran&#231;oisFabre So, you&#39;re saying, if I say, <i>I will go</i>, that also means <i>I don&#39;t want to go</i>? :("}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1491382232, "post_id": 43226159, "comment_id": 73522536, "body": "@Jean-Fran&#231;oisFabre Ahh.. got it, you meant &quot;will not&quot; == &quot;doesn&#39;t want to&quot;, right?"}, {"owner": {"reputation": 99, "user_id": 7579186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dcd098a0501ec4f902fc4792870bf9b?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/7579186/markus"}, "edited": false, "score": 2, "creation_date": 1491382574, "post_id": 43226159, "comment_id": 73522777, "body": "It&#39;s probably because update_label expects a GtkLabel* but you supply a GtkWidget*"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491384447, "post_id": 43226159, "comment_id": 73524080, "body": "@SouravGhosh yes, of course. Sorry."}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1491385384, "post_id": 43226159, "comment_id": 73524808, "body": "You&#39;ve a typo in your code, you intended your <code>lbl</code> to be of type <code>GtkLabel *</code> but typed it out as <code>GtkWidget *</code>"}], "answers": [{"tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": true, "score": 0, "last_activity_date": 1491385838, "creation_date": 1491385838, "answer_id": 43227683, "question_id": 43226159, "link": "https://stackoverflow.com/questions/43226159/c-and-gtk-passing-parameters/43227683#43227683", "title": "C and GTK Passing parameters", "body": "<p>You declare <code>update_label</code> as accepting <code>GtkLabel*</code> argument:</p>\n\n<pre><code>void update_label(GtkLabel *glab);\n</code></pre>\n\n<p>On the other hand, you pass it argument <code>lbl</code> which is of type <code>GtkWidget*</code>:</p>\n\n<pre><code>GtkWidget *lbl;\n(...)\nupdate_label(lbl);\n</code></pre>\n\n<p>That's why compiler raises error <em>\"passing argument 1 of \u2018update_label\u2019 from incompatible pointer type\"</em>, and even explains it further:</p>\n\n<pre><code>my04.c:5:6: note: expected \u2018struct GtkLabel *\u2019 but argument is of type \u2018struct GtkWidget *\u2019\n void update_label(GtkLabel *glab)\n</code></pre>\n\n<p>To solve this, you have to upcast <code>lbl</code> to <code>GtkLabel*</code>, as that variable points to object which is really a <code>GtkLabel</code>:</p>\n\n<pre><code>update_label(GTK_LABEL(lbl));\n</code></pre>\n\n<p><a href=\"https://developer.gnome.org/gobject/stable/gtype-conventions.html\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gobject/stable/gtype-conventions.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1491387690, "creation_date": 1491387690, "answer_id": 43228375, "question_id": 43226159, "link": "https://stackoverflow.com/questions/43226159/c-and-gtk-passing-parameters/43228375#43228375", "title": "C and GTK Passing parameters", "body": "<p>For GTK in C you need a lot of pointer conversions.\nFor some reason all creator functions return <code>GtkWidget*</code> but all the related modifier functions require proper pointers to <code>GtkLabel*</code> etc..</p>\n\n<p>For this purpose GTK provides typecast macros.</p>\n\n<p>You can use <code>GTK_LABEL()</code> macro to convert your pointer.\nFor other types of widgets you have <code>GTK_WINDOW</code>, <code>GTK_MENU_ITEM</code> and much more such macros.</p>\n\n<p>This is rather annyoing in first place.</p>\n\n<p>When it comes to functions from an interface or from parent object \"class\" (not really OO classes) you need to pick the correct type and cast apropriately anyway.</p>\n"}], "owner": {"reputation": 211, "user_id": 4910176, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-LY2kLX49E24/AAAAAAAAAAI/AAAAAAAAAHo/0YkFkiptFj8/photo.jpg?sz=128", "display_name": "Graeme Jensz", "link": "https://stackoverflow.com/users/4910176/graeme-jensz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "closed_date": 1491413251, "accepted_answer_id": 43227683, "answer_count": 2, "score": 0, "last_activity_date": 1491387690, "creation_date": 1491381752, "last_edit_date": 1491385283, "question_id": 43226159, "link": "https://stackoverflow.com/questions/43226159/c-and-gtk-passing-parameters", "closed_reason": "Duplicate", "title": "C and GTK Passing parameters", "body": "<p>The following program will not compile. I've reduced the code down to this simple program. I've posted the compile command and its output.</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nvoid update_label(GtkLabel *glab);\n\nvoid update_label(GtkLabel *glab)\n{\n}\n\nint main(int argc, char *argv[])\n{\n  GtkWidget *lbl;\n\n  gtk_init(&amp;argc, &amp;argv);\n\n  lbl = gtk_label_new(\"Hi\");\n\n  update_label(lbl);\n\n  gtk_main();\n\n  return 0;\n}\n</code></pre>\n\n<p>The compiler output is:</p>\n\n<pre><code>graeme@graeme-HP-xw4300-Workstation ~/c/label $ gcc `pkg-config --cflags gtk+-3.0` my04.c -o my04 `pkg-config --libs gtk+-3.0`\nmy04.c: In function \u2018main\u2019:\nmy04.c:17:3: warning: passing argument 1 of \u2018update_label\u2019 from incompatible pointer type [enabled by default]\n   update_label(lbl);\n   ^\nmy04.c:5:6: note: expected \u2018struct GtkLabel *\u2019 but argument is of type \u2018struct GtkWidget *\u2019\n void update_label(GtkLabel *glab)\n      ^\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "save", "load"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491381434, "post_id": 43225988, "comment_id": 73522018, "body": "Sorry, but I don;t see any function call ..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1491381468, "post_id": 43225988, "comment_id": 73522037, "body": "Time to learn <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491381494, "post_id": 43225988, "comment_id": 73522056, "body": "Welcome to Stack Overflow! You mind creating a <a href=\"http://stackoverflow.com/help/mcve\"><b><i>MCVE</i></b></a>?"}], "owner": {"reputation": 27, "user_id": 7819147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f39d54c30597aec5ef7f221fd5cb645c?s=128&d=identicon&r=PG&f=1", "display_name": "Conflate", "link": "https://stackoverflow.com/users/7819147/conflate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491386003, "creation_date": 1491381299, "last_edit_date": 1491386003, "question_id": 43225988, "link": "https://stackoverflow.com/questions/43225988/loading-an-array-with-length-0-in-c", "title": "Loading an array with length 0 in C", "body": "<p>I keep receiving this error whenever the load function encounters a case where the length of the array is 0. I would really appreciate any help in resolving this issue! The code and error received respectively are: </p>\n\n<pre><code>/*\nSave the entire array ia into a file called 'filename' in a JSON\ntext file array file format that can be loaded by\nintarr_load_json(). Returns zero on success, or a non-zero error\ncode on failure. Arrays of length 0 should produce an output file\ncontaining an empty array.\n\nThe JSON output should be human-readable.\n\nExamples:\n\nThe following line is a valid JSON array:\n [ 100, 200, 300 ]\n\nThe following lines are a valid JSON array:\n[\n100,\n200,\n300\n]\n*/ \n\nint intarr_save_json( intarr_t* ia, const char* filename )\n{\n    if (ia == NULL)  {\n        return 1;\n    }\n    int *arr=ia-&gt;data;\n    if (arr == NULL) { \n        return 1;\n    }\n    int n=ia-&gt;len;\n    if (n == 0 ) {\n        return 0;\n    }\n    int i;\n    FILE *p;\n    p=fopen(filename,\"w\");\n\n    if(p!=NULL)\n    {\n        fprintf(p,\"[\\n\");\n        for(i=0;i&lt;n;i++)\n        {\n            if(i!=n-1)\n            {\n                fprintf(p,\" %d,\\n\",arr[i]);\n            }\n            else\n            {\n                fprintf(p,\" %d\\n\",arr[i]);\n            }\n        }\n        fprintf(p,\"]\");\n        fclose(p);\n        return 0;\n    }\n    return 1;\n}\n\n/*\nLoad a new array from the file called 'filename', that was\npreviously saved using intarr_save(). The file may contain an array\nof length 0. Returns a pointer to a newly-allocated intarr_t on\nsuccess (even if that array has length 0), or NULL on failure.\n*/\n\nintarr_t* intarr_load_json( const char* filename ){ \n    if (filename == NULL) { \n        return NULL;\n    }\n    FILE* f = fopen(filename, \"r\");\n    if (f == NULL) { \n        return NULL;\n    }\n\n    intarr_t* loaded = intarr_create(0);\n\n    char c;\n    fscanf(f, \"%c \", &amp;c);\n\n    int value;\n    while (fscanf(f, \"%d, \", &amp;value)) {\n        intarr_push(loaded, value);\n    }\n    if (fscanf(f, \"%d \", &amp;value)){\n        intarr_push(loaded, value);\n    }\n\n    fclose(f);\n    return loaded;\n}\n</code></pre>\n\n<hr>\n\n<p>Error Received: </p>\n\n<pre>\nSaving array len 0: intarr_save_json( 0x1277010, \"saved_array.0\" )\n    Loading array intarr_load_json( \"saved_array.0\" )\n    Error: intarr_load_json() returned NULL pointer.\n</pre>\n"}, {"tags": ["c", "user-interface", "gtk"], "comments": [{"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "edited": false, "score": 1, "creation_date": 1491383237, "post_id": 43225956, "comment_id": 73523264, "body": "Is there something wrong with <code>gdk_monitor_get_geometry()</code> and <code>gdk_monitor_get_workarea()</code>?"}, {"owner": {"reputation": 41, "user_id": 6447030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ddeff5d132061c1c7e4ae368dedbc1?s=128&d=identicon&r=PG&f=1", "display_name": "T. Gros", "link": "https://stackoverflow.com/users/6447030/t-gros"}, "reply_to_user": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "edited": false, "score": 0, "creation_date": 1491384730, "post_id": 43225956, "comment_id": 73524312, "body": "Should I do something like that :  <code>display = gdk_display_get_default();  monitor = gdk_display_get_monitor(display, 0);  gdk_monitor_get_geometry(monitor, &amp;r);</code>  Doing so returns me 0, 0 in the r variable."}, {"owner": {"reputation": 543, "user_id": 3587570, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001071662888/picture?type=large", "display_name": "Valy", "link": "https://stackoverflow.com/users/3587570/valy"}, "edited": false, "score": 0, "creation_date": 1491389481, "post_id": 43225956, "comment_id": 73527823, "body": "You could use functions from another API to get the size of the screen (like <code>GetSystemMetrics</code> on Windows). You want to do this specifically  with functions from Gtk?"}, {"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "edited": false, "score": 0, "creation_date": 1491389775, "post_id": 43225956, "comment_id": 73528050, "body": "@T.Gros that looks ok. Can you show the actual code that gives you &quot;0, 0&quot;?"}, {"owner": {"reputation": 41, "user_id": 6447030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ddeff5d132061c1c7e4ae368dedbc1?s=128&d=identicon&r=PG&f=1", "display_name": "T. Gros", "link": "https://stackoverflow.com/users/6447030/t-gros"}, "edited": false, "score": 0, "creation_date": 1491389826, "post_id": 43225956, "comment_id": 73528094, "body": "I don&#39;t want to use Gtk functions specifically, but I would like something that works in a cross-platform application. Since I&#39;m using Gtk, I think it could be easier no? (I&#39;m working on a MacOS / Unix environment, by the way)."}, {"owner": {"reputation": 41, "user_id": 6447030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ddeff5d132061c1c7e4ae368dedbc1?s=128&d=identicon&r=PG&f=1", "display_name": "T. Gros", "link": "https://stackoverflow.com/users/6447030/t-gros"}, "reply_to_user": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "edited": false, "score": 1, "creation_date": 1491390604, "post_id": 43225956, "comment_id": 73528688, "body": "@jku All right, I&#39;m just an idiot. I was printing the x and y values instead of width and height, for the GtkRectangle...Thank you very much for your answer!"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10714074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f54b504d5b437839bb5339a6980f3134?s=128&d=identicon&r=PG&f=1", "display_name": "David Ramsay", "link": "https://stackoverflow.com/users/10714074/david-ramsay"}, "is_accepted": false, "score": 3, "last_activity_date": 1543360324, "last_edit_date": 1543360324, "creation_date": 1543357716, "answer_id": 53509211, "question_id": 43225956, "link": "https://stackoverflow.com/questions/43225956/how-to-get-the-size-of-the-screen-with-gtk/53509211#53509211", "title": "How to get the size of the screen with Gtk?", "body": "<p>I have to work out aspect ratio's per monitor however - \nGtk+ Functions Depreciate So Fast: but ended up with this:</p>\n\n<pre><code>GdkRectangle workarea = {0};\ngdk_monitor_get_workarea(\n    gdk_display_get_primary_monitor(gdk_display_get_default()),\n    &amp;workarea);\n\nprintf (\"W: %u x H:%u\\n\", workarea.width, workarea.height);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 14454736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343594d89c4fde137bbea7e3c69883a2?s=128&d=identicon&r=PG", "display_name": "Brian Bennett", "link": "https://stackoverflow.com/users/14454736/brian-bennett"}, "edited": false, "score": 0, "creation_date": 1602753685, "post_id": 64368283, "comment_id": 113821940, "body": "I have only just started with Gtk in Julia, but have wangled this one out. Please comment should it have unseen errors."}, {"owner": {"reputation": 3236, "user_id": 4294399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97f2d5c622f069ac28762c6a8250e93?s=128&d=identicon&r=PG", "display_name": "Calculuswhiz", "link": "https://stackoverflow.com/users/4294399/calculuswhiz"}, "edited": false, "score": 1, "creation_date": 1602762215, "post_id": 64368283, "comment_id": 113825812, "body": "I don&#39;t know Julia, but should the last paren be closed?"}], "tags": [], "owner": {"reputation": 1, "user_id": 14454736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343594d89c4fde137bbea7e3c69883a2?s=128&d=identicon&r=PG", "display_name": "Brian Bennett", "link": "https://stackoverflow.com/users/14454736/brian-bennett"}, "is_accepted": false, "score": -1, "last_activity_date": 1602753465, "last_edit_date": 1602753465, "creation_date": 1602752931, "answer_id": 64368283, "question_id": 43225956, "link": "https://stackoverflow.com/questions/43225956/how-to-get-the-size-of-the-screen-with-gtk/64368283#64368283", "title": "How to get the size of the screen with Gtk?", "body": "<pre><code>using Gtk\nwin = GtkWindow()\nmaximize(win)\nsleep(0.1)\nwindow = GtkWindow(&quot;Title&quot;, width(win), height(win))\ndestroy(win)\nmaximize(window)\n\nscreen size : width(win), height(win\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6447030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24ddeff5d132061c1c7e4ae368dedbc1?s=128&d=identicon&r=PG&f=1", "display_name": "T. Gros", "link": "https://stackoverflow.com/users/6447030/t-gros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4877, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1602753465, "creation_date": 1491381202, "question_id": 43225956, "link": "https://stackoverflow.com/questions/43225956/how-to-get-the-size-of-the-screen-with-gtk", "title": "How to get the size of the screen with Gtk?", "body": "<p>I'm trying to get the size of the monitor with a C Gtk program.</p>\n\n<p>I saw this version, but these functions are deprecated since Gtk 3.22:</p>\n\n<pre><code>gint width  = gdk_screen_width();\ngint height = gdk_screen_height();\n</code></pre>\n\n<p>In the GdkScreen documentation, I only found: \"Use per-monitor information\".</p>\n\n<p>I tried to find any information about that in the GdkMonitor or GdkDisplay documentation, but had no success.</p>\n\n<p>The only similar function is:</p>\n\n<pre><code>int gdk_monitor_get_width_mm (GdkMonitor *monitor);\n</code></pre>\n\n<p>But it's not what I am looking for.</p>\n\n<p>Does anyone have an idea on how can I get these informations?</p>\n"}, {"tags": ["c", "qt", "valgrind"], "comments": [{"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 1, "creation_date": 1491461924, "post_id": 43225849, "comment_id": 73565033, "body": "Do you really need to build yourself? What&#39;s wrong with the version that comes with the OS? It&#39;s at 2.0.0 if you&#39;re on Ubuntu 16.04: <code>sudo apt install valkyrie</code>."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 6426003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209523698229401/picture?type=large", "display_name": "Simon Pickup", "link": "https://stackoverflow.com/users/6426003/simon-pickup"}, "edited": false, "score": 0, "creation_date": 1529594942, "post_id": 44509926, "comment_id": 88940967, "body": "On RHEL 7.4 I found that adding unistd.h only to each of the three files was sufficient."}], "tags": [], "owner": {"reputation": 21, "user_id": 7644448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0eb1d6ce31a78d21fe348025a6296d?s=128&d=identicon&r=PG&f=1", "display_name": "KJS", "link": "https://stackoverflow.com/users/7644448/kjs"}, "is_accepted": false, "score": 2, "last_activity_date": 1529648294, "last_edit_date": 1529648294, "creation_date": 1497308589, "answer_id": 44509926, "question_id": 43225849, "link": "https://stackoverflow.com/questions/43225849/tried-to-compile-valkyriegui-for-valgrind-and-it-throws-an-error/44509926#44509926", "title": "Tried to compile valkyrie(GUI for valgrind) and it throws an error:", "body": "<p>I encountered the same issue on a standard RHEL 7.1 (3.10.0-229.el7.x86_64) system.  Since this system doesn't have RH subscription to allow using yum, I had to resort to downloading the .bz2 and building it myself.  Here's how I worked around the compiler errors. </p>\n\n<p>Issue #1: objects/tool_object.cpp:392:42: error: ?usleep? was not declared in this scope.\nFix #1: Add <code>#include &lt;unistd.h&gt;</code> to that source</p>\n\n<p>Issue #2: utils/vk_config.cpp:125:25: error: ?getuid? was not declared in this scope\nFix #2: Add <code>#include &lt;unistd.h&gt;</code> and <code>#include &lt;sys/types.h&gt;</code> to the source.</p>\n\n<p>Issue #3: utils/vk_utils.cpp:54:83: error: ?getpid? was not declared in this scope.\nFix #3: Add <code>#include &lt;unistd.h&gt;</code> and <code>#include &lt;sys/types.h&gt;</code> to the source.</p>\n\n<p>With those fixes in place I followed the steps in the \"INSTALL\" file and now Valkyrie (v2.0.0) + Valgrind (v3.12.0) are working fine together.</p>\n"}], "owner": {"reputation": 21, "user_id": 5655266, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646050128989838/picture?type=large", "display_name": "Isa Issa", "link": "https://stackoverflow.com/users/5655266/isa-issa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529648294, "creation_date": 1491380885, "last_edit_date": 1491386334, "question_id": 43225849, "link": "https://stackoverflow.com/questions/43225849/tried-to-compile-valkyriegui-for-valgrind-and-it-throws-an-error", "title": "Tried to compile valkyrie(GUI for valgrind) and it throws an error:", "body": "<p>Tried to compile valkyrie(valgrind GUI) and it throws an error. \nSteps:</p>\n\n<ol>\n<li><p>Download valkyrie 2.0.0 from valgrind website</p></li>\n<li><p>After untar I followed the instructions under INSTALL file:</p></li>\n<li><p>stillstoned@stillstoned ~/Downloads/valkyrie-2.0.0/src $ qmake-qt4 PREFIX=/opt</p></li>\n</ol>\n\n<blockquote>\n<pre><code>stillstoned@stillstoned ~/Downloads/valkyrie-2.0.0/src $ make\ncompiling objects/tool_object.cpp\n\n\nobjects/tool_object.cpp: In member function \u2018bool ToolObject::startProcess(QStringList)\u2019:\n\nobjects/tool_object.cpp:391:42: error: \u2018usleep\u2019 was not declared in this scope\n       usleep( WAIT_VG_START_SLEEP * 1000 );\n                                          ^\n\nobjects/tool_object.cpp: In member function \u2018void ToolObject::stopProcess()\u2019:\n\nobjects/tool_object.cpp:474:42: error: \u2018usleep\u2019 was not declared in this scope\n             usleep( 1000 * sleepDuration );\n                                          ^\nmake: *** [Makefile:627: obj/tool_object.o] Error 1\nstillstoned@stillstoned ~/Downloads/valkyrie-2.0.0/src $\n</code></pre>\n</blockquote>\n\n<p>Do you have any idea on this?\nThanks!!! I appreciate all your answers.</p>\n"}, {"tags": ["c++", "c", "checksum", "ipv4"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1491380541, "post_id": 43225466, "comment_id": 73521347, "body": "You have a buffer which holds 20 elements of type <code>unsigned short</code>. But a single <code>unsigned short</code> takes 2 elements of it? Shouldn&#39;t your buffer be of type <code>unsigned char</code>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1491380668, "post_id": 43225466, "comment_id": 73521429, "body": "Not to mention that you have tons of invalid tokens. <code>4E</code> or <code>0A</code> are not valid tokens. You need <code>0x4E</code>, <code>0x0A</code>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 776, "user_id": 2986042, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bddc199a94ba0624f39a3820943d8a32?s=128&d=identicon&r=PG&f=1", "display_name": "user2986042", "link": "https://stackoverflow.com/users/2986042/user2986042"}, "edited": false, "score": 0, "creation_date": 1491558798, "post_id": 43225654, "comment_id": 73618047, "body": "Thanks . this is perfect solution !!"}], "tags": [], "owner": {"reputation": 345, "user_id": 7402897, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/660d276e5c398a797bf406e995a78a20?s=128&d=identicon&r=PG&f=1", "display_name": "Aeonos", "link": "https://stackoverflow.com/users/7402897/aeonos"}, "is_accepted": true, "score": 1, "last_activity_date": 1491380438, "creation_date": 1491380438, "answer_id": 43225654, "question_id": 43225466, "link": "https://stackoverflow.com/questions/43225466/how-to-calculate-the-hexa-value-from-the-ip-checksum-field/43225654#43225654", "title": "How to calculate the Hexa value from the IP checksum field?", "body": "<p>You can separate the values using the bit operators</p>\n\n<pre><code>buffer[11] = (checksum &gt;&gt; 8) &amp; 0xff;\nbuffer[12] = checksum &amp; 0xff;\n</code></pre>\n\n<p>The first line shifts the checksum by 8 bits to the right, which is equivalent to dividing by 256 and than ensures, that you only get the information of those remaining 8 bits (0xD7) by using the and(&amp;) operator with 0xff which equals to 1111 1111 in binary representation.\nThe second line also uses the and operator to save ONLY the last 8 bit of your checksum, which would be 0x80.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1491381015, "creation_date": 1491381015, "answer_id": 43225894, "question_id": 43225466, "link": "https://stackoverflow.com/questions/43225466/how-to-calculate-the-hexa-value-from-the-ip-checksum-field/43225894#43225894", "title": "How to calculate the Hexa value from the IP checksum field?", "body": "<p>You can use expressions of the form <code>buffer[11] = (checkSum &amp; 0xFF00) &gt;&gt; 8; buffer[12] = (checkSum &amp; 0xFF)</code>, but you should carefully check if your processor architecture uses big endian or little endian form for representing integers. Hence, it may be that on some systems you have to exchange the expressions to <code>buffer[12] = (checkSum &amp; 0xFF00) &gt;&gt; 8; buffer[11] = (checkSum &amp; 0xFF)</code>.</p>\n\n<p>See the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned short getCheckSum(unsigned short buffer[]) {\n    return 0xD780;\n}\n\nint main(int argc, const char *argv[])\n{\n    unsigned short buffer[20] = {0x45,0x00,0x00,0x4E,0x4E,0x05,0x00,0x10,0x80,0x11,0X00,0X00,0x0A,0x00,0x00,0x1C,0x1A,0x00,0x00,0x2F};\n\n    unsigned short checkSum = getCheckSum(buffer);\n\n    buffer[11] = (checkSum &amp; 0xFF00) &gt;&gt; 8;\n    buffer[12] = (checkSum &amp; 0xFF);\n\n    for (int i=0; i&lt;20; i++) {\n        printf(\"%02X \", buffer[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 776, "user_id": 2986042, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bddc199a94ba0624f39a3820943d8a32?s=128&d=identicon&r=PG&f=1", "display_name": "user2986042", "link": "https://stackoverflow.com/users/2986042/user2986042"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 1, "accepted_answer_id": 43225654, "answer_count": 2, "score": 0, "last_activity_date": 1491381015, "creation_date": 1491379872, "question_id": 43225466, "link": "https://stackoverflow.com/questions/43225466/how-to-calculate-the-hexa-value-from-the-ip-checksum-field", "title": "How to calculate the Hexa value from the IP checksum field?", "body": "<p>I have a unsigned short buffer , it contain a hexa values of IP header .</p>\n\n<pre><code>unsigned short buffer = {45,00,00,4E,4E,05,00,10,80,11,0X00,0X00,0A,00,00,1C,1A,00,00,2F};\n</code></pre>\n\n<p>I added <code>0X00 , 0X00</code> in the place of Checksum filed and calculated checksum with the <strong>RFC 1071 - Calculating IP header checksum</strong> . So it is returning a <code>unsigned short checksum</code> value . Now i need to insert to the Ip buffer .</p>\n\n<p><strong>For example</strong> : if my <code>unsigned short checksum value</code> =  <code>55168</code> and it's Hex value = <code>D780</code> . Now i need to add  <code>D7</code> , <code>80</code> to <code>buffer[11]</code> and <code>buffer[12]</code> . How can i convert unsigned short checksum value and split the Hex value for inserting to the buffer ? If it Hex = <code>D78</code> , then also i need to add <code>0D</code> and <code>78</code> to the buffer field . </p>\n"}, {"tags": ["c", "segmentation-fault", "long-long"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491379795, "post_id": 43225392, "comment_id": 73520867, "body": "This isn&#39;t where your error is (<a href=\"http://ideone.com/XrgEvb\" rel=\"nofollow noreferrer\">case and point</a>). The undefined behavior is elsewhere. Check the return value of <code>scanf</code> and it&#39;s kin, always!"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491379964, "post_id": 43225392, "comment_id": 73520975, "body": "What input are you providing? How did you confirm that the segmentation fault occurred in the scanning process and not after it?"}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "edited": false, "score": 0, "creation_date": 1491379983, "post_id": 43225392, "comment_id": 73520988, "body": "I checked my code by putting printf statements throughout and confirmed that it does indeed stop at the second scanf statement."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491380003, "post_id": 43225392, "comment_id": 73521004, "body": "@Vishal So a <code>printf</code> followed by an <code>fflush</code> after the second <code>scanf</code> did not print? Can you edit your code to show that? (We can&#39;t debug code we can&#39;t see. And you don&#39;t know that <i>this</i> code faulted in the <code>scanf</code>.)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491380048, "post_id": 43225392, "comment_id": 73521031, "body": "@Vishal - printf statement don&#39;t confirm anything. If output is buffered (as stdout often is) you won&#39;t see any printout near the actual crash site."}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1491380106, "post_id": 43225392, "comment_id": 73521059, "body": "@DavidSchwartz the second scanf doesn&#39;t work if the number is more than 6 digits. specifically you can try this 123456789 9876543"}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491380202, "post_id": 43225392, "comment_id": 73521134, "body": "@DavidSchwartz the code you see here is all the code I&#39;m working on, there is nothing else."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491380225, "post_id": 43225392, "comment_id": 73521151, "body": "@Vishal Okay, so you don&#39;t know that it&#39;s the second <code>scanf</code> that&#39;s faulting in that code. And that&#39;s the only code you&#39;re working on. Thank you."}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491380510, "post_id": 43225392, "comment_id": 73521336, "body": "@StoryTeller You are right, I checked the return value of scanf and it is 1 for both the scanf statements, so the error is somewhere else. Thanks for pointing out. Can you tell me what do you mean by output is buffered?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1491380705, "post_id": 43225392, "comment_id": 73521462, "body": "This is a stack overflow, which occurs here <code>int com[t];</code> when you try to allocate far too much memory on the stack."}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491381093, "post_id": 43225392, "comment_id": 73521797, "body": "@Lundin Gotit, thanks for pointing out."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491383408, "post_id": 43225392, "comment_id": 73523369, "body": "@Vishal - Buffered output means that what ever you print doesn&#39;t appear in the terminal right away. Instead it&#39;s stored in a buffer by the call. The way, IO operations (which are somewhat costly) can be reduced. When the buffer is full, the entire content is printed at once."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1491380453, "last_edit_date": 1491380453, "creation_date": 1491379955, "answer_id": 43225491, "question_id": 43225392, "link": "https://stackoverflow.com/questions/43225392/segmentation-fault-in-scanning-long-long-int-in-c/43225491#43225491", "title": "Segmentation fault in scanning long long int in C", "body": "<p>I suspect your input is a truly big number (<em>edit: you confirmed it in a comment</em>). The call stack is fairly limited in size, and declaring a huge variable length array can easily overflow it.</p>\n\n<p>Replace <code>int com[t];</code> with the following:</p>\n\n<pre><code>int *com = malloc(sizeof *com * t);\n</code></pre>\n\n<p>And don't forget to free it, of course, when you are done.</p>\n"}], "owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "closed_date": 1491380605, "accepted_answer_id": 43225491, "answer_count": 1, "score": 0, "last_activity_date": 1491380453, "creation_date": 1491379630, "question_id": 43225392, "link": "https://stackoverflow.com/questions/43225392/segmentation-fault-in-scanning-long-long-int-in-c", "closed_reason": "Duplicate", "title": "Segmentation fault in scanning long long int in C", "body": "<p>I'm trying to write a simple program to calculate the number of common factors for two numbers.I am stuck with segmentation fault(core dumped) occurring while scanning the second number.I don't understand where is the fault?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nlong long int first,second,t,k;\nlong long int i,count=0;\nscanf(\"%lld\",&amp;first);\nscanf(\"%lld\",&amp;second);\n//storing the lowest of two numbers in t  \nif(first&lt;second){\n    t=first;\n}\nelse{\n    t=second;\n}\n//initialising an array to be used as flags\nint com[t];\nfor(i=0;i&lt;t;i=i+1){\n    com[i]=1;\n}\nfor(i=0;i&lt;t;i=i+1){\n    if(com[i]==1){\n        if(first%(i+1)==0&amp;&amp;second%(i+1)==0){\n            count=count+1;\n        }\n        else{\n            for(k=2;k*(i+1)-1&lt;t;k=k+1){\n                com[k*(i+1)-1]=0;\n            }\n        }\n    }\n}\nprintf(\"%lld\\n\",count);\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "binaryfiles"], "comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 1, "creation_date": 1491379222, "post_id": 43225235, "comment_id": 73520482, "body": "You should specify what errors you get..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1491379269, "post_id": 43225235, "comment_id": 73520513, "body": "Your second code snippet invokes <i>undefined behavior</i>. <code>fileWriting</code> doesn&#39;t point to determinate data, yet you&#39;re dereferencing it."}, {"owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "edited": false, "score": 0, "creation_date": 1491379411, "post_id": 43225235, "comment_id": 73520608, "body": "it gives a bus error: 10"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1491379483, "post_id": 43225235, "comment_id": 73520656, "body": "<code>fileData* fileWriting;</code> --&gt; <code>fileData* fileWriting = malloc(sizeof(*fileWriting));</code> or just use <code>fileData fileWriting; fileWriting.data1 = 10;</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1491379560, "post_id": 43225235, "comment_id": 73520704, "body": "Make sure to enable all compiler warnings."}, {"owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491379729, "post_id": 43225235, "comment_id": 73520822, "body": "Thanks @BLUEPIXY -- solved the issue."}], "owner": {"reputation": 49, "user_id": 7734211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5983b321b6ef668a0b66e6ee5f739d8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7734211/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1491379528, "answer_count": 0, "score": 0, "last_activity_date": 1491379331, "creation_date": 1491379130, "last_edit_date": 1491379331, "question_id": 43225235, "link": "https://stackoverflow.com/questions/43225235/write-a-struct-to-binary-file-in-c", "closed_reason": "Duplicate", "title": "Write a Struct to Binary File in C", "body": "<p>I am trying to write the contents of a struct into a binary file in C.</p>\n\n<p>The Struct looks like:</p>\n\n<pre><code>typedef struct fileData fileData;\nstruct fileData {\n    uint8_t data1;\n    uint8_t data2;\n    uint8_t data3;\n}\n</code></pre>\n\n<p>I am trying to get these 3 data pieces to write to the header of the binary file (each as 1 byte).</p>\n\n<pre><code>fileData* fileWriting;\nfileWriting-&gt;data1 = 10;\nfileWriting-&gt;data2 = 20;\nfileWriting-&gt;data3 = 30;\n</code></pre>\n\n<p>Code to write to file:</p>\n\n<pre><code>FILE * outputFile = fopen(\"test.bin\",\"wb\");\nfwrite(&amp;fileWriting-&gt;data1,1,1, outputFile);\nfwrite(&amp;fileWriting-&gt;data2,1,1, outputFile);\nfwrite(&amp;fileWriting-&gt;data3,1,1, outputFile);\nfclose(outputFile);\n</code></pre>\n\n<p>However, this is giving errors (i.e. bus:10). What is wrong/is there a better way?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1491378137, "post_id": 43224706, "comment_id": 73519819, "body": "Don&#39;t change <code>a</code> in the inner loop (i.e. don&#39;t do <code>a = a + 7; </code>). Instead use a temp variable in the inner loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7491201"}, "edited": false, "score": 0, "creation_date": 1491378186, "post_id": 43224706, "comment_id": 73519857, "body": "Are you intending <code>n</code> to be the total number of printed elements, or the size of the row/column?"}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491378265, "post_id": 43224706, "comment_id": 73519900, "body": "@llap42  it is  value of row and column"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7491201"}, "edited": false, "score": 2, "creation_date": 1491378463, "post_id": 43224706, "comment_id": 73520011, "body": "One issue you will have is that although you ask the user for <code>n</code>, you have specifically coded for the case of <code>n=4</code>"}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491378943, "post_id": 43225037, "comment_id": 73520290, "body": "Probably the clearer approach to read. Although it&#39;s worth noting the giving up the row order traversal makes this less cache friendly for bigger arrays. Also, the <code>std::cout</code> isn&#39;t C, but here&#39;s an upvote anyway."}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491379566, "post_id": 43225037, "comment_id": 73520708, "body": "Thanks for your answer!"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491380803, "post_id": 43225037, "comment_id": 73521542, "body": "Yes, I think OP selected randomly... +1 by me"}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491386181, "post_id": 43225037, "comment_id": 73525442, "body": "@Biegeleisen thank you for you answer it is working. When the first time you answered it did not worked. Now it is ok!"}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491386292, "post_id": 43225037, "comment_id": 73525529, "body": "But in C programming you cannot declare int inside for loop. It gives you error!"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491386459, "post_id": 43225037, "comment_id": 73525666, "body": "@Armani I think it is compiler-specific.  In the demo I linked, which uses GCC, there is no problem with my code and it runs.  But point taken."}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491386606, "post_id": 43225037, "comment_id": 73525772, "body": "Thank you very much it is working. there was another true answer it also worked, i don&#39;t know if that guy deleted it or what!"}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": true, "score": 4, "last_activity_date": 1491379097, "last_edit_date": 1491379097, "creation_date": 1491378558, "answer_id": 43225037, "question_id": 43224706, "link": "https://stackoverflow.com/questions/43224706/how-to-write-the-algorithm-of-this-matrix-in-this-ascending-order-in-c-where-is/43225037#43225037", "title": "How to write the algorithm of this matrix in this ascending order in C.Where is error in my code?", "body": "<p>The way I approached this is to build the matrix of values you actually want, but doing so in <em>column</em> order, where we can relatively easily control the logic of value progression by row.  Then, with that matrix in hand, print out the values in <em>row</em> order, as you want the output:</p>\n\n<pre><code>int main()\n{\n    int a = 7;\n    int n = 4;\n    int array[4][4];\n\n    for (int c=0; c &lt; n; ++c)\n    {\n        for (int r=0; r &lt; n; ++r)\n        {\n            // values ascending for even columns\n            if (c % 2 == 0)\n            {\n                array[r][c] = a + c*n + r;\n            }\n            // values descending for odd columns\n            else\n            {\n                array[r][c] = a + c*n + n-r-1;\n            }\n        }\n    }\n\n    for (int i=0; i &lt; n; ++i)\n    {\n        for (int j=0; j &lt; n; ++j)\n        {\n            printf(\"%d \", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/t03kP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t03kP.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Demo here:</strong></p>\n\n<p><a href=\"http://rextester.com/XKEL68881\" rel=\"nofollow noreferrer\"><h1>Rextester</h1></a></p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491378696, "post_id": 43225044, "comment_id": 73520140, "body": "Declaring all the variables at the top, despite the limited scope of their use, is so 1989..."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1491379287, "post_id": 43225044, "comment_id": 73520529, "body": "Can you update your solution so that the number <code>8</code> is not hard-coded, or at least is expressed as a multiple of some fixed parameter?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491379326, "post_id": 43225044, "comment_id": 73520559, "body": "Oh my bad, will fix it."}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491379527, "post_id": 43225044, "comment_id": 73520686, "body": "Thanks for your answer!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491380237, "post_id": 43225044, "comment_id": 73521159, "body": "@StoryTeller, everytime I write code like this, it hurts my brain. But it&#39;s less effort than having to figure out what standard the guy on the other side is using or having to change later. I have seen many students using even Turbo C."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491380294, "post_id": 43225044, "comment_id": 73521204, "body": "They&#39;ll keep using it we don&#39;t nudge them towards better options :)"}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 1, "last_activity_date": 1491380577, "last_edit_date": 1491380577, "creation_date": 1491378587, "answer_id": 43225044, "question_id": 43224706, "link": "https://stackoverflow.com/questions/43224706/how-to-write-the-algorithm-of-this-matrix-in-this-ascending-order-in-c-where-is/43225044#43225044", "title": "How to write the algorithm of this matrix in this ascending order in C.Where is error in my code?", "body": "<p>Instead of using this complex mechanism to keep track of all elements you can just calculate the value to add at any time by simple arithmetic. </p>\n\n<p>See this</p>\n\n<pre><code>int row;\nint column;\nprintf(\"\\n\");\nfor (row = 0; row &lt; n; row++) {\n    for (column = 0; column &lt; n; column++) {\n        int base; \n        int flag; \n        if (column % 2 != 0) {\n            base = (column+1)/2 * 2*n - 1;\n            flag = -1;\n        }else {\n            base = column/2 * 2*n;\n            flag = 1;\n        }\n        printf( \"%d \", a + base + flag * row);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>I hope you are able to follow this logic. If not feel free to ask.</p>\n\n<p>Demo here:\n<a href=\"https://ideone.com/OWf11N\" rel=\"nofollow noreferrer\">Ideone</a></p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491379073, "post_id": 43225151, "comment_id": 73520384, "body": "Why the extra memory though? It can be done without it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491379126, "post_id": 43225151, "comment_id": 73520422, "body": "@AjayBrahmakshatriya Why not? I prefer to use a matrix and an easier loop to print."}, {"owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "edited": false, "score": 0, "creation_date": 1491379588, "post_id": 43225151, "comment_id": 73520726, "body": "Thanks for your answer!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491379736, "post_id": 43225151, "comment_id": 73520827, "body": "@LPs because you will run into all kinds of cache issues when either filling or dumping the matrix ( you cannot optimize both the accesses). Also memory accesses are costly for large n. I just mean when there is a cheaper solution, we should go for that."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491380720, "post_id": 43225151, "comment_id": 73521475, "body": "@AjayBrahmakshatriya Cheaper on what? I think it is clearer to fill matrix: you can debug it and see what is going on. For newbies should be clearer a matrix filling process with coordinated calculation then <code>base = (column+1)&#47;2 * 2*n - 1;</code> and <code>a + base + flag * row</code> as per your answer. BTW personal opinions are OT."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1491384531, "last_edit_date": 1491384531, "creation_date": 1491378878, "answer_id": 43225151, "question_id": 43224706, "link": "https://stackoverflow.com/questions/43224706/how-to-write-the-algorithm-of-this-matrix-in-this-ascending-order-in-c-where-is/43225151#43225151", "title": "How to write the algorithm of this matrix in this ascending order in C.Where is error in my code?", "body": "<p>Simple solution using a matrix to calculate values before print them</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a;\n    int i = 0, j = 0, n;\n    printf(\"Insert the value of n: \");\n    scanf(\"%d\", &amp;n);\n\n    printf(\"Insert the value of a number: \");\n    scanf(\"%d\", &amp;a);\n\n    int matrix[n][n];\n\n    for (i=0; i&lt; n*n; i++)\n    {\n        // even columns ascending\n        if (((i/n) % 2) == 0)\n        {\n            matrix[i%n][i/n] = a++;\n        }\n        // odd column descending\n        else\n        {\n            matrix[n-(i%n)-1][i/n] = a++;\n        }\n    }\n\n    for (i=0; i&lt; n; i++)\n    {\n        for (j=0; j&lt; n; j++)\n        {\n            printf(\"%d\\t\", matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Insert the value of n: 4\nInsert start value: 1\n1   8   9   16  \n2   7   10  15  \n3   6   11  14  \n4   5   12  13  \n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7491201"}, "is_accepted": false, "score": 0, "last_activity_date": 1491378982, "creation_date": 1491378982, "answer_id": 43225183, "question_id": 43224706, "link": "https://stackoverflow.com/questions/43224706/how-to-write-the-algorithm-of-this-matrix-in-this-ascending-order-in-c-where-is/43225183#43225183", "title": "How to write the algorithm of this matrix in this ascending order in C.Where is error in my code?", "body": "<p>There seem to be two issues with your code as it is. As mentioned in the above comment, you are using the variable <code>a</code> in the loop calculation, so it is constantly being updated. This means your loop becomes invalid after a few iterations. If you define a dummy variable, this would avoid the problem. Secondly the implementation of the spiralling is close to being right, but it's not quite there.</p>\n\n<p>Consider in the case <code>n = 4</code>. When you print along each row, the difference between a new element and the last alternates between values of <code>(2n - 1) = 7</code> and <code>1</code>. To take this into account, you could for example check every time you want to print whether the column index (<code>j</code>) is odd or even, and use this to determine which difference to add. Once you have the row machinery fixed, it shouldn't be difficult to extend it to the columns.</p>\n"}], "owner": {"reputation": 49, "user_id": 7639661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dcf9a045e44df60ef1bbc6f0d97c24b?s=128&d=identicon&r=PG&f=1", "display_name": "Armani", "link": "https://stackoverflow.com/users/7639661/armani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 43225037, "answer_count": 4, "score": -1, "last_activity_date": 1491384531, "creation_date": 1491377637, "last_edit_date": 1491378069, "question_id": 43224706, "link": "https://stackoverflow.com/questions/43224706/how-to-write-the-algorithm-of-this-matrix-in-this-ascending-order-in-c-where-is", "title": "How to write the algorithm of this matrix in this ascending order in C.Where is error in my code?", "body": "<p>I am writing this code to print the following matrix in this spiral order(spiral by column).But my code is printing totally different thing.</p>\n\n<pre><code>a     a+7  a+8   a+15\na+1   a+6  a+9   a+14\na+2   a+5  a+10  a+13\na+3   a+4  a+11  a+12\n</code></pre>\n\n<p>Here is what i did:</p>\n\n<pre><code>int main() {\n    int a;\n    int Sum = 0;\n    int i = 0, j = 0,n;\n    printf(\"Insert the value of n: \");\n    scanf(\"%d\",&amp;n);\n\n    printf(\"Insert the value of a number: \");\n    scanf(\"%d\",&amp;a);\n\n    for(i=0;i&lt;n;i++){\n        for(j=0;j&lt;n;j++){\n            printf(\"%d  \",a);\n            a = a + 7;\n            printf(\"\\t\");\n        }\n\n        printf(\"%d\",a);\n        a = a + 1 ;\n\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "http", "get", "freegeoip"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1491381088, "post_id": 43224689, "comment_id": 73521790, "body": "Try to add a <code>&#47;</code> after csv. And you might add a <code>host:</code> line"}, {"owner": {"reputation": 543, "user_id": 3668037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96f09a3a60300d3c4a337c85a21a2aa?s=128&d=identicon&r=PG&f=1", "display_name": "neuo", "link": "https://stackoverflow.com/users/3668037/neuo"}, "edited": false, "score": 0, "creation_date": 1491980251, "post_id": 43224689, "comment_id": 73786642, "body": "HTTP response code 400 may be caused by header <code>HOST</code> absent. 403 may be caused by other header absent, as instance, <code>User-Agent</code>, or url path, or HTTP method. recommend read <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol\" rel=\"nofollow noreferrer\">HTTP</a>."}], "owner": {"reputation": 31, "user_id": 6281201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068d9bd01df89e7f410589669abb0dc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S.", "link": "https://stackoverflow.com/users/6281201/alex-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491377574, "creation_date": 1491377574, "question_id": 43224689, "link": "https://stackoverflow.com/questions/43224689/sending-http-get-request-to-freegeoip-in-c", "title": "Sending HTTP GET request to freegeoip in C", "body": "<p>I have written a C-programm on Windows to get my location using <a href=\"http://www.freegeoip.net/\" rel=\"nofollow noreferrer\">freegeoip</a>. The side just says that I must send a HTTP GET request in format freegeoip.net/{format}/{IP_or_hostname} where IP_or_hostname is optional and format can be csv, xml or json. So I did:</p>\n\n<pre><code>// ....\n\n//Create a socket\nif((s = socket(AF_INET , SOCK_STREAM , 0 )) == INVALID_SOCKET){\n    printf(\"Could not create socket : %d\" , WSAGetLastError());\n}\n\nprintf(\"Socket created.\\n\");\nserver.sin_addr.s_addr = inet_addr(\"104.31.11.172\"); //Actual address of url\nserver.sin_family = AF_INET;\nserver.sin_port = htons( 80 ); //Http port\n\n//Connect to remote server\nif (connect(s , (struct sockaddr *)&amp;server , sizeof(server)) &lt; 0){\n    puts(\"connect error\");\n    return 1;\n}\nputs(\"Connected\");\n\n//Send some data\n//I think this might be the error:\nmessage = \"GET freegeoip.net/csv HTTP/1.0\\r\\n\\r\\n\"; \n\nif( send(s , message , strlen(message) , 0) &lt; 0){\n    puts(\"Send failed\");\n    return 1;\n}\nputs(\"Data Send\\n\");\n\n//Receive a reply from the server\nif((recv_size = recv(s , server_reply , 2000 , 0)) == SOCKET_ERROR){\n    puts(\"recv failed\");\n}\n\nputs(\"Reply received\\n\");\n\n//Add a NULL terminating character to make it a proper string before printing\nserver_reply[recv_size] = '\\0';\nputs(server_reply);\n</code></pre>\n\n<p>I also tryed HTTP/1.1 or other strings for message, like:</p>\n\n<pre><code>message = \"GET /csv HTTP/1.0\\r\\n\\r\\n\"; \n</code></pre>\n\n<p>But the only response I get is 400 Bad request or 403 Forbidden.</p>\n"}, {"tags": ["c", "syntax", "malloc"], "comments": [{"owner": {"reputation": 13144, "user_id": 341291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LmEnh.jpg?s=128&g=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/341291/axel"}, "edited": false, "score": 0, "creation_date": 1491376627, "post_id": 43224312, "comment_id": 73518854, "body": "Shouldn&#39;t it be <code>int *p = malloc(N*sizeof(int))</code> or <code>int **p = malloc(N*sizeof(int*))</code>?"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "reply_to_user": {"reputation": 13144, "user_id": 341291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LmEnh.jpg?s=128&g=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/341291/axel"}, "edited": false, "score": 0, "creation_date": 1491377049, "post_id": 43224312, "comment_id": 73519113, "body": "yes, it is, <code>int **p = malloc(N*sizeof(int*))</code> I fix it in my edit"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1491377364, "post_id": 43224312, "comment_id": 73519322, "body": "Instead of posting this question on the internet, why don&#39;t you try them in your compiler and it will tell you. Also, if you read and understand a C programming book you should be able to figure out that <code>*int</code> is nonsense."}], "answers": [{"comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491376779, "post_id": 43224336, "comment_id": 73518946, "body": "this <code>int *p = malloc(N*sizeof(*int))</code> should be this: <code>int *p = malloc(N*sizeof(int))</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1491376836, "post_id": 43224336, "comment_id": 73518981, "body": "@tilz0R and where did I mention otherwise? :)"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1491379848, "post_id": 43224336, "comment_id": 73520899, "body": "If you read <code>sizeof *p</code> loud, do you say &quot;sizeof star p&quot; or &quot;sizeof dereferenced p&quot;?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1491377450, "last_edit_date": 1491377450, "creation_date": 1491376541, "answer_id": 43224336, "question_id": 43224312, "link": "https://stackoverflow.com/questions/43224312/right-syntax-with-malloc-sizeofint-or-sizeofint/43224336#43224336", "title": "Right syntax with malloc : sizeof(*int) or sizeof(int*)", "body": "<p><strong>TL;DR</strong> The first one, <em>partially</em> (considering you have the terminating <code>;</code> in your actual code).</p>\n\n<p><del>Probably a better</del> Correct way to write it will be</p>\n\n<pre><code> int *p = malloc(N*sizeof(*p));  // need memory for \"int\" type, not pointer to int\n</code></pre>\n\n<p>which removes the hard-coded dependency on the data type.</p>\n\n<hr>\n\n<p>FWIW, the second one, </p>\n\n<pre><code> int *p = malloc(N*sizeof(*int))\n</code></pre>\n\n<p>is an erroneous statement, syntactical error.</p>\n\n<p>And, to <em>nitpick</em>, it's not a <em>\"star\"</em>, it's called a dereference operator.</p>\n"}, {"tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": true, "score": 2, "last_activity_date": 1491376616, "creation_date": 1491376616, "answer_id": 43224364, "question_id": 43224312, "link": "https://stackoverflow.com/questions/43224312/right-syntax-with-malloc-sizeofint-or-sizeofint/43224364#43224364", "title": "Right syntax with malloc : sizeof(*int) or sizeof(int*)", "body": "<p>None of the above is right for enough amount of memory. Below is correct:</p>\n\n<pre><code>int *p = malloc(N * sizeof(int));\n</code></pre>\n\n<p>or </p>\n\n<pre><code>int **p = malloc(N * sizeof(int *));\n</code></pre>\n\n<p>In the first one, you allocate memory for integers and you return it as pointer. The second is allocating array of pointers so you need <code>*</code> character in sizeof keyword.</p>\n\n<p>But for messing in future of sizes, if you change <code>int *p</code> to let's say <code>char *p</code>, it is better to use this syntax:</p>\n\n<pre><code>int *p = malloc(N * sizeof(*p));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 4, "last_activity_date": 1491377236, "last_edit_date": 1491377236, "creation_date": 1491376874, "answer_id": 43224458, "question_id": 43224312, "link": "https://stackoverflow.com/questions/43224312/right-syntax-with-malloc-sizeofint-or-sizeofint/43224458#43224458", "title": "Right syntax with malloc : sizeof(*int) or sizeof(int*)", "body": "<p>The second one can be used only with an <em>expression</em> as the operand of the <code>sizeof</code> operator (and <code>*int</code> is not an expression, it's a syntax error).\nYou probably have seen it in code that uses the canonical way to allocate a dynamic array of N members of an arbitrary type:</p>\n\n<pre><code>p = malloc (N * sizeof *p);\n</code></pre>\n\n<p>I deliberately do not show the declaration of the pointer type <code>p</code>, since it is not needed. Even if the type of <code>p</code> changes, you never need to touch this allocation line. It always does the right thing.</p>\n\n<p>C grammar <code>sizeof</code> quirk: with an expression operand, the parentheses are optional. They are required when the operand is a type.</p>\n"}], "owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1615, "favorite_count": 1, "accepted_answer_id": 43224364, "answer_count": 3, "score": -3, "last_activity_date": 1491377450, "creation_date": 1491376472, "last_edit_date": 1491377067, "question_id": 43224312, "link": "https://stackoverflow.com/questions/43224312/right-syntax-with-malloc-sizeofint-or-sizeofint", "title": "Right syntax with malloc : sizeof(*int) or sizeof(int*)", "body": "<p>I usually see the syntax for malloc allocation :</p>\n\n<pre><code>int **p = malloc(N*sizeof(int*))\n</code></pre>\n\n<p>with <code>p</code> being a pointer. I have also seen the following syntax (maybe my sources are not right) :</p>\n\n<pre><code>int **p = malloc(N*sizeof(*int))\n</code></pre>\n\n<p>The difference between 2 syntax above is that \"star\" <code>*</code> appears after the type <code>int</code> for the first and before for the second one.</p>\n\n<p>Could you tell me the right syntax between the two above?</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 1, "creation_date": 1491377442, "post_id": 43224229, "comment_id": 73519380, "body": "This definitely looks suspicious: <code>mach_vm_map(size=13835058055282167808)</code> Seems to me, that <code>buf-&gt;length</code> is uninitialized or corrupted. Considering it&#39;s a multithreading process, I would start by looking carefully for all shared variables/memory between threads and double-check, that proper locking/synchronization is in place. Overall it sounds like a typical race condition. In this case, external tools are often not helpful, because they slow down the process enough to hide the problem."}, {"owner": {"reputation": 1283, "user_id": 2747160, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xE6Dt.png?s=128&g=1", "display_name": "m8mble", "link": "https://stackoverflow.com/users/2747160/m8mble"}, "edited": false, "score": 1, "creation_date": 1491388574, "post_id": 43224229, "comment_id": 73527167, "body": "I&#39;d try valgrind, before doing anything else..."}], "answers": [{"tags": [], "owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "is_accepted": false, "score": 3, "last_activity_date": 1491377472, "creation_date": 1491377472, "answer_id": 43224650, "question_id": 43224229, "link": "https://stackoverflow.com/questions/43224229/c-malloc-cant-allocate-region-error-but-cant-repro-with-gdb/43224650#43224650", "title": "C malloc &quot;can&#39;t allocate region&quot; error, but can&#39;t repro with GDB?", "body": "<p>One debugging technique that is sometimes overlooked is to include debug prints in the code, of course it has it's disadvantages, but also it has advantages. A thing you must keep in mind though in the face of abnormal termination is to make sure the printouts actually get printed. Often it's enough to print to <code>stderr</code> (but if that doesn't make the trick one may need to <code>fflush</code> the stream explicitly).</p>\n\n<p>Another trick is to stop the program before the error occurs. This requires you to know when the program is about to crash, preferably as close as possible. You do this by using raise:</p>\n\n<pre><code>raise(SIGSTOP);\n</code></pre>\n\n<p>This does not terminate the program, it just suspends execution. Now you can attach with <code>gdb</code> using the command <code>gdb &lt;program-name&gt; &lt;pid&gt;</code> (use <code>ps</code> to find the pid of the process). Now in <code>gdb</code> you have to tell it to ignore <code>SIGSTOP</code>:</p>\n\n<pre><code>&gt; handle SIGSTOP ignore\n</code></pre>\n\n<p>Then you can set break-points. You can also step out of the <code>raise</code> function using the <code>finish</code> command (may have to be issued multiple times to return to your code).</p>\n\n<p>This technique makes the program have normal behaviour up to the time you decide to stop it, hopefully the final part when running under <code>gdb</code> would not alter the behavior enuogh.</p>\n\n<p>A third option is to use <code>valgrind</code>. Normally when you see these kind of errors there's errors involved that <code>valgrind</code> will pick up. These are accesses out of range and uninitialized variables.</p>\n"}, {"tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 1, "last_activity_date": 1491388311, "creation_date": 1491388311, "answer_id": 43228625, "question_id": 43224229, "link": "https://stackoverflow.com/questions/43224229/c-malloc-cant-allocate-region-error-but-cant-repro-with-gdb/43228625#43228625", "title": "C malloc &quot;can&#39;t allocate region&quot; error, but can&#39;t repro with GDB?", "body": "<p>Many memory managers initialise memory to a known bad value to expose problems like this (e.g. Microsoft's CRT will use a range of values (0xCD means uninitialised, 0xDD means already free etc).</p>\n\n<p>After each use of malloc, try memset'ing the memory to 0xCD (or some other constant value).  This will allow you to identify uninitialised memory more easily with the debugger.  don't use 0x00 as this is a 'normal' value and will be harder to spot if it's wrong (it will also probably 'fix' your problem).  </p>\n\n<p>Something like:</p>\n\n<pre><code>void *memory = malloc(sizeof(my_object));\nmemset(memory, 0xCD, sizeof(my_object));\n</code></pre>\n\n<p>If you know the size of the blocks, you could do something similar before free (this is sometimes harder unless you know the size of your objects, or track it in some way):</p>\n\n<pre><code>memset(memory, 0xDD, sizeof(my_object));\nfree(memory);\n</code></pre>\n"}], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1823, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1491388311, "creation_date": 1491376240, "question_id": 43224229, "link": "https://stackoverflow.com/questions/43224229/c-malloc-cant-allocate-region-error-but-cant-repro-with-gdb", "title": "C malloc &quot;can&#39;t allocate region&quot; error, but can&#39;t repro with GDB?", "body": "<p>How can I debug a C application that does not crash when attached with <code>gdb</code> and <code>run</code> inside of gdb?  </p>\n\n<p>It crashes consistently when run standalone - even the same debug build!</p>\n\n<hr>\n\n<p>A few of us are getting this error with a C program written for BSD/Linux, and we are compiling on macOS with OpenSSL.</p>\n\n<pre><code>app(37457,0x7000017c7000) malloc: *** mach_vm_map(size=13835058055282167808) failed (error code=3)\n*** error: can't allocate region\n*** set a breakpoint in malloc_error_break to debug\nERROR: malloc(buf-&gt;length + 1) failed!\n</code></pre>\n\n<p>I know, not helpful.  </p>\n\n<p>Recompiling the application with <code>-g -rdynamic</code> gives the same error.  Ok, so now we know it isn't because of a release build as it continues to fail.</p>\n\n<p>It works when running within a <code>gdb</code> debugging session though!!</p>\n\n<pre><code>$ sudo gdb app\n(gdb) b malloc_error_break\nFunction \"malloc_error_break\" not defined.\nMake breakpoint pending on future shared library load? (y or [n]) y\nBreakpoint 1 (malloc_error_break) pending.\n(gdb) run -threads 8\nStarting program: ~/code/app/app -threads 8\n[New Thread 0x1903 of process 45436]\nwarning: unhandled dyld version (15)\n</code></pre>\n\n<p>And it runs for hours.  CTRL-C, and run <code>./app -threads 8</code> and it crashes after a second or two (a few million iterations).  </p>\n\n<p>Obviously there's an issue within one of the threads.  But those workers for the threads are pretty big (a few hundred lines of code).  Nothing stands out.</p>\n\n<p>Note that the threads iterate over loops of about 20 million per second.   </p>\n\n<ul>\n<li>macOS 10.12.3</li>\n<li>Homebrew w/GNU gcc and openssl (linking to crypto)</li>\n</ul>\n\n<hr>\n\n<p>Ps, not familiar with C too much - especially any type of debugging.  Be kind and expressive/verbose in answers.  :)</p>\n"}, {"tags": ["c", "performance", "syntax", "switch-statement"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1491375417, "post_id": 43223920, "comment_id": 73518093, "body": "The above is a GCC extension. Quite obvious why the second is better"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491375423, "post_id": 43223920, "comment_id": 73518097, "body": "The former won&#39;t even compile in standard C. Which non-standard compiler are you using?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491375470, "post_id": 43223920, "comment_id": 73518131, "body": "Why don;t you check the generated assembly code, for starters?"}], "answers": [{"comments": [{"owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "edited": false, "score": 4, "creation_date": 1491375809, "post_id": 43223950, "comment_id": 73518341, "body": "Your alternative may be easily writable, but it is slower in terms of performance, as the OP is asking about. Maybe you should state it."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1491376175, "last_edit_date": 1491376175, "creation_date": 1491375416, "answer_id": 43223950, "question_id": 43223920, "link": "https://stackoverflow.com/questions/43223920/are-there-any-possible-changes-in-optimization-while-using-different-syntax-for/43223950#43223950", "title": "Are there any possible changes in optimization while using different syntax for switch statement?", "body": "<p>If in doubt profile it.</p>\n\n<p>But note that the first snippet is <strong>not</strong> standard C (the range <code>switch</code> is a notable gcc compiler extension), and so is therefore not portable.</p>\n\n<p><code>switch ((a - 1) / 5)</code> would be an obvious alternative if you don't like duplicating case labels. But this could wind up being slower; again, profile it. Presumably you are aware that the <code>printf</code> is the performance bottleneck by a country mile?</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1491376373, "last_edit_date": 1491376373, "creation_date": 1491375545, "answer_id": 43223989, "question_id": 43223920, "link": "https://stackoverflow.com/questions/43223920/are-there-any-possible-changes-in-optimization-while-using-different-syntax-for/43223989#43223989", "title": "Are there any possible changes in optimization while using different syntax for switch statement?", "body": "<p>Both the snippets are <em>same</em>, they are <strong>not</strong> different. You're just using a different <em>syntax</em> for writing the code, that's all.</p>\n\n<p>As already mentioned in comments, the first approach makes use of <strong><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Case-Ranges.html#Case-Ranges\" rel=\"nofollow noreferrer\">gcc extension for case-range</a>.</strong> It allows you to write <em>shorter</em> code at the cost of <em>portability</em>, so choose wisely.</p>\n\n<p>Any (<em>half-decent</em>) compiler, while generating the assembly, will generate the same code, so performance-wise there should be no difference.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 43223989, "answer_count": 2, "score": 1, "last_activity_date": 1491376373, "creation_date": 1491375358, "last_edit_date": 1491376073, "question_id": 43223920, "link": "https://stackoverflow.com/questions/43223920/are-there-any-possible-changes-in-optimization-while-using-different-syntax-for", "title": "Are there any possible changes in optimization while using different syntax for switch statement?", "body": "<p>Which is better performance in following two code snippets? and why?</p>\n\n<p><strong>Snippet 1:</strong></p>\n\n<pre><code> switch(a)\n {\n      case 1 ... 5:\n                   printf(\"%d\\n\",a);\n                   break;\n     case 6 ... 10:\n                  printf(\"%d\\n\",a);\n                  break;\n    default:\n            printf(\"%d\\n\",a);\n }\n</code></pre>\n\n<p><strong>Snippet 2:</strong></p>\n\n<pre><code>switch(a)\n{\n    case 1:\n    case 2:\n    case 3:\n    case 4:\n    case 5:\n          printf(\"%d\\n\",a);\n          break;\n    case 6:\n    case 7:\n    case 8:\n    case 9:\n    case 10:\n           printf(\"%d\\n\",a);\n           break;\n   default:\n           printf(\"%d\\n\",a);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "algorithm", "random"], "comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1491375014, "post_id": 43223772, "comment_id": 73517821, "body": "I read your question a few times but I couldn&#39;t understand what you want. Do you want a way to generate random numbers? Or do you want a way to generate pink noise (1/f noise)?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1491375249, "post_id": 43223772, "comment_id": 73517969, "body": "Question begging for code get close voted as off-topic pretty fast here.You should <a href=\"https://stackoverflow.com/posts/43223772/edit\">edit</a> your question to remove those parts."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491375297, "post_id": 43223772, "comment_id": 73517998, "body": "Punch &quot;hasty pudding&quot; into your favorite search engine."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1491402181, "post_id": 43223772, "comment_id": 73537985, "body": "A really easy way to do this, although it would require some memory, is to create an array of the numbers from 0 to 65,535, and then <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">shuffle them</a>."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1491403027, "post_id": 43223772, "comment_id": 73538723, "body": "By the way, if you&#39;re interested in finding the article, the table of contents for DDJ 1980 editions is at <a href=\"ftp://ftp.math.utah.edu/pub/tex/bib/toc/dr-dobbs-1980.html\" rel=\"nofollow noreferrer\">ftp.math.utah.edu/pub/tex/bib/toc/dr-dobbs-1980.html</a>."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1491403046, "post_id": 43223772, "comment_id": 73538742, "body": "Also relevant: <a href=\"https://www.schneier.com/academic/archives/1994/09/pseudo-random_sequen.html\" rel=\"nofollow noreferrer\">schneier.com/academic/archives/1994/09/&hellip;</a>"}, {"owner": {"reputation": 409, "user_id": 3418256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab1a4e1a35a00156efb7996f21995638?s=128&d=identicon&r=PG&f=1", "display_name": "ChocoBilly", "link": "https://stackoverflow.com/users/3418256/chocobilly"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1491433569, "post_id": 43223772, "comment_id": 73556172, "body": "@JimMischel I&#39;ll definitely be going through those archives. It would be nice to see the original code. I don&#39;t even remember what language or processor the code was written for."}], "answers": [{"comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1491402195, "post_id": 43223851, "comment_id": 73537996, "body": "Exactly what I was thinking."}, {"owner": {"reputation": 409, "user_id": 3418256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab1a4e1a35a00156efb7996f21995638?s=128&d=identicon&r=PG&f=1", "display_name": "ChocoBilly", "link": "https://stackoverflow.com/users/3418256/chocobilly"}, "edited": false, "score": 1, "creation_date": 1491432531, "post_id": 43223851, "comment_id": 73555831, "body": "That&#39;s exactly what I was looking for and thanks for understanding the original post."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 6, "last_activity_date": 1491375163, "creation_date": 1491375163, "answer_id": 43223851, "question_id": 43223772, "link": "https://stackoverflow.com/questions/43223772/pattern-returning-pseudo-random-number-generator/43223851#43223851", "title": "Pattern returning pseudo random number generator", "body": "<p>I believe that what you are looking for is a <a href=\"https://en.m.wikipedia.org/wiki/Linear-feedback_shift_register\" rel=\"noreferrer\">linear-feedback shift register</a>. It can have the properties you seem to want of returning the full sequence in seemingly random order without repeating an element of the range.</p>\n"}], "owner": {"reputation": 409, "user_id": 3418256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab1a4e1a35a00156efb7996f21995638?s=128&d=identicon&r=PG&f=1", "display_name": "ChocoBilly", "link": "https://stackoverflow.com/users/3418256/chocobilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 43223851, "answer_count": 1, "score": 0, "last_activity_date": 1491542007, "creation_date": 1491374846, "last_edit_date": 1491542007, "question_id": 43223772, "link": "https://stackoverflow.com/questions/43223772/pattern-returning-pseudo-random-number-generator", "title": "Pattern returning pseudo random number generator", "body": "<p><strong>Edit:</strong></p>\n\n<p>Due to the responses of so many having no idea of what I was asking, I've rephrased the question.</p>\n\n<pre><code>extern unsigned short lfsr();\nint foo[65536];\nfor (int i = 0; i &lt; 65536; i++)\n    foo[lfsr()] = 1;\n// every element of foo has been set to 1.\n</code></pre>\n\n<p>I want source code for <code>lfsr()</code> which returns a pseudo random 16 bit value, 0 to 65535. If called 65536 times it will have returned every number from 0 to 65535 exactly once, with no repetition. If you did it again, it would return the same sequence. Not a great random number generator but it has its uses.</p>\n\n<p>I once had code for this from a Dr. Dobbs Journal of Computer Calisthenics and Orthodontia around 1984.</p>\n\n<p>This seems very similar to a noise generator but the exception is that the cycle repeats and that would not work for audio. Rendering the same 64K 16 bit PCM samples would be noticeably repetitive in less than 1.5 seconds at 48 kHz, and I've never heard that from a 16 bit noise generator.</p>\n\n<p>Note:\nA shuffle method wouldn't have worked in 1984 as the array would take 128K which would have been more than twice the available memory on an Apple][ or similar computer.</p>\n\n<p><strong>Answer:</strong>\nThanks to Jesper Juhl and Jim Mischel for identifying it as an LFSR, linear feedback shift register and where to find the original article. </p>\n\n<p>Sorry for the poorly phrased original question and thanks for your time.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491374542, "post_id": 43223509, "comment_id": 73517541, "body": "<code>long long int A =  0xAABBCCDDBBCCFFEE;</code> ----&gt; <code>unsigned long long int A =  0xAABBCCDDBBCCFFEE;</code>"}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1491375810, "post_id": 43223509, "comment_id": 73518343, "body": "<code>int byte_compare(long long int A, long long int B) {</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1491377111, "last_edit_date": 1491377111, "creation_date": 1491376096, "answer_id": 43224179, "question_id": 43223509, "link": "https://stackoverflow.com/questions/43223509/hexadecimal-comparison-for-big-number-in-c-program/43224179#43224179", "title": "Hexadecimal comparison for big number in c program", "body": "<p>You have many problems in your code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid byte_compare(uint64_t C, uint64_t D, int *array)\n{\n    int i = 0;\n\n    while (i &lt; 8)\n    {\n        printf(\"C = %\"PRIx64\"\\n\"  , (C&amp;0xFF));\n        printf(\"D = %\"PRIx64\"\\n\\n\", (D&amp;0xFF));\n\n        if ((C&amp;0xFF) == (D&amp;0xFF))\n        {\n            array[i] = 1;\n        }\n        else\n        {\n            array[i] = 0;\n        }\n\n        i++;\n\n        C &gt;&gt;= 8;\n        D &gt;&gt;= 8;\n    }\n}\n\nint main(void)\n{\n    int i = 0;\n\n    uint64_t A = UINT64_C(0xAABBCCDDBBCCFFEE);\n    uint64_t B = UINT64_C(0xAACCCCDDBBDDFF00);\n\n    int array[8] = {0};\n\n    byte_compare(A, B, array);\n\n    while (i &lt; 8)\n    {\n        printf(\"array[%d] - %d\\n\", i, array[i]);\n        i++;\n    }\n}\n</code></pre>\n\n<ol>\n<li>Correct type for your variables must be <code>unsigned long long</code> due to the literals: bit 63 is set to 1 so assign it to a signed variable causes overflow which invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>. Using <code>stdint.h</code> standard header you can use <code>uint64_t</code> that is clearer.</li>\n<li><code>byte_compare</code> function definition is wrong, you must pass parameters with correct type: <code>unsigned long long</code> (<code>uint64_t</code>). Moreover the function does not return an int so should be <code>void</code>.</li>\n<li><code>printf</code> with <code>%x</code> format specifier wants an <code>unsigned int</code>, not a <code>uint64_t</code>. Best thing to do is to use defined in <code>inttypes.h</code> standard header where all format specifier are well reported: in your case <code>PRIx64</code> is the right one.</li>\n<li>In your version of code you are left shifting a <code>long long int</code> that is used as mask to \"select\" the byte to check. It is plain wrong because last shift causes an overflow on a <code>signed</code> value that is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a> as for point 1.</li>\n<li><code>stdint.h</code> has also macros that append the correct suffix to literals.</li>\n</ol>\n\n<p>Another example using a mask:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid byte_compare(uint64_t C, uint64_t D, int *array)\n{\n    uint64_t mask = UINT64_C(0xFF00000000000000);\n\n    while (mask &gt; 0)\n    {\n        printf(\"C = %\"PRIx64\"\\n\"  , (C&amp;mask));\n        printf(\"D = %\"PRIx64\"\\n\\n\", (D&amp;mask));\n\n        if ((C&amp;mask) == (D&amp;mask))\n        {\n            *array = 1;\n        }\n        else\n        {\n            *array = 0;\n        }\n\n        mask &gt;&gt;= 8;\n        array--;\n    }\n}\n\nint main(void)\n{\n    int i = 0;\n\n    uint64_t A = UINT64_C(0xAABBCCDDBBCCFFEE);\n    uint64_t B = UINT64_C(0xAACCCCDDBBDDFF00);\n\n    int array[8] = {0};\n\n    byte_compare(A, B, &amp;array[7]);\n\n    while (i &lt; 8)\n    {\n        printf(\"array[%d] - %d\\n\", i, array[i]);\n        i++;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7785042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39216ca6ee8b409a1e33c51f70997e96?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/7785042/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1491377111, "creation_date": 1491373984, "question_id": 43223509, "link": "https://stackoverflow.com/questions/43223509/hexadecimal-comparison-for-big-number-in-c-program", "title": "Hexadecimal comparison for big number in c program", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nlong long int A =  0xAABBCCDDBBCCFFEE;\nlong long int B = 0xAACCCCDDBBDDFF00;\nint array[8] = {'\\0'};\nint byte_compare(int A, int B)\n{\n  int i = 0;\n  long long int j = 0xFF;\n  long long int C = A;\n  long long int D = B;\n\n  while(i &lt; 8)\n  {\n    C = (j &amp; A);\n    D = (j &amp; B);\n    printf(\"C = %x\\n\",C);\n    printf(\"D = %x\\n\",D);\n    printf(\"j = %x\\n\",j);\n    if(C == D)\n    {\n        array[i] = 1;\n    }\n    else\n    {\n        array[i] = 0;\n    }\n    i++;\n    j = j &lt;&lt; 8;\n  }\n}\n\nmain()\n{\n    int i = 0;\n    byte_compare(A,B);\n    while(i &lt; 8)\n    {\n        printf(\"array[%d] - %d\\n\",i, array[i]);\n        i++;\n    }\n}\n\nlong long int A = 0xAABBCCDDBBCCFFEE;\nlong long int B = 0xAACCCCDDBBDDFF00;\nresult = 10111010\n</code></pre>\n\n<p>when A and B byte number matches with each other it should print 1 otherwise 0.</p>\n\n<p>for my above program it is printing output </p>\n\n<pre><code>C = ee\nD = 0\nj = ff\nC = ff00\nD = ff00\nj = ff00\nC = cc0000\nD = dd0000\nj = ff0000\nC = bb000000\nD = bb000000\nj = ff000000\nC = 0\nD = 0\nj = 0\nC = 0\nD = 0\nj = 0\nC = 0\nD = 0\nj = 0\nC = 0\nD = 0\nj = 0\narray[0] - 0\narray[1] - 1\narray[2] - 0\narray[3] - 1\narray[4] - 1\narray[5] - 1\narray[6] - 1\narray[7] - 1\n</code></pre>\n\n<p>Not able to compare after first four byte please help me what datatype I should use instead above.</p>\n"}, {"tags": ["c", "unix", "firewall"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491373921, "post_id": 43223372, "comment_id": 73517242, "body": "If you want to check <code>errno</code> (either directly or indirectly through e.g. <code>perror</code>) you need to do it immediately after the failed function. If you use any other function that might set <code>errno</code> (which <code>printf</code> might indirectly do) then the value of <code>errno</code> is undefined."}, {"owner": {"reputation": 1250, "user_id": 6013687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614da05ed1b3b25b62612968f546dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "MrApnea", "link": "https://stackoverflow.com/users/6013687/mrapnea"}, "edited": false, "score": 0, "creation_date": 1491373943, "post_id": 43223372, "comment_id": 73517252, "body": "First off, are you sure the firewall is open? There could be other rules blocking this before your rule? One way to make sure (maybe you are an expert on iptables but just to make sure..), is to setup something else on that port and test. If that works you are sure the problem is in your code. I only bring it up since you added the firewall rule and it sounds like the problem could be there or in the code. Seting up a netcat &quot;webserver&quot; is one way to test. Run:  netcat -l 5001 &lt; index.html    Then you can try to connect to it and see if you get the page. If it works you know the code is broken"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491374123, "post_id": 43223372, "comment_id": 73517347, "body": "As for your problem, in the outcommented code if <code>hostip[0]</code> is a digit then you don&#39;t set <code>dest.sin_addr</code>. Assuming that you assume that <code>hostip</code> is an IP-address in that case, you don&#39;t need to call <code>getaddrinfo</code> for that. Just use <a href=\"http://man7.org/linux/man-pages/man3/inet_pton.3.html\" rel=\"nofollow noreferrer\"><code>inet_pton</code></a>. Also, in the other case you should not really be using <code>strncpy</code> as the data isn&#39;t really a string."}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "reply_to_user": {"reputation": 1250, "user_id": 6013687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614da05ed1b3b25b62612968f546dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "MrApnea", "link": "https://stackoverflow.com/users/6013687/mrapnea"}, "edited": false, "score": 0, "creation_date": 1491374415, "post_id": 43223372, "comment_id": 73517486, "body": "@FSDaniel  when i run  netcat -l 5001 &lt; index.html and try to connect to it from another remote device, it shows CONNECTION REFUSED but when i connect from same device, it works."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491374640, "post_id": 43223372, "comment_id": 73517586, "body": "Regarding the last comment, it indeed seems like you have a firewall issue. That is better solved by going to <a href=\"https://superuser.com/\">superuser.com</a> and asking about that specifically instead."}, {"owner": {"reputation": 1250, "user_id": 6013687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614da05ed1b3b25b62612968f546dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "MrApnea", "link": "https://stackoverflow.com/users/6013687/mrapnea"}, "edited": false, "score": 0, "creation_date": 1491376051, "post_id": 43223372, "comment_id": 73518488, "body": "@johnleonardonwuzuruigbo, then its either the firewall on the remote machine or on your local machine. I would guess the local machine, but the remote machine could also be blocking outgoing connections to unknown ports, not likely but possible. If you run:    iptables -nL    then you will get all your firewall rules listed in order and you might see the problem there?  You can also check (when you have already started your server program) that it is indeed listening to the correct ip and not just localhost.    netstat -na | grep 5001"}, {"owner": {"reputation": 1250, "user_id": 6013687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614da05ed1b3b25b62612968f546dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "MrApnea", "link": "https://stackoverflow.com/users/6013687/mrapnea"}, "edited": false, "score": 0, "creation_date": 1491376102, "post_id": 43223372, "comment_id": 73518521, "body": "@johnleonardonwuzuruigbo, are you using the same connect command (same ip) on both tries on both machines? Just so it isnt listening on 127.0.0.1 or somehing like that by accident...."}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491376438, "post_id": 43223372, "comment_id": 73518732, "body": "Yes,  i use same ip on both machine. not localhost (127.0.0.1)"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491373920, "post_id": 43223414, "comment_id": 73517239, "body": "this is not the problem, i can connect to other port in my device like 80 or even to google ip and port but cannot connect on this particular port 5001."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491374011, "post_id": 43223414, "comment_id": 73517291, "body": "@johnleonardonwuzuruigbo How does it follow from those observations that this is not the problem? In this particular case (forget about the other cases for now), how do you think the OS knows what IP address the client is trying to connect to? And how can you expect it to work if the OS has no idea what IP address you&#39;re trying to reach?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491374134, "post_id": 43223414, "comment_id": 73517354, "body": "@johnleonardonwuzuruigbo To give an analogy: Say you walked across the street without looking both ways and got hit by a car. Would you say, &quot;It can&#39;t be because I didn&#39;t look both ways. I didn&#39;t look both ways before crossing my living room and didn&#39;t get hit by a car. I didn&#39;t look both ways before crossing my lawn and didn&#39;t get hit by a car.&quot;"}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491375494, "post_id": 43223414, "comment_id": 73518150, "body": "@Davide Schwartz, i did as you suggested still not working. I am still getting CONNECTION REFUSED"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491376427, "post_id": 43223414, "comment_id": 73518726, "body": "@johnleonardonwuzuruigbo Then, <i>now</i>, that&#39;s not the reason. Assuming you did it correctly, which we can&#39;t tell because we can&#39;t see the code."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491377155, "post_id": 43223414, "comment_id": 73519180, "body": "@johnleonardonwuzuruigbo And, as I expected, you now have a different bug. See my update."}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491377666, "post_id": 43223414, "comment_id": 73519501, "body": "@DavideSchwartz, updated to  memcpy((char*)&amp;dest.sin_addr , (char*)host-&gt;h_addr , sizeof dest.sin_addr);      still NO CONNECTION"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491378361, "post_id": 43223414, "comment_id": 73519947, "body": "@johnleonardonwuzuruigbo Now you might have a different problem. But, again, it&#39;s hard to tell without being able to see the code. Also, it would help to see the precise error. (Which function reported an error and what errror did it report?)"}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491379588, "post_id": 43223414, "comment_id": 73520727, "body": "@DavideSchwartz, i edited my post, below it, you will see the error i get and from which part of the code its logging it from"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491380637, "post_id": 43223414, "comment_id": 73521407, "body": "@johnleonardonwuzuruigbo See my answer update for your next bug."}, {"owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "edited": false, "score": 0, "creation_date": 1491381492, "post_id": 43223414, "comment_id": 73522055, "body": "@DavideSchwartz  Edited still print same error message. the problem might be from the server code?"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1491380628, "last_edit_date": 1491380628, "creation_date": 1491373654, "answer_id": 43223414, "question_id": 43223372, "link": "https://stackoverflow.com/questions/43223372/connection-refused-even-after-adding-a-new-firewall-rule/43223414#43223414", "title": "Connection Refused even after adding a new Firewall rule", "body": "<p>Your client has no code to specify the IP address it wants to connect to. All the code that could do that has been commented out.</p>\n\n<p><strong>Update</strong>: Now your bug is here:</p>\n\n<pre><code>    strncpy((char*)&amp;dest.sin_addr , (char*)host-&gt;h_addr , sizeof dest.sin_addr);\n</code></pre>\n\n<p>The <code>strncpy</code> function is only suitable for C-style strings. You need to use <code>memcpy</code> or something similar. This will only copy part of the IP address if any octet other than its last one (in network byte order) is zero.</p>\n\n<p><strong>Update</strong>: Now your bug is here:</p>\n\n<pre><code>    printf(\"%d\\n\", connect(sockfd, (struct sockaddr *)&amp;dest, sizeof(dest)) &lt; 0);\n    perror(\"hmmmm\" );\n    exit(1);\n</code></pre>\n\n<p>This calls <code>connect</code>, then calls <code>printf</code> and then calls <code>perror</code>. The problem is, the call to <code>printf</code> can modify <code>errno</code> even if it succeeds. Thus your call to <code>perror</code> can print a totally irrelevant error message.</p>\n"}], "owner": {"reputation": 63, "user_id": 7152653, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-2JQJFL_c4So/AAAAAAAAAAI/AAAAAAAAAaE/Q8KOSYzF5wA/photo.jpg?sz=128", "display_name": "johnleonard onwuzuruigbo", "link": "https://stackoverflow.com/users/7152653/johnleonard-onwuzuruigbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491381384, "creation_date": 1491373562, "last_edit_date": 1491381384, "question_id": 43223372, "link": "https://stackoverflow.com/questions/43223372/connection-refused-even-after-adding-a-new-firewall-rule", "title": "Connection Refused even after adding a new Firewall rule", "body": "<p>I am trying to connect to my local UNIX server i made from another remote device. the Server is up and listening to the port i specified. i also added a new firewall rule to open that port but still my client cannot connect. it shows ERROR CONNECTION REFUSED</p>\n\n<p>here is my server code</p>\n\n<pre><code>int main() {\n  int fd, i,svclient,rval,msg;\n  int clients[10], num_clients;\n  fd_set read_set,write_set;\n  char buf[100];\n\n  struct sockaddr_in addr;\n\n  if ( (fd = socket(AF_INET, SOCK_STREAM, 0)) == -1) {\n    perror(\"socket error\");\n    exit(-1);\n  }\n\n\n  bzero((char *) &amp;addr, sizeof(addr));\n  addr.sin_family = AF_INET;\n  addr.sin_addr.s_addr = INADDR_ANY;\n  addr.sin_port = htons(4001);\n\n  //strncpy(addr.sun_path, socket_path, sizeof(addr.sun_path)-1);\n  //strcpy(addr.sun_path, NAME);\n\n  if (bind(fd, (struct sockaddr*)&amp;addr, sizeof(addr)) == -1) {\n    perror(\"bind error\");\n    exit(-1);\n  }\n  printf(\"Bind complet...\\n\");\n\n  if (listen(fd, 20) == -1) {\n    perror(\"listen error\");\n    exit(-1);\n  }\n\n  num_clients = 0;\n  int size = sizeof(fd);\n\n   while (1) {\n\n    int clientfd;\n    struct sockaddr_in client_addr;\n    int addrlen=sizeof(client_addr);\n    FD_ZERO(&amp;read_set);\n    FD_SET(fd, &amp;read_set);\n\n    for (i = 0; i &lt; num_clients; i++) { //at first this part will not excute\n      FD_SET(clients[i], &amp;read_set);\n    }\n\n    select(fd + num_clients + 1, &amp;read_set, NULL, NULL, NULL);\n\n\n    if (FD_ISSET(fd, &amp;read_set)) {\n      if ( (clients[num_clients++] = accept(fd,(struct sockaddr*)&amp;client_addr,&amp;addrlen)) == -1) {\n        perror(\"accept error\");\n        continue;\n      }\n      /*printf(\"incoming message..................... !\\n \\n\");*/\n      printf(\"%s:%d connected\\n\", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n    }\n\n\n    for (i = 0; i &lt; num_clients; i++) {\n\n      if (FD_ISSET(clients[i], &amp;read_set)) {\n        msg = read(clients[i], buf, sizeof(buf));\n        if(msg &gt; 0){\n          buf[msg] = 0;\n          int savedclnt = clients[i];\n          printf(\"%s \\n \\n\", buf);\n\n          /*for(int p=0;p&lt;num_clients;p++)\n          {\n            if( clients[p]!= savedclnt){\n              write(clients[p],buf,msg);\n            }\n\n          }*/\n        }\n\n      }\n\n    }\n  }\n}\n</code></pre>\n\n<p>and my client </p>\n\n<pre><code>    int main( )\n{   \n\n    struct uci_context *uci;\n    uci = uci_init();\n    int sockfd;\n    int ret;\n    struct sockaddr_in dest;\n    struct addrinfo hint, *res = NULL;\n    struct hostent *host;\n    char *hostip;\n    char *string;\n\n\n\n    if ( (sockfd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0 )\n    {\n        puts(\"Unble to create socket\");\n        exit(1);\n    }\n\n    hostip = ucix_get_option(uci, \"pack_mon\", \"pack_monitoring\", \"address\");\n    string = ucix_get_option(uci, \"pack_mon\", \"pack_monitoring\", \"port\");\n\n    bzero(&amp;dest, sizeof(dest));\n    dest.sin_family = AF_INET;\n    dest.sin_port = htons(atoi(string));\n\n    memset(&amp;hint, '\\0', sizeof hint);\n    hint.ai_family = PF_UNSPEC;\n    hint.ai_flags = AI_NUMERICHOST;\n\n    printf(\" %s- %s\\n\", hostip, string );\n\n\n\n    if(isdigit(hostip[0])){\n        ret = getaddrinfo(hostip, NULL, &amp;hint, &amp;res);// this is more efficient than inet_addr\n\n        if (ret) {\n\n            exit(1);\n        }\n    }else if( (host = gethostbyname(hostip)) != 0){\n\n        memcpy((char*)&amp;dest.sin_addr , (char*)host-&gt;h_addr , (sizeof dest.sin_addr)+1);\n\n    }else{\n\n        exit(1);\n        printf(\"cannot resolve ip address\");\n    }  \n\n\n    if ( connect(sockfd, (struct sockaddr *)&amp;dest, sizeof(dest)) &lt; 0 )\n    {\n\n        perror(\"ERROR Connecting\" );\n        exit(1);\n    }else{\n\n        printf(\"Port number %s is open.....\\n\",string);\n    }\n\n\n    char *message;\n    message = \"help\";\n    write(sockfd,message,strlen(message));\n\n\n    close(sockfd);\n    freeaddrinfo(res);\n    return 0;\n}\n</code></pre>\n\n<p>FIREWALL RULE </p>\n\n<p>sudo iptables -I INPUT -p tcp --dport 4001 -j ACCEPT</p>\n\n<p>Error is : </p>\n\n<p>192.168.10.155- 4001</p>\n\n<p>ERROR Connecting: Connection refused</p>\n\n<p>and this logs are coming from this codes :</p>\n\n<p>printf(\" %s- %s\\n\", hostip, string );</p>\n\n<p>perror(\"ERROR Connecting\");</p>\n\n<p>exit(1);</p>\n"}, {"tags": ["c", "embedded", "microcontroller", "interrupt"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491370402, "post_id": 43222519, "comment_id": 73515531, "body": "I don&#39;t suppose you know whether or not <code>_X</code> is <i>nul-terminated</i>, do you? Also, there is NO need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a> for thorough explanation."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1491370420, "post_id": 43222519, "comment_id": 73515540, "body": "You can use <code>strdup</code> (if you actually have a nul-terminated string). Not safer than <code>malloc</code>, though."}, {"owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "edited": false, "score": 0, "creation_date": 1491370460, "post_id": 43222519, "comment_id": 73515566, "body": "its null terminated, I make that sure by reserving the last byte and hard coding it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491370527, "post_id": 43222519, "comment_id": 73515596, "body": "Are you adding <code>+1</code> in your <code>malloc</code> call to provide space for it in <code>_Xp</code> before the <code>strcpy</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1491370531, "post_id": 43222519, "comment_id": 73515598, "body": "(1) Your information is accurate \u2014 <code>malloc()</code> is one of the least interrupt-safe routines around. (2) Don&#39;t do the memory allocation in the interrupt handler.  In your main loop, spot that an interrupt occurred so there is data to read and then allocate the buffer and read the data. (3) There&#39;s no particular reason to avoid <code>unsigned char</code> if that&#39;s the type you need to work with.  The only reason for caution is that the library functions almost all take <code>char *</code> and not <code>unsigned char *</code>, so using <code>unsigned char</code> can make things verbose."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1491370646, "post_id": 43222519, "comment_id": 73515644, "body": "You have two sane choices, but they both come down to doing less work in the interrupt handler. First, you can have a buffer already set up for the interrupt handler and have separate code that fills up the supply of buffers for the interrupt handler. Second, you can have the interrupt handler do nothing but tell other, non-interrupt code to handle whatever it is that needs to be handled. Essentially, do as little as possible in the interrupt handler, and you definitely don&#39;t need to allocate memory in it since that can be done any time."}, {"owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491371128, "post_id": 43222519, "comment_id": 73515847, "body": "@DavidC.Rankin _X is already one byte larger before hand, should I again add another byte?"}, {"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 0, "creation_date": 1491371155, "post_id": 43222519, "comment_id": 73515861, "body": "What sort of programming environment is the robot using? Does it have an operating system? Interrupt handlers should avoid doing heavy lifting; their interaction with user code is usually mediated by the OS, which allows <code>malloc</code> to be safe."}, {"owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491371216, "post_id": 43222519, "comment_id": 73515890, "body": "@DavidSchwartz the code is in a function that start only if I got an interruption and the received_data flag as been set to true, is it sufficient to make it safe?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491371523, "post_id": 43222519, "comment_id": 73516034, "body": "@A.albin - no. It is simply an accounting problem. If you have already accounted for the space required for the <i>nul-byte</i> there is no need to tack an extra on the end. It was just completely unclear from what you posted. The answer lies in the interrupt sensitivity described by the other commenters."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1491371538, "post_id": 43222519, "comment_id": 73516044, "body": "There are no stupid questions. You being a wood worker has nothing to do with the quality of your post, mainly because you did way more research than the novice &quot;professional&quot; programmer does on average today."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1491371610, "post_id": 43222519, "comment_id": 73516070, "body": "You can qualify that slightly by saying <i>&quot;the only stupid questions are the ones that go unasked&quot;</i> <code>:)</code> and if @A.albin writes the first bit of code to auto-square my Beismeir Fence System, I&#39;ll be the first to use it..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491371661, "post_id": 43222519, "comment_id": 73516098, "body": "@DavidC.Rankin - hehe, but I don&#39;t think going unasked attests to the inherent quality of the question :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491371706, "post_id": 43222519, "comment_id": 73516120, "body": "Granted........."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491377696, "post_id": 43222519, "comment_id": 73519518, "body": "Most likely, <a href=\"http://electronics.stackexchange.com/a/171581/6102\">using malloc doesn&#39;t even make any sense</a> in this application."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491395006, "post_id": 43222519, "comment_id": 73532004, "body": "Not only is it not safe, it is non-deterministic in terms if processing time and success /failure. strlen and strcpy are also poor choice for ISR; their execution time depends on string length, making the ISR less deterministic."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491412801, "post_id": 43222519, "comment_id": 73545475, "body": "1) On typical MCU environments, <code>malloc</code> &amp; friends should be avoided like hell. 2) They definitively must not be used in an interrupt handler. 3) Names starting with underscore at file-level are reserved for the implementation for all name-spaces. IOW: you must not define them in your code."}], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "edited": false, "score": 0, "creation_date": 1491372578, "post_id": 43222626, "comment_id": 73516496, "body": "OK, understood will update my variable names, even if I will be the only one using it."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "edited": false, "score": 0, "creation_date": 1491372695, "post_id": 43222626, "comment_id": 73516563, "body": "@A.albin - It&#39;s not to protect other people. The identifiers are reserved because sometimes the language updates with new keywords (for instance in 1999 <code>_Bool</code> was added and in 2011 <code>_Noreturn</code>). It&#39;d be a shame to have code break when a newer compiler is used."}, {"owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "edited": false, "score": 0, "creation_date": 1491373555, "post_id": 43222626, "comment_id": 73517045, "body": "I have to compile with gcc 3.8 (its an old hardware) I think I should have said it before...."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "edited": false, "score": 0, "creation_date": 1491380316, "post_id": 43222626, "comment_id": 73521218, "body": "@A.albin Even if you are using and old compiler, the underscore means the code might collide with identifiers used by the compiler. Most often this is not an issue - I&#39;ve maintained lots of code bases using such naming conventions and never encountered any bugs caused by it. But in theory, you could get unlucky and use the same identifier as the compiler."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1491371279, "last_edit_date": 1495535496, "creation_date": 1491370527, "answer_id": 43222626, "question_id": 43222519, "link": "https://stackoverflow.com/questions/43222519/malloc-alternative-for-interrupt-safety/43222626#43222626", "title": "malloc alternative for interrupt safety", "body": "<blockquote>\n  <p>1) is malloc really not interrupt safe?</p>\n</blockquote>\n\n<p><code>malloc</code> accesses and modifys a global resource, the common memory pool of you running program. If the access happens from two unsynchronized places, such as your normal program flow and the ISR<sup>1</sup>, then it can mess up the pool. If your ISR doesn't call <code>malloc</code> itself it won't be a problem.</p>\n\n<p>If it does, you'd need to put in place a system for preventing such reentry into <code>malloc</code>. For instance, wrap the call to <code>malloc</code> in a function that turns interrupt handling off, and then on again.</p>\n\n<blockquote>\n  <p>2) is there a more efficient way to initialize the buffer?</p>\n</blockquote>\n\n<p>If you need a buffer with allocated storage duration (i.e. that you decide when its lifetime ends, and not the scope it's allocated in) then there isn't really a standard C alternative. By the way, <code>sizeof(char)</code> is always 1, so no need to specify it. <a href=\"https://stackoverflow.com/a/605858/817643\">And since C allows implicit conversion of pointer types from <code>void*</code></a>, the call can at least be prettified a bit<sup>2</sup>:</p>\n\n<pre><code>char* _Xp = malloc(strlen((char*)_X));\n</code></pre>\n\n<blockquote>\n  <p>3) why are unsigned char \"bad\"?</p>\n</blockquote>\n\n<p>They aren't bad. In fact when you need to know exactly whether or not the character type is signed or not, you have to use <code>signed char</code> or <code>unsigned char</code>. The regular <code>char</code> can be signed on one platform and unsigned on another.</p>\n\n<hr>\n\n<p><sup>1</sup> Interrupt Service Routine.<br>\n<sup>2</sup> C has a notion of <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">reserved identifiers</a>. In particular, any identifier the starts with an underscore followed by an uppercase letter is always reserved. So renaming your variables may help with portability.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491379843, "last_edit_date": 1492086765, "creation_date": 1491379843, "answer_id": 43225460, "question_id": 43222519, "link": "https://stackoverflow.com/questions/43222519/malloc-alternative-for-interrupt-safety/43225460#43225460", "title": "malloc alternative for interrupt safety", "body": "<p>First of all, you say that you are using a bare metal microcontroller, so <a href=\"https://electronics.stackexchange.com/questions/171257/realloc-wasting-lots-of-space-in-my-mcu/171581#171581\">malloc never makes sense</a>. It is not a PC - you don't share your RAM with anyone else. So all the dangers and disadvantages of malloc don't even enter the discussion, since malloc makes no sense for you to use at all.</p>\n\n<blockquote>\n  <p>1) is malloc really not interrupt safe? information I found are from 2004.<br>\n  4) last question is strcpy also not interrupt safe? sources I read differ on that point.</p>\n</blockquote>\n\n<p>No function using shared resources between an ISR and the main application is interrupt safe. You should avoid calling library functions from an ISR, they should be kept minimal.</p>\n\n<p>All data shared between an ISR and the caller has to be treated with care. You <em>must</em> ensure atomic access of individual objects. You <em>must</em> declare such variables as <code>volatile</code> to prevent optimizer bugs. You might have to use semaphores or other synchronization means. This applies to all such data, whether you change it by yourself or through a library function.</p>\n\n<p>Failing to do all of the above will lead to very mysterious and subtle bugs, causing data corruption, race conditions or code that is never executed. Overall, interrupts are always hard to work with because of all this extra complexity. Only use them when your real-time requirements give you no other options.</p>\n\n<blockquote>\n  <p>2) is there a more efficient way to initialize the buffer?</p>\n</blockquote>\n\n<p>Yes, use an array. <code>static char _Xp [LARGE_ENOUGH_FOR_WORST_CASE];</code> Usually it is a good idea to keep such buffers in the <code>.data</code> segment rather than on the stack, hence the <code>static</code> keyword.</p>\n\n<blockquote>\n  <p>3) why are unsigned char \"bad\"? (read something about that).</p>\n</blockquote>\n\n<p>There is nothing bad with them as such. The different <code>char</code> types are problematic though, because in theory they could have other sizes than 8 bits. Worse, <code>char</code> without signed/unsigned has <em>implementation-defined signedness</em>, meaning it might be signed <em>or</em> unsigned depending on compiler. Meaning that you should <em>never</em> use the <code>char</code> type for storing anything else but text strings.</p>\n\n<p>If you need a variable type to hold bytes of data, always use <code>uint8_t</code> from stdint.h.</p>\n\n<blockquote>\n  <p>As the robot could do bad &amp; dangerous things, I try to make every parts safe (at least as much as I can).</p>\n</blockquote>\n\n<p>Writing safe software for embedded systems is a highly qualified task. I wouldn't recommend anyone with less than 5 years of experience working full-time with embedded firmware programming to even consider it, unless there's at least one hardened C veteran who is part of your team and all code passes through peer review and static analysis.</p>\n\n<p>It sounds like you would benefit a lot from reading through the MISRA-C:2012 coding guidelines. It is a safe subset of the C language, intended to be used in safety-critical applications, or any form of application where bugs are bad. Unfortunately the MISRA-C document is not free, but it is becoming an industry standard.</p>\n"}], "owner": {"reputation": 264, "user_id": 7795069, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e5b1c663655ddc6d4810ea996adc9eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A.albin", "link": "https://stackoverflow.com/users/7795069/a-albin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1600, "favorite_count": 0, "accepted_answer_id": 43222626, "answer_count": 2, "score": 3, "last_activity_date": 1491380014, "creation_date": 1491370077, "last_edit_date": 1491380014, "question_id": 43222519, "link": "https://stackoverflow.com/questions/43222519/malloc-alternative-for-interrupt-safety", "title": "malloc alternative for interrupt safety", "body": "<p>Once again, Im not a developer but a wood worker so my questions might be, well, stupid.</p>\n\n<p>I forgot something really important I've to use gcc-3.8 to compile as the original code I'm working with can't compile with newer version. I totaly forgot to talk about that, sorry.</p>\n\n<p>I'm sending data from a tool to an autonomous robot.\nRobot receive data as unsigned char*\nI read a lot and it seems that malloc isn't interrupt safe.</p>\n\n<p>As the robot could do bad &amp; dangerous things, I try to make every parts safe (at least as much as I can).</p>\n\n<p>This malloc happens after an interrupt raised by data received.\nThis code segment is now giving me an hard time to make it safe, also my syntax is probably bad..</p>\n\n<pre><code>char* _Xp = (char*) malloc(strlen((char*)_X)*sizeof(char));\nstrcpy(_Xp, (char*)_X);\n</code></pre>\n\n<p>1) is malloc really not interrupt safe? information I found are from 2004.</p>\n\n<p>2) is there a more efficient way to initialize the buffer?</p>\n\n<p>3) why are unsigned char \"bad\"? (read something about that).</p>\n\n<p>4) last question is strcpy also not interrupt safe? sources I read differ on that point.</p>\n\n<p>===== \nanswering some questions:</p>\n\n<p>Robot doesn't have operating system, target is an STR911FFM44 at 25Mhz (if it helps)</p>\n\n<p>Input arrays are all nul-terminated.</p>\n\n<p>Code is not in the interruption handler but in the infinite loop and processed only if the IrHandler as set the flag for it.</p>\n\n<p>I don't know the rate of the data stream to \"hard code\" the safety. but interruption should be in [500ms to 1500ms].</p>\n"}, {"tags": ["c", "arrays", "function-call"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491369290, "post_id": 43222269, "comment_id": 73515124, "body": "<code>Right here, why can&#39;t I use &#39;a&#39; instead of &#39;a+n&#39;</code>...what do you mean?"}, {"owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491452188, "post_id": 43222269, "comment_id": 73560828, "body": "My bad I meant to say &#39;Why can&#39;t I use &#39;n&#39; instead of having to use &#39;a+n&#39;&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "edited": false, "score": 0, "creation_date": 1491452600, "post_id": 43222290, "comment_id": 73560927, "body": "I understand that they aren&#39;t the same type, but that&#39;s how my professor showed us how to pass arrays as an argument or I guess a pointer to an array? The program could be written differently but we had to use pointers. I want to know if there is a proper way of passing an array to a function, or if I&#39;m doing it right and I&#39;m being worried for nothing. This entire pointer business is super confusing."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1491369925, "last_edit_date": 1491369925, "creation_date": 1491369025, "answer_id": 43222290, "question_id": 43222269, "link": "https://stackoverflow.com/questions/43222269/warning-messages-for-all-of-my-functions-using-pointers-expected-int-but-arg/43222290#43222290", "title": "Warning messages for all of my functions using pointers. Expected &#39;int*&#39; but argument is of type &#39;int (*)[10]&#39;", "body": "<p>I think the error message is pretty self-describing.</p>\n\n<p>In your code, <code>a</code> is an array type, having <code>int [10]</code>. You pass <code>&amp;a</code>, which is of type <em>pointer to an array of 10 <code>int</code>s</em>, or, <code>int (*)[10]</code> which is not the same type as a pointer to <code>int</code>, i.e., <code>int *</code>. Hence the compiler screams.</p>\n\n<p>As array type variables decay to the pointer to the first element of the array while passed as function arguments, you should call your function like</p>\n\n<pre><code> readarray(a);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491369925, "creation_date": 1491368894, "last_edit_date": 1491369125, "question_id": 43222269, "link": "https://stackoverflow.com/questions/43222269/warning-messages-for-all-of-my-functions-using-pointers-expected-int-but-arg", "title": "Warning messages for all of my functions using pointers. Expected &#39;int*&#39; but argument is of type &#39;int (*)[10]&#39;", "body": "<p>The code works fine I'm just worried about the warning messages I'm getting, would there be a way to make them not appear? Is there any reason to be worried about them? Also farther down in the code I don't quite understand what I did or why it worked. It wasn't working before so I looked up what other people did with pointers and it works now</p>\n\n<pre><code>Warning passing argument 1 of 'readarray' from incompatible pointer type [-wincomp\nreadarray(&amp;a);\n          ^\nnote: expected 'int*' but argument is of type 'int(*)[10]'\nvoid readarray (int*);\n     ^\n</code></pre>\n\n<p>This is the warning message, I get it for each of my functions^^^^^^^^^^^^^^^^^^</p>\n\n<p>I understand why it's having issues, I think, but I don't understand how I could change anything</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define n 10\n\nvoid readarray (int*);\nint findmaxvalue(int*);\nvoid reversearray(int*, int*);\nvoid printarray(int*);\n\nint main(void)\n{\n        int a[n], i, b[n];\n\n        for (i = 0; i &lt; n; i++)\n        {\n                a[i] = 0;\n        }\n        for (i = 0; i &lt; n; i++)\n        {\n                b[i] = 0;\n        }\n\n        readarray(&amp;a);\n        findmaxvalue(&amp;a);\n        reversearray(&amp;a, &amp;b);\n        printarray(&amp;b);\n\n    return 0;\n    }\n\n\nvoid readarray (int *a)\n{\n        int *q;\n\n        q = a;\n        printf(\"Enter up to 10 numbers. Terminate by entering a 0\\n\");\n</code></pre>\n\n<p>Right here, why can't I use 'a' instead of 'a+n'</p>\n\n<pre><code>        for(q = a; q &lt; a+n; q++)\n        {\n                scanf(\"%d\", q);\n                if (*q == 0)\n                        break;\n        }\n        printf(\"\\n\");\n}\n\n\nint findmaxvalue(int *a)\n{\n        int i, max;\n\n        max = a[0];\n        for (i = 1; i &lt; n; i++)\n        {\n                if (a[i] &gt; max)\n                        max = a[i];\n        }\n        printf(\"The highest element in the array is: %d\\n\\n\", max);\n        return max;\n}\n\n\nvoid reversearray(int *a, int *b)\n{\n        int *i, *j, t;\n\n        for (i = a; i &lt; a+n; i++)\n        {\n                for (j = i + 1; j &lt; a+n; j++)\n                {\n                        if (*j &lt; *i)\n                        {\n                                t = *j;\n                                *j = *i;\n                                *i = t;\n                        }\n                }\n        }\n\n        for (i = a + n - 1, j = b; i &gt; a; i--, j++)\n        {\n                *j = *i;\n        }\n}\n\nvoid printarray(int *b)\n{\n        int *q;\n\n        q = b;\n        printf(\"The reversed array in descending order is:\\n\");\n        for (q = b; q &lt; b+n; q++)\n        {\n                printf(\"%d  \", *q);\n        }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory-management", "heap-memory"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 8, "creation_date": 1491365898, "post_id": 43221684, "comment_id": 73513941, "body": "You call <code>memset(ptr...</code> after <code>free(ptr)</code>  ? Obviously this is undefined behaviour"}, {"owner": {"reputation": 3416, "user_id": 2484972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea1c4b2c5aa3c7da2f2740bc1a643ee0?s=128&d=identicon&r=PG", "display_name": "Tatsuyuki Ishi", "link": "https://stackoverflow.com/users/2484972/tatsuyuki-ishi"}, "edited": false, "score": 0, "creation_date": 1491367591, "post_id": 43221684, "comment_id": 73514523, "body": "Freed memory must not be touched. Use tools like Valgrind to debug memory errors instead."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491368369, "post_id": 43221684, "comment_id": 73514819, "body": "After assert, why&#39;d you check for NULL again?"}, {"owner": {"reputation": 738, "user_id": 4699294, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WzHD5.jpg?s=128&g=1", "display_name": "Dinesh Maurya", "link": "https://stackoverflow.com/users/4699294/dinesh-maurya"}, "edited": false, "score": 1, "creation_date": 1491368793, "post_id": 43221684, "comment_id": 73514963, "body": "@Sauav Ghosh, basically the assert which is used here is not standard C++ language assert. This is a custom assert which is disabled in release builds."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491369189, "post_id": 43221684, "comment_id": 73515088, "body": "@DineshMaurya So, then it&#39;s not relevant. Either don;t show the call, or show the full implementation. <b>Don&#39;t confuse people, please</b>."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1491369711, "post_id": 43221684, "comment_id": 73515286, "body": "The normal assert is disabled in release builds. Well, it&#39;s disabled when you define <code>NDEBUG</code>, which nearly everybody does for a release build, anyway."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1491380001, "post_id": 43221684, "comment_id": 73521002, "body": "I suspect part of your problem might be that you&#39;re not sure in which language you&#39;re programming. You talk about C++ asserts, but then use C functions like <code>free</code> and <code>memset</code>. In C++, the things you&#39;re trying to do (like custom deallocators) are much better supported than in C; the Standard C++ library has direct support for them in <code>std::shared_ptr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1491369692, "last_edit_date": 1491369692, "creation_date": 1491368728, "answer_id": 43222231, "question_id": 43221684, "link": "https://stackoverflow.com/questions/43221684/can-calling-memset-on-a-dynamically-allocated-memory-cause-heap-corruption/43222231#43222231", "title": "Can calling memset on a dynamically allocated memory cause heap corruption", "body": "<blockquote>\n  <p><em>To just verify that the segmentation fault is not because of allocated memory not being set to NULL after deallocation</em></p>\n</blockquote>\n\n<p>Well, that's not how you debug dynamically allocated memory related problem. A pointer containing <code>NULL</code> is as invalid as a pointer which has been already passed to <code>free()</code> memory, in terms of further deallocation. </p>\n\n<p>So, whether an already <code>free()</code>-d pointer is (<em>manually</em>) set to <code>NULL</code> or not, further usage (dereference) of that pointer will cause <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, you may or may not get a segmentation fault, for certain, it's just one of many side effects of having UB.</p>\n\n<p>You need to use a memory debugger, like valgrind to catch and resolve the issue.</p>\n\n<p>FWIW, any attempt of using invalid memory (including <code>NULL</code>, yes) invokes UB, avoid that.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1491369294, "creation_date": 1491369294, "answer_id": 43222344, "question_id": 43221684, "link": "https://stackoverflow.com/questions/43221684/can-calling-memset-on-a-dynamically-allocated-memory-cause-heap-corruption/43222344#43222344", "title": "Can calling memset on a dynamically allocated memory cause heap corruption", "body": "<blockquote>\n  <p>So my question is how and in what scenario a call to memset() can cause heap corruption.</p>\n</blockquote>\n\n<p>Any time you use it to modify memory that might be being used to track the internal structure of the heap. For example, memory that you just told the heap allocator that you were finished with and that it was now free to use for any purpose such as, for example, tracking the internal structure of the heap.</p>\n"}], "owner": {"reputation": 738, "user_id": 4699294, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WzHD5.jpg?s=128&g=1", "display_name": "Dinesh Maurya", "link": "https://stackoverflow.com/users/4699294/dinesh-maurya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1273, "favorite_count": 0, "accepted_answer_id": 43222344, "answer_count": 2, "score": -1, "last_activity_date": 1491369692, "creation_date": 1491365648, "last_edit_date": 1491369236, "question_id": 43221684, "link": "https://stackoverflow.com/questions/43221684/can-calling-memset-on-a-dynamically-allocated-memory-cause-heap-corruption", "title": "Can calling memset on a dynamically allocated memory cause heap corruption", "body": "<p>While debugging a segmentation fault in a real project, where the crash happens after a long run with random testing which are not easy to reproduce. Crash point shows crash in a function which is written something like</p>\n\n<pre><code>void deallocateObject( objectType* ptr)\n{\n    ASSERT(ptr);\n    if(!ptr)\n        return;\n    if(ptr-&gt;customDeallocator)\n        ptr-&gt;customDeallocator-&gt;deallocate();\n    else\n        free(ptr);\n}\n</code></pre>\n\n<p>There are various kind of allocator and deallocator being used in the project.\nTo just verify that the segmentation fault is not because of allocated memory not being set to NULL after deallocation, I added a call to memset after the last statement in this function.</p>\n\n<pre><code>memset(ptr, 0, sizeof(objectType));\n</code></pre>\n\n<p>But after this change I started getting crash every time with message saying heap is corrupted.</p>\n\n<p>So my question is how and in what scenario a call to memset() can cause heap corruption.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1491365016, "post_id": 43221532, "comment_id": 73513674, "body": "tldr; post a minimal example."}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1491365160, "post_id": 43221532, "comment_id": 73513707, "body": "i tried to reduce it. the original server is *much larger"}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1491365224, "post_id": 43221532, "comment_id": 73513730, "body": "i know its a bit large, but any help would be greatly appreciated.  I was specifically wondering if declaring a global struct which holds a buffer for thread communication is bad or not."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1491367327, "post_id": 43221532, "comment_id": 73514433, "body": "@MattBorg about good-bad global structs, take a look here <a href=\"http://stackoverflow.com/questions/484635/are-global-variables-bad\" title=\"are global variables bad\">stackoverflow.com/questions/484635/are-global-variables-bad</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491368889, "post_id": 43221532, "comment_id": 73514994, "body": "Step 1: make sure your ring buffer works single-threaded.  If that&#39;s not working, you&#39;re hosed.  Write test code specifically for that.  I assume you&#39;ve already done test code for the list which is why you assert that is OK \u2014 if not, test that, too.   Step 2: Do you need semaphores or mutexes for the threads in the server?  Devise a way of testing whether your semaphore code is working without using the ring buffer.  Or, if that&#39;s not feasible, print lots of diagnostic information \u2014 or get good at debugging multithreaded programs (or both).    Please read about creating an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "edited": false, "score": 0, "creation_date": 1491370011, "post_id": 43221532, "comment_id": 73515398, "body": "ty Jonathan.  I&#39;ll test it with one thread, thats a good idea ..should&#39;ve done that.  I think the problem may be that i declared my &#39;ring-buffer&#39; struct as a global struct; I wanted all threads of a process to see it, but i already passed a linked list via the arg for pthread().   Methinks the problem is that, yes all threads of a process can see it ...but i&#39;m thinking all processes see it as well.  Im trying to implement a buffer for each process/thread combo ..not a buffer across proceses.              .........any thoughts from anyone on this would be most appreciated."}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "edited": false, "score": 0, "creation_date": 1491370867, "post_id": 43221532, "comment_id": 73515740, "body": "..bah ..just read that fork() creates copys for children ...i just dunno whats wrong."}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "edited": false, "score": 0, "creation_date": 1491372089, "post_id": 43221532, "comment_id": 73516282, "body": "ran it with 1 thread per child as suggested.   ..i&#39;m &quot;hosed&quot; as suggested above."}, {"owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "edited": false, "score": 0, "creation_date": 1491375005, "post_id": 43221532, "comment_id": 73517812, "body": "don&#39;t give up, just make it work :-)"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "edited": false, "score": 0, "creation_date": 1491427411, "post_id": 43226601, "comment_id": 73553933, "body": "The idea i&#39;m trying for is that each child *DOES have its own buffer. Buffer is not to be shared among children. Each child will have several write and 1 read threads which communicate inside the process with their own buffer.  Then each writer thread will eventually write all info to a log using a file lock."}, {"owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "edited": false, "score": 0, "creation_date": 1491427478, "post_id": 43226601, "comment_id": 73553973, "body": "I read that threads can see info from each other in 1 of two ways.l Either a global variable or memory declared on the heap.  From what i understand the stack for each thread can only be accessed by said thread."}], "tags": [], "owner": {"reputation": 1, "user_id": 6716773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad8a5bc35c8e679d256535295f65269?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Uvarov", "link": "https://stackoverflow.com/users/6716773/yuri-uvarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1491383097, "creation_date": 1491383097, "answer_id": 43226601, "question_id": 43221532, "link": "https://stackoverflow.com/questions/43221532/producer-consumer-semaphore-thread-safety/43226601#43226601", "title": "Producer Consumer Semaphore Thread Safety", "body": "<p>The problem is that fork() do not share global variables. Child and parent processes have their own copies of buffer. You should use shared memory for this purpose.</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "is_accepted": false, "score": 0, "last_activity_date": 1491459900, "creation_date": 1491459900, "answer_id": 43247303, "question_id": 43221532, "link": "https://stackoverflow.com/questions/43221532/producer-consumer-semaphore-thread-safety/43247303#43247303", "title": "Producer Consumer Semaphore Thread Safety", "body": "<p>for those unfortunate enough to come here for answers, i've managed to outline a solution.  I fixed two things in my main server</p>\n\n<ol>\n<li><p>i got rid of the global buffer, ..just risky business. The initial problem is that when pthread_create is called, only 1 arg can be passed (see man pages).  I needed alot of info to pass, so i made a 'super-control-struct' consisting of the inter-thread-ring-buffer and all info needed for thread operations and passed that</p></li>\n<li><p>Semaphores and loops can be tricky. </p></li>\n<li><p>my basic approach *seems to work. many producer threads process info, push to buffer, 1 writer thread per child  writes to a log.txt. Use a ring buffer on the heap to reference a linked list on same heap. </p></li>\n</ol>\n\n<p>..now i tackle the memory leaks and im done. </p>\n"}], "owner": {"reputation": 85, "user_id": 7817722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa81d4deab26643585906bbf2d139895?s=128&d=identicon&r=PG&f=1", "display_name": "MattBorg", "link": "https://stackoverflow.com/users/7817722/mattborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1491459900, "creation_date": 1491364597, "last_edit_date": 1491368576, "question_id": 43221532, "link": "https://stackoverflow.com/questions/43221532/producer-consumer-semaphore-thread-safety", "title": "Producer Consumer Semaphore Thread Safety", "body": "<p>I have a programming question regarding C on Linux.  The below code is a 'snapshot' of a larger server I'm trying to code.</p>\n\n<p>To explain, I want to:</p>\n\n<ol>\n<li>fork() multiple children processes in server to handle requests generated by parent process or a client or whoever</li>\n<li>Each child process has several producer (writer) threads and 1 consumer (reader) thread</li>\n<li>Ring buffer of pointers hold info written to and read by threads</li>\n<li>Producer threads retrieve a string from a linked list (node->string) and 'push' node->string to a ring buffer of pointers read by consumer</li>\n<li>Consumer thread 'pops' from ring buffer and writes to some stream (file, stdout, etc) </li>\n<li>I use POSIX semaphores to try and synchronize access to the Ring Buffer between threads (and here is probably the problem)</li>\n</ol>\n\n<p>My Ring Buffer does not work. I'm not sure if I coded the buffer poorly or if the semaphores aren't working as I hoped. </p>\n\n<p>I included 'server.c' and 'circbuff.c'  there is also a linkedlist.h library but I'm confident that it works</p>\n\n<p>POSSIBLE PROBLEMS?</p>\n\n<ol>\n<li><p>I declare buffer_t buffer (ring buffer) globally. I do not malloc it.</p></li>\n<li><p>????</p></li>\n</ol>\n\n<p>Anyone who would could help would really be appreciated. </p>\n\n<p>Recommendations on how to get threads to talk with a linked list or ring buffer are most welcome.</p>\n\n<p>Output is always different, but it always pushes more to the ring buffer than it pops.</p>\n\n<p>OUTPUT: ..format = 'PUSH: child  line# thread'</p>\n\n<pre><code>PUSH: 2264 line 0      thread: 139746191480576\nPUSH: 2264 line 0      thread: 139746183087872\nPUSH: 2264 line 1      thread: 139746183087872\nBuffer underflow\npop 0  \nBuffer underflow\npop 0  \nBuffer underflow\npop 0  \nPUSH: 2275 line 0      thread: 139746191480576\nPUSH: 2275 line 0      thread: 139746191480576\n</code></pre>\n\n<p>More OUTPUT</p>\n\n<pre><code>PUSH: 4208 line 0      thread: 140707316717312\nPUSH: 4208 line 1      thread: 140707316717312\nPUSH: 4208 line 2      thread: 140707316717312\nPUSH: 4208 line 3      thread: 140707316717312\nPUSH: 4208 line 4      thread: 140707316717312\nPUSH: 4208 line 5      thread: 140707316717312\npop 4208 line 0    \npop 4208 line 0\n</code></pre>\n\n<h3>SERVER.C</h3>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;fcntl.h&gt;\n    #include &lt;sys/shm.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;sys/mman.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;semaphore.h&gt;\n    #include &lt;dirent.h&gt;\n    #include &lt;sys/wait.h&gt;\n    #include &lt;errno.h&gt;\n\n    #include \"circbuff.h\"\n    #include \"server.h\"\n\n\n    #define SNAME \"/OS\"\n\n    #define MAXDIRPATH 1024\n    #define MAXKEYWORD 256\n    #define MAXLINESIZE 1024\n    #define MAXOUTSIZE 2048\n\n\n    sem_t * sem_wrt;\n    sem_t * sem_empty;\n    sem_t * sem_full;\n    sem_t * sem_mutex;\n\n    buffer_t buffer;             //a circular buffer pointer array that reads info from a linked list\n    void * producer(void *arg);  //thread producer\n    void * consumer(void *arg);  //thread consumer\n\n    int main( int argc, char *argv[]){\n\n    if (argc != 3){\n        printf(\"Three arguements required .../client &lt;arbitrary&gt; &lt;**buffer_size**&gt;\\n\");\n        exit(0);\n        }\n\n    int reqsize= atoi(argv[1]);\n    int bbuff= atoi(argv[2]);\n    //buffer_t *buf; \n    int qbuffsize= reqsize*(MAXDIRPATH+MAXKEYWORD);\n\n    //char tok1[MAXDIRPATH];\n    //char tok2[MAXKEYWORD]; \n    int child_num, status; \n\n      /*** Semaphore open */  \n    sem_wrt=sem_open(\"/sem_wrt\", O_CREAT, S_IRUSR | S_IWUSR, 1);\n        if (sem_wrt == SEM_FAILED) {\n        perror(\"server: sem_open failed for semaphone sem_wrt\");\n        return EXIT_FAILURE;\n    }\n    sem_empty=sem_open(\"/sem_empty\", O_CREAT, S_IRUSR | S_IWUSR, bbuff); //semaphore waits for bbuff number of things to stop process\n        if (sem_empty == SEM_FAILED) {\n        perror(\"server: sem_open failed for semaphone sem_empty\");\n        return EXIT_FAILURE;\n    }\n    sem_full=sem_open(\"/sem_full\", O_CREAT, S_IRUSR | S_IWUSR, 0);\n        if (sem_full == SEM_FAILED) {\n        perror(\"server: sem_open failed for semaphone sem_full\");\n        return EXIT_FAILURE;\n    }\n    sem_mutex=sem_open(\"/sem_mutex\", O_CREAT, S_IRUSR | S_IWUSR, 1);\n        if (sem_mutex == SEM_FAILED) {\n        perror(\"server: sem_poen failed for semaphone sem_mutex\");\n        return EXIT_FAILURE;\n        }\n\n\n    /* Create 4 child processes (each will have 11 threads per below, 1 producer, 10 consumers) */\n    pid_t pid;\n    int ct;\n    for(ct=0; ct&lt;4; ct++){\n\n        pid=fork();  //make 5 children\n        child_num++;\n    }\n\n\n\n\n    if(pid==0){//IF CHILD PROCESS\n\n        struct ThreadList* t_list=NULL;  //delcare a list of threads \n        t_list= create_list();           //create the list of  thread_info_nodes             \n\n        init(&amp;buffer, bbuff);   //initial circular buffer (declared GLOBALLY), which to multiple threads write, 1 thread reads\n\n        pthread_t ctid;                                 //consumer thread id\n        pthread_create(&amp;ctid, NULL, consumer, t_list);  //create one consumer/writer/pop-list thread \n\n\n        /* make n_cnt producer threads (10 threads) that take node-&gt;string from a linked list and push to a ring buffer of pointers */\n        int n_cnt; \n        for(n_cnt=0; n_cnt&lt;10; n_cnt++){\n            struct thread_info_node *tnode = malloc(sizeof(struct thread_info_node));//make a node on the heap\n            init_tnode(tnode, n_cnt, NULL, \" line \");                                //initialize node info ..a string\n            insert_tail( tnode, t_list);                                             //insert node to tail of list\n            pthread_create( &amp;(tnode-&gt;tid), NULL, producer, t_list);                  //create a few producer threads that read list\n        }\n\n\n\n        //When child process is done, close semaphores to release resources used by child\n        sem_close(sem_wrt);  \n        sem_close(sem_empty);  \n        sem_close(sem_full);   \n        sem_close(sem_mutex);\n    }\n\n    else{// if the PARENT\n        /*wait for child processes to finish*/\n        int cnt;\n        for(cnt=0; cnt &lt; child_num ; cnt++){\n            waitpid(-1, &amp;status, 0);}\n\n\n        sem_close(sem_wrt);  \n        sem_close(sem_empty);  \n        sem_close(sem_full);   //printf(\"close sem_full= %d\\n\", sem_close(sem_full)   );  \n        sem_close(sem_mutex);\n\n\n        sem_unlink(\"/sem_wrt\"); \n        sem_unlink(\"/sem_empty\");  \n        sem_unlink(\"/sem_full\"); //printf(\"unlink sem_full= %d\\n\", sem_unlink(\"/sem_full\")   );  \n        sem_unlink(\"/sem_mutex\");\n\n        }\n\n\nreturn 0; \n}\n\n\nvoid * producer(void *arg){\n\n    struct ThreadList *list = arg;  \n    struct thread_info_node *tmp = list-&gt;head;\n    pthread_t tid= pthread_self(); \n    char thread_id[MAXLINESIZE]; \n\n  /* push all but last string from linked list*/ \n  // I AM PUSHING ONLY THE 'node-&gt;string' value, not the whole node.  IS THIS THE WR0NG WAY TO DO IT??? \n    while(tmp-&gt;next != NULL){\n\n        sem_wait(sem_empty); //decrement empty. if 0 no more empty, stop process.  \n        sem_wait(sem_mutex);\n\n        /*** CRITICAL SECTION ***/\n        snprintf(thread_id, 10,  \"%lu\", tid);\n        //strcat(tmp-&gt;filename, thread_id);\n        printf(\"PUSH: %s    thread: %lu\\n\", tmp-&gt;filename, tid);\n        push( &amp;buffer, tmp-&gt;filename );\n        ///--------------------//\n\n        sem_post(sem_mutex);\n        sem_post(sem_full); \n\n        tmp= tmp-&gt;next;\n    }\n\n  /* push last string left in linked list, and an exit message for the consumer */  \n    sem_wait(sem_empty); //decrement empty. if 0 no more slots empty, stop process.  \n    sem_wait(sem_mutex);\n\n    /*** CRITICAL SECTION ***/\n    snprintf(thread_id, 10,  \"%lu\", tid);\n    strcat(tmp-&gt;filename, thread_id);\n    printf(\"PUSH: %s\\n\", tmp-&gt;filename);\n    push( &amp;buffer, tmp-&gt;filename );\n\n    printf(\"SPECIAL_EXIT_CODE\\n\");\n    push( &amp;buffer, \"SPECIAL_EXIT_CODE\"); \n    ///--------------------//\n\n    sem_post(sem_mutex);\n    sem_post(sem_full);\n\n    return NULL;    \n}\n\n\nvoid * consumer(void *arg){\n\n//struct ThreadList *list = arg;    \n\nchar outline[MAXOUTSIZE]; \n\n    while(1){ \n\n     sem_wait(sem_full);\n     sem_wait(sem_mutex); \n          /******* CRITICAL SECTION ******/ \n\n          //printf(\"==&gt;CONSUMER THREAD\\n\");\n          strcpy(outline, popqueue(&amp;buffer)); \n          printf(\"pop %s  \\n\",  outline );\n\n          if (strcmp(outline,\"SPECIAL_EXIT_CODE\")==0) break;\n\n\n          /********************************/\n      sem_post(sem_mutex);\n      sem_post(sem_empty); \n\n\n    }//end WHILE*/\n\n    return NULL;\n}\n</code></pre>\n\n<h3>CIRCBUFF.H</h3>\n\n<pre><code>#ifndef __CIRCBUFF_h__\n#define __CIRCBUFF_h__\n\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXDIRPATH 1024\n#define MAXKEYWORD 256\n#define MAXLINESIZE 1024\n#define MAXOUTSIZE 2048\n\n\nstruct buffer {\n    int size;\n    int start;\n    //int end;  // position of last element\n    /* Tracking start and end of buffer would waste\n     * one position. A full buffer would always have\n     * to leave last position empty or otherwise\n     * it would look empty. Instead this buffer uses\n     * count to track if buffer is empty or full\n     */\n    int count; // number of elements in buffer\n    /* Two ways to make buffer element type opaque\n     * First is by using typedef for the element\n     * pointer. Second is by using void pointer.\n     */\n    /* different types of buffer: \n    int *element;   // array of integers\n    char *element;  // array of characters \n    void *element;  // array of void type (could cast to int, char, etc)\n    char **element; //array of char pointers (array of strings)\n    void **element; // array of void pointers\n    Choosing array of void pointers since it's the most flexible */\n    void **element;\n\n};\n\ntypedef struct buffer buffer_t;\n\nvoid init(buffer_t *buffer, int size) {\n    buffer-&gt;size = size;\n    buffer-&gt;start = 0;\n    buffer-&gt;count = 0;\n    //buffer-&gt;element = malloc(sizeof(buffer-&gt;element)*size);\n    /* allocated array of void pointers. Same as below */\n    //buffer-&gt;element = malloc(sizeof(void *) * size);\n\n    /* Allocate array of char poitners*/\n    buffer-&gt;element = malloc(sizeof(char **) * size);\n\n}\n\nint full(buffer_t *buffer) {\n    if (buffer-&gt;count == buffer-&gt;size) { \n        return 1;\n    } else {\n        return 0;\n    }\n}\n\nint empty(buffer_t *buffer) {\n    if (buffer-&gt;count == 0) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\nvoid push(buffer_t *buffer, void *data) {\n    int index;\n    if (full(buffer)) {\n        printf(\"Buffer overflow\\n\");\n    } else {\n        index = buffer-&gt;start + buffer-&gt;count; \n        if (index &gt;= buffer-&gt;size) {\n            index = 0;\n            //index= index - buffer-&gt;size;//6 \n        }\n        buffer-&gt;element[index] = data;\n        buffer-&gt;count++;\n    }\n}\n\n\nvoid * popqueue(buffer_t *buffer) {\n    void * element;\n    if (empty(buffer)) {\n        printf(\"Buffer underflow\\n\");\n        return \"0\";\n    } else {\n       /* FIFO implementation */\n       element = buffer-&gt;element[buffer-&gt;start];\n       buffer-&gt;start++;\n       buffer-&gt;count--;\n       if (buffer-&gt;start == buffer-&gt;size) {\n           buffer-&gt;start = 0;\n       }\n\n       return element;\n    }\n}\n\nvoid * popstack(buffer_t *buffer) {\n    int index;\n    if (empty(buffer)) {\n        printf(\"Buffer underflow\\n\");\n        return \"0\";\n    } else {\n        /* LIFO implementation */\n        index = buffer-&gt;start + buffer-&gt;count - 1;\n        if (index &gt;= buffer-&gt;size) {\n           index = buffer-&gt;count - buffer-&gt;size - 1;\n           //index= index-buffer-&gt;size\n           //index = buffer-&gt;count \u2013 buffer-&gt;size \u2013 1;\n        }      \n        buffer-&gt;count--;\n        return buffer-&gt;element[index];\n    }\n}\n\n#endif\n</code></pre>\n"}, {"tags": ["c", "console", "operating-system", "printf"], "answers": [{"tags": [], "owner": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "is_accepted": true, "score": 4, "last_activity_date": 1491364985, "creation_date": 1491364985, "answer_id": 43221581, "question_id": 43221509, "link": "https://stackoverflow.com/questions/43221509/what-is-the-function-of-0x0700-in-cga-putc/43221581#43221581", "title": "What is the function of 0x0700 in cga_putc?", "body": "<p>Read it through. </p>\n\n<blockquote>\n  <p>~0xFF: invert 0xFF, i.e 0xFFFFFF00 if using a 32 bit number</p>\n  \n  <p>c &amp; 0xffffff00: look at the high order bits</p>\n  \n  <p>if (!c): if no high order bits, set the high order bits to 0x0700;</p>\n</blockquote>\n\n<p>The purpose of this is pretty much explained in the preceding comment:</p>\n\n<blockquote>\n  <p>// if no attribute given, then use black on white</p>\n</blockquote>\n\n<p>Highly likely that the high order bits are controlling the FG and BG color of the text. </p>\n"}], "owner": {"reputation": 1194, "user_id": 5685664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f2211f38f9402a40441b9781b614d60?s=128&d=identicon&r=PG&f=1", "display_name": "Jiahao Cai", "link": "https://stackoverflow.com/users/5685664/jiahao-cai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 43221581, "answer_count": 1, "score": 2, "last_activity_date": 1491364985, "creation_date": 1491364407, "question_id": 43221509, "link": "https://stackoverflow.com/questions/43221509/what-is-the-function-of-0x0700-in-cga-putc", "title": "What is the function of 0x0700 in cga_putc?", "body": "<p>I am studying for <a href=\"https://pdos.csail.mit.edu/6.828/2011/schedule.html\" rel=\"nofollow noreferrer\">Operating System Engineering</a> recently, and I found a \"magic number\" that I can't figure out in the <code>kern/console.c</code> when I tried to read the source code.</p>\n\n<p>Basically, <code>static void cga_putc(int c)</code> in <a href=\"https://raw.githubusercontent.com/Jameeeees/MIT-JOS/master/lab1/kern/console.c\" rel=\"nofollow noreferrer\"><code>kern/console.c</code></a> is a function for output the character to the console, it is used by <code>cprintf</code> in this kernel.</p>\n\n<pre><code>static void cga_putc(int c)\n{\n    // if no attribute given, then use black on white\n    if (!(c &amp; ~0xFF))\n        c |= 0x0700;\n\n    switch (c &amp; 0xff) {\n    case '\\b':\n        ...\n    case '\\n':\n        ...\n    default:\n        crt_buf[crt_pos++] = c;     /* write the character */\n        break;\n    }\n    ...\n}\n</code></pre>\n\n<p>However, I don't understand the function of <code>if (!(c &amp; ~0xFF)) c |= 0x0700;</code>, can anybody help me with this? I don't know which material I should look at.</p>\n"}, {"tags": ["c++", "c", "linux", "serial-port"], "comments": [{"owner": {"reputation": 61, "user_id": 6525559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Plq5HkQuX-4/AAAAAAAAAAI/AAAAAAAAAMc/XTBNHSSl_ag/photo.jpg?sz=128", "display_name": "Mitchell Kline", "link": "https://stackoverflow.com/users/6525559/mitchell-kline"}, "edited": false, "score": 0, "creation_date": 1491365955, "post_id": 43221390, "comment_id": 73513963, "body": "Does this work for you? <a href=\"http://stackoverflow.com/questions/17980725/locking-linux-serial-port/17983721#17983721\" title=\"locking linux serial port\">stackoverflow.com/questions/17980725/locking-linux-serial-po&zwnj;&#8203;rt/&hellip;</a>  You can just poll on open in this case."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 61, "user_id": 6525559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Plq5HkQuX-4/AAAAAAAAAAI/AAAAAAAAAMc/XTBNHSSl_ag/photo.jpg?sz=128", "display_name": "Mitchell Kline", "link": "https://stackoverflow.com/users/6525559/mitchell-kline"}, "edited": false, "score": 0, "creation_date": 1491377098, "post_id": 43221390, "comment_id": 73519142, "body": "@MitchellKline: That takes care of the block, but this question specifies a &quot;first come first serve&quot; access. That requires a queue, which Linux does not provide."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1491377263, "post_id": 43221390, "comment_id": 73519263, "body": "@LOK: are the processes cooperating (all under your control)? Otherwise, things get more complex quite rapidly - a random other process isn&#39;t &quot;C/C++&quot; but assembly. And on an unrelated note, there&#39;s no such thing as C/C++ anyway. They&#39;re two languages that forked at the end of the previous century."}, {"owner": {"reputation": 329, "user_id": 716243, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4376e606829668325e6cc3ae20de819f?s=128&d=identicon&r=PG&f=1", "display_name": "LOK", "link": "https://stackoverflow.com/users/716243/lok"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1491423154, "post_id": 43221390, "comment_id": 73551677, "body": "Hi @MSalters  yes all the processes are under my control and they will be implemented using C++ and C. And yes MitchellKine solutions did take account of the queuing aspect.    And now I am thinking of using cross-process mutex.  <a href=\"http://stackoverflow.com/questions/9389730/is-it-possible-to-use-mutex-in-multiprocessing-case-on-linux-unix\" title=\"is it possible to use mutex in multiprocessing case on linux unix\">stackoverflow.com/questions/9389730/&hellip;</a>"}], "owner": {"reputation": 329, "user_id": 716243, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4376e606829668325e6cc3ae20de819f?s=128&d=identicon&r=PG&f=1", "display_name": "LOK", "link": "https://stackoverflow.com/users/716243/lok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491363560, "creation_date": 1491363560, "question_id": 43221390, "link": "https://stackoverflow.com/questions/43221390/prevent-multiple-access-of-a-serial-port-in-linux", "title": "Prevent multiple access of a serial port in Linux", "body": "<p>What is the best way to prevent multiple access of a serial port across multiple  processes using C\\C++ on Linux.</p>\n\n<p>Assuming each process can access the serial port at any time. What is the most efficient way to restrict to only one process can access the a serial port at a time. Once the serial port is in use, I would like other process to be blocked. Once the current process release the port the next process can take over the serial port base on first come first serve rule.</p>\n"}, {"tags": ["c", "arrays", "sprite"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491364316, "post_id": 43221381, "comment_id": 73513507, "body": "Assuming you already use some sort of struct for each bullet (for its coordinates, etc.), just add another member to use as an in-use flag... or use an otherwise invalid value for one of the other fields to indicate an unused bullet."}, {"owner": {"reputation": 71, "user_id": 7731109, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1525992747433390/picture?type=large", "display_name": "BobFisher3", "link": "https://stackoverflow.com/users/7731109/bobfisher3"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491364986, "post_id": 43221381, "comment_id": 73513667, "body": "@Dmitri I&#39;m a bit confused with how to implement the array, This is what I&#39;ve tried so far <a href=\"https://drive.google.com/open?id=0B1Law3IdbnVqRW1JNmhOM0NTOVk\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1349, "user_id": 7219646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468228f1b25f2f7ea7d41c913854c36f?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/7219646/rishi"}, "edited": false, "score": 0, "creation_date": 1491365212, "post_id": 43221381, "comment_id": 73513725, "body": "Please post what you have tried so far"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491365789, "post_id": 43221381, "comment_id": 73513897, "body": "Looks like <code>sprite_t</code> has an <code>is_visible</code> member you could use... If you can assume invisible bullets are unused."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7731109, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1525992747433390/picture?type=large", "display_name": "BobFisher3", "link": "https://stackoverflow.com/users/7731109/bobfisher3"}, "edited": false, "score": 0, "creation_date": 1491366394, "post_id": 43221726, "comment_id": 73514105, "body": "Still having trouble working out how to do this...Could you do an example by any chance? &lt;3"}], "tags": [], "owner": {"reputation": 46, "user_id": 7765019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R4LrE.jpg?s=128&g=1", "display_name": "Karanjit Singh Gill", "link": "https://stackoverflow.com/users/7765019/karanjit-singh-gill"}, "is_accepted": true, "score": 0, "last_activity_date": 1491365873, "creation_date": 1491365873, "answer_id": 43221726, "question_id": 43221381, "link": "https://stackoverflow.com/questions/43221381/c-arrays-used-unused-array-values/43221726#43221726", "title": "C Arrays - used / unused array values", "body": "<p>I saw your Code, u have a bullet array all you need is a lastUsedIndex for the last used bullet. Initialize this with the last bullet index (Max bullet -1). If the bullet hits, do nothing. If it misses \"hide\" the bullet and decrement d index. If the index hits -1 Game over. </p>\n"}], "owner": {"reputation": 71, "user_id": 7731109, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1525992747433390/picture?type=large", "display_name": "BobFisher3", "link": "https://stackoverflow.com/users/7731109/bobfisher3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 43221726, "answer_count": 1, "score": 0, "last_activity_date": 1491365873, "creation_date": 1491363513, "question_id": 43221381, "link": "https://stackoverflow.com/questions/43221381/c-arrays-used-unused-array-values", "title": "C Arrays - used / unused array values", "body": "<p>I am creating a 'Space invaders' style game where I need to limit my number of bullets to 100. I believe my best option is to Devise some way to indicate if a bullet is \"in use\" or \"available\". \nWhen user presses \"Launch missile\" key, scan the array to find an available bullet.\nIf there are no available bullets, do nothing.\nIf there is an available bullet, launch the bullet found, and make it be \"in use\".\nWhen the bullet flies off the screen, or when it hits a diamond, make it be \"available\".</p>\n\n<p>How would I go about doing this?</p>\n"}, {"tags": ["c", "process", "fork", "semaphore", "child-process"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1491366000, "post_id": 43221271, "comment_id": 73513981, "body": "For pity&#39;s sake, please learn how to indent code in SO.  Prepare the material properly formatted \u2014 suggested indent level of 4 spaces; spaces are mandatory, but 4 isn&#39;t \u2014 and copy it into the edit box.  Make sure that looks like it should (ignore the preview).  Then select the code (or code fragment) and use the <b><code>{}</code></b> button above the edit box to indent the code by 4 spaces.  Now look at the preview window.  If you didn&#39;t have any tabs in the code, it should look correct."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1491366186, "post_id": 43221271, "comment_id": 73514035, "body": "You aren&#39;t doing any error checking of any of the functions directly \u2014 somewhat indirectly, you sort of check <code>fork()</code>.  You don&#39;t know what&#39;s going wrong.  The first step is to make sure that every system call that can fail is checked for an error indication, and print the appropriate error message (and probably exit).  There are few system calls that can&#39;t fail \u2014 <code>getpid()</code> is one such, and the others are similar.  Another debugging step is to print (copious) debugging information, with most lines prefixed with the process&#39;s PID.  Done reasonably, that&#39;ll tell you more about what&#39;s going on."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1491366518, "post_id": 43221271, "comment_id": 73514148, "body": "Finally, from me, for now, you should note that <code>i</code> is not in shared memory, so any changes made by one of the processes to its copy of <code>i</code> does not affect the value of <code>i</code> in any of the other processes.  Similarly, I&#39;m not sure whether the semaphores are shared across processes.  They&#39;re created in the original (parent) process, but I think the copies in the children become independent and changes made by one process are not reflected in other processes.  I might be wrong on that \u2014 check the manual.  With <code>i</code>, I&#39;m confident; with <code>semN</code>, I&#39;m just lazy."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491430597, "post_id": 43221271, "comment_id": 73555223, "body": "for ease of readability and understanding: 1) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line. 2) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  unindent before every closing brace &#39;}&#39;.  Suggest using 4 spaces for each indent level as that is wide enough to be visible even with variable width fonts. 3) separate functions be 2 or 3 blank lines (be consistent)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491430779, "post_id": 43221271, "comment_id": 73555286, "body": "the posted code does not compile!  Several of the functions have a signature indicating that the function returns an <code>int</code> but the body of the function(s) do not return anything.  Note: do not access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the expected command line parameter actually exists."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491430914, "post_id": 43221271, "comment_id": 73555345, "body": "the function: <code>fork()</code> 1) can fail 2) has three kinds of returned values &lt;0 means error, ==0 means child process, &gt;0 means parent process  For each call to <code>fork()</code> all three conditions need to be checked"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491430985, "post_id": 43221271, "comment_id": 73555363, "body": "the function: <code>atoi()</code> does not return any error condition when it fails. Suggest using <code>strtol()</code> or similar function, which does return any error indication"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491431142, "post_id": 43221271, "comment_id": 73555420, "body": "you state: <code>NO COMPILATION ERRORS</code>,  That is not strictly true,  Suggest enabling the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu11</code> )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491431295, "post_id": 43221271, "comment_id": 73555459, "body": "when <code>pid1</code> is 0, then in the child process,  The child process execution must not fall through into the parent code.  I.E. always keep execution paths completely separate."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491431718, "post_id": 43221271, "comment_id": 73555595, "body": "at this statement: <code>while(i&lt;=value)</code> in parent and child1 and child2 and parent knows nothing about the value in <code>pid2</code> so this statement, in the parent, is testing uninitialized values, <code>if(pid1==0&amp;&amp;pid2&gt;0)</code>  There are other problems in the posted code, but the main problem is not keeping the execution paths separate.  Note: the calls to <code>print()</code> in the <code>process#()</code> functions all output the same line of text, so there is no easy way to determine which process produced each line"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1491431920, "post_id": 43221271, "comment_id": 73555658, "body": "The posted code is using semaphores.  For the current code logic, a mutex would be much better"}], "owner": {"user_type": "does_not_exist", "display_name": "user7639153"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491362765, "creation_date": 1491362765, "question_id": 43221271, "link": "https://stackoverflow.com/questions/43221271/sem-wait-and-sem-post-are-not-working-as-expected-no-compilation-errors-but-not", "title": "sem_wait and sem_post are not working as expected, No compilation errors but not getting an expected output", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;semaphore.h&gt;\n#include&lt;fcntl.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/wait.h&gt;\nint process3(int i);\nint process2(int i);\nint process1(int i);\nsem_t sem1;\nsem_t sem2;\nsem_t sem3;\nint main(int argc, char *argv[])\n{\nint pid1,pid2,value,i=0;\nsem_init(&amp;sem1, 1, 0);\nsem_init(&amp;sem2, 1, 1);\nsem_init(&amp;sem3, 1, 0);\nvalue=atoi(argv[1]);        \npid1=fork();    \nif(pid1==0)\n{\npid2=fork();\n}\nwhile(i&lt;=value)\n{\nif(pid2==0)\n{\nsem_wait(&amp;sem2);\nprocess3(i);\nsem_post(&amp;sem1);\n}\nif(pid1==0&amp;&amp;pid2&gt;0)\n{\nsem_wait(&amp;sem3);\nprocess2(i);\nsem_post(&amp;sem2);\n}\nif(pid1&gt;0)\n{\nsem_wait(&amp;sem1);\nprocess1(i);\nsem_post(&amp;sem3);\n}\ni++;        \n}\nreturn 0;\n}\nint process3(int i)\n{\nif(i%3==0)\n{\nprintf(\"%d\\n\",i);\n}\n} \nint process2(int i)\n{\nif((i+1)%3==0)\n{\nprintf(\"%d\\n\",i);\n}\n}\nint process1(int i)\n{ \nif((i+2)%3==0)\n{\n printf(\"%d\\n\",i);\n}\n}\n</code></pre>\n\n<p>Expected error is: 0,1,2,3,....maxnum given along with output command.\nGot output:\n0\nThe aim of my code is to create two child processes and to print numbers in an increasing order. But getting an unexpected output as shown above.\nCan anybody help me with this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1491362996, "post_id": 43221231, "comment_id": 73513199, "body": "&quot;doesn&#39;t work&quot; is not a proper problem description. Please give the expected output and actual output. And what have you done to debug the problem yourself?"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1491363008, "post_id": 43221231, "comment_id": 73513206, "body": "I think you mean &quot;maximum&quot; not &quot;roof&quot;. But still your question is unclear. In what way doesn&#39;t it work? What is happening (with specific inputs) and what do you expect (with those inputs)."}, {"owner": {"reputation": 1, "user_id": 6517375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002829479834055/picture?type=large", "display_name": "Jangchun  Lee", "link": "https://stackoverflow.com/users/6517375/jangchun-lee"}, "edited": false, "score": 0, "creation_date": 1491364387, "post_id": 43221231, "comment_id": 73513525, "body": "Thanks for your advice. Actually It&#39;s my first time to post the question. so now I changed my question to be specification. Thanks a lot"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491366798, "post_id": 43221231, "comment_id": 73514248, "body": "Part of your problem is the checks on the loops: <code>for (cla = 0; i &lt; sizeof(arScore) &#47; sizeof(arScore[0]); cla++) {     \t\tsum[cla] = 0;          \t\tfor (stu = 0; j &lt; sizeof(arScore[0]) &#47; sizeof(arScore[0][0]); stu++) {</code>.  You&#39;re incrementing <code>cla</code> and <code>stu</code>, but you&#39;re checking <code>i</code> and <code>j</code> against the limits.  This is probably not what you wanted.  Too much copy&#39;n&#39;paste without quite enough editing \u2014 a common problem, and not only amongst beginners."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6517375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002829479834055/picture?type=large", "display_name": "Jangchun  Lee", "link": "https://stackoverflow.com/users/6517375/jangchun-lee"}, "edited": false, "score": 0, "creation_date": 1491381921, "post_id": 43223618, "comment_id": 73522333, "body": "Oh my god, i feel so ashamed. Thanks for your kindness"}, {"owner": {"reputation": 1081, "user_id": 6764663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GlGjM.jpg?s=128&g=1", "display_name": "Tanuj Yadav", "link": "https://stackoverflow.com/users/6764663/tanuj-yadav"}, "reply_to_user": {"reputation": 1, "user_id": 6517375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002829479834055/picture?type=large", "display_name": "Jangchun  Lee", "link": "https://stackoverflow.com/users/6517375/jangchun-lee"}, "edited": false, "score": 0, "creation_date": 1491394704, "post_id": 43223618, "comment_id": 73531783, "body": "@JangchunLee You can mark it as correct, if it was helpful"}], "tags": [], "owner": {"reputation": 1081, "user_id": 6764663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GlGjM.jpg?s=128&g=1", "display_name": "Tanuj Yadav", "link": "https://stackoverflow.com/users/6764663/tanuj-yadav"}, "is_accepted": false, "score": 0, "last_activity_date": 1491374347, "creation_date": 1491374347, "answer_id": 43223618, "question_id": 43221231, "link": "https://stackoverflow.com/questions/43221231/why-doesnt-this-loop-work/43223618#43223618", "title": "Why doesn&#39;t this loop work", "body": "<p>You have written wrong variables,<br></p>\n\n<pre><code>for (cla = 0; i &lt; sizeof(arScore) / sizeof(arScore[0]); cla++) {  // i instead of cla\n        sum[cla] = 0;\n\n        for (stu = 0; j &lt; sizeof(arScore[0]) / sizeof(arScore[0][0]); stu++) {\n            sum[cla] += arScore[cla][stu];   //j instead of stu\n</code></pre>\n\n<p><br> write this instead<br></p>\n\n<pre><code>for (cla = 0; cla &lt; sizeof(arScore) / sizeof(arScore[0]); cla++) {\n        sum[cla] = 0;\n\n        for (stu = 0; stu &lt; sizeof(arScore[0]) / sizeof(arScore[0][0]); stu++) {\n            sum[cla] += arScore[cla][stu];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6517375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002829479834055/picture?type=large", "display_name": "Jangchun  Lee", "link": "https://stackoverflow.com/users/6517375/jangchun-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1491374347, "creation_date": 1491362545, "last_edit_date": 1491366707, "question_id": 43221231, "link": "https://stackoverflow.com/questions/43221231/why-doesnt-this-loop-work", "title": "Why doesn&#39;t this loop work", "body": "<p>I want to make a program to sum scores and find the highest scores by using a two-dimensional array.\nI faced some strange thing without any error.\nI found that the loop (with cla, stu variable) seems be skipped.\nI tried to print something on every loop, but I couldn't find the reason.\nI work on Visual Studio 2017 in Windows 7.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define makeScore() (rand() % 60 + 40);\n\nint main() {\n\n    int arScore[2][3];\n    int cla, stu;\n    int sum[2];\n    int maxScore = 0;\n    int maxc = 0, maxs = 0;\n    int i = 0, j = 0;\n\n    for (i = 0; i &lt; sizeof(arScore) / sizeof(arScore[0]); i++) {\n        for (j = 0; j &lt; sizeof(arScore[0]) / sizeof(arScore[0][0]); j++) {\n            arScore[i][j] = makeScore();\n        }\n    }\n\n    for (cla = 0; i &lt; sizeof(arScore) / sizeof(arScore[0]); cla++) {\n        sum[cla] = 0;\n\n        for (stu = 0; j &lt; sizeof(arScore[0]) / sizeof(arScore[0][0]); stu++) {\n            sum[cla] += arScore[cla][stu];\n\n            if (maxScore &lt; arScore[cla][stu]) {\n                maxScore = arScore[cla][stu];\n                maxc = cla;\n                maxs = stu;\n            }\n        }\n        printf(\"the total score of %d class : %d\\n\", cla + 1, sum[cla]);\n    }\n\n    puts(\"the student with the highest score\");\n    printf(\"%d class, %d student, %d score\\n\", maxc, maxs, maxScore);\n\n    return 0;    \n}\n</code></pre>\n"}, {"tags": ["c", "sizeof"], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1491363391, "creation_date": 1491363391, "answer_id": 43221365, "question_id": 43221227, "link": "https://stackoverflow.com/questions/43221227/whats-the-sizeof-of-size-t-on-gpu/43221365#43221365", "title": "What&#39;s the sizeof of size_t on gpu?", "body": "<p>Roughly speaking, <code>size_t</code> should be able to represent the size of any single allocated object.   This might be smaller than the total address space though.</p>\n\n<p>For example in 16-bit MS-DOS program one memory model had a 16-bit <code>size_t</code> even though many megabytes of memory were available, and pointers were 32-bit.  But you could not allocate any particular chunk of memory larger than 64K. </p>\n\n<p>It would be up to the compiler writer for the GPU to make <code>size_t</code> have some size that is large enough for the largest possible allocation on that GPU. As you say, this is likely to be a power of 2 (but not guaranteed).</p>\n\n<p>The type used to represent any memory position is <code>void *</code>.</p>\n"}], "owner": {"reputation": 1836, "user_id": 1642116, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/db9865f69b27f7844a4ba786f4e66cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Trauer", "link": "https://stackoverflow.com/users/1642116/trauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491363391, "creation_date": 1491362530, "question_id": 43221227, "link": "https://stackoverflow.com/questions/43221227/whats-the-sizeof-of-size-t-on-gpu", "title": "What&#39;s the sizeof of size_t on gpu?", "body": "<p>My understanding is that size_t is a type large enough to represent (or address) any memory position in a given architecture.\nFor instance, on a 32 bit machine size_t should be able to represent at least 2^32 values. This means that sizeof(size_t) must be >= 4 in 32 bit architectures, right?</p>\n\n<p><strong>So what should be the sizeof(size_t) on code that's meant to run a gpu?</strong></p>\n\n<p>Since many gpus have more than 4gb, sizeof(size_t) must be at least 5. But I imagine it's 8, for alignment purposes.</p>\n"}, {"tags": ["c", "makefile", "compiler-errors", "shared-libraries", "static-libraries"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "edited": false, "score": 0, "creation_date": 1491384421, "post_id": 43223174, "comment_id": 73524061, "body": "Is this the only way? Because it I have a modified header that is included by just one file the whole project would have to be rebuilt."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "edited": false, "score": 0, "creation_date": 1491386546, "post_id": 43223174, "comment_id": 73525729, "body": "@cpassos Without any additional assumptions, yes. Any source file could include any header file, and no information about those includes is available to make."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "edited": false, "score": 0, "creation_date": 1491387160, "post_id": 43223174, "comment_id": 73526146, "body": "@cpassos If you don&#39;t want to rebuild everything, you can, either manually or programmatically, create specific dependecies."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 0, "last_activity_date": 1491387647, "last_edit_date": 1491387647, "creation_date": 1491372799, "answer_id": 43223174, "question_id": 43221103, "link": "https://stackoverflow.com/questions/43221103/c-library-makefile-header-dependencies/43223174#43223174", "title": "C library, makefile header dependencies", "body": "<p>Generate a list of headers:</p>\n\n<pre><code>HEADERS := $(wildcard src/*.h)\n</code></pre>\n\n<p>and since you don't have any dependency files, simply ensure that all object files depend on all header files:</p>\n\n<pre><code>$(OBJECTS): $(HEADERS)\n</code></pre>\n\n<p>If any header is modified every object file is rebuild since any source file may include (and depend) on any header file.</p>\n\n<p>If you don't want to rebuild everything after a header is changed, you can manually add specific dependencies, so that only the needed files are rebuilt. For example:</p>\n\n<pre><code>src/file.c: src/file.h\nsrc/main.c: src/main.h src/file.h\n</code></pre>\n\n<p>Those dependencies can also be made automatically.</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491394652, "post_id": 43230266, "comment_id": 73531744, "body": "Great! Did other similar posts explaining how automatic dependecies can be created, help you solve this one?"}, {"owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491394998, "post_id": 43230266, "comment_id": 73532000, "body": "@2501 This <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/\" rel=\"nofollow noreferrer\">site</a> helped. Although I don&#39;t quite get why it works. Is it creating two recipes for each .o target? Because I have that line with <code>build&#47;%.o: src&#47;%.c</code> and the <code>$(DEPS)</code> included are of the same form but with percentage symbols replaced by the actual filenames. Is this a normal thing to do in makefile?"}, {"owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491395814, "post_id": 43230266, "comment_id": 73532635, "body": "I actually mean rules, not recipes. If I create multiple rules for a single target and place a recipe only on one, leaving the others empty with just the dependencies, will make always make sure the target is up to date with the dependencies?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491425265, "post_id": 43230266, "comment_id": 73552810, "body": "I&#39;m not sure, I haven&#39;t seen the entire makefile. I suggest you do some research and/or ask new questions. My I ask, and I&#39;m only curious, did you learn about the existence of automatic dependency generation from my answer?"}, {"owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491425937, "post_id": 43230266, "comment_id": 73553196, "body": "@2501 I already knew about it and tried numerous ways, I just couldn&#39;t understand I had to provide a general rule (with the percentage signs) even if I had included the dependency file generated by gcc. Thanks anyway."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491426076, "post_id": 43230266, "comment_id": 73553274, "body": "Look at the contents of the generated dependency file. It only contains code that looks like the code at the bottom in my answer, which only sets the prerequisites. You still have to provide the recipes."}, {"owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1491426238, "post_id": 43230266, "comment_id": 73553367, "body": "@2501 Yeah, I understand that now. I originally thought that make would also provide implicit recipes\u200b just like it provides implicit rules."}], "tags": [], "owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "is_accepted": false, "score": 1, "last_activity_date": 1491392765, "creation_date": 1491392765, "answer_id": 43230266, "question_id": 43221103, "link": "https://stackoverflow.com/questions/43221103/c-library-makefile-header-dependencies/43230266#43230266", "title": "C library, makefile header dependencies", "body": "<p>I was able to solve this myself. Changed this:</p>\n\n<pre><code>build/%.o: src/%.c\n    $(CC) $(CFLAGS) -o $@ -c $&lt;\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>build/%.o: src/%.c\n    $(CC) $(CFLAGS) -MMD -o $@ -c $&lt;\n\ninclude $(DEPS)\n\n$(DEPS): ;\n</code></pre>\n\n<p>And added:</p>\n\n<pre><code>DEPS=$(patsubst %.o,%.d,$(OBJECTS))\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>OBJECTS=$(patsubst src/%.c,build/%.o,$(SOURCES))\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4778535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a28bc7ab929e7c8d0c0fd4d9976da4e?s=128&d=identicon&r=PG&f=1", "display_name": "WeakestTopology", "link": "https://stackoverflow.com/users/4778535/weakesttopology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1410, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491392765, "creation_date": 1491361737, "question_id": 43221103, "link": "https://stackoverflow.com/questions/43221103/c-library-makefile-header-dependencies", "title": "C library, makefile header dependencies", "body": "<p>Let' say I have library project with a few folders:</p>\n\n<ul>\n<li>build: where .o files go</li>\n<li>lib: where the compiled static and dynamic libraries go</li>\n<li>src: where the .c source files go</li>\n<li>include: where the headers are placed</li>\n</ul>\n\n<p>The problem is, everytime I change a header file and make doesn't perceive this (which is obvious why if you look at my Makefile) and says everything is up to date. I have manage to solve this with another project which wasn't a library, but with this one everytime I try something I end up with an error when the target is getting built. Here is the Makefile: </p>\n\n<pre><code>CC=gcc\nCFLAGS=-g -O2 -Wall -Iinclude -rdynamic -DNDEBUG $(OPTFLAGS)\nLDFLAGS=$(OPTLIBS)\n\nSOURCES=$(wildcard src/*.c)\nOBJECTS=$(patsubst src/%.c,build/%.o,$(SOURCES))\n\nTARGET=lib/libdatastruct.a\nSO_TARGET=$(patsubst %.a,%.so,$(TARGET))\n\n# The Target lib\nall: $(TARGET) $(SO_TARGET)\n\ndev: CFLAGS=-g -Wall -Iinclude -Wall -Wextra $(OPTFLAGS)\ndev: all\n\n$(TARGET): CFLAGS += -fPIC\n$(TARGET): build $(OBJECTS)\n    ar rcs $@ $(OBJECTS)\n    ranlib $@\n$(SO_TARGET): $(TARGET) $(OBJECTS)\n    $(CC) -shared -o $@ $(OBJECTS)\n\nbuild/%.o: src/%.c\n    $(CC) $(CFLAGS) -o $@ -c $&lt;\n\nbuild:\n    @mkdir -p lib\n    @mkdir -p build\n\nclean:\n    rm -rf lib build\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 4, "creation_date": 1491362052, "post_id": 43221093, "comment_id": 73512946, "body": "Unable to reproduce, statement in question seems implausible. Possible compiler might be optimizing the entire loop out if it has no observable effects."}, {"owner": {"reputation": 144, "user_id": 7772011, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a52faf3d1c0acf8c5d0334719f16834?s=128&d=identicon&r=PG&f=1", "display_name": "John Is No", "link": "https://stackoverflow.com/users/7772011/john-is-no"}, "edited": false, "score": 0, "creation_date": 1491362238, "post_id": 43221093, "comment_id": 73513009, "body": "Seems good to me. Show us a screenshot of your error."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1491362335, "post_id": 43221093, "comment_id": 73513033, "body": "Calling <code>clock</code> is observable behaviour. Or it would be if the right header were included"}, {"owner": {"reputation": 7, "user_id": 7681923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f56bbefd6a0548dcf42b8e85a5e674?s=128&d=identicon&r=PG&f=1", "display_name": "DeadAccount", "link": "https://stackoverflow.com/users/7681923/deadaccount"}, "edited": false, "score": 0, "creation_date": 1491362410, "post_id": 43221093, "comment_id": 73513051, "body": "<a href=\"http://prntscr.com/esl0e4\" rel=\"nofollow noreferrer\">prntscr.com/esl0e4</a> Without printf <a href=\"http://prntscr.com/esl0ht\" rel=\"nofollow noreferrer\">prntscr.com/esl0ht</a> with printf"}, {"owner": {"reputation": 7, "user_id": 7681923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f56bbefd6a0548dcf42b8e85a5e674?s=128&d=identicon&r=PG&f=1", "display_name": "DeadAccount", "link": "https://stackoverflow.com/users/7681923/deadaccount"}, "edited": false, "score": 0, "creation_date": 1491362450, "post_id": 43221093, "comment_id": 73513067, "body": "&lt;time.h&gt; was included"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1491362455, "post_id": 43221093, "comment_id": 73513068, "body": "Please post your real code. This code should fail to compile, as <code>CLOCKS_PER_SEC</code> is not defined."}, {"owner": {"reputation": 7, "user_id": 7681923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f56bbefd6a0548dcf42b8e85a5e674?s=128&d=identicon&r=PG&f=1", "display_name": "DeadAccount", "link": "https://stackoverflow.com/users/7681923/deadaccount"}, "edited": false, "score": 0, "creation_date": 1491362538, "post_id": 43221093, "comment_id": 73513091, "body": "<a href=\"http://prntscr.com/esl0ve\" rel=\"nofollow noreferrer\">prntscr.com/esl0ve</a> This is proof its the real code add &lt;time.h&gt;"}, {"owner": {"reputation": 144, "user_id": 7772011, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a52faf3d1c0acf8c5d0334719f16834?s=128&d=identicon&r=PG&f=1", "display_name": "John Is No", "link": "https://stackoverflow.com/users/7772011/john-is-no"}, "edited": false, "score": 0, "creation_date": 1491362567, "post_id": 43221093, "comment_id": 73513100, "body": "<code>time</code> might have reached 5 and you have no idea it already reached 5. try inserting your <code>printf</code> inside the <code>if</code> block"}, {"owner": {"reputation": 7, "user_id": 7681923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f56bbefd6a0548dcf42b8e85a5e674?s=128&d=identicon&r=PG&f=1", "display_name": "DeadAccount", "link": "https://stackoverflow.com/users/7681923/deadaccount"}, "edited": false, "score": 0, "creation_date": 1491362644, "post_id": 43221093, "comment_id": 73513110, "body": "same problem still hits the if statement instatly"}, {"owner": {"reputation": 144, "user_id": 7772011, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a52faf3d1c0acf8c5d0334719f16834?s=128&d=identicon&r=PG&f=1", "display_name": "John Is No", "link": "https://stackoverflow.com/users/7772011/john-is-no"}, "edited": false, "score": 0, "creation_date": 1491362790, "post_id": 43221093, "comment_id": 73513145, "body": "what is the output of <code>printf(&quot;%d \\n&quot;, time)</code> inside your <code>if</code> block?"}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1491362693, "creation_date": 1491362693, "answer_id": 43221256, "question_id": 43221093, "link": "https://stackoverflow.com/questions/43221093/if-statement-instantly-true-without-printf/43221256#43221256", "title": "If statement instantly true without printf", "body": "<p>Depending on how fast your computer is, the loop without the print may take less than a second to run 10 million times, so may seem to exit 'instantly' (it takes about a second and a half on my averageish 2 yr old desktop).</p>\n\n<p>If you want an infinite loop, use <code>while(1)</code> or <code>for(;;)</code></p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1491368183, "creation_date": 1491368183, "answer_id": 43222124, "question_id": 43221093, "link": "https://stackoverflow.com/questions/43221093/if-statement-instantly-true-without-printf/43222124#43222124", "title": "If statement instantly true without printf", "body": "<p>You are using <code>int</code> where you should have been using <code>time_t</code>. <code>int</code> can potentially overflow in this context leading to undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1491384551, "creation_date": 1491384551, "answer_id": 43227168, "question_id": 43221093, "link": "https://stackoverflow.com/questions/43221093/if-statement-instantly-true-without-printf/43227168#43227168", "title": "If statement instantly true without printf", "body": "<ol>\n<li><em>clock();</em> returns the amount of time spent in your program.</li>\n<li><em>CLOCKS_PER_SEC</em> This macro expands to an expression representing the\nnumber of clock ticks per second.</li>\n</ol>\n\n<p>Now as @Chris_Dodd said, your CPU is very fast. So <strong>time will immediately reach the value 5.</strong> </p>\n"}], "owner": {"reputation": 7, "user_id": 7681923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f56bbefd6a0548dcf42b8e85a5e674?s=128&d=identicon&r=PG&f=1", "display_name": "DeadAccount", "link": "https://stackoverflow.com/users/7681923/deadaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1491384551, "creation_date": 1491361690, "last_edit_date": 1491367055, "question_id": 43221093, "link": "https://stackoverflow.com/questions/43221093/if-statement-instantly-true-without-printf", "title": "If statement instantly true without printf", "body": "<p>I have noticed that if I put a <code>printf</code> statement, the code works the way I expect (waiting 5 seconds before if statement is true). But if I don't put the <code>printf</code> in the loop, the <code>if</code> statement is true instantly. I want to know why this is?</p>\n\n<pre><code>int main()\n{\n    int i;\n\n    for(i=0; i&lt;10000000; i++){\n        int ticks = clock();\n        int time = (float)ticks / CLOCKS_PER_SEC;\n        printf(\"%d \\n\", time); //If this printf statement is not here\n\n        if(time &gt;= 5){ //This will become true immediately\n            break;\n        }\n    }\n\n    printf(\"\\nTimer is done\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "debugging", "return", "character"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4253819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4c3bb3181038e87854a4882baa0403c5?s=128&d=identicon&r=PG&f=1", "display_name": "JVAN", "link": "https://stackoverflow.com/users/4253819/jvan"}, "edited": false, "score": 0, "creation_date": 1491360399, "post_id": 43220898, "comment_id": 73512579, "body": "But i need to return the statement somehow. I can do this with a  printf?"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "reply_to_user": {"reputation": 93, "user_id": 4253819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4c3bb3181038e87854a4882baa0403c5?s=128&d=identicon&r=PG&f=1", "display_name": "JVAN", "link": "https://stackoverflow.com/users/4253819/jvan"}, "edited": false, "score": 0, "creation_date": 1491360490, "post_id": 43220898, "comment_id": 73512600, "body": "Nope. You could <code>malloc</code> a buffer, use <a href=\"http://www.cplusplus.com/reference/cstdio/snprintf/\" rel=\"nofollow noreferrer\"><code>snprintf</code></a> to format it, and then return that."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "reply_to_user": {"reputation": 93, "user_id": 4253819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4c3bb3181038e87854a4882baa0403c5?s=128&d=identicon&r=PG&f=1", "display_name": "JVAN", "link": "https://stackoverflow.com/users/4253819/jvan"}, "edited": false, "score": 0, "creation_date": 1491360530, "post_id": 43220898, "comment_id": 73512609, "body": "But all you do with the return is printf it. Why not just do the printf in the function?"}], "tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": true, "score": 0, "last_activity_date": 1491360250, "creation_date": 1491360250, "answer_id": 43220898, "question_id": 43220876, "link": "https://stackoverflow.com/questions/43220876/how-to-return-a-string-with-variables-in-c/43220898#43220898", "title": "How to return a string with variables in c", "body": "<p>This isn't going to work:</p>\n\n<p>char *m = (\"Change returned. %d nickels and %d dimes\\n\",nickels, dimes);</p>\n\n<p>Maybe get rid of the char * and just call printf?</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7810709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77Hdg.jpg?s=128&g=1", "display_name": "af-inet", "link": "https://stackoverflow.com/users/7810709/af-inet"}, "is_accepted": false, "score": 0, "last_activity_date": 1491368128, "creation_date": 1491368128, "answer_id": 43222115, "question_id": 43220876, "link": "https://stackoverflow.com/questions/43220876/how-to-return-a-string-with-variables-in-c/43222115#43222115", "title": "How to return a string with variables in c", "body": "<p>It is actually possible to do what you're saying. Here's two solutions you might like:</p>\n\n<p><strong>Solution 1: using printf instead of returning.</strong></p>\n\n<p>First of all, you're not actually formatting your string by writing</p>\n\n<p><code>char *m = (\"Change returned. %d nickels and %d dimes\\n\", nickels, dimes);\n</code></p>\n\n<p>We need to pass these values to a function to do the actual formatting! </p>\n\n<p>Secondly, I don't see why we need to return from <code>coinReturn</code>... when we could simply write</p>\n\n<p><code>printf(\"Change returned. %d nickels and %d dimes\\n\", nickels, dimes);\n</code></p>\n\n<p>and we're done!</p>\n\n<p>But maybe that's not what we want. Maybe we want to actually return a string pointer for this function, we can make that happen too :)</p>\n\n<p><strong>Solution 2: using snprintf and returning a pointer to a static buffer</strong></p>\n\n<pre><code>char *coinReturn(int insert) {\n    // set aside a buffer for our string.\n    static char buf[512];\n    int dimes = insert/DI;\n    int remainder = insert % DI;\n    int nickels = remainder/NI;\n    int remainder2= nickels % NI;\n    // output our string into the buffer.\n    snprintf(buf, sizeof(buf),\n        \"Change returned. %d nickels and %d dimes\\n\", nickels, dimes);\n    return buf;\n}\n</code></pre>\n\n<p>Firstly we set aside some memory to store our formatted string,</p>\n\n<p><code>static char buf[512];</code></p>\n\n<p>Note it's neccesary to declare <code>buf</code> as <code>static</code> so it survives the scope of our <code>coinReturn</code> function.</p>\n\n<p>512 will be our maximum string length, that should be more than enough here.</p>\n\n<p>Lets have a look at that next part:</p>\n\n<pre><code>snprintf(buf, sizeof(buf),\n    \"Change returned. %d nickels and %d dimes\\n\", nickels, dimes);\n</code></pre>\n\n<p>(see: <a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/printf</a>)</p>\n\n<p>The first argument is the location where our string will be written, <code>buf</code>.</p>\n\n<p>The second argument is the maximum number of bytes <code>snprintf</code> will write (including the null terminator).</p>\n\n<p>The last arguments are just like <code>printf</code> which you're already familiar with.</p>\n\n<pre><code>return buf;\n</code></pre>\n\n<p>And finally we can return <code>buf</code> knowing the result will be a pointer to our formatted string.</p>\n\n<hr>\n\n<p>Out of these two solutions, the first definitely makes more sense - there are a lot of issues I see with #2 (for example: it isn't thread safe), but it get's the job done if that's all you want here.</p>\n"}], "owner": {"reputation": 93, "user_id": 4253819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4c3bb3181038e87854a4882baa0403c5?s=128&d=identicon&r=PG&f=1", "display_name": "JVAN", "link": "https://stackoverflow.com/users/4253819/jvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 43220898, "answer_count": 2, "score": 0, "last_activity_date": 1491368128, "creation_date": 1491360038, "question_id": 43220876, "link": "https://stackoverflow.com/questions/43220876/how-to-return-a-string-with-variables-in-c", "title": "How to return a string with variables in c", "body": "<p>My program is trying to simulate a vending machine. Everything works except for the part where coins are returned or change is returned. I'm trying to take the amount of cents inserted into the machine and input that into another code outside of the main, and then return a string. Is this possible in C because I keep getting an initialization makes pointer from integer without a cast error. If this isn't possible, any ideas on how I could do this? </p>\n\n<p>Thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#define NI 5\n#define DI 10\n#define QU 25\n\n\n\nbool isValid(int num) {\n    return (num &gt;= 10 &amp;&amp; num &lt;= 100 );\n}\n\nbool isMultiple(int num) {\n        return (num % 5 == 0);\n}\n\n\nchar *coinReturn(int insert) {\n\n                                int dimes = insert/DI;\n                                int remainder = insert % DI;\n                                int nickels = remainder/NI;\n                                int remainder2= nickels % NI;\n                                char *m = (\"Change returned. %d nickels and %d dimes\\n\",nickels, dimes);\n                                return m;\n}\n\n\nint \nmain (int argc, char *argv[])\n{  for (int i = 1; i != argc; ++i) {\n         int price = atoi(argv[i]);\n        if (!isValid(price)) {\n            printf(\"Price muse be from 10 cents to 100 cents.\\n\");\n            break;\n        } else if (!isMultiple(price)) {\n                printf(\"Price must be a multiple of 5.\\n\");\n                break;\n        } else {\n                printf(\" Welcome to my Vending Machine!\\n\");\n                printf(\"Pop is %d cents. Please enter nickels, dimes, or quarters\\n\", price);\n\n                        int cents = 0;\n                        char coin = '\\0';\n\n                        while (cents &lt;= price &amp;&amp; coin != 'E') {\n                        printf(\" PLease enter a coin [NDQR]\\n\");\n                        scanf (\" %c\", &amp;coin);\n\n                        if (coin == 'N'|| coin == 'n') {\n                                cents = cents + NI;\n                                printf(\" You have inserted 5 cents\\n\");\n                        }\n                        else if (coin == 'd' || coin == 'D') {\n                                cents = cents + DI;\n                                printf(\"You have inserted 10 cents\\n\");\n                        }\n                        else if (coin == 'Q' || coin == 'q') {\n                                cents = cents + QU;\n                                printf(\"You have entered 25 cents\\n\");\n                        }\n                        else if ( coin == 'R' || coin == 'r'){\n                                printf(\"Change requested\\n\");\n                                char *rtn2= coinReturn(cents);\n                                printf(\"%s\\n\",rtn2 );\n                        } else {\n                                printf(\"Unknown coin. Rejected.\\n\");\n                        }\n                        int balance = price - cents;\n                        printf(\"You have entered a total of %d cents\\n\", cents);\n\n                        if (balance &gt; 0) {\n                        printf(\"You must enter %d more cents\\n\", balance);\n                    } else {\n\n                                char *rtn = coinReturn(cents);\n                                printf(\"%s\\n\",rtn );\n                         cents = 0;\n\n                    }\n\n                    }\n\n\n               printf(\"DONE!\\n\");\n                return 0;\n}\n}\n</code></pre>\n"}]