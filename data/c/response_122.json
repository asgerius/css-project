[{"tags": ["c", "memory", "mutex", "semaphore", "producer-consumer"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1494460952, "post_id": 43904414, "comment_id": 74842747, "body": "<code>item</code> is uninitialised."}, {"owner": {"reputation": 1, "user_id": 6117577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f311c4b8ed98e7599a3bbdbc16f01789?s=128&d=identicon&r=PG&f=1", "display_name": "Damenace", "link": "https://stackoverflow.com/users/6117577/damenace"}, "reply_to_user": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1494461266, "post_id": 43904414, "comment_id": 74842805, "body": "the function produce_item returns a rand number up to 50"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1494461412, "post_id": 43904414, "comment_id": 74842835, "body": "what about the <code>consume_item</code> ?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1494461483, "post_id": 43904414, "comment_id": 74842851, "body": "<code>i</code> is uninitialised."}, {"owner": {"reputation": 1, "user_id": 6117577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f311c4b8ed98e7599a3bbdbc16f01789?s=128&d=identicon&r=PG&f=1", "display_name": "Damenace", "link": "https://stackoverflow.com/users/6117577/damenace"}, "edited": false, "score": 0, "creation_date": 1494461565, "post_id": 43904414, "comment_id": 74842876, "body": "consume_item does nothing but print out the item, I am unsure how to remove from buffer."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1494461633, "post_id": 43904414, "comment_id": 74842889, "body": "But <code>item</code> is uninitalised when passed to <code>consume_item</code>. Too much missing code to be sure what is happening. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 6117577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f311c4b8ed98e7599a3bbdbc16f01789?s=128&d=identicon&r=PG&f=1", "display_name": "Damenace", "link": "https://stackoverflow.com/users/6117577/damenace"}, "edited": false, "score": 0, "creation_date": 1494461782, "post_id": 43904414, "comment_id": 74842916, "body": "why do we need to initialize item when it is being creating before we consume it. Do i need to pass it in as an argument to the consumer function?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1494462655, "post_id": 43904414, "comment_id": 74843081, "body": "Don&#39;t know what you mean. But generally if you are passing a variable to a function then that variable needs to have a valid value for the function to use right? <code>printf(&quot;Consumer consumes %d\\n&quot;,item);</code> what do you expect that to print since <code>item</code> has not been set to any value? It is Undefined Behaviour."}], "owner": {"reputation": 1, "user_id": 6117577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f311c4b8ed98e7599a3bbdbc16f01789?s=128&d=identicon&r=PG&f=1", "display_name": "Damenace", "link": "https://stackoverflow.com/users/6117577/damenace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494461871, "creation_date": 1494460791, "last_edit_date": 1494461871, "question_id": 43904414, "link": "https://stackoverflow.com/questions/43904414/sharing-memory-buffer-in-a-producer-consumer-semaphore", "title": "Sharing memory buffer in a producer consumer semaphore", "body": "<p>I have a question on how to implement using a shared memory buffer in semaphore sets. I am doing the classic consumer producer problem where I add a new item to a buffer stack and depending on the scheduler I want to remove the first in item produced from my producer.\nBelow is my producer and consumer code :</p>\n\n<pre><code>int produce_item(){\n    int item = rand()%50 +1;\n    printf(\"Producer produces %d\\n\",item);\n    sleep(1);\n    return item;\n}\n\nvoid consume_item(int item){\n    printf(\"Consumer consumes %d\\n\",item);\n    sleep(2);\n}\nvoid* consumer(void * arg) {\n    int item, j=0;\n    while(1){\n        down(full);\n        down(mutex);    \n        consume_item(item);\n        buffer[j++] = item; \n        up(mutex);\n        up(empty);\n    }\n    return 0;\n}\n\nvoid* producer(void* arg) { \n    int item, i;\n    while(1){\n        item  = produce_item();\n        down(empty);\n        down(mutex);\n        buffer[i++]=item;\n        up(mutex);\n        up(full);\n        sleep(1);\n    }\n</code></pre>\n\n<p>my buffer is decalred as a global variable </p>\n\n<p>and here is a test run which shows my question, why is it only consuming the same item over and over again?</p>\n\n<pre><code>Consumer consumes 32622\nProducer produces 16\nConsumer consumes 32622\nProducer produces 22\nConsumer consumes 32622\nProducer produces 1\nConsumer consumes 32622\nProducer produces 16\nConsumer consumes 32622\nProducer produces 15\n</code></pre>\n"}, {"tags": ["c", "switch-statement", "doubly-linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1494460519, "post_id": 43904322, "comment_id": 74842662, "body": "Show the error message."}, {"owner": {"reputation": 483, "user_id": 7452238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5339f527b561933b4e1eceaf7e42d9?s=128&d=identicon&r=PG&f=1", "display_name": "bobra", "link": "https://stackoverflow.com/users/7452238/bobra"}, "edited": false, "score": 1, "creation_date": 1494460553, "post_id": 43904322, "comment_id": 74842669, "body": "are you shoure you didnt forget closting &#39; } &#39; of your swithc, and initialized choice before?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1494466774, "post_id": 43904322, "comment_id": 74843991, "body": "Sure, you forgot a <code>}</code> to close the <code>switch</code> code. You can see it both in the first time you show it and also in the second time when you commented it out."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494496609, "post_id": 43905349, "comment_id": 74857557, "body": "thanks for your help man, really appreciate it :) but after applying your corrections (which were valuable) this error still there &quot; |error: expected declaration or statement at end of input| |290|warning: control reaches end of non-void function [-Wreturn-type]| ||=== Build failed: 1 error(s), 1 warning(s) (0 minute(s), 2 second(s)) ===|  &quot; .... if you can help with this I&#39;ll be greatful"}, {"owner": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494497771, "post_id": 43905349, "comment_id": 74858410, "body": "I had it full functional with (if-else), but I also need to make it work with the (switch)"}, {"owner": {"reputation": 610, "user_id": 5798328, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a9843be6e6863d67877be647a5a5f2a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nebeski", "link": "https://stackoverflow.com/users/5798328/nebeski"}, "reply_to_user": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494501652, "post_id": 43905349, "comment_id": 74861051, "body": "After making the corrections your code worked fine for me, but tell me in which function is the error appearing?"}, {"owner": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494503564, "post_id": 43905349, "comment_id": 74862376, "body": "at the end of delete function"}, {"owner": {"reputation": 610, "user_id": 5798328, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a9843be6e6863d67877be647a5a5f2a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nebeski", "link": "https://stackoverflow.com/users/5798328/nebeski"}, "reply_to_user": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494504217, "post_id": 43905349, "comment_id": 74862817, "body": "Did you maybe change the definition of delete, because in your code here, definition is <code>void DeleteNode (int Node )</code>, and because it is void, it doesn&#39;t need to return anything. You have probably changed something since you posted the code here. If you haven&#39;t changed the definition, error <code>expected declaration or statement at end of input</code> appears due to the missing <code>}</code> at the end of function. Check your brackets."}, {"owner": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "edited": false, "score": 0, "creation_date": 1494511001, "post_id": 43905349, "comment_id": 74868211, "body": "it&#39;s still there, it works very well with the (if-else if). thanks for you effort man, really appreciate it"}], "tags": [], "owner": {"reputation": 610, "user_id": 5798328, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a9843be6e6863d67877be647a5a5f2a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nebeski", "link": "https://stackoverflow.com/users/5798328/nebeski"}, "is_accepted": true, "score": 1, "last_activity_date": 1494468423, "creation_date": 1494468423, "answer_id": 43905349, "question_id": 43904322, "link": "https://stackoverflow.com/questions/43904322/double-linked-list-c/43905349#43905349", "title": "Double linked list - C", "body": "<p>There was a few problems in your code. I was working with the switch version, and there were also problems with the if else version.</p>\n\n<pre><code>case 5:\n    printf(\"Enter the data you want search\\n\");\n    scanf(\"%d\",data);\n    Search(data);\n    if(Search(data))\n    {\n     printf(\"%d\\n\",*(Search(data)));\n    }\n    else\n    {}\n    data =0;\n    break;\n</code></pre>\n\n<p>When you use scanf you need to send a pointer to the location where you want to store something, so it will be <code>scanf(\"%d\", &amp;data)</code>. Also printf's %d needs int value as argument but here:</p>\n\n<p><code>printf(\"%d\\n\",*(Search(data)));</code> </p>\n\n<p>you are sending it a Node, and so it will not accept it. You need to send the data that is within the Node so you do this: </p>\n\n<p><code>printf(\"%d\\n\",(*(Search(data))).data);</code></p>\n\n<p>And you don't need to have else with an empty block, if you remove it it won't affect the program.</p>\n\n<p>Now we have a problem in the CreatNode function which does not return anything in the case temp is null. So you need to return null in the if block in case there was not enough memory:</p>\n\n<pre><code>struct Node* CreatNode (void)\n{\n    struct Node* temp;\n    temp = (struct Node*) malloc(sizeof(struct Node));\n    if (!temp)\n    {\n        printf(\"\\nNot Enough Memory\");\n        return NULL; //YOU NEED TO RETURN NULL HERE\n    }\n    else\n    {\n        return temp;\n    }\n}\n</code></pre>\n\n<p>Function Search won't return anything if for example first current equals NULL, so you need to move return and printf line out of if block like this:</p>\n\n<pre><code>struct Node* Search (int data)\n{\n    struct Node* current;\n    current = pstart;\n    if (current)\n    {\n        while(current)\n        {\n            if (current-&gt;data == data)\n            {\n                return current;\n            }\n            current = current-&gt;pnext;\n        }\n    }\n    printf(\"\\nIt's not found\\n\");\n    return NULL;\n}\n</code></pre>\n\n<p>And the last thing and the reason why your switch does not work is because it is not in a loop. Switch by itself is not a loop so you need to put it in a while loop that works until for example, user enters 0. So this will be a solution:</p>\n\n<pre><code>int main()\n{\n    int choice=-1,data;\n    while(choice != 0)\n    {\n        printf(\"\\n\\nChoose from the following options\\n\\n\");\n        printf(\"1-Insert at the beginning\\n2-Append\\n3-Print Forward\\n4-Print Backward\\n5-Search\\n6-Delete\\n\");\n        scanf(\"%d\", &amp;choice);\n        switch(choice)\n        {\n            case 1:\n                /*...*/\n\n            case 2:\n                /*...*/\n\n            case 3:\n                /*...*/\n\n            case 4:\n                /*...*/\n\n            case 5:\n                /*...*/\n\n            case 6:\n                /*...*/\n\n            case 0:\n                break;\n\n            default :\n                printf(\"Not Valid Entry\\n\");\n\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4519278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef6859add707847985de22b4830643f?s=128&d=identicon&r=PG&f=1", "display_name": "kiko", "link": "https://stackoverflow.com/users/4519278/kiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "accepted_answer_id": 43905349, "answer_count": 1, "score": 1, "last_activity_date": 1494487342, "creation_date": 1494460018, "last_edit_date": 1494487342, "question_id": 43904322, "link": "https://stackoverflow.com/questions/43904322/double-linked-list-c", "title": "Double linked list - C", "body": "<p>I'm trying to make a simple double linked list, I used (switch) in the first place:</p>\n\n<pre><code>int choice, data;\n    switch(choice)\n    {\n        case 1:\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsetFirst(data);\n            data =0;\n            break;\n\n        case 2:\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsertLast(data);\n            data =0;\n            break;\n\n        case 3:\n            printf(\"The list from the beginning to the End :\\n\");\n            PrintForward();\n            break;\n\n        case 4:\n            printf(\"The list from the end to the beginning\\n\");\n            PrintBackward();\n            break;\n\n        case 5:\n            printf(\"Enter the data you want search\\n\");\n            scanf(\"%d\",data);\n            Search(data);\n            if(Search(data))\n            {\n             printf(\"%d\\n\",*(Search(data)));\n            }\n            else\n            {}\n            data =0;\n            break;\n\n        case 6:\n            printf(\"Enter The data you want to delete\\n\");\n            scanf(\"%d\",&amp;data);\n            DeleteNode(data);\n            break;\n\n        default :\n            printf(\"Not Valid Entry\\n\");\n</code></pre>\n\n<p>But it kept showing me this error in one of the functions </p>\n\n<p><code>\"expected declaration or statement at end of input\"</code></p>\n\n<p>knowing that I tested the functions individually and it worked properly,</p>\n\n<p>After that I used (if,if-else) and then it worked`</p>\n\n<pre><code>int main()\n{\n    int choice=1 , data;\n    while (1)\n    {\n        printf(\"Choose from the following options\\n\\n\");\n        printf(\"1-Insert at the beginning\\n2-Append\\n3-Print Forward\\n4-Print Backward\\n5-Search\\n6-Delete\\n\");\n        scanf(\"%d\",&amp;choice);\n        if(choice==1)\n         {\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsetFirst(data);\n            data =0;\n         }\n         else if (choice==2)\n         {\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsertLast(data);\n            data =0;\n         }\n         else if(choice==3)\n         {\n             printf(\"The list from the beginning to the End :\\n\");\n             PrintForward();\n         }\n         else if(choice==4)\n         {\n             printf(\"The list from the end to the beginning\\n\");\n             PrintBackward();\n         }\n         else if(choice==5)\n         {\n             printf(\"Enter the data you want search\\n\");\n             scanf(\"%d\",data);\n             Search(data);\n             data =0;\n         }\n         else if(choice==6)\n         {\n            printf(\"Enter The data you want to delete\\n\");\n            scanf(\"%d\",&amp;data);\n            DeleteNode(data);\n         }\n         else\n         {\n             printf(\"Enter a Valid Choice\\n\");\n         }\n    }`, \n</code></pre>\n\n<p>but there were error with search function in case the item doesn't exist.</p>\n\n<p>hope anyone can help me, thanks in advance, peace :)\nhere is the full code with commented sections that don't work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\nstruct Node\n{\n    int data;\n    struct Node* pnext;\n    struct Node* pprev;\n};\nstruct Node* pstart = NULL;\nstruct Node* plast = NULL;\n\n/** Functions Prototype **/\n\nstruct Node* CreatNode (void);\nvoid InsetFirst (int data);\nvoid InsertLast (int data);\nvoid PrintForward (void);\nvoid PrintBackward (void);\nstruct Node* Search (int data);\nvoid DeleteNode (int Node );\n\n\nint main()\n{\n    int choice=1 , data;\n    while (1)\n    {\n        printf(\"Choose from the following options\\n\\n\");\n        printf(\"1-Insert at the beginning\\n2-Append\\n3-Print Forward\\n4-Print Backward\\n5-Search\\n6-Delete\\n\");\n        scanf(\"%d\",&amp;choice);\n        if(choice==1)\n         {\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsetFirst(data);\n            data =0;\n         }\n         else if (choice==2)\n         {\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsertLast(data);\n            data =0;\n         }\n         else if(choice==3)\n         {\n             printf(\"The list from the beginning to the End :\\n\");\n             PrintForward();\n         }\n         else if(choice==4)\n         {\n             printf(\"The list from the end to the beginning\\n\");\n             PrintBackward();\n         }\n         else if(choice==5)\n         {\n             printf(\"Enter the data you want search\\n\");\n             scanf(\"%d\",data);\n             Search(data);\n             data =0;\n         }\n         else if(choice==6)\n         {\n            printf(\"Enter The data you want to delete\\n\");\n            scanf(\"%d\",&amp;data);\n            DeleteNode(data);\n         }\n         else\n         {\n             printf(\"Enter a Valid Choice\\n\");\n         }\n    }\n\n/*\n    int choice,data;\n    switch(choice)\n    {\n        case 1:\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsetFirst(data);\n            data =0;\n            break;\n\n        case 2:\n            printf(\"Enter Your Data\\n\");\n            scanf(\"%d\",&amp;data);\n            InsertLast(data);\n            data =0;\n            break;\n\n        case 3:\n            printf(\"The list from the beginning to the End :\\n\");\n            PrintForward();\n            break;\n\n        case 4:\n            printf(\"The list from the end to the beginning\\n\");\n            PrintBackward();\n            break;\n\n        case 5:\n            printf(\"Enter the data you want search\\n\");\n            scanf(\"%d\",data);\n            Search(data);\n            if(Search(data))\n            {\n             printf(\"%d\\n\",*(Search(data)));\n            }\n            else\n            {}\n            data =0;\n            break;\n\n        case 6:\n            printf(\"Enter The data you want to delete\\n\");\n            scanf(\"%d\",&amp;data);\n            DeleteNode(data);\n            break;\n\n        default :\n            printf(\"Not Valid Entry\\n\");\n            */\n\n    return 0;\n}\n\n/** Function to create Node in the list **/\n\nstruct Node* CreatNode (void)\n{\n    struct Node* temp;\n    temp = (struct Node*) malloc(sizeof(struct Node));\n    if (!temp)\n    {\n        printf(\"\\nNot Enough Memory\");\n    }\n    else\n    {\n        return temp;\n    }\n}\n/**************************************************************************************/\n\n\n/** Function to Insert Node at the Beginning of the list **/\n\nvoid InsetFirst (int data)\n{\n    struct Node* temp;\n    temp = CreatNode();\n    temp -&gt;data = data;\n    temp -&gt;pnext = NULL;\n    temp -&gt;pprev = NULL;\n    if (pstart == NULL)\n    {\n        pstart = temp;\n        plast = temp;\n    }\n    else\n    {\n        temp -&gt;pnext = pstart;\n        pstart -&gt;pprev =temp;\n        pstart = temp;\n    }\n}\n/***********************************************************************************/\n\n\n\n/** Function to Insert Node at the End of the List **/\n\nvoid InsertLast (int data)\n{\n    struct Node* temp;\n    temp = CreatNode();\n    temp -&gt;data = data;\n    temp -&gt;pnext = NULL;\n    temp -&gt;pprev = NULL;\n    if (pstart == NULL)\n    {\n        pstart = temp;\n        plast = temp;\n    }\n    else\n    {\n        temp -&gt;pprev = plast;\n        plast -&gt;pnext = temp;\n        plast = temp;\n    }\n}\n/**********************************************************************************************/\n\n/** Function to Print the list From the beginning to the End **/\n\nvoid PrintForward (void)\n{\n    struct Node* current;\n    current = pstart;\n    printf(\"\\nThe list From the Beginning to the End :\\n\");\n    while (current)\n    {\n        printf(\"\\n%d\",current-&gt;data);\n        current = current-&gt;pnext;\n    }\n    printf(\"\\n\");\n}\n/*********************************************************************************************/\n\nvoid PrintBackward (void)\n{\n    struct Node* current;\n    current = plast;\n    printf(\"\\nThe list From End to the Beginning :\\n\");\n    while (current)\n    {\n        printf(\"\\n%d\",current-&gt;data);\n        current = current-&gt;pprev;\n    }\n    printf(\"\\n\");\n}\n/*********************************************************************************************/\n\n/** Function To Find a Given Data **/\n\nstruct Node* Search (int data)\n{\n    struct Node* current;\n    current = pstart;\n    if (current)\n    {\n        while(current)\n        {\n            if (current-&gt;data == data)\n            {\n                return current;\n            }\n            current = current-&gt;pnext;\n        }\n        printf(\"\\nIt's not found\\n\");\n        return NULL;\n    }\n\n}\n/**************************************************************************************/\n\n/** Function to Delete a Given Node **/\n\nvoid DeleteNode (int Node )\n{\n    struct Node* state;\n    state = Search(Node);\n\n    if (state)\n    {\n        if ((state == pstart) &amp;&amp; (state == plast))\n        {\n            pstart = NULL;\n            plast = NULL;\n        }\n        else if (pstart == state)\n        {\n            pstart = state-&gt;pnext;\n            state-&gt;pnext-&gt;pprev = NULL;\n        }\n        else if (plast == state)\n        {\n            plast = state-&gt;pprev;\n            state-&gt;pprev-&gt;pnext = NULL;\n        }\n        else\n        {\n            state-&gt;pprev-&gt;pnext = state-&gt;pnext;\n            state-&gt;pnext-&gt;pprev = state-&gt;pprev;\n        }\n        free(state);\n    }\n    else\n    {\n        printf(\"NOT Found\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494460719, "post_id": 43904260, "comment_id": 74842695, "body": "You&#39;ve never allocated memory for <code>threads</code>."}, {"owner": {"reputation": 365, "user_id": 3103257, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99fb5ff4ea7c694d4e5bbc21c5eaaa1b?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/3103257/adam"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494460882, "post_id": 43904260, "comment_id": 74842734, "body": "@Barbar I&#39;m sorry for not posting the whole relevant part of the code. I have allocated the memory actually."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494461223, "post_id": 43904260, "comment_id": 74842797, "body": "You&#39;re reading <code>allread</code> and <code>found</code> outside the code protected by the mutex."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494461626, "post_id": 43904260, "comment_id": 74842888, "body": "Where do you stop the other threads when this thread finds a match?"}, {"owner": {"reputation": 365, "user_id": 3103257, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99fb5ff4ea7c694d4e5bbc21c5eaaa1b?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/3103257/adam"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494461849, "post_id": 43904260, "comment_id": 74842933, "body": "In <code>notifyfound</code> which I&#39;ve forgotten to upload before too..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1494462204, "post_id": 43904260, "comment_id": 74843000, "body": "Suppose the a thread finds the word before <code>runthreads()</code> finishes starting all the threads. The loop in <code>notifyfound()</code> will only cancel the threads that have already been started, not the ones that get started afterward."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494462270, "post_id": 43904260, "comment_id": 74843010, "body": "You have to make sure you use mutex protection around any global variable accesses in threads."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 1583655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8ac3da7ce6fb555cc0bfe8a328dcbe?s=128&d=identicon&r=PG", "display_name": "bluesawdust", "link": "https://stackoverflow.com/users/1583655/bluesawdust"}, "is_accepted": false, "score": 1, "last_activity_date": 1494476077, "last_edit_date": 1495541890, "creation_date": 1494476077, "answer_id": 43906424, "question_id": 43904260, "link": "https://stackoverflow.com/questions/43904260/pthread-does-not-exit-in-c/43906424#43906424", "title": "pthread does not exit in C", "body": "<p>This has to do with cancellation points, although the specifics are hard to come by since you haven't shared a minimal example. My diagnosis is either</p>\n\n<ol>\n<li><p>6/10 times you have at least one thread waiting for a mutex, and other one in readRecords, which will cancel and not free the mutex. Setup cancellation handlers with <code>pthread_cleanup_push</code> and <code>pthread_cleanup_pop</code> which will free your mutex, and read the manual for <a href=\"http://www.mkssoftware.com/docs/man3/pthread_cancel.3.asp\" rel=\"nofollow noreferrer\">pthread_cancel</a>. See related <a href=\"https://stackoverflow.com/q/24503877/1583655\">pthread_cleanup_push causes Syntax error</a> for some references.</p></li>\n<li><p>Some of your threads are not detecting the cancellation - try using <code>pthread_testcancel</code> to setup a guaranteed cancellation point.</p></li>\n</ol>\n\n<p>Here is some code that fixes these sorts of problems, by adding a cancellation check and mutex cleanup.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\nFILE* f;\npthread_mutex_t mutex;\npthread_t* threads;\nint n_threads = 3;\nint allread;\nlong int count = 0;\nint *thread_ids;\nint global_quit = 0;\n#define MAX 99999\n\nvoid waitforthreads(int N) {\n  printf(\"waiting for %d threads\\n\", N);\n  for (int i=0; i&lt;N; i++)\n    {\n      printf(\"thread %d | %d\\n\", i, threads[i]);\n      if(pthread_join(threads[i], NULL))\n        {\n          printf(\"problem\\n\");\n          exit(6);\n        }\n    }\n  printf(\"done.\\n\");\n}\n\nvoid notifyfound(pthread_t tid, int count) {\n  printf(\"%d | %d got big number\\n\", count, pthread_self());\n  for (int i=0; i&lt;n_threads; i++)\n    if (threads[i] &amp;&amp; !pthread_equal(threads[i], tid)) {\n      printf(\" closing '%ld'\\n\", (long) threads[i]);\n      pthread_cancel(threads[i]);\n    }\n  global_quit = 1;\n  printf(\" finished closing\\n\");\n}\n\nvoid waiting_thread_cleanup(void *arg)\n{\n  pthread_mutex_unlock((pthread_mutex_t *)arg);\n}\n\nvoid* do_thing(void* arg) {\n  pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS, NULL);\n  pthread_setcancelstate(PTHREAD_CANCEL_ENABLE, NULL);\n\n  int* id = (int *)arg;\n  int quit = 0;\n  while (!allread) {\n    pthread_mutex_lock(&amp;mutex);\n    pthread_cleanup_push(waiting_thread_cleanup, (void *)&amp;mutex); /* must be paired with pop. */\n    if(count++==MAX)\n      {\n        notifyfound(pthread_self(), *id);\n        quit=1;\n      }\n    else if(count % 10000 == 0)\n      printf(\"[%d] - %d\\n\", *id, count);\n    pthread_testcancel();       /* required to allow for the cancel to ever be 'detected' other functions are sufficient as well. */\n    pthread_mutex_unlock(&amp;mutex);\n    pthread_cleanup_pop(1);     /* if this isn't here, this will occassionally hand because the mutex isn't freed. */\n    if(quit==1)\n      {\n        printf(\"%d | %d quitting\\n\", *id, pthread_self());\n        break;\n      }\n  }\n  return NULL;\n}\n\nvoid runthreads(FILE* f, int n_threads) {\n  for (int i=0; i&lt;n_threads; i++)\n    pthread_create(&amp;threads[i], NULL, do_thing, &amp;(thread_ids[i]));\n}\n\nint main(int argc, char* argv[]) {\n  threads = (pthread_t*) calloc(n_threads, sizeof(pthread_t));\n  thread_ids = (int*) calloc(n_threads, sizeof(int));\n  for(int i=0;i&lt;n_threads;i++)\n    thread_ids[i] = i;\n\n  pthread_mutex_init(&amp;mutex, NULL);\n\n  runthreads(f, n_threads);\n  waitforthreads(n_threads);\n\n  pthread_mutex_destroy(&amp;mutex);\n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 3103257, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99fb5ff4ea7c694d4e5bbc21c5eaaa1b?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/3103257/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494476077, "creation_date": 1494459557, "last_edit_date": 1494461824, "question_id": 43904260, "link": "https://stackoverflow.com/questions/43904260/pthread-does-not-exit-in-c", "title": "pthread does not exit in C", "body": "<p>I am writing a multi-threaded application that reads a file and seeks for a word in chunks of it a thread has in memory.</p>\n\n<p>A thread needs to asynchronously close other threads looking for that word if it is first to find it.</p>\n\n<p>The problem is when a word is found and other threads are being closed the program does not terminate (in 6 out of 10 executions). I have checked in gdb that one thread does not exit. It happens even when I do not call <code>waitforthreads(n_threads)</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// [...]\nFILE* f;\npthread_mutex_t mutex;\npthread_t* threads;\nint n_threads;\nint allread;\n// [...]\n\nint main(int argc, char* argv[]) {\n  // [...]\n  threads = (pthread_t*) calloc(n_threads, sizeof(pthread_t));\n  pthread_mutex_init(&amp;mutex, NULL);\n\n  runthreads(f, word, n_threads, n_records);\n  waitforthreads(n_threads);\n\n  pthread_mutex_destroy(&amp;mutex);\n  // [...]\n}\n\n\nvoid runthreads(FILE* f, char* w, int n_threads, int n_records) {\n  struct targs_t args = {w, n_records};\n  for (int i=0; i&lt;n_threads; i++)\n    pthread_create(&amp;threads[i], NULL, findword, (void*) &amp;args);\n}\n\n\nvoid waitforthreads(int N) {\n  for (int i=0; i&lt;N; i++)\n    if(pthread_join(threads[i], NULL))\n      exit_(6);\n}\n\n\nvoid* findword(void* arg) {\n  pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS, NULL);\n  pthread_setcancelstate(PTHREAD_CANCEL_ENABLE, NULL);\n\n  struct targs_t* args = (struct targs_t*) arg;\n  int max_length = args-&gt;n_records * sizeof(record_t);\n  record_t* records = malloc(max_length);\n\n  int found = 0;\n  while (!allread &amp;&amp; !found) {\n    pthread_mutex_lock(&amp;mutex);\n    // allread is being set in the function below \n    // if the whole file has been read\n    readRecords((char*) records, args-&gt;n_records, f);\n    pthread_mutex_unlock(&amp;mutex);\n\n    for (int i=0; i&lt;args-&gt;n_records; i++)\n      if (strlen(records[i].text) == 0) break;\n      else if (strstr(records[i].text, args-&gt;word) != NULL) {\n        notifyfound(pthread_self(), records[i].id);\n        found = 1;\n        break;\n      }\n  }\n  free(records);\n  return NULL;\n}\n\n\nvoid notifyfound(pthread_t tid, int id) {\n  printf(\"Found: %d (%ld)\\n\", id, (long) tid);\n  for (int i=0; i&lt;n_threads; i++)\n    if (threads[i] &amp;&amp; !pthread_equal(threads[i], tid)) {\n      printf(\" closing %ld\\n\", (long) threads[i]);\n      pthread_cancel(threads[i]);\n    }\n  printf(\" finished closing\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "struct", "operating-system", "malloc"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1494461933, "post_id": 43904257, "comment_id": 74842948, "body": "Maybe you freed one of the variables. That allows the memory to be reused. But it doesn&#39;t change the value of the variable."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494461976, "post_id": 43904257, "comment_id": 74842959, "body": "BTW, <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 11, "user_id": 6172238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97ff6d6e79652c97c03bf5d5c98d32b?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rosberg", "link": "https://stackoverflow.com/users/6172238/f-rosberg"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494500215, "post_id": 43904257, "comment_id": 74860036, "body": "Intresting, actually got an idea to what may be wrong! Thank you!"}], "owner": {"reputation": 11, "user_id": 6172238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97ff6d6e79652c97c03bf5d5c98d32b?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rosberg", "link": "https://stackoverflow.com/users/6172238/f-rosberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494461745, "creation_date": 1494459537, "last_edit_date": 1494461745, "question_id": 43904257, "link": "https://stackoverflow.com/questions/43904257/allocating-memory-for-a-new-struct-have-same-value-as-an-already-existing-struct", "title": "Allocating memory for a new struct have same value as an already existing struct in C?", "body": "<p>I will try my best to explain my problem.</p>\n\n<p>I am currently programming a very basic OS for an ARM. I have a problem where a new struct of the type msg have the same (location?) value as a struct of type listobj.</p>\n\n<pre><code>typedef struct msgobj {\n    char            *pData;\n    exception       Status;\n    struct l_obj    *pBlock;\n    struct msgobj   *pPrevious;\n    struct msgobj   *pNext;\n} msg;\n\ntypedef struct l_obj {\n     TCB            *pTask;\n     uint           nTCnt;\n     msg            *pMessage;\n     struct l_obj   *pPrevious;\n     struct l_obj   *pNext;\n} listobj;\n</code></pre>\n\n<p>The listobjs are used to in different linked lists to control the data in the OS. While the msg's are used to save data to a mailbox simply explained.\nWhile trying the OS and the lists have formed I have a list with listobj linked doubly and correctly.</p>\n\n<p>Later I make a new msg to be inserted in the mailbox, </p>\n\n<pre><code>msg* message = (msg*)malloc(sizeof(msg))\n</code></pre>\n\n<p>Now the problem is that the value of this struct is the same as a listobj struct in one of the lists.\n<a href=\"https://i.stack.imgur.com/TtH5x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TtH5x.png\" alt=\"(value is viewed by the live watch in IAR)\"></a>\nWhen I try linking the msg to a maibox (FIFO) using the pNext and pPrevious.\nI am changing the pNext and pPrevious of the listobj. (the pNext and pPrevious is of different types)</p>\n\n<p>Is there an explaination to this? Or a way to avoid it? At the moment it seem that this is the final bug to finish the project.</p>\n\n<p>It is worth mentioning that the code uses context switches and simulated in IAR. The code for the context switches is not made by me but by my professor.</p>\n\n<p>I apologize for bad grammar,\nand thank you!</p>\n"}, {"tags": ["c", "multithreading", "linux-kernel", "semaphore"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1494455760, "post_id": 43903708, "comment_id": 74841482, "body": "Maybe you should point to the source (add a URL).  It might be good to specify &quot;functions used in the Linux kernel&quot; (or something similar) before the question mark; it clarifies context quickly that <i>is</i> available from the tags but should really be in the question proper."}, {"owner": {"reputation": 5975, "user_id": 2009594, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4dd8071609cda0c3ec0d33d6a171958?s=128&d=identicon&r=PG", "display_name": "hebbo", "link": "https://stackoverflow.com/users/2009594/hebbo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494523257, "post_id": 43903708, "comment_id": 74876965, "body": "@JonathanLeffler Thanks for the tip. I will update the question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494525632, "post_id": 43903708, "comment_id": 74878301, "body": "Did you find/look at <a href=\"https://0xax.gitbooks.io/linux-insides/content/SyncPrim/sync-5.html\" rel=\"nofollow noreferrer\">0xax.gitbooks.io/linux-insides/content/SyncPrim/sync-5.html</a>?  What about <a href=\"http://www.makelinux.net/ldd3/chp-5-sect-3\" rel=\"nofollow noreferrer\">makelinux.net/ldd3/chp-5-sect-3</a>?  That seems less helpful."}, {"owner": {"reputation": 5975, "user_id": 2009594, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4dd8071609cda0c3ec0d33d6a171958?s=128&d=identicon&r=PG", "display_name": "hebbo", "link": "https://stackoverflow.com/users/2009594/hebbo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494538116, "post_id": 43903708, "comment_id": 74884929, "body": "Yes, I have read some of those long time ago. But none of these answer any of my questions. I am asking specifically the &quot;non_owner&quot; and &quot;nested&quot; parts."}], "owner": {"reputation": 5975, "user_id": 2009594, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4dd8071609cda0c3ec0d33d6a171958?s=128&d=identicon&r=PG", "display_name": "hebbo", "link": "https://stackoverflow.com/users/2009594/hebbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494525120, "creation_date": 1494455472, "last_edit_date": 1494525120, "question_id": 43903708, "link": "https://stackoverflow.com/questions/43903708/what-is-the-difference-between-down-read-down-read-nested-and-down-read-no", "title": "What is the difference between down_read(), down_read_nested(), and down_read_non_owner()", "body": "<p>What is the difference between <code>down_read()</code>, <code>down_read_nested()</code>, and <code>down_read_non_owner()</code> in the Linux kernel?</p>\n\n<p>I tried to search on the internet, but I could not find a good description besides confused conversations. The source code itself, does not have proper comments.</p>\n\n<p>My question is related to the rw_semaphore in the Linux kernel. Here is a link to the file that has all these functions: <a href=\"http://elixir.free-electrons.com/linux/v2.6.38.8/source/kernel/rwsem.c\" rel=\"nofollow noreferrer\">http://elixir.free-electrons.com/linux/v2.6.38.8/source/kernel/rwsem.c</a></p>\n\n<p>Specific questions I have:</p>\n\n<ul>\n<li><p>Is the nested version related to allowing a thread to down read the semaphore more than once? Well, there is no need for that. A thread can do that already with the plain down read version, as long as it is up read the same number of times.\nWhat is its intended use? And how is it different from the plain version?</p></li>\n<li><p>What does the non-owner version even mean? As far as I know, a read lock does not mean the semaphore is owned by the locking process. It simply prevents write locks. A thread intending to <code>down_write</code> the semaphore has to wait for all down readers. So, does non-owner mean a down writes are allowed? Well, then this not safe. And this defeats the whole purpose of having a semaphore.</p></li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1494455452, "post_id": 43903681, "comment_id": 74841390, "body": "What magic will put a value into <code>sm</code> ? Not speaking of some other nonsensical constructs...Please grab a modern C book and read it."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 4, "creation_date": 1494455767, "post_id": 43903681, "comment_id": 74841483, "body": "<code>return(sm,av);</code> does not return 2 values, it returns av"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1494455815, "post_id": 43903681, "comment_id": 74841494, "body": "The <code>av</code> in <code>main</code> is not the same <code>av</code> as in <code>sumavg</code> which is forgotten on function exit. Function <code>sumavg</code> attempts to return a value: which relies on out of date assumptions, and the value is not collected by <code>main</code> anyway."}, {"owner": {"reputation": 427, "user_id": 4901269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/10303396ec8bbab327d22b73a8e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4901269/geoff"}, "edited": false, "score": 3, "creation_date": 1494455861, "post_id": 43903681, "comment_id": 74841511, "body": "<code>main()</code>? I&#39;m sorry, are you from the past?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 427, "user_id": 4901269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/10303396ec8bbab327d22b73a8e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4901269/geoff"}, "edited": false, "score": 3, "creation_date": 1494455888, "post_id": 43903681, "comment_id": 74841521, "body": "Do not write K&amp;R (pre-standard) C functions.  Always use the modern (as in, for the last 28 years) notation with explicit types and full function prototypes.  (@Geoff: <code>main()</code> is less of a problem than <code>sumavg()</code>.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1494457246, "post_id": 43903681, "comment_id": 74841913, "body": "That&#39;s not valid C! Pay heed to compiler warnings!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7927787"}, "edited": false, "score": 0, "creation_date": 1494700895, "post_id": 43903681, "comment_id": 74944416, "body": "<b>main()? I&#39;m sorry, are you from the past?</b>  Geoff, yes, actually I am from the past...picked up programming very late in life, so considering that C is a very old language and that writing the main function just as main() (just because I want to get down the basics correctly first), does make me look like i come from the past"}], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "is_accepted": true, "score": 2, "last_activity_date": 1494457450, "last_edit_date": 1494457450, "creation_date": 1494455917, "answer_id": 43903769, "question_id": 43903681, "link": "https://stackoverflow.com/questions/43903681/cannot-figure-out-the-output-in-this-c-program-for-calculation-of-sum-and-averag/43903769#43903769", "title": "Cannot figure out the output in this C program for calculation of sum and average using functions", "body": "<p>You call a function in which you declare, and then give <code>sm</code> and <code>av</code> a value. But these variables are local variables, they have nothing to do with the ones that are in <code>main()</code>. If you declare a variable in a function and then you declare an other variable in an other function, these two variables are <em>not</em> the same, in any case, even if they have the same name. It's like people: you may have the same name than someone else, it doesn't mean that you are the same person, and it is definitely not.</p>\n\n<p>To use the variables you declared in <code>main</code>, you could pass a pointer to them as argument of your function. Here is the prototype you would have:</p>\n\n<pre><code>void    sumavg(int a, int b, int c, int d, int e, int *sum, int *av)\n</code></pre>\n\n<p>You could also use 2 different functions that calculates the sum or average of all your ints, and then return the result directly into the variables of your <code>main</code>:</p>\n\n<pre><code>int    main(void)\n{\n    int a, b, c, d, e, sm, av;\n\n    printf (\"Enter any 5 integers:\\n\");\n    scanf (\"%d%d%d%d%d\", &amp;a, &amp;b, &amp;c, &amp;d, &amp;e);\n    sm = get_sm(a, b, c, d, e);\n    av = get_av(a, b, c, d, e);\n    printf (\"\\nSum = %d\", sm);\n    printf (\"\\nAverage = %d\", av);\n    return (0);\n}\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>int    get_sum(int a, int b, int c, int d, int e)\n{\n    return (a + b + c + d + e);\n}\n\nint    get_av(int a, int b, int c, int d, int e)\n{\n    return((a + b + c + d + e) / 5);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1494456307, "post_id": 43903795, "comment_id": 74841650, "body": "It is perfectly legitimate to use a prototype declaration with names for the arguments: <code>int sum(int v1, int v2, int v3, int v4, int v5);</code> would work, as would <code>int sum(int n, int w, int o, int b, int h);</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494456570, "post_id": 43903795, "comment_id": 74841721, "body": "Your comment doesn&#39;t mention &quot;optional&quot;; it says that the prototype must not name the parameters.  If you&#39;d said &quot;and possibly with the parameters unnamed&quot; (or something similar), we&#39;d not be having this discussion."}, {"owner": {"reputation": 455, "user_id": 7829467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc7e2bb834f1b83651d824d57525bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Gold Dragon", "link": "https://stackoverflow.com/users/7829467/gold-dragon"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494456695, "post_id": 43903795, "comment_id": 74841761, "body": "Fixed. Should have not been so quick in writing it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494456756, "post_id": 43903795, "comment_id": 74841781, "body": "Good.  I can only up-vote once, though.  Shall we remove these comments?"}], "tags": [], "owner": {"reputation": 455, "user_id": 7829467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc7e2bb834f1b83651d824d57525bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Gold Dragon", "link": "https://stackoverflow.com/users/7829467/gold-dragon"}, "is_accepted": false, "score": 4, "last_activity_date": 1494456657, "last_edit_date": 1494456657, "creation_date": 1494456100, "answer_id": 43903795, "question_id": 43903681, "link": "https://stackoverflow.com/questions/43903681/cannot-figure-out-the-output-in-this-c-program-for-calculation-of-sum-and-averag/43903795#43903795", "title": "Cannot figure out the output in this C program for calculation of sum and average using functions", "body": "<p>C needs things explained to it. It won't make the inferences many languages will. Furthermore the syntax is wrong. Let me enumerate the issues (not all of these are strictly necessary in this circumstance, but you should do them):</p>\n\n<ol>\n<li><p>Declare return types for your functions. <code>int main()</code> and for <code>sumavg</code> that brings us to number 2.</p></li>\n<li><p>C does not allow for returning multiple values that way. By that syntax, <code>sm</code> will be discarded (you're using a comma operator in the <code>return</code> statement). You should probably declare <code>int sum()</code> and <code>int avg()</code> as two separate functions.</p></li>\n<li><p>Declare types for your parameters. <code>int sum(int n, int w, int o, int b, int h)</code></p></li>\n<li><p>Functions should be declared before they are called. You can do this by putting a 'prototype' at the top (the function's signature with the body replaced with a semicolon and parameters potentially unnamed): <code>int sum(int,int,int,int,int);</code></p></li>\n<li><p>Return values are not communicated to the calling function by virtue of having the same name. You need to assign them explicitly, i.e., <code>sm = sum(a,b,c,d,e);</code></p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7927787"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 43903769, "answer_count": 2, "score": 0, "last_activity_date": 1494457450, "creation_date": 1494455344, "question_id": 43903681, "link": "https://stackoverflow.com/questions/43903681/cannot-figure-out-the-output-in-this-c-program-for-calculation-of-sum-and-averag", "title": "Cannot figure out the output in this C program for calculation of sum and average using functions", "body": "<p>I use Dev-C++ (MinGW Compiler) on a Windows 7 64-bit machine. I have written a simple program to find the sum and average of 5 integers (assuming average will be an int). Here is the code:</p>\n\n<pre><code>/*Sum and average of 5 integers*/\n#include &lt;stdio.h&gt;\n\nmain()\n{\n    int a,b,c,d,e,sm,av;\n    printf (\"Enter any 5 integers:\\n\");\n    scanf (\"%d%d%d%d%d\", &amp;a,&amp;b,&amp;c,&amp;d,&amp;e);\n    sumavg(a,b,c,d,e);\n    printf (\"\\nSum = %d\", sm);\n    printf (\"\\nAverage = %d\", av);\n    getch();\n}\n\nsumavg(n,w,o,b,h)\n{\n     int sm = n+w+o+b+h;\n     int av = sm/5;\n     return(sm,av);\n}\n</code></pre>\n\n<p>For some strange reason, the output is Sum = 2 and Average = 27, no matter what are the values of the 5 integers. Even if the average is not accurate (because it will be floating point ideally), at least the value of the sum returned should be accurate. What am I doing wrong? Thanks...</p>\n"}, {"tags": ["c", "arrays", "loops", "readfile"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1494455438, "post_id": 43903667, "comment_id": 74841382, "body": "Are you familiar with containers, such as arrays? It looks as if you are attempting something too far beyond your ability to be a useful exercise."}, {"owner": {"reputation": 789, "user_id": 3586305, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/464ee72c175d2c8cbb8488ec020ef5b8?s=128&d=identicon&r=PG&f=1", "display_name": "jms1980", "link": "https://stackoverflow.com/users/3586305/jms1980"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1494455542, "post_id": 43903667, "comment_id": 74841417, "body": "I know I have to read the data from the results.txt into an array put the issue is parsing the lines from that file into x,y,u and v."}, {"owner": {"reputation": 789, "user_id": 3586305, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/464ee72c175d2c8cbb8488ec020ef5b8?s=128&d=identicon&r=PG&f=1", "display_name": "jms1980", "link": "https://stackoverflow.com/users/3586305/jms1980"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1494455598, "post_id": 43903667, "comment_id": 74841435, "body": "I was able to do this in perl but the processing time for large files can take a long time."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1494456999, "post_id": 43903667, "comment_id": 74841849, "body": "Use comparisons <code>==</code> and not assignments <code>=</code> in conditions: <code>if (xx= x &amp;&amp; yy = y){</code> is wrong."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1494457195, "post_id": 43903667, "comment_id": 74841899, "body": "Your example code bears no relation to the example data.  The example data is relatively straight-forward; you create an in-memory record of the data in the <code>results.txt</code> file (array, list, other structure? I&#39;ll assume an array), and then as you&#39;re reading the data from the other file, lookup the entry in the array and print the appropriate data.  It is harder if you&#39;re dealing with float indexes (and <code>lat</code> and <code>lon</code> in the code suggest that you are).  You can&#39;t do fractional indexes in an array (so you can&#39;t lookup using <code>lat</code> and <code>lon</code> as the indexes).  You can still search an array."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1494457209, "post_id": 43903667, "comment_id": 74841902, "body": "<code>fscanf(fp, &quot;%d %d %d %d&quot;, &amp;x, &amp;y, %u, %v);</code> What&#39;s the problem?"}, {"owner": {"reputation": 842, "user_id": 6572460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3c0888e8617ae4a4c18fc6b3cba6d517?s=128&d=identicon&r=PG&f=1", "display_name": "Nguai al", "link": "https://stackoverflow.com/users/6572460/nguai-al"}, "edited": false, "score": 1, "creation_date": 1494458510, "post_id": 43903667, "comment_id": 74842230, "body": "You missed <code>5 3 9 9</code>  in the output file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494519203, "post_id": 43903667, "comment_id": 74874631, "body": "the posted code causes the compiler to output several &#39;error&#39; messages.  How can you expect us to advise you when you have not posted code that cleanly compiles?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494519501, "post_id": 43903667, "comment_id": 74874797, "body": "when compiling, always enable all the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu11</code> ).   Amongst other things, this line: <code>printf(&quot;%d %d %f %f\\n&quot;,xx,yy,u,v)</code> refers to variable <code>v</code> and <code>u</code> but those variable do not exist AND the line is missing a trailing semicolon <code>;</code>.   Similar missing semicolon for: <code>printf(&quot;%d %d\\n&quot;,x,y)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494519629, "post_id": 43903667, "comment_id": 74874871, "body": "for ease of readability and understanding: 1) follow the axiom: <i>only statement per line and (at most) one variable declaration per statement.</i>  2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494519706, "post_id": 43903667, "comment_id": 74874919, "body": "the variables: <code>x</code>, <code>xx</code>, <code>y</code>, <code>yy</code> are not declared"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494519850, "post_id": 43903667, "comment_id": 74875002, "body": "the variables: <code>lat</code> and <code>lon</code> are declared as <code>float</code>, so all literals being assigned to them should also be declared <code>float</code>.  I.E. the literals need a decimal point AND a trailing <code>f</code>.   With no decimal point, the value is an <code>int</code>.  With no trailing <code>f</code> the value is a <code>double</code>,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494520076, "post_id": 43903667, "comment_id": 74875158, "body": "it is a poor programming practice to <code>#include</code> header files those contents are not being used in the code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494520791, "post_id": 43903667, "comment_id": 74875568, "body": "did someone replace the actual OPs code with some silliness?  The question has nothing to do with the &#39;currently&#39; posted code."}], "answers": [{"tags": [], "owner": {"reputation": 4082, "user_id": 7893951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5eWm1.jpg?s=128&g=1", "display_name": "Akira", "link": "https://stackoverflow.com/users/7893951/akira"}, "is_accepted": false, "score": 0, "last_activity_date": 1494525456, "last_edit_date": 1494525456, "creation_date": 1494524715, "answer_id": 43922364, "question_id": 43903667, "link": "https://stackoverflow.com/questions/43903667/filling-in-one-text-file-with-values-from-another-text-file/43922364#43922364", "title": "filling in one text file with values from another text file", "body": "<p>Okay, let me tell you I didn't understand what do you want to do with your example code. It seems that it has no connection with your question:</p>\n\n<blockquote>\n  <p>filling in one text file with values from another text file</p>\n</blockquote>\n\n<p>If you already have the filled <code>results.txt</code> and you wish to fill the second file (let call it <code>second.txt</code>) as you defined, then you can do it as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    FILE* fp;\n    int x, y, i;\n    char found = 0;\n\n    int results[1024][4] = {};\n    int rows = 0;\n\n    /* Open the results.txt for read. */\n    fp = fopen(\"results.txt\", \"r\");\n    if(fp == NULL)\n        exit(EXIT_FAILURE);\n\n    /* Parse results.txt line-by-line and store the values to results array. */\n    while(fscanf(fp, \"%d %d %d %d\\n\",\n            &amp;results[rows][0], &amp;results[rows][1],\n            &amp;results[rows][2], &amp;results[rows][3]) == 4 &amp;&amp; rows &lt; 1024) {\n        printf(\"x: %d, y: %d, u: %d, v: %d\\n\", results[rows][0],\n                results[rows][1], results[rows][2], results[rows][3]);\n        rows++;\n    }\n\n    fclose(fp);\n\n    /* Open the second.txt for write. */\n    fp = fopen(\"second.txt\", \"w\");\n    if(fp == NULL)\n        exit(EXIT_FAILURE);\n\n    for(x = 2; x &lt;= 5; ++x) {\n        for(y = 1; y &lt;= 5; ++y) {\n            found = 0;\n\n            /* Search for matching entry in results array. */\n            for(i = 0; i &lt; rows; ++i) {\n                if(results[i][0] == x &amp;&amp; results[i][1] == y) {\n                    found = 1;\n                    break;\n                }\n            }\n\n            if(found)\n                fprintf(fp, \"%d %d %d %d\\n\", x, y, results[i][2], results[i][3]);\n            else\n                fprintf(fp, \"%d %d\\n\", x, y);\n        }\n    }\n\n    fclose(fp);\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>The example above is not optimized but tested and works. It is limited to maximal 1024 lines in <code>results.txt</code>.</p>\n"}], "owner": {"reputation": 789, "user_id": 3586305, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/464ee72c175d2c8cbb8488ec020ef5b8?s=128&d=identicon&r=PG&f=1", "display_name": "jms1980", "link": "https://stackoverflow.com/users/3586305/jms1980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494525456, "creation_date": 1494455266, "question_id": 43903667, "link": "https://stackoverflow.com/questions/43903667/filling-in-one-text-file-with-values-from-another-text-file", "title": "filling in one text file with values from another text file", "body": "<p>I have the following text file results.txt:</p>\n\n<pre><code>x y  u  v\n3 2 10 12\n3 3 10 15\n3 4 11 15\n5 1 10 12\n5 2 12 13\n5 3 9 9\n</code></pre>\n\n<p>Now I want to take the values u and v from the above file and put them into another file where x goes from 2 to 5 and y goes from 1 to 5 so I can get the desired output:</p>\n\n<pre><code>2 1 \n2 2\n2 3\n2 4\n2 5\n3 1\n3 2 10 12\n3 3 10 15\n3 4 11 15\n3 5\n4 1\n4 2\n4 3\n4 4\n4 5\n5 1 10 12\n5 2 12 13\n5 3\n5 4\n5 5\n</code></pre>\n\n<p>For generating the x and y values in the above output I just use a loop as shown below:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n\n    float lat,lon;\n    int count;\n\n    count=1;\n\n    for ( lat = -70; lat &lt;= 80; lat = lat + .125){\n        for ( lon = -179.875; lon &lt;= 180; lon = lon + 0.125){\n            printf(\"%d) Value of lat/lon: %0.2f/%0.2f\\n\", count,lat,lon);\n            count=count+1;\n            if (xx= x &amp;&amp; yy = y){\n                 printf(\"%d %d %f %f\\n\",xx,yy,u,v)\n            }\n            else\n            {\n                 printf(\"%d %d\\n\",x,y)\n\n            }       \n        }\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>In the context of the above c program snippet, how do I do I read the file results.txt along with the above loop so that when the x and y values combinations from the above loop match the x and y combinations in results.txt (xx and yy) inserts it prints the corresponding line from the results.txt file?  How do I tweak the above program with the appropriate read statements to get the desired output results?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1494455305, "post_id": 43903653, "comment_id": 74841323, "body": "What do <i>you</i> think it does? That really belongs in your question as well."}, {"owner": {"reputation": 738, "user_id": 7572026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340e7b48d6bfe006ce1b6f7161911df2?s=128&d=identicon&r=PG&f=1", "display_name": "Manav Dubey", "link": "https://stackoverflow.com/users/7572026/manav-dubey"}, "edited": false, "score": 0, "creation_date": 1494455328, "post_id": 43903653, "comment_id": 74841334, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35021521/what-does-do-in-c-language\">What does ** do in C language</a>"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 2, "creation_date": 1494455423, "post_id": 43903653, "comment_id": 74841376, "body": "<code>50d &amp; 3d</code> == <code>110010b &amp; 000011b</code> == <code>10b</code> == <code>2d</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1494455468, "post_id": 43903653, "comment_id": 74841395, "body": "Can you see that 50 &amp; 3 = 2? <code>p++;</code> increments <code>p</code> so that it points to the second element of <code>arr[]</code>."}, {"owner": {"reputation": 64, "user_id": 7419065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd878d9638f079c2a44a05d3ed4a2624?s=128&d=identicon&r=PG&f=1", "display_name": "nan0", "link": "https://stackoverflow.com/users/7419065/nan0"}, "edited": false, "score": 0, "creation_date": 1494456080, "post_id": 43903653, "comment_id": 74841581, "body": "Okay, the ampersand is in that case a binary compare operator and has nothing to do with the pointer. thanks."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1494456356, "post_id": 43903653, "comment_id": 74841658, "body": "No, the <code>&amp;</code> in <code>50 &amp;(** p2 );</code> is a bitwise <code>AND</code> operator."}], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 7829467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc7e2bb834f1b83651d824d57525bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Gold Dragon", "link": "https://stackoverflow.com/users/7829467/gold-dragon"}, "is_accepted": true, "score": 2, "last_activity_date": 1494456465, "creation_date": 1494456465, "answer_id": 43903844, "question_id": 43903653, "link": "https://stackoverflow.com/questions/43903653/c-pointers-and-integers-pointer-behavior-in-a-certain-case/43903844#43903844", "title": "C Pointers and integers \u2014 Pointer-behavior in a certain case", "body": "<p><code>x</code> is assigned the value of <code>50</code> bitwise-and'd with the integer pointed to by the pointer pointed to by <code>p2</code>.</p>\n\n<p>Or in other terms, it is bitwise-and-ing 50 and 3. 50 is in binary 00110010 where 3 is 00000011. The only bit that they both have a 1 in is the second-least-significant. Therefore, the result is 00000010, or 2.</p>\n"}], "owner": {"reputation": 64, "user_id": 7419065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd878d9638f079c2a44a05d3ed4a2624?s=128&d=identicon&r=PG&f=1", "display_name": "nan0", "link": "https://stackoverflow.com/users/7419065/nan0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43903844, "answer_count": 1, "score": -1, "last_activity_date": 1494456504, "creation_date": 1494455185, "last_edit_date": 1494456504, "question_id": 43903653, "link": "https://stackoverflow.com/questions/43903653/c-pointers-and-integers-pointer-behavior-in-a-certain-case", "title": "C Pointers and integers \u2014 Pointer-behavior in a certain case", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int arr [6] = {22,3,30,1};\n    int * p = arr ;\n    p++;\n    int ** p2 = &amp;p;\n    int x = 50 &amp;(** p2 );\n    printf(\"\\n\\n%d\\n\\n\", x);\n}\n</code></pre>\n\n<p>Can someone explain what happens in the second last row?\n<code>printf</code> prints <code>2</code>.</p>\n"}, {"tags": ["c", "backtracking", "maze"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494454435, "post_id": 43903527, "comment_id": 74840982, "body": "Do you have a prototype of <code>is_min</code>? Really the message is telling you pretty much everything."}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494454507, "post_id": 43903527, "comment_id": 74841012, "body": "what does a prototype of is_min mean?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494454533, "post_id": 43903527, "comment_id": 74841027, "body": "Ok.. .show the full code then."}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494454628, "post_id": 43903527, "comment_id": 74841065, "body": "the main calls for path"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494454686, "post_id": 43903527, "comment_id": 74841090, "body": "Show the full code. <i>Please</i>."}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494455055, "post_id": 43903527, "comment_id": 74841225, "body": "<a href=\"https://pastebin.com/GH7cagqT\" rel=\"nofollow noreferrer\">pastebin.com/GH7cagqT</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494455118, "post_id": 43903527, "comment_id": 74841248, "body": "What&#39;s in <code>test_data.h</code>?"}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494455164, "post_id": 43903527, "comment_id": 74841260, "body": "a few test mazes, together with other test cases for the other Qs    int maze1[N][N] = { \t{1,\t1,\t1,\t1,\t1,\t1,\t1}, \t{1,\t1,\t1,\t1,\t1,\t1,\t1}, \t{1,\t1,\t1,\t1,\t0,\t1,\t1}, \t{0,\t1,\t0,\t0,\t0,\t1,\t1}, \t{0,\t1,\t0,\t1,\t1,\t1,\t1}, \t{0,\t1,\t0,\t1,\t0,\t0,\t1}, \t{1,\t1,\t0,\t1,\t1,\t1,\t1}};"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1494455193, "post_id": 43903527, "comment_id": 74841270, "body": "You need to declare functions before you use them.  If you&#39;re compiling with a C compiler that still allows the ancient C90 semantics, rather than the old C99 semantics or the current C11 semantics, then the compiler assumes from your use of <code>is_min()</code> that it returns an <code>int</code>, and gets upset when you define it and say it returns <code>void</code> (nothing) instead.  That&#39;s what the error message means.  At minimum, declare functions before you use them.  Often, it is better to define the function before you use it \u2014 reverse the order of the functions."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494455239, "post_id": 43903527, "comment_id": 74841296, "body": "So no prototype I guess. Prototype is that declaration @JonathanLeffler is talking about."}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494455331, "post_id": 43903527, "comment_id": 74841338, "body": "Thank you @JonathanLeffler and EugeneSh , indeed after switching the functions the program compiled. but now I have a new issue that it doesn&#39;t find the best path"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494455375, "post_id": 43903527, "comment_id": 74841356, "body": "Also, you should not place empty variable definitions after functions.  You have <code>void is_min(int n, int maze[][N], int i, int j, int *maxlen){ \u2026 };</code> and that trailing semicolon is not needed.  Some compilers will warn about it.  Technically, that semicolon marks the end of a variable definition \u2014 but a variable definition with neither type nor variable name, hence &#39;empty&#39;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494455414, "post_id": 43903527, "comment_id": 74841373, "body": "Fixing your algorithm is a separate problem.  Go resolve it using your debugger to see where it is going wrong, or use debugging print statements.  Fixing the code when running is not a part of the initial problem."}, {"owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494455589, "post_id": 43903527, "comment_id": 74841433, "body": "@JonathanLeffler, Thank you very much"}], "owner": {"reputation": 41, "user_id": 7994259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91aa903902daca7145c71536fccf62d5?s=128&d=identicon&r=PG&f=1", "display_name": "gxxgly_eyez", "link": "https://stackoverflow.com/users/7994259/gxxgly-eyez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494454454, "creation_date": 1494454387, "last_edit_date": 1494454454, "question_id": 43903527, "link": "https://stackoverflow.com/questions/43903527/solving-maze-using-backtracking-in-c-error", "title": "Solving maze using backtracking in C error", "body": "<p>Im trying to find the best way to exit a maze ([N][N] array, N&lt;20) where 1's are passages, and 0's are walls.\nstarting from the top left [0][0], exiting from bottom right[N-1][N-1].</p>\n\n<p>Im getting the following error:\nerror C2371: 'is_min' : redefinition; different basic types</p>\n\n<p>any idea what I'm doing wrong?\nthanks in advance</p>\n\n<pre><code>int search_path(int n, int maze[][N], int i,  int j){\n\n    int maxlen = 400;\n    int current_best;\n\n\n    if (maze[i][j] == 0) return False;\n    if (maze[i][j] == -1) return False;\n    if (i==N-1 &amp;&amp; j==N-1 ) return True;\n\n    maze[i][j] = -1;\n\n    if(i &lt; N-1) \n        is_min(n,maze,i,j+1,&amp;maxlen);\n    if  (i &gt;0 ) \n        is_min(n,maze,i-1,j,&amp;maxlen) ;\n    if  (j &lt; N-1 ) \n        is_min(n,maze,i,j+1,&amp;maxlen) ;\n    if  (j &gt;0 ) \n        is_min(n,maze,i,j-1,&amp;maxlen);\n\n     maze[i][j] = 1;\n\n    if ((maxlen == 400)||(maxlen ==0))\n        return False;\n\n     return maxlen+1;\n\n};\n\nvoid is_min(int n, int maze[][N], int i, int j, int *maxlen){\n\n    int current_best = search_path(n,maze, i, j);\n\n    if ((current_best &lt; *maxlen) &amp;&amp; (current_best &gt; 0)){\n        *maxlen = current_best;};\n};\n\n\n\n\n\n    void path(int n, int maze[][N])\n{\n    //find best path, starting from 0,0\n    int best = search_path(n, maze, 0,0);\n\n    if (best == 0){\n        printf(\"No path found!\\n\");}\n    else\n        printf(\"Shortest path length is:%d\\n\", best);\n\n }\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1494453095, "post_id": 43903267, "comment_id": 74840513, "body": "<code>%d</code> is used to input an integer. <code>scanf</code> is taking a pointer."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1494453105, "post_id": 43903267, "comment_id": 74840516, "body": "and what does the debugger show when you step through?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1494453161, "post_id": 43903267, "comment_id": 74840548, "body": "Enable your compiler all warnings to catch simple mistakes like <code>int character; ...    scanf(&quot;%d&quot;, character);</code>"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 1, "creation_date": 1494454922, "post_id": 43903267, "comment_id": 74841171, "body": "The loop is also slightly wrong, if the target character appears more than once in succession."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7994152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150d16a30c4f9ecadfdd2a1908485480?s=128&d=identicon&r=PG&f=1", "display_name": "Crushinz", "link": "https://stackoverflow.com/users/7994152/crushinz"}, "edited": false, "score": 0, "creation_date": 1494456507, "post_id": 43903786, "comment_id": 74841699, "body": "Yes this worked a treat, thank you very much. Still very new to this lol."}], "tags": [], "owner": {"reputation": 1128, "user_id": 1267222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44f5d723bf2ef2dac40327bfa9815989?s=128&d=identicon&r=PG", "display_name": "Jan-Gerd", "link": "https://stackoverflow.com/users/1267222/jan-gerd"}, "is_accepted": true, "score": 0, "last_activity_date": 1494456060, "creation_date": 1494456060, "answer_id": 43903786, "question_id": 43903267, "link": "https://stackoverflow.com/questions/43903267/need-to-remove-character-from-a-string-in-c/43903786#43903786", "title": "Need to remove character from a string in C", "body": "<p>The first issue in your code is easily spotted by the compiler:</p>\n\n<pre><code>$ clang char.c\nchar.c:15:17: warning: format specifies type 'int *' but the argument has type 'int' [-Wformat]\nscanf(\"%d\", character);\n       ~~   ^~~~~~~~~\n 1 warning generated.\n</code></pre>\n\n<p>If you take the address of <code>character</code> by replacing it with <code>&amp;character</code> your code will compile but still not work correctly. First, replace <code>%d</code> by <code>%c</code> since you want a <code>char</code>, not an <code>int</code>, and update the definition accordingly (<code>char character</code>). Then, if you only need to output the input string minus any occurrences of the specified character you can get this by simply iterating over the characters one by one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX_LENGTH 25\n\n\nint main(void)\n{\n    char string[MAX_LENGTH];\n    char character;\n    int count, i, j;\n\n    printf(\"Enter a string (max length 25): \");\n    fgets(string, MAX_LENGTH, stdin);\n    printf(\"Enter a character: \");\n    scanf(\"%c\", &amp;character);\n    printf(\"%s\", \"Output String: \");\n    count = 0;\n    for (i = 0; string[i] != '\\0'; i++){\n        if (string[i] != character) {\n            putchar(string[i]);\n            count++;\n        }\n    }\n\n    printf(\"Output Count: %d\\n\", count);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ clang char.c -o char &amp;&amp; ./char\nEnter a string (max length 25): arra\nEnter a character: r\nOutput String: aa\nOutput Count: 2\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7994152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150d16a30c4f9ecadfdd2a1908485480?s=128&d=identicon&r=PG&f=1", "display_name": "Crushinz", "link": "https://stackoverflow.com/users/7994152/crushinz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 43903786, "answer_count": 1, "score": 0, "last_activity_date": 1494456060, "creation_date": 1494452960, "question_id": 43903267, "link": "https://stackoverflow.com/questions/43903267/need-to-remove-character-from-a-string-in-c", "title": "Need to remove character from a string in C", "body": "<p>I need to write a program that takes a string and a character as input, then removes all of that character from the string. The catch is I need to use the same string to print the output. The code I've done so far doesn't remove anything and I don't know why. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX_LENGTH 25\n\n\nint main(void)\n{\n    char string[MAX_LENGTH];\n    int character;\n    int count, i, j;\n\n    printf(\"Enter a string (max length 25): \");\n    fgets(string, MAX_LENGTH, stdin);\n    printf(\"Enter a character: \");\n    scanf(\"%d\", character);\n\n    count = 0;\n    for (i = 0; string[i] != '\\0'; i++){\n        while (string[i] == character){\n            count ++;\n            for (j = i; string[j] != '\\0'; j++){\n                string[j] = string[j+1];\n            }\n            string[j] = '\\0';\n        }\n\n    }\n    printf(\"Output String: %s\", string);\n    printf(\"Output Count: %d\\n\", count);\n}\n</code></pre>\n"}, {"tags": ["c", "fgets", "lines", "fgetc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1494453306, "post_id": 43903249, "comment_id": 74840598, "body": "To read file <i>lines</i>, better to use <code>fgets()</code> than <code>fgetc&#47;fscanf()</code>"}, {"owner": {"reputation": 1604, "user_id": 5991423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/beK29.jpg?s=128&g=1", "display_name": "Aaron3468", "link": "https://stackoverflow.com/users/5991423/aaron3468"}, "edited": false, "score": 0, "creation_date": 1494453721, "post_id": 43903249, "comment_id": 74840752, "body": "I highly recommend the use of scripting languages like python or ruby script for preprocessing a file. The i/o libraries of scripting languages tend to have a lot less footguns to be aware of and even large files don&#39;t usually take more than a second to process. Still, this question is asked very well. Welcome to Stack Overflow!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494470725, "post_id": 43903249, "comment_id": 74844883, "body": "<code>fscanf(programFile, &quot;%s&quot;, symbol);</code> --&gt; <code>ungetc(ch, programFile); fscanf(programFile, &quot;%s&quot;, symbol);</code> Your input starts with a space rather than a tab. If you treat spaces like tabs, <code>if(ch == &#39;\\t&#39;){</code> --&gt; <code>if(isspace(ch)){</code>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1494483014, "post_id": 43903249, "comment_id": 74848621, "body": "You should learn how to use a debugger and step one instruction at a time to see what you program actually does. But mixing <code>fgets</code> or <code>fgetc</code> and <code>scanf</code> is always a wrong idea and leads to problem. The correct way here <i>as input is line oriented</i> is to use <code>fgets</code> to read a line, test the first char of the line and use <code>sscanf</code> to decode the line"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1494484747, "post_id": 43903249, "comment_id": 74849563, "body": "<code>while (fgets (line, sizeof line, fp)) { if (*line == &#39;\\t&#39;) continue; ...do something with line...}</code> will skip all lines beginning with a <code>tab</code> (don&#39;t forget the trailing <code>&#39;\\n&#39;</code>)"}, {"owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "edited": false, "score": 0, "creation_date": 1494493286, "post_id": 43903249, "comment_id": 74855109, "body": "What I would do: first, I would make a function that lets you choose the line you&#39;re going to work on. Dependening on what the first characters are, you would do something. To evaluate what the first characters are, I would fill a string of these characters and make a call to <code>strcmp</code> to evaluate if they are equal to &lt;--tab--&gt; or if they are different."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494488471, "post_id": 43906200, "comment_id": 74851988, "body": "I like your approach, but recall calling <code>strtok</code> on <code>str</code> modifies <code>str</code> which may prevent its reuse if required. If you wish to remove the leading <code>&#39;\\t&#39;</code> from <code>str</code>, it may be much easier to simply use <code>str + 1</code>. Depends on your needs."}, {"owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494490130, "post_id": 43906200, "comment_id": 74853010, "body": "I am sorry, but I think the author means is that if a line is &quot;sta val2&quot;, it should ouput &quot;sta&quot; instead of &quot;sta val2&quot; ."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494492445, "post_id": 43906200, "comment_id": 74854492, "body": "That was unclear to me. That&#39;s why I included the description about handling the parsing as needed. Whether by <code>strtok</code>, <code>sscanf</code> or simply walking a pointer down the string. I&#39;ll look again for additional detail, but the thrust seemed to be segregating the the lines beginning with <code>tab</code> from the others."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494493232, "post_id": 43906200, "comment_id": 74855060, "body": "Updated, used a slightly different parse, but to the same effect."}, {"owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "edited": false, "score": 0, "creation_date": 1494493736, "post_id": 43906200, "comment_id": 74855443, "body": "I think that you should put your code in a <code>if</code> statement that evaluates if the file was correctly open. There could be some reasons for the opening to fail and if you try to <code>fclose</code> a pointer that does not point to any file (because it failed to <code>fopen</code> it), it will (or may) segfault. Not sure if this is an important detail here though. I&#39;ll delete my comment if it is not."}, {"owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "edited": false, "score": 0, "creation_date": 1494495410, "post_id": 43906200, "comment_id": 74856683, "body": "Thank you very mush for your suggestion. I don&#39;t handle these errors."}], "tags": [], "owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494474516, "creation_date": 1494474516, "answer_id": 43906200, "question_id": 43903249, "link": "https://stackoverflow.com/questions/43903249/skipping-specific-lines-and-storing-variables-specific-variables-in-c/43906200#43906200", "title": "Skipping specific lines and storing variables specific variables in C", "body": "<p>I think you maybe use four ' ' instead of '\\t' before ldb, addr, float, stat, j. And the following could work.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, const char *argv[])\n{\n    char str[100];\n    FILE* pointer_file = fopen(\"test\", \"r\");\n\n    while (fgets(str, sizeof str, pointer_file) != NULL )\n        if (str[0] != '\\t') {\n            fputs(strtok(str, \" \\t\\n\"), stdout);\n            fputs(\"\\n\", stdout );\n        }\n    fclose(pointer_file);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1494586581, "post_id": 43909227, "comment_id": 74904015, "body": "<code>... Basically, convenience and efficiency. Line-oriented input functions provide a buffered read ...</code> That is true, but getc() and fgetc() read from <b>exactly</b> the same buffer, thus there is no efficiency gain in using line-oriented input. Actually, line-oriented input is  (marginally) <i>slower</i>, because it forces you to make <i>at least</i> one extra pass over the same buffer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1494622756, "post_id": 43909227, "comment_id": 74925594, "body": "The problem with <code>getc</code> is there is no guarantee how it is implemented, it may be a macro that evaluates the input stream more than once. The I/O penalty for a character-oriented read can be significant over it&#39;s line-oriented counterpart. Yes conditions may very whether reading from SSD or Platter drives (or tape), but you can easily prove this to yourself by timing the reads of a large text file (10-100M). I&#39;ve seen order of magnitude differences in the tests I&#39;ve run. I don&#39;t dispute that the FILE* stream is buffered, but the read times are still significantly different."}, {"owner": {"reputation": 41, "user_id": 7543281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f5f4812fea12fe5fc4edf694674055?s=128&d=identicon&r=PG&f=1", "display_name": "Chibuikem", "link": "https://stackoverflow.com/users/7543281/chibuikem"}, "edited": false, "score": 0, "creation_date": 1494635964, "post_id": 43909227, "comment_id": 74928951, "body": "Hey @DavidC.Rankin, thanks for your help. I tried using the first approach you mentioned because that output would be better for my use, but when I tested it, my output came out to be <code>start mul  - no tab\\n  - no tab\\n  - begins with tab\\n  - begins with tab\\n  - no tab\\n  - begins with tab\\n loop lda # - no tab\\n  - no tab\\n  - begins with tab\\n  - no tab\\n  - begins with tab\\n val1 word  - no tab\\n  - no tab\\n val2 word  - no tab\\n 0 - no tab</code> I tried debugging, and it seems len is always 10, for the lines w/out tabs and for the lines w/ tab, len is something different"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494643426, "post_id": 43909227, "comment_id": 74930075, "body": "If I understand you are getting a literal <code>start mul - no tab\\n - no tab\\n</code> that tells me you have <b>blank lines that begin with a</b> <code>tab</code>. Simple to handle, just add a second check to see if the following character is a <code>newline</code>, e.g. <code>if (*line == &#39;\\t&#39;) { if (line[1] == &#39;\\n&#39;) continue; ... }</code>"}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1494838039, "post_id": 43909227, "comment_id": 74979629, "body": "@DavidC.Rankin In all the implementations I&#39;ve seen since 1985, getc() was implemented as a macro. But I agree: there is no guarantee. And the undelying FS (SSD, etc) is not relevant here: the read()s still go in block-sized chunks, typically 512 byes."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494867667, "post_id": 43909227, "comment_id": 74999241, "body": "Do you have a source link for the <code>512</code> size? It appears to derive from <code>#define _G_BUFSIZ 8192</code> see <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/_G_config.h;hb=cdd45522b6e87369afc341402bda7a95bdf83380\" rel=\"nofollow noreferrer\"><b>sysdeps/unix/sysv/linux/_G_config.h</b></a> which is the low-level file buffer size itself on opening, not the number of bytes read by <code>fgetc</code>. <code>fgetc</code> now appears implemented through <code>int _IO_getc (FILE *fp)</code> and the use of a <code>weak alias</code>. Much easier to track when <code>stdio&#47;fgetc.c</code> actually existed (pre 2002)."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1494494198, "last_edit_date": 1494494198, "creation_date": 1494488085, "answer_id": 43909227, "question_id": 43903249, "link": "https://stackoverflow.com/questions/43903249/skipping-specific-lines-and-storing-variables-specific-variables-in-c/43909227#43909227", "title": "Skipping specific lines and storing variables specific variables in C", "body": "<p>Continuing from the comment, while there is nothing wrong with using <em>character-oriented</em> input functions (e.g. <code>fgetc</code>, <code>getc</code>), when needing to handle <strong>\"lines\"</strong> of data, you are far better served to use the <em>line-oriented</em> input functions provided by the C-library (<code>fgets</code>) or POSIX (<code>getline</code>) and then parsing the needed information from each line.</p>\n\n<p>Why? Basically, convenience and efficiency. Line-oriented input functions provide a <em>buffered</em> read (reading multiple-characters each time) and for large input files can really help with file I/O. Next, regardless of the contents, you will read the whole line (provided there is sufficient storage for line when using <code>fgets</code> -- otherwise you will read multiple chunks until the complete line is read; <code>getline</code> will automatically allocate (and reallocate) sufficient storage to hold each line). </p>\n\n<p>You then have the tools like <code>sscanf</code>, <code>strtok</code>, <code>strsep</code>, <code>strstr</code>, <code>strchr</code>, etc.. that you can parse whatever you need from the stored line. (you can also <em>always</em> use simple <em>pointer arithmetic</em> to parse any line with a pointer, or pair of pointers, \"<em>walking the string</em>\" and comparing each character as you go) In-memory operations on each character in a stored string are orders of magnitude faster than performing the same operation while doing file I/O on each at the same time.</p>\n\n<p>When you are concerned about the beginning character of each line, you only need compare <code>line[0]</code> (or simply <code>*line</code>) against whatever character you are looking for.</p>\n\n<p>The following is a simple example that reads from the input filename given as the first argument (or from <code>stdin</code>, by default if no filename is given) and then tests the beginning character of each line. If the line begins with a <code>tab</code>, it simply outputs the line preceded by a <code>tab</code> (after having skipped the <code>tab</code> from the file by outputting <code>line + 1</code>) followed by <code>-- begins with tab</code> (you can handle those lines however you like, or skip them entirely), otherwise it will output the line itself followed by <code>-- no tab</code>. The handling of the differing prefixed lines is completely up to you. You can build an array of pointers holding each different type of line, or use a struct containing the commands and tabbed content in pointer arrays to preserve the line associations (which commands go with which tabbed lines), if required.</p>\n\n<p>The only other note on <em>line-oriented</em> input functions is that they read <em>up to and including</em> the trailing <code>'\\n'</code>. You generally do not want to store strings with <code>newlines</code> dangling off the ends, so you will want to trim the <code>newlines</code> by overwriting the trailing <code>'\\n'</code> with the <em>nul-terminating character</em>. The example does this by getting the length of each line with <code>strlen</code> and then overwriting the <code>newline</code> with <code>0</code> (which is equivalent to the character <code>'\\0'</code>). I don't like to type...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 64\n\nint main (int argc, char **argv) {\n\n    char line[MAX] = \"\";\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (fgets (line, MAX, fp))   /* read each line in file  */\n    {\n        size_t len = strlen (line); /* get the length */\n\n        if (line[len - 1] == '\\n')  /* check for trailing '\\n' */\n            line[--len] = 0;        /* overwrite with nul-byte */\n\n        if (*line == '\\t') {        /* if first char is '\\t'   */\n            printf (\"\\t%s - begins with tab\\n\", line + 1);\n            continue;\n        }\n\n        printf (\"%s - no tab\\n\", line);     /* line has no tab */\n    }\n\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Input File</strong></p>\n\n<pre><code>$ cat dat/tabfile.txt\nstart mul val1\n        ldb #2\n        addr A B\n        float\nloop lda #1\n        sta val2\n        j loop\nval1 word 12\nval2 word 0\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/filehandletab &lt;dat/tabfile.txt\nstart mul val1 - no tab\n        ldb #2 - begins with tab\n        addr A B - begins with tab\n        float - begins with tab\nloop lda #1 - no tab\n        sta val2 - begins with tab\n        j loop - begins with tab\nval1 word 12 - no tab\nval2 word 0 - no tab\n</code></pre>\n\n<p>As pointed out in the comments, if your intent was to parse the first word from the lines not beginning with a <code>tab</code>, then you can simply use <code>strchr</code> to locate the first <code>space</code>, temporarily terminate line at the <code>space</code> make use of the command, and then restore the <code>space</code> so the string can be further parsed a second time, if required, e.g.</p>\n\n<pre><code>while (fgets (line, MAX, fp)) \n{\n    char *p = NULL;\n    size_t len = strlen (line);\n    ...\n    if (*line == '\\t') {        /* if first char is '\\t'   */\n        printf (\"\\t%s - begins with tab\\n\", line + 1);\n        continue;\n    }\n\n    if ((p = strchr (line, ' '))) {      /* find first ' ' */\n        *p = 0;                          /* terminate at p */\n        printf (\"%s - no tab\\n\", line);  /* output line    */\n        *p = ' ';                        /* restore ' '    */\n    }\n    else\n        printf (\"%s - no tab\\n\", line);    /* s has no tab */\n}\n</code></pre>\n\n<p>Or, writing the same termination of line, removing the <code>if...else...</code> and the duplicate <code>printf</code>, you could do the following in a bit more compact, but arguably less readable, code (completely up to you):</p>\n\n<pre><code>    if ((p = strchr (line, ' ')))        /* find first ' ' */\n        *p = 0;                          /* terminate at p */\n\n    printf (\"%s - no tab\\n\", line);      /* s has no tab */\n\n    if (p)                               /* if terminated  */\n        *p = ' ';                        /* restore ' '    */\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/filehandletab &lt;dat/tabfile.txt\nstart - no tab\n        ldb #2 - begins with tab\n        addr A B - begins with tab\n        float - begins with tab\nloop - no tab\n        sta val2 - begins with tab\n        j loop - begins with tab\nval1 - no tab\nval2 - no tab\n</code></pre>\n\n<p>Look things over and let me know if you have any further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "is_accepted": false, "score": 0, "last_activity_date": 1494495162, "last_edit_date": 1494495162, "creation_date": 1494494262, "answer_id": 43911299, "question_id": 43903249, "link": "https://stackoverflow.com/questions/43903249/skipping-specific-lines-and-storing-variables-specific-variables-in-c/43911299#43911299", "title": "Skipping specific lines and storing variables specific variables in C", "body": "<p>Either you read entire lines and parse them, or you read characters to drive a Finite State Machine, like:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\nint ch, state;\n\nfor (state =0; ; ) {\n        ch = getc(stdin) ;\n        if (ch==EOF) break;\n        switch(state) {\n        case 0: /* initial */\n                if (ch == '\\t') {state = 2; continue; }\n                if (ch == '\\n') { continue; }   /* empty line */\n                state = 1;\n                break;        /* break will emit the character */\n        case 1: /* first word on the line */\n                if (ch== ' ') {ch = '\\n'; state =2; break; }\n                if (ch== '\\n') {state =0; break; }\n                break;\n        case 2: /* ignore until EOL */\n                if (ch== '\\n') {state =0; continue; }\n                continue;\n                }\n        putc(ch, stdout);\n        }\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7543281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f5f4812fea12fe5fc4edf694674055?s=128&d=identicon&r=PG&f=1", "display_name": "Chibuikem", "link": "https://stackoverflow.com/users/7543281/chibuikem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 43909227, "answer_count": 3, "score": 1, "last_activity_date": 1494495162, "creation_date": 1494452863, "last_edit_date": 1494480788, "question_id": 43903249, "link": "https://stackoverflow.com/questions/43903249/skipping-specific-lines-and-storing-variables-specific-variables-in-c", "title": "Skipping specific lines and storing variables specific variables in C", "body": "<p>This is a simple question but I just can't seem to figure it out. I need a little help. I have a file called programFile that looks like this:</p>\n\n<pre><code>start mul val1\n&lt;--tab--&gt;ldb #2\n&lt;--tab--&gt;addr A B\n&lt;--tab--&gt;float\nloop lda #1\n&lt;--tab--&gt;sta val2\n&lt;--tab--&gt;j loop\nval1 word 12\nval2 word 0\n</code></pre>\n\n<p>I want to take only the lines that do not start with the tab and do something with them (for now I just want to print the first word in that line), so only the lines <code>start mul val1</code>, <code>loop lda #1</code>, <code>val1 word 12</code> and <code>val2 word 0</code>. The output should be:</p>\n\n<pre><code>start\nloop\nval1\nval2\n</code></pre>\n\n<p>Eventually, I also want to take the lines that start with the tab and do something different with them, but this is my poor attempt at solving it:</p>\n\n<pre><code>while(ch = fgetc(programFile) != EOF){\n    if(ch == '\\t'){\n        while(ch != '\\n'){\n            ch = fgetc(programFile);\n        }\n    }else{\n        fscanf(programFile, \"%s\", symbol);\n        printf(\"%s\\n\", symbol);\n    }\n}\n</code></pre>\n\n<p>And this is my output:</p>\n\n<pre><code>tart\nldb\naddr\nfloat\nloop\nsta\nj\nval1\nval2\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "server", "multiplexing"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494452407, "post_id": 43903106, "comment_id": 74840229, "body": "<code>do { \u2026 } while (FALSE);</code> only works as an infinite loop for eccentric (non-zero) values of <code>FALSE</code>.  Use <code>TRUE</code> instead of <code>FALSE</code>, or <code>1</code>, or \u2026"}, {"owner": {"reputation": 97, "user_id": 7805427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/462317d25b7455e93bbe93b1c2ce3d60?s=128&d=identicon&r=PG&f=1", "display_name": "ezviagintcev", "link": "https://stackoverflow.com/users/7805427/ezviagintcev"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494453050, "post_id": 43903106, "comment_id": 74840495, "body": "Yes, it is used just to get out of error message and see error code (for do not write WSAGetLastError() every time in every error message), it doesn&#39;t touch the logic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494453265, "post_id": 43903106, "comment_id": 74840584, "body": "Oh, I see.  Yes.  Bother!  That means there&#39;s a lot of code to be waded through, and my machines don&#39;t have <code>WSA*</code> functions.  Are you sure this an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)?"}, {"owner": {"reputation": 97, "user_id": 7805427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/462317d25b7455e93bbe93b1c2ce3d60?s=128&d=identicon&r=PG&f=1", "display_name": "ezviagintcev", "link": "https://stackoverflow.com/users/7805427/ezviagintcev"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494453874, "post_id": 43903106, "comment_id": 74840807, "body": "There was a full code, I hope I minimized it enough to understand what&#39;s going on :) Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 7805427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/462317d25b7455e93bbe93b1c2ce3d60?s=128&d=identicon&r=PG&f=1", "display_name": "ezviagintcev", "link": "https://stackoverflow.com/users/7805427/ezviagintcev"}, "is_accepted": true, "score": 0, "last_activity_date": 1494494839, "last_edit_date": 1494494839, "creation_date": 1494493609, "answer_id": 43911082, "question_id": 43903106, "link": "https://stackoverflow.com/questions/43903106/client-server-echo-chat-multiplexing-i-o-threads/43911082#43911082", "title": "Client-server echo-chat (multiplexing I/O + threads)", "body": "<p>Well, I solved it by myself. The condition  </p>\n\n<pre><code>if ((FD_ISSET(listeningSocket, &amp;readSet)) != 0) \n</code></pre>\n\n<p>worked for all while(1) cycle, it should has been finished after accept() function.\nAlso I added these lines in the beginning of while(1) after FD_SET for readSet:</p>\n\n<pre><code>if (newSocketDescriptor)\n{\n    FD_SET(newSocketDescriptor, &amp;readSet);\n}\n</code></pre>\n\n<p>The chat started working but there are a lot of stuffs to work at :)</p>\n"}], "owner": {"reputation": 97, "user_id": 7805427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/462317d25b7455e93bbe93b1c2ce3d60?s=128&d=identicon&r=PG&f=1", "display_name": "ezviagintcev", "link": "https://stackoverflow.com/users/7805427/ezviagintcev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 43911082, "answer_count": 1, "score": 0, "last_activity_date": 1494494839, "creation_date": 1494452118, "last_edit_date": 1494453937, "question_id": 43903106, "link": "https://stackoverflow.com/questions/43903106/client-server-echo-chat-multiplexing-i-o-threads", "title": "Client-server echo-chat (multiplexing I/O + threads)", "body": "<p>I just started learning C language and I'm trying to get deal with Windows Sockets.</p>\n\n<p>The problem is the server can accept and send message only once.\nI used debug mode and saw that work stops in select() from the server part. It seems fine in client (but I'm not sure) and don't see the problem in my code. But I have such a result. What's wrong?</p>\n\n<p>I noticed that my tv.tv_sec isn't defined and I did that just before select, nothing was changed.</p>\n\n<p>And just to be sure: as I need to receive and send message, I don't need write descriptor in accept(), right?</p>\n\n<p>Client uses CreateThread function where I try to send message. Send is in while(1) cycle in main()</p>\n\n<p>Server part:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    /* definitions, WSAStartup(), socket(), bind(), listen() \n    Listening socket is a returned value of listen() function*/\n\n        FD_ZERO(&amp;readSet);\n        FD_ZERO(&amp;writeSet);\n\n        while (1)\n        {\n            // SELECT (LISTENING SOCKET)\n            FD_ZERO(&amp;readSet);\n            FD_SET(listeningSocket, &amp;readSet);\n            tv.tv_sec = 5;\n            printf(\"Listening: Read FD: %d; Write FD : %d;\\n\", FD_ISSET(listeningSocket, &amp;readSet), FD_ISSET(listeningSocket, &amp;writeSet));\n            if ((retVal = select(listeningSocket + 1, &amp;readSet, NULL, NULL, 0)) == SOCKET_ERROR)\n            {\n                printf(\"Select error \");\n                break;\n            }\n            else if (retVal == 0)\n            {\n                printf(\". . .\\n\");\n                continue;\n            }\n            else\n            {\n                // READ SD\n                if ((FD_ISSET(listeningSocket, &amp;readSet)) != SOCKET_ERROR)\n                {\n                    if ((newSocketDescriptor = accept(listeningSocket, (struct sockaddr *)&amp;clientAddr, &amp;clientAddrSize)) == SOCKET_ERROR)\n                    {\n                        printf(\"Accept error \");\n                        break;\n                    }\n                    FD_ZERO(&amp;readSet);\n                    FD_SET(newSocketDescriptor, &amp;readSet);\n\n                    HOSTENT *hst = gethostbyaddr((const char *)&amp;serverAddr.sin_addr.s_addr, 4, AF_INET);\n                    printf(\"Welcome %s (%s:%d) new connected\\n\", hst-&gt;h_name, inet_ntoa(clientAddr.sin_addr), ntohs(clientAddr.sin_port));\n                    printf(\"Read FD: %d; Write FD : %d;\\n\", FD_ISSET(newSocketDescriptor, &amp;readSet), FD_ISSET(newSocketDescriptor, &amp;writeSet));\n\n                    // READ\n                    if (FD_ISSET(newSocketDescriptor, &amp;readSet) != 0)\n                    {\n                        if ((numBytes = recv(newSocketDescriptor, &amp;bufferData[0], sizeof(bufferData), 0)) == SOCKET_ERROR)\n                        {\n                            printf(\"Recv failed \\n\");\n                            freeSocketInformation(newSocketDescriptor);\n                            break;\n                        }\n\n                        bufferData[numBytes] = '\\0';\n                        printf(\"Client -&gt; Server: %s\\n\", &amp;bufferData[0]);\n                    }\n\n                    // WRITE\n                    FD_ZERO(&amp;writeSet);\n                    FD_SET(newSocketDescriptor, &amp;writeSet);\n\n                    printf(\"Read FD: %d; Write FD : %d;\\n\", FD_ISSET(newSocketDescriptor, &amp;readSet), FD_ISSET(newSocketDescriptor, &amp;writeSet));\n                    if (FD_ISSET(newSocketDescriptor, &amp;writeSet) != 0)\n                    {\n                        //fgets(&amp;bufferData[0], sizeof(bufferData), stdin);\n                        if (send(newSocketDescriptor, &amp;bufferData[0], strlen(&amp;bufferData[0]), 0) == SOCKET_ERROR)\n                        {\n                            printf(\"Send error \");\n                            freeSocketInformation(newSocketDescriptor);\n                            break;\n                        }\n                        bufferData[numBytes] = '\\0';\n                        printf(\"Server -&gt; Client: %s\\n\", &amp;bufferData[0]);\n\n                    }\n                    printf(\"Read FD: %d; Write FD : %d;\\n\", FD_ISSET(newSocketDescriptor, &amp;readSet), FD_ISSET(newSocketDescriptor, &amp;writeSet));\n\n                    FD_SET(newSocketDescriptor, &amp;readSet);\n                }\n            }\n        }\n        //FD_CLR(listeningSocket, &amp;readSet);\n        closesocket(newSocketDescriptor);\n    } while (FALSE);\n    printf(\"- Error code: %d\\n\", WSAGetLastError());\n    closesocket(listeningSocket);\n    WSACleanup();\n    return 0;\n}\n</code></pre>\n\n<p>Client part (it uses CreateThread function which is in the end of the code):</p>\n\n<pre><code>/* definitions, socket(), connect()*/\n        if (ioctlsocket(socketDescriptor, FIONBIO, (unsigned long *)&amp;nb) != 0)\n        {\n            printf(\"ioctlsocket error \");\n            break;\n        }\n\n\n            FD_ZERO(&amp;writeSet);\n            FD_SET(socketDescriptor, &amp;writeSet);\n            if ((retVal = select(socketDescriptor + 1, NULL, &amp;writeSet, NULL, &amp;tv)) == SOCKET_ERROR)\n            {\n                printf(\"Send non-blocking error \");\n                break;\n            }\n            else if (retVal == 0)\n            {\n                printf(\"Non-blocking connect time limit is expired\");\n                break;\n            }\n        }\n        printf(\"Connection with %s\\n\", SERVERADDR);\n\n        DWORD thID;\n        printf(\"Socket Desciptor: %d\\n\", socketDescriptor);\n        HANDLE hThread = CreateThread(NULL, NULL, HandleReadThread, (LPVOID)socketDescriptor, NULL, &amp;thID);\n        printf(\"Thread ID: %d\\n\", thID);\n\n        while (1)\n        {\n            // WRITE\n            printf(\"Client -&gt; Server: \");\n            fgets(&amp;bufferData[0], sizeof(bufferData), stdin);\n\n            FD_ZERO(&amp;writeSet);\n            FD_SET(socketDescriptor, &amp;writeSet);\n            tv.tv_sec = 5;\n            if ((retVal = select(socketDescriptor + 1, NULL, &amp;writeSet, NULL, &amp;tv)) == SOCKET_ERROR)\n            {\n                printf(\"Send non-blocking error \");\n                break;\n            }\n            if (FD_ISSET(socketDescriptor, &amp;writeSet) != 0)\n            {\n                if (send(socketDescriptor, bufferData, strlen(&amp;bufferData[0]), 0) == SOCKET_ERROR)\n                {\n                    printf(\"Send error \");\n                    break;\n                }\n            }\n        }\n    } while (FALSE);\n    printf(\"- Error code: %d\\n\", WSAGetLastError());\n    closesocket(socketDescriptor);\n    WSACleanup();\n    return 0;\n}\n\nDWORD WINAPI HandleReadThread(LPVOID serverSocket)\n{\n    SOCKET socketDescriptor;\n    socketDescriptor = (SOCKET)serverSocket;\n    char bufferData[MAXDATASIZE] = { 0 };\n    int retVal;\n    fd_set readSet;\n    timeval tv = { 0 };\n    tv.tv_sec = 5;\n\n    int numBytes;\n    int nclients = 0;\n\n    while (1)\n    {\n        FD_ZERO(&amp;readSet);\n        FD_SET(socketDescriptor, &amp;readSet);\n\n        if ((retVal = select(socketDescriptor + 1, &amp;readSet, NULL, NULL, &amp;tv)) == SOCKET_ERROR)\n        {\n            printf(\"Select error. Error code: %d\", WSAGetLastError());\n            break;\n        }\n        else if (retVal == 0)\n        {\n            //printf(\". . .\\n\");\n            continue;\n        }\n\n        else\n        {\n            //FD_ZERO(socketDescriptor, &amp;readSet);\n            //FD_SET(socketDescriptor, &amp;readSet);\n            // READ\n            if (FD_ISSET(socketDescriptor, &amp;readSet) != 0)\n            {\n                if ((numBytes = recv(socketDescriptor, &amp;bufferData[0], sizeof(bufferData), 0)) == SOCKET_ERROR)\n                {\n                    printf(\"Recv error in Thread. Error code: %d\\n\", WSAGetLastError());\n                    break;\n                }\n                printf(\"\\nSocket Desciptor: %d\\n\", socketDescriptor);\n                bufferData[numBytes] = '\\0';\n                printf(\"Server -&gt; Client: %s\\n\", &amp;bufferData[0]);\n            }\n        }\n    }\n    closesocket(socketDescriptor);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "unistd.h"], "answers": [{"tags": [], "owner": {"reputation": 160387, "user_id": 25646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb7953f53aa7715c72054c3d54e7b48?s=128&d=identicon&r=PG", "display_name": "bbum", "link": "https://stackoverflow.com/users/25646/bbum"}, "is_accepted": false, "score": 1, "last_activity_date": 1494452096, "creation_date": 1494452096, "answer_id": 43903099, "question_id": 43903020, "link": "https://stackoverflow.com/questions/43903020/timer-in-program-is-too-slow/43903099#43903099", "title": "Timer in program is too slow", "body": "<p>You should never rely on an internal accumulator to accumulate elapsed wall time.  Doing so not only captures the time consumed by <code>usleep()</code>, but also the execution time of formatting that string and any other calculations (the string format is likely to the big one).</p>\n\n<p>Instead, get the system time at the start.   Then, whenever you need to sample a new amount of time, get the system time again and subtract the start time from the now time.  That'll give you the elapsed time and then you can adjust from there.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1494452317, "post_id": 43903102, "comment_id": 74840192, "body": "The <code>time()</code> function gives one-second granularity.  For millisecond timing, on POSIX systems, use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_gettime.html\" rel=\"nofollow noreferrer\"><code>clock_gettime()</code></a> or perhaps <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/gettimeofday.html\" rel=\"nofollow noreferrer\"><code>gettimeofday()</code></a> \u2014 the latter is obsolescent, but more widely available (<code>clock_gettime()</code> is available in macOS Sierra, but not earlier versions of Mac OS X, for example)."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494457259, "post_id": 43903102, "comment_id": 74841919, "body": "Thanks, I changed my answer to suggest <code>clock_gettime</code>."}, {"owner": {"reputation": 11, "user_id": 5834374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c76020a6b99fafd818684df5b8af3d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter pitzulo", "link": "https://stackoverflow.com/users/5834374/peter-pitzulo"}, "edited": false, "score": 0, "creation_date": 1494467827, "post_id": 43903102, "comment_id": 74844240, "body": "Thanks a bunch! I will have to use <code>clock_gettime()</code>"}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 2, "last_activity_date": 1494457240, "last_edit_date": 1494457240, "creation_date": 1494452105, "answer_id": 43903102, "question_id": 43903020, "link": "https://stackoverflow.com/questions/43903020/timer-in-program-is-too-slow/43903102#43903102", "title": "Timer in program is too slow", "body": "<p>Your code seems to be written with the assumption that your process can run reliably once every millisecond, but you're probably running it on an operating system that has to perform other tasks, so you won't get to run every millisecond.  Also, usleep might not be as accurate as you are hoping for it to be, and you're not accounting for the time it takes to do your calculations and output data to the terminal.</p>\n\n<p>It's OK to use usleep to conserve CPU time.  But when you want to figure out what time it is for displaying the time to the user, you should use a function that actually gets the time, like the C <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_gettime.html\" rel=\"nofollow noreferrer\">clock_gettime</a> function perhaps.</p>\n"}], "owner": {"reputation": 11, "user_id": 5834374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c76020a6b99fafd818684df5b8af3d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter pitzulo", "link": "https://stackoverflow.com/users/5834374/peter-pitzulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 43903102, "answer_count": 2, "score": 0, "last_activity_date": 1494457240, "creation_date": 1494451683, "question_id": 43903020, "link": "https://stackoverflow.com/questions/43903020/timer-in-program-is-too-slow", "title": "Timer in program is too slow", "body": "<p>Hello i am creating a speedcube timer i just got the time centered but then i noticed that the time on it was too slow, I tried changing the usleep function from 1000 but it was either to fast or to slow, any ideas?</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint main()\n{\n  int minutes = 0, milliseconds = 0, seconds = 0, x = 0, y = 0, text = 6, textminutes = 0, textseconds = 0, textmilliseconds = 0;\n\n  initscr();\n  while(1)\n    {\n      /*This block of code centers the text on the screen by incrementing each variable by one\n    for each number starting at ten, Then prints the time.*/\n      getmaxyx(stdscr,y,x);\n      if (seconds == 60 &amp;&amp; minutes == 10){\n    textminutes += 1;\n      }\n      if  (milliseconds == 1000 &amp;&amp; seconds == 10){\n    textseconds += 0;\n      }\n      if (milliseconds == 10){\n    textmilliseconds += 1;\n      }\n      else if (milliseconds == 100)\n    {\n     textmilliseconds += 1;\n    }\n      else if(milliseconds == 1000)\n       {\n        textmilliseconds += 1;\n       }\n      int left_row = (x / 2) - (3 + textminutes + textseconds + textmilliseconds / 2);\n      mvprintw(y/2, left_row,\"%d : %d : %d\", minutes, seconds, milliseconds);\n\n      /*Sleep for 1 millisecond the increment the milliseconds\n    var i don't think that the timing is right though. \n    Then it refreshes and clears the screen to fetch the new contents.*/\n      usleep(1000);\n      milliseconds++;\n      if(milliseconds == 1000)\n       {\n         milliseconds = 0;\n     textmilliseconds -= 2;\n         seconds++;\n     if(seconds == 60)\n       {\n        seconds = 0;\n        textseconds -= 1;\n        minutes++;\n       }\n       }       \n      refresh();\n      clear();\n      }\n  endwin();\n  return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "exception-handling", "signals", "fork", "control-flow"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494457684, "post_id": 43902880, "comment_id": 74842042, "body": "You should read <a href=\"http://stackoverflow.com/questions/16891019/how-to-avoid-using-printf-in-a-signal-handler/\">How to avoid using <code>printf()</code> in a signal handler?</a>  It probably isn&#39;t immediately critical, but you should at least know which rules you&#39;re breaking before you break them."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494458368, "post_id": 43902880, "comment_id": 74842191, "body": "Yes, it is perfectly possible for the parent process to send the signal to the child before the child gets to print the <code>C</code>.  I&#39;m puzzled that you don&#39;t see two <code>A</code>&#39;s \u2014 and if you see a <code>C</code>, you should see two <code>B</code>&#39;s before it.  In my testing, I only got <code>AsAB7E</code> as the output.  If I add a 1 millisecond <code>usleep()</code> before the <code>kill()</code>, I get <code>AB4E</code> and <code>ABCE</code> as results."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494458949, "post_id": 43902880, "comment_id": 74842337, "body": "In the last results, I had replaced the <code>printf(&quot;E&quot;);</code> with <code>printf(&quot;E\\n&quot;);</code>.  When run with the millisecond delay 100 times, I got each output string 100 times.  Note that if the child gets to print A, B, and C before the parent sends the signal, it will exit with 4 and the parent will pick that exit status up \u2014 that&#39;s what happens with the millisecond delay."}], "owner": {"reputation": 63, "user_id": 7817065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3857f4980e19b45dae3ebf6c2e4071f1?s=128&d=identicon&r=PG&f=1", "display_name": "78t66", "link": "https://stackoverflow.com/users/7817065/78t66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494457555, "creation_date": 1494450957, "last_edit_date": 1494457555, "question_id": 43902880, "link": "https://stackoverflow.com/questions/43902880/how-to-determine-possible-outputs-with-fork-and-signal-handlers", "title": "How to determine possible outputs with fork() and signal handlers", "body": "<p>For the following code, the possible outputs are ABBCE4E, ABs7E, and ABCBs7E. I'm not sure why the first one doesn't have a 7 in it. When it sends the interrupt signal to the child, wouldn't \"s\" and \"7\" be printed? For the second, I don't understand how \"s\" and \"7\" are printed but no \"C\". Does that mean the kill signal reached the child before it could print \"C\"? For the last one, I'm not also not sure why a 4  would be printed in any case.</p>\n\n<pre><code>void handler(int sig){\n    printf(\"s\");\n    exit(7);\n}\n\nint forker(int x){\n    int pid,status;\n    signal(SIGINT, handler);\n    printf(\"A\");\n    if(x &gt; 0) {\n        pid = fork();\n        printf(\"B\");\n        if(pid == 0) {\n            printf(\"C\");\n        } else {\n            kill(pid,SIGINT);\n            waitpid(pid,&amp;status,0);\n            printf(\"%d\", WEXITSTATUS(status));\n          }\n    }\n    printf(\"E\");\n    exit(4);\n}\n</code></pre>\n"}, {"tags": ["c", "string", "newline"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1494449626, "post_id": 43902533, "comment_id": 74838922, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t just describe the code in words, show it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494449628, "post_id": 43902533, "comment_id": 74838925, "body": "Show more code please... How <code>intCAPass</code> is defined and initialized?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1494449743, "post_id": 43902533, "comment_id": 74838994, "body": "Reeks of <code>\\r\\n</code>. Is there any Windows in your area?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1494449755, "post_id": 43902533, "comment_id": 74839001, "body": "File comes from Windows?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1494449768, "post_id": 43902533, "comment_id": 74839008, "body": "Defenestrate it!"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1494449773, "post_id": 43902533, "comment_id": 74839012, "body": "It looks like the <code>\\n</code> is not in the index you think it is."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494451203, "post_id": 43902533, "comment_id": 74839695, "body": "If the source file is supposed to be a <i>text</i> file on Linux, then Windows-style line terminators in it should be considered a malformation.  It&#39;s one that you might very well want or need your program to handle gracefully, but you do also have the alternative of running the file through <code>dos2unix</code> to correct the line termination style."}], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 1527152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/70137d1d63d9196b42844848bcc6f11f?s=128&d=identicon&r=PG", "display_name": "user1527152", "link": "https://stackoverflow.com/users/1527152/user1527152"}, "edited": false, "score": 0, "creation_date": 1494451896, "post_id": 43902624, "comment_id": 74840004, "body": "Yep, fixed. Thank you. I actually thought about it but I thought the files were created under linux. That&#39;s also why I mentioned the OS."}], "tags": [], "owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "is_accepted": true, "score": 5, "last_activity_date": 1494450235, "last_edit_date": 1494450235, "creation_date": 1494449872, "answer_id": 43902624, "question_id": 43902533, "link": "https://stackoverflow.com/questions/43902533/c-deleting-the-newline-at-the-end-of-a-string-acting-weird/43902624#43902624", "title": "C Deleting the newline at the end of a string acting weird", "body": "<pre><code>.he output is: intercapass\n</code></pre>\n\n<p>You have a Windows-style CRLF (<code>\\r\\n</code>) line ending in the input string.\nWhen the final newline <code>\\n</code> is removed, the carriage return <code>\\r</code> is left in the string. When printed, it moves output back to the start of the line. Thus the final dot overwrites the first letter of the output line.</p>\n\n<p>These should show similar behaviour:</p>\n\n<pre><code>printf(\"string one: %s.\\n\", \"blah\\r\\n\");\nprintf(\"string two: %s.\\n\", \"blah\\r\");\n</code></pre>\n\n<p>Check the character before the <code>\\n</code> at the end of the string against a <code>\\r</code>, and remove that one too.</p>\n"}], "owner": {"reputation": 877, "user_id": 1527152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/70137d1d63d9196b42844848bcc6f11f?s=128&d=identicon&r=PG", "display_name": "user1527152", "link": "https://stackoverflow.com/users/1527152/user1527152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43902624, "answer_count": 1, "score": 2, "last_activity_date": 1494450235, "creation_date": 1494449539, "question_id": 43902533, "link": "https://stackoverflow.com/questions/43902533/c-deleting-the-newline-at-the-end-of-a-string-acting-weird", "title": "C Deleting the newline at the end of a string acting weird", "body": "<p>So I have the following code:</p>\n\n<pre><code>printf(\"the output is: %s.\\n\", intCAPass);\n</code></pre>\n\n<p>Which prints the following:</p>\n\n<pre><code>the output is: intercapass\n.\n</code></pre>\n\n<p>So I tried the two following options to get rid of the newline at the end of the string <code>intCAPass</code>:</p>\n\n<pre><code>intCAPass[strlen(intCAPass)- 1] = '\\0';\nstrtok(intCAPass,\"\\n\");\n</code></pre>\n\n<p>but both give me the following output:</p>\n\n<pre><code>.he output is: intercapass\n</code></pre>\n\n<p>So I'm wondering whats going on here.</p>\n\n<p>More info:</p>\n\n<p>OS: Linux</p>\n\n<p>The variable <code>intCAPass</code> receive the string from a function that reads a file containing <code>interca\\n</code>. So, I use a buffer in which I copy the whole file and at the end I do <code>buffer[len] = '\\0';</code> and at some point I thought it could cause some problems but I don't think so.</p>\n"}, {"tags": ["c", "string", "stringification"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1494448783, "post_id": 43902320, "comment_id": 74838501, "body": "The process you&#39;re describing is normally called &quot;escaping&quot;  , and there&#39;s no built-in escaping function in C (nor in the preprocessor).  &quot;stringify&quot; means to change <code>X</code> into <code>&quot;X&quot;</code>, where <code>X</code> is a pre-processing token (not an arbitrary sequence of bytes)"}, {"owner": {"reputation": 10834, "user_id": 3156085, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b749799809f0e3d93d851d639afdbab9?s=128&d=identicon&r=PG&f=1", "display_name": "vmonteco", "link": "https://stackoverflow.com/users/3156085/vmonteco"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1494449274, "post_id": 43902320, "comment_id": 74838749, "body": "@M.M Actually, the <code>gcc</code> documentation&#39;s refers to the <code>#</code> use in preprocessor directives as &quot;stringizing&quot; (perhaps both words are used?), but thank you for making it clear that there is no such thing in C standard library. :)  <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Stringizing.html#Stringizing\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/cpp/Stringizing.html#Stringizing</a>"}, {"owner": {"reputation": 10834, "user_id": 3156085, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b749799809f0e3d93d851d639afdbab9?s=128&d=identicon&r=PG&f=1", "display_name": "vmonteco", "link": "https://stackoverflow.com/users/3156085/vmonteco"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1494449632, "post_id": 43902320, "comment_id": 74838930, "body": "@AppWriter Done, thank you for the suggestion!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1494451395, "post_id": 43902320, "comment_id": 74839792, "body": "yes, the <code>#</code> operator is for stringizing as I described in my comment (not escaping)"}], "answers": [{"comments": [{"owner": {"reputation": 10834, "user_id": 3156085, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b749799809f0e3d93d851d639afdbab9?s=128&d=identicon&r=PG&f=1", "display_name": "vmonteco", "link": "https://stackoverflow.com/users/3156085/vmonteco"}, "edited": false, "score": 2, "creation_date": 1494449312, "post_id": 43902361, "comment_id": 74838770, "body": "That&#39;s all I needed to know. :) Thank you for this answer and for the link."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1494448826, "last_edit_date": 1495540026, "creation_date": 1494448826, "answer_id": 43902361, "question_id": 43902320, "link": "https://stackoverflow.com/questions/43902320/escaping-a-char-in-c/43902361#43902361", "title": "Escaping a char * in C", "body": "<p>Escaping special characters is not provided in any standard <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> function.</p>\n\n<hr>\n\n<p>For GPL, you can take a look in <a href=\"https://stackoverflow.com/questions/2725385/standard-c-library-for-escaping-a-string\">standard c library for escaping a string</a>.</p>\n"}], "owner": {"reputation": 10834, "user_id": 3156085, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b749799809f0e3d93d851d639afdbab9?s=128&d=identicon&r=PG&f=1", "display_name": "vmonteco", "link": "https://stackoverflow.com/users/3156085/vmonteco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 43902361, "answer_count": 1, "score": 2, "last_activity_date": 1494449615, "creation_date": 1494448696, "last_edit_date": 1494449615, "question_id": 43902320, "link": "https://stackoverflow.com/questions/43902320/escaping-a-char-in-c", "title": "Escaping a char * in C", "body": "<p>I had to made something for a little programm some days ago, I needed to turn a string like <code>\"foo\\n\"</code> into its stringified form (something like <code>\"\\\"foo\\\\n\\\"\"</code>).</p>\n\n<p>But I found nothing, so I ended up writing my own function (and it worked fine). But I'm still wondering : Is there a function to stringify strings like this?</p>\n\n<p>I know the python equivalent <code>\"%r\" % strtostringify</code>, and I know that I can strinfifying pieces of code at compiling with preprocessor directives :</p>\n\n<pre><code>#define TOSTRING(X) #X\n#define STRINGIFY(X) TOSTRING(X)\n</code></pre>\n\n<p>but is there a way to make it dynamically in <code>C</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1494448479, "post_id": 43902195, "comment_id": 74838336, "body": "Standard common error. <code>array[i] = fgets(buff, 255, (FILE*)fp);</code>. That stores <code>buff</code> which is then returned to the caller. But <code>buff</code> is a local variable and is not valid after the function returns. In fact, <code>buff</code> is scoped only to the <code>for</code> loop and is invalid as soon as that loop completes."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1494449473, "post_id": 43902195, "comment_id": 74838858, "body": "To add to the previous comment - think about <code>array</code> as an array of strings. You only allocated memory for this array&#39;s elements (which are just addresses, each is an address of a string). Now you have to allocate (using <code>malloc</code> if you want to use them outside of this function) a memory for each of these strings too."}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1494451341, "post_id": 43902195, "comment_id": 74839767, "body": "A tip is to use <code>gdb</code> and <code>valgrind</code> to detect bugs"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494451376, "post_id": 43902195, "comment_id": 74839778, "body": "BTW, you should probably avoid defining your own functions with the same names as POSIX and C standard functions like <code>read()</code>."}], "owner": {"reputation": 241, "user_id": 7993952, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/BzDdP.png?s=128&g=1", "display_name": "Dan Hessler", "link": "https://stackoverflow.com/users/7993952/dan-hessler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494448182, "creation_date": 1494448182, "question_id": 43902195, "link": "https://stackoverflow.com/questions/43902195/c-char-not-printing-correctly-after-being-returned-from-function", "title": "C - char** not printing correctly after being returned from function", "body": "<p>I am trying to return a char** from a function to main so I can do stuff with it, but when I print it out it gives me random characters. I'm at a loss.</p>\n\n<p>main VV</p>\n\n<pre><code>// ./main &lt; data/filelist.txt\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"hist.h\"\n\nint main(){\n\n    int count = 0;\n    int i;\n    char** files = read(&amp;count);\n    displayList(files, count);\n\n    char** array = splitFiles(files, count);\n        printf(\"IN MAIN: array[0] - %s\\n\", array[0]);       \n        Histogram* p; \n        printf(\"here\\n\");\n        int histArrayCount = calcHistogram(&amp;array[0], &amp;count, &amp;p);\n        printf(\"here\\n\");\n        displayHistogram(p, histArrayCount);\n        printf(\"here\\n\");\n}\n</code></pre>\n\n<p>hist.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"hist.h\"\n\nint calcHistogram (char** a, int* count, Histogram** q) {\n\n    int i, k;\n    int j = 0;\n    int histArrayCount = 0;\n\n    Histogram* p = (Histogram*)malloc((*count) * sizeof(Histogram));\n    for (k = 0; k &lt; *count; k++) {\n        p[k].num =  \"1\";\n        p[k].freq = 0;\n    }\n\n    for (i = 0; i &lt;= *count; i++) {\n        while ((strcmp(p[j].num, \"1\") != 0) &amp;&amp; (strcmp(p[j].num, a[i]) != 0)) {\n            j++;\n        }\n        if (strcmp(p[j].num, \"1\") == 0) {\n            p[j].num = a[i];\n            p[j].freq = 1;\n            histArrayCount++;\n        }\n        else if ((strcmp(p[j].num, a[i]) == 0)) {\n            p[j].freq += 1;\n        }\n        else {\n            printf(\"ERROR\\n\");\n        }\n        j = 0;\n    }\n\n    *q = p;\n\n    return histArrayCount;\n}\n\nvoid displayHistogram (Histogram* p, int histArrayCount) {\n    int i;\n    for (i = 0; i &lt; histArrayCount - 1; i++) {\n        printf(\"value %s: freq %d\\n\", p[i].num, p[i].freq);\n    }\n    printf(\"\\n\");\n}\n\nchar** splitFiles(char** files, int count) {\n        int i;\n        char** array = (char**)malloc((count)*sizeof(char*)); \n        FILE* fp;\n        int c = 0;\n        for(i = 0; i &lt; count; i++) {\n                char buff[255];\n                fp =  fopen(files[i], \"r\");\n\n                array[i] = fgets(buff, 255, (FILE*)fp);\n                printf(\"%d : %s\\n\", i, buff);\n        }\n\n        printf(\"array[0] = %s\\n\", array[0]);\n        return array;\n}\n\nvoid displayList(char** a, int c) { \n    int i;\n    for (i = 0; i &lt; c; i++) {\n        printf(\"File %d: %s\\n\", i, a[i]);\n    }\n    printf(\"\\n\");\n}\n\n\nchar** read(int* c){\n    int count = 0;\n    int i;\n\n    char** a = (char**)malloc(100*sizeof(char*));\n\n    for (i = 0; i&lt; 100; i++) {\n        a[count] = (char*)malloc(100*sizeof(char));\n        count++;\n    }\n\n    count = 0;\n\n    int endOfFile = scanf(\"%s\", a[count]);\n\n    while (endOfFile != EOF) {\n            count++;\n            endOfFile = scanf(\"%s\", a[count]);\n    }\n\n    *c = count;\n    return a;\n}\n</code></pre>\n\n<p>When I print the array at index 0 in here it gives me what is actually there, but when I do the same thing in main it does not. It gives me three random characters.</p>\n\n<p>hist.h</p>\n\n<pre><code>typedef struct Histogram {\n    char* num;\n    int freq;\n} Histogram;\n\nchar** read(int* c);\nvoid displayList(char** a, int c);\nint calcHistogram (char** a, int* c, Histogram** p);\nvoid displayHistogram (Histogram* a, int histArrayCount);\nchar** splitFiles (char** files, int count);\n</code></pre>\n"}, {"tags": ["c", "arduino", "arm", "embedded"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494447957, "post_id": 43902092, "comment_id": 74838074, "body": "What exactly is not working?"}, {"owner": {"reputation": 76, "user_id": 6776262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Xtf1nVNHJq4/AAAAAAAAAAI/AAAAAAAAAFE/t7i3QcnAbzA/photo.jpg?sz=128", "display_name": "quackenator", "link": "https://stackoverflow.com/users/6776262/quackenator"}, "edited": false, "score": 1, "creation_date": 1494447967, "post_id": 43902092, "comment_id": 74838080, "body": "have you tried <code>&#39;\\r&#39;</code> and <code>&#39;\\n&#39;</code>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1494452992, "post_id": 43902092, "comment_id": 74840462, "body": "Your string is &quot;ALERT&quot; but the display shows &quot;TEMPERATURE&quot; - it would be far better to post the code that relates to the result image.  Is the output means outputting exactly 7 characters or does it rely on nul termination - which you do not have?"}, {"owner": {"reputation": 2597, "user_id": 4755321, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e93c2832d8928731e8e5d2f6d665c4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek \u015alimok", "link": "https://stackoverflow.com/users/4755321/jacek-%c5%9alimok"}, "edited": false, "score": 3, "creation_date": 1494491054, "post_id": 43902092, "comment_id": 74853575, "body": "Is this the data you send to the display directly? What kind of display is it? It may be that controlling cursor position (what you&#39;re trying to achieve with &#39;\\r&#39; and &#39;\\n&#39;) isn&#39;t actually done by sending such character codes to it, but rather by sending totally separate commands, such as &quot;set cursor position X, Y&quot;. If that is the case, the display may have some other characters in its character map under 0x0D and 0x0A, which would explain you seeing something you don&#39;t expect."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1494541942, "post_id": 43902092, "comment_id": 74886437, "body": "@Clifford Code is here: github.com/aliyah3/IoT/blob/master/Temperature_controller.c"}], "answers": [{"comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1494448034, "post_id": 43902128, "comment_id": 74838117, "body": "@EugeneSh. I&#39;m sure. It seems like he wasn&#39;t null terminating the string, also it might not have been large enough"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1494448081, "post_id": 43902128, "comment_id": 74838142, "body": "Yeah, that&#39;s another problem how it is used. I would do <code>ALERT[]=&quot;ALERT\\n\\r&quot;</code>;"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1494448179, "post_id": 43902128, "comment_id": 74838196, "body": "if \\r and \\n give you something other than 10 and 13 then something is broken they should be interchangeable, if not use 10 and 13..."}, {"owner": {"reputation": 76, "user_id": 6776262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Xtf1nVNHJq4/AAAAAAAAAAI/AAAAAAAAAFE/t7i3QcnAbzA/photo.jpg?sz=128", "display_name": "quackenator", "link": "https://stackoverflow.com/users/6776262/quackenator"}, "edited": false, "score": 1, "creation_date": 1494448265, "post_id": 43902128, "comment_id": 74838231, "body": "If they&#39;re interchangeable, why obfuscate the meaning with numerical values?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494448487, "post_id": 43902128, "comment_id": 74838339, "body": "It looks weird to me that this answer is downvoted but not the other one... (not that I call for downvoting the other one :) )"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494448497, "post_id": 43902128, "comment_id": 74838343, "body": "They are <i>not</i> interchangeable, and <code>\\r</code> and <code>\\n</code> are <i>not</i> guaranteed to be equivalent to 10 and 13.  Paragraph 5.2.2/3 of the standard says: &quot;Each of these escape sequences shall produce a unique <b><i>implementation-defined</i></b> value which can be stored in a single char object. The external representations in a text file need not be identical to the internal representations, and are outside the scope of this International Standard&quot; (emphasis added).  In practice, the source or execution character set (which are not guaranteed ASCII-compatible) might factor in."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494448630, "post_id": 43902128, "comment_id": 74838423, "body": "@JohnBollinger Moreover, not only the runtime character set, but the control codes on the serial terminal that is probably used here since it is Arduino."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "edited": false, "score": 1, "creation_date": 1494448978, "post_id": 43902128, "comment_id": 74838596, "body": "Its TM4C123G Microcontroller, I tried: unsigned char TEMP[]={&#39;T&#39;,&#39;E&#39;,&#39;M&#39;,&#39;P&#39;,&#39;E&#39;,&#39;R&#39;,&#39;A&#39;,&#39;T&#39;,&#39;U&#39;,&#39;R&#39;,&#39;E&#39;,&#39;\\r&#39;,&#39;\\n&zwnj;&#8203;&#39;,&#39;\\0&#39;};  unsigned char ALERT[]={&#39;A&#39;,&#39;L&#39;,&#39;E&#39;,&#39;R&#39;,&#39;T&#39;,&#39;\\r&#39;,&#39;\\n&#39;,&#39;\\0&#39;};   and just the first line is displayed. Just the &quot;TEMPERATURE&quot;"}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494449223, "post_id": 43902128, "comment_id": 74838720, "body": "@EugeneSh. I tried TEMP[]=&quot;TEMPERATURE/n/r&quot;; ALERT[]=&quot;ALERT\\n\\r&quot; but just the first line, &quot;TEMPERATURE&quot; was displayed."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494449534, "post_id": 43902128, "comment_id": 74838885, "body": "@EugeneSh.   Everything is here: <a href=\"https://github.com/aliyah3/IoT/blob/master/Temperature_controller.c\" rel=\"nofollow noreferrer\">github.com/aliyah3/IoT/blob/master/Temperature_controller.c</a>  thanks a bunch"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494449704, "post_id": 43902128, "comment_id": 74838966, "body": "It could be very well the case your LCD is not recognizing these characters. It is very likely since LCDs are often have special commands to move the cursor."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494450258, "post_id": 43902128, "comment_id": 74839248, "body": "@EugeneSh. Ok, good point. I will look for characters for Nokia5110 LCD. Thank a lot. I really appreciate it. I will update this question if I find it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494450830, "post_id": 43902128, "comment_id": 74839523, "body": "Take a look at the sample code: <a href=\"http://playground.arduino.cc/Code/PCD8544\" rel=\"nofollow noreferrer\">playground.arduino.cc/Code/PCD8544</a> Looks like the subset of ascii from 0x20 to 0x7F is supported (with an offset of <code>0x20</code>, so your <code>10</code> will become <code>10-0x20</code> which is pretty bad)."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "edited": false, "score": 0, "creation_date": 1494451001, "post_id": 43902128, "comment_id": 74839603, "body": "The important lesson here is not to buy $2 LCD from China.:)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "edited": false, "score": 1, "creation_date": 1494451120, "post_id": 43902128, "comment_id": 74839660, "body": "@AliyarAttaran Well, the LCD is fine. It is well documented as well. So that&#39;s a wrong lesson :) As I said, most of LCDs are working similarly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494453584, "post_id": 43902128, "comment_id": 74840702, "body": "@JohnBollinger I have never come across a system where &quot;<code>\\r</code> and <code>\\n</code> are 10 and 13&quot; <i>respectively</i>.  13 and 10, sure.  ;-)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494453949, "post_id": 43902128, "comment_id": 74840820, "body": "Ah, @chux, but my point is that they <i>could</i> be 10 and 13, respectively :).  But for a more serious example, one might very well find <code>\\n</code> to have the one of the values 21 or 37 (decimal) on a machine that is natively EBCDIC-based."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "edited": false, "score": 1, "creation_date": 1494454160, "post_id": 43902128, "comment_id": 74840895, "body": "@AliyarAttaran : For an LCD module to translate ASCII control codes to cursor position would require it to have intelligence  - i.e. a microcontroller or some quite complex logic, making it unnecessarily expensive since your microcontroller already has that capability and code can send the necessary control signals or addressing.  You can set the line/column and it can use a look-up ROM to index glyph bitmaps with a character code and render them - what more would you need or expect?  It is a simple display, not a complete display termina.l"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494456586, "post_id": 43902128, "comment_id": 74841726, "body": "@JohnBollinger If code needs to use <code>10</code> for <code>&#39;\\n</code> to match the targets ASCII, then the letters in <code>{&#39;A&#39;,&#39;L&#39;,&#39;E&#39;,&#39;R&#39;,&#39;T&#39;,...};</code> is likely problematic too.  Given that OP did not mention any letter issue, the code and the LCD are certainly using a consistent character encoding.  I suspect the control codes sent to the LCD are not interpreted by it as <i>control characters</i>.   IAC, OP&#39;s post is scant on needed information."}, {"owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494542166, "post_id": 43902128, "comment_id": 74886504, "body": "@EugeneSh. If the LCD is fine, it should recognize these special characters, right?"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1494448002, "last_edit_date": 1494448002, "creation_date": 1494447951, "answer_id": 43902128, "question_id": 43902092, "link": "https://stackoverflow.com/questions/43902092/ascii-code-for-carriage-return-and-line-feed-in-c/43902128#43902128", "title": "ASCII code for carriage return and line feed in C", "body": "<p>Try <code>unsigned char ALERT[]={'A','L','E','R','T','\\r','\\n','\\0'};</code></p>\n"}], "owner": {"reputation": 41, "user_id": 6179539, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-yRQMmiuJpqA/AAAAAAAAAAI/AAAAAAAAAts/zfRz9RhXlxk/photo.jpg?sz=128", "display_name": "Aliyar Attaran", "link": "https://stackoverflow.com/users/6179539/aliyar-attaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3535, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494542637, "creation_date": 1494447855, "last_edit_date": 1494542637, "question_id": 43902092, "link": "https://stackoverflow.com/questions/43902092/ascii-code-for-carriage-return-and-line-feed-in-c", "title": "ASCII code for carriage return and line feed in C", "body": "<p>For ASCII code for carriage return and line feed, I used, 10 and 13 but they don't work properly. two characters after each word are printed like weird symbols. for example, like: `unsigned char ALERT[7]={'A','L','E','R','T',13,10}; \nCode is here: github.com/aliyah3/IoT/blob/master/Temperature_controller.c</p>\n\n<p>Could anyone give me suggestion on fixing it. </p>\n\n<p><a href=\"https://i.stack.imgur.com/7NNqP.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "string", "concat", "strcat"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494447464, "post_id": 43901967, "comment_id": 74837838, "body": "Is there a problem with your code?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1494447487, "post_id": 43901967, "comment_id": 74837848, "body": "maybe <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a> would be a better place for that question."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1494447646, "post_id": 43901967, "comment_id": 74837924, "body": "<code>va_arg(current,int)</code> ? Not <code>char *</code>?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1494447670, "post_id": 43901967, "comment_id": 74837944, "body": "@dxramax  Why is there used the type int in current = va_arg(args, int)?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1494448145, "post_id": 43901967, "comment_id": 74838172, "body": "<code>strcat_ex</code> is a <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.31.13\" rel=\"nofollow noreferrer\">bad name choice</a>. Better <code>dxramax_strcat</code>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1494448156, "post_id": 43901967, "comment_id": 74838178, "body": "Have you looked at <code>asprintf</code>? It&#39;s not the same, obviously, since it needs an explicit format, but it is often even more useful as a result."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1494448357, "post_id": 43901967, "comment_id": 74838275, "body": "By the way, you seem to be assuming that <code>va_arg</code> will automatically restart the argument scan (it won&#39;t), or you didn&#39;t paste the code where you make a copy of the <code>va_list</code>."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 3, "creation_date": 1494448412, "post_id": 43901967, "comment_id": 74838309, "body": "I&#39;m voting to close this question as off-topic because it belongs to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494448888, "post_id": 43901967, "comment_id": 74838557, "body": "You appear to have forgotten to include the first string (<code>str</code>) in your length computation and your concatenated output."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1494448997, "post_id": 43901967, "comment_id": 74838603, "body": "@rici, do not overlook that <code>asprintf()</code> is a GNU-specific extension, so not necessarily a viable approach."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494449779, "post_id": 43901967, "comment_id": 74839016, "body": "@JohnBollinger: It&#39;s an extension, to be sure, and it was first included in the Gnu libc, but it is also available on *BSD for quite some time, so I don&#39;t think &quot;Gnu-specific&quot; is a bit of an overstatement (<a href=\"http://www.manpages.info/macosx/asprintf.3.html#sect9\" rel=\"nofollow noreferrer\">manpages.info/macosx/asprintf.3.html#sect9</a>). See <a href=\"http://stackoverflow.com/questions/30685109/does-c-have-any-tools-for-doing-string-addition/30687023\">here</a> for a shim."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6378892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-khRGcl4VBxc/AAAAAAAAAAI/AAAAAAAAAAA/6pu7xncI-gM/photo.jpg?sz=128", "display_name": "dxramax", "link": "https://stackoverflow.com/users/6378892/dxramax"}, "edited": false, "score": 1, "creation_date": 1494452045, "post_id": 43902811, "comment_id": 74840080, "body": "NULL  is required to be the last parameter, clever way to know the last argument without providing the number of arguments, thanks."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1494453453, "post_id": 43902811, "comment_id": 74840662, "body": "Code is much, much simpler to read if you check for an error and deal with it immediately (ie. <a href=\"https://en.wikipedia.org/wiki/Structured_programming#Early_exit\" rel=\"nofollow noreferrer\">early exit</a>) rather than checking for no error and nesting ever deeper."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1494455430, "post_id": 43902811, "comment_id": 74841378, "body": "@Schwern I can not agree with you relative to this function implementation."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1494457104, "post_id": 43902811, "comment_id": 74841874, "body": "@VladfromMoscow Any particular reason? <a href=\"https://gist.github.com/schwern/ccaa8d4d2868a520592e49dabc5d310d\" rel=\"nofollow noreferrer\">I rewrote it to demonstrate how much simpler it is</a>. The code reads linearly, it has no branches of consequence. With the error check and handling together, its very easy to tell what happens on error and what gets returned."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1494457487, "post_id": 43902811, "comment_id": 74841982, "body": "@Schwern The more exits the more you have to check that all clean up  operations are made before each exit. It is like using goto statements. Such a code is difficult to modify because you need to be sure that the modifications do not break the clean up operations."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1494457918, "post_id": 43902811, "comment_id": 74842084, "body": "@VladfromMoscow Yeah, that&#39;s <a href=\"https://en.wikipedia.org/wiki/Structured_programming\" rel=\"nofollow noreferrer\">structured programming</a> talking. Having too many returns is a problem, but blindly adhering to a single return can also complicate the rest of the code. &quot;Early exit&quot; for errors and argument checks is a common exception to &quot;single return&quot;. In this case there&#39;s no cleanup, so there&#39;s no point in adhering to a single return. As for maintenance, understanding nested, single return code is more difficult, its hard to tell nesting resulting from the single return policy from nesting due to code logic."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1494458615, "post_id": 43902811, "comment_id": 74842254, "body": "@Schwern I could agree with you when there were many multiline checks at the beginning of the program. But it is not the case. The function does something if the parameter is not equal to NULL and this approach if ( s != NULL ) do the job; is clear enough."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1494451909, "last_edit_date": 1494451909, "creation_date": 1494450639, "answer_id": 43902811, "question_id": 43901967, "link": "https://stackoverflow.com/questions/43901967/strcat-for-unlimited-string-in-c/43902811#43902811", "title": "strcat for unlimited string in c", "body": "<p>Before this loop</p>\n\n<pre><code>size_t cur = 0;\nfor(; current; current = va_arg(args, char *)) {\n    size_t cur_len = strlen(current);\n    memcpy_s(res + cur, cur_len, current, cur_len);\n}\n</code></pre>\n\n<p>you have to reinitialize <code>args</code> using the macro <code>va_start</code>.</p>\n\n<p>The variable <code>cur</code> is not being changed in the loop and always equal to 0.  So all strings are copied at the same address <code>res + 0</code>. </p>\n\n<p>Before each exit from the program you have to invoke the macro <code>va_end</code>.</p>\n\n<p>The function can look as it is shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;string.h&gt;\n\nchar * strcat_ex( const char *s, ... )\n{\n    char *result = NULL;\n\n    if ( s != NULL )\n    {\n        va_list ap;\n\n        size_t n = 0;\n\n        va_start( ap, s );\n\n        for ( const char *p = s; p != NULL; p = va_arg( ap, const char * ) )\n        {\n            n += strlen( p );\n        }\n\n        va_end( ap );\n\n        ++n;\n\n        result = ( char * )malloc( n );\n\n        if ( result != NULL )\n        {\n            n = 0;\n\n            va_start( ap, s );\n\n            for ( const char *p = s; p != NULL; p = va_arg( ap, const char * ) )\n            {\n                strcpy( result + n, p );\n                n += strlen( p );\n            }\n\n            va_end( ap );\n        }\n    }\n\n    return result;\n}\n\nint main(void) \n{\n    char *s;\n\n    s = strcat_ex( \"1\", \"2\", \"3\", \"4\", \"5\", NULL );\n\n    puts( s );\n\n    free( s );\n\n    s = strcat_ex( \"Hello\", \" \", \"World!\", NULL );\n\n    puts( s );\n\n    free( s );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>12345\nHello World!\n</code></pre>\n\n<p>You can add a check that the total length of all the strings is not greater than the maximum value that can be stored in an object of the type <code>size_t</code>. That is that there is np overflow.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 6378892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-khRGcl4VBxc/AAAAAAAAAAI/AAAAAAAAAAA/6pu7xncI-gM/photo.jpg?sz=128", "display_name": "dxramax", "link": "https://stackoverflow.com/users/6378892/dxramax"}, "edited": false, "score": 0, "creation_date": 1494484525, "post_id": 43903299, "comment_id": 74849409, "body": "` size_t str_sizes[num_args]; ` =&gt; expression must have a constant value, I think only a dynamic allocation is feasible here."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1494453611, "last_edit_date": 1494453611, "creation_date": 1494453156, "answer_id": 43903299, "question_id": 43901967, "link": "https://stackoverflow.com/questions/43901967/strcat-for-unlimited-string-in-c/43903299#43903299", "title": "strcat for unlimited string in c", "body": "<p>First, some general commentary.</p>\n\n<pre><code>if(!str)return 0;\n</code></pre>\n\n<p>While the constant <code>0</code> is guaranteed to be equivalent to the null pointer, I don't believe checking a pointer if it's false is. This probably isn't a problem for the common environments, but it's a bad habit to poke the C compatibility dragons <em>especially</em> if you're coming from a Windows background where it will be very tempting to get addicted to Microsoft extensions, and <em>especially</em> if you don't have an encyclopedic knowledge of the C standard. Don't poke the edge cases. If you mean null, use <code>NULL</code>.</p>\n\n<p>Speaking of Microsoft extensions, <a href=\"https://msdn.microsoft.com/en-us/library/wes2t00f.aspx\" rel=\"nofollow noreferrer\"><code>memcpy_s</code></a> is a non-standard Microsoft extension. Either use <code>memcpy</code> or provide a compatibility wrapper.</p>\n\n<p><code>va_arg</code> has to be reinitialized on each use, it will not restart on its own. Think of <code>va_start</code> and <code>va_end</code> like braces around the use of <code>va_args</code>. The basic pattern is this:</p>\n\n<pre><code>va_start(args, first);\nfor(\n    current = first;\n    current != NULL;\n    current = va_arg(args, char *)\n) {\n    ...\n}\nva_end(args);\n</code></pre>\n\n<p>You can't tell how many variable arguments there are, <code>va_arg</code> will keep reading whatever garbage is on the stack. You either have to pass in the number of arguments, which is error prone, or use a sentinel value like making the last argument NULL.</p>\n\n<p>I would consider calling it something other than <code>strcat*</code> because it has a different interface. Using it like <code>strcat</code> invites a hard to debug error. <code>strcat</code> has the form <code>strcat( dest, src )</code> whereas your function is <code>dest = strcat_ex( src, src, ... )</code>. It will be very tempting for someone to write <code>strcat_ex( dest, src, src, ... )</code>.</p>\n\n<p>The name which comes to mind is <code>strjoin</code>. <code>join</code> functions in other languages include the ability to supply a delimiter. This suggests a useful feature you could add to the function, you'll often want to join strings with a delimiter like <code>\", \"</code> or <code>\" \"</code>, that would be the first argument.</p>\n\n<hr>\n\n<p>To avoid having to read all the strings twice, you can take advantage that the number of arguments will be quite small. The number of arguments are constrained by the size of the stack and the sanity of the programmer. So it's cheaper to go through the small number of arguments multiple times than it is to call <code>strlen</code> on the strings multiple times.</p>\n\n<p>You need three loops through the arguments.</p>\n\n<ol>\n<li>Figure out how many arguments there are.\n\n<ul>\n<li>Allocate an array to hold their lengths.</li>\n</ul></li>\n<li>Store the string lengths and their total length.\n\n<ul>\n<li>Allocate the destination.</li>\n</ul></li>\n<li>Copy the strings.</li>\n</ol>\n\n\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\nchar* strjoin(const char* first, ...) {\n    if( first == NULL ) {\n        return NULL;\n    }\n\n    va_list args;\n    int i;\n    const char *current;\n\n    // 1. Figure out how many arguments there are.\n    va_start(args, first);\n    size_t num_args = 0;\n    for(\n        current = first;\n        current != NULL;\n        current = va_arg(args, char *)\n    ) {\n        num_args++;\n    }\n    va_end(args);\n\n    //   * Allocate an array to hold their lengths.\n    size_t str_sizes[num_args];\n\n    // 2. Store the string lengths and their total length.\n    size_t dest_size = 0;\n    va_start(args, first);\n    for(\n        i = 0, current = first;\n        current != NULL;\n        i++, current = va_arg(args, char *)\n    ) {\n        str_sizes[i] = strlen(current);\n        dest_size += str_sizes[i];\n    }\n    va_end(args);\n\n    //     * Allocate the destination.\n    char *dest = malloc(dest_size + 1);\n    if( dest == NULL ) {\n        return NULL;\n    }\n\n    // 3. Copy the strings.\n    char *dest_pos = dest;\n    va_start(args, first);\n    for(\n        i = 0, current = first;\n        current != NULL;\n        i++, current = va_arg(args, char *)\n    ) {\n        memcpy( dest_pos, current, str_sizes[i] );\n        dest_pos += str_sizes[i];\n    }\n    va_end(args);\n\n    // Add the final null byte\n    dest_pos[0] = '\\0';\n\n    return dest;\n}\n\nint main() {\n    char *all = strjoin( \"foo\", \"bar\", \"baz\", \"biff\", \"wibble\", NULL );\n    puts(all);\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6378892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-khRGcl4VBxc/AAAAAAAAAAI/AAAAAAAAAAA/6pu7xncI-gM/photo.jpg?sz=128", "display_name": "dxramax", "link": "https://stackoverflow.com/users/6378892/dxramax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "closed_date": 1494484059, "accepted_answer_id": 43903299, "answer_count": 2, "score": 1, "last_activity_date": 1494453611, "creation_date": 1494447371, "last_edit_date": 1494447935, "question_id": 43901967, "link": "https://stackoverflow.com/questions/43901967/strcat-for-unlimited-string-in-c", "closed_reason": "Not suitable for this site", "title": "strcat for unlimited string in c", "body": "<hr>\n\n<p>I want to implement strcat in c but for unlimited string, the function will allocate the necessary memory required for the final string, I came up with this :</p>\n\n<pre><code>char* strcat_ex(const char* str, ...) {\n    if(!str)return 0;\n\n    const char* current = str;\n    char* res = 0;\n    va_list args;\n    va_start(args, str);\n\n    // calculate the length of the final string\n    size_t len = 0;\n    for(; current; current = va_arg(args, char *))\n        len += strlen(current);\n\n    // allocate the string\n    res = malloc(sizeof(char) * len + 1);\n    if(!res)return 0;\n\n    // copy the strings to the final destination\n    size_t cur = 0;\n    for(; current; current = va_arg(args, char *)) {\n        size_t cur_len = strlen(current);\n        memcpy_s(res + cur, cur_len, current, cur_len);\n    }\n\n    va_end(args);\n    return res;\n}\n</code></pre>\n\n<ul>\n<li>Is there any standard function already implemented.</li>\n<li><p>If not how can I improve this code, for example :</p>\n\n<p>1-I am calculating the length of the strings twice, how can I calculate them only once.</p>\n\n<p>2-Is there any security issues.</p>\n\n<p>3-Other suggestion to improve the code.</p></li>\n</ul>\n"}, {"tags": ["java", "c", "eclipse", "maven", "jenkins"], "comments": [{"owner": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 1, "creation_date": 1494446764, "post_id": 43901775, "comment_id": 74837498, "body": "What type of build are you doing, and what build step?  My first guess is you&#39;re using a script type that doesn&#39;t like having mixed slashes in your path to java. <code>C:\\Program Files\\Java\\jdk1.8.0_73&#47;bin&#47;java</code>  You start with backslashes and switch to forward slashes, probably because part of that path is defined by a variable."}, {"owner": {"reputation": 1587, "user_id": 1967021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec87a032dd3d3f1c76cd13582e60a54?s=128&d=identicon&r=PG", "display_name": "Ivan Pronin", "link": "https://stackoverflow.com/users/1967021/ivan-pronin"}, "edited": false, "score": 0, "creation_date": 1494447387, "post_id": 43901775, "comment_id": 74837795, "body": "<code>Caused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified</code> - looks like pom cannot be found."}, {"owner": {"reputation": 11, "user_id": 7973564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c5ab11a4d32d9ef63e5f5b7a6b74c?s=128&d=identicon&r=PG&f=1", "display_name": "SaneAxe", "link": "https://stackoverflow.com/users/7973564/saneaxe"}, "reply_to_user": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494447972, "post_id": 43901775, "comment_id": 74838085, "body": "@Tuffwer can you tell where can i set that location? I can&#39;t find it."}, {"owner": {"reputation": 11, "user_id": 7973564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c5ab11a4d32d9ef63e5f5b7a6b74c?s=128&d=identicon&r=PG&f=1", "display_name": "SaneAxe", "link": "https://stackoverflow.com/users/7973564/saneaxe"}, "reply_to_user": {"reputation": 1587, "user_id": 1967021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec87a032dd3d3f1c76cd13582e60a54?s=128&d=identicon&r=PG", "display_name": "Ivan Pronin", "link": "https://stackoverflow.com/users/1967021/ivan-pronin"}, "edited": false, "score": 0, "creation_date": 1494448075, "post_id": 43901775, "comment_id": 74838139, "body": "@IvanPronin I checked and the location for the project is set as what i want it to be. that is: &quot;C:\\Users\\Huzaifa\\workspace\\WebdriverTest\\pom.xml&quot;"}, {"owner": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494448353, "post_id": 43901775, "comment_id": 74838271, "body": "That would be hard to say without knowing how you are executing that buildstep? Based on <code>[WebdriverTest] $ cmd &#47;c call C:\\Windows\\TEMP\\jenkins5869105887311849511.bat</code> I believe you are using an <code>Execute windows batch command</code> build step and have a batch script of some sort.  Can you share that step with us (by editing it into the question)?"}, {"owner": {"reputation": 11, "user_id": 7973564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c5ab11a4d32d9ef63e5f5b7a6b74c?s=128&d=identicon&r=PG&f=1", "display_name": "SaneAxe", "link": "https://stackoverflow.com/users/7973564/saneaxe"}, "reply_to_user": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494449439, "post_id": 43901775, "comment_id": 74838834, "body": "@Tuffwer I&#39;ve Updated the question please take a look."}, {"owner": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494449746, "post_id": 43901775, "comment_id": 74838995, "body": "What version of Jenkins are you using?  If it&#39;s still 1.X you should go to manage jenkins -&gt; Configure system -&gt; and check the path to your JDK on that page"}, {"owner": {"reputation": 11, "user_id": 7973564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c5ab11a4d32d9ef63e5f5b7a6b74c?s=128&d=identicon&r=PG&f=1", "display_name": "SaneAxe", "link": "https://stackoverflow.com/users/7973564/saneaxe"}, "reply_to_user": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494450451, "post_id": 43901775, "comment_id": 74839337, "body": "@Tuffwer I&#39;m using fully updated version that is 2.x"}, {"owner": {"reputation": 927, "user_id": 5220640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1314995621c1b3ea44cc9110eab67e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Tuffwer", "link": "https://stackoverflow.com/users/5220640/tuffwer"}, "edited": false, "score": 0, "creation_date": 1494451216, "post_id": 43901775, "comment_id": 74839706, "body": "Go to Manage Jenkins as before but this time got to Global Tool Configuration instead of Configure System and either change or set the JDK path."}], "owner": {"reputation": 11, "user_id": 7973564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c5ab11a4d32d9ef63e5f5b7a6b74c?s=128&d=identicon&r=PG&f=1", "display_name": "SaneAxe", "link": "https://stackoverflow.com/users/7973564/saneaxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 736, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494449197, "creation_date": 1494446609, "last_edit_date": 1494449197, "question_id": 43901775, "link": "https://stackoverflow.com/questions/43901775/getting-error-while-building-in-jenkins", "title": "Getting error while building in Jenkins", "body": "<p>I'm new to Jenkins and I'm trying to build, and i'm geting the following error in console. Please Help! I've resolved most of the problems that i could.</p>\n\n<p>I'm followin tutorial: \"<a href=\"http://www.guru99.com/maven-jenkins-with-selenium-complete-tutorial.html\" rel=\"nofollow noreferrer\">http://www.guru99.com/maven-jenkins-with-selenium-complete-tutorial.html</a>\"</p>\n\n<p>This Question is Related to this: \"Steps to Install Jenkins and configure it to Run Maven with TestNg Selenium\"</p>\n\n<p>I've also resolved most of the error that occurred in the above tutorial and now I'm stuck on this</p>\n\n<pre><code>Started by timer\nBuilding in workspace C:\\Program Files (x86)\\Jenkins\\workspace\\WebdriverTest\n[WebdriverTest] $ cmd /c call C:\\Windows\\TEMP\\jenkins5869105887311849511.bat\n\nC:\\Program Files (x86)\\Jenkins\\workspace\\WebdriverTest&gt;D: -cp C:\\Program Files\\Java\\jdk1.8.0_73\\lib*;C:\\Program Files\\Java\\jdk1.8.0_73\\bin org.testng.TestNG testng.xml 1&gt;java \n\nD:\\&gt;exit 0 \nParsing POMs\nEstablished TCP socket on 18731\n[WebdriverTest] $ \"C:\\Program Files\\Java\\jdk1.8.0_73/bin/java\" -cp \"C:\\Program Files (x86)\\Jenkins\\plugins\\maven-plugin\\WEB-INF\\lib\\maven33-agent-1.8.1.jar;C:\\Program Files (x86)\\Jenkins\\tools\\hudson.tasks.Maven_MavenInstallation\\Maven\\boot\\plexus-classworlds-2.5.2.jar;C:\\Program Files (x86)\\Jenkins\\tools\\hudson.tasks.Maven_MavenInstallation\\Maven/conf/logging\" jenkins.maven3.agent.Maven33Main \"C:\\Program Files (x86)\\Jenkins\\tools\\hudson.tasks.Maven_MavenInstallation\\Maven\" \"C:\\Program Files (x86)\\Jenkins\\war\\WEB-INF\\lib\\remoting-3.7.jar\" \"C:\\Program Files (x86)\\Jenkins\\plugins\\maven-plugin\\WEB-INF\\lib\\maven33-interceptor-1.8.1.jar\" \"C:\\Program Files (x86)\\Jenkins\\plugins\\maven-plugin\\WEB-INF\\lib\\maven3-interceptor-commons-1.8.1.jar\" 18731\nERROR: Failed to parse POMs\njava.io.IOException: Cannot run program \"C:\\Program Files\\Java\\jdk1.8.0_73/bin/java\" (in directory \"C:\\Users\\Huzaifa\\workspace\\WebdriverTest\"): CreateProcess error=2, The system cannot find the file specified\n    at java.lang.ProcessBuilder.start(Unknown Source)\n    at hudson.Proc$LocalProc.&lt;init&gt;(Proc.java:245)\n    at hudson.Proc$LocalProc.&lt;init&gt;(Proc.java:214)\n    at hudson.Launcher$LocalLauncher.launch(Launcher.java:850)\n    at hudson.Launcher$ProcStarter.start(Launcher.java:384)\n    at hudson.maven.AbstractMavenProcessFactory.newProcess(AbstractMavenProcessFactory.java:278)\n    at hudson.maven.ProcessCache.get(ProcessCache.java:236)\n    at hudson.maven.MavenModuleSetBuild$MavenModuleSetBuildExecution.doRun(MavenModuleSetBuild.java:798)\n    at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:534)\n    at hudson.model.Run.execute(Run.java:1735)\n    at hudson.maven.MavenModuleSetBuild.run(MavenModuleSetBuild.java:544)\n    at hudson.model.ResourceController.execute(ResourceController.java:97)\n    at hudson.model.Executor.run(Executor.java:405)\nCaused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified\n    at java.lang.ProcessImpl.create(Native Method)\n    at java.lang.ProcessImpl.&lt;init&gt;(Unknown Source)\n    at java.lang.ProcessImpl.start(Unknown Source)\n    ... 13 more\nFinished: FAILURE\n</code></pre>\n"}, {"tags": ["c", "sphlib"], "answers": [{"tags": [], "owner": {"reputation": 573, "user_id": 1549596, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/efe8174d3d585c656b3115bba66919ea?s=128&d=identicon&r=PG", "display_name": "Vega4", "link": "https://stackoverflow.com/users/1549596/vega4"}, "is_accepted": false, "score": 0, "last_activity_date": 1494451062, "creation_date": 1494451062, "answer_id": 43902897, "question_id": 43901593, "link": "https://stackoverflow.com/questions/43901593/unresolved-external-symbol-sphlib-sph-blake512-init/43902897#43902897", "title": "Unresolved external symbol Sphlib - sph_blake512_init?", "body": "<p>Issue resolved. I was trying to reference a C function from C++.\nI  surrounded function's definition with</p>\n\n<pre><code>        #ifdef __cplusplus\n    extern \"C\" {\n    #endif\n    FUNCTION DECLARATION\n#ifdef __cplusplus\n    }\n    #endif`\n</code></pre>\n\n<p>and it's fine.</p>\n"}], "owner": {"reputation": 573, "user_id": 1549596, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/efe8174d3d585c656b3115bba66919ea?s=128&d=identicon&r=PG", "display_name": "Vega4", "link": "https://stackoverflow.com/users/1549596/vega4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494451062, "creation_date": 1494445921, "last_edit_date": 1494446518, "question_id": 43901593, "link": "https://stackoverflow.com/questions/43901593/unresolved-external-symbol-sphlib-sph-blake512-init", "title": "Unresolved external symbol Sphlib - sph_blake512_init?", "body": "<p>I'm having trouble with what I've thought would be a trivially easy task.\nThere is a Sphlib (Saphir 2.0) library containing hash functions.</p>\n\n<p>I'm using Visual Studio 2017. </p>\n\n<p>Scenario:\n    I want to import Blake512 hash function into my project so I do the following:</p>\n\n<pre><code>1) import sph_types.h into my project\n2)import sph_blake.h\n3) import blake.c\n</code></pre>\n\n<p>everything compiles but if include a sample invocation of a function I get an error during linking stage. </p>\n\n<pre><code>  error LNK2019: unresolved external symbol \"void __cdecl sph_blake512_init(void *)\"\n</code></pre>\n\n<p>I've been fighting with this for quite some time.\nI think it has got to do with the included macros but I do not know how to force VS to evaluate them properly. some macro-magic is being done in the sph_types.h that's what I know.</p>\n"}, {"tags": ["c", "scripting", "julia", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1494448595, "post_id": 43901787, "comment_id": 74838400, "body": "OK, I see. BTW, I am not that familiar with Julia&#39;s type system, so I am not sure whether that ADT-like structure will actually work"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1494449052, "post_id": 43901787, "comment_id": 74838625, "body": "And what about retrieving? Is it something like <code>ret-&gt;type</code>? Or is it <code>jl_valueof()</code> and <code>jl_typeof()</code>? They are macros so I don&#39;t really know their type"}, {"owner": {"reputation": 2917, "user_id": 3545907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dHGjEqN7wuY/AAAAAAAAAAI/AAAAAAAAAF4/GmFw533FE-s/photo.jpg?sz=128", "display_name": "Jeff Bezanson", "link": "https://stackoverflow.com/users/3545907/jeff-bezanson"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1494449629, "post_id": 43901787, "comment_id": 74838928, "body": "Yes, you can get the type of a <code>jl_value_t*</code> using <code>jl_typeof()</code>. The <code>jl_value_t*</code> itself already points to the data area (after the type tag)."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1494449941, "post_id": 43901787, "comment_id": 74839093, "body": "What do I get if I use <code>jl_valueof()</code> on a complex type? Or, is it what <code>jl_get_nth_field()</code> or <code>jl_get_field()</code> for? (Yeah, browsing 1800+ lines of code to guess API is not really fun...)"}, {"owner": {"reputation": 2917, "user_id": 3545907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dHGjEqN7wuY/AAAAAAAAAAI/AAAAAAAAAF4/GmFw533FE-s/photo.jpg?sz=128", "display_name": "Jeff Bezanson", "link": "https://stackoverflow.com/users/3545907/jeff-bezanson"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1494450151, "post_id": 43901787, "comment_id": 74839188, "body": "If you want to access fields of a composite value, yes you want <code>jl_get_nth_field</code> or <code>jl_get_field</code>. I agree the embedding docs need to cover a lot more, but I&#39;m not sure what <code>jl_get_field</code> would do other than get a field. <code>jl_get_nth_field</code> is faster since it avoids looking up the index for the field name."}], "tags": [], "owner": {"reputation": 2917, "user_id": 3545907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dHGjEqN7wuY/AAAAAAAAAAI/AAAAAAAAAF4/GmFw533FE-s/photo.jpg?sz=128", "display_name": "Jeff Bezanson", "link": "https://stackoverflow.com/users/3545907/jeff-bezanson"}, "is_accepted": true, "score": 4, "last_activity_date": 1494446643, "creation_date": 1494446643, "answer_id": 43901787, "question_id": 43901415, "link": "https://stackoverflow.com/questions/43901415/boxing-unboxing-complex-types-in-julia/43901787#43901787", "title": "Boxing/Unboxing complex types in Julia", "body": "<p>You can convert a C string to a Julia <code>String</code> using <code>jl_cstr_to_string(char*)</code>.</p>\n\n<p>To get the data from a Julia <code>String</code>, use <code>jl_string_ptr(jl_value_t*)</code>.</p>\n\n<p>Constructors are called just like functions, so to call a constructor you can use <code>jl_get_function(m, \"Idle\")</code> and call it as normal. Or, to allocate an object directly (going around any constructors that might be defined, so technically a bit dangerous), you can call <code>jl_new_struct(type, fields...)</code>.</p>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 43901787, "answer_count": 1, "score": 0, "last_activity_date": 1518750513, "creation_date": 1494445283, "last_edit_date": 1518750513, "question_id": 43901415, "link": "https://stackoverflow.com/questions/43901415/boxing-unboxing-complex-types-in-julia", "title": "Boxing/Unboxing complex types in Julia", "body": "<p>I have basically digged through all Julia documentation, but I cannot find any answers on this. My question can be split into two parts. Code snippets ignore stuff like basic s initialization.</p>\n\n<h1>Part 1: How to pass basic complex types without <code>jl_eval_string()</code></h1>\n\n<p>Suppose I have a C/C++ program which calls some Julia scripts, for a function <code>f</code> which do some <code>String</code> manipulation. In the C source:</p>\n\n<pre><code>char* parameter_string; // Initialized as something.\njl_module_t *m = (jl_module_t *) jl_load(\"Script.jl\");\njl_function_t *f = jl_get_function(m, \"f\");\njl_value_t * ret = jl_call1(f, /*???*/) &lt;--- Problem\n</code></pre>\n\n<p>Now, notice that the manual only describes how to box up primitives, like int, float, double. Nothing about complex types, like <code>String</code>. Yes, I can use <code>jl_eval_string(parameter_string)</code>, but I don't like this. Moreover, <code>ret</code> will be a String, and I have no idea how to extract it to C. It is undocumented.</p>\n\n<h1>Part 2:</h1>\n\n<p>Suppose I have a C/C++ program which calls some Julia scripts, in which a state machine is stepped. To create a state machine, I create some types:</p>\n\n<pre><code>abstract State\ntype Idle &lt;: State end\ntype State1 &lt;: State end\ntype State2 &lt;: State end\n</code></pre>\n\n<p>And then a transition function:</p>\n\n<pre><code>function transition(s :: State, input :: String) # input :: String is arbitrary\n  .. Do Something ..\n  return newState\nend\n</code></pre>\n\n<p>Now, if I want to create a <code>State</code>, say <code>Idle</code>, in C... I cannot find anything like this, let alone finding a way to retrieve it from Julia.</p>\n\n<p>I am approaching this problem more or less like functional programming language, such as Haskell, Scala, or F#. Algebraic Data Type might not be well supported here, but I think it is still better than hard coding it with integers.</p>\n\n<p>The real problem is that I cannot find any C API documents on Julia, without directly digging into its source code.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494445370, "post_id": 43901382, "comment_id": 74836759, "body": "<code>for (i = 0; i &lt; 100; i++)</code> -- You assume that all lines/words are 100 characters long. That&#39;s not true; you must use the real length of the line: <code>for (i = 0; s[i]; i++)</code>. The garbage you see is the garbage after the nul terminator <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445383, "post_id": 43901382, "comment_id": 74836765, "body": "You are opening in <code>temp</code> but checking <code>kp</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445547, "post_id": 43901382, "comment_id": 74836849, "body": "You are changing in k but saving s."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494445575, "post_id": 43901382, "comment_id": 74836861, "body": "Also, <code>fscanf(f, &quot;%s&quot;, s)</code>(note that there is not <code>&amp;</code> when scanning strings) reads &quot;words&quot;, i.e. everything but white space. You lose all white space when writing to the output file."}, {"owner": {"reputation": 25, "user_id": 7805694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/665e9f2997a012e77df477a244a99d2a?s=128&d=identicon&r=PG&f=1", "display_name": "dozgunay", "link": "https://stackoverflow.com/users/7805694/dozgunay"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494445616, "post_id": 43901382, "comment_id": 74836887, "body": "@MOehm With &#39;for(i=0;s[i];i++)&#39; anything has changed."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494445753, "post_id": 43901382, "comment_id": 74836977, "body": "Well, Ajay&#39;s comment has the real reason: You upper-case <code>s</code>, but print <code>k</code>, which is a char buffer that has never been initialised. That&#39;s garbage right from the start."}, {"owner": {"reputation": 25, "user_id": 7805694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/665e9f2997a012e77df477a244a99d2a?s=128&d=identicon&r=PG&f=1", "display_name": "dozgunay", "link": "https://stackoverflow.com/users/7805694/dozgunay"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445908, "post_id": 43901382, "comment_id": 74837066, "body": "@AjayBrahmakshatriya I have opened a new file in order to copy the string into that and change it on that file."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445972, "post_id": 43901382, "comment_id": 74837099, "body": "@dozgunay Yes, I understand. The condition to check if the file has opened should be <code>if ( temp == NULL)</code> in that case."}, {"owner": {"reputation": 25, "user_id": 7805694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/665e9f2997a012e77df477a244a99d2a?s=128&d=identicon&r=PG&f=1", "display_name": "dozgunay", "link": "https://stackoverflow.com/users/7805694/dozgunay"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494446147, "post_id": 43901382, "comment_id": 74837190, "body": "@AjayBrahmakshatriya I understand my mistakes.I am very pleased from your help."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 1, "last_activity_date": 1494445744, "creation_date": 1494445744, "answer_id": 43901547, "question_id": 43901382, "link": "https://stackoverflow.com/questions/43901382/lowercase-to-uppercase-with-opening-new-file/43901547#43901547", "title": "Lowercase to uppercase with opening new file", "body": "<p>Multiple issues in your code which together cause the issues</p>\n\n<ol>\n<li>You are storing the opened FILE* in temp, but checking kp. I think that is because you copy pasted the check from above. Can be easily fixed by changing the variable</li>\n<li>You perform the capitalization operation outside what was set by scanf. As suggested by @MOehm, change the loop condition to <code>s[i]</code></li>\n<li>Finally you are converting the string in place in s but are saving k in the file. k is never modified. Change <code>fprintf(temp, \"%s\", k);</code> to <code>fprintf(temp, \"%s\", s);</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7805694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/665e9f2997a012e77df477a244a99d2a?s=128&d=identicon&r=PG&f=1", "display_name": "dozgunay", "link": "https://stackoverflow.com/users/7805694/dozgunay"}, "edited": false, "score": 0, "creation_date": 1494447289, "post_id": 43901826, "comment_id": 74837741, "body": "I understand, using pointer and strlen function is the easiest way to complete this programme I guess,isn&#39;t it?"}], "tags": [], "owner": {"reputation": 724, "user_id": 7438356, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3b94d667c9db8baa2b9ab57502b4a82?s=128&d=identicon&r=PG&f=1", "display_name": "RomMer", "link": "https://stackoverflow.com/users/7438356/rommer"}, "is_accepted": false, "score": 0, "last_activity_date": 1494446805, "creation_date": 1494446805, "answer_id": 43901826, "question_id": 43901382, "link": "https://stackoverflow.com/questions/43901382/lowercase-to-uppercase-with-opening-new-file/43901826#43901826", "title": "Lowercase to uppercase with opening new file", "body": "<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *append(const char *s, char c) {\n    int len = strlen(s);\n    char buf[len+2];\n    strcpy(buf, s);\n    buf[len] = c;\n    buf[len + 1] = 0;\n    return strdup(buf);\n}\n\nint main(int argc, char **argv)\n{\n    char ch;\n    FILE *fp;\n\n    if (argc != 2)\n      return (0);\n\n    if ((fp = fopen(argv[1], \"r\")) == NULL)\n    {\n      perror(\"Error while opening the file.\\n\");\n      exit(EXIT_FAILURE);\n    }\n\n    char *res;\n    while((ch = fgetc(fp)) != EOF)\n    {\n      res = append(res, ch);\n    }\n\n    fclose(fp);\n\n    int i = 0;\n    while (i &lt; strlen(res))\n    {\n      if (res[i] &gt;= 97 &amp;&amp; res[i] &lt;= 122)\n        res[i] = res[i] - 32;\n      i++;\n    }\n\n    printf(\"%s\\n\", res);\n    return 0;\n}\n</code></pre>\n\n<p>here is a quick example</p>\n\n<p>read the file char by char and add each char in a char *. Then for each character lowercase char, sub 32 to get the uppercase char and write it then print. Give the filename as first parameter when you start the programm</p>\n"}], "owner": {"reputation": 25, "user_id": 7805694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/665e9f2997a012e77df477a244a99d2a?s=128&d=identicon&r=PG&f=1", "display_name": "dozgunay", "link": "https://stackoverflow.com/users/7805694/dozgunay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 43901547, "answer_count": 2, "score": 0, "last_activity_date": 1494446805, "creation_date": 1494445182, "question_id": 43901382, "link": "https://stackoverflow.com/questions/43901382/lowercase-to-uppercase-with-opening-new-file", "title": "Lowercase to uppercase with opening new file", "body": "<p>I tried to change all random lowercase letters to uppercase letters in this program.First of all, I have initialized in lowercase.txt <strong>AkfsASlkALfdk</strong>.Then I read from it and changing all the lowercase letters into capital ones.The problem is,when I opened the <strong>capital.txt</strong> is <strong>\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00cc\u00ccAKFSASLKALFDK</strong>.Where did the error come from?I couldn't find it yet and I decided to ask you.</p>\n\n<pre><code>#pragma warning(disable:4996)\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;conio.h&gt;\nint main() \n{\n    int i;\n    char s[100];\n    char k[100];\nFILE *kp;\nkp = fopen(\"lowercase.txt\", \"r\");\nif (kp == NULL)\n{\n    printf(\"Error in opening file.\\n\");\n    system(\"pause\");\n    exit(1);\n}\nFILE *temp;\ntemp = fopen(\"capital.txt\", \"w\");\nif (kp == NULL)\n{\n    printf(\"Error in opening file.\\n\");\n    system(\"pause\");\n    exit(2);\n}\n    printf(\"Opening file is successful.\\n\");\n\n\n    if (fscanf(kp, \"%s\", &amp;s) != EOF)\n    {\n    for (i = 0; i &lt; 100; i++)\n        {\n        if (s[i] &gt;= 97 &amp;&amp; s[i] &lt;= 122)\n            {\n            s[i] -= 32;\n\n            }\n        }\n    }\nfprintf(temp, \"%s\", k);\ngetch();\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "integer-overflow", "typing"], "comments": [{"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 7, "creation_date": 1494445668, "post_id": 43901379, "comment_id": 74836927, "body": "formulae for calculating distances differ in the two codes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494534082, "post_id": 43901379, "comment_id": 74883035, "body": "instead of <code>abs()</code> both sets of code should be using <code>labs()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 1541408, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d970d21d260162975ee97529c4f8d64b?s=128&d=identicon&r=PG", "display_name": "Giulio Muscarello", "link": "https://stackoverflow.com/users/1541408/giulio-muscarello"}, "is_accepted": false, "score": 2, "last_activity_date": 1494445181, "creation_date": 1494445181, "answer_id": 43901380, "question_id": 43901379, "link": "https://stackoverflow.com/questions/43901379/why-do-i-get-different-results-when-replacing-a-variable-by-a-direct-function-ca/43901380#43901380", "title": "Why do I get different results when replacing a variable by a direct function call?", "body": "<p>This happens because the second function overflows: <code>abs</code> returns an <code>int</code>, so the result of <code>abs(...) + abs(...)</code> is an <code>int</code> (which will sometimes overflow), which is then cast to <code>long</code> by the <code>return</code> keyword.</p>\n\n<p>On the other hand, the first function casts operands to <code>long</code> by storing it in <code>long</code> variables, therefore their sum is also a <code>long</code>, and it won't overflow.</p>\n"}], "owner": {"reputation": 1304, "user_id": 1541408, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d970d21d260162975ee97529c4f8d64b?s=128&d=identicon&r=PG", "display_name": "Giulio Muscarello", "link": "https://stackoverflow.com/users/1541408/giulio-muscarello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494446022, "creation_date": 1494445181, "last_edit_date": 1494445337, "question_id": 43901379, "link": "https://stackoverflow.com/questions/43901379/why-do-i-get-different-results-when-replacing-a-variable-by-a-direct-function-ca", "title": "Why do I get different results when replacing a variable by a direct function call?", "body": "<p>I have this code which works just fine:</p>\n\n<pre><code>long nodeDistance(node_t a, node_t b) {\n    long d1 = abs(a.passi_1 - b.passi_2);\n    long d2 = abs(a.passi_2 - b.passi_2);\n    return d1 + d2;\n}\n</code></pre>\n\n<p>I call it over a linked list, and it returns a plausible, positive result (120259067966). However, when I inline both variables, it acts very weird; I also noticed that it compiles much slower.</p>\n\n<pre><code>long nodeDistance(node_t a, node_t b) {\n    return abs(a.passi_1 - b.passi_1) + abs(a.passi_2 - b.passi_2);\n}\n</code></pre>\n\n<p>When calling it over the same linked list, it will return a negative value (-16322). Why is this?</p>\n"}, {"tags": ["c", "compiler-errors", "mpfr"], "comments": [{"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 2, "creation_date": 1494445188, "post_id": 43901368, "comment_id": 74836647, "body": "How exactly do you expect to get help without a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>?"}, {"owner": {"reputation": 119, "user_id": 3442976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/riBJr.png?s=128&g=1", "display_name": "Drone Scientist", "link": "https://stackoverflow.com/users/3442976/drone-scientist"}, "reply_to_user": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 0, "creation_date": 1494445346, "post_id": 43901368, "comment_id": 74836745, "body": "I wouldn&#39;t know how to give a verifiable example because my code works on one computer.  I would like help how to follow this type of problem through the compilation, for example some compiler flags that give more information.  Maybe such help is not possible."}, {"owner": {"reputation": 6961, "user_id": 1248974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClqC2.jpg?s=128&g=1", "display_name": "davedwards", "link": "https://stackoverflow.com/users/1248974/davedwards"}, "edited": false, "score": 1, "creation_date": 1494445743, "post_id": 43901368, "comment_id": 74836970, "body": "<a href=\"http://www.mpfr.org/mpfr-current/mpfr.html#Installing-MPFR\" rel=\"nofollow noreferrer\">mpfr.org/mpfr-current/mpfr.html#Installing-MPFR</a> states &quot;The official type for exponent values changed from <code>mp_exp_t</code> to <code>mpfr_exp_t</code> in MPFR 3.0&quot;, maybe you don&#39;t have the lib installed or need the 3.0 version"}, {"owner": {"reputation": 119, "user_id": 3442976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/riBJr.png?s=128&g=1", "display_name": "Drone Scientist", "link": "https://stackoverflow.com/users/3442976/drone-scientist"}, "reply_to_user": {"reputation": 6961, "user_id": 1248974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClqC2.jpg?s=128&g=1", "display_name": "davedwards", "link": "https://stackoverflow.com/users/1248974/davedwards"}, "edited": false, "score": 1, "creation_date": 1494445798, "post_id": 43901368, "comment_id": 74837003, "body": "@downshift you have out googled me, thanks a lot.  I appreciate the help."}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1494445887, "post_id": 43901368, "comment_id": 74837057, "body": "Have you included the right header files and compiled with <code>-Wall</code> <code>-Wextra</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 3442976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/riBJr.png?s=128&g=1", "display_name": "Drone Scientist", "link": "https://stackoverflow.com/users/3442976/drone-scientist"}, "is_accepted": true, "score": 1, "last_activity_date": 1494446045, "creation_date": 1494446045, "answer_id": 43901631, "question_id": 43901368, "link": "https://stackoverflow.com/questions/43901368/changed-computer-now-can-not-compile/43901631#43901631", "title": "Changed computer now can not compile", "body": "<p>The MPFR libraries changed some syntax between versions.  In particular, as stated in the comments,</p>\n\n<p>\"The official type for exponent values changed from mp_exp_t to mpfr_exp_t in MPFR 3.0\".</p>\n\n<p>Changing the code fixes the problem.</p>\n"}], "owner": {"reputation": 119, "user_id": 3442976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/riBJr.png?s=128&g=1", "display_name": "Drone Scientist", "link": "https://stackoverflow.com/users/3442976/drone-scientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1494453023, "accepted_answer_id": 43901631, "answer_count": 1, "score": -2, "last_activity_date": 1494507564, "creation_date": 1494445142, "last_edit_date": 1494507564, "question_id": 43901368, "link": "https://stackoverflow.com/questions/43901368/changed-computer-now-can-not-compile", "closed_reason": "Needs details or clarity", "title": "Changed computer now can not compile", "body": "<p>I have encountered a problem which I do not know where to begin with.  I developed code on my laptop and it works fine.  I moved to another computer and now during compilation I get,</p>\n\n<blockquote>\n  <p>error: unknown type name 'mpfr_exp_t'</p>\n</blockquote>\n\n<p>The mpfr library is located in the same place on both computers.  Can anyone give me a clue how to learn what is wrong on the new computer?</p>\n"}, {"tags": ["c", "arrays", "char", "mandelbrot"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445235, "post_id": 43901163, "comment_id": 74836680, "body": "Use <code>memcpy</code> instead of <code>strncpy</code> The pixel data might have 0s in between them"}, {"owner": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494445749, "post_id": 43901163, "comment_id": 74836975, "body": "Sounds like an idea but I used strcat/strncat to concatenate the values (line + newPixelData) and I don&#39;t know about something equivalent to that for memcpy"}, {"owner": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494446547, "post_id": 43901163, "comment_id": 74837385, "body": "Thank you, using memcpy and a pointer to the new index in the array worked"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "edited": false, "score": 0, "creation_date": 1494445227, "post_id": 43901257, "comment_id": 74836674, "body": "You&#39;re right, pixelData contains of three values for RGB. As I want to first generate a whole line (so append those three values to the existing line) which is (width*3) long before I write it to stdout, how else would I do this?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "edited": false, "score": 0, "creation_date": 1494445797, "post_id": 43901257, "comment_id": 74837001, "body": "@iwilltry: think of it as an array of triplets. The first triplet occupies positions 0-2; the next one 3-5; then 4-6; and so on. (Or you could use two dimensional array.) You might want to look at <code>memcpy</code>."}, {"owner": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "edited": false, "score": 0, "creation_date": 1494446661, "post_id": 43901257, "comment_id": 74837447, "body": "Thank you, I worked it out like this: use an int as a running index for the current location in the line[]-array, than memcpy(&amp;line[i*3], pixelData, 3); and increment i. Thank you very much for pointing me in the right direction :)"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1494444733, "creation_date": 1494444733, "answer_id": 43901257, "question_id": 43901163, "link": "https://stackoverflow.com/questions/43901163/c-concatenate-char-arrays-then-write-to-stdout-different-to-writing-single-ch/43901257#43901257", "title": "C - Concatenate char arrays, then write to stdout different to writing single chars", "body": "<p>You cannot use string functions with <code>char</code> arrays which might contain 0s, nor with <code>char</code> arrays which are not 0-terminated. I believe that <code>pixelData</code> in your code is just an array of three small integers, rather than a printable string. So <code>strncat</code> won't help you. On the other hand, since you always know how long your line is, you don't need <code>strncat</code> to work it out for you.</p>\n"}], "owner": {"reputation": 45, "user_id": 6450189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIOPe.jpg?s=128&g=1", "display_name": "iwilltry42", "link": "https://stackoverflow.com/users/6450189/iwilltry42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 43901257, "answer_count": 1, "score": 0, "last_activity_date": 1494444876, "creation_date": 1494444344, "last_edit_date": 1494444876, "question_id": 43901163, "link": "https://stackoverflow.com/questions/43901163/c-concatenate-char-arrays-then-write-to-stdout-different-to-writing-single-ch", "title": "C - Concatenate char arrays, then write to stdout different to writing single chars", "body": "<p>so I have this task to create mandel fractals in C.\nI will keep the code simple as it's quite much.\nThe Problem: </p>\n\n<ul>\n<li><p>in the given file, each pixel (char[3]) is calculated separately and then written to stdout via write(1, pixeldata, 3) </p></li>\n<li><p>NOW: as this is not very efficient, I want to first collect all pixels of one line in a char array char line[width*3]</p></li>\n<li>everything works, except that the output is very different from the one before (colors look displaced, etc.)</li>\n</ul>\n\n<p>Here's the code: </p>\n\n<pre><code>char pixelData[3];\nchar line[width*3];\nfor (y=1; y &lt;= height; ++y) {\n...\n    for (x=1; x &lt;= width; ++x) {\n    ... calculate ...\n\n    // iterate\n        for ( .... calculate ...) {\n               ... calculate ....\n        }\n        strncat(line, pixelData, 3);        // after\n        // write(1, pixelData, 3);  // before: worked\n}\nwrite(1, line, sizeof(line)); // after\nmemset(line, 0, sizeof(line));\n</code></pre>\n\n<p>}</p>\n\n<p>It would be pretty cool, if someone could tell me, what I did wrong here...\nThanks in advance :)</p>\n"}, {"tags": ["c", "function", "parameters"], "comments": [{"owner": {"reputation": 116, "user_id": 7863703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0hiI.jpg?s=128&g=1", "display_name": "Gili Levy", "link": "https://stackoverflow.com/users/7863703/gili-levy"}, "edited": false, "score": 0, "creation_date": 1494445323, "post_id": 43901087, "comment_id": 74836726, "body": "Pass by reference?"}], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "edited": false, "score": 0, "creation_date": 1494445707, "post_id": 43901468, "comment_id": 74836949, "body": "Interesting. Thank you. To clarify this silliness is only for arrays?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "edited": false, "score": 0, "creation_date": 1494445944, "post_id": 43901468, "comment_id": 74837086, "body": "Yeah, the behavior is a bit confusing for arrays. If you pass primitives or structs and don&#39;t use the <code>&amp;</code> they will be passed by value, unlike arrays."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "edited": false, "score": 0, "creation_date": 1494446364, "post_id": 43901468, "comment_id": 74837292, "body": "@seamus  Re: &quot;only for arrays?&quot; Functions are also converted to a <i>pointer to the function</i> when used as a function parameter (and other situations):  <code>foo(rand)</code>.  Yet the receiving function <code>foo(int (*f)())</code> cannot certainly read nor write the function <code>rand()</code> via that pointer. It can execute the function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494446614, "post_id": 43901468, "comment_id": 74837423, "body": "@SHG &quot;it&#39;s exactly like passing the array address. &quot;  --&gt; Almost.  &quot;it&#39;s exactly like passing the address of the first element of the array.&quot;  This difference is subtle to see.  The value of those 2 address are <i>equivalent</i>, yet differ in type and rarely bit pattern."}], "tags": [], "owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "is_accepted": true, "score": 4, "last_activity_date": 1494447330, "last_edit_date": 1494447330, "creation_date": 1494445496, "answer_id": 43901468, "question_id": 43901087, "link": "https://stackoverflow.com/questions/43901087/can-c-function-parameters-set-variables/43901468#43901468", "title": "Can C function parameters set variables?", "body": "<p>When you pass an array as an argument to a function, it's exactly like passing the array address. Then, the function can modify the context of this address, means the array itself.</p>\n\n<p>E.g the function can be defined as <code>int readln(char *s, int maxlen)</code> and the functionality will stay the same.</p>\n\n<p>When calling the function you could use either <code>readln(firstname, STRLEN)</code> or <code>readln(&amp;firstname[0], STRLEN)</code>. Both will work with either of the function definitions (they're orthogonal).</p>\n\n<p>A nice <a href=\"https://www.tutorialspoint.com/cprogramming/c_passing_arrays_to_functions.htm\" rel=\"nofollow noreferrer\">tutorial</a> about this subject.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1494515803, "last_edit_date": 1494515803, "creation_date": 1494451211, "answer_id": 43902924, "question_id": 43901087, "link": "https://stackoverflow.com/questions/43901087/can-c-function-parameters-set-variables/43902924#43902924", "title": "Can C function parameters set variables?", "body": "<p>The general term is \"pass by reference\" - the formal parameter <code>s</code> in <code>readln</code> <em>refers</em> to the same chunk of memory that the actual parameters <code>firstname</code> and <code>lastname</code> do in the respective function calls.  </p>\n\n<p>C actually passes all function arguments <em>by value</em> - the formal parameter in the function definition is a separate object in memory from the actual parameter in the function call, and the value of the actual parameter is copied to the formal parameter:  </p>\n\n<pre><code>void swap( int a, int b ) // a receives a *copy* of x's value, b receives\n{                         // a *copy* of y's value\n  int t = a;              // updates to a and b have no effect on x and y\n  a = b;\n  b = t;\n}\n\nvoid bar( void )\n{\n   int x = 1, y = 2;\n   swap( x, y );          // x and y are not actually updated\n}\n</code></pre>\n\n<p>We <em>fake</em> pass by reference semantics by passing a pointer to the object we want modified:</p>\n\n<pre><code>void swap( int *a, int *b ) // a receives the *address* of x, b receives the\n{                           // address of y\n  int t = *a;               // updates to *a and *b *do* have and effect on\n  *a = *b;                  // x and y\n  *b = t;\n}\n\nvoid bar( void )\n{\n  int x = 1, y = 2;\n  swap( &amp;x, &amp;y );          // instead of passing the *values* of x and y,\n}                          // we pass their addresses.\n</code></pre>\n\n<p>Again, <code>a</code> and <code>b</code> are separate objects in memory from <code>x</code> and <code>y</code>, but instead of receiving the <em>values</em> of <code>x</code> and <code>y</code>, they receive their <em>addresses</em>.  IOW</p>\n\n<pre><code> a == &amp;x;\n b == &amp;y;\n*a ==  x;\n*b ==  y;\n</code></pre>\n\n<p>The situation gets a little weird with arrays - unless it's the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators (or a string literal used to initialize a character array in a declaration), an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element in the array.</p>\n\n<p>So, if you pass an array expression to a function, what the function actually receives is a pointer to the first element of the array, so you don't need to use the <code>&amp;</code> operator in the function call.  That's what's happening in <code>readln</code>; the parameter <code>s</code> points to the first element of the array in the function call.  </p>\n"}], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 43901468, "answer_count": 2, "score": -1, "last_activity_date": 1494515803, "creation_date": 1494444084, "last_edit_date": 1494445581, "question_id": 43901087, "link": "https://stackoverflow.com/questions/43901087/can-c-function-parameters-set-variables", "title": "Can C function parameters set variables?", "body": "<p>I can't figure out how the firstname and lastname variables are being set in the below C code.</p>\n\n<pre><code>printf(\"Hello, %s, %s\\n\", firstname, lastname);\n</code></pre>\n\n<p>It looks the char [s] parameter of the readln function is setting firstname &amp; lastname. </p>\n\n<p>Is this possible, if so what is this called so I can do a bit of research.</p>\n\n<p>Thanks</p>\n\n<p>Edit: Below is a simpler version. It looks like the parameter is setting a variable.</p>\n\n<pre><code>int foo(char s[]){\n    s[0]='w';\n    s[1]='\\0';\n\n    return 5;\n}\n\nint main() {\n\n    char name[2];\n    int wtf;\n\n    wtf = foo(name);\n    printf(\"%s\\n\", name);\n}\n</code></pre>\n\n<p>Parameter char s[] is setting name</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define STRLEN 5\n\n\nint readln(char s[], int maxlen) {\n    char ch;\n    int i;\n    int chars_remain;\n    i = 0;\n    chars_remain = 1;\n    while (chars_remain) {\n        ch = getchar();\n        if ((ch == '\\n') || (ch == EOF) ) {\n            chars_remain = 0;\n        } else if (i &lt; maxlen - 1) {\n            s[i] = ch;\n            i++;\n        }\n    }\n    s[i] = '\\0';\n    return i;\n} \n\nint main(int argc, char **argv) {\n    char firstname[STRLEN];\n    char lastname[STRLEN];\n    int len_firstname;\n    int len_lastname;\n    printf(\"Enter your first name:\");\n    len_firstname = readln(firstname, STRLEN);\n    printf(\"Enter your last name:\");\n    len_lastname = readln(lastname, STRLEN);\n    printf(\"Hello, %s, %s\\n\", firstname, lastname);\n    printf(\"Length of firstname = %d, lastname = %d\", len_firstname, len_lastname);\n}\n</code></pre>\n"}, {"tags": ["c", "bison", "yacc", "lex", "lexical-analysis"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494443583, "post_id": 43900607, "comment_id": 74835728, "body": "Your description of your build process is suspicious.  You run <code>lex</code>, but you do not appear to compile the resulting lexical analysis code or include the lexer function in your program.  Are you performing some kind of ill-advised <code>#include</code> of the lexer&#39;s generated C source into the generated parser source?  If so, then I must be overlooking it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494444274, "post_id": 43900607, "comment_id": 74836153, "body": "I think your expectation of the program&#39;s behavior is wrong, but it segfaults for me before accepting any input, so I defer commentary on any specifics until you can provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1494446943, "post_id": 43900607, "comment_id": 74837565, "body": "Try to enable warnings on gcc yacc and lex"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1494447887, "last_edit_date": 1495542368, "creation_date": 1494447887, "answer_id": 43902106, "question_id": 43900607, "link": "https://stackoverflow.com/questions/43900607/in-lex-and-yacc-code-printf-not-working-in-yacc-file/43902106#43902106", "title": "in lex and yacc code printf not working in yacc file", "body": "<h2>You have several problems:</h2>\n\n<ol>\n<li><p>The build details you describe do not follow the usual pattern, and in fact <em>they do not work</em> for the code you provide.</p></li>\n<li><p>Having sorted out how to build your program, <em>it does not work at all</em>, instead segfaulting before reading any input.</p></li>\n<li><p>Having solved <em>that</em> problem, your expectation of the program's behavior with the given input is incorrect in at least two ways.</p></li>\n</ol>\n\n<h3>With respect to the build:</h3>\n\n<ul>\n<li><p><code>yacc</code> builds C source for a parser and optionally a header file containing corresponding token definitions.  It is usual to exercise the option to get the definitions, and to <code>#include</code> their header in the lexer's source file (<code>#include 'y.tab.h'</code>):</p>\n\n<p><code>yacc -d example.y</code></p></li>\n<li><p><code>lex</code> builds C source for a lexical analyzer.  This can be done either before of after <code>yacc</code>, as <code>lex</code> does not depend directly on the token definitions:</p>\n\n<p><code>lex example.l</code></p></li>\n<li><p>The two generated C source files must be compiled and linked together, possibly with other sources as well, and possibly with libraries.  In particular, it is often convenient to link in <code>libl</code> (or <code>libfl</code> if your <code>lex</code> is really GNU <code>flex</code>).  I linked the latter to get the default <code>yywrap()</code>:</p>\n\n<p><code>gcc -o example lex.yy.c y.tab.c -lfl</code></p></li>\n</ul>\n\n<h3>With respect to the segfault:</h3>\n\n<p>Your generated program is built around this:</p>\n\n<pre><code>extern FILE *yyin;\n\nmain()\n{\n    while(!feof(yyin)) {\n        yyparse();\n    }\n}\n</code></pre>\n\n<p>In the first place, you should read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>.  Having had that under consideration might have spared you from committing a much more fundamental mistake: evaluating <code>yyin</code> before it has been set.  Although it's true that <code>yyin</code> will be set to <code>stdin</code> if you don't set it to something else, that cannot happen at program initialization because <code>stdin</code> is not a compile-time constant.  Therefore, when control first reaches the loop control expression, <code>yyin</code>'s value is still NULL, and a segfault results.</p>\n\n<p>It would be safe and make more sense to test for end of file after <code>yyparse()</code> returns.</p>\n\n<h3>With respect to behavioral expectations</h3>\n\n<p>You complained that the input</p>\n\n<pre><code>verb accept,admire,reject\nnoun jam,pillow,knee\njam reject knee\n</code></pre>\n\n<p>does not elicit any output from the program, but that's not exactly true.  That input does not elicit output from the program <em>when it is entered interactively, without afterward sending an end-of-file signal</em> (i.e. by typing control-D at the beginning of a line).</p>\n\n<p>The parser not yet having detected end-of-file in that case (and not paying any attention at all to newlines, since your lexer notifies it about them only when they immediately follow a period), it has no reason to attempt to reduce its token stack to the start symbol.  It could be that you will continue with an object to extend the simple sentence, and it cannot be sure that it won't see a CONJUNCTION next, eithger.  It doesn't print anything because it's waiting for more input.  If you end the sentence with a period or afterward send a control-D then it will in fact print \"Parsed a simple sentence.\"</p>\n"}], "owner": {"reputation": 1, "user_id": 7781179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e72e099bb79af7d90f2714f700e6293?s=128&d=identicon&r=PG&f=1", "display_name": "J.Pole", "link": "https://stackoverflow.com/users/7781179/j-pole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 43902106, "answer_count": 1, "score": 0, "last_activity_date": 1494447887, "creation_date": 1494442406, "question_id": 43900607, "link": "https://stackoverflow.com/questions/43900607/in-lex-and-yacc-code-printf-not-working-in-yacc-file", "title": "in lex and yacc code printf not working in yacc file", "body": "<p>Hi i am trying to run John code from lex and yacc book by R. Levine i have compiled the lex and yacc program in linux using the commands</p>\n\n<pre><code>lex example.l\nyacc example.y\ngcc -o example y.tab.c\n./example\n</code></pre>\n\n<p>the program asks the user for input of verbs,nouns,prepositions e.t.c in the format </p>\n\n<pre><code>verb accept,admire,reject\nnoun jam,pillow,knee\n</code></pre>\n\n<p>and then runs the grammar in yacc to check if it's a simple or compound sentence\nbut when i type \n<code>jam reject knee</code></p>\n\n<p>it shows noting on screen where it is supposed to show the line \"Parsed a simple sentence.\" on parsing.The code is given below</p>\n\n<p><strong>yacc file</strong></p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n/* we found the following required for some yacc implementations. */\n/* #define YYSTYPE int */\n%}\n\n%token NOUN PRONOUN VERB ADVERB ADJECTIVE PREPOSITION CONJUNCTION\n\n%%\n\nsentence: simple_sentence   { printf(\"Parsed a simple sentence.\\n\"); }\n    | compound_sentence { printf(\"Parsed a compound sentence.\\n\"); }\n    ; \n\nsimple_sentence: subject verb object\n    |   subject verb object prep_phrase\n    ;\n\ncompound_sentence: simple_sentence CONJUNCTION simple_sentence\n    |   compound_sentence CONJUNCTION simple_sentence\n    ;\n\nsubject:    NOUN\n    |   PRONOUN\n    |   ADJECTIVE subject\n    ;\n\nverb:       VERB\n    |   ADVERB VERB\n    |   verb VERB\n    ;\n\nobject:     NOUN\n    |   ADJECTIVE object\n    ;\n\nprep_phrase:    PREPOSITION NOUN\n    ;\n\n%%\n\nextern FILE *yyin;\n\nmain()\n{\n    while(!feof(yyin)) {\n        yyparse();\n    }\n}\n\nyyerror(s)\nchar *s;\n{\n    fprintf(stderr, \"%s\\n\", s);\n}\n</code></pre>\n\n<p><strong>lex file</strong></p>\n\n<pre><code>%{\n/*\n * We now build a lexical analyzer to be used by a higher-level parser.\n */\n\n#include \"ch1-06y.h\"    /* token codes from the parser */\n\n#define LOOKUP 0 /* default - not a defined word type. */\n\nint state; \n\n%}\n\n%%\n\n\\n  { state = LOOKUP; }\n\n\\.\\n    {   state = LOOKUP;\n        return 0; /* end of sentence */\n    }\n\n^verb   { state = VERB; }\n^adj    { state = ADJECTIVE; }\n^adv    { state = ADVERB; }\n^noun   { state = NOUN; }\n^prep   { state = PREPOSITION; }\n^pron   { state = PRONOUN; }\n^conj   { state = CONJUNCTION; }\n\n[a-zA-Z]+ { \n         if(state != LOOKUP) {\n            add_word(state, yytext);\n         } else {\n        switch(lookup_word(yytext)) {\n        case VERB:\n          return(VERB);\n        case ADJECTIVE:\n          return(ADJECTIVE);\n        case ADVERB:\n          return(ADVERB);\n        case NOUN:\n          return(NOUN);\n        case PREPOSITION:\n          return(PREPOSITION);\n        case PRONOUN:\n          return(PRONOUN);\n        case CONJUNCTION:\n          return(CONJUNCTION);\n        default:\n          printf(\"%s:  don't recognize\\n\", yytext);\n          /* don't return, just ignore it */\n        }\n            }\n          }\n\n.   ; \n\n%%\n/* define a linked list of words and types */\nstruct word {\n    char *word_name;\n    int word_type;\n    struct word *next;\n};\n\nstruct word *word_list; /* first element in word list */\n\nextern void *malloc();\n\nint\nadd_word(int type, char *word)\n{\n    struct word *wp;    \n\n    if(lookup_word(word) != LOOKUP) {\n        printf(\"!!! warning: word %s already defined \\n\", word);\n        return 0;\n    }\n\n    /* word not there, allocate a new entry and link it on the list */\n\n    wp = (struct word *) malloc(sizeof(struct word));\n\n    wp-&gt;next = word_list;\n\n    /* have to copy the word itself as well */\n\n    wp-&gt;word_name = (char *) malloc(strlen(word)+1);\n    strcpy(wp-&gt;word_name, word);\n    wp-&gt;word_type = type;\n    word_list = wp;\n    return 1;   /* it worked */\n}\n\nint\nlookup_word(char *word)\n{\n    struct word *wp = word_list;\n\n    /* search down the list looking for the word */\n    for(; wp; wp = wp-&gt;next) {\n        if(strcmp(wp-&gt;word_name, word) == 0)\n            return wp-&gt;word_type;\n    }\n\n    return LOOKUP;  /* not found */\n}\n</code></pre>\n\n<p><strong>header file</strong></p>\n\n<pre><code># define NOUN 257\n# define PRONOUN 258\n# define VERB 259\n# define ADVERB 260\n# define ADJECTIVE 261\n# define PREPOSITION 262\n# define CONJUNCTION 263\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494442423, "post_id": 43900578, "comment_id": 74835041, "body": "This has to be the <i>first</i> time someone has posted a video to demonstrate the error. So congrats on that!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494442493, "post_id": 43900578, "comment_id": 74835088, "body": "<code>for (int j = i; array[j] &lt;= array[j - 1]; j--) </code> This is the culprit."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494442495, "post_id": 43900578, "comment_id": 74835089, "body": "When you decrease <code>j</code>, you must take care that <code>j - 1</code> cannot drop below 0."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494442791, "post_id": 43900693, "comment_id": 74835278, "body": "Since <code>array[j - 1]</code> is accessed, the condition needs to be <code>j &gt; 0</code>."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 1, "last_activity_date": 1494442836, "last_edit_date": 1494442836, "creation_date": 1494442680, "answer_id": 43900693, "question_id": 43900578, "link": "https://stackoverflow.com/questions/43900578/variable-arbitrary-changing-value/43900693#43900693", "title": "variable arbitrary changing value", "body": "<p>In this line -</p>\n\n<pre><code>for (int j = i; array[j] &lt;= array[j - 1]; j--)  \n</code></pre>\n\n<p>j can potentially go less than 0, which would cause an out of bound access leading to Undefined Behavior.</p>\n\n<p>I don't want to make sense out of UB but what happens is you end up changing other values on the stack like <code>arraySize</code>.</p>\n\n<p>One simple fix for this would be -</p>\n\n<pre><code>for (int j = i; j &gt; 0 &amp;&amp; array[j] &lt;= array[j - 1] ; j--) //Short circuiting prevents UB here. \n</code></pre>\n\n<p>instead of the line mentioned above.</p>\n\n<p>Now whether this condition is appropriate for your logic, that is for you to figure out.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1494442697, "creation_date": 1494442697, "answer_id": 43900697, "question_id": 43900578, "link": "https://stackoverflow.com/questions/43900578/variable-arbitrary-changing-value/43900697#43900697", "title": "variable arbitrary changing value", "body": "<p>This loop:</p>\n\n<pre><code>for (int j = i; array[j] &lt;= array[j - 1]; j--) {\n</code></pre>\n\n<p>can run off the beginning of the array (<code>j</code> becomes less than 0), resulting in undefined behavior.  Evaluating the loop termination condition causes UB all by itself even when <code>j</code> is exactly zero, but the most likely culprit for the change to another variable's value is the out-of-bounds modifications to the array performed in the loop body.</p>\n\n<p>You need to ensure that your sort stops at the beginning of the array.</p>\n"}], "owner": {"reputation": 3, "user_id": 7114921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf93733ec2f56fe8cd7170c4c82a766?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Novaes", "link": "https://stackoverflow.com/users/7114921/daniel-novaes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 43900693, "answer_count": 2, "score": 0, "last_activity_date": 1494442836, "creation_date": 1494442319, "question_id": 43900578, "link": "https://stackoverflow.com/questions/43900578/variable-arbitrary-changing-value", "title": "variable arbitrary changing value", "body": "<p>so, today I was implementing a insertion sort algorithm in C and I found myself with <a href=\"https://youtu.be/ig9FfiXCD3s\" rel=\"nofollow noreferrer\">THIS (video)</a> strange bug.</p>\n\n<p>the integer variable arraySize simply change it's own value during a loop, and it doesn't even occur everytime, it's completely random and the ONLY time I change the arraySize value is at the start of the code, when I initialize with the value 10.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n\nint main () {\n  int y = 0, arraySize = 10, array[1000];\n  srand(time(NULL));\n  for (int i = 0; i &lt; arraySize; i++) {\n    array[i] = rand() % 1000;\n  }\n  for (int i = 1; i &lt; arraySize; i++) {\n    for (int j = i; array[j] &lt;= array[j - 1]; j--) {\n      y = array[j - 1];\n      array[j - 1] = array[j];\n      array[j] = y;\n    }\n    printf(\"for externo i = %d, arraySize = %d \\n\", i, arraySize);\n  }\n  for (int i = 0; i &lt; arraySize; i++) {\n    printf(\"%d. i = %d \", array[i], i);\n  }\n  printf(\"\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>Example of outputs this exact program gave-me after being compiled with a simple \"gcc insertionSort.c\"</p>\n\n<pre><code>for externo i = 1, arraySize = 10 \nfor externo i = 2, arraySize = 10 \nfor externo i = 3, arraySize = 10 \nfor externo i = 4, arraySize = 5 \n10. i = 0 22. i = 1 233. i = 2 343. i = 3 592. i = 4\n\nfor externo i = 1, arraySize = 10 \nfor externo i = 2, arraySize = 10 \nfor externo i = 3, arraySize = 10 \nfor externo i = 4, arraySize = 10 \nfor externo i = 5, arraySize = 10 \nfor externo i = 6, arraySize = 10 \nfor externo i = 7, arraySize = 10 \nfor externo i = 8, arraySize = 10 \nfor externo i = 9, arraySize = 10 \n54. i = 0 239. i = 1 312. i = 2 313. i = 3 438. i = 4 465. i = 5 827. i = 6 839. i = 7 874. i = 8 935. i = 9\n\nfor externo i = 1, arraySize = 10 \nfor externo i = 2, arraySize = 10 \nfor externo i = 3, arraySize = 10 \nfor externo i = 4, arraySize = 10 \nfor externo i = 5, arraySize = 10 \nfor externo i = 6, arraySize = 10 \nfor externo i = 7, arraySize = 10 \nfor externo i = 8, arraySize = 10 \nfor externo i = 9, arraySize = 6 \n10. i = 0 58. i = 1 135. i = 2 316. i = 3 411. i = 4 442. i = 5\n</code></pre>\n\n<p>I'm using xubuntu 16.04 and those are my gcc configs:</p>\n\n<p>Using built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1~16.04.4' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4)</p>\n"}, {"tags": ["c", "linux", "macos", "gcc", "compiler-errors"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494442197, "post_id": 43900484, "comment_id": 74834894, "body": "where <code>printSummary</code> is defined?"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1494442275, "post_id": 43900484, "comment_id": 74834942, "body": "How about cachelab.h as well?"}, {"owner": {"reputation": 11, "user_id": 7993536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d70c06d3c6d5c78146ad25fe75f1e76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Casey", "link": "https://stackoverflow.com/users/7993536/jeff-casey"}, "edited": false, "score": 0, "creation_date": 1494442803, "post_id": 43900484, "comment_id": 74835283, "body": "edit: included cachelab.c, which includes printSummary"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1494442963, "post_id": 43900484, "comment_id": 74835380, "body": "The OSX gcc is a different compiler, clang. OSX uses <code>gcc</code> as the command name to cater to existing build scripts.  clang is designed to be as compatible as possible with gcc, but they&#39;re different code bases."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494443020, "post_id": 43900484, "comment_id": 74835411, "body": "Because on your OSX, <code>gcc</code> is not <code>gcc</code> but actually <code>clang</code>. Different compilers have different meaning for the same optimization flags like -O1, and -O2. Even the defaults are different for both the compilers."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494443072, "post_id": 43900484, "comment_id": 74835442, "body": "So to point out the reason, both compilers are running different optimizations and hence their performance overheads are different."}, {"owner": {"reputation": 11, "user_id": 7993536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d70c06d3c6d5c78146ad25fe75f1e76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Casey", "link": "https://stackoverflow.com/users/7993536/jeff-casey"}, "edited": false, "score": 0, "creation_date": 1494443078, "post_id": 43900484, "comment_id": 74835451, "body": "Got it. Thanks! Any recommendations on how to fix this issue...? I&#39;d assume it has something to do with the while loop in simulate, but I can&#39;t figure it out."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494443844, "post_id": 43900484, "comment_id": 74835874, "body": "@JeffCasey run both the compilers on their respective highest level of optimization. Like -O3 for clang. Please check for gcc with gcc --help (on Ubuntu Linux)."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 3106531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a4a089a86f815752131f0a469d37c5?s=128&d=identicon&r=PG&f=1", "display_name": "fernan", "link": "https://stackoverflow.com/users/3106531/fernan"}, "is_accepted": false, "score": 6, "last_activity_date": 1494445258, "last_edit_date": 1494445258, "creation_date": 1494443735, "answer_id": 43900987, "question_id": 43900484, "link": "https://stackoverflow.com/questions/43900484/difference-in-behavior-between-clang-and-gcc/43900987#43900987", "title": "Difference in behavior between clang and gcc?", "body": "<p>You forgot to initialize the counters and flags so they start at undefined values. The following lines:</p>\n\n<pre><code>int hitCount, missCount, evictionCount;\nint s, E, b;\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>int hitCount = 0, missCount = 0, evictionCount = 0;\nint s = 0, E = 0, b = 0;\n</code></pre>\n\n<p>It just happens that the initial values happen to be lower on the mac so you're not getting correct results on the mac either (at least not guaranteed since the initial value is undefined).</p>\n"}], "owner": {"reputation": 11, "user_id": 7993536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d70c06d3c6d5c78146ad25fe75f1e76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Casey", "link": "https://stackoverflow.com/users/7993536/jeff-casey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 2, "answer_count": 1, "score": -1, "last_activity_date": 1494445258, "creation_date": 1494441965, "last_edit_date": 1494444491, "question_id": 43900484, "link": "https://stackoverflow.com/questions/43900484/difference-in-behavior-between-clang-and-gcc", "title": "Difference in behavior between clang and gcc?", "body": "<p>I'm writing a C function to simulate a cache given an address trace. The function works as expected when compiled on my mac using gcc (really clang). <code>gcc --version</code> on my mac returns this:</p>\n\n<pre><code>Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.1.0 (clang-802.0.42)\n</code></pre>\n\n<p>When I compile the same program on linux using gcc, the returns are way off, and eC &amp; hC in my program (cache eviction counter and hit counter) are in the hundreds of thousands, when they should be below 10. When typing gcc --version on the linux machine, it returns this:</p>\n\n<p>gcc (Ubuntu 4.9.3-8ubuntu2~14.04) 4.9.3</p>\n\n<p>Here is the program:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;math.h&gt;\n    #include &lt;limits.h&gt;\n    #include &lt;getopt.h&gt;\n    #include \"cachelab.h\"\n\n    typedef struct{\n        int v;\n        int t;\n        int LRU;\n    } block;\n\n    typedef struct{\n        block *blocks;\n    } set;\n\n    typedef struct{\n        set *sets;\n    } cache;\n\n    void simulate(int s, int E, int b, char* file, int* hC, int* mC, int* eC)\n    {\n        int numSets = (1 &lt;&lt; s);\n        char operation;\n        int address;\n        int size;\n        int curTag;\n        int curSet;\n        int maxLRU = 0;\n        int curLRU = 0;\n        int check = 0;\n\n    cache c;\n    set *sets = malloc(sizeof(set) * numSets);\n    c.sets = sets;\n\n    int i = 0;\n    while(i &lt; numSets)\n    {\n        c.sets[i].blocks = malloc(sizeof(block) * E);\n        for (int j = 0; j &lt; E; j++)\n        {\n            c.sets[i].blocks[j].v = 0;\n            c.sets[i].blocks[j].t = INT_MIN;\n            c.sets[i].blocks[j].LRU = 0;\n        }\n\n        i++;\n    }\n\n    FILE *f = fopen(file, \"r\");\n    while(fscanf(f,\" %c %x,%d\", &amp;operation, &amp;address, &amp;size) != EOF)\n    {\n        check = 0;\n        curTag = ((unsigned int) address) &gt;&gt; (s+b);\n        curSet = (address &gt;&gt; b) &amp; ((1 &lt;&lt; s) - 1);\n        for (int i = 0; i &lt; E; i++)\n        {\n            c.sets[curSet].blocks[i].LRU++;\n            if(c.sets[curSet].blocks[i].LRU &gt;= maxLRU)\n            {\n                maxLRU = c.sets[curSet].blocks[i].LRU;\n                curLRU = i;\n            }\n            if(curTag == c.sets[curSet].blocks[i].t)\n            {\n                *hC = *hC + 1;\n                if (operation == 'M')\n                {\n                    *hC = *hC + 1;\n                }\n                c.sets[curSet].blocks[i].LRU = 0;\n                check = 1;\n            }\n        }\n        if(check == 0)\n        {\n            for(int i = 0; i &lt; E; i++)\n            {\n                if(c.sets[curSet].blocks[i].v == 0)\n                {\n                    *mC = *mC + 1;\n                    if (operation == 'M')\n                    {\n                        *hC = *hC + 1;\n                    }\n                    c.sets[curSet].blocks[i].v = 1;\n                    c.sets[curSet].blocks[i].LRU = 0;\n                    c.sets[curSet].blocks[i].t = curTag;\n                    check = 1;\n                    break;\n                }\n            }\n        }\n        if(check == 0)\n        {\n            *eC = *eC + 1;\n            *mC = *mC + 1;\n            if (operation == 'M')\n            {\n                *hC = *hC + 1;\n            }\n            c.sets[curSet].blocks[curLRU].t = curTag;\n            c.sets[curSet].blocks[curLRU].v = 1;\n            c.sets[curSet].blocks[curLRU].LRU = 0;\n        }\n    }\n    }\n\n    int main(int argc, char** argv)\n    {\n    int hitCount, missCount, evictionCount;\n\n    int s, E, b;\n    char *file;\n    char opt;\n    while((opt = getopt(argc,argv,\"v:h:s:E:b:t:\")) != -1)\n    {\n        switch(opt){\n            case 'v':\n                break;\n            case 'h':\n                break;\n            case 's':\n                s = atoi(optarg);\n                break;\n            case 'E':\n                E = atoi(optarg);\n                break;\n            case 'b':\n                b = atoi(optarg);\n                break;\n            case 't':\n                file = optarg;\n                break;\n            default:\n                exit(1);\n        }\n    }\n    simulate(s, E, b, file, &amp;hitCount, &amp;missCount, &amp;evictionCount);\n\n    printSummary(hitCount, missCount, evictionCount);\n    return 0;\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I understand that this is due to a difference between clang and gcc. Does anyone have any information about how I can go about fixing this discrepancy?</p>\n\n<p>Here is cachelab.c:</p>\n\n<pre><code>/*\n * cachelab.c - Cache Lab helper functions\n */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include \"cachelab.h\"\n#include &lt;time.h&gt;\n\ntrans_func_t func_list[MAX_TRANS_FUNCS];\nint func_counter = 0;\n\n/*\n * printSummary - Summarize the cache simulation statistics. Student cache simulators\n *                must call this function in order to be properly autograded.\n */\nvoid printSummary(int hits, int misses, int evictions)\n{\n    printf(\"hits:%d misses:%d evictions:%d\\n\", hits, misses, evictions);\n    FILE* output_fp = fopen(\".csim_results\", \"w\");\n    assert(output_fp);\n    fprintf(output_fp, \"%d %d %d\\n\", hits, misses, evictions);\n    fclose(output_fp);\n}\n\n/*\n * initMatrix - Initialize the given matrix\n */\nvoid initMatrix(int M, int N, int A[N][M], int B[M][N])\n{\n    int i, j;\n    srand(time(NULL));\n    for (i = 0; i &lt; N; i++){\n        for (j = 0; j &lt; M; j++){\n            // A[i][j] = i+j;  /* The matrix created this way is symmetric */\n            A[i][j]=rand();\n            B[j][i]=rand();\n        }\n    }\n}\n\nvoid randMatrix(int M, int N, int A[N][M]) {\n    int i, j;\n    srand(time(NULL));\n    for (i = 0; i &lt; N; i++){\n        for (j = 0; j &lt; M; j++){\n            // A[i][j] = i+j;  /* The matrix created this way is symmetric */\n            A[i][j]=rand();\n        }\n    }\n}\n\n/*\n * correctTrans - baseline transpose function used to evaluate correctness\n */\nvoid correctTrans(int M, int N, int A[N][M], int B[M][N])\n{\n    int i, j, tmp;\n    for (i = 0; i &lt; N; i++){\n        for (j = 0; j &lt; M; j++){\n            tmp = A[i][j];\n            B[j][i] = tmp;\n        }\n    }\n}\n\n\n\n/*\n * registerTransFunction - Add the given trans function into your list\n *     of functions to be tested\n */\nvoid registerTransFunction(void (*trans)(int M, int N, int[N][M], int[M][N]),\n                           char* desc)\n{\n    func_list[func_counter].func_ptr = trans;\n    func_list[func_counter].description = desc;\n    func_list[func_counter].correct = 0;\n    func_list[func_counter].num_hits = 0;\n    func_list[func_counter].num_misses = 0;\n    func_list[func_counter].num_evictions =0;\n    func_counter++;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1494441663, "post_id": 43900347, "comment_id": 74834567, "body": "<code>int i=1;   A=malloc(i*sizeof(int));[...]   scanf(&quot;%d&quot;,&amp;A[i]);</code> Out-of-bounds access, undefined behavior."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1494441721, "post_id": 43900347, "comment_id": 74834602, "body": "and the <code>free</code> loop is wrong. There&#39;s only <code>free(A)</code> to perform. Not to mention the print loop which should start at 0 and stop at i-1"}, {"owner": {"reputation": 1, "user_id": 7949230, "user_type": "registered", "profile_image": "https://graph.facebook.com/1984032141820271/picture?type=large", "display_name": "L&#226;m Ch&#237; Th&#224;nh", "link": "https://stackoverflow.com/users/7949230/l%c3%a2m-ch%c3%ad-th%c3%a0nh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494486475, "post_id": 43900347, "comment_id": 74850633, "body": "@EOF thank you I can fix it now"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1494521191, "post_id": 43900347, "comment_id": 74875816, "body": "the posted code does not compile!  it is missing the needed <code>#include</code> statements.  Do you expect us to guess as to which header files your code actually uses?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1494521279, "post_id": 43900347, "comment_id": 74875872, "body": "there are only 2 valid signatures for the <code>main()</code> function.  Both of those signatures have a return type of <code>int</code>.  Suggest using the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494521457, "post_id": 43900347, "comment_id": 74875973, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494521637, "post_id": 43900347, "comment_id": 74876081, "body": "when calling any of the heap memory allocation functions (malloc, calloc, realloc)  1) always check (!=NULL) the returned value to assure the operation was successful.  2) when calling <code>realloc()</code>, always save the returned value into a temporary variable and check that variable for !=NULL and if not NULL, then assign to the target variable.  Otherwise, when <code>realloc()</code> fails the original heap memory pointer is overlayed, resulting in a memory leak."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494522389, "post_id": 43900347, "comment_id": 74876485, "body": "this statement: <code>while (i&gt;=1)</code> has absolutely no effect (unless more than 2gig entries are typed by the user.  Suggest replacing with: <code>int temp; while( 1 == scanf( &quot;%d&quot;, &amp;temp ) ) {  tempRealloc = realloc( A, (i+1) * sizeof(int) ); if( !tempRealloc() ) { handle error } else { A[i] = temp; i++; } if( !temp ) break;</code>  Note: a lot of the other code can then be eliminated"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494522540, "post_id": 43900347, "comment_id": 74876561, "body": "Note: in C, array indexes start with 0 and continue to (length of array -1)  so the posted code has some logic errors regarding where in the array the new value is placed.  infact new values are being placed 1 beyond the end of the array.  This results in undefined behavior and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494522984, "post_id": 43900347, "comment_id": 74876806, "body": "when reaching this loop: <code>for (j = 1; j &lt;= i; j++) {         free(A[j]);     }</code> there is really only one allocation for the array, so that loop needs to be replaced with <code>free[A];</code>  Calling <code>free()</code> with the contents of the elements in the array <code>A[]</code> is undefined behavior as those contents are from the user, not from calls to malloc or realloc.  This can/will result in a seg fault event."}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494524268, "post_id": 43922085, "comment_id": 74877525, "body": "Note: if you really want to NOT use element 0 of the array, just modify the &#39;i&#39; variable accordingly.  However, in general, the <code>A[0]</code> should be used just like any other element of the array"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1494524031, "last_edit_date": 1494524031, "creation_date": 1494523692, "answer_id": 43922085, "question_id": 43900347, "link": "https://stackoverflow.com/questions/43900347/the-even-places-in-my-array-automatically-turn-into-0-can-you-fix-my-code/43922085#43922085", "title": "The even places in my array automatically turn into 0. Can you fix my code?", "body": "<p>the following proposed code</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>corrects all the problems listed in the comments to the OPs question</li>\n<li>performs the desired functionality</li>\n</ol>\n\n<p>and now the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // scanf(), printf(), perror()\n#include &lt;stdlib.h&gt;  // realloc(), exit(), EXIT_FAILURE\n\n\nint main( void )\n{\n    int *A = NULL;\n    int temp;\n    size_t i = 0;\n\n    printf(\"Enter the element A[%lu] = \", i+1);\n    while( 1 == scanf(\"%d\",&amp;temp) )\n    {\n        int* tempRealloc = realloc(A, (i+1) * sizeof(int));\n        if( !tempRealloc )\n        {\n            perror( \"realloc failed\" );\n            free( A ); // cleanup\n            exit( EXIT_FAILURE );\n        }\n\n        // implied else, realloc successful\n\n        A = tempRealloc;\n\n        A[i] = temp;\n        i++;\n\n        if( !temp )  // 0 entered by user\n            break;\n\n        printf(\"Enter the element A[%lu] = \",i+1);\n    }\n\n    for (size_t j = 0 ; j &lt; i; j++)\n    {\n        printf(\"\\t%d\", A[j]);\n    }\n\n    free( A );\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7949230, "user_type": "registered", "profile_image": "https://graph.facebook.com/1984032141820271/picture?type=large", "display_name": "L&#226;m Ch&#237; Th&#224;nh", "link": "https://stackoverflow.com/users/7949230/l%c3%a2m-ch%c3%ad-th%c3%a0nh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494524031, "creation_date": 1494441501, "last_edit_date": 1494469086, "question_id": 43900347, "link": "https://stackoverflow.com/questions/43900347/the-even-places-in-my-array-automatically-turn-into-0-can-you-fix-my-code", "title": "The even places in my array automatically turn into 0. Can you fix my code?", "body": "<p>I have written this program which requires you to input values of elements in a 1D array from element number 1, it will stop when you input the value of 0. </p>\n\n<pre><code>void main() {\n    int *A;\n    int n, j, B;\n    int i = 1;\n\n    A = malloc(i * sizeof(int));\n    printf(\"Enter the element A[%d] = \", i);\n    scanf(\"%d\",&amp;A[i]);\n    while (i&gt;=1) {\n        if (A[i] != 0) {\n            i = i + 1;\n            A = realloc(A, i * sizeof(int));\n            printf(\"Enter the element A[%d] = \",i);\n            scanf(\"%d\",&amp;A[i]);\n        } else {\n            break;\n        }\n    }\n\n    for (j = 1 ; j &lt;= i; j++) {\n        printf(\"\\t%d\", A[j]);\n    }\n\n    for (j = 1; j &lt;= i; j++) {\n        free(A[j]);\n    }\n}\n</code></pre>\n\n<p>Here's the result: <a href=\"https://i.stack.imgur.com/9V9PZ.png\" rel=\"nofollow noreferrer\">image 1</a>, <a href=\"https://i.stack.imgur.com/WDEiR.png\" rel=\"nofollow noreferrer\">image 2</a>.</p>\n\n<p>As you can see, even places are replaced with 0. I cant figure out why and how to fix this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494441311, "post_id": 43900246, "comment_id": 74834352, "body": "What? You have your code, why you are not happy with it? You want all of them gone or what?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494441313, "post_id": 43900246, "comment_id": 74834355, "body": "Add a flag indicating that it was already replaced once. Really, simple logic."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494441489, "post_id": 43900246, "comment_id": 74834461, "body": "@gsamaras The OP wants <code>s&#47;\\s+&#47;$&#47;</code>"}, {"owner": {"reputation": 19, "user_id": 6629598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f420f04a8afec04e7cb83f67df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejMakulec", "link": "https://stackoverflow.com/users/6629598/maciejmakulec"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494441536, "post_id": 43900246, "comment_id": 74834493, "body": "@gsamaras Yes, I want all of them gone :P Problem with my code happens when i make more than one space, and I want my words or characters (nevermind, just input) to be one under another :P"}, {"owner": {"reputation": 19, "user_id": 6629598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f420f04a8afec04e7cb83f67df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejMakulec", "link": "https://stackoverflow.com/users/6629598/maciejmakulec"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494441588, "post_id": 43900246, "comment_id": 74834530, "body": "@EugeneSh. Maybe simple, maybe not. Started not so long ago, still have to learn ;P"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1494442428, "post_id": 43900246, "comment_id": 74835042, "body": "Try a state machine with three states: read a space; read something other than a space; read EOF. ..."}, {"owner": {"reputation": 247, "user_id": 7976491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e332cb2aea0faa8ea222642e3e169504?s=128&d=identicon&r=PG&f=1", "display_name": "AppWriter", "link": "https://stackoverflow.com/users/7976491/appwriter"}, "edited": false, "score": 0, "creation_date": 1494445693, "post_id": 43900246, "comment_id": 74836941, "body": "Look at the edited answer I posted below (the one with 7 lines of code)."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 2390187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2ee07abb988355b505be207104122227?s=128&d=identicon&r=PG", "display_name": "Andrew Michael Felsher", "link": "https://stackoverflow.com/users/2390187/andrew-michael-felsher"}, "is_accepted": false, "score": -1, "last_activity_date": 1494442845, "creation_date": 1494442845, "answer_id": 43900734, "question_id": 43900246, "link": "https://stackoverflow.com/questions/43900246/replacing-one-and-more-spaces-with-exactly-one-new-line/43900734#43900734", "title": "Replacing one and more spaces, with exactly ONE new line.", "body": "<p>Perhaps this will work for you, though the newline won't show up until the input ends or the first non-space character is entered.</p>\n\n<pre><code>int input = 0;\nint previous = 0;\n\nwhile((input = getchar()) != EOF)\n{\n    if (input != ' ')\n    {\n        if (previous == ' ')\n        {\n            putchar('\\n');\n        }\n        putchar(input);\n    }\n\n    previous = input;\n}\n\nif (input == ' ')\n{\n    putchar('\\n');\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1494444843, "post_id": 43901262, "comment_id": 74836479, "body": "Stop deleting and reposting your answers!  If you want to fix your code, edit it in place, or test it before posting.  You can test your code here: <a href=\"http://ideone.com/\" rel=\"nofollow noreferrer\">ideone.com</a>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1494444878, "post_id": 43901262, "comment_id": 74836497, "body": "Still not right: input <code>&quot;one   two&quot;</code> produces <code>&quot;onet\\nwo&quot;</code>."}], "tags": [], "owner": {"reputation": 247, "user_id": 7976491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e332cb2aea0faa8ea222642e3e169504?s=128&d=identicon&r=PG&f=1", "display_name": "AppWriter", "link": "https://stackoverflow.com/users/7976491/appwriter"}, "is_accepted": false, "score": 0, "last_activity_date": 1494445527, "last_edit_date": 1494445527, "creation_date": 1494444742, "answer_id": 43901262, "question_id": 43900246, "link": "https://stackoverflow.com/questions/43900246/replacing-one-and-more-spaces-with-exactly-one-new-line/43901262#43901262", "title": "Replacing one and more spaces, with exactly ONE new line.", "body": "<p>Use this instead of the if statement:</p>\n\n<pre><code>if(input == ' ') {\n    while (input == ' ')\n    {\n        input = getchar();\n    }\n    putchar('\\n');\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "reply_to_user": {"reputation": 19, "user_id": 6629598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f420f04a8afec04e7cb83f67df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejMakulec", "link": "https://stackoverflow.com/users/6629598/maciejmakulec"}, "edited": false, "score": 0, "creation_date": 1494450623, "post_id": 43901401, "comment_id": 74839418, "body": "@MaciejMakulec What is it that you don&#39;t understand? I&#39;d gladly explain it to you"}, {"owner": {"reputation": 19, "user_id": 6629598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f420f04a8afec04e7cb83f67df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejMakulec", "link": "https://stackoverflow.com/users/6629598/maciejmakulec"}, "edited": false, "score": 0, "creation_date": 1494481140, "post_id": 43901401, "comment_id": 74847820, "body": "I can&#39;t get along with this if else logic :P"}], "tags": [], "owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "is_accepted": true, "score": 3, "last_activity_date": 1494446506, "last_edit_date": 1494446506, "creation_date": 1494445235, "answer_id": 43901401, "question_id": 43900246, "link": "https://stackoverflow.com/questions/43900246/replacing-one-and-more-spaces-with-exactly-one-new-line/43901401#43901401", "title": "Replacing one and more spaces, with exactly ONE new line.", "body": "<pre><code>int input, last_was_space = 0;    \nwhile((input = getchar()) != EOF)\n{\n    if(input == ' ')\n    {\n        last_was_space = 1;\n    }\n    else\n    {\n        if(last_was_space)\n        {\n            last_was_space = 0;\n            putchar('\\n');\n        }\n\n        putchar(input);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6629598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f420f04a8afec04e7cb83f67df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejMakulec", "link": "https://stackoverflow.com/users/6629598/maciejmakulec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 43901401, "answer_count": 3, "score": 2, "last_activity_date": 1494446506, "creation_date": 1494441181, "question_id": 43900246, "link": "https://stackoverflow.com/questions/43900246/replacing-one-and-more-spaces-with-exactly-one-new-line", "title": "Replacing one and more spaces, with exactly ONE new line.", "body": "<p>I'm exercise code. The thing is, to replace space from input, with a new line. </p>\n\n<p>I wrote something like this: </p>\n\n<pre><code>int input;\n\nwhile((input = getchar()) != EOF)\n{\n    if (input == ' ')\n    {\n        input = '\\n';\n\n    }\n\n    putchar(input);\n\n}\n</code></pre>\n\n<p>But I don't know how to make it change more than one space into exactly one new line. I had an idea to make something like buffer variable (ex. int buffer) and store space in there, and then check if after input, previous character was space, but I don't have any idea how to make it work :P </p>\n"}, {"tags": ["c", "optimization", "x86", "bit-manipulation", "x86-64"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494441044, "post_id": 43900161, "comment_id": 74834186, "body": "Can you clarify - what&#39;s the absolute-value difference of a single value? (I&#39;m only aware of a difference between <i>two</i> values.)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494441063, "post_id": 43900161, "comment_id": 74834200, "body": "Also it looks like a &quot;code for me&quot; request."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494441172, "post_id": 43900161, "comment_id": 74834272, "body": "I suspect the nastiest part will be the 5-bit number that straddles the two <code>uint64_t</code>s."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494441259, "post_id": 43900161, "comment_id": 74834320, "body": "@EOF maybe a way to get around that would be to place the 18 free bits towards the end of each <code>uint64</code>s instead of being bunched up together."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494441339, "post_id": 43900161, "comment_id": 74834377, "body": "@AjayBrahmakshatriya: Yes, making it 11 5-bit numbers in one <code>uint64_t</code> and using two of those is obviously more sane, and probably more reusable too."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1494441447, "post_id": 43900161, "comment_id": 74834431, "body": "Show your attempt (some C code), and where it fell short."}, {"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494441650, "post_id": 43900161, "comment_id": 74834563, "body": "I can divide it 55/55 instead of 64/46 to avoid the straddling.  I&#39;m not sure if there are some shuffling operations which might be useful here.  The real struggle is I&#39;m working with 5 bits instead of 4..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494441777, "post_id": 43900161, "comment_id": 74834635, "body": "@EOF I had a very nice scheme in mind but I am running short of 1 exactly 1 bit. I was thinking giving 6 bits to each and using 1 bit for carry. This way before substraction we can set all the carries and subtract. But that will require 66 bits. We have only 64 + 1 (actual carry) = 65 bits."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494442173, "post_id": 43900161, "comment_id": 74834879, "body": "The obvious next question is whether using 8-bit numbers instead will <i>actually</i> hurt performance in any way, considering that you&#39;ll easily find appropriate SIMD instructions for those on many architectures, potentially giving you <i>a lot</i> of speedup (AVX2 could do 32 of those at once, AVX512 with the appropriate extension 64, ARM NEON 16...)"}, {"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494442432, "post_id": 43900161, "comment_id": 74835046, "body": "I will have ~41 million of these 110-bit segments and I need to do this operation on every pair.  It seemed wasteful use 8 bit numbers, but really what I want is fast code here.  I&#39;m assuming there&#39;s an instruction for the absolute value difference of 2 8-bit numbers?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1494442459, "post_id": 43900161, "comment_id": 74835065, "body": "If you first do a swap such that the larger segments are in one operand, then do a conventional subtract, it will never overflow."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494442785, "post_id": 43900161, "comment_id": 74835271, "body": "@WillCunningham: Well, there&#39;s <code>[V]PSADBW</code> on x86, which gives you <i>the sum</i> of absolute differences between two vectors of <code>uint8_t</code>s. I don&#39;t think x86 has an instruction for the absolute differences themselves, but ARM NEON does: <code>VABD</code>. On x86 you might need two instructions, <code>[V]PSUBB</code> and <code>[V]PABSB</code>."}, {"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494443153, "post_id": 43900161, "comment_id": 74835490, "body": "Yes! VPSADBW is what I want.  After the operation I described I need to make sure the sum of all 5-bit numbers is less than 3, and based on the values the data can take this will do it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494443546, "post_id": 43900161, "comment_id": 74835710, "body": "A bit of caution: <code>VPSADBW</code> gives you two or four <i>partial</i> sums of the absolute differences (one from each run of 8 differences, depending on whether you use the 128-bit form or the 256-bit form), you&#39;ll probably need a few extra instructions at the end to get the total."}, {"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494443811, "post_id": 43900161, "comment_id": 74835863, "body": "Yes, I&#39;ll add a horizontal add."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494444029, "post_id": 43900161, "comment_id": 74836009, "body": "If you are substracting A from B is it guaranteed that all the 22 sets in A will smaller than those in B? If no, what should be the result? Negative number in 5 bits?"}, {"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494444150, "post_id": 43900161, "comment_id": 74836083, "body": "No, unfortunately not."}], "answers": [{"tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": false, "score": 2, "last_activity_date": 1494459193, "last_edit_date": 1494459193, "creation_date": 1494443997, "answer_id": 43901062, "question_id": 43900161, "link": "https://stackoverflow.com/questions/43900161/subtraction-over-ranges-of-bits/43901062#43901062", "title": "Subtraction over ranges of bits", "body": "<p>You can use <code>pdep</code> with a mask like <code>0b000111111000111111...</code> to scatter your 5-bit integers into 8-bit fields and use the byte-wise SIMD stuff discussed in the comments above.</p>\n\n<p>Alternately, you could expand them out into 6-bit fields, and with the extra bit set to <code>1</code>, and do the subtraction in 64-bit words, but then you'll need to find some <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#IntegerAbs\" rel=\"nofollow noreferrer\">bit-twiddly</a> way to do the \"abs\" part in a SWAR fashion. I suspect SIMD would be faster though.</p>\n\n<p>Keep in mind that <code>pdep</code> has terrible performance on AMD CPUs: 18 <em>times</em> worse throughput!</p>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "edited": false, "score": 0, "creation_date": 1494445402, "post_id": 43901326, "comment_id": 74836774, "body": "Thanks! This will be useful."}], "tags": [], "owner": {"reputation": 2976, "user_id": 2958774, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d2cf682c1744c34aecd5804b144b0d75?s=128&d=identicon&r=PG&f=1", "display_name": "Myria", "link": "https://stackoverflow.com/users/2958774/myria"}, "is_accepted": false, "score": 1, "last_activity_date": 1494445000, "creation_date": 1494445000, "answer_id": 43901326, "question_id": 43900161, "link": "https://stackoverflow.com/questions/43900161/subtraction-over-ranges-of-bits/43901326#43901326", "title": "Subtraction over ranges of bits", "body": "<p>I think that your best bet may be with the <code>pdep</code> (parallel bit deposit) instruction on recent x86 CPUs.  You can use this to quickly expand your 5-bit values into 8-bit values.  Once they are 8-bit values, there are many SSE instructions that you can do.</p>\n\n<p>The following takes a 128-bit value in <code>rdx:rax</code> and outputs <code>xmm1:xmm0</code> with these split as bytes.</p>\n\n<p>Here is some untested code that I think might work for you:</p>\n\n<pre><code>mov r8, abs 0x1F1F1F1F1F1F1F1F\n\npdep rcx, rax, r8\nmovq xmm0, rcx\n\nshrd rax, rdx, 16\nshr rax, 40 - 16\npdep rax, rax, r8\npinsrq xmm0, rax, 1\n\nshr rdx, 16\npdep rdx, rdx, r8\nmovq xmm1, rdx\n</code></pre>\n\n<p>The inverse transformation is similar, with <code>pext</code> instead of <code>pdep</code>.</p>\n"}], "owner": {"reputation": 171, "user_id": 3631538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kS4bVjRRaGQ/AAAAAAAAAAI/AAAAAAAAARs/sKhSHukSW9g/photo.jpg?sz=128", "display_name": "William J. Cunningham", "link": "https://stackoverflow.com/users/3631538/william-j-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494459193, "creation_date": 1494440941, "last_edit_date": 1494443372, "question_id": 43900161, "link": "https://stackoverflow.com/questions/43900161/subtraction-over-ranges-of-bits", "title": "Subtraction over ranges of bits", "body": "<p>I have a set of 22 5-bit values (0-31) which are packed together as 110 bits into two 64-bit unsigned integers (i.e. the last 18 bits are always zero).  I want to devise a function which will, for each segment of 5 bits, perform an absolute-value difference.</p>\n\n<p>I am aware of methods of subtraction using bitwise operators on a single number, but here I don't want to worry about overflow between the 5-bit segments.  I am looking for a solution using bitwise operators and/or x86 assembly operations, preferably without any loops.</p>\n\n<p><strong>EDIT:</strong> To clarify, I will have pairs of these 110 bits which I want to do this difference operation on.  Any suggestions are welcome.</p>\n\n<p><strong>SOLUTION:</strong> Thanks to @EOF for suggesting the VPSADBW instruction.  I'm going to use 8-bit numbers instead in favor of faster (and more readable) code.</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494440717, "post_id": 43899921, "comment_id": 74834008, "body": "<i>it doesn&#39;t seem to work</i>? Please be specific and also provide a minimal and verifiable code."}, {"owner": {"reputation": 161, "user_id": 5628095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g48qu.jpg?s=128&g=1", "display_name": "Fra", "link": "https://stackoverflow.com/users/5628095/fra"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494441691, "post_id": 43899921, "comment_id": 74834583, "body": "Yes, sorry, I edited the question"}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1494531828, "post_id": 43899921, "comment_id": 74881690, "body": "<code>if (i != j)</code> in the innermost loop should be <code>if ((n&#47;p) * my_rank + i != j)</code>, otherwise you are comparing a local index to a global one."}], "answers": [{"comments": [{"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494446010, "post_id": 43901050, "comment_id": 74837122, "body": "Your answer does not work for number of processors greater than two."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494447670, "post_id": 43901050, "comment_id": 74837945, "body": "I fixed the offset calculation."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494448175, "post_id": 43901050, "comment_id": 74838193, "body": "Can you please be specific? Obviously I do assume that <code>n</code> is divisible by <code>p</code> as all of the remaining code does."}, {"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1494449523, "post_id": 43901050, "comment_id": 74838877, "body": "Sorry, silly by me. Since my answer (coincidentally) worked even for odd number of processors, it made me to think that your one is wrong."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": false, "score": 1, "last_activity_date": 1494447629, "last_edit_date": 1494447629, "creation_date": 1494443957, "answer_id": 43901050, "question_id": 43899921, "link": "https://stackoverflow.com/questions/43899921/parallelize-double-sum-in-c-with-mpi/43901050#43901050", "title": "Parallelize double sum in C with MPI", "body": "<p>While the indexing in <code>local_x</code> is fine, the check for <code>i != j</code> is not. You must consider that <code>i</code> covers different parts of the global array, e.g. like that:</p>\n\n<pre><code>double Parallel_Sum(double (*OP)(double, double), double* local_x, double* y, int n, int p, int rank)\n{\n    double local_V = 0.0;\n    int i, j;\n\n    for (i = 0; i &lt; n / p; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            if ((i + rank * (n / p)) != j)\n                local_V += OP(local_x[i], y[j]);\n        }\n    }\n\n    return local_V;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 5628095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g48qu.jpg?s=128&g=1", "display_name": "Fra", "link": "https://stackoverflow.com/users/5628095/fra"}, "edited": false, "score": 0, "creation_date": 1494455478, "post_id": 43901597, "comment_id": 74841399, "body": "Thank you! Could you please expand a little on why this works?"}, {"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "reply_to_user": {"reputation": 161, "user_id": 5628095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g48qu.jpg?s=128&g=1", "display_name": "Fra", "link": "https://stackoverflow.com/users/5628095/fra"}, "edited": false, "score": 0, "creation_date": 1494456020, "post_id": 43901597, "comment_id": 74841558, "body": "Regarding for loop, suppose that you ran with single processor. Then <code>0&lt;i&lt;10</code>. But when <code>np=2</code>, for each processor, you had <code>0=&lt;i&lt;5</code> which was true only for the first processor. For the second processor it should be <code>5=&lt;i&lt;10</code>."}], "tags": [], "owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "is_accepted": true, "score": 2, "last_activity_date": 1494456070, "last_edit_date": 1494456070, "creation_date": 1494445932, "answer_id": 43901597, "question_id": 43899921, "link": "https://stackoverflow.com/questions/43899921/parallelize-double-sum-in-c-with-mpi/43901597#43901597", "title": "Parallelize double sum in C with MPI", "body": "<pre><code>double Parallel_Sum(double (*OP)(double,double),double* local_x,double* y,int n,int p, int rank){\n\n    double local_V = 0.0;\n    int i,j;\n\n    for(i = rank*n/p;i&lt;(rank+1)*n/p;i++){ // &lt;-- changed\n        for(j = 0;j&lt;n;j++){    \n\n            if(i != j)\n                local_V += OP(local_x[i-rank*n/p],y[j]); // &lt;-- changed                 \n        }\n    }\n\n    return local_V;    \n}\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 5628095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g48qu.jpg?s=128&g=1", "display_name": "Fra", "link": "https://stackoverflow.com/users/5628095/fra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 43901597, "answer_count": 2, "score": 2, "last_activity_date": 1494456070, "creation_date": 1494440117, "last_edit_date": 1494443752, "question_id": 43899921, "link": "https://stackoverflow.com/questions/43899921/parallelize-double-sum-in-c-with-mpi", "title": "Parallelize double sum in C with MPI", "body": "<p>I have this function Sum() in C that I would like to parallelize , using MPI :</p>\n\n<pre><code>double Sum(double* x, double* y, int n)\n{\n    double V = 0.0;\n    int i, j;\n\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            if (i != j)\n                V += F(x[i], y[j]);\n        }\n    }\n\n    return V;\n}\n</code></pre>\n\n<p>where <code>F(x[i],y[j])</code> is just a function that calculates something like the difference between the two elements or a similar binary operation.</p>\n\n<p>Now I thought that I could  separate the sum on the various processors <code>p</code>using <code>MPI_Scatter()</code> to generate a local vecotr and then use <code>MPI_Reduce()</code> to bing the local sums togheter, unfortunately it seems that I am unable to do it. This was my solution but it doesn't seem to work:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ndouble Parallel_Sum(double (*)(double, double), double*, double*, int, int);\ndouble F(double, double);\n\nint main(int argc, char** argv)\n{\n    int my_rank, p;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;p);\n    int n = 10;\n    double *y = calloc(n, sizeof(double)), *x = calloc(n, sizeof(double));\n    /*just for trial*/\n    y[5] = 1;\n    x[5] = 1;\n    double* local_x = calloc(n / p, sizeof(double));\n    MPI_Scatter(x, n / p, MPI_DOUBLE, local_x, n / p, MPI_DOUBLE, 0, MPI_COMM_WORLD);\n    double local_S, S = 0.0;\n    local_S = Parallel_Sum(F, local_x, y, n, p);\n\n    MPI_Reduce(&amp;local_S, &amp;S, 1, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);\n    if (my_rank == 0)\n    {\n        printf(\"%lf\\n\", S);\n    }\n\n    MPI_Finalize();\n    return 0;\n}\n\ndouble F(double a, double b)\n{\n    return a - b;\n}\ndouble Parallel_Sum(double (*OP)(double, double), double* local_x, double* y, int n, int p)\n{\n    double local_V = 0.0;\n    int i, j;\n\n    for (i = 0; i &lt; n / p; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            if (i != j)\n                local_V += OP(local_x[i], y[j]);\n        }\n    }\n\n    return local_V;\n}\n</code></pre>\n\n<p>In this example, the sum should be 0, since the vectors are all zero except for <code>y[5] = 1; x[5] = 1;</code> unfortunately for <code>p &gt; 1</code> it never is zero. What am I doing wrong?</p>\n"}, {"tags": ["c", "gcc", "assembly", "compiler-construction", "x86"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1494439574, "post_id": 43899750, "comment_id": 74833377, "body": "Try compiling with optimizations."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494439907, "post_id": 43899750, "comment_id": 74833577, "body": "@KerrekSB I compiled with -O3.   It removed the whole eax = 16 thing and uses xorl instead of movl to set eax to 0 at the end but it still does all the other stuff (including declaring a local variable).   Also I&#39;m curious why it does this anyway."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494440091, "post_id": 43899750, "comment_id": 74833679, "body": "What platform is this for? I can&#39;t reproduce this on Linux."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494440196, "post_id": 43899750, "comment_id": 74833733, "body": "@KerrekSB I&#39;m using Windows 8.1 with Intel Core i5."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494440888, "post_id": 43899750, "comment_id": 74834101, "body": "Checkout the Windows ABI, specifically register spilling and red zones."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1494443284, "post_id": 43899750, "comment_id": 74835565, "body": "@KerrekSB Thanks. So it&#39;s connected to the <code>call __alloca</code>? I still don&#39;t get why would it have the value of 16."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1494445641, "post_id": 43899750, "comment_id": 74836904, "body": "The call to <code>__alloca</code> allocates space on the stack. It&#39;s necessary when the amount being allocate on the stack could be over 4092 bytes. It&#39;s not necessary here. The call <code>___main</code> is for initialization that needs to be done before the start of the program. It shouldn&#39;t be necessary, as this initialization should have been done be <code>_main</code> was called. These are probably artifacts of the MinGW port of GCC which has issues like these."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1494486993, "post_id": 43899750, "comment_id": 74850953, "body": "@RossRidge OK, thanks!"}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1494531831, "post_id": 43899750, "comment_id": 74881691, "body": "My guess here is that you would get more information if your main function had arguments. I suspect that what you are seeing comes from a main template that will do processing for arguments."}], "answers": [{"comments": [{"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494442299, "post_id": 43900447, "comment_id": 74834966, "body": "OK, so the aligning is some kind of Windows convention? But I still don&#39;t get the eax and local variable part. Are they some kind of argument to __alloca? This doesn&#39;t make sense."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494442920, "post_id": 43900447, "comment_id": 74835349, "body": "But it doesn&#39;t hold the former value of <code>esp</code>, it holds the value of 16, doesn&#39;t it?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494443241, "post_id": 43900447, "comment_id": 74835538, "body": "Neo - <i>subl    $8, %esp</i> Here, the compiler appears to be reserving space on the stack. I am not sure why it reserves 8.  Again, likely directly related to alignment.  It probably will contain left most bits of esp after clearing the rightmost bits."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494443344, "post_id": 43900447, "comment_id": 74835604, "body": "So it&#39;s some kind of argument for <code>__alloca</code>?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494443861, "post_id": 43900447, "comment_id": 74835892, "body": "@Neo - <code>andl    $-16, %esp</code>  aligns esp to a 16 byte boundary.  ( from references <i><a href=\"http://stackoverflow.com/questions/23309863/why-does-gcc-produce-andl-16\">here</a></i> and <i><a href=\"http://stackoverflow.com/questions/2465232/what-does-subl-do-here\">here</a></i> )"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1494444633, "post_id": 43900447, "comment_id": 74836376, "body": "@Neo - the link (and an excerpt) edited into my answer above details some answers to similar questions you are asking. Hope it helps. ( I am very new to assembly. )"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1494445113, "last_edit_date": 1495541410, "creation_date": 1494441849, "answer_id": 43900447, "question_id": 43899750, "link": "https://stackoverflow.com/questions/43899750/what-is-the-purpose-of-these-lines-of-assembly-code/43900447#43900447", "title": "What is the purpose of these lines of assembly code?", "body": "<p>The <em>Intel Core i5</em> uses a 64 bit architecture.<br>\nAddressing questions 1, and partially 2, From <em><a href=\"https://msdn.microsoft.com/en-us/library/ms235286.aspx\" rel=\"nofollow noreferrer\">an Overview of x64 Calling Conventions</a></em>:</p>\n\n<blockquote>\n  <p>Alignment<br>\n  Most structures are aligned to their natural alignment. The primary\n  exceptions are the stack pointer and malloc or alloca memory, which\n  are aligned to 16 bytes in order to aid performance. Alignment above\n  16 bytes must be done manually, but since 16 bytes is a common\n  alignment size for XMM operations, this should work for most code. For\n  more information about structure layout and alignment see Types and\n  Storage. For information about the stack layout, see Stack Usage.</p>\n</blockquote>\n\n<p>regarding the part of your question: <em>...why it is done in such a complicated way</em>.  Only a guess, but from the quote, the complexity may be due in part to accommodate portability.</p>\n\n<p>Borrowing from <em><a href=\"https://stackoverflow.com/a/823452/645128\">this post</a></em>, (also having tags <code>gcc</code>, <code>compiler-construction</code> &amp;  <code>assembly</code> ) is a very good line by line explanation of some of the same code you are trying to interpret.  An excerpt:</p>\n\n<blockquote>\n  <p>In step 1 we save the pointer to the old stack frame on the stack by\n  calling, pushl %ebp. Since main is the first function called, I have\n  no idea what the previous value of %ebp points too.</p>\n  \n  <p>Step 2, We are entering a new stack frame because we are entering a\n  new function (main). Therefore, we must set a new stack frame base\n  pointer. We use the value in esp to be the beginning of our stack\n  frame.</p>\n  \n  <p>Step 3. Allocates 8 bytes of space on the stack. As we mentioned\n  above, the stack grows toward lower addresses thus, subtracting by 8,\n  moves the top of the stack by 8 bytes.<br>\n  ...  </p>\n</blockquote>\n\n<p>and regarding calling __alloca &amp; __main  </p>\n\n<blockquote>\n  <p>...<br>\n  Steps 12 and 13 setup the c library.</p>\n</blockquote>\n"}], "owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1494445113, "creation_date": 1494439517, "last_edit_date": 1494440850, "question_id": 43899750, "link": "https://stackoverflow.com/questions/43899750/what-is-the-purpose-of-these-lines-of-assembly-code", "title": "What is the purpose of these lines of assembly code?", "body": "<pre class=\"lang-none prettyprint-override\"><code>_main:\n; create stack frame\npushl   %ebp\nmovl    %esp, %ebp\n; save one local variable\nsubl    $8, %esp\n; zero four rightmost bits of esp\nandl    $-16, %esp\n; set eax to (0 + 15 + 15) / 2^4 * 2^4 = 16\nmovl    $0, %eax\naddl    $15, %eax\naddl    $15, %eax\nshrl    $4, %eax\nsall    $4, %eax\n; set local variable to eax (16)\nmovl    %eax, -4(%ebp)\nmovl    -4(%ebp), %eax\n; call allocation and main\ncall    __alloca\ncall    ___main\n; set eax to zero (return value)\nmovl    $0, %eax\n; fold stack frame and return to caller\nleave\nret\n</code></pre>\n\n<p>I compiled a <code>int main(){return 0;}</code> C code using <code>gcc -S return_zero.c</code> (on Windows) and this is what I got (I removed the assembler directives and added explanation comment as much as I understood. Correct me if I'm wrong, please.).  </p>\n\n<p>I don't understand three things:  </p>\n\n<ul>\n<li>Why does the compiler align esp to 16? </li>\n<li>Why is eax set to 16, why it is done in such a complicated way, and why is there a local variable also set to 16?  </li>\n<li>What are __alloca and ___main?</li>\n</ul>\n\n<p>I got somewhat unclear explanations to both #1 and #3 on the internet so I'd like if someone can answer more deeply and for #2 I haven't find any explanation so if someone can explain it'll be great.  </p>\n\n<p>If any further information is needed comment and I'll post it.  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["python", "c", "sockets", "unix", "endianness"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1494439453, "post_id": 43899649, "comment_id": 74833315, "body": "Endianness is not relevant for <code>char</code>s, and I suggest to use fixed size type ie: <code>uint32_t</code>instead of <code>size_t</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1494440114, "post_id": 43899752, "comment_id": 74833693, "body": "<code>s&#47;opposite order&#47;big endian order&#47;</code>"}], "tags": [], "owner": {"reputation": 6027, "user_id": 7738328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d6eb24cbea7d5c8d4bdab21dd3d232?s=128&d=identicon&r=PG&f=1", "display_name": "JohanL", "link": "https://stackoverflow.com/users/7738328/johanl"}, "is_accepted": false, "score": 2, "last_activity_date": 1494440406, "last_edit_date": 1494440406, "creation_date": 1494439521, "answer_id": 43899752, "question_id": 43899649, "link": "https://stackoverflow.com/questions/43899649/unix-sockets-between-c-and-python/43899752#43899752", "title": "Unix sockets between C and Python", "body": "<p>This is exactly endianness. The bits of a single byte are always in the same order, but the byte orders within a word might differ. And first you send a word consisting of 4 bytes, and they are received in opposite (i.e., big endian) order, but then in the second example you are sending your message byte-by-byte.</p>\n"}, {"comments": [{"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1494440136, "post_id": 43899851, "comment_id": 74833702, "body": "Note, typical windows PCs are little-endian, so if you&#39;re running on windows, you can be pretty sure that your data is stored little-endian."}, {"owner": {"reputation": 2107, "user_id": 3770881, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9a575ab4e645630e948c8ae7eebeda74?s=128&d=identicon&r=PG&f=1", "display_name": "lpares12", "link": "https://stackoverflow.com/users/3770881/lpares12"}, "edited": false, "score": 1, "creation_date": 1494441428, "post_id": 43899851, "comment_id": 74834424, "body": "I&#39;m using a Raspberry Pi W and you are right, it&#39;s represented as <code>0x54000000</code>. Thanks!"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1494442943, "post_id": 43899851, "comment_id": 74835367, "body": "Since PC is little endian (0x54000000) and pi is little endian, shouldn&#39;t pi be the same as PC?"}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1494443227, "post_id": 43899851, "comment_id": 74835530, "body": "@KevinDTimm Thanks.  My brain mis-wired when I wrote the comment, and I flipped little and big in my head."}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1494443387, "post_id": 43899851, "comment_id": 74835629, "body": "<a href=\"https://www.raspberrypi.org/forums/viewtopic.php?f=2&amp;t=531\" rel=\"nofollow noreferrer\">raspberrypi.org/forums/viewtopic.php?f=2&amp;t=531</a> and <a href=\"https://raspberrypi.stackexchange.com/questions/34581/is-raspbian-big-endian-or-little-endian\" title=\"is raspbian big endian or little endian\">raspberrypi.stackexchange.com/questions/34581/&hellip;</a> both show that raspberry pi is (usually) little endian, so this makes sense."}], "tags": [], "owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "is_accepted": true, "score": 2, "last_activity_date": 1494443304, "last_edit_date": 1494443304, "creation_date": 1494439860, "answer_id": 43899851, "question_id": 43899649, "link": "https://stackoverflow.com/questions/43899649/unix-sockets-between-c-and-python/43899851#43899851", "title": "Unix sockets between C and Python", "body": "<p>This actually has nothing to do with Python and nothing to do with sockets, but you're right, it does have to do with endianness.</p>\n\n<p>Test you're implicit assumption:  is 84 really represented as <code>0x00 0x00 0x 00 0x54</code> on your computer that is running the C client program?  Try writing to a file instead of a socket, and binary edit the result.  I bet you'll see that your native architecture is little-endian, and that the data that was written was <code>0x54 0x00 0x00 0x00</code>.</p>\n\n<p>What you're seeing on the socket is simply what you're sending.</p>\n"}], "owner": {"reputation": 2107, "user_id": 3770881, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9a575ab4e645630e948c8ae7eebeda74?s=128&d=identicon&r=PG&f=1", "display_name": "lpares12", "link": "https://stackoverflow.com/users/3770881/lpares12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 43899851, "answer_count": 2, "score": 1, "last_activity_date": 1494443304, "creation_date": 1494439163, "question_id": 43899649, "link": "https://stackoverflow.com/questions/43899649/unix-sockets-between-c-and-python", "title": "Unix sockets between C and Python", "body": "<p>Just made a Python program which acts as a server for Unix sockets and when it receives a connection, reads 4 bytes from it.</p>\n\n<p>On the other hand, I made a C program which connects to the server and sends this 4 bytes to it.</p>\n\n<p>file.py</p>\n\n<pre><code>packet = connection.recv(4, socket.MSG_WAITALL)\nfor value in packet:\n    if value == '\\0':\n        print 'A none'\n    else:\n        print value\n</code></pre>\n\n<p>file.c</p>\n\n<pre><code>size_t toSend 84; // Char representation \\0\\0\\0T\nwrite(fd, (void *)&amp;toSend, sizeof(toSend));\n</code></pre>\n\n<p>This makes the python program receive a wrong order of bytes. Here the output</p>\n\n<pre><code>T\nA none\nA none\nA none\n</code></pre>\n\n<p>The first thing that came to my mind was that this was the result of endianness, but then I modified the files leaving them like this.</p>\n\n<p>file.c</p>\n\n<pre><code>char abc[16]; \n// setting char abc to be 'ABCDEFGHIJKLMNOP' (without ending \\0)\nwrite(fd, (void *)&amp;abc[0], 16);\n</code></pre>\n\n<p>file.py</p>\n\n<pre><code>packet = connection.recv(16, socket.MSG_WAITALL)\n// everything else, wasn't modified\n</code></pre>\n\n<p>And this printed:</p>\n\n<pre><code>A\nB\nC\n...\nP\n</code></pre>\n\n<p>So this time it was received as it was supposed to. Could someone point me out to what I'm doing wrong? Unless it has something to do with the <code>size_t</code> type, I can't think of anything else.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "struct", "member", "defined"], "comments": [{"owner": {"reputation": 62518, "user_id": 469300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f8256aabf1f8938bc2356b1fbeb227f4?s=128&d=identicon&r=PG", "display_name": "slezica", "link": "https://stackoverflow.com/users/469300/slezica"}, "edited": false, "score": 5, "creation_date": 1494437753, "post_id": 43899263, "comment_id": 74832316, "body": "Remove the include guard (<code>define</code>/<code>ifndef</code>) and see if it works. If you included this header more than once, the second time it will be empty. Also note that, at least in the code you posted, it looks like including that header inside the <code>struct</code> will cause syntax errors"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494438556, "post_id": 43899263, "comment_id": 74832811, "body": "I&#39;m suspicious that whatever is in <code>visitor_room.h</code> is interfering where it is included by <code>challenge_room_system_fields.h</code>.  I cannot be certain, however, unless you actually present that."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1494438613, "post_id": 43899263, "comment_id": 74832854, "body": "Visual Studio 2015 complains about the semicolon at the end of <code>#include &quot;challenge_room_system_fields.h&quot;;</code>, so you might try removing that. That said, I would fire anyone who wrote code like this."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 62518, "user_id": 469300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f8256aabf1f8938bc2356b1fbeb227f4?s=128&d=identicon&r=PG", "display_name": "slezica", "link": "https://stackoverflow.com/users/469300/slezica"}, "edited": false, "score": 1, "creation_date": 1494438761, "post_id": 43899263, "comment_id": 74832936, "body": "You have a good point, @slezica, and I&#39;m inclined to agree that if <code>challenge_room_system_fields.h</code> is intended only to provide the contents of <code>struct SChallengeRoomSystem</code> then it does not need and should not have include guards.  I&#39;m not convinced that that explains the OP&#39;s problem, however."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494438791, "post_id": 43899263, "comment_id": 74832950, "body": "The mutual inclusion is a bad idea here."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1494439766, "post_id": 43899263, "comment_id": 74833483, "body": "The error message suggests that you are compiling this as a C program (as does the use of <code>typedef</code>). This is certainly one of the cases where C and C++ are different: The nested <code>struct</code> definition is treated differently by the two languages. I don&#39;t think that fact is relevant to your question, so I just removed the tag <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1494440054, "post_id": 43899263, "comment_id": 74833657, "body": "Try running the preprocessor on those files and see what code you end up with. May be it will shed some light."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494441374, "post_id": 43899263, "comment_id": 74834399, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "reply_to_user": {"reputation": 62518, "user_id": 469300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f8256aabf1f8938bc2356b1fbeb227f4?s=128&d=identicon&r=PG", "display_name": "slezica", "link": "https://stackoverflow.com/users/469300/slezica"}, "edited": false, "score": 0, "creation_date": 1494442523, "post_id": 43899263, "comment_id": 74835105, "body": "@slezica it doesn&#39;t work, it just creates more errors like\t&quot;error C2059: syntax error : &#39;}&#39; &quot; and &quot; struct type redefiniton - and the original error still reamins"}, {"owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494442751, "post_id": 43899263, "comment_id": 74835248, "body": "@EugeneSh. I have to do the mutual inclusion"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6424206"}, "edited": false, "score": 0, "creation_date": 1494452613, "post_id": 43899263, "comment_id": 74840302, "body": "It&#39;s been a while since I used C, so maybe I&#39;m thinking wrong, but maybe the compiler is attempting to redefine VisitorList at the struct VisitorList* line, thus causing the error. In other words, is the struct keyword being used correctly?"}, {"owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "edited": false, "score": 0, "creation_date": 1494454445, "post_id": 43899263, "comment_id": 74840985, "body": "@RexGray I&#39;m pretty sure it is, but thanks anyway for the help"}], "owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494439641, "creation_date": 1494437648, "last_edit_date": 1494439641, "question_id": 43899263, "link": "https://stackoverflow.com/questions/43899263/c-requires-that-a-struct-or-union-has-at-least-one-member-but-members-have-b", "title": "C requires that a struct or union has at least one member - but members *have* been defined", "body": "<p>I have a problem with my struct definition.\nI define it here:</p>\n\n<pre><code>#ifndef CHALLENGE_SYSTEM_H_\n#define CHALLENGE_SYSTEM_H_\n\n#include \"visitor_room.h\"\n\ntypedef struct SChallengeRoomSystem\n{\n\n#include \"challenge_room_system_fields.h\";\n\n} ChallengeRoomSystem;\n\n#endif\n</code></pre>\n\n<p>And the file \"challenge_room_system_fields.h\" is:</p>\n\n<pre><code>#ifndef CHALLENGE_ROOM_SYSTEM_FIELDS_H_\n#define CHALLENGE_ROOM_SYSTEM_FIELDS_H_\n#include \"visitor_room.h\"\n\nstruct VisitorList {\n    Visitor* visitor;\n    struct VisitorList* next;\n};\nstruct VisitorList* list;\nchar *name;\nint num_of_challenges;\nChallenge* challenges;\nint num_of_rooms;\nChallengeRoom* rooms;\nint last_time;\n\n#endif\n</code></pre>\n\n<p>The following code gives me the error: \"error C2016 C requires that a struct or union has at least one member\". I don't understand why it doesn't work because I did declare members in the struct.\nP.S. It's part of my homework and I have to define the members of the struct in the \"challenge_room_system_fields.h\" file. Also, \"visitor_room.h\" is another file in this project but it's not the reason of the problem for sure.</p>\n"}, {"tags": ["c", "readfile", "fgets", "strtok"], "comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 2, "creation_date": 1494438601, "post_id": 43899205, "comment_id": 74832846, "body": "I think that the strcat() call inside your innermost loop may be harming the operation.  strtok() must be approached carefully, as it modifies the string you are tokenizing during each consecutive call. I bet it is not expecting the source buffer (word) to be modified in between calls."}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 0, "creation_date": 1494438722, "post_id": 43899205, "comment_id": 74832916, "body": "What do you intend with the <code>strcat</code> function call ?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1494438877, "post_id": 43899205, "comment_id": 74833002, "body": "<code>printf(&quot;\\n&quot;, NULL);</code> ?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494439601, "post_id": 43899205, "comment_id": 74833392, "body": "If you just want tom print the word with a space after it, forget about all that copying and concantenating. C&#39;s strings are not like strings in other languages; they are somewhat tricky to work with. If you want a space, put it in <code>printf</code>&#39;s format string. Repalce your <code>print</code> function and everything inside the loop befire the <code>strtok</code> line with <code>printf(&quot;%s &quot;, word);</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6392565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e0dab3c588da746b9fcbbd4e1bee73?s=128&d=identicon&r=PG&f=1", "display_name": "Chief", "link": "https://stackoverflow.com/users/6392565/chief"}, "is_accepted": false, "score": 0, "last_activity_date": 1494439299, "creation_date": 1494439299, "answer_id": 43899691, "question_id": 43899205, "link": "https://stackoverflow.com/questions/43899205/while-reading-from-a-file-and-using-strtok-while-loop-only-prints-first-word-of/43899691#43899691", "title": "While reading from a file and using strtok while loop only prints first word of each line", "body": "<p>I think BlueStrat is right.  Try copying word to printword first, then cat \" \" to printword</p>\n\n<pre><code>strcpy(printword, word);\nstrcat(printword, \" \");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1494439973, "last_edit_date": 1494439973, "creation_date": 1494439660, "answer_id": 43899795, "question_id": 43899205, "link": "https://stackoverflow.com/questions/43899205/while-reading-from-a-file-and-using-strtok-while-loop-only-prints-first-word-of/43899795#43899795", "title": "While reading from a file and using strtok while loop only prints first word of each line", "body": "<p>@BlueStrat appears to have put his finger on the issue with his comment.</p>\n\n<p>When using <code>strtok()</code>, you must always remember that it does not allocate any memory, but instead returns pointers into the original string (inserting terminators in place of delimiters), and maintains an internal static pointer to the start of the next token.  Suppose, then, that the first line of your input file contains</p>\n\n<pre><code>one two three\n</code></pre>\n\n<p><code>fgets()</code> will read that into your <code>line</code> array:</p>\n\n<pre><code>       0         1\noffset 0123456789012 3\nline   one two three\\0\n</code></pre>\n\n<p>The first <code>strtok()</code> call returns a pointer to the character at offset 0, sets the character at offset 3 to a terminator, and sets its internal state variable to point to the character at offset 4:</p>\n\n<pre><code>       0         1\noffset 012 3456789012 3\nline   one\\0two three\\0\n       ^    ^\n       |    |\n       |    +-- (next)\n       +------- word \n</code></pre>\n\n<p>Then you <code>strcat</code> an extra character onto the end of <code>word</code>, producing:</p>\n\n<pre><code>       0         1\noffset 0123 456789012 3\nline   one \\0wo three\\0\n       ^    ^\n       |    |\n       |    +-- (next)\n       +------- word \n</code></pre>\n\n<p>Now study that for a moment.  Not only have you corrupted the data following the first token, you have done it in such a way that the internal state pointer points to a string terminator.  When you next call <code>strtok()</code>, then, that function sees that it is at the end of the string (a string), and returns <code>NULL</code> to signal that there are no more tokens.</p>\n\n<p>Instead of manipulating the token, which is perilous, concatenate its contents to the <code>printword</code> buffer and then concatenate the extra space to <em>that</em>.</p>\n"}], "owner": {"reputation": 25, "user_id": 3570467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db05024226551751a1a23f16309dfc82?s=128&d=identicon&r=PG&f=1", "display_name": "crimson_skier", "link": "https://stackoverflow.com/users/3570467/crimson-skier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 1, "accepted_answer_id": 43899795, "answer_count": 2, "score": 0, "last_activity_date": 1494439973, "creation_date": 1494437465, "question_id": 43899205, "link": "https://stackoverflow.com/questions/43899205/while-reading-from-a-file-and-using-strtok-while-loop-only-prints-first-word-of", "title": "While reading from a file and using strtok while loop only prints first word of each line", "body": "<p>I am a Java programmer testing my luck at C. I am trying to read a file in line by line and then count each individual word. So far I am not having luck separating each line into words. I am able to see each line and loop through the file correctly but my output is only the first word of each line.\nWhat am I doing wrong here?</p>\n\n<pre><code>char printword[1024]= \"\";\n\nvoid print() {\n    printf(\"%s\", printword);    \n}\nmain()\n{\n    FILE* f;\n    errno_t err;\n    err = fopen_s(&amp;f, FILE_NAME, \"r\");\n    if (&amp;f == NULL) {\n    exit(EXIT_FAILURE);\n    }\n    char line[1024];\n    while (fgets(line, 1024, f) != NULL) {\n        char * word;\n        char *context = \" \";\n        word = strtok(line, \" \");\n        while (word != NULL) {\n        strcpy(printword, strcat(word,\" \"));\n        print();\n        word = strtok(NULL, \" \");\n        }\n        printf(\"\\n\", NULL);\n    }\n    //}\n    fclose(f);\n    printf(\"Press any key to continue\");\n    getchar();\n    exit(0);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 631, "user_id": 3762627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62cc959f6d15c5a429116d08a5df4fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gil-Mor", "link": "https://stackoverflow.com/users/3762627/gil-mor"}, "edited": false, "score": 0, "creation_date": 1494439174, "post_id": 43899066, "comment_id": 74833151, "body": "Your code is unreadable. Please indent it according to some C guidelines."}, {"owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "reply_to_user": {"reputation": 631, "user_id": 3762627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62cc959f6d15c5a429116d08a5df4fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gil-Mor", "link": "https://stackoverflow.com/users/3762627/gil-mor"}, "edited": false, "score": 0, "creation_date": 1494439601, "post_id": 43899066, "comment_id": 74833391, "body": "What do you mean by that? The code works for me."}, {"owner": {"reputation": 4875, "user_id": 1144624, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c640c2471d507b73b93d5cb34eaebfed?s=128&d=identicon&r=PG", "display_name": "Kcvin", "link": "https://stackoverflow.com/users/1144624/kcvin"}, "edited": false, "score": 0, "creation_date": 1494439767, "post_id": 43899066, "comment_id": 74833484, "body": "You have inconsistent, and nonexistent spacing."}, {"owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "edited": false, "score": 0, "creation_date": 1494439924, "post_id": 43899066, "comment_id": 74833584, "body": "Ok i will edit it."}, {"owner": {"reputation": 631, "user_id": 3762627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62cc959f6d15c5a429116d08a5df4fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gil-Mor", "link": "https://stackoverflow.com/users/3762627/gil-mor"}, "edited": false, "score": 0, "creation_date": 1494439976, "post_id": 43899066, "comment_id": 74833612, "body": "I didn&#39;t say it won&#39;t compile, I said it&#39;s unreadable. There are indentation standards and guidelines. Look at some C code examples to get the general idea."}, {"owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "edited": false, "score": 0, "creation_date": 1494440028, "post_id": 43899066, "comment_id": 74833641, "body": "I have edited it now. I hope it is better."}, {"owner": {"reputation": 631, "user_id": 3762627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62cc959f6d15c5a429116d08a5df4fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gil-Mor", "link": "https://stackoverflow.com/users/3762627/gil-mor"}, "edited": false, "score": 0, "creation_date": 1494440487, "post_id": 43899066, "comment_id": 74833889, "body": "Nope.. That&#39;s not good indentation.. You&#39;ll have to look at some examles.. here&#39;s a random page with C code in it.. <a href=\"http://beginnersbook.com/2014/01/c-functions-examples/\" rel=\"nofollow noreferrer\">beginnersbook.com/2014/01/c-functions-examples</a>"}, {"owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "edited": false, "score": 0, "creation_date": 1494440859, "post_id": 43899066, "comment_id": 74834076, "body": "I am sorry sir,but can you show me what specific lines or segments are unreadable? I really think that everything is in order with the reading,i can explain some segments if you want and you don&#39;t understand."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494440958, "post_id": 43899066, "comment_id": 74834141, "body": "When you scan and print the array elements, you must use <code>S[j]</code> and <code>D[k]</code> instead of just <code>S</code> and <code>D</code>. Turning on warnings will tell you about type mismatches with the variadic library functions. You should also initialise <code>k</code> to 0 and free the allocated memory after use."}, {"owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "edited": false, "score": 0, "creation_date": 1494441332, "post_id": 43899066, "comment_id": 74834371, "body": "As you can see over there when i am printing {printf(&quot; element %d is %d\\n&quot;,k,D); i think what you just said is just a matter of writing? am I right or wrong?"}], "owner": {"reputation": 1, "user_id": 7971337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1461294297291035/picture?type=large", "display_name": "R\u0103zvan Alexandru", "link": "https://stackoverflow.com/users/7971337/r%c4%83zvan-alexandru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517992719, "creation_date": 1494437054, "last_edit_date": 1517992719, "question_id": 43899066, "link": "https://stackoverflow.com/questions/43899066/build-a-binary-tree-using-two-arrays-given-in-c", "title": "Build a binary tree using two arrays given in C", "body": "<p>I have a question. How can I add two arrays L(elements of theleft subtree) and D(elements of the right subtree) and create a binary tree? It's not a binary search tree. However these data that i have are stored in a file in which i have managed to convert the lines with numbers into int arrays S->Left elements and D->Right elements. Finally with the p i have stored the number of nodes from the first line. The file contains these lines:</p>\n\n<blockquote>\n  <p>7   ->Number of nodes</p>\n  \n  <p>2 4 0 0 7 0 0 ->Left subtree elements</p>\n  \n  <p>3 5 6 0 0 0 0 ->Right subtree elements</p>\n</blockquote>\n\n<p>However my assignment is to build this code and do a postorder,inorder and preorder traversal of the binary tree and the output should look like this:</p>\n\n<blockquote>\n  <p>Preorder: 1 2 4 5 7 3 6</p>\n  \n  <p>Inorder: 4 2 7 5 1 3 6</p>\n  \n  <p>Postorder: 4 7 5 2 6 3 1</p>\n</blockquote>\n\n<p>It's not clear for me why 1 is there. I am sure that 1 is the root but i don't know how to add the rest of the elements to the binary tree from S and D arrays.</p>\n\n<p>My code so far looks like this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  int p;\n  int length1, length2,  *S,  *D;\n  int j = 0, k;\n  const char *v1;\n  const char *v2;\n\n  FILE *fptr = fopen(\"sd.in\", \"r\");\n  if (fptr == NULL)\n  {\n    printf(\"Failed to open file\\n\");\n    return  - 1;\n  }\n  char buf[3][100];\n  int i = 0;\n\n  while ((fgets(buf[i], 100, fptr) != NULL) &amp;&amp; (i &lt; 3))\n  {\n    printf(\"%s\\n\", buf[i++]);\n  }\n\n  fclose(fptr);\n\n  p = atoi(buf[0]);\n  v1 = buf[1];\n  v2 = buf[2];\n  length1 = strlen(v1);\n  length2 = strlen(v2);\n  S = (int*)malloc(length1 *sizeof(int));\n  D = (int*)malloc(length2 *sizeof(int));\n\n  while (sscanf(v1, \"%d%n\", &amp;S, &amp;length1) == 1)\n  {\n    printf(\" element %d is %d\\n\", j, S);\n    v1 += length1;\n    j++;\n  }\n\n  while (sscanf(v2, \"%d%n\", &amp;D, &amp;length2) == 1)\n  {\n    printf(\" element %d is %d\\n\", k, D);\n    v2 += length2;\n    k++;\n  }\n\n  printf(\"%d\\n\", p);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "compilation"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1494440570, "post_id": 43899644, "comment_id": 74833939, "body": "Thanks, it works with this example, but now the error is moved forward in the next function, here is used one more register. extern inline char * strncpy(char * dest,const char *src,int count) { __asm__(&quot;cld\\n&quot; \t&quot;1:\\tdecl %2\\n\\t&quot; \t&quot;js 2f\\n\\t&quot; \t&quot;lodsb\\n\\t&quot; \t&quot;stosb\\n\\t&quot; \t&quot;testb %%al,%%al\\n\\t&quot; \t&quot;jne 1b\\n\\t&quot; \t&quot;rep\\n\\t&quot; \t&quot;stosb\\n&quot; \t&quot;2:&quot; \t::&quot;S&quot; (src),&quot;D&quot; (dest),&quot;c&quot; (count):&quot;si&quot;,&quot;di&quot;,&quot;ax&quot;,&quot;cx&quot;); return dest; }"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1494441636, "post_id": 43899644, "comment_id": 74834555, "body": "@JoAccount: Same thing. The clobber list should be just <code>:&quot;ax&quot;, &quot;cc&quot;</code>. The &quot;cx&quot; overlaps with <code>&quot;c&quot;</code> that stands for register <code>ecx</code>."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1494439774, "last_edit_date": 1494439774, "creation_date": 1494439129, "answer_id": 43899644, "question_id": 43898963, "link": "https://stackoverflow.com/questions/43898963/compiling-linux-0-0-1-error-asm-operand-has-impossible-constraints-asm/43899644#43899644", "title": "compiling linux 0.0.1 =&gt; error: \u2018asm\u2019 operand has impossible constraints __asm__(&quot;cld\\n&quot;", "body": "<p>I think that the problem is that the <em>register clobber list</em> overlaps with the inputs.</p>\n\n<p>That is, the <code>\"S\"</code>  stands for register <code>esi</code> while <code>\"D\"</code> stands for register <code>edi</code>; but then the clobber list contains <code>\"si\"</code> and <code>\"di\"</code> that are the lower 16 bit pieces of those registers. Maybe old GCC versions ignored that, but newer ones do not allow overlaps.</p>\n\n<p>From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#Clobbers\" rel=\"nofollow noreferrer\">docs here</a>:</p>\n\n<blockquote>\n  <p>Clobber descriptions may not in any way overlap with an input or output operand.</p>\n</blockquote>\n\n<p>Solution, just remove them from the list:</p>\n\n<pre><code>...\n::\"S\" (src),\"D\" (dest) :\"ax\", \"cc\");\n</code></pre>\n\n<p>BTW, I also added the clobber to <code>\"cc\"</code> because that assembly modifies the <code>e</code> flag.</p>\n"}], "owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494439774, "creation_date": 1494436683, "question_id": 43898963, "link": "https://stackoverflow.com/questions/43898963/compiling-linux-0-0-1-error-asm-operand-has-impossible-constraints-asm", "title": "compiling linux 0.0.1 =&gt; error: \u2018asm\u2019 operand has impossible constraints __asm__(&quot;cld\\n&quot;", "body": "<p>I'm trying to compile linux kernel 0.0.1 from source code on my 64 bit intel machine.\nOnly to fill in the boot and main I had to modify all makefiles to get a 32-bit compilation.</p>\n\n<p>So, this is the output of make:</p>\n\n<pre><code>In file included from traps.c:7:0:\n../include/string.h:128:22: warning: conflicting types for built-in function \u2018strchr\u2019\n extern inline char * strchr(const char * s,char c)\n                      ^\n../include/string.h:145:22: warning: conflicting types for built-in function \u2018strrchr\u2019\n extern inline char * strrchr(const char * s,char c)\n                      ^\n../include/string.h:379:22: warning: conflicting types for built-in function \u2018memchr\u2019\n extern inline void * memchr(const void * cs,char c,int count)\n                      ^\n../include/string.h:395:22: warning: conflicting types for built-in function \u2018memset\u2019\n extern inline void * memset(void * s,char c,int count)\n                      ^\nIn file included from traps.c:11:0:\n../include/linux/kernel.h:5:1: warning: function return types not compatible due to \u2018volatile\u2019\n volatile void panic(const char * str);\n ^\n../include/linux/kernel.h:5:1: warning: function return types not compatible due to \u2018volatile\u2019\n../include/linux/kernel.h:5:1: warning: function return types not compatible due to \u2018volatile\u2019\nIn file included from traps.c:7:0:\n../include/string.h: In function \u2018strcpy\u2019:\n../include/string.h:29:1: error: \u2018asm\u2019 operand has impossible constraints\n __asm__(\"cld\\n\"\n ^\nMakefile:24: set di istruzioni per l'obiettivo \"traps.o\" non riuscito\n</code></pre>\n\n<p>The portion of code of string.h is the following:</p>\n\n<pre><code>extern inline char * strcpy(char * dest,const char *src)\n{\n__asm__(\"cld\\n\"\n    \"1:\\tlodsb\\n\\t\"\n    \"stosb\\n\\t\"\n    \"testb %%al,%%al\\n\\t\"\n    \"jne 1b\"\n    ::\"S\" (src),\"D\" (dest):\"si\",\"di\",\"ax\");\nreturn dest;\n}\n</code></pre>\n\n<p>I don't know why the original code doesn't compile.\nUntil now I successfully compiled: boot and init subdir.</p>\n\n<p>Many Thanks</p>\n"}, {"tags": ["c", "linux", "posix", "shared-memory"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1494436047, "post_id": 43898658, "comment_id": 74831303, "body": "Have you tried passing an absolute path instead of <code>&quot;.&quot;</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494436052, "post_id": 43898658, "comment_id": 74831307, "body": "I don&#39;t immediately see an error in the code presented, other than the fact that the function&#39;s return type has been clipped off.  Please expand the code to present a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1494436183, "post_id": 43898658, "comment_id": 74831388, "body": "@KeineLust, to the best of my knowledge, it is not required to use an absolute pathname with <code>ftok()</code>.  In any event, if there were a problem with creating or attaching the shared memory segment then I would expect it to be caught by the OP&#39;s error checks."}, {"owner": {"reputation": 137, "user_id": 7987828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oqj98.jpg?s=128&g=1", "display_name": "Doctor.008", "link": "https://stackoverflow.com/users/7987828/doctor-008"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494436492, "post_id": 43898658, "comment_id": 74831609, "body": "@JohnBollinger the return type is void. This is created as a seperate method just to improve the readability of the main method."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494437133, "post_id": 43898658, "comment_id": 74831940, "body": "@dolittele, the point of my first comment is that the error very likely arises from some part of your program other than what you have presented.  Adding the function return type is not nearly enough to create an MCVE.  Follow the link I provided if you are uncertain what is actually needed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494437554, "post_id": 43898658, "comment_id": 74832201, "body": "In fact, @dolittele, I took your exact code, built a simple program around it that writes to and reads from the shared memory segment, and tested it.  I saw no sign of misbehavior."}, {"owner": {"reputation": 137, "user_id": 7987828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oqj98.jpg?s=128&g=1", "display_name": "Doctor.008", "link": "https://stackoverflow.com/users/7987828/doctor-008"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494439249, "post_id": 43898658, "comment_id": 74833202, "body": "@JohnBollinger  I updated the queston."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494440144, "post_id": 43898658, "comment_id": 74833709, "body": "Expressions such as this: <code>cntPtr+=rowCnt</code> increment the <i>pointer</i>, not the contents of the (shared) memory to which it points.  You want <code>*cntPtr+=rowCnt</code>."}, {"owner": {"reputation": 137, "user_id": 7987828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oqj98.jpg?s=128&g=1", "display_name": "Doctor.008", "link": "https://stackoverflow.com/users/7987828/doctor-008"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494442746, "post_id": 43898658, "comment_id": 74835241, "body": "@JohnBollinger Can you please explain me how to initialize an integer variable inside the shared memory ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494443067, "post_id": 43898658, "comment_id": 74835438, "body": "@dolittele, there is nothing different about accessing shared memory via a pointer than accessing unshared memory via a pointer.  It can be easy to flub pointer usage, but if you don&#39;t understand pointer usage at all then shared memory is not the place for you to start.  Note in particular that you do not have an integer <i>variable</i> inside the shared memory.  Rather, you have a pointer to <code>int</code> (the pointer itself in unshared memory), and the space it is pointing to happens to be shared memory.  The shared bytes do not constitute a variable, they constitute the representation of a <i>value</i>."}], "owner": {"reputation": 137, "user_id": 7987828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oqj98.jpg?s=128&g=1", "display_name": "Doctor.008", "link": "https://stackoverflow.com/users/7987828/doctor-008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 919, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1494439189, "creation_date": 1494435570, "last_edit_date": 1494439189, "question_id": 43898658, "link": "https://stackoverflow.com/questions/43898658/creating-shared-memory-in-c", "title": "Creating shared memory in C", "body": "<p>I created following method in C to create a shared memory segment to store counter value. But I can't store data in this segment.When I try to print the value of the counter it gives me a garbage value.Whats wrong with this code?</p>\n\n<pre><code>CreateCounter()\n{\n  key = ftok(\".\",'B');\n  shmCntid = shmget(key,COUNTER_SIZE,IPC_CREAT|0666);\n\n  if(shmCntid == -1 )\n  {\n    perror(\"shmget\");\n    exit(1);\n  }\n\n  else\n  {\n    printf(\"Creating new Sahred memory sement\\n\");\n    cntPtr = shmat(shmCntid,0,0);\n    if(cntPtr == -1 )\n    {\n      perror(\"shmat\");\n      exit(1);\n    }\n  }\n}\n</code></pre>\n\n<p>This method is called inside the main method as follows.</p>\n\n<pre><code>   int *cntPtr;\n   int rowCnt;\n   sem_t s;\n   sem_t c;\n   sem_t r; \n  int main(int argc, int *argv[])\n    {\n      int pid, pid2, pid3, i;\n      CreateBuf1();\n      CreateBuf2();\n      CreateCounter();\n      GetInput(argv[1],*buf1Ptr);\n      sem_init(&amp;c, 0, 1);\n      sem_init(&amp;r, 0, 1);\n      sem_init(&amp;s, 0, 1);\n\n      for( i = 0 ; i &lt; 9; i++)\n      {\n        pid = fork();\n\n        if(pid &lt; 0)\n        {\n          printf(\"Fork error !\\n\");\n        }\n\n        else if (pid == 0)\n        break;\n\n      }\n\n\n\n      if(pid &lt; 0)\n      {\n        printf(\"Fork error !\\n\");\n      }\n      else if (pid == 0)\n      {\n        sem_wait(&amp;r);\n        Grp1 (i,i);\n        cntPtr+=rowCnt;\n        sleep(1);\n        sem_post(&amp;r);\n        sem_post(&amp;c);\n        exit(0);\n      }\n      else\n      {\n        wait(NULL);\n      }\n      pid2 = fork();\n      if(pid2 &lt; 0)\n      {\n        printf(\"Fork error !\\n\");\n      }\n\n      else if (pid2 == 0)\n      {\n        sem_wait(&amp;c);\n        Grp2(9);\n        cntPtr+=colCnt;\n        sleep(1);\n        sem_post(&amp;c);\n        exit(0);\n      }\n      else\n      {\n        wait(NULL);\n      }\n\n    // This space is to print the values..............\n\n      shmctl(shmBuf1id,IPC_RMID,0);\n      shmctl(shmBuf2id,IPC_RMID,0);\n      shmctl(shmCntid,IPC_RMID,0);\n\n\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "assembly", "floating-point", "floating-accuracy", "fpu"], "comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 2, "creation_date": 1494435882, "post_id": 43898608, "comment_id": 74831221, "body": "This article explains why the strict IEEE 754 binary64 behavior (which is that of <code>addsd</code> is nver in practice completely emulated when the compiler generates <code>faddl</code>: <a href=\"https://hal.archives-ouvertes.fr/hal-00128124v5/document\" rel=\"nofollow noreferrer\">hal.archives-ouvertes.fr/hal-00128124v5/document</a> The compiler can try harder than yours is trying, but the emulation will not be perfect anyway unless it expends more effort than it&#39;s willing to."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 2, "creation_date": 1494436077, "post_id": 43898608, "comment_id": 74831321, "body": "This has little to do with C in general, even less with the brand and model of your x86-64 CPU, and very much to do with your specific platform, compiler version, and command-line. This is the information that your question should provide."}, {"owner": {"reputation": 6240, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "edited": false, "score": 1, "creation_date": 1494437240, "post_id": 43898608, "comment_id": 74832006, "body": "As you&#39;ve pointed out - when you compile code as 32bit one - calculations are performed on FPU and if compiled as 64bit code &#39;addsd&#39; instruction is used. &#39;addsd&#39; is - as far as I rememeber - SSE instruction. FPU and SSE use different bit length patterns for calculations and that&#39;s why you encounter some differences. This is what I suspect."}, {"owner": {"reputation": 322, "user_id": 2119820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fadf86ec198ad110eb9c50b4d61d05bc?s=128&d=identicon&r=PG", "display_name": "Fabrice LARRIBE", "link": "https://stackoverflow.com/users/2119820/fabrice-larribe"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1494438087, "post_id": 43898608, "comment_id": 74832535, "body": "@PascalCuoq : I do not know is this is what you are asking for but I use gcc (mingw) 32 and 64 bits under windows7 (I do not understand how this can interfer but, who knows...) I do not use any compiling option (no optimisations) except &quot;-g&quot; for debugging. Do you thing that some compiler option can be added to make the compiler uses more &quot;clever&quot; solution in order to make the computation more accurate ?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1494440953, "post_id": 43898608, "comment_id": 74834136, "body": "@user2119820: You might be able to get the compiler to emit ieee754 binary64 compliant code if you specify <code>-msse2</code> and/or <code>-mfpmath=sse</code>."}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 3, "creation_date": 1494442255, "post_id": 43898608, "comment_id": 74834928, "body": "Suggested search term: &quot;double rounding&quot; (or even &quot;x87 double rounding&quot;). <a href=\"http://www.exploringbinary.com/double-rounding-errors-in-floating-point-conversions/\" rel=\"nofollow noreferrer\">This blog post</a> explains what&#39;s going on (though the HAL paper that @PascalCuoq linked to should also be required reading)."}, {"owner": {"reputation": 13243, "user_id": 3512216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kg2sx.gif?s=128&g=1", "display_name": "rkhb", "link": "https://stackoverflow.com/users/3512216/rkhb"}, "edited": false, "score": 1, "creation_date": 1494478407, "post_id": 43898608, "comment_id": 74846806, "body": "I can confirm that behaviour. It depends on the internal precision (FPU control word). 64-bit mantissa: round down, 53-bit mantissa: round up."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 2119820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fadf86ec198ad110eb9c50b4d61d05bc?s=128&d=identicon&r=PG", "display_name": "Fabrice LARRIBE", "link": "https://stackoverflow.com/users/2119820/fabrice-larribe"}, "edited": false, "score": 5, "creation_date": 1494439396, "post_id": 43899159, "comment_id": 74833281, "body": "I thing that you should read more attentively the above post. In both compilation context I am using &#39;double&#39; (IEEE744 Binary64). The binary (hexadecimal) version of the values are given (decimal values are only here for informational purpose)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 322, "user_id": 2119820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fadf86ec198ad110eb9c50b4d61d05bc?s=128&d=identicon&r=PG", "display_name": "Fabrice LARRIBE", "link": "https://stackoverflow.com/users/2119820/fabrice-larribe"}, "edited": false, "score": 0, "creation_date": 1494442377, "post_id": 43899159, "comment_id": 74835015, "body": "I read that and your question title.  ignore single from double then, where did you demonstrate that you isolated the decimal world from binary? ascii from binary?  What work if any have you done in trying to figure this out?  Where is your minimal code that demonstrates the problem?  Are you expecting us to do all of the work for you?  This not a contract software service."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": -5, "last_activity_date": 1494437320, "creation_date": 1494437320, "answer_id": 43899159, "question_id": 43898608, "link": "https://stackoverflow.com/questions/43898608/binary64-floating-point-addition-rounding-mode-error-and-behaviors-difference-32/43899159#43899159", "title": "Binary64 floating point addition rounding mode error and behaviors difference 32/64 bits", "body": "<p>First and foremost you are looking at base 10 numbers.  you want to talk about floating point and rounding and such needs to be a base 2 discussion.</p>\n\n<p>Second single and double have different length mantissas so obviously for the same number the place where you round varies  in decimal 1.2345678 we could round it 1.23  or could round it 1.2346 depending on how many digits we allow one rounds up one rounds down, going with a round up rule.  </p>\n\n<p>Since you are base 10 at some point here you are also mixing in possibly compile time conversions, run time operations, and runtime conversions</p>\n\n<p>I take </p>\n\n<pre><code>float x=1.234567;\nx=x*2.34;\nprintf(\"%f\\n\",x);\n</code></pre>\n\n<p>there are compile time conversions, first and formost ascii to double then double to float to be completely accurate to the language (didnt put F's at the end of the constants).  then the run time multiply, and then a runtime conversion to ascii, the runtime C library might not be the same one as the compile time, do they honor the same rounding settings, etc.  pretty easy to find numbers that you simply declare x=1.234...something and then the next line of code is printf and the printf is not what you fed it, no floating point math other than the runtime float to int.</p>\n\n<p>So before you can ask this question we need to see the binary versions of your numbers, the answer your question should almost automatically fall out from that without further help, but if you still need help then post that and we can look at it.  Having a decimal based discussion adds compiler, and library issues and makes it harder to isolate the problem if there is a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "is_accepted": true, "score": 2, "last_activity_date": 1494512668, "creation_date": 1494512668, "answer_id": 43918211, "question_id": 43898608, "link": "https://stackoverflow.com/questions/43898608/binary64-floating-point-addition-rounding-mode-error-and-behaviors-difference-32/43918211#43918211", "title": "Binary64 floating point addition rounding mode error and behaviors difference 32/64 bits", "body": "<p>The FPU registers are 80-bit wide, whenever a single or double precision number is loaded with <code>fld</code> and variants it is converted into the <a href=\"https://en.wikipedia.org/wiki/Extended_precision\" rel=\"nofollow noreferrer\">double extended precision</a> by default<sup>1</sup>.<br>\nThus <code>fadd</code> usually works with 80-bit numbers.  </p>\n\n<p>The SSE registers are format agnostic and the SSE extensions don't support the double extended precision.<br>\nFor example, <code>addpd</code> works with double precision numbers. </p>\n\n<hr>\n\n<p>The default rounding mode is <em>round to nearest (even)</em> that means the usual <em>round to nearest</em> but toward the even end in case of a tie (e.g. 4.5 => 4).</p>\n\n<p>To implement the IEEE 754 requirement to perform arithmetic as with an infinite precision numbers, the hardware need two guards bit and a sticky bit<sup>2</sup>  </p>\n\n<hr>\n\n<h2>double</h2>\n\n<p>I'll write a double precision number as</p>\n\n<pre><code>&lt;sign&gt; &lt;unbiased exponent in decimal&gt; &lt;implicit integer part&gt; &lt;52-bit mantissa&gt; | &lt;guard bits&gt; &lt;sticky bit&gt;\n</code></pre>\n\n<p>The two numbers</p>\n\n<pre><code>2.500244140625\n4503599627370496\n</code></pre>\n\n<p>are</p>\n\n<pre><code>+  1 1 0100000000 0010000000 0000000000 0000000000 0000000000 00\n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 00\n</code></pre>\n\n<p>The first one is shifted</p>\n\n<pre><code>+ 52 0 0000000000 0000000000 0000000000 0000000000 0000000000 10 |10 1   \n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 00 |00 0\n</code></pre>\n\n<p>The sum is done</p>\n\n<pre><code>+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 10 |10 1\n</code></pre>\n\n<p>Rounding to nearest (even) gives</p>\n\n<pre><code>+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 11\n</code></pre>\n\n<p>because <code>0 |10 1</code> is closer to <code>1 |00 0</code> than <code>0 |00 0</code>.</p>\n\n<h2>double extended</h2>\n\n<p>The two numbers are</p>\n\n<pre><code>+  1 1 0100000000 0010000000 0000000000 0000000000 0000000000 0000000000 000\n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 0000000000 000\n</code></pre>\n\n<p>The first is shifted</p>\n\n<pre><code>+ 52 0 0000000000 0000000000 0000000000 0000000000 0000000000 1010000000 000 | 10 0\n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 0000000000 000 | 00 0\n</code></pre>\n\n<p>The sum is done</p>\n\n<pre><code>+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 1010000000 000 | 10 0\n</code></pre>\n\n<p>Rounding to nearest (even):</p>\n\n<pre><code>+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 1010000000 000\n</code></pre>\n\n<p>as <code>0 | 10 0</code> is tie broken to the nearest even.  </p>\n\n<p>When this number is then converted from double extended precision to double precision (due to a <code>fstp QWORD []</code>) the rounding is repeated using bit 52, 53 and 54 of the double extended mantissa as guards and sticky bits</p>\n\n<pre><code>+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 1010000000 000\n\n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 10|100\n\n+ 52 1 0000000000 0000000000 0000000000 0000000000 0000000000 10\n</code></pre>\n\n<p>because <code>0|100</code> is again tie broken to the nearest even.</p>\n\n<hr>\n\n<p><sup>1</sup> See Chapter 8.5.1.2 of the Intel Manual - Volume 1.<br>\n<sup>2</sup> The guard bit are extra precision bits retained after one of the number is shifted to make the exponents match. The sticky bit it the OR of bits less significant than the the least guard. See the \"on Rounding\" section of <a href=\"http://pages.cs.wisc.edu/~markhill/cs354/Fall2008/notes/flpt.apprec.html\" rel=\"nofollow noreferrer\">this page</a> and <a href=\"http://perso.ens-lyon.fr/jean-michel.muller/goldberg.pdf\" rel=\"nofollow noreferrer\">Goldberg</a> for a format approach.</p>\n"}, {"tags": [], "owner": {"reputation": 322, "user_id": 2119820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fadf86ec198ad110eb9c50b4d61d05bc?s=128&d=identicon&r=PG", "display_name": "Fabrice LARRIBE", "link": "https://stackoverflow.com/users/2119820/fabrice-larribe"}, "is_accepted": false, "score": 2, "last_activity_date": 1494579062, "last_edit_date": 1495540493, "creation_date": 1494579062, "answer_id": 43933375, "question_id": 43898608, "link": "https://stackoverflow.com/questions/43898608/binary64-floating-point-addition-rounding-mode-error-and-behaviors-difference-32/43933375#43933375", "title": "Binary64 floating point addition rounding mode error and behaviors difference 32/64 bits", "body": "<p>Thanks to all the comments received by my question I understood what happent and was able to solve the issue.</p>\n\n<p>I will try to summarize it here.</p>\n\n<p>First, the incorrect rounding was confirmed. As mentioned by <a href=\"https://stackoverflow.com/users/270986/mark-dickinson\">@MarkDickinson</a>, it can be due to a \"double rounding\", but I do not know if it can be confirmed. Indeed, it can also be due to others phenomenon such as the ones described in the <a href=\"https://hal.archives-ouvertes.fr/hal-00128124v5/document\" rel=\"nofollow noreferrer\">publication</a> given by <a href=\"https://stackoverflow.com/users/139746/pascal-cuoq\">Pascal Cuoq</a>.</p>\n\n<p>it seem that the ia32 FPU do not comply perfectly the IEEE754 standard when it is question of rounding certain numbers.</p>\n\n<p>By default, GCC (32 bits version) generate code that uses the FPU to compute additions on Binary64 numbers.</p>\n\n<p>But, on my computer (intel core i7), the SSE unit is also able to make those computations. This unit is use, by default by GCC (64 bit version).</p>\n\n<p>The use of the two following options on the GCC32 command line solves my problem.</p>\n\n<blockquote>\n  <p>-msse2 -mfpmath=sse. </p>\n</blockquote>\n\n<p>(Thanks you <a href=\"https://stackoverflow.com/users/3185968/eof\">EOF</a>)</p>\n"}], "owner": {"reputation": 322, "user_id": 2119820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fadf86ec198ad110eb9c50b4d61d05bc?s=128&d=identicon&r=PG", "display_name": "Fabrice LARRIBE", "link": "https://stackoverflow.com/users/2119820/fabrice-larribe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 43918211, "answer_count": 3, "score": 2, "last_activity_date": 1494579062, "creation_date": 1494435406, "question_id": 43898608, "link": "https://stackoverflow.com/questions/43898608/binary64-floating-point-addition-rounding-mode-error-and-behaviors-difference-32", "title": "Binary64 floating point addition rounding mode error and behaviors difference 32/64 bits", "body": "<p>I noticed a rounding error when I tried to add the two following floating point numbers on an  Intel core I7 / I5 :</p>\n\n<blockquote>\n  <p>2.500244140625E+00 + 4503599627370496.00\n   &lt;=>  0x1.4008p+1 + 0x1.0p+52</p>\n</blockquote>\n\n<p>The addition, made with two <code>double</code> precision constants by the <code>faddl</code> assembly instruction (when I compile with a 32 bits compiler).</p>\n\n<p>The result I obtains is :</p>\n\n<blockquote>\n  <p>4.50359962737049<strong>8</strong>E+15 = 0x1.000000000000<strong>2</strong>p+52</p>\n</blockquote>\n\n<p>Instead of :</p>\n\n<blockquote>\n  <p>4.50359962737049<strong>9</strong>E+15 = 0x1.000000000000<strong>3</strong>p+52</p>\n</blockquote>\n\n<p>(as I was expected and was confirmed by <a href=\"http://weitz.de/ieee/\" rel=\"nofollow noreferrer\">http://weitz.de/ieee/</a>.)</p>\n\n<p>Demonstration:</p>\n\n<blockquote>\n  <p>0x1.0p+52 = 0x10000000000000.00p+0</p>\n  \n  <p>0x1.4008p+1 = 0x2.801p+0</p>\n  \n  <p>0x10000000000000.00p+0 + 0x2.801p+0 = 0x10000000000002.801p+0 <strong>(exactly)</strong></p>\n  \n  <p>0x10000000000002.801p+0 = 0x1.0000000000002<strong>8</strong>01p+52 <strong>(exactly)</strong></p>\n  \n  <p>0x10000000000002.801p+0 = 0x1.000000000000<strong>3</strong>p+52 <strong>(after rounding)</strong></p>\n</blockquote>\n\n<p>I double check and verify in debugging mode that my FPU is in \"round to the nearest mode\".</p>\n\n<p>Something witch is even more strange is that when I compile my code with a 64 bits compiler, and then the <code>addsd</code> instruction is used, there is <strong>no</strong> rounding <strong>error</strong>.</p>\n\n<p>Does anyone can give me reference or explanation about precision differences on 'double' addition on the same FPU but using different instruction set ?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1494435222, "post_id": 43898522, "comment_id": 74830834, "body": "Show your code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1494435223, "post_id": 43898522, "comment_id": 74830836, "body": "Some good reading: <a href=\"http://stackoverflow.com/questions/1641957/is-an-array-name-a-pointer-in-c\" title=\"is an array name a pointer in c\">stackoverflow.com/questions/1641957/&hellip;</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1494435239, "post_id": 43898522, "comment_id": 74830841, "body": "Can you show an example of how you print an array with expected and actual output?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1494435272, "post_id": 43898522, "comment_id": 74830863, "body": "When an array variable is used in an expression, it some contexts it decays to a pointer to the first element but in some contexts it does not."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1494435274, "post_id": 43898522, "comment_id": 74830864, "body": "Because once you <code>print</code> it, you pass it to a function. Once array is passed to a function, it is decaying to a pointer. This is the way it works."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494435471, "post_id": 43898522, "comment_id": 74830970, "body": "Same thing happens also here ptr = arr. where ptr is a pointer and arr is an Array"}, {"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 0, "creation_date": 1494435585, "post_id": 43898522, "comment_id": 74831042, "body": "what do you mean by &#39;address of array elements&#39; ?. Consider an array of 10 elements , then &#39;address of array elements&#39; means the address of all 10 elements. How will that be possible."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1494435587, "post_id": 43898522, "comment_id": 74831043, "body": "That depends....on how you want the output to be formatted....read the man page of printf() first..."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494435674, "post_id": 43898522, "comment_id": 74831101, "body": "Probably you mean Array names and not Array itself, when you ask <code>Why array holds the address of the first element in C?  </code> If not, you could think that this <code>int arr[] = {1,2,3};     int *ptr; ptr = &amp;arr;</code> is OK."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 3106531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a4a089a86f815752131f0a469d37c5?s=128&d=identicon&r=PG&f=1", "display_name": "fernan", "link": "https://stackoverflow.com/users/3106531/fernan"}, "is_accepted": false, "score": 0, "last_activity_date": 1494436879, "creation_date": 1494436879, "answer_id": 43899018, "question_id": 43898522, "link": "https://stackoverflow.com/questions/43898522/why-array-holds-the-address-of-the-first-element-in-c/43899018#43899018", "title": "Why array holds the address of the first element in C?", "body": "<p>The difference between an array and a pointer is that the compiler knows about the array size and dimensions so it can perform some static checks address computations that are not possible with just pointers.</p>\n\n<p>Additionally in the case of printf() it doesn't matter what you pass it because it's a variadic function. It doesn't know anything about the type of the arguments that you pass it except from the format string so if you pass a <code>%s</code> argument you're in effect casting it to <code>char*</code>. The only reason the compiler may give you a warning if you pass an argument of the wrong type is because it's an intrinsic function and the compiler knows about it.</p>\n\n<p>Most functions that take arrays take them as pointer arguments so you're also implicitly casting the array to a pointer when calling a function unless the function specifies an array type as argument.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7761522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1494465683, "creation_date": 1494435118, "last_edit_date": 1495542366, "question_id": 43898522, "link": "https://stackoverflow.com/questions/43898522/why-array-holds-the-address-of-the-first-element-in-c", "title": "Why array holds the address of the first element in C?", "body": "<p>Some says that array in c is not a pointer to the first element of the array\n<a href=\"https://stackoverflow.com/questions/18518255/why-is-array-name-a-pointer-to-the-first-element-of-the-array\">why is array name a pointer to the first element of the array?</a>\nSo when you print the array in c using \"printf\" for example why it is showing the address of the first element instead of the array elements?</p>\n\n<p><strong>Update:</strong></p>\n\n<pre><code>const char  h[10]=\"Hello\";\nprintf(\"%p\", h);\n</code></pre>\n\n<p>Output: 00AFFE0C</p>\n\n<p>well as one answer said said that this happens because of the %type I specified and that made sense because when I write </p>\n\n<pre><code>printf(\"%s\", h);\nOR\nprintf(h);\n</code></pre>\n\n<p>Output: Hello</p>\n\n<p>here two questions rises:</p>\n\n<p>1) In printf(h); why it is not decaying the array and printing the pointer value because in decaying array will be converted to pointer</p>\n\n<p>2) how can I print an array of int in the same way i.e. what is the %type in printf for array of int</p>\n"}, {"tags": ["android", "c"], "answers": [{"comments": [{"owner": {"reputation": 1989, "user_id": 717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036531ea3b93c552a25172af0f2c7ce7?s=128&d=identicon&r=PG", "display_name": "atonyc", "link": "https://stackoverflow.com/users/717400/atonyc"}, "edited": false, "score": 0, "creation_date": 1494576254, "post_id": 43898464, "comment_id": 74897389, "body": "Thanks! I think I was looking for more specific libraries (but was very unclear), or thoughts on whether it were smarter and cleaner to just rewrite. I&#39;m deeper into it now though, so I&#39;ll update with code samples."}], "tags": [], "owner": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "is_accepted": true, "score": 3, "last_activity_date": 1494434959, "creation_date": 1494434959, "answer_id": 43898464, "question_id": 43898384, "link": "https://stackoverflow.com/questions/43898384/including-c-in-android-cfabsolutetime-cfgregoriandate-etc/43898464#43898464", "title": "Including C in Android: CFAbsoluteTime, CFGregorianDate, etc", "body": "<blockquote>\n  <p>when I'm including the library in Android, I'm getting errors with the CFAbsoluteTime and CFGregorianDate types</p>\n</blockquote>\n\n<p>It would appear that <a href=\"https://developer.apple.com/reference/corefoundation/cfgregoriandate\" rel=\"nofollow noreferrer\"><code>CFGregorianDate</code></a> and <a href=\"https://developer.apple.com/reference/corefoundation/cfabsolutetime?language=objc\" rel=\"nofollow noreferrer\"><code>CFAbsoluteTime</code></a> are classes from an Apple SDK (\"Core Foundation\").</p>\n\n<blockquote>\n  <p>should I rewrite the C to remove the offending data types?</p>\n</blockquote>\n\n<p>The Android NDK does not contain Core Foundation APIs. So, either remove references to those APIs, or find some cross-platform port of them.</p>\n"}], "owner": {"reputation": 1989, "user_id": 717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036531ea3b93c552a25172af0f2c7ce7?s=128&d=identicon&r=PG", "display_name": "atonyc", "link": "https://stackoverflow.com/users/717400/atonyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 43898464, "answer_count": 1, "score": 0, "last_activity_date": 1495160007, "creation_date": 1494434714, "last_edit_date": 1495160007, "question_id": 43898384, "link": "https://stackoverflow.com/questions/43898384/including-c-in-android-cfabsolutetime-cfgregoriandate-etc", "title": "Including C in Android: CFAbsoluteTime, CFGregorianDate, etc", "body": "<p>I have a cross-platform project which involves using the same C source library in both ios and Android.</p>\n\n<p>The ios version works well, but when I'm including the library in Android, I'm getting errors with some CoreFoundation types such as CFAbsoluteTime and CFGregorianDate.</p>\n\n<p>I've tried using <a href=\"https://github.com/mlabbe/CoreFoundation\" rel=\"nofollow noreferrer\">CoreFoundation Lite</a>, but configuring the prerequisites has been a mess. It feels like overkill for just a couple of datatypes.</p>\n\n<p>Am I on the right track here? Are there \"quick\" replacements for CFAbsoluteTime and CFGregorianDate, or should I be trying to make the library work?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1494432571, "post_id": 43897643, "comment_id": 74829240, "body": "An array decays into a pointer when is passed to a function, and thats what you get inside the function: the size of a pointer."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1494433844, "post_id": 43897643, "comment_id": 74830007, "body": "@Fredrik both values are 4 on a 32bit system or 8 on a 64bit system."}, {"owner": {"reputation": 574, "user_id": 5639712, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/537518938b29f95cfbabcf9c97bbe9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5639712/marco"}, "edited": false, "score": 0, "creation_date": 1494437050, "post_id": 43897643, "comment_id": 74831898, "body": "I want to know the number of items. sizeof(*phrase) returns the number of chars in the array. I obtained the operation from a Stackoverflow post. And it runs when i do that in the main functions."}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1494446141, "post_id": 43897643, "comment_id": 74837187, "body": "Use a function like this: <code>void composeList(char * phrase[], size_t size);</code> and call it like this: <code>composeList(phrase, sizeof(*phrase)&#47;sizeof(phrase[0]));</code>"}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1494446229, "post_id": 43897643, "comment_id": 74837232, "body": "Another tip is to use always use <code>-Wall</code> and <code>-Wextra</code> when compiling. In this case it will warn about your problem"}], "owner": {"reputation": 574, "user_id": 5639712, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/537518938b29f95cfbabcf9c97bbe9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5639712/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1494432445, "answer_count": 0, "score": 0, "last_activity_date": 1494432297, "creation_date": 1494432297, "question_id": 43897643, "link": "https://stackoverflow.com/questions/43897643/array-of-char-as-argument-in-c", "closed_reason": "Duplicate", "title": "Array of char * as argument in c", "body": "<p>I'm trying to pass an array of char * defined with braces and with static strings, and I want to pass it as an argument to a function.</p>\n\n<p>The array is the next:</p>\n\n<pre><code>char * phrase[] = {\"my\", \"name\", \"is\", \"John\"};\n</code></pre>\n\n<p>and the function which is going to receive the argument is implemented as follows:</p>\n\n<pre><code>void composeList(char * phrase[]){\n  //I'm getting the size of the list\n  int phrase_list_size = sizeof(*phrase)/sizeof(phrase[0]);\n  printf(\"%d\\n\",phrase_list_size);\n}\n</code></pre>\n\n<p>I call that function in this way:</p>\n\n<pre><code>composeList(phrase);\n</code></pre>\n\n<p>But when I print the size the value is 1 instead of 4. Could you help me?</p>\n"}, {"tags": ["java", "c", "c++11", "java-native-interface", "jnienv"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1494437057, "post_id": 43897532, "comment_id": 74831902, "body": "Have  you tried using <code>while?</code>"}, {"owner": {"reputation": 13, "user_id": 6633222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/285108ece716dbdc23a328a0c3ffc9e2?s=128&d=identicon&r=PG&f=1", "display_name": "mike_q", "link": "https://stackoverflow.com/users/6633222/mike-q"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1494439378, "post_id": 43897532, "comment_id": 74833276, "body": "for loop or while  loop it&#39;s the same thing , just diffrent condition"}], "answers": [{"tags": [], "owner": {"reputation": 2591, "user_id": 1366016, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/6ZjQr.jpg?s=128&g=1", "display_name": "Wheezil", "link": "https://stackoverflow.com/users/1366016/wheezil"}, "is_accepted": false, "score": 1, "last_activity_date": 1495028370, "last_edit_date": 1495028370, "creation_date": 1494771506, "answer_id": 43964945, "question_id": 43897532, "link": "https://stackoverflow.com/questions/43897532/jni-return-string-array-from-c-c11-and-use-on-java-without-for-loop-on-c-s/43964945#43964945", "title": "jni return string array from c / c++11 and use on java without for loop on c++ side?", "body": "<p>In order to return a String[] to Java via JNI, you must create the array and then convert and set each string into the array.  There isn't any shortcut like passing the char** back to Java.  </p>\n\n<p>However... if your goal is to avoid creating Java Strings in C++ via JNI, and do it in Java instead, you can accomplish this.  There are sometimes good reasons for doing so.  In our software, we hand complex data structures from C++ to Java.  We've found that using JNI to build the data structures is very slow (JNI method calls are like 1000 clock cycles each).  It is often faster to serialize to a byte array in C++, create a single JNI byte array, hand it across the JNI boundary to Java, and have the Java deserialize the byte array.</p>\n\n<p>I'm not going to give you a complete, working example, but it goes something like this.  I'm going to build a byte array in C++ that has nulls between each string, then hand it to Java for process into a List (easier than String[]).</p>\n\n<p>C++:</p>\n\n<pre><code>// Find overall length with nulls\nint len = 0;\nfor (int i = 0; i &lt; sizeof(days)/sizeof(char*); i++) {\n   len += strlen(days[i]) + 1;\n}\n// Fill C++ byte array\nchar* cBytes = new char[len];\nchar* ptr = cBytes;\nfor (int i = 0; i &lt; sizeof(days)/sizeof(char*); i++) {\n   strcpy(ptr, days[i]); \n   ptr += strlen(days[i]) + 1;\n}\n// Copy C++ to Java\njbyteArray jBytes = env-&gt;NewByteArray(len);\nenv-&gt;SetByteArrayRegion(jBytes, 0, len, cBytes);\ndelete [] cBytes;\nreturn jBytes;\n</code></pre>\n\n<p>Java:</p>\n\n<pre><code>byte jBytes[] = // call C++ via JNI\nList&lt;String&gt; strs = new ArrayList&lt;&gt;();\nint offset = 0;\n// break byte array at null, convert to String\nwhile (offset &lt; jBytes.length) {\n   for (int i = offset; true; i++) {\n      if (jBytes[i] == 0) {\n         // Default code page assumed.  You could also pass a Charset.\n         strs.add(new String(jBytes, offset, i - offset));\n         offset = i + 1;\n         break;\n      }\n   }\n}\n</code></pre>\n\n<p>I realize that there are \"even more optimal\" ways of passing arrays between C++ and Java, usually involving some sort of NativeByteBuffer wrapper.  But these methods often have special cases and are more complex.</p>\n"}], "owner": {"reputation": 13, "user_id": 6633222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/285108ece716dbdc23a328a0c3ffc9e2?s=128&d=identicon&r=PG&f=1", "display_name": "mike_q", "link": "https://stackoverflow.com/users/6633222/mike-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1495028370, "creation_date": 1494431968, "last_edit_date": 1494432699, "question_id": 43897532, "link": "https://stackoverflow.com/questions/43897532/jni-return-string-array-from-c-c11-and-use-on-java-without-for-loop-on-c-s", "title": "jni return string array from c / c++11 and use on java without for loop on c++ side?", "body": "<p>why make a foor loop once on jni side  and one more on java side ?\ni'ts possible to return just the array without for loop ?</p>\n\n<pre><code>JNIEXPORT jobjectArray JNICALL Java_main_returndays(JNIEnv *env, jobject jobj)\n{\n\n  char *days[]={\"Sunday\",\n                \"Monday\",\n                \"Tuesday\",\n                \"Wednesday\",\n                \"Thursday\",\n                \"Friday\",\n                \"Saturday\"};\n\n  jstring str;\n  jobjectArray day = 0;\n  jsize len = 7;\n  int i;\n\n  day = (*env)-&gt;NewObjectArray(env,len,(*env)-&gt;FindClass(env,\"java/lang/String\"),0);\n\n  for(i=0;i&lt;7;i++)//// without this loop ?\n  {\n    str = (*env)-&gt;NewStringUTF(env,days[i]);\n    (*env)-&gt;SetObjectArrayElement(env,day,i,str);\n  }\n\nreturn day;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1494431645, "post_id": 43897400, "comment_id": 74828692, "body": "<code>%</code>, not <code>$</code>..."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1494431659, "post_id": 43897400, "comment_id": 74828697, "body": "<code>c=(int*)(malloc(1)); [...] *c=5;</code> Out-of-bounds access, undefined behavior."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1494431747, "post_id": 43897400, "comment_id": 74828755, "body": "Also FWIW this code is super non-idiomatic - variables of different types declared on the same line, functions declared inside functions, old-style function definitions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1494431812, "post_id": 43897400, "comment_id": 74828805, "body": "Are you learning C from a 30 year old textbook? Please find something more recent."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494432031, "post_id": 43897400, "comment_id": 74828939, "body": "Ah! K &amp; R. Save yourself some trouble, use C11."}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "edited": false, "score": 0, "creation_date": 1494432208, "post_id": 43897400, "comment_id": 74829027, "body": "@ EOF Thanks a lot."}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "edited": false, "score": 0, "creation_date": 1494432243, "post_id": 43897400, "comment_id": 74829043, "body": "@ Barmar Thanks for you suggestion"}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "edited": false, "score": 0, "creation_date": 1494432306, "post_id": 43897400, "comment_id": 74829080, "body": "@ Oliver Charlesworth could you please tell me new type of declaration please?"}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1494432520, "post_id": 43897400, "comment_id": 74829206, "body": "<a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/562303/&hellip;</a>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494434796, "post_id": 43897400, "comment_id": 74830582, "body": "@aminbk You should start with <code>int main(void){}</code>"}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494442488, "post_id": 43897400, "comment_id": 74835086, "body": "@Michi Thank you"}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1494442500, "post_id": 43897400, "comment_id": 74835091, "body": "@Oliver Charlesworth Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494434937, "post_id": 43897684, "comment_id": 74830662, "body": "What&#39;s the story of <code>int argc, char *argv[]</code> here?"}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "edited": false, "score": 0, "creation_date": 1494442391, "post_id": 43897684, "comment_id": 74835024, "body": "@Joans Thank you"}], "tags": [], "owner": {"reputation": 557, "user_id": 6779190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcba1950ebc59c140e0bb91699b5b9af?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/6779190/jonas"}, "is_accepted": false, "score": 0, "last_activity_date": 1494433061, "last_edit_date": 1494433061, "creation_date": 1494432441, "answer_id": 43897684, "question_id": 43897400, "link": "https://stackoverflow.com/questions/43897400/incorrect-result-in-c-code/43897684#43897684", "title": "Incorrect result in c code", "body": "<p>As @OliverCharlesworth states in his comment the problem here is that you use <code>$d</code> instead of <code>%d</code>. As a result of this the format-string only uses the first argument <code>a[1]</code>. Simply replace <code>$d</code>with <code>%d</code>and your code should work fine. </p>\n\n<p>On another node. C are zero-indexed. You are accessing arrays as if they were one-index. This will cause you problems at some point, as you are accessing unallocated memory. Thus when declaring an array <code>int a[2]</code>, should access it using index <code>0</code> and <code>1</code>.(<code>a[0]</code> and <code>a[1]</code>)</p>\n\n<p>I have taken the liberty to rewrite your code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid myfunction(int x, int* y, int *d);\n\nint main(int argc, char *argv[])\n{\n    double b;\n    int a[2], *c; \n\n\n    c  = (int*)(malloc(sizeof(c)));\n    b  = 10.;\n    *c = 5;\n    a[0] = 1;\n    a[1] = 2;\n\n    printf(\"before call %f %d %d %d\\n\", b, a[0], a[1], *c);\n    printf(\"before call %f %d %d %d\\n\", b, a[0], a[1], *c);\n    myfunction(b,a,c);\n    printf(\"after call %f %d %d %d\\n\", b, a[0], a[1], *c);\n}\n\nvoid myfunction(int x, int * y, int * d) \n{\n    x = 2 * x;\n    y[0] = 3 * y[0];\n    y[1] = 3 * y[1];\n    *d = *d + 2;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1494434886, "post_id": 43897707, "comment_id": 74830633, "body": "<code>int argc,</code> and <code>char **argv</code> are not used. Why <code>int main(int argc, char **argv)</code> and not <code>int main(void)</code>? <code>Z</code> is unused."}, {"owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "edited": false, "score": 0, "creation_date": 1494442412, "post_id": 43897707, "comment_id": 74835034, "body": "@pm100 Thank you"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 1, "last_activity_date": 1494432499, "creation_date": 1494432499, "answer_id": 43897707, "question_id": 43897400, "link": "https://stackoverflow.com/questions/43897400/incorrect-result-in-c-code/43897707#43897707", "title": "Incorrect result in c code", "body": "<p>How your code should look</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n void myfunction(double x, int y[2], int *d);\n\nint main(int argc, char **argv)\n{\n   int a[2];\n    int *c = malloc(sizeof(int));\n    double b=10.0;\n    *c = 5;\n    a[0]=1;\n    a[1]=2;\n\n    printf(\"before call %f %d %d %d\\n\",b,a[0],a[1],*c);\n    myfunction(b,a,c);\n    printf(\"after call %f %d %d %d\\n\",b,a[0],a[1],*c);\n}\n\nvoid myfunction(double x, int y[2], int *d)\n{\n    double z;\n    x=2*x;\n    y[0]=3*y[0];\n    y[1]=3*y[1];\n    *d =*d+2;\n}\n</code></pre>\n\n<p>Note, malloc correct size</p>\n\n<p>arrays start at 0</p>\n\n<p>modern declarations of functions</p>\n\n<p>declaring variables at time of first use.</p>\n\n<p>fixed prrintf format (% not $)</p>\n"}], "owner": {"reputation": 173, "user_id": 2346655, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/30b790334a8233985b242727e0d1ce09?s=128&d=identicon&r=PG", "display_name": "amin bk", "link": "https://stackoverflow.com/users/2346655/amin-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 43897707, "answer_count": 2, "score": -6, "last_activity_date": 1494433061, "creation_date": 1494431593, "last_edit_date": 1494431753, "question_id": 43897400, "link": "https://stackoverflow.com/questions/43897400/incorrect-result-in-c-code", "title": "Incorrect result in c code", "body": "<p>I have this code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nmain()\n{\n    double b;int a[2],*c; \n    void myfunction();\n    c=(int*)(malloc(1));\n    b=10.;\n    *c=5;\n    a[1]=1;a[2]=2;\n\n    printf(\"before call %f $d $d %d\\n\",b,a[1],a[2],*c);\n    printf(\"before call %f $d $d %d\\n\",b,a[1],a[2],*c);\n    myfunction(b,a,c);\n    printf(\"after call %f $d $d %d\\n\",b,a[1],a[2],*c);\n}\n\nvoid myfunction(x,y,d)\n     double x;int y[2],*d;\n{\n    double z;\n    x=2*x;\n    y[1]=3*y[1];\n    y[2]=3*y[2];\n    *d =*d+2;\n}\n</code></pre>\n\n<p>when I execute it I receive this</p>\n\n<pre><code>before call 10.000000 $d $d 1\nbefore call 10.000000 $d $d 1\nafter call 10.000000 $d $d 3\n</code></pre>\n\n<p>I expect to get 5 in first and second call and 7 in the last call, also \na[i] is not shown.\ncould you please advise me why?\nThanks</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494431872, "post_id": 43897353, "comment_id": 74828851, "body": "Multicast data is UDP. So what do you mean by &quot;both UDP and multicast data&quot;?"}, {"owner": {"reputation": 1263, "user_id": 3938402, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3db2c7bcda762ef0a3017108b1446094?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/3938402/harry"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494431955, "post_id": 43897353, "comment_id": 74828893, "body": "@Barmar I mean both point-to-point and multicast data"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494432307, "post_id": 43897353, "comment_id": 74829082, "body": "I don&#39;t think you can do it. In order to receive multicast data you have to join the multicast group, which is like binding to a specific local address. Then it won&#39;t receive packets sent to any other address, including the machine&#39;s real IP."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494432369, "post_id": 43897353, "comment_id": 74829112, "body": "Do you really need to use the same socket for both? Why not use two sockets, and use <code>select()</code> to wait for a packet on either of them?"}, {"owner": {"reputation": 1263, "user_id": 3938402, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3db2c7bcda762ef0a3017108b1446094?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/3938402/harry"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1494432432, "post_id": 43897353, "comment_id": 74829152, "body": "@Barmar I can use another socket, but want to know if it is possible using a single socket"}], "answers": [{"tags": [], "owner": {"reputation": 2418, "user_id": 5128826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b54c3cd8c70aad8122d9391ce8028a?s=128&d=identicon&r=PG&f=1", "display_name": "nsilent22", "link": "https://stackoverflow.com/users/5128826/nsilent22"}, "is_accepted": false, "score": 0, "last_activity_date": 1494535998, "creation_date": 1494535998, "answer_id": 43925345, "question_id": 43897353, "link": "https://stackoverflow.com/questions/43897353/receive-unicast-and-multicast-data-using-a-single-socket/43925345#43925345", "title": "receive unicast and multicast data using a single socket", "body": "<p>It is possible. Or at least 'kind-of' possible.</p>\n\n<p>Consider following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n\nint main(void) {\n    struct sockaddr_in vSSocket;\n    vSSocket.sin_family = AF_INET;\n    vSSocket.sin_addr.s_addr = INADDR_ANY;\n    vSSocket.sin_port = htons(1234);\n\n    int vSocket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n    if (vSocket &lt; 0) {\n        perror(\"socket\");\n        return 1;\n    }\n\n    struct ip_mreq vReq;\n    vReq.imr_multiaddr.s_addr = inet_addr(\"235.5.5.5\");\n    vReq.imr_interface.s_addr = inet_addr(\"123.1.2.3\");\n    if (setsockopt(vSocket, IPPROTO_IP, IP_ADD_MEMBERSHIP, &amp;vReq, sizeof(vReq)) &lt; 0) {\n        perror(\"setsockopt 2\");\n        return 1;\n    }\n    if (bind(vSocket, (struct sockaddr *)&amp;vSSocket, sizeof(vSSocket)) == -1) {\n        perror(\"bind\");\n        return 1;\n    }\n    ssize_t r;\n    char vBuf[256];\n    while (1) {\n        r = recv(vSocket, vBuf, sizeof(vBuf), 0);\n        if (r &lt; 0) {\n            perror(\"recv\");\n            break;\n        }\n        if (memcmp(vBuf, \"quit\", 4) == 0) {\n            printf(\"quit\\n\");\n            break;\n        }\n        write(1, vBuf, r);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The trick is: you bind your socket to <code>INADDR_ANY</code> address. So it will listen on <strong>every</strong> interface your machine has. Additionally, interface that has address 123.1.2.3 joins multicast group 235.5.5.5, so it will receive any packet for that address.</p>\n\n<p>You can test this solution using superb <code>socat</code> tool.\nTo send to multicast address:</p>\n\n<pre><code>socat STDIO UDP4-DATAGRAM:235.5.5.5:1234\n</code></pre>\n\n<p>To send to unicast address:</p>\n\n<pre><code>socat STDIO UDP4-DATAGRAM:123.1.2.3:1234\n</code></pre>\n\n<p>The program should output anything you send to it and quit upon reception of a packet beginning with 'quit'.</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 6322839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684a3344526864eeae67b190890520d5?s=128&d=identicon&r=PG&f=1", "display_name": "serafean", "link": "https://stackoverflow.com/users/6322839/serafean"}, "is_accepted": false, "score": 0, "last_activity_date": 1537269262, "creation_date": 1537269262, "answer_id": 52385349, "question_id": 43897353, "link": "https://stackoverflow.com/questions/43897353/receive-unicast-and-multicast-data-using-a-single-socket/52385349#52385349", "title": "receive unicast and multicast data using a single socket", "body": "<p>Yes you can. nsilent22 has the first 90%.</p>\n\n<ul>\n<li>Bind the socket to <code>INADDR_ANY</code></li>\n<li>Set <code>IP_ADD_MEMBERSHIP</code> (ipv6: <code>IPV6_JOIN_GROUP</code>)</li>\n<li>If sending is required, set <code>IP_MULTICAST_IF</code> (ipv6: <code>IPV6_MULTICAST_IF</code>) to set the output interface of multicast packets.</li>\n</ul>\n\n<p>This gets you a socket that listens on a multicast group, but also receives all unicast traffic to the machine. To limit it to a single interface, you have two options:</p>\n\n<ul>\n<li>Set <code>IP_PKTINFO</code> (ipv6: <code>IPV6_RECVPKTINFO</code>), receive data using recvmsg, and filter received data based on the <code>ipi_ifindex</code> member of the <code>in_pktinfo</code> structure (ipv6: <code>ipi6_ifindex</code> member of <code>struct in6_pktinfo</code>).</li>\n<li>Set the (linux specific) socket option <code>SO_BINDTODEVICE</code> (root privileges required)</li>\n</ul>\n\n<p>This way you get a socket that receives multicast traffic from select multicast groups, as well as all unicast traffic, but limited to a single interface.</p>\n\n<p>Sources: manpages for ip,ipv6 and socket.</p>\n"}], "owner": {"reputation": 1263, "user_id": 3938402, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3db2c7bcda762ef0a3017108b1446094?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/3938402/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1150, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1537269262, "creation_date": 1494431488, "last_edit_date": 1494432236, "question_id": 43897353, "link": "https://stackoverflow.com/questions/43897353/receive-unicast-and-multicast-data-using-a-single-socket", "title": "receive unicast and multicast data using a single socket", "body": "<p>I am developing a network based application wherein I want to receive both unicast and multicast data. So I want to know whether it is possible to receive both unicast data and multicast data using a single socket. This is my code, as of now I am only able to receive unicast data but not multicast data.</p>\n\n<pre><code>void* rec(void* t)\n{\n    printf(\"Rec Thread created\\n\");\n    char buf[200];\n    struct sockaddr_in soc;\n    soc.sin_family=AF_INET;\n    soc.sin_addr.s_addr=inet_addr(\"123.1.2.3\");\n    soc.sin_port=htons(1234);\n\n    long sock_fd=socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);\n\n    bind(sock_fd,(struct sockaddr *)&amp;soc,sizeof(sockaddr_in));\n\n    struct ip_mreq mreq;\n    memset(&amp;mreq,0,sizeof(struct ip_mreq));\n    mreq.imr_multiaddr.s_addr=inet_addr(\"235.5.5.5\");\n    mreq.imr_interface.s_addr=inet_addr(\"123.1.2.3\");\n\n    setsockopt(sock_fd,IPPROTO_IP,IP_ADD_MEMBERSHIP,&amp;mreq,sizeof(mreq)) \n\n    while(true)\n    {\n        memset(buf,0,sizeof(buf));\n        long size=recvfrom(sock_fd,buf,200,0,NULL,NULL);\n        if(size&gt;0)\n        {\n            printf(\"recvd %s\\n\",buf);\n        }\n        else\n        {\n            perror(\"Error receving data\");\n        }\n    }\n}\n\nint main(int argc,char* argv[])\n{\n    pthread_create(&amp;pt,NULL,rec,NULL);\n    sleep(2);\n    char buf[]=\"Hello World!;\n    struct sockaddr_in soc;\n    soc.sin_family=AF_INET;\n    soc.sin_addr.s_addr=inet_addr(\"123.1.2.3\");\n    soc.sin_port=htons(1234);\n\n    long sock_fd=socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);\n\n    sendto(sock_fd,buf,sizeof(buf),0,(struct sockaddr *)&amp;soc,sizeof(sockaddr_in));\n\n    struct sockaddr_in msoc;\n    msoc.sin_family=AF_INET;\n    msoc.sin_addr.s_addr=inet_addr(\"235.5.5.5\");\n    msoc.sin_port=htons(1234);\n\n    char mbuf[]=\"Hi All!\";\n    sendto(sock_fd,mbuf,sizeof(mbuf),0,(struct sockaddr *)&amp;msoc,sizeof(sockaddr_in));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "keil"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494431506, "post_id": 43897252, "comment_id": 74828604, "body": "Given it is highly unlikely that anyone here has this specific hardware, nor that someone is going to study the datasheets and manuals for it, I don&#39;t really understand what kind of help you are hoping to get here."}, {"owner": {"reputation": 5013, "user_id": 1619432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8SFy2.png?s=128&g=1", "display_name": "handle", "link": "https://stackoverflow.com/users/1619432/handle"}, "edited": false, "score": 0, "creation_date": 1494433286, "post_id": 43897252, "comment_id": 74829649, "body": "<a href=\"https://www.sparkfun.com/products/11792\" rel=\"nofollow noreferrer\">Demo software for PC is available in the documents below, simply connect the module to your computer using an FTDI Breakout and start the software to read fingerprints!</a>"}, {"owner": {"reputation": 1, "user_id": 7992720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b15170186a2015f44d9bd44b3bb688f?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Buns", "link": "https://stackoverflow.com/users/7992720/mark-buns"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494473176, "post_id": 43897252, "comment_id": 74845462, "body": "The kind of help that recognizes that I am missing something if there is someone out there who has messed with something similar or even the same thing because I&#39;ve spent a million hours stuck at a standstill... but thanks for the worthless comment &lt;3 @EugeneSh."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494511879, "post_id": 43897252, "comment_id": 74868929, "body": "You are welcome. As you can see there are not too many answers you are getting. My comment explains you why it is, if you are wondering. This is what comments are for."}], "owner": {"reputation": 1, "user_id": 7992720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b15170186a2015f44d9bd44b3bb688f?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Buns", "link": "https://stackoverflow.com/users/7992720/mark-buns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564837493, "creation_date": 1494431140, "last_edit_date": 1564837493, "question_id": 43897252, "link": "https://stackoverflow.com/questions/43897252/gt-511c3-fingerprint-scanner-with-stm32f407g-microcontroller", "title": "GT-511C3 Fingerprint Scanner with STM32F407G Microcontroller", "body": "<p>I am working on a project that requires using the GT-511C3 fingerprint scanner with a STM32F407G microcontroller board. I am using Keil uvision 5 and can't figure out how to initialize and turn on the scanner. I've written this code and it seems correct, based off the datasheet, for starting up the scanner and sending the start commands. I've used an oscilloscope to verify that the values are being sent correctly and it seems they are but the scanner is not lighting up. I'm completely lost on what I could be doing wrong or what I could be missing. I've verified the scanner is wired correctly and connected to the board accordingly. Any help would be gr8 :)</p>\n\n<p>Scanner: <a href=\"https://www.digikey.com/catalog/en/partgroup/fingerprint-scanner-ttl-gt-511c3/56722\" rel=\"nofollow noreferrer\">https://www.digikey.com/catalog/en/partgroup/fingerprint-scanner-ttl-gt-511c3/56722</a></p>\n\n<p>Current Code:</p>\n\n<pre><code>#include \"stm32f4xx.h\"                  // Device header\n\nint i=0;\nint z=0;\n\nint main(){\n\n// ENABLE CLocks for PORT C and UART4\nRCC -&gt; AHB1ENR = 0x00000004; //Enable the clock to GPIO port GPIOCEN\nRCC -&gt; APB1ENR = 0x00080000; //Enable the clock to UART 4 UART4EN\n\n\n\n// Set Mode Pins on Port C pins 10 and 11 to Alternate Function\nGPIOC-&gt;MODER|=0x00A00000;\n\n\n// Set Alternate Function Register for Port C 10 and 11\nGPIOC-&gt;AFR[1]|= 0x00008800; //AFR High = enabled\n\n\n// UART setup:\n// 8 data bits (default), no parity (default), one stop bit (default) &amp; no  flow control (default)\n\n// UART Baud Rate\nUART4-&gt;BRR = 0x683;\n\n// Enable  TRANSMITTER (TE bit)\nUART4-&gt;CR1 |= (1&lt;&lt;3);\nUART4-&gt;CR1 |= (1&lt;&lt;2);\n\n// WE WANT TO TRANSMIT SO ENABLE TRANSMIT INTERRUPT\nUART4-&gt;CR1 |=(1&lt;&lt;7);\n\n\n// Enable UART  (UE bit in CR1 register) \nUART4-&gt;CR1 |=(1&lt;&lt;13);\n\n\n// NVIC to handle interrupts\n\n__enable_irq();\nNVIC_ClearPendingIRQ(UART4_IRQn);\nNVIC_SetPriority(UART4_IRQn,0); \nNVIC_EnableIRQ(UART4_IRQn);\n\nwhile(1){};\n\n}\n\n// Interrupt reoutine for UART1\n\nvoid UART4_IRQHandler(void){\n// TX IRQ \nif(((UART4-&gt;SR)&amp;(1&lt;&lt;7))&gt;0){ //if txe flag in sr is on then\n    if(z==0){\n    int command[]={0x55,0xAA, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x02, 0x01};\n    UART4-&gt;DR=command[i]; // command start code\n    i=i+1;\n    if(i==12){\n        z=1;\n        i=0;\n    }\n}\n    if(z==1){\n    int command1[]={0x55,0xAA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x01, 0x12, 0x00, 0x13, 0x01};\n    UART4-&gt;DR=command1[i]; // command start code\n    i=i+1;\n    if(i==12){\n        z=0;\n        i=0;\n    }\n}\n}\n}\n</code></pre>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1494430740, "post_id": 43897051, "comment_id": 74828104, "body": "You have a major misconception here. These segments need not be remembered in the run-time. They are just used to allocate variables in. And each variable has an address which is located in that segment."}, {"owner": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494430930, "post_id": 43897051, "comment_id": 74828239, "body": "But how can the same code be ran in different places in memory, if it does not have pointers which stores segment &quot;offset&quot;?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494430971, "post_id": 43897051, "comment_id": 74828276, "body": "It can&#39;t unless compiled as &quot;relocatable&quot;."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494431101, "post_id": 43897051, "comment_id": 74828357, "body": "The heap is usually created by the C runtine which is linked with your code (statically or dynamically). It decides an address in the virtual address, calls the operating system provided system calls to map pages and stores the address in some data structure which is used by malloc (and family of functions) as heap."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494431144, "post_id": 43897051, "comment_id": 74828388, "body": "All this code is either executed before calling main or is statically initialized in the binary."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494431241, "post_id": 43897051, "comment_id": 74828455, "body": "The bss segment is normally folded into the data segment after the executable is loaded. The rest of the runtime isn&#39;t affected by this. The variables are located at an appropriate address regardless of where it came from in the executable."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494431251, "post_id": 43897051, "comment_id": 74828462, "body": "As for the bss section, As you know it is filled with all zeroes. The binary has information on the size of the .bss section and the base address. The loader maps pages to this virtual address and clears them with zeroes (in an efficient way)."}, {"owner": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 0, "creation_date": 1494431275, "post_id": 43897051, "comment_id": 74828477, "body": "I think i understand what i dont understand, now (if you understand what i mean). I hadnt read about relocatable programs and virtuel addresses. Thanks for the help"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494431303, "post_id": 43897051, "comment_id": 74828489, "body": "You can see the address of the bss segment and its size by running <code>dumpbin &#47;HEADERS binary.exe</code> if on windows. On Linux you can use <code>objdump</code>. I believe the required flag is <code>-x</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1494517666, "post_id": 43897051, "comment_id": 74873606, "body": "If you were wanting to lay out memory in a specific manner, then you pass a linker command file (usually has the extension: <code>.cmd</code>) to the linker.  This is most useful when there are memory mapped I/O, memory mapped special registers, memory mapped ROM and FLASH, memory mapped peripheral registers, etc,  Most often used when creating executables for (bare metal) embedded systems.  Here is a link to more info for a GNU linker command file: (others are similar) &#39;<a href=\"https://www.math.utah.edu/docs/info/ld_3.html\" rel=\"nofollow noreferrer\">math.utah.edu/docs/info/ld_3.html</a>&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 0, "creation_date": 1494432107, "post_id": 43897453, "comment_id": 74828982, "body": "Thank you for the detailed explenation. Is there any name for this topic, which i can use to find resources? The topic of how compilers and operatingsystems manage memory"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 1, "creation_date": 1494432247, "post_id": 43897453, "comment_id": 74829044, "body": "You can read about &quot;linkers and loaders&quot;. I don&#39;t really have links to resources. For structure of the binary you can read about the ELF file format. It is the most commonly used. Other one is COFF."}, {"owner": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 0, "creation_date": 1494432583, "post_id": 43897453, "comment_id": 74829245, "body": "One last question. If this is the process  of how code is ran, and the code has static knowlage of where the segments are, why do you have segment registers at all?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 1, "creation_date": 1494432755, "post_id": 43897453, "comment_id": 74829336, "body": "Segment registers really hasn&#39;t got anything to do with these segments. The segment registers <b>were</b> used in segmented memory models. Modern architectures (like x86_64) use paging and a flat memory model, where the entire Virtual address is accessible to the program and it can decide how it wants to use it. To answer in short, the segment registers are not used anymore. The base of cs, ds segments is always set to 0 on x86_64."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "edited": false, "score": 1, "creation_date": 1494432879, "post_id": 43897453, "comment_id": 74829409, "body": "If on x86 your program does use segment registers, the bss and heap are usually combined with other .data and .rodata sections as a part of the memory under the data segment. The cs is for code(.text section in the binary), and stack is well for the stack!"}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 3, "last_activity_date": 1494431712, "creation_date": 1494431712, "answer_id": 43897453, "question_id": 43897051, "link": "https://stackoverflow.com/questions/43897051/how-does-a-program-know-where-the-bss-segment-is-located/43897453#43897453", "title": "How does a program know where the bss segment is located", "body": "<p>The heap is usually created by the C runtine which is linked with your code (statically or dynamically). It decides an address in the virtual address, calls the operating system provided system calls to map pages and stores the address in some data structure which is used by malloc (and family of functions) as heap. \nAll this code is either executed before calling main or is statically initialized in the binary. </p>\n\n<p>As for the bss section, As you know it is filled with all zeroes. The binary has information on the size of the .bss section and the base address. The loader maps pages to this virtual address and clears them with zeroes (in an efficient way). </p>\n\n<p>You can see the address of the bss segment and its size by running <code>dumpbin /HEADERS binary.exe</code> if on windows. On Linux you can use <code>objdump</code>. I believe the required flag is <code>-x</code>.</p>\n\n<p>About your question that how can they be moved around if the offsets are hard coded in the instructions -</p>\n\n<p>The binary also has a table called the relocation table which has addresses of all instructions that access these values on a particular section. The loader may decide to place the segment somewhere else (usually happens when you load multiple dlls or shared libraries in Linux). \nIn that case it patches all the instructions looking at the relocation table. It actually changes the offsets in the instruction. This is done by the loader before executing the <code>main</code>.</p>\n\n<p>Ofcourse this has an overhead and can be done only if the relocation information is available. Some binaries may choose to omit the relocation table and in that case the binary fails loading if the section cannot be placed at the specified location. </p>\n\n<p>Hope that clears some of the confusion.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1494433189, "creation_date": 1494433189, "answer_id": 43897938, "question_id": 43897051, "link": "https://stackoverflow.com/questions/43897051/how-does-a-program-know-where-the-bss-segment-is-located/43897938#43897938", "title": "How does a program know where the bss segment is located", "body": "<p>Actually, the simple answer is that the \"bss segment\" is just a number in the executable that tells the loader how much data at a minimum to reserve for the zero-initialized global data. Nothing more.</p>\n\n<p>After having reserved and set to zero this memory, the run-time start-up of the program (be it compiled from Fortran, C or whatever for the particular platform), now reserves more memory and sets up the heap there and next decides where the stack is to go. Following more platform specific initializiation, control is finally transfered to the program entry point as indicated in the executable file, and control is transfered to there. Only now is the program \"live\".</p>\n"}, {"tags": [], "owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "is_accepted": false, "score": 0, "last_activity_date": 1494470226, "creation_date": 1494470226, "answer_id": 43905582, "question_id": 43897051, "link": "https://stackoverflow.com/questions/43897051/how-does-a-program-know-where-the-bss-segment-is-located/43905582#43905582", "title": "How does a program know where the bss segment is located", "body": "<blockquote>\n  <p>As far as i have understood x86 has dedicated registers for pointers to code-, data- and stack segment, but not bss- and heap segment. How does the computer remember where these segments are? Especially heap, since bss is directly after data, but heap often is placed a different place in memory.</p>\n</blockquote>\n\n<p>You are suffering for overlapping terminology. A segment can refer to memory segment under the segmented memory model (as used in pre-64-bit X86). A segment can also refer to an block of memory with common access attributes created by a linker.</p>\n\n<p>Your question appears to refer to the second usage.</p>\n\n<p>You also appear to suffer from an oversimplified view of memory. First of all, there is no heap segment. A heap is one or more blocks of read/write data.</p>\n\n<p>Second, a linker can create multiple demand zero (bss) segments. A linker can also put the segments in any order in memory</p>\n\n<p>Third, the knowledge of segments is only needed at load time. Once the segments are loaded, they are just memory. </p>\n"}], "owner": {"reputation": 735, "user_id": 6347748, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/923058547740595/picture?type=large", "display_name": "Elias Fyksen", "link": "https://stackoverflow.com/users/6347748/elias-fyksen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 43897453, "answer_count": 3, "score": 3, "last_activity_date": 1494470226, "creation_date": 1494430585, "question_id": 43897051, "link": "https://stackoverflow.com/questions/43897051/how-does-a-program-know-where-the-bss-segment-is-located", "title": "How does a program know where the bss segment is located", "body": "<p>As far as i have understood x86 has dedicated registers for pointers to code-, data- and stack segment, but not bss- and heap segment. How does the computer remember where these segments are? Especially heap, since bss is directly after data, but heap often is placed a different place in memory.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1494430119, "post_id": 43896750, "comment_id": 74827701, "body": "According to the docs (<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/stdio.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/basedefs/stdio.h.h&zwnj;&#8203;tml</a>) That should work since <code>FILE    *open_memstream(char **, size_t *);</code> is supposed to be defined in <code>stdio.h</code>, which you&#39;re including... are you sure that your AIX platform supports that primitive?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1494430293, "post_id": 43896750, "comment_id": 74827816, "body": "can you try manually adding <code>FILE *open_memstream(char **, size_t *);</code> and see what happens?"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1494430321, "post_id": 43896750, "comment_id": 74827839, "body": "it seems like your compiler thinks open_memstream(char **, size_t *) returns int. maybe it&#39;s redefined in other headers? did you try compiling with only stdio?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1494559397, "post_id": 43896750, "comment_id": 74890499, "body": "I updated your title to quote the English text of the warning. I&#39;d be surprised if anyone knows what &quot;1506-196&quot; means."}], "answers": [{"comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1494430997, "post_id": 43897159, "comment_id": 74828293, "body": "stdio.h is implemented differently for every compiler?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1494431451, "post_id": 43897159, "comment_id": 74828573, "body": "@CIsForCookies : yes!"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1494431560, "post_id": 43897159, "comment_id": 74828634, "body": "mind. blown. thanks! I thought FILE and such should always be the same, for any platform and any compiler"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1494431608, "post_id": 43897159, "comment_id": 74828659, "body": "Maybe you need to set <code>_POSIX_C_SOURCE</code> or similar to indicate that you want POSIX functions?  You should find the option that rejects calls to undeclared functions."}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494471772, "post_id": 43897159, "comment_id": 74845113, "body": "The stdio.h originally has this function, otherwise it cannot be compiled successfully!  And also redefining _POSIX_C_SOURCE not take effect !!"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1494430860, "creation_date": 1494430860, "answer_id": 43897159, "question_id": 43896750, "link": "https://stackoverflow.com/questions/43896750/xlc-warning-initialization-between-types-struct-and-int-is-not-allow/43897159#43897159", "title": "xlC warning &#39;Initialization between types &quot;struct {...}*&quot; and &quot;int&quot; is not allowed.&#39;", "body": "<p>The warning says that you are affecting an int value to a pointer which is often caused by inderection level errors. And <code>open_memstream</code> is not standard C but POSIX.</p>\n\n<p>Here, it is likely that for xlC, <code>open_memstream</code> is not declared in <code>stdio.h</code>. The compiler then assumes that it should be a function returning int hence the warning. You should ask the man (<code>man open_memstream</code>) to know in what include file it is declared and include it in you source.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1494538472, "last_edit_date": 1494538472, "creation_date": 1494537952, "answer_id": 43925810, "question_id": 43896750, "link": "https://stackoverflow.com/questions/43896750/xlc-warning-initialization-between-types-struct-and-int-is-not-allow/43925810#43925810", "title": "xlC warning &#39;Initialization between types &quot;struct {...}*&quot; and &quot;int&quot; is not allowed.&#39;", "body": "<p>there are a few problems with the posted code.</p>\n\n<ol>\n<li><p>the parameter <code>argc</code> should always be checked to assure the command line argument(s) actually exist.  The compiler outputs a warning about the parameter not being used</p></li>\n<li><p>the call to <code>open_memstream()</code> should have the returned value checked (!=NULL) and if NULL, then call <code>perror()</code> so the proper error message is passed to <code>stderr</code>, including the text of why the system thinks the call failed.</p></li>\n</ol>\n\n<p>So, other than not using the passed parameter <code>argc</code> and not checking the returned value from <code>open_memstream()</code> the program compiles and runs with no problems.</p>\n\n<p>Note the warning about <code>argc</code> can be fixed by having the following as the first statement in the body of <code>main()</code>:</p>\n\n<pre><code>(void)argc;\n</code></pre>\n\n<p>Also, it is a poor programming practice to include header files those contents are not used.  I.E. remove this statement:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n</code></pre>\n\n<p>however, the root of YOUR problem is that the xlC compiler has a bug regarding initialization of arrays.  This discussed at: <code>https://stat.ethz.ch/pipermail/r-sig-mac/2003-October/001009.html</code></p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1494559862, "post_id": 43928575, "comment_id": 74890616, "body": "It would be worth figuring out what the proper way to do this is, instead of doing what you did  , there should be macros you can pre-define to enable this function in the stdio.h header"}], "tags": [], "owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "is_accepted": false, "score": -1, "last_activity_date": 1494607520, "last_edit_date": 1494607520, "creation_date": 1494557867, "answer_id": 43928575, "question_id": 43896750, "link": "https://stackoverflow.com/questions/43896750/xlc-warning-initialization-between-types-struct-and-int-is-not-allow/43928575#43928575", "title": "xlC warning &#39;Initialization between types &quot;struct {...}*&quot; and &quot;int&quot; is not allowed.&#39;", "body": "<p>Finally I have to manually add the following declaration ahead of int main\uff0cthen it is compiled perfectly\uff01\uff01</p>\n\n<pre><code>FILE *open_memstream(char **, size_t *);\n</code></pre>\n\n<p>So the solution of Jean-Fran\u00e7ois is right, but why this would only result in such warning without impacting on the final compiling and running\uff01\uff1f</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494571901, "post_id": 43928893, "comment_id": 74894825, "body": "Thanks a lots to keith and All\uff01  It seems that the declaration of open_memstream should be no any practical meaning in the stdio.h\uff01  Because I have already removed the declaration of open_memstream in the stdio.h,  but it still can be compiled and run successfully w/o the declaration of open_memstream in my program source file\uff01   So I think the first reason should be that compiler would directly find the function of open_memstream in the /usr/lib/libc.a by default\uff01\uff01  And the second reason should be as what you said\uff01"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494575035, "post_id": 43928893, "comment_id": 74896613, "body": "@lylklb: Are you saying you modified <code>stdio.h</code>? Don&#39;t do that. It&#39;s provided by the implementation, and if you change it you can break things. If your system provides it, it should be declared in <i>some</i> header; read your system&#39;s documentation to find out how to use it. Don&#39;t try to use it without a declaration. And don&#39;t confuse function declarations (typically in headers, they tell the compiler how to generate a call) with the code that implements a function (in a binary library)."}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494586229, "post_id": 43928893, "comment_id": 74903764, "body": "Anyway, I think the declaration of open_memstream in stdio.h is  just only a explanatory note\uff01\uff01"}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494586852, "post_id": 43928893, "comment_id": 74904216, "body": "Notes: I just only removed the lines of  open_memstream  declaration  in the stdio.h,  then the program still can be compiled and run\uff01\uff01"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494607492, "post_id": 43928893, "comment_id": 74917871, "body": "@lylklb: If you think a declaration in a standard header is &quot;only an explanatory note&quot;, you don&#39;t have enough knowledge to be modifying standard headers. You risk breaking your implementation in ways we won&#39;t be able to help you with. If there was an <code>open_memstream</code> declaration in your system&#39;s <code>stdio.h</code>, then apparently your system does provide that function, and you need to find out how to make that declaration visible to your code. <code>man open_memstream</code> should provide the necessary information. <b>Don&#39;t modify standard headers</b>. (I know what I&#39;m doing, and I wouldn&#39;t consider doing that.)"}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494645495, "post_id": 43928893, "comment_id": 74930348, "body": "Thanks again\uff01  I know  what you mean\uff01  And I also tested with your program source file, then the same results appeared with either xlc or xlC\uff01 In fact my thought is that just only some specific function declarations(not all others), such as open_memstream,  are explanatory notes\uff01"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494662073, "post_id": 43928893, "comment_id": 74933166, "body": "@lylklb: Function declarations are not &quot;explanatory notes&quot;."}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494669976, "post_id": 43928893, "comment_id": 74935181, "body": "Doesn&#39;t it mean that the declaration of open_memstream is a exception that not takes effect in the stdio.h regradless of its POSIX-2008\uff1f"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494706647, "post_id": 43928893, "comment_id": 74946140, "body": "@lylklb: I don&#39;t think so. Your system supports <code>open_memstream</code>, so it declares it in <code>&lt;stdio.h&gt;</code>, and it has to provide a mechanism to make that declaration visible. Why would it be there in the first place if it never takes effect? You absolutely should <i>not</i> have to declare it yourself above <code>main</code>, and you absolutely should not be modifying your system&#39;s <code>stdio.h</code> file unless you really really know what the heck you&#39;re doing."}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494932200, "post_id": 43928893, "comment_id": 75027264, "body": "I find that the material cause is all POSIX declaration in the original stdio.h are not imported at all during the generation of its intermediate file,  even though specifying with -D _POSIX_C_SOURCE=200809L\uff01That means you must manually add the corresponding POSIX declaration in the program source file if you want to use them\uff01"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494948864, "post_id": 43928893, "comment_id": 75039798, "body": "@lylklb: No sane Unix-like system would work that way. I don&#39;t know what you&#39;re doing wrong, but declaring those functions in your own program is <b>not</b> the right way to do this. There has to be some way to make those declarations visible. You just need to find out what it is. One question you haven&#39;t answered:  why are you using <code>xlC</code> rather than <code>xlc</code>?"}, {"owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494986101, "post_id": 43928893, "comment_id": 75056382, "body": "It would have been my &quot;mistake&quot; for long time\uff01  And I shall correct the bad habit\uff01 Notes: Within IBM VAC environments, almost all of the corresponding xlC(vacpp/bin) files are just the symbolic links to the xlc(vac/bin) files\uff01!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "edited": false, "score": 0, "creation_date": 1494986240, "post_id": 43928893, "comment_id": 75056426, "body": "@lylklb: Even if <code>xlC</code> is a symlink to <code>xlc</code>, it might look at the name to decide whether to compile C or C++. Check the documentation on your system; it should cover this."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1494619686, "last_edit_date": 1494619686, "creation_date": 1494560276, "answer_id": 43928893, "question_id": 43896750, "link": "https://stackoverflow.com/questions/43896750/xlc-warning-initialization-between-types-struct-and-int-is-not-allow/43928893#43928893", "title": "xlC warning &#39;Initialization between types &quot;struct {...}*&quot; and &quot;int&quot; is not allowed.&#39;", "body": "<p>You're getting a warning:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Initialization between types \"struct {...}*\" and \"int\" is not allowed.\n</code></pre>\n\n<p>on this line:</p>\n\n<pre><code>FILE *om = open_memstream(&amp;ls_sh, &amp;len);\n</code></pre>\n\n<p>First problem: the <code>open_memstream</code> is not a standard C library function. It's defined by some versions of POSIX. The man page on my Linux system (Ubuntu 16.10) says:</p>\n\n<blockquote>\n  <p>CONFORMING TO<br>\n         POSIX.1-2008.  These functions are not specified in POSIX.1-2001, and are not widely available on other systems.</p>\n</blockquote>\n\n<p>You might be trying to compile code written for another system (one that provides <code>open_memstream</code> on a different system (one that doesn't provide <code>open_memstream</code>). Or it might be available on your system, but you haven't provided whatever incantation is needed to make it visible. A conforming ISO C implementation is forbidden to define functions in standard headers other than the ones defined by the C standard (unless they use reserved names, which doesn't apply here), but typically there's a way to request conformance to POSIX rather than just to ISO C. If that's the case, the man page on your system should tell you what you need to do: <code>man open_memstream</code>. You might need to define a macro or pass a command-line argument to the compiler.</p>\n\n<p>(This all might have been simpler if all POSIX-specific functions were declared in separate headers rather than sharing the C-standard ones line <code>&lt;stdio.h&gt;</code>, but there are historical reasons why that wasn't done.)</p>\n\n<p>Second problem: You've also asked why you only get a warning. Prior to the 1999 ISO C standard, it was legal to call an undeclared function. The compiler would create an implicit declaration, assuming that the function takes whatever arguments you've passed it and returns a result of type <code>int</code>. If the actual function doesn't match that assumption, the behavior is undefined. The 1999 standard dropped this \"implicit <code>int</code>\" rule, making a call to an undeclared function a <em>constraint violation</em>. But compilers aren't required to reject code that violates such a rule; printing a warning and continuing to compile is valid. Which means that you should take all warnings from your C compiler <em>very</em> seriously.</p>\n\n<p>(If your system doesn't have <code>open_memstream</code>, you might look for <code>fmemopen</code>, which appears to be similar. It's also defined by POSIX and not by ISO C, so the same considerations apply.)</p>\n\n<p><strong>UPDATE</strong> :</p>\n\n<p>Since you're using <code>xlC</code>, I presume you're on an AIX system. Here's the <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_aix_72/com.ibm.aix.basetrf1/open_memstream.htm\" rel=\"nofollow noreferrer\">man page for <code>open_memstream</code> on AIX</a>.</p>\n\n<p>I see there are no instructions for enabling symbols that aren't defined by ISO C. The man page includes an example. Here's a stripped-down version that should compile with out error:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    char *buf;\n    size_t len;\n    FILE *f = open_memstream(&amp;buf, &amp;len);\n}\n</code></pre>\n\n<p>Please try compiling this example. If you get a complaint about <code>open_memstream</code>, most likely you're using some restrictive command-line option (try compiling with just <code>xlc c.c</code>) <em>or</em> you've hacked your <code>stdio.h</code>. If the latter, restore that header file to its original contents. If you didn't save a backup of the original, you <em>really</em> need to stop messing around with your system.</p>\n\n<p>Also, if I recall correctly, <code>xlC</code> is the C++ compiler; the C compiler is <code>xlc</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7991070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711dcf1894609bfbba8a5dfbf2e2803?s=128&d=identicon&r=PG&f=1", "display_name": "lylklb", "link": "https://stackoverflow.com/users/7991070/lylklb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 43928893, "answer_count": 4, "score": 3, "last_activity_date": 1494619686, "creation_date": 1494429839, "last_edit_date": 1494559364, "question_id": 43896750, "link": "https://stackoverflow.com/questions/43896750/xlc-warning-initialization-between-types-struct-and-int-is-not-allow", "title": "xlC warning &#39;Initialization between types &quot;struct {...}*&quot; and &quot;int&quot; is not allowed.&#39;", "body": "<p>The following program om.c is compiled successfully via xlC, except for the warning about 1506-196\uff01\uff01</p>\n\n<p>Anybody who can explain such warning information\uff01\uff1f</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\nint main(int argc, char *argv[])\n{\n    char ch_sh[]=\"This is a program!!\";\n    char k1[1200];\n    char *ls_sh=NULL;\n    size_t len=0;\n    FILE *om = open_memstream(&amp;ls_sh, &amp;len);\n    fprintf(om, \"   %32s\", ch_sh);\n    if ( argv[1] != NULL )\n    {\n        fprintf(om, \"%26s\", argv[1]);\n        fclose(om);\n        sprintf(k1, \"echo %s\", ls_sh);\n        system(k1);\n        printf(\"\\ndone message in program\\n\");\n    }\n    else\n    {\n        printf(\"Error: Empty input\\n\");\n        return 1;\n    }\n    free(ls_sh);\n}\n</code></pre>\n\n<p>Compiler log:  </p>\n\n<pre><code> 1. root@psph:/tmp# \n        root@psph:/tmp# \n        root@psph:/tmp# \n        root@psph:/tmp# xlC -o om om.c\n        \"om.c\", line 11.14: 1506-196 (W) Initialization between types \"struct {...}*\" and \"int\" is not allowed.\n        root@psph:/tmp# \n        root@psph:/tmp# xlC -qsrcmsg -o om om.c\n               11 |     FILE *om = open_memstream(&amp;ls_sh, &amp;len);\n                    .............a..............................\n        a - 1506-196 (W) Initialization between types \"struct {...}*\" and \"int\" is not allowed.\n\n        root@psph:/tmp# ./om data1    \n        This is a program!! data1\n        done message in program\n        root@psph:/tmp# \n        root@psph:/tmp# xlC -qversion\n        IBM XL C/C++ for AIX, V11.1 (5724-X13)\n        Version: 11.01.0000.0000\n        Driver Version: 11.01(C/C++) Level: 100304\n        C Front End Version: 11.00(C/C++) Level: 100301\n        C++ Front End Version: 11.01(C/C++) Level: 100304\n        High-Level Optimizer Version: 11.01(C/C++) and 13.01(Fortran) Level: 100301\n        Low-Level Optimizer Version: 11.01(C/C++) and 13.01(Fortran) Level: 100304\n        root@psph:/tmp# \n        root@psph:/tmp# \n        root@psph:/tmp#\n</code></pre>\n\n<p>That's all\uff01</p>\n"}, {"tags": ["c", "linked-list", "malloc"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1494430221, "post_id": 43896707, "comment_id": 74827779, "body": "<code>(*nodes)-&gt;args[i]=strdup(argsNode[i]); </code>- invokes undefined behavior. You forgot to allocate the pointer bed for <code>args</code>. <code>(*nodes)-&gt;args = malloc(nArgs * sizeof(char*));</code> is missing."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "reply_to_user": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1494430294, "post_id": 43896707, "comment_id": 74827820, "body": "@kuro thanks for the answer, but it didn&#39;t work. Still the same error."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1494430753, "post_id": 43896707, "comment_id": 74828114, "body": "@WhozCraig my answer was to the user kuro that answered before you. Your answer fixed it."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1494431075, "post_id": 43896707, "comment_id": 74828343, "body": "Excellent. Glad it helped. The example of a debugger walk-through in eyalm&#39;s answer is in itself worthy of an upvote, and it points out the outrigt problems. Personally, I&#39;d take that."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1494431411, "post_id": 43897193, "comment_id": 74828545, "body": "Was not aware that using recursion was a bad idea, will fix it. And thanks for the example when it comes to the debugger, will take a better look in to it !"}], "tags": [], "owner": {"reputation": 3268, "user_id": 182634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5b602ab0bc363e3e990f2e904b671d?s=128&d=identicon&r=PG", "display_name": "eyalm", "link": "https://stackoverflow.com/users/182634/eyalm"}, "is_accepted": true, "score": 3, "last_activity_date": 1494430970, "creation_date": 1494430970, "answer_id": 43897193, "question_id": 43896707, "link": "https://stackoverflow.com/questions/43896707/add-list-of-strings-to-linkedlist/43897193#43897193", "title": "Add list of Strings to LinkedList", "body": "<p>There are a few problems.</p>\n\n<p>You must initialize the head of the list:</p>\n\n<pre><code>NODES nodes = NULL;\n</code></pre>\n\n<p>You did not allocate the <code>args</code> array:</p>\n\n<pre><code>(*nodes)-&gt;args = malloc(sizeof(char *)*nArgs)\n</code></pre>\n\n<p>If you want to be sure where the crash is, use a debugger:</p>\n\n<pre><code># gdb ./prog\n(gdb) run\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000004006e9 in insert (nodes=0x7fffffffdc98, idNode=1, \n    cmdNode=0x40088f \"wc\", argsNode=0x7fffffffdca0, nArgs=4, conn=0) at    qq.c:33\n33                  (*nodes)-&gt;args[i]=strdup(argsNode[i]); \n</code></pre>\n\n<p>After the crash:</p>\n\n<pre><code>(gdb) backtrace\n</code></pre>\n\n<p>You will see the exact faulty line </p>\n\n<p>Another thing. It is not realistic to use recursion for linked-list insertion. It will hit the stack limit pretty fast.</p>\n"}], "owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 43897193, "answer_count": 1, "score": 2, "last_activity_date": 1494430970, "creation_date": 1494429726, "question_id": 43896707, "link": "https://stackoverflow.com/questions/43896707/add-list-of-strings-to-linkedlist", "title": "Add list of Strings to LinkedList", "body": "<p>I'm trying to implement a linked list but i'm having some trouble when it comes to add an array of strings to it. It adds the first time with no trouble, but if i call my insert function again I get a \"Segmentation fault: 11\" error.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>typedef struct node_s{\n    int id;\n    char *cmd;\n    char **args;\n    int numArgs;\n    int connected;\n    struct node_s *next;\n}node;\n\ntypedef node *NODES;\n\nvoid insert(NODES *nodes, int idNode, char *cmdNode,char **argsNode, int nArgs,int conn){\n    int i;\n\n    if (!exist(*nodes,idNode))\n    {\n        if(*nodes==NULL){ \n            *nodes = (NODES) malloc(sizeof(struct node_s)); \n            if(*nodes==NULL) \n            {\n                perror(\"malloc err\");\n                return;\n            }\n\n            (*nodes)-&gt;id = idNode;\n            (*nodes)-&gt;cmd = strdup(cmdNode);\n            // Problem\n            for(i=0;i&lt;nArgs;i++)\n                (*nodes)-&gt;args[i]=strdup(argsNode[i]); \n            (*nodes)-&gt;numArgs=nArgs;\n            (*nodes)-&gt;connected=conn;\n            (*nodes)-&gt;next = NULL; \n        }\n        else\n            insert(&amp;(*nodes)-&gt;next,idNode,cmdNode,argsNode,nArgs,conn); \n\n    }\n}\n\nint main()\n{\n    char *cmds[4]={\"wc\", \"-l\", \"another\",\"hello.com\"};\n    NODES nodes;    \n    inicNodes(&amp;nodes);\n    insert(&amp;nodes,1,\"wc\",cmds,4,0);\n// if i try to list my values here it shows them as expected.       \n    insert(&amp;nodes,3,\"ls\",cmds,4,1);\n\n    return 0;\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "function", "matrix", "functional-programming"], "comments": [{"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1494429460, "post_id": 43896565, "comment_id": 74827198, "body": "<code>=</code> is used for assignment. use <code>==</code> for equality check"}, {"owner": {"reputation": 43, "user_id": 7815483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/184902388691676/picture?type=large", "display_name": "Jordi Garc&#237;a", "link": "https://stackoverflow.com/users/7815483/jordi-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1494429498, "post_id": 43896565, "comment_id": 74827226, "body": "sorry for being retarded, i just spent the last 4 hours trying to find a solution.ty so much"}], "answers": [{"comments": [{"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1494429655, "post_id": 43896635, "comment_id": 74827354, "body": "Agreed on the tips to use constant &#39;A&#39; in the left side of <code>==</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1494429659, "last_edit_date": 1494429659, "creation_date": 1494429514, "answer_id": 43896635, "question_id": 43896565, "link": "https://stackoverflow.com/questions/43896565/i-accidentally-change-a-variable-with-a-conditional-sentence-if/43896635#43896635", "title": "I accidentally change a variable with a conditional sentence ( if )?", "body": "<p><code>map-&gt;p[i+1].m[j+1].jugador_id = 'A'</code> is an <em>expression</em> of type <code>int</code><sup>1</sup> equal to whatever <code>'A'</code> is equal to.</p>\n\n<p>On every possible <em>encoding</em><sup>2</sup>, <code>'A'</code> is non-zero, so your <code>if</code> block will always run.</p>\n\n<p>Solution: replace <code>=</code> with <code>==</code>.</p>\n\n<p>Some folk write <code>'A' == map-&gt;p[i+1].m[j+1].jugador_id</code> to induce compile time failures if they slip an <code>==</code>.</p>\n\n<hr>\n\n<p><sup>1</sup>I am not wrong. <code>'A'</code> is an <code>int</code> literal in C, and a <code>char</code> literal in C++.</p>\n\n<p><sup>2</sup>The C standard insists that <code>'A'</code> <strong>cannot</strong> be 0.</p>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1494430618, "creation_date": 1494430618, "answer_id": 43897064, "question_id": 43896565, "link": "https://stackoverflow.com/questions/43896565/i-accidentally-change-a-variable-with-a-conditional-sentence-if/43897064#43897064", "title": "I accidentally change a variable with a conditional sentence ( if )?", "body": "<p>There are two operators in play here, <code>=</code> (assignment operator) and <code>==</code> (equal to (conditional) operator). The assignment operator(<code>=</code>) \"assigns\" the value on the right to the variable on the left. The result value of an assignment statement (say <code>a=b</code>) is <code>b</code>, ie the value being assigned.</p>\n\n<p>The conditional operator on the other hand checks wether the values on either side are equal or not. If yes, the resultant value of the expression is <code>1</code> otherwise it is <code>0</code>. </p>\n\n<hr>\n\n<p>Now in <code>C</code> any non zero value is treated as <code>true</code> and zero is treated as <code>false</code>. Thus the value of the expression <code>map-&gt;p[i+1].m[j+1].jugador_id = 'A'</code>is the value of <code>A</code>(in ASCII 65) which is non zero and hence true. That's why the if block is executed. But at the same time to check for the \"trueness\" of the condition the condition itself has to executed. The condition executes, and value of the variable is set to <code>A</code> </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7987230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ea241cf0de2cc21e33f7cf54c10c53?s=128&d=identicon&r=PG&f=1", "display_name": "C. Hubbard", "link": "https://stackoverflow.com/users/7987230/c-hubbard"}, "is_accepted": false, "score": 1, "last_activity_date": 1494430687, "creation_date": 1494430687, "answer_id": 43897087, "question_id": 43896565, "link": "https://stackoverflow.com/questions/43896565/i-accidentally-change-a-variable-with-a-conditional-sentence-if/43897087#43897087", "title": "I accidentally change a variable with a conditional sentence ( if )?", "body": "<pre><code>map-&gt;p[i+1].m[j+1].jugador_id = 'A'\n</code></pre>\n\n<p>is always going to be true in the if condition, because the assignment operator =\nis used instead of the equivalency operator ==. This means that everytime this if statement is reached, that instead of comparing the variable with 'A', what it is actually doing is setting the value to 'A'. Since the ASCII value of 'A' is not zero, the if statement will always evaluate to true.</p>\n\n<p>The simple fix is to change the statement to have the equivalency operator == instead, so that it compares the value to 'A', and then runs the if block if it is true.</p>\n"}], "owner": {"reputation": 43, "user_id": 7815483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/184902388691676/picture?type=large", "display_name": "Jordi Garc&#237;a", "link": "https://stackoverflow.com/users/7815483/jordi-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43897064, "answer_count": 3, "score": 1, "last_activity_date": 1501319775, "creation_date": 1494429364, "last_edit_date": 1501319775, "question_id": 43896565, "link": "https://stackoverflow.com/questions/43896565/i-accidentally-change-a-variable-with-a-conditional-sentence-if", "title": "I accidentally change a variable with a conditional sentence ( if )?", "body": "<p>Information about the code down below: the function initialise players code is:</p>\n\n<pre><code>void initialise_players (tvector_players *vj){\nint i;  \n  for (i=0; i&lt; (vj-&gt;nplayers); i++){\n      vj-&gt;vjug [i].letter = 'A'+i;\n      vj-&gt;vjug [i].num_regiones = 0;\n\n  }\n}\n</code></pre>\n\n<p>past the previous function call, inside the second for (for (j=0; j &lt; (mapa->num_cols+1);  j++)) i am giving a character to \"map->p[i+1].m[j+1].player_id\".\nThen i print it and everything's ok at the moment. But then i use a conditional sentence which should not influence in any way the last variable and i print it again but this time the value of the variable \"map->p[i+1].m[j+1].player_id\" changes to 'A' for no reason. It would be understandable if the first character given was the 'A' but most of the times its not. Why?</p>\n\n<pre><code>    initialise_players (vj);\n    for (i=0; i &lt; (map-&gt;rows+1); i++){\n        for (j=0; j &lt; (mapa-&gt;num_cols+1);  j++){\n            map-&gt;p[i+1].m[j+1].player_id = 'A'+rand()%vj-&gt;nplayers;\n\n            printf (\"\\n%c\\n\", map-&gt;p[i+1].m[j+1].jugador_id);\n\n            if (map-&gt;p[i+1].m[j+1].jugador_id = 'A'){\n\n                 printf (\"\\n%c\\n\", map-&gt;p[i+1].m[j+1].jugador_id);\n\n                 vj-&gt;vjug[0].num_regiones += 1;\n             }\n        }\n    }\nshow_matrix (map, vj);\n</code></pre>\n"}, {"tags": ["c", "gcc", "optimization"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494429065, "post_id": 43896407, "comment_id": 74826900, "body": "Please add the <code>main</code> function for completeness."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1494429133, "post_id": 43896407, "comment_id": 74826952, "body": "Do you really want volatile and not <code>std::atomic</code> instead."}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494429424, "post_id": 43896407, "comment_id": 74827177, "body": "well this is actually C code and not C++ code. Also I&#39;m not sure hot std::atomic interacts with interrupts."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494429518, "post_id": 43896407, "comment_id": 74827245, "body": "Do you <i>need</i> <code>sg_CpuCount</code> to be an <code>int64_t</code>? I&#39;d try with it being a <code>volatile sig_atomic_t</code> instead."}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494429658, "post_id": 43896407, "comment_id": 74827358, "body": "The main function is not really helpful to this. I think I edited the post with additional information that you may be looking for."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1494429751, "post_id": 43896407, "comment_id": 74827430, "body": "If you&#39;re using counters larger than the natural word size, that can easily cause problems. Have you examined the assembler output with and without optimization? Both those functions could be interesting, and <code>+=</code> on a larger-than-word type is always likely to be problematic."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494429754, "post_id": 43896407, "comment_id": 74827435, "body": "Show us the generated assembly code. The two functions are sufficiently simple so the generated assembly code should be pretty straight forward."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1494430126, "post_id": 43896407, "comment_id": 74827707, "body": "It&#39;s very possible the updates to <code>sg_CpuCount</code> are not occurring atomically."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494430158, "post_id": 43896407, "comment_id": 74827729, "body": "<code>main</code> function <i>is</i> relevant. Please include it. MCVE is required for any &quot;why my code is not working&quot; questions."}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494430259, "post_id": 43896407, "comment_id": 74827796, "body": "I&#39;ll get the asm - I need to figure out how to generate the intermediate files..."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1494430340, "post_id": 43896407, "comment_id": 74827851, "body": "FWIW, this seems mechanism seems like overkill compared to e.g. <code>tmp = sg_CpuCount; return tmp + TMP0-&gt;CNT;</code> (the non-atomicity would affect it either way)."}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494430353, "post_id": 43896407, "comment_id": 74827862, "body": "This code is part of a larger project. main just calls a bunch of init function not related to this portion of the code."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1494431427, "post_id": 43896407, "comment_id": 74828555, "body": "Wait - this logic is weird full-stop!  You&#39;re doing <code>sg_CpuCount + TMP0-&gt;CNT</code>, which only makes sense if they&#39;re in the same units.  Thus your ISR should be incrementing by MAX_VALUE_OF_COUNTER.  So this only makes sense of CPU_CLOCK / TICKRATE_HZ equals that value."}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494431795, "post_id": 43896407, "comment_id": 74828791, "body": "TMP0-&gt;CNT counts from 0 to CPU_CLOCK / TICKRATE_HZ - 1 and then rolls over. So CPU_CLOCK / TICKRATE_HZ is the number of counts per interrupt."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "edited": false, "score": 0, "creation_date": 1494435401, "post_id": 43897505, "comment_id": 74830932, "body": "I realize 64 bit operation will not be atomic, but that is why the if statement in GetCpuCount function to verify sg_CpuCount has not changed from the first reading."}], "tags": [], "owner": {"reputation": 1154, "user_id": 5329483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540d2cd6d0b20c87290f01247f8aae17?s=128&d=identicon&r=PG&f=1", "display_name": "user5329483", "link": "https://stackoverflow.com/users/5329483/user5329483"}, "is_accepted": false, "score": 1, "last_activity_date": 1494431886, "creation_date": 1494431886, "answer_id": 43897505, "question_id": 43896407, "link": "https://stackoverflow.com/questions/43896407/how-do-c-c-optimizations-affect-volatile-variables/43897505#43897505", "title": "How do C/C++ optimizations affect volatile variables?", "body": "<p>If you are on a 32bit machine you cannot guarantee 64bit operations to be atomic. Due to optimizations timings may shift. And never ever call the function with interrupts disabled. </p>\n\n<pre><code>static volatile uint32_t sg_CpuCount;\n\nvoid TPM0_IRQHandler(void)\n{\n   TPM0-&gt;SC |= TPM_SC_TOF(1); //clear interrupt flag\n   sg_CpuCount++; //count interrupts\n}\n\nint64_t GetCpuCount(void)\n{\n   for (;;) {\n      uint32_t tmpCpuCount = sg_CpuCount;\n      uint32_t tmpCnt = TPM0-&gt;CNT;\n      if (tmpCpuCount == sg_CpuCount) {\n         return (int64_t)tmpCpuCount * CPU_CLOCK / TICKRATE_HZ + tmpCnt;\n      }\n   }\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1154, "user_id": 5329483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540d2cd6d0b20c87290f01247f8aae17?s=128&d=identicon&r=PG&f=1", "display_name": "user5329483", "link": "https://stackoverflow.com/users/5329483/user5329483"}, "edited": false, "score": 0, "creation_date": 1494444829, "post_id": 43900786, "comment_id": 74836473, "body": "Not really sure about this. In your first example you didn&#39;t detected the interrupt, but the function still returns a valid value: <code>sg_CpuCount + TPM0-&gt;CNT</code> from before the interrupt.  What type is TPM0?"}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "reply_to_user": {"reputation": 1154, "user_id": 5329483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540d2cd6d0b20c87290f01247f8aae17?s=128&d=identicon&r=PG&f=1", "display_name": "user5329483", "link": "https://stackoverflow.com/users/5329483/user5329483"}, "edited": false, "score": 0, "creation_date": 1494508112, "post_id": 43900786, "comment_id": 74865784, "body": "TPM0&#39;s is a struct of many CPU registers CNT is volatile uint32_t. Yes, you are correct that the first example can return a valid value even though it fails to detect the interrupt - but not always... I believe there is one more component at play here - interrupt latency. I found out it is possible to read TPM0-&gt;CNT as 0 or 1 (i.e. rollover) just prior to the interrupt executing . My problem only happens under this condition. So in the first example CNT is read (as 0 or 1) and sg_CpuCount low is read prior to the interrupt, but sg_CpuCount is incorrect because it hasn&#39;t been updated yet."}, {"owner": {"reputation": 1154, "user_id": 5329483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540d2cd6d0b20c87290f01247f8aae17?s=128&d=identicon&r=PG&f=1", "display_name": "user5329483", "link": "https://stackoverflow.com/users/5329483/user5329483"}, "edited": false, "score": 0, "creation_date": 1494521745, "post_id": 43900786, "comment_id": 74876146, "body": "Do you see the timer-overflow flag set in GetCpuCount()? It should immediately trigger an interrupt and should be cleared in the ISR, so you don&#39;t see it. If yes why? Globally disabled interrupts?"}, {"owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "reply_to_user": {"reputation": 1154, "user_id": 5329483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540d2cd6d0b20c87290f01247f8aae17?s=128&d=identicon&r=PG&f=1", "display_name": "user5329483", "link": "https://stackoverflow.com/users/5329483/user5329483"}, "edited": false, "score": 0, "creation_date": 1494523239, "post_id": 43900786, "comment_id": 74876957, "body": "I didn&#39;t investigate if the flag is observable in the GetCpuCount function. But after the flag asserts the cpu may execute 1 more instruction before the interrupt process begins. By placing a single asm(&quot;nop&quot;) instruction just prior to the if statement fixed all issues. I am looking for documentation on the interrupt latency timing to determine if one nop will guarantee correct operation."}], "tags": [], "owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "is_accepted": false, "score": 1, "last_activity_date": 1494444452, "last_edit_date": 1494444452, "creation_date": 1494443015, "answer_id": 43900786, "question_id": 43896407, "link": "https://stackoverflow.com/questions/43896407/how-do-c-c-optimizations-affect-volatile-variables/43900786#43900786", "title": "How do C/C++ optimizations affect volatile variables?", "body": "<p>After analyzing the ASM for optimized and non optimized code I noticed one main difference. One loads the 64bit int high word first and the other does low word first. So I believe user5329483 is correct and I'll explain the exact sequence that could cause the problem...</p>\n\n<pre><code>read sg_CpuCount low\nread sg_CpuCount high\nread TPM0-&gt;CNT\nread sg_CpuCount low\n***interrupt***\nread sg_CpuCount high\ncompare first sg_CpuCount with second sg_CpuCount (equal!!!!!)\n</code></pre>\n\n<p>Since the increment of sg_CpuCount in the interrupt may only change the lower word the above sequence fails to detect the interrupt happened.</p>\n\n<p>The non optimized code is as follows:</p>\n\n<pre><code>read sg_CpuCount high\nread sg_CpuCount low\nread TPM0-&gt;CNT\nread sg_CpuCount high\n***interrupt***\nread sg_CpuCount low\ncompare first sg_CpuCount with second sg_CpuCount (**NOT** equal!!!!!)\n</code></pre>\n\n<p>This code correctly detected the interrupt happened.</p>\n\n<p>So the optimization did in fact change the code - however both code gens are equally valid from the perspective of the compiler. So the answer is to either explicitly define the order of operations by splitting the 64bit int into 2 32bit variables or better yet just use user5329483's suggested code.</p>\n\n<p>edit: unfortunately 32bits is not enough to run for long enough times. Anyway the problem is well understood now.</p>\n"}], "owner": {"reputation": 51, "user_id": 4730260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316233242b2f8363936a0c8831af3c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Houe", "link": "https://stackoverflow.com/users/4730260/houe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1494444452, "creation_date": 1494428955, "last_edit_date": 1494435293, "question_id": 43896407, "link": "https://stackoverflow.com/questions/43896407/how-do-c-c-optimizations-affect-volatile-variables", "title": "How do C/C++ optimizations affect volatile variables?", "body": "<p>I'm having some issue with some code (see below). When all optimization are off (-O0) the code behaves as i would expect however when I turn on optimization the code does not perform as I would expect. So I'm posting here to see if someone sees a reason why the code would operate differently (incorrectly) when optimizations are on. Let me explain what the code is doing...</p>\n\n<p>TPM0->CNT is a timer register and is of volatile uint32_t type. When TPM0->CNT reaches it's maximum value and rolls over an interrupt is generated. Within this interrupt sg_CpuCount is incremented by the number of timer cycles that have elapsed since the last interrupt.</p>\n\n<p>The GetCpuCount function's job is to return the instantaneous count (i.e. sg_CpuCount + TPM0->CNT) however because interrupts can happen at any moment and the timer does not stop care must be taken when reading/computing this. The two components are read and then the first component is once again tested to see if it changed. If it changed its known a interrupt fired in between the first and 2nd reading and the process is repeated, however if they are the same it is known no interrupt occurred and the addition of the components is returned.</p>\n\n<p>Is the logic sound? Is optimization generating bad code? any insights? Thanks in advance!</p>\n\n<p>edit: I should mention the behavior I notice when optimizations are on. Basically subsequent calls to GetCpuCount are not always monotonic increasing like they are when optimizations are off. That is later calls to GetCpuCount might return a smaller number than previous calls - that should not be possible.</p>\n\n<p>edit2: I should mention the micro this code runs on is a 32bit architecture (and I'm using 64bit values). I still think it should be ok but it is a point to think about.</p>\n\n<pre><code>static volatile int64_t sg_CpuCount;\n\nvoid TPM0_IRQHandler(void)\n{\n   TPM0-&gt;SC |= TPM_SC_TOF(1); //clear interrupt flag\n   sg_CpuCount += CPU_CLOCK / TICKRATE_HZ;\n}\n\nint64_t GetCpuCount(void)\n{\n   for (;;) {\n      int64_t tmpCpuCount = sg_CpuCount;\n      uint32_t tmpCnt = TPM0-&gt;CNT;\n      if (tmpCpuCount == sg_CpuCount) {\n         return tmpCpuCount + tmpCnt;\n      }\n   }\n}\n</code></pre>\n\n<p>edit3: adding asm</p>\n\n<p>optimized (-0s)</p>\n\n<pre><code>GetCpuCount:\n.LFB36:\n    .loc 2 80 0\n    .cfi_startproc\n    @ args = 0, pretend = 0, frame = 0\n    @ frame_needed = 0, uses_anonymous_args = 0\n    push    {r4, r5, r6, lr}\n    .cfi_def_cfa_offset 16\n    .cfi_offset 4, -16\n    .cfi_offset 5, -12\n    .cfi_offset 6, -8\n    .cfi_offset 14, -4\n.LBB2:\n    .loc 2 82 0\n    ldr r4, .L20\n    .loc 2 83 0\n    ldr r6, .L20+4\n.L18:\n    //int64_t tmpCpuCount = sg_CpuCount;\n    ldr r0, [r4]\n    ldr r1, [r4, #4]\n    //uint32_t tmpCnt = TPM0-&gt;CNT;\n    ldr r5, [r6, #4]\n    //if (tmpCpuCount == sg_CpuCount) {\n    ldr r2, [r4]\n    ldr r3, [r4, #4]\n    cmp r0, r2\n    bne .L18\n    cmp r1, r3\n    bne .L18\n    //return tmpCpuCount + tmpCnt;\n    movs    r0, r5\n    movs    r1, #0\n.LBE2:\n    .loc 2 88 0\n    @ sp needed\n.LBB3:\n    .loc 2 85 0\n    adds    r0, r0, r2\n    adcs    r1, r1, r3\n.LBE3:\n    .loc 2 88 0\n    pop {r4, r5, r6, pc}\n.L21:\n    .align  2\n.L20:\n    .word   sg_CpuCount\n    .word   1073971200\n    .cfi_endproc\n</code></pre>\n\n<p>non optimized (-00)</p>\n\n<pre><code>GetCpuCount:\n.LFB36:\n    .loc 2 80 0\n    .cfi_startproc\n    @ args = 0, pretend = 0, frame = 16\n    @ frame_needed = 1, uses_anonymous_args = 0\n    push    {r4, r7, lr}\n    .cfi_def_cfa_offset 12\n    .cfi_offset 4, -12\n    .cfi_offset 7, -8\n    .cfi_offset 14, -4\n    sub sp, sp, #20\n    .cfi_def_cfa_offset 32\n    add r7, sp, #0\n    .cfi_def_cfa_register 7\n.L19:\n.LBB2:\n    //int64_t tmpCpuCount = sg_CpuCount;\n    ldr r3, .L21\n    ldr r4, [r3, #4]\n    ldr r3, [r3]\n    str r3, [r7, #8]\n    str r4, [r7, #12]\n    //uint32_t tmpCnt = TPM0-&gt;CNT;\n    ldr r3, .L21+4\n    ldr r3, [r3, #4]\n    str r3, [r7, #4]\n    //if (tmpCpuCount == sg_CpuCount) {\n    ldr r3, .L21\n    ldr r4, [r3, #4]\n    ldr r3, [r3]\n    ldr r0, [r7, #8]\n    cmp r0, r3\n    bne .L19\n    ldr r0, [r7, #12]\n    cmp r0, r4\n    bne .L19\n    //return tmpCpuCount + tmpCnt;\n    ldr r3, [r7, #4]\n    movs    r1, r3\n    movs    r3, #0\n    movs    r2, r3\n    ldr r3, [r7, #8]\n    ldr r4, [r7, #12]\n    adds    r3, r3, r1\n    adcs    r4, r4, r2\n.LBE2:\n    .loc 2 88 0\n    movs    r0, r3\n    movs    r1, r4\n    mov sp, r7\n    add sp, sp, #20\n    @ sp needed\n    pop {r4, r7, pc}\n.L22:\n    .align  2\n.L21:\n    .word   sg_CpuCount\n    .word   1073971200\n    .cfi_endproc\n</code></pre>\n"}, {"tags": ["c", "mutex", "semaphore"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494430653, "post_id": 43896361, "comment_id": 74828053, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your current example does not include a <code>main()</code> function, nor the implementations of <code>up()</code> and <code>down()</code> (which are extremely suspect, given the <code>typedef</code> for <code>semaphore</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 74709, "user_id": 21945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/631470ecb1d4fe8bd3be6d7e0dfe4449?s=128&d=identicon&r=PG", "display_name": "mhawke", "link": "https://stackoverflow.com/users/21945/mhawke"}, "is_accepted": false, "score": 1, "last_activity_date": 1494510205, "last_edit_date": 1494510205, "creation_date": 1494509667, "answer_id": 43917009, "question_id": 43896361, "link": "https://stackoverflow.com/questions/43896361/c-producer-consumer-using-semaphores/43917009#43917009", "title": "C Producer Consumer using semaphores", "body": "<p>There are a few obvious problems that need fixing before there is any hope that this code will work:</p>\n\n<ol>\n<li><code>semid_empty</code>, <code>semid_empty</code>, and <code>semid_empty</code> are the <em>same</em>\nsemaphore set, and therefore all of the <code>semop()</code> operations are operating on the same semaphore.</li>\n<li>The code removes the semaphore sets immediately\nafter creating the producer and consumer threads. All subsequent\ncalls to <code>semop()</code> made within those threads are failing.</li>\n<li>When attempting to initialise <code>semid_full</code> to 0, the code\nincorrectly uses <code>semid_empty</code> as the semaphore id.</li>\n</ol>\n\n<p>There are a few ways to fix item 1:</p>\n\n<ul>\n<li><p>Use a different key for each semaphore set or, since the semaphores\nare used only in the same process, you can simply use <code>IPC_PRIVATE</code>\nas the key, e.g. </p>\n\n<pre><code>semid_empty = semget(IPC_PRIVATE, 1, 0600|IPC_CREAT);\n</code></pre>\n\n<p>This will ensure that each semaphore set is unique.</p></li>\n<li><p>Create 3 semaphores in the same set and assign them roles as the\nempty semaphore, full semaphore and mutex semaphore. Reference the\nrelevant semaphore by it's number in calls to <code>semop()</code>, <code>semctl</code>, etc.</p></li>\n</ul>\n\n<p>To fix item 2:</p>\n\n<ul>\n<li>Don't remove the semaphores. The semaphores will be recreated or reused as necessary between executions of the program. All will be well provided that they are properly initialised each time, or</li>\n<li>Organise for the semaphores to be removed when the process exits. You\nmight use signals or whatever other methods are available.</li>\n</ul>\n\n<p>Item 3 is probably just a typo, fix it with:</p>\n\n<pre><code>semctl(semid_full, 0, SETVAL, arg);\n</code></pre>\n\n<p>Finally, and this is very important, <strong>add error checking and logging</strong> to your code; most of these problems would have been immediately apparent, especially the <code>semop()</code> failures in <code>setSemaphore()</code>. This would have led you to discover the problems for yourself.</p>\n\n<p>I am not sure that fixing the above will fix all the code problems, or that your algorithm is even correct, but it's a start, and you can then try adding debug logging and error checking to solve any other lurking problems.</p>\n"}], "owner": {"reputation": 1, "user_id": 6117577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f311c4b8ed98e7599a3bbdbc16f01789?s=128&d=identicon&r=PG&f=1", "display_name": "Damenace", "link": "https://stackoverflow.com/users/6117577/damenace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494510205, "creation_date": 1494428854, "last_edit_date": 1494431861, "question_id": 43896361, "link": "https://stackoverflow.com/questions/43896361/c-producer-consumer-using-semaphores", "title": "C Producer Consumer using semaphores", "body": "<p>Why does, for the first few iterations of the output from my code display the consumer consumes 0 twice, when it should consume the first two items produced?</p>\n\n<pre><code>Consumer consumes 0\nProducer produces 17\nProducer produces 17\nConsumer consumes 0\nProducer produces 10\nProducer produces 12\nConsumer consumes 10\nProducer produces 11\nProducer produces 43\nConsumer consumes 12\nProducer produces 33\nProducer produces 39\nConsumer consumes 11\n</code></pre>\n\n<p>here is some of my code for displaying </p>\n\n<pre><code>#define N 10\n\ntypedef int semaphore;\nsemaphore mutex, full, empty;\n\nint first=0,last=0, semArray[N];\n</code></pre>\n\n<p>Could it the use of the global variables ? </p>\n\n<pre><code>int produce_item(){\n    int item = rand()%50 +1;\n    printf(\"Producer produces %d\\n\",item);\n    sleep(1);\n    return item;\n}\n\nvoid consume_item(int item){\n    printf(\"Consumer consumes %d\\n\",item);\n    sleep(2);\n}\n\nint remove_item(){  \n    int temp = semArray[first];\n    first = first +1;\n    return temp;\n}\n\nvoid insert_item(int item){\n    semArray[last] = item;\n    last++;\n}\n</code></pre>\n\n<p>This is the producer and consumer functions for semaphores</p>\n\n<pre><code>void* consumer(void* arg) {\n    int item, i=0;\n    while(1){\n        down(full);\n        down(mutex);\n        item = remove_item();\n        up(mutex);\n        up(empty);\n        consume_item(item);\n    }\n    return 0;\n}\n\nvoid* producer(void* arg) { \n    int item, i=0;\n    while(1){\n        item=produce_item();\n        down(empty);\n        down(mutex);\n        insert_item(item);\n        up(mutex);\n        up(full);\n    }\n    return 0;\n}\n\nvoid down(semaphore s){\n    setSemaphore(s,0,-1);   \n}\n\nvoid up(semaphore s){\n    setSemaphore(s,0,1);\n} \n\n\nint setSemaphore(int semID, int semNum, int semOp){\n    struct sembuf Buf;\n    Buf.sem_num = semNum;\n    Buf.sem_op  = semOp;\n    Buf.sem_flg = 0;\n    return semop(semID,&amp;Buf,1);\n}\nmain() {\n    int i;\n    pthread_t threads[2];   \n    srand(time(NULL));\n    int semid_full, semid_empty, semid_mutex;\n\n    key_t key;\n    key = ftok(\"task2.c\", 'J');\n\n    //initialize and create each semaphore set \n    semid_empty = semget(key, 1, 0600|IPC_CREAT);\n    arg.val = N; \n    semctl(semid_empty, 0, SETVAL, arg);\n    semid_full = semget(key, 1, 0600|IPC_CREAT);\n    arg.val = 0; \n    semctl(semid_empty, 0, SETVAL, arg);\n    semid_mutex = semget(key, 1, 0600|IPC_CREAT);\n    arg.val = 1; \n    semctl(semid_mutex, 0, SETVAL, arg);\n\n       pthread_create(&amp;threads[0],NULL,consumer,NULL);\n    pthread_create(&amp;threads[1],NULL,producer,NULL);\n        //remove \n    semctl(semid_empty, 0 , IPC_RMID, arg);\n    semctl(semid_full, 0, IPC_RMID,arg);\n    semctl(semid_mutex, 0 , IPC_RMID, arg);\n    for(i=0; i&lt;2; i++) {\n        pthread_join(threads[i],NULL);\n    }\n</code></pre>\n"}, {"tags": ["c", "algorithm", "math", "field"], "comments": [{"owner": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 3, "creation_date": 1494428787, "post_id": 43896322, "comment_id": 74826689, "body": "Are you writing in C or C++?"}, {"owner": {"reputation": 1, "user_id": 7992269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3577e4314f27a9d853d256a877141382?s=128&d=identicon&r=PG&f=1", "display_name": "manh", "link": "https://stackoverflow.com/users/7992269/manh"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1494429278, "post_id": 43896322, "comment_id": 74827073, "body": "yes. where add_pol is plus 2 polynomials (XOR), mul_pol is multipliction of 2 polynomials"}, {"owner": {"reputation": 1, "user_id": 7992269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3577e4314f27a9d853d256a877141382?s=128&d=identicon&r=PG&f=1", "display_name": "manh", "link": "https://stackoverflow.com/users/7992269/manh"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1494429486, "post_id": 43896322, "comment_id": 74827217, "body": "i write in c and use a library MMATH.h"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1494430129, "post_id": 43896322, "comment_id": 74827710, "body": "If you write in C, why the C++ tag?  They are two different languages.  For example, the C++ has <code>std::vector</code> and the C language doesn&#39;t.  Please edit your tags."}], "owner": {"reputation": 1, "user_id": 7992269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3577e4314f27a9d853d256a877141382?s=128&d=identicon&r=PG&f=1", "display_name": "manh", "link": "https://stackoverflow.com/users/7992269/manh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494430498, "creation_date": 1494428761, "last_edit_date": 1494430498, "question_id": 43896322, "link": "https://stackoverflow.com/questions/43896322/three-way-formulas-based-on-field-extension", "title": "Three-way formulas based on field extension", "body": "<p>I want to write a program that multiplies 2 polynomials in an expansion field. But the results do not match.</p>\n\n<p>this is algorithm:\n   <a href=\"http://cacr.uwaterloo.ca/techreports/2011/cacr2011-30.pdf\" rel=\"nofollow noreferrer\">in section 4</a></p>\n\n<p>As before, i split 2 polynomials in three parts.\nNext step is:</p>\n\n<pre><code>P0 = A0B0                                          in F2[X]\nP1 = (A0 + A1 + A2)(B0 + B1 + B2)                  in F2[X],\nP2 = (A0 + A2 + \u03b1(A1 + A2))(B0 + B2 + \u03b1(B1 + B2)), in F4[X],\nP3 = (A0 + A1 + \u03b1(A1 + A2))(B0 + B1 + \u03b1(B1 + B2)), in F4[X],\nP4 = A2B2                                          in F2[X]\n</code></pre>\n\n<p>and result:</p>\n\n<pre><code> C = (P0 + X^(n/3)P4)(1 + X^n) + (P1 + (1 + \u03b1)(P2 + P3))(X^(n/3) + X^(2n/3) \n            +X^n)+\u03b1(P2 + P3)X^n + P2X^(2n/3) + P3X^(n/3)\n</code></pre>\n\n<p>this is my code:</p>\n\n<pre><code>void three_way(M_LONG A, M_LONG B, M_LONG &amp;C)\n{\n   M_LONG P0, P1, P2, P3, P4, tmp,R1,R2,R3, m0, m1, m2, n0, n1, n2;\n   M_LONG alpha;\n   alpha[0] = 1; alpha[1] = 1;\n   unsigned int mA = deg(A), mB = deg(B);\n   unsigned int n = mA &lt; mB ? mB : mA;\n   int m = (n+1) / 3,h=0;\n   int l = 0;\n  if (m % 32)\n  {\n     l = m % 32; \n  }\n  h = m/32;\n  split3_pol(A, h, l, m0, m1, m2);\n  split3_pol(B, h, l, n0, n1, n2);\n\n  mul_pol(m0, n0, P0);//P0=m0*n0\n  //P1=(m0+m1+m2)*(n0+n1+n2)\n  add_pol(m0, m1, P2);\n  add_pol(m2, P2, P2);\n\n  add_pol(n0, n1, tmp);\n  add_pol(n2, tmp, tmp);\n  mul_pol(P2, tmp, P1);\n  //P2 = (A0 + A2 + \u03b1(A1 + A2))(B0 + B2 + \u03b1(B1 + B2))\n  add_pol(m0, m2, P3);\n  add_pol(m1, m2, P4);//A1 + A2\n  mul_pol(P4, alpha, R1);//\u03b1(A1 + A2)\n  add_pol(P3, R1, P4);\n  //m_shl(P2, 1);\n  add_pol(n0, n2, P3);\n  add_pol(n1, n2, P2);\n  mul_pol(P2, alpha, R2);//\u03b1(B1 + B2)\n  add_pol(P3, R2, tmp);\n\n  mul_pol(tmp, P4, P2);\n  //P3 = (A0 + A1 + \u03b1(A1 + A2))(B0 + B1 + \u03b1(B1 + B2))\n  add_pol(m0, m1, P3);\n  add_pol(P3, R1, tmp);\n\n  add_pol(n0, n1, R3);\n  add_pol(R2, R3, R3);\n\n  mul_pol(R3, tmp, P3);\n  //P4 = A2B2\n  mul_pol(m2, n2, P4);\n  M_LONG Xn, X2n, X3n, U1, U2, U3, U4, U5, U6, U7;\n  int k = h + 1;\n  m_zero(Xn, k); l = k * 2; m_zero(X2n, l); l += k; m_zero(X3n, l);\n  m_setbit(Xn, m); k = 2 * m; m_setbit(X2n, k); k += m; m_setbit(X3n, k);\n  while (Xn[Xn[0]] == 0)\n     Xn[0]--;\n  while (X2n[X2n[0]] == 0)\n        X2n[0]--;\n  while (X3n[X3n[0]] == 0)\n     X3n[0]--;\n//C = (P0 + Xn / 3P4)(1 + Xn) + (P1 + (1 + \u03b1)(P2 + P3))(Xn / 3 + X2n / 3 + Xn) + \u03b1(P2 + P3)Xn + P2X2n / 3 + P3Xn / 3\n\nadd_pol(P2, P3,U1);//U1=P2+P3\nmul_pol(alpha, U1, U2);//U2 = \u03b1U1 (= \u03b1(P2 + P3)) \n//m_copy(U2, U1); m_shl(U2, 1);\n//mul_pol(three, U1, U3);//U3 = (1 + \u03b1)U1 (= (1 + \u03b1)(P2 + P3))\nadd_pol(U1, U2, U3);\nadd_pol(P1, U3, U4);//U4 = P1 + U3 (= P1 + (1 + \u03b1)(P2 + P3))\n//U5 = U4(Xn/3 + X2n/3 + X3n/3)\nadd_pol(Xn, X3n, tmp);\nadd_pol(X2n, tmp, tmp);\nmul_pol(tmp, U4, U5);\n\n //U6 = P0 + Xn/3P4 (= P0 + Xn/3P4)\n mul_pol(Xn, P4, U6);\nadd_pol(P0, U6, U6);\n\n//U7 = U6(1 + Xn) (= P0 + Xn/3P4)(1 + Xn))\nmul_pol(U6, X3n, U7);\nadd_pol(U6, U7, U7);\nadd_pol(U7, U5, tmp);\nmul_pol(X3n, U2, R1);\nmul_pol(P2, X2n, R2);\nmul_pol(P3, Xn, R3);\n//m_shl(R3, 4);\nadd_pol(tmp, R1, C);\nadd_pol(R2, C, C);\nadd_pol(R3, C, C);\nwhile (C[C[0]] == 0)\n    C[0]--;\n}\n</code></pre>\n\n<p>and This is result:<a href=\"https://i.stack.imgur.com/SUEe5.png\" rel=\"nofollow noreferrer\">result</a></p>\n\n<p>please tell me where am i wrong?</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 1, "creation_date": 1494428803, "post_id": 43896249, "comment_id": 74826699, "body": "You could save pair of indices/pointers that represent the words instead."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1494429427, "post_id": 43896249, "comment_id": 74827179, "body": "Sure you could, @VittorioRomeo, but that does not get you C strings containing the individual words."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494429555, "post_id": 43896249, "comment_id": 74827279, "body": "<code>but that does not get you C strings</code> There are no <code>C strings</code>, there are just arrays of characters, (except for string literals of course)."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494429678, "post_id": 43896249, "comment_id": 74827374, "body": "<code>array of char-pointer (char**).</code>   ==&gt;&gt; <code>char**</code> is not an Array, or Array of char pointer. It is only a Pointer-to-Pointer to char."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494429781, "post_id": 43896249, "comment_id": 74827459, "body": "There very well are C strings, @Michi.  That the term refers to a particular application of arrays and not to a separate data type in no way reduces its utility for expressing the related concepts clearly and concisely."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494429906, "post_id": 43896249, "comment_id": 74827529, "body": "@JohnBollinger Which are exactly those  <code>C strings</code> ? I know only <code>char str[] = &quot;string&quot;;</code>  and <code>const char *str = &quot;string&quot;;</code>  and none of them are <code>C strings</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494430107, "post_id": 43896249, "comment_id": 74827688, "body": "@Michi, C strings are contiguous sequences of <code>char</code>s terminated by <code>(char) 0</code>, as you seem already to know since you presented your own definition.  What exactly is your problem here?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494430521, "post_id": 43896249, "comment_id": 74827972, "body": "@JohnBollinger No problem here. Could you please point me to the standard reference of this?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494430524, "post_id": 43896249, "comment_id": 74827973, "body": "@Michi, In particular, <code>char str[] = &quot;string&quot;</code> defines <code>str</code> as an array whose initial contents constitute a C string.  <code>const char *str = &quot;string&quot;</code> defines <code>str</code> as a pointer to a static array of <code>char</code> whose contents constitute a C string."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494430651, "post_id": 43896249, "comment_id": 74828050, "body": "@JohnBollinger In my opinion <code>char str[] = &quot;string&quot;</code> means that you copy the <code>String Literal</code> in that Array, but that still doesn&#39;t means that there are <code>C strings</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494430674, "post_id": 43896249, "comment_id": 74828062, "body": "@Michi, if your point is that the term is not defined by the standard then you would have saved a lot of trouble by saying so directly.  That <i>the standard</i> does not define it does not mean that it is not well defined or that we should not use it.  You knew exactly what I meant by it."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494430759, "post_id": 43896249, "comment_id": 74828119, "body": "@JohnBollinger Somehow that was my Point. Here is SO and not a learning system and in my opinion people should stick to the standard."}, {"owner": {"reputation": 3255, "user_id": 2553437, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6zoD6.png?s=128&g=1", "display_name": "Alexej Magura", "link": "https://stackoverflow.com/users/2553437/alexej-magura"}, "edited": false, "score": 0, "creation_date": 1494431451, "post_id": 43896249, "comment_id": 74828572, "body": "Have you looked into maybe using <code>strtok</code>?  Also what do you mean you&#39;re not <i>allowed</i> to use memory allocation?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1494431673, "post_id": 43896249, "comment_id": 74828706, "body": "I&#39;m sorry, @Michi, but I reject your self-appointment to the role of terminology police.  You are welcome to offer well-founded criticism of my speech for being inaccurate, imprecise, or unclear (though correction, extension, or clarification would be better received than criticism in such cases).  You are certainly free to express a differing opinion.  But I do not accept criticism that the words I use, despite being clear, accurate and well-understood, are not the approved words."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494434153, "post_id": 43896249, "comment_id": 74830210, "body": "@JohnBollinger I am sorry to hear that. I never intended to judge you or your Knowledge. Of course I understand that, but here is SO, and for me this means that, when someone ask what means this:  <code>char str[] = &quot;string&quot;;</code> a good answer will be: <code>contiguous sequences of chars terminated by (char) 0</code>. That&#39;s all. Again, I&#39;m sorry."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7992439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/622c6504502b9a33bba6ee561634d650?s=128&d=identicon&r=PG&f=1", "display_name": "Treborium", "link": "https://stackoverflow.com/users/7992439/treborium"}, "edited": false, "score": 0, "creation_date": 1494449996, "post_id": 43896570, "comment_id": 74839120, "body": "If I&#39;d remove the <code>const</code> modifier would&#39;nt I still have the same problem since I&#39;m allowed to call the function with an automatic generated const char* whenever I&#39;m using quotation marks?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 21, "user_id": 7992439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/622c6504502b9a33bba6ee561634d650?s=128&d=identicon&r=PG&f=1", "display_name": "Treborium", "link": "https://stackoverflow.com/users/7992439/treborium"}, "edited": false, "score": 0, "creation_date": 1494450540, "post_id": 43896570, "comment_id": 74839375, "body": "@Treborium, I have interpreted &quot;split[ting] a string [...] into words&quot; and &quot;saving the individual words&quot; as requiring the production of C strings (null-terminated character sequences, Michi) of one word each, as indeed the implementation idea you presented supports.  In that case, as I said, the constraints on the problem make it intractable.  So yes, removing the <code>const</code> changes the problem into a different one.  In particular, it changes it into a <i>solvable</i> one.  And you are correct, the resulting function would not be safe to use on string literals."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1494429373, "creation_date": 1494429373, "answer_id": 43896570, "question_id": 43896249, "link": "https://stackoverflow.com/questions/43896249/c-splitting-c-string-into-words-without-reallocating-memory/43896570#43896570", "title": "C - Splitting C-String into words without reallocating memory", "body": "<p>There is no solution to the problem as posed.  You can obtain a pointer to the start of each word, but in order to use the source string as the storage for separate word strings you must modify it by replacing delimiters with string terminators, as you considered doing.</p>\n\n<p>If the task indeed supposes that you will alter the input line to use it for storage of several separate strings, then it seems that it is inherently incorrect for the function's <code>line</code> parameter to be <code>const</code>-qualified.  Such qualification is inconsistent with the job the function is supposed to perform.  Moreover, if you are supposed to assign pointers into the string pointed to by <code>line</code> into <code>words</code>, then the fact that <code>words</code> is <em>not</em> <code>const</code>-qualified also presents a conflict.</p>\n\n<p>The only plausible solution I see to the problem described is to remove the <code>const</code> qualifier from your <code>line</code> parameter.</p>\n"}], "owner": {"reputation": 21, "user_id": 7992439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/622c6504502b9a33bba6ee561634d650?s=128&d=identicon&r=PG&f=1", "display_name": "Treborium", "link": "https://stackoverflow.com/users/7992439/treborium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494429373, "creation_date": 1494428525, "question_id": 43896249, "link": "https://stackoverflow.com/questions/43896249/c-splitting-c-string-into-words-without-reallocating-memory", "title": "C - Splitting C-String into words without reallocating memory", "body": "<p>I'm trying to split a string (const char*) into words and saving the individual words in an array of char-pointer (char**).   </p>\n\n<p>My problem is not the splitting part but that I'm not allowed to allocate any memory. I need to use the input string as my memory, but since its a const char* I'm not able to modify it.  </p>\n\n<p>My thirst thought was to change all whitespaces into '\\0' and save the position of the beginning of the words in the array, which of course is not possible since the input string is const. </p>\n\n<p>The declaration of the function looks like this:\n</p>\n\n<pre><code>int breakIntoWords(const char *line, int maxWords, char** words);\n</code></pre>\n\n<p>The function returns the number of words in <strong>line</strong> and <strong>maxWords</strong> is the size of the word-array. </p>\n\n<p>Everything I found either used arrays as input strings or allocated memory with malloc. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1494428544, "post_id": 43896221, "comment_id": 74826490, "body": "Also, why is that pointer <code>0x0ADF4</code> and not <code>0x0000ADF4</code> or <code>0xADF4</code>? That&#39;s totally up to the (arbitrarily) chosen format."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1494428556, "post_id": 43896221, "comment_id": 74826500, "body": "Why is there a leading zero? Shouldn&#39;t the &quot;length&quot; of this value be 4? And why &quot;should&quot; it vary between pointers?"}, {"owner": {"reputation": 626, "user_id": 4612370, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/87fwa.jpg?s=128&g=1", "display_name": "n0tis", "link": "https://stackoverflow.com/users/4612370/n0tis"}, "edited": false, "score": 0, "creation_date": 1494428968, "post_id": 43896221, "comment_id": 74826825, "body": "Yes you&#39;re right about the leading 0, I modified the post"}, {"owner": {"reputation": 64759, "user_id": 277304, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4c90624b2aa9623d5ba30db0e34b2000?s=128&d=identicon&r=PG", "display_name": "leonbloy", "link": "https://stackoverflow.com/users/277304/leonbloy"}, "edited": false, "score": 1, "creation_date": 1494429248, "post_id": 43896221, "comment_id": 74827056, "body": "That&#39;s not &quot;the lenght of the pointer&quot;. That&#39;s the &quot;length of the hexadecimal representation of the pointer casted as an integer&quot;."}, {"owner": {"reputation": 626, "user_id": 4612370, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/87fwa.jpg?s=128&g=1", "display_name": "n0tis", "link": "https://stackoverflow.com/users/4612370/n0tis"}, "edited": false, "score": 0, "creation_date": 1494429378, "post_id": 43896221, "comment_id": 74827146, "body": "yes you are right, i will modify the post"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1494430210, "post_id": 43896221, "comment_id": 74827770, "body": "But what is your &quot;special reason&quot; to want that. Looks like some <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a> to me. You should <b>edit your question</b> to motivate it!"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 64759, "user_id": 277304, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4c90624b2aa9623d5ba30db0e34b2000?s=128&d=identicon&r=PG", "display_name": "leonbloy", "link": "https://stackoverflow.com/users/277304/leonbloy"}, "edited": false, "score": 0, "creation_date": 1494430680, "post_id": 43896221, "comment_id": 74828070, "body": "@leonbloy  That&#39;s the &quot;length of the hexadecimal representation of the pointer casted as an integer&quot; + &quot;with leading zeros removed&quot;. Which is unusual, normally pointers are presented with all digits present"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494431022, "post_id": 43896221, "comment_id": 74828316, "body": "Note that &quot;the length of the hexadecimal representation of the pointer casted as an integer&quot; in the edited version of the question actually is an answer."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1494435727, "post_id": 43896221, "comment_id": 74831129, "body": "Presumably you&#39;re outputting some table of pointer values, but there are much better ways to achieve textual alignment with data."}], "answers": [{"comments": [{"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "reply_to_user": {"reputation": 64759, "user_id": 277304, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4c90624b2aa9623d5ba30db0e34b2000?s=128&d=identicon&r=PG", "display_name": "leonbloy", "link": "https://stackoverflow.com/users/277304/leonbloy"}, "edited": false, "score": 0, "creation_date": 1494430316, "post_id": 43896416, "comment_id": 74827835, "body": "Yes I have the OP asked the length of the address. In order to know the length you need to know the size first because of different architectures, and knowing the endian is important too because of the byte ordering. Then it is a matter of stripping out the non significant leading 0s and storing the result into a new character array. The size or length of this character array will be the length of the pointer address the OP is looking for since every two non 0 characters represents one byte of memory addressing. I did make a single mistake; if the address is in hex; each 2 characters is 1 byte"}], "tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": -2, "last_activity_date": 1494430527, "last_edit_date": 1494430527, "creation_date": 1494428978, "answer_id": 43896416, "question_id": 43896221, "link": "https://stackoverflow.com/questions/43896221/get-length-of-a-pointer-not-sizeoff/43896416#43896416", "title": "Get length of a pointer ( not sizeoff )", "body": "<p>The size of a pointer will depend on the architecture of the machine such that a 32bit system will have their pointers as 4 bytes in memory and a 64bit system will have it as 8 bytes in memory. These sizes will not change on a particular system. Knowing this will help you to design the needed algorithm. Your function or method should first check to see what the size of a pointer is for the particular machine. Once you know the size of the pointer the next step would be to check to see if it is little endian or big endian. Once you are able to determine which endian is being used then you can begin to design your algorithm. After you know what these two are then you should be able to store the actual physical address into a character array. From there you can then strip out all non significant leading zeros leaving you with any characters that are non zero and save them into a new dynamic character array. I would suggest using unsigned char for this. Then it is a matter of counting how many bytes are in the unsigned character array that you just extrapolated from the original address. Note if the address is in hex value then every 2 characters is 1 byte. So if the resulting character array has 8 values then there is 4 bytes; but you would want to return 8 as in the length and not 4 as in bytes. </p>\n\n<p><strong>EDIT</strong> - Pseudo Code</p>\n\n<pre><code>unsigned getAddressLength( unsigned char&amp; address ) {\n    // First Check to See if System is 16bit, 32bit, 64bit etc.\n    unsigned sizeInBytes = sizeof( address );\n\n    bool isBigEndian;\n\n    // test if Big or Little Endian;\n    if ( address is Big ) {\n        isBigEndian = true;\n    } else {\n        isBigEndian = false;\n    }\n\n    unsigned char[] addressBytes; // Evert 2 Characters In The Address String is 1 byte of memory.\n    if ( isBigEndian ) {\n         // Perform Algorithm This Way To Strip Out Non Significant 0s\n    } else {\n         // Same Thing But For Little Endian\n    }\n\n    // After Striping out All Non Significant leading 0s get the size in bytes of this new array\n\n    return (new length of character array);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1494429635, "post_id": 43896586, "comment_id": 74827336, "body": "I have tried with this actual code, my ptr is <code>&quot;0028FF34&quot;</code> and the output is <code>6</code>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1494430328, "post_id": 43896586, "comment_id": 74827845, "body": "@Badda That&#39;s how numbers work :p The leading 0&#39;s are purely down to formatting and do not represent any difference in actual value (looking at the comments, the op seems to want leading 0&#39;s removed)."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1494430948, "post_id": 43896586, "comment_id": 74828257, "body": "You should probably cast it to an <code>intptr_t</code> instead. I&#39;m not sure if the standard says anything about <code>sizeof(size_t)</code> vs <code>sizeof(int*)</code>."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1494431260, "post_id": 43896586, "comment_id": 74828467, "body": "@Kevin Just had a quick look and I couldn&#39;t find anything to suggest that <code>sizeof(size_t)</code> is guaranteed to be equivalent to <code>sizeof(int*)</code>, so i&#39;ve updated the answer. Cheers :)"}], "tags": [], "owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "is_accepted": true, "score": 4, "last_activity_date": 1494536633, "last_edit_date": 1494536633, "creation_date": 1494429397, "answer_id": 43896586, "question_id": 43896221, "link": "https://stackoverflow.com/questions/43896221/get-length-of-a-pointer-not-sizeoff/43896586#43896586", "title": "Get length of a pointer ( not sizeoff )", "body": "<p>You can cast the ptr to type <code>intptr_t</code> and from there use a standard digit counting algorithm : </p>\n\n<pre><code>int main() {\n    int counter = 0;\n    int* ptr = &amp;counter;\n    intptr_t val = (intptr_t)ptr; \n\n    while ( val &gt; 0 )\n    {\n        val/=16;\n        ++counter;\n    }\n\n    printf(\"%d\", counter);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1494439459, "last_edit_date": 1494439459, "creation_date": 1494430010, "answer_id": 43896823, "question_id": 43896221, "link": "https://stackoverflow.com/questions/43896221/get-length-of-a-pointer-not-sizeoff/43896823#43896823", "title": "Get length of a pointer ( not sizeoff )", "body": "<p>So you want the length of some <em>textual representation</em> of your pointer (beware of the terminology, your don't want the size of the allocated memory zone holding that pointer), often of a pointer into some <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a> memory location (but perhaps not).</p>\n\n<p>You should notice that both <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>sprintf</code> and <code>snprintf</code></a> are returning the number of bytes written to some buffer (including the terminating zero byte) and they both accept a <code>NULL</code> buffer, so you could code:</p>\n\n<pre><code>int ptrtextlen = sprintf(NULL, \"%p\", ptr);\n</code></pre>\n\n<p>In your case (for <code>ptr</code> being 0x2ADF4), it would return 8 (because <code>0x2ADF4</code> needs 7 bytes starting with <code>0</code> and <code>x</code> up to <code>4</code>, and one additional terminating zero byte). BTW, read more about <code>sprintf</code> (you may use it to get some leading zeros, but you'll probably need to cast the <code>ptr</code> to <code>long</code> or more probably <code>uintptr_t</code>)</p>\n\n<p><sup>(AFAIK, the C11 standard does not guarantee any specific textual representation of pointer with <code>%p</code> - they are implementation specific; I'm thinking of my Linux/x86-64 desktop)</sup></p>\n\n<p>If you want the length of some null terminated string (given by the pointer to its first character) use <a href=\"http://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\">strlen</a>.</p>\n\n<blockquote>\n  <p>I do not want the total memory occupation my pointer (which I can get via sizeof)</p>\n</blockquote>\n\n<p>This is very wrong. All pointers have the same <code>sizeof</code> (independently of the size of the pointed memory), which is 8 bytes on my Linux/x86-64 machine; so for example</p>\n\n<pre><code> char buf[32];\n int ptrtextlen = snprintf(buf, sizeof(buf), \"%p\", ptr);\n printf(\"ptrtextlen=%d length(buf)=%zd\\n\", ptrtextlen, strlen(buf));\n</code></pre>\n\n<p>should output <code>ptrtextlen=6 length(buf)=5</code> on my Linux/x86-64 desktop</p>\n\n<pre><code>int*heaptr = malloc(1024*sizeof(int));\nprintf(\"%zd\", sizeof(heaptr));\n</code></pre>\n\n<p>will output 8 (not 4096, which is the byte size of the memory zone given by the <em>successful</em> call to <code>malloc</code>, since <code>sizeof(int)</code> is 4 on my machine).</p>\n\n<p>PS. Spend several days reading more about <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a> and its <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a> specification; it looks that you are <em>very confused</em>. Read about <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">C dynamic memory allocation</a>.</p>\n"}], "owner": {"reputation": 626, "user_id": 4612370, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/87fwa.jpg?s=128&g=1", "display_name": "n0tis", "link": "https://stackoverflow.com/users/4612370/n0tis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 43896586, "answer_count": 3, "score": -1, "last_activity_date": 1494899829, "creation_date": 1494428443, "last_edit_date": 1494899829, "question_id": 43896221, "link": "https://stackoverflow.com/questions/43896221/get-length-of-a-pointer-not-sizeoff", "title": "Get length of a pointer ( not sizeoff )", "body": "<p>For some special reason I need to get the length (in character) of a pointer.\nIf the pointer is :</p>\n\n<pre><code>0x2ADF4\n</code></pre>\n\n<p>It should return <code>5</code>, \nbecause there are 5 characters in the pointer.\nIn fact I want the length of the hexadecimal representation of the pointer casted as an integer.\n This number should vary from pointer to pointer.\nPlease note I do not want the total memory occupation my pointer (which I can get via sizeoff).</p>\n"}, {"tags": ["c", "linux", "variables", "linux-kernel"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1494439700, "post_id": 43895817, "comment_id": 74833447, "body": "Are both files (<code>net&#47;sched&#47;sch_htb.c</code> and <code>net&#47;ipv4&#47;tcp_dctcp.c</code>) are compiled as a <b>part of the kernel core</b> (that is, not as modules)? If so, no <code>EXPORT_SYMBOL</code> is needed. Note, that compilation of the file <code>sched&#47;sch_htb.c</code> depends on <code>CONFIG_NET_SCH_HTB</code> configuration option. If you compile it as a module, you cannot use symbol defined in it in the kernel core."}, {"owner": {"reputation": 43, "user_id": 7609443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3089c177f4eba77b76205e9ece25759d?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter", "link": "https://stackoverflow.com/users/7609443/hunter"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1494466767, "post_id": 43895817, "comment_id": 74843990, "body": "I checked the &#39;.config&#39; file, which shows&quot;CONFIG_TCP_CONG_DCTCP=y &quot; and &quot;CONFIG_NET_SCH_HTB=m&quot;. I think that maybe I should change it from &#39;m&#39; to &#39;y&#39; and delete the &#39;EXPORT_SYMBOL&#39;.Then I can compile it successfuly?"}, {"owner": {"reputation": 43, "user_id": 7609443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3089c177f4eba77b76205e9ece25759d?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter", "link": "https://stackoverflow.com/users/7609443/hunter"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1494467786, "post_id": 43895817, "comment_id": 74844229, "body": "I have another question. I need to use the variable &#39;queuelength&#39; also in other codes (ovs). So maybe I have to reserve &#39;EXPORT_SYMBOL&#39; and compilation as module?I&#39;m not sure about it but it did work well without modifying net/ipv4/tcp_dctcp.c.What should I do to deal with the both problems at the same time?"}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 3, "last_activity_date": 1494492152, "last_edit_date": 1592644375, "creation_date": 1494492152, "answer_id": 43910573, "question_id": 43895817, "link": "https://stackoverflow.com/questions/43895817/how-to-use-a-variable-from-another-c-file-in-linux-kernel/43910573#43910573", "title": "How to use a variable from another c file in linux kernel?", "body": "<p>It depends on how a source file, which <em>defines</em> the variable (generally, symbol), and a source file, which <em>uses</em> the variable (symbol) are compiled: as a part of the <strong>kernel module</strong>, or as a part of the <strong>kernel core</strong> (that is, <em>built-in</em> into kernel).</p>\n<p>Assuming names of the source files are <code>define-symbol.c</code> and <code>use-symbol.c</code> correspondingly, you have 5 possibilities:</p>\n<ol>\n<li><p>Both <code>define-symbol.c</code> and <code>use-symbol.c</code> are compiled into <strong>kernel core</strong>.</p>\n<p><code>EXPORT_SYMBOL</code> <em>isn't needed</em>.</p>\n</li>\n<li><p><code>define-symbol.c</code> is compiled into <strong>kernel core</strong>, <code>use-symbol.c</code> is compiled into <strong>kernel module</strong>.</p>\n<p><code>EXPORT_SYMBOL</code> is <em>needed</em>.</p>\n</li>\n<li><p><code>define-symbol.c</code> is compiled into <strong>kernel module</strong>, <code>use-symbol.c</code> is compiled into <strong>kernel core</strong>.</p>\n<p>You <em>cannot use</em> such symbol.</p>\n</li>\n<li><p><code>define-symbol.c</code> and <code>use-symbol.c</code> are compiled into the <strong>same kernel module</strong>.</p>\n<p><code>EXPORT_SYMBOL</code> <em>isn't needed</em>.</p>\n</li>\n<li><p><code>define-symbol.c</code> and <code>use-symbol.c</code> are compiled into the <strong>different kernel modules</strong>.</p>\n<p><code>EXPORT_SYMBOL</code> is <em>needed</em>.</p>\n</li>\n</ol>\n<p>Note, that way of source compilation may <em>depend on configuration options</em>.</p>\n<p>In your case, it seems you have situation 3: as <code>net/ipv4/tcp_dctcp.c</code> is used for <code>built-in.o</code>, it is part of the <em>kernel core</em>.</p>\n<hr />\n<p>Note, that in any case variable should be <strong>declared</strong> for use it. Otherwise, it will be <em>compile-time error</em>, not a link one.</p>\n"}], "owner": {"reputation": 43, "user_id": 7609443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3089c177f4eba77b76205e9ece25759d?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter", "link": "https://stackoverflow.com/users/7609443/hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 2, "accepted_answer_id": 43910573, "answer_count": 1, "score": 4, "last_activity_date": 1494492152, "creation_date": 1494427469, "last_edit_date": 1494428108, "question_id": 43895817, "link": "https://stackoverflow.com/questions/43895817/how-to-use-a-variable-from-another-c-file-in-linux-kernel", "title": "How to use a variable from another c file in linux kernel?", "body": "<p>I know the way normal and I tried it but it seems not work.</p>\n\n<p>In linux/net/sched/sch_htb.c, I define the variable:</p>\n\n<pre><code>unsigned int queuelength;\nEXPORT_SYMBOL(queuelength);\n</code></pre>\n\n<p>And some actions about the variable, not important.</p>\n\n<p>In linux/net/ipv4/tcp_dctcp.c,</p>\n\n<pre><code>extern unsigned int queuelength;\n</code></pre>\n\n<p>Error come with net/built-in.o:</p>\n\n<pre><code>In function `dctcp_update_alpha':\nlinux/net/ipv4/tcp_dctcp.c:230: undefined reference to `queuelength'\n</code></pre>\n\n<p>The kernel version is v4.6.</p>\n"}, {"tags": ["c++", "c", "windows", "winapi", "file-attributes"], "answers": [{"tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 8, "last_activity_date": 1494427578, "creation_date": 1494427578, "answer_id": 43895857, "question_id": 43895795, "link": "https://stackoverflow.com/questions/43895795/all-files-has-file-attribute-archive-attribute/43895857#43895857", "title": "All files has FILE_ATTRIBUTE_ARCHIVE attribute", "body": "<p>The \"archive\" attribute doesn't mean \"this file is an archive\" (like a ZIP or 7Z file). Rather, it <a href=\"https://en.wikipedia.org/wiki/Archive_bit\" rel=\"noreferrer\">typically means</a> \"this file needs to be backed up\":</p>\n\n<blockquote>\n  <p>On Windows and OS/2, when a file is created or modified, the archive bit is set, and when the file has been backed up, the archive bit is cleared. Thus, the meaning of the archive bit is: <em>this file is due for archiving</em>, or: <em>this file has not been archived</em>.</p>\n  \n  <p>An <em>incremental backup</em> task may use the archive bit to distinguish which files have already been backed up, and select only the new or modified files for backup.</p>\n</blockquote>\n\n<p>I don't think it's being used much in practice anymore (if it ever was).</p>\n"}], "owner": {"reputation": 82, "user_id": 6153435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce7b82e2733323ab61030fda6dc595e?s=128&d=identicon&r=PG", "display_name": "johnbrovi", "link": "https://stackoverflow.com/users/6153435/johnbrovi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 1, "accepted_answer_id": 43895857, "answer_count": 1, "score": 1, "last_activity_date": 1616259295, "creation_date": 1494427416, "last_edit_date": 1616259295, "question_id": 43895795, "link": "https://stackoverflow.com/questions/43895795/all-files-has-file-attribute-archive-attribute", "title": "All files has FILE_ATTRIBUTE_ARCHIVE attribute", "body": "<p>I'm working on a program that should retrieve attributes of all files from chosen directory in std::vector.</p>\n<p>This code shows how I'm getting file attributes:</p>\n<pre><code>DWORD attr_flags = GetFileAttributes(file_path);\n\nif (attr_flags == INVALID_FILE_ATTRIBUTES) {\n  std::cout &lt;&lt; &quot;Invalid file attributes.&quot; &lt;&lt; std::endl;\n  return;\n}\n</code></pre>\n<p>And the code parses retrieved flags like this:</p>\n<pre><code>if (attr_flags &amp; FILE_ATTRIBUTE_ARCHIVE) {\n  attrs.push_back(defines::Attributes::kArchive);\n  attr_flags &amp;= ~FILE_ATTRIBUTE_ARCHIVE;\n}\n\nif (attr_flags &amp; FILE_ATTRIBUTE_COMPRESSED) {\n  attrs.push_back(defines::Attributes::kCompressed);\n  attr_flags &amp;= ~FILE_ATTRIBUTE_COMPRESSED;\n}\n\n/* etc... */\n</code></pre>\n<p>So, after all I'm printing result to console and get this:</p>\n<p><a href=\"https://i.stack.imgur.com/zZCWM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zZCWM.png\" alt=\"All files has archive attribute\" /></a></p>\n<p>Can anyone, please, tell me, why all files (not even archive) has archive attribute?</p>\n<p>P.S: <a href=\"https://msdn.microsoft.com/ru-ru/library/windows/desktop/gg258117(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN</a> tell's</p>\n<pre><code>FILE_ATTRIBUTE_ARCHIVE  32 (0x20)\n</code></pre>\n<p>A file or directory that is an archive file or directory. Applications typically use this attribute to mark files for backup or removal .</p>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494427444, "post_id": 43895762, "comment_id": 74825540, "body": "Why are you even benchmarking at <code>-O0</code>?"}, {"owner": {"reputation": 941, "user_id": 1020897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6501792042c1bcbd97ac0e0478615f6d?s=128&d=identicon&r=PG", "display_name": "linkdd", "link": "https://stackoverflow.com/users/1020897/linkdd"}, "edited": false, "score": 1, "creation_date": 1494427543, "post_id": 43895762, "comment_id": 74825613, "body": "maybe to have a benchmark not depending on the compiler&#39;s optimisations"}, {"owner": {"reputation": 21, "user_id": 7992401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5c657683af8e3199cfee3cc04fb20?s=128&d=identicon&r=PG&f=1", "display_name": "Florent", "link": "https://stackoverflow.com/users/7992401/florent"}, "edited": false, "score": 3, "creation_date": 1494427613, "post_id": 43895762, "comment_id": 74825672, "body": "running without compiler optimizations somewhat ensures the running code is really close to the C code you wrote."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494428135, "post_id": 43895762, "comment_id": 74826162, "body": "There is a contradiction in your requirements. C doesn&#39;t have the notion of <i>cache</i> or <i>time</i>. Optimizer does. So asking <i>why</i> about these terms without using optimizer and keeping the code &quot;really close to C&quot; doesn&#39;t make much sense."}, {"owner": {"reputation": 21, "user_id": 7992401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5c657683af8e3199cfee3cc04fb20?s=128&d=identicon&r=PG&f=1", "display_name": "Florent", "link": "https://stackoverflow.com/users/7992401/florent"}, "edited": false, "score": 0, "creation_date": 1494428773, "post_id": 43895762, "comment_id": 74826680, "body": "I just updated the post because i didin&#39;t see that the problem happened only when using optimizations O2 and O3 only."}, {"owner": {"reputation": 50347, "user_id": 1763356, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zGWG9.png?s=128&g=1", "display_name": "Veedrac", "link": "https://stackoverflow.com/users/1763356/veedrac"}, "edited": false, "score": 0, "creation_date": 1494501815, "post_id": 43895762, "comment_id": 74861134, "body": "When allocated inline, the GCC seems to realize that <code>cache_hit</code> is just a loop of <code>memcpy</code>s. That explains the speed difference."}], "owner": {"reputation": 21, "user_id": 7992401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5c657683af8e3199cfee3cc04fb20?s=128&d=identicon&r=PG&f=1", "display_name": "Florent", "link": "https://stackoverflow.com/users/7992401/florent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494427957, "creation_date": 1494427345, "last_edit_date": 1494427957, "question_id": 43895762, "link": "https://stackoverflow.com/questions/43895762/c-code-runs-faster-when-allocate-and-run-inside-main-slower-when-allocate-elsew", "title": "C code runs faster when allocate and run inside main, slower when allocate elsewhere", "body": "<p>I was playing with CPU caches in C and i ran into a strange thing.</p>\n\n<p>To play with CPU cache, I allocate a 2dim array of X lines and (cpu L1 cache size) columns.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;time.h&gt;\n\n#define LINES 1000\n#define COLUMNS 64 * 1024 // L1 cache size on i3-3110M\n\nvoid cache_hit(uint8_t **t) {\n    uint64_t i = 0, j = 0;\n\n    for(j = 0; j &lt; LINES; ++j) {\n        for(i = 0; i &lt; COLUMNS; ++i) {\n            t[j][i] = 255;\n        }\n    }\n}\n\nvoid cache_miss(uint8_t **t) {\n    uint64_t i = 0, j = 0;\n\n    for(i = 0; i &lt; COLUMNS; ++i) {\n        for(j = 0; j &lt; LINES; ++j) {\n            t[j][i] = 0;\n        }\n    }\n}\n\n// parce que je kiff le C...\nvoid init_array(uint8_t ***t) {\n    uint64_t j = 0;\n\n    *t = calloc(LINES, sizeof(uint8_t *));\n    for(j = 0; j &lt; LINES; ++j) {\n        (*t)[j] = calloc(COLUMNS, sizeof(uint8_t));\n    }\n}\n\n#ifdef FROM_MAIN\nint main(void) {\n#else\nvoid bench(void) {\n#endif\n    uint8_t **t = NULL;\n    uint64_t j = 0;\n    clock_t t_begin;\n    clock_t t_end;\n    clock_t t1, t2;\n\n    puts(\"init...\");\n#ifdef ALLOC_IN_PLACE\n    t = calloc(LINES, sizeof(uint8_t *));\n    for(j = 0; j &lt; LINES; ++j) {\n        t[j] = calloc(COLUMNS, sizeof(uint8_t));\n    }\n#else\n    init_array(&amp;t);\n#endif\n    puts(\"bench...\");\n\n    /* cache hit */\n    t_begin = clock();\n    cache_hit(t);\n    t_end = clock();\n\n    t1 = t_end - t_begin;\n    printf(\"cache hit time:  %ld\\n\", t1);\n    /* */\n\n    /* cache miss */\n    t_begin = clock();\n    cache_miss(t);\n    t_end = clock();\n\n    t2 = t_end - t_begin;\n    printf(\"cache miss time: %ld\\n\", t2);\n    /* */\n\n    printf(\"run time factor: %f\\n\", ((double)t2)/((double)t1));\n\n    for(j = 0; j &lt; LINES; ++j) {\n        free(t[j]);\n    }\n    free(t);\n#ifndef FROM_MAIN\n}\n#endif\n\n#ifndef FROM_MAIN\nint main(void) {\n    bench();\n#endif\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I build with <code>gcc -O0 -Wall main.c -DFROM_MAIN -DALLOC_IN_PLACE</code> to allocate and run from main(), and <code>-DFROM_MAIN</code> to only run from main and allocate in a separate function (init_array).</p>\n\n<p>The code runs six times slower when running from main and if the array was allocated from outside main().</p>\n\n<p><strong>Update</strong>: with -O0, no difference. With -O2 or -O3, clear difference happen.</p>\n\n<p>I hope I have been clear.</p>\n"}, {"tags": ["c", "tcp", "server", "client", "message"], "comments": [{"owner": {"reputation": 5013, "user_id": 1619432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8SFy2.png?s=128&g=1", "display_name": "handle", "link": "https://stackoverflow.com/users/1619432/handle"}, "edited": false, "score": 0, "creation_date": 1494434576, "post_id": 43895523, "comment_id": 74830456, "body": "Please elaborate the problem. What is <code>the &quot;for&quot; cicle</code>? Show sample data etc. Also see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 3, "user_id": 7992231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/195d24554a7ca8088f53d8ba83906dc7?s=128&d=identicon&r=PG&f=1", "display_name": "Pipox", "link": "https://stackoverflow.com/users/7992231/pipox"}, "reply_to_user": {"reputation": 5013, "user_id": 1619432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8SFy2.png?s=128&g=1", "display_name": "handle", "link": "https://stackoverflow.com/users/1619432/handle"}, "edited": false, "score": 0, "creation_date": 1494439678, "post_id": 43895523, "comment_id": 74833442, "body": "This is the cycle                             for(i=0;i&lt;n;i++) {                                                              printf(&quot;insert number: &quot;);                                                              fgets(buffsend,256,stdin);                                                                write(simpleSocket, buffsend, strlen(buffsend)+1);"}], "answers": [{"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 0, "last_activity_date": 1494427738, "creation_date": 1494427738, "answer_id": 43895926, "question_id": 43895523, "link": "https://stackoverflow.com/questions/43895523/send-unique-string-with-multiple-numbers-client-server-tcp/43895926#43895926", "title": "Send unique string with multiple numbers Client/Server TCP", "body": "<p>In read call, you might get entire or partial string that you mentioned(4 11 21 9 11)</p>\n\n<p>After each read call you need to parse the data you received, check if you got entire string or partial one, if you get partial one post read again to get rest of data.\nAfter you confirm you got entire data, you need to call write to send 4 back to your client</p>\n\n<p>Then get back to read call again</p>\n"}], "owner": {"reputation": 3, "user_id": 7992231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/195d24554a7ca8088f53d8ba83906dc7?s=128&d=identicon&r=PG&f=1", "display_name": "Pipox", "link": "https://stackoverflow.com/users/7992231/pipox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494430618, "creation_date": 1494426827, "question_id": 43895523, "link": "https://stackoverflow.com/questions/43895523/send-unique-string-with-multiple-numbers-client-server-tcp", "title": "Send unique string with multiple numbers Client/Server TCP", "body": "<p>i am working on a TCP client/server communication in C. Client has to get the number of data(not > 6), get the data and send them to server in a single string message like this: 4 11 21 9 11.<br>\n4 is the number of data and 11, 21, 9, 11 are data.</p>\n\n<p>Then, server has to read message, print it and send to client the number of data received(4).</p>\n\n<p>I tried this for client:</p>\n\n<pre><code>#include &lt;stdio.h&gt;      \n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;   \n#include &lt;netdb.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n\n\n\nint main(int argc, char *argv[]) {\n\n    int simpleSocket = 0;\n    int simplePort = 0;\n    int returnStatus= 0;\n    char buffsend[256];\n    char buffrecv[256];\n    int n, i;\n    struct sockaddr_in simpleServer;\n\n    if (3 != argc) {\n\n        fprintf(stderr, \"Usage: %s &lt;server&gt; &lt;port&gt;\\n\", argv[0]);\n        exit(1);\n\n    }\n\n    /* create a streaming socket      */\n    simpleSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n    if (simpleSocket == -1) {\n\n        fprintf(stderr, \"Could not create a socket!\\n\");\n        exit(1);\n\n    }\n    else {\n        fprintf(stderr, \"Socket created!\\n\");\n    }\n\n    /* retrieve the port number for connecting */\n    simplePort = atoi(argv[2]);\n\n    /* setup the address structure */\n    /* use the IP address sent as an argument for the server address  */\n    //bzero(&amp;simpleServer, sizeof(simpleServer)); \n    memset(&amp;simpleServer, '\\0', sizeof(simpleServer));\n    simpleServer.sin_family = AF_INET;\n    //inet_addr(argv[2], &amp;simpleServer.sin_addr.s_addr);\n    simpleServer.sin_addr.s_addr=inet_addr(argv[1]);\n    simpleServer.sin_port = htons(simplePort);\n\n    /*  connect to the address and port with our socket  */\n    returnStatus = connect(simpleSocket, (struct sockaddr *)&amp;simpleServer, sizeof(simpleServer));\n\n    if (returnStatus == 0) {\n        fprintf(stderr, \"Connect successful!\\n\");\n    }\n    else {\n        fprintf(stderr, \"Could not connect to address!\\n\");\n    close(simpleSocket);\n    exit(1);\n    }\n\n\n\n\n\n    /* get the message from the server   */\n\n\n\n      do {\n\n        printf(\"get numb of data or terminate(write '0'): \");\n        fgets(buffsend,256,stdin);\n        n=atoi(buffsend);\n        if(n&gt;6) {\n          printf(\"Error\\n\");\n\n         }\n        else {\n                for(i=0;i&lt;n;i++) {\n                   printf(\"insert number: \");\n                   fgets(buffsend,256,stdin);\n                   write(simpleSocket, buffsend, strlen(buffsend)+1);\n\n\n         }\n\n\n\n     } while((n!=0) &amp;&amp; (n&gt;0));\n\n\n\n\n\n    close(simpleSocket);\n    return 0;\n\n}\n</code></pre>\n\n<p>And this for server:</p>\n\n<pre><code>#include &lt;stdio.h&gt;      \n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;   \n#include &lt;netdb.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt; \n\nint main(int argc, char *argv[]) {\n\n    int simpleSocket = 0;\n    int simplePort = 0;\n    int returnStatus = 0;\n    char buff[256];\n    char message[256];\n    int count;\n\n    struct sockaddr_in simpleServer;\n\n    if (2 != argc) {\n\n        fprintf(stderr, \"Usage: %s &lt;port&gt;\\n\", argv[0]);\n        exit(1);\n\n    }\n\n    simpleSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n    if (simpleSocket == -1) {\n\n        fprintf(stderr, \"Could not create a socket!\\n\");\n        exit(1);\n\n    }\n    else {\n        fprintf(stderr, \"Socket created!\\n\");\n    }\n\n    /* retrieve the port number for listening */\n    simplePort = atoi(argv[1]);\n\n    /* setup the address structure */\n    /* use INADDR_ANY to bind to all local addresses  */\n    memset(&amp;simpleServer, '\\0', sizeof(simpleServer)); \n    simpleServer.sin_family = AF_INET;\n    simpleServer.sin_addr.s_addr = htonl(INADDR_ANY);\n    simpleServer.sin_port = htons(simplePort);\n\n    /*  bind to the address and port with our socket  */\n    returnStatus = bind(simpleSocket,(struct sockaddr *)&amp;simpleServer,sizeof(simpleServer));\n\n    if (returnStatus == 0) {\n        fprintf(stderr, \"Bind completed!\\n\");\n    }\n    else {\n        fprintf(stderr, \"Could not bind to address!\\n\");\n    close(simpleSocket);\n    exit(1);\n    }\n\n    /* lets listen on the socket for connections      */\n    returnStatus = listen(simpleSocket, 5);\n\n    if (returnStatus == -1) {\n        fprintf(stderr, \"Cannot listen on socket!\\n\");\n    close(simpleSocket);\n        exit(1);\n    }\n\n    while (1)\n\n    {\n\n        struct sockaddr_in clientName = { 0 };\n    int simpleChildSocket = 0;\n    int clientNameLength = sizeof(clientName);\n\n    /* wait here */\n\n        simpleChildSocket = accept(simpleSocket,(struct sockaddr *)&amp;clientName, &amp;clientNameLength);\n\n    if (simpleChildSocket == -1) {\n\n            fprintf(stderr, \"Cannot accept connections!\\n\");\n        close(simpleSocket);\n        exit(1);\n\n    }\n\n        /* handle the new connection request  */\n    /* write out our message to the client */\n\n\n        while(read(simpleChildSocket, buff, 256))\n            cont++;\n            printf(\"%s\", buff);\n        printf(\"Data received: %d %s\\n\", cont, buff);\n\n\n\n       close(simpleChildSocket);\n    }\n\n    close(simpleSocket);\n    return 0;\n\n}\n</code></pre>\n\n<p>The problem is with the \"for\" cicle because everytime I insert a number, buffer of server is emptied and prints only the last number received.\nThank you if provide a solution to this. </p>\n"}, {"tags": ["c", "stack-overflow", "maze"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1494426803, "post_id": 43895461, "comment_id": 74824955, "body": "you probably have to convert your recursive approach to an iterative approach with a custom stack."}, {"owner": {"reputation": 43245, "user_id": 699305, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/db6ce45b5ec86e1b00d922fc5cee315f?s=128&d=identicon&r=PG", "display_name": "alexis", "link": "https://stackoverflow.com/users/699305/alexis"}, "edited": false, "score": 3, "creation_date": 1494426803, "post_id": 43895461, "comment_id": 74824956, "body": "Probably not your intent, but the title is amusing for this site :-)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1494426954, "post_id": 43895461, "comment_id": 74825096, "body": "I rewrote something like that (flood fill, in python): <a href=\"http://stackoverflow.com/questions/40963288/fatal-python-error-cannot-recover-from-stack-overflow-during-flood-fill/40963737?s=2|0.2649#40963737\" title=\"fatal python error cannot recover from stack overflow during flood fill\">stackoverflow.com/questions/40963288/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1494427084, "post_id": 43895461, "comment_id": 74825225, "body": "As a rule of thumb: For a given problem, if recursion doesn&#39;t seem to make sense, then don&#39;t use recursion. If it does seem to make sense, then don&#39;t use recursion."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494427289, "post_id": 43895461, "comment_id": 74825410, "body": "@Lundin Your rule of thumb reduces to &quot;don&#39;t use recursion&quot; :) Why the hate towards recursion?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494427504, "post_id": 43895461, "comment_id": 74825582, "body": "@AjayBrahmakshatriya For the following reasons: 1) it is most of the time very slow 2) it is very memory-consuming 3) it is very dangerous 4) it is hard to read 5) it comes with no benefits what-so-ever in 99.9% of all use cases."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494427595, "post_id": 43895461, "comment_id": 74825654, "body": "@Lundin most compilers performing tail call optimizations make it bearable though. But yes, I agree, in general one should try to avoid."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494427745, "post_id": 43895461, "comment_id": 74825805, "body": "@AjayBrahmakshatriya Hence &quot;most of the time very slow&quot;. Tail recursion might, if you are lucky, get optimized to a loop. Or you could write it as a loop to begin with. But most confused uses of recursion are <i>not</i> tail call but some other mess, like in the above code. The compiler will not be able to optimize it, so the stack gets blown to pieces."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494427946, "post_id": 43895461, "comment_id": 74825986, "body": "I tried recursion because it was quite logic for this algorithm, I&#39;ll try to search for an interative approach !"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494430381, "post_id": 43895461, "comment_id": 74827879, "body": "Porr man&#39;s partial solution: you can save some stack space by avoiding the parameters <code>map</code> and <code>size</code> as they never change throughout the algorithm. Instead have 2 global variables <code>map</code> and <code>size</code>. So the prototype would be <code>recursive_gen(int x, int y,)</code>."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494431407, "post_id": 43895461, "comment_id": 74828544, "body": "I can&#39;t use globals :/ Forbiden by the exercise"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494428035, "post_id": 43895630, "comment_id": 74826070, "body": "As I&#39;m quite still a beginner, I didn&#39;t understand everything, especially the custom stack (a way to stack every coordinate visited, like the recursion &quot;does&quot; ?)  edit: I&#39;ll try to recode this without recursion so :)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494428172, "post_id": 43895630, "comment_id": 74826183, "body": "Yes you create a stack on the heap and push on it the coordinate to be processed. Keep processing every coordinate on the stack and adding there neighbours (if they are not added) till the stack is not empty."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494428601, "post_id": 43895630, "comment_id": 74826536, "body": "Here&#39;s is how I think it could work 1) Create a stack (maximum maze sized) 2) Do the algorithm while possible (puting every coord in the stack) 3) When can&#39;t move anymore, travel back in the stack while not possible 4) restart algorithm 5) Find a way to stop it (empty stack?)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494428667, "post_id": 43895630, "comment_id": 74826578, "body": "I will put in a simpler way in my answer. See if that helps."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494429037, "post_id": 43895630, "comment_id": 74826877, "body": "Thank you very much ! edit: is there a way to mark this question as solved? I&#39;m a bit new to this site :/ edit2: didn&#39;t look in the right place"}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494443298, "post_id": 43895630, "comment_id": 74835574, "body": "I edited my code, the problem is that it don&#39;t seems to be optimized, even after 30min, the 10k*10k don&#39;t show any result"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494443381, "post_id": 43895630, "comment_id": 74835623, "body": "10k * 10k cells. That is really a large number of cells. Try writing a simple loop that counts up to 10k * 10k and see how much time it takes."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494444400, "post_id": 43895630, "comment_id": 74836225, "body": "With just a single loop, that goes from 0 to 10k*10k, it took 0.22s"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494444603, "post_id": 43895630, "comment_id": 74836366, "body": "Yes, now imagine in each iteration, there are so many function calls, conditional branches, memory accesses etc. It is bound to take a lot of time."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494444746, "post_id": 43895630, "comment_id": 74836423, "body": "Well, I guess it has to take its time so :) Thank you for your help !"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494444812, "post_id": 43895630, "comment_id": 74836467, "body": "At the same time, the code can be optimized a lot. Try running the compiler with the highest optimization level, Like say -O2 or -O3. It will make your code considerably faster."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494444986, "post_id": 43895630, "comment_id": 74836555, "body": "-O2 and -O3 did a really great job, 1000*1000 was 43s, now 17s !"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494445073, "post_id": 43895630, "comment_id": 74836594, "body": "They optimize every nook and corner of the code with the given source. Although there may be source level optimizations too. Or even change in logic to make it faster."}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494445231, "post_id": 43895630, "comment_id": 74836677, "body": "I&#39;ll try to optimize the code a bit more (looking for shortcut, etc...)"}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494513460, "post_id": 43895630, "comment_id": 74870236, "body": "Just to give an update, I did some optimization in the program, now the 10000*10000 takes only 5s ! Thanks for all !"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494513582, "post_id": 43895630, "comment_id": 74870341, "body": "That is great! You could add your updated code to your questions for other readers to see if some one has similar issues in the future."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494514761, "post_id": 43895630, "comment_id": 74871370, "body": "Yes, an Edit and paste the new code. Do keep the original code (the problematic one) separately above for the question to be complete."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494515770, "post_id": 43895630, "comment_id": 74872210, "body": "@LeVentilo your function to find the last of stack is very inefficient. Iterating every time till the end to get the last. Why don&#39;t you just store the last index. And update it every time you push or pop from the stack. You will get even faster execution"}, {"owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "edited": false, "score": 0, "creation_date": 1494579849, "post_id": 43895630, "comment_id": 74899562, "body": "That&#39;s exactly what I did to save that much time (i used istack in the loop)"}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 2, "last_activity_date": 1494428957, "last_edit_date": 1494428957, "creation_date": 1494427061, "answer_id": 43895630, "question_id": 43895461, "link": "https://stackoverflow.com/questions/43895461/avoiding-stack-overflow-maze-generator-in-c/43895630#43895630", "title": "Avoiding stack overflow (Maze generator in C)", "body": "<p>The stack space is usually small and wont be enough to hold lots of stack frames from all the recursive calls. But the heap on the other hand has lots of space (Almost all of your virtual address space).</p>\n\n<p>So you can create a custom stack there which just holds the relevant data on it.</p>\n\n<p>Then you cam use a <code>while</code> loop to process each instance on the stack. Your code is a version of DFS. Look up how you can do DFS without recursion.</p>\n\n<p>The basic idea is that you start with an empty stack and push the first coordinate on it.</p>\n\n<p>Then repeat the following steps till there are elements on the stack (use a while loop).</p>\n\n<ol>\n<li>Pop an element from the stack</li>\n<li>Perform the operation for that point</li>\n<li>Add neighbours to the stack if they meet the condition (similar to what you used in recursion. Hint : See when do you call recursion, what condition do you check).</li>\n<li>Repeat if stack not empty.</li>\n</ol>\n\n<p>There is yet another way if you want to avoid all the code but are ready to sacrifice portability. </p>\n\n<p>You can allocate some space on the heap (order of 100s of MBs) and make that your call stack by setting the stack pointer to that. Then start your recursion. After the recursion is done switch back to original stack.</p>\n\n<p>Remember though you might have to change the Thread Environment Block's field to update the stack limit and stack base because the libraries may check against them to check if the stack is in the limit, or has overflowed.</p>\n"}], "owner": {"reputation": 87, "user_id": 7379715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a066a8ff507fec2aa18f3074f4cf7e33?s=128&d=identicon&r=PG&f=1", "display_name": "SamuelRousseaux", "link": "https://stackoverflow.com/users/7379715/samuelrousseaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 43895630, "answer_count": 1, "score": 3, "last_activity_date": 1494515631, "creation_date": 1494426681, "last_edit_date": 1494515631, "question_id": 43895461, "link": "https://stackoverflow.com/questions/43895461/avoiding-stack-overflow-maze-generator-in-c", "title": "Avoiding stack overflow (Maze generator in C)", "body": "<p>I'm currently writing a maze generator in C, using the depth-first search algorithm. It's working really well, and I'm happy with the result, but when I push the dimensions of the maze a bit too far (more than 2000x2000), it gives me a stack overflow.</p>\n\n<p>I know it's due to the recursivity used in the algorithm, but I really don't know how I can avoid this problem...</p>\n\n<p>Here's the sample of the program where the recursive occurs :</p>\n\n<p><strong>*int <em>dirs</em></strong> is composed of 4 numbers randomized (1, 2, 3 and 4)</p>\n\n<p><strong><em>x</em></strong> and <strong><em>y</em></strong> are the coordinates in the map</p>\n\n<pre><code>void    recursive_gen(char **map, int x, int y, t_size size)\n{\n  int   *dirs;\n  int   i;\n\n  i = -1;\n  dirs = gen_random_dirs();\n  while (++i &lt; 4)\n    {\n      if (dirs[i] == 1)\n        up(map, x, y, size);\n      if (dirs[i] == 2)\n        right(map, x, y, size);\n      if (dirs[i] == 3)\n        down(map, x, y, size);\n      if (dirs[i] == 4)\n        left(map, x, y, size);\n    }\n}\n</code></pre>\n\n<p>And there's up function (the other are pretty much the same):</p>\n\n<pre><code>void    up(char **map, int x, int y, t_size size)\n{\n  if (y - 2 &lt; 0)\n    return ;\n  if (map[y - 2][x] == 'X')\n    {\n      map[y - 1][x] = '*';\n      map[y - 2][x] = '*';\n      recursive_gen(map, x, y - 2, size);\n    }\n}\n</code></pre>\n\n<p><strong>EDIT :</strong>\nSo I did the same in iterative, with a custom stack to stock coords. It works great, but I can't figure out if 10k*10k maze if infinite looping, or if it's really really long (1000*1000 takes 43s, 10k*10k I stopped the program at 1000s)</p>\n\n<p>Is there anyway I can optimize it?\nHere's the new code :</p>\n\n<pre><code>void    recursive_gen(char **map, t_size size)\n{\n  int   *pos;\n  int   *dirs;\n  int   **stack;\n  int   i;\n  int   istack;\n\n  istack = 0;\n  pos = malloc(sizeof(int) * 2);\n  pos[0] = 0;\n  pos[1] = 0;\n  stack = alloc_stack(size);\n  while (is_stack_empty(stack) == 0)\n    {\n      dirs = gen_random_dirs();\n      i = -1;\n      while (++i &lt; 4)\n        {\n          if (dirs[i] == 1 &amp;&amp; up(map, pos, size, stack) == 1)\n            break ;\n          if (dirs[i] == 2 &amp;&amp; right(map, pos, size, stack) == 1)\n            break ;\n          if (dirs[i] == 3 &amp;&amp; down(map, pos, size, stack) == 1)\n            break ;\n          if (dirs[i] == 4 &amp;&amp; left(map, pos, size, stack) == 1)\n            break;\n        }\n      if (i == 4)\n        {\n          pos[0] = stack[istack][0];\n          pos[1] = stack[istack][1];\n          stack[istack][0] = -1;\n          stack[istack][1] = -1;\n          istack -= 1;\n        }\n      else\n        istack += 1;\n    }\n}\n</code></pre>\n\n<p>And the new up function :</p>\n\n<pre><code>int     lastof_stack(int **stack)\n{\n  int   i;\n\n  i = 0;\n  while (stack[i][1] != -1)\n    i++;\n  return (i);\n}\n\nint     up(char **map, int *pos, t_size size, int **stack)\n{\n  if (pos[1] - 2 &lt; 0)\n    return (0);\n  if (map[pos[1] - 2][pos[0]] == 'X')\n    {\n      map[pos[1] - 1][pos[0]] = '*';\n      map[pos[1] - 2][pos[0]] = '*';\n      pos[1] -= 2;\n      stack[lastof_stack(stack)][0] = pos[0];\n      stack[lastof_stack(stack)][1] = pos[1];\n      return (1);\n    }\n  return (0);\n}\n</code></pre>\n\n<p><strong><em>EDIT</em></strong> : working iterative program with custom stack (full working)</p>\n\n<p>Here's a sample of the final code !</p>\n\n<pre><code>int     sub_gen(int *pos, int **stack, int istack, int i)\n{\n  if (i == 4)\n    {\n      pos[0] = stack[istack][0];\n      pos[1] = stack[istack][1];\n      stack[istack][0] = -1;\n      stack[istack][1] = -1;\n      istack -= 1;\n    }\n  else\n    istack += 1;\n  return (istack);\n}\n\nvoid    recursive_gen(char **map, t_size size)\n{\n  int   *pos;\n  int   *dirs;\n  int   **stack;\n  int   i;\n  int   istack;\n\n  istack = 0;\n  pos = alloc_pos();\n  stack = alloc_stack(size);\n  while (stack[0][0] != -1)\n    {\n      dirs = gen_random_dirs();\n      i = -1;\n      while (++i &lt; 4)\n    if ((dirs[i] == 1 &amp;&amp; up(map, pos, stack, istack) == 1) ||\n            (dirs[i] == 2 &amp;&amp; right(map, pos, size, stack, istack) == 1) ||\n            (dirs[i] == 3 &amp;&amp; down(map, pos, size, stack, istack) == 1) ||\n            (dirs[i] == 4 &amp;&amp; left(map, pos, stack, istack) == 1))\n          break ;\n      istack = sub_gen(pos, stack, istack, i);\n    }\n}\n</code></pre>\n\n<p>and up function</p>\n\n<pre><code>int     up(char **map, int *pos, int **stack, int i)\n{\n  if (pos[1] - 2 &lt; 0)\n    return (0);\n  if (map[pos[1] - 2][pos[0]] == 'X')\n    {\n      map[pos[1] - 1][pos[0]] = '*';\n      map[pos[1] - 2][pos[0]] = '*';\n      pos[1] -= 2;\n      stack[i + 1][0] = pos[0];\n      stack[i + 1][1] = pos[1];\n      return (1);\n    }\n  return (0);\n}\n</code></pre>\n\n<p>I can upload the full code on github if someone's interested !</p>\n"}, {"tags": ["python", "c", "semaphore"], "comments": [{"owner": {"reputation": 2912, "user_id": 3081206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaKOY.jpg?s=128&g=1", "display_name": "takendarkk", "link": "https://stackoverflow.com/users/3081206/takendarkk"}, "edited": false, "score": 0, "creation_date": 1494431806, "post_id": 43895176, "comment_id": 74828800, "body": "&quot;<i>How should the correct alternative form of lightswitch semaphore look like in non-object oriented C language?</i>&quot; is just a fancy way of saying &quot;write code for me&quot; which is not what this website is for."}, {"owner": {"reputation": 87, "user_id": 4847441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fcc58f3174dc73035a4bb1978bac9ed?s=128&d=identicon&r=PG&f=1", "display_name": "Amphoru", "link": "https://stackoverflow.com/users/4847441/amphoru"}, "reply_to_user": {"reputation": 2912, "user_id": 3081206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaKOY.jpg?s=128&g=1", "display_name": "takendarkk", "link": "https://stackoverflow.com/users/3081206/takendarkk"}, "edited": false, "score": 0, "creation_date": 1495040528, "post_id": 43895176, "comment_id": 75088192, "body": "@csm_dev There is no need to &quot;write code for me&quot;. You could just point some ideas how should I do it. Nevermind, I made it anyways. Have a nice day :)"}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4847441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fcc58f3174dc73035a4bb1978bac9ed?s=128&d=identicon&r=PG&f=1", "display_name": "Amphoru", "link": "https://stackoverflow.com/users/4847441/amphoru"}, "is_accepted": false, "score": -1, "last_activity_date": 1494428541, "creation_date": 1494428541, "answer_id": 43896254, "question_id": 43895176, "link": "https://stackoverflow.com/questions/43895176/correct-form-of-lightswitch-semaphore-in-c/43896254#43896254", "title": "Correct form of lightswitch semaphore in C", "body": "<p>One of the solutions could look like this:</p>\n\n<pre><code>typedef struct \n{\n    int counter;\n    sem_t mutex;\n\n}LightSwitch;\n\nvoid ls_lock(LightSwitch *ls, sem_t *sem){\n    sem_wait(&amp;ls-&gt;mutex);\n    ls-&gt;counter++;\n    if (ls-&gt;counter == 1)\n    {\n        sem_wait(sem);\n    }\n    sem_post(&amp;ls-&gt;mutex);\n}\n\nvoid ls_unlock(LightSwitch *ls, sem_t* sem){\n    sem_wait(&amp;ls-&gt;mutex);\n    ls-&gt;counter--;\n    if (ls-&gt;counter == 0)\n    {\n         sem_post(sem);\n    }\n    sem_post(&amp;ls-&gt;mut);\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4847441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fcc58f3174dc73035a4bb1978bac9ed?s=128&d=identicon&r=PG&f=1", "display_name": "Amphoru", "link": "https://stackoverflow.com/users/4847441/amphoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1494428541, "creation_date": 1494425902, "last_edit_date": 1494426733, "question_id": 43895176, "link": "https://stackoverflow.com/questions/43895176/correct-form-of-lightswitch-semaphore-in-c", "title": "Correct form of lightswitch semaphore in C", "body": "<p>How should the correct alternative form of lightswitch semaphore look like in non-object oriented C language? Python reference of lightswitch semaphore is written in this paperwork <a href=\"http://greenteapress.com/semaphores/LittleBookOfSemaphores.pdf\" rel=\"nofollow noreferrer\">Little Book Of Semaphores</a>.</p>\n\n<p>Lightswitch code:</p>\n\n<pre><code>class Lightswitch :\n\n  def __init__(self):\n    self.counter = 0\n    self.mutex = Semaphore(1)\n\n  def lock(self, semaphore):\n    self.mutex.wait()\n      self.counter += 1\n      if self.counter == 1:\n        semaphore.wait()\n    self.mutex.signal()\n\n  def unlock(self, semaphore):\n    self.mutex.wait()\n      self.counter -= 1\n      if self.counter == 0:\n        semaphore.signal()\n    self.mutex.signal()\n</code></pre>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 4, "creation_date": 1494425960, "post_id": 43895145, "comment_id": 74824361, "body": "Your function <code>print_list</code> expects an argument of type  <code>node_t *</code> but you are passing <code>node_t **</code>. Change  <code>print_list(&amp;head);</code> to <code>print_list(head);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494426158, "post_id": 43895145, "comment_id": 74824499, "body": "Enable all compiler warnings and treat warnings as errors."}, {"owner": {"reputation": 83, "user_id": 7754119, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b61c26f9b193abc4d1c91015d557cff0?s=128&d=identicon&r=PG&f=1", "display_name": "Leet", "link": "https://stackoverflow.com/users/7754119/leet"}, "edited": false, "score": 0, "creation_date": 1494426865, "post_id": 43895145, "comment_id": 74825005, "body": "Oh, so it was that simple. Thank you everyone for your help! I&#39;ve just started playing with pointers so there&#39;s a great deal for me to learn."}], "answers": [{"tags": [], "owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "is_accepted": false, "score": 5, "last_activity_date": 1494426199, "creation_date": 1494426199, "answer_id": 43895287, "question_id": 43895145, "link": "https://stackoverflow.com/questions/43895145/linked-list-as-an-argument-to-a-function/43895287#43895287", "title": "Linked list as an argument to a function", "body": "<p>Note that your function <code>void print_list(node_t * head);</code> expects a parameter of type <code>node_t *</code> but you are passing parameter of type <code>node_t **</code>.<br/><br/>\nChange <code>print_list(&amp;head);</code> to <code>print_list(head);</code><br/><br/>\n<code>head</code> is of type <code>node_t *</code> while <code>&amp;head</code> is of type <code>node_t **</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1494426617, "last_edit_date": 1494426617, "creation_date": 1494426215, "answer_id": 43895288, "question_id": 43895145, "link": "https://stackoverflow.com/questions/43895145/linked-list-as-an-argument-to-a-function/43895288#43895288", "title": "Linked list as an argument to a function", "body": "<p>Change your <code>print_list(&amp;head)</code> function to <code>print_list(head)</code>.</p>\n\n<pre><code>print_list(&amp;head);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>print_list(head);\n</code></pre>\n\n<p>function <code>void print_list(node_t * head)</code> accepts single reference pointer. But your passing <code>**head</code> to the <code>print_list</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7987230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ea241cf0de2cc21e33f7cf54c10c53?s=128&d=identicon&r=PG&f=1", "display_name": "C. Hubbard", "link": "https://stackoverflow.com/users/7987230/c-hubbard"}, "is_accepted": false, "score": 0, "last_activity_date": 1494433733, "last_edit_date": 1494433733, "creation_date": 1494429969, "answer_id": 43896808, "question_id": 43895145, "link": "https://stackoverflow.com/questions/43895145/linked-list-as-an-argument-to-a-function/43896808#43896808", "title": "Linked list as an argument to a function", "body": "<p>Your <code>print_list</code> function is called using    <code>print_list(&amp;head);</code> , however head is already a pointer to a node. </p>\n\n<p>This means that the print_list function is actually receiving a pointer to a pointer to a node, or <code>node_t **</code>. As such, when you try to print the values of the pointer you will see something that appears to be a memory address. To fix this, just pass in the head of the list using    <code>print_list(head);</code></p>\n"}], "owner": {"reputation": 83, "user_id": 7754119, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b61c26f9b193abc4d1c91015d557cff0?s=128&d=identicon&r=PG&f=1", "display_name": "Leet", "link": "https://stackoverflow.com/users/7754119/leet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1494433733, "creation_date": 1494425815, "last_edit_date": 1494430513, "question_id": 43895145, "link": "https://stackoverflow.com/questions/43895145/linked-list-as-an-argument-to-a-function", "title": "Linked list as an argument to a function", "body": "<p>The program does not print the list's values as it is intended to. It prints something that's gotta be a memory address imo. I've been trying to find the solution solo, but to no avail thus far. I would appreciate some help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct node\n{\n    int val;\n    struct node * next;\n} node_t;\n\nvoid print_list(node_t * head);\n\nvoid main()\n{\n    node_t * head = NULL;\n    head = malloc(sizeof(node_t));\n    if (head == NULL)\n        return 1;\n    head-&gt;val = 1;\n    head-&gt;next = malloc(sizeof(node_t));\n    head-&gt;next-&gt;val = 2;\n    head-&gt;next-&gt;next = malloc(sizeof(node_t));\n    head-&gt;next-&gt;next-&gt;val = 3;\n    head-&gt;next-&gt;next-&gt;next = malloc(sizeof(node_t));\n    head-&gt;next-&gt;next-&gt;next-&gt;val = 18;\n    head-&gt;next-&gt;next-&gt;next-&gt;next = NULL;\n\n    print_list(&amp;head);\n    system(\"pause\");\n}\n\nvoid print_list(node_t * head) {\n    node_t * current = head;\n\n    while (current != NULL) {\n        printf(\"%d\\n\", current-&gt;val);\n        current = current-&gt;next;\n    }\n}\n</code></pre>\n\n<p>The aforementioned problem was resolved thanks to your inputs. Thank you very much! However, a new issue occurred. Wanting to add a new element to the list, I added a few lines of code. Unfortunately, the wanted result is not printed and the program is terminated abruptly. Here's the new code:</p>\n\n<pre><code>    head-&gt;next-&gt;next-&gt;next-&gt;next = malloc(sizeof(node_t));\n    head-&gt;next-&gt;next-&gt;next-&gt;next-&gt;val = 5556;\n    head-&gt;next-&gt;next-&gt;next-&gt;next-&gt;next = NULL;\n    node_t * current = head;\n    while (current-&gt;next != NULL) \n    {\n        current = current-&gt;next;\n    }\n    current-&gt;next = malloc(sizeof(node_t));\n    current-&gt;next-&gt;val = 32;\n    current-&gt;next-&gt;next = NULL;\n    printf(\"%d\\n\", current-&gt;next-&gt;val);\n    system(\"pause\");\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 931, "user_id": 2394967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFaiD.png?s=128&g=1", "display_name": "sknt", "link": "https://stackoverflow.com/users/2394967/sknt"}, "edited": false, "score": 0, "creation_date": 1494427210, "post_id": 43894889, "comment_id": 74825341, "body": "This needs more detail, did you serialize the struct to a binary file? If yes show us the code that does that. Is it possible to create a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> ?"}, {"owner": {"reputation": 1, "user_id": 7992087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71aae19e2e04ae5b5d666da9b4356dd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Berry", "link": "https://stackoverflow.com/users/7992087/j-berry"}, "reply_to_user": {"reputation": 931, "user_id": 2394967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFaiD.png?s=128&g=1", "display_name": "sknt", "link": "https://stackoverflow.com/users/2394967/sknt"}, "edited": false, "score": 0, "creation_date": 1494432726, "post_id": 43894889, "comment_id": 74829315, "body": "Don&#39;t worry about this, I got carried away trying to get some file handling in it and forgot I created it as a linked list. Should&#39;ve paid more attention to the rest of the code."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1494425420, "creation_date": 1494425420, "answer_id": 43894965, "question_id": 43894889, "link": "https://stackoverflow.com/questions/43894889/access-violation-reading-data-from-binary-file-into-struct-in-c/43894965#43894965", "title": "Access violation reading data from binary file into struct in C", "body": "<p>Since pointers are assigned in run-time and addresses are handed out in run-time, it makes no sense whatsoever to store/load a binary image containing pointers inside a file, because addresses will vary each time your program is executed.</p>\n\n<p>Therefore you cannot load this struct. You'll have to re-write your whole program from scratch as it makes no sense.</p>\n"}], "owner": {"reputation": 1, "user_id": 7992087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71aae19e2e04ae5b5d666da9b4356dd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Berry", "link": "https://stackoverflow.com/users/7992087/j-berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 43894965, "answer_count": 1, "score": -5, "last_activity_date": 1494425420, "creation_date": 1494425202, "question_id": 43894889, "link": "https://stackoverflow.com/questions/43894889/access-violation-reading-data-from-binary-file-into-struct-in-c", "title": "Access violation reading data from binary file into struct in C", "body": "<p>I've been trying to read in data from a binary file storing a struct but while the file is read in correctly any attempt to access the struct causes an access violation. \nThis is the struct:</p>\n\n<pre><code>typedef struct Object {\n    const char *Description;\n    const char *Tag[20];\n    struct Object *Location;\n    struct Object *Destination;\n} OBJECT;\n</code></pre>\n\n<p>Here's the code used to read in the file:</p>\n\n<pre><code>int ReadInDataFiles(OBJECT Objects[])\n{\n    FILE *pObjectFile = NULL;\n    OBJECT TempObjects;\n\n    if (fopen_s(&amp;pObjectFile, OBJECT_FILE, \"rb\") != 0)\n    {\n        printf(\"Error: external file cannot be opened.\");\n        return 1;\n    }\n    else\n    {\n        fread(&amp;TempObjects, sizeof(OBJECT), 1, pObjectFile);\n\n        for (int Count = 0; Count &lt; NUMBER_OF_OBJECTS; Count++)\n        {\n            Objects[Count] = TempObjects;\n\n            fread(&amp;TempObjects, sizeof(OBJECT), 1, pObjectFile);\n        }\n\n        fclose(pObjectFile);\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1494424655, "post_id": 43894537, "comment_id": 74823277, "body": "You shouldn&#39;t <code>malloc</code> inside the loop. (You could use <code>realloc</code>, though.) It&#39;s easier to make an extra loop before, where you count the capital letters. Then allocate space as appropriate, then copy the capital letters from <code>A</code> to <code>B</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494424678, "post_id": 43894537, "comment_id": 74823302, "body": "This looks similar to <a href=\"http://stackoverflow.com/questions/43893471/how-to-make-a-function-to-read-an-array-in-c/43893606#43893606\">this SO question</a>"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1494425225, "post_id": 43894537, "comment_id": 74823755, "body": "You shouldn&#39;t <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Cast the result of malloc</a>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494425964, "post_id": 43894537, "comment_id": 74824370, "body": "Now you are using <code>counter</code> and <code>counter1</code> with <code>malloc</code> before you have determined them. Therefore you are allocating 0 bytes. Actually the program was less wrong <i>before</i> your edit."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494425239, "post_id": 43894738, "comment_id": 74823769, "body": "after moving memory allocation before copying characher, still can&#39;t get them copied and printed for some reason..."}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 0, "last_activity_date": 1494425465, "last_edit_date": 1494425465, "creation_date": 1494424836, "answer_id": 43894738, "question_id": 43894537, "link": "https://stackoverflow.com/questions/43894537/separating-capital-letters-from-char-array-into-the-new-array-and-rellocating-me/43894738#43894738", "title": "Separating capital letters from char array into the new array and rellocating memory for it in C", "body": "<p>You have assigned character values to arrB and arrC, prior to allocating memory to them, you need to allocate memory first, then copy characters in them</p>\n\n<p>Also check assignment</p>\n\n<pre><code> *arrB = *arrA;\n</code></pre>\n\n<p>change it to</p>\n\n<pre><code> arrB[j++] = arrA[i];// maintain seperator counter j for arrB as you want to increment it only for capital letters, init it to 0 prior to starting loop\n</code></pre>\n\n<p>You need to do same for arrC's loop</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494426555, "post_id": 43895357, "comment_id": 74824766, "body": "first approach would be better for me because if fits more into my assingment, possibly with using relloc, because we haven&#39;t used functions yet in class, I would appreciate if you post it :)"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 0, "last_activity_date": 1494427087, "last_edit_date": 1494427087, "creation_date": 1494426411, "answer_id": 43895357, "question_id": 43894537, "link": "https://stackoverflow.com/questions/43894537/separating-capital-letters-from-char-array-into-the-new-array-and-rellocating-me/43895357#43895357", "title": "Separating capital letters from char array into the new array and rellocating memory for it in C", "body": "<p>You could follow two different approaches.</p>\n\n<p>The first approach would be to allocate the maximum amount of chars (i.e. <code>arrB = malloc(n * sizeof(char))</code>) for both <code>arrB</code> and <code>arrC</code>. You could then live with some unused memory or <code>realloc</code> these arrays once you have copied the characters and finally know their number (i.e. <code>arrB = realloc(arrB, countCapital * sizeof(char))</code>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint isCapitalLetter(char c) {\n    return (c &gt;= 'A') &amp;&amp; (c &lt;= 'Z');\n}\n\nint isSmallLetter(char c) {\n    return (c &gt;= 'a') &amp;&amp; (c &lt;= 'z');\n}\n\nint main() {\n    int n=0, i, countCapital, countSmall;\n    char *arrA, *arrB, *arrC;\n\n\n    printf(\"Enter number of elements: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"Enter elements of array: \\n\");\n\n\n    arrA = malloc(n * sizeof(char));\n    arrB = malloc(n * sizeof(char));\n    arrC = malloc(n * sizeof(char));\n\n    for (i = 0; i &lt; n; i++) {\n        scanf(\" %c\", &amp;arrA[i]);\n    }\n\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%d. element of array is: %c\\n\", i + 1, arrA[i]);\n    }\n\n    countCapital = 0;\n    countSmall = 0;\n    for (i = 0; i &lt; n; i++) {\n        char c = arrA[i];\n        if (isCapitalLetter(c)) {\n            arrB[countCapital++] = c;\n        }\n        else if (isSmallLetter(c)) {\n            arrC[countSmall++] = c;\n        }\n    }\n    arrB = realloc(arrB, countCapital * sizeof(char));\n    arrC = realloc(arrC, countSmall * sizeof(char));\n\n    for (i = 0; i &lt; countCapital; i++) {\n        printf(\"%d. element of array B is: %c\\n\", i + 1, arrB[i]);\n    }\n    for (i = 0; i &lt; countSmall; i++) {\n        printf(\"%d. element of array C is: %c\\n\", i + 1, arrC[i]);\n    }\n    free(arrA);\n    free(arrB);\n    free(arrC);\n\n    return 0;\n}\n</code></pre>\n\n<p>The second approach would be to count capital and small letters, respectively; then allocate <code>arrB</code> and <code>arrC</code> accordingly before copying the values into them:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint isCapitalLetter(char c) {\n    return (c &gt;= 'A') &amp;&amp; (c &lt;= 'Z');\n}\n\nint isSmallLetter(char c) {\n    return (c &gt;= 'a') &amp;&amp; (c &lt;= 'z');\n}\n\nint main() {\n    int n=0, i, countCapital, countSmall;\n    char *arrA, *arrB, *arrC;\n\n\n    printf(\"Enter number of elements: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"Enter elements of array: \\n\");\n\n\n    arrA = malloc(n * sizeof(char));\n\n    for (i = 0; i &lt; n; i++) {\n        scanf(\" %c\", &amp;arrA[i]);\n    }\n\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%d. element of array is: %c\\n\", i + 1, arrA[i]);\n    }\n\n    countCapital = 0;\n    countSmall = 0;\n    for (i = 0; i &lt; n; i++) {\n        if (isCapitalLetter(arrA[i])) {\n            countCapital++;\n        }\n        else if (isSmallLetter(arrA[i])) {\n            countSmall++;\n        }\n    }\n\n    arrB = malloc(countCapital * sizeof(char));\n    arrC = malloc(countSmall * sizeof(char));\n\n    char *writeCaptialPtr = arrB;\n    char *writeSmallPtr = arrC;\n    for (i = 0; i &lt; n; i++) {\n        char c = arrA[i];\n        if (isCapitalLetter(c)) {\n            *writeCaptialPtr++ = c;\n        }\n        else if (isSmallLetter(c)) {\n            *writeSmallPtr++ = c;\n        }\n    }\n\n    for (i = 0; i &lt; countCapital; i++) {\n        printf(\"%d. element of array B is: %c\\n\", i + 1, arrB[i]);\n    }\n    for (i = 0; i &lt; countSmall; i++) {\n        printf(\"%d. element of array C is: %c\\n\", i + 1, arrC[i]);\n    }\n    free(arrA);\n    free(arrB);\n    free(arrC);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494427057, "post_id": 43895520, "comment_id": 74825195, "body": "problem is, can&#39;t use that isupper/islower functions because we haven&#39;t learned them in class..."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494427224, "post_id": 43895520, "comment_id": 74825355, "body": "@SvenB No prpblem. The function calls can be substituted for conditions in the original code."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1494427163, "last_edit_date": 1494427163, "creation_date": 1494426812, "answer_id": 43895520, "question_id": 43894537, "link": "https://stackoverflow.com/questions/43894537/separating-capital-letters-from-char-array-into-the-new-array-and-rellocating-me/43895520#43895520", "title": "Separating capital letters from char array into the new array and rellocating memory for it in C", "body": "<p>In fact you are doing all correctly except that at first you have to count the number of the capital letters and the number of the small letters and only after that to allocate memory for the arrays and copy corresponding letters in them.</p>\n\n<p>Otherwise these statements</p>\n\n<pre><code>arrB = (char*)malloc(counter * sizeof(char));\narrC = (char*)malloc(counter1 * sizeof(char));\n</code></pre>\n\n<p>do not make sense because at this point of the program the variables <code>counter</code> and <code>counter1</code> are equal to zero.</p>\n\n<p>And correspondingly these statements</p>\n\n<pre><code>*arrB = *arrA;\n*arrC = *arrA;\n</code></pre>\n\n<p>also do not make sense because they reference the same elements of the arrays.</p>\n\n<p>Also you should use standard C function <code>isupper</code> and <code>islower</code>.</p>\n\n<p>The program can look the following way</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main( void ) \n{\n    size_t n;\n    size_t i, j, k;\n    size_t counter, counter1;\n    char *arrA, *arrB, *arrC;\n\n    printf( \"Enter number of elements: \" );\n    scanf( \"%zu\", &amp;n );\n\n    printf( \"Enter elements of array separated by spaces: \\n\" );\n\n\n    arrA = ( char* )malloc( n * sizeof( char ) );\n\n    for ( i = 0; i &lt; n; i++ ) scanf( \" %c\", &amp;arrA[i] );\n\n    putchar( '\\n' );\n\n    for ( i = 0; i &lt; n; i++ ) \n    {\n        printf( \"%zu. element of array is: %c\\n\", i + 1, arrA[i]);\n    }\n\n    counter = counter1 = 0;\n\n    for ( i = 0; i &lt; n; i++ ) \n    {\n        if ( isupper( ( unsigned char )arrA[i] ) ) \n        {\n            counter++;\n        }\n        else if ( islower( ( unsigned char )arrA[i] ) )\n        {\n            counter1++;\n        }\n    }\n\n    arrB = arrC = NULL;\n    if ( counter )  arrB = ( char* )malloc( counter  * sizeof( char ) );\n    if ( counter1 ) arrC = ( char* )malloc( counter1 * sizeof( char ) );\n\n    for ( i = j = k = 0; i &lt; n; i++ ) \n    {\n        if ( isupper( ( unsigned char )arrA[i] ) ) \n        {\n            arrB[j++] = arrA[i];\n        }\n        else if ( islower( ( unsigned char )arrA[i] ) )\n        {\n            arrC[k++] = arrA[i];\n        }\n    }\n\n    if ( arrB ) putchar( '\\n' );\n\n    for ( j = 0; j &lt; counter; j++ ) \n    {\n        printf( \"%zu. element of array B is: %c\\n\", j + 1, arrB[j] );\n    }\n\n    if ( arrC ) putchar( '\\n' );\n\n    for ( k = 0; k &lt; counter1; k++ ) \n    {\n        printf( \"%zu. element of array C is: %c\\n\", k + 1, arrC[k] );\n    }\n\n    free( arrC );\n    free( arrB );\n    free (arrA );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>Enter number of elements: 10\nEnter elements of array separated by spaces: a b c 1 2 Z x Y w 5\n\n1. element of array is: a\n2. element of array is: b\n3. element of array is: c\n4. element of array is: 1\n5. element of array is: 2\n6. element of array is: Z\n7. element of array is: x\n8. element of array is: Y\n9. element of array is: w\n10. element of array is: 5\n\n1. element of array B is: Z\n2. element of array B is: Y\n\n1. element of array C is: a\n2. element of array C is: b\n3. element of array C is: c\n4. element of array C is: x\n5. element of array C is: w\n</code></pre>\n\n<p>If you may not use the functions <code>isupper</code> and <code>islower</code> then you can substitute them for used by you conditions. For example</p>\n\n<pre><code>if ( 'A' &lt;= arrA[i] &amp;&amp; arrA[i] &lt;= 'Z' )\n{\n//... \n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 43895357, "answer_count": 3, "score": 0, "last_activity_date": 1494879533, "creation_date": 1494424375, "last_edit_date": 1494879533, "question_id": 43894537, "link": "https://stackoverflow.com/questions/43894537/separating-capital-letters-from-char-array-into-the-new-array-and-rellocating-me", "title": "Separating capital letters from char array into the new array and rellocating memory for it in C", "body": "<p>I have array in which I enter number of elements, enter all the elements, print them, and after that I should transfer all the capital letters into the new array, and small letters into another array, allocate memory for them and print it. I've tried it this way but it didn't worked:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int n, i, j, counter=0, counter1=0;\n    char *arrA, *arrB, *arrC;\n\n    printf(\"Enter number of elements: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"Enter elements of array: \\n\");\n\n\n    arrA = (char*)malloc(n * sizeof(char));\n\n    for (i = 0; i &lt; n; i++) {\n        scanf(\" %c\", &amp;arrA[i]);\n    }\n\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%d. element of array is: %c\\n\", i + 1, arrA[i]);\n    }\n    arrB = (char*)malloc(counter * sizeof(char));\n    arrC = (char*)malloc(counter1 * sizeof(char));\n\n    for (i = 0; i &lt; n; i++) {\n        if ((arrA[i] &gt;= 'A') &amp;&amp; (arrA[i] &lt;= 'Z')) {\n            counter++;\n            *arrB = *arrA;\n        }\n    }\n    for (i = 0; i &lt; n; i++) {\n        if ((arrA[i] &gt;= 'a') &amp;&amp; (arrA[i] &lt;= 'z')) {\n            counter1++;\n            *arrC = *arrA;\n        }\n    }\n\n\n    for (i = 0; i &lt; counter; i++) {\n        printf(\"%d. element of array B is: %c\\n\", i + 1, arrB[i]);\n    }\n    for (i = 0; i &lt; counter1; i++) {\n        printf(\"%d. element of array C is: %c\\n\", i + 1, arrC[i]);\n    }\n    free(arrA);\n    free(arrB);\n    free(arrC);\n\n    return 0;\n}\n</code></pre>\n\n<p>How can I separate those capital letters into the new array \"arrB\"?</p>\n"}, {"tags": ["c", "pointers", "syntax"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 3, "creation_date": 1494424564, "post_id": 43894495, "comment_id": 74823200, "body": "Can you explain what you think a variable is? Is it a name that can be used in a certain way? Is it a place to store a value? What sort of value? As asked, your question may not be answered to your satisfaction."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1494424634, "post_id": 43894495, "comment_id": 74823267, "body": "Time to read the basics...."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1494424994, "post_id": 43894596, "comment_id": 74823550, "body": "Rather, an address is a number and pointer is the group name for the C variable types used for storing addresses. The term pointer does not exist outside C (and C++)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494426374, "post_id": 43894596, "comment_id": 74824644, "body": "Pointer may or may not be an integer. In a specific implementation it is an integer. The C standard does not impose any such restriction."}], "tags": [], "owner": {"reputation": 58, "user_id": 6131425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1716544318613837/picture?type=large", "display_name": "Hassan A. El-Seoudy", "link": "https://stackoverflow.com/users/6131425/hassan-a-el-seoudy"}, "is_accepted": true, "score": 1, "last_activity_date": 1494424545, "creation_date": 1494424545, "answer_id": 43894596, "question_id": 43894495, "link": "https://stackoverflow.com/questions/43894495/do-declaring-a-pointer-in-c-also-declare-a-variable-with-the-same-name/43894596#43894596", "title": "Do declaring a pointer in C also declare a variable with the same name", "body": "<p>NO, A pointer is just like an int: a number. It happens to be a number that identifies a memory location, and if something is stored in that memory location you can call it an address. Like an int, a pointer can be stored in a variable. A variable that stores a pointer could be called a pointer variable.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494424670, "post_id": 43894602, "comment_id": 74823296, "body": "despite all facts, how does this answers the question?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494426451, "post_id": 43894602, "comment_id": 74824694, "body": "@dbush, I think the question asked is much simpler. Whether <code>pointer</code> is a variable or not."}, {"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494427848, "post_id": 43894602, "comment_id": 74825895, "body": "This doesn&#39;t indeed answer the question. But I think it was good mention of the undefined behaviour. Thanks"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1494424936, "last_edit_date": 1494424936, "creation_date": 1494424555, "answer_id": 43894602, "question_id": 43894495, "link": "https://stackoverflow.com/questions/43894495/do-declaring-a-pointer-in-c-also-declare-a-variable-with-the-same-name/43894602#43894602", "title": "Do declaring a pointer in C also declare a variable with the same name", "body": "<p>What you have is a variable names <code>pointer</code> whose type is <code>int *</code>, i.e. a pointer to an <code>int</code>.  This does <em>not</em> give you space to store an <code>int</code>.</p>\n\n<p>For example, if you did this:</p>\n\n<pre><code>int *pointer;\n*pointer = 1;\n</code></pre>\n\n<p>You would be invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> since you would be attempting to dereference an uninitialized pointer.</p>\n\n<p>This however is valid.</p>\n\n<pre><code>int value;\nint *pointer;\npointer = &amp;value;\n*pointer = 1;\n</code></pre>\n\n<p>In this example, we set <code>pointer</code> to the address of a variable of type <code>int</code>.  We are then able to dereference that variable to read/write the location it points to.</p>\n\n<p>So to summarize, declaring a pointer to a type does not automatically give you space for the type itself.</p>\n"}, {"comments": [{"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494427804, "post_id": 43894620, "comment_id": 74825856, "body": "Thanks, quite a refresher :)"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 6, "last_activity_date": 1494424601, "creation_date": 1494424601, "answer_id": 43894620, "question_id": 43894495, "link": "https://stackoverflow.com/questions/43894495/do-declaring-a-pointer-in-c-also-declare-a-variable-with-the-same-name/43894620#43894620", "title": "Do declaring a pointer in C also declare a variable with the same name", "body": "<p>Let's get the terminology straight:</p>\n\n<ul>\n<li><code>int *pointer</code> declares a variable</li>\n<li>Variables have a name and a type</li>\n<li>The name of the variable is <code>pointer</code></li>\n<li>The type of the variable is \"pointer to <code>int</code>\"</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1494515706, "creation_date": 1494515706, "answer_id": 43919423, "question_id": 43894495, "link": "https://stackoverflow.com/questions/43894495/do-declaring-a-pointer-in-c-also-declare-a-variable-with-the-same-name/43919423#43919423", "title": "Do declaring a pointer in C also declare a variable with the same name", "body": "<p>the question: can the code have a variable and a pointer with the same name?</p>\n\n<p>The answer is NO, because those names are in the same 'scope;;</p>\n\n<p>If they were each local to different functions (or different files) then they are in different 'scopes' then, YES then can have the same name.</p>\n"}], "owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 2, "accepted_answer_id": 43894596, "answer_count": 4, "score": 0, "last_activity_date": 1494515706, "creation_date": 1494424303, "question_id": 43894495, "link": "https://stackoverflow.com/questions/43894495/do-declaring-a-pointer-in-c-also-declare-a-variable-with-the-same-name", "title": "Do declaring a pointer in C also declare a variable with the same name", "body": "<p>If i create a pointer like:</p>\n\n<pre><code> int *pointer;\n</code></pre>\n\n<p>is also a variable (called pointer) created in the C Language? Why/why not?</p>\n"}, {"tags": ["c", "pointers", "c-preprocessor", "string-literals"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1494424344, "post_id": 43894420, "comment_id": 74823040, "body": "you can&#39;t. Macro evaluation ist simply text replacement so your code isn&#39;t different at all from <code>char *my_id = &quot;28&quot;;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1494424357, "creation_date": 1494424357, "answer_id": 43894523, "question_id": 43894420, "link": "https://stackoverflow.com/questions/43894420/does-data-under-address-assigned-using-define-can-be-overwritten/43894523#43894523", "title": "Does data under address assigned using #define can be overwritten?", "body": "<p>A <code>#define</code> just does text substitution.  So what you have is equivalent to:</p>\n\n<pre><code>char *my_id = \"28\";\n</code></pre>\n\n<p>What this means is that <code>my_id</code> points to the string constant <code>\"28\"</code>.  String constants are typically stored in a read-only data section, so there's nothing to allocate/deallocate.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1494424762, "last_edit_date": 1494424762, "creation_date": 1494424364, "answer_id": 43894525, "question_id": 43894420, "link": "https://stackoverflow.com/questions/43894420/does-data-under-address-assigned-using-define-can-be-overwritten/43894525#43894525", "title": "Does data under address assigned using #define can be overwritten?", "body": "<p>After preprocessing, your snippet looks like</p>\n\n<pre><code> char * my_id = \"28\";\n</code></pre>\n\n<p>so, <code>my_id</code> points to the string literal <code>\"28\"</code>.</p>\n\n<p>For string literals, it basically is a null terminated character array with <code>static</code> storage duration. But, attempt to modify a(ny) string literal causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.4.5, <em>String literals</em>, paragraph 6,</p>\n\n<blockquote>\n  <p>In translation phase 7, a byte or code of value zero is appended to each multibyte\n  character sequence that results from a string literal or literals.<sup>78)</sup> The multibyte character\n  sequence is then used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. For character string literals, the array elements have\n  type char, and are initialized with the individual bytes of the multibyte character\n  sequence. [...]</p>\n</blockquote>\n\n<p>and paragraph 7,</p>\n\n<blockquote>\n  <p>[...] If the program attempts to modify such an array, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>So, <strong>TL:DR</strong>, <code>my_id</code> points to the string literal, or for the sake of accuracy, it holds the address of the first element of the null-terminated array with static storage, initialized with the content <code>\"28\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1494425194, "post_id": 43894532, "comment_id": 74823732, "body": "No, string literals are not stored on the stack on any system I&#39;ve ever worked with. Because they need to be preserved throughout the whole execution of the program. They tend to be stored in either <code>.rodata</code> or <code>.text</code> sections, or possibly in a dedicated section for string literals. Or do you mean that the pointer itself will likely be a stack variable? Please clarify."}, {"owner": {"reputation": 703, "user_id": 7959503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZhz50YXYTc/AAAAAAAAAAI/AAAAAAAA5pU/fdQ_dA-dKSE/photo.jpg?sz=128", "display_name": "Chris Rouffer", "link": "https://stackoverflow.com/users/7959503/chris-rouffer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494425913, "post_id": 43894532, "comment_id": 74824321, "body": "It totally depends on the platform.  The C spec. doesn&#39;t require literals to be stored in any particular place.  There is a good discussion here:  <a href=\"http://stackoverflow.com/questions/2589949/c-string-literals-where-do-they-go\" title=\"c string literals where do they go\">stackoverflow.com/questions/2589949/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1494426306, "post_id": 43894532, "comment_id": 74824600, "body": "That would be because the C standard does not even give a name for different kinds of memory, so it is quite irrelevant here. What&#39;s relevant is to look at industry de facto standards for memory sections. All computers use similar section names. None stores string literals on the stack because that doesn&#39;t make any sense."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494426746, "post_id": 43894532, "comment_id": 74824915, "body": "@ChrisRouffer the moment you mentioned the word &quot;stack&quot;, the C standard went out of the picture. You are now talking about one specific implementation which uses a stack and there it cannot place string literals on the stack since it would go out of scope once the stack frame is destroyed. Meaning the content will be open to be overwritten by whatever functions come in later."}], "tags": [], "owner": {"reputation": 703, "user_id": 7959503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZhz50YXYTc/AAAAAAAAAAI/AAAAAAAA5pU/fdQ_dA-dKSE/photo.jpg?sz=128", "display_name": "Chris Rouffer", "link": "https://stackoverflow.com/users/7959503/chris-rouffer"}, "is_accepted": false, "score": 0, "last_activity_date": 1494428116, "last_edit_date": 1494428116, "creation_date": 1494424370, "answer_id": 43894532, "question_id": 43894420, "link": "https://stackoverflow.com/questions/43894420/does-data-under-address-assigned-using-define-can-be-overwritten/43894532#43894532", "title": "Does data under address assigned using #define can be overwritten?", "body": "<p>The string \"28\" will be stored in a section of your executable.  The pointer, my_id, will point to the address of the string \"28\".  </p>\n\n<p><em>Edited to remove mistaken reference to 'stack'.  Thank you commenters for your clarification.</em></p>\n"}], "owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 43894523, "answer_count": 3, "score": 0, "last_activity_date": 1494428116, "creation_date": 1494424110, "last_edit_date": 1494424736, "question_id": 43894420, "link": "https://stackoverflow.com/questions/43894420/does-data-under-address-assigned-using-define-can-be-overwritten", "title": "Does data under address assigned using #define can be overwritten?", "body": "<p>I have a hard time uderestanding how #define works when combined with pointers.</p>\n\n<p>Here is my pseudocode:</p>\n\n<pre><code>#define ID \"28\"      // I need to keep it as string\n\nint main()\n{\n    char * my_id = ID;\n    ...\n    ...\n}\n</code></pre>\n\n<p>Now what is actually <code>my_id</code> pointing to ? I did not call alloc nor statically allocated memory for my variable so can data under address <code>my_id</code> be overwritten?</p>\n"}, {"tags": ["c++", "c", "arrays", "string", "character"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1494423049, "post_id": 43893935, "comment_id": 74822008, "body": "Hint: <code>st2[]=&quot;&quot;</code> is probably meaninless."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494423177, "post_id": 43893935, "comment_id": 74822111, "body": "Is it C or C++?"}, {"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494423333, "post_id": 43893935, "comment_id": 74822228, "body": "Ohh! Can you explain why it is working right after using &quot;st2[10]&quot; instead? @SouravGhosh"}, {"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494423381, "post_id": 43893935, "comment_id": 74822264, "body": "it is c++ @tilz0R"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494423425, "post_id": 43893935, "comment_id": 74822303, "body": "@SadmanRizwan updated answer."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494423677, "post_id": 43893935, "comment_id": 74822522, "body": "It&#39;s already explained in the dupe linked answer."}], "answers": [{"tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1494423240, "creation_date": 1494423240, "answer_id": 43894048, "question_id": 43893935, "link": "https://stackoverflow.com/questions/43893935/printf-skips-first-character-of-character-array/43894048#43894048", "title": "printf skips first character of character array", "body": "<p><code>char st1[10],st2[]=\"\";</code> reserves 10 bytes for <code>st1</code> and 1 byte for <code>st2</code>.</p>\n\n<p>Then you are trying to copy content of st1 to st2.</p>\n\n<p>Remove this as it is not required: </p>\n\n<pre><code>strcpy(st2,\"\");\n</code></pre>\n\n<p>Change this:</p>\n\n<pre><code>char st1[10],st2[10];\n</code></pre>\n\n<p>Now you have memory for both variables and you can copy data between. In first example you did not have reserved enough memory for <code>st2</code> variable and behaviour was in general undefined.</p>\n"}], "owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "closed_date": 1494423209, "answer_count": 1, "score": -1, "last_activity_date": 1494423240, "creation_date": 1494422947, "question_id": 43893935, "link": "https://stackoverflow.com/questions/43893935/printf-skips-first-character-of-character-array", "closed_reason": "Duplicate", "title": "printf skips first character of character array", "body": "<p>In the code given below, I am trying to take string input using <strong>scanf</strong> in <strong>while</strong> loop. When I print that string, it is printed without the first character. But it prints correctly when I copy it in another string and print that new string. </p>\n\n<p>In my code, if I give <strong>\"abc\"</strong> as input and print both strings, then <strong>\"bc abc\"</strong> is printed instead of <strong>\"abc abc\"</strong>.</p>\n\n<p>What is the reason for this? Is something wrong in my code?</p>\n\n<pre><code>int main()\n{\n    char st1[10],st2[]=\"\";\n    while(scanf(\"%s\",st1)==1){\n        strcpy(st2,st1);\n        printf(\"%s %s\\n\",st1,st2);\n        strcpy(st2,\"\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1494422855, "post_id": 43893852, "comment_id": 74821852, "body": "Call <code>isalpha</code> on the characters you read?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494423596, "post_id": 43893852, "comment_id": 74822457, "body": "Please provide the function declaration for <code>linkLst</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494424088, "post_id": 43893852, "comment_id": 74822842, "body": "Could you give us an example of a line from the input file and the corresponding string you want to pass to <code>linkLst</code>? Don&#39;t answer in a comment but edit your question."}, {"owner": {"reputation": 73, "user_id": 7288288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/728035f4c65455aa9cd2dd97cdc9efc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jayamal Jayamaha  ", "link": "https://stackoverflow.com/users/7288288/jayamal-jayamaha"}, "edited": false, "score": 0, "creation_date": 1494424782, "post_id": 43893852, "comment_id": 74823386, "body": "I added a part of the file"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494424917, "post_id": 43893852, "comment_id": 74823485, "body": "Also can you specify what is the expected behavior? What should go into the linkLst?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1494428067, "post_id": 43893852, "comment_id": 74826103, "body": "&quot;I want to ignore non alphabetic characters like commas, \\ , :,&quot; --&gt; Should code <i>ignore</i> them or use them as <i>word</i> separators?  <code>abc:def</code> --&gt; 1 word  <code>abcdef</code> or 2 words <code>abc</code>, <code>def</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494423339, "post_id": 43893930, "comment_id": 74822233, "body": "Since OP has called <code>linkList</code> on <code>c</code> it would appear that it takes <code>char*</code>. You are passing a char."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494423471, "post_id": 43893930, "comment_id": 74822338, "body": "Did you saw my statement on last line or not?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494423563, "post_id": 43893930, "comment_id": 74822435, "body": "But what if <code>linkLst</code> needs <code>char*</code> ?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494423822, "post_id": 43893930, "comment_id": 74822640, "body": "OP is passing the entire string he reads to <code>linkLst</code>. All he wants to do is filter our non alpha numeric characters. I don&#39;t understand why you insist on passing it character by character?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424403, "post_id": 43893930, "comment_id": 74823075, "body": "You can pass string multiple times, can&#39;t you? I&#39;ve also updated the code, don&#39;t be silly, please."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424533, "post_id": 43893930, "comment_id": 74823180, "body": "@But he needs the entire string. How difficult is that to understand?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424598, "post_id": 43893930, "comment_id": 74823234, "body": "If while loop is in use I assume linkLst can be called multiple times. So if it is even more times, I don&#39;t see a problem. Again, why are you so silly? @AjayBrahmakshatriya"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424721, "post_id": 43893930, "comment_id": 74823340, "body": "Are you implying that calling <code>linkLst(&quot;abc&quot;)</code> and <code>linkLst(&quot;a&quot;); linkLst(&quot;b&quot;); linkLst(&quot;c&quot;);</code> are the same? Well what if they are not?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424780, "post_id": 43893930, "comment_id": 74823381, "body": "His code creates <b>1</b> node in the linked list with the entire string. Your code creates <b>3</b> nodes with &quot;a&quot; &quot;b&quot; and &quot;c&quot;. How do you not understand that they are not the same?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424783, "post_id": 43893930, "comment_id": 74823389, "body": "But noone said that can&#39;t be the same!"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424819, "post_id": 43893930, "comment_id": 74823422, "body": "I don&#39;t see linkLst and until I don&#39;t see it we can only argue. I&#39;m done just now!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424833, "post_id": 43893930, "comment_id": 74823430, "body": "Exactly! No one said they are same or not. So you should stick to the behavior shown in the question and not invent possibilities."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": -1, "last_activity_date": 1494423598, "last_edit_date": 1494423598, "creation_date": 1494422942, "answer_id": 43893930, "question_id": 43893852, "link": "https://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file/43893930#43893930", "title": "How to ignore non alphabetic characters in c when read file", "body": "<p>Filter out each character with <code>isalpha</code> function.</p>\n\n<pre><code>while (fscanf(fp, \"%s\", c) != EOF) {\n    char* ptr = c;\n    while (*ptr) {\n        if (isalpha(*ptr)) {\n            linkLst(*ptr);\n        }\n        ptr++;\n    }\n}\n</code></pre>\n\n<p>And correct function <code>linkLst</code> to accept character by character instead of character pointer.</p>\n\n<p>If <code>linkLst</code> is mandatory for <code>char *</code> as parameter, you can do it like this:</p>\n\n<pre><code>while (fscanf(fp, \"%s\", c) != EOF) {\n    char* ptr = c;\n    char tmp[2] = {0, 0};\n    while (*ptr) {\n        if (isalpha(*ptr)) {\n            tmp[0] = *ptr; \n            linkLst(tmp);\n        }\n        ptr++;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494423385, "post_id": 43894055, "comment_id": 74822269, "body": "Wow, instant DV! May I ask the reason?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494423577, "post_id": 43894055, "comment_id": 74822442, "body": "if input like <code>name:value</code>,  <code>namevalue</code> is added to the list."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494423646, "post_id": 43894055, "comment_id": 74822492, "body": "@BLUEPIXY I think that is what OP wants. <i>I want to ignore none alphabetic characters like commas, \\ , :, and dots</i>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494423836, "post_id": 43894055, "comment_id": 74822650, "body": "So OP wants <code>ABC DEF GHI</code> to <code>ABCDEFGHI</code>?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494423926, "post_id": 43894055, "comment_id": 74822719, "body": "@BLUEPIXY he is using <code>&quot;%s&quot;</code> to scan strings. SO not spaces. My understanding is he wants to read multiple strings separated by space and call <code>linkLst</code> after filtering special characters from the strings."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494424071, "post_id": 43894055, "comment_id": 74822835, "body": "So why do you need to join in cases other than white-spaces?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494424178, "post_id": 43894055, "comment_id": 74822912, "body": "@BLUEPIXY I am not joining any strings. I am just filtering the non alpha numberic characters. For the input <code>abcd:123 efgh&#47;456 ijkl,789</code> I am adding <code>abcd123</code>, <code>efgh456</code> and <code>ijkl789</code> to the linked list."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494424366, "post_id": 43894055, "comment_id": 74823055, "body": "Yes, I understand it. However, your code yields the results shown above.(<code>name:value</code> to  <code>namevalue</code>)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494424435, "post_id": 43894055, "comment_id": 74823102, "body": "Isn&#39;t that is what is expected? He also wants to filter <code>:</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494424492, "post_id": 43894055, "comment_id": 74823154, "body": "I think it should be treated as a separate word. E.g if input as <code>isalpha(c[index]))</code> to <code>isalpha</code> , <code>c</code> and <code>index</code>, not <code>isalphacindex</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494427859, "post_id": 43894055, "comment_id": 74825908, "body": "<a href=\"http://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file#comment74822912_43894055\">I am adding abcd123</a> certainly does not meet <a href=\"http://stackoverflow.com/q/43893852/2410359\">read file word by word ignoring non alphabetic characters</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1494427913, "post_id": 43894055, "comment_id": 74825952, "body": "Note: <code>if (isalpha(c[index]))</code> is UB when <code>c[index] &lt; 0</code> and not <code>EOF</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494428247, "post_id": 43894055, "comment_id": 74826250, "body": "@chux would <code>isalpha((unsigned char) c[index])</code> be fine?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494428347, "post_id": 43894055, "comment_id": 74826324, "body": "@chux, regarding the other issue, OP is not clearing anything after repeatedly asking. Anyway, I will change the code to add different words on seeing a non alpha numeric character."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494428534, "post_id": 43894055, "comment_id": 74826481, "body": "@BLUEPIXY is this solution okay?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494429184, "post_id": 43894055, "comment_id": 74827004, "body": "At least I like it better than before. (^\u0437^)-\u2606Chu!!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494436791, "post_id": 43894055, "comment_id": 74831754, "body": "@AjayBrahmakshatriya <code>isalpha((unsigned char) c[index])</code> is the typical fix.   This and other issues are minor (no length limit, braces style).  Good improvement."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494436955, "post_id": 43894055, "comment_id": 74831843, "body": "So actually OP&#39;s char array <code>c</code> had a length limit of 50. So I used the same limit. And I didn&#39;t get your point about braces style."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 1, "last_activity_date": 1494428491, "last_edit_date": 1494428491, "creation_date": 1494423253, "answer_id": 43894055, "question_id": 43893852, "link": "https://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file/43894055#43894055", "title": "How to ignore non alphabetic characters in c when read file", "body": "<p>You will have to create a copy of the string you read filtering out the non alphanumeric characters. </p>\n\n<p>After the <code>scanf</code> do this</p>\n\n<pre><code>char str[50];\nint index = 0;\nint index2 = 0;\nwhile(c[index] != '\\0') {\n    if (isalpha((unsigned char)c[index]))\n        str[index2++] = c[index];\n    else{\n        str[index2] = '\\0'; \n        if (index2 != 0)\n            linkLst(str);\n        index2 = 0; \n    }    \n    index++;    \n}\nstr[index2] = '\\0';\nif (index2 != 0)\n    linkLst(str);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424383, "post_id": 43894083, "comment_id": 74823067, "body": "@Badda how can you compare <code>c</code> which is a <code>char[]</code> with the integers 66 and 90?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424456, "post_id": 43894083, "comment_id": 74823122, "body": "@AjayBrahmakshatriya As I said below, use a loop and access to char which are inside <code>char[]</code>with <code>char[i]</code>. I can add an example if you want"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494424483, "post_id": 43894083, "comment_id": 74823144, "body": "@Badda Please: what are those magic numbers <code>66</code> and <code>90</code>? <b>I</b> know what they are, but you can write these differently, I&#39;m sure you know it."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424613, "post_id": 43894083, "comment_id": 74823248, "body": "@Badda then in your loop, shouldn&#39;t you be using <code>c[i]</code> ?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494424650, "post_id": 43894083, "comment_id": 74823274, "body": "@MichaelWalz Well you can write <code>&#39;A&#39;</code> and <code>&#39;Z&#39;</code> directly, but writing this would not explain how ASCII table works."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494424969, "post_id": 43894083, "comment_id": 74823531, "body": "@Badda <code>if (c &lt; 66 &amp;&amp; c &gt; 90)</code> this doesn&#39;t make sense!! replace c with c[i]."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494425144, "post_id": 43894083, "comment_id": 74823686, "body": "@Badda <code>for (int i = 0; i &lt; sizeof(c); i++) &#47;&#47; Then use c[i] to access to char inside it {     if (c &lt; 66 &amp;&amp; c &gt; 90) &#47;&#47; or if (isalpha(c[i])     {         &#47;&#47; do what you wanna do     }     else      {        &#47;&#47; ignore     } }</code> C is a char here? Will you read your own answer <b>once</b>?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494425871, "post_id": 43894083, "comment_id": 74824284, "body": "@AjayBrahmakshatriya Corrected."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494425925, "post_id": 43894083, "comment_id": 74824333, "body": "@Badda now it makes sense. PS: the Downvote is not from me."}], "tags": [], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "is_accepted": false, "score": -1, "last_activity_date": 1494425298, "last_edit_date": 1494425298, "creation_date": 1494423314, "answer_id": 43894083, "question_id": 43893852, "link": "https://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file/43894083#43894083", "title": "How to ignore non alphabetic characters in c when read file", "body": "<p>Include header <code>#include &lt;ctype.h&gt;</code> which includes a function <code>isalpha(char c)</code> which returns <code>true</code> if <code>c</code> is a alphabetic character.</p>\n\n<pre><code>if ( isalpha(c))\n{\n     // do what you wanna do\n}\nelse \n{\n     // ignore\n}\n</code></pre>\n\n<p>Otherwise, you can use the <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII table</a>. Use characters as if they were <code>int</code> and compare them. For example, to check if a <code>char</code> is a alphabetic and capital, you'd do :</p>\n\n<pre><code>if ( c &lt; 66 &amp;&amp; c &gt; 90)\n{\n    // do what you wanna do\n}\nelse \n{\n    // ignore\n}\n</code></pre>\n\n<p>If <code>c</code> is a tab, then loop into it like that : </p>\n\n<pre><code>for (int i = 0; i &lt; sizeof(c); i++) // Then use c[i] to access to char inside it\n{\n    if (c[i] &lt; 66 &amp;&amp; c[i] &gt; 90) // or if (isalpha(c[i])\n    {\n        // do what you wanna do\n    }\n    else \n    {\n       // ignore\n    }\n}\n</code></pre>\n\n<p>You could also write :</p>\n\n<pre><code>if (c[i] &lt; 'A' &amp;&amp; c[i] &gt; 'Z') \n</code></pre>\n\n<p>Because thanks to ASCII table, <code>'A' == 66</code> and <code>'Z' == 90</code></p>\n"}, {"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1494429566, "post_id": 43894947, "comment_id": 74827289, "body": "For example, input does not work as expected if it begins with parentheses(or newline or etc)."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494464221, "post_id": 43894947, "comment_id": 74843430, "body": "yes but it can easily be adapted to take care of it."}], "tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": false, "score": 0, "last_activity_date": 1494513959, "last_edit_date": 1494513959, "creation_date": 1494425376, "answer_id": 43894947, "question_id": 43893852, "link": "https://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file/43894947#43894947", "title": "How to ignore non alphabetic characters in c when read file", "body": "<p>I am going to stick to reading the content \"word by word\" rather than worrying about the linked list.</p>\n\n<p><code>scanf</code> family of functions gives you the ability to do trivial parsing, there's no need to do it character by character as enough functionality is available in scanf.  If you want to parse the strings char by char then  simply use <code>fgets</code> and perform the parsing you need.</p>\n\n<p>I'll stick with scanf as that's what you're using:</p>\n\n<p>Starting with a simple file (<em>foo.txt</em>) containing:</p>\n\n<blockquote>\n  <p>hello there, how are you?</p>\n</blockquote>\n\n<p>and trying to scanf it: </p>\n\n<h2>bad example 1:</h2>\n\n<pre><code>/* NOTE: this code does NOT do what you want */\n#include &lt;stdio.h&gt;\n\nint main() {\n    char foo[128];\n    FILE *fp;\n    fp = fopen(\"foo.txt\", \"r\");\n    do {\n        sscanf(input, \"%[A-Za-z0-9]\", foo);\n        fprintf(stderr, \"foo: %s\\n\", foo);\n    } while(1);\n    return 0;\n}\n</code></pre>\n\n<p>You get an infinite loop printing <code>hello</code> because scanf is stuck and cannot mung the space after \"hello\". </p>\n\n<p>So let's add a munger:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char foo[128];\n    char mung[128];\n    char rv = 0;\n    FILE *fp;\n    fp = fopen(\"foo.txt\", \"r\");\n    do {\n        rv = fscanf(fp, \"%[A-Za-z0-9]%[^A-Za-z0-9]\", foo, mung);\n        if(rv == EOF)\n            break;\n        fprintf(stderr, \"foo: %s\\n\", foo);\n    }while(1);\n}\n</code></pre>\n\n<p>So munger munges everything that's not in the foo character set that we're looking for (putting a <code>^</code> inside the [] as the first character makes scanf negate the content).</p>\n\n<p>This will print out:</p>\n\n<pre><code> foo: hello\n foo: there\n foo: how\n foo: are\n foo: you\n</code></pre>\n\n<p>Now if we are being clever we can skip the assignment of the mung variable:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char foo[128];\n    char rv = 0;\n    FILE *fp;\n    fp = fopen(\"foo.txt\", \"r\");\n    do {\n        rv = fscanf(fp, \"%[A-Za-z0-9]%*[^A-Za-z0-9]\", foo);\n        if(rv == EOF)\n            break;\n        fprintf(stderr, \"foo: %s\\n\", foo);\n    }while(1);\n}\n</code></pre>\n\n<p>Obviously in my examples I've assumed that foo is less than 128 bytes. However we don't know that, well scanf (after 2001 POSIX standard) allows you go to dynamically allocate memory for character strings which you have to <code>free</code> later on, so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char *foo;\n    char rv = 0;\n    FILE *fp;\n    fp = fopen(\"foo.txt\", \"r\");\n    do {\n        /* notice the &amp; before foo, because fscanf will modify the pointer\n         * variable itself and assign it a new pointer after allocating \n         * the space for the string\n         */\n        rv = fscanf(fp, \"%m[A-Za-z0-9]%*[^A-Za-z0-9]\", &amp;foo);\n\n        if(rv == EOF)\n            break;\n\n        fprintf(stderr, \"foo: %s\\n\", foo);\n        /* store the foo pointer somewhere for use and free it later,\n         * if you are sticking it in a linked list, then you should \n         * free it whenever you free the corrosponding node.\n         *\n         * I am just going to free it here after printing it out\n         */\n        free(foo); \n    }while(1);\n}\n</code></pre>\n\n<h1>Update</h1>\n\n<p>As BLUEPIXY points out this would not eat up any characters that begin with non-matching chars. So something like,</p>\n\n<blockquote>\n  <p>)) oops helo </p>\n</blockquote>\n\n<p>will get stuck in a <code>(null)</code> loop</p>\n\n<p>Which means we need to make munging a separate operation so that it eats things up:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char *foo;\n    char rv = 0;\n    FILE *fp;\n    fp = fopen(\"foo.txt\", \"r\");\n    do {\n        /* notice the &amp; before foo, because fscanf will modify the pointer\n         * variable itself and assign it a new pointer after allocating \n         * the space for the string\n         */\n        rv = fscanf(fp, \"%m[A-Za-z0-9]\", &amp;foo);\n\n        if(rv == EOF)\n            break;\n\n        /* foo would be null if scanf didn't read anything */\n        if (foo) {\n             fprintf(stderr, \"foo: %s\\n\", foo);\n        /* store the foo pointer somewhere for use and free it later,\n         * if you are sticking it in a linked list, then you should \n         * free it whenever you free the corrosponding node.\n         *\n         * I am just going to free it here after printing it out\n         */\n             free(foo); \n        }\n\n\n        rv = fscanf(fp, %*[^A-Za-z0-9]\");\n\n        if (rv == EOF) \n             break;\n\n    }while(1);\n}\n</code></pre>\n\n<p>(see scanf(3)) page for details</p>\n"}], "owner": {"reputation": 73, "user_id": 7288288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/728035f4c65455aa9cd2dd97cdc9efc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jayamal Jayamaha  ", "link": "https://stackoverflow.com/users/7288288/jayamal-jayamaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2052, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1494513959, "creation_date": 1494422745, "last_edit_date": 1494424760, "question_id": 43893852, "link": "https://stackoverflow.com/questions/43893852/how-to-ignore-non-alphabetic-characters-in-c-when-read-file", "title": "How to ignore non alphabetic characters in c when read file", "body": "<p>I am reading a file using <code>fscanf</code>. I want to ignore non alphabetic characters like commas, \\ , :, and dots.</p>\n\n<p>This is my code:</p>\n\n<pre><code>FILE *fp;\nfp = fopen(fl,\"r\");\nchar c[50];\n\nwhile(fscanf(fp, \"%s\" ,c)!= EOF){\n    linkLst(c);\n\n}\n\nfclose(fp);\n</code></pre>\n\n<p>how do I read file word by word ignoring non alphabetic characters?</p>\n\n<p>{\npart of the file as follows</p>\n\n<p>WITH ANSWERS:</p>\n\n<p>1) What written language is the most complicated in the world? (Hint: It\nuses four character sets.) (Is this question too easy?)  >> Japanese</p>\n\n<p>2) What language has a vocabulary primarily of Arabic origin (about 70%,\nI'm told), but uses the Roman alphabet? (I'd like to know where you found\nthe answer!)  >> Maltese</p>\n\n<p>3) What non-Romance language uses a tilde (~) over the letter N? >> Estonian\n}</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 3, "creation_date": 1494421829, "post_id": 43893471, "comment_id": 74821018, "body": "<code>pointer = &amp;ar[0];</code> or <code>pointer = ar;</code> and warning will disappear. But this does not mean program will work."}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494421959, "post_id": 43893471, "comment_id": 74821139, "body": "still the 2nd warning (warning: &#39;ar&#39; is used uninitialized in this function [-Wuninitialized]) at the same code line"}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1494422031, "post_id": 43893471, "comment_id": 74821203, "body": "So initialize it."}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 0, "creation_date": 1494422178, "post_id": 43893471, "comment_id": 74821322, "body": "I know how to initialize a pointer to point to a variable(int *p, a; p = &amp;a) but I`m stuck here."}], "answers": [{"tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": true, "score": 2, "last_activity_date": 1494422332, "last_edit_date": 1494422332, "creation_date": 1494422025, "answer_id": 43893577, "question_id": 43893471, "link": "https://stackoverflow.com/questions/43893471/how-to-make-a-function-to-read-an-array-in-c/43893577#43893577", "title": "How to make a function to read an array in c?", "body": "<p>I would consider with 2 options. One returns pointer to array and saves length as pointer and another returns length but accepts pointer to pointer as parameter.</p>\n\n<h2>Option 1: Return pointer of array and pass pointer to length parameter</h2>\n\n<p>This option will return pointer to allocated and filled array and length will be saved to pointer passed as parameter</p>\n\n<pre><code>int* readArray(int* length) {\n    int* arr;\n    //Scan for length\n    scanf(\"%d\", length);\n    //Allocate memory\n    arr = (int *)malloc(...);\n    //Fill data\n    ...\n    return arr;\n}\n</code></pre>\n\n<p>and I will use it like this:</p>\n\n<pre><code>int length;\nint *pointer;\n\npointer = readArray(&amp;length);\nprintArray(pointer, length);\n</code></pre>\n\n<hr>\n\n<h2>Option 2: Pass pointer to pointer to array and return length of array</h2>\n\n<pre><code>int readArray(int ** ar) {\n    int length;\n    ....\n    *ar = (int *)malloc(...);\n    ...\n    return length;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>int* ar;\nint length;\n\nlength = readArray(&amp;ar);\nprintArray(ar, length);\n</code></pre>\n\n<p>I would go with this option.</p>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 0, "creation_date": 1494423907, "post_id": 43893606, "comment_id": 74822705, "body": "This <code>&amp;(*ar)[i]</code> confused me. I do not understand this."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 1, "creation_date": 1494424368, "post_id": 43893606, "comment_id": 74823056, "body": "@Timotei  <code>ar</code> is a pointer to a pointer to <code>int</code>. <code>*ar</code> is a pointer to <code>int</code>, actually here it is the pointer to the <code>length</code> <code>int</code>s allocated by <code>malloc</code>. <code>(*ar)[n]</code> is the nth <code>int</code> of the <code>int</code>s mentioned before. <code>&amp;(*ar)[n]</code> is the <i>pointer</i> to the nth <code>int</code>."}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 0, "creation_date": 1494446470, "post_id": 43893606, "comment_id": 74837351, "body": "How would you write a function to read the array in the exactly the same way you did in the above comment and to print the array(in the same function)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 0, "creation_date": 1494485354, "post_id": 43893606, "comment_id": 74849928, "body": "@Timotei not quite sure I understood your question. Maybe you should post another question."}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "edited": false, "score": 0, "creation_date": 1494491768, "post_id": 43893606, "comment_id": 74854004, "body": "I mean how would the function void printArray(int **pointer, int length) look? Note de the **pointer not *pointer."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1494422088, "creation_date": 1494422088, "answer_id": 43893606, "question_id": 43893471, "link": "https://stackoverflow.com/questions/43893471/how-to-make-a-function-to-read-an-array-in-c/43893606#43893606", "title": "How to make a function to read an array in c?", "body": "<p>You actually want this:</p>\n\n<pre><code>int readArray(int **ar) {\n  int i, length;\n  scanf(\"%d\", &amp;length);\n  *ar = (int *)malloc(length * sizeof(int));\n  for (i = 0; i &lt; length; i++) {\n    scanf(\"%d\", &amp;(*ar)[i]);\n  }\n  return length;\n}\n\nvoid printArray(int *pointer, int length) {\n  int i;\n  for (i = 0; i &lt; length; i++) {\n    printf(\"%d \", *(pointer + i));\n  }\n}\n\nint main() {\n  int *ar, length;\n  length = readArray(&amp;ar);\n  printArray(ar, length);\n  return 0;\n}\n</code></pre>\n\n<p>Variables are passed by value in C, included pointers. With your solution:</p>\n\n<pre><code>int readArray(int *ar, int *pointer){\n    int i, length;\n    scanf(\"%d\", &amp;length);\n    ar = (int *) malloc(length * sizeof(int));\n    for(i = 0; i &lt; length; i++){\n        scanf(\"%d\", pointer + i);\n    }\n    return length;\n}\n</code></pre>\n\n<p><code>ar</code> is a local variable to <code>readArray</code> and <code>pointer</code> will never get modified in <code>main</code>.</p>\n\n<p>Consider this:</p>\n\n<pre><code>void foo(int bar)\n{\n  bar = 123;\n}\n\n...\nint a = 1;\nfoo(a);\n// a won't contain 123 here\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4578, "favorite_count": 0, "closed_date": 1494426774, "accepted_answer_id": 43893577, "answer_count": 2, "score": -1, "last_activity_date": 1496317931, "creation_date": 1494421734, "last_edit_date": 1496317931, "question_id": 43893471, "link": "https://stackoverflow.com/questions/43893471/how-to-make-a-function-to-read-an-array-in-c", "closed_reason": "Duplicate", "title": "How to make a function to read an array in c?", "body": "<p>I have to write function to read the array length and the array and make that array able to be used in other functions.</p>\n\n<p>I have read many things about pointers but I didn`t find an answer to my question.\nHere is my code.</p>\n\n<pre><code>int readArray(int *ar, int *pointer){\n    int i, length;\n    scanf(\"%d\", &amp;length);\n    ar = (int *) malloc(length * sizeof(int));\n    for(i = 0; i &lt; length; i++){\n        scanf(\"%d\", pointer + i);\n    }\n    return length;\n}\n\nvoid printArray(int *pointer, int length){\n    int i;\n    for(i = 0; i &lt; length; i++){\n        printf(\"%d \", *(pointer + i));\n    }\n}\n\nint main(){\n    int *pointer, *ar, length;\n    pointer = ar[0];//Here I get the warnings.\n    length = readArray(ar, pointer);\n    printArray(pointer, length);\n    return 0;\n}\n</code></pre>\n\n<p>The warnings in codeblocks:\n<code>warning: assignment makes pointer from integer without a cast</code>\nand\n<code>warning: 'ar' is used uninitialized in this function [-Wuninitialized]|</code>.</p>\n\n<p>This question is different from this <a href=\"https://stackoverflow.com/questions/39486797/dynamic-memory-access-only-works-inside-function\">Dynamic memory access only works inside function</a> because i have to read the array length in the readArray function. And for me, as a begginer, only little difference is a big difference.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1494421346, "post_id": 43893077, "comment_id": 74820609, "body": "Note <code>sizeof recieve</code> is probably 8 (recieve is a pointer. Same for <code>sizeof send</code> (which is a badvariable name, IMHO)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1494421569, "post_id": 43893077, "comment_id": 74820782, "body": "<code>read</code> won&#39;t null-terminate the string read in too, so you need to do that. and also the size given should be 1 less than allocated to accommodate that NUL character"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1494421601, "post_id": 43893077, "comment_id": 74820818, "body": "Only the characters of the string go over the pipe, not the string as an object in its own right.  In this sense, there is no difference between sending an array and sending a dynamically allocated buffer."}], "answers": [{"tags": [], "owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "is_accepted": false, "score": 3, "last_activity_date": 1494421721, "last_edit_date": 1494421721, "creation_date": 1494421018, "answer_id": 43893187, "question_id": 43893077, "link": "https://stackoverflow.com/questions/43893077/c-sending-allocated-strings-through-named-pipe-linux/43893187#43893187", "title": "C sending allocated strings through named pipe - linux", "body": "<p>There are multiple mistakes in your code.</p>\n\n<ol>\n<li><p>You have to keep in mind that both <a href=\"https://linux.die.net/man/2/read\" rel=\"nofollow noreferrer\">read</a> and <a href=\"https://linux.die.net/man/2/write\" rel=\"nofollow noreferrer\">write</a> don't guarantee they will effectively read or write the amount of bytes you told them to.</p>\n\n<p>From the Linux write man page:</p>\n\n<blockquote>\n  <p><strong>Synopsis</strong></p>\n  \n  <p>#include &lt;unistd.h&gt;</p>\n  \n  <p>ssize_t write(int fd, const void *buf, size_t count);</p>\n  \n  <p><strong>Description</strong></p>\n  \n  <p>write() writes up to count bytes from the buffer pointed buf to the\n  file referred to by the file descriptor fd. <strong><em>The number of bytes\n  written may be less than count if</em></strong>, for example, there is insufficient\n  space on the underlying physical medium, or the RLIMIT_FSIZE resource\n  limit is encountered (see setrlimit(2)), or the call was interrupted\n  by a signal handler after having written less than count bytes. (See\n  also pipe(7).)</p>\n</blockquote>\n\n<p>They return how many bytes they have read or written, so you must store their return value in a variable and handle that accordingly. You'd generally wrap them in a loop, keep a counter that accumulates how many bytes were read/written, and exit the loop when it reaches the original buffer size, or when an error value is returned.</p></li>\n<li><p>As mentioned by @wildplasser in comments, you are misusing the <code>sizeof</code> operator. When you do <code>char *foo; sizeof foo;</code>, the resulting size is not the size of the string pointed by <code>foo</code>, but the size of the char pointer type (8 bytes in 64 bits architecture, 4 bytes in 32 bits). You should use <code>strlen(foo)</code> instead.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1494775670, "last_edit_date": 1494775670, "creation_date": 1494421360, "answer_id": 43893326, "question_id": 43893077, "link": "https://stackoverflow.com/questions/43893077/c-sending-allocated-strings-through-named-pipe-linux/43893326#43893326", "title": "C sending allocated strings through named pipe - linux", "body": "<p>@jweyrich has already answered the main point of your question.  However there are some other points that you might consider...  </p>\n\n<p>String assignments in C are sometimes a confusion point when getting started with the language as there are occasions when assignments such as:</p>\n\n<pre><code>send = \"This text was sent by parent!\";\n</code></pre>\n\n<p>will work, and others when it will not.  It works in this case because the variable <code>send</code> in your code was created as a pointer.  Keep in mind if it had been created as an array, the only time an assignment could have been made using an <code>=</code> operator would have been during initialization.  Post initialization assignments to the <code>char array</code> form of a C string must be made differently.  Commonly the string functions (<code>strcpy</code>, <code>strcat</code>, <code>sprintf</code>, etc) are used to modify, or make assignments to strings;  Examples:</p>\n\n<pre><code>//string literal used to initialize\nchar send[100] = \"This text was sent by parent!\"; //works\n\n//initialized with nul terminator\nchar send[100] = '\\0';\n//post initialization statements:\nstrcpy(send, \"This text was sent by parent!\");//works\nstrcat(send, \"This text was sent by parent!\");//works\nsprintf(send, \"%s\", \"This text was sent by parent!\");//works\n</code></pre>\n\n<p>but:</p>\n\n<pre><code>send = \"This text was sent by parent!\"; //does not work;\n</code></pre>\n\n<p><em><a href=\"https://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\">More on strings here</a></em>   </p>\n\n<p>Also, it is recommended that you always check the return of <code>malloc()</code> to make sure memory was indeed allocated:</p>\n\n<pre><code>send = malloc(100);\nif(!send) return -1; //check return of malloc\nsend = \"This text was sent by parent!\";\n</code></pre>\n\n<p>One other point: because <code>recieve</code> is a pointer, it's size will be the number of bytes required to contain its address, probably 4 bytes for a 32 bit target, or 8 bytes for a 64bit target.  So the statement:</p>\n\n<pre><code>read(fd, recieve, sizeof(recieve));\n</code></pre>\n\n<p>is very likely telling read to read 4 or 8 bytes, which is not likely what you expected.  Change this line to:</p>\n\n<pre><code>read(fd, recieve, 100);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5269324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c3a8071d415ce44bd3a3bf17bf23bf?s=128&d=identicon&r=PG&f=1", "display_name": "dudefromouterspace", "link": "https://stackoverflow.com/users/5269324/dudefromouterspace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494775670, "creation_date": 1494420741, "question_id": 43893077, "link": "https://stackoverflow.com/questions/43893077/c-sending-allocated-strings-through-named-pipe-linux", "title": "C sending allocated strings through named pipe - linux", "body": "<p>I want to send allocated strings through named pipes, not simple char arrays.</p>\n\n<p>I got the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main()\n{\n    int pid, fd;\n    fd = mkfifo(\"fifo.ftc\", S_IRUSR | S_IWUSR);\n    pid = fork();\n\n    char* send, * recieve;\n\n    if(pid == 0) {\n        recieve = malloc(100);\n        fd = open(\"fifo.ftc\", O_RDONLY);\n        read(fd, recieve, sizeof(recieve));\n        close(fd);\n        printf(\"%s\\n\", recieve);\n\n        send = malloc(100);\n        send = \"This text was sent by child!\";\n        fd = open(\"fifo.ftc\", O_WRONLY);\n        write(fd, send, sizeof(send));\n        close(fd);\n\n        free(recieve);\n        free(send);\n\n    } else if(pid &gt; 0) {\n        send = malloc(100);\n        send = \"This text was sent by parent!\";\n        fd = open(\"fifo.ftc\", O_WRONLY);\n        write(fd, send, sizeof(send));\n        close(fd);\n\n        recieve = malloc(100);\n        fd = open(\"fifo.ftc\", O_RDONLY);\n        read(fd, recieve, sizeof(recieve));\n        close(fd);\n        printf(\"%s\\n\", recieve);\n\n        unlink(\"fifo.ftc\");\n\n        free(send);\n        free(recieve);\n    }\n}\n</code></pre>\n\n<p>As an output, I always recieve:</p>\n\n<pre><code>This tex\nThis tex\n</code></pre>\n\n<p>It looks like it doesn't print the whole strings out. How to recieve the whole messages from the parent and the child?</p>\n"}, {"tags": ["c", "segmentation-fault", "json-c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1494421394, "post_id": 43892931, "comment_id": 74820649, "body": "Your debugging approach is kinda crude.  Make sure you build the program with debugging symbols included, and run it in a debugger, such as gdb.  That will allow you to catch the segfault, to find <i>exactly</i> where it occurs, and to examine the values of the variables involved to determine the proximal cause."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 4, "last_activity_date": 1494421283, "creation_date": 1494421283, "answer_id": 43893299, "question_id": 43892931, "link": "https://stackoverflow.com/questions/43892931/segmentation-fault-parsing-json-c/43893299#43893299", "title": "Segmentation fault parsing json-c", "body": "<p>The reason for your parseText failing on the field <code>\"val\"</code> is - </p>\n\n<pre><code>val = (char *)json_object_get_string(o);\n</code></pre>\n\n<p>This changes the local variable <code>val</code>. Which doesn't affect the tmp from the caller.</p>\n\n<p>What you need is </p>\n\n<pre><code>*(char**) val = (char*) json_object_get_string(o);\n</code></pre>\n\n<p>This will change <code>tmp</code> to the point to the string returned by <code>json_object_get_string</code>.</p>\n\n<p>In your case <code>tmp</code> is <code>NULL</code> and you are trying to copy from <code>NULL</code> after that which is Undefined Behavior and also is causing the SEG FAULT.</p>\n"}], "owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 43893299, "answer_count": 1, "score": 0, "last_activity_date": 1494421283, "creation_date": 1494420354, "last_edit_date": 1494420790, "question_id": 43892931, "link": "https://stackoverflow.com/questions/43892931/segmentation-fault-parsing-json-c", "title": "Segmentation fault parsing json-c", "body": "<p>I am getting a seg fault when I try and get the result of val  from my json file the other fetch values return fine if I comment out the lines</p>\n\n<pre><code>/*parseText(obj, \"val\", &amp;tmp);\nstrcpy (test.val, tmp);\nprintf(\"val = %s\\n\", test.val); */\n</code></pre>\n\n<p>This is the only one that is not an integer which I presume I am handling incorrectly.</p>\n\n<p>Here is my code and the json file is below.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"string.h\"\n#include \"json-c/json.h\"\n\ntypedef struct __attribute__ ((packed))\n{\n    char val[4];\n    uint32_t fetch_1;\n    uint32_t fetch_2;\n    uint32_t fetch_3;\n    uint32_t fetch_4;\n    uint32_t fetch_5;\n}\nTEST;\n\nstatic int parseText(struct json_object *new_obj, const char *field,\n                        void *val)\n{\n    struct json_object *o = NULL;\n    json_type type;\n    int ret = 0;\n\n    if (!json_object_object_get_ex(new_obj, field, &amp;o))\n        printf(\"Field %s does not exist\\n\", field);\n\n    type = json_object_get_type(o);\n\n    switch (type) {\n    case json_type_null:\n        printf(\"Return type is NULL\\n\");\n        ret = -1;\n        break;\n    case json_type_boolean:\n        *((int *)(val)) = json_object_get_boolean(o);\n        break;\n    case json_type_double:\n        *((double *)(val)) = json_object_get_double(o);\n        break;\n    case json_type_int:\n        *((int *)(val)) = json_object_get_int(o);\n        break;\n    case json_type_string:\n        val = (char *)json_object_get_string(o);\n        break;\n    case json_type_object:\n    case json_type_array:\n        ret = -1;;\n        break;\n    }\n    return ret;\n\n}\nstatic inline int parsing(struct json_object *obj) {\n    char* tmp = NULL;\n    TEST test;\n    memset(&amp;test, 0, sizeof(test));\n\n    parseText(obj, \"val\", &amp;tmp);\n    strcpy (test.val, tmp);\n    printf(\"val = %s\\n\", test.val);\n    parseText(obj, \"fetch 1\", &amp;test.fetch_1);\n    printf(\"fetch_1= %d\\n\", test.fetch_1);\n    parseText(obj, \"fetch 2\", &amp;test.fetch_2);\n    printf(\"fetch_2= %d\\n\", test.fetch_2);\n    parseText(obj, \"fetch 3\", &amp;test.fetch_3);\n    printf(\"fetch_3= %d\\n\", test.fetch_3);\n    parseText(obj, \"fetch 4\", &amp;test.fetch_4);\n    printf(\"fetch_4= %d\\n\", test.fetch_4);\n    parseText(obj, \"fetch 5\", &amp;test.fetch_5);\n    printf(\"fetch_5= %d\\n\", test.fetch_5);\n\n    return 0;\n}\n\nchar* file_read (const char* filename) {\n  FILE* fp;\n  char* buffer;\n  long  fsize;\n\n  /* Open the file */\n  fp = fopen (filename, \"r\");\n\n  if (fp == NULL)\n    {\n      return NULL;\n    }\n\n  /* Get the size of the file */\n  fseek (fp, 0, SEEK_END);\n  fsize = ftell (fp) + 1;\n  fseek (fp, 0, SEEK_SET);\n\n  /* Allocate the buffer */\n  buffer = calloc (fsize, sizeof (char));\n\n  if (buffer == NULL)\n    {\n      fclose (fp);\n      return NULL;\n    }\n\n  /* Read the file */\n  fread (buffer, sizeof (char), fsize, fp);\n\n  /* Close the file */\n  fclose (fp);\n\n  /* Return the buffer */\n  return buffer;\n}\n\nint main (int argc, char *argv[])\n{\n    struct json_object *jsonObj;\n    int i = 0;\n\n    char* file = file_read(argv[1]);\n\n    jsonObj = json_tokener_parse(file);\n\n    for(i = 0; i &lt; json_object_array_length(jsonObj); i++) {\n        json_object *obj = json_object_array_get_idx(jsonObj, i);\n        parsing(obj);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is the json file:</p>\n\n<pre><code>[{\n    \"val\": \"fpr\",\n    \"fetch 1\": 100,\n    \"fetch 2\": 200,\n    \"fetch 3\": 300,\n    \"fetch 4\": 400,\n    \"fetch 5\": 500\n}, {\n    \"val\": \"mpr\",\n    \"fetch 1\": 445,\n    \"fetch 2\": 223,\n    \"fetch 3\": 1089,\n    \"fetch 4\": 432,\n    \"fetch 5\": 34400\n}]\n</code></pre>\n"}, {"tags": ["c", "undefined-behavior"], "comments": [{"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "edited": false, "score": 0, "creation_date": 1494419742, "post_id": 43892524, "comment_id": 74819266, "body": "UB is not &quot;something bad happens&quot;. UB is &quot;compiler is allowed to do anything it wants&quot;. Using uninitialized value is a permission to compiler to do anything - including returning 0."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1494419831, "post_id": 43892524, "comment_id": 74819329, "body": "You&#39;ll probably hit UB <i>before</i> multiplication."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1494419850, "post_id": 43892524, "comment_id": 74819343, "body": "@SouravGhosh this should be a better duplicate <a href=\"http://stackoverflow.com/q/25074180/995714\">Is a^a or a-a undefined behaviour if a is not initialized?</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1494419916, "post_id": 43892524, "comment_id": 74819384, "body": "@L\u01b0uV\u0129nhPh&#250;c Sure, just added that. :)"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1494419934, "post_id": 43892524, "comment_id": 74819410, "body": "...and someone would do this because......?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1494425755, "post_id": 43892524, "comment_id": 74824187, "body": "Better duplicate still: <a href=\"http://stackoverflow.com/questions/11962457/why-is-using-an-uninitialized-variable-undefined-behavior-in-c\">(Why) is using an uninitialized variable undefined behavior in C?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494419571, "post_id": 43892596, "comment_id": 74819116, "body": "I do not think that it is UB. - simply <code>x</code> can be given any junk value and <code>0*x</code> will be 0."}, {"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1494419578, "post_id": 43892596, "comment_id": 74819125, "body": "Why downvotes for this answer ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494419644, "post_id": 43892596, "comment_id": 74819178, "body": "@EdHeal: some implementations may reserve some bits of <code>int</code> for trap values."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494420015, "post_id": 43892596, "comment_id": 74819469, "body": "@EdHeal, not just trap representations, some compilers might also run into bad optimizations because of the UB."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494420230, "post_id": 43892596, "comment_id": 74819626, "body": "What are the trap representations for an <code>int</code>?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1494420983, "post_id": 43892596, "comment_id": 74820293, "body": "Usual hardware (Intel, AMD, ...) does not have the concept of trap representation. But imagine a 9-bit computer where it finds a value with all 9 bits set to 1 causes it to reboot."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494421038, "post_id": 43892596, "comment_id": 74820342, "body": "...although traps representations for integer values are highly unlikely today."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494425392, "post_id": 43892596, "comment_id": 74823891, "body": "If <code>int</code> does not have a trap value, will the behaviour be undefined?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1494425891, "post_id": 43892596, "comment_id": 74824307, "body": "It is not UB because of trap representations, but because the variable has automatic storage and never has its address taken. <a href=\"http://stackoverflow.com/a/40674888/584518\">See this</a>. Trap representations are mostly irrelevant in real-world computers. If this variable had its address taken and the system did not support trap represenation, it would have been merely unspecified behavior."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494427868, "post_id": 43892596, "comment_id": 74825916, "body": "Would it be unspecified behavour in the latter case?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494455831, "post_id": 43892596, "comment_id": 74841498, "body": "@Lundin: On gcc 5.4.1 for the ARM, using <code>memcpy</code> to copy a partially-written struct containing two <code>uint16_t</code> values may yield a copy with a field containing a value outside the range 0-65535.  Using <code>memcpy</code> on a partially-written structure should be defined behavior, but gcc sometimes optimizes away the <code>memcpy</code>, even though it would render otherwise-undefined behavior, defined."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1494485894, "post_id": 43892596, "comment_id": 74850265, "body": "@supercat What does that have to do with trap representations? The ARM ABI does not have trap representations. It rather sounds like something related to pointer aliasing, which has nothing to do with this topic."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494507259, "post_id": 43892596, "comment_id": 74865109, "body": "@Lundin: You say that a defining factor is that an object&#39;s address is not taken.  Applying <code>memcpy</code> to an object implies taking its address, thus forbidding a compiler from regarding it as an &quot;object of automatic duration whose address has not been taken&quot;.  The only other way that reading object of an unsigned integer type could behave as though it yielded an object outside its range would be if it could hold a trap representation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1494508036, "post_id": 43892596, "comment_id": 74865725, "body": "@supercat memcpy does indeed mean that the address is taken. The UB related to automatic storage duration variables means that they might be allocated in CPU registers unless you take their address. If the address is taken, then that part isn&#39;t relevant and you end up with an indeterminate value, which could either be an unspecified value (in 99.99% of all real-world computers) or a trap representation (in wildly exotic, barely existing computers). Again, the issue you describe seems related to pointer aliasing and not to indeterminate values."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494519237, "post_id": 43892596, "comment_id": 74874648, "body": "@Lundin: My point is that some optimizers will replace code that takes an object&#39;s address with code that doesn&#39;t, and then treat the object as though the address isn&#39;t taken."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1494520955, "post_id": 43892596, "comment_id": 74875673, "body": "Am I right that UB is invoked exactly in this piece of code: <code>0*x</code> ? And not somewhere inside <code>printf</code> when the value is about to be printed ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1494570867, "post_id": 43892596, "comment_id": 74894255, "body": "@supercat The standard is clear, so if a compiler does something else, then it is not conforming."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1494570923, "post_id": 43892596, "comment_id": 74894279, "body": "@ks1322 Yes you invoke UB as soon as <code>x</code> is accessed. It is a local variable and its address had not been taken, so it is UB as per 6.3.2.1."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 3, "last_activity_date": 1494419804, "last_edit_date": 1494419804, "creation_date": 1494419482, "answer_id": 43892596, "question_id": 43892524, "link": "https://stackoverflow.com/questions/43892524/is-it-ub-to-use-zero-multiplied-uninitialized-variable/43892596#43892596", "title": "Is it UB to use zero multiplied uninitialized variable?", "body": "<p>Yes, it's UB.</p>\n\n<p>A conforming compiler may not do any optimization and run into a trap representation in <code>x</code>.<br>\nSome implementations may reserve some bits for special values, including trap representations.</p>\n"}, {"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1494420283, "post_id": 43892717, "comment_id": 74819683, "body": "What are the trap representations for an int?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1494426011, "post_id": 43892717, "comment_id": 74824400, "body": "No this is not (necessarily) why this is UB. <a href=\"http://stackoverflow.com/questions/11962457/why-is-using-an-uninitialized-variable-undefined-behavior-in-c/40674888#40674888\">See this</a>. In real-world computers there exist no trap representations so any discussion about them is irrelevant to the real world."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419777, "creation_date": 1494419777, "answer_id": 43892717, "question_id": 43892524, "link": "https://stackoverflow.com/questions/43892524/is-it-ub-to-use-zero-multiplied-uninitialized-variable/43892717#43892717", "title": "Is it UB to use zero multiplied uninitialized variable?", "body": "<p>This is undefined behavior, as this may cause a trap representation.</p>\n\n<p>From the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<p>Uniitialized variables, section 6.7.9:</p>\n\n<blockquote>\n  <p><em>10</em> If an object that has automatic storage duration is not initialized explicitly, its value is <strong>indeterminate</strong>.</p>\n</blockquote>\n\n<p>The definition of indeterminate, Section 3.19.2:</p>\n\n<blockquote>\n  <p><strong>indeterminate value</strong></p>\n  \n  <p>either an unspecified value or a <strong>trap representation</strong></p>\n</blockquote>\n\n<p>The definition of trap representation, Section 3.19.4:</p>\n\n<blockquote>\n  <p><strong>trap representation</strong></p>\n  \n  <p>an object representation that need not represent a value of the object\n  type</p>\n</blockquote>\n"}], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "closed_date": 1494419790, "accepted_answer_id": 43892596, "answer_count": 2, "score": 0, "last_activity_date": 1494425770, "creation_date": 1494419268, "question_id": 43892524, "link": "https://stackoverflow.com/questions/43892524/is-it-ub-to-use-zero-multiplied-uninitialized-variable", "closed_reason": "Duplicate", "title": "Is it UB to use zero multiplied uninitialized variable?", "body": "<p>Is there UB in the following code?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int x;\n    printf(\"%d\", 0*x);\n    return 0;\n}\n</code></pre>\n\n<p>Here, the variable <code>x</code> was not initialized, but was multiplied by <code>0</code> and the result was passed to <code>printf</code>. Mathematically, the result passed to <code>printf</code> should be <code>0</code>, but I guess that in c language this invokes UB. If the variable was not multiplied by <code>0</code> it is clearly UB but I am not sure is it UB in this particular case.</p>\n\n<p><a href=\"https://ideone.com/aUT5WV\" rel=\"nofollow noreferrer\">Ideone link</a></p>\n"}, {"tags": ["c", "arrays", "loops", "scanf"], "comments": [{"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 0, "creation_date": 1494419376, "post_id": 43892518, "comment_id": 74818952, "body": "change <code>scanf(&quot;%s&quot;,&amp;ip[i]);</code> to <code>scanf(&quot;%d&quot;,&amp;ip[i]);</code> . ip is int array and ip[i] is of type int. &quot;%s&quot; is for reading string/character arrays while %d is for int"}, {"owner": {"reputation": 21, "user_id": 4215718, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqgfT-uQYJk/AAAAAAAAAAI/AAAAAAAAADc/CZdQzr6t9Ks/photo.jpg?sz=128", "display_name": "zuczek zuk", "link": "https://stackoverflow.com/users/4215718/zuczek-zuk"}, "reply_to_user": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 0, "creation_date": 1494419653, "post_id": 43892518, "comment_id": 74819188, "body": "I didn.t know there is difference beetwen %s and %d, I thought this arguments just can&#39;t recur... Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419485, "last_edit_date": 1494419485, "creation_date": 1494419398, "answer_id": 43892569, "question_id": 43892518, "link": "https://stackoverflow.com/questions/43892518/easy-program-checking-ip-scanf-segmentation-fault/43892569#43892569", "title": "easy program checking ip - scanf segmentation fault", "body": "<p><code>scanf</code> requires a pointer to the memory where it shall store the result. You are not passing a pointer. You pass an array value.</p>\n\n<p>Besides that you are trying to scan a string (aka %s) into an integer variable. To scan an integer use <code>%d</code></p>\n\n<p>So change</p>\n\n<pre><code>scanf(\"%s\",ip[i]);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>scanf(\"%d\", &amp;ip[i]);\n</code></pre>\n\n<p>Finally, you should always check the value returned by <code>scanf</code> to make sure that you got the correct number of items, i.e.</p>\n\n<pre><code>if (scanf(\"%d\", &amp;ip[i]) != 1)\n{\n   // Illegal input.\n   // Add error handling, e.g. just terminate\n   exit(1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419447, "creation_date": 1494419447, "answer_id": 43892587, "question_id": 43892518, "link": "https://stackoverflow.com/questions/43892518/easy-program-checking-ip-scanf-segmentation-fault/43892587#43892587", "title": "easy program checking ip - scanf segmentation fault", "body": "<p>Change line :</p>\n\n<pre><code>scanf(\"%s\",ip[i]);\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>scanf(\"%d\", &amp;ip[i]);   //%d instead of %s\n</code></pre>\n\n<p>as :</p>\n\n<ul>\n<li>The symbol <code>&amp;</code> is necessary in order to pass a <em>pointer</em> to <code>scanf</code>.</li>\n<li>You want to read <code>int</code>s, so the correct specifier is <code>%d</code>. <code>%s</code> is for strings.</li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 4215718, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqgfT-uQYJk/AAAAAAAAAAI/AAAAAAAAADc/CZdQzr6t9Ks/photo.jpg?sz=128", "display_name": "zuczek zuk", "link": "https://stackoverflow.com/users/4215718/zuczek-zuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494419485, "creation_date": 1494419252, "question_id": 43892518, "link": "https://stackoverflow.com/questions/43892518/easy-program-checking-ip-scanf-segmentation-fault", "title": "easy program checking ip - scanf segmentation fault", "body": "<p>I have assignment to make easy program in c which check class of IP address. My problem is that I don't work in c, and I don't know what's wrong with my program, because I don't have any IDE and everything compiles on my Debian. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int ip[4];\n    int i=0;\n\n    printf(\"Enter IP address: \");\n\n    for(i=0;i&lt;4;i++) {\n        printf(\"%d: \",i);\n        scanf(\"%s\",ip[i]);\n    }\n\n    printf(\"Your IP address: %03d.%03d.%03d.%03d\\n\",ip[0],ip[1],ip[2],ip[3]);\n\n    if(ip[0]&gt;=0 &amp;&amp; ip[0]&lt;=127){\n        printf(\"This is class A IP address\\n\");\n        printf(\"Network address: %03d.0.0.0\",ip[0]);\n    }\n    if(ip[0]&gt;127 &amp;&amp; ip[0]&lt;=191){\n        printf(\"This is class B IP address\\n\");\n        printf(\"Network address: %03d.%03d.0.0\",ip[0],ip[1]);\n    }\n    if(ip[0]&gt;191 &amp;&amp; ip[0]&lt;224){\n        printf(\"This is class C IP address\\n\");\n        printf(\"Network address: %03d.%03d.%03d.0\",ip[0],ip[1],ip[2]);\n    }\n\n    return 1;\n    }\n</code></pre>\n\n<p>When I have this code there's segmentation fault and when in line 18 I made </p>\n\n<pre><code>scanf(\"%s\",&amp;ip[i]); \n</code></pre>\n\n<p>I don't have any error, but my numbers are random.</p>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494419375, "post_id": 43892339, "comment_id": 74818951, "body": "<code>scanf(&quot;Array element: %c \\n&quot;, ...)</code> looks very iffy to me."}, {"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494419541, "post_id": 43892339, "comment_id": 74819086, "body": "@InternetAussie can you suggest better way to do it, it doesen&#39;t work anyway this way I wrote it?"}], "answers": [{"tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 3, "last_activity_date": 1494419007, "last_edit_date": 1495541409, "creation_date": 1494418866, "answer_id": 43892373, "question_id": 43892339, "link": "https://stackoverflow.com/questions/43892339/c-allocating-memory-for-char-type-array/43892373#43892373", "title": "C - Allocating memory for char type array", "body": "<p>Change line :</p>\n\n<pre><code>printf(\"%d. array element is: %c\\n\", i + 1, arrA + i);\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>printf(\"%d. array element is: %c\\n\", i + 1, *(arrA + i));\n</code></pre>\n\n<p>or :</p>\n\n<pre><code>printf(\"%d. array element is: %c\\n\", i + 1, arrA[i]);\n</code></pre>\n\n<p>as right now you are trying to print the pointer itself and not its content.</p>\n\n<p>Also read <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">this link</a> on why not to cast the result of <code>malloc</code> and <a href=\"https://stackoverflow.com/questions/26831981/should-i-check-if-malloc-was-successful\">this one</a> on checking <code>malloc</code>'s result.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1494419294, "post_id": 43892381, "comment_id": 74818872, "body": "Changed it as you said, but still I get random character print after entering number of elements, can&#39;t get to the phase where I input elements into array... And also I get error that arrA cannot be used without being initialized..."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1494418884, "last_edit_date": 1495540961, "creation_date": 1494418884, "answer_id": 43892381, "question_id": 43892339, "link": "https://stackoverflow.com/questions/43892339/c-allocating-memory-for-char-type-array/43892381#43892381", "title": "C - Allocating memory for char type array", "body": "<p><code>arrA + i</code> is a <em>pointer</em>. You need to use <code>*(arrA + i)</code> in the <code>printf</code> argument, or the clearer and exactly equivalent <code>arrA[i]</code>.</p>\n\n<p>Notes: <code>sizeof(char)</code> is 1 by the C standard, so is superfluous. Also don't cast <code>malloc</code> on the right hand side. See <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a>. Lastly, always check the result of <code>malloc</code>. If it's <code>NULL</code> then the memory allocation failed.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494420270, "post_id": 43892827, "comment_id": 74819672, "body": "Change <code>scanf(&quot;%c&quot;</code> to <code>scanf(&quot; %c&quot;</code> and the &quot;<code>scanf</code> oddity&quot; should no longer exist. If there is no whitespace, the space gobbles nothing. If there is whitespace, the space gobbles it all. And <code>sizeof(char)</code> is redundant, as it is alway 1."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494420738, "post_id": 43892827, "comment_id": 74820073, "body": "@SvenB just enter the characters en press the [Enter] key only once at the end."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494420875, "post_id": 43892827, "comment_id": 74820189, "body": "@InternetAussie not quite.  With &quot;scanf(&quot; %c&quot;...` and no <code>getc</code>, the first element will actually be <code>10</code> (line feed from previous <code>scanf</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494421067, "post_id": 43892827, "comment_id": 74820365, "body": "That is odd. <code>scanf</code> is supposed to gobble <code>&#39;\\n&#39;</code>s as whitespace."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494421206, "post_id": 43892827, "comment_id": 74820497, "body": "@InternetAussie how does the program behave on your system? I admit, that I never really understood that scanf stuff, I never use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494421962, "post_id": 43892827, "comment_id": 74821141, "body": "If I remove the <code>getc(stdin);</code> and change the <code>&quot;%c&quot;</code> to <code>&quot; %c&quot;</code>, then it just skips the whitespace, including any newlines between the input characters. The C standard specifies that <code>fscanf</code> (and <code>scanf</code> by extension) skips any characters where <code>isspace</code> returns non-zero if a whitespace character is in the format string. <a href=\"http://ideone.com/mVEHUY\" rel=\"nofollow noreferrer\">Ideone.com</a> does this too, so I&#39;m not the crazy one :p"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1494422396, "post_id": 43892827, "comment_id": 74821480, "body": "@InternetAussie so I suppose my C implementation is the crazy one then (possible because it&#39;s Microsoft)."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1494420042, "creation_date": 1494420042, "answer_id": 43892827, "question_id": 43892339, "link": "https://stackoverflow.com/questions/43892339/c-allocating-memory-for-char-type-array/43892827#43892827", "title": "C - Allocating memory for char type array", "body": "<p>Complement to the other answers:</p>\n\n<p>You want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n  int n, i;\n  char *arrA;\n\n  printf(\"Enter number of elements: \");\n  scanf(\"%d\", &amp;n);\n  printf(\"Enter array elements followed by [Enter] key: \\n\");\n\n  getc(stdin);  // absorb \\n (scanf oddity)\n\n  arrA = malloc(n * sizeof(char));\n\n  for (i = 0; i &lt; n; ++i) {\n    scanf(\"%c\", &amp;arrA[i]);\n  }\n\n  for (i = 0; i &lt; n; ++i) {\n    printf(\"%d. array element is: %c\\n\", i + 1, arrA[i]);\n  }\n\n  free(arrA);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 43892827, "answer_count": 3, "score": 0, "last_activity_date": 1494420042, "creation_date": 1494418786, "question_id": 43892339, "link": "https://stackoverflow.com/questions/43892339/c-allocating-memory-for-char-type-array", "title": "C - Allocating memory for char type array", "body": "<p>I have task to create char type array, and then enter number of elements that array should have, and after that allocate memory for that array and print it after entering all the elements into the array. Problem is, I know how to do it if array was int type, but for char I only for print of random charachters. I wrote this code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n\n\n    int n, i;\n    char *arrA;\n\n\n    printf(\"Enter number of elements: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"Enter array elements: \\n\");\n    arrA = (char*)malloc(n * sizeof(char));\n    for (i = 0; i &lt; n; ++i) {\n        scanf(\"Array element: %c \\n\", arrA + i);\n    }\n\n    for (i = 0; i &lt; n; ++i) {\n        printf(\"%d. array element is: %c\\n\", i + 1, arrA + i);\n    }\n\n    free(arrA);\n    return 0;\n}\n</code></pre>\n\n<p>How can I make it work for char type array? </p>\n"}, {"tags": ["c", "function", "file", "stream"], "comments": [{"owner": {"reputation": 1221, "user_id": 6610379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869458e7097eb3f538a64ab550a0aa4b?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Brubaker", "link": "https://stackoverflow.com/users/6610379/phil-brubaker"}, "edited": false, "score": 2, "creation_date": 1494418886, "post_id": 43892294, "comment_id": 74818576, "body": "You should <code>fclose(inFILE)</code> and re-open it with mode &quot;<code>r</code>&quot; before passing it to <code>fcopy</code>."}, {"owner": {"reputation": 160, "user_id": 6594779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c25720c1e7423a97c7894b530bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "svtag", "link": "https://stackoverflow.com/users/6594779/svtag"}, "edited": false, "score": 2, "creation_date": 1494421130, "post_id": 43892294, "comment_id": 74820423, "body": "It is possible to pass file stream as function argument. In the given code there are few things missing, (1) File need to be opened in read+write mode    (<a href=\"https://www.tutorialspoint.com/cprogramming/c_file_io.htm\" rel=\"nofollow noreferrer\">details</a>). (2) Since you write to file, cursor is at the ending of file. This will result in no data from <code>a=fgetc(inFILE1);</code> line. Cursor have to be brought back in order to read data (<a href=\"http://beej.us/guide/bgc/output/html/multipage/fseek.html\" rel=\"nofollow noreferrer\">details</a>)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1494421527, "post_id": 43892294, "comment_id": 74820754, "body": "One more: <code>fgetc</code> returns an <code>int</code>, not a <code>char</code>, so <code>char a;</code> -&gt; <code>int a;</code>"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "edited": false, "score": 2, "creation_date": 1494421568, "post_id": 43892294, "comment_id": 74820780, "body": "Also add fclose(inFILEcopy) after do-while loop into fcopy function"}], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "is_accepted": false, "score": 1, "last_activity_date": 1494421821, "last_edit_date": 1495541903, "creation_date": 1494421821, "answer_id": 43893500, "question_id": 43892294, "link": "https://stackoverflow.com/questions/43892294/c-passing-file-stream-as-a-function-parameter/43893500#43893500", "title": "C passing File stream as a function parameter", "body": "<p>To summarize mine and <a href=\"https://stackoverflow.com/users/6610379/phil-brubaker\">Phil Brubaker</a> comments, modify your code in this way:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid fcopy(FILE *inFILE1) {\n    FILE *inFILEcopy;\n    char a;\n    inFILEcopy = fopen(\"C:/Users/scifani/Desktop/empoleecopy.bak\", \"w\");\n    do{\n        a = fgetc(inFILE1);\n        fputc(a, inFILEcopy);\n        if (feof(inFILE1))break;\n    } while (1);\n    fclose(inFILEcopy);\n}\n\nint main(){\n    FILE *inFILE;\n    inFILE = fopen(\"C:/Users/scifani/Desktop/empolee.dat\", \"w\");\n    fputs(\"My name is Anthony\", inFILE);\n    fclose(inFILE);\n    inFILE = fopen(\"C:/Users/scifani/Desktop/empolee.dat\", \"r\");\n    fcopy(inFILE);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "is_accepted": false, "score": 0, "last_activity_date": 1494422515, "last_edit_date": 1495542387, "creation_date": 1494422515, "answer_id": 43893761, "question_id": 43892294, "link": "https://stackoverflow.com/questions/43892294/c-passing-file-stream-as-a-function-parameter/43893761#43893761", "title": "C passing File stream as a function parameter", "body": "<pre><code>FILE* fcopy(char* yourFile) { // Or parse a FILE like you did but with a pointer\n\n    FILE *inFILEcopy;\n    inFILEcopy = fopen(\"C:/Users/labuser.pcroot PC.003/Desktop/empoleecopy.bak\", \"w\");\n    if (inFILEcopy == NULL)\n        return NULL; // You'll have to check null to see if fcopy() failed\n    FILE* inFILE1 = fopen(yourFile, \"r\");\n    if (inFILE1 == NULL) {\n        puts(\"File to be copied does not exist.\\n\");\n        return NULL;\n    }\n    for (char a = fgetc(inFILE1); feof(inFILE1);)\n    {\n       fputc(a, inFILEcopy);\n       if (ferror(inFILE1) || ferror(inFILEcopy)) { // If error in one of the two files\n           if (fclose(inFILE1))\n               puts(\"Couldn't close inFILE1\\n\");\n           if (fclose(inFILEcopy));\n               puts(\"Couldn't close inFILEcopy\\n\");\n           puts(\"Error during copy.\\n\");\n           return NULL;\n       }\n    }\n    return inFILEcopy;\n}\n\nint main() {\n\n   FILE *inFILE;\n   inFILE= fopen(\"C:/Users/labuser.pcroot-PC.003/Desktop/empolee.dat\",\"w\");\n   if (inFILE != NULL)\n   {\n       fputs(\"My name is Anthony\", inFILE);\n       if (!ferror(inFILE) || fclose(inFILE)) // If no error when writing and closing works, we can copy\n       {\n           inFILE = fcopy(\"C:/Users/labuser.pcroot-PC.003/Desktop/empolee.dat\");\n           if (inFILE != NULL)\n               puts(\"Copy success\\n\");\n       }\n   }\n}\n</code></pre>\n\n<p>I think this is the best way to do this. I am open to any improvement though. Check <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">this link</a> if you have any question regarding the error checkings, someone explains the best way to do so. This should work perfectly.</p>\n"}], "owner": {"reputation": 87, "user_id": 7714503, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85baa6296d02f229da40a98a4c4f696d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagato", "link": "https://stackoverflow.com/users/7714503/nagato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1806, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494422515, "creation_date": 1494418677, "question_id": 43892294, "link": "https://stackoverflow.com/questions/43892294/c-passing-file-stream-as-a-function-parameter", "title": "C passing File stream as a function parameter", "body": "<p>This function gives infinite loop. Any Help? And is it even possible to pass file stream to a function as argument.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid fcopy(FILE *inFILE1){\nFILE *inFILEcopy;\nchar a;\ninFILEcopy=fopen(\"C:/Users/labuser.pcroot-PC.003/Desktop/empoleecopy.bak\",\"w\");\ndo{\n        a=fgetc(inFILE1);\n        fputc(a,inFILEcopy);\n        if(feof(inFILE1))break;\n    }while(1);\n}\nint main(){\n\nFILE *inFILE;\ninFILE=fopen(\"C:/Users/labuser.pcroot-PC.003/Desktop/empolee.dat\",\"w\");\nfputs(\"My name is Anthony\",inFILE);\nfcopy(inFILE);  \n\n\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "winforms", "winapi"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1494425149, "post_id": 43892043, "comment_id": 74823691, "body": "It is still the same fundamental problem you had yesterday, DLU is the wrong unit of measure to use.  DLU only applies to dialog templates, they ensure that dialogs properly rescale on monitors with a different DPI setting.  But the winapi calls you use require pixels, not DLUs.  To get the proper textbox height you have to convert the font height from points to pixels, add the internal margin that textbox uses and add the border width.  Compare to the <a href=\"https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/TextBoxBase.cs,fec237b930cfc431\" rel=\"nofollow noreferrer\">Winforms code</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1494426688, "post_id": 43892043, "comment_id": 74824857, "body": "Hm so this means the Design Specifications are either not correct or at least more limited in scope than stated there: &quot;The system defines the size and location of user interface elements in a window based on dialog units (DLUs), not pixels.&quot; -- do you have any source for that? Meanwhile I found a way to center the content of the edit control vertically by overriding the control&#39;s window proc, but this feels &quot;hacky&quot; ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1494427002, "post_id": 43892043, "comment_id": 74825131, "body": "BTW, <code>GetTextExtentExPointW</code> returns pixels by default, and I only use this to convert the <code>50 DLU</code> / <code>14 DLU</code> to pixels, so I <i>do</i> use pixels in the API calls..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1494429128, "post_id": 43892043, "comment_id": 74826948, "body": "And I committed the version that makes the 14DLU high Textbox kind of look good: <a href=\"https://github.com/Zirias/w32ctltest/commit/92ad0a089178c5b6dae278157ed6edd9c8f0c16b\" rel=\"nofollow noreferrer\">github.com/Zirias/w32ctltest/commit/&hellip;</a> -- but modifying the client RECT feels wrong."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1601706987, "last_edit_date": 1601706987, "creation_date": 1494502074, "answer_id": 43914109, "question_id": 43892043, "link": "https://stackoverflow.com/questions/43892043/win32-how-to-calculate-control-sizes-for-a-consistent-look-across-windows-versi/43914109#43914109", "title": "win32: How to calculate control sizes for a consistent look across windows versions / themes?", "body": "<p>This is only a partial answer I'm adding here for reference:</p>\n<p>Indeed, using the <code>DEFAULT_GUI_FONT</code> <em>is</em> wrong according to <a href=\"https://web.archive.org/web/20190120031333/https://blogs.msdn.microsoft.com/oldnewthing/20050707-00/?p=35013\" rel=\"nofollow noreferrer\">this blog entry by Raymond Chen</a>. So, no need to trust <a href=\"/questions/tagged/winforms\" class=\"post-tag\" title=\"show questions tagged &#39;winforms&#39;\" rel=\"tag\">winforms</a> to do &quot;the right thing&quot;.</p>\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ms997619.aspx\" rel=\"nofollow noreferrer\">Design Specifications</a> indicate that Edit Controls should be the same height as Buttons (14 DLU). To convert these to pixel sizes, the Dialog Base Units (DBU) are needed, and while <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms645475(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetDialogBaseUnits()</a> only returns them for the system font, there are <a href=\"https://support.microsoft.com/en-us/help/125681\" rel=\"nofollow noreferrer\">MSDN</a> <a href=\"https://support.microsoft.com/EN-US/help/145994\" rel=\"nofollow noreferrer\">articles</a> describing how to calculate them for other fonts.</p>\n<p>1 vertical DBU corresponds to 8 DLU, so an Edit control will be 6 DLU higher than the text it contains. This doesn't look so nice, because the Edit control doesn't center the text vertically but instead aligns it at the top. <a href=\"/questions/tagged/winforms\" class=\"post-tag\" title=\"show questions tagged &#39;winforms&#39;\" rel=\"tag\">winforms</a> avoids this by calculating a smaller size for an Edit control. The drawback is that an Edit control will not align nicely next to a Button.</p>\n<p>I found a kind of &quot;hacky&quot; solution to that problem by shrinking the client area of the Edit control in an overridden window proc. The following code compares the results (and contains controls using the system font for completeness):</p>\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\ntypedef struct PaddedControl\n{\n    WNDPROC baseWndProc;\n    int vshrink;\n} PaddedControl;\n\nstatic HINSTANCE instance;\nstatic HWND mainWindow;\nstatic HWND buttonSF;\nstatic HWND textBoxSF;\nstatic HWND buttonMF;\nstatic HWND textBoxMF;\nstatic HWND buttonMFC;\nstatic HWND textBoxMFC;\nstatic PaddedControl textBoxMFCPadded;\n\n#define WC_mainWindow L&quot;W32CtlTestDemo&quot;\n\nstatic NONCLIENTMETRICSW ncm;\nstatic HFONT messageFont;\nstatic TEXTMETRICW messageFontMetrics;\nstatic int controlHeightSF;\nstatic int controlHeightMF;\nstatic int buttonWidthSF;\nstatic int buttonWidthMF;\n\n/* hack to enable visual styles without relying on manifest\n * found at http://stackoverflow.com/a/10444161\n * modified for unicode-only code */\nstatic int enableVisualStyles(void)\n{\n    wchar_t dir[MAX_PATH];\n    ULONG_PTR ulpActivationCookie = 0;\n    ACTCTXW actCtx =\n    {\n        sizeof(actCtx),\n        ACTCTX_FLAG_RESOURCE_NAME_VALID\n            | ACTCTX_FLAG_SET_PROCESS_DEFAULT\n            | ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID,\n        L&quot;shell32.dll&quot;, 0, 0, dir, (LPWSTR)124,\n        0, 0\n    };\n    UINT cch = GetSystemDirectoryW(dir, sizeof(dir) / sizeof(*dir));\n    if (cch &gt;= sizeof(dir) / sizeof(*dir)) { return 0; }\n    dir[cch] = L'\\0';\n    ActivateActCtx(CreateActCtxW(&amp;actCtx), &amp;ulpActivationCookie);\n    return (int) ulpActivationCookie;\n}\n\nstatic void init(void)\n{\n    INITCOMMONCONTROLSEX icx;\n    icx.dwSize = sizeof(INITCOMMONCONTROLSEX);\n    icx.dwICC = ICC_WIN95_CLASSES;\n    InitCommonControlsEx(&amp;icx);\n    ncm.cbSize = sizeof(ncm);\n    SystemParametersInfoW(SPI_GETNONCLIENTMETRICS, ncm.cbSize, &amp;ncm, 0);\n    messageFont = CreateFontIndirectW(&amp;ncm.lfStatusFont);\n\n    LONG sysDbu = GetDialogBaseUnits();\n    HDC dc = GetDC(0);\n    SelectObject(dc, (HGDIOBJ) messageFont);\n    GetTextMetricsW(dc, &amp;messageFontMetrics);\n    SIZE sampleSize;\n    GetTextExtentExPointW(dc,\n            L&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;,\n            52, 0, 0, 0, &amp;sampleSize);\n    ReleaseDC(0, dc);\n    controlHeightSF = MulDiv(HIWORD(sysDbu), 14, 8);\n    controlHeightMF = MulDiv(messageFontMetrics.tmHeight, 14, 8);\n    buttonWidthSF = MulDiv(LOWORD(sysDbu), 50, 4);\n    buttonWidthMF = MulDiv(sampleSize.cx, 50, 4 * 52);\n    instance = GetModuleHandleW(0);\n}\n\nstatic LRESULT CALLBACK paddedControlProc(\n        HWND w, UINT msg, WPARAM wp, LPARAM lp)\n{\n    PaddedControl *self = (PaddedControl *)GetPropW(w, L&quot;paddedControl&quot;);\n    WNDCLASSEXW wc;\n\n    switch (msg)\n    {\n    case WM_ERASEBKGND:\n        wc.cbSize = sizeof(wc);\n        GetClassInfoExW(0, L&quot;Edit&quot;, &amp;wc);\n        RECT cr;\n        GetClientRect(w, &amp;cr);\n        cr.top -= self-&gt;vshrink;\n        cr.bottom += self-&gt;vshrink;\n        HDC dc = GetDC(w);\n        FillRect(dc, &amp;cr, wc.hbrBackground);\n        ReleaseDC(w, dc);\n        return 1;\n\n    case WM_NCCALCSIZE:\n        if (!wp) break;\n        LRESULT result = CallWindowProcW(self-&gt;baseWndProc, w, msg, wp, lp);\n        NCCALCSIZE_PARAMS *p = (NCCALCSIZE_PARAMS *)lp;\n        int height = p-&gt;rgrc[0].bottom - p-&gt;rgrc[0].top;\n        self-&gt;vshrink = 0;\n        if (height &gt; messageFontMetrics.tmHeight + 3)\n        {\n            self-&gt;vshrink = (height - messageFontMetrics.tmHeight - 3) / 2;\n            p-&gt;rgrc[0].top += self-&gt;vshrink;\n            p-&gt;rgrc[0].bottom -= self-&gt;vshrink;\n        }\n        return result;\n    }\n\n    return CallWindowProcW(self-&gt;baseWndProc, w, msg, wp, lp);\n}\n\nstatic LRESULT CALLBACK wproc(HWND w, UINT msg, WPARAM wp, LPARAM lp)\n{\n    switch (msg)\n    {\n    case WM_CREATE:\n        buttonSF = CreateWindowExW(0, L&quot;Button&quot;, L&quot;sysfont&quot;,\n                WS_CHILD|WS_VISIBLE|BS_PUSHBUTTON,\n                4, 4, buttonWidthSF, controlHeightSF,\n                w, 0, instance, 0);\n\n        buttonMF = CreateWindowExW(0, L&quot;Button&quot;, L&quot;msgfont&quot;,\n                WS_CHILD|WS_VISIBLE|BS_PUSHBUTTON,\n                4, 8 + controlHeightSF, buttonWidthMF, controlHeightMF,\n                w, 0, instance, 0);\n        SendMessageW(buttonMF, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        buttonMFC = CreateWindowExW(0, L&quot;Button&quot;, L&quot;msgfont adj&quot;,\n                WS_CHILD|WS_VISIBLE|BS_PUSHBUTTON,\n                4, 12 + controlHeightSF + controlHeightMF,\n                buttonWidthMF, controlHeightMF,\n                w, 0, instance, 0);\n        SendMessageW(buttonMFC, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        textBoxSF = CreateWindowExW(WS_EX_CLIENTEDGE, L&quot;Edit&quot;, L&quot;abcdefgh&quot;,\n                WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,\n                8 + buttonWidthSF, 4, 100, controlHeightSF,\n                w, 0, instance, 0);\n\n        textBoxMF = CreateWindowExW(WS_EX_CLIENTEDGE, L&quot;Edit&quot;, L&quot;abcdefgh&quot;,\n                WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,\n                8 + buttonWidthMF, 8 + controlHeightSF,\n                100, controlHeightMF,\n                w, 0, instance, 0);\n        SendMessageW(textBoxMF, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        textBoxMFC = CreateWindowExW(WS_EX_CLIENTEDGE, L&quot;Edit&quot;, L&quot;abcdefgh&quot;,\n                WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,\n                8 + buttonWidthMF, 12 + controlHeightSF + controlHeightMF,\n                100, controlHeightMF,\n                w, 0, instance, 0);\n        memset(&amp;textBoxMFCPadded, 0, sizeof(PaddedControl));\n        textBoxMFCPadded.baseWndProc = (WNDPROC)SetWindowLongPtr(\n                textBoxMFC, GWLP_WNDPROC, (LONG_PTR)paddedControlProc);\n        SetPropW(textBoxMFC, L&quot;paddedControl&quot;, &amp;textBoxMFCPadded);\n        SetWindowPos(textBoxMFC, 0, 0, 0, 0, 0,\n                SWP_NOOWNERZORDER|SWP_NOSIZE|SWP_NOMOVE|SWP_FRAMECHANGED);\n        SendMessageW(textBoxMFC, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        break;\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n\n    }\n\n    return DefWindowProcW(w, msg, wp, lp);\n}\n\nint main(int argc, char **argv)\n{\n    if (argc &lt; 2 || strcmp(argv[1], &quot;-s&quot;))\n    {\n        enableVisualStyles();\n    }\n\n    init();\n\n    WNDCLASSEXW wc;\n    memset(&amp;wc, 0, sizeof(wc));\n    wc.cbSize = sizeof(wc);\n    wc.hInstance = instance;\n    wc.lpszClassName = WC_mainWindow;\n    wc.lpfnWndProc = wproc;\n    wc.hbrBackground = (HBRUSH) COLOR_WINDOW;\n    wc.hCursor = LoadCursorA(0, IDC_ARROW);\n    RegisterClassExW(&amp;wc);\n\n    mainWindow = CreateWindowExW(0, WC_mainWindow, L&quot;fontdemo&quot;,\n            WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, 240, 180,\n            0, 0, instance, 0);\n    ShowWindow(mainWindow, SW_SHOWNORMAL);\n\n    MSG msg;\n    while (GetMessageW(&amp;msg, 0, 0, 0) &gt; 0)\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessageW(&amp;msg);\n    }\n    return (int)msg.wParam;\n}\n</code></pre>\n<p>The last row of controls using this hack is the best I could achieve so far:</p>\n<p><a href=\"https://i.stack.imgur.com/DEjwd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DEjwd.png\" alt=\"screenshots in win10 and win7\" /></a></p>\n<p>As you can see, a problem that still persists is that the heights of Button and Edit controls look different with the visual styles theme of Windows 10. So I'd still be happy to see a better answer to this question.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1601706987, "creation_date": 1494418007, "last_edit_date": 1494419808, "question_id": 43892043, "link": "https://stackoverflow.com/questions/43892043/win32-how-to-calculate-control-sizes-for-a-consistent-look-across-windows-versi", "title": "win32: How to calculate control sizes for a consistent look across windows versions / themes?", "body": "<p>Working on a simple <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> GUI library, I'm starting with the <a href=\"/questions/tagged/winapi\" class=\"post-tag\" title=\"show questions tagged &#39;winapi&#39;\" rel=\"tag\">winapi</a> backend and having some problems right now calculating the preferred sizes of controls. I'm comparing my results with those of <code>Windows.Forms</code>.</p>\n\n<p>Right now, I'm using values from <a href=\"https://msdn.microsoft.com/en-us/library/ms997619.aspx\" rel=\"nofollow noreferrer\">Design Specifications and Guidelines - Visual Design Layout</a> (like Buttons and TextBoxes being 14 \"Dialog Logical Units\" high) for calculating the pixel sizes in the <a href=\"/questions/tagged/winapi\" class=\"post-tag\" title=\"show questions tagged &#39;winapi&#39;\" rel=\"tag\">winapi</a> implementation, while keeping everything default with Windows Forms. I created these simple demo implementations:</p>\n\n<h3>Windows Forms (demo.cs):</h3>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System.Drawing;\nusing System.Windows.Forms;\n\nnamespace W32CtlTest\n{\n    public class Demo : Form\n    {\n        private FlowLayoutPanel panel;\n        private Button button;\n        private TextBox textBox;\n\n        public Demo() : base()\n        {\n            Text = \"winforms\";\n            panel = new FlowLayoutPanel();\n\n            button = new Button();\n            button.Text = \"test\";\n            button.Click += (sender, args) =&gt;\n            {\n                Close();\n            };\n            panel.Controls.Add(button);\n\n            textBox = new TextBox();\n            panel.Controls.Add(textBox);\n\n            Controls.Add(panel);\n        }\n\n        protected override Size DefaultSize\n        {\n            get\n            {\n                return new Size(240,100);\n            }\n        }\n\n        public static void Main(string[] argv)\n        {\n            if (argv.Length &lt; 1 || argv[0] != \"-s\")\n            {\n                Application.EnableVisualStyles();\n            }\n            Application.Run(new Demo());\n        }\n    }\n}\n</code></pre>\n\n<p>compile with <code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /out:demo.exe /lib:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319 /reference:System.Windows.Forms.dll,System.Drawing.dll demo.cs</code></p>\n\n<h3>Win32 API (demo.c):</h3>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;string.h&gt;\n\n#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\nstatic HINSTANCE instance;\nstatic HWND mainWindow;\nstatic HWND button;\nstatic HWND textBox;\n\n#define WC_mainWindow L\"W32CtlTestDemo\"\n#define CID_button 0x101\n\nstatic NONCLIENTMETRICSW ncm;\nstatic HFONT messageFont;\nstatic TEXTMETRICW messageFontMetrics;\nstatic int buttonWidth;\nstatic int buttonHeight;\nstatic int textBoxWidth;\nstatic int textBoxHeight;\n\n/* hack to enable visual styles without relying on manifest\n * found at http://stackoverflow.com/a/10444161\n * modified for unicode-only code */\nstatic int enableVisualStyles(void)\n{\n    wchar_t dir[MAX_PATH];\n    ULONG_PTR ulpActivationCookie = 0;\n    ACTCTXW actCtx =\n    {\n        sizeof(actCtx),\n        ACTCTX_FLAG_RESOURCE_NAME_VALID\n            | ACTCTX_FLAG_SET_PROCESS_DEFAULT\n            | ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID,\n        L\"shell32.dll\", 0, 0, dir, (LPWSTR)124,\n        0, 0\n    };\n    UINT cch = GetSystemDirectoryW(dir, sizeof(dir) / sizeof(*dir));\n    if (cch &gt;= sizeof(dir) / sizeof(*dir)) { return 0; }\n    dir[cch] = L'\\0';\n    ActivateActCtx(CreateActCtxW(&amp;actCtx), &amp;ulpActivationCookie);\n    return (int) ulpActivationCookie;\n}\n\nstatic void init(void)\n{\n    INITCOMMONCONTROLSEX icx;\n    icx.dwSize = sizeof(INITCOMMONCONTROLSEX);\n    icx.dwICC = ICC_WIN95_CLASSES;\n    InitCommonControlsEx(&amp;icx);\n    ncm.cbSize = sizeof(ncm);\n    SystemParametersInfoW(SPI_GETNONCLIENTMETRICS, ncm.cbSize, &amp;ncm, 0);\n    messageFont = CreateFontIndirectW(&amp;ncm.lfStatusFont);\n    HDC dc = GetDC(0);\n    SelectObject(dc, (HGDIOBJ) messageFont);\n    GetTextMetricsW(dc, &amp;messageFontMetrics);\n    SIZE sampleSize;\n    GetTextExtentExPointW(dc,\n            L\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n            52, 0, 0, 0, &amp;sampleSize);\n    ReleaseDC(0, dc);\n    buttonWidth = MulDiv(sampleSize.cx, 50, 4 * 52);\n    buttonHeight = MulDiv(messageFontMetrics.tmHeight, 14, 8);\n    textBoxWidth = 100;\n    textBoxHeight = MulDiv(messageFontMetrics.tmHeight, 14, 8);\n    instance = GetModuleHandleW(0);\n}\n\nstatic LRESULT CALLBACK wproc(HWND w, UINT msg, WPARAM wp, LPARAM lp)\n{\n    switch (msg)\n    {\n    case WM_CREATE:\n        button = CreateWindowExW(0, L\"Button\", L\"test\",\n                WS_CHILD|WS_VISIBLE|BS_PUSHBUTTON,\n                2, 2, buttonWidth, buttonHeight,\n                w, (HMENU)CID_button, instance, 0);\n        SendMessageW(button, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        textBox = CreateWindowExW(WS_EX_CLIENTEDGE, L\"Edit\", L\"\",\n                WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,\n                6 + buttonWidth, 2, textBoxWidth, textBoxHeight,\n                w, 0, instance, 0);\n        SendMessageW(textBox, WM_SETFONT, (WPARAM)messageFont, 0);\n\n        break;\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n\n    case WM_COMMAND:\n        switch (LOWORD(wp))\n        {\n        case CID_button:\n            DestroyWindow(w);\n            break;\n        }\n        break;\n\n    }\n\n    return DefWindowProcW(w, msg, wp, lp);\n}\n\nint main(int argc, char **argv)\n{\n    if (argc &lt; 2 || strcmp(argv[1], \"-s\"))\n    {\n        enableVisualStyles();\n    }\n\n    init();\n\n    WNDCLASSEXW wc;\n    memset(&amp;wc, 0, sizeof(wc));\n    wc.cbSize = sizeof(wc);\n    wc.hInstance = instance;\n    wc.lpszClassName = WC_mainWindow;\n    wc.lpfnWndProc = wproc;\n    wc.hbrBackground = (HBRUSH) COLOR_WINDOW;\n    wc.hCursor = LoadCursorA(0, IDC_ARROW);\n    RegisterClassExW(&amp;wc);\n\n    mainWindow = CreateWindowExW(0, WC_mainWindow, L\"winapi\",\n            WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, 240, 100,\n            0, 0, instance, 0);\n    ShowWindow(mainWindow, SW_SHOWNORMAL);\n\n    MSG msg;\n    while (GetMessageW(&amp;msg, 0, 0, 0) &gt; 0)\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessageW(&amp;msg);\n    }\n    return (int)msg.wParam;\n}\n</code></pre>\n\n<p>compile with <code>gcc -odemo.exe -O2 demo.c -lgdi32 -lcomctl32</code></p>\n\n<hr>\n\n<p>The test code is also available <a href=\"https://github.com/Zirias/w32ctltest\" rel=\"nofollow noreferrer\">on github</a></p>\n\n<hr>\n\n<p>It looks like this on windows 10, with visual styles enabled in the upper row and disabled in the lower row:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RiwJ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RiwJ5.png\" alt=\"control appearance on windows 10\"></a></p>\n\n<p>One thing I soon found out is that <code>Windows.Forms</code> doesn't use the message font (as I had expected) but instead uses the <code>DEFAULT_GUI_FONT</code> Although that's not the right thing to do, I changed my win32 code accordingly so I can compare the results better:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PCVT8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PCVT8.png\" alt=\"control appearance on windows 10 with DEFAULT_GUI_FONT\"></a></p>\n\n<p>For completeness, here is what it looks like on windows 7 without visual styles:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w6MUT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6MUT.png\" alt=\"control appearance on windows 7 with DEFAULT_GUI_FONT\"></a></p>\n\n<p>Now my questions are:</p>\n\n<ol>\n<li><p>Is it correct to use the message font? So, Windows.Forms definitely got this one \"wrong\"?</p></li>\n<li><p>Obviously Windows.Forms uses the 14 DLU height for Buttons, but some smaller height for TextBoxes. This contradicts the <a href=\"https://msdn.microsoft.com/en-us/library/ms997619.aspx\" rel=\"nofollow noreferrer\">Design Specifications</a>. So is Windows.Forms wrong here as well? Or should TextBoxes in fact be smaller, so the text doesn't look like it's \"hanging from the ceiling\"? I think this <em>does</em> look better the way Windows.Forms does it.</p></li>\n<li><p>Comparing visual styles enabled/disabled, I find that without visual styles, I get the same height for my button and my text box, but with visual styles enabled on windows 10, the text box is actually higher. Is there something like \"theme specific metrics\" and if so, how can I use that to correct my calculations?</p></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1494418149, "post_id": 43892011, "comment_id": 74818037, "body": "A complete minimal working example would be great...I am also not sure what is the problem in he behavior (what works and what doesn&#39;t, by your sayings)."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1494418283, "post_id": 43892011, "comment_id": 74818133, "body": "Did you check <code>argc</code>?  Typically, if you type <code>a.out echo $3 $1</code>  it is the same typing just <code>a.out echo</code>, since the <code>$3</code> and the <code>$1</code> will each be replaced with the empty string and no argument will be passed."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1494418583, "post_id": 43892011, "comment_id": 74818349, "body": "Sounds like a XY problem. What do you want to do with the args after? Can you show that code. <i>the code executes everything else is working), but i&#39;m not getting the correct results</i>. What is the expected output, what are you getting? Provide a Minimal, verifiable and reproducible example."}, {"owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1494441571, "post_id": 43892011, "comment_id": 74834515, "body": "@WilliamPursell wow, never thought that might be the problem, will check it, i put &quot;$n&quot; to try, but will check if that isn&#39;t the problem, because when i tested printing the array it only gave me the argumentos without $:"}, {"owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494441575, "post_id": 43892011, "comment_id": 74834520, "body": "@gsamaras it will do a loop readin from stdin, fork to a child, read stdin from father a string separated by columns, use the $n column to execute the program on the child and return the exit status to father.  didn&#39;t include that because my problem is getting the number without the $."}, {"owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1494441580, "post_id": 43892011, "comment_id": 74834525, "body": "@AjayBrahmakshatriya expected output would be coluna getting the int n from $n."}, {"owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "edited": false, "score": 0, "creation_date": 1494442666, "post_id": 43892011, "comment_id": 74835188, "body": "Okay, found the problem, the sscanf is not producing the expect results"}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1494420761, "post_id": 43892425, "comment_id": 74820084, "body": "<a href=\"http://stackoverflow.com/q/17710018/995714\"><code>atoi</code> has deprecated and shouldn&#39;t be used</a>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1494424008, "post_id": 43892425, "comment_id": 74822779, "body": "@L\u01b0uV\u0129nhPh&#250;c Sure - I don&#39;t use it myself anyway, just retained it because of being in the original question..."}, {"owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "edited": false, "score": 0, "creation_date": 1494442121, "post_id": 43892425, "comment_id": 74834845, "body": "@Aconcagua i want the value(s) of coluna to use later with an input string to extract the nth field."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1494418998, "creation_date": 1494418998, "answer_id": 43892425, "question_id": 43892011, "link": "https://stackoverflow.com/questions/43892011/replace-n-with-n-in-string/43892425#43892425", "title": "Replace $n with n in string", "body": "<p>You repeatedly overwrite <code>coluna</code>:</p>\n\n<pre><code>for(...)\n{\n    if(sscanf(...) == 1)\n        coluna = atoi(col); // &lt;--\n}\n</code></pre>\n\n<p>I cannot figure out what you exactly want to achive, if you just want to get the <em>first</em> such value (thus the name \"coluna\"?), then simply <code>break</code> your loop:</p>\n\n<pre><code>if(sscanf(...) == 1)\n{\n    coluna = atoi(col);\n    break;\n}\n</code></pre>\n\n<p>Otherwise, use coluna directly here instead of breaking or store your values in an array as below. Assuming every argument might contain <code>$n</code>:</p>\n\n<pre><code>int cols[argc-1]; // assuming you checked for argc &gt; 1 already!\nint numCols = 0;\n\nif(sscanf(...) == 1)\n    cols[numCols++] = atoi(col);\n</code></pre>\n\n<p>Side note: These two pieces of code:</p>\n\n<pre><code>int total = argc-1;\n\nfor(i=0;i&lt;total;i++) {\n    if(i+1 == total) cmd[total+1] = NULL;\n    else cmd[i] = argv[i+1];\n}\n</code></pre>\n\n<p>can be replaced by simply doing:</p>\n\n<pre><code>--argc;\n++argv;\n</code></pre>\n\n<p>unless you really need for any reason a copy (like comparing modified cmd against original argv). If you modify argc/argv as above, you can then use argc and argv just as you do with cmd/total. To retain the names, you might even rename argc to total and argv to cmd...</p>\n"}], "owner": {"reputation": 147, "user_id": 1911609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1e8c2e4ed6798bdd08499b42d76c2575?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Moreira", "link": "https://stackoverflow.com/users/1911609/jos%c3%a9-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 43892425, "answer_count": 1, "score": -1, "last_activity_date": 1494418998, "creation_date": 1494417929, "last_edit_date": 1494418307, "question_id": 43892011, "link": "https://stackoverflow.com/questions/43892011/replace-n-with-n-in-string", "title": "Replace $n with n in string", "body": "<p>My program will receive a command like </p>\n\n<blockquote>\n  <p>./a.out echo $3 $1 \">\" log.txt</p>\n</blockquote>\n\n<p>i need to replace the $3 with 3 and 1 to use latter when reading from stdin, at this moment i have my code like this (its only doing for one $n at this moment):</p>\n\n<pre><code>int total = argc-1;\nint coluna =0;\nint i,n,cut,s, pid,status;\nchar *cmd[total]; \nchar buffer[PIPE_BUF];\nchar col[10];\nchar field[10];\n\n\n//passar argumentos para array\nfor(i=0;i&lt;total;i++) {\n    if(i+1 == total) cmd[total+1] = NULL;\n    else cmd[i] = argv[i+1];\n}\n//verify for $n\nchar *tmp = cmd;\nfor(i=0;i&lt;total-1;i++) {\n    if(sscanf(tmp,\"[$]%s\",col) == 1) coluna = atoi(col);\n}\n</code></pre>\n\n<p>the code executes everything else is working (tried without $n, and some other test), but i'm not getting the correct results, seems it ignores the value.</p>\n\n<p>can someone point me my error?</p>\n"}, {"tags": ["c", "file", "loops", "for-loop", "while-loop"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494417757, "post_id": 43891868, "comment_id": 74817736, "body": "<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong?rq=1\">Relevant question.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419501, "creation_date": 1494419501, "answer_id": 43892601, "question_id": 43891868, "link": "https://stackoverflow.com/questions/43891868/how-can-i-use-feof-with-while-loop/43892601#43892601", "title": "How can I use feof with while loop?", "body": "<p>Several things:</p>\n\n<p>First, <strong><em>NEVER NEVER NEVER NEVER NEVER</em></strong> use <code>gets</code> - it is dangerous, it <em>will</em> introduce a point of failure and/or massive security hole in your code, and it has been removed from the standard library as of the 2011 version of the language standard.  Use <code>fgets</code> instead:</p>\n\n<pre><code>fgets( nameOfStudents, sizeof nameOfStudents, stdin );\n</code></pre>\n\n<p>Secondly, <code>while( !feof( fp ) )</code> is always wrong. On input from <code>fp</code>, it will loop one time too often.  On output to <code>fp</code>, it is meaningless.</p>\n\n<p>You can use the result of <code>fgets</code> to control your loop:</p>\n\n<pre><code>while ( fgets( nameOfStudents, sizeof nameOfStudents, stdin ) )\n{\n  ...\n}\n</code></pre>\n\n<p>When you're done entering data from the terminal, signal an EOF using either <kbd>Ctrl</kbd><kbd>Z</kbd> or <kbd>Ctrl</kbd><kbd>D</kbd> (depends on your platform).</p>\n\n<p>Third, <code>main</code> returns <code>int</code>, not <code>void</code>; use</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>instead.</p>\n\n<p>Finally, change</p>\n\n<pre><code>for (; i &lt; strlen(namesOfStudents); i++)\n{\n  fprintf(Points, \"%c\", namesOfStudents[i]); //To write student name to file\n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>fprintf( Points, \"%s\", nameOfStudents );\n</code></pre>\n\n<p>to write the student name to the file.</p>\n\n<p>There are other problems, but make those changes and see if that doesn't help.</p>\n"}], "owner": {"reputation": 41, "user_id": 7857772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca789633ab493512f3b79aacefdbff8?s=128&d=identicon&r=PG&f=1", "display_name": "serkanhelvacioglu", "link": "https://stackoverflow.com/users/7857772/serkanhelvacioglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494419501, "creation_date": 1494417557, "question_id": 43891868, "link": "https://stackoverflow.com/questions/43891868/how-can-i-use-feof-with-while-loop", "title": "How can I use feof with while loop?", "body": "<p>I want to get student name mid-term and final points and write them in a txt file but when I use a loop, It never get student name. It always gives it a miss. How can I use feof with a loop? I want to get student names mid-term and final point and calculate the average from the got points and It must get always name and points till user press the end of file.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;conio.h&gt;\n\nvoid main()\n{\nFILE *Points;\n\nchar namesOfStudents[10];\nint pointsOfStudents[1][2];\ndouble AverageOfStudents[1];\nint i=0,j=1;\nint numberOfStudents;\n\nPoints = fopen(\"C:\\\\Users\\\\Toshiba\\\\Desktop\\\\PointsOfStudent.txt\", \"a+\");\nfprintf(Points, \"Name\\t\\t 1.Grade\\t2.Grade\\t\\tAverage\\n\");\n/*  printf(\"How many students will you enter: \");\nscanf(\"%d\",&amp;numberOfStudents);*/\n\n//while (!feof(Points))\n\nprintf(\"Please enter new students name: \");\ngets(namesOfStudents);\nprintf(\"\\nPlease enter new students first point: \");\nscanf(\"%d\",&amp;pointsOfStudents[0][0]);\nprintf(\"\\nPlease enter new students second point: \");\nscanf(\"%d\",&amp;pointsOfStudents[0][1]);\n\n\n        for (; i &lt; strlen(namesOfStudents); i++)\n            {\n                fprintf(Points, \"%c\", namesOfStudents[i]); //To write \n     student name to file\n\n            }\n        fprintf(Points,\"\\t\\t   \");\n\n        fprintf(Points,\"%d\\t\\t\",pointsOfStudents[0][0]);  //to write \nstudent's first point\n        fprintf(Points,\"%d\\t\\t\",pointsOfStudents[0][1]);  //to write \nstudent's second point  \n\n        fprintf(Points,\"%d\\n\",(pointsOfStudents[0][0]+pointsOfStudents[0]\n[1])/2);    //to calculate and write average \n        system(\"cls\");\n\n        fclose(Points);\n\nsystem(\"Pause\");\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "thread-safety", "pthreads"], "answers": [{"tags": [], "owner": {"reputation": 2532, "user_id": 4530326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/65z58.png?s=128&g=1", "display_name": "tpunt", "link": "https://stackoverflow.com/users/4530326/tpunt"}, "is_accepted": true, "score": 1, "last_activity_date": 1494426485, "last_edit_date": 1494426485, "creation_date": 1494425838, "answer_id": 43895149, "question_id": 43891788, "link": "https://stackoverflow.com/questions/43891788/multiple-threads-print-value-together/43895149#43895149", "title": "multiple threads print value together", "body": "<p>When you create a new thread, there is no fixed order of thread execution. The main thread and the newly created thread(s) will simply run concurrently to each other.</p>\n\n<p>The problem with respect to your <code>i</code> variable is that you're passing in the <em>address</em> of <code>i</code> to the <code>pthread_create</code> function. Since this variable gets updated upon subsequent loop iterations, its value will change when you access it via its address (from within the <code>printHello</code> callback function). In your output, we can see that the loop in the <code>main</code> function has finished before any of the spawned threads output anything, since <code>i</code> has reached the <code>NUM_THREADS</code> limit already.</p>\n\n<p>If you want things to be deterministic, then create a new variable to hold the thread IDs, and pass in the address location for that thread instead:</p>\n\n<pre><code>int threadIds[NUM_THREADS];\nint rc;\nint i;\n\nfor (i = 0; i &lt; NUM_THREADS; i++)\n{\n    threadIds[i] = i;\n    rc = pthread_create(&amp;threads[i], NULL, printHello, threadIds + i);\n}\n</code></pre>\n\n<p>Also, block on the main thread until all spawned threads have finished executing, and don't invoke <code>pthread_exit</code> in the <code>main</code> function. It is not running inside of a pthread, and so it does not need exiting.</p>\n"}], "owner": {"reputation": 2002, "user_id": 6455516, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10154051803880210/picture?type=large", "display_name": "Manspof", "link": "https://stackoverflow.com/users/6455516/manspof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 43895149, "answer_count": 1, "score": 0, "last_activity_date": 1494426543, "creation_date": 1494417319, "last_edit_date": 1494426543, "question_id": 43891788, "link": "https://stackoverflow.com/questions/43891788/multiple-threads-print-value-together", "title": "multiple threads print value together", "body": "<p>I'm trying to understand why I got this answer while I run this code in thread.\nI don't understand why i don't get different i value each time.\n<a href=\"https://i.stack.imgur.com/VxTDj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VxTDj.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define NUM_THREADS 5\n\nvoid *printHello(void *threadid)\n{\n    int tid = *(int*)threadid;  \n\n    printf(\"Hello World! It's me, thread #%d!\\n\", tid);\n\n    pthread_exit(NULL);\n}\n\nint main(int argc, char *argv[])\n{\n    pthread_t threads[NUM_THREADS];\n    int rc;\n    int i;\n\n    for (i = 0; i &lt; NUM_THREADS; i++)\n    {\n        printf(\"In main: creating thread %ld\\n\", i,);\n\n        rc = pthread_create(&amp;threads[i], NULL, printHello, &amp;i);\n\n        if (rc)\n        {\n            printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n            exit(-1);\n        }\n    }\n\n    pthread_exit(NULL); \n}\n</code></pre>\n\n<p>do all the thread wait until they finish to create them and then they go to printHello function?</p>\n"}, {"tags": ["c", "linux", "unix", "process", "fork"], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 5432234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-lDqG2Q7DArU/AAAAAAAAAAI/AAAAAAAACHY/hQLKaC_WNZs/photo.jpg?sz=128", "display_name": "Mattia", "link": "https://stackoverflow.com/users/5432234/mattia"}, "edited": false, "score": 0, "creation_date": 1494419576, "post_id": 43892162, "comment_id": 74819123, "body": "Yes, I will probably call <code>execvp</code> or a <code>exit(0)</code> after the <code>printf(&quot;Child pid is %d\\n&quot;, getpid())</code>"}], "tags": [], "owner": {"reputation": 395, "user_id": 7980658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a8a398fe8bfc300b8539214bdee7fb?s=128&d=identicon&r=PG", "display_name": "Paul-Louis Ageneau", "link": "https://stackoverflow.com/users/7980658/paul-louis-ageneau"}, "is_accepted": false, "score": 1, "last_activity_date": 1494418325, "creation_date": 1494418325, "answer_id": 43892162, "question_id": 43891745, "link": "https://stackoverflow.com/questions/43891745/main-process-doesnt-print-after-calling-fork-in-a-function/43892162#43892162", "title": "Main process doesn&#39;t print after calling fork() in a function", "body": "<p>You should call <code>fflush(stdout)</code> after <code>printf(\"&gt; \")</code> to ensure the string is displayed, since it does not end with a line feed, yet stdout is line-buffered. However, the <code>\"&gt; \"</code> might be displayed before the child process has a chance to write, actually outputting <code>\"&gt; Process created\"</code>.</p>\n\n<p>Besides, the child process will loop indefinitely in <code>for(;;)</code> just comparing the PIDs, so you should also fix that.</p>\n"}, {"comments": [{"owner": {"reputation": 130, "user_id": 5432234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-lDqG2Q7DArU/AAAAAAAAAAI/AAAAAAAACHY/hQLKaC_WNZs/photo.jpg?sz=128", "display_name": "Mattia", "link": "https://stackoverflow.com/users/5432234/mattia"}, "edited": false, "score": 0, "creation_date": 1494419311, "post_id": 43892429, "comment_id": 74818887, "body": "I think i should add a <code>sleep(1)</code> after the <code>printf(&quot;Process created\\n&quot;);</code>"}, {"owner": {"reputation": 114, "user_id": 7902532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87dbc7fbea473c258865df5288708a0?s=128&d=identicon&r=PG", "display_name": "cheemcheem", "link": "https://stackoverflow.com/users/7902532/cheemcheem"}, "reply_to_user": {"reputation": 130, "user_id": 5432234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-lDqG2Q7DArU/AAAAAAAAAAI/AAAAAAAACHY/hQLKaC_WNZs/photo.jpg?sz=128", "display_name": "Mattia", "link": "https://stackoverflow.com/users/5432234/mattia"}, "edited": false, "score": 0, "creation_date": 1494420052, "post_id": 43892429, "comment_id": 74819489, "body": "That won&#39;t work since it isn&#39;t a thread its a process, look at my answer for a fix."}, {"owner": {"reputation": 130, "user_id": 5432234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-lDqG2Q7DArU/AAAAAAAAAAI/AAAAAAAACHY/hQLKaC_WNZs/photo.jpg?sz=128", "display_name": "Mattia", "link": "https://stackoverflow.com/users/5432234/mattia"}, "edited": false, "score": 0, "creation_date": 1494420489, "post_id": 43892429, "comment_id": 74819855, "body": "Thanks I solved by adding <code>wait(0)</code> after the <code>createProcess()</code> in the main. Now I try to understand your solution. If I want to keep the child process active doing nothing which function do you recommend?"}], "tags": [], "owner": {"reputation": 114, "user_id": 7902532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87dbc7fbea473c258865df5288708a0?s=128&d=identicon&r=PG", "display_name": "cheemcheem", "link": "https://stackoverflow.com/users/7902532/cheemcheem"}, "is_accepted": true, "score": 1, "last_activity_date": 1494420150, "last_edit_date": 1494420150, "creation_date": 1494419009, "answer_id": 43892429, "question_id": 43891745, "link": "https://stackoverflow.com/questions/43891745/main-process-doesnt-print-after-calling-fork-in-a-function/43892429#43892429", "title": "Main process doesn&#39;t print after calling fork() in a function", "body": "<pre><code>&gt; create\n\n&gt; Process created\n\nChild pid is 5655\n</code></pre>\n\n<p>So I tested it and got this^ (note the \"> \" before \"Process created\").\nThis means it is printing out just not in the order you want.</p>\n\n<p><strong>Edit this is a fix:</strong></p>\n\n<pre><code>void createProcess(){\n      pid_t  pid;\n      pid = fork();\n      if (pid == 0){\n         printf(\"Process created\\n\");\n         printf(\"Child pid is %d\\n\", getpid());\n         exit(0);\n      }\n      if (pid &gt; 0) {\n         int stat_loc;\n         wait(&amp;stat_loc);\n      }\n   }\n</code></pre>\n\n<p>got this output:</p>\n\n<pre><code>&gt; create\nProcess created\nChild pid is 5700\n&gt; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1494421033, "creation_date": 1494421033, "answer_id": 43893191, "question_id": 43891745, "link": "https://stackoverflow.com/questions/43891745/main-process-doesnt-print-after-calling-fork-in-a-function/43893191#43893191", "title": "Main process doesn&#39;t print after calling fork() in a function", "body": "<p>Beware, you have an active loop in the child process, which could cause unexpected side effects.</p>\n\n<p>Here is what happens</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>for(;;) unterminated loop\n| if parent =&gt; ok first pass is parent\n| fork\n  -----------------------------\n  | (parent)                   | (child)\n  | loop as expected           | still loops!\n                               | getpid() != mainPid so won't read a line\n                               | and infinitely loops...\n</code></pre>\n\n<p>Your loop should be:</p>\n\n<pre><code>  while (mainPid == getpid()){  // let child terminate...\n     printf(\"&gt; \");\n     line = read_line();\n     if (line[strlen(line) - 1] == '\\n')\n        line[strlen(line) - 1] = '\\0';\n     if (strcmp(line, \"create\") == 0)\n        createProcess();\n     else if (strcmp(line, \"exit\") == 0) break;  // add clean exit...\n     else printf(\"Write \\\"Create\\\"\\n\" );\n  }\n</code></pre>\n\n<p>Correctly works with Clang compiler...</p>\n"}], "owner": {"reputation": 130, "user_id": 5432234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-lDqG2Q7DArU/AAAAAAAAAAI/AAAAAAAACHY/hQLKaC_WNZs/photo.jpg?sz=128", "display_name": "Mattia", "link": "https://stackoverflow.com/users/5432234/mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 43892429, "answer_count": 3, "score": 1, "last_activity_date": 1494421033, "creation_date": 1494417199, "last_edit_date": 1494419261, "question_id": 43891745, "link": "https://stackoverflow.com/questions/43891745/main-process-doesnt-print-after-calling-fork-in-a-function", "title": "Main process doesn&#39;t print after calling fork() in a function", "body": "<p>I'm trying to write a shell but i can't understand why this <code>\"&gt; \"</code> is not printed by the main process after the <code>createProcess</code> function ends.\nAlso is there a better way to print something from the main process only? I've used this <code>if (mainPid == getpid()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nvoid createProcess(){\n   pid_t  pid;\n   pid = fork();\n   if (pid == 0){\n      printf(\"Process created\\n\");\n      printf(\"Child pid is %d\\n\", getpid());\n   }\n}\n\nchar *read_line(){\n   char *line = NULL;\n   size_t bufsize = 0;\n   getline(&amp;line, &amp;bufsize, stdin);\n   return line;\n}\n\nint main(){\n   pid_t mainPid = getpid();\n   char* line = NULL;\n   for (;;) {\n      if (mainPid == getpid()){\n         printf(\"&gt; \");\n         line = read_line();\n         if (line[strlen(line) - 1] == '\\n')\n            line[strlen(line) - 1] = '\\0';\n         if (strcmp(line, \"create\") == 0)\n            createProcess();\n         else printf(\"Write \\\"Create\\\"\\n\" );\n      }\n   }\nfree(line);\nreturn 0;\n}  \n</code></pre>\n\n<p>Expected Output</p>\n\n<pre><code>&gt; create\nProcess created\nChild pid is 2417\n&gt; \n</code></pre>\n"}, {"tags": ["c", "struct", "magenta"], "answers": [{"tags": [], "owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "is_accepted": true, "score": 0, "last_activity_date": 1494417625, "creation_date": 1494417625, "answer_id": 43891897, "question_id": 43891648, "link": "https://stackoverflow.com/questions/43891648/c-structs-with-three-options-in-the-magenta-kernel/43891897#43891897", "title": "C Structs with three options in the magenta kernel", "body": "<p>It's a macro shorthand for the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Type-Attributes.html#Common-Type-Attributes\" rel=\"nofollow noreferrer\"><code>aligned</code> attribute</a>, which is a GCC extension.</p>\n\n<p>The macro is defined as follows:</p>\n\n<pre><code>#define __CPU_ALIGN __ALIGNED(CACHE_LINE)\n</code></pre>\n\n<p>The macro __ALIGNED in turn is defined like this:</p>\n\n<pre><code>#define __ALIGNED(x) __attribute__((aligned(x)))\n</code></pre>\n\n<p>...which matches the syntax in the GCC documentation. (The value of CACHE_LINE depends on the architecture.)</p>\n"}], "owner": {"reputation": 13, "user_id": 7991237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff00bbaf1206ea2005ee8b72304ee279?s=128&d=identicon&r=PG&f=1", "display_name": "plenty", "link": "https://stackoverflow.com/users/7991237/plenty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 43891897, "answer_count": 1, "score": 1, "last_activity_date": 1494417625, "creation_date": 1494416947, "question_id": 43891648, "link": "https://stackoverflow.com/questions/43891648/c-structs-with-three-options-in-the-magenta-kernel", "title": "C Structs with three options in the magenta kernel", "body": "<p>In the magenta kernel there is a paragraph in which struct got not only a type and name but one option more. I found in the references nothing to explain that syntax. So what is __CPU_ALIGN as argument in struct for and where do I find the syntax for it? </p>\n\n<blockquote>\n  <p>struct type name ???</p>\n</blockquote>\n\n<pre><code>#if WITH_SMP\n/* a global state structure, aligned on cpu cache line to minimize aliasing */\nstruct mp_state mp __CPU_ALIGN = {\n    .hotplug_lock = MUTEX_INITIAL_VALUE(mp.hotplug_lock),\n    .ipi_task_lock = SPIN_LOCK_INITIAL_VALUE,\n};\n</code></pre>\n\n<p>I know that __CPU_ALIGN itself is used to have aligned bytes for the CPU memory size. </p>\n"}, {"tags": ["c", "arrays", "algorithm", "pointers"], "comments": [{"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 1, "creation_date": 1494416322, "post_id": 43891346, "comment_id": 74816607, "body": "In <code>printf()</code> change <code>knapsack(value[100],weight[100])</code> to <code>knapsack(value,weight)</code>"}, {"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 1, "creation_date": 1494416517, "post_id": 43891346, "comment_id": 74816786, "body": "I do not understand your last question about the &quot;good practise&quot;. If the fucntion demands multiple values of same type, then one has to use an array, there is no other option"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1494416740, "post_id": 43891346, "comment_id": 74816964, "body": "<code>int knapsack(int value[], int weight[])</code> ----&gt; <code>int knapsack(size_t capacity, int value[capacity], int weight[capacity])</code>"}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 0, "creation_date": 1494419695, "post_id": 43891346, "comment_id": 74819221, "body": "Note that <code>value[i] &#47; weight[i]</code> is integer division, in which fractional parts are truncated; this is perhaps not what you want."}, {"owner": {"reputation": 1, "user_id": 7516973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab3c40d394d2a318db4c7ec7511af92?s=128&d=identicon&r=PG&f=1", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/7516973/kwaku"}, "reply_to_user": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 0, "creation_date": 1494420123, "post_id": 43891346, "comment_id": 74819552, "body": "@GAURANGV VYAS was thinking int value[ ] isn&#39;t correct but compiling but read it correct with the C99 standard."}, {"owner": {"reputation": 1, "user_id": 7516973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab3c40d394d2a318db4c7ec7511af92?s=128&d=identicon&r=PG&f=1", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/7516973/kwaku"}, "reply_to_user": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 0, "creation_date": 1494420248, "post_id": 43891346, "comment_id": 74819648, "body": "@Codor so meaning it is better to declare array value and weight has float?"}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 4464804, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PANGULX0Vjs/AAAAAAAAAAI/AAAAAAAAACk/ntk8m7xVA5s/photo.jpg?sz=128", "display_name": "Ashutosh Narang", "link": "https://stackoverflow.com/users/4464804/ashutosh-narang"}, "is_accepted": false, "score": 0, "last_activity_date": 1504997360, "last_edit_date": 1504997360, "creation_date": 1494443313, "answer_id": 43900870, "question_id": 43891346, "link": "https://stackoverflow.com/questions/43891346/understanding-fractional-knapsack-arrays-and-pointers/43900870#43900870", "title": "Understanding fractional knapsack, arrays and pointers", "body": "<pre><code>int knapsack(int value[], int weight[])\n</code></pre>\n\n<p>The above statement gives the compiler the information about <strong>HOW</strong> the function should be called (type of arguments) and <strong>WHAT</strong> the function will return.</p>\n\n<ol>\n<li><p>It says the function knapsack will return an integer value (the 1st int).</p></li>\n<li><p>Its name is knapsack (case-sensitive).</p></li>\n<li><p>It expects two arguments: an integer array (named value) and an integer array (named weight).</p></li>\n</ol>\n\n<p>Points 1, 2 and 3 together make up the signature of a function.</p>\n\n<p>To call the function you have to pass 2 integer arrays as its arguments.</p>\n\n<p>The <strong>mistake</strong> : <code>value[100]</code> corresponds to an <strong>INTEGER ENTRY</strong> in the array and not the array itself.</p>\n\n<p>To pass the array you should pass the array name as its argument, which your function expects.</p>\n\n<p>Call the function like this: <code>knapsack(value, weight)</code></p>\n\n<p><em>value</em> corresponds the <em>array value</em> and <em>weight</em> corresponds to the <em>array weight</em></p>\n\n<p>Also, passing <code>value[100]</code> corresponds to some garbage value that is not within the array bounds as you can only access elements ranging from <code>value[0]</code> to <code>value[99]</code> (0-based indexing).</p>\n"}], "owner": {"reputation": 1, "user_id": 7516973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab3c40d394d2a318db4c7ec7511af92?s=128&d=identicon&r=PG&f=1", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/7516973/kwaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504997360, "creation_date": 1494416146, "last_edit_date": 1504997228, "question_id": 43891346, "link": "https://stackoverflow.com/questions/43891346/understanding-fractional-knapsack-arrays-and-pointers", "title": "Understanding fractional knapsack, arrays and pointers", "body": "<p>Just started learning C programming and decided to take a class in algorithmic Toolbox on Coursera. One of the challenges is writing a code using fractional knapsack, maximizing the value of loot and a pseudo code was given to help in coding the solution. Below are the pseudo code and the code I wrote for the pseudo code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint min(int a, int b)\n{\n    if (a &lt; b)\n        return a;\n    else\n        return b;\n}\n\nint knapsack(int value[], int weight[])\n{\n    int capacity = 100;\n    int val = 0;\n    int array[] = { 0 };\n    for (int i = 1; i &lt; capacity; i++)\n    {\n        if (capacity == 0)\n        {\n            return val;\n        }\n        for (int i = 1; i &lt; capacity; i++)\n        {\n            if (weight[i] &gt; 0 &amp;&amp; (value[i] / weight[i]))\n            {\n                int a = min(weight[i], capacity);\n                val = val + a * (value[i] / weight[i]);\n                weight[i] = weight[i] - a;\n                array[i] = array[i] + a;\n                capacity = capacity - a;\n            }\n        }\n    }\n    return val;\n}\n\nint main()\n{\n    int value[100];\n    int weight[100];\n    scanf(\"%d\", &amp;value[100]);\n    scanf(\"%d\", &amp;weight[100]);\n    printf(\"%d\", knapsack(value[100], weight[100]));\n    return 0;\n}\n</code></pre>\n\n<p>pseudo code</p>\n\n<pre><code>Knapsack(W, w1,v1,......wn,vn)\nA &lt;-- [0,0,], V &lt;-- 0;\nrepeat n times:\nif W =  0:\nreturn (V,A)\nselect i with Wi &gt; 0 and max vi/wi\na &lt;-- min(wi, W)\nV &lt;-- V + a(vi/wi)\nwi &lt;-- wi - a, A[i] &lt;-- A[i] + a, W &lt;-- W - a\nreturn (V, A)\n</code></pre>\n\n<p>I am getting errors when I compile such as \"passing argument 1 of 'knapsack' makes pointer from integer without a cast [-Wint-conversion]\"</p>\n\n<pre><code>printf(\"%d\", knapsack(value[100],weight[100]));\n</code></pre>\n\n<p>\"expected int * but argument is of type 'int'\"</p>\n\n<pre><code>int knapsack(int value[], int weight[])\n</code></pre>\n\n<p>I also want to know if it is a good practice to declare <code>int value[], int weight[]</code> in the function <code>int knapsack</code> argument and also more explanation in using arrays and pointers in situations like this.</p>\n"}, {"tags": ["c", "string", "pointers", "string-literals"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 3, "creation_date": 1494415744, "post_id": 43891117, "comment_id": 74816216, "body": "You don&#39;t need to put <code>\\0</code> at the end. The string literal does that for you."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1494416096, "last_edit_date": 1494416096, "creation_date": 1494415792, "answer_id": 43891199, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string/43891199#43891199", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>In this case</p>\n\n<pre><code> str = \"hello world\\0\";\n</code></pre>\n\n<p><code>str</code> points to the address of the first element of an array of <code>chars</code>, initialized with <code>\"hello world\\0\"</code>. In other words, <code>str</code> points to a \"string literal\".</p>\n\n<p>By definition, the array is allocated and the address of the first element has to be \"valid\".</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.4.5, <em>String literals</em></p>\n\n<blockquote>\n  <p>In translation phase 7, a byte or code of value zero is appended to each multibyte\n  character sequence that results from a string literal or literals.<sup>78)</sup> The multibyte character\n  sequence is then used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. For character string literals, the array elements have\n  type char, and are initialized with the individual bytes of the multibyte character\n  sequence. [....]</p>\n</blockquote>\n\n<p>Memory allocation <strong>still</strong> happens, just <strong>not explicitly</strong> by you (via memory allocator functions).</p>\n\n<hr>\n\n<p>That said, the <code>\"...\\0\"</code> at the end is repetitive, as mentioned (in the first statement of the quote) above, by default, the array will be null-terminated.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7990510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45870f164ee5bb251780e05266ed332?s=128&d=identicon&r=PG&f=1", "display_name": "Black_Knight", "link": "https://stackoverflow.com/users/7990510/black-knight"}, "is_accepted": false, "score": 1, "last_activity_date": 1494415825, "creation_date": 1494415825, "answer_id": 43891213, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string/43891213#43891213", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>Right. But in this case you are just pointing to a string literal which is placed in the constant memory area. Your pointer is created in the stack area. So you are just pointing to another address. i.e, at the starting address of string literal.</p>\n\n<p>Try using copy the string literal in your pointer variable. Then it will give error because you have not allocated memory. Hope you understand now.</p>\n"}, {"tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": true, "score": 1, "last_activity_date": 1494415974, "last_edit_date": 1495540985, "creation_date": 1494415974, "answer_id": 43891274, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string/43891274#43891274", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>When you declare a string literal in a C program, it is stored in a <a href=\"https://stackoverflow.com/a/2589963/1679849\">read-only section</a> of the program code. A statement of the form <code>char *str = \"hello\";</code> will assign the address of this string to the <code>char*</code> pointer. However, the string itself (i.e., the characters <code>h</code>, <code>e</code>, <code>l</code>, <code>l</code> and <code>o</code>, plus the <code>\\0</code> string terminator) are still located in read-only memory, so you can't change them at all.</p>\n\n<p>Note that there's no need for you to explicitly add a zero byte terminator to your string declarations. The C compiler will do this for you.</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1494416033, "creation_date": 1494416033, "answer_id": 43891296, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string/43891296#43891296", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>Using a <code>char</code> variable without <code>malloc</code> is stating that the string you are assigning is read-only. This means  that you are creating a pointer to a string constant. <code>\"hello world\\0\"</code> is somewhere in the read-only part of memory and you are just pointing to it.</p>\n\n<p>Now if you want to make changes to the string. Let's say changing the <code>h</code> to <code>H</code>, that would be <code>str[0]='H'</code>. Without <code>malloc</code> that will not be possible to make. </p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1494417961, "creation_date": 1494417961, "answer_id": 43892020, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string/43892020#43892020", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>Storage for string literals is set aside at program startup and held until the program exits.  This storage <em>may</em> be read-only, and attempting to modify the contents of a string literal results in undefined behavior (it may work, it may crash, it may do something in between).  </p>\n"}], "owner": {"reputation": 53, "user_id": 6832735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FNWPmbKjzs8/AAAAAAAAAAI/AAAAAAAAABE/mzLkpphaOYM/photo.jpg?sz=128", "display_name": "Radi Hadzhiev", "link": "https://stackoverflow.com/users/6832735/radi-hadzhiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 43891274, "answer_count": 5, "score": 3, "last_activity_date": 1494417961, "creation_date": 1494415588, "last_edit_date": 1494416130, "question_id": 43891117, "link": "https://stackoverflow.com/questions/43891117/i-want-to-know-why-this-works-without-having-to-bind-memory-for-the-string", "title": "I want to know why this works without having to bind memory for the string", "body": "<p>Hello guys I recently picked up C programming and I am stuck at understanding pointers. As far as I understand to store a value in a pointer you have to bind memory (using malloc) the size of the value you want to store. Given this, the following code should not work as I have not allocated 11 bytes of memory to store my string of size 11 bytes and yet for some reason beyond my comprehension it works perfectly fine. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\n  char *str = NULL;\n\n  str = \"hello world\\0\";\n  printf(\"filename = %s\\n\", str);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "database", "sqlite"], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 0, "last_activity_date": 1494435149, "creation_date": 1494435149, "answer_id": 43898533, "question_id": 43890896, "link": "https://stackoverflow.com/questions/43890896/read-sqlite3-db-data-into-uint64-t/43898533#43898533", "title": "Read sqlite3 db data into uint64_t", "body": "<p>There is no <em>unsigned</em> 64-bit type among <a href=\"http://www.sqlite.org/datatype3.html#storage_classes_and_datatypes\" rel=\"nofollow noreferrer\">SQLite's data types</a>.</p>\n\n<p>To handle values larger than 9223372036854775807, you have to use floating-point numbers (which are not accurate enough to be able to repesent all integers) or strings.</p>\n"}], "owner": {"reputation": 1, "user_id": 3459631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf88fabfe62af737de97c37f951a5be?s=128&d=identicon&r=PG&f=1", "display_name": "user3459631", "link": "https://stackoverflow.com/users/3459631/user3459631"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606772258, "creation_date": 1494414977, "last_edit_date": 1494415947, "question_id": 43890896, "link": "https://stackoverflow.com/questions/43890896/read-sqlite3-db-data-into-uint64-t", "title": "Read sqlite3 db data into uint64_t", "body": "<p>I am very new to sqlite3 and I have question regarding insert and read uint64 data in sqlite3 DB. I am using Sqlite C interface.</p>\n\n<p>While inserting data into sqlite3 DB, as I didn't see any function to bind uint64 data I have used sqlite3_bind_int64. So in DB data will store into signed int64.</p>\n\n<p>I need to read same data into uint64. So query I have passed to sqlite3 to read is like :</p>\n\n<p>\"select ldtolu(length) from tblname\" </p>\n\n<p>Here \"ldtolu\" is an extension in sqlite which call int64_to_uint64, this should read data from DB which is signed int64 and I need to convert this into uint64. I wrote :</p>\n\n<pre><code>static void\nint64_to_uint64(sqlite3_context *context, int argc, sqlite3_value **argv)\n{\n    u_int64_t value;\n    value = (u_int64_t)sqlite3_value_int64(argv[0]);\n    sqlite3_result_int64(context, (sqlite3_int64) (value));\n}\n</code></pre>\n\n<p>Again here too I see only \"sqlite3_result_int64\" there is no function like \"sqlite3_result_uint64\".</p>\n\n<p>Can anyone please help me how to bind uint64 and read same data or how to write extension to read int64 and cast it to uint64.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "struct", "compilation", "warnings", "bit-fields"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1494415354, "post_id": 43890884, "comment_id": 74815911, "body": "fyi g++ 5.1.0 produces the 2 warnings as expected.  2 * <code>warning: overflow in implicit constant conversion [-Woverflow]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494415631, "post_id": 43891107, "comment_id": 74816117, "body": "Thanks for the answer but the question is why I didn&#39;t get both warnings! :)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494415874, "post_id": 43891107, "comment_id": 74816303, "body": "But if this is the case, I would expect 1 to be printed. See, the initial linked question for more please."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1494415649, "last_edit_date": 1494415649, "creation_date": 1494415576, "answer_id": 43891107, "question_id": 43890884, "link": "https://stackoverflow.com/questions/43890884/warning-about-only-one-bitfield-instead-of-both/43891107#43891107", "title": "Warning about only one bitfield, instead of both?", "body": "<p><code>int b:2;</code> is 2 bit width signed integer. Number 2 (unsigned) is represented as <code>10</code> in binary and because source int is signed, you actually get signed number saved to memory.</p>\n\n<p>This is the reason you got this warning.</p>\n\n<p>Values you can save to 2-bit signed int are: <code>(-2 = 11, -1 = 10, 0 = 00, 1 = 01)</code></p>\n\n<p>Reason why you did not get in both cases is that <code>int a:1</code> is only 1 bit and can hold numbers <code>1</code> or <code>0</code>, without negative numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494416088, "post_id": 43891271, "comment_id": 74816443, "body": "When I fix <code>b</code>, I get no warning at all for <code>a</code> . . .But +1 for the idea!"}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1494416336, "post_id": 43891271, "comment_id": 74816617, "body": "Cool.  I would probably put money on gcc having a specialization for a single bit case.  In C++ this is done using partial template specialization, and I <i>think</i> gcc is written in C++."}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1494421251, "post_id": 43891271, "comment_id": 74820536, "body": "I found the source code check for clang here: <a href=\"https://github.com/llvm-mirror/clang/blob/master/lib/Sema/SemaChecking.cpp#L8812\" rel=\"nofollow noreferrer\">github.com/llvm-mirror/clang/blob/master/lib/Sema/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "is_accepted": true, "score": 1, "last_activity_date": 1494422726, "last_edit_date": 1494422726, "creation_date": 1494415969, "answer_id": 43891271, "question_id": 43890884, "link": "https://stackoverflow.com/questions/43890884/warning-about-only-one-bitfield-instead-of-both/43891271#43891271", "title": "Warning about only one bitfield, instead of both?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Two%27s_complement</a></p>\n\n<p>There could be a couple things that are happening, maybe some experiments can help.</p>\n\n<p>First, it could be that gcc is smart enough to know that a single bit can't really be positive or negative because it's just the single bit.</p>\n\n<p>The other possibility is the order in which gcc evaluates a expression is backwards from what you are thinking.  Some compilers evaluate from right to left and in your case, kicked out the error and stopped.</p>\n\n<p>To test, correct the bitfield for b to hold a signed integer for '2' without flipping the sign bit (3 bits should work).  If in fixing 'b' you have generated an error for 'a', then you know it's just the compiler evaluation order.</p>\n\n<p>If fixing 'b' doesn't cause 'a' to kick out a warning, then gcc is performing some internal optimization on a single bit field.</p>\n\n<p>Also, changing your bitfield types to 'uint' should also fix the warnings, in which case it is simply the sign bit of the representation getting flipped.</p>\n\n<p>Happy coding.</p>\n\n<p><strong>EDIT</strong>\nRelevant source code: <a href=\"https://github.com/llvm-mirror/clang/blob/master/lib/Sema/SemaChecking.cpp#L8812\" rel=\"nofollow noreferrer\">https://github.com/llvm-mirror/clang/blob/master/lib/Sema/SemaChecking.cpp#L8812</a></p>\n"}], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 43891271, "answer_count": 2, "score": 1, "last_activity_date": 1494422726, "creation_date": 1494414932, "last_edit_date": 1495540021, "question_id": 43890884, "link": "https://stackoverflow.com/questions/43890884/warning-about-only-one-bitfield-instead-of-both", "title": "Warning about only one bitfield, instead of both?", "body": "<p>Inspired from this <a href=\"https://stackoverflow.com/questions/43889846/why-output-of-the-below-code-is-1-and-2\">question</a>, I have:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct st\n{\n        int a:1;\n        int b:2;\n};\n\nint main()\n{\n        struct st obj={1, 2};\n        printf(\"a = %d\\nb = %d\\n\",obj.a,obj.b);\n}\n</code></pre>\n\n<p>and I get:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nmain.c:10:26: warning: implicit truncation from 'int' to bitfield changes value\n      from 2 to -2 [-Wbitfield-constant-conversion]\n        struct st obj={1, 2};\n                          ^\n1 warning generated.\nGeorgioss-MacBook-Pro:~ gsamaras$ ./a.out \na = -1\nb = -2\n</code></pre>\n\n<p>I think I understand why both bitfields fail to hold their values (as per this <a href=\"https://stackoverflow.com/a/18560011/2411320\">answer</a>), but I don't understand why the compiler warns about <code>2</code> only, instead of <code>1</code> too! Any ideas?</p>\n\n<p>I am using in my Mac:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -v\nConfigured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.1.0 (clang-802.0.38)\nTarget: x86_64-apple-darwin16.3.0\nThread model: posix\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\n</code></pre>\n\n<hr>\n\n<p>In an old Linux system, with gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5), I got no related warning.</p>\n\n<p>In a Debian installation, with gcc version 4.9.2 (Debian 4.9.2-10) , I got no related warning!</p>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1494414570, "post_id": 43890664, "comment_id": 74815314, "body": "What do you thing sizeof(e) is the size of? Hint: it isn&#39;t the size of an element."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1494414834, "post_id": 43890664, "comment_id": 74815490, "body": "In my C coding standard, although the language may allow it, giving the typedef element the same name as the structure is a recipe for confusion and problems - would always use a different name e.g. typedef struct element element_t;"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1494414888, "post_id": 43890664, "comment_id": 74815530, "body": "Have you actually tried running this through a debugger? It&#39;s called debugging."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1494414968, "post_id": 43890664, "comment_id": 74815593, "body": "In Real Life, what is the maximum length of a name or a family name?"}, {"owner": {"reputation": 1940, "user_id": 1251787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2fd207b0ac82e637b82c099e33df1790?s=128&d=identicon&r=PG", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/1251787/mehdi"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1494415251, "post_id": 43890664, "comment_id": 74815839, "body": "lol. It was just for testing @barny"}], "answers": [{"comments": [{"owner": {"reputation": 1940, "user_id": 1251787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2fd207b0ac82e637b82c099e33df1790?s=128&d=identicon&r=PG", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/1251787/mehdi"}, "edited": false, "score": 0, "creation_date": 1494414792, "post_id": 43890763, "comment_id": 74815463, "body": "Thank you of your remark but the problem still same"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1494415254, "post_id": 43890763, "comment_id": 74815842, "body": "Why bother malloc the list? There is only one, and simply declaring a List l; avoids the pain and aggravation and risk of introducing errors that comes with using malloc - to be avoided."}, {"owner": {"reputation": 45, "user_id": 1057043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76dcb8f65489fabdfc54414d8288a64b?s=128&d=identicon&r=PG", "display_name": "vfiskewl", "link": "https://stackoverflow.com/users/1057043/vfiskewl"}, "edited": false, "score": 0, "creation_date": 1494415736, "post_id": 43890763, "comment_id": 74816208, "body": "I like how the guy snatches a solution and presents it as theirs and gets to be the accepted solution."}], "tags": [], "owner": {"reputation": 45, "user_id": 1057043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76dcb8f65489fabdfc54414d8288a64b?s=128&d=identicon&r=PG", "display_name": "vfiskewl", "link": "https://stackoverflow.com/users/1057043/vfiskewl"}, "is_accepted": false, "score": 0, "last_activity_date": 1494415612, "last_edit_date": 1494415612, "creation_date": 1494414633, "answer_id": 43890763, "question_id": 43890664, "link": "https://stackoverflow.com/questions/43890664/list-of-structure-in-c/43890763#43890763", "title": "List of structure in C", "body": "<p>first error is this</p>\n\n<pre><code>struct List *l=malloc(sizeof(l));\n</code></pre>\n\n<p>it should be </p>\n\n<pre><code>struct List *l=malloc(sizeof(struct List));\n</code></pre>\n\n<p>because l is a pointer to a struct and pointers have a fixed size (depending on the architecture and independent of the object they point to)</p>\n\n<p>same error later is actually the source of you problems:</p>\n\n<pre><code>e=malloc(sizeof(e));\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>e=malloc(sizeof(struct element));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1940, "user_id": 1251787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2fd207b0ac82e637b82c099e33df1790?s=128&d=identicon&r=PG", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/1251787/mehdi"}, "edited": false, "score": 0, "creation_date": 1494414986, "post_id": 43890850, "comment_id": 74815607, "body": "Yeeesss ! It was this. Thanks a lot"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1494415058, "post_id": 43890850, "comment_id": 74815657, "body": "Personally I would prefer to leave the OP to figure this sort of thing out for themselves, preferably by breaking the problem down or inspecting it more using a debugger, rather than giving it to him on a plate."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": true, "score": 0, "last_activity_date": 1494415106, "last_edit_date": 1494415106, "creation_date": 1494414849, "answer_id": 43890850, "question_id": 43890664, "link": "https://stackoverflow.com/questions/43890664/list-of-structure-in-c/43890850#43890850", "title": "List of structure in C", "body": "<p>You have to allocate for structure size, not for pointer to structure size.</p>\n\n<p><code>sizeof(l)</code> will return size of pointer to struct, while <code>sizeof(*l)</code> will return size of actual structure where <code>l</code> is type of structure.</p>\n\n<p>Change these parts</p>\n\n<pre><code>struct List *l = malloc(sizeof(l));\ne = malloc(sizeof(e));\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>struct List *l = malloc(sizeof(*l));\ne = malloc(sizeof(*e));\n</code></pre>\n\n<p>You can also do it in a way below but above example is more generic and avoids problems in future.</p>\n\n<pre><code>struct List *l = malloc(sizeof(struct List));\ne = malloc(sizeof(struct element));\n</code></pre>\n"}], "owner": {"reputation": 1940, "user_id": 1251787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2fd207b0ac82e637b82c099e33df1790?s=128&d=identicon&r=PG", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/1251787/mehdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43890850, "answer_count": 2, "score": -1, "last_activity_date": 1494415612, "creation_date": 1494414320, "last_edit_date": 1494414788, "question_id": 43890664, "link": "https://stackoverflow.com/questions/43890664/list-of-structure-in-c", "title": "List of structure in C", "body": "<p>I want to create a list that contain a structure of person following FIFO.\nI create a list with just 2 elements. The problem is when I printing my list. It prints three elements even if I create 2 elements.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\ntypedef struct element element ;\n\nstruct person {\n    char name[25], family[25];\n    int age ;\n};\n\nstruct element {\n    struct person p;\n    element *next ;\n};\n\nstruct List{\n    element *first;\n};\n\nint main()\n{\n    int n=2,i;\n    element *pre, *actuel, *e;\n    struct List *l=malloc(sizeof(l));\n\n    for(i=0;i&lt;n;i++)\n    {\n        e=malloc(sizeof(e));\n        e-&gt;next=NULL;\n        printf(\"give name:\\n\");\n        scanf(\"%s\",e-&gt;p.name);\n        printf(\"give family name:\\n\");\n        scanf(\"%s\",e-&gt;p.family);\n        printf(\"donner l'age :\\n\");\n        scanf(\"%d\",&amp;e-&gt;p.age);\n        if(i==0)\n        {\n            l-&gt;first=e;\n            pre=e;\n        }else{\n            pre-&gt;next=e;\n            pre=e;\n        }\n\n    }\n\n   actuel=l-&gt;first;\n   while(actuel!=NULL)\n   {\n        printf(\"age is : %d \\n\",actuel-&gt;p.age );\n        printf(\"name is : %s \\n\",actuel-&gt;p.name );\n        printf(\"family name is : %s \\n\",actuel-&gt;p.family );\n        actuel=actuel-&gt;next;\n   }\n\n    return 0 ;\n}\n</code></pre>\n\n<p>Where is the problem please ?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "assembly", "arm", "shellcode"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1494416755, "post_id": 43890583, "comment_id": 74816974, "body": "ARM already has PC-relative addressing, and in any case, <code>bl</code> does not push the return address on the stack."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1494416993, "post_id": 43890583, "comment_id": 74817152, "body": "<code>bl</code> is the equivalent, but ARM does not put the return address on the stack. But since ARM has PC relative addressing you don&#39;t need the trick at all."}, {"owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1494417083, "post_id": 43890583, "comment_id": 74817225, "body": "Ah, I understand, thanks!"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1494422731, "post_id": 43890583, "comment_id": 74821747, "body": "since you string is a constant read-only in either case it could be in .text doesnt have to be in .data"}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1531899036, "post_id": 43890583, "comment_id": 89763203, "body": "Here is a nice setup to test this out: <a href=\"https://github.com/cirosantilli/arm-assembly-cheat/tree/e3477c16c8d5a59e239a202760223f4d86e199c9/linux\" rel=\"nofollow noreferrer\">github.com/cirosantilli/arm-assembly-cheat/tree/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 0, "creation_date": 1494417320, "post_id": 43891645, "comment_id": 74817413, "body": "Cool, thanks, this works! Now we just need to figure out how to convert this into shellcode. Any ideas?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 1, "creation_date": 1494417402, "post_id": 43891645, "comment_id": 74817484, "body": "Not sure what you want to convert ... just run it through the assembler and you get the bytes."}, {"owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 0, "creation_date": 1494417565, "post_id": 43891645, "comment_id": 74817614, "body": "We want to extract the shellcode like x04\\xe7\\x06...., and the bytes of the &quot;string .ascii&quot; area are separated from the rest of the bytes. Do I just put them all into a &quot;combined&quot; shellcode to execute it?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 2, "creation_date": 1494417815, "post_id": 43891645, "comment_id": 74817780, "body": "Yes. Not sure what you mean by &quot;separated&quot; they should come directly after the code."}, {"owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 0, "creation_date": 1494417832, "post_id": 43891645, "comment_id": 74817798, "body": "Never mind, I got it ;) Thanks for your help, @Jester!"}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "reply_to_user": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 0, "creation_date": 1494452843, "post_id": 43891645, "comment_id": 74840397, "body": "@Marvin - where you are to get the actual shellcode to work in a separate program?"}, {"owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "reply_to_user": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1494488253, "post_id": 43891645, "comment_id": 74851851, "body": "@InfinitelyManic What do you mean exactly? Are you asking how I am executing the shellcode in another program?"}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "reply_to_user": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "edited": false, "score": 0, "creation_date": 1494509190, "post_id": 43891645, "comment_id": 74866710, "body": "@Marvin, I mean did you copy the Assembly byte code into a C program and successfully execute it?"}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 2, "last_activity_date": 1531898943, "last_edit_date": 1531898943, "creation_date": 1494416935, "answer_id": 43891645, "question_id": 43890583, "link": "https://stackoverflow.com/questions/43890583/hello-world-in-arm-assembly-without-data-section/43891645#43891645", "title": "Hello World in ARM Assembly without data section", "body": "<p>ARM already has PC-relative addressing, and in any case, <code>bl</code> does not push the return address on the stack.</p>\n\n<p>This works:</p>\n\n<pre><code>.global _start\n\n_start:\n    mov r7, #4\n    mov r0, #1\n    adr r1, string\n    mov r2, #12\n    swi 0\n    mov r7, #1\n    swi 0\n\nstring:\n  .ascii \"Hello, World\"\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7981046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d8fff2e2911cbde9f1a37c9d1a68d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/7981046/marvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 2, "accepted_answer_id": 43891645, "answer_count": 1, "score": 3, "last_activity_date": 1531898943, "creation_date": 1494414096, "last_edit_date": 1495541874, "question_id": 43890583, "link": "https://stackoverflow.com/questions/43890583/hello-world-in-arm-assembly-without-data-section", "title": "Hello World in ARM Assembly without data section", "body": "<p>I have a \"Hello, World!\" program in ARM assembly language and I want to convert it into shell code to execute it in a memory region. In Intel Assembly language I got rid of the .data section since only the .text section is being used when converting to shell code. (<a href=\"https://stackoverflow.com/questions/15593214/linux-shellcode-hello-world\">See here</a>)</p>\n\n<p>Now I am struggling to do the same in ARMs assembly language. The basis is the following code:</p>\n\n<p><strong>ARM Assembly Hello World</strong></p>\n\n<pre><code>.global _start\n\n_start:\n    mov r7, #4\n    mov r0, #1\n    ldr r1,=string\n    mov r2, #12\n    swi 0\n    mov r7, #1\n    swi 0\n\n.data\nstring:\n  .ascii \"Hello, World\"\n</code></pre>\n\n<p><strong>Modified ARM Assembly Hello World to omit the .data section</strong></p>\n\n<pre><code>.global _start\n.global mymessage\n\nmymessage:\n    mov r7, #4\n    mov r0, #1\n    pop {r1}\n    mov r2, #12\n    swi 0\n    mov r7, #1\n    swi 0\n\n_start:\n    bl mymessage\n    .ascii \"Hello, World\"\n</code></pre>\n\n<p>But this doesn't work, since this is an \"<em>illegal instruction</em>\" apparently. Any ideas?</p>\n"}, {"tags": ["c", "scope"], "comments": [{"owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "edited": false, "score": 2, "creation_date": 1494414215, "post_id": 43890577, "comment_id": 74815040, "body": "The first <code>i = i + 1</code> increments the outer <code>i</code>, so the second <code>if</code> is never entered."}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "edited": false, "score": 0, "creation_date": 1494414234, "post_id": 43890577, "comment_id": 74815059, "body": "Which line you expect should print 7? Maybe you missed one more <code>printf(&quot;%d\\n&quot;, i);</code> after second <code>i = i + 1;</code>?"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1494414302, "post_id": 43890577, "comment_id": 74815110, "body": "You only have three printfs so you can&#39;t expect four numbers to be printed. And it&#39;s YOUR code, YOU can debug it. Hint: use a debugger!"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1494417609, "post_id": 43890577, "comment_id": 74817640, "body": "Probably you have warning messages from the compiler - don&#39;t ignore them!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "edited": false, "score": 0, "creation_date": 1494428486, "post_id": 43890633, "comment_id": 74826436, "body": "OMG THANK YOU, now i know where is the wrong haha and finally understand~ but why the &quot;Other scope&quot; cannot output the number of 3 ?    Cus the &quot;Other Scope&quot; now is outer scope already right ? so it should print 3 ?"}, {"owner": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "edited": false, "score": 0, "creation_date": 1494428516, "post_id": 43890633, "comment_id": 74826461, "body": "int main () and int main (void) are different ? void means nothing right ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "edited": false, "score": 0, "creation_date": 1494436601, "post_id": 43890633, "comment_id": 74831659, "body": "@ThomasLeong it outputs <code>3</code>, as you said...<code>3</code> (from outer) and <code>6</code> (from inner), right?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "edited": false, "score": 0, "creation_date": 1494436667, "post_id": 43890633, "comment_id": 74831692, "body": "@ThomasLeong no, they are not the same, at least not in this case. <code>()</code> means no constraint on number/type of args, but <code>(void)</code> means explicitly none."}, {"owner": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "edited": false, "score": 0, "creation_date": 1494502658, "post_id": 43890633, "comment_id": 74861706, "body": "Now lets say the code have 3 printf.   The First print output 3,  the second print output 6, and the Third print nothing ? @@"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 9, "last_activity_date": 1494415045, "last_edit_date": 1494415045, "creation_date": 1494414216, "answer_id": 43890633, "question_id": 43890577, "link": "https://stackoverflow.com/questions/43890577/scope-in-c-programming-global-and-local-variable/43890633#43890633", "title": "Scope in C programming (Global and local variable)", "body": "<p>Nothing here <em>\"disappears\"</em>, this happens because, the inner scope takes precedence over the outer scope for identifiers with overlapping scope.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.2.1 (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>[...] If an identifier designates two different entities in the same name\n  space, the scopes might overlap. If so, the scope of one entity (the inner scope) will end\n  strictly before the scope of the other entity (the outer scope). <strong>Within the inner scope, the\n  identifier designates the entity declared in the inner scope; the entity declared in the outer\n  scope is hidden (and not visible) within the inner scope.</strong></p>\n</blockquote>\n\n<p>So, in your case, (<em>follow the comments</em>)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {   //note the correct signature\n    int i = 3;            //outer scope of i\n    printf(\"%d\\n\", i);\n    if (i == 3) {\n        i = i + 1;         //this happens in \"outer\" scope, i value changed...\n        //---------------------&gt;     |-----inner scope starts, outer scope gets hidden\n        int i = 6;                // |\n        printf(\"%d\\n\", i);        // |\n        i = i + 1;                // |\n    }//------------------------&gt;     |-----inner scope ends, outer scope resumes\n\n    if (i == 3) {                 // hey. look , other scope is back!!!\n        printf(\"%d\\n\", i); \n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 478, "user_id": 7989544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RCpdI.jpg?s=128&g=1", "display_name": "Biswajit Roy", "link": "https://stackoverflow.com/users/7989544/biswajit-roy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419607, "creation_date": 1494419607, "answer_id": 43892645, "question_id": 43890577, "link": "https://stackoverflow.com/questions/43890577/scope-in-c-programming-global-and-local-variable/43892645#43892645", "title": "Scope in C programming (Global and local variable)", "body": "<p>The output is so because the local variables have a greater preference over the global variables or variables declared not in the same scope. Each time you initialize an existing variable with a value in a scope, the value becomes dominant in its scope. This similar situation in java is referred to as \"Namespace Collision\".\nIt is to be noted here that the c complier allows auto storage class as default storage class which allows you to initialize again.I am referring to int i=6. However, using static storage class won't allow you to initialize the same variable again !</p>\n"}], "owner": {"reputation": 21, "user_id": 7703952, "user_type": "registered", "profile_image": "https://graph.facebook.com/1395280980492307/picture?type=large", "display_name": "Thomas Leong", "link": "https://stackoverflow.com/users/7703952/thomas-leong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1494419607, "creation_date": 1494414074, "last_edit_date": 1494414567, "question_id": 43890577, "link": "https://stackoverflow.com/questions/43890577/scope-in-c-programming-global-and-local-variable", "title": "Scope in C programming (Global and local variable)", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main () {\n    int i = 3; \n    printf(\"%d\\n\", i);\n    if (i == 3) {\n        i = i + 1;\n        int i = 6; \n        printf(\"%d\\n\", i);\n        i = i + 1;\n    }\n\n    if (i == 3) {\n        printf(\"%d\\n\", i); \n    }\n    return 0;\n}\n</code></pre>\n\n<p>My Question is Why the 4 and 7 disappear? </p>\n\n<p>When I run the code they only print the output 3 and 6 ? </p>\n"}, {"tags": ["c", "string", "header"], "comments": [{"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1494414122, "post_id": 43890563, "comment_id": 74814962, "body": "<code>char</code> is  not a string (not to mention that to return a string literal as <code>char*</code> isn&#39;t a great idea for other reasons...)"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 7902532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87dbc7fbea473c258865df5288708a0?s=128&d=identicon&r=PG", "display_name": "cheemcheem", "link": "https://stackoverflow.com/users/7902532/cheemcheem"}, "is_accepted": false, "score": 0, "last_activity_date": 1494417589, "last_edit_date": 1494417589, "creation_date": 1494417214, "answer_id": 43891749, "question_id": 43890563, "link": "https://stackoverflow.com/questions/43890563/header-file-in-c-for-the-functions-with-strings/43891749#43891749", "title": "Header file in C for the functions with strings", "body": "<p>\"char test(void);\" \nshould be:\n\"char* test(void);</p>\n\n<p>\"char z\"\nshould be:\n\"char* z\"</p>\n\n<p>You are returning a char array (technically a pointer to the start of the array) from test() not a single char.</p>\n\n<p><strong>Edit just compiled and it works</strong></p>\n\n<pre><code>#ifndef TEST_H_\n#define TEST_H_\n\nchar* test(void);\n\n#endif\n</code></pre>\n\n<p>is the new test.h</p>\n\n<pre><code> #include \"test.h\"\n\n  char* test(void)\n {\n   return \"abcd\";\n }\n</code></pre>\n\n<p>is the new test.c file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nint main(){\n\n   char* z = test();\n   printf(\"%s\\n\",z);\n   return 0;\n  }\n</code></pre>\n\n<p>is the new main.c file.</p>\n"}], "owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494417589, "creation_date": 1494414041, "question_id": 43890563, "link": "https://stackoverflow.com/questions/43890563/header-file-in-c-for-the-functions-with-strings", "title": "Header file in C for the functions with strings", "body": "<p>main.c is my piece of code that takes the header file test.h and my test.h and test.c files as follows. I am not able to compile and execute this. Where am I going wrong?</p>\n\n<pre><code>#ifndef TEST_H_\n#define TEST_H_\n\nchar test(void);\n\n#endif\n</code></pre>\n\n<p>is my test.h</p>\n\n<pre><code> #include \"test.h\"\n\n  char test(void)\n {\n   return \"abcd\";\n }\n</code></pre>\n\n<p>is my test.c file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nint main(){\n\n   char z = test();\n   printf(\"%s\\n\",z);\n   return 0;\n  }\n</code></pre>\n\n<p>is my main.c file.</p>\n"}, {"tags": ["c", "sqlite", "c-preprocessor"], "comments": [{"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "edited": false, "score": 1, "creation_date": 1494423702, "post_id": 43890560, "comment_id": 74822542, "body": "Your CREATE TABLE query is invalid. Try something like this: CREATE TABLE &#39;mytable&#39;(&#39;id&#39; INTEGER); You need at least one field in the table"}, {"owner": {"reputation": 321, "user_id": 3076306, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fccfq.jpg?s=128&g=1", "display_name": "TheAlPaca02", "link": "https://stackoverflow.com/users/3076306/thealpaca02"}, "reply_to_user": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "edited": false, "score": 0, "creation_date": 1494424128, "post_id": 43890560, "comment_id": 74822871, "body": "Ah yes, I added several fields and both the table and the database have been created now. This solved the problem, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 3076306, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fccfq.jpg?s=128&g=1", "display_name": "TheAlPaca02", "link": "https://stackoverflow.com/users/3076306/thealpaca02"}, "is_accepted": true, "score": 0, "last_activity_date": 1494427252, "last_edit_date": 1495541407, "creation_date": 1494426355, "answer_id": 43895334, "question_id": 43890560, "link": "https://stackoverflow.com/questions/43890560/c-sqlite3-variable-database-table-naming-sql-syntax-error/43895334#43895334", "title": "C &amp; Sqlite3 - Variable database &amp; table naming - SQL Syntax error", "body": "<p>To turn @Simone Cifani 's comment into a valid answer. The problem was that my CREATE TABLE query was invalid as I did not add any fields to the table. Following solution solved the problem.</p>\n\n<p>Note that I also swapped the sprintf function for the asprintf function, which I highly suggest you read up on if you are planning to do anything similar to this. <a href=\"https://stackoverflow.com/questions/12746885/why-use-asprintf\">This thread</a> explains the working of the asprintf function and the difference with the sprintf function very clearly.</p>\n\n<pre><code>#define _GNU_SOURCE \n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sqlite3.h&gt;\n\n#define REAL_TO_STRING(s) #s\n#define TO_STRING(s) REAL_TO_STRING(s)   \n\n#ifndef DB_NAME\n  #define DB_NAME Sensor.db\n#endif\n\n#ifndef TABLE_NAME\n  #define TABLE_NAME SensorData\n#endif\n\n#define DBCONN sqlite3 \n\nint main()\n{\n\n    char *err_msg = 0;\n    DBCONN * db;\n    int rc = sqlite3_open(TO_STRING(DB_NAME), &amp;db);\n\n    if(rc != SQLITE_OK)\n    {\n        fprintf(stderr,\"Cannot open database: %s\\n\",sqlite3_errmsg(db));\n        sqlite3_close(db);\n        return 0;\n    }\n\n    char * sql;\n    int size = 0;\n\n    size  = asprintf(&amp;sql,\"CREATE TABLE %s (id INT, value REAL, ts INT);\", TO_STRING(TABLE_NAME));\n\n    if(size == -1)\n        printf(\"asprintf failed in main\\n\");\n\n    rc = sqlite3_exec(db, sql, 0, 0, &amp;err_msg);\n\n    if (rc != SQLITE_OK ){\n\n      fprintf(stderr, \"SQL error: %s\\n\", err_msg);\n      sqlite3_free(err_msg);        \n      sqlite3_close(db);\n      free(sql);\n      return 0;\n  }\n\n    free(sql);\n    sqlite3_close(db);\n    return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3076306, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fccfq.jpg?s=128&g=1", "display_name": "TheAlPaca02", "link": "https://stackoverflow.com/users/3076306/thealpaca02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 43895334, "answer_count": 1, "score": 0, "last_activity_date": 1494427252, "creation_date": 1494414038, "last_edit_date": 1494423071, "question_id": 43890560, "link": "https://stackoverflow.com/questions/43890560/c-sqlite3-variable-database-table-naming-sql-syntax-error", "title": "C &amp; Sqlite3 - Variable database &amp; table naming - SQL Syntax error", "body": "<p>I'm trying to write some code that initializes an sql database and table with the name of the database &amp; table set through preprocessor commands and if not set, defaulting to the values given below.</p>\n\n<p>I'm using a macro to stringify whatever name is given. The sqlite3_open correctly opens / creates the database with the given name or the default</p>\n\n<pre><code>sqlite3_open(TO_STRING(DB_NAME), &amp;db);\n</code></pre>\n\n<p>For the creation of  the table I'm relying on sprintf.</p>\n\n<pre><code>sprintf(str,\"CREATE TABLE %s;\", TO_STRING(TABLE_NAME));\nsql = str;\n</code></pre>\n\n<p>When inspecting my code in debugging, pointer sql seems to be having the correct value of \"CREATE TABLE SensorData;\". However when I try to execute my code I get the error <strong><em>\"SQL error: near \";\": syntax error\"</em></strong>. Upon inspection it is clear that the error code 110 is returned by the function, I can't seem to find any information on this code however.</p>\n\n<p>I can't seem to figure out what the exact problem is in this case, as the string resulting in the array str seems to be exactly the same as when I create the table in a static way.</p>\n\n<p>This is all my code relevant to the problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sqlite3.h&gt;\n\n#define REAL_TO_STRING(s) #s\n#define TO_STRING(s) REAL_TO_STRING(s)   \n\n#ifndef DB_NAME\n  #define DB_NAME Sensor.db\n#endif\n\n#ifndef TABLE_NAME\n  #define TABLE_NAME SensorData\n#endif\n\n#define DBCONN sqlite3 \n\nint main()\n{\n\n    char *err_msg = 0;\n    DBCONN * db;\n    int ok = sqlite3_open(TO_STRING(DB_NAME), &amp;db);\n\n\n    if(ok != SQLITE_OK)\n    {\n        fprintf(stderr,\"Cannot open database: %s\\n\",sqlite3_errmsg(db));\n        sqlite3_close(db);\n        return 0;\n    }\n\n    char * sql;\n    char str[100];\n    //clear array\n    memset(&amp;str[0],0,100);  \n\n    sprintf(str,\"CREATE TABLE %s;\", TO_STRING(TABLE_NAME));\n    sql = str;\n\n    ok = sqlite3_exec(db, sql, 0, 0, &amp;err_msg);\n\n    if (ok != SQLITE_OK ){\n\n      fprintf(stderr, \"SQL error: %s\\n\", err_msg);\n\n      sqlite3_free(err_msg);        \n      sqlite3_close(db);\n\n      return 0;\n  }\n\n    sqlite3_close(db);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "url", "filtering", "blacklist"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1494413145, "post_id": 43890173, "comment_id": 74814211, "body": "Build a balanced binary tree of the keywords and search that. 5000 keywords isn&#39;t too much for an in-memory data structure."}, {"owner": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1494414253, "post_id": 43890173, "comment_id": 74815076, "body": "Thanks Paul. It is 50 000 and it will increase in time. This will be a like a backward search. Lets say my url is www.selldrugs.com. I have a list of keywords which has drug in it. I have to get the keywords one by one and then call doesUrlContainsKeyword() method. If the keyword is 50 000th keyword, then it is a problem."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1494418141, "post_id": 43890173, "comment_id": 74818027, "body": "50.000 keywords still shouldn&#39;t be a problem for an in-memory data structure on a 64-bit machine."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "edited": false, "score": 0, "creation_date": 1494414435, "post_id": 43890604, "comment_id": 74815209, "body": "Thanks Andriy. If I a url contains 2000 characters, I have to create keyword combinations with 2000 characters. Wouldn&#39;t that cost much?"}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "edited": false, "score": 0, "creation_date": 1494421571, "post_id": 43890604, "comment_id": 74820784, "body": "Sure, you need keyword separators to split URL efficiently. IMO it makes sense for the filtration, since sex and unisex might have quite different meaning. But sure, it is up to you and it is just my 2 cents..."}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1494414155, "creation_date": 1494414155, "answer_id": 43890604, "question_id": 43890173, "link": "https://stackoverflow.com/questions/43890173/efficient-way-of-filtering-urls-by-looking-through-keyword-list/43890604#43890604", "title": "Efficient Way of Filtering URLs by looking through keyword list", "body": "<blockquote>\n  <ol start=\"2\">\n  <li>Check whether the keyword is in the url\n  [...]\n  Is there an efficient way to do this?</li>\n  </ol>\n</blockquote>\n\n<p>The vice versa will be much more efficient: split the URL onto the keywords and lookup them in the database.</p>\n\n<p>To speed up the database lookup, you can use a variety of methods. For example, sort the database and do a binary search, use a trie structure, hash table, etc etc.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "edited": false, "score": 0, "creation_date": 1494508486, "post_id": 43891395, "comment_id": 74866114, "body": "Thank you Marcin. This was exactly what I was looking for."}], "tags": [], "owner": {"reputation": 396, "user_id": 6554862, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c451fea2abf89a2c625404fe5cb0774b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin", "link": "https://stackoverflow.com/users/6554862/marcin"}, "is_accepted": false, "score": 2, "last_activity_date": 1494416284, "creation_date": 1494416284, "answer_id": 43891395, "question_id": 43890173, "link": "https://stackoverflow.com/questions/43890173/efficient-way-of-filtering-urls-by-looking-through-keyword-list/43891395#43891395", "title": "Efficient Way of Filtering URLs by looking through keyword list", "body": "<p>The problem is multi pattern search and can be effectively solved with Aho-Coracisk algorithm. This algorithm searches a set of strings simultaneously. The complexity of the algorithm is linear in the length of the keyowords plus the length of the URL plus the number of output matches.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "is_accepted": false, "score": 0, "last_activity_date": 1494592786, "creation_date": 1494592786, "answer_id": 43938014, "question_id": 43890173, "link": "https://stackoverflow.com/questions/43890173/efficient-way-of-filtering-urls-by-looking-through-keyword-list/43938014#43938014", "title": "Efficient Way of Filtering URLs by looking through keyword list", "body": "<p>Aho-Corasick algorithm is the best solution for this problem.\nHere is the python implementation <a href=\"https://github.com/WojciechMula/pyahocorasick/\" rel=\"nofollow noreferrer\">Aho-Corasick</a></p>\n\n<p>Below is a code sample</p>\n\n<pre><code>import ahocorasick  \nA = ahocorasick.Automaton()  \nfor index, word in enumerate('asim sinan yuksel uksel sel sina sim asi as nan an in ina uks .com .co www. http//'.split()):  \n   A.add_word(word, (index, word))\nA.make_automaton()  \nfor item in A.iter('http://wwww.asimsinanyuksel.com'):  \n   print(item)  \n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1430739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0380f1aef78cd19cd6790bd8e0bcbd3a?s=128&d=identicon&r=PG", "display_name": "As\u0131m Sinan Y&#252;ksel", "link": "https://stackoverflow.com/users/1430739/as%c4%b1m-sinan-y%c3%bcksel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1494592786, "creation_date": 1494413035, "question_id": 43890173, "link": "https://stackoverflow.com/questions/43890173/efficient-way-of-filtering-urls-by-looking-through-keyword-list", "title": "Efficient Way of Filtering URLs by looking through keyword list", "body": "<p>What is the best way to filter urls by comparing where a keyword is inside the url or not?\nI have a list of keywords (a kind of blacklist) which contains 50000 words. \nThe search method uses the following steps:</p>\n\n<p>While (end of keywords)\n 1. Get the keyword from database\n 2. Check whether the keyword is in the url\n 3. Redirect the user to a specific page.</p>\n\n<p>When I use this method, the cpu usage becomes  around %90. Is there an efficient way to do this? It seems that I can't use regex, since the keyword always changes. </p>\n"}, {"tags": ["c", "function", "linked-list"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1494415615, "post_id": 43890168, "comment_id": 74816099, "body": "Instead of creating a new node, you should use the existing odd node to save to the odd chain. In the current code it will be lost. (<i>leaked</i>)"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 7988020, "user_type": "registered", "profile_image": "https://graph.facebook.com/1832400533644274/picture?type=large", "display_name": "Manikandan Kbk", "link": "https://stackoverflow.com/users/7988020/manikandan-kbk"}, "is_accepted": false, "score": 0, "last_activity_date": 1494413167, "creation_date": 1494413167, "answer_id": 43890214, "question_id": 43890168, "link": "https://stackoverflow.com/questions/43890168/i-am-trying-to-write-a-function-that-removes-all-the-odd-elements-from-a-given-l/43890214#43890214", "title": "I am trying to write a function that removes all the odd elements from a given linked-list and also returns", "body": "<p>Create a separate linkedlist and on removing every odd element, insert that particular element to that LL. Also have the head reference of the new LL and return it. It will be a LL of entire removed odd elements.</p>\n"}], "owner": {"reputation": 15, "user_id": 4380896, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b6911a07e8bec0289c343656d06f5c86?s=128&d=identicon&r=PG&f=1", "display_name": "Gal1988", "link": "https://stackoverflow.com/users/4380896/gal1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494413167, "creation_date": 1494413016, "question_id": 43890168, "link": "https://stackoverflow.com/questions/43890168/i-am-trying-to-write-a-function-that-removes-all-the-odd-elements-from-a-given-l", "title": "I am trying to write a function that removes all the odd elements from a given linked-list and also returns", "body": "<p>an adress of a new list of the odd elements removed. I find this task quite complicated, and I would be happy if you could help to repair or improve my code.</p>\n\n<p>Here is what I've done by far:</p>\n\n<pre><code>typedef struct list{\n      int data;\n      struct  list* next;\n} List;\n\n\nList* removeOddValues(List** source)\n{\n      List* curr= *source;\n      List* prev;\n      List* odd= NULL;\n\n      while (curr)\n      {\n        if ((curr-&gt;data)%2==1)  //odd//\n          {\n           insertNodeToEnd(&amp;odd, curr-&gt;data); //creating a new list of those odd elements//\n           prev-&gt;next = curr-&gt;next;\n          }\n        else\n          {\n           prev = curr;\n           curr= curr-&gt;next;\n          }\n      }\n     return odd;   //returning the new list as wanted//\n}\n\nList* createNewNode(int newData, List*  next)\n{\n       List* newNode = (List)calloc(1, sizeof(List));\n       newNode-&gt;data = newData;\n       newNode-&gt;next = next;\n\n       return newNode;\n}\n\nvoid insertNodeToEnd(List** list, type  newData) //insert a new node to list //\n{\n       LNode* newNode = createNewNode(newData, NULL);\n\n    list-&gt;next= newNode;\n</code></pre>\n"}, {"tags": ["c", "gcc", "enums", "arm", "ld"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "edited": false, "score": 0, "creation_date": 1494413029, "post_id": 43890117, "comment_id": 74814128, "body": "Why do you need 32-bit enums?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "edited": false, "score": 0, "creation_date": 1494413146, "post_id": 43890117, "comment_id": 74814212, "body": "Maybe you should add some flags to linker, and use short enums for all objects."}, {"owner": {"reputation": 131, "user_id": 1702503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354ab5bbf31c36ebfd28bfa274ffefe3?s=128&d=identicon&r=PG", "display_name": "Schlumpf", "link": "https://stackoverflow.com/users/1702503/schlumpf"}, "edited": false, "score": 0, "creation_date": 1494413160, "post_id": 43890117, "comment_id": 74814222, "body": "I need it for compatibility to software parts on other platforms/processors. I definitely need 32-bit enums."}, {"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "edited": false, "score": 0, "creation_date": 1494415493, "post_id": 43890117, "comment_id": 74816018, "body": "What kind of compatibility? Networking?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "edited": false, "score": 0, "creation_date": 1494415689, "post_id": 43890117, "comment_id": 74816165, "body": "Btw, don&#39;t you use some other libraries? Show the full build log :)"}], "answers": [{"comments": [{"owner": {"reputation": 4270, "user_id": 26074, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0fe832e8f56443852c5360f14c0b2bac?s=128&d=identicon&r=PG", "display_name": "calandoa", "link": "https://stackoverflow.com/users/26074/calandoa"}, "edited": false, "score": 0, "creation_date": 1610561370, "post_id": 46701347, "comment_id": 116175818, "body": "No, on ARM, gcc will use by default the smallest enum size depending on the values to store. Check <i>4.9 Structures, Unions, Enumerations, and Bit-Fields</i> in gcc doc."}], "tags": [], "owner": {"reputation": 178, "user_id": 5495173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9cMwC.jpg?s=128&g=1", "display_name": "Rod Dewell", "link": "https://stackoverflow.com/users/5495173/rod-dewell"}, "is_accepted": false, "score": 2, "last_activity_date": 1507781936, "creation_date": 1507781936, "answer_id": 46701347, "question_id": 43890117, "link": "https://stackoverflow.com/questions/43890117/enforce-32-bit-enums-with-gcc-linker/46701347#46701347", "title": "Enforce 32-bit enums with GCC linker", "body": "<p>I have a partial answer as I had the same question.  The problem is a warning message from the linker that will appear with the use of -fno-short-enums.  The message indicates that the target object is not compatible.  So I spent a world of time looking for now to change the target to be compatible.</p>\n\n<p>But that wasn't the problem.  The gcc compiler will build 32-bit enums by default!!  So this option is no necessary unless you DONT want 32-bit enums.  However, if you do specify the -fno-short-enums you will receive the warning message.  Unfortunately I don't know why.</p>\n\n<p>So the bottom line is that the no-short-enums flag is not necessary to achieve 32-bit enums.  If you do specify it then you will receive the warning message.</p>\n"}, {"comments": [{"owner": {"reputation": 416, "user_id": 1121645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3955996cd2f7cac253895badff34fc7?s=128&d=identicon&r=PG", "display_name": "Tejas Kale", "link": "https://stackoverflow.com/users/1121645/tejas-kale"}, "edited": false, "score": 0, "creation_date": 1560792889, "post_id": 49629524, "comment_id": 99843681, "body": "Should be <code>-Xlinker</code> (With the lowercase <code>l</code>). <code>arm-none-eabi-g++: error: unrecognized command line option &#39;-XLinker&#39;; did you mean &#39;-Xlinker&#39;?</code>"}], "tags": [], "owner": {"reputation": 131, "user_id": 1702503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354ab5bbf31c36ebfd28bfa274ffefe3?s=128&d=identicon&r=PG", "display_name": "Schlumpf", "link": "https://stackoverflow.com/users/1702503/schlumpf"}, "is_accepted": true, "score": 1, "last_activity_date": 1560931150, "last_edit_date": 1560931150, "creation_date": 1522756664, "answer_id": 49629524, "question_id": 43890117, "link": "https://stackoverflow.com/questions/43890117/enforce-32-bit-enums-with-gcc-linker/49629524#49629524", "title": "Enforce 32-bit enums with GCC linker", "body": "<p>After a while I got it working.\nI rebuilt the whole toolchain including the compiler with this flag. Here is the way I did:</p>\n\n<ol>\n<li><p>Get the toolchain <strong>source</strong> from <a href=\"https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads\" rel=\"nofollow noreferrer\">https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads</a></p></li>\n<li><p>Add 3 lines to some sections of the buildscript <code>build-toolchain.sh</code>:</p>\n\n<pre><code>saveenv\nsaveenvvar CFLAGS_FOR_TARGET '-fno-short-enums'\n  [...build commands...]\nrestoreenv\n</code></pre>\n\n<p>Modified sections:</p>\n\n<ul>\n<li><code>Task [III-1] /$HOST_NATIVE/gcc-first/</code></li>\n<li><code>Task [III-2] /$HOST_NATIVE/newlib/</code></li>\n<li><code>Task [III-4] /$HOST_NATIVE/gcc-final/</code></li>\n<li><code>Task [IV-3] /$HOST_MINGW/gcc-final/</code></li>\n</ul>\n\n<p>I Skipped building <code>newlib-nano</code> and <code>gcc-size-libstdcxx</code>.</p></li>\n<li><p>Run the modified Scripts <code>build-prerequisites.sh</code> and <code>build-toolchain.sh</code> to build everything.</p></li>\n</ol>\n\n<hr>\n\n<p>After that, the compiler is using the large-enum-mode and the linker is fine with my objects. But now, I get the opposit warning for some objects of the newlib (<code>lib_a-mbtowc_r.o</code>, <code>lib_a-svfiprintf.o</code>, <code>lib_a-svfprintf.o</code>, <code>lib_a-vfprintf.o</code> and <code>lib_a-vfiprintf.o</code>):</p>\n\n<pre><code>c:/gcc-arm-none-eabi/bin/../lib/gcc/arm-none-eabi/6.2.1/../../../../arm-none-eabi/bin/ld.exe: warning: c:/gcc-arm-none-eabi/bin/../lib/gcc/arm-none-eabi/6.2.1/../../../../arm-none-eabi/lib\\libc.a(lib_a-mbtowc_r.o) uses variable-size enums yet the output is to use 32-bit enums; use of enum values across objects may fail\n</code></pre>\n\n<p>I looked into the makefiles of these object and they are explicitly set to variable-size-enums, sadly. The only \"solution\" for this, was to add a linker flag to mute this warning:</p>\n\n<pre><code>-Xlinker -no-enum-size-warning\n</code></pre>\n\n<p>That's it.</p>\n"}], "owner": {"reputation": 131, "user_id": 1702503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354ab5bbf31c36ebfd28bfa274ffefe3?s=128&d=identicon&r=PG", "display_name": "Schlumpf", "link": "https://stackoverflow.com/users/1702503/schlumpf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4316, "favorite_count": 1, "accepted_answer_id": 49629524, "answer_count": 2, "score": 4, "last_activity_date": 1560931150, "creation_date": 1494412880, "question_id": 43890117, "link": "https://stackoverflow.com/questions/43890117/enforce-32-bit-enums-with-gcc-linker", "title": "Enforce 32-bit enums with GCC linker", "body": "<p>I'm writing a bare metal application for an ARM device (no OS). I need 32-bit enums, so I compiled the application with the <code>-fno-short-enums</code> compiler flag. Without this flag, I get variable enums (and enforcing the size by adding an additional <code>0xFFFFFFFF</code> value to each enum is not an option).</p>\n\n<p>Now I get the following linker warning for every object:</p>\n\n<pre><code>c:/gcc-arm-none-eabi/bin/../lib/gcc/arm-none-eabi/6.2.1/../../../../arm-none-eabi/bin/ld.exe: warning: ./src/test.o uses 32-bit enums yet the output is to use variable-size enums; use of enum values across objects may fail\n</code></pre>\n\n<p>It's just a warning, no error. But what does it mean exactly? How can I specify the \"output\"?</p>\n\n<p>I tried to recompile the newlib with the above flag to ensure that all objects use the same enum size, but I'm still getting the warning. Is there something I missed?</p>\n"}, {"tags": ["c", "struct", "bit-fields"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494412192, "post_id": 43889846, "comment_id": 74813564, "body": "you get the answer as <code>-1 and -2</code> or <code>-1 and 2</code>?"}, {"owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494412243, "post_id": 43889846, "comment_id": 74813595, "body": "@SouravGhosh -1 and -2 Sir"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1494412268, "post_id": 43889846, "comment_id": 74813608, "body": "&quot;It should be 1 and 2, Right?&quot; No, why do you think it should be like that?"}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "edited": false, "score": 0, "creation_date": 1494412583, "post_id": 43889915, "comment_id": 74813804, "body": "You are welcome @Chirag, I updated my answer with a working struct, hope this will be enough for acceptance! :)"}, {"owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "edited": false, "score": 0, "creation_date": 1494412854, "post_id": 43889915, "comment_id": 74814007, "body": "Yes, I am very much clear with this concept, Thanks for the help"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1494414408, "last_edit_date": 1495541439, "creation_date": 1494412252, "answer_id": 43889915, "question_id": 43889846, "link": "https://stackoverflow.com/questions/43889846/why-output-of-the-below-code-is-1-and-2/43889915#43889915", "title": "Why output of the below code is -1 and -2?", "body": "<p>Compile with all the warnings enabled, and read what your compiler says:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nmain.c:7:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nmain()\n^\nmain.c:9:26: warning: implicit truncation from 'int' to bitfield changes value\n      from 2 to -2 [-Wbitfield-constant-conversion]\n        struct st obj={1,2};\n                         ^\nmain.c:11:40: warning: format specifies type 'int' but the argument has type\n      'unsigned long' [-Wformat]\n        printf(\"Size of struct = %d\\n\",sizeof(obj));\n                                 ~~    ^~~~~~~~~~~\n                                 %lu\n3 warnings generated.\n</code></pre>\n\n<p>Recall, that </p>\n\n<blockquote>\n  <p>a signed 1 bit variable can hold only two values, -1 and 0</p>\n</blockquote>\n\n<p>as you can see in this <a href=\"https://stackoverflow.com/questions/43452788/struct-variable-doesnt-changed-by-assignment\">answer</a>.</p>\n\n<p>So if you use this struct instead:</p>\n\n<pre><code>struct st\n{\n        int a:2;\n        int b:3;\n};\n</code></pre>\n\n<p>you will get the desired output.</p>\n\n<hr>\n\n<p>This <a href=\"https://stackoverflow.com/a/18560011/2411320\">answer</a> gives a nice explanation as well.</p>\n"}], "owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "closed_date": 1494412250, "accepted_answer_id": 43889915, "answer_count": 1, "score": 0, "last_activity_date": 1494414977, "creation_date": 1494412072, "last_edit_date": 1494414977, "question_id": 43889846, "link": "https://stackoverflow.com/questions/43889846/why-output-of-the-below-code-is-1-and-2", "closed_reason": "Duplicate", "title": "Why output of the below code is -1 and -2?", "body": "<p>Why output of the below code is -1 and -2, It should be 1 and 2, Right?</p>\n\n<p>Also on a 64 bit server size of the below structure is 4 Bytes, It should be 8 Bytes right?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct st\n{\n        int a:1;\n        int b:2;\n};\nmain()\n{\n        struct st obj={1,2};\n        printf(\"a = %d\\nb = %d\\n\",obj.a,obj.b);\n        printf(\"Size of struct = %d\\n\",sizeof(obj));\n}\n</code></pre>\n"}, {"tags": ["php", "c", "linux", "daemon"], "comments": [{"owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494572576, "post_id": 43889483, "comment_id": 74895164, "body": "I have tracked the problem to a difference in block masks between the two cases. I have created a new thread for the question <a href=\"http://stackoverflow.com/questions/43931229/setting-up-signal-masks-in-a-linux-c-daemon\">here</a>"}, {"owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494836648, "post_id": 43889483, "comment_id": 74978835, "body": "This issue has now been solved. See link in comment above."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "edited": false, "score": 0, "creation_date": 1494414381, "post_id": 43890569, "comment_id": 74815175, "body": "you can try with <code>pkill process</code> as well, which does not require the <code>&lt;pid&gt;</code>, it uses the name of the process instead"}, {"owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494418131, "post_id": 43890569, "comment_id": 74818017, "body": "You statement in the first sentence is correct, but why does kill work when the daemon is started from the command line, but not if it is started in another way. I could not find any clues in the provided thread either."}, {"owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "reply_to_user": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494420521, "post_id": 43890569, "comment_id": 74819882, "body": "@Marius I am just making assumptions here but If the process you are trying to kill is a parent process then you can use the <code>-P</code> argument. Like this <code>pkill  -P &lt;pid&gt;</code>"}, {"owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "reply_to_user": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494420751, "post_id": 43890569, "comment_id": 74820080, "body": "This will kill all processes that have the parent process ID"}, {"owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "reply_to_user": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "edited": false, "score": 0, "creation_date": 1494422335, "post_id": 43890569, "comment_id": 74821443, "body": "@Marius There are 4 commands that can kill a process, have you tried them all? If your script is creating multiple processes killing just one process will not do the trick. You have to find a way to kill all parent-child processes. See also <code>xkill</code> and <code>killall</code>."}], "tags": [], "owner": {"reputation": 187, "user_id": 3355587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9na1s.jpg?s=128&g=1", "display_name": "Jimmy_A", "link": "https://stackoverflow.com/users/3355587/jimmy-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1494414055, "creation_date": 1494414055, "answer_id": 43890569, "question_id": 43889483, "link": "https://stackoverflow.com/questions/43889483/cannot-stop-c-daemon-in-certain-situations-from-php/43890569#43890569", "title": "Cannot stop C daemon in certain situations from PHP", "body": "<p>Maybe your question should be why <code>kill &lt;pid&gt;</code> might not work. It is not a certain issue with PHP. <code>kill</code> can easily be ignored by the processes. Now you mention that it is a C daemon, however, you do not mention what the daemon does. So I will just assume that your daemon awaits for I/O, it is not properly configured with a timeout, and you kill it. Then the process will just won't be killed no matter what.</p>\n\n<p>You can read here <a href=\"https://askubuntu.com/questions/59811/kill-pid-not-really-killing-the-process-why\">https://askubuntu.com/questions/59811/kill-pid-not-really-killing-the-process-why</a> for possible solutions.</p>\n"}], "owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494485975, "creation_date": 1494411106, "last_edit_date": 1494485975, "question_id": 43889483, "link": "https://stackoverflow.com/questions/43889483/cannot-stop-c-daemon-in-certain-situations-from-php", "title": "Cannot stop C daemon in certain situations from PHP", "body": "<p>I have created a simple C daemon in Linux. The daemon is setup to catch the SIGTERM signal, do some cleanup and terminate. When run from the command line, this behaves as expected. Sending a SIGTERM to the daemon via the kill command gets handled properly. </p>\n\n<p>I would however like to be able to start and stop the daemon from a PHP application. I do this using exec() in PHP. To start</p>\n\n<pre><code>exec(\"$daemon_name\");\n</code></pre>\n\n<p>and to stop </p>\n\n<pre><code>exec(\"kill $daemon_pid\");\n</code></pre>\n\n<p>Starting the daemon this way always works, but stopping doesn't. In fact, when started this way, executing kill from the command line also doesn't work. Only \"kill -9\" now works, and this obviously does not do the required cleanup. As far as I can tell, the process is simply not getting the signal.</p>\n\n<p>Here is what really gets me. When I deploy this exact same configuration on SLES 12 or OpenSuSE 42.2, it doesn't work, but on OpenSuSE 42.1, it does work (I can start AND stop via PHP).</p>\n\n<p>It is not a permissions issue, I verified this.</p>\n\n<p>I'm out of ideas as to what can cause the process to not receive the SIGTERM signal. Looking at the output of \"ps aux\" and \"ps -ef\" I can see no difference between a daemon started from the command line, and one start via PHP.</p>\n\n<p>Edit:\nThanks for all comments so far. None of them seems to take into account that the exact same code works on some systems, but not other. The only thing I can think of, is that the daemon is started in different environments. Question: Is there anything in the environment that a process is started in that can cause it to ignore signals?</p>\n"}, {"tags": ["c", "return-value", "void", "function-call"], "comments": [{"owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "edited": false, "score": 3, "creation_date": 1494410833, "post_id": 43889343, "comment_id": 74812636, "body": "<i>void</i>, by definition, does <i>not</i> return value. You should just call it without assignment: <code>UsartCallback(&amp;buf)</code>. The <code>uchar* data</code> part is unnecessary"}, {"owner": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "reply_to_user": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "edited": false, "score": 0, "creation_date": 1494410875, "post_id": 43889343, "comment_id": 74812663, "body": "no i can return value that i have shown above."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1494410896, "post_id": 43889343, "comment_id": 74812684, "body": "What thought process led to the decision to tag a C question <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> and <a href=\"https://stackoverflow.com/questions/tagged/c%23\">c#</a>, pray tell?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1494411152, "post_id": 43889343, "comment_id": 74812858, "body": "Unclear, and you&#39;ve changed the language twice, now changed the question a few times in comments too. -1"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494411177, "post_id": 43889343, "comment_id": 74812874, "body": "Observing response comments in existing answers, Voting to close as unclear...."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494410942, "post_id": 43889382, "comment_id": 74812710, "body": "can i do this in C++ ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494410974, "post_id": 43889382, "comment_id": 74812732, "body": "@user3764118 why?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494411036, "post_id": 43889382, "comment_id": 74812780, "body": "@user3764118 Dude are you writing C or is it C++? Would you please <i>pick one</i>?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494411105, "post_id": 43889382, "comment_id": 74812825, "body": "Or is ti C# maybe?"}, {"owner": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494411233, "post_id": 43889382, "comment_id": 74812915, "body": "ok, i&#39;m bit confused because i wrote file in C so that way i mention as &quot;C&quot; so is it possible in C++"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494411246, "post_id": 43889382, "comment_id": 74812927, "body": "@tilz0R why not ruby? python? go? fortan? asm, maybe? :P"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494412094, "post_id": 43889382, "comment_id": 74813495, "body": "Before you hate, original post had tags for c c++ and c#. @SouravGhosh"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1494412354, "post_id": 43889382, "comment_id": 74813678, "body": "@tilz0R OK, i think you got me wrong... 1) i&#39;m the one who edited them out. 2) my question was not &quot;targeted&quot; to you and it&#39;s rhetorical...hope it&#39;s clear now. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1494411002, "last_edit_date": 1494411002, "creation_date": 1494410883, "answer_id": 43889382, "question_id": 43889343, "link": "https://stackoverflow.com/questions/43889343/how-to-store-return-values-from-void-in-c/43889382#43889382", "title": "how to store return values from void in C?", "body": "<p>This is <strong>invalid</strong> code, as it violates the constraint.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.8.6.4</p>\n\n<blockquote>\n  <p>A <code>return</code> statement with an expression shall not appear in a function whose return type\n  is <code>void</code>. [...]</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494411058, "post_id": 43889413, "comment_id": 74812798, "body": "ok is there any way to get &quot;buf&quot; value from void and i want to store that in &quot;main&quot; .. is it possible ?"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1494411135, "last_edit_date": 1494411135, "creation_date": 1494410940, "answer_id": 43889413, "question_id": 43889343, "link": "https://stackoverflow.com/questions/43889343/how-to-store-return-values-from-void-in-c/43889413#43889413", "title": "how to store return values from void in C?", "body": "<p>You can't. There is no such thing as a \"void value\". <code>void</code> is the absence of a value. It is true that it <em>looks like</em> you're returning a \"thing\" here, but you're not.</p>\n\n<ul>\n<li><p>In C, this is illegal and your program doesn't even compile.</p></li>\n<li><p>In C++, the code is accepted as an \"oddity\" of syntax (this is for making templates easier to implement). Your line is effectively the same as <code>return;</code>.</p></li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <p>ok is there any way to get \"buf\" value from void and i want to store that in \"main\" .. is it possible ? </p>\n</blockquote>\n\n<p>Okay, completely different question now.</p>\n\n<p><code>buf</code> is a pointer. So, yes, simply return it. Presumably your callback is required to return <code>void*</code> by some external force?</p>\n\n<pre><code>void* UsartCallback (uchar* buf, uint len)\n{\n    return buf;\n}\n</code></pre>\n\n<p>I suggest you brush up on pointer syntax; your question (if I now understand it correctly; really hard to tell) betrays a lack of understanding of how to work with pointer types.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1494411059, "post_id": 43889446, "comment_id": 74812800, "body": "Oh, right. hah."}, {"owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "edited": false, "score": 0, "creation_date": 1494411125, "post_id": 43889446, "comment_id": 74812842, "body": "ah, that is a void <i>pointer</i>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494411130, "post_id": 43889446, "comment_id": 74812845, "body": "Maybe, maybe not, we passed pointer to <code>buf</code> as argument...... :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "edited": false, "score": 0, "creation_date": 1494416524, "post_id": 43889446, "comment_id": 74816796, "body": "@user3764118 so your code is different from the code in this answer. Where <i>exactly</i> did you get this error? Maybe you should ask a new question about this specific problem."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1494416438, "last_edit_date": 1494416438, "creation_date": 1494411034, "answer_id": 43889446, "question_id": 43889343, "link": "https://stackoverflow.com/questions/43889343/how-to-store-return-values-from-void-in-c/43889446#43889446", "title": "how to store return values from void in C?", "body": "<p>You probably want this:</p>\n\n<pre><code>void *UsartCallback (uchar* buf, uint len)\n{\n  return (void*)buf;\n}\n\nint main()\n{\n  uchar *mybuf = UsartCallback(&amp;buf,1);\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3764118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60161ef1b8bf09731ec6aab6faefed24?s=128&d=identicon&r=PG&f=1", "display_name": "user3764118", "link": "https://stackoverflow.com/users/3764118/user3764118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "closed_date": 1494411292, "answer_count": 3, "score": -3, "last_activity_date": 1494416438, "creation_date": 1494410777, "last_edit_date": 1494411025, "question_id": 43889343, "link": "https://stackoverflow.com/questions/43889343/how-to-store-return-values-from-void-in-c", "closed_reason": "Needs details or clarity", "title": "how to store return values from void in C?", "body": "<p>How to store values from void function in main ?</p>\n\n<p>Example </p>\n\n<pre><code>void UsartCallback (uchar* buf, uint len)\n{\n    return void(*buf);\n}\n\nint main()\n{\n    UsartCallback(&amp;buf,1); // I can get values from void function but how to store this \"*buf\" value\n    // For Example \n    uchar* data=UsartCallback(&amp;buf); //Error: but i want get only \"buf\" value from void function.\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "compare", "min"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494410294, "post_id": 43889006, "comment_id": 74812251, "body": "<code>scanf(&quot;%d:,%d&quot;,</code>...smells fishy..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1494410336, "post_id": 43889006, "comment_id": 74812279, "body": "<code>int bestTime = scanf</code>....check what is the return value of <code>scanf()</code>..."}, {"owner": {"reputation": 1403, "user_id": 5577416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8cc9163c517d1d081b19006c9a18712?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme", "link": "https://stackoverflow.com/users/5577416/graeme"}, "edited": false, "score": 0, "creation_date": 1494410402, "post_id": 43889006, "comment_id": 74812319, "body": "For the comparison I would convert the times into total number of seconds (multiply hours by 3600, minutes by 60 add together).  Then you make the comparison between 2 integer values, and can easily compute the difference between them and hence find the nearest one"}, {"owner": {"reputation": 1403, "user_id": 5577416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8cc9163c517d1d081b19006c9a18712?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme", "link": "https://stackoverflow.com/users/5577416/graeme"}, "edited": false, "score": 0, "creation_date": 1494411007, "post_id": 43889006, "comment_id": 74812754, "body": "@AjayBrahmakshatriya indeed, but working with integers is easier than HH:MM eg, user enters 13:00 and there could be a time of 12:58 and 13:03 or user enters 15:00 and times are 09:12 and 21:11.. makes for a more complex search, integer versions its a simple subtraction wrapped in <code>abs</code>"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1494427115, "post_id": 43889006, "comment_id": 74825248, "body": "<code>for(counter = 0; counter &lt;  ; counter++){</code> is clearly missing some character(s) after the <code>&lt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1494410695, "creation_date": 1494410695, "answer_id": 43889311, "question_id": 43889006, "link": "https://stackoverflow.com/questions/43889006/converting-char-array-to-integer-c-programming/43889311#43889311", "title": "Converting char array to integer c programming", "body": "<p>You can make a function that converts a string of format \"hh:mm\" into minutes from \"00:00\". And then use that to do all the comparisons.</p>\n\n<p>One implementation of the function can be</p>\n\n<pre><code>unsigned int str_to_mins(const char* t) {\n    return (unsigned int) (\n        ((t[0] - '0') * 10 + (t[1] - '0')) * 60 \n        + (t[3] - '0') *10 + (t[4] - '0')\n    );\n}\n</code></pre>\n\n<p>Call this function on all your strings. They will give you unsigned integers. Use that to find the number closest to the one entered. (Convert your input to also this format in similar way).</p>\n\n<p>Just to be clear scan your input as </p>\n\n<pre><code>char input[10];\nscanf(\"%s\", input);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 357, "user_id": 7763210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2431674aae29bd58336eaa2fcb83ba91?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed Bakr Sikal", "link": "https://stackoverflow.com/users/7763210/mohammed-bakr-sikal"}, "is_accepted": false, "score": 0, "last_activity_date": 1494412602, "creation_date": 1494412602, "answer_id": 43890031, "question_id": 43889006, "link": "https://stackoverflow.com/questions/43889006/converting-char-array-to-integer-c-programming/43890031#43890031", "title": "Converting char array to integer c programming", "body": "<blockquote>\n  <p>The idea: </p>\n  \n  <ul>\n  <li>After getting the time from the user, convert everything to minutes.</li>\n  <li>Get every element of your departure array, convert it to integers using atoi().</li>\n  <li>Convert to minutes the departure times and put them inside an array of integers.</li>\n  <li>Now compare the total number of minutes entered by the user with every total you have in your array. That's simple; you compare the\n  absolute values of the subtraction of the departure total from the\n  input total. The lowest absolute value is your closest. For that, I\n  wrote a function that returns the index of the closest element inside\n  the array.</li>\n  <li>I display the equivalent closest value from your initial departure array of strings.</li>\n  <li>NB: I assume you have 7 departure times.</li>\n  </ul>\n</blockquote>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\nint findClosest(int * , int);\n\nint main(void) {\n\n    int hours,mins,total; //24 hour time to be entered by user\n    char computationHours[3],computationMins[3];\n    int computationHoursInt,computationMinsInt,computationTotal;\n\n    int bestTime; //best time for user departure\n    int index;\n    char * depart[8] = {\n        \"8:00\",\n        \"9:43\",\n        \"11:19\",\n        \"12:47\",\n        \"14:00\",\n        \"15:45\",\n        \"19:00\",\n        \"\\0\"\n    }; //times available for departure\n    int departures[7];\n    int counter; //count number of times to loop\n    printf(\"Please Enter The Best Time For Your Flight In 24 Hour Format.\\n\");\n    scanf(\"%d:%d\",  &amp; hours,  &amp; mins);\n    total = (hours * 60) + mins;\n    for (counter = 0; counter &lt; 7; counter++) {\n\n        if (strlen(depart[counter]) == 4) {\n            //Like 8:00\n            strncpy(computationHours, depart[counter], 2);\n            strncpy(computationMins, depart[counter] + 2, 2);\n            computationHoursInt = atoi(computationHours);\n            computationMinsInt = atoi(computationMins);\n            computationTotal = (computationHoursInt * 60) + computationMinsInt;\n        } else {\n            //Like 19:00\n            strncpy(computationHours, depart[counter], 2);\n            strncpy(computationMins, depart[counter] + 3, 2);\n            computationHoursInt = atoi(computationHours);\n            computationMinsInt = atoi(computationMins);\n        }\n        computationTotal = (computationHoursInt * 60) + computationMinsInt;\n        departures[counter] = computationTotal;\n    }\n\n    index = findClosest(departures, total);\n    printf(\"Closest timing is: %s\", depart[index]);\n    return 0;\n}\n\nint findClosest(int values[], int n) {\n    int dist = abs(values[0] - n),closest;\n    int size = 7;\n    for (int i = 1; i &lt; size; ++i) {\n        if (abs(values[i] - n) &lt; dist) {\n            dist = abs(values[i] - n);\n            closest = i;\n        }\n    }\n    return closest;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7028960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qOKEtmqCSzU/AAAAAAAAAAI/AAAAAAAAFTU/Z7QKYf4uvwk/photo.jpg?sz=128", "display_name": "Kanesha Patterson", "link": "https://stackoverflow.com/users/7028960/kanesha-patterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1494412602, "creation_date": 1494409914, "last_edit_date": 1494410246, "question_id": 43889006, "link": "https://stackoverflow.com/questions/43889006/converting-char-array-to-integer-c-programming", "title": "Converting char array to integer c programming", "body": "<p>The Problem: The user enters a time in 24 hour format. The Array has different times listed also in 24 hour format. I would like to compare the number entered by the user to the time that is closest to the time entered by the user. Whatever number is closest to the time entered by the user is to be displayed on the screen. I've been working overnight at my company job and trying to understand the programming behind this. Can anyone help me? By the way, I just began this C Programming class. If you see anything that looks like C# code, it's because I haven't learned enough yet. Here's what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n\n    int hours, mins; //24 hour time to be entered by user\n\n    int bestTime = scanf(\"%d:,%d\", &amp;hours, &amp;mins);  //best time for user departure\n\n    char* depart [8] = {\"8:00\", \"9:43\", \"11:19\", \"12:47\", \"14:00\", \"15:45\", \"19:00\", \"\\0\"}; //times available for departure\n\n    int counter; //count number of times to loop\n    printf(\"Please Enter The Best Time For Your Flight In 24 Hour Format.\\n\");\n    scanf(\"%d:,%d\", &amp;hours, &amp;mins);\n\n    for(counter = 0; counter &lt;  ; counter++){\n        if(bestTime &lt; depart[counter]){\n            bestTime = depart[counter];\n        }\n    }\n\n    return bestTime;\n}\n</code></pre>\n"}]