[{"tags": ["c", "standards"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1545260134, "post_id": 53860286, "comment_id": 94568566, "body": "It is the same statement like <code>x = x</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1545260194, "post_id": 53860286, "comment_id": 94568586, "body": "Or more precisely, it&#39;s like <code>myThing = myThing;</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1545260219, "post_id": 53860286, "comment_id": 94568589, "body": "@Osiris Not really. This assignment might be implemented as <code>memcpy</code>, which is restricted to non-overlapping buffers. So the question is interesting. Yet I do not believe there is a restriction imposed by the standard on the assignment, so any complying compiler will not use <code>memcpy</code> in such a case."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1545260277, "post_id": 53860286, "comment_id": 94568604, "body": "Struct self-assignment follows the same rules as any other self-assignment."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545260401, "post_id": 53860286, "comment_id": 94568642, "body": "@EugeneSh. Then the compiler would be required to use <code>memmove</code> if it cannot prove that the memory regions don&#39;t overlap (and if they don&#39;t, then it could use <code>memcpy</code>). The OP&#39;s code <i>is</i> like <code>x = x</code>."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545260557, "post_id": 53860286, "comment_id": 94568681, "body": "@EugeneSh. Then one could also argue that <code>x = x</code> may be implemented as <code>memcpy</code>. I think in this case the compiler is not allowed to use <code>memcpy</code> when he can not ensure that the elements do not overlap."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1545260582, "post_id": 53860286, "comment_id": 94568691, "body": "Now I see that this question is a little more interesting. If you write <code>x = x</code> the compiler can tell immediately that they&#39;re the same variables, and can just optimize the assignment away completely (unless it&#39;s volatile). But with <code>x = *ptr;</code> it usually won&#39;t be able to tell whether they&#39;re the same or not."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1545260590, "post_id": 53860286, "comment_id": 94568693, "body": "@Cornstalks Well, yes. Semantically they are alike."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545260668, "post_id": 53860286, "comment_id": 94568713, "body": "@EugeneSh. Then what&#39;s the point of your &quot;Not really.&quot; comment?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545260709, "post_id": 53860286, "comment_id": 94568727, "body": "Isn&#39;t struct assignment defined to be equivalent to memberwise assignment?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1545260713, "post_id": 53860286, "comment_id": 94568731, "body": "@Cornstalks Because the OP seem to understand that. He is interested of internals I guess"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545260799, "post_id": 53860286, "comment_id": 94568758, "body": "It can implement it any way it likes, as long as the result matches the specification.  I don&#39;t think there&#39;s anything in the spec that prohibits <code>x = *ptr;</code> where <code>ptr == &amp;x;</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545260984, "post_id": 53860286, "comment_id": 94568806, "body": "Well, there is <i>something</i> in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.16.1p3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.16.1p3</a> - <i>If the value being stored in an object is read from another object that overlaps in any way the storage of the first object, then the overlap shall be exact and the two objects shall have qualified or unqualified versions of a compatible type; otherwise, the behavior is undefined.</i>"}, {"owner": {"reputation": 3667, "user_id": 2965738, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/EV9E2.png?s=128&g=1", "display_name": "not-a-user", "link": "https://stackoverflow.com/users/2965738/not-a-user"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1594998992, "post_id": 53860286, "comment_id": 111332379, "body": "@Cornstalks Here is a compiler that uses <code>memcpy</code> without checking if the objects are the same or not: <a href=\"https://godbolt.org/z/v5f9vE\" rel=\"nofollow noreferrer\">godbolt.org/z/v5f9vE</a> - So should I file a bug against gcc? Or better modify <code>memcpy</code> upstream to zero out the overlap and wait for funny things to happen?"}], "answers": [{"comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1545261527, "post_id": 53860427, "comment_id": 94568958, "body": "What is the meaning of &quot;overlap is exact&quot;? Going through some code I found a pointer to a global was passed to a function which then assigned the dereferenced pointer back to the global memory area as in <code>ItemCommonLocal = *pDataBuffer;</code> where <code>pDataBuffer</code> is a pointer to <code>ItemCommonLocal</code> and it suddenly struck me since it was overlapping, was there a problem."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1545263267, "post_id": 53860427, "comment_id": 94569409, "body": "Exact overlap means they start and end on exact same boundaries. Or simply the same object."}, {"owner": {"reputation": 3667, "user_id": 2965738, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/EV9E2.png?s=128&g=1", "display_name": "not-a-user", "link": "https://stackoverflow.com/users/2965738/not-a-user"}, "edited": false, "score": 0, "creation_date": 1594998472, "post_id": 53860427, "comment_id": 111332104, "body": "Here is a compiler that uses <code>memcpy</code> for this, no matter if it is the same object or not: <a href=\"https://godbolt.org/z/nPxqWc\" rel=\"nofollow noreferrer\">godbolt.org/z/nPxqWc</a> - But that is undefined behaviour, because for <code>memcpy</code> &quot; The memory areas must not overlap.&quot; (quoting from the man page). So is the compiler wrong here? Or does it somehow know that <code>memcpy</code> does the right thing (like doing nothing if the pointers are the same)?"}], "tags": [], "owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "is_accepted": true, "score": 6, "last_activity_date": 1545261024, "creation_date": 1545261024, "answer_id": 53860427, "question_id": 53860286, "link": "https://stackoverflow.com/questions/53860286/can-a-struct-assignment-overlap-similar-to-memmove-or-is-struct-assignment-lik/53860427#53860427", "title": "can a struct assignment overlap similar to memmove() or is struct assignment like memcpy()?", "body": "<p>Section 6.5.16.1 (\"Simple assignment\") of the C standard (reading from draft N1548) states:</p>\n\n<blockquote>\n  <p>In <em>simple assignment</em> (<code>=</code>), the value of the right operand is converted to the type of the assignment expression and replaces the value stored in the object designated by the left operand.</p>\n  \n  <p>If the value being stored in an object is read from another object that overlaps in any way the storage of the first object, then the overlap shall be exact and the two objects shall have qualified or unqualified versions of a compatible type; otherwise, the behavior is undefined.</p>\n</blockquote>\n\n<p>The C standard doesn't specify <em>how</em> the compiler implements the simple assignment. But overlap between the source and destination are permitted if the overlap is exact and the types are compatible. Self-assignment (whether through a pointer or not) meets this requirement, and thus the behavior is well-defined.</p>\n"}], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 53860427, "answer_count": 1, "score": 5, "last_activity_date": 1545261024, "creation_date": 1545260056, "question_id": 53860286, "link": "https://stackoverflow.com/questions/53860286/can-a-struct-assignment-overlap-similar-to-memmove-or-is-struct-assignment-lik", "title": "can a struct assignment overlap similar to memmove() or is struct assignment like memcpy()?", "body": "<p>There are two different functions for making a copy of a data area in the Standard C library, <code>memmove()</code> used for overlapping memory areas and <code>memcpy()</code> for disjoint, non-overlapping memory areas.</p>\n\n<p>What does the C standards say about struct assignment as in:</p>\n\n<pre><code>struct thing myThing = {0};\nstruct thing *pmyThing = &amp;myThing;\n\nmyThing = *pmyThing;     // assign myThing to itself through a pointer dereference.\n</code></pre>\n\n<p>Does the struct assignment follow the rules for <code>memmove()</code> or for <code>memcpy()</code> or its own rules so far as overlapping memory areas are concerned?</p>\n"}, {"tags": ["c", "networking", "module", "linux-kernel", "ip-address"], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545262058, "post_id": 53860356, "comment_id": 94569084, "body": "This might invoke UB or is at least dependent on the endianess of the target architecture; a better solution is to use arithmetics to divide the integer into octets."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1545263210, "post_id": 53860356, "comment_id": 94569396, "body": "@Ctx Network is big-endian across architectures, there&#39;s no risk of that. That&#39;s why the functions <code>htons()</code>, <code>htonl()</code>, <code>ntohs()</code> and <code>ntohl()</code> exist, they convert between &quot;host endianess&quot; to &quot;network endianess&quot;, which is big-endian. If the host is already big-endian, they do nothing."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545289852, "post_id": 53860356, "comment_id": 94575330, "body": "If the ipv4 is represented as an integer and stored in an integer variable, it <i>is</i> dependent on the endianess of the machine. Integer representations of IPs are well defined and platform independent, 127.0.0.1 is for example 2130706433. Use this instead of your 1234567890 and compile your program big and little endian, you will get different results."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545342441, "post_id": 53860356, "comment_id": 94600278, "body": "@Ctx If it is coming from the socket library, it is not. Little-endian machines will simply interpret it wrong. It is always stored in network endianess (big endian)."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545347975, "post_id": 53860356, "comment_id": 94601972, "body": "Sorry, you are plain wrong here. Try &quot;telnet 2130706433&quot; on a recent unix box to open a connection to localhost. If you do <code>int32_t ipv4 = 2130806433</code> and use your method above to convert it to dotted-quad notation you get &quot;1.0.0.127&quot; or &quot;127.0.0.1&quot;, dependent on the machine endianess. Technically, you are invoking undefined behaviour for violating the strict-aliasing rule, so converting it this way is an ill advice in any case."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545348055, "post_id": 53860356, "comment_id": 94601992, "body": "That&#39;s because this number is coming from user interface and has to be converted to network format with <code>htonl()</code> to make any sense to the sockets library. <b>It is always big-endinan in the socket library!</b>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1545348233, "post_id": 53860356, "comment_id": 94602046, "body": "Endianess is a feature of the cpu architecture, not of a library. You are mixing up things and are confusing yourself or others with imprecise terminology. The term &quot;a 32-bit big-endian integer&quot; is completely misleading, an integer is neither big- or little-endian, but can be <i>stored</i> in memory big- or little endian."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545348547, "post_id": 53860356, "comment_id": 94602123, "body": "@Ctx It does not matter what endianess the CPU understands, this information is for networking and the IP protocol uses big-endian therefore all information in the networking headers must use big-endian, the IP address, port, checksums, everything has to be in big-endian and that&#39;s what the functions <code>htons()</code> and associates are there for. If you read a 32-bit IP from any socket structure from the socket.h library, it is immediately in big-endian regardless of architecture,  you&#39;d have to convert it with <code>ntohl()</code> to bring it to your host endianess."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545348876, "post_id": 53860356, "comment_id": 94602203, "body": "But you didn&#39;t do that in your example, you hard-coded an ipv4 &quot;1234567890&quot; which represents &quot;73.150.2.210&quot;, but will be decoded wrong as &quot;210.2.150.73&quot; on most platforms. Why is this so hard to understand? And apart from that, it still is UB and should not be done at all this way. Perhaps you should start fixing your answer instead of trying to discuss its shortcomings away."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545348936, "post_id": 53860356, "comment_id": 94602212, "body": "@Ctx I explicitly stated it&#39;s a random example, not a specific IP, I don&#39;t care what address it&#39;s in there I merely initialized the variable with garbage."}], "tags": [], "owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "is_accepted": false, "score": -1, "last_activity_date": 1545260507, "creation_date": 1545260507, "answer_id": 53860356, "question_id": 53860258, "link": "https://stackoverflow.com/questions/53860258/converting-network-byte-order-ip-to-host-byte-order-with-ip4-format-in-kernel-mo/53860356#53860356", "title": "Converting network byte order IP to host byte order with ip4 format in kernel module", "body": "<p>If by \"network IP\" you mean a 32-bit big-endian integer representing a IPv4 that you wish to convert to a dotted-decimal string representation, then it can be done with <code>sprintf()</code>.</p>\n\n<pre><code>int32_t ipv4 = 1234567890; // random example\n\nunsigned char *ptr = (unsigned char *)&amp;ipv4;\nchar ipstr[16];\nsprintf(ipstr, \"%d.%d.%d.%d\", ptr[0], ptr[1],  ptr[2],  ptr[3]);\n</code></pre>\n\n<p><code>ipstr</code> will contain the string with the IP address.</p>\n"}, {"tags": [], "owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "is_accepted": true, "score": 4, "last_activity_date": 1545346665, "creation_date": 1545346665, "answer_id": 53877174, "question_id": 53860258, "link": "https://stackoverflow.com/questions/53860258/converting-network-byte-order-ip-to-host-byte-order-with-ip4-format-in-kernel-mo/53877174#53877174", "title": "Converting network byte order IP to host byte order with ip4 format in kernel module", "body": "<p>You have access to <code>ntohl()</code> and friends. Just <code>#include &lt;linux/byteorder/generic.h&gt;</code>.\nUse it as usual:</p>\n\n<pre><code>__le32 le_ipaddr = ntohl(be_ipaddr); /* to flip big-endian IP to little-endian */\n</code></pre>\n\n<hr>\n\n<p>Also you can print IPv4 address as you want without any difficulties through the special format specifier <code>%pI4</code> in <code>printk()</code> e.g. such way:</p>\n\n<pre><code>__be32 ipaddr /*= gain from somewhere IP in network byte order (__be32 means big endian)*/;\nprintk(KERN_INFO \"Got IP: %pI4\\n\", &amp;ipaddr); /* in network byte order */\nprintk(KERN_INFO \"Got IP: %pI4h\\n\", &amp;ipaddr); /* in host byte order */\n</code></pre>\n\n<p>Read also:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/584713/ip-address-from-sk-buff\">IP-address from sk_buff</a></p>\n\n<p><a href=\"https://www.kernel.org/doc/Documentation/printk-formats.txt\" rel=\"nofollow noreferrer\">How to get printk format specifiers right</a> (from Kernel.org):</p>\n\n<blockquote>\n  <p>Passed by reference.</p>\n  \n  <p>IPv4 addresses</p>\n  \n  <p>==============</p>\n  \n  <p>::</p>\n  \n  <p>%pI4    1.2.3.4</p>\n  \n  <p>%pi4    001.002.003.004</p>\n  \n  <p>...</p>\n  \n  <p>The additional <code>h</code>, <code>n</code>, <code>b</code>, and <code>l</code> specifiers are used to\n  specify host, network, big or little endian order addresses\n  respectively. Where no specifier is provided the default network/big\n  endian order is used.</p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>Passed by reference.</p>\n  \n  <p>IPv6 addresses</p>\n  \n  <p>==============</p>\n  \n  <p>::</p>\n  \n  <p>%pI6   0001:0002:0003:0004:0005:0006:0007:0008</p>\n  \n  <p>%pi6   00010002000300040005000600070008</p>\n  \n  <p>%pI6c  1:2:3:4:5:6:7:8</p>\n</blockquote>\n\n<hr>\n\n<p>P.S. you can search the functions you need in Linux kernel sources, e.g. on this site: <a href=\"https://elixir.bootlin.com/linux/latest/ident/\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/latest/ident/</a></p>\n"}], "owner": {"reputation": 1658, "user_id": 10813146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502c57cd3ed11359acecbd8124d9ae17?s=128&d=identicon&r=PG&f=1", "display_name": "milad", "link": "https://stackoverflow.com/users/10813146/milad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2469, "favorite_count": 0, "accepted_answer_id": 53877174, "answer_count": 2, "score": 3, "last_activity_date": 1545351554, "creation_date": 1545259859, "last_edit_date": 1545351554, "question_id": 53860258, "link": "https://stackoverflow.com/questions/53860258/converting-network-byte-order-ip-to-host-byte-order-with-ip4-format-in-kernel-mo", "title": "Converting network byte order IP to host byte order with ip4 format in kernel module", "body": "<p>I am writing a kernel module in Arch Linux with <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> language. I want to convert the network IP to host IP with ip4 format: 127.0.0.1</p>\n\n<p>I know it is possible in user program to use these functions:</p>\n\n<pre><code>inetntoa()\nntohs()\nntohl()\n</code></pre>\n\n<p>I tried to include the <em><code>socket.h</code></em>, <em><code>in.h</code></em>, etc and use the below functions, but none of them worked for me.</p>\n\n<p>So in kernel module I don't have access to this functions.\nIs there in kernel module a replacement for this functions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1545259189, "post_id": 53860154, "comment_id": 94568273, "body": "You&#39;re accessing memory your program doesn&#39;t own. If you want to know more you&#39;ll have to post the code!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1545259345, "post_id": 53860154, "comment_id": 94568324, "body": "It would be easier to read if you do a quick search &amp; replace instead of providing translations (and indent the code)."}, {"owner": {"reputation": 11, "user_id": 9362035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d3487f13c06a6ed92b19cfbb96a30c?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin Co\u015fkun", "link": "https://stackoverflow.com/users/9362035/yasin-co%c5%9fkun"}, "edited": false, "score": 0, "creation_date": 1545259363, "post_id": 53860154, "comment_id": 94568330, "body": "Sorry that was my first entry so i couldnt get how to share code but i think now i get it"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545259736, "post_id": 53860154, "comment_id": 94568444, "body": "With some limited success, it is possible to paste C code into Google translate and get something back that is close [it may need a bit of tweaking]."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1545259999, "post_id": 53860154, "comment_id": 94568519, "body": "true this looks like obfuscated code. Harder to figure out the bugs..."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1545266165, "post_id": 53860154, "comment_id": 94570043, "body": "This is not how you compare strings: <code>if (harf &lt;= dugum-&gt;harf)</code>.  This compares the addresses of memory locations."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9362035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d3487f13c06a6ed92b19cfbb96a30c?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin Co\u015fkun", "link": "https://stackoverflow.com/users/9362035/yasin-co%c5%9fkun"}, "edited": false, "score": 0, "creation_date": 1545260340, "post_id": 53860234, "comment_id": 94568624, "body": "Thank you for million times :)"}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": true, "score": 3, "last_activity_date": 1545259678, "creation_date": 1545259678, "answer_id": 53860234, "question_id": 53860154, "link": "https://stackoverflow.com/questions/53860154/mors-alphabet-segmentation-fault/53860234#53860234", "title": "Mors Alphabet Segmentation Fault", "body": "<p>You try to dereference a NULL pointer.</p>\n\n<pre><code>while (dugum != NULL) {\n  anne = dugum;\n  if (harf &lt;= dugum-&gt;harf)\n    dugum = dugum-&gt;sol;\n  else\n    dugum = dugum-&gt;sag;\n}\n</code></pre>\n\n<p>This loop ends when <code>dugum</code> is NULL.\nDirectly after you try to access <code>dugum-&gt;harf</code>:</p>\n\n<pre><code> if (harf &lt;= dugum-&gt;harf)\n</code></pre>\n\n<p>This leads to undefined behavior.</p>\n\n<p>Also note that this comparisons compare the pointers to string literals, and is therefore also undefined behavior. To compare two C strings you should use <code>strcmp</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9362035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d3487f13c06a6ed92b19cfbb96a30c?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin Co\u015fkun", "link": "https://stackoverflow.com/users/9362035/yasin-co%c5%9fkun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53860234, "answer_count": 1, "score": 0, "last_activity_date": 1545260288, "creation_date": 1545259126, "last_edit_date": 1545259745, "question_id": 53860154, "link": "https://stackoverflow.com/questions/53860154/mors-alphabet-segmentation-fault", "title": "Mors Alphabet Segmentation Fault", "body": "<p>My code doesn't adding second node to tree. It gives me SIGSEGV fault when i'm adding the second node.I think its about strcmp function but when i'm trying to understand how it works properly at the very bottom of main func it returns -1 so i've wrote it like this.And most of my variables named Turkish so here are the translations of them to make you understand more easily\ndugum=node,kok=root;sol=left;sag=right;anne=mother</p>\n\n<pre><code>// C program to demonstrate insert operation in binary search tree\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct tree {\n  char *harf;\n  char *morskodu;\n  struct tree *left;\n  struct tree *right;\n} agac;\n\nagac *kok = NULL;\n\nvoid ekle(char *harf, char *morskodu) {\n  if (kok == NULL) {\n    kok = (agac *)malloc(sizeof(agac));\n    kok-&gt;harf = harf;\n    kok-&gt;morskodu = morskodu;\n    kok-&gt;left = NULL;\n    kok-&gt;right= NULL;\n  } else {\n    agac *yeni = (agac *)malloc(sizeof(agac));\n    yeni-&gt;harf = harf;\n    yeni-&gt;morskodu = morskodu;\n    yeni-&gt;left = NULL;\n    yeni-&gt;right = NULL;\n    agac *dugum = kok, *anne;\n    while (dugum != NULL) {\n      anne = dugum;\n      if (harf &lt;= dugum-&gt;harf)\n        dugum = dugum-&gt;left;\n      else\n        dugum = dugum-&gt;right;\n    }\n    if (harf &lt;= dugum-&gt;harf)\n      anne-&gt;left = yeni;\n    else\n      anne-&gt;right = yeni;\n  }\n}\n\nvoid dolas(agac *dugum) {\n  if (dugum != NULL) {\n    printf(\" %s \", dugum-&gt;harf);\n    dolas(dugum-&gt;left);\n    dolas(dugum-&gt;right);\n  }\n}\n\nvoid main() {\n  ekle(\"a\", \"-\");\n  ekle(\"b\", \"-.\");\n  dolas(kok);\n\n  int x = strcmp(\"A\", \"B\");\n  printf(\"%d\", x);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1545258396, "post_id": 53860008, "comment_id": 94567987, "body": "<code>scanf(&quot;%d&quot;, num[i]);</code> -&gt; <code>scanf(&quot;%d&quot;, &amp;num[i]);</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1545270868, "post_id": 53860008, "comment_id": 94570975, "body": "instead of <code>pow(10,9)+7</code> it&#39;ll be easier to read with <code>1e9 + 7</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": true, "score": 1, "last_activity_date": 1545258682, "creation_date": 1545258682, "answer_id": 53860078, "question_id": 53860008, "link": "https://stackoverflow.com/questions/53860008/i-am-not-able-to-put-values-in-the-elements-of-a-dynamically-allocated-array-wit/53860078#53860078", "title": "I am not able to put values in the elements of a dynamically allocated array with scanf?", "body": "<p><code>scanf</code> requires an address to place the scanned input into.  You are providing a value, not an address to the value.</p>\n\n<p>To understand this better, to print the number, you would reference it as <code>num[i]</code>, but to get the address of that same number, you would use <code>&amp;num[i]</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 10381990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EATXe.png?s=128&g=1", "display_name": "MrDeepThought", "link": "https://stackoverflow.com/users/10381990/mrdeepthought"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53860078, "answer_count": 1, "score": 1, "last_activity_date": 1545258682, "creation_date": 1545258316, "question_id": 53860008, "link": "https://stackoverflow.com/questions/53860008/i-am-not-able-to-put-values-in-the-elements-of-a-dynamically-allocated-array-wit", "title": "I am not able to put values in the elements of a dynamically allocated array with scanf?", "body": "<p>What can I do to assign values to the elements of the array that is being called from the heap memory. I want to take the values from the user, so I was using scanf here but as I try to assign the first value to the first element of the array the compiler shows a segmentation fault(core dumped) and i am not able to assign further values.</p>\n\n<pre><code> int n,i;\n int *num;\n int answer = 1;\n\nscanf(\"%d\", &amp;n);\n\nnum = (int*)(malloc(n*sizeof(int)));\n\nfor(i=0; i&lt;n; i++)\n{\n    scanf(\"%d\", num[i]);\n    answer = (answer*num[i])%(((int)pow(10,9))+7);\n}\n\nprintf(\"\\n%d\",answer);\nfree(num);\nreturn 0;\n</code></pre>\n\n<p>I want to assign the values to all the elements of the array that will be user defined both the array size and the values inside the array.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1545258106, "post_id": 53859856, "comment_id": 94567887, "body": "Please add the actual code for us to have a clear example"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 3, "creation_date": 1545258225, "post_id": 53859856, "comment_id": 94567934, "body": "<code>if (*pointer == &#39;something&#39;)</code> is very like not doing what you expect; you probably want <code>if(pointer &amp;&amp; strcmp(pointer,&quot;something&quot;)==0)</code>"}, {"owner": {"reputation": 27, "user_id": 10657369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a231b47bc6699de289b03d448427002?s=128&d=identicon&r=PG&f=1", "display_name": "MathewN", "link": "https://stackoverflow.com/users/10657369/mathewn"}, "edited": false, "score": 0, "creation_date": 1545258231, "post_id": 53859856, "comment_id": 94567936, "body": "It is too much, I was just trying to get an idea how to return an error, if possible. The functions have to be returned as char pointers."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1545259530, "post_id": 53859856, "comment_id": 94568383, "body": "You are aware of <code>exit()</code>, right? If an unrecoverable error occurs, for example a dynamic memory allocation for the dataset at hand fails, it is quite acceptable to just print out an error message, and exit the program then and there."}, {"owner": {"reputation": 27, "user_id": 10657369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a231b47bc6699de289b03d448427002?s=128&d=identicon&r=PG&f=1", "display_name": "MathewN", "link": "https://stackoverflow.com/users/10657369/mathewn"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545259790, "post_id": 53859856, "comment_id": 94568462, "body": "@NominalAnimal I am, but I am trying not to use it."}], "answers": [{"tags": [], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "is_accepted": false, "score": 1, "last_activity_date": 1545258710, "creation_date": 1545258710, "answer_id": 53860084, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions/53860084#53860084", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>A common way of handling errors in C is through return values.</p>\n\n<p>Say a function <code>f</code>, on success, returns a pointer to a character string.</p>\n\n<pre><code>char *f();\n</code></pre>\n\n<p>Such functions, upon failure, would return the <code>NULL</code> pointer, which you can have by including some common header files (e.g. <code>&lt;string.h&gt;</code>).</p>\n\n<p>Now say <code>g</code> is a function that given an integer, computes something and returns the integer result of the operation, but the function can fail (e.g. the parameter is invalid for the computation, who knows...). Then maybe you want to write it like so</p>\n\n<pre><code>int g(int i, int *result);\n</code></pre>\n\n<p>Here, <code>i</code> is the parameter to compute something, and <code>result</code> is a pointer to the variable you will use to store the result in. Now, why is <code>g</code>'s return type <code>int</code> ? Well, it could be <code>bool</code> from <code>&lt;stdbool.h&gt;</code> but usually one uses <code>int</code>... The return value will be used as a boolean, <code>g</code> will return <code>0</code> upon failure and <code>1</code> upon success.</p>\n\n<p>You can use these like so in a third function <code>h</code></p>\n\n<pre><code>int h(int i) {\n    char *str = f();\n\n    if (str == NULL) {\n        printf(\"f failed !\\n\");\n        return 0; // f failed\n    }\n\n    printf(\"%s\\n\", str);\n\n    int result;\n    if (!g(i, &amp;result)) {\n        printf(\"g failed !\\n\");\n        return 0; // g failed\n    } else {\n        printf(\"result = %d\\n\", result);\n    }\n\n    return 1; // h success\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1545266843, "last_edit_date": 1545266843, "creation_date": 1545258890, "answer_id": 53860110, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions/53860110#53860110", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>Don't return out of band error codes with pointers. A pointer is either NULL or valid (if it's not valid, usually stack overflowed in your program). Doing <code>char *pointer = (char*)(uintptr_t)1;</code> is just confusing, and doing <code>if ((uintptr_t)pointer == 1) {.. }</code> is as much un-maintainable.</p>\n\n<p>Return an <code>int</code>. <code>int</code> is common in C standard library to return an error. Usually C libraries return <code>-1</code> on error and set errno - I usually write library code that  return a negative value that is an error code (ie. <code>return -ENOMEM</code> in case of <code>malloc</code> fail). Return <code>0</code> on success and maybe positive values to notify user codes on some \"state\" within the library. Pass all variables you want to set by a pointer. Look at ex. <a href=\"https://en.cppreference.com/w/c/io/fopen\" rel=\"nofollow noreferrer\">fopen_s</a> (opinion: don't use <code>fopen_s</code>, only look at it).</p>\n\n<pre><code>enum importantFunction_rets_e {\n   IMPORTANT_FUNCTION_ERR_1 = -1,\n   IMPORTANT_FUNCTION_ERR_2 = -2,\n   IMPORTANT_FUNCTION_STATE_1 = 1,\n   IMPORTANT_FUNCTION_STATE_2 = 2,\n};\n\nint importantFunction(char **pointer)\n{\n   assert(pointer != NULL);\n   // or maybe\n   if (pointer == NULL) return -EINVAL;\n\n   int ret;\n   ret = secondFunction(pointer);\n   if (ret &lt; 0) return ret;\n   ret = thirdFunction(pointer);\n   if (ret &lt; 0) return ret; \n   return 0;\n}\n\nint secondFunction(char **pointer) {\n  *pointer = malloc(sizeof(char) * 5);\n   if (*pointer == NULL) {\n      return IMPORTANT_FUNCTION_ERR_1;\n   }\n   memcpy(*pointer, \"hey!\", 5);\n   return 0;\n}\n\nint main() {\n    char *pointer;\n    const int importantFunction_ret = importantFunction(&amp;pointer);\n    if (importantFunction_ret &lt; 0) {\n       if (importantFunction_ret == IMPORTANT_FUNCTION_ERR_1) {\n          // handle err 1\n       } else if (importantFunction_ret == IMPORTANT_FUNCTION_ERR_2) {\n          // handle err 2\n       } else {\n          // hanlde other errors\n       }\n       return -1;\n    }\n    if (importantFunction_ret == IMPORTANT_FUNCTION_STATE_1) { \n         // handle state1\n    } else if {importantFunction_ret == IMPORTANT_FUNCTION_STATE_2) {\n        // handle state2\n    } else {\n        // handle other states \n        assert(0);\n    }\n}\n</code></pre>\n\n<p>If you feel like exploring the topic or error handling in C, you can implement something along the new (or is it old?) <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2285.pdf\" rel=\"nofollow noreferrer\">proposal</a> that uses the same method as object oriented languages use <code>std::variant</code> or <code>std::expected</code> or similar (opinion: I am really against this proposal as it is right now, it needs redesign/refactoring, but it would be a BIG step forward for C).</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 4, "last_activity_date": 1545265434, "creation_date": 1545265434, "answer_id": 53860952, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions/53860952#53860952", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>There are three common patterns of returning an error from a function:</p>\n\n<ol>\n<li><p>Have the function return an <code>int</code>, with specific values indicating success and failure</p>\n\n<p>For example, returning <code>EXIT_SUCCESS</code> or <code>EXIT_FAILURE</code> from <code>main()</code> is the way the C standards recommend reporting success or failure of the entire process. (BSD variants have attempted to standardize some other codes; if your system has a <code>&lt;sysexits.h&gt;</code> header, you could use those. But do note that they are not \"standard\", just the closest thing we have to an agreement how a process can report error codes.)<br>&nbsp;</p></li>\n<li><p>Reserve a specific return value for errors, and use a global or thread-local variable (usually <code>errno</code>) to describe the error</p>\n\n<p>Most standard C library functions do this, with functions returning <code>int</code> using <code>-1</code> for the error, and functions returning a pointer using <code>NULL</code> to indicate the error.<br>&nbsp;</p></li>\n<li><p>Use an extra parameter to point to an error indicator.</p>\n\n<p>This approach is common with code and interfaces deriving from Fortran. Often, the error indicator is optional, and may be left <code>NULL</code> if the caller is not interested in whether the result is valid or not.<br>&nbsp;</p></li>\n</ol>\n\n<p>My own rules are simple:</p>\n\n<ul>\n<li><p>Prefer the second approach when writing a low-level library. It is familiar approach to those familiar with the standard C library.</p></li>\n<li><p>Use the first approach for recoverable errors.</p>\n\n<p>Often, I combine it with the second one, using <code>return 0;</code> for success, and <code>return errno;</code> or <code>return errno = EINVAL;</code> etc. for errors. (The last one first assigns <code>EINVAL</code> to <code>errno</code>, and then returns <code>EINVAL</code>.)</p></li>\n<li><p>Use the third approach when error state should be retained over a number of operations, or there is a structure whose state errors affect.</p></li>\n</ul>\n\n<hr>\n\n<p>Let's look how these methods differ in practice.</p>\n\n<p>A very common thing to do is to parse command-line arguments as numbers. Let's look at a case where the arguments are to be used as <code>double</code>s, for some kind of calculation:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int     arg;\n    double  val;    \n\n    for (arg = 1; arg &lt; argc; arg++) {\n        if (sscanf(argv[arg], \"%lf\", &amp;val) == 1) {\n            printf(\"argv[%d] = %.6f\\n\", arg, val);\n        } else {\n            printf(\"%s: Not a number.\\n\", argv[arg]);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The above uses <code>sscanf()</code> to convert a string. Unfortunately, it does not check for any trailing garbage, so it accepts for example <code>1.5k</code> as <code>1.5</code>. To avoid that, we can use a dummy character to detect trailing garbage:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int     arg;\n    double  val;\n    char    dummy;\n\n    for (arg = 1; arg &lt; argc; arg++) {\n        if (sscanf(argv[arg], \"%lf %c\", &amp;val, &amp;dummy) == 1) {\n            printf(\"argv[%d] = %.6f\\n\", arg, val);\n        } else {\n            printf(\"%s: Not a number.\\n\", argv[arg]);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>That works, because <code>sscanf()</code> returns the number of successful conversions, and we expect only the double conversion (<code>%lf</code>) to work, and the char conversion (<code>%c</code>) to fail.</p>\n\n<p>Unfortunately, scanf family of functions does not check for overflow. If you supply a large enough number, it gets silently mangled. Not good.  To avoid that, we can use <code>strtod()</code>. To make use simpler, we can put it in a separate function, <code>parse_double()</code>. But, how should that return the value, and the possible error? Which one of the following to implement?</p>\n\n<pre><code>/* Convert the initial double, returning the pointer to the rest of the\n   string; or NULL if an error occurs. */\nconst char *parse_double(const char *src, double *to);\n\n/* If the string contains exactly one double, convert it and return 0.\n   Otherwise return a nonzero error code. */\nint parse_double(const char *src, double *to);\n\n/* Convert the string to a double as best as you can. If an error occurs, return 'errval'. */\ndouble parse_double(const char *src, const double errval);\n</code></pre>\n\n<p>So, which one of these is the best?</p>\n\n<p>The answer is, of course, <strong>it depends on the use case</strong>.</p>\n\n<p>I've actually implemented all three (in separate programs), depending on which one has been the most appropriate one.</p>\n\n<p>The first one is especially useful when the same function is used to parse input files, and/or we allow any number of doubles per parameter/line. It is very easy to use in a loop.</p>\n\n<p>The second one is what I most often use in programs. Very often, I use</p>\n\n<pre><code>typedef struct {\n    double  x;\n    double  y;\n    double  z;\n} vec3d;\n\nint parse_vector(const char *src, vec3d *to)\n{\n    vec3d  temp;\n    char   dummy;\n\n    if (!src || !*src)\n        return -1; /* NULL or empty string */\n\n    if (sscanf(src, \" %lf %lf %lf %c\", &amp;temp.x, &amp;temp.y, &amp;temp.z, &amp;dummy) == 3 ||\n        sscanf(src, \" %lf %*[.,:/] %lf %*[.,:/] %lf %c\", &amp;temp.x, &amp;temp.y, &amp;temp.z, &amp;dummy) == 3) {\n        if (to)\n            *to = temp;\n        return 0;\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>which allows one to specify a 3D vector on the command line using <code>1+2+3</code>, <code>1/2/3</code>, <code>1:2:3</code>, or even <code>'1 2 3'</code> or <code>\"1 2 3\"</code> (the quotes are needed to stop the shell from splitting it to three separate arguments).  It does not check for <code>double</code> overflow, so it is important to show the parsed vector in the output, so that the user can detect if their input was misparsed.</p>\n\n<p>(The asterisk <code>*</code> in <code>%*[.,:/]</code> means the result of the conversion is not stored anywhere, and the conversion is not counted in the return value. <code>[</code> is a conversion specifier, \"converting\" any and all of the characters in the list, terminated with a <code>]</code> character. <code>[^</code> is the inverse, \"converting\" any and all characters <em>not</em> in the list.)</p>\n"}, {"tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1545268839, "creation_date": 1545268839, "answer_id": 53861298, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions/53861298#53861298", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>One thing I've realized is that it is often not worth the trouble to percolate fatal errors up the stack.  If something fails in a way that makes forward progress impossible, just end the program there.   I usually deal with it by creating an <code>error_exit</code> function that I can call from anywhere:</p>\n\n<pre><code>void error_exit(int code, const char* message) {\n  printf(\"Error %d: %s\\nExiting!\\n\", code, message);\n  cleanup();\n  exit(code);\n}\n\nfloat* nested_function(int input, ...) {\n  if (causes_hopeless_failure(input)) {\n    error_exit(err_HOPELESS, \"invalid input to nested_function\");\n  }\n  //normal processing proceeds ...\n  return valid_pointer;\n}\n\nint main() {\n   float* vector = function_which_eventually_calls_nested_function();\n   cleanup();\n   return 0;\n}\n</code></pre>\n\n<p>The <code>cleanup</code> function is used to deal with resources that don't get cleaned up correctly on program exit.  File handles and allocated buffers don't usually fall into this category. I generally use it for system configuration changes that need to be undone.</p>\n"}, {"comments": [{"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "edited": false, "score": 0, "creation_date": 1545580480, "post_id": 53904977, "comment_id": 94654589, "body": "Note that the list above is not exhaustive."}], "tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": false, "score": 0, "last_activity_date": 1545580459, "last_edit_date": 1545580459, "creation_date": 1545579999, "answer_id": 53904977, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions/53904977#53904977", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>C has out-of-band error code handling, it's been in there since forever.</p>\n\n<pre><code>#include &lt;errno.h&gt;\n\nint do_something(char* data) {\n   if ( data == 0 ) {\n      errno = ENODATA;\n      return 0;\n   }\n   ... do stuff ...\n}\n</code></pre>\n\n<p>... in the caller ...</p>\n\n<pre><code>int value = do_something( \"one\" );\nif ( int errornum = errno ) {\n   fprintf(\"error (%d) could not do something: %s\", strerror( errornum ) );\n   return; // or exit;\n} \n</code></pre>\n\n<p>if wishing to chain errors</p>\n\n<pre><code>int value = do_something( \"one\" );\nif ( int errornum = errno ) {\n   fprintf(\"error (%d) could not do something: %s\", strerror( errornum ) );\n   errno = errornum;\n   return; // or exit;\n} \n</code></pre>\n\n<p>Keep in mind that errno is reset by nearly every standard function call, so you need to capture it and then optionally set it again after you do whatever you want.</p>\n\n<p>The reason errno is typically not used as heavily as it should be is probably becasue too many people are taught in-band error reporting (through special sentinels / values) first.  In addition, it takes more lines of code to properly check error codes.  That said, it is a far better solution, as you don't overload a return value with data and control information in the same variable.</p>\n\n<p>There are already many error codes set, odd are you can reuse one for your needs, or pick one that's close enough</p>\n\n<pre><code>1  EPERM Operation not permitted\n2   ENOENT  No such file or directory\n3   ESRCH   No such process\n4   EINTR   Interrupted system call\n5   EIO     I/O error\n6   ENXIO   No such device or address\n7   E2BIG   Argument list too long\n8   ENOEXEC     Exec format error\n9   EBADF   Bad file number\n10  ECHILD  No child processes\n11  EAGAIN  Try again\n12  ENOMEM  Out of memory\n13  EACCES  Permission denied\n14  EFAULT  Bad address\n15  ENOTBLK     Block device required\n16  EBUSY   Device or resource busy\n17  EEXIST  File exists\n18  EXDEV   Cross-device link\n19  ENODEV  No such device\n20  ENOTDIR     Not a directory\n21  EISDIR  Is a directory\n22  EINVAL  Invalid argument\n23  ENFILE  File table overflow\n24  EMFILE  Too many open files\n25  ENOTTY  Not a typewriter\n26  ETXTBSY     Text file busy\n27  EFBIG   File too large\n28  ENOSPC  No space left on device\n29  ESPIPE  Illegal seek\n30  EROFS   Read-only file system\n31  EMLINK  Too many links\n32  EPIPE   Broken pipe\n33  EDOM    Math argument out of domain of func\n34  ERANGE  Math result not representable\n35  EDEADLK     Resource deadlock would occur\n36  ENAMETOOLONG    File name too long\n37  ENOLCK  No record locks available\n38  ENOSYS  Function not implemented\n39  ENOTEMPTY   Directory not empty\n40  ELOOP   Too many symbolic links encountered\n42  ENOMSG  No message of desired type\n43  EIDRM   Identifier removed\n44  ECHRNG  Channel number out of range\n45  EL2NSYNC    Level 2 not synchronized\n46  EL3HLT  Level 3 halted\n47  EL3RST  Level 3 reset\n48  ELNRNG  Link number out of range\n49  EUNATCH     Protocol driver not attached\n50  ENOCSI  No CSI structure available\n51  EL2HLT  Level 2 halted\n52  EBADE   Invalid exchange\n53  EBADR   Invalid request descriptor\n54  EXFULL  Exchange full\n55  ENOANO  No anode\n56  EBADRQC     Invalid request code\n57  EBADSLT     Invalid slot\n59  EBFONT  Bad font file format\n60  ENOSTR  Device not a stream\n61  ENODATA     No data available\n62  ETIME   Timer expired\n63  ENOSR   Out of streams resources\n64  ENONET  Machine is not on the network\n65  ENOPKG  Package not installed\n66  EREMOTE     Object is remote\n67  ENOLINK     Link has been severed\n68  EADV    Advertise error\n69  ESRMNT  Srmount error\n70  ECOMM   Communication error on send\n71  EPROTO  Protocol error\n72  EMULTIHOP   Multihop attempted\n73  EDOTDOT     RFS specific error\n74  EBADMSG     Not a data message\n75  EOVERFLOW   Value too large for defined data type\n76  ENOTUNIQ    Name not unique on network\n77  EBADFD  File descriptor in bad state\n78  EREMCHG     Remote address changed\n79  ELIBACC     Can not access a needed shared library\n80  ELIBBAD     Accessing a corrupted shared library\n81  ELIBSCN     .lib section in a.out corrupted\n82  ELIBMAX     Attempting to link in too many shared libraries\n83  ELIBEXEC    Cannot exec a shared library directly\n84  EILSEQ  Illegal byte sequence\n85  ERESTART    Interrupted system call should be restarted\n86  ESTRPIPE    Streams pipe error\n87  EUSERS  Too many users\n88  ENOTSOCK    Socket operation on non-socket\n89  EDESTADDRREQ    Destination address required\n90  EMSGSIZE    Message too long\n91  EPROTOTYPE  Protocol wrong type for socket\n92  ENOPROTOOPT     Protocol not available\n93  EPROTONOSUPPORT     Protocol not supported\n94  ESOCKTNOSUPPORT     Socket type not supported\n95  EOPNOTSUPP  Operation not supported on transport endpoint\n96  EPFNOSUPPORT    Protocol family not supported\n97  EAFNOSUPPORT    Address family not supported by protocol\n98  EADDRINUSE  Address already in use\n99  EADDRNOTAVAIL   Cannot assign requested address\n100     ENETDOWN    Network is down\n101     ENETUNREACH     Network is unreachable\n102     ENETRESET   Network dropped connection because of reset\n103     ECONNABORTED    Software caused connection abort\n104     ECONNRESET  Connection reset by peer\n105     ENOBUFS     No buffer space available\n106     EISCONN     Transport endpoint is already connected\n107     ENOTCONN    Transport endpoint is not connected\n108     ESHUTDOWN   Cannot send after transport endpoint shutdown\n109     ETOOMANYREFS    Too many references: cannot splice\n110     ETIMEDOUT   Connection timed out\n111     ECONNREFUSED    Connection refused\n112     EHOSTDOWN   Host is down\n113     EHOSTUNREACH    No route to host\n114     EALREADY    Operation already in progress\n115     EINPROGRESS     Operation now in progress\n116     ESTALE  Stale NFS file handle\n117     EUCLEAN     Structure needs cleaning\n118     ENOTNAM     Not a XENIX named type file\n119     ENAVAIL     No XENIX semaphores available\n120     EISNAM  Is a named type file\n121     EREMOTEIO   Remote I/O error\n122     EDQUOT  Quota exceeded\n123     ENOMEDIUM   No medium found\n124     EMEDIUMTYPE     Wrong medium type\n125     ECANCELED   Operation Canceled\n126     ENOKEY  Required key not available\n127     EKEYEXPIRED     Key has expired\n128     EKEYREVOKED     Key has been revoked\n129     EKEYREJECTED    Key was rejected by service\n130     EOWNERDEAD  Owner died\n131     ENOTRECOVERABLE     State not recoverable\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10657369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a231b47bc6699de289b03d448427002?s=128&d=identicon&r=PG&f=1", "display_name": "MathewN", "link": "https://stackoverflow.com/users/10657369/mathewn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 53860110, "answer_count": 5, "score": 1, "last_activity_date": 1545580459, "creation_date": 1545257528, "question_id": 53859856, "link": "https://stackoverflow.com/questions/53859856/what-are-the-best-practices-for-returning-one-of-mulitple-errors-from-functions", "title": "What are the best practices for returning one of mulitple errors from functions and ending the program in C?", "body": "<p>I cann't find a way to return an error from a function inside an function, and ending the program.</p>\n\n<p>I was thinking of using a struct and storing the returning value inside and end it this way, but I don't know if this is the best practise</p>\n\n<p>Lets say I have a programm like this:</p>\n\n<pre><code>int main()\n{\n  // do stuff \n  importantFunction();\n  // do stuff\n  return 0;\n}\n</code></pre>\n\n<p>In the importantFunction() I am calling two other functions which are doing some Bitshifting and are returning an array always. Now I want to try to return 1 (or 0x01 because the function is returning an array pointer) if an error happends in one of this function, but I am not sure how.</p>\n\n<pre><code>char *importantFunction()\n{\n  //do stuff\n  secoundFunction();\n  thirdFunction();\n  //do stuff\n  return array;\n }\n\n\nchar *secoundFunction()\n{\n  // do stuff\n  if (something == x)\n    return array;\n  // do stuff\n  return array;\n}\n</code></pre>\n\n<p>I am just trying to find an methode without having to check the first function if it is equall to something and then end the program in int main.\nI am trying to avoid this, because it is not working always:</p>\n\n<pre><code>int main()\n{\n  // do stuff \n  char *pointer = importantFunction();\n  if (*pointer == 'something')\n    return 1;\n  if (*pointer == 'something')\n    return 2;\n  if (*pointer == 'something')\n    return 3;\n  // and so on...\n  // do stuff\n  return 0;\n}\n</code></pre>\n\n<p>I am sorry if this is a stupid question, I am not really good in asking questions.</p>\n"}, {"tags": ["c", "memory", "dynamic"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1545255130, "post_id": 53859417, "comment_id": 94566718, "body": "remove <code>double*</code>. You are not defining anything here."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1545255970, "post_id": 53859417, "comment_id": 94567084, "body": "you wanted <code>array_counts[i].array = (double *)calloc(n, 8);</code> instead"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1545255998, "post_id": 53859417, "comment_id": 94567094, "body": "Aside: rather than <code>calloc(n, 8)</code>, avoid magic numbers.  Suggest <code>calloc(n, sizeof array_counts[i].array[0]);</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545257477, "post_id": 53859417, "comment_id": 94567649, "body": "Note that 32-bit integers can only store up to factorial 12."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545293593, "post_id": 53859417, "comment_id": 94576769, "body": "See also Timo&#39;s <a href=\"https://stackoverflow.com/questions/53862059/different-error-messages-while-freeing-allocated-memory\">more recent question</a>.  It doesn&#39;t seem to have been said here, but it helps enormously if you provide an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  You&#39;ve not done that, so we can only wave hands around and guess.  You don&#39;t show the <code>shuffle()</code> code; you don&#39;t show the <code>update_array_counts()</code> code; those are candidates for causing trouble.  The printing function is less likely to cause trouble, but it could.  And there&#39;s no <code>main()</code> function, so we don&#39;t know what parameters you&#39;re using."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545350779, "post_id": 53859417, "comment_id": 94602576, "body": "(The more recent question has been deleted, so it is only visible to those with 10K rep.)"}], "owner": {"reputation": 35, "user_id": 10813098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1f1a62713970c85e06c452b4a50c64e?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/10813098/timo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545255163, "creation_date": 1545254989, "last_edit_date": 1545255163, "question_id": 53859417, "link": "https://stackoverflow.com/questions/53859417/c-dynamic-memory-allocation-issue-with-allocating-an-array-of-arrays-dynamicall", "title": "C dynamic memory allocation. Issue with allocating an array of arrays dynamically", "body": "<p>I created a struct, called ArrayCount, that contains a double array and an integer that should count how often an array occurs.</p>\n\n<p>If the size of the double-array is n, the idea is, to create an array of the struct ArrayCount of the size n! (n! is called m in my code).</p>\n\n<p>The idea is to safe each permutation in the ArrayCount-array, counting the occurrences of each permutation, for a given algorithm. \nBut that's just the background information and not part of the problem.</p>\n\n<p>I am having issues allocating the memory. The allocation for the Array-Count array works fine, but I can't allocate the memory for the double-arrays that are included.</p>\n\n<p>The error message is:</p>\n\n<pre><code>error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018.\u2019 token\n</code></pre>\n\n<p>And the error is occurring during the initiate_array_counts function, when I try to allocate the memory with \"double* <code>array_counts[i].array = calloc(n, 8);</code>.</p>\n\n<p>Thanks in advance,\nTimo</p>\n\n<pre><code>typedef struct {\ndouble* array;\nint counter;\n} ArrayCount;\n\nvoid initiate_array_counts(/*INOUT*/ArrayCount* array_counts, \n/*IN*/int n){\n    int m = factorial(n);\n    for(int i = 0; i &lt; m; i++){\n        double* array_counts[i].array = calloc(n, 8);\n        for(int j = 0; j &lt; n; j++){\n            array_counts[i].array[j] = 0;\n        }\n    }\n}\n\nvoid shuffle_frequency(int n) {\n    double a[n];\n    for (int i = 0; i &lt; n; i++) {\n        a[i] = i; // 0, 1, 2, ..., n - 1\n    }\n    int m = factorial(n);\n    ArrayCount* array_counts = calloc(m, sizeof(ArrayCount));\n    initiate_array_counts(array_counts, n);\n    for (int i = 0; i &lt; 1000 * m; i++) {\n        shuffle(a, n);\n        update_array_counts(array_counts, m, a, n);\n    }\n    for (int i = 0; i &lt; m; i++) {\n                printf(\"%4d%8d    \", i, array_counts[i].counter);\n        printdaln(array_counts[i].array, n);\n    }\n    free(array_counts);\n}\n</code></pre>\n\n<p>(I included only the necessary code)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545253607, "post_id": 53859142, "comment_id": 94566112, "body": "Do you know what a <code>struct</code> is and how to use it?"}, {"owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545253870, "post_id": 53859142, "comment_id": 94566229, "body": "no I haven&#39;t learned it yet so they won&#39;t let me use it"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1545253982, "post_id": 53859142, "comment_id": 94566273, "body": "LidorCohen, Stack Overflow lets you use <code>struct</code>."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1545255271, "post_id": 53859142, "comment_id": 94566778, "body": "You cannot <i>return</i> multiple values.  You can write to multiple output parameters - <code>void optionThree( float radius, float *perimeter, float *area ) { *perimeter = TWO * PI * radius; *area = PI * ( radius * radius ); }</code>.  Assuming you had the variables <code>r</code>, <code>p</code>, and <code>a</code> in the calling function, you&#39;d call it as <code>optionThree( r, &amp;p, &amp;a );</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545255877, "post_id": 53859142, "comment_id": 94567047, "body": "Then maybe you scan through the things you did learn already and look for something helpful there."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545255940, "post_id": 53859142, "comment_id": 94567069, "body": "When you are restricted like that by a teacher, then most likely your question about returning two values is an XY problem. Please describe more about your assignment."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545255997, "post_id": 53859142, "comment_id": 94567093, "body": "My guess would be: Use two functions, one calculating the perimeter, one calculating the area."}], "owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1545253640, "answer_count": 0, "score": 0, "last_activity_date": 1545253572, "creation_date": 1545253550, "last_edit_date": 1545253572, "question_id": 53859142, "link": "https://stackoverflow.com/questions/53859142/is-it-possible-to-return-two-values-from-a-function", "closed_reason": "Duplicate", "title": "Is it possible to return two values from a function", "body": "<p>Like Area and Perimeter how do I return 2 of these variables in one function</p>\n\n<p>I have this</p>\n\n<pre><code>float optionThree(float radius)\n{\n    float perimeter = 0;\n    float area = 0;\n    perimeter = TWO * PI * radius;\n    area = PI * (radius * radius);\n\n    return perimeter, area;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 2, "creation_date": 1545253031, "post_id": 53858996, "comment_id": 94565866, "body": "You&#39;ve got some really cool patterns, but it&#39;s not clear what sort of array or switch statement you&#39;re looking for. Please provide a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, verifiable example</a> showing what you&#39;re attempting to do and where you&#39;re stuck. Otherwise, it&#39;s pretty much guesswork as far as what sort of array/switch will actually help you here."}, {"owner": {"reputation": 55, "user_id": 10759325, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K9lMOXS6ihM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iomjg78Brj0VzC-JpqfYztNlku6g/mo/photo.jpg?sz=128", "display_name": "Mondel Craguey", "link": "https://stackoverflow.com/users/10759325/mondel-craguey"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1545253514, "post_id": 53858996, "comment_id": 94566079, "body": "@ggorlen Characters, it must be 4 cases in switch, 1 for each patern, for example case&#39;K&#39; which should be king"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545253689, "post_id": 53858996, "comment_id": 94566147, "body": "How will you distinguish <code>&#39;K&#39;</code> between Knight and King? An answer shows the use of <code>enum</code> which you can also use for indexing arrays, such as the names of the pieces."}, {"owner": {"reputation": 55, "user_id": 10759325, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K9lMOXS6ihM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iomjg78Brj0VzC-JpqfYztNlku6g/mo/photo.jpg?sz=128", "display_name": "Mondel Craguey", "link": "https://stackoverflow.com/users/10759325/mondel-craguey"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545254028, "post_id": 53858996, "comment_id": 94566281, "body": "@WeatherVane It does not have to be exactly K, it can be any other character, you can use A,B,C,D if u want, all i need is to add patterns to array with Switch"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10759325, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K9lMOXS6ihM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iomjg78Brj0VzC-JpqfYztNlku6g/mo/photo.jpg?sz=128", "display_name": "Mondel Craguey", "link": "https://stackoverflow.com/users/10759325/mondel-craguey"}, "edited": false, "score": 0, "creation_date": 1547021442, "post_id": 53859111, "comment_id": 95043512, "body": "Yeah, that works but i cant add them to look in this order like in this picture <a href=\"https://imgur.com/a/5405d3u\" rel=\"nofollow noreferrer\">imgur.com/a/5405d3u</a> ,  one line seems to always go away"}], "tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1545253400, "creation_date": 1545253400, "answer_id": 53859111, "question_id": 53858996, "link": "https://stackoverflow.com/questions/53858996/adding-characters-to-array-using-switch-in-c/53859111#53859111", "title": "Adding characters to Array using Switch in C", "body": "<p>Although vague, I'll make some assumptions.</p>\n\n<p>I'll assume by \"character\" you mean one of the following: Rook, Knight, Bishop</p>\n\n<p>First it's a good idea to enclose these \"characters\" in an enum such as:</p>\n\n<pre><code>enum characters {Rook, Knight, Bishop};\n</code></pre>\n\n<p>Next you create your array (and optionally initialise it) as follows:</p>\n\n<pre><code>enum characters my_fancy_array[] = {Rook, Knight, Bishop, Knight, Rook};\n</code></pre>\n\n<p>You may populate the array in other ways by maybe an input from the user. The idea might be to then iterate through the array and print its contents in the format you specify.</p>\n\n<p>Finally your switch would look like this:</p>\n\n<pre><code>switch (my_fancy_array[i]) {\n    case Rook:\n        printf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);~\n        ...\n        break;\n\n    case Bishop:\n        printf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\n        ...\n        break;\n\n    case Knight:\n        printf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\n        ...\n        break;\n    default:\n        break;\n}\n</code></pre>\n\n<p>where <code>i</code> is some index of the array.</p>\n\n<p>A good practice is to encapsulate those printfs in functions.</p>\n"}], "owner": {"reputation": 55, "user_id": 10759325, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K9lMOXS6ihM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iomjg78Brj0VzC-JpqfYztNlku6g/mo/photo.jpg?sz=128", "display_name": "Mondel Craguey", "link": "https://stackoverflow.com/users/10759325/mondel-craguey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545253400, "creation_date": 1545252755, "question_id": 53858996, "link": "https://stackoverflow.com/questions/53858996/adding-characters-to-array-using-switch-in-c", "title": "Adding characters to Array using Switch in C", "body": "<p>I need help on how to add characters to array using SWITCH(must be done using switch) and then print that array.\nOutput in array looks like this : <a href=\"https://imgur.com/a/5405d3u\" rel=\"nofollow noreferrer\">https://imgur.com/a/5405d3u</a></p>\n\n<p>I have created the patterns:Rook</p>\n\n<p>Rook</p>\n\n<pre><code>printf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,0,0,0,0,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,0,0,0,0,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,0,0,0,0,0,0,0,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);`\n\nKnight\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,0,0,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,0,0,0,177,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,0,0,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\n\nBishop\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,219,219,219,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,219,219,219,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",0,0,0,0,0,0,0,0,0,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\n\nKing\n\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,177,177,0,0,177,177,0,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,0,0,0,0,0,0,0,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,0,0,0,0,177,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,0,0,0,0,0,0,177,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,0,0,0,0,0,0,0,0,177);\nprintf(\"%c%c%c%c%c%c%c%c%c%c\\n\",177,177,177,177,177,177,177,177,177,177);\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 6, "creation_date": 1545248723, "post_id": 53858176, "comment_id": 94564112, "body": "why not just check the return value of <code>read</code> ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1545248838, "post_id": 53858176, "comment_id": 94564174, "body": "&quot;Upon successful completion, read() and pread() shall return a non-negative integer indicating the number of bytes actually read&quot;. <code>c</code> is probably unmodified. <code>EOF</code> is returned by <code>getc</code>, not by <code>read</code>. This code should work. Remove <code>if(c == EOF || c == &#39;\\0&#39;) break;</code> as if your file contains a 0 character it will stop when there are still bytes to read"}, {"owner": {"reputation": 23, "user_id": 10623010, "user_type": "registered", "profile_image": "https://graph.facebook.com/509357656233570/picture?type=large", "display_name": "Nurlan Imanov", "link": "https://stackoverflow.com/users/10623010/nurlan-imanov"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1545249267, "post_id": 53858176, "comment_id": 94564359, "body": "Return value of read() function will be 0 when it reads also last empty character of the file but I want to avoid to read last empty character."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1545249320, "post_id": 53858176, "comment_id": 94564384, "body": "there is <i>no</i> empty character. <code>c</code> has the value it had after the last <i>successful</i> read"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545249410, "post_id": 53858176, "comment_id": 94564420, "body": "Can&#39;t reproduce the issue. Try this <code>while(1){         int readd =read(fd,&amp;c,1);         if (c == EOF || readd == 0)                 break;         printf(&quot;%c&quot;,c); }</code> May be you are confusing with <code>\\n</code> of <code>printf()</code>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1545249454, "post_id": 53858176, "comment_id": 94564442, "body": "There is no last empty character. You are probably (not) seeing a newline character. Try printing out the character as a small hex number."}, {"owner": {"reputation": 23, "user_id": 10623010, "user_type": "registered", "profile_image": "https://graph.facebook.com/509357656233570/picture?type=large", "display_name": "Nurlan Imanov", "link": "https://stackoverflow.com/users/10623010/nurlan-imanov"}, "edited": false, "score": 0, "creation_date": 1545249589, "post_id": 53858176, "comment_id": 94564496, "body": "Try to write a word inside a fooooo file with 6 character you will  see seven 1 in the output it will read last empty character also"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 3, "creation_date": 1545249804, "post_id": 53858176, "comment_id": 94564584, "body": "The &quot;last empty character&quot; is very likely a newline.  What is the output of <code>wc</code> for your input file?  My bet is there are 7 characters in the file you think only has 6."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1545250262, "post_id": 53858176, "comment_id": 94564756, "body": "&quot;//I have a problem with this line&quot; sure : if is wrongly placed before to test the value returned by the <i>read</i> function"}, {"owner": {"reputation": 23, "user_id": 10623010, "user_type": "registered", "profile_image": "https://graph.facebook.com/509357656233570/picture?type=large", "display_name": "Nurlan Imanov", "link": "https://stackoverflow.com/users/10623010/nurlan-imanov"}, "edited": false, "score": 0, "creation_date": 1545250403, "post_id": 53858176, "comment_id": 94564811, "body": "Thank you all.I have solved problem with your help,I just added if(c==&#39;\\n&#39;) break ; and it works."}, {"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 1, "creation_date": 1545255120, "post_id": 53858176, "comment_id": 94566713, "body": "You understand that will stop reading whenever it encounters a newline, right? So you can&#39;t use that if the file is more than one line?"}], "owner": {"reputation": 23, "user_id": 10623010, "user_type": "registered", "profile_image": "https://graph.facebook.com/509357656233570/picture?type=large", "display_name": "Nurlan Imanov", "link": "https://stackoverflow.com/users/10623010/nurlan-imanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545250256, "creation_date": 1545248588, "last_edit_date": 1545250256, "question_id": 53858176, "link": "https://stackoverflow.com/questions/53858176/how-can-i-avoid-to-read-last-character-of-a-file-if-i-use-read-function-to-rea", "title": "how can I avoid to read last character of a file if I use read() function to read character one by one", "body": "<p>How can I avoid reading the last character of a file if I use the <code>read()</code> function to read characters one by one? In this example, I have tried to use <code>EOF</code> and '\\0', but it doesn't help me. Every time I have 6 characters, but it reads 7 characters with last being an empty one.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main() {\n    int fd = open(\"foooooo\", O_RDONLY | O_CREAT , 0666);\n    char c;\n\n    while(1) {\n        int readd = read(fd, &amp;c, 1);\n        if (c == EOF || c == '\\0') break; //I have a problem with this line \n        if (readd == 0) break;\n        printf(\"%d\\n\", readd);\n        printf(\"%c\\n\", c);\n   }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "sockets", "bluetooth", "hci"], "comments": [{"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545248717, "post_id": 53857864, "comment_id": 94564108, "body": "Quick note, there are two &quot;different&quot; sets of HCI commands, one for BT classic and one for BT LE. You need to specify whether you are using ble, bt classic or both. I&#39;m assuming the API you&#39;re using supports both."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 5721839, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-cqGkX2ngzTQ/AAAAAAAAAAI/AAAAAAAAAQM/y9k8pJDMNF4/photo.jpg?sz=128", "display_name": "Sean McVeigh", "link": "https://stackoverflow.com/users/5721839/sean-mcveigh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545421372, "creation_date": 1545421372, "answer_id": 53890011, "question_id": 53857864, "link": "https://stackoverflow.com/questions/53857864/details-on-hci-filter-socket-options/53890011#53890011", "title": "Details on HCI filter socket options?", "body": "<p>So, I was looking through the <a href=\"https://github.com/noble/noble/\" rel=\"nofollow noreferrer\">noble</a> <a href=\"https://github.com/noble/noble/blob/c4cd18a7a429bb832f6c4ca793be3faf9af884e9/lib/hci-socket/hci.js#L130\" rel=\"nofollow noreferrer\">source</a> and found this:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>Hci.prototype.setSocketFilter = function() {\n  var filter = new Buffer(14);\n  var typeMask = (1 &lt;&lt; HCI_COMMAND_PKT) | (1 &lt;&lt; HCI_EVENT_PKT) | (1 &lt;&lt; HCI_ACLDATA_PKT);\n  var eventMask1 = (1 &lt;&lt; EVT_DISCONN_COMPLETE) | (1 &lt;&lt; EVT_ENCRYPT_CHANGE) | (1 &lt;&lt; EVT_CMD_COMPLETE) | (1 &lt;&lt; EVT_CMD_STATUS);\n  var eventMask2 = (1 &lt;&lt; (EVT_LE_META_EVENT - 32));\n  var opcode = 0;\n\n  filter.writeUInt32LE(typeMask, 0);\n  filter.writeUInt32LE(eventMask1, 4);\n  filter.writeUInt32LE(eventMask2, 8);\n  filter.writeUInt16LE(opcode, 12);\n\n  debug('setting filter to: ' + filter.toString('hex'));\n  this._socket.setFilter(filter);\n};\n</code></pre>\n\n<p>So the mask is defined as the bit shifted left by the constant's value defined in the Bluetooth Core Volume 2, Part E, Section 5 &amp; 7.</p>\n"}], "owner": {"reputation": 499, "user_id": 5721839, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-cqGkX2ngzTQ/AAAAAAAAAAI/AAAAAAAAAQM/y9k8pJDMNF4/photo.jpg?sz=128", "display_name": "Sean McVeigh", "link": "https://stackoverflow.com/users/5721839/sean-mcveigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545421372, "creation_date": 1545247165, "question_id": 53857864, "link": "https://stackoverflow.com/questions/53857864/details-on-hci-filter-socket-options", "title": "Details on HCI filter socket options?", "body": "<p>While I was testing some basic HCI commands using python's <code>socket</code> library, it seems that in order to get any socket traffic using <code>AF_BLUETOOTH</code> and <code>BTPROTO_HCI</code> a \"pass all\" filter needs to be set in the socket options:</p>\n\n<pre class=\"lang-python prettyprint-override\"><code>from socket import socket, AF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI, SOL_HCI, HCI_FILTER\nfrom struct import pack\n\nPASS_ALL = pack(\"IIIh2x\", 0xffffffff, 0xffffffff, 0xffffffff, 0)\n\ndef open_socket_with_hci(dev_id: int):\n    hci = socket(AF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI)\n    hci.bind((dev_id,))\n    hci.setsockopt(SOL_HCI, HCI_FILTER, PASS_ALL)\n    return hci\n</code></pre>\n\n<p>I found <a href=\"http://gbrault.github.io/gattclient/structhci__filter.html\" rel=\"nofollow noreferrer\">hci_filter</a> struct defined as: </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct hci_filter {\n    uint32_t type_mask;\n    uint32_t event_mask[2];\n    uint16_t opcode;\n};\n</code></pre>\n\n<p>The opcode mask is straight forward enough. I'm assuming <code>type_mask</code> is a mask on values (code from <a href=\"https://github.com/torvalds/linux/blob/62393dbcbe0f3001691e4bd479a25beb5941f2ed/include/net/bluetooth/hci.h#L288\" rel=\"nofollow noreferrer\">hci.h</a>):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* HCI data types */\n#define HCI_COMMAND_PKT     0x01\n#define HCI_ACLDATA_PKT     0x02\n#define HCI_SCODATA_PKT     0x03\n#define HCI_EVENT_PKT       0x04\n#define HCI_DIAG_PKT        0xf0\n#define HCI_VENDOR_PKT      0xff\n</code></pre>\n\n<p>But could someone please explain the 2x <code>event_mask</code>s? Is the 1st for HCI Event Type and the 2nd for Subevent Type (i.e. LE Meta Event)?</p>\n"}, {"tags": ["c++", "c", "eclipse", "arduino", "avr"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1545246559, "post_id": 53857673, "comment_id": 94563237, "body": "Maybe you want this? <code>Right Click on &quot;project&quot;</code>-&gt;<code>Properties</code>-&gt;<code>C&#47;C++ General</code>-&gt;<code>Processor Include Paths, Macros etc..</code>-&gt;<code>GNU C++</code>-&gt;<code>CDT User Settings</code>-&gt;<code>Add</code>"}, {"owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1545247093, "post_id": 53857673, "comment_id": 94563452, "body": "I am not seeing Processor Include Paths anywhere. I did find add PATH under the Linked Resources tab. However, I am still uncertain why parts mentioned in the official documentation are missing."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1545248564, "post_id": 53857673, "comment_id": 94564030, "body": "You should have &quot;C/C++ Build&quot; tab as well. It looks like you have some wrong or unsupported project type."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545249369, "post_id": 53857673, "comment_id": 94564407, "body": "Which eclipse version are you using? And on which platform is it?"}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545249427, "post_id": 53857673, "comment_id": 94564429, "body": "Also, make sure you right click on the MAIN project then go to properties from the bottom of the list."}, {"owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "edited": false, "score": 0, "creation_date": 1545250270, "post_id": 53857673, "comment_id": 94564760, "body": "I am using Oxygen.3a Release (4.7.3a) and was looking at the main."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1545251475, "post_id": 53857673, "comment_id": 94565217, "body": "You are likely missing some plugins installed"}, {"owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "edited": false, "score": 0, "creation_date": 1545252297, "post_id": 53857673, "comment_id": 94567095, "body": "I am really new to C++ so I don&#39;t understand this entirely. What appears to be the problem is that I am using a default template (specifically the Arduino Plugin). This does not include the Cross GCC toolchain. Therefore when looking through the project properties many things are missing. This includes &quot;C/C++ Build&quot; and the PATH variables. If I create a normal C++ project I am able to see everything as expected and amend the PATH."}], "answers": [{"tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1545254127, "creation_date": 1545254127, "answer_id": 53859230, "question_id": 53857673, "link": "https://stackoverflow.com/questions/53857673/how-do-i-the-add-path-to-a-3rd-party-library-eclipse-arduino/53859230#53859230", "title": "How do I the add path to a 3rd party library? - Eclipse/Arduino", "body": "<p>So here is the solution, I've installed oxygen 3a and here are the steps:</p>\n\n<ol>\n<li><a href=\"https://imgur.com/AKkW815\" rel=\"nofollow noreferrer\">https://imgur.com/AKkW815</a></li>\n<li><a href=\"https://imgur.com/dV0GqZQ\" rel=\"nofollow noreferrer\">https://imgur.com/dV0GqZQ</a></li>\n<li><a href=\"https://imgur.com/fM6NRwL\" rel=\"nofollow noreferrer\">https://imgur.com/fM6NRwL</a></li>\n<li><a href=\"https://imgur.com/861wM1W\" rel=\"nofollow noreferrer\">https://imgur.com/861wM1W</a></li>\n<li><a href=\"https://imgur.com/MsMCaPu\" rel=\"nofollow noreferrer\">https://imgur.com/MsMCaPu</a></li>\n</ol>\n\n<p>I'm sure you can take over from here.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "is_accepted": true, "score": 0, "last_activity_date": 1546464781, "creation_date": 1546464781, "answer_id": 54013436, "question_id": 53857673, "link": "https://stackoverflow.com/questions/53857673/how-do-i-the-add-path-to-a-3rd-party-library-eclipse-arduino/54013436#54013436", "title": "How do I the add path to a 3rd party library? - Eclipse/Arduino", "body": "<p>Turned out to be really simple. In short you do not need to add the path of the library to eclipse.</p>\n\n<pre><code>//If you use:\n&lt;header.hpp&gt; //Eclipse looks at the current directory\n//but you could instead say\n&lt;path-to-header/header.hpp&gt;\n</code></pre>\n\n<p>This eliminates the need to add the path to eclipse via the methods mentioned by everyone else</p>\n"}], "owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 54013436, "answer_count": 2, "score": 1, "last_activity_date": 1546464781, "creation_date": 1545246223, "last_edit_date": 1545347147, "question_id": 53857673, "link": "https://stackoverflow.com/questions/53857673/how-do-i-the-add-path-to-a-3rd-party-library-eclipse-arduino", "title": "How do I the add path to a 3rd party library? - Eclipse/Arduino", "body": "<p>This is my first time coding in C++ and I have no experience with compiler languages. </p>\n\n<p>I am creating an Arduino project using Eclipse. I want include a 3rd party library. I need to add the path of the library in Eclipse but don't know how. The documentation I found said that I should look at the following:</p>\n\n<p>Project --> Properties --> C/C++ General --> Paths and Symbols </p>\n\n<p>but as you can see in the image Paths and Symbols does not exist. I used the the filter bar to search for Paths and did not get any relevant results. The libraries tab also does not let me add the package in any manner. </p>\n\n<p>I think this is because Arduino uses an AVR compiler and not the cross gcc toolchain. If I create a normal C++ package I can add the path to another library. However, I have not yet figured out how to get it to compile for the Arduino.  </p>\n\n<p>How can I add the path to the Arduino project direct eclipse to the 3rd party library that I am using?</p>\n\n<p><a href=\"https://i.stack.imgur.com/oVzd0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVzd0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1545246376, "post_id": 53857642, "comment_id": 94563148, "body": "Can you give an example of the code that worked on Linux but not macOs?  I don&#39;t know how else you would initialize the result of <code>malloc</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10548749"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1545246841, "post_id": 53857642, "comment_id": 94563347, "body": "On linux, no need of the init_null function. My professor told me that It actually worked, but on my mac when I type new-&gt;value, it printed 15780894 for example."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 4, "creation_date": 1545246969, "post_id": 53857642, "comment_id": 94563396, "body": "Then you got lucky on Linux.  There is no guarantee about the contents of memory returned from <code>malloc</code>. You should assume it  contains random values on all platforms.  (even if sometimes, in certain cases, which you probably can&#39;t predict correctly, it might be 0)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545246995, "post_id": 53857642, "comment_id": 94563406, "body": "<code>init_null</code> assigns <code>NULL</code> to <code>root-&gt;value</code>. Nothing in the rest of the code shown assigns a value to <code>root-&gt;value</code> (a.k.a. <code>new-&gt;value</code>). Therefore, without <code>init_null</code>, the behavior of using <code>root-&gt;value</code> is not defined. On the Linux system you tried, it just happened to behave as if it had been initialized to zero."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1545247060, "post_id": 53857642, "comment_id": 94563432, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8029584/why-does-malloc-initialize-the-values-to-0-in-gcc\">Why does malloc initialize the values to 0 in gcc?</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1545247590, "post_id": 53857642, "comment_id": 94563668, "body": "&quot;On linux, there was no issues.&quot; -  that&#39;s purely by accident. Without <code>init_null</code> your code would not explicitly initialize <code>left</code> and <code>right</code> pointers in the first branch of <code>if</code>, which means without extra initialization that code is broken on Linux as well. Also, <code>root-&gt;value = NULL</code>, <code>root-&gt;operator = NULL</code> - this makes no sense. Don&#39;t assign <code>NULL</code> to non-pointer values."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1545249648, "post_id": 53857642, "comment_id": 94564526, "body": "<i>My professor told me that It actually worked</i> I hope that professor didn&#39;t see your source code and then tell you that.  Seriously.  Because if your professor did see your source code using uninitialized memory and then tell you that it worked, your professor doesn&#39;t understand undefined behavior, has no business teaching C, and you really do need to find another professor."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1545250936, "post_id": 53857642, "comment_id": 94565031, "body": "@AShelly I don&#39;t think it&#39;s a duplicate as the author doesn&#39;t know that that was the problem, although the answer may be similar."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545251779, "post_id": 53857642, "comment_id": 94565341, "body": "Moreover, although the representation of null pointers on Linux and, I think, OS X is all-bits-zero, that is not a requirement of the C language, and it is not universal practice.  Therefore, even if you could rely on <code>malloc()</code> to return memory that had been zeroed (or if you used <code>calloc()</code> instead), you would <i>still</i> need to separately initialize all pointers in the allocated space in order for your program to be strictly conforming."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545248791, "post_id": 53858119, "comment_id": 94564147, "body": "Be aware the specification of <code>malloc</code> is not that \u201cIt leaves whatever there was in that memory block there.\u201d It is that malloc returns space for an object \u201cwhose value is indeterminate.\u201d (C 2018 7.22.3.4 2.) This is because, in modern compilers, a call to <code>malloc</code> in source code is not necessarily translated to an actual call in CPU instructions. The compiler is allowed by the C standard to interpret the code and transform it, and modern compilers do aggressive transformations for optimization. When they see indeterminate values being used, they can transform the code in unexpected ways."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545248978, "post_id": 53858119, "comment_id": 94564233, "body": "@EricPostpischil I agree with you. I didn&#39;t attempt to get into a detailed answer. Even further, the compiler the author uses on the macos system may even actually set the memory to zero, which may the the unexpected/indeterminate behaviour."}, {"owner": {"reputation": 6451, "user_id": 1827457, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36a4fa28b2cfce2c219592f7880e4008?s=128&d=identicon&r=PG", "display_name": "LtWorf", "link": "https://stackoverflow.com/users/1827457/ltworf"}, "edited": false, "score": 1, "creation_date": 1545254282, "post_id": 53858119, "comment_id": 94566396, "body": "Normally on linux memory is reset to 0 when a process is started, so that stuff from other processes doesn&#39;t leak in other processes. So a big enough malloc() will get new pages and will be zeroed, but small mallocs, in the beginning will always be 0, but after some frees they will probably be reused memory from the same process and contain garbage data."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "reply_to_user": {"reputation": 6451, "user_id": 1827457, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36a4fa28b2cfce2c219592f7880e4008?s=128&d=identicon&r=PG", "display_name": "LtWorf", "link": "https://stackoverflow.com/users/1827457/ltworf"}, "edited": false, "score": 0, "creation_date": 1545254584, "post_id": 53858119, "comment_id": 94566500, "body": "@LtWorf Good point. I would expect a similar behaviour on a macOS machine as potentially described in this article <a href=\"http://www.cocoawithlove.com/2010/05/look-at-how-malloc-works-on-mac.html\" rel=\"nofollow noreferrer\">cocoawithlove.com/2010/05/look-at-how-malloc-works-on-mac.ht&zwnj;&#8203;ml</a>"}], "tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1545249214, "last_edit_date": 1545249214, "creation_date": 1545248322, "answer_id": 53858119, "question_id": 53857642, "link": "https://stackoverflow.com/questions/53857642/why-do-i-need-to-initialize-result-of-malloc-on-macos/53858119#53858119", "title": "Why do I Need to initialize result of malloc on MacOs?", "body": "<p>Here is the problem:</p>\n\n<p>There are at least 2 memory allocation methods you can use, <code>malloc</code> and <code>calloc</code>. The difference is that <code>malloc</code> DOES NOT initialise (or set) the successfully allocated memory to anything. There is an indeterminate explicit or implicit effect on the memory block, specific to the compiler at this compilation stance, as @EricPostpischil explained.</p>\n\n<p>Whereas <code>calloc</code> sets the successfully allocated memory block to zero. Note that the arguments are slightly different.</p>\n\n<p>Back to your concern, in Linux <code>malloc</code> just happened to allocate a block of memory that had zero in it, whereas on the macos platform there was something in it.</p>\n\n<p>Use <code>calloc</code> if you thing you need it, otherwise do a <code>memset</code> of 0 to the allocated memory block.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10548749"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1545260733, "creation_date": 1545246077, "last_edit_date": 1545253934, "question_id": 53857642, "link": "https://stackoverflow.com/questions/53857642/why-do-i-need-to-initialize-result-of-malloc-on-macos", "title": "Why do I Need to initialize result of malloc on MacOs?", "body": "<p>I have implemented a C calculator to analyses input.\nI have a struct (like a chained list) but on macOS I have to initialise through the init_null function or variable like value have an initial value. \nI have just one question: why? </p>\n\n<p>On Linux, there was no issues. </p>\n\n<pre><code>typedef struct node_t {\n    int value;\n    char operator;\n    struct node_t *left;\n    struct node_t *right;\n} node_t;\n\nnode_t *init_null(node_t *root) {\n    root-&gt;value = NULL;\n    root-&gt;operator = NULL;\n    root-&gt;left = NULL;\n    root-&gt;right = NULL;\n    return root;\n}\n\nnode_t *build_tree(const char *argv[], int *position) {\n    node_t *new = malloc(sizeof(node_t));\n    new = init_null(new); /*sinon erreur*/\n\n    if (isdigit(*argv[*position])) {\n        new-&gt;value = atoi(argv[*position]);\n    } else/*Op\u00e9rateur*/  {\n        new-&gt;operator = *argv[*position];\n        *position = *position + 1;\n        new-&gt;left = build_tree(argv, position);\n        *position = *position + 1;\n        new-&gt;right = build_tree(argv, position);\n    }\n    return new;\n}\n</code></pre>\n\n<p>When run, <code>./main * 2 + 3 4</code> should print <code>(2 * (3 + 4))</code>.</p>\n"}, {"tags": ["c", "string", "fgets", "strcmp"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1545245733, "post_id": 53857550, "comment_id": 94562838, "body": "Hint: what&#39;s strlen(a) and strlen(b)?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 7, "creation_date": 1545245735, "post_id": 53857550, "comment_id": 94562842, "body": "Because <code>fgets()</code> includes the newline at the end of the input and the string you&#39;re comparing with does not."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 2, "creation_date": 1545245899, "post_id": 53857550, "comment_id": 94562909, "body": "<code>&#47;&#47; more like type &quot;house&lt;ENTER&gt;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545254210, "post_id": 53857705, "comment_id": 94566353, "body": "<code>a[strlen(a) - 1] =&#39;\\0&#39;;</code> --&gt; <code>a[strcspn(a, &quot;\\n&quot;)] =&#39;\\0&#39;;</code> is a nice one line alternative without the error concerns."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545254304, "post_id": 53857705, "comment_id": 94566404, "body": "Minor 1  not needed.  Recommend <code>fgets(a, n, stdin);</code>"}], "tags": [], "owner": {"reputation": 131, "user_id": 10399054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a4ae5c303031e8ccd2e092a47aea1c?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gabor", "link": "https://stackoverflow.com/users/10399054/christian-gabor"}, "is_accepted": false, "score": 0, "last_activity_date": 1545246514, "last_edit_date": 1545246514, "creation_date": 1545246400, "answer_id": 53857705, "question_id": 53857550, "link": "https://stackoverflow.com/questions/53857550/why-does-it-seem-like-the-strings-are-not-equal/53857705#53857705", "title": "Why does it seem like the strings are not equal?", "body": "<p>In your example, this is what strcmp is comparing</p>\n\n<pre><code>strcmp(\"house\\n\", \"house\")\n</code></pre>\n\n<p>Which is false. </p>\n\n<p>Here is a solution you could add to fix your code to the way (I assume) you expect it to work.</p>\n\n<pre><code>int main()\n{\n    int n = 100;\n    char a[n];\n    char b[] = \"house\";\n    fgets(a, n-1, stdin);\n    a[strlen(a) - 1] ='\\0';  //you may want to add length checking to prevent errors if user input is null\n    if (strcmp(a, b) == 0)\n        printf(\"The strings are eq\\n\");\n    else\n        printf(\"Not eq\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 3, "last_activity_date": 1545271569, "last_edit_date": 1545271569, "creation_date": 1545246413, "answer_id": 53857710, "question_id": 53857550, "link": "https://stackoverflow.com/questions/53857550/why-does-it-seem-like-the-strings-are-not-equal/53857710#53857710", "title": "Why does it seem like the strings are not equal?", "body": "<p>Reason why this</p>\n\n<pre><code>if (strcmp(a,b) == 0) { }\n</code></pre>\n\n<p>is not true because <code>fgets()</code> stores the <code>\\n</code> at the end of buffer. So here array <code>a</code> looks like <code>house</code> and array <code>b</code> looks like <code>house\\n</code>(If <code>ENTER</code> key was pressed after entering input char's) and <code>strcmp(a,b)</code> doesn't return <code>0</code>.\nFrom the manual page of <code>fgets()</code></p>\n\n<blockquote>\n  <p><code>fgets()</code> reads in at most one less than size characters from stream\n         and stores them into the buffer pointed to by  s.   Reading  stops\n         after  an  EOF  or  a newline.  <strong>If a newline is read, it is stored\n         into the buffer.</strong>  A terminating null byte ('\\0') is  stored  after\n         the last character in the buffer.</p>\n</blockquote>\n\n<p>One way is to use <code>strcspn()</code> which removes the trailing <code>\\n</code>. For e.g</p>\n\n<pre><code>fgets(a,n,stdin);\na[strcspn(a, \"\\n\")] = 0;\n</code></pre>\n\n<p>Now compare the char array like</p>\n\n<pre><code>if (strcmp(a,b) == 0) {\n        printf(\"The strings are equal.\\n\");\n}\nelse {\n        printf(\"The strings are not equal.\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10812319, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0XcwIZkClEo/AAAAAAAAAAI/AAAAAAAAACo/ZROXCoC0Zwg/photo.jpg?sz=128", "display_name": "Bernd Bond", "link": "https://stackoverflow.com/users/10812319/bernd-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 53857710, "answer_count": 2, "score": 1, "last_activity_date": 1545271569, "creation_date": 1545245659, "last_edit_date": 1545245801, "question_id": 53857550, "link": "https://stackoverflow.com/questions/53857550/why-does-it-seem-like-the-strings-are-not-equal", "title": "Why does it seem like the strings are not equal?", "body": "<pre><code>int main()\n{        \n    int n = 100;    \n    char a[n];    \n    char b[ ]=\"house\";\n\n    fgets(a,n-1,stdin); // type \"house\"\n\n    if (strcmp(a,b) == 0)\n        printf(\"The strings are equal.\\n\");\n    else\n        printf(\"The strings are not equal.\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "gcc", "header", "undefined"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1545244469, "post_id": 53857272, "comment_id": 94562300, "body": "What command(s) are you using to compile?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545244572, "post_id": 53857272, "comment_id": 94562345, "body": "You need to compile both sources and link them together.  Perhaps that would be achieved by naming both (the .c and .cxx) on the compiler command line."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545244661, "post_id": 53857272, "comment_id": 94562377, "body": "Question, however: what language do you expect the compiler to assume for file <code>param.cxx</code>?  If C, then its name should end in <code>.c</code>, not <code>.cxx</code>."}, {"owner": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545244706, "post_id": 53857272, "comment_id": 94562393, "body": "This part of the code is compiled with g++."}, {"owner": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545245085, "post_id": 53857272, "comment_id": 94562527, "body": "@JohnBollinger, unfortunately I can&#39;t modify the compiler call, which is unaccessible for me. However, I don&#39;t think that it&#39;s a compiler linking problem (I&#39;m surely wrong) : I tried the solution described here (<a href=\"https://stackoverflow.com/questions/8562694/how-to-declare-function-pointer-in-header-and-c-file\" title=\"how to declare function pointer in header and c file\">stackoverflow.com/questions/8562694/&hellip;</a>) an it worked, but once I adapt it to follow the rest of my code, nope, not anymore :&#39;)"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545245808, "post_id": 53857348, "comment_id": 94562873, "body": "Thank you it worked !! However I don&#39;t quite understand why in another groupe of header/*.c file already existing in the program I&#39;m using, it worked with the same header declaration ?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545247446, "post_id": 53857348, "comment_id": 94563604, "body": "Are the other C files calling <code>grid_create()</code>?"}, {"owner": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545247669, "post_id": 53857348, "comment_id": 94563698, "body": "No, but a similarly defined function. Actually I copy/paste the header files for those other functions in a new header, and then simplifying this content to create my own function i.e. grid_create()"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545247892, "post_id": 53857348, "comment_id": 94563774, "body": "It is not clear if those C files face the same problem. If the symbols are resolving, then it means the linker found a defined symbol."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "edited": false, "score": 0, "creation_date": 1545253970, "post_id": 53857348, "comment_id": 94566267, "body": "Related: <a href=\"https://stackoverflow.com/q/1041866/315052\">stackoverflow.com/q/1041866/315052</a> and <a href=\"https://stackoverflow.com/q/3789340/315052\">stackoverflow.com/q/3789340/315052</a>"}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 2, "last_activity_date": 1545248948, "last_edit_date": 1545248948, "creation_date": 1545244712, "answer_id": 53857348, "question_id": 53857272, "link": "https://stackoverflow.com/questions/53857272/void-function-declared-in-hxx-defined-in-cxx-but-undefined-in-c/53857348#53857348", "title": "Void function declared in *.hxx, defined in *.cxx but undefined in *.c", "body": "<p><code>.cxx</code> is one of the extensions used for C++ files. Your compiler may be using the extension of the file to compile the source as C++. When the C file is compiled, it generates an unresolved reference to the C symbol <code>grid_create</code>, but the compiled C++ file defines <code>grid_create</code> as a C++ symbol. Thus, the linker will leave the C symbol reference to <code>grid_create</code> unresolved, since there is only a C++ symbol associated with <code>void grid_create(void)</code>.</p>\n\n<p>You can try to guard the header file so that the C++ compiler will generate a C symbol rather than a C++ one.</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid \ngrid_create(void);\n\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10812478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f97b43947b47a16288d005dde94a62?s=128&d=identicon&r=PG", "display_name": "Flof", "link": "https://stackoverflow.com/users/10812478/flof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 53857348, "answer_count": 1, "score": 1, "last_activity_date": 1545248948, "creation_date": 1545244364, "last_edit_date": 1545244822, "question_id": 53857272, "link": "https://stackoverflow.com/questions/53857272/void-function-declared-in-hxx-defined-in-cxx-but-undefined-in-c", "title": "Void function declared in *.hxx, defined in *.cxx but undefined in *.c", "body": "<p>I'm trying to declare a global function accessible through different *.c files.</p>\n\n<p>I have declared it in param.hxx, defined it in param.cxx and I would like to access it in compute_grid.c.</p>\n\n<p>Unfortunately, during the compilation I have the following error :</p>\n\n<pre><code>compute_grid.c:(.text+0x5)\u00a0: undefined reference to \u00ab\u00a0grid_create\u00a0\u00bb\n</code></pre>\n\n<p>I'm not very familiar with such functions declarations in C. Actually I'm building a module part of a big program, I've copied those declaration from another file of the code witch seems to work ?!</p>\n\n<p>Unfortunately, the program is hugely confidential, I don't have access to all the sources but I will do my best to give you expurged parts...</p>\n\n<p>param.hxx :</p>\n\n<pre><code>typedef struct grid_t\n{\n    int   *test;\n} grid_t;\n\nvoid \ngrid_create(void);\n\nextern grid_t *grid;\n</code></pre>\n\n<p>param.cxx : </p>\n\n<pre><code>#include &lt;malloc.h&gt;\n#include \"param.hxx\"\n\ngrid_t *grid;\n\nvoid grid_create(void)\n{\n    grid = (grid_t*)malloc(sizeof(grid_t));\n    grid-&gt;test = (int*)malloc(sizeof(int));\n    *grid-&gt;test = 123;\n}\n</code></pre>\n\n<p>compute_grid.c :</p>\n\n<pre><code>#include \"param.hxx\"\n\nvoid\ncompute_grid()\n{\n    grid_create();\n\n    return;\n}\n</code></pre>\n\n<p>Thank you for your help !</p>\n"}, {"tags": ["c", "embedded", "core-flight-system"], "answers": [{"comments": [{"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1545322337, "post_id": 53857163, "comment_id": 94591765, "body": "This is probably a self answer to the actual problem, but because it&#39;s not specific about that but has a laundry list of other points, it looks to have been read by some to be a random guess from a 3rd party.  Your answer would be better received if you were specific about the actual typo, ie, <b>show the wrong line of code and explain what it should have been</b>.   That said, questions that turn out to be about a one-time goof have little lasting value and tend to be closed/removed."}, {"owner": {"reputation": 1037, "user_id": 1601162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc9a5ecc2804b84da8a6e5baaf2ca01?s=128&d=identicon&r=PG", "display_name": "superdesk", "link": "https://stackoverflow.com/users/1601162/superdesk"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1545403298, "post_id": 53857163, "comment_id": 94619715, "body": "Unfortunately I don&#39;t have the actual code that caused the problem. I was trying to recreate a question that we had on our github issue tracker. This is a fairly common question for us, which is why I put down the laundry list. I don&#39;t think the specific typo would add much (even if I had it)."}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1545404699, "post_id": 53857163, "comment_id": 94620427, "body": "You haven&#39;t even satisfied the requirements for <i>real</i> questions and answers.  Fake ones intended to educate others would be held to an even higher standard.  Both question and response have been rightfully downvoted to oblivion and will likely get removed from the site."}, {"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "edited": false, "score": 0, "creation_date": 1546016710, "post_id": 53857163, "comment_id": 94761382, "body": "@superdesk as the coder of the app you&#39;re having trouble with, I&#39;d also add that this issue could be related to forgetting to correctly name the app in the Makefile. I wasted a couple of hours the first time trying to solve this."}, {"owner": {"reputation": 1466, "user_id": 810658, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62139de5517901ce4c7ba8184070d24f?s=128&d=identicon&r=PG", "display_name": "Philip", "link": "https://stackoverflow.com/users/810658/philip"}, "edited": false, "score": 0, "creation_date": 1546622506, "post_id": 53857163, "comment_id": 94922312, "body": "As a reminder, it&#39;s not a &quot;fake question&quot; and <a href=\"https://stackoverflow.blog/2011/07/01/its-ok-to-ask-and-answer-your-own-questions/\">it is ok to answer your own questions.</a>.  But the question certainly does need an actual question at some point, and the offending line would raise the quality. If you&#39;re taking something from the CFS mailing list and posting it here, post the answer with it immediately to avoid wasting people&#39;s time. Asking both at the same time is ok, but share whatever solutions you get."}], "tags": [], "owner": {"reputation": 1037, "user_id": 1601162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc9a5ecc2804b84da8a6e5baaf2ca01?s=128&d=identicon&r=PG", "display_name": "superdesk", "link": "https://stackoverflow.com/users/1601162/superdesk"}, "is_accepted": true, "score": -2, "last_activity_date": 1545401346, "last_edit_date": 1545401346, "creation_date": 1545243783, "answer_id": 53857163, "question_id": 53857162, "link": "https://stackoverflow.com/questions/53857162/custom-application-for-coreflightsystem-could-not-load-cfe-application/53857163#53857163", "title": "Custom application for coreFlightSystem: &quot;Could not load cFE application&quot;", "body": "<p>Failing to load an application may be caused by a number of issues. A few things to check:</p>\n\n<ul>\n<li>Check that the application is be generated (the <code>.so</code>) and is in the correct directory</li>\n<li>Review the startup script to make sure that the application name and entry location are correct</li>\n<li>Check for warnings such as undefined references when building.</li>\n</ul>\n\n<p>This specific case was caused by a typo in a function name called by the application's <code>*_AppInit</code> function. This resulted in an undefined reference warning when building.</p>\n"}], "owner": {"reputation": 1037, "user_id": 1601162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc9a5ecc2804b84da8a6e5baaf2ca01?s=128&d=identicon&r=PG", "display_name": "superdesk", "link": "https://stackoverflow.com/users/1601162/superdesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 53857163, "answer_count": 1, "score": -3, "last_activity_date": 1587141029, "creation_date": 1545243783, "last_edit_date": 1545254061, "question_id": 53857162, "link": "https://stackoverflow.com/questions/53857162/custom-application-for-coreflightsystem-could-not-load-cfe-application", "title": "Custom application for coreFlightSystem: &quot;Could not load cFE application&quot;", "body": "<p>When I run coreFlightSystem with my custom application, I get the following log message:</p>\n\n<pre><code>ES Startup: Loading file: /cf/apps/lls_app.so, APP: LLS_APP\nES Startup: loading directly:/cf/apps/lls_app.so (LLS_APP) -70028.\nES Startup: Could not load cFE application file:/cf/apps/lls_app.so. EC = 0xFFFFFFFF\n</code></pre>\n\n<p>I have checked, and <code>lls_app.so</code> is built and placed in the correct location (<code>build/cpu1/exe/cf/apps/lls_app.so</code>). </p>\n"}, {"tags": ["c", "arrays", "substring"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1545243247, "post_id": 53857011, "comment_id": 94561775, "body": "You forgot to initialise <code>j</code>."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1545243376, "post_id": 53857011, "comment_id": 94561826, "body": "Also do not forget to terminate <code>array3</code> with a <code>&#39;\\0&#39;</code> character."}, {"owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545243405, "post_id": 53857011, "comment_id": 94561841, "body": "@Osiris Truth!!! thanks."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1545243555, "post_id": 53857011, "comment_id": 94561902, "body": "Also note <code>array1</code> needs a size of at least 16 to hold <code>&quot;ughIuytLikeretC&quot;</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545243772, "post_id": 53857011, "comment_id": 94561992, "body": "Is it an OK way of solving the problem? -- Yes.  Is there a way to use bitwise AND to improve the code? -- No, not that I see.  All of your data are arranged in byte-size or larger units, so I don&#39;t really see a reason even to consider bitwise operations."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545244673, "post_id": 53857011, "comment_id": 94562384, "body": "Is the goal to form a <i>string</i> at <code>array3</code> or to print select characters of <code>array1[]</code>?"}, {"owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545244719, "post_id": 53857011, "comment_id": 94562395, "body": "@chux, to form new string"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545244871, "post_id": 53857011, "comment_id": 94562451, "body": "For a slightly slicker alternative: <code>for (i = 0; array1[i]; i++){  array3[j] = array1[i]; j += array2[i];    } array3[j] = 0;</code>"}, {"owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545245335, "post_id": 53857011, "comment_id": 94562638, "body": "Thanks @chux, that was pretty slick, but why does the loop not stop at the first false in array1?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545245616, "post_id": 53857011, "comment_id": 94562780, "body": "@jregalad Unclear about &quot;first false in array1&quot;.  Did you mean <i>null chracter</i>?  Are you asking why <code>for (i = 0; array1[i]; i++)</code> iterates about 15 times? (it does stop at the first <i>null chracter</i>.)"}, {"owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "edited": false, "score": 0, "creation_date": 1545246104, "post_id": 53857011, "comment_id": 94563004, "body": "$chux, sorry messed the arrays, now I get it, many thanks!!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545246607, "post_id": 53857011, "comment_id": 94563256, "body": "@jregalad Note: &quot;messed the arrays&quot; --&gt; next time use more informative object names than <code>array1, array2, array3</code>.  Perhaps <code>source, enable, destination</code>?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1545247183, "post_id": 53857011, "comment_id": 94563500, "body": "&quot;ughIuytLikeretC\\0&quot; requires 17 characters; you have two nulls at the end - the one the compiler put there and an explicit one.  Safet to leave the <code>[]</code> empty and the compiler will supply the correct length for the initialiser."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1545247432, "post_id": 53857011, "comment_id": 94563596, "body": "Better also to ask if there is a better way rather than being explicit about wanting a solution using bit-wise AND.  I see no scope for using bitwise-AND here. An array if indices <code>{3,7,8,9,10,14}</code> would seem to make more sense."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545255623, "post_id": 53857011, "comment_id": 94566940, "body": "Also, not sure what your intention was though, you don&#39;t need to put the \\0 in the &quot;ughIuytLikeretC&quot; string as C literal strings have an implicit \\0 at the end."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 1, "creation_date": 1545256666, "post_id": 53857011, "comment_id": 94567332, "body": "For working code, it is always a much better idea to post on the Code Review Stack Exchange site."}], "answers": [{"tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": true, "score": 0, "last_activity_date": 1545255408, "creation_date": 1545255408, "answer_id": 53859502, "question_id": 53857011, "link": "https://stackoverflow.com/questions/53857011/c-and-operator-between-two-arrays/53859502#53859502", "title": "C - AND operator between two arrays", "body": "<p>To answer your question, this is an OK way of doing this.</p>\n\n<p>From an algorithmic perspective, this is an acceptable solution as you are required to build an additional array, which you are doing.</p>\n\n<p>I'm ignoring the small caveats as pointed out in the comments.</p>\n\n<p>Note: I would create a function something like <code>and_arrays(const char a[], const char b[], char result[]);</code> where you need to pass an allocated array for the result parameter.</p>\n"}], "owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 53859502, "answer_count": 1, "score": -3, "last_activity_date": 1545255408, "creation_date": 1545243159, "last_edit_date": 1545247774, "question_id": 53857011, "link": "https://stackoverflow.com/questions/53857011/c-and-operator-between-two-arrays", "title": "C - AND operator between two arrays", "body": "<p>I want to subsample an array based on a true-false vector:</p>\n\n<pre><code>array1 - ughIuytLikeretC\n\narray2 - ffftfffttttffft\n</code></pre>\n\n<p>Such that <code>array1 &amp;&amp; array2</code> yields:</p>\n\n<pre><code>array3 - ILikeC\n</code></pre>\n\n<p>What I have done:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main() {\n\n    char source[16] = \"ughIuytLikeretC\\0\";\n    bool mask[15] = {\n        false, false, false, true, false,\n        false, false, true, true, true,\n        true, false, false, false, true,\n    };\n    char *filtered;\n    filtered = malloc(16 * sizeof(char));\n\n    int j = 0;\n    int i;\n    for (i = 0; i &lt; 15; i++) {\n        if (mask[i]) {\n            filtered[j] = source[i];\n            j += 1;\n        }\n    }\n    filtered[j] = 0;\n    printf(\"%s\\n\", filtered);\n    free(filtered);\n}\n</code></pre>\n\n<p>My questions are:<br>\nIs this an OK way of doing it or is there a sleeker way of achieving this? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1545242889, "post_id": 53856943, "comment_id": 94561629, "body": "So, whats your question?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545256678, "post_id": 53856943, "comment_id": 94567336, "body": "There is a very similar question <i><a href=\"https://stackoverflow.com/questions/1739259/how-to-use-queryperformancecounter\">HERE</a></i> that has a detailed answer to how to use <code>QueryPerformanceCounter</code>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545256741, "post_id": 53856943, "comment_id": 94567365, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1739259/how-to-use-queryperformancecounter\">How to use QueryPerformanceCounter?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": true, "score": 2, "last_activity_date": 1545255943, "creation_date": 1545255943, "answer_id": 53859591, "question_id": 53856943, "link": "https://stackoverflow.com/questions/53856943/how-to-calculate-running-time-in-c-language/53859591#53859591", "title": "How to calculate running time in C language", "body": "<p>Include the <code>&lt;time.h&gt;</code> library and use the <code>time_t time(time_t *timer);</code> function.</p>\n\n<p>Also, if you want to use QueryPerformanceCounter, then you need to include Winbase.h (and Windows.h).</p>\n"}], "owner": {"reputation": 23, "user_id": 10812487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k24o0.jpg?s=128&g=1", "display_name": "ayalarevivo", "link": "https://stackoverflow.com/users/10812487/ayalarevivo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1545256741, "accepted_answer_id": 53859591, "answer_count": 1, "score": -3, "last_activity_date": 1545256463, "creation_date": 1545242818, "last_edit_date": 1545256463, "question_id": 53856943, "link": "https://stackoverflow.com/questions/53856943/how-to-calculate-running-time-in-c-language", "closed_reason": "Needs details or clarity", "title": "How to calculate running time in C language", "body": "<p>The following function is not compiling:</p>\n\n<pre><code>double GetCurTime()\n{\n    LARGE_INTEGER CounterFreq;\n    QueryPerformanceFrequency(&amp;CounterFreq);\n\n    LARGE_INTEGER Counter;\n    QueryPerformanceCounter(&amp;Counter);\n    return (double)Counter.QuadPart / (double)CounterFreq.QuadPart;\n}\n</code></pre>\n\n<p>The C the compiler I am using does not recognize <code>LARGE_INTEGER</code> and  <code>QueryPerformanceFrequency</code>.    </p>\n\n<p>If anyone recognizes these items, can you please suggest where I might find them?<br>\nPerhaps they are in a header file, or a library that I do not currently have.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1545242355, "post_id": 53856784, "comment_id": 94561413, "body": "Aside: why do you even use pointers for this?"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1545242365, "post_id": 53856784, "comment_id": 94561416, "body": "Why are you using those pointers? They&#39;re completely unnecessary, and only serve to make the code more difficult to read"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545242858, "post_id": 53856784, "comment_id": 94561612, "body": "Since you&#39;re using pointers here in an unnecessarily complicated way, you may need a better C programming reference to learn from. This is not how you&#39;d normally tackle a problem like this in C. These pointers point at a <code>static</code> variable, and that&#39;s also a messy solution. You might want to have some kind of state <code>struct</code> you pass in."}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1545242863, "post_id": 53856784, "comment_id": 94561615, "body": "@PhilM well.. there&#39;s no particular reason actually.. I did it for learning purpose only, sorry if it hurts your eyes! :-("}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545242989, "post_id": 53856784, "comment_id": 94561672, "body": "@tadman okayyy, i&#39;m sorry, I&#39;ll remove the pointers, no big deal :-( they&#39;re not part of the question tho! It&#39;s about the output..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545243009, "post_id": 53856784, "comment_id": 94561679, "body": "There&#39;s nothing wrong with learning, but this is like using a hammer to drive in a screw, it&#39;s not the correct tool for the job. If you want to learn more about pointers, write a linked list implementation or dive into C strings in more detail, both of which require a solid understanding of how pointers work and what they can do."}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1545243778, "post_id": 53856784, "comment_id": 94561995, "body": "@tadman will do! i should&#39;ve posted the readable code in the first place!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545243690, "post_id": 53857020, "comment_id": 94561963, "body": "but.. what am I supposed to do to make it a 1? how come it got all the other numbers right, but not this one?"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "reply_to_user": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545243984, "post_id": 53857020, "comment_id": 94562070, "body": "I suppose it&#39;s arguable whether the others are &#39;correct&#39;. One might say that 13 is a better guess than 12 after 25. Does the assignment specify what values it should return given this particular case?"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545244523, "post_id": 53857020, "comment_id": 94562322, "body": "it does, there are examples of input and output. i&#39;ll edit the question to include them! i got all the others right except the last number (that is 2 instead of 1). the parameter==-1 is supposed to decrease the interval that was (0,100), to make it (0,50), then (0,25) etc; you see it always returns the half of that interval.."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "reply_to_user": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545245496, "post_id": 53857020, "comment_id": 94562718, "body": "I think one small change will fix it to match your <code>1,-1,-1,1</code> output"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "reply_to_user": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545246490, "post_id": 53857020, "comment_id": 94563210, "body": "Won&#39;t matter too much, unless there&#39;s a test case of 6 <code>-1</code>s in a row. Seems to work fine with the proper interval, though"}], "tags": [], "owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1545244599, "last_edit_date": 1545244599, "creation_date": 1545243200, "answer_id": 53857020, "question_id": 53856784, "link": "https://stackoverflow.com/questions/53856784/writing-a-function-that-splits-an-interval-in-c/53857020#53857020", "title": "writing a function that splits an interval in c", "body": "<p>Let's do some math. You can break out the math into separate lines and step through with a debugger to confirm.</p>\n\n<p>For the call that returns a guess of 2, your statics are <code>a == 1</code> and <code>b == 6</code>.</p>\n\n<p>So for the (cleaned up) code</p>\n\n<pre><code>b-=(a+b)/2 - a + 1;\nnum=(a+b)/2;\n</code></pre>\n\n<p>we get:</p>\n\n<pre><code>`a` + `b` == 7\n7 / 2 == 3 (integer math)\n3 - 1 + 1 == 3\n6 - 3 == 3\nnum = (1 + 3) / 2 == 2\n</code></pre>\n\n<p>EDIT: Here's code that returns the sequence you want. Can't guarantee I didn't break your +1 sequence, though :)</p>\n\n<pre><code>int NextGuess(int  param) {\n    int num;\n    static int a=0, b=100;\n    static int lastGuess = 50;\n\n    //printf(\"%d %d %d %d\\n\", a, b, interval, lastGuess);\n    if (param==-1) //less\n    {\n        b = lastGuess;\n    }\n    else if (param==1) //greater\n    {\n        a = lastGuess + 1;\n    }\n\n    lastGuess = (a+b) / 2;\n\n    return lastGuess;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1545245053, "post_id": 53857175, "comment_id": 94562520, "body": "thank you! but that&#39;s a bit too complicated for my very limited knowlegde :-( this is actually supposed to be a really simple function. it is supposed to take -1, 1 and 0 as parameters and return a number."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1545244273, "last_edit_date": 1545244273, "creation_date": 1545243858, "answer_id": 53857175, "question_id": 53856784, "link": "https://stackoverflow.com/questions/53856784/writing-a-function-that-splits-an-interval-in-c/53857175#53857175", "title": "writing a function that splits an interval in c", "body": "<p>Rather than criticize, let me show you a couple of counterexamples. Consider the following:</p>\n\n<pre><code>struct intrange {\n    int   minimum;\n    int   maximum;\n};\n</code></pre>\n\n<p>These limits are inclusive. You can pass structures by value, and assign them just like any other type. To split such a structure, you could use</p>\n\n<pre><code>struct intrange  intrange_split(const struct intrange  range,\n                                const int              half)\n{\n    /* Midpoint of the range, rounding towards zero */\n    const int        midpoint = (range.minimum + range.maximum) / 2;\n    struct intrange  result;\n\n    if (half &gt; 0) {\n        /* Upper half, including midpoint. */\n        result.minimum = midpoint;\n        result.maximum = range.maximum;\n    } else\n    if (half &lt; 0) {\n        /* Lower half, excluding midpoint. */\n        result.minimum = range.minimum;\n        result.maximum = midpoint - 1;\n    } else {\n        /* No change. */\n        result = range;\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>The above <code>intrange_split()</code> function takes an intrange structure <code>range</code> as a parameter, and an int <code>half</code> to indicate how to split it. There are no error checks.</p>\n\n<p>If you wanted to operate on a structure passed by reference, you could use say</p>\n\n<pre><code>int intrange_split(struct intrange *range, int half)\n{\n    int midpoint;\n\n    /* No range? Invalid range? */\n    if (!range || range-&gt;maximum &lt; range-&gt;minimum)\n        return -1; /* Invalid range. */\n\n    /* Note: This could overflow. */\n    midpoint = (range-&gt;minimum + range-&gt;maximum) / 2;\n\n    if (half == 1) {\n        /* Upper half, including midpoint. */\n        range-&gt;minimum = midpoint;\n    } else\n    if (half == -1) {\n        /* Lower half, excluding midpoint. */\n        range-&gt;maximum = midpoint - 1;\n    } else {\n        /* Invalid operation. */\n        return -1;\n    }\n\n    /* Verify range is valid (non-empty). */\n    if (range-&gt;maximum &lt; range-&gt;minimum)\n        return -1;\n\n    /* Range is valid, and not empty. */\n    return 0;\n}\n</code></pre>\n\n<p>It is more common to use the return value to represent success/error in C, because unlike C++, there are no exceptions.  (You could also use assertions, or print an error message and <a href=\"http://man7.org/linux/man-pages/man3/abort.3.html\" rel=\"nofollow noreferrer\"><code>abort()</code></a> or <a href=\"http://man7.org/linux/man-pages/man3/exit.3.html\" rel=\"nofollow noreferrer\"><code>exit(EXIT_FAILURE)</code></a>, depending on whether the error is recoverable or not.)</p>\n\n<p>In all above cases, I used the logic that <code>midpoint</code> is halfway between <code>minimum</code> and <code>maximum</code>, rounded towards zero; and that <code>midpoint</code> belongs to the upper range. It is up to you to choose <em>how</em> you define it, as long as you make the choice explicitly, and document it.  See how much simpler these approaches are?</p>\n\n<p>It is also common to use preprocessor macros or static inline functions for initializing variables. In this case, for example</p>\n\n<pre><code>#define  INTRANGE_INIT(min, max)  { min, max }\n\nstatic inline struct intrange intrange_define(const int minimum,\n                                              const int maximum)\n{\n    struct intrange  result = { minimum, maximum };\n    return result;\n}\n</code></pre>\n\n<p>so that in your code, you can declare a range using e.g. <code>struct intrange  my_range = INTRANGE_INIT(0, 100);</code>. Sure, you can also initialize it using <code>struct intrange my_range = { 0, 100 };</code>, or even <code>struct intrange my_range; my_range = intrange_define(0, 100);</code>.</p>\n\n<p>As long as the implementation is readable and easy to understand, it is fine.  I tend to prefer the preprocessor macro style myself, but that is purely a style issue.</p>\n\n<p>Remember to write comments that describe your design and intent, not what the code does. That skill is as important as programming itself. You'll find that in most cases, code that can only be written and not maintained, is not worth the electricity to run it on.</p>\n\n<p>(And never ever get into the habit of thinking you'll add error checking and security stuff later. Because you won't. Nobody ever does. If they try, they invariably fail. This is because robustness and security can only be designed in, not added afterwards.)</p>\n"}], "owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545256472, "creation_date": 1545242128, "last_edit_date": 1545256472, "question_id": 53856784, "link": "https://stackoverflow.com/questions/53856784/writing-a-function-that-splits-an-interval-in-c", "title": "writing a function that splits an interval in c", "body": "<p>I'm writing a function that's supposed to increase or decrease an interval between 1 and 100, depending on which parameter it takes.</p>\n\n<p>It starts from <code>(0,100)</code>, then, if <code>parameter=-1</code> it becomes <code>(0,50)</code>, if <code>parameter=1</code> afterwards, it becomes <code>(25, 50)</code>. It stores the last \"guess\" and gives the next one based on that.</p>\n\n<p>I'd like to know what I'm doing wrong when <code>parameter=-1</code> (the part where it's supposed to decrease the interval). Other parts work fine, you don't have to look at them, they give the expected output BUT this (-1) one gives <code>25 12 6 3 2</code> instead of <code>25 12 6 3 1</code>.</p>\n\n<p>here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint NextGuess(int  param) {\n\n    int num;\n    static int a=1, b=99;\n\n    //this part is where it goes wrong (the output doesn't match with the expected one)//\n    if (param==-1) //less\n    {\n        b-=(a+b)/2 - a+1;\n        num=(a+b)/2;\n    }\n    //these below are doing fine//\n\n    if (param==1) //greater\n    {\n        a+=(a+b)/2 - a+1;\n        num=(a+b)/2;\n    }\n\n    if (param==0) //equal\n    num=(a+b)/2;\n\n    return num;\n}\n//main isn't important, it's just for testing the output//\nint main() {\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(-1));\n//output should be: 25 12 6 3 1  but this gives: 25 12 6 3 2    \n    return 0;\n}\n</code></pre>\n\n<p>If someone could just point to what I'm doing wrong in that part, I've been thinking about this simple thing for far too long now...</p>\n\n<p>other examples of what the function is supposed to output when called:</p>\n\n<pre><code>printf (\"%d \", NextGuess(1));\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(-1));\nprintf (\"%d \", NextGuess(1));\n//output: 75 62 56 59\n</code></pre>\n"}, {"tags": ["c", "memory-leaks"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1545242459, "post_id": 53856783, "comment_id": 94561460, "body": "The amount of virtual memory (what apps have access to) may be (far) greater than the physical RAM installed."}], "answers": [{"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": true, "score": 1, "last_activity_date": 1545244762, "creation_date": 1545244762, "answer_id": 53857361, "question_id": 53856783, "link": "https://stackoverflow.com/questions/53856783/is-there-a-way-to-dump-all-native-memory/53857361#53857361", "title": "Is there a way to dump all native memory?", "body": "<p>The C Standard allows implementations to do anything they see fit if an application tries to access memory it doesn't own.  Some implementations designed for low-level programming usefully guarantee that attempts to access storage through a pointer they don't \"understand\" will be processed \"in a documented fashion characteristic of the environment\" (typically be treating them as requests to access the underlying hardware addresses.  Some implementations designed for handling security-sensitive applications may usefully prevent attempts to access unowned storage by actively blocking them and \"terminating a translation or execution (with a diagnostic message)\".  Some may simply do whatever happens to be convenient in any given circumstance.</p>\n\n<p>The authors of the Standard recognized that implementations are used for a variety of purposes, and that treatments that would be suitable for some tasks would be unsuitable for others.  According to the published Rationale, the question of which approach implementations should use for processing actions the Standard regards as \"Undefined Behavior\" is a \"Quality of Implementation\" issue, letting the \"marketplace\" decide how quality implementations intended for various purposes should be expected to behave.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53857361, "answer_count": 1, "score": 0, "last_activity_date": 1545244762, "creation_date": 1545242128, "question_id": 53856783, "link": "https://stackoverflow.com/questions/53856783/is-there-a-way-to-dump-all-native-memory", "title": "Is there a way to dump all native memory?", "body": "<p>I built a shared library to get access linux specific system calls from <code>Java</code> code through <code>jni</code> and got into trouble  that RSS is constantly getting increased.</p>\n\n<p>Is there a way to examine native memory? I tried to take the core dump with gdb:</p>\n\n<pre><code>gdb --pid=6385\ngdb&gt; gcore\n</code></pre>\n\n<p>But it turned to become 9GB for 400MB RSS. Maybe there is some another simpler way or tool to troubleshoot that?</p>\n\n<p>I'm on Linux Ubuntu 18.04</p>\n"}, {"tags": ["c", "vector", "comparison"], "comments": [{"owner": {"reputation": 527, "user_id": 10488746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vTDhZ.jpg?s=128&g=1", "display_name": "H.cohen", "link": "https://stackoverflow.com/users/10488746/h-cohen"}, "edited": false, "score": 0, "creation_date": 1545242089, "post_id": 53856703, "comment_id": 94561298, "body": "is the input constricted? like numbers 0-100? If so you can use an aux array[100] and if not a double for loop will do"}, {"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "reply_to_user": {"reputation": 527, "user_id": 10488746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vTDhZ.jpg?s=128&g=1", "display_name": "H.cohen", "link": "https://stackoverflow.com/users/10488746/h-cohen"}, "edited": false, "score": 1, "creation_date": 1545242328, "post_id": 53856703, "comment_id": 94561399, "body": "@H.cohen No. Only integers. (32 bit)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545242396, "post_id": 53856703, "comment_id": 94561433, "body": "For so few numbers to test, an approach of the general kind you describe should be fine.  Alternatively, however, you could sort the input, thereby leaving all duplicate elements in consecutive locations.  There are may be other viable alternatives, too, depending on the constraints on your input."}, {"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545242680, "post_id": 53856703, "comment_id": 94561542, "body": "@JohnBollinger thanks for confirming that. However I am more concerned with how to actually code this into a running program. As I said this is about my 10. programm ever and the first 9 I didnt even program myself rather than copying pieces from this forum xD  Can I run the pointer of the vector with a variable? Or is there an operation that does this for me?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545243040, "post_id": 53856703, "comment_id": 94561696, "body": "I&#39;m sorry, @Lukas, but &quot;How do I write this program?&quot; is too broad a question.  Since this is an exercise for a formal class, I suggest you start by reviewing the course materials and your lecture notes.  Then try something.  Working out solutions to the exercises is one of the more important ways that you will learn the course material."}, {"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545243364, "post_id": 53856703, "comment_id": 94561821, "body": "@JohnBollinger Yes, I already wrote a program trying that. However I am to inexperienced with the syntax. I dont know how to express this condition.  I tried <code>while (a &lt;= 10);\t \t{ \t\tfor (scanf_s(&quot;%lf&quot;, &amp;vektor[a]) == 0) \t\t\t{ \t\t\t\tprintf(&quot;Eingabe ungueltig, neue Eingabe erforderlich.\\n&quot;); \t\t\t\tfflush(stdin); \t\t\t} \t\ta++; \t}</code>   This is for the input of the 10 integers"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545244240, "post_id": 53856703, "comment_id": 94562192, "body": "@LukasLanger, if you have a program you would like us to consider then please edit it into the question, and pose a specific question about it. But note, however, that what you&#39;ve just presented in your comment appears to do nothing more than read the input.  We&#39;re willing to help -- to some extent -- but we&#39;re looking for a good-faith effort at solving the problem yourself.  If you really haven&#39;t a clue how to start then we&#39;re probably not the resource you want.  In that case, consider seeking help from your instructor, a teaching assistant, or a classmate."}, {"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545245275, "post_id": 53856703, "comment_id": 94562614, "body": "@JohnBollinger Ok, I am sorry. Let me reprhase my question in addition to my very first code I added to the question.  Is there an operator that searches in a vector (such as searchvector[a] for example) and if there is none is my method apart from some syntax errors on the right path? Is this a viable means of comparison in C?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545245377, "post_id": 53856703, "comment_id": 94562664, "body": "1) <code>vektor[]</code> is not define/declare anywhere.  Post true code. 2) <code>scanf_s(&quot;%lf&quot;, &amp;vektor[a])</code> expects <code>vektor[a]</code> to be a <code>double</code>, not <code>int</code>."}, {"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545245821, "post_id": 53856703, "comment_id": 94562881, "body": "@chux Actually vektor[a] is vector[a] but I quickly translated the program from german to english since we say vektor instead of vector and also the printf parts were in German. Therefore vektor is declared in the very first line of the main function. So by changing the input to a double the return value of the scanf_s should be true and the input is saved in the vector?  But again I declared ` int vector[10]` . Why should the program expect a double?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545246195, "post_id": 53856703, "comment_id": 94563054, "body": "@LukasLanger &quot;return value of the scanf_s should be true&quot; --&gt; The return value will be 1 of 3 things: <code>EOF, 0, 1</code>.  It will be 1 when text input was successfully converted to a <code>double</code>.  Suggest you edit and post true compilable code and clearly reword post.  Do not use &quot;integer&quot; when <code>double</code> is being read or do not use <code>double</code> if <code>int</code>s are being read.  This will add clarity to your goal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545246418, "post_id": 53856703, "comment_id": 94563180, "body": "<code>while (a &lt;= 10);</code> --&gt; infinite loop. Note the <code>;</code> at the end is the <i>body</i> of the loop.  This points out a key failing here - you are not enabling all compiler warnings (or using a weak compiler). A good compiler would have warned of that mistake.   <b>Save time</b>  enable all warnings, fix problems and then re-post <i>true</i>  code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "edited": false, "score": 0, "creation_date": 1545248214, "post_id": 53857857, "comment_id": 94563889, "body": "Thanks for this answer. I use Visual Studio and I encountered the problems you and @chux described but couldnt find the problem with the loops head. I found that I get quite confused with the ` ; ` but I guess this is something I have to find out myself. I will try to code this into a working program tomorrow. But so far thanks for you patience."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1545247130, "creation_date": 1545247130, "answer_id": 53857857, "question_id": 53856703, "link": "https://stackoverflow.com/questions/53856703/searching-for-all-integers-that-occure-twice-in-a-vector/53857857#53857857", "title": "Searching for all integers that occure twice in a vector", "body": "<p>Your code has several problems, some syntactic and some semantic.  Your compiler will help with many of the former kind, such as</p>\n\n<ul>\n<li>misspelling of variable name <code>vector</code> in one place (though perhaps this was a missed after-the-fact edit), and</li>\n<li>incorrect syntax for a <code>for</code> loop</li>\n</ul>\n\n<p>Some compilers will notice that your <code>scanf</code> format is mismatched with the corresponding argument.  Also, you might even get a warning that clues you in to the semicolons that are erroneously placed between your loop headers and their intended bodies.  I don't know any compiler that would warn you that bad input will cause your input loop to spin indefinitely, however.</p>\n\n<p>But I guess the most significant issue is that the details of your approach to printing only non-duplicate elements simply will not serve.  For this purpose, I recommend figuring out how to describe <em>in words</em> how the computer (or a person) should solve the problem before trying to write C code to implement it.  These are really two different exercises, especially for someone whose familiarity with C is limited.  You can reason about the prose description without being bogged down and distracted by C syntax.</p>\n\n<p>For example, here are some words that might suit:</p>\n\n<ol>\n<li>Consider each element, E, of the array in turn, from first to last.</li>\n<li>Check all the elements preceding E in the array for one that contains the same value.</li>\n<li>If none of the elements before E contains the same value as E then E contains the first appearance of its value, so print it.  Otherwise, E's value was already printed when some previous element was processed, so do not print it again.</li>\n<li>Consider the next E, if any (go back to step 1).</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 10776285, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqAHQT9uRD4/AAAAAAAAAAI/AAAAAAAARVQ/K-IGvOcnA_Y/photo.jpg?sz=128", "display_name": "Lukas Langer", "link": "https://stackoverflow.com/users/10776285/lukas-langer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545247130, "creation_date": 1545241814, "last_edit_date": 1545245653, "question_id": 53856703, "link": "https://stackoverflow.com/questions/53856703/searching-for-all-integers-that-occure-twice-in-a-vector", "title": "Searching for all integers that occure twice in a vector", "body": "<p>I got the task in university to realize an input of a maximum of 10 integers, which shall be stored in a one dimensional vector. Afterwards, every integer of the vector needs to be displayed on the display (via printf).</p>\n\n<p>However, I don't know how to check the vector for each number. I thought something along the lines of letting the pointer of the vector run from 0 to 9 and comparing the value of each element with all elements again, but I am sure there is a much smarter way.  I don't in any case know how to code this idea since I am new to C.</p>\n\n<p>Here is what I have tried:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int vector[10];\n    int a;\n    int b;\n    int c;\n    a = 0;\n    b = 0;\n    c = 0;\n\n    printf(\"Please input 10 integers.\\n\\n\");\n\n    while (a &lt;= 10);    \n    {\n        for (scanf_s(\"%lf\", &amp;vektor[a]) == 0)\n            {\n                printf(\"This is not an integer. Please try again.\\n\");\n                fflush(stdin);\n            }\n        a++;\n    }\n\n    for (b &lt;= 10);\n        {\n            if (vector[b] != vector[c]);\n                {\n                    printf(\"&amp;d\", vector[b]);\n                    c++;\n                }\n            b++;\n        }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1545241749, "post_id": 53856637, "comment_id": 94561144, "body": "You probably need to use <code>double</code> rather than <code>float</code> internally, because all <code>float</code> arguments are promoted to <code>double</code> anyway ? (Also note that your <code>1685.2622</code> argument that you are using for testing is a literal <code>double</code>.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545241993, "post_id": 53856637, "comment_id": 94561253, "body": "In the most commonly used format for <code>float</code>, <code>1865.2622f</code> in source text becomes 1865.26220703125 in <code>float</code>. This means your implementation is doing a better job in this case, which suggests the <code>printf</code> you are using is low quality. Which <code>printf</code> is it? Microsoft? Apple? GNU? Somebody else? What version? Do you want to duplicate that <code>printf</code> exactly, or do you want to do a high-quality job?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545242068, "post_id": 53856637, "comment_id": 94561283, "body": "Conversion of binary floating-point to decimal is complicated. It is not easy to do a good job (one that gets rounding correct and is efficient)."}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1545242214, "post_id": 53856637, "comment_id": 94561350, "body": "c literals are double by default. Your value comes out to 1685.26220000 as a double. But when you cast to float it&#39;s turned into 1685.26220703125. Add an <code>f</code> on the end to force it to float literal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1545246820, "post_id": 53856637, "comment_id": 94563339, "body": "<code>int_part += 0.5;</code> is the same as <code>int_part += 0</code> same as <code>(void) int_part;</code> - as if the code was not there."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545246956, "post_id": 53856637, "comment_id": 94563389, "body": "saouas, What would you like code to do with <code>int_part = (int)nbr;</code>  when <code>nbr</code> is outside the <code>int</code> range?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 1, "creation_date": 1545247421, "post_id": 53856637, "comment_id": 94563594, "body": "@BurnsBA Note: C calls 1685.26220000 a <i>constant</i>, not a <i>literal</i>.  C does have <i>literals</i> such as <i>string literal</i> which can have their address taken.  unlike the address of 1685.26220000."}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545247555, "post_id": 53856637, "comment_id": 94563659, "body": "@chux oh yes, of course, thanks for the correction"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10812443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d9fa85ebc72aef3488e194f221f60f?s=128&d=identicon&r=PG&f=1", "display_name": "saouas", "link": "https://stackoverflow.com/users/10812443/saouas"}, "edited": false, "score": 0, "creation_date": 1545990976, "post_id": 53858899, "comment_id": 94751060, "body": "Thank&#39;s you very much for your answer !! :) , i really understand now why it doesn&#39;t work."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1545253710, "last_edit_date": 1545253710, "creation_date": 1545252300, "answer_id": 53858899, "question_id": 53856637, "link": "https://stackoverflow.com/questions/53856637/how-can-my-own-printf-do-the-same-round-as-the-original-one/53858899#53858899", "title": "How can my own printf do the same round as the original one?", "body": "<p>2 major problems:</p>\n\n<ul>\n<li>Code is using <code>float</code> math in trying to print a <code>double</code> that exceeds the precision of <code>float</code>.  <code>1685.2622</code> as a <code>float</code> typically encodes in <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">binary32</a> exactly as 1685.26220703125. So an output of <code>1685.26220704</code> is not so bad.</li>\n</ul>\n\n<p>Code using <code>double</code></p>\n\n<pre><code>void double_itoa(double nbr, char *ret_str, int precision) {\n  int int_part;\n  double double_part;\n  int i;\n  int_part = (int) nbr;\n  double_part = nbr - (double) int_part;\n  i = convert_int_to_str(int_part, ret_str, 0);\n  if (precision != 0) {\n    ret_str[i] = '.';\n    i++;\n    double_part = double_part * pow(10, precision);\n    convert_int_to_str(round(double_part), ret_str + i, precision);\n  }\n}\n</code></pre>\n\n<ul>\n<li>Truncation rather than rounding. </li>\n</ul>\n\n<p><code>(int) float_part</code> lops off the fraction.  A better approach would round as incorporated above <code>round(double_part)</code>.  To create a good round function without <code>&lt;math.h&gt;</code> has subtle pitfalls versus the <em>usual</em> <code>(int) (x + 0.5)</code>. <a href=\"https://stackoverflow.com/a/23254545/2410359\">This</a> may help.</p>\n\n<p>Example:</p>\n\n<pre><code>int main() {\n  char s[100];\n  float_itoa(1685.2622, s, 8);\n  puts(s);\n  double_itoa(1685.2622, s, 8);\n  puts(s);\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>1685.26220704\n1685.26220000\n</code></pre>\n\n<hr>\n\n<p>Code has other weaknesses such as  using <code>(int) some_floating_point_value</code> is prone to significant failure should the FP value lie outside the <code>int</code> range.</p>\n"}], "owner": {"reputation": 15, "user_id": 10812443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d9fa85ebc72aef3488e194f221f60f?s=128&d=identicon&r=PG&f=1", "display_name": "saouas", "link": "https://stackoverflow.com/users/10812443/saouas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53858899, "answer_count": 1, "score": 1, "last_activity_date": 1545253710, "creation_date": 1545241527, "last_edit_date": 1545251489, "question_id": 53856637, "link": "https://stackoverflow.com/questions/53856637/how-can-my-own-printf-do-the-same-round-as-the-original-one", "title": "How can my own printf do the same round as the original one?", "body": "<p>I am trying to make my own <code>printf</code> and I have a problem with the <code>\"%f\"</code> option, precisely with rounding. When I try to prints this test :  </p>\n\n<pre><code>print(\"Real : %.8f\\n\",1685.2622);\n</code></pre>\n\n<p>The original one gave : <code>1685.26220000</code> and mine gave : <code>1685.26220704</code>.</p>\n\n<p>I don't know how to fix it ...</p>\n\n<p>Here is my code below : </p>\n\n<pre><code>#include \"../includes/ft_printf.h\"\n#include &lt;stdarg.h&gt;\n\nvoid ft_reverse_str(char *str, int len) {\n  int i;\n  int j;\n  int tmp;\n\n  i = 0;\n  j = len - 1;\n  while (i &lt; j) {\n    tmp = str[i];\n    str[i] = str[j];\n    str[j] = tmp;\n    i++;\n    j--;\n  }\n}\n\nint convert_int_to_str(int int_part, char *ret_str, int precision) {\n  int i;\n\n  i = 0;\n  while (int_part) {\n    int_part += 0.5;\n    ret_str[i++] = (int_part % 10) + '0';\n    int_part = int_part / 10;\n  }\n  while (i &lt; precision)\n    ret_str[i++] = '0';\n  ft_reverse_str(ret_str, i);\n  ret_str[i] = '\\0';\n  return (i);\n}\n\nvoid float_itoa(float nbr, char *ret_str, int precision) {\n  int int_part;\n  float float_part;\n  int i;\n  int_part = (int) nbr;\n  float_part = nbr - (float) int_part;\n  i = convert_int_to_str(int_part, ret_str, 0);\n  if (precision != 0) {\n    ret_str[i] = '.';\n    i++;\n    float_part = float_part * ft_pow(10, precision);\n    convert_int_to_str((int) float_part, ret_str + i, precision);\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1545241561, "post_id": 53856602, "comment_id": 94561065, "body": "You never allocated space for copy!"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1545241613, "post_id": 53856602, "comment_id": 94561086, "body": "It is uninitialized, and you are copying data to an invalid location."}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 1, "last_activity_date": 1545242017, "creation_date": 1545242017, "answer_id": 53856747, "question_id": 53856602, "link": "https://stackoverflow.com/questions/53856602/how-to-remove-first-word-from-string-and-keep-rest-of-sentence-in-c/53856747#53856747", "title": "How to remove first word from string and keep rest of sentence in C?", "body": "<p>As noted in the comments, you never allocated <code>copy</code>, so you're essentially writing to unallocated space, which will produce an undefined behavior (e..g, on my machine, this code just segfaults). </p>\n\n<p>In fact, you don't even need to copy the string. You can just have <code>copy</code> point to the first character after the space:</p>\n\n<pre><code>char *copy = strchr(sentence, ' ');\nif (copy != NULL) {\n        copy++;\n        printf(\"COPY %s\\n\", copy);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1545242250, "creation_date": 1545242250, "answer_id": 53856813, "question_id": 53856602, "link": "https://stackoverflow.com/questions/53856602/how-to-remove-first-word-from-string-and-keep-rest-of-sentence-in-c/53856813#53856813", "title": "How to remove first word from string and keep rest of sentence in C?", "body": "<p>Since a string is just a pointer to the first element in an array of <code>char</code> terminated by a NULL, you can use pointer arithmetic to get the string after the first word:</p>\n\n<pre><code>char mystring[100] = \"Not everybody is going to like this\";\nchar *pstring = mystring;\nwhile(*pstring &amp;&amp; *pstring != ' ') \n    pstring++;\n\nputs(pstring);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> everybody is going to like this\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10196048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139cd1a6c5c96fb3e16ab94736dca591?s=128&d=identicon&r=PG&f=1", "display_name": "fcp", "link": "https://stackoverflow.com/users/10196048/fcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 53856747, "answer_count": 2, "score": 1, "last_activity_date": 1545249741, "creation_date": 1545241356, "last_edit_date": 1545249741, "question_id": 53856602, "link": "https://stackoverflow.com/questions/53856602/how-to-remove-first-word-from-string-and-keep-rest-of-sentence-in-c", "title": "How to remove first word from string and keep rest of sentence in C?", "body": "<p>I'm trying to manipulate a string by removing the first character or word before a space, and keeping the rest of the sentence. </p>\n\n<p>For example:</p>\n\n<p><code>char *sentence = {\"I am home\"};</code></p>\n\n<p>should become: <code>\"am home\"</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char** argv) {\n\n    char *sentence = {\"I am home\"};  \n    int space_cnt = 0;\n    char *p = sentence;\n    char *copy;\n\n    printf(\"%s\\n \", sentence);\n\n        for (int k=0; k&lt;strlen(sentence); k++) {\n            if (space_cnt = 0 &amp;&amp; ((p=strchr(sentence, ' ')) != NULL)) {\n                space_cnt = 1;\n            }\n            else if (space_cnt = 1) {\n                *copy++ = *p;\n            }  \n        }\n    printf(\"COPY: %s\\n\", copy);\n\n    return (EXIT_SUCCESS);\n</code></pre>\n\n<p>}</p>\n\n<p>Current output: </p>\n\n<pre><code>I am home\nCOPY: 2\ufffd\n</code></pre>\n"}, {"tags": ["c", "bubble-sort"], "comments": [{"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1545241759, "post_id": 53856587, "comment_id": 94561149, "body": "Your indexing is wrong in the inner loop. For a bubble sort you want to check element <code>i</code> against each element between <code>i + 1</code> and <code>n - 1</code> but here you are checking against each element between 0 and <code>n - i - 1</code>. Either change the inner loop range or add <code>i</code> to the array indexing for the second item."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 2, "creation_date": 1545241862, "post_id": 53856587, "comment_id": 94561196, "body": "Also take care that <code>(a+b+c)&#47;2</code> is <i>integer division</i> and will calculate incorrect areas if <code>a+b+c</code> is odd; divide by <code>2.0</code> instead to ensure floating-point division."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1545242815, "post_id": 53856587, "comment_id": 94561600, "body": "Don&#39;t calculate the area (you don&#39;t care what the area is, you only care if the area will be larger or smaller). Note that, for positive numbers, if <code>sqrt(a) &lt; sqrt(b)</code> is true then <code>a &lt; b</code> will also be true (in other words, you could calculate &quot;area squared&quot; and use that instead)."}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1545243279, "post_id": 53856587, "comment_id": 94561788, "body": "@TypeIA Thank you, but I still don&#39;t get it. Should I write (j=i+1;j&lt;n-1;++j)?"}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1545244139, "post_id": 53856587, "comment_id": 94562141, "body": "@TypeIA I actually looked up a couple of websites and they all write bubble sort similarly. Here are links for reference: www.geeksforgeeks.org/bubble-sort/ and www.programmingsimplified.com/c/source-code/c-program-bubble&zwnj;&#8203;-sort I don&#39;t understand what wrong in my implementation and will be really grateful if you can lead me with an example. Thanks."}, {"owner": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "edited": false, "score": 0, "creation_date": 1545255075, "post_id": 53856587, "comment_id": 94566695, "body": "Your ranges are more complex than necessary, but look correct.  Your <code>p</code> calculation is slightly wrong but it shouldn&#39;t cause the problem that you indicate.  Maybe the problem is in some other part of the code that you are not showing?  The input or output?  Alternately, try dividing by <code>2.0</code> and/or eliminating the <code>sqrt</code>.  Perhaps this is a casting error."}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "reply_to_user": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "edited": false, "score": 0, "creation_date": 1545325889, "post_id": 53856587, "comment_id": 94593562, "body": "@mdfst13 it works fine for n&lt;=10. This is the next test case for n = 20 the output is broken. Do you think there is a memory management issue?"}], "answers": [{"comments": [{"owner": {"reputation": 1754, "user_id": 4449640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-me4y5aVPCrY/AAAAAAAAAAI/AAAAAAAAABI/0dkBJMaB1IE/photo.jpg?sz=128", "display_name": "Kyle Williamson", "link": "https://stackoverflow.com/users/4449640/kyle-williamson"}, "edited": false, "score": 1, "creation_date": 1576786566, "post_id": 59416274, "comment_id": 105020075, "body": "Hi.  Code only answers are seen as low quality.  Could you add some text to clarify?  <a href=\"https://meta.stackoverflow.com/questions/300837/what-comment-should-i-add-to-code-only-answers\" title=\"what comment should i add to code only answers\">meta.stackoverflow.com/questions/300837/&hellip;</a>"}, {"owner": {"reputation": 35, "user_id": 12567231, "user_type": "registered", "profile_image": "https://graph.facebook.com/2566127440172708/picture?type=large", "display_name": "Madhav Mishra", "link": "https://stackoverflow.com/users/12567231/madhav-mishra"}, "reply_to_user": {"reputation": 1754, "user_id": 4449640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-me4y5aVPCrY/AAAAAAAAAAI/AAAAAAAAABI/0dkBJMaB1IE/photo.jpg?sz=128", "display_name": "Kyle Williamson", "link": "https://stackoverflow.com/users/4449640/kyle-williamson"}, "edited": false, "score": 0, "creation_date": 1576787523, "post_id": 59416274, "comment_id": 105020424, "body": "I wish i could add text but I&#39;m new to Stack Overflow and I don&#39;t know to give answers . Even I had to managed a lot to write those code ."}, {"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1576792513, "post_id": 59416274, "comment_id": 105022053, "body": "@MadhavMishra Then you should read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and keep-on answering... your effort is appreciated!"}, {"owner": {"reputation": 35, "user_id": 12567231, "user_type": "registered", "profile_image": "https://graph.facebook.com/2566127440172708/picture?type=large", "display_name": "Madhav Mishra", "link": "https://stackoverflow.com/users/12567231/madhav-mishra"}, "edited": false, "score": 0, "creation_date": 1576865311, "post_id": 59416274, "comment_id": 105045132, "body": "Yes sure. Thank you!!"}], "tags": [], "owner": {"reputation": 35, "user_id": 12567231, "user_type": "registered", "profile_image": "https://graph.facebook.com/2566127440172708/picture?type=large", "display_name": "Madhav Mishra", "link": "https://stackoverflow.com/users/12567231/madhav-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1576791418, "last_edit_date": 1576791418, "creation_date": 1576785943, "answer_id": 59416274, "question_id": 53856587, "link": "https://stackoverflow.com/questions/53856587/sorting-sides-of-n-triangles-according-to-the-area/59416274#59416274", "title": "Sorting sides of n triangles according to the area", "body": "<p>I just improvised your code and it works:</p>\n\n<pre><code>#include &lt; stdio.h &gt;\n#include &lt; stdlib.h &gt;\n#include &lt; math.h &gt;\n\nstruct triangle\n{\n    int a;\n    int b;\n    int c;\n};\n\ntypedef struct triangle triangle;\nfloat area(int a, int b, int c)\n{\n    float p;\n    p = (float)(a + b + c) / 2;\n    return sqrt(p * (p - a) * (p - b) * (p - c));\n}\nvoid sort_by_area(triangle* tr, int n)\n{\n    int i, j;\n\n    float area1, area2;\n    triangle temp[5];\n    for (i = 0; i &lt; n - 1; i++)\n    {\n        for (j = 0; j &lt; n - i - 1; j++)\n        {\n            area1 = area(tr[j].a, tr[j].b, tr[j].c);\n            area2 = area(tr[j + 1].a, tr[j + 1].b, tr[j + 1].c);\n            if (area1 &gt; area2)\n            {\n                temp[0] = tr[j];\n                tr[j] = tr[j + 1];\n                tr[j + 1] = temp[0];\n            }\n        }\n    }\n}\n\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n    triangle* tr = malloc(n * sizeof(triangle));\n    for (int i = 0; i &lt; n; i++)\n    {\n        scanf(\"%d%d%d\", &amp;tr[i].a, &amp;tr[i].b, &amp;tr[i].c);\n    }\n    sort_by_area(tr, n);\n    for (int i = 0; i &lt; n; i++)\n    {\n        printf(\"%d %d %d\\n\", tr[i].a, tr[i].b, tr[i].c);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 1, "creation_date": 1576792783, "post_id": 59417215, "comment_id": 105022141, "body": "Maybe it would <b>help more to explain</b> how you approached the problem, using comments to share your knowledge. Designing effective algorithms is a result of thinking and applying rules. These contribute to a good answer."}, {"owner": {"reputation": 11, "user_id": 10798833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/raU8H.jpg?s=128&g=1", "display_name": "Z&#252;mr&#252;d-&#252; Anka", "link": "https://stackoverflow.com/users/10798833/z%c3%bcmr%c3%bcd-%c3%bc-anka"}, "reply_to_user": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1576793628, "post_id": 59417215, "comment_id": 105022416, "body": "Sorry, you are right. I try the explain with my bad English :) I hope this is usefully :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 10798833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/raU8H.jpg?s=128&g=1", "display_name": "Z&#252;mr&#252;d-&#252; Anka", "link": "https://stackoverflow.com/users/10798833/z%c3%bcmr%c3%bcd-%c3%bc-anka"}, "is_accepted": false, "score": 1, "last_activity_date": 1602723286, "last_edit_date": 1602723286, "creation_date": 1576791712, "answer_id": 59417215, "question_id": 53856587, "link": "https://stackoverflow.com/questions/53856587/sorting-sides-of-n-triangles-according-to-the-area/59417215#59417215", "title": "Sorting sides of n triangles according to the area", "body": "<p>This is my solution for this challenge:</p>\n<pre><code>double area(triangle t){\n    double p = (t.a+t.b+t.c)/2.0;\n    return sqrt(p*(p-t.a)*(p-t.b)*(p-t.c));\n}\n\nvoid sort_by_area(triangle* tr, int n) {\n    int i,j;\n    for(i=0;i&lt;n-1;i++){\n        for(j=i+1;j&lt;n;j++){\n            if(area(tr[j]) &lt; area(tr[i])){\n                triangle temp = tr[i];\n                tr[i]=tr[j];\n                tr[j]=temp;\n            }\n        }\n    }\n}\n</code></pre>\n<p>Your usage of the 'for' loop for comparing triangles is this (by triangle, I mean triangle's area):</p>\n<pre><code>for(i = 0; i &lt; n - 1; ++i){\n    ...\n    ...\n    for(j = 0; j &lt; n - i - 1; ++j){\n        ...\n    }\n}\n</code></pre>\n<p>Observe carefully: The loop you used fails to compare the last elements of the arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10272063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72e9a82de33224de0829e928e262970?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/10272063/shawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1590291190, "creation_date": 1590291190, "answer_id": 61981312, "question_id": 53856587, "link": "https://stackoverflow.com/questions/53856587/sorting-sides-of-n-triangles-according-to-the-area/61981312#61981312", "title": "Sorting sides of n triangles according to the area", "body": "<p>An edit of @Z\u00fcmr\u00fcd-\u00fc Anka's answer to match the bubble sorts you'll find elsewhere. Your loops actually should work fine, both for loops here are the same as yours. This passes the test cases for HackerRank. I think it was actually just the integer division that was giving you an issue. </p>\n\n<pre><code>double area(triangle t){\n    double p = (t.a+t.b+t.c)/2.0;\n    return sqrt(p*(p-t.a)*(p-t.b)*(p-t.c));\n}\n\nvoid sort_by_area(triangle* tr, int n) {\n    int i,j;\n    for(i=0;i&lt;n-1;i++){\n        for(j=0;j&lt;n-i-1;j++){\n            if(area(tr[j]) &gt; area(tr[j+1])){\n                triangle temp = tr[j+1];\n                tr[j+1]=tr[j];\n                tr[j]=temp;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2734, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1602723286, "creation_date": 1545241262, "question_id": 53856587, "link": "https://stackoverflow.com/questions/53856587/sorting-sides-of-n-triangles-according-to-the-area", "title": "Sorting sides of n triangles according to the area", "body": "<p>Given n triangles, with sides a,b,c print them in the same style by sorting them from the smallest to the largest.\nComplete problem: <a href=\"https://www.hackerrank.com/challenges/small-triangles-large-triangles/problem\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/small-triangles-large-triangles/problem</a></p>\n\n<p>In the solution, we have a structure named as Triangle. It has 3 integers a,b,c. An array of Triangle is made, named as tr and the input is passed to the function sort_by_area.\nMy approach is to apply bubble sort on this array.But instead of comparing tr[j] > tr[j+1] like we do in normal bubble sort, I'm comparing the areas of tr[j] and tr[j+1]. Now, if area of tr[j] > tr[j+1]: Swap.</p>\n\n<p>The problem: In the end the results are wrong. The array doesn't sort properly. First I thought it's a typo somewhere so I rewrite the code but the problem persists.</p>\n\n<pre><code>double area (int a, int b, int c)\n{\n double  p = (a+b+c)/2;\n return sqrt(p*(p-a)*(p-b)*(p-c));\n}\n\nvoid sort_by_area(triangle* tr, int n) {\n/**\n* Sort an array a of the length n\n*/\nint i,j;\ndouble area1, area2;\ntriangle temp;\nfor(i = 0; i &lt; n-1;++i)\n{ \n    for(j = 0; j &lt; n-i-1; ++j)\n    {\n        area1 = area(tr[j].a , tr[j].b, tr[j].c);\n        area2 = area(tr[j+1].a , tr[j+1].b, tr[j+1].c);\n        if(area1 &gt; area2)\n        {\n            temp = tr[j];\n            tr[j] = tr[j+1];\n            tr[j+1] = temp;\n        } \n    }\n}\n\n}\n</code></pre>\n\n<p>input: 20</p>\n\n<p>23 37 47\n22 18 5\n58 31 31\n28 36 40\n54 62 11\n31 41 14\n53 18 54\n41 38 55\n55 44 44\n44 48 18\n26 41 65\n20 23 21\n58 61 50\n28 56 56\n20 39 32\n33 45 49\n26 41 62\n31 46 39\n48 49 67\n57 33 45</p>\n\n<p>expected output:\n22 18 5\n31 41 14\n20 23 21\n54 62 11\n26 41 65\n58 31 31\n20 39 32\n26 41 62\n44 48 18\n23 37 47\n53 18 54\n28 36 40\n31 46 39\n33 45 49\n57 33 45\n28 56 56\n41 38 55\n55 44 44\n48 49 67\n58 61 50</p>\n\n<p>actual output:\n22 18 5\n54 62 11\n31 41 14\n20 23 21\n26 41 65\n20 39 32\n58 31 31\n26 41 62\n23 37 47\n44 48 18\n53 18 54\n28 36 40\n31 46 39\n33 45 49\n57 33 45\n28 56 56\n41 38 55\n55 44 44\n48 49 67\n58 61 50</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545240007, "post_id": 53856224, "comment_id": 94560303, "body": "Like <code>struct {int property1, int property2} x = {10,20};</code>?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545240083, "post_id": 53856224, "comment_id": 94560354, "body": "you can&#39;t initialize structure member inside structure as they are not in existence until variable of structure didn&#39;t get created. First create variable like <code>struct MyStruct var = {10,20};</code> or <code>struct MyStruct{     int property1;     int property2; } var = {10,20}</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10799156"}, "edited": false, "score": 0, "creation_date": 1545240237, "post_id": 53856224, "comment_id": 94560428, "body": "I get an error message"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1545241281, "post_id": 53856224, "comment_id": 94560935, "body": "<i>What</i> error message?"}], "owner": {"user_type": "does_not_exist", "display_name": "user10799156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1545239926, "answer_count": 0, "score": 0, "last_activity_date": 1545239803, "creation_date": 1545239803, "question_id": 53856224, "link": "https://stackoverflow.com/questions/53856224/defining-values-in-struct", "closed_reason": "Duplicate", "title": "Defining values in struct?", "body": "<p>How can I make a struct and define values inside:</p>\n\n<pre><code>struct MyStruct{\n    int property1 = 10;\n    int property2 = 20;\n}\n</code></pre>\n\n<p>It does not work. I don't want to make a whole typedef struct just for one object. How can I define values inside my one struct? Please help me!</p>\n"}, {"tags": ["c", "struct", "conflicting-libraries", "name-collision"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1545238372, "post_id": 53855784, "comment_id": 94559440, "body": "include guards do not help if the same name is used in two different headers."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1545238471, "post_id": 53855784, "comment_id": 94559493, "body": "I don&#39;t think there is a standard way. Library authors should think about such an issues and create unique names. Such as <code>stack_item_t</code> vs <code>queue_item_t</code>"}, {"owner": {"reputation": 397, "user_id": 7940762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sArw5.png?s=128&g=1", "display_name": "Renan Lopes", "link": "https://stackoverflow.com/users/7940762/renan-lopes"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545238638, "post_id": 53855784, "comment_id": 94559590, "body": "@EugeneSh. There is no way to fix this without changing the original code?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1545238659, "post_id": 53855784, "comment_id": 94559596, "body": "There is no way to prevent that kind of clashes. The usual is to prefix identifiers with something, hopefully, unique. Maybe, in your case, <code>struct item</code> should be either <code>struct RL_stack_item</code> or <code>struct RL_queue_item</code>. Also, in my opinion, do not pollute the global namespace with <code>typedef</code>s."}, {"owner": {"reputation": 397, "user_id": 7940762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sArw5.png?s=128&g=1", "display_name": "Renan Lopes", "link": "https://stackoverflow.com/users/7940762/renan-lopes"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545239134, "post_id": 53855784, "comment_id": 94559833, "body": "@pmg It means that I should use it as a struct without redefining its name?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1545239149, "post_id": 53855784, "comment_id": 94559843, "body": "Making wrapper libraries could possibly help. But it&#39;s too much hassle."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1545239576, "post_id": 53855784, "comment_id": 94560057, "body": "In my opinion, library header files should not create <code>typedef</code>s. If the user of the library cannot type <code>struct foo_bar_xyz</code> let him do the <code>typedef struct foo_bar_xyz fbx</code> himself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545240659, "post_id": 53855784, "comment_id": 94560645, "body": "I&#39;m not a big fan of <code>typedef</code>s myself, @pmg, but it does not appear that <code>typedef</code>s are the only problem here.  There is a collision of structure tags as well, unless those two structure types somehow manage to be compatible, in the standard&#39;s sense of that term."}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 7940762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sArw5.png?s=128&g=1", "display_name": "Renan Lopes", "link": "https://stackoverflow.com/users/7940762/renan-lopes"}, "edited": false, "score": 0, "creation_date": 1545240207, "post_id": 53856132, "comment_id": 94560409, "body": "I thought that different files wouldn&#39;t cause this conflict even with equal names. Something like <code>filename_struct</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 397, "user_id": 7940762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sArw5.png?s=128&g=1", "display_name": "Renan Lopes", "link": "https://stackoverflow.com/users/7940762/renan-lopes"}, "edited": false, "score": 1, "creation_date": 1545240501, "post_id": 53856132, "comment_id": 94560565, "body": "@RenanLopes, there is no problem with using the same identifier for different things in different translation units.  Formally, however, there <i>is</i> a problem with using different tags for supposedly the same structure type in different translation units, if objects of that type are in any way communicated between the two."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1545239831, "last_edit_date": 1545239831, "creation_date": 1545239460, "answer_id": 53856132, "question_id": 53855784, "link": "https://stackoverflow.com/questions/53855784/what-is-the-standard-way-to-fix-conflicting-types-from-different-libraries-in-c/53856132#53856132", "title": "What is the standard way to fix conflicting types from different libraries in C?", "body": "<p>C has only one namespace for structure tags, which also contains the tags of unions and enumerations.  You cannot use two different structure types with the same tag in the same scope.  There is a different namespace that contains <code>typedef</code>ed identifiers, among other things, but again, one type name can mean only one thing in any given scope.</p>\n\n<p>However, in practice, structure names are significant only at compile time.  If you are using packaged, pre-compiled versions of the third-party libraries then probably all you need to worry about is the headers.  You <em>might</em> be able to use the preprocessor to change one or both of the tags within the scopes of your program's translation units.  For example,</p>\n\n<pre><code>#define item stack_item\n#include &lt;stack.h&gt;\n#undef item\n\n#define item queue_item\n#include &lt;queue.h&gt;\n#undef item\n</code></pre>\n\n<p>Your code would then use <code>struct stack_item</code> and / or the typedef <code>stack_item</code> for the one, and <code>struct queue_item</code> and / or <code>queue_item</code> for the other.  Be aware that there is a risk of that having a broader effect than you want -- changing structure member names, for example.  Additionally, although it has a decent chance to work, it is technically non-conforming to call any functions that have parameters or return types derived from or containing instances of the original structure types (with some caveats).</p>\n\n<p>In the event that that does not work, you could also consider performing equivalent edits by hand to produce local versions of the headers for use by your project only.  This would allow you to be more precise about what gets changed, but using these headers still suffers from the conformance issues described above.</p>\n\n<p>If you must use both libraries in the same translation unit and you want to ensure that your code conforms to the standard, then you're out of luck.  The only <em>conforming</em> alternative is to modify and rebuild one or both libraries so that they no longer have name collisions.</p>\n"}], "owner": {"reputation": 397, "user_id": 7940762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sArw5.png?s=128&g=1", "display_name": "Renan Lopes", "link": "https://stackoverflow.com/users/7940762/renan-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 53856132, "answer_count": 1, "score": 0, "last_activity_date": 1545239831, "creation_date": 1545238293, "question_id": 53855784, "link": "https://stackoverflow.com/questions/53855784/what-is-the-standard-way-to-fix-conflicting-types-from-different-libraries-in-c", "title": "What is the standard way to fix conflicting types from different libraries in C?", "body": "<p>I'm trying to include 3rd party libraries into the <strong>.c</strong> file but it gives either <strong>redefinition</strong> or <strong>conflicting types</strong> error since it has typedef structs with the same name.</p>\n\n<p>I've tried to include guards after reading some answers here in SO and obviously directly changing the typedef on the <strong>.h</strong> file has solved the problem.</p>\n\n<p><em>e.g.</em> (Also have to change the functions return type)</p>\n\n<pre><code>// stack.h\ntypedef struct item stack_item;\n\n// queue.h\ntypedef struct item queue_item;\n</code></pre>\n\n<p>However, the original code is as follows:</p>\n\n<pre><code>// stack.h\ntypedef struct item item;\n\n// queue.h\ntypedef struct item item;\n</code></pre>\n\n<p>It throws the following error:</p>\n\n<pre><code>In file included from test.c:5:0:\nQueues/queue.c:6:8: error: redefinition of \u2018struct item\u2019\n struct item {\n        ^\n\nIn file included from Stacks/stack.c:4:0, from test.c:4:\nStacks/stack.h:6:16: note: originally defined here\n typedef struct item item;\n                ^\n</code></pre>\n\n<p>I would like to know what is the standard way to solve this, instead of changing the definitions in the <strong>.h</strong> file</p>\n"}, {"tags": ["c", "linked-list", "structure"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545238279, "post_id": 53855761, "comment_id": 94559388, "body": "You most likely do."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1545238829, "post_id": 53855761, "comment_id": 94559679, "body": "how would you store 7 different numbers? it&#39;s the same principle"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545239521, "post_id": 53855761, "comment_id": 94560028, "body": "&quot;Do I need 7 structures?&quot; because your lists hold the same type you have to define only <i>one</i> time the supporting structs and functions, and that independently if you will create 7 lists or any other number of them. If you need to open 7 files you use the same type FILE, not FILE1, FILE2 ... FILE7 ... fortunately."}], "answers": [{"tags": [], "owner": {"reputation": 527, "user_id": 10488746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vTDhZ.jpg?s=128&g=1", "display_name": "H.cohen", "link": "https://stackoverflow.com/users/10488746/h-cohen"}, "is_accepted": true, "score": 1, "last_activity_date": 1545239676, "creation_date": 1545239676, "answer_id": 53856198, "question_id": 53855761, "link": "https://stackoverflow.com/questions/53855761/how-do-i-create-multiple-linked-lists/53856198#53856198", "title": "How do I create multiple linked lists?", "body": "<p>Each list is made out of nodes. Each node is a struct. so each node in each list is a struct.\nthe typical node looks like this:</p>\n\n<pre><code>struct node\n{\n   struct node* next;\n   struct node* prev;\n   int data; /*can be int char char* void* and so on depending on the type of data you want to store*/\n};\n</code></pre>\n\n<p>the next node will store a pointer to the next node in that list. the prev will store a pointer to the previous node in the list.</p>\n\n<p>Now - if you need to store 7 same type elements in one list it will contain 7 nodes - 7 structs.</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 37, "user_id": 10347787, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xkMjeSkniiU/AAAAAAAAAAI/AAAAAAAAAHU/rnzwTlKJFDA/photo.jpg?sz=128", "display_name": "mackesmilian", "link": "https://stackoverflow.com/users/10347787/mackesmilian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 53856198, "answer_count": 1, "score": -2, "last_activity_date": 1545511333, "creation_date": 1545238238, "question_id": 53855761, "link": "https://stackoverflow.com/questions/53855761/how-do-i-create-multiple-linked-lists", "title": "How do I create multiple linked lists?", "body": "<p>Basically, I need 7 linked lists which hold the same types of data. How do I go about this? I am not experienced in C, I know how to create a linked list with a Structure. But how do I create 7 linked lists? Do I need 7 structures? </p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545237912, "post_id": 53855633, "comment_id": 94559168, "body": "For which input? I.e. what is surprising you about that?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 5, "creation_date": 1545237951, "post_id": 53855633, "comment_id": 94559187, "body": "both test are same in if and else if, what are you trying to do ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545238104, "post_id": 53855633, "comment_id": 94559285, "body": "Since your <code>input</code> array has space for <i>strings</i> up to 9 characters long, use <code>scanf(&quot;%9s&quot;, input);</code> to prevent buffer overflows."}, {"owner": {"reputation": 103, "user_id": 10695408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2781a16988af5f2aa05274716be683?s=128&d=identicon&r=PG&f=1", "display_name": "Avocado", "link": "https://stackoverflow.com/users/10695408/avocado"}, "edited": false, "score": 0, "creation_date": 1545238620, "post_id": 53855633, "comment_id": 94559577, "body": "edited, sorry. I am trying to check if they equal &quot;math&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545239360, "post_id": 53855633, "comment_id": 94559946, "body": "&quot;If I input the string &quot;math&quot;,I get cpi in the output,&quot; --&gt; because <code>(strcmp(&quot;math&quot;,&quot;math&quot;) == 0)</code> is true."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 3594190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d7878378bed553d490d179a0c592474?s=128&d=identicon&r=PG&f=1", "display_name": "PerfectContrast", "link": "https://stackoverflow.com/users/3594190/perfectcontrast"}, "is_accepted": true, "score": 1, "last_activity_date": 1545242303, "creation_date": 1545242303, "answer_id": 53856824, "question_id": 53855633, "link": "https://stackoverflow.com/questions/53855633/checking-if-two-strings-match/53856824#53856824", "title": "Checking if two strings match", "body": "<pre><code>if(strcmp(input,subject1) == 0)\n</code></pre>\n\n<p>Is true when you input math as strcmp() returns 0 if the arguments match. So what you want is</p>\n\n<pre><code>if(strcmp(input,subject1) != 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 10784315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtBov1jbNKk/AAAAAAAAAAI/AAAAAAAACGU/Pa9R61HyPsA/photo.jpg?sz=128", "display_name": "Kazi", "link": "https://stackoverflow.com/users/10784315/kazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1545242609, "creation_date": 1545242609, "answer_id": 53856898, "question_id": 53855633, "link": "https://stackoverflow.com/questions/53855633/checking-if-two-strings-match/53856898#53856898", "title": "Checking if two strings match", "body": "<p>Both of the if-conditions are true here. So, when the first 'if' condition is satisfied and executed, it doesn't check the 'else if' condition. The 'else if' condition only gets checked and executed whenever all the previous 'if' conditions were false. </p>\n\n<p>Hope this helped. </p>\n"}], "owner": {"reputation": 103, "user_id": 10695408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2781a16988af5f2aa05274716be683?s=128&d=identicon&r=PG&f=1", "display_name": "Avocado", "link": "https://stackoverflow.com/users/10695408/avocado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53856824, "answer_count": 2, "score": -3, "last_activity_date": 1545243397, "creation_date": 1545237782, "last_edit_date": 1545243397, "question_id": 53855633, "link": "https://stackoverflow.com/questions/53855633/checking-if-two-strings-match", "title": "Checking if two strings match", "body": "<p>I am trying to check whether an user input matches a variable in my program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* subject1 = \"math\";\nchar input[10];\n\nint main() \n{\n    printf(\"Subject: \");\n    scanf(\"%s\", input);\n\n    if(strcmp(input,subject1) == 0)\n    {\n        printf(\"cpi\\n\");\n    }\n    else if(strcmp(input,subject1) == 0)\n    {\n        printf(\"math\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If I input the string \"math\",I get <code>cpi</code> in the output, instead of <code>math</code>. Why?</p>\n"}, {"tags": ["c", "arrays", "malloc"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1545237609, "post_id": 53855496, "comment_id": 94558993, "body": "You only change <code>vect</code> locally."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1545237613, "post_id": 53855496, "comment_id": 94558997, "body": "Your input validation is incorrect. You ask for <code>n</code> once, if invalid -  you ask again. Then not checking anymore. Also it looks like you do not expect <code>n</code> to be greater than <code>4</code>, so why <code>250</code>?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545239399, "post_id": 53855496, "comment_id": 94559968, "body": "Can you elaborate <code>each time the array is full </code> as <code>if(i==n)</code> part ?"}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1545238218, "last_edit_date": 1545238218, "creation_date": 1545237762, "answer_id": 53855629, "question_id": 53855496, "link": "https://stackoverflow.com/questions/53855496/c-function-stops-after-few-iterations/53855629#53855629", "title": "C function stops after few iterations", "body": "<p>Firstly, Change this</p>\n\n<pre><code>if ((n&lt;1)||(n&gt;4)) { } /* use &amp;&amp; instead of || to scan if n if both condition are true*/\n</code></pre>\n\n<p>to</p>\n\n<pre><code>//scanf(\"%d\",&amp;n); /*remove this, use only once, in below loop */\nwhile(1) {\n    scanf(\"%d\",&amp;n);\n    if ((n&gt;=1) &amp;&amp; (n&lt;=4)) {\n       break; \n    }\n    else {\n       printf(\"Number not valid, try again: '\");\n    }\n}\n</code></pre>\n\n<p>And allocate memory equal to <code>n</code> bytes. for e.g</p>\n\n<pre><code>int *arr = malloc (n * sizeof(*arr)); /* typecasting is not required */\n</code></pre>\n\n<p>Also here</p>\n\n<pre><code>for (int i=0;i&lt;220;i++) { /* some code */ }\n</code></pre>\n\n<p>what is the rationale behind rotating loop <code>220</code> times, doesn't it should be <code>n</code> times ?</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1545240290, "creation_date": 1545240290, "answer_id": 53856356, "question_id": 53855496, "link": "https://stackoverflow.com/questions/53855496/c-function-stops-after-few-iterations/53856356#53856356", "title": "C function stops after few iterations", "body": "<p>As you were said in comment, your main error is that realloc is allowed to change the pointer value. If it happens, the new value is only assigned to the local copy inside the <code>doubleArray</code> function, but the caller still keeps the previous value which is now a dangling pointer (pointing to non allocated memory). Using it invokes Undefined Behaviour (and crashes are to be expected...)</p>\n\n<p>The correct way is to return the new pointer value:</p>\n\n<pre><code>int * doubleArray(int vect[], int *dim)\n{\n    int n = *dim *2;\n    *dim = n;\n    return realloc(vect, n*sizeof(int));\n}\n</code></pre>\n\n<p>That is not all. best practices recommend to test allocation. In a stressed environment, the system could be unable to allocate enough memory and realloc could return NULL. Proceeding would then also involve Undefined Behaviour.</p>\n\n<p>Let us go on. Controlling input is nice, but a user can type twice an error, so you should loop until you get a correct value:</p>\n\n<pre><code>int n;\nfor (;;) {\n    printf(\"Insert a number between 1 and 4: \");\n    scanf(\"%d\",&amp;n);\n    if ((n &gt;= 1) &amp;&amp; (n &lt;= 4)) break;\n    printf(\"Number not valid, try again: '\");\n}\n</code></pre>\n\n<p>And please, please <strong><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">do not cast malloc in C language</a></strong>. It is useless and can hide hard to find indirection level errors.</p>\n\n<p>Finally, I cannot understand why you have a loop up to 220... From your requirements it should be up to 2048.</p>\n\n<p>Last point (but this one is only my opinion, not a problem): I would only display the initialized content of the array, so up to <code>i</code> instead of <code>n</code>. That way you would see the array grow while always keeping the same (initialized) values:</p>\n\n<pre><code>int *arr = malloc (n*sizeof(int));\nsrand(time(NULL));\nint num;\nfor (int i=0;i&lt;2048;i++)\n{\n    num = rand();\n    if (i==n)\n    {\n        arr = doubleArray(arr, &amp;n);\n        if (arr == NULL) {\n            perror(\"allocation error\");\n            return 1;\n        }\n        stampaArray(arr, i);\n        printf(\"\\n\");\n    }\n    arr[i]=num;\n}\nstampaArray(arr,2048);\nfree(arr); // not required immediately before a return but good practice\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9032563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1752997721398364/picture?type=large", "display_name": "Simone Barandoni", "link": "https://stackoverflow.com/users/9032563/simone-barandoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545240290, "creation_date": 1545237305, "last_edit_date": 1545237374, "question_id": 53855496, "link": "https://stackoverflow.com/questions/53855496/c-function-stops-after-few-iterations", "title": "C function stops after few iterations", "body": "<p>The program should do this: write a doubleArray() function, which takes in input an array of int and its size (as a pointer to int). In the main(): ask the user to input an integer n between 1 and 4, then dynamically create an array of size n. Then start filling the array with 2048 randomly generated int: each time the array is full, call the doubleArray function; each time the function doubleArray is called, print the content of the array.</p>\n\n<p>My code works until the size of array n reach a number around 250, then stops inside the for loop.</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\nvoid doubleArray(int vect[], int *dim)\n{\n    int n = *dim *2;\n    *dim = n;\n    vect = (int*)realloc(vect, n*sizeof(int));\n}\n\nvoid stampaArray(int vect[], int dim)\n{\n    for (int i=0;i&lt;dim;i++)\n    {\n        printf(\"%d \",vect[i]);\n    }\n    printf(\"\\n\");\n}\n\nint main()\n{\n    printf(\"Insert a number between 1 and 4: \");\n        int n;\n    scanf(\"%d\",&amp;n);\n    if ((n&lt;1)||(n&gt;4))\n    {\n        printf(\"Number not valid, try again: '\");\n        scanf(\"%d\",&amp;n); \n    }\n    int *arr = (int*) malloc (n*sizeof(int));\n    srand(time(NULL));\n    int num;\n    for (int i=0;i&lt;220;i++)\n    {\n        num = rand();\n        if (i==n)\n        {\n            doubleArray(arr, &amp;n);\n            stampaArray(arr, n);\n        }\n        arr[i]=num;\n    }\n    stampaArray(arr,n);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1545236197, "post_id": 53855080, "comment_id": 94558162, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/376278/parameter-evaluation-order-before-a-function-calling-in-c\">Parameter evaluation order before a function calling in C</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1545236206, "post_id": 53855080, "comment_id": 94558168, "body": "You can never rule out UB by observing the actual behavior of a program.  UB does not necessarily mean &quot;it crashes&quot; or &quot;it behaves inconsistently&quot; or &quot;it does something unexpected&quot;, though of course your program <i>does</i> do something you don&#39;t expect."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1545236845, "post_id": 53855080, "comment_id": 94558569, "body": "There is no UB here, and the suggested duplicate is not a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "edited": false, "score": 0, "creation_date": 1545236801, "post_id": 53855156, "comment_id": 94558542, "body": "If all parameters are evaluated before function call regardless of evaluation order, shouldn&#39;t there be an overwrite in the case of the integer array as well?"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 0, "last_activity_date": 1545236054, "creation_date": 1545236054, "answer_id": 53855156, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call/53855156#53855156", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>There is only one variable <code>mess</code>.\nWhen you call:</p>\n\n<pre><code>printf(\"%s %s\\n\", mes(55), mes(25));\n</code></pre>\n\n<p>You are filling in that one variable two different times, once with <code>\"25\"</code> and once with <code>\"55\"</code> (overwriting the <code>\"25\"</code>).  As a result, when <code>printf</code> goes to format with <code>%s %s</code>, it finds the same string twice, <code>\"55\"</code> and again <code>\"55\"</code> because the <code>\"25\"</code> has already been overwritten.</p>\n\n<p>You need to be aware that all parameters to a function are evaluated before the function is called. The order of parameter evaluation is not defined, but is often right-to-left.  Breaking down that <code>printf</code> into little steps:</p>\n\n<ol>\n<li>Evaluate the <code>mes(25)</code>; now static char mess is now <code>\"25\"</code>.</li>\n<li>Evaluate the <code>mes(55)</code>, now static char mess is overwritten to <code>\"55\"</code>.</li>\n<li>Evaluate the parameter <code>\"%s %s\\n\"</code> (there isn't much to evaluate here.  Its just a string)</li>\n<li>Call <code>printf</code> with parameters: <code>\"%s %s\\n\"</code>, and <code>\"55\"</code> and <code>\"55\"</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "edited": false, "score": 0, "creation_date": 1545236576, "post_id": 53855185, "comment_id": 94558405, "body": "But shouldn&#39;t it be the same for the integer array?"}, {"owner": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "edited": false, "score": 0, "creation_date": 1545238022, "post_id": 53855185, "comment_id": 94559230, "body": "So if I understand correctly, when pointers are involved parameters are all evaluated before printing. While when passing integers (by value) the printing is done in-place?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "edited": false, "score": 1, "creation_date": 1545238178, "post_id": 53855185, "comment_id": 94559324, "body": "No, no. Parameters are <i>always</i> passed by value. Whenever they are pointer or not. It is just that in the first case two <i>identical</i> values have been passed to the function, but in second case two different ones were passed. Do you see why the code above is equivalent to yours?"}, {"owner": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "edited": false, "score": 0, "creation_date": 1545238993, "post_id": 53855185, "comment_id": 94559758, "body": "Thanks, I think I got it."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 5, "last_activity_date": 1545237295, "last_edit_date": 1545237295, "creation_date": 1545236148, "answer_id": 53855185, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call/53855185#53855185", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>The order of evaluation of function parameters is unspecified, meaning that you can theoretically see <code>25 25</code> instead. That's first thing. \nSecond, when <code>printf</code> is called, both functions have been already evaluated, and the <em>same</em> pointer is passed as first and the second string (because it is a static location), which is the result of the last evaluation (<code>55</code> in your case). So identical text is printed. </p>\n\n<p>This is pretty much equivalent to the following:</p>\n\n<pre><code>char* a = mes(25);\nchar* b = mes(55);\n\n// Note, the above can swap depending on the order of evaluation\n\nprintf(\"%s %s\\n\", a, b);\n</code></pre>\n\n<p>But here <code>a</code> equals <code>b</code> as both are pointing to a static array.</p>\n\n<p>As for the second example this is not happening as it will be equivalent to the following (up to the order of evaluation):</p>\n\n<pre><code>int *ap = hes(55);\nint a = ap[0];\n\nint *bp = hes(25);\nint b = bp[0];\n\nprintf(\"%d %d\\n\", a, b);\n</code></pre>\n\n<p>Note, that here the <em>pointed values</em> are passed and not the pointer itself. So even though <code>ap</code> equals <code>bp</code>, <code>a</code> is not the same as <code>b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 0, "last_activity_date": 1545236193, "creation_date": 1545236193, "answer_id": 53855196, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call/53855196#53855196", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>When you call:</p>\n\n<p><code>printf(\"%s %s\\n\", mes(55), mes(25));</code></p>\n\n<p><code>mes(55)</code> and <code>mes(25)</code> get evaluated before their result is populated into the string.  And since you're pointing to the same static memory, when it's time to populate the string, you get the same value.</p>\n"}, {"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1545236227, "creation_date": 1545236227, "answer_id": 53855208, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call/53855208#53855208", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>Returning the address of a static variable is almost always a bad pattern as you'e found. There's only one such static allocation for the whole program, so for example calling mes twice causes the second call to overwrite the results of the first.</p>\n\n<p>A more reasonable pattern is having the caller furnish a buffer. This is also needed for thread safety:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst char* mes(char *buf, int a)\n{\n    sprintf(buf, \"%d\", a);\n    return buf;\n}\n\nconst int* hes(int *arr, char *buf, int a)\n{\n    arr[0] = a;\n    return arr;\n}\n\nint main()\n{\n    char buf1[100], buf2[100];\n    int arr[100];\n    printf(\"%s %s\\n\", mes(buf1, 55), mes(buf2, 25)); //55 55\n    printf(\"%s\\n\", mes(buf1, 55)); //55\n    printf(\"%s\\n\", mes(buf1, 25)); //25\n    printf(\"%d %d\\n\", hes(arr, 55)[0], hes(arr, 25)[0]); //55 25\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1545240773, "last_edit_date": 1545240773, "creation_date": 1545240466, "answer_id": 53856408, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call/53856408#53856408", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>The why code is wrong is well explained by others.</p>\n\n<p>An alternative to <code>static char mess[100]</code> is to use a <em>compound literal</em> as an argument.  Then the return value from <code>mes()</code>, <code>hes()</code> is valid until the end of the block of code - well after the <code>printf()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst char* mes_helper(char mess[100], int a) {\n  sprintf(mess, \"%d\", a);\n  return mess;\n}\nconst int* hes_helper(int arr[100], int a) {\n  arr[0] = a;\n  return arr;\n}\n\n// compound literal        v-------------v\n#define mes(a) mes_helper( (char [100]){0}, (a))\n#define hes(a) hes_helper( (int  [100]){0}, (a))\n\n// No changes to `main() code\nint main(void) {\n  printf(\"%s %s\\n\", mes(55), mes(25)); //55 55\n  printf(\"%s\\n\", mes(55)); //55\n  printf(\"%s\\n\", mes(25)); //25\n  printf(\"%d %d\\n\", hes(55)[0], hes(25)[0]); //55 25\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>55 25\n55\n25\n55 25\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7840442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rw62LxywxLg/AAAAAAAAAAI/AAAAAAAAD6w/RbEK9OFR0Bk/photo.jpg?sz=128", "display_name": "Raheeb Hassan", "link": "https://stackoverflow.com/users/7840442/raheeb-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 53855185, "answer_count": 5, "score": 2, "last_activity_date": 1545240773, "creation_date": 1545235780, "last_edit_date": 1545237868, "question_id": 53855080, "link": "https://stackoverflow.com/questions/53855080/sprintf-cant-change-static-variable-inside-printf-call", "title": "sprintf can&#39;t change static variable inside printf call", "body": "<p>I can't seem to understand what exactly is going on here</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst char* mes(int a)\n{\n    static char mess[100];\n    sprintf(mess, \"%d\", a);\n    return mess;\n}\nconst int* hes(int a)\n{\n    static int arr[100];\n    arr[0] = a;\n    return arr;\n}\n\nint main()\n{\n    printf(\"%s %s\\n\", mes(55), mes(25)); //55 55\n    printf(\"%s\\n\", mes(55)); //55\n    printf(\"%s\\n\", mes(25)); //25\n    printf(\"%d %d\\n\", hes(55)[0], hes(25)[0]); //55 25\n}\n</code></pre>\n\n<p>In the first printf the second function seems to be ignored and the output of the earlier input gets printed again.<br>\nAt first I assumed it was a static variable issue, so I tried printing them separately and then they seem to work fine.<br>\nThen I assumed it was a printf issue so I tried to simulate the same behavior with an integer array, and it worked fine there too.<br>\nI've run this program a couple of times with various inputs, ruling out the possibility of UB.<br>\nSo, what exactly am I missing here?</p>\n\n<p>EDIT:\nI encountered this issue somewhere else and couldn't understand what was happening. So I reproduced the issue in a short sample code. But my question stands, (as many have mentioned) are all the parameters evaluated before printing? If so there should be an overwrite in both cases (int and char array) regardless of evaluation order.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 0, "creation_date": 1545234646, "post_id": 53854645, "comment_id": 94557188, "body": "You&#39;re mixing <code>in</code> and <code>arch</code>. Name your variables more clearly. You can do both, but for clarity and sanity, don&#39;t."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545234935, "post_id": 53854645, "comment_id": 94557375, "body": "Two code review comments: (1) You can pass a pointer to const struct instead of passing the struct by value. Should be faster. (2) Writing binary data is brittle; changing from debug to relase build may already change the struct layout, let alone changing the compiler. Especially if you really want to persist data long-term (&quot;archive program&quot;) you should take care to be language, platform and compiler independent. The canonical method would be to choose a text format of your choice like XML or JASON and write 7 bit ascii text representations."}, {"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "edited": false, "score": 0, "creation_date": 1545237119, "post_id": 53854645, "comment_id": 94558733, "body": "It&#39;s writing fine now, but with ^@^@^@ between attributes - is this fine? I&#39;ve memsetted the structure before filling"}, {"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545237136, "post_id": 53854645, "comment_id": 94558741, "body": "Thanks @PeterA.Schneider, noted"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545246327, "post_id": 53854645, "comment_id": 94563122, "body": "^@ is the null character. The struct has gaps between the members which are undefined (in your case: are 0 because you zeroed the memory before). This padding is one of the reasons (besides integer sizes and float formats) why the same struct definition can differ binarily."}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "edited": false, "score": 0, "creation_date": 1545234846, "post_id": 53854707, "comment_id": 94557322, "body": "Thanks for this, apologies for such a basic mistake, I thought it was something semantically I was doing wrong. I&#39;ll implement the error checks throughout"}, {"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "edited": false, "score": 0, "creation_date": 1545237107, "post_id": 53854707, "comment_id": 94558721, "body": "It&#39;s writing fine now, but with ^@^@^@ between attributes - is this fine? I&#39;ve memsetted the structure before filling"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1545238697, "post_id": 53854707, "comment_id": 94559612, "body": "<code>^@</code> is actually the <code>NUL</code> byte"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 4, "last_activity_date": 1545234422, "creation_date": 1545234422, "answer_id": 53854707, "question_id": 53854645, "link": "https://stackoverflow.com/questions/53854645/how-do-i-use-fwrite-to-write-a-struct-to-a-file/53854707#53854707", "title": "How do I use fwrite() to write a struct to a file?", "body": "<p>Your <code>fwrite</code> is trying to write to <code>in</code>, not <code>arch</code>. Since you don't check the return value of <code>fwrite</code>, this error (trying to write to a file that's opened for read) is undetected.</p>\n"}], "owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545234422, "creation_date": 1545234177, "question_id": 53854645, "link": "https://stackoverflow.com/questions/53854645/how-do-i-use-fwrite-to-write-a-struct-to-a-file", "title": "How do I use fwrite() to write a struct to a file?", "body": "<p>I'm making an archive program in C - I've got it traversing and writing the file contents to a single file, but I can't seem to get the <code>fileHeader</code> structure I've created (using <code>fwrite()</code>) to write into the file (only using two attributes for testing at the moment, I know more will be required). Here's my code:</p>\n\n<pre><code>struct fileHeader {\n        char name[50];\n        char path[50];  \n};\n\nvoid addToArch(char *inPath, char *archPath, struct fileHeader header) {\n        FILE *in, *arch;\n        int ch;\n        arch = fopen(archPath, \"ab\");\n\n        struct stat sb;\n        stat(inPath, &amp;sb);\n\n        if(S_ISREG(sb.st_mode) == 0) {\n                fprintf(arch, \"\\n%s\\n\", inPath);\n                printf(\"Directory detected - skipped\");\n        }\n\n        else {\n                in = fopen(inPath, \"rb\");\n                ch = fgetc(in);\n                fwrite(&amp;header, 1, sizeof(struct fileHeader), in);\n                while (ch != EOF) {\n                        fputc(ch, arch);\n                        ch = fgetc(in);\n                }\n                fclose(in);\n                fclose(arch);\n                printf(\"File copied successfully!\\n\");\n        }\n}\n</code></pre>\n\n<p>My calling code is here:</p>\n\n<pre><code>//Create new file header\nstruct fileHeader header;\n//Populate struct fields\nsnprintf(header.name, 50, \"%s\", entry-&gt;d_name);\nsnprintf(header.path, 50, \"%s\", buffer);\n\naddToArch(buffer, \"out.txt\", header);\n</code></pre>\n\n<p>I've printed <code>entry-&gt;d_name</code> and <code>buffer</code> and they are definitely the strings I want going into the struct. There are no compiler errors, but no header is showing in my archive file, along with the contents.</p>\n"}, {"tags": ["c++", "c", "eclipse", "path", "include"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1545233219, "post_id": 53854318, "comment_id": 94556166, "body": "If you have a &quot;project with makefile&quot; doesn&#39;t that mean that you don&#39;t want Eclipse to mess around with settings and just use make instead?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1545233254, "post_id": 53854318, "comment_id": 94556197, "body": "Are you using Eclipse internal build, external build with Eclipse-generated makefiles, or some other build type?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1545233335, "post_id": 53854318, "comment_id": 94556249, "body": "And is Eclipse able to find and index your <code>cheddar.h</code> file?"}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1545233337, "post_id": 53854318, "comment_id": 94556251, "body": "^^^ External build with Eclipse-generated makefile, which I edited with the -I option."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1545233419, "post_id": 53854318, "comment_id": 94556323, "body": "@FredLarson, perhaps I misunderstand. If I specify a Makefile, does this sidestep and invalidate <code>Properties</code> settings described above?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1545233437, "post_id": 53854318, "comment_id": 94556336, "body": "Adding the include path as your Research 1 and 2 suggested is the right way. Did you make sure you specified it for the build configuration your actually using? Do you have multiple build configurations specified?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1545233499, "post_id": 53854318, "comment_id": 94556369, "body": "If you&#39;re using a makefile not generated by Eclipse, adding the path within Eclipse will not affect the include path used to build. It will affect the indexer."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1545233659, "post_id": 53854318, "comment_id": 94556465, "body": "Build Configuration is set to <code>Default [Active]</code> as shown in <code>Properties -&gt; C&#47;C++ Build</code> screen."}], "answers": [{"comments": [{"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1545419042, "post_id": 53860367, "comment_id": 94626202, "body": "If you must know, the <code>X</code> in this XY problem is the use of <b>VIM</b> as the primary editor. Don&#39;t get me wrong, VIM has it&#39;s place, and is great for a quick look at files, but there&#39;s only so much <code>gdb</code> I can take before I want a modern IDE, so I&#39;m trying to nurture us onto <b>Eclipse</b>. Think notepad++ vs Visual Studio in Windows, or TextWrangler vs Xcode on a Mac."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1545419279, "post_id": 53860367, "comment_id": 94626271, "body": "<b>Anyway</b>, it seems that I have three (3) solutions here: 1. Use a Makefile <i>not</i> generated by Eclipse with the <code>-I</code> option to specify target directories; 2. Use the Eclipse build system, and specify paths therein. 3. Set environment variables (<i>gasp</i>), as you suggest. The problem with (3) is that this code will be committed to source control, and I want User to be able to build with minimal environment setup. I suppose I could ask them to set up their environment variables, and/or write a little script to do so... but I fear that it&#39;s too much to ask."}, {"owner": {"reputation": 146, "user_id": 10587057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff297a4081a475da78e663c3475bf8e?s=128&d=identicon&r=PG&f=1", "display_name": "user6f6e65", "link": "https://stackoverflow.com/users/10587057/user6f6e65"}, "reply_to_user": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1545478078, "post_id": 53860367, "comment_id": 94636414, "body": "Are you generating the makefile with cmake? You can do the CXX_COMPILER_FLAGS option if you are, or you can use it in your makefile. if they aren&#39;t libraries that already exist you&#39;re going to want to put them in the same project so the users can get the code to compile. If not you&#39;ll have them as dependencies and they&#39;ll compile to their respective locations."}], "tags": [], "owner": {"reputation": 146, "user_id": 10587057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff297a4081a475da78e663c3475bf8e?s=128&d=identicon&r=PG&f=1", "display_name": "user6f6e65", "link": "https://stackoverflow.com/users/10587057/user6f6e65"}, "is_accepted": false, "score": 1, "last_activity_date": 1545260608, "creation_date": 1545260608, "answer_id": 53860367, "question_id": 53854318, "link": "https://stackoverflow.com/questions/53854318/eclipse-c-fatal-error-cheddar-h-no-such-file-or-directory/53860367#53860367", "title": "Eclipse C++: fatal error: cheddar.h: no such file or directory", "body": "<h1>What is wrong with CMake/Makefile?</h1>\n\n<p>I don\u2019t know, but this just sounds like an XY problem. But what\u2019s even more confusing is how you\u2019re so reluctant to use a solution that you\u2019ve already got (as in it\u2019s bugging me).</p>\n\n<h2><strong><em>Anyway</em></strong></h2>\n\n<p>What may aid you in this is to ditch eclipse\u2019s settings and just use the compiler\u2019s. Eclipse uses (GCC/G++ (probably)). What you can do is set some <em>environment variables DUN DUN DUHH</em>!</p>\n\n<p>These environment variables are aptly named: <code>C_INCLUDE_PATH</code> and <code>CPLUS_INCLUDE_PATH</code>. If, however, you want the same for both (you want to use it for both languages) you can just set <code>CPATH</code>.</p>\n\n<p>You\u2019re probably thinking: what else can I do with this marvel... and for that I direct you to <a href=\"http://gcc.gnu.org/onlinedocs/gcc-4.8.1/gcc/Environment-Variables.html#Environment-Variables\" rel=\"nofollow noreferrer\">the official GCC website</a>.</p>\n"}], "owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545260608, "creation_date": 1545233110, "last_edit_date": 1545234740, "question_id": 53854318, "link": "https://stackoverflow.com/questions/53854318/eclipse-c-fatal-error-cheddar-h-no-such-file-or-directory", "title": "Eclipse C++: fatal error: cheddar.h: no such file or directory", "body": "<p>[RHEL v7.3, Eclipse Photon, C/C++ Project with Eclipse-generated Makefile]</p>\n\n<p>Attempting to include a custom library named <code>cheddar.h</code> results in \n<code>Fatal Error: cheddar.h: no such file or directory</code></p>\n\n<p>Research <a href=\"https://help.eclipse.org/kepler/index.jsp?topic=/org.eclipse.cdt.doc.user/tasks/cdt_t_proj_paths.htm\" rel=\"nofollow noreferrer\">1</a> and <a href=\"https://www.eclipse.org/forums/index.php/t/263075/\" rel=\"nofollow noreferrer\">2</a> suggests manually adding the include path by first alt-clicking the project in Project Explorer, and then manually adding the path :<br>\n<code>Properties -&gt; C/C++ General -&gt; Paths and Symbols : Includes : Languages, GNU C++</code> </p>\n\n<p>No luck.</p>\n\n<p>It works if I do things the old-fashioned way, and add the path to the makefile with a -I option, like so\n<code>-I/home/kmiklas/lib/</code></p>\n\n<p>..but I feel like I'm working-around the issue, and I want this set up properly; the way it <strong>should</strong> be set up. </p>\n\n<p>How do I correctly specify a custom include path in Eclipse? Tyvm :^)</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545233350, "post_id": 53854285, "comment_id": 94556264, "body": "The logic of the program is hard to trace. Please explain it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545233936, "post_id": 53854285, "comment_id": 94556668, "body": "I am checking if the word &quot;on&quot; is an independent word on it&#39;s own and trying to run the strtok function from the character right before &quot;on&quot; if it is non-overlapping."}, {"owner": {"reputation": 711, "user_id": 4611211, "user_type": "registered", "profile_image": "https://graph.facebook.com/958083580869419/picture?type=large", "display_name": "Kevin Kouketsu", "link": "https://stackoverflow.com/users/4611211/kevin-kouketsu"}, "edited": false, "score": 0, "creation_date": 1545234339, "post_id": 53854285, "comment_id": 94556955, "body": "Searching for single word &quot;on&quot;? &quot;online&quot; it&#39;s not a expected result ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545234865, "post_id": 53854285, "comment_id": 94557331, "body": "Yes, &quot;on&quot; must be a word on it&#39;s own. If it is part of another word (e.g. online), I don&#39;t want strtok to add a null character at that point, but rather move on and continue searching in the same string until it reaches the end."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545235475, "post_id": 53854683, "comment_id": 94557749, "body": "Thank You for the code, but, I would like to split a string into two different strings at a particular word, that is why I am trying to use strtok."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545236304, "post_id": 53854683, "comment_id": 94558218, "body": "Yes, it works on this particular string. But if I had multiple strings, it has to split the file as many number of times. For e.g. if I were to add an extra &quot;on&quot;, it needs to split it into 3 strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545672677, "post_id": 53854683, "comment_id": 94675314, "body": "@ xing: Is it possible to modify your code so one can copy the 3 different strings in 3 different arrays (rather than printing it out on the screen)? I am trying to use memcpy, but, it doesn&#39;t seem to work. Please let me know if possible. Thank You."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545675442, "post_id": 53854683, "comment_id": 94675987, "body": "@ xing: Thank You"}], "tags": [], "owner": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "is_accepted": true, "score": 1, "last_activity_date": 1545674965, "last_edit_date": 1545674965, "creation_date": 1545234312, "answer_id": 53854683, "question_id": 53854285, "link": "https://stackoverflow.com/questions/53854285/is-it-possible-to-use-strtok-function-on-only-non-overlapping-strings/53854683#53854683", "title": "Is it possible to use strtok function on only non-overlapping strings?", "body": "<p><code>strspn</code> and <code>strcspn</code> can be used to parse a string for a matching word.<br>\n<code>strtok</code> will split the string at each occurrence of the individual characters in the delimiter. This is not well suited for what you appear to want to do.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char data[50]=\"Jason could you please turn on the TV\";\n    char delimiter[5]=\"on\";\n    char *parse = data;\n    size_t space = 0;\n    size_t span = 0;\n\n    while ( *parse){//parse not pointing to zero terminator\n        space = strspn ( parse, \" \\n\\t\");//leading whitespace\n        parse += space;//advance past whitespace\n        span = strcspn ( parse, \" \\n\\t\");//not whitespace\n        if ( span) {\n            printf(\"word is: %.*s\\n\", (int)span, parse);//prints span number of characters\n        }\n        if ( 0 == strncmp ( delimiter, parse, span)) {\n            printf ( \"\\tword matches delimiter: %s\\n\", delimiter);//found match\n        }\n        parse += span;//advance past non whitespace for next word\n    }\n    return 0;\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char data[50]=\"Jason could you please turn on the TV\";\n    char delimiter[5]=\"on\";\n    char *parse = data;\n    size_t space = 0;\n    size_t span = 0;\n\n    while ( *parse){//parse not pointing to zero terminator\n        space = strspn ( parse, \" \\n\\t\");//leading whitespace\n        parse += space;//advance past whitespace\n        span = strcspn ( parse, \" \\n\\t\");//not whitespace\n        if ( span) {\n            printf(\"word is: %.*s\\n\", (int)span, parse);//prints span number of characters\n            if ( 0 == strncmp ( delimiter, parse, span)) {\n                printf ( \"\\tword matches delimiter: %s\\n\", delimiter);//found match\n                *parse = 0;\n                parse += span;\n                space = strspn ( parse, \" \\n\\t\");//leading whitespace\n                parse += space;\n                break;\n            }\n        }\n        parse += span;//advance past non whitespace for next word\n    }\n    printf ( \"\\n\\nsplit strings:\\n%s\\n%s\\n\", data, parse);\n    return 0;\n}\n</code></pre>\n\n<p>The basis could be wrapped in a function. This would divide the original string into as many sub-strings as required by the delimiting word. None of the sub-strings are stored but with modification that can be achieved.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *strwordsep ( char *str, char *word, size_t *stop) {\n    char *parse = str;\n    size_t space = 0;\n    size_t span = 0;\n\n    while ( *parse){//parse not pointing to zero terminator\n        space = strspn ( parse, \" \\n\\t\");//leading whitespace\n        parse += space;//advance past whitespace\n        span = strcspn ( parse, \" \\n\\t\");//not whitespace\n        if ( span) {\n            // printf(\"word is: %.*s\\n\", (int)span, parse);//prints span number of characters\n            if ( 0 == strncmp ( word, parse, span)) {\n                // printf ( \"\\tword matches delimiter: %s\\n\", word);//found match\n                // *parse = 0;//zero terminate\n                *stop = parse - str;\n                parse += span;//advance past delimiter\n                space = strspn ( parse, \" \\n\\t\");//leading whitespace\n                parse += space;//advance past whiteespace\n                return parse;\n            }\n        }\n        parse += span;//advance past non whitespace for next word\n    }\n    return NULL;\n}\n\nint main() {\n    char data[]=\"Jason, I am on the phone, could you please turn on the TV\";\n    char word[5]=\"on\";\n    char *lead = data;\n    char *trail = data;\n    size_t stop = 0;\n    while ( ( trail = strwordsep ( lead, word, &amp;stop))) {\n        printf ( \"\\nsplit strings:\\n%.*s\\n\", (int)stop, lead);\n        lead = trail;\n    }\n    if ( *lead) {\n        printf ( \"\\nsplit strings:\\n%s\\n\", lead);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Edit</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *strwordsep ( char *str, char *word, size_t *stop) {\n    char *parse = str;\n    size_t space = 0;\n    size_t span = 0;\n\n    while ( *parse){//parse not pointing to zero terminator\n        space = strspn ( parse, \" \\n\\t\");//leading whitespace\n        parse += space;//advance past whitespace\n        span = strcspn ( parse, \" \\n\\t\");//not whitespace\n        if ( span) {\n            // printf(\"word is: %.*s\\n\", (int)span, parse);//prints span number of characters\n            if ( 0 == strncmp ( word, parse, span)) {\n                // printf ( \"\\tword matches delimiter: %s\\n\", word);//found match\n                // *parse = 0;//zero terminate\n                *stop = parse - str;\n                parse += span;//advance past delimiter\n                space = strspn ( parse, \" \\n\\t\");//leading whitespace\n                parse += space;//advance past whiteespace\n                return parse;\n            }\n        }\n        parse += span;//advance past non whitespace for next word\n    }\n    return NULL;\n}\n\nchar **freelines ( char **ppc) {\n    int each = 0;\n    while ( ppc[each]) {//loop until sentinel NULL\n        free ( ppc[each]);//free memory\n        each++;\n    }\n    free ( ppc);//free pointers\n    return NULL;\n}\n\nchar **addline ( char **ppc, int *lines, char *add, int length) {\n    char **temp = NULL;\n    if ( ( temp = realloc ( ppc, sizeof ( *temp) * ( *lines + 2)))) {//add pointer\n        ppc = temp;//assign reallocated pointer to original\n        if ( ( ppc[*lines] = malloc ( length + 1))) {//allocate memory to pointer\n            strncpy ( ppc[*lines], add, length);//copy lenght characters to pointer\n            ppc[*lines][length] = 0;\n        }\n        else {\n            fprintf ( stderr, \"problem malloc\\n\");\n            ppc = freelines ( ppc);//release memory\n            return ppc;\n        }\n        ppc[*lines + 1] = NULL;//sentinel NULL\n        *lines = *lines + 1;\n    }\n    else {\n        fprintf ( stderr, \"problem realloc\\n\");\n        ppc = freelines ( ppc);//release memory\n        return ppc;\n    }\n    return ppc;\n}\n\nvoid showlines ( char **ppc) {\n    int each = 0;\n    while ( ppc[each]) {\n        printf ( \"output[%d]= %s\\n\", each, ppc[each]);\n        each++;\n    }\n}\n\nint main() {\n    char data[]=\"Jason, I am on the phone, could you please turn on the TV\";\n    char word[5]=\"on\";\n    char **output = NULL;//pointer to pointer to store sub-strings\n    char *lead = data;\n    char *trail = data;\n    int lines = 0;\n    size_t stop = 0;\n    while ( ( trail = strwordsep ( lead, word, &amp;stop))) {\n        if ( ! ( output = addline ( output, &amp;lines, lead, (int)stop))) {\n            return 0;\n        }\n        lead = trail;\n    }\n    if ( *lead) {\n        if ( ! ( output = addline ( output, &amp;lines, lead, (int)strlen ( lead)))) {\n            return 0;\n        }\n    }\n    showlines ( output);\n    output = freelines ( output);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545262199, "post_id": 53859523, "comment_id": 94569119, "body": "Thank You for the code, I understand how one can null-terminate. But, if there were multiple &quot;on&quot; in a paragraph, how would I copy the lines in between into a different array as I intend to break it into multiple strings. The multiple strings should not have &quot;on&quot; in them."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545267606, "post_id": 53859523, "comment_id": 94570305, "body": "No problems with multiple <code>&quot;on&quot;</code> just put the above in a loop and set <code>p = next;</code> at the end of the loop. (e.g. <code>while ((p = strstr (p, delim))) { ... p = next; }</code> If you can find one, you can find them all <code>:)</code>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545274651, "last_edit_date": 1545274651, "creation_date": 1545255498, "answer_id": 53859523, "question_id": 53854285, "link": "https://stackoverflow.com/questions/53854285/is-it-possible-to-use-strtok-function-on-only-non-overlapping-strings/53859523#53859523", "title": "Is it possible to use strtok function on only non-overlapping strings?", "body": "<p>It's not entirely clear from your use of \"non-overlapping\" what your intent with <code>data</code> is, but I take it from your additional comments that you want to find <code>\"on\"</code> within <code>data</code> as a whole-word and not the <code>\"on\"</code> as part of <code>\"Jason\"</code>.</p>\n\n<p>When attempting to locate <code>\"on\"</code> within <code>data</code>, you don't need <code>strtok, strspn</code> or <code>strcspn</code>, the correct tool for the job is <code>strstr</code> which allows you to find the first occurrence of a substring within a string. You only job is identifying the correct substring to search for.</p>\n\n<p>Since in this case you want to fine <code>\"on\"</code> as a whole-word, why not search for <code>\" on\"</code> to locate <code>\"on\"</code> preceded by a space. (you could expand that to all whitespace as well, but for purpose of your sentence we will use space separated words and then expand the check for all whitespace to ensure what follows <code>\"on\"</code> is whitespace).</p>\n\n<p>First, related to your initialization of <code>data</code>, unless you intend to append to your string within your code, there is no need to specify the <em>magic-number</em> <code>50</code>, simply leave the <code>[]</code> empty and <code>data</code> will be size appropriately to hold the string, e.g.</p>\n\n<pre><code>    char data[]=\"Jason could you please turn on the TV\",\n        *p = data;    /* pointer to data */\n</code></pre>\n\n<p>Likewise, unless you plan on changing your delimiter, you can simply use a <em>string-literal</em>, e.g.</p>\n\n<pre><code>    const char *delim = \" on\";\n</code></pre>\n\n<p>Then to locate <code>\" on\"</code> within data, all you need is a single call to <code>strstr (p, delim)</code>, and you can make the call within a conditional expression to determine whether it exists, e.g.</p>\n\n<pre><code>    if ((p = strstr (p, delim))) {\n        size_t len = strlen (delim);\n        char *next = p + len;\n        if (isspace (*next) || ispunct (*next)) {\n            printf (\"found: '%s' (now what?)\\n\", ++p);\n        }\n    }\n</code></pre>\n\n<p>If it is found, just declare a pointer (or use array indexing with <code>p</code>) to access the next character after <code>\" on\"</code>. You can then test whether what follows <code>\" on\"</code> is whitespace which confirms you have found your wanted substring. Since you know <code>p</code> points to the <code>space</code> before <code>\"on\"</code>, you can simply increment the pointer <code>p</code> to point to <code>\"on\"</code> itself as was done above within the <code>printf</code> statement. Now what you do with the remainder of the string is up to you. You have <code>p</code> pointing to the beginning of the string, and <code>next</code> pointing to the whitespace following <code>\"on\"</code>, so you can trivially copy <code>\"on\"</code> or <em>nul-terminate</em> at <code>next</code> -- whatever it is you need to do.</p>\n\n<p>Putting it altogether you would have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (void) {\n\n    char data[]=\"Jason could you please turn on the TV\",\n        *p = data;\n    const char *delim = \" on\";\n\n    if ((p = strstr (p, delim))) {\n        size_t len = strlen (delim);\n        char *next = p + len;\n        if (isspace (*next) || ispunct (*next)) {\n            printf (\"found: '%s' (now what?)\\n\", ++p);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strstr_on\nfound: 'on the TV' (now what?)\n</code></pre>\n\n<p>Look things over and let me know if you have any further questions.</p>\n\n<p><strong>Finding Multiple <code>\"on\"</code> In String</strong></p>\n\n<p>As explained in the comments below, if you have multiple <code>\"on\"</code> located in your input, all you need to do is fashion the above <code>if</code> statement into a loop and then set <code>p = next;</code> at the end of the loop. For example, the only changes needed to find all substrings beginning with <code>\"on\"</code>, you could:</p>\n\n<pre><code>    char data[]=\"Jason could you please turn on the TV on the desk\",\n    ...\n    while ((p = strstr (p, delim))) {\n        size_t len = strlen (delim);\n        char *next = p + len;\n        if (isspace (*next) || ispunct (*next)) {\n            printf (\"found: '%s' (now what?)\\n\", ++p);\n        }\n        p = next;\n    }\n</code></pre>\n\n<p><strong>Use/Output Finding All <code>\"on\"</code></strong></p>\n\n<pre><code>$ ./bin/strstr_on\nfound: 'on the TV on the desk' (now what?)\nfound: 'on the desk' (now what?)\n</code></pre>\n\n<p>Let me know if you have any more questions.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53854683, "answer_count": 2, "score": 1, "last_activity_date": 1545674965, "creation_date": 1545233030, "last_edit_date": 1545249882, "question_id": 53854285, "link": "https://stackoverflow.com/questions/53854285/is-it-possible-to-use-strtok-function-on-only-non-overlapping-strings", "title": "Is it possible to use strtok function on only non-overlapping strings?", "body": "<p>In the code below there are two instances of the substring \"on\" in the string data. But is it possible to apply strtok only on the the substring \"on\" which is non-overlapping (i.e. is not part of another word)? If yes, can please someone tell me how to and what I am doing wrong in the code below?  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;ctype.h&gt;\n\nint main()\n{  \n  char data[50]=\"Jason could you please turn on the TV\";\n  char delimiter[5]=\"on\";\n\n  char *ptr,*pointer,*pa,*p,*pb[10];\n  int i=0,j=0,k=0,count=0;\n\n  p=data;\n  pointer=data;\n\n  while((*pointer!='\\0')&amp;&amp;(pointer=strstr(pointer,delimiter)))\n  {\n    pa=pointer+strlen(delimiter);\n    ptr=(--pointer);\n\n    while((isspace(*ptr))&amp;&amp;(isspace(*pa)))\n    {\n      pb[count]=strtok(ptr,delimiter);\n      printf(\"%s\\n\",pb[count]);\n      count++;\n      break;\n\n     } \n\n      pointer++;\n     (*pointer)++;\n\n  }   \n\n\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "code-coverage", "gcov"], "comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1545237106, "post_id": 53854284, "comment_id": 94558720, "body": "Maybe try using the <code>-ftest-coverage</code> flag when you build gcc rather than when you compile your program? -- Edit -- I am not a gcc expert, just making an educated guess."}], "answers": [{"tags": [], "owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "is_accepted": false, "score": 1, "last_activity_date": 1545279827, "creation_date": 1545279827, "answer_id": 53862372, "question_id": 53854284, "link": "https://stackoverflow.com/questions/53854284/how-to-do-source-code-coverage-of-gcc-compiler/53862372#53862372", "title": "how to do source code coverage of gcc compiler", "body": "<p>As per searching online for the <code>BOOT_CFLAGS</code>, it seems it sets the default compiler flags for the code that you would be compiling.<br>\nRefer here:<a href=\"https://www.phoronix.com/scan.php?page=news_item&amp;px=MTEzOTA\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=49275\" rel=\"nofollow noreferrer\">2</a></p>\n\n<p>Probably you need to run configure something like this:</p>\n\n<pre><code>./src/configure --enable-languages=c,c++ --disable-bootstrap --disable-multilib CFLAGS=\"-O2 -g -ftest-coverage -fprofile-arcs\" CXXFLAGS=\"-O2 -g -ftest-coverage -fprofile-arcs\"\n</code></pre>\n\n<p>But you might face other issues while building with coverage enabled <a href=\"https://gcc.gnu.org/ml/gcc-help/2012-04/msg00222.html\" rel=\"nofollow noreferrer\">GCC Build with coverage</a>.</p>\n\n<p>Better would be to post on GCC mailing list to see if someone has a probable solution.</p>\n"}], "owner": {"reputation": 59, "user_id": 9917291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc89af2c18033c73928331787fd90872?s=128&d=identicon&r=PG&f=1", "display_name": "Sameeran Joshi", "link": "https://stackoverflow.com/users/9917291/sameeran-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1545279827, "creation_date": 1545233025, "question_id": 53854284, "link": "https://stackoverflow.com/questions/53854284/how-to-do-source-code-coverage-of-gcc-compiler", "title": "how to do source code coverage of gcc compiler", "body": "<p>For a given sample program I want to know which part of GCC's source code is used during compilation.</p>\n\n<p><strong>BUILDING GCC</strong>:\nI tried building gcc-8.2 source code using </p>\n\n<pre><code>./src/configure --enable-languages=c,c++\n    --disable-bootstrap --disable-multilib BOOT_CFLAGS=\"-O2 -g -ftest-coverage -fprofile-arcs\"\n</code></pre>\n\n<p>I have a sample program named program.c </p>\n\n<p>I am compiling the program.c with xgcc as</p>\n\n<pre><code>/path/to/xgcc -B path/to/stage1build/gcc -ftest-coverage program.c\n</code></pre>\n\n<p>The above command gives me code coverage of program .The problem is I don't want to find code coverage of program.c using gcov and lcov.</p>\n\n<p>I want to find code coverage of gcc's source code.</p>\n\n<p>I tried searching on web but almost all of the answers tell me how do I use gcov and lcov by giving example of a sample .c program .</p>\n\n<p><strong>NOTE:</strong>\nI know how to use gcov and lcov</p>\n"}, {"tags": ["c", "arrays", "for-loop", "struct", "initialization"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1545232626, "post_id": 53854118, "comment_id": 94555742, "body": "You should provide the structure definition."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1545232631, "post_id": 53854118, "comment_id": 94555746, "body": "Compile with warnings: <code>warning: ISO C forbids empty initializer braces</code>, switch to <code>client clients[100] = {{0}};</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1545232723, "post_id": 53854118, "comment_id": 94555826, "body": "In addition to your struct definition, please also show us the code to print the data."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 1, "creation_date": 1545232909, "post_id": 53854118, "comment_id": 94555951, "body": "@Cid No need to use <code>malloc</code> when you declare it as array like <code>int a[30]</code>."}, {"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "edited": false, "score": 0, "creation_date": 1545232970, "post_id": 53854118, "comment_id": 94555994, "body": "Since my teachers said that the amount of clients is 100, i didn&#39;t use malloc(); because i don&#39;t need a dynamic size array"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545233032, "post_id": 53854118, "comment_id": 94556036, "body": "What is <code>Client</code> in your code to print?"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1545233087, "post_id": 53854118, "comment_id": 94556068, "body": "Just an aside, you could simply bzero your whole array and not bother setting names to &quot;NULL&quot; (handle that elsewhere) and avoid using a for() completely for efficiency sake.  Also note that <code>0.0</code> is a double, not a float. <code>0.0f</code>. Modern compilers are smart enough to handle this for you, but since you are learning, it&#39;s good to know this."}, {"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545233158, "post_id": 53854118, "comment_id": 94556115, "body": "@Osiris the <code>Client</code> in my code to print, is a variable of the type <code>client</code> that i receive to print the information of its month"}, {"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "reply_to_user": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1545233301, "post_id": 53854118, "comment_id": 94556227, "body": "@CinderBiscuits thank you for the advice and after make the complete program i will look int efficiency but my since i&#39;m in introduction to programming my teachers aren&#39;t looking for code efficiency because the project isn&#39;t big. Efficiency is an extra(Their words) but again, thanks for the advice and i&#39;ll look into it"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545233315, "post_id": 53854118, "comment_id": 94556237, "body": "If it is of type <code>client</code> then you should use <code>Client.exerMinutes[i]</code>."}, {"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545233438, "post_id": 53854118, "comment_id": 94556337, "body": "@Osiris i use <code>Client-&gt;exerMinutes</code> because for the whole month submodule, add minutes, change them, printing month report i receive the <code>client</code> variable as reference"}, {"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "reply_to_user": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1545233576, "post_id": 53854118, "comment_id": 94556418, "body": "@CinderBiscuits i understand, however in my projects specifications i have to initialize my <code>name</code> and &#224;ddress` as &quot;NULL&quot;, is there a way to use bzero only for &#233;xerMinutes` array??"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1545233589, "post_id": 53854118, "comment_id": 94556427, "body": "I can&#39;t find the error in this code. Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1545233797, "post_id": 53854118, "comment_id": 94556551, "body": "Sure, though you may wish to use <code>memset</code> as well, (<code>bzero</code> isn&#39;t actually standard C, it&#39;s ANSI) <code>memset(&amp;clients[i].exerMinutes, 0, sizeof(clients[i].exerMinutes));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "edited": false, "score": 0, "creation_date": 1545238357, "post_id": 53855233, "comment_id": 94559430, "body": "Thank you for the answer, I realised I couldn&#39;t do using the client itself so I opted to send the full array of clients and the position of the client wanted so that I could modify that position on the array itself instead of modifying an instance of a client."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7555262"}, "is_accepted": true, "score": 0, "last_activity_date": 1545236703, "last_edit_date": 1545236703, "creation_date": 1545236312, "answer_id": 53855233, "question_id": 53854118, "link": "https://stackoverflow.com/questions/53854118/error-initializing-array-of-struct-element/53855233#53855233", "title": "Error initializing array of struct element", "body": "<p>The code is working perfectly, i.e. all the variables in the 'struct' are initialised with zeroes or whatever just as intended. I tried it with a few changes.</p>\n\n<p>Problem is with these lines:</p>\n\n<pre><code>if((i+1)%2==0    &amp;&amp;    i!=0){\n        printf(\"day    %2d:    %3d    min\\n\",    i+1,    Client-&gt;exerMinutes[i]);\n}else{\n        printf(\"day    %2d:    %3d    min\\t\\t\",    i+1,    Client-&gt;exerMinutes[i]);\n}\n</code></pre>\n\n<p>You've used pointer to structure \"Client\" but its not initialised and that's the reason you're getting unexpected results. Keep in mind that in this \"Client\", you've used a capital 'C'. Hope this helps :)</p>\n"}], "owner": {"reputation": 11, "user_id": 10750681, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKlDsn8oXGc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jBbhZQRUIUsmRIDoTo0sQCugLVBQ/mo/photo.jpg?sz=128", "display_name": "David Abreu", "link": "https://stackoverflow.com/users/10750681/david-abreu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53855233, "answer_count": 1, "score": 1, "last_activity_date": 1545236703, "creation_date": 1545232489, "last_edit_date": 1545232893, "question_id": 53854118, "link": "https://stackoverflow.com/questions/53854118/error-initializing-array-of-struct-element", "title": "Error initializing array of struct element", "body": "<p>Good afternoon, for a school project i have to input and show the minutes of exercise for 30 days(1 month) of a client, the client is a struct which contains the array of days, when i initialize my program i initialize my vector of clients using:</p>\n\n<pre><code>//Struct\ntypedef struct{\nchar name[100];\nint dayOfBirth;\nint monthOfBirth;\nint yearOfBirth;\nchar address[100];\nint phone;\nint iRSNumber;\nfloat height;\nfloat weight;\nint exerMinutes[30];\n\n}client;\n\nclient clients[100] = {};\n\n\n//initialize struct of clients\nfor(int i=0; i&lt;100; i++){\n    strcpy(clients[i].name, \"NULL\");\n    strcpy(clients[i].address, \"NULL\");\n    clients[i].height = 0.0;\n    clients[i].yearOfBirth = 0;\n    clients[i].monthOfBirth = 0;\n    clients[i].dayOfBirth = 0;\n    clients[i].iRSNumber = 0;\n    clients[i].weight = 0.0;\n    clients[i].phone = 0;\n    for(int j = 0; j&lt;30; j++){\n        clients[i].exerMinutes[j] = 0;\n    }\n}\n</code></pre>\n\n<p>Code to show the report:</p>\n\n<pre><code>system(\"cls\");\nprintf(\"\\nSHOW MONTHLY REPORT\\n\");\nfor(int i=0;i&lt;30;i++){\n    if((i+1)%2==0 &amp;&amp; i!=0){\n        printf(\"day %2d: %3d min\\n\", i+1, Client-&gt;exerMinutes[i]);\n    }else{\n        printf(\"day %2d: %3d min\\t\\t\", i+1, Client-&gt;exerMinutes[i]);\n    }\n}\n\nprintf(\"\\n\\nPress Enter to continue\");\nsystem(\"pause &gt;nul /nobreak\");\n</code></pre>\n\n<p>However the cycle for() to initialize the month array doesn't seems to work, because when i ask for the month report this is the output:</p>\n\n<pre><code>day  1: 100 min         day  2:   0 min\nday  3:   0 min         day  4:   0 min\nday  5:   0 min         day  6:   0 min\nday  7:   0 min         day  8:   0 min\nday  9:   0 min         day 10:   0 min\nday 11:   0 min         day 12:   0 min\nday 13:   0 min         day 14:   0 min\nday 15:   0 min         day 16:   0 min\nday 17:   0 min         day 18:   0 min\nday 19:   0 min         day 20:   0 min\nday 21:   0 min         day 22:   0 min\nday 23:   0 min         day 24:   0 min\nday 25:  10 min         day 26:   3 min\nday 27: 1999 min                day 28: 1280070990 min\nday 29:   0 min         day 30:   0 min\n</code></pre>\n\n<p>I would be thankful for any help and/or advice given.</p>\n"}, {"tags": ["c", "linux", "unix", "gcc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1545231526, "post_id": 53853755, "comment_id": 94555078, "body": "Beware of using <code>printf()</code> in signal handlers. It isn\u2019t safe or sanctioned by PODIX, which is a lot more generous about what you can call from a signal handler than Standard C is."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1545234043, "post_id": 53853755, "comment_id": 94556745, "body": "The <code>if</code> statement should probably check of <code>-1</code> (instead of ` &gt; 0` ), since <code>-2</code> might be translated to a valid process number (by reading the <code>pid_t</code> as if it&#39;s unsigned)... This is system and implementation specific, but still..."}], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1545236329, "post_id": 53854592, "comment_id": 94558234, "body": "Worth mentioning that if you are able to block in <code>wait</code> in your main loop, you needn&#39;t have a handler for <code>SIGCHLD</code> at all.  It&#39;s only useful if you need to be calling <code>[p]select</code> in the main loop, instead."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1545236925, "post_id": 53854592, "comment_id": 94558610, "body": "Good point, @zwol.  I have added a brief discussion of that issue."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545246366, "post_id": 53854592, "comment_id": 94563146, "body": "It might also be useful to point out that SIGCHLD is not queued; none of the standard POSIX signals are. So, if a number of children die before the SIGCHLD signal is delivered to the parent, only one signal is delivered. It does not affect reaping the children (via <code>wait()</code> etc.) at all, though."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545248945, "post_id": 53854592, "comment_id": 94564219, "body": "Thanks, @NominalAnimal, I have updated this answer to discuss that issue, too."}, {"owner": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "edited": false, "score": 0, "creation_date": 1545269415, "post_id": 53854592, "comment_id": 94570683, "body": "thank you, @John Bollinger, for reminding me that the parent may terminate when its children are still running. So I add a loop <code>while(1) pause();</code> to wait for the signals. But it still results in the same. Indeed the explicit wait-loop in will solve this problem, but I wonder how to implement it with a signal handler. <b>I think the wait-loop in the signal handler will collect all the children if the parent is not terminate(with the loop described above).</b>"}, {"owner": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "edited": false, "score": 0, "creation_date": 1545270261, "post_id": 53854592, "comment_id": 94570851, "body": "And another question would be, <b>do I need to replace the <code>printf</code> with <code>write</code>, even that I add a <code>sigprocmask</code> to block all the signals?</b>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "edited": false, "score": 0, "creation_date": 1545270661, "post_id": 53854592, "comment_id": 94570927, "body": "@L.Yao, <code>printf()</code> is not async-signal-safe, period.  If you call it from a signal handler then undefined behavior results.  This is not conditional on whether signals are blocked.  You may call <code>write()</code> from a signal handler without invoking undefined behavior, but it is still best to minimize signal-handler actions."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "edited": false, "score": 0, "creation_date": 1545271093, "post_id": 53854592, "comment_id": 94571029, "body": "In a general sense, @L.Yao, I would also expect a wait loop in a signal handler to be able to collect all the children, as long as the parent did not terminate first, but your particular handler does a heck of a lot of work, involving a lot of UB.  There are many <code>printf()</code>s, but <code>free()</code> is not async-signal-safe either.  Moreover, signal handlers often run with very small stacks, and it is plausible that you are exhausting yours.  All this says to me that I have no particular expectation at all for how your program will behave."}, {"owner": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "edited": false, "score": 0, "creation_date": 1545272672, "post_id": 53854592, "comment_id": 94571343, "body": "@John Bollinger, thank you for saving my life! I made a simplified version and got the expected result. Here&#39;s my <a href=\"https://gist.github.com/Sar-Kerson/5a63e2d668c749153e237ed2d4acb352\" rel=\"nofollow noreferrer\">note</a>(though there are something in Chinese)."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1545248902, "last_edit_date": 1545248902, "creation_date": 1545234036, "answer_id": 53854592, "question_id": 53853755, "link": "https://stackoverflow.com/questions/53853755/the-parent-process-only-received-sigchld-from-its-children-once-or-twice-no-mat/53854592#53854592", "title": "The parent-process only received SIGCHLD from its children once or twice, no mater how many times it fork()", "body": "<p>Your parent process does not wait for its children to finish (via <code>wait()</code> or <code>waitpid()</code>), so nothing ensures that the <code>SIGCHLD</code> signals they emit when they do will be delivered to it while it's still alive.  That the signal handler performs a wait does not help here, because that does not prevent the process from terminating while children are still alive.  The parent and all the children will probably terminate at about the same time, so it is not very surprising that the parent reports signals only from one or two children, even if we assume that calling <code>printf()</code> from a signal handler will behave as you seem to expect.</p>\n\n<p>Additionally, all the <code>sleep()</code>ing the program does probably confuses the issue more than it clarifies.  Certainly it is not the right tool for managing inter-process synchronization and timing.</p>\n\n<p>Consider this heavily-trimmed and modified derivative for comparison:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\nvolatile sig_atomic_t signal_count;\n\nvoid handler(int sig) {\n    signal_count += 1;\n}\n\nint main(int argc, char *argv[]) {\n    pid_t pid;\n\n    signal_count = 0;\n    signal(SIGCHLD, handler);\n    for (int i = 0; i &lt; 10; ++i) {\n        if ((pid = fork()) == 0) {\n            sleep(1);\n            execve(\"/bin/date\", argv, NULL);\n        }\n        sleep(1);\n    }\n\n    // wait for the children to terminate\n    while (wait(NULL) != -1) { /* empty */ }\n\n    printf(\"Process %d handled %d SIGCHLD signals\\n\", (int) getpid(), (int) signal_count);\n    exit(0);\n}\n</code></pre>\n\n<p>My test run of that program produced this output:</p>\n\n<blockquote>\n<pre><code>Wed Dec 19 09:56:08 CST 2018\nWed Dec 19 09:56:09 CST 2018\nWed Dec 19 09:56:09 CST 2018\nWed Dec 19 09:56:10 CST 2018\nWed Dec 19 09:56:10 CST 2018\nWed Dec 19 09:56:11 CST 2018\nWed Dec 19 09:56:11 CST 2018\nWed Dec 19 09:56:11 CST 2018\nWed Dec 19 09:56:12 CST 2018\nWed Dec 19 09:56:12 CST 2018\nProcess 2169 handled 10 SIGCHLD signals\n</code></pre>\n</blockquote>\n\n<p>Note especially the last line.  It confirms that all 10 expected signals were handled by the original parent process.</p>\n\n<p><strong>Addendum</strong></p>\n\n<p>As @zwol observed in comments, to the extent that the parent can rely on blocking in <code>wait()</code> or <code>waitpid()</code> to collect its children, it does not need to register a handler for <code>SIGCHLD</code> at all.  It can instead perform whatever work is needed each time <code>wait()</code> returns a non-error code.  Using a signal handler to collect children serves that opposite case, that you want to avoid blocking the parent process, or figuring out where to try to collect children in a non-blocking manner.</p>\n\n<p>Nevertheless, it may be the case that although you don't normally want to block to collect children, the parent wants to ensure at some point -- perhaps as it's preparing to terminate -- that it collects all remaining children.  It might make sense in such a case to use both approaches to collecting children in the same program.</p>\n\n<p><strong>Addendum 2</strong></p>\n\n<p>With thanks to @NominalAnimal, I observe, too, that the usual implementations of signal handling do not queue multiple non-realtime signals of the same type to the same thread at the same time.  If a signal is delivered to a thread that already has that signal of that type pending on it then the new signal produces no additional effect.  For that reason, although I demonstrate receipt of a separate <code>SIGCHLD</code> for each child, I'm not guaranteed to see more than one, as the second through tenth could be delivered while the first was still pending.  Keeping signal handler implementations short reduces the likelihood of \"losing\" signals that way, but cannot eliminate it.</p>\n\n<p>Note well, however, that these particular signal-handling details do not prevent <code>wait()</code> and <code>waitpid()</code> from collecting the process's terminated children.</p>\n"}], "owner": {"reputation": 21, "user_id": 9708387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503a2809dc3dd8695b31a42518dab02?s=128&d=identicon&r=PG&f=1", "display_name": "L. Yao", "link": "https://stackoverflow.com/users/9708387/l-yao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1545248902, "creation_date": 1545231173, "question_id": 53853755, "link": "https://stackoverflow.com/questions/53853755/the-parent-process-only-received-sigchld-from-its-children-once-or-twice-no-mat", "title": "The parent-process only received SIGCHLD from its children once or twice, no mater how many times it fork()", "body": "<p>I almost do the same thing as <a href=\"https://github.com/vonzhou/CSAPP/blob/master/chapter8/procmask2.c\" rel=\"nofollow noreferrer\">here</a>, to implement a signalprocmask program, in which the parent will process all the SIGCHLD sent by its children.(I also test the code in the link, but the result is the same -- the parent only received the SIGCHLD once or twice no mater how many times it forks)</p>\n\n<p><strong>And the expected result would be:(the number of add is the same as del)</strong></p>\n\n<pre><code>add job 12987\nadd job 12988\nWed Dec 19 22:20:59 CST 2018\ndel from 12987\nWed Dec 19 22:21:00 CST 2018\ndel from 12988\nadd job 12989\nadd job 12990\ndel from 12989\nWed Dec 19 22:21:01 CST 2018\nadd job 12991\nWed Dec 19 22:21:02 CST 2018\ndel from 12990\nWed Dec 19 22:21:03 CST 2018\ndel from 12991\n</code></pre>\n\n<p><strong>But the result is:(Not all the SIGCHLD would be catched by the parent-process)</strong></p>\n\n<pre><code>add job 12987\nadd job 12988\nWed Dec 19 22:20:59 CST 2018\ndel from 12987\nnow the list is: 12988\nWed Dec 19 22:21:00 CST 2018\ndel from 12988\nnow the list is: \nadd job 12989\nadd job 12990\nWed Dec 19 22:21:01 CST 2018\nadd job 12991\nWed Dec 19 22:21:02 CST 2018\nadd job 12992\nWed Dec 19 22:21:03 CST 2018\nadd job 12993\nWed Dec 19 22:21:04 CST 2018\nadd job 12994\nWed Dec 19 22:21:05 CST 2018\nadd job 13091\nWed Dec 19 22:21:06 CST 2018\nadd job 13092\nWed Dec 19 22:21:07 CST 2018\nWed Dec 19 22:21:08 CST 2018 \n</code></pre>\n\n<p>And here's my code:</p>\n\n<pre><code>#include \"apue.h\"\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/signal.h&gt;\n#include &lt;errno.h&gt;\n\nvoid printJobs();\nvoid addJob(int);\nvoid delJob();\n\nvoid handler(int sig)\n{\n    sigset_t mask_all, pre_all;\n    sigfillset(&amp;mask_all); // fill all bits of the mask\n    pid_t pid;\n    while ((pid = waitpid(-1, NULL, 0)) &gt; 0) {\n        sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;pre_all);\n        printf(\"del from %d\\n\", pid);\n        delJob(pid);\n        sigprocmask(SIG_UNBLOCK, &amp;pre_all, NULL);\n    }\n    if (errno != ECHILD)\n        printf(\"waitpid error\\n\");\n}\n\nint main(int argc, char **argv)\n{\n    pid_t pid;\n    sigset_t mask_all, mask_one, pre_one;\n\n    sigfillset(&amp;mask_all);\n    sigemptyset(&amp;mask_one);\n    sigaddset(&amp;mask_one, SIGCHLD);\n    signal(SIGCHLD, handler);\n    for (int i = 0; i &lt; 10; ++i) {\n        sigprocmask(SIG_BLOCK, &amp;mask_one, &amp;pre_one); // block SIGCHLD\n        if ((pid = fork()) == 0) {\n            sigprocmask(SIG_SETMASK, &amp;pre_one, NULL);\n            sleep(1);\n            execve(\"/bin/date\", argv, NULL);\n        }\n        sigprocmask(SIG_BLOCK, &amp;mask_all, NULL);     // block all sigals\n        addJob(pid);\n        sigprocmask(SIG_SETMASK, &amp;pre_one, NULL); // unblock SIGCHLD\n        sleep(1);\n    }\n    exit(0);\n}\n\ntypedef struct Node {\n    int val;\n    struct Node *next;\n} Node, *pNode;\n\npNode phead = NULL, ptail = NULL;\n\nvoid printJobs()\n{\n    pNode pt = phead;\n    while (pt) {\n        printf(\"%d\", pt-&gt;val);\n        pt = pt-&gt;next;\n    }\n    printf(\"\\n\");\n}\n\nvoid delJob(int pid)\n{\n    if (ptail) {\n        pNode pt = phead, pre = NULL;\n        while (pt &amp;&amp; pt-&gt;val != pid) {\n            pre = pt;\n            pt = pt-&gt;next;\n        }\n        if (!pt) {\n            printf(\"No job %d\\n\", pid);\n            return;\n        }\n        if (pt == phead) { // only have one node or empty\n            phead = phead-&gt;next ? phead-&gt;next : NULL;\n            free(pt);\n            ptail = phead ? ptail : NULL;\n        } else { // have more than one nodes\n            printf(\"del %d\\n\", pt-&gt;val);\n            free(pt);\n            pre-&gt;next = NULL;\n            ptail = pt == ptail ? pre : ptail;\n        }\n        printf(\"now the list is: \");\n        printJobs();\n    } else {\n        printf(\"No job %d\\n\", pid);\n    }\n}\n\nvoid addJob(int pid)\n{\n    printf(\"add job %d\\n\", pid);\n    pNode pt = malloc(sizeof(Node));\n    pt-&gt;val = pid;\n    pt-&gt;next = NULL;\n    if (!phead) {\n        phead = ptail = pt;\n    } else {\n        ptail-&gt;next = pt;\n        ptail = pt;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "bit-fields", "signed-integer", "implementation-defined-behavior"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 46, "creation_date": 1545230729, "post_id": 53853540, "comment_id": 94554594, "body": "Since the bitfield is declared as <code>int</code> i think it only can hold the values <code>0</code> and <code>-1</code>."}, {"owner": {"reputation": 76, "user_id": 10806577, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X9waOdRLeRU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gciJQJ0xxYgfog5PPqo8ljLBt2JA/mo/photo.jpg?sz=128", "display_name": "J&#252;rgen", "link": "https://stackoverflow.com/users/10806577/j%c3%bcrgen"}, "edited": false, "score": 6, "creation_date": 1545232191, "post_id": 53853540, "comment_id": 94555481, "body": "just think of it how int stores -1. All bits are set to 1. Hence, if you only have one bit it clearly has to be -1. So 1 and -1 in the 1 bit int are the same. Change the check to &#39;if (s.enabled != 0)&#39; and it works. Because 0 it can&#39;t be."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1545235584, "post_id": 53853540, "comment_id": 94557813, "body": "It is true that these rules are the same in C and C++. But according to the <a href=\"https://stackoverflow.com/tags/c%2b%2b/info\">tag usage</a> policies, we should only tag this as C and refrain from cross-tagging when not needed. I&#39;ll remove the C++ part, it should not affect any posted answers."}, {"owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "edited": false, "score": 8, "creation_date": 1545235691, "post_id": 53853540, "comment_id": 94557877, "body": "Have you tried changing it to <code>struct mystruct { unsigned int enabled:1; };</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1545293095, "post_id": 53853540, "comment_id": 94576588, "body": "Kindly read the <a href=\"https://stackoverflow.com/tags/c%2b%2b/info\">C and C++ tag policies</a>, particularly the part regarding cross-tagging C and C++ both, established through community consensus <a href=\"https://meta.stackoverflow.com/questions/374306/proposed-update-to-c-and-c-tag-usage-wikis\">here</a>. I&#39;m not going into some rollback war, but this question is incorrectly tagged C++. Even if the languages happen to have some slight difference because of various TC, then make a separate question about the difference between C and C++."}, {"owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545301152, "post_id": 53853540, "comment_id": 94580572, "body": "Thanks @Lundin for the tag policy link. Both the C &amp; C++ have different standard specifications for the bit fields. Hence I am interested in knowing the output results from both the perspectives."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545301587, "post_id": 53853540, "comment_id": 94580776, "body": "@iammilind They don&#39;t, until apparently after some TC of C++11. It seems to be that comparing C vs C++ vs C++11 TC:x is a separate question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545303174, "post_id": 53853540, "comment_id": 94581575, "body": "Been reading C++11 and C++17. I find no evidence anywhere that C++ bit-fields behave differently than C ones. Multiple cases of implementation-defined behavior are the same for both languages. If anything, they are even more poorly defined in C++17 than in for example C90. Wouldn&#39;t have thought such a thing possible."}, {"owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545304921, "post_id": 53853540, "comment_id": 94582458, "body": "@Lundin, C++ defines the bit-fields more clearly and coincidentally they have taken an example, which matches the code in Qn. You may refer <a href=\"https://stackoverflow.com/a/53867011/514235\">my answer</a>. It&#39;s indeed good to have both the perspectives of C and C++ for this feature."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1545313406, "post_id": 53853540, "comment_id": 94586708, "body": "Bitfields and throw specifications are the two most useless features of C++. Bitfields serve no purpose whatsoever."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 15, "creation_date": 1545231638, "post_id": 53853610, "comment_id": 94555143, "body": "The authors of the standard were on holidays the day the bit-field chapter was designed. So the janitor had to do it. There is no rationale about <i>anything</i> regarding how bit-fields are designed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 9, "creation_date": 1545232857, "post_id": 53853610, "comment_id": 94555919, "body": "There is no coherent <i>technical</i> rationale.  But that leads me to conclude that there was a <i>political</i> rationale: to avoid making any of the existing code or implementations incorrect.  But the result is that there&#39;s very little about bitfields that you can rely upon."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 6, "creation_date": 1545233191, "post_id": 53853610, "comment_id": 94556141, "body": "@JohnBollinger There was definitely politics in place, that caused a lot of damage to C90. I once spoke with a member of the committee who explained the source of lots of the crap - the ISO standard could not be allowed to favour certain existing technologies. This is why we are stuck with moronic things like support for 1&#39;s complement and signed magnitude, implementation-defined signedness of <code>char</code>, support for bytes that aren&#39;t 8 bits etc etc. They weren&#39;t allowed to give moronic computers a market disadvantage."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1545233393, "post_id": 53853610, "comment_id": 94556300, "body": "@Lundin It would be interesting to see a collection of writeups and post-mortems from people who believed tradeoffs had been made in error, and why.  I wonder how much study of these <i>&quot;we did that last time, and it did/didn&#39;t work out&quot;</i> has become institutional knowledge to inform the next such case, vs. just stories in people&#39;s heads."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 1, "creation_date": 1545235217, "post_id": 53853610, "comment_id": 94557590, "body": "This is still listed as point no. 1 of the original principles of C in the C2x Charter: &quot;Existing code is important, existing implementations are not.&quot; ... &quot;no one implementation was held up as the exemplar by which to define C: It is assumed that all existing implementations must change somewhat to conform to the Standard.&quot;"}], "tags": [], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "is_accepted": false, "score": 58, "last_activity_date": 1545245794, "last_edit_date": 1545245794, "creation_date": 1545230713, "answer_id": 53853610, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/53853610#53853610", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<blockquote>\n  <p>I am unable to understand, how is it possible that we set something and then it doesn't show up as it is.</p>\n</blockquote>\n\n<p>Are you asking why it compiles vs. gives you an error?</p>\n\n<p>Yes, it should ideally give you an error.  And it does, if you use your compiler's warnings.  In GCC, with <code>-Werror -Wall -pedantic</code>:</p>\n\n<pre><code>main.cpp: In function 'int main()':\nmain.cpp:7:15: error: overflow in conversion from 'int' to 'signed char:1' \nchanges value from '1' to '-1' [-Werror=overflow]\n   s.enabled = 1;\n           ^\n</code></pre>\n\n<p>The reasoning for why this is left up to being implementation-defined vs. an error may have more to do with historical usages, where requiring a cast would mean breaking old code.  The authors of the standard may believe warnings were enough to pick up the slack for those concerned.</p>\n\n<p>To throw in some prescriptivism, I'll echo @Lundin's statement: <strong>\"Never use bit-fields for any purpose.\"</strong>  If you have the kind of good reasons to get low-level and specific about your memory layout details that would get you to thinking you needed bitfields in the first place, the other associated requirements you almost certainly have will run up against their underspecification.</p>\n\n<p><em>(TL;DR - If you're sophisticated enough to legitimately \"need\" bit-fields, they're not well-defined enough to serve you.)</em></p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4930268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3ea484fa5cd555cbee3a579a106f76?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4930268/michael"}, "edited": false, "score": 5, "creation_date": 1545248296, "post_id": 53853737, "comment_id": 94563921, "body": "At work we have static_asserts on the size and address of bitfields just to make sure that they are not padded. We use bitfields for hardware registers in our firmware."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1545291992, "post_id": 53853737, "comment_id": 94576162, "body": "C++ doesn&#39;t have the last part after <a href=\"https://wg21.link/CWG739\" rel=\"nofollow noreferrer\">CWG 739</a>; it&#39;s always signed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 101, "user_id": 4930268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3ea484fa5cd555cbee3a579a106f76?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4930268/michael"}, "edited": false, "score": 1, "creation_date": 1545292305, "post_id": 53853737, "comment_id": 94576278, "body": "@Michael At one time I used bit-fields too, one of those usual sloppily-written register maps you get from the compiler vendor. Then tried to port the code to another compiler for the same MCU. Of course everything went haywire, because the register map was utterly non-portable. Sure, bit-fields was not the only problem, but a major one. The solution was to roll out your own register map. I wrote little a program which grabbed the register names and bit masks from the MCU manual and made an ISO/MISRA C register map header out of it. Based on <i>bit masks</i> to be used with the bit-wise operators."}, {"owner": {"reputation": 101, "user_id": 4930268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3ea484fa5cd555cbee3a579a106f76?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4930268/michael"}, "edited": false, "score": 4, "creation_date": 1545294321, "post_id": 53853737, "comment_id": 94577032, "body": "@Lundin: The ugly thing with #define-d masks and offsets is that your code gets littered with shifts and bit-wise AND/OR operators. With bitfields the compiler takes care of that for you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1545301882, "post_id": 53853737, "comment_id": 94580925, "body": "@T.C. That link doesn&#39;t change the behavior, you seem to have misinterpreted it. It says that if a type is &quot;plain&quot; such as <code>int</code> then it has implementation-defined signedness just like C. Basically that TC says &quot;can we clarify just how stupid bit-fields are defined by the standard&quot;."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1545303010, "post_id": 53853737, "comment_id": 94581488, "body": "@T.C. They have also apparently entirely removed the part you linked in the C++17 draft, so it is no longer just implementation-defined... but as I read it, using a bit-field of <code>int</code> type is undefined behavior in C++17, as the behavior and signedness of the different integer types is not covered by the standard. Or at least I can&#39;t find it."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 101, "user_id": 4930268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3ea484fa5cd555cbee3a579a106f76?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4930268/michael"}, "edited": false, "score": 4, "creation_date": 1545303401, "post_id": 53853737, "comment_id": 94581698, "body": "@Michael <i>With bitfields the compiler takes care of that for you.</i> Well, that&#39;s OK if your standards for &quot;takes care of that&quot; are &quot;non-portable&quot; and &quot;unpredictable&quot;.  Mine are higher than that."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1545305212, "post_id": 53853737, "comment_id": 94582573, "body": "The final resolution of CWG739 (you need to scroll down to the February 2012 PR, not the August 2011 one) removes the implementation-definedness entirely. Plain <code>int</code> therefore has the same meaning it has everywhere else (which is, of course, signed)."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1545313797, "post_id": 53853737, "comment_id": 94586910, "body": "@AndrewHenle these properties are all implementation-defined, i.e. a conforming implementation is <i>required</i> to do something predictable, and document it. I&#39;m not completely convinced the problem is substantially worse than for struct members in general: the alignment and padding of fields is also still implementation-defined (although they can&#39;t be reordered or straddle storage units), which makes a &quot;simple&quot; struct&#39;s layout technically non-portable between separately compiled binaries as well."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1545315976, "post_id": 53853737, "comment_id": 94588157, "body": "@Leushenko The requirements on structures are much, much stricter than on bit fields.  There are many C standard functions such as <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.11.2.1\" rel=\"nofollow noreferrer\"><code>localconv()</code></a> that pass structures, so structure layout requirements are stronger than &quot;implementation-defined&quot;.  I suspect structure layout is <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">ABI</a>-controlled.  (Someone with more expertise can comment...)  Bit fields are completely controlled by the compiler chosen, and can and do change between different compilers on the same platform."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1545316240, "post_id": 53853737, "comment_id": 94588319, "body": "@AndrewHenle ABI is 100% beyond the scope of the standard. It doesn&#39;t and can&#39;t mandate that data structures (or even primitive types) are in <i>any way</i> compatible with those produced by a different compiler on the same system; how the standard library is made available to a program by an implementation is out of scope too. Implementations choosing to all di the same thing because it&#39;s sensible and because sharing a stdlib is practical doesn&#39;t make it not-implementation-defined."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 101, "user_id": 4930268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3ea484fa5cd555cbee3a579a106f76?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4930268/michael"}, "edited": false, "score": 0, "creation_date": 1545320392, "post_id": 53853737, "comment_id": 94590674, "body": "@Michael Lets compare <code>reg.bit0 = 1;</code> with <code>reg |= bit0;</code>. In the former case we have something like <code>typedef struct { int bit0:1; } reg_t;</code>, in the latter <code>#define bit0 (1u &lt;&lt; 0)</code>. The main difference is that <code>reg |= bit0;</code> actually sets bit 0, portably, independtly of compiler and endianess. Wheras <code>reg.bit0 = 1;</code> could set bit 0, or bit 31 or a padding bit, or a padding byte."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1545322030, "post_id": 53853737, "comment_id": 94591609, "body": "@Leushenko <i>ABI is 100% beyond the scope of the standard. It doesn&#39;t and can&#39;t mandate that data structures (or even primitive types) are in any way compatible with those produced by a different compiler on the same system</i> Not true.  The <a href=\"https://software.intel.com/sites/default/files/article/402129/mpx-linux64-abi.pdf\" rel=\"nofollow noreferrer\">x86_64 ABI</a>, for example, strictly specifies structure layout while leaving bit field implementations a great deal of freedom.  Strict compliance with the ABI would result in different compilers having to create identical structures while having wildly different bit-fields."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1545345684, "post_id": 53853737, "comment_id": 94601368, "body": "@AndrewHenle Leushenko is saying that from the perspective of <i>just the C standard itself</i>, it is up to the implementation whether or not it chooses to follow the x86-64 ABI or not."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1545346772, "post_id": 53853737, "comment_id": 94601662, "body": "@mtraceur First, I&#39;d say a compiler that doesn&#39;t follow a platform&#39;s ABI is perverse and deliberately non-portable.  Second, I&#39;m saying that even given strict adherence to an ABI, the C standard bit field &quot;specifications&quot; still leave so much unspecified that different compilers - that each strictly follow an ABI - can easily use wildly incompatible bit field layouts on the exact same platform."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1545348008, "post_id": 53853737, "comment_id": 94601979, "body": "@AndrewHenle Right, I agree on both points. My point was that I think your disagreement with Leushenko boils down to the fact that you&#39;re using &quot;implementation defined&quot; to refer only to things neither strictly defined by the C standard nor strictly defined by the platform ABI, and he&#39;s using it to refer to anything not strictly defined by just the C standard."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 78, "last_activity_date": 1545231907, "last_edit_date": 1545231907, "creation_date": 1545231112, "answer_id": 53853737, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/53853737#53853737", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>Bit-fields are incredibly poorly defined by the standard. Given this code <code>struct mystruct {int enabled:1;};</code>, then we <em>don't</em> know:</p>\n\n<ul>\n<li>How much space this occupies - if there are padding bits/bytes and where they are located in memory.</li>\n<li>Where the bit is located in memory. Not defined and also depends on endianess.</li>\n<li>Whether an <code>int:n</code> bitfield is to be regarded as signed or unsigned.</li>\n</ul>\n\n<p>Regarding the last part, C17 6.7.2.1/10 says:</p>\n\n<blockquote>\n  <p>A bit-field is interpreted as having a signed or unsigned integer type consisting of the\n  specified number of bits <sup>125)</sup></p>\n</blockquote>\n\n<p>Non-normative note explaining the above:</p>\n\n<blockquote>\n  <p><sup>125)</sup> As specified in 6.7.2 above, if the actual type specifier used is <code>int</code> or a typedef-name defined as <code>int</code>,\n  then it is implementation-defined whether the bit-field is signed or unsigned.</p>\n</blockquote>\n\n<p>In case the bitfield is to be regarded as <code>signed int</code> and you make a bit of size <code>1</code>, then there is no room for data, only for the sign bit. This is the reason why your program might give weird results on some compilers.</p>\n\n<p>Good practice:</p>\n\n<ul>\n<li>Never use bit-fields for any purpose.</li>\n<li>Avoid using signed <code>int</code> type for any form of bit manipulation.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545231361, "post_id": 53853744, "comment_id": 94554993, "body": "&quot;ince it is signed, the valid values are -1 and 0&quot;. Who said it is signed? It&#39;s not defined but implementation-defined behavior. If it is signed, then the valid values are <code>-</code> and <code>+</code>. 2&#39;s complement doesn&#39;t matter."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1545231628, "post_id": 53853744, "comment_id": 94555138, "body": "@Lundin A 1 bit twos compliment number only has two possible values.  If the bit is set, then since it is the sign bit, it is -1.  If it isn&#39;t set then it is &quot;positive&quot; 0.  I know this is implementation defined, I&#39;m just explaining the results using the most common implantation"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1545231783, "post_id": 53853744, "comment_id": 94555235, "body": "The key here is rather that 2&#39;s complement or any other signed form cannot function with a single bit available."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545231896, "post_id": 53853744, "comment_id": 94555305, "body": "@Lundin What do you mean it cannot function?  <a href=\"http://coliru.stacked-crooked.com/a/41fa5d5c6fe4f85c\" rel=\"nofollow noreferrer\">It works fine here</a>, you just have know the domain you are working with."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545231941, "post_id": 53853744, "comment_id": 94555330, "body": "@NathanOliver, a possible point of contention arises here from the wording of the standard, which does not seem specifically to require that bitfields of type <code>int</code> in fact represent signed types.  I do think it&#39;s the intent that such bitfields should be signed, however."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545232096, "post_id": 53853744, "comment_id": 94555428, "body": "@JohnBollinger I understand that.  That&#39;s why I have the discliamer that this is implementation defined.  At least for the big 3 they all treat <code>int</code> as signed in this case.  It is a shame that bit-fields are so under specified. It&#39;s basically here is this feature, consult your compiler on how to use it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1545232101, "post_id": 53853744, "comment_id": 94555433, "body": "@Lundin, the standard&#39;s wording for the representation of signed integers can perfectly well handle the case where there are zero value bits, at least in two of the three allowed alternatives.  This works because it assigns (negative) <i>place values</i> to sign bits, rather than giving them an algorithmic interpretation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545232933, "post_id": 53853744, "comment_id": 94555967, "body": "@JohnBollinger In the line <code>s.enabled = 1;</code>, the rule of simple assignment applies. We have a conversion from <code>int</code> to &quot;sign bit&quot;. <code>Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.</code> This is what happens, and it is not necessarily &quot;place values in sign bit&quot;."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545233232, "post_id": 53853744, "comment_id": 94556174, "body": "Agreed, @Lundin, that the result of the assignment is implementation-defined, and in particular that it does not have to correspond in any way to placing a value in the sign bit.  All I&#39;m saying is that C&#39;s rules for integer representation <i>do</i> afford meaningful and well-defined interpretations for 1-bit signed integers.  I say &quot;afford&quot; rather than &quot;specify&quot; only because there are two viable alternatives and one wobbly one."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 23, "last_activity_date": 1545235224, "last_edit_date": 1545235224, "creation_date": 1545231125, "answer_id": 53853744, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/53853744#53853744", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>This is implementation defined behavior.  I am making the assumption that the machines you are running this on use twos-compliment signed integers and treat <code>int</code> in this case as a signed integer to explain why you don't enter if true part of the if statement.</p>\n\n<pre><code>struct mystruct { int enabled:1; };\n</code></pre>\n\n<p>declares <code>enable</code> as a 1 bit bit-field.  Since it is signed, the valid values are <code>-1</code> and <code>0</code>.  Setting the field to <code>1</code> overflows that bit going back to <code>-1</code> (this is undefined behavior) </p>\n\n<p>Essentially when dealing with a signed bit-field the max value is <code>2^(bits - 1) - 1</code> which is <code>0</code> in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 10, "last_activity_date": 1545231469, "creation_date": 1545231469, "answer_id": 53853835, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/53853835#53853835", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>You could think of it as that in the 2's complement system, the left-most bit is the sign bit. Any signed integer with the left-most bit set is thus a negative value.</p>\n\n<p>If you have a 1-bit signed integer, it has only the sign bit. So assigning <code>1</code> to that single bit can only set the sign bit. So, when reading it back, the value is interpreted as negative and so is -1.</p>\n\n<p>The values a 1 bit signed integer can hold is <code>-2^(n-1)= -2^(1-1)= -2^0= -1</code> and <code>2^n-1= 2^1-1=0</code></p>\n"}, {"tags": [], "owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "is_accepted": true, "score": 8, "last_activity_date": 1545313110, "last_edit_date": 1545313110, "creation_date": 1545302408, "answer_id": 53867011, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/53867011#53867011", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>As per the <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4713.pdf\" rel=\"noreferrer\">C++ standard n4713</a>, a very similar code snippet is provided. The type used is <code>BOOL</code> (custom), but it can apply to any type.</p>\n\n<blockquote>\n  <h3>12.2.4</h3>\n  \n  <p><sup><strong>4</strong></sup> If the value true or false is stored into a bit-field of type <code>bool</code> of any size (including a one bit bit-field), the original <code>bool</code> value and the value of the bit-field shall compare equal. <strong>If the value of an enumerator is stored into a bit-field of the same enumeration type and the number of bits in the bit-field is large enough to hold\n  all the values of that enumeration type (10.2), the original enumerator value and the value of the bit-field\n  shall compare equal</strong>. \n  [ Example:</p>\n\n<pre><code>enum BOOL { FALSE=0, TRUE=1 };\nstruct A {\n  BOOL b:1;\n};\nA a;\nvoid f() {\n  a.b = TRUE;\n  if (a.b == TRUE)    // yields true\n    { /* ... */ }\n}\n</code></pre>\n  \n  <p>\u2014 end example ]</p>\n</blockquote>\n\n<hr>\n\n<p>At 1st glance, the bold part appears open for interpretation. However, the correct intent becomes clear when the <code>enum BOOL</code> is derived from the <code>int</code>.</p>\n\n<pre><code>enum BOOL : int { FALSE=0, TRUE=1 }; // ***this line\nstruct mystruct { BOOL enabled:1; };\nint main()\n{\n  struct mystruct s;\n  s.enabled = TRUE;\n  if(s.enabled == TRUE)\n    printf(\"Is enabled\\n\"); // --&gt; we think this to be printed\n  else\n    printf(\"Is disabled !!\\n\");\n}\n</code></pre>\n\n<p>With above code it gives a warning without <code>-Wall -pedantic</code>:</p>\n\n<blockquote>\n  <p>warning: \u2018mystruct::enabled\u2019 is too small to hold all values of \u2018enum BOOL\u2019\n   <code>struct mystruct { BOOL enabled:1; };</code></p>\n</blockquote>\n\n<p>The output is:</p>\n\n<blockquote>\n  <p>Is disabled !!  (when using <code>enum BOOL : int</code>)</p>\n</blockquote>\n\n<p>If <code>enum BOOL : int</code> is made simple <code>enum BOOL</code>, then the output is as the above standard pasage specifies:</p>\n\n<blockquote>\n  <p>Is enabled  (when using <code>enum BOOL</code>)</p>\n</blockquote>\n\n<hr>\n\n<p>Hence, it can be concluded, also as few other answers  have, that <strong><code>int</code> type is not big enough to store value \"1\" in just a single bit bit-field.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "is_accepted": false, "score": 0, "last_activity_date": 1546566452, "creation_date": 1546566452, "answer_id": 54032174, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back/54032174#54032174", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>There is nothing wrong with your understanding of bitfields that I can see. What I see is that you redefined mystruct first as <strong>struct mystruct { int enabled:1; }</strong> and then as <strong>struct mystruct s;</strong>. What you should have coded was:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct mystruct { int enabled:1; };\nint main()\n{\n    mystruct s; &lt;-- Get rid of \"struct\" type declaration\n    s.enabled = 1;\n    if(s.enabled == 1)\n        printf(\"Is enabled\\n\"); // --&gt; we think this to be printed\n    else\n        printf(\"Is disabled !!\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6122, "favorite_count": 15, "accepted_answer_id": 53867011, "answer_count": 6, "score": 96, "last_activity_date": 1547791951, "creation_date": 1545230430, "last_edit_date": 1547791951, "question_id": 53853540, "link": "https://stackoverflow.com/questions/53853540/why-is-assigning-a-value-to-a-bit-field-not-giving-the-same-value-back", "title": "Why is assigning a value to a bit field not giving the same value back?", "body": "<p>I saw the below code in <a href=\"https://www.quora.com/What-is-something-that-almost-nobody-knows-about-the-C-coding-language/answer/%C3%81lvaro-Lopes\" rel=\"nofollow noreferrer\">this Quora post</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct mystruct { int enabled:1; };\nint main()\n{\n  struct mystruct s;\n  s.enabled = 1;\n  if(s.enabled == 1)\n    printf(\"Is enabled\\n\"); // --&gt; we think this to be printed\n  else\n    printf(\"Is disabled !!\\n\");\n}\n</code></pre>\n\n<p>In both C &amp; C++, the output of the code is <em>unexpected</em>, </p>\n\n<blockquote>\n  <p>Is disabled  !!</p>\n</blockquote>\n\n<p>Though the \"sign bit\" related explanation is given in that post, I am unable to understand, how it is possible that we set something and then it doesn't reflect as it is.</p>\n\n<p>Can someone give a more elaborate explanation?</p>\n\n<hr>\n\n<p><strong>Note</strong>: Both the tags <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> &amp; <a href=\"/questions/tagged/c%2b%2b\" class=\"post-tag\" title=\"show questions tagged &#39;c++&#39;\" rel=\"tag\">c++</a> are required, because their standards slightly differ for describing the bit-fields. See answers for <a href=\"https://stackoverflow.com/a/53853737/514235\">C specification</a> and <a href=\"https://stackoverflow.com/a/53867011/514235\">C++ specification</a>.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 5, "creation_date": 1545230099, "post_id": 53853299, "comment_id": 94554203, "body": "When creating a file with <code>open</code> you have to provide a <i>third</i> argument, the <code>pmode</code> to specify the file permissions. See <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/open.2.html</a>"}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "edited": false, "score": 0, "creation_date": 1545230248, "post_id": 53853299, "comment_id": 94554288, "body": "I tried compiling your code and it works. On my OS (OSX) it creates the file and with the <code>printf</code> it prints the input string on it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1545230746, "post_id": 53853299, "comment_id": 94554611, "body": "Note that you should <i>always</i> pass an appropriate third argument to <code>open()</code>, as @PaulOgilvie describes, when you specify the <code>O_CREAT</code> flag.  The system needs it when it does create a file, and ignores it when it does not need to create one.  You don&#39;t need to know in advance which case will apply. To the best of my knowledge, in fact, it is not harmful to pass the third argument even when you don&#39;t specify <code>O_CREAT</code>, that the argument would never be used in such cases."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545230965, "post_id": 53853299, "comment_id": 94554747, "body": "Additional note: <i>check the return values of your function calls for error indicators</i>.  I am confident that if your program did so consistently, then it would <i>not</i> seem like it had written successfully in the new-file case."}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1545231000, "post_id": 53853299, "comment_id": 94554771, "body": "Never forget to flush() before close you the stream"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545231047, "post_id": 53853299, "comment_id": 94554801, "body": "@wildplasser, <code>open()</code>&#39;s docs specify two alternative signatures, one with three arguments, but also one with only two.  Or its Linux docs do.  The POSIX docs simply declare it as a varargs function."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 2, "creation_date": 1545232464, "post_id": 53853299, "comment_id": 94555634, "body": "@TsakiroglouFotis: beware, <code>fflush</code> is for C streams (opened with <code>fopen</code>). Here OP uses the Posix <code>open</code> function. No <code>flush</code> exists at this level, only <code>fsync</code> which is seldom used because it is only valid for true files, and never immediately before a <code>close</code>. For streams, C standard says for <code>fclose</code>: <i>A successful call to the fclose function causes the stream pointed to by stream to be flushed and the associated file to be closed.</i>"}, {"owner": {"reputation": 35, "user_id": 9565145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Salieri", "link": "https://stackoverflow.com/users/9565145/salieri"}, "edited": false, "score": 0, "creation_date": 1545233129, "post_id": 53853299, "comment_id": 94556098, "body": "I added third argument 0644 and it solved thank you"}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1545233492, "post_id": 53853299, "comment_id": 94556367, "body": "@SergeBallesta my bad, you are right."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1545235457, "post_id": 53853299, "comment_id": 94557735, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/596306/using-the-open-system-call\">Using the open() system call</a>"}], "owner": {"reputation": 35, "user_id": 9565145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Salieri", "link": "https://stackoverflow.com/users/9565145/salieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545229673, "creation_date": 1545229673, "question_id": 53853299, "link": "https://stackoverflow.com/questions/53853299/c-create-txt-file-and-write-to-a-txt-file-with-dup2", "title": "C create txt file and write to a txt file with dup2", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main()\n{\nint fd;\n\nchar c1[100];\n\nprintf(\"type text: \");\nscanf(\"%s\", c1);\nprintf(\"%s\\n\", c1); \n\nif((fd = open(\"test.txt\", O_WRONLY | O_CREAT | O_APPEND)) == -1)\n{\n    return -1;\n}\n\ndup2(fd, 1);\n\nclose(fd);\nprintf(\"%s\\n\", c1);\nreturn 0;\n}\n</code></pre>\n\n<p>This code works fine if \"test.txt\" file already exists.\nBut if \"test.txt\" file doesn't exist, this code makes \"test.txt\" file and seems like write successfully, but txt file is unreadable.(permission problem)</p>\n\n<p>I tried<br>\n<code>if((fd = open(\"test.txt\", O_RDWR | O_CREAT | O_APPEND)) == -1)</code>\nIt has same problem.</p>\n\n<p>I know it is permission problem but how should I fix this code?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 1886, "user_id": 5527075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef879760061aaa53884ab1ee19fe9589?s=128&d=identicon&r=PG&f=1", "display_name": "Feathercrown", "link": "https://stackoverflow.com/users/5527075/feathercrown"}, "edited": false, "score": 0, "creation_date": 1545228415, "post_id": 53852800, "comment_id": 94553220, "body": "Can you define what the &quot;smallest sum&quot; is? The smallest row sum in the grid? The smallest sum of two numbers in a row?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1545228516, "post_id": 53852800, "comment_id": 94553267, "body": "@ZvonimirBrle it is very strange to have <code>sum_row +=mat[i][j]; if(mat[i][j]&lt;sum_row)...</code> can I suppose you missed to close the embeded for body, I mean <code>sum_row +=mat[i][j]; } if(mat[i][j]&lt;sum_row)...</code> ?"}, {"owner": {"reputation": 27, "user_id": 10535571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBWzBDyKOzE/AAAAAAAAAAI/AAAAAAAAAFs/R4HykfnWgEA/photo.jpg?sz=128", "display_name": "Equus", "link": "https://stackoverflow.com/users/10535571/equus"}, "edited": false, "score": 0, "creation_date": 1545228525, "post_id": 53852800, "comment_id": 94553276, "body": "Smallest sum in rows"}, {"owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1545228748, "post_id": 53852800, "comment_id": 94553429, "body": "Why would you set min_row to an element rather than a sum of a row&#39;s elements? Do that and then compare every row sum to that initial one."}, {"owner": {"reputation": 27, "user_id": 10535571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBWzBDyKOzE/AAAAAAAAAAI/AAAAAAAAAFs/R4HykfnWgEA/photo.jpg?sz=128", "display_name": "Equus", "link": "https://stackoverflow.com/users/10535571/equus"}, "edited": false, "score": 0, "creation_date": 1545228776, "post_id": 53852800, "comment_id": 94553451, "body": "Brune that was the part of a problem, but i need to find the smallest sum in number of row that i enter. E.g. I entered 3 rows and I need to find the smallest sum of numbers in that rows"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545228845, "post_id": 53852800, "comment_id": 94553487, "body": "@ZvonimirBrle you also need to not use the same var sum_row for both compute the row sum and to save the smallest sum, and of course to not initialize the smallest sum with 0 except if the sum is always negative"}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545229542, "post_id": 53853195, "comment_id": 94553870, "body": "you suppose int are on 32 bits, can be false. The initial error with the &#39;}&#39; closing the embedded for is still present"}, {"owner": {"reputation": 27, "user_id": 10535571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBWzBDyKOzE/AAAAAAAAAAI/AAAAAAAAAFs/R4HykfnWgEA/photo.jpg?sz=128", "display_name": "Equus", "link": "https://stackoverflow.com/users/10535571/equus"}, "edited": false, "score": 0, "creation_date": 1545229575, "post_id": 53853195, "comment_id": 94553885, "body": "Thanks guys il find the rest, but why min_row=-1 ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545229667, "post_id": 53853195, "comment_id": 94553937, "body": "CSPei tried to compulte the larger possible int, but he does wrong, you can look at my proposal ..."}, {"owner": {"reputation": 10151, "user_id": 1153165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fee10843adffc656f32cdfa67aa425c5?s=128&d=identicon&r=PG", "display_name": "CS Pei", "link": "https://stackoverflow.com/users/1153165/cs-pei"}, "edited": false, "score": 0, "creation_date": 1545229688, "post_id": 53853195, "comment_id": 94553951, "body": "thanks, Bruno, I will fix it. min_row is initialized to be an invalid value. so -1 is one such value (array is 0 based)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545229759, "post_id": 53853195, "comment_id": 94553988, "body": "One good way is to compute the sum of the first row and use it at a current min sum, this it what I did in my answer"}], "tags": [], "owner": {"reputation": 10151, "user_id": 1153165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fee10843adffc656f32cdfa67aa425c5?s=128&d=identicon&r=PG", "display_name": "CS Pei", "link": "https://stackoverflow.com/users/1153165/cs-pei"}, "is_accepted": false, "score": 0, "last_activity_date": 1545229787, "last_edit_date": 1545229787, "creation_date": 1545229293, "answer_id": 53853195, "question_id": 53852800, "link": "https://stackoverflow.com/questions/53852800/how-to-find-the-smallest-sum-of-rows2d-array-c-programming/53853195#53853195", "title": "How to find the smallest sum of rows(2D array) C programming", "body": "<p>I think the comments provided by a few people already point you to the direction. I just sums up all the changes needed for you to check.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n\n{\n    int i, j,n, sum_row, min_row;\n\n    printf(\"Enter the size of an array: \");\n    scanf(\"%d\", &amp;n);\n    int mat[n][n];\n\n    printf(\"\\nEnter numbers in array:\");\n    for(i=0;i&lt;n; i++){\n        for (j=0;j&lt;n;j++){\n            scanf(\"%d\", &amp;mat[i][j]);\n        }\n    }\n\n    min_row = - 1;        // row index\n    int row_min = 1&lt;&lt;31; // some large number, here I assume int is 32 bit on your machine.  this var saves the min value of row sum\n\n    for(i=0;i&lt;n;i++){\n        sum_row = 0;\n\n        for (j=0;j&lt;n;j++){\n            sum_row += mat[i][j];\n\n\n            if(sum_row &lt; row_min) {\n                row_min = sum_row;\n                min_row = i;\n            }\n\n        }\n    }\n\n    printf(\"The smallest sum in rows is: %d, and row looks like %d\", row_min, min_row);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1545230280, "last_edit_date": 1545230280, "creation_date": 1545229476, "answer_id": 53853246, "question_id": 53852800, "link": "https://stackoverflow.com/questions/53852800/how-to-find-the-smallest-sum-of-rows2d-array-c-programming/53853246#53853246", "title": "How to find the smallest sum of rows(2D array) C programming", "body": "<p>I suppose n >= 1</p>\n\n<pre><code>int min_row =0;\nint i, j;\n\n// min_row is first the sum for first row\nfor (j=0;j&lt;n;j++)\n  min_row +=mat[0][j];\n\n// look at other rows\nfor (i=1; i&lt;n; i++) {\n  // compute current row sum\n  int sum_row = 0;\n\n  for (j=0;j&lt;n;j++)\n    sum_row +=mat[i][j];\n\n  // look at who is the smallest\n  if(sum_row &lt; min_row)\n    min_row = sum_row;\n}\n\nprintf(\"The smallest sum in rows is: %d\", min_row);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10535571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBWzBDyKOzE/AAAAAAAAAAI/AAAAAAAAAFs/R4HykfnWgEA/photo.jpg?sz=128", "display_name": "Equus", "link": "https://stackoverflow.com/users/10535571/equus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545230280, "creation_date": 1545227923, "last_edit_date": 1545228580, "question_id": 53852800, "link": "https://stackoverflow.com/questions/53852800/how-to-find-the-smallest-sum-of-rows2d-array-c-programming", "title": "How to find the smallest sum of rows(2D array) C programming", "body": "<p>This one is good for finding the largest number and his row but i dont know how to find the smallest sum. I tried to compare it like mat[i][j] &lt; sum of row but it doesnt work. If u can help me a bit         </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n\n{\n    int i, j,n, sum_row, min_row;\n\nprintf(\"Enter the size of an array: \");\nscanf(\"%d\", &amp;n);\nint mat[n][n];\n\nprintf(\"\\nEnter numbers in array:\");\nfor(i=0;i&lt;n; i++){\n    for (j=0;j&lt;n;j++){\n        scanf(\"%d\", &amp;mat[i][j]);\n    }\n}\n\n\n\nmin_row=mat[0][0];\nfor(i=0;i&lt;n;i++){\n        sum_row=0;\n    for (j=0;j&lt;n;j++){\n            sum_row +=mat[i][j];\n\n\n       if(mat[i][j]&lt;sum_row)\n            sum row=mat[i][j];\n           /*  min_row=i; */\n\n    }\n}\nprintf(\"The smallest sum in rows is: %d, and row looks like\", sum_row);\n\n\n/*for(j=0;j&lt;n;j++){\n    printf(\" %3d\", min_row);\n}*/\n\n\n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 4, "creation_date": 1545227808, "post_id": 53852762, "comment_id": 94552882, "body": "<code>person *myPerson;</code> You need to allocate memory to <code>myPerson</code>."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1545227869, "post_id": 53852762, "comment_id": 94552912, "body": "You do that with <code>person *myPerson = malloc(sizeof(person));</code>."}, {"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 1, "creation_date": 1545228139, "post_id": 53852762, "comment_id": 94553060, "body": "Remember, in C you <i>can</i> allocate dynamically, but you are not <i>obliged</i>: <code>person myPerson; initPerson(&amp;myPerson, &quot;Oscar&quot;, 45);</code> will work and avoid the layer of complexity associated with dynamic memory management. Google <code>memory leaks</code> :)"}, {"owner": {"reputation": 99, "user_id": 10811344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9333f801105728bd2771e33084d5e77d?s=128&d=identicon&r=PG&f=1", "display_name": "Horst", "link": "https://stackoverflow.com/users/10811344/horst"}, "edited": false, "score": 1, "creation_date": 1545228702, "post_id": 53852762, "comment_id": 94553395, "body": "Ah, so person myPerson allocates memory automatically, but person *myPerson doesn&#39;t, therefore one has to do it manually: person *myPerson = malloc(sizeof(person));"}, {"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1545228736, "post_id": 53852762, "comment_id": 94553422, "body": "That&#39;s indeed what&#39;s meant."}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 8, "last_activity_date": 1550506291, "last_edit_date": 1550506291, "creation_date": 1545228133, "answer_id": 53852852, "question_id": 53852762, "link": "https://stackoverflow.com/questions/53852762/c-dereferencing-pointer/53852852#53852852", "title": "C Dereferencing pointer", "body": "<p><em>\"...the app keeps crashing., ...Can someone tell me whats the problem?\"</em><br>\nYes, your program is attempting to write to a memory location it does not own.  </p>\n\n<p>If you must use a pointer to <code>person</code>, create some memory before using it:</p>\n\n<pre><code>int main()\n{\n    person *myPerson = calloc(1, sizeof(*myPerson));\n    if(!myPerson) return 0; //test if failed\n\n    initPerson(myPerson, \"Oscar\", 45);\n\n    printf(\"%s, %i\", myPerson-&gt;name, myPerson-&gt;age);\n    free(myPerson);//free memory\n    return 0;\n}\n</code></pre>\n\n<p>Or, you can simply pass the <em>address of</em> a non-pointer instance of <code>person</code> (using <code>&amp;</code>) to get the same results:</p>\n\n<pre><code>int main()\n{\n    person myPerson = {0};\n\n    initPerson(&amp;myPerson, \"Oscar\", 45);\n    printf(\"%s, %i\", myPerson.name, myPerson.age);\n    return 0;\n}\n</code></pre>\n\n<p>The statement:</p>\n\n<pre><code>person *myPerson;\n</code></pre>\n\n<p>Creates only an uninitialized pointer, not pointing to any particular place in memory at the time of creation.  The only space used at this point is for the pointer itself, <code>sizeof(person *)</code>. (either 4 or 8 bytes for 32bit or 64 bit target respectively.) Before a pointer variable can be used in this way, space must be <em>dynamically</em> allocated by a call to _<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_calloc.htm\" rel=\"nofollow noreferrer\">void *calloc(size_t nitems, size_t size)</a>_ or family.  Memory created in this fashion sets the address of the pointer to a memory location coincident  with the first byte of a contiguous block of <code>nitems*size</code> bytes set aside and dedicated for use with, in this case, <code>myPerson</code>.  Memory allocated in this fashion is referred to as <em>heap memory</em> and must be explicitly freed with a call to <em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_free.htm\" rel=\"nofollow noreferrer\">free()</a></em> when it is no longer needed.  Generally, this method is recommended only when memory requirements for a particular variable are not known at compile time  </p>\n\n<p>But the statement:  </p>\n\n<pre><code>person myPerson;\n</code></pre>\n\n<p><em>Statically</em> (Or <em>automatically</em>, depending on when/where it is created.) allocates memory with <code>sizeof(person)</code> bytes for an immediately usable instance of <code>myPerson</code>, located in memory at the address: <code>&amp;myPerson</code>.  Memory created in this fashion is referred to as <em>stack memory</em>. Because passing the address of <code>myPerson</code> ( <code>&amp;myPerson</code> ) as an argument to <code>initPerson()</code>,  and accomplish the same thing as was accomplished with dynamically allocated memory (discussed above), this is a much simpler option as it does not require any memory creation or freeing.</p>\n\n<p><em><a href=\"https://www.gribblelab.org/CBootCamp/7_Memory_Stack_vs_Heap.html\" rel=\"nofollow noreferrer\">Stack and heap memory explained.</a></em></p>\n\n<p><em><a href=\"https://stackoverflow.com/questions/8385322/difference-between-static-memory-allocation-and-dynamic-memory-allocation\">Discussion on automatic, static and dynamic memory allocation</a></em></p>\n"}], "owner": {"reputation": 99, "user_id": 10811344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9333f801105728bd2771e33084d5e77d?s=128&d=identicon&r=PG&f=1", "display_name": "Horst", "link": "https://stackoverflow.com/users/10811344/horst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53852852, "answer_count": 1, "score": 2, "last_activity_date": 1550506291, "creation_date": 1545227757, "last_edit_date": 1545327734, "question_id": 53852762, "link": "https://stackoverflow.com/questions/53852762/c-dereferencing-pointer", "title": "C Dereferencing pointer", "body": "<p>i started to learn C, and i dont know why the app keeps crashing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n{\n    char name[50];\n    int age;\n}person;\n\nvoid initPerson(person *aPerson, char name[50], int age)\n{\n    strcpy(aPerson-&gt;name, name); // &lt;- causes a crash\n    aPerson-&gt;age = age; // &lt;- causes a crash\n    printf(\"%s\", aPerson-&gt;name);\n}\n\nint main()\n{\n    person *myPerson;\n    initPerson(myPerson, \"Oscar\", 45);\n\n    printf(\"%s, %i\", myPerson-&gt;name, myPerson-&gt;age);\n    return 0;\n}\n</code></pre>\n\n<p>I have marked the lines that are causing the crash. Can someone tell me whats the problem?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545225918, "post_id": 53851934, "comment_id": 94551697, "body": "Why the 30ms delay if you check the flag anyway?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545226000, "post_id": 53851934, "comment_id": 94551746, "body": "Also your delay function will never work with an optimizing compiler. You shouldn&#39;t need any dirty busy-wait delays anywhere."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10810984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37783d8cac9e9dfe2990e0f9440a34f0?s=128&d=identicon&r=PG&f=1", "display_name": "Satyanarayana houji", "link": "https://stackoverflow.com/users/10810984/satyanarayana-houji"}, "edited": false, "score": 0, "creation_date": 1545304693, "post_id": 53852352, "comment_id": 94582339, "body": "thanks for ur reply as per ur guidelines i added Carriage return at the end of string and now iam able to send Sms"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 21, "user_id": 10810984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37783d8cac9e9dfe2990e0f9440a34f0?s=128&d=identicon&r=PG&f=1", "display_name": "Satyanarayana houji", "link": "https://stackoverflow.com/users/10810984/satyanarayana-houji"}, "edited": false, "score": 0, "creation_date": 1545314313, "post_id": 53852352, "comment_id": 94587216, "body": "@Satyanarayanahouji: happy for you! You should now accept the answer..."}], "tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1545226701, "last_edit_date": 1545226701, "creation_date": 1545226376, "answer_id": 53852352, "question_id": 53851934, "link": "https://stackoverflow.com/questions/53851934/gsm-sim900a-module-interfacing-with-pic18f4520-controller/53852352#53852352", "title": "GSM SIM900A Module interfacing with PIC18F4520 Controller", "body": "<p>You need to send CR or CR+LF (characters number 13 and 10 respectively) after every string you send to the modem.</p>\n\n<p>When using a terminal emulator like HyperTerminal, you press the Enter key, right? If you don't press that key, the modem does not know that the command is terminated and must be executed. The same must be done in your firmware.</p>\n\n<p>There is more: you must allow some delay, and you should read back modem responses, but this could be a second step; first of all, to check the setup is working at the base level, you must send an \"AT\", followed by a CR, then see if the modem replies with OK (+ CR and LF...).</p>\n\n<p>Modify</p>\n\n<pre><code>char tocheck[] =\"AT\";\n</code></pre>\n\n<p>in</p>\n\n<pre><code>char tocheck[] =\"AT\\r\";  // the \\r is the CR (carriage return)\n</code></pre>\n\n<p>and you will see that the modem will reply, if all is connected well.</p>\n"}], "owner": {"reputation": 21, "user_id": 10810984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37783d8cac9e9dfe2990e0f9440a34f0?s=128&d=identicon&r=PG&f=1", "display_name": "Satyanarayana houji", "link": "https://stackoverflow.com/users/10810984/satyanarayana-houji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545226840, "creation_date": 1545224822, "last_edit_date": 1545226840, "question_id": 53851934, "link": "https://stackoverflow.com/questions/53851934/gsm-sim900a-module-interfacing-with-pic18f4520-controller", "title": "GSM SIM900A Module interfacing with PIC18F4520 Controller", "body": "<p>I am working with GSM (sim900a) Module interfaced with PIC18F4520 Microcontroller.</p>\n\n<p>Here I am trying to send SMS through PIC controller serially to GSM Module but unable to receive any response from GSM and not receiving any Messages. </p>\n\n<p>When I am trying to connect only GSM Module to Hyperterminal then I am able to send SMS. In the similar fashion when I am trying to send AT commands from PIC to HYPERTERMINAL then I am receiving Commands Serially.</p>\n\n<p><strong>Code Below</strong></p>\n\n<pre><code>#include&lt;p18f4520.h&gt;      /* Header File */\n#include&lt;string.h&gt;\nvoid delay_ms(int ms);\nvoid Data(char Value); \nvoid Cmd(char Value);\nchar temp;\nvoid main() \n{\n   char tocheck[] =\"AT\";/*Basic command to test GSM is working or not */\n   char sendingsmsmode[]=\"AT+CMGF=1\";/* To change the GSM Module in SMS \n  sending Mode */\n   char newsms[]=\"AT+CMGS=918500923915\";/*Set Text mode for SMS */\n char msg[]=\"WelcometoGSM\";/* The text which you want to send */\n char terminator=0x1A;\n int i=0;\n  TRISC =   0x80;         /* RC6=0 (O/P) RC7=1(I/P)                    */           \n SPBRG  =   0x33;         /* Serial Port Baud rate Generator (9600)    */\n TXSTA  =   0X24;         /* Transmission Enabling(TXEN=1,SYNC=0,BRGH=1) \n */\n RCSTA  =   0X90;         /* Rception Enabling (SPEN=1,CREN=1)         */\n TRISC=0X00;               /*  (RC1,RC0 -&gt;O/P Setting by Zero)                 \n   */\n TRISD=0X00;                 /*  PORTD (0 - 7)pins Config as Output                  \n       */\n\n   while(tocheck[i]!='\\0'){\n    while(TXSTAbits.TRMT==0);\n    TXREG=tocheck[i];\n    delay_ms(30);\n    i++;\n  }\n   i=0;\n   while(sendingsmsmode[i]!='\\0'){\n    while(TXSTAbits.TRMT==0);\n    TXREG=sendingsmsmode[i];\n    delay_ms(30);\n    i++;\n  }\n  i=0;\n  while(newsms[i]!='\\0'){\n    while(TXSTAbits.TRMT==0);\n    TXREG=newsms[i];\n    delay_ms(30);\n    i++;\n   }\n   i=0;\n  while(msg[i]!='\\0'){\n    while(TXSTAbits.TRMT==0);\n    TXREG=msg[i];\n    delay_ms(30);\n    i++;\n}\n  TXREG=terminator;\n delay_ms(3000);\n while(1);\n }\n  void Cmd(char Value)\n   {\n PORTD=Value;\n PORTCbits.RC1=0;                /*  RC1=0(RS=0)        [Command Registr \n Selection])    */\n PORTCbits.RC0=0;                /*  RC0=0(R/W=0)   [Write Process])                \n   */\n PORTCbits.RC2=1;                /*  RC2=1(Enable=1)    [Enable Line ON]                \n  */\n delay_ms(4);                    /*  Minimun Delay For Hold On Data                      \n   */\n PORTCbits.RC2=0;                /*  RC2=0(Enable=0)    [Enable Line OFF]               \n */\n    }   \n\nvoid Data(char Value)\n{\n PORTD=Value;\n PORTCbits.RC1=1;               /*  RC1=1(RS=1)     [Data Registr \nSelection])       */\n PORTCbits.RC0=0;                /*  RC0=0(R/W=0)   [Write Process])                \n   */\n PORTCbits.RC2=1;               /*  RC2=1(Enable=1) [Enable Line ON]                \n   */\n delay_ms(4);                   /*  Minimun Delay For Hold On Data                      \n    */\n PORTCbits.RC2=0;               /*  RC2=0(Enable=0) [Enable Line OFF]               \n    */\n    }\n  void delay_ms(int ms)\n{\nint i,count;\n\nfor(i=1;i&lt;=ms;i++)\n{\n    count=498;\n    while(count!=1)\n    {\n        count--;\n    }\n     }\n\n   }\n</code></pre>\n"}, {"tags": ["c", "struct", "enums"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545224648, "post_id": 53851791, "comment_id": 94551004, "body": "Because C is not C++.  You could define a structure type within another and both are usable."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545225599, "post_id": 53851791, "comment_id": 94551507, "body": "From the dupe: &quot;In C, there is simply no rule for scope for enums and struct. The place where you define your enum doesn&#39;t have any importance.&quot; Please search next time for duplicates @knowledge, since they don&#39;t seem to be so rare about your question!"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545226898, "post_id": 53851791, "comment_id": 94552295, "body": "@gsamaras Unfortunately your quotation from selected answer on that question is incorrect. <a href=\"https://ideone.com/btYDin\" rel=\"nofollow noreferrer\">Scope is determined by the placement of the struct definition.</a>"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545227162, "post_id": 53851791, "comment_id": 94552459, "body": "Are you saying that the answer in the dupe is wrong? If so, please let the poster now. Moreover, if it&#39;s indeed wrong, then I should unmark the dupe, but I really have no time to contribute more now"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545227759, "post_id": 53851791, "comment_id": 94552841, "body": "@gsamaras I left comment on that answer. I don&#39;t know if removing dupe is necessary; second answer on that question is closer to truth."}], "owner": {"reputation": 761, "user_id": 3990094, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8f85dae089a6c11339f051c01387f9f3?s=128&d=identicon&r=PG&f=1", "display_name": "knowledge", "link": "https://stackoverflow.com/users/3990094/knowledge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1545225587, "answer_count": 0, "score": 3, "last_activity_date": 1545224376, "creation_date": 1545224376, "question_id": 53851791, "link": "https://stackoverflow.com/questions/53851791/enum-within-struct-scope-of-enum-in-c", "closed_reason": "Duplicate", "title": "Enum within struct - Scope of enum in C", "body": "<p>Why I can use the enum \"outside\" the struct as a parameter of the init function? So it looks like the enum is global and not restricted to the enclosing struct block.</p>\n\n<pre><code>typedef struct {\n    double x;\n    double y;\n    enum color_t {r, g, b} color;\n} point;\n\nvoid myfunc(point *this, enum color_t c) {\n    // TODO\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1545223245, "post_id": 53851445, "comment_id": 94550196, "body": "Compile with all warnings and debug info (<code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>...). Improve your code to get no warnings. Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>. Use <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">the <code>gdb</code> debugger</a>. Give an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1545223251, "post_id": 53851445, "comment_id": 94550198, "body": "what is abc.txt file?"}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 1, "creation_date": 1545223339, "post_id": 53851445, "comment_id": 94550240, "body": "abc.txt file is just a txt with some coordinates (just an example of it)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1545223349, "post_id": 53851445, "comment_id": 94550244, "body": "@BasileStarynkevitch it&#39;s almost an MCVE!"}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1545223370, "post_id": 53851445, "comment_id": 94550255, "body": "thanks @Basilestarynkevitch ill try"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545223439, "post_id": 53851445, "comment_id": 94550294, "body": "2D arrays (even if you call them simple) and input reading are two different non-trivial problems. Separate them. Try to solve one first, then start on the other."}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545223653, "post_id": 53851445, "comment_id": 94550415, "body": "@Yunnosch thanks for your comment. As i said in question, the program works whe i&#39;ve got everything in a &#39;int main&#39;, but once i separate the code into functions it stops working"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545223786, "post_id": 53851445, "comment_id": 94550485, "body": "Would you like to show the working code before the refactoring? It would make finding the problematic change easier than looking for the problem in the shown code."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545223850, "post_id": 53851445, "comment_id": 94550521, "body": "Also, your comment does not seem to actually answer mine. Split the two parts. Solve each. Identify the one which makes the problem. Ask about that one. Demonstrate that one in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, exclude the other one from the question."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545224120, "post_id": 53851445, "comment_id": 94550704, "body": "@Yunnosch OP has already provided a very good attempt for an MCVE."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545227231, "post_id": 53851445, "comment_id": 94552503, "body": "See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545234411, "post_id": 53851445, "comment_id": 94557018, "body": "@gsamaras No has not. Code has been provided to demonstrate a problem with 2D array or reading. For &quot;M&quot; only the code whith the part which demonstrates the problem should be provided. Removing the rest is part of making the CVE minimal."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545223514, "post_id": 53851535, "comment_id": 94550338, "body": "You&#39;re right thanks, but still it doesn&#39;t solve my segmentation fault. Edited the question"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545224567, "post_id": 53851535, "comment_id": 94550969, "body": "OK @DylanLopes, answer updated, problem solved. I rolled back your edit, since it invalidates my answer. :) Let me know if you have any problems.."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545224775, "post_id": 53851535, "comment_id": 94551085, "body": "You are welcome @DylanLopes. I think this edit with compiler warnings was really helpful... PS: Not a great fail, just a mistake that might trigger new knowledge for you (like compiling with warnings enabled next time!) ;) PPS: Your MCVE was perfect,  except from the fact that wasn&#39;t intended."}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545226416, "post_id": 53851535, "comment_id": 94551994, "body": "Thanks for your tips ;) now i&#39;ve the problem that if i try read coordinates from this file: <a href=\"https://ufile.io/k1iap\" rel=\"nofollow noreferrer\">ufile.io/k1iap</a>. i get a segmentation fault. if you can help please ;) PS: sorry for uploading the file, but it a really long one."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545226657, "post_id": 53851535, "comment_id": 94552142, "body": "I cannot open the file from my work @DylanLopes, it&#39;s not a trusted file. How many columns, and how many rows? Because in your code, you have 3 hardcoded."}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545226910, "post_id": 53851535, "comment_id": 94552301, "body": "19352 rows and 3 columns, i&#39;ve hardcoded 3 columns, but unlimited rows right?"}, {"owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 1, "creation_date": 1545227248, "post_id": 53851535, "comment_id": 94552515, "body": "Ok i got it wrong, i was allocatting memory for unlimited collumns instead of rows, i just changed that and it works, that for everything @gsamaras"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "edited": false, "score": 0, "creation_date": 1545227254, "post_id": 53851535, "comment_id": 94552525, "body": "No @DylanLopes, as I explain in my <a href=\"https://gsamaras.wordpress.com/code/2d-dynamic-array-c/\" rel=\"nofollow noreferrer\">2D dynamic array(C)</a>, you are allocating dynamically memory for 3 rows and <code>s</code> columns. Glad I helped!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1545224684, "last_edit_date": 1545224684, "creation_date": 1545223411, "answer_id": 53851535, "question_id": 53851445, "link": "https://stackoverflow.com/questions/53851445/core-dumped-trying-to-create-newvectorarray-2d-in-a-struct/53851535#53851535", "title": "Core dumped trying to create newVector(array 2D) in a struct", "body": "<p>In <code>count()</code>, you are incrementing an <em>uninitialized</em> variable, invoking Undefined Behavior (UB).</p>\n\n<p>Change this:</p>\n\n<pre><code>int count() {\n  int i;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>int count() {\n  int i = 0;\n</code></pre>\n\n<hr>\n\n<p><code>newVector()</code> is <em>not</em> returning the dynamic allocated memory.</p>\n\n<p>Change this:</p>\n\n<pre><code>coord *newVector(size_t s) {\n  ...\n}\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>coord *newVector(size_t s) {\n  ...\n  return v;\n}\n</code></pre>\n\n<hr>\n\n<p>After fixing these issues, you should see this output:</p>\n\n<pre><code>1.000000 2.000000 3.000000\n4.000000 5.000000 6.000000\n7.000000 8.000000 9.000000\n</code></pre>\n\n<hr>\n\n<p>Not the problem, but I would use <code>%lf</code> as the format specifiers in <code>fscanf()</code>, instead of <code>%le</code>.</p>\n\n<p>Moreover, in <code>count()</code>, this <code>return(i);</code> is the same as this <code>return i;</code>. The parentheses are redundant.</p>\n\n<p>TODO: Free the dynamically allocated memory (I assume that you skipped that part for providing the MCVE).</p>\n\n<hr>\n\n<p>Pro-tip: Compile with warning flags enabled next time. They would have already found the issue for you in this case. In GCC for example, I would get this:</p>\n\n<pre><code>gsamaras@myPc:~$ gcc -Wall  main.c\nmain.c: In function \u2018main\u2019:\nmain.c:51:28: warning: unused variable \u2018j\u2019 [-Wunused-variable]\n                 int i = 0, j=0;\n                            ^\nmain.c: In function \u2018newVector\u2019:\nmain.c:37:13: warning: control reaches end of non-void function [-Wreturn-type]\n             }\n             ^\n</code></pre>\n\n<p>where the last warning is the second point in my answer.</p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 3083333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aea2d9f71f42d8984a03edcd0b7b918?s=128&d=identicon&r=PG", "display_name": "garlix", "link": "https://stackoverflow.com/users/3083333/garlix"}, "is_accepted": false, "score": 0, "last_activity_date": 1545224117, "creation_date": 1545224117, "answer_id": 53851719, "question_id": 53851445, "link": "https://stackoverflow.com/questions/53851445/core-dumped-trying-to-create-newvectorarray-2d-in-a-struct/53851719#53851719", "title": "Core dumped trying to create newVector(array 2D) in a struct", "body": "<p>You forgot to return <code>v</code> in <code>newVector</code> function:</p>\n\n<pre><code>        // creates new structure with the right size of memory allocated\n        coord *newVector(size_t s){\n            coord *v;\n            int j;\n            v = malloc(sizeof(coord));\n\n            v-&gt;a = malloc(sizeof(double*)*3);\n\n            for (j=0; j&lt;3; j++){\n                v-&gt;a[j] = malloc(sizeof(double)*s);\n            }\n\n            return v;\n\n        }\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10496767, "user_type": "registered", "profile_image": "https://graph.facebook.com/1914466478619993/picture?type=large", "display_name": "Dylan Lopes", "link": "https://stackoverflow.com/users/10496767/dylan-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53851535, "answer_count": 2, "score": 0, "last_activity_date": 1545224684, "creation_date": 1545223048, "last_edit_date": 1545224385, "question_id": 53851445, "link": "https://stackoverflow.com/questions/53851445/core-dumped-trying-to-create-newvectorarray-2d-in-a-struct", "title": "Core dumped trying to create newVector(array 2D) in a struct", "body": "<p>So I'm trying to create a simple array 2D inside a struct, and to read the values of some coordinates that are in a file.</p>\n\n<p>At this moment I've got all inside functions and i get a segmentation fault when i try to get the coordinates on the 'get_coords' function. If I write all the exactly same code on a 'int main' instead of using functions it works.</p>\n\n<p>code: </p>\n\n<pre><code>            #include &lt;stdio.h&gt;\n            #include &lt;stdlib.h&gt;\n\n            // structure\n            typedef struct coordinates{\n                double **a;\n            } coord;\n\n            // counts the nmbr of points \n            int count(){\n                int i;\n                int a1, a2, a3;\n                FILE *fp;\n                fp = fopen(\"abc.txt\", \"r+\");\n                while (fscanf(fp, \"%d %d %d\", &amp;a1, &amp;a2, &amp;a3) != EOF){\n                    i++;\n                    if (feof(fp)){\n                        break;          \n                    }   \n                }\n                fclose(fp);\n                return(i);\n            }\n\n            // creates new structure with the right size of memory allocated\n            coord *newVector(size_t s){\n                coord *v;\n                int j;\n                v = malloc(sizeof(coord));\n\n                v-&gt;a = malloc(sizeof(double*)*3);\n\n                for (j=0; j&lt;3; j++){\n                    v-&gt;a[j] = malloc(sizeof(double)*s);\n                }\n\n            }\n\n            void get_coords(coord *points){\n                int i=0;\n                FILE *fp;\n                fp = fopen(\"abc.txt\", \"r+\");\n                while (fscanf(fp, \"%le %le %le\", &amp;points-&gt;a[i][0], &amp;points-&gt;a[i][1], &amp;points-&gt;a[i][2]) != EOF){\n                    i++;\n                }\n                fclose(fp);\n            }\n\n\n            int main(){\n                int i = 0, j=0;\n\n                coord *points;\n\n                i = count();\n\n                points = newVector(i);\n\n                get_coords(points);\n\n                for (i=0; i&lt;3; i++){\n                        printf(\"%lf %lf %lf\\n\", points-&gt;a[i][0], points-&gt;a[i][1], points-&gt;a[i][2]);\n                }\n            }\n</code></pre>\n\n<p>abc.txt:</p>\n\n<pre><code>1 2 3\n4 5 6\n7 8 9\n</code></pre>\n\n<p>Thanks all for your help.</p>\n\n<p>Cumps, \nDylan.</p>\n\n<p>PS: This is just a prototype for what i want.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 714, "user_id": 9890829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P8efG.jpg?s=128&g=1", "display_name": "Hirasawa Yui", "link": "https://stackoverflow.com/users/9890829/hirasawa-yui"}, "edited": false, "score": 0, "creation_date": 1545221492, "post_id": 53850926, "comment_id": 94549294, "body": "Try moving an if statement into the while loop."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1545226895, "post_id": 53850926, "comment_id": 94552291, "body": "It seems like a bad idea to modify <code>i</code> both in the for loop (<code>i++</code>) and also in the while loop (<code>i=i&#47;10;</code>).  It means your for-loop will not run across all values from <code>m</code> to <code>n</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1545222869, "creation_date": 1545222869, "answer_id": 53851395, "question_id": 53850926, "link": "https://stackoverflow.com/questions/53850926/why-does-my-code-not-give-a-proper-output/53851395#53851395", "title": "Why does my code not give a proper output?", "body": "<p>I see two faults in your program, <code>j</code> is only initialised once, and you are destroying the loop control <code>i</code>. To remedy, initialise <code>j</code> inside the loop, and work with <code>temp</code> instead of with <code>i</code>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)                      // modern style\n{\n    int m, n, i, j, r; \n    printf(\"Enter m\\n\");\n    scanf(\"%d\", &amp;m);\n\n    printf(\"Enter n\\n\");\n    scanf(\"%d\", &amp;n);\n\n    for(i = m; i &lt;= n; i++) {\n        j = 0;                      // initialise j\n        int temp = i;\n        while(temp &gt; 0) {           // work with temp\n            r = temp % 10;\n            j = j + r * r * r;\n            temp = temp / 10;\n        }\n\n        if(j == i) {\n            printf(\"%d is armstrong\\n\", i);\n        }\n    }\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre>\nEnter m\n1\nEnter n\n10000\n1 is armstrong\n153 is armstrong\n370 is armstrong\n371 is armstrong\n407 is armstrong\n</pre>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 8710770, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KGhJP.jpg?s=128&g=1", "display_name": "Physx", "link": "https://stackoverflow.com/users/8710770/physx"}, "is_accepted": false, "score": 2, "last_activity_date": 1545223685, "creation_date": 1545223685, "answer_id": 53851618, "question_id": 53850926, "link": "https://stackoverflow.com/questions/53850926/why-does-my-code-not-give-a-proper-output/53851618#53851618", "title": "Why does my code not give a proper output?", "body": "<pre><code>for(i=m; i&lt;=n; i++)\n{\n    j = 0;\n    int temp = i;\n    while(temp &gt; 0)\n    {\n        r = temp % 10;\n        j = j + r*r*r;\n        temp = temp/10;\n    }\n\n    if(j == i)\n    {\n        printf(\"%d is armstrong\\n\", i);\n    }\n\n\n}\n</code></pre>\n\n<p>In while loop you need to work with variable temp to leave i intact so the for loop continues correctly. Before starting new while loop set j = 0 to start counting again from 0. In if statement compare j == i because temp variable is reduced to 0 by while loop.</p>\n"}], "owner": {"reputation": 59, "user_id": 9788789, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_x9a7aFkxgk/AAAAAAAAAAI/AAAAAAAACHs/DYxFkFBvtAU/photo.jpg?sz=128", "display_name": "Kunal Nk", "link": "https://stackoverflow.com/users/9788789/kunal-nk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545223685, "creation_date": 1545221240, "question_id": 53850926, "link": "https://stackoverflow.com/questions/53850926/why-does-my-code-not-give-a-proper-output", "title": "Why does my code not give a proper output?", "body": "<p>This is the code to print all armstrong numbers within a range m to n as input by the user. But when i run it, it does not give proper output. Suppose i input m as 1 and n as some 10000, it only shows '1 is armstrong' and nothing else.Please tell me if something is wrong in my code.    </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\n\n    int m,n,a,i,j=0,r; \n    printf(\"Enter m\\n\");\n    scanf(\"%d\",&amp;m);\n\n    printf(\"Enter n\\n\");\n\n    scanf(\"%d\",&amp;n);\n\n    for(i=m;i&lt;=n;i++)\n    {\n        int temp=i;\n        while(i&gt;0)\n        {\n            r=i%10;\n            j=j+r*r*r;\n            i=i/10;\n        }\n\n        if(j==temp)\n        {\n            printf(\"%d is armstrong\\n\",temp);\n        }\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 347, "user_id": 3211593, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3c9939cd088e2101ed406ee85096318d?s=128&d=identicon&r=PG", "display_name": "Hooman", "link": "https://stackoverflow.com/users/3211593/hooman"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1545220870, "post_id": 53850625, "comment_id": 94548965, "body": "that works. i thought <code>[</code> and <code>]</code> are options which comes between <code>%s</code> for scanning strings."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 3211593, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3c9939cd088e2101ed406ee85096318d?s=128&d=identicon&r=PG", "display_name": "Hooman", "link": "https://stackoverflow.com/users/3211593/hooman"}, "is_accepted": true, "score": 1, "last_activity_date": 1545221086, "creation_date": 1545221086, "answer_id": 53850874, "question_id": 53850625, "link": "https://stackoverflow.com/questions/53850625/sscanf-multi-string-scan/53850874#53850874", "title": "sscanf multi string scan", "body": "<p><code>\"%d=%[^|]|%[^=]=%[^|]|%s\"</code> is the correct format.</p>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 1, "last_activity_date": 1545317300, "last_edit_date": 1545317300, "creation_date": 1545227997, "answer_id": 53852820, "question_id": 53850625, "link": "https://stackoverflow.com/questions/53850625/sscanf-multi-string-scan/53852820#53852820", "title": "sscanf multi string scan", "body": "<h2>The Problem Asked About</h2>\n\n<p>After a <code>|</code> character is encountered with the scanset directive <code>%[^|]</code>, <code>sscanf()</code> will resume matching with the <code>|</code> character. The next directive should be a literal <code>|</code> to avoid a matching failure. In the original code, with <code>%[^|]s</code>, the <code>s</code> is <em>not</em> a part of the scanset directive, and instead <code>sscanf()</code> seeks to match a literal <code>s</code> in the input. Also, note that maximum width specifiers should always be used with the <code>%s</code> and <code>%[]</code> <code>fscanf()</code> family directives to avoid buffer overflow with malicious or malformed inputs:</p>\n\n<pre><code>\"%d=%39[^|]|%39[^=]=%39[^|]|%39s\"\n</code></pre>\n\n<h2>Some Other Serious Issues</h2>\n\n<p>Always enable warnings when compiling C code; doing so here would have helped you avoid several serious problems. There are a lot of warnings for this code, and most of the problems listed below lead to undefined behavior. I always use at least <code>gcc -std=c11 -Wall -Wextra -Wpedantic</code>, and I have added a sample of gcc output for the original code at the end of the answer.</p>\n\n<p>The posted code is missing <code>#include &lt;string.h&gt;</code> for <code>memset()</code>.</p>\n\n<p>The <code>.title</code> and <code>.extra</code> fields of <code>lcdInput</code> should be <code>unsigned char *</code>, since these point to the first elements of <code>unsigned char</code> arrays.</p>\n\n<p>In the initialization of <code>customInput</code> the <code>&amp;</code> operators should be removed. <code>customInput.title</code> and <code>customInput.extra</code> are both expecting pointers to <code>unsigned char</code> (or <code>char</code>s before the above correction). With, e.g. <code>&amp;customInputTitle[0]</code> you have a pointer to an array of <code>CUSTOM_INPUT_LENGTH</code> <code>unsigned char</code>s (or <code>char</code>s before the above correction); this is a type mismatch, and your compiler should complain vociferously (with warnings enabled). Instead, just use:</p>\n\n<pre><code>static lcdInput customInput = {\n    .title = {customInputTitle[0], customInputTitle[1]},\n    .extra = {customInputExtra[0], customInputExtra[1]},\n    .type = INPUT_NORMAL,\n    .editable = 1,\n    .forceLen = 0,\n};\n</code></pre>\n\n<p>Here, <code>customInputTitle[0]</code> is an array of <code>CUSTOM_INPUT_LENGTH</code> <code>unsigned char</code>s, which will decay to a pointer to its first element (<code>unsigned char *</code>). Alternatively, you could use <code>&amp;customInputTitle[0][0]</code>, <code>&amp;customInputTitle[1][0]</code>, etc.</p>\n\n<p>Similarly, you need to remove the ampersands from the <code>customInput</code> arrays in the call to <code>sscanf()</code>. Here you also need to do something about <code>&amp;customInput.type</code>. This is an <code>enum</code> type, and you can't input an <code>enum</code> value. Again, the compiler complains with warnings enabled. Instead, try:</p>\n\n<pre><code>int typeInput;\nif (sscanf(payload, CUSTOM_INPUT_REGX,\n           &amp;typeInput,\n           customInputTitle[0], customInputTitle[1],\n           customInputExtra[0], customInputExtra[1]) == 5) {\n    if (typeInput &gt;= INPUT_NUMBER &amp;&amp; typeInput &lt;= INPUT_PAYAMOUNT) {\n        customInput.type = typeInput;\n    } else {\n        /* Handle error */\n    }\n};\n</code></pre>\n\n<p>Here <code>typeInput</code> is used to collect input, the value returned by <code>sscanf()</code> is checked to verify that the correct number of values was assigned, and the value of <code>typeInput</code> is checked against the value range for <code>inputType</code>. If input is as expected, <code>typeInput</code> is assigned to <code>customInput.type</code>.</p>\n\n<p>The calls to <code>memset()</code> will work, but why obfuscate things with bitshifts? You don't need the <code>&amp;</code> operators here, either, but in this case they are OK. Instead, consider:</p>\n\n<pre><code>memset(customInputTitle, 0, sizeof customInputTitle);\nmemset(customInputExtra, 0, sizeof customInputExtra);\n</code></pre>\n\n<p>Here is the corrected code. This compiles with no warnings using <code>gcc -std=c11 -Wall -Wextra -Wpedantic</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;        // missing header\n\ntypedef enum {\n    INPUT_NUMBER = 0,\n    INPUT_NORMAL = 1,\n    INPUT_PASSWORD = 2,\n    INPUT_PAYAMOUNT = 3,\n} inputType;\n\ntypedef struct {\n    unsigned char * title[2];    // need unsigned char\n    unsigned char * extra[2];\n    inputType type;\n    unsigned minLen:6;\n    unsigned maxLen:6;\n    unsigned forceLen:1;\n    unsigned editable:1;\n    unsigned char data[100];\n} lcdInput;\n\n#define CUSTOM_INPUT_LENGTH     40\n\nstatic unsigned char customInputTitle[2][CUSTOM_INPUT_LENGTH];\nstatic unsigned char customInputExtra[2][CUSTOM_INPUT_LENGTH];\nconst char * payload = \"1=Salam Khobi|FC93F8A120F491F3A8=Rial|F191FEA4\";\n\n// bad format string\n#define CUSTOM_INPUT_REGX       \"%d=%39[^|]|%39[^=]=%39[^|]|%39s\"\n\n// &amp; operator not needed\nstatic lcdInput customInput = {\n    .title = {customInputTitle[0], customInputTitle[1]},\n    .extra = {customInputExtra[0], customInputExtra[1]},\n    .type = INPUT_NORMAL,\n    .editable = 1,\n    .forceLen = 0,\n};\n\nint main(void)\n{\n    // could use improvements\n    memset(customInputTitle, 0, sizeof customInputTitle);\n    memset(customInputExtra, 0, sizeof customInputExtra);\n\n    // &amp; operators not needed\n    int typeInput;\n    if (sscanf(payload, CUSTOM_INPUT_REGX,\n               &amp;typeInput,\n               customInputTitle[0], customInputTitle[1],\n               customInputExtra[0], customInputExtra[1]) == 5) {\n        if (typeInput &gt;= INPUT_NUMBER &amp;&amp; typeInput &lt;= INPUT_PAYAMOUNT) {\n            customInput.type = typeInput;\n        } else {\n            /* Handle error */\n        }\n    };\n\n    return 0;\n}\n</code></pre>\n\n<h2>GCC Output with Warnings</h2>\n\n<p>Here are the compiler warnings with <code>gcc -std=c11 -Wall -Wextra -Wpedantic</code> from the original program posted in the question:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>bad_program.c:27:19: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n         .title = {&amp;customInputTitle[0], &amp;customInputTitle[1]},\n                   ^\nbad_program.c:27:19: note: (near initialization for \u2018customInput.title[0]\u2019)\nbad_program.c:27:41: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n         .title = {&amp;customInputTitle[0], &amp;customInputTitle[1]},\n                                         ^\nbad_program.c:27:41: note: (near initialization for \u2018customInput.title[1]\u2019)\nbad_program.c:28:19: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n         .extra = {&amp;customInputExtra[0], &amp;customInputExtra[1]},\n                   ^\nbad_program.c:28:19: note: (near initialization for \u2018customInput.extra[0]\u2019)\nbad_program.c:28:41: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n         .extra = {&amp;customInputExtra[0], &amp;customInputExtra[1]},\n                                         ^\nbad_program.c:28:41: note: (near initialization for \u2018customInput.extra[1]\u2019)\nbad_program.c: In function \u2018main\u2019:\nbad_program.c:36:5: warning: implicit declaration of function \u2018memset\u2019 [-Wimplicit-function-declaration]\n     memset(&amp;customInputTitle, 0, CUSTOM_INPUT_LENGTH &lt;&lt; 1);\n     ^~~~~~\nbad_program.c:36:5: warning: incompatible implicit declaration of built-in function \u2018memset\u2019\nbad_program.c:36:5: note: include \u2018&lt;string.h&gt;\u2019 or provide a declaration of \u2018memset\u2019\nbad_program.c:25:33: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 3 has type \u2018inputType * {aka enum &lt;anonymous&gt; *}\u2019 [-Wformat=]\n #define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\n                                 ^\nbad_program.c:39:21: note: in expansion of macro \u2018CUSTOM_INPUT_REGX\u2019\n     sscanf(payload, CUSTOM_INPUT_REGX,\n                     ^~~~~~~~~~~~~~~~~\nbad_program.c:25:33: warning: format \u2018%[^|\u2019 expects argument of type \u2018char *\u2019, but argument 4 has type \u2018unsigned char (*)[40]\u2019 [-Wformat=]\n #define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\n                                 ^\nbad_program.c:39:21: note: in expansion of macro \u2018CUSTOM_INPUT_REGX\u2019\n     sscanf(payload, CUSTOM_INPUT_REGX,\n                     ^~~~~~~~~~~~~~~~~\nbad_program.c:25:33: warning: format \u2018%[^=\u2019 expects argument of type \u2018char *\u2019, but argument 5 has type \u2018unsigned char (*)[40]\u2019 [-Wformat=]\n #define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\n                                 ^\nbad_program.c:39:21: note: in expansion of macro \u2018CUSTOM_INPUT_REGX\u2019\n     sscanf(payload, CUSTOM_INPUT_REGX,\n                     ^~~~~~~~~~~~~~~~~\nbad_program.c:25:33: warning: format \u2018%[^|\u2019 expects argument of type \u2018char *\u2019, but argument 6 has type \u2018unsigned char (*)[40]\u2019 [-Wformat=]\n #define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\n                                 ^\nbad_program.c:39:21: note: in expansion of macro \u2018CUSTOM_INPUT_REGX\u2019\n     sscanf(payload, CUSTOM_INPUT_REGX,\n                     ^~~~~~~~~~~~~~~~~\nbad_program.c:25:33: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 7 has type \u2018unsigned char (*)[40]\u2019 [-Wformat=]\n #define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\n                                 ^\nbad_program.c:39:21: note: in expansion of macro \u2018CUSTOM_INPUT_REGX\u2019\n     sscanf(payload, CUSTOM_INPUT_REGX,\n                     ^~~~~~~~~~~~~~~~~\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 3211593, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3c9939cd088e2101ed406ee85096318d?s=128&d=identicon&r=PG", "display_name": "Hooman", "link": "https://stackoverflow.com/users/3211593/hooman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 53850874, "answer_count": 2, "score": 0, "last_activity_date": 1545317300, "creation_date": 1545220227, "question_id": 53850625, "link": "https://stackoverflow.com/questions/53850625/sscanf-multi-string-scan", "title": "sscanf multi string scan", "body": "<p>i want to capture following string in c with sscanf</p>\n\n<pre><code>\"1=Salam Khobi|FC93F8A120F491F3A8=Rial|F191FEA4\"\n</code></pre>\n\n<p>but sscanf only fills <code>&amp;customInput.type</code> and <code>customInputTitle[0]</code> with \"Salam Khobi\" and other part of string would not scan.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef enum {\n    INPUT_NUMBER = 0,\n    INPUT_NORMAL = 1,\n    INPUT_PASSWORD = 2,\n    INPUT_PAYAMOUNT = 3,\n} inputType;\n\ntypedef struct {\n    char * title[2];\n    char * extra[2];\n    inputType type;\n    unsigned minLen:6;\n    unsigned maxLen:6;\n    unsigned forceLen:1;\n    unsigned editable:1;\n    unsigned char data[100];\n} lcdInput;\n#define CUSTOM_INPUT_LENGTH     40\nstatic unsigned char customInputTitle[2][CUSTOM_INPUT_LENGTH];\nstatic unsigned char customInputExtra[2][CUSTOM_INPUT_LENGTH];\nconst char * payload = \"1=Salam Khobi|FC93F8A120F491F3A8=Rial|F191FEA4\";\n#define CUSTOM_INPUT_REGX       \"%d=%[^|]s|%[^=]s=%[^|]s|%s\"\nstatic lcdInput customInput = {\n        .title = {&amp;customInputTitle[0], &amp;customInputTitle[1]},\n        .extra = {&amp;customInputExtra[0], &amp;customInputExtra[1]},\n        .type = INPUT_NORMAL,\n        .editable = 1,\n        .forceLen = 0,\n};\n\nint main()\n{\n    memset(&amp;customInputTitle, 0, CUSTOM_INPUT_LENGTH &lt;&lt; 1);\n    memset(&amp;customInputExtra, 0, CUSTOM_INPUT_LENGTH &lt;&lt; 1);\n\n    sscanf(payload, CUSTOM_INPUT_REGX,\n           &amp;customInput.type,\n           &amp;customInputTitle[0], &amp;customInputTitle[1],\n           &amp;customInputExtra[0], &amp;customInputExtra[1]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "multithreading", "signals"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1545218993, "post_id": 53850202, "comment_id": 94547985, "body": "Your code invokes undefined behavior.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note188\" rel=\"nofollow noreferrer\">footnote 183 of the C standard</a>: &quot;Thus, a signal handler cannot, in general, call standard library functions.&quot;  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow noreferrer\">POSIX allows the calling of async-signal-safe functions from within a signal handler</a>.  Using <code>cout</code> and calling <code>sleep()</code> are not async-signal-safe."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1545219812, "post_id": 53850202, "comment_id": 94548383, "body": "You don&#39;t want to have to handle signals that way. Not ever."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1545220786, "post_id": 53850202, "comment_id": 94548916, "body": "<a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/signal.7.html</a>"}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1545268599, "post_id": 53850202, "comment_id": 94570521, "body": "@AndrewHenle  Yes, you are right. But I need to print something to debug, so I think I have no choice. Using non-reentrant functions in signal handler can be undefined behavior. At least for the code above, it works as expected."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1545301980, "post_id": 53850202, "comment_id": 94580979, "body": "@Yves On a POSIX system: <code>write( STDOUT_FILENO, buffer, strlen( buffer ) );</code>  Or <code>STDERR_FILENO</code>, if you prefer.  Build a C-style string, then use <code>write()</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1546431093, "post_id": 53850202, "comment_id": 94848764, "body": "On Linux specifically, you might consider <a href=\"http://man7.org/linux/man-pages/man2/signalfd.2.html\" rel=\"nofollow noreferrer\">signalfd(2)</a>. However, it does have shortcomings (STFW)"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1545219980, "last_edit_date": 1545219980, "creation_date": 1545218756, "answer_id": 53850246, "question_id": 53850202, "link": "https://stackoverflow.com/questions/53850202/signal-handler-and-multithreading/53850246#53850246", "title": "signal handler and multithreading", "body": "<blockquote>\n  <p>So signal only interrupt thread instead of the whole process if there are multi-threading?</p>\n</blockquote>\n\n<p>Yes. A signal interrupts a single thread of execution. At least according to the POSIX standard. C standard itself doesn't specify behaviour of processes or threads.</p>\n\n<p>If a signal is generated for a multi threaded process as opposed to being generated for particular thread, the signal will be delivered to exactly one of the threads belonging to that process (unless the signal is blocked by all threads).</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1545218756, "creation_date": 1545218756, "answer_id": 53850247, "question_id": 53850202, "link": "https://stackoverflow.com/questions/53850202/signal-handler-and-multithreading/53850247#53850247", "title": "signal handler and multithreading", "body": "<p>No matter how many threads the process has, some thread catches the signal and runs the signal handler while the other threads (if any) go on about their business. The signal is sent to the process, but what the process does when it gets the signal is dependent on how the process, and the threads in, configured its signal handlers.</p>\n\n<p>The full rules are quite complicated and I think it's safe to say that very few programmers bother to full understand them and generally avoid signals except for very limited purposes. See <a href=\"https://docs.oracle.com/cd/E19455-01/806-5257/6je9h033a/index.html\" rel=\"nofollow noreferrer\">here</a> for more details.</p>\n"}, {"comments": [{"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1545923082, "post_id": 53851378, "comment_id": 94732422, "body": "+1 on your answer. Here&#39;s a couple ideas for improvements: mentioning the async-signal-safe <a href=\"http://man7.org/linux/man-pages/man2/getpid.2.html\" rel=\"nofollow noreferrer\"><code>getpid(2)</code></a> or <a href=\"http://man7.org/linux/man-pages/man3/pthread_self.3.html\" rel=\"nofollow noreferrer\"><code>pthread_self</code></a> functions to get idea of thread handler is being invoked for; mentioning how Ctrl-C is typically handled by a shell, process groups, and the <a href=\"http://man7.org/linux/man-pages/man2/kill.2.html\" rel=\"nofollow noreferrer\"><code>kill(2)</code></a> function with negative PIDs."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1545924646, "post_id": 53851378, "comment_id": 94733057, "body": "Thanks... I will check them and see if I can improve it."}], "tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": true, "score": 6, "last_activity_date": 1564760705, "last_edit_date": 1564760705, "creation_date": 1545222836, "answer_id": 53851378, "question_id": 53850202, "link": "https://stackoverflow.com/questions/53850202/signal-handler-and-multithreading/53851378#53851378", "title": "signal handler and multithreading", "body": "<p><strong>INTRODUCTION</strong></p>\n\n<p>First of all each thread has its own mask that specifies which signals it is listening to. When a thread is created it inherits the mask of the thread that is creating it (let me call it the <em>parent thread)</em> that is active when <code>pthread_create</code> is called. </p>\n\n<p>Generally it is better that if a thread is listening to a signal then the others should not, unless you want to have many threads that do the same stuff (for example when processing a connection request in a server to process many requests simultaneously). In this way you always know which thread is processing the signal. Otherwise you do not have any idea which thread is receiving the signal and which part of the program is executing: it becomes impossible to debug (an example is your own question). </p>\n\n<p>To <strong>change the mask</strong> of the <em>child thread</em> that is being created from the <em>parent thread</em> you create a new mask, you set it active, create a new thread with <code>pthread_create</code> and then in the <em>parent thread</em> set the previous mask active again (see the code at the end of the answer).</p>\n\n<p><strong>EDIT</strong>: According to <a href=\"https://stackoverflow.com/questions/231912/what-is-the-difference-between-sigaction-and-signal\">this post</a> it is better to use <code>sigaction()</code> instead of <code>signal</code>. In modern systems <code>signal()</code> is implemented with <code>sigaction()</code> so there should not be any difference. However if its old implementation is used, problems might arise.</p>\n\n<p><strong>ANSWER</strong></p>\n\n<blockquote>\n  <p>So signal only interrupt thread instead of the whole process if there\n  are multi-threading?</p>\n</blockquote>\n\n<p><strong>NO</strong>: Signals are just signals, they do not do anything. Actions associated to signals have the power to do stuff, including stopping the program or terminating the thread. Each signal has a default action associated and the default action for <code>SIGINT</code> is to interrupt the process.</p>\n\n<p>With you handler you are overwriting the default action. So it will not stop the program anymore but it will do what you have specified in the thread function.</p>\n\n<p>In the first case you have only one thread, the main one, which is an infinite loop, it always catches the signal as long as he is alive so that's why the behavior. If you resend the signal, the signal is momentarily blocked until the signal handler ends the execution. Nevertheless if many signals are sent while the handler is executing, you can loose some signals.\nIn fact as explained <a href=\"https://stackoverflow.com/questions/18442102/what-happens-when-a-signal-is-received-while-already-in-a-signal-handler\">here</a>, blocked signals are set to pending, but not queued. The term <em>pending</em> means that the operating system remembers that there is a signal waiting to be delivered at the next opportunity by setting a flag, and <em>not queued</em> means that it does this by setting a flag somewhere, but not by keeping an exact record of how many signals have arrived.\nSo if the signals is sent once, 5 times or more (try to press CTRL+C more times with your program: I have tried) while the signal handler is executing it produces the exactly same behaviour.</p>\n\n<p>In your second case you have 3 threads: the <code>main</code> one, <code>t1</code>, and <code>t2</code>: all of them are enabled to see the signal <code>SIGINT</code> and all of them have associated the same signal handler. If you press 3 times one after the other all three of them will execute the handler: that is why you don't see any delay. If you press very very fast though and more than 3 times (the number of threads listening to that signal) I think you will see something similar to the first behaviour.</p>\n\n<p>I will end my answer with <a href=\"https://stackoverflow.com/questions/48612546/how-to-terminate-threads-cleanly-in-c\">the code I posted in a question</a> where I was setting masks so that some signals were caught only by the main thread:</p>\n\n<pre><code>int main()\n{\n    int err;\n    sigset_t omask, mask;\n    pthread_t thread_motionSensor;\n    pthread_t thread_tempReading;\n    pthread_t thread_platformPost;\n\n    printf(\"Created threads IDs\\n\");\n\n    ...\n    if (signal(SIGINT, sig_handler)==SIG_ERR)\n        printf(\"Error on recording SIGINT HANDLER\\n\");\n\n    /*Create a new mask to block all signals for the following thread*/\n    sigfillset(&amp;mask);\n    pthread_sigmask(SIG_SETMASK, &amp;mask, &amp;omask);\n    printf(\"Trying to create threads\\n\");\n    if ((err = pthread_create (&amp;thread_motionSensor, NULL, task1, NULL))!=0)\n    {\n    printf(\"Thread 1 not created: error %d\\n\", err);\n        err_exit((const char)err, \"pthread_create error\");\n    }\n    printf(\"Thread 1 created. Trying to create Thread 2\\n\");\n    if((err = pthread_create (&amp;thread_tempReading,   NULL, task2, NULL))!=0)\n    {\n    printf(\"Thread 2 not created: error %d\\n\", err);\n        err_exit((const char)err, \"pthread_create error\");\n    }\n    printf(\"Thread 2 created. Trying to create Thread 3\\n\");\n    if ((err = pthread_create (&amp;thread_platformPost, NULL, task3, NULL))!=0)\n    {\n     printf(\"Thread 3 not created: error %d %d\\n\", err);\n         err_exit((const char)err, \"pthread_create error\");\n    }\n    printf(\"Thread 3 created\\n\");\n    /*The main thread must block the SIGALRM but catch SIGINT\n    SIGQUIT, SIGTERM, SIgkILL*/\n    /*empty the omask set from all signals */\n    sigemptyset(&amp;omask);\n    /*add the signals to the omask*/\n    sigaddset(&amp;omask, SIGINT);\n    sigaddset(&amp;omask, SIGQUIT);\n    sigaddset(&amp;omask, SIGKILL);\n    sigaddset(&amp;omask, SIGTERM);\n    /*unblock all signals in omask*/\n    pthread_sigmask(SIG_UNBLOCK, &amp;omask, NULL);\n    printf(\"Main thread waiting for signal\\n\");\n    /*pause will stop the main thread until any signal not blocked by omask will be received*/\n    pause();\n    printf(\"Exit signal received: cancelling threads\\n\");\n\n    pthread_cancel(thread_motionSensor);\n    pthread_cancel(thread_tempReading);\n    pthread_cancel(thread_platformPost);\n    pthread_join(thread_motionSensor, NULL);\n    pthread_join(thread_tempReading,  NULL);\n    pthread_join(thread_platformPost, NULL);\n    printf(\"Exiting from main thread and process\\n\");\n    exit(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 1, "accepted_answer_id": 53851378, "answer_count": 3, "score": 2, "last_activity_date": 1564760705, "creation_date": 1545218541, "question_id": 53850202, "link": "https://stackoverflow.com/questions/53850202/signal-handler-and-multithreading", "title": "signal handler and multithreading", "body": "<p>I know that signal is a way of communication between CPU and OS kernel. A signal can interrupt the sequence of instructions, execute the handler and go back to the sequence of instructions.</p>\n\n<p>Here is a piece of description of this <a href=\"https://www.ibm.com/developerworks/library/l-reent/index.html\" rel=\"nofollow noreferrer\">link</a>:</p>\n\n<blockquote>\n  <p>When a signal that is being caught is handled by a process, the normal\n  sequence of instructions being executed by the process is temporarily\n  interrupted by the signal handler. The process then continues\n  executing, but the instructions in the signal handler are now\n  executed. If the signal handler returns, the process continues\n  executing the normal sequence of instructions it was executing when\n  the signal was caught.</p>\n</blockquote>\n\n<p>Here is my test:</p>\n\n<pre><code>void func(int p)\n{\n    cout&lt;&lt;\"int\"&lt;&lt;endl;\n    sleep(5);\n}\n\nint main()\n{\n    signal(SIGINT, func);\n    while(1)\n    {\n        cout&lt;&lt;\"main\"&lt;&lt;endl;\n        sleep(2);\n    }   \n    return 0;\n}\n</code></pre>\n\n<p>I execute it and if I press <code>ctrl+C</code>, <code>int</code> will be printed and then I have to wait for 5 seconds, no matter how many times <code>ctrl+C</code> I pressed while waiting for the 5 seconds, nothing happened.</p>\n\n<p>Then I make another test:</p>\n\n<pre><code>void func(int p)\n{\n    cout&lt;&lt;\"int\"&lt;&lt;endl;\n    sleep(5);\n}\n\nint main()\n{\n    signal(SIGINT, func);\n    thread t1([](){while(1){cout&lt;&lt;\"t1\"&lt;&lt;endl; sleep(2);}});\n    thread t2([](){while(1){cout&lt;&lt;\"t2\"&lt;&lt;endl; sleep(2);}});\n    t1.join();\n    t2.join();\n\n    return 0;\n}\n</code></pre>\n\n<p>For this code, I found that I could press <code>ctrl+C</code> three times continually and three <code>int</code> would be printed, then I have to wait for about 5 seconds.</p>\n\n<p>So it seems that the first <code>ctrl+C</code> interrupts the <code>t1</code> thread, the second interrupts the <code>t2</code> thread and the third interrupts the main thread.</p>\n\n<p>So signal only interrupt thread instead of the whole process if there are multi-threading?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 1297, "user_id": 6074182, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/eea96ceabd30de865464b40ddbd2e64d?s=128&d=identicon&r=PG&f=1", "display_name": "Aemyl", "link": "https://stackoverflow.com/users/6074182/aemyl"}, "edited": false, "score": 0, "creation_date": 1545218705, "post_id": 53850089, "comment_id": 94547841, "body": "please insert the relevant code in this post, rather than just linking to it."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1545218949, "post_id": 53850089, "comment_id": 94547963, "body": "You need to add <code>#include &lt;string.h&gt;</code> otherwise <code>strtok</code> returns an int and you code does undefined behaviour and segfaults."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1545227591, "post_id": 53850089, "comment_id": 94552725, "body": "@KamilCuk Assuming standard C, the code won&#39;t compile if you forget to include a header."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12211554"}, "edited": false, "score": 0, "creation_date": 1589998508, "post_id": 53850089, "comment_id": 109518008, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/3831191/how-do-i-clear-an-array-in-c\">How do I clear an array in C?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 4, "last_activity_date": 1545218972, "creation_date": 1545218972, "answer_id": 53850296, "question_id": 53850089, "link": "https://stackoverflow.com/questions/53850089/clear-array-data-in-c/53850296#53850296", "title": "Clear array data in c", "body": "<p>You need to reset the <code>j</code> after processing each input.</p>\n\n<p>Otherwise your <code>array1</code> will have all the inputs.</p>\n\n<pre><code>for(i=0; i&lt;limit; i++)\n{\n\n    scanf(\"%s\",tree_input);\n    pch = strtok(tree_input, \",\");\n\n    while(pch!=NULL)\n    {\n        //printf(\"%s\\n\",pch);\n        array1[j]=atoi(pch); //atoi it\n        j++;\n        pch = strtok (NULL, \",\");\n    }\n    mergeSort(array1, 0, j - 1);\n    printArray(array1, j);\n    j=0; //Reset the j\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8955356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8437362b0277eb3d2be248d8a185fb2?s=128&d=identicon&r=PG&f=1", "display_name": "YellowBoy", "link": "https://stackoverflow.com/users/8955356/yellowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 53850296, "answer_count": 1, "score": 2, "last_activity_date": 1556351850, "creation_date": 1545218131, "last_edit_date": 1556351850, "question_id": 53850089, "link": "https://stackoverflow.com/questions/53850089/clear-array-data-in-c", "title": "Clear array data in c", "body": "<p>I write a program about merge sort. I have some problem with array things.</p>\n\n<p>The first line represents the amount of the input series. (Now i input 2, means have 2 input)</p>\n\n<pre><code>Input: 2\n9,5,6,7,1,8,3\n22,86,-5,8,66,9\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 3 5 6 7 8 9\n-5 1 3 5 6 7 8 8 9 9 22 66 86\n</code></pre>\n\n<p>How did i on the next second output the array no have the first input value <code>9,5,6,7,1,8,3</code> only have this second input <code>22,86,-5,8,66,9</code> </p>\n\n<p>Means that the output should be like</p>\n\n<pre><code>1 3 5 6 7 8 9\n-5 8 9 22 66 86\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// Merges two subarrays of arr[].\n// First subarray is arr[l..m]\n// Second subarray is arr[m+1..r]\nvoid merge(int arr[], int l, int m, int r)\n{\n    int i, j, k;\n    int n1 = m - l + 1;\n    int n2 =  r - m;\n\n    /* create temp arrays */\n    int L[n1], R[n2];\n\n    /* Copy data to temp arrays L[] and R[] */\n    for (i = 0; i &lt; n1; i++)\n        L[i] = arr[l + i];\n    for (j = 0; j &lt; n2; j++)\n        R[j] = arr[m + 1+ j];\n\n    /* Merge the temp arrays back into arr[l..r]*/\n    i = 0; // Initial index of first subarray\n    j = 0; // Initial index of second subarray\n    k = l; // Initial index of merged subarray\n    while (i &lt; n1 &amp;&amp; j &lt; n2)\n    {\n        if (L[i] &lt;= R[j])\n        {\n            arr[k] = L[i];\n            i++;\n        }\n        else\n        {\n            arr[k] = R[j];\n            j++;\n        }\n        k++;\n    }\n\n    /* Copy the remaining elements of L[], if there\n       are any */\n    while (i &lt; n1)\n    {\n        arr[k] = L[i];\n        i++;\n        k++;\n    }\n\n    /* Copy the remaining elements of R[], if there\n       are any */\n    while (j &lt; n2)\n    {\n        arr[k] = R[j];\n        j++;\n        k++;\n    }\n}\n\n/* l is for left index and r is right index of the\n   sub-array of arr to be sorted */\nvoid mergeSort(int arr[], int l, int r)\n{\n    if (l &lt; r)\n    {\n        // Same as (l+r)/2, but avoids overflow for\n        // large l and h\n        int m = l+(r-l)/2;\n\n        // Sort first and second halves\n        mergeSort(arr, l, m);\n        mergeSort(arr, m+1, r);\n\n        merge(arr, l, m, r);\n    }\n}\n\n/* UTILITY FUNCTIONS */\n/* Function to print an array */\nvoid printArray(int A[], int size)\n{\n    int i;\n    for (i=0; i &lt; size; i++)\n        printf(\"%d \", A[i]);\n    printf(\"\\n\");\n}\n\nint main()\n{\n\n    int limit,i;\n    //char *tree_input = malloc(1000*sizeof(char));\n    //int *array1 = malloc(1000 * sizeof(int));\n    char tree_input[1000];\n    int array1[1000]; //char also can?\n    int j=0;\n    char *pch;\n\n    printf(\"input the limit\\n\");\n    scanf(\"%d\",&amp;limit);\n\n    for(i=0; i&lt;limit; i++)\n    {\n\n        scanf(\"%s\",tree_input);\n        pch = strtok(tree_input, \",\");\n\n        while(pch!=NULL)\n        {\n            //printf(\"%s\\n\",pch);\n            array1[j]=atoi(pch); //atoi it\n            j++;\n            pch = strtok (NULL, \",\");\n        }\n        mergeSort(array1, 0, j - 1);\n        printArray(array1, j);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "serial-port", "raspberry-pi3"], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "is_accepted": true, "score": 2, "last_activity_date": 1545237620, "last_edit_date": 1545237620, "creation_date": 1545234692, "answer_id": 53854800, "question_id": 53849974, "link": "https://stackoverflow.com/questions/53849974/problem-with-parity-setting-in-serial-communication-on-raspberry-pi-in-c/53854800#53854800", "title": "Problem with Parity setting in Serial Communication on Raspberry PI in C", "body": "<p>ttyS0 on the Raspberry PI systems is the mini-uart, which does not support a parity bit.  See: <a href=\"https://www.raspberrypi.org/documentation/configuration/uart.md\" rel=\"nofollow noreferrer\">https://www.raspberrypi.org/documentation/configuration/uart.md</a></p>\n\n<p>The code you posted is otherwise basically correct.  I don't have an RPi accessible at the moment, but if the drivers are implemented correctly, you should be able to also verify correct application of the attributes by checking the return value of tcsetattr(), and also verifying the changes by checking the values set by tcgetattr(), as setattr may only indicate failure if NONE of the attributes are able to be set.</p>\n"}], "owner": {"reputation": 65, "user_id": 10754462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eecdc55e48b1321546b3d1080a1ab0f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob SO", "link": "https://stackoverflow.com/users/10754462/bob-so"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 53854800, "answer_count": 1, "score": 2, "last_activity_date": 1545237620, "creation_date": 1545217639, "last_edit_date": 1545218110, "question_id": 53849974, "link": "https://stackoverflow.com/questions/53849974/problem-with-parity-setting-in-serial-communication-on-raspberry-pi-in-c", "title": "Problem with Parity setting in Serial Communication on Raspberry PI in C", "body": "<p>I send the bytes from Raspberry PI and receive them on my laptop through the serial communication ports using a terminal program. The parameters of the communication are as follow:</p>\n\n<p>Baud rate: 9600, Data bits: 8, Parity: ODD, Stop bit: 1, Handshaking: None.</p>\n\n<p>After sending two bytes <code>{0x10, 0x05}</code> I receive on the terminal (in my laptop) <code>{0x10, 0xC1}</code>. I can receive the correct bytes only if I change parity on the terminal to NONE.</p>\n\n<p>How can I operate with my parity set to <code>ODD</code>?</p>\n\n<p>See my code bellow:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main()\n{\n\n    struct termios RSopt;\n    char str[3] = { 0x10, 0x05, 0x0};\n    int fd;\n    fd = open( \"/dev/ttyS0\", O_RDWR | O_NOCTTY | O_NDELAY );    \n\n    tcgetattr( fd, &amp;RSopt);\n    cfmakeraw( &amp;RSopt);\n    cfsetspeed ( &amp;RSopt, (speed_t)B9600);\n    RSopt.c_cflag &amp;= ~CSIZE;  \n    RSopt.c_cflag |= CS8;     \n    RSopt.c_cflag |= PARENB;  \n    RSopt.c_cflag |= PARODD; \n    RSopt.c_cflag &amp;= ~CSTOPB; \n    tcflush( fd, TCIFLUSH );\n    tcsetattr ( fd, TCSANOW, &amp;RSopt); \n\n    write( fd, str, 2 );\n    close( fd );\n\n}\n</code></pre>\n"}, {"tags": ["java", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1545213967, "post_id": 53848522, "comment_id": 94545214, "body": "What part in <code>java-1.5.0</code> is unclear? That JVM is 1.5, not 1.8. Why do you keep such an archaic JVM around?"}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1545220014, "post_id": 53848522, "comment_id": 94548500, "body": "<a href=\"http://jnicookbook.owsiak.org\" rel=\"nofollow noreferrer\">jnicookbook.owsiak.org</a> - take a look there in case you start your jurney with JNI ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 2, "creation_date": 1545230057, "post_id": 53850521, "comment_id": 94554178, "body": "Here&#39;s the why: the way it&#39;s written in your makefile the &quot;export&quot; line is a separate shell command. And after it finishes, its environment will be gone. To make this work inside the makefile you could either put the &quot;export&quot; outside the target definition or use <code>env</code> to set the environment in the same command as the hello_world call. If you want to set the variable only for the &quot;run&quot; target you&#39;d have to duplicate the target name with only the variable declaration <code>run: export LD_LIBRARY_PATH=...</code> (will delete my answer because I didn&#39;t read the question thoroughl enough)"}], "tags": [], "owner": {"reputation": 73, "user_id": 3474609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b435ca1c7a30335a9a8dc2984619d934?s=128&d=identicon&r=PG&f=1", "display_name": "lenxn", "link": "https://stackoverflow.com/users/3474609/lenxn"}, "is_accepted": false, "score": 0, "last_activity_date": 1545219814, "creation_date": 1545219814, "answer_id": 53850521, "question_id": 53848522, "link": "https://stackoverflow.com/questions/53848522/jni-api-call-resulting-in-jni-eversion-error/53850521#53850521", "title": "JNI API call resulting in JNI_EVERSION error", "body": "<p>I finally was able to get it running. Even though I don't know why, the <code>export LD_LIBRARY_PATH</code> command in the <code>Makefile</code> apparently didn't do its job. Upon checking the content of <code>LD_LIBRARY_PATH</code> on the command line I noticed that it contains</p>\n\n<pre><code>/usr/lib/jvm/java-1.5.0-gcj-6-amd64/lib\n</code></pre>\n\n<p>After setting</p>\n\n<pre><code>LD_LIBRARY_PATH=\"/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/server/\"\n</code></pre>\n\n<p>and rerunning <code>make</code>, I was able to launch the JVM</p>\n"}], "owner": {"reputation": 73, "user_id": 3474609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b435ca1c7a30335a9a8dc2984619d934?s=128&d=identicon&r=PG&f=1", "display_name": "lenxn", "link": "https://stackoverflow.com/users/3474609/lenxn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545219814, "creation_date": 1545212946, "question_id": 53848522, "link": "https://stackoverflow.com/questions/53848522/jni-api-call-resulting-in-jni-eversion-error", "title": "JNI API call resulting in JNI_EVERSION error", "body": "<p>I am having troubles getting the Java Native Interface (JNI) running on my OS. My minimal working example (derived from <a href=\"http://hildstrom.com/projects/jni/index.html\" rel=\"nofollow noreferrer\">here</a> and adjusted for my system) returns a version error, <strong>JNI_EVERSION (-3)</strong>, upon calling <code>JNI_CreateJavaVM()</code>. My c-file looks like</p>\n\n<pre><code>// hello_world.c\n#include &lt;stdio.h&gt;\n#include &lt;jni.h&gt;\n\nJNIEnv *create_vm(JavaVM **jvm)\n{\n  JNIEnv* env;\n  JavaVMInitArgs args;\n  JavaVMOption options;\n  args.version = JNI_VERSION_1_8;\n  args.nOptions = 1;\n  options.optionString = \"-Djava.class.path=./\";\n  args.options = &amp;options;\n  args.ignoreUnrecognized = 0;\n  int rv;\n  rv = JNI_CreateJavaVM(jvm, (void**)&amp;env, &amp;args);\n  if (rv &lt; 0 || !env)\n      printf(\"Unable to Launch JVM %d\\n\",rv);\n  else\n      printf(\"Launched JVM! :)\\n\");\n  return env;\n}\n\nint main(int argc, char *argv[])\n{\n  JavaVM *jvm;\n  JNIEnv *env;\n  env = create_vm(&amp;jvm);\n  return 0;\n}\n</code></pre>\n\n<p>and my Makefile like</p>\n\n<pre><code>all: run\n\nhelloWorld.class: helloWorld.java\n    /usr/bin/javac helloWorld.java\n\nhello_world: hello_world.c\n    gcc -o hello_world \\\n    -L /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/server/ \\\n    -ljvm \\\n    -I /usr/lib/jvm/java-8-openjdk-amd64/include/ \\\n    -I /usr/lib/jvm/java-8-openjdk-amd64/include/linux/ \\\n    hello_world.c\n\nrun: helloWorld.class hello_world\n    export LD_LIBRARY_PATH=\"/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/server/\"\n    ./hello_world\n\nclean:\n    rm -f helloWorld.class hello_world\n</code></pre>\n\n<p>The resulting output from <code>make</code> is</p>\n\n<pre><code>/usr/bin/javac helloWorld.java\ngcc -o hello_world \\\n-L /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/server/ \\\n-ljvm \\\n-I /usr/lib/jvm/java-8-openjdk-amd64/include/ \\\n-I /usr/lib/jvm/java-8-openjdk-amd64/include/linux/ \\\nhello_world.c\nexport LD_LIBRARY_PATH=\"/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/server/\"\n./hello_world\n./hello_world: /usr/lib/jvm/java-1.5.0-gcj-6-amd64/lib/libjvm.so: no version information available (required by ./hello_world)\nUnable to Launch JVM -3\n</code></pre>\n\n<p>The message \"Unable to Launch JVM -3\" is the program output with the JNI_EVERSION error. I think the line <code>/usr/lib/jvm/java-1.5.0-gcj-6-amd64/lib/libjvm.so: no version information available (required by ./hello_world)</code> gives a hint to the problem, but I do not really understand this issue and when I look into the shared object with <code>readelf -h /usr/lib/jvm/java-1.5.0-gcj-6-amd64/lib/libjvm.so</code> it features a line</p>\n\n<pre><code> Version:                           1 (current)\n</code></pre>\n"}, {"tags": ["c", "linux", "yocto"], "comments": [{"owner": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1545211659, "post_id": 53847959, "comment_id": 94543772, "body": "Can you show the makefile? It seems like you&#39;re not linking it in your makefile."}, {"owner": {"reputation": 93, "user_id": 2156513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf485a233e7e9bb78fb55ce5ee2382a6?s=128&d=identicon&r=PG", "display_name": "user2156513", "link": "https://stackoverflow.com/users/2156513/user2156513"}, "reply_to_user": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1545211732, "post_id": 53847959, "comment_id": 94543809, "body": "snippet of my CMakelists.txt:                                                                                # specify libraries to link target_link_libraries(${PROJECT_NAME}     ${SDK_SERVER_LIBRARIES}     ${SDK_BASE_LIBRARIES}     ${OS_LIBS} ${SDK_SYSTEM_LIBS}     curl     json-c )"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1545212398, "post_id": 53847959, "comment_id": 94544241, "body": "Cjson is a completely different library from what you&#39;re using, btw."}, {"owner": {"reputation": 93, "user_id": 2156513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf485a233e7e9bb78fb55ce5ee2382a6?s=128&d=identicon&r=PG", "display_name": "user2156513", "link": "https://stackoverflow.com/users/2156513/user2156513"}, "edited": false, "score": 0, "creation_date": 1545212603, "post_id": 53847959, "comment_id": 94544370, "body": "i&#39;m using json-c..Can you please explain what u r saying ?"}, {"owner": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1545213758, "post_id": 53847959, "comment_id": 94545071, "body": "What he&#39;s saying is that in the post title you wrote <code>cjson</code> but according to the download link, it&#39;s <code>json-c</code> which is two different library. And the snippet doesn&#39;t really help clarify your problem. You should post the CMake to your question. At least the part where those variables are defined."}], "owner": {"reputation": 93, "user_id": 2156513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf485a233e7e9bb78fb55ce5ee2382a6?s=128&d=identicon&r=PG", "display_name": "user2156513", "link": "https://stackoverflow.com/users/2156513/user2156513"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1545214774, "answer_count": 0, "score": 0, "last_activity_date": 1545214499, "creation_date": 1545210975, "last_edit_date": 1545214499, "question_id": 53847959, "link": "https://stackoverflow.com/questions/53847959/not-able-to-compile-code-which-uses-json-c-library-functions-on-yocto-linux-os", "closed_reason": "Duplicate", "title": "Not able to compile code which uses json-c library functions on Yocto Linux OS", "body": "<p>I'm using some function like json_object_get_string etc in my code and have included <code>#include &lt;json-c/json.h&gt;</code> in my code.\nI downloaded cjson library from following link:\n<a href=\"https://s3.amazonaws.com/json-c_releases/releases/json-c-0.13.tar.gz\" rel=\"nofollow noreferrer\">https://s3.amazonaws.com/json-c_releases/releases/json-c-0.13.tar.gz</a></p>\n\n<p>I installed it after placing it in /usr/lib and following commands inside the library folder:</p>\n\n<ol>\n<li>./configure</li>\n<li>make</li>\n<li>make install</li>\n</ol>\n\n<p>Before installation of library,I was getting error in include statement, no such file or directory\nBut after installation, this error is gone but i get errors like: <code>Undefined reference to json_object_get_string</code> and all other functions that i have used.</p>\n\n<p>Can someone tell me if i'm missing something? do i need to install in some other way?</p>\n"}, {"tags": ["c", "allocation"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545211225, "post_id": 53847876, "comment_id": 94543532, "body": "I do just <code>bufsize += 1</code>. This <i>depens</i>. On system, environment, on usage, on program, on developer. Many libraries handle that differently, ex. see <a href=\"https://github.com/cs50/libcs50/blob/develop/src/cs50.c#L174\" rel=\"nofollow noreferrer\">cs50</a>. Ex. in C++ they just <code>new bufsize+1</code> -&gt; copy all the data -&gt; <code>delete old_storage</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1545211787, "post_id": 53847876, "comment_id": 94543855, "body": "Don&#39;t <code>realloc</code> with the pointer itself, use a temporary pointer, e.g. <code>void *tmp = realloc(buffer, bufsize * 2); if (!tmp) { perror (&quot;realloc-buffer&quot;); buffer[position] = &#39;\\0&#39;; break; } buffer = tmp; bufsize *= 2;</code> and keep going."}], "answers": [{"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1545211456, "post_id": 53847946, "comment_id": 94543661, "body": "Did I misunderstood the question?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545211462, "post_id": 53847946, "comment_id": 94543664, "body": "Clearly he wants to multiply the old result and get <code>1024 * 2 * 2 = 4096</code> and that&#39;s how it&#39;s done, ex. <a href=\"https://github.com/cs50/libcs50/blob/develop/src/cs50.c#L181\" rel=\"nofollow noreferrer\">cs50</a>. We can find many examples on github for such approach, see <a href=\"https://www.google.pl/search?q=%22capacity+%2A%3D+2%22+realloc+github\" rel=\"nofollow noreferrer\">google results</a>. The question is <code>What is the better way to expand the original space? bufsize += BUF_SIZE or bufsize *= 2?</code>."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545211622, "post_id": 53847946, "comment_id": 94543746, "body": "@KamilCuk I always believe memory re-allocation should be additional not exponential."}, {"owner": {"reputation": 1, "user_id": 9770081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7miqg.jpg?s=128&g=1", "display_name": "Shang-Chih Raphael Huang", "link": "https://stackoverflow.com/users/9770081/shang-chih-raphael-huang"}, "edited": false, "score": 0, "creation_date": 1545211763, "post_id": 53847946, "comment_id": 94543836, "body": "@kiranBiradar What&#39;s your reason?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545211830, "post_id": 53847946, "comment_id": 94543887, "body": "Me too ; ) As I usually work in embedded systems with very little memory, allocating 16 or 32 bytes makes <i>much</i> difference to me (if I have <code>malloc</code> at all). I do <code>bufsize += 1</code>. But that&#39;s an opinion. But on some systems <code>realloc</code> is so very expensive, that&#39;s it&#39;s better to allocate very big chunks once in a while."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1, "user_id": 9770081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7miqg.jpg?s=128&g=1", "display_name": "Shang-Chih Raphael Huang", "link": "https://stackoverflow.com/users/9770081/shang-chih-raphael-huang"}, "edited": false, "score": 0, "creation_date": 1545212100, "post_id": 53847946, "comment_id": 94544061, "body": "@Shang-ChihRaphaelHuang Consider you are short of memory fourth time and there is only one character to be read, with exponential you will be allocating 8192 bytes where as with additional you will be allocating 4096 bytes. That is again depends on your requirement. What do you want to care memory or performance."}, {"owner": {"reputation": 1, "user_id": 9770081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7miqg.jpg?s=128&g=1", "display_name": "Shang-Chih Raphael Huang", "link": "https://stackoverflow.com/users/9770081/shang-chih-raphael-huang"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545212797, "post_id": 53847946, "comment_id": 94544489, "body": "@kiranBiradar So it&#39;s a trade-off. I want to know whether there are some rules to guide programmers to make decision. @KamilCuk said right, that depends on the implementation of <code>realloc</code>."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": -1, "last_activity_date": 1545210908, "creation_date": 1545210908, "answer_id": 53847946, "question_id": 53847876, "link": "https://stackoverflow.com/questions/53847876/what-is-the-better-memory-allocation-method-in-c-when-the-input-data-exceed-the/53847946#53847946", "title": "What is the better memory allocation method in C when the input data exceed the original allocated space?", "body": "<p>What happens when you are reallocating 3rdth time and you have already allocated 2048 bytes memory at 2ndth time?</p>\n\n<pre><code>bufsize += BUF_SIZE; //this will be 2048 + 1024 =3072\nbufsize *= 2; // this will be 2048*2 = 4096\n</code></pre>\n\n<p>Where as you clearly  want to allocate <code>3072</code> bytes of memory.</p>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545215692, "post_id": 53848347, "comment_id": 94546218, "body": "Your <code>&#47;&#47;</code> comments in the <code>else</code> part effectively comment out the <code>}</code> closing brace."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545216278, "post_id": 53848347, "comment_id": 94546544, "body": "@pmg Which will not be a problem when you exchange the comment for suitable code."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1545216308, "last_edit_date": 1545216308, "creation_date": 1545212333, "answer_id": 53848347, "question_id": 53847876, "link": "https://stackoverflow.com/questions/53847876/what-is-the-better-memory-allocation-method-in-c-when-the-input-data-exceed-the/53848347#53848347", "title": "What is the better memory allocation method in C when the input data exceed the original allocated space?", "body": "<blockquote>\n  <p>Which way is more effective?</p>\n</blockquote>\n\n<p>This is a VERY ambiguous question. Effective with regard to what? Note that <em>performance</em> is not a good answer, since that is almost as ambiguous as \"effective\".</p>\n\n<p>You cannot say that one method is better than the other. Both have pros and cons and it depends to a large degree on the actual circumstances and the value of <code>BUF_SIZE</code>. </p>\n\n<p>Go with one or the other. If you experience performance issues, try the other method and try tweaking the value of <code>BUF_SIZE</code>. But before you do that, profile the code to see if the reallocation really is the issue.</p>\n\n<p>A third alternative is somewhere in between. You could do this:</p>\n\n<pre><code>bufsize = bufsize*log(bufsize);\nrealloc(buffer, bufsize);\n</code></pre>\n\n<p>A fourth is to use exponential growth until a threshold and then switch:</p>\n\n<pre><code>if(bufsize &gt; THRESHOLD)\n    bufsize += LINEAR_INCREASE;\nelse\n    bufsize *= 2;\n</code></pre>\n\n<p>One situation where pure exponential growth can cause problems is if you already have a very large buffer. Then the next reallocation may fail, or cause other problems.</p>\n\n<p>Also, remember to check that re reallocation (and the initial allocation too) actually worked by checking if the return pointer is NULL. And never assign the buffer to the return value. If the reallocation fails, you lose the current allocation too. You can do like this:</p>\n\n<pre><code>void * ptr = realloc(buffer, bufsize);\nif(ptr) buffer = ptr;\nelse { // Handle the fact that reallocation failed }\n</code></pre>\n\n<p>If you have very limited amount of memory, it could be a good idea to do something like this:</p>\n\n<pre><code>int increase = LINEAR_INCREASE;\nvoid * ptr;\ndo {\n    ptr = realloc(buffer, increase);\n    increase /= 2; // If realloc failed, try with half the increase\n} while(!ptr &amp;&amp; increase &gt; 0)\nif(ptr) buffer = ptr;\nelse { /* Handle the fact that reallocation failed */ }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9770081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7miqg.jpg?s=128&g=1", "display_name": "Shang-Chih Raphael Huang", "link": "https://stackoverflow.com/users/9770081/shang-chih-raphael-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1545213202, "answer_count": 2, "score": 0, "last_activity_date": 1545216308, "creation_date": 1545210689, "last_edit_date": 1545210914, "question_id": 53847876, "link": "https://stackoverflow.com/questions/53847876/what-is-the-better-memory-allocation-method-in-c-when-the-input-data-exceed-the", "closed_reason": "Duplicate", "title": "What is the better memory allocation method in C when the input data exceed the original allocated space?", "body": "<p>I know there is a common strategy in C to handle the situation that the input data, for example, text, exceed the original allocated space. That is reallocating with more space.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define BUF_SIZE 1024\n\nvoid check_buffer(char *buffer) \n{\n    if (!buffer) {\n        fprintf(stderr, \"lsh: allocation error\\n\");\n        exit(EXIT_FAILURE);\n    }\n}\n\nchar *read_line() \n{\n    int bufsize = BUF_SIZE;\n    int position = 0;\n    char *buffer = malloc(sizeof(char) * bufsize);\n    int c;\n\n    check_buffer(buffer);\n\n    while (1) {\n        c = getchar();\n\n        if (c == EOF || c == '\\n') {\n            buffer[position] = '\\0';\n            return buffer;\n        } else {\n            buffer[position] = c;\n        }\n        position++;\n\n        if (position &gt;= bufsize) {\n            bufsize += BUF_SIZE; // Or `bufsize *= 2;`?\n            buffer = realloc(buffer, bufsize);\n\n            check_buffer(buffer);\n        }\n    }\n}\n</code></pre>\n\n<p>So what is the better way to expand the original space? <code>bufsize += BUF_SIZE</code> or <code>bufsize *= 2</code>? Which way is more effective?</p>\n"}, {"tags": ["c++", "ios", "c"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1545209164, "post_id": 53847428, "comment_id": 94542442, "body": "You get a better readable enum set and you can use bits, e.g. to be send to low-level controlers, for easy testing, etc. See the comment that says <code>bitmask 0xFF</code>"}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 1, "creation_date": 1545209752, "post_id": 53847428, "comment_id": 94542739, "body": "May be of interest: <a href=\"https://stackoverflow.com/q/34904564/2442804\">stackoverflow.com/q/34904564/2442804</a> - basically: to be able to perform proper bitwise arithmetics."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545221455, "post_id": 53847428, "comment_id": 94549276, "body": "For anything dealing with bits, it is more convenient to use a base that is a power of 2 (which decimal, 10, isn&#39;t) since each digit in such a base represents an integer number of bits. In base 16 (hexadecimal), each digit corresponds to exactly 4 bits, and therefore a byte of 8 bits can be written in exactly two hexadecimal digits. Alternatively, for individual bits, the syntax <code>1 &lt;&lt; n</code> is often seen, where <code>n</code> denotes the number of the bit (zero being the least significant bit)."}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 0, "last_activity_date": 1545209213, "creation_date": 1545209213, "answer_id": 53847505, "question_id": 53847428, "link": "https://stackoverflow.com/questions/53847428/why-use-hexadecimal-instead-of-decimal-in-ios-enumeration/53847505#53847505", "title": "Why use hexadecimal instead of decimal in iOS enumeration\uff1f", "body": "<p>Answer option a:<br>\n Ask the author.</p>\n\n<p>Answer option b (my guess):<br>\n It is about readability as perceived by the author.<br>\nThey might consider values which are in the context/vicinity of a lower-byte bitmask (see inside the <code>()</code> in the comments) more readable in hex, even if they are not even passing the lowest nibble. In the context of a second set of values, which are in relation to a high-byte bit-mask and DO pass the lower byte, using hex for all of them is more conistent and hence helps readability.</p>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545210147, "post_id": 53847585, "comment_id": 94542982, "body": "For what you demonstrate, defining them with hex representation is not functionally necessary - if the value is the same, e.g. 256*1, 256*2, ..."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545213058, "post_id": 53847585, "comment_id": 94544649, "body": "@Yunnosch Nothing is <i>functionally necessary</i> if you want to write &quot;256*1, 256*2, ...&quot;"}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 0, "last_activity_date": 1545209480, "creation_date": 1545209480, "answer_id": 53847585, "question_id": 53847428, "link": "https://stackoverflow.com/questions/53847428/why-use-hexadecimal-instead-of-decimal-in-ios-enumeration/53847585#53847585", "title": "Why use hexadecimal instead of decimal in iOS enumeration\uff1f", "body": "<p>Using bit then you can combine multiple <code>enum</code>s by bitwise or <code>|</code> operation.</p>\n\n<p>This is useful when there are multiple orthogonal properties that can exist at the same time.</p>\n\n<p>For example, <code>YYTextLineStyleThick</code> | <code>YYTextLineStylePatternDot</code> will draw a thick line with dotted pattern.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10377910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f281156036a7701b90bb2e2dc251a640?s=128&d=identicon&r=PG&f=1", "display_name": "Dwyane", "link": "https://stackoverflow.com/users/10377910/dwyane"}, "edited": false, "score": 0, "creation_date": 1545211327, "post_id": 53847729, "comment_id": 94543584, "body": "Thank you. How about using the following bit operation?       YYTextAttributeTypeUIKit    = 1 &lt;&lt; 0,  YYTextAttributeTypeCoreText = 1 &lt;&lt; 1,"}], "tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": false, "score": 2, "last_activity_date": 1545210079, "last_edit_date": 1592644375, "creation_date": 1545210079, "answer_id": 53847729, "question_id": 53847428, "link": "https://stackoverflow.com/questions/53847428/why-use-hexadecimal-instead-of-decimal-in-ios-enumeration/53847729#53847729", "title": "Why use hexadecimal instead of decimal in iOS enumeration\uff1f", "body": "<p>It just usable to see the bits:</p>\n<h3>in hex format you can see the bits easily:</h3>\n<p>0x0100 | 0x11 = 0x0111</p>\n<h3>in decimal you don't:</h3>\n<p>256 | 17 = 273</p>\n"}], "owner": {"reputation": 13, "user_id": 10377910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f281156036a7701b90bb2e2dc251a640?s=128&d=identicon&r=PG&f=1", "display_name": "Dwyane", "link": "https://stackoverflow.com/users/10377910/dwyane"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1545214920, "answer_count": 3, "score": 0, "last_activity_date": 1545210079, "creation_date": 1545208892, "last_edit_date": 1545209363, "question_id": 53847428, "link": "https://stackoverflow.com/questions/53847428/why-use-hexadecimal-instead-of-decimal-in-ios-enumeration", "closed_reason": "Opinion-based", "title": "Why use hexadecimal instead of decimal in iOS enumeration\uff1f", "body": "<pre><code>typedef NS_OPTIONS (NSInteger, YYTextLineStyle) {\n// basic style (bitmask:0xFF)\nYYTextLineStyleNone       = 0x00, ///&lt; (        ) Do not draw a line (Default).\nYYTextLineStyleSingle     = 0x01, ///&lt; (\u2500\u2500\u2500\u2500\u2500\u2500) Draw a single line.\nYYTextLineStyleThick      = 0x02, ///&lt; (\u2501\u2501\u2501\u2501\u2501\u2501\u2501) Draw a thick line.\nYYTextLineStyleDouble     = 0x09, ///&lt; (\u2550\u2550\u2550\u2550\u2550\u2550) Draw a double line.\n\n// style pattern (bitmask:0xF00)\nYYTextLineStylePatternSolid      = 0x000, ///&lt; (\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500) Draw a solid line (Default).\nYYTextLineStylePatternDot        = 0x100, ///&lt; (\u2011 \u2011 \u2011 \u2011 \u2011 \u2011) Draw a line of dots.\nYYTextLineStylePatternDash       = 0x200, ///&lt; (\u2014 \u2014 \u2014 \u2014) Draw a line of dashes.\nYYTextLineStylePatternDashDot    = 0x300, ///&lt; (\u2014 \u2011 \u2014 \u2011 \u2014 \u2011) Draw a line of alternating dashes and dots.\nYYTextLineStylePatternDashDotDot = 0x400, ///&lt; (\u2014 \u2011 \u2011 \u2014 \u2011 \u2011) Draw a line of alternating dashes and two dots.\nYYTextLineStylePatternCircleDot  = 0x900, ///&lt; (\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022) Draw a line of small circle dots.\n};\n</code></pre>\n\n<p>This code is what I see on a framework, generally enumerated values use decimal, but this code use hexadecimal, what is the benefit?</p>\n"}, {"tags": ["c", "struct", "c-preprocessor"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1545208786, "post_id": 53847326, "comment_id": 94542265, "body": "I have a superstitious skepticism about using <code>#define</code> within <code>{}</code>. What is your intended effect of placing them there?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1545208903, "post_id": 53847326, "comment_id": 94542308, "body": "dump the <code>#define</code>. Write it out long hand - makes it readable for a start."}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1545209506, "post_id": 53847326, "comment_id": 94542637, "body": "I don&#39;t quite understand what you are saying,  my intent to put #define XYZ(x,y,z) .. is to indicate that this macro is only and only used to init this structure (within which it is defined) and i intend to include a header file with all macro definitions X(1,2,3).. and so on. This is just a concept i intend to use in a bigger work project."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1545210722, "post_id": 53847326, "comment_id": 94543283, "body": "@CodeTry: since you are mentioning &quot;huge arrays&quot;, one approach might be to write a script which will generate the source with the appropriate data for you during build (or even one-time invoke). That&#39;s far more efficient and less error prone than writing hundreds of numbers manually."}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1545215632, "post_id": 53847326, "comment_id": 94546181, "body": "I agree, and so far what i have done is written a python script to parse the data to dump to header file in Xmacro format x(1,2,3,...) . And then i lam trying to load my arrays during preprocessing. I only added a sample code to highlight the exact problem but then as StoryTeller tells me its not much gain w.r.t to time."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545227057, "post_id": 53847326, "comment_id": 94552388, "body": "What is the actual problem you are trying to solve?"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1545209228, "post_id": 53847413, "comment_id": 94542483, "body": "Thanks , and i already know the reason why they become zero . I wanted to ask if theres any macro trick that can do away with that  so that it does not put zero there but the last value from the earlier macro call."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 1, "creation_date": 1545209314, "post_id": 53847413, "comment_id": 94542528, "body": "@CodeTry - This is a rabbit hole you don&#39;t want to go into. Honestly, the cost/benefit ratio just isn&#39;t worth it to make the preprocessor do this."}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1545209566, "post_id": 53847413, "comment_id": 94542663, "body": "Okay , got it. Thanks again."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1545208807, "creation_date": 1545208807, "answer_id": 53847413, "question_id": 53847326, "link": "https://stackoverflow.com/questions/53847326/initializing-structure-using-macros/53847413#53847413", "title": "initializing structure using macros", "body": "<p>This is a case where turning on warnings would have helped you. Compiling your code with GCC gives me this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>main.cpp:8:40: warning: initialized field overwritten [-Woverride-init]\n                 #define XYZ(x,y,z) [x]={.a[y][z]=1,.b[y][z]=1},\n                                        ^\nmain.cpp:10:18: note: in expansion of macro 'XYZ'\n                  XYZ(1,3,2)\n                  ^~~\nmain.cpp:8:40: note: (near initialization for 'q_abc[1]')\n                 #define XYZ(x,y,z) [x]={.a[y][z]=1,.b[y][z]=1},\n                                        ^\nmain.cpp:10:18: note: in expansion of macro 'XYZ'\n                  XYZ(1,3,2)\n</code></pre>\n\n<p>And for good reason. A brace initializer will initialize <em>all the fields</em>, even if you omit explicit initializers for some (those will be zero). By writing <code>X(1,..) X(1,...)</code> you initialize the same index twice. You can't split it into two macro expansions like you try. It must be in a single one, if you really wish to use a macro.</p>\n\n<p>Personally, I wouldn't faff about with macros. Designated initializers make the code readable enough even without hiding them behind a macro.</p>\n"}], "owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545287414, "creation_date": 1545208460, "last_edit_date": 1545287414, "question_id": 53847326, "link": "https://stackoverflow.com/questions/53847326/initializing-structure-using-macros", "title": "initializing structure using macros", "body": "<p>I have a structure and i am using preprocessing macro to populate the arrays in struct. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid init_data();\ntypedef struct _abc{\n        int a[10][10];\n        int b[5][5];\n}abc;\nstatic abc q_abc[]= {\n                #define XYZ(x,y,z) [x]={.a[y][z]=1,.b[y][z]=1},\n                 XYZ(1,2,3)\n                 XYZ(1,3,2)\n\n};\nstatic abc q_abc1[5];\nvoid init_data()\n{\n #define XYZW(x,y,z) q_abc1[x].a[y][z] =1;\n  XYZW(1,2,3)\n  XYZW(1,3,2)\n}\nint main()\n{\n        printf(\"\\n  %d  %d\\n\",q_abc[1].a[2][3]);\n        init_data();\n        printf(\"\\n %d  %d\\n\",q_abc1[1].a[2][3]);\n        return 0;\n}\n</code></pre>\n\n<p>I am initializing  struct <code>q_abc</code> using macro. But the problem here is value set during macro call to  <code>XYZ(1,2,3)</code> is reset to the default 0 during call to next macro call <code>XYZ(1,3,2)</code>. I can understand as not specifying any explicit initializer will set the array to the default 0.</p>\n\n<p>To avoid this I used the <code>init_data</code> approach .Here i am not initializing the array but assigning, so arrays will have all the values from all macro calls intact. but then problem here is , if data is huge or number of macro calls are huge, the func call will take little time to complete which adds an overhead to my exe run time.</p>\n\n<p>is there any way to achieve <code>init_data</code> sort of behavior during variable definition itself ? any suggestions ?</p>\n"}, {"tags": ["c++", "c", "macros"], "comments": [{"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 1, "creation_date": 1545216554, "post_id": 53847219, "comment_id": 94546687, "body": "BTW, if you want to count the number of variadic arguments for more than 10, <code>#define CV_VA_NUM_ARGS(...) std::tuple_size&lt;decltype(std::make_tuple(__VA_ARGS__))&gt;::val&zwnj;&#8203;ue</code> works in C++11."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 0, "creation_date": 1545224474, "post_id": 53847219, "comment_id": 94550922, "body": "@Hiroki: generally, it is done to dispatch on other MACRO depending of argument count, so this way &quot;fail&quot;"}, {"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1545313181, "post_id": 53847219, "comment_id": 94586568, "body": "@Jarod42 thx but I still do not well understand your comment. Assuming <a href=\"https://wandbox.org/permlink/Q9PZAyprPPPE3QWd\" rel=\"nofollow noreferrer\">such use cases</a>, I commented on the above line. So what does your \u201cfail\u201d mean? Since I know that you are a great C++ programmer through my this 2 months SO life, I want to understand precisely what you are saying with examples and learn from you :)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 0, "creation_date": 1545314372, "post_id": 53847219, "comment_id": 94587245, "body": "@Hiroki: I meant iterate over variadic MACRO as for <a href=\"https://stackoverflow.com/a/43194701/2684539\">example</a>,"}, {"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1545316007, "post_id": 53847219, "comment_id": 94588176, "body": "@Jarod42 Ah I see. many thx!"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1545210786, "last_edit_date": 1545210786, "creation_date": 1545208199, "answer_id": 53847249, "question_id": 53847219, "link": "https://stackoverflow.com/questions/53847219/count-number-of-variadic-arguments-in-macro-function/53847249#53847249", "title": "Count number of variadic arguments in macro function", "body": "<p><code>_1</code> to <code>_10</code> are just placeholders from the start in order to make sure <code>N</code> is positioned over the correct number from <code>10</code> to <code>0</code> (depending on <code>__VA_ARGS__</code>). They serve no purpose other than occupying a position.</p>\n\n<p>Since each macro parameter must have a distinct identifier, those identifiers are as good as any.</p>\n\n<hr>\n\n<p>Regarding your edit, that is limitation of the preprocessor. An empty token sequence is a valid argument to a macro. So it really is a single argument, because <code>__VA_ARGS__ ,</code> (note the comma) becomes such an argument.</p>\n\n<p>It's quite a known issue, so much so that C++20 added the <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0306r4.html\" rel=\"nofollow noreferrer\"><code>__VA_OPT__</code></a> preprocessor macro. It allows to add the comma conditionally. On C++20, the implementation can be fixed to work as expected like this:</p>\n\n<pre><code>#define CV_VA_NUM_ARGS(...)      CV_VA_NUM_ARGS_HELPER(__VA_ARGS__ __VA_OPT__(,) 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1545209931, "creation_date": 1545209931, "answer_id": 53847685, "question_id": 53847219, "link": "https://stackoverflow.com/questions/53847219/count-number-of-variadic-arguments-in-macro-function/53847685#53847685", "title": "Count number of variadic arguments in macro function", "body": "<p>There is nothing special about <code>_1</code>, <code>_2</code> etc. You can have <code>i</code>, <code>j</code>, <code>k</code> in their place.</p>\n\n<p>The value of N depends on the number of arguments you have passed because N becomes the 11th element in the macro expansion (because of the 10 place holders). </p>\n\n<p>So for <code>CV_VA_NUM_ARGS(a,b,c)</code>, the 11th element is 3.\nFor <code>CV_VA_NUM_ARGS(a,b,c,d,e,f)</code>, the 11th element is 6 and so on.</p>\n\n<p>Note that with this particular code you can count only up to 10 arguments. Using more than 10 arguments will generate a compiler error.</p>\n"}], "owner": {"reputation": 528, "user_id": 8110010, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1enq4.jpg?s=128&g=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/8110010/finley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 1, "accepted_answer_id": 53847249, "answer_count": 2, "score": 2, "last_activity_date": 1545210786, "creation_date": 1545208056, "last_edit_date": 1545210139, "question_id": 53847219, "link": "https://stackoverflow.com/questions/53847219/count-number-of-variadic-arguments-in-macro-function", "title": "Count number of variadic arguments in macro function", "body": "<p>Here are two lines I saw in OpenCV</p>\n\n<pre><code>#define CV_VA_NUM_ARGS_HELPER(_1, _2, _3, _4, _5, _6, _7, _8, _9, _10, N, ...)    N\n#define CV_VA_NUM_ARGS(...)      CV_VA_NUM_ARGS_HELPER(__VA_ARGS__, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)\n</code></pre>\n\n<p>I guess it is to count the number of variadic  arguments passing to <code>CV_VA_NUM_ARGS</code>. Take following code for example:</p>\n\n<pre><code>CV_VA_NUM_ARGS(a,b,c)\n</code></pre>\n\n<p>will be extended to</p>\n\n<pre><code>CV_VA_NUM_ARGS_HELPER(a,b,c,10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)\n</code></pre>\n\n<p>At this point, I am stuck on understanding what is going on. Concretely, <strong>I don't know the utility of <code>_1</code>,<code>_2</code>,etc.</strong> Can anyone help me out? Here is a similar <a href=\"https://stackoverflow.com/questions/11317474/macro-to-count-number-of-arguments\">post</a> while more complex to me.</p>\n\n<p><strong>EDIT:</strong>\nWhen I pass no arguments(say <code>CV_VA_NUM_ARGS_HELPER()</code>), the macro will be replaced by 1 instead of 0, why is that?</p>\n"}, {"tags": ["c++", "c", "linux", "raspberry-pi", "beagleboneblack"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9763635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f683b2d0504cd09a5ce354524a3f472?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoub", "link": "https://stackoverflow.com/users/9763635/ayoub"}, "edited": false, "score": 0, "creation_date": 1545209754, "post_id": 53847189, "comment_id": 94542740, "body": "can you tell me exactly what to do to deactivate I&#178;C? or how can I enable the CTS and RTS pins for UART1 and UART4? because i know how to count on the pins 0x178 and 0x17c and how to set the mode I only know that I have the pins:  P9_20 (Mode 0 for CTS UART1),   P9_19 (Mode 0 for RTS UART1),   P8_35 (Mode 6 for CTS UART4),   P8_33 (Mode 6 for RTS UART4),"}, {"owner": {"reputation": 11, "user_id": 9763635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f683b2d0504cd09a5ce354524a3f472?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoub", "link": "https://stackoverflow.com/users/9763635/ayoub"}, "edited": false, "score": 0, "creation_date": 1545211884, "post_id": 53847189, "comment_id": 94543930, "body": "are the pins in the code piece what you wrote, are they now set for UART or for I&#178;C?"}, {"owner": {"reputation": 11, "user_id": 9763635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f683b2d0504cd09a5ce354524a3f472?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoub", "link": "https://stackoverflow.com/users/9763635/ayoub"}, "edited": false, "score": 0, "creation_date": 1545221034, "post_id": 53847189, "comment_id": 94549047, "body": "I did that and also restarted Beaglebone, but I still have the same error messages: Pin is not modifyable: P9_20 i2c2_sda, Pin is not modifyable: P9_19 i2c2_scl, Invalid mode: uart (for pin P8_35), Invalid mode: uart (for pin P8_33)"}, {"owner": {"reputation": 11, "user_id": 9763635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f683b2d0504cd09a5ce354524a3f472?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoub", "link": "https://stackoverflow.com/users/9763635/ayoub"}, "edited": false, "score": 0, "creation_date": 1545231883, "post_id": 53847189, "comment_id": 94555294, "body": "I made the changes in am335x-bone-common.dtsi should compile this and put it somewhere? so that I notice the changes?                                                          When I try to compile the file with <code>dtc -O dtb -o am335x-bone-common.dtb -b 0 -@ am335x-bone-common.dtsi</code> but I get the error:                                                                                                                <code>Error: am335x-bone-common.dtsi: 9.1-2 syntax error</code>                                        <code>FATAL ERROR: Unable to parse input tree</code>"}], "tags": [], "owner": {"reputation": 394, "user_id": 3264375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3958029becfe0d27b76e56aa3371c3?s=128&d=identicon&r=PG", "display_name": "erenbasturk", "link": "https://stackoverflow.com/users/3264375/erenbasturk"}, "is_accepted": false, "score": 0, "last_activity_date": 1545217000, "last_edit_date": 1545217000, "creation_date": 1545207934, "answer_id": 53847189, "question_id": 53847046, "link": "https://stackoverflow.com/questions/53847046/how-can-i-enable-rts-and-cts-pin-on-beanglebone-black-kernel-4-1-15-ti-rt-r43/53847189#53847189", "title": "How can i enable RTS and CTS pin on Beanglebone Black Kernel 4.1.15-ti-rt-r43?", "body": "<p>It is an expected behaviour. If you revise the am335x-bone-common.dtsi file. You will see that if the i2c is enabled. You can not use uart1 rts and cts pin. So that, you should disable the i2c or assign to other pins then, you should mux the cts and rts pin in the pin muxing. </p>\n\n<pre><code>i2c2_pins: pinmux_i2c2_pins {\n        pinctrl-single,pins = &lt;\n            0x178 (PIN_INPUT_PULLUP | MUX_MODE3)    /* uart1_ctsn.i2c2_sda */\n            0x17c (PIN_INPUT_PULLUP | MUX_MODE3)    /* uart1_rtsn.i2c2_scl */\n        &gt;;\n    };\n</code></pre>\n\n<p><code>https://github.com/beagleboard/linux/blob/4.1/arch/arm/boot/dts/am335x-bone-common.dtsi</code></p>\n\n<p>in the .dts file disable i2c2 like that</p>\n\n<pre><code>&amp;i2c2 {\n    status = \"disabled\";\n};\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9763635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f683b2d0504cd09a5ce354524a3f472?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoub", "link": "https://stackoverflow.com/users/9763635/ayoub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545217106, "creation_date": 1545207275, "last_edit_date": 1545217106, "question_id": 53847046, "link": "https://stackoverflow.com/questions/53847046/how-can-i-enable-rts-and-cts-pin-on-beanglebone-black-kernel-4-1-15-ti-rt-r43", "title": "How can i enable RTS and CTS pin on Beanglebone Black Kernel 4.1.15-ti-rt-r43?", "body": "<p>To activate the RTS and CTS pins on Beaglebone, I followed several routes, but unfortunately I did not get any further.</p>\n\n<p>1) the activation of the RXD and TXD was easier.\nI entered the command at uEnv.txt:</p>\n\n<pre><code>root@beaglebone:/boot# nano uEnv.txt\ncmdline=coherent_pool=1M quiet cape_universal=enable\ndtb=am335x-boneblack-emmc-overlay.dtb\n</code></pre>\n\n<p>then I can directly activate the pins in the code</p>\n\n<pre><code>//UART1\nsystem(\"config-pin P9.26 uart\"); // RXD\nsystem(\"config-pin P9.24 uart\"); // TXD\n// UART4\nsystem(\"config-pin P9.11 uart\"); // RXD\nsystem(\"config-pin P9.13 uart\"); // TXD\n</code></pre>\n\n<p>if I want to activate a RTS or a CTS pin with this way,</p>\n\n<pre><code>system(\"config-pin P9.20 uart\"); // CTS\n</code></pre>\n\n<p>I get the error message</p>\n\n<pre><code>Pin is not modifyable: P9_20 i2c2_sda\n</code></pre>\n\n<p>information:</p>\n\n<pre><code>root@beaglebone:~# config-pin -l P9_20\nPin is not modifyable: P9_20 i2c2_sda\n</code></pre>\n\n<p>2) I also used a second way, I commented on the komand at uEnv.txt.</p>\n\n<pre><code># cmdline = coherent_pool = 1M quiet cape_universal = enable\n</code></pre>\n\n<p>\u00a0 I restarted Beaglebone and prepared that:</p>\n\n<pre><code>root@beaglebone:/lib/firmware# cat $SLOTS\n 0: PF----  -1\n 1: PF----  -1\n 2: PF----  -1\n 3: PF----  -1\n 4: P-O-L-   0 Override Board Name,00A0,Override Manuf,BB-UART4\n 5: P-O-L-   1 Override Board Name,00A0,Override Manuf,BB-UART1\n 6: P-O-L-   2 Override Board Name,00A0,Override Manuf,BB-UART4-RTSCTS\n 7: P-O-L-   3 Override Board Name,00A0,Override Manuf,BB-UART1-RTSCTS\n</code></pre>\n\n<p>in this case, my code hangs at read function, which responds to code as if UART is not enabled</p>\n\n<p>3) I also tried the command before</p>\n\n<pre><code>capemgr.enable_partno=BB-UART1,BB-UART4\n</code></pre>\n\n<p>my code also hangs in the read function.</p>\n\n<p>Can someone say what should I do?</p>\n"}, {"tags": ["c", "linux", "gcc", "compilation"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1545201885, "post_id": 53845771, "comment_id": 94539307, "body": "Just for test.c."}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 6, "last_activity_date": 1545202414, "creation_date": 1545202414, "answer_id": 53846013, "question_id": 53845771, "link": "https://stackoverflow.com/questions/53845771/would-gcc-o-take-effect-for-linked-static-library/53846013#53846013", "title": "Would gcc -O take effect for linked static library?", "body": "<p><code>-O2</code> is a <strong>compilation</strong> flag. The only input you're compiling in this example is <code>test.c</code>. <code>mystaticlib.a</code> is not compiled, but rather <strong>linked</strong> with the compilation output of <code>test.c</code> to create the executable <code>test</code>. Since <code>mystaticlib.a</code> isn't compiled here, the <code>-O2</code> flag does not affect it.</p>\n"}], "owner": {"reputation": 51, "user_id": 2223024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ueqF.jpg?s=128&g=1", "display_name": "nonkr", "link": "https://stackoverflow.com/users/2223024/nonkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1545317267, "creation_date": 1545201296, "last_edit_date": 1545317267, "question_id": 53845771, "link": "https://stackoverflow.com/questions/53845771/would-gcc-o-take-effect-for-linked-static-library", "title": "Would gcc -O take effect for linked static library?", "body": "<p>such as:</p>\n\n<pre><code>gcc test.c mystaticlib.a -o test -O2\n</code></pre>\n\n<p>would <code>-O2</code> take effect for <code>mystaticlib.a</code>, or just <code>test.c</code>?</p>\n"}, {"tags": ["c++", "c", "clang", "covariance"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1545198577, "post_id": 53845245, "comment_id": 94538130, "body": "Whatever calling convention that is might not support varargs?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545200524, "post_id": 53845436, "comment_id": 94538742, "body": "Thnaks but I have tried by removing EFIABI but its not working."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545200543, "post_id": 53845436, "comment_id": 94538753, "body": "And what happens <i>then</i>?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545201314, "post_id": 53845436, "comment_id": 94539074, "body": "Then the compiler is set to have a <i>default calling convention</i> I guess"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545208374, "post_id": 53845436, "comment_id": 94542088, "body": "So, I guess you need to specify <i>another</i> calling convention here manually."}, {"owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545208925, "post_id": 53845436, "comment_id": 94542318, "body": "yeah in addition to this error i&#39;m getting &quot;error:SSE register return with SSE disabled&quot;."}, {"owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545208960, "post_id": 53845436, "comment_id": 94542340, "body": "Can you help in this too?"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 0, "last_activity_date": 1545199575, "creation_date": 1545199575, "answer_id": 53845436, "question_id": 53845245, "link": "https://stackoverflow.com/questions/53845245/error-va-start-used-in-win64-abi-funtion-getting-thi-seero-in-clang-help-me-t/53845436#53845436", "title": "error: &quot;va_start&quot; used in Win64 ABI funtion getting thi seero in clang help me to solve this?", "body": "<p>Since your function is <code>static</code> <em>and</em> I doubt you're passing it anywhere as an argument, I believe you can just remove <code>EFIABI</code> here (and in the declaration). <code>EFIABI</code> is a 4-register calling convention for which GCC seemingly does not support variable arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545221356, "post_id": 53847945, "comment_id": 94549229, "body": "yeah its working thank you.can you please help in this also &quot;error:SSE register return with SSE disabled&quot;. on below line"}, {"owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545221405, "post_id": 53847945, "comment_id": 94549251, "body": "double difftime(time_t time1, time_t time0) {   return (double)(time1 - time0); }"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "edited": false, "score": 0, "creation_date": 1545298296, "post_id": 53847945, "comment_id": 94578987, "body": "<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1545210906, "creation_date": 1545210906, "answer_id": 53847945, "question_id": 53845245, "link": "https://stackoverflow.com/questions/53845245/error-va-start-used-in-win64-abi-funtion-getting-thi-seero-in-clang-help-me-t/53847945#53847945", "title": "error: &quot;va_start&quot; used in Win64 ABI funtion getting thi seero in clang help me to solve this?", "body": "<p><code>va_*</code> are explicitly ban by clang, per <a href=\"http://lists.llvm.org/pipermail/llvm-dev/2016-April/098578.html\" rel=\"nofollow noreferrer\">here</a>. Use the builtins if you want to \"cross-compile\" between linux and windows targets, per <a href=\"http://clang-developers.42468.n3.nabble.com/Is-it-a-va-arg-bug-in-clang-td4049311.html\" rel=\"nofollow noreferrer\">here</a>, also add <code>__attribute__((ms_abi))</code>, otherwise it will not work either, see <a href=\"https://github.com/Microsoft/clang/blob/master/test/Sema/varargs-x86-64.c\" rel=\"nofollow noreferrer\">these tests</a>.</p>\n\n<pre><code>static int\n__attribute__((ms_abi))\nva_Utimes(\n  const char   *path,\n  ...\n  )\n{\n  __builtin_ms_va_list ap;\n\n  __builtin_ms_va_start(ap, path);\n  retval = ...ioctl( filp, FIOSETIME, ap);\n  __builtin_ms_va_end(ap);\n\n  return retval;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9814942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a06a64aed0c61aae04786dfd560bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Rkm.Tony", "link": "https://stackoverflow.com/users/9814942/rkm-tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53845436, "answer_count": 2, "score": -1, "last_activity_date": 1546845487, "creation_date": 1545198288, "last_edit_date": 1546845487, "question_id": 53845245, "link": "https://stackoverflow.com/questions/53845245/error-va-start-used-in-win64-abi-funtion-getting-thi-seero-in-clang-help-me-t", "title": "error: &quot;va_start&quot; used in Win64 ABI funtion getting thi seero in clang help me to solve this?", "body": "<p>I have compiled but while compiling with CLANG in ubuntu im getting error like this error: \"va_start\" used in Win64 ABI funtion. can anyone help me?</p>\n"}, {"tags": ["c", "multithreading", "assembly", "cpu-architecture", "cpu-cache"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1545197450, "post_id": 53845062, "comment_id": 94537787, "body": "C doesn&#39;t run directly on CPUs, it has to be compiled to asm.  But no, there&#39;s no way the stores could reorder at compile time, or else they&#39;d leave the wrong value long term.  And at run-time, no I don&#39;t think any ISA exists that would let another thread observe <code>3</code> temporarily, then <code>1</code>, then <code>3</code> again as the final long-term value.  But any C program that tried to check would have undefined behaviour, because <code>int data[]</code> is not <code>_Atomic</code>.  From within the same thread (or signal handlers in that thread), your program will always see its own operations happen in program order."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 0, "creation_date": 1545199271, "post_id": 53845062, "comment_id": 94538341, "body": "You need to provide a specific architecture, but assuming you mean x86 or most common ones - no, stores do not reorder with other stores. Unless you use explicitly weakly ordered stores."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1545199853, "post_id": 53845062, "comment_id": 94538523, "body": "<a href=\"https://stackoverflow.com/questions/1474030/how-can-i-tell-gcc-not-to-inline-a-function\" title=\"how can i tell gcc not to inline a function\">stackoverflow.com/questions/1474030/&hellip;</a> - <code>noinline</code> does nothing to guarantee that your function is called at all. GCC can very well see what it does, even if it is not inlined. It doesn&#39;t have <i>side-effects</i> because <code>data[]</code> is not volatile."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 1, "creation_date": 1545200988, "post_id": 53845062, "comment_id": 94538944, "body": "@Leeor: stores to the <i>same</i> address never reorder on x86, even weakly-ordered.  (And I think on any sane architecture, because program logic dictates the final long-term value of the bytes in memory, so all cores have to see that one last unless there&#39;s temporary flip-flopping)."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1545201761, "post_id": 53845062, "comment_id": 94539255, "body": "@PeterCordes, yes, I was talking about the general case of 2 stores, as the rule says. In the example above the matching address would be detected and block (or possibly merge) the 2nd store."}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 3, "last_activity_date": 1545215047, "last_edit_date": 1545215047, "creation_date": 1545200143, "answer_id": 53845533, "question_id": 53845062, "link": "https://stackoverflow.com/questions/53845062/will-cpu-reorder-store-instructions-to-same-address/53845533#53845533", "title": "will cpu reorder STORE instructions to same address?", "body": "<p>Your question is pretty much pointless as it is now.</p>\n\n<pre><code>int* __attribute__ ((noinline)) GetMemAddr(int index) {\n    static int data[10];\n    return &amp;data[0];\n}\n\nvoid fun() {\n    int *a=GetMemAddr(1); //use different args to get same address to avoid optimiztion\n    int *b=GetMemAddr(2);\n    *a=1;\n    *b=3;\n}\n</code></pre>\n\n<p>this <a href=\"https://godbolt.org/z/YfS8e8\" rel=\"nofollow noreferrer\">compiled with GCC 7.3 and <code>-O3</code></a> elides the first  call to <code>GetMemAddr</code> completely because it doesn't have side effects. It elides the assignment <code>*a=1</code> too. <code>noinline</code> means that the function must not be inlined. It doesn't mean that it needs to be called at all.</p>\n\n<p>The only proper way to actually avoid elision is to declare <code>a</code> and <code>b</code> as <code>volatile int *</code>s. That way the stores are also to be kept in order. However, it is still not in any way guaranteed that these stores be <em>atomic</em>, so another thread can  see funny things happening - for those you need to use the C11 atomic features, or a compiler extension/guarantee.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1545216909, "creation_date": 1545216909, "answer_id": 53849743, "question_id": 53845062, "link": "https://stackoverflow.com/questions/53845062/will-cpu-reorder-store-instructions-to-same-address/53849743#53849743", "title": "will cpu reorder STORE instructions to same address?", "body": "<p>The CPU can re-order the two stores so long as it doesn't violate any guarantee that the CPU has to provide. It's the compiler's job to generate code for the CPU that doesn't allow it to make optimizations that cause the generated code to violate the C standard. To put it another way, a C compiler takes code that it promises will run according to the rules of the C standard and turns it in to assembly code that will in fact run according to the rules of the C standard by relying on the CPU to run according to the rules of its architecture specification.</p>\n\n<p>So if those two stores happen to be to the same memory location, no \"optimization\" is possible that permits the wrong result to be observed from that very same thread. That would violate the C standard, so a non-broken compiler will generate whatever code it takes for a non-broken CPU to not do that. However, nothing prevents optimizations that might cause other threads to see strange intermediary results unless your platform's threading standard says something different (and none that I know of do).</p>\n\n<p>If you want cross-thread guarantees, you have to use atomic operations, mutexes, or whatever else your platform provides for that. If you just want code that happens to work, you'll need platform-specific knowledge about what optimizations your platform is actually capable of and what methods there are to disable them on that platform (<code>volatile</code>, compiler flags, whatever).</p>\n"}], "owner": {"reputation": 107, "user_id": 1057494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91f5baccfba8d9f47b0e6aa9675990f7?s=128&d=identicon&r=PG", "display_name": "xYZ", "link": "https://stackoverflow.com/users/1057494/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 53849743, "answer_count": 2, "score": 0, "last_activity_date": 1545216909, "creation_date": 1545197158, "last_edit_date": 1545198893, "question_id": 53845062, "link": "https://stackoverflow.com/questions/53845062/will-cpu-reorder-store-instructions-to-same-address", "title": "will cpu reorder STORE instructions to same address?", "body": "<p>Given below code, will CPU reorder STORE a and STORE b ? From code logic, a and b are independent. </p>\n\n<pre><code>int* __attribute__ ((noinline)) GetMemAddr(int index) {\n    static int data[10];\n    return &amp;data[0];\n}\n\nvoid fun() {\n    int *a=GetMemAddr(1); //use different args to get same address to avoid optimiztion\n    int *b=GetMemAddr(2);\n    *a=1;\n    *b=3;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "audio", "mp3", "voice"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 3, "creation_date": 1545196302, "post_id": 53844920, "comment_id": 94537490, "body": "You will need to decode the mp3 data, mix it, then encode it again, you can&#39;t just mix compressed data."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1545196948, "post_id": 53844920, "comment_id": 94537658, "body": "Yes, it&#39;s possible, but it&#39;s harder than just sticking the two files together with duct tape and baling wire."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1545197012, "post_id": 53844920, "comment_id": 94537678, "body": "The answer to <a href=\"https://stackoverflow.com/questions/62618/what-is-the-best-way-to-merge-mp3-files?rq=1\">this question</a> suggests a tool called mp3wrap."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1545197172, "post_id": 53844920, "comment_id": 94537717, "body": "If you don&#39;t mind a slight loss of quality you can also convert them both to raw files, join the raw files and convert back to mp3."}, {"owner": {"reputation": 676, "user_id": 10809273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcYeO.png?s=128&g=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10809273/j-doe"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1545198420, "post_id": 53844920, "comment_id": 94538073, "body": "@immibis how to mix raw files?"}, {"owner": {"reputation": 676, "user_id": 10809273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcYeO.png?s=128&g=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10809273/j-doe"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1545198485, "post_id": 53844920, "comment_id": 94538098, "body": "@RetiredNinja How to do that?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545202993, "post_id": 53844920, "comment_id": 94539789, "body": "Use appropriate libraries. (Do not ask which, that would be off-topic here. Search and pick one yourself. Ideally one with a tutorial, asking about one would also be off-topic.)"}, {"owner": {"reputation": 676, "user_id": 10809273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcYeO.png?s=128&g=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10809273/j-doe"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545203204, "post_id": 53844920, "comment_id": 94539880, "body": "@Yunnosch to mix this two mp3 or to mix raw files?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545203811, "post_id": 53844920, "comment_id": 94540116, "body": "Yes, one of the two. Or better, yes, whatever is your goal. However, I only have heard of libs for mixing non-compressed files - and for uncompressing them."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1545374367, "post_id": 53844920, "comment_id": 94607327, "body": "It seems like you don&#39;t really understand how computer audio works. I suggest learning about that first, if you can&#39;t find an existing tool that does what you want"}], "answers": [{"tags": [], "owner": {"reputation": 168, "user_id": 7103781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--1U2ry2Ru5A/AAAAAAAAAAI/AAAAAAAADa0/lDWeeGF250o/photo.jpg?sz=128", "display_name": "Gio", "link": "https://stackoverflow.com/users/7103781/gio"}, "is_accepted": false, "score": 0, "last_activity_date": 1545212393, "creation_date": 1545212393, "answer_id": 53848361, "question_id": 53844920, "link": "https://stackoverflow.com/questions/53844920/how-to-mergemix-two-stereo-mp3-audio-file/53848361#53848361", "title": "How to merge(Mix) two stereo mp3 audio file", "body": "<p>You can achieve that by following these steps:</p>\n\n<ol>\n<li><p>Decode 1.mp3 and 2.mp3 files</p></li>\n<li><p>Save decoded raw data (in different WAVE formatted files or in memory)</p></li>\n<li><p>Replace of 1.mp3 decoded raw data's first or second channel values with 2.mp3 decoded raw data's first or second channel values one by one (note that this causes quality loss of audio)</p></li>\n<li><p>Construct WAVE(raw audio data format) header based on the merged audio data features</p></li>\n<li><p>Create WAVE formated 3.wav file using constructed WAVE header and merged audio data</p></li>\n<li><p>Convert 3.wav file to 3.mp3 file format</p></li>\n</ol>\n\n<p>Doing these steps requires you to know:</p>\n\n<ul>\n<li><p>How to decode mp3 files to get raw data</p></li>\n<li><p>How to manipulate on data bytes in buffer</p></li>\n<li><p>WAVE soundfile format</p></li>\n<li><p>How to convert wav to mp3</p></li>\n</ul>\n\n<p>For decoding and encoding audio files in different formats you can use some appropriate sound library(for example <a href=\"https://www.un4seen.com/\" rel=\"nofollow noreferrer\">BASS</a>) - this helps you to do 1 and 6 steps. For constructing WAVE formated audio data you should be familiar with <a href=\"http://soundfile.sapp.org/doc/WaveFormat/\" rel=\"nofollow noreferrer\">WAVE File Format</a> and how audio data channels is aligned in buffer - this helps you to do 3, 4 and 5 steps</p>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 4432916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f5c33058603089e08b3f435dabde3?s=128&d=identicon&r=PG&f=1", "display_name": "thomachan", "link": "https://stackoverflow.com/users/4432916/thomachan"}, "is_accepted": false, "score": 0, "last_activity_date": 1545214158, "creation_date": 1545214158, "answer_id": 53848896, "question_id": 53844920, "link": "https://stackoverflow.com/questions/53844920/how-to-mergemix-two-stereo-mp3-audio-file/53848896#53848896", "title": "How to merge(Mix) two stereo mp3 audio file", "body": "<p>mp3 is compressed audio data. you can not directly mix them using file operations. \none thing you can do is use ffmpeg library to convert the mp3 to raw PCM, mix the channels and then converting it back to mp3.</p>\n"}], "owner": {"reputation": 676, "user_id": 10809273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcYeO.png?s=128&g=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10809273/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559029319, "creation_date": 1545196179, "last_edit_date": 1559029319, "question_id": 53844920, "link": "https://stackoverflow.com/questions/53844920/how-to-mergemix-two-stereo-mp3-audio-file", "title": "How to merge(Mix) two stereo mp3 audio file", "body": "<p>I have two stereo file: <strong>1.mp3, 2.mp3</strong>\n\nI want to merge this two audio files in the special way</p>\n\n<p>with this code I can merge them so <strong>3.mp3</strong> has both file's data, when I play <strong>3.mp3</strong> It plays <strong>1.mp3</strong> then <strong>2.mp3</strong> blow-by-blow</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\n\nINT ReadMyFile(LPCWSTR lpcszFilePath, PBYTE* pbytReadBuffer, DWORD* dwSize)\n{\n    HANDLE hndlRead;\n    OVERLAPPED ol = {0};\n    BOOL bRetValCheck;\n    INT nReturnValue = TRUE;\n\n    hndlRead = CreateFileW(lpcszFilePath, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n    if (hndlRead != INVALID_HANDLE_VALUE)\n    {\n        *dwSize = GetFileSize(hndlRead, NULL);\n        *pbytReadBuffer = (PBYTE) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, *dwSize);\n\n        if (pbytReadBuffer != NULL)\n        {\n            bRetValCheck = ReadFile(hndlRead, *pbytReadBuffer, *dwSize, NULL, &amp;ol);\n\n            if (!bRetValCheck)\n            {\n                nReturnValue = FALSE;\n                HeapFree(GetProcessHeap(), 0, pbytReadBuffer);\n            }\n        }\n        else\n        {       \n            nReturnValue = FALSE;\n        }\n        CloseHandle(hndlRead);\n    }\n    else\n    {\n        nReturnValue = FALSE;\n    }   \n    return nReturnValue;\n}\nint main()\n{\n    DWORD dwSiaze_IN = 0;\n    DWORD dwSiaze_OUT = 0;\n    PBYTE pbytPlainText_IN = NULL;\n    PBYTE pbytPlainText_OUT = NULL;\n    PBYTE pOutputBuffer;\n    DWORD dwOutputSize = 0;\n    DWORD dwBytesWritten;\n    HANDLE hndlWrite;\n\n    if (ReadMyFile(L\"1.mp3\", &amp;pbytPlainText_IN, &amp;dwSiaze_IN) &amp;&amp; ReadMyFile(L\"2.mp3\", &amp;pbytPlainText_OUT, &amp;dwSiaze_OUT))\n    {\n\n        dwOutputSize = dwSiaze_IN + dwSiaze_OUT;\n        pOutputBuffer = (PBYTE) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, dwOutputSize);\n\n        int i = 0;\n        // For mp3 Header\n        for (i=0; i&lt;11; i++)\n        {\n            pOutputBuffer[i] = pbytPlainText_IN[i];\n        }\n\n        for (i=11; i&lt;dwOutputSize/2; i++)\n        {\n            pOutputBuffer[i] = pbytPlainText_IN[i];\n        }\n        int tmp = 11;\n        for (i=dwOutputSize/2; i&lt;dwOutputSize; i++)\n        {\n            pOutputBuffer[i] = pbytPlainText_OUT[tmp];\n            tmp++;\n        }\n\n        hndlWrite = CreateFileW(L\"3.mp3\", GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);\n        if (hndlWrite != INVALID_HANDLE_VALUE)\n        {\n            SetFilePointer(hndlWrite, 0, 0, FILE_END);\n            WriteFile(hndlWrite, pOutputBuffer, dwOutputSize, &amp;dwBytesWritten, NULL);\n            CloseHandle(hndlWrite);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>But I want to have the data synchronous...</p>\n\n<p>I mean I want <strong>3.mp3</strong> to be a stereo file that has <strong>1.mp3</strong> in it's left channel and <strong>2.mp3</strong> in it's right channel</p>\n"}, {"tags": ["c", "debugging"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1545196659, "post_id": 53844390, "comment_id": 94537577, "body": "<code>scanf(&quot;%s&quot;,x);</code> you can&#39;t store a string in the space of a single char."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545196820, "post_id": 53844390, "comment_id": 94537622, "body": "@DavidC.Rankin: Which doesn&#39;t even matter, because storing into a single char would still require passing its address."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1545196926, "post_id": 53844390, "comment_id": 94537649, "body": "Suggest <code>x[1024]</code> and then using <code>fgets(x, sizeof x, stdin);</code> to read the selection and then <code>switch (*x) {...}</code>. (and don&#39;t forget to check the return of <b><i>every</i></b> input function used)"}, {"owner": {"reputation": 141, "user_id": 4164564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kD8BnKdJQLI/AAAAAAAAAAI/AAAAAAAAAIw/U79TXWpOrWY/photo.jpg?sz=128", "display_name": "thilinaur", "link": "https://stackoverflow.com/users/4164564/thilinaur"}, "edited": false, "score": 0, "creation_date": 1545197737, "post_id": 53844390, "comment_id": 94537873, "body": "or use scanf(&quot;%c&quot;,&amp;x)"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 4164564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kD8BnKdJQLI/AAAAAAAAAAI/AAAAAAAAAIw/U79TXWpOrWY/photo.jpg?sz=128", "display_name": "thilinaur", "link": "https://stackoverflow.com/users/4164564/thilinaur"}, "edited": false, "score": 1, "creation_date": 1545197855, "post_id": 53845095, "comment_id": 94537909, "body": "you&#39;ll need to use &amp;x;"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1545684601, "post_id": 53845095, "comment_id": 94677940, "body": "&quot;import statements&quot;? Did you mean <code>#include</code> directives?"}, {"owner": {"reputation": 26, "user_id": 10809328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pJOBrZYQZs4/AAAAAAAAAAI/AAAAAAAAAHk/LT7HyDq3x4M/photo.jpg?sz=128", "display_name": "Parakh Jaggi", "link": "https://stackoverflow.com/users/10809328/parakh-jaggi"}, "edited": false, "score": 0, "creation_date": 1545707478, "post_id": 53845095, "comment_id": 94680711, "body": "yup! I&#39;ve been doing too much Java recently."}], "tags": [], "owner": {"reputation": 26, "user_id": 10809328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pJOBrZYQZs4/AAAAAAAAAAI/AAAAAAAAAHk/LT7HyDq3x4M/photo.jpg?sz=128", "display_name": "Parakh Jaggi", "link": "https://stackoverflow.com/users/10809328/parakh-jaggi"}, "is_accepted": false, "score": 0, "last_activity_date": 1545198004, "last_edit_date": 1545198004, "creation_date": 1545197363, "answer_id": 53845095, "question_id": 53844390, "link": "https://stackoverflow.com/questions/53844390/format-specifies-type-char-but-the-argument-has-type-int-any-mistake-i-ma/53845095#53845095", "title": "Format specifies type &#39;char *&#39; but the argument has type &#39;int&#39;, any mistake I made here?", "body": "<p><code>x</code> is declared as a character here.    </p>\n\n<pre><code>char name[20],\n     c[1000],\n     d[1000],\n     x;\n</code></pre>\n\n<p>But when scanning into <code>x</code> you use <code>%s</code>, which is for Strings. </p>\n\n<pre><code>scanf(\"%s\", &amp;x); \n</code></pre>\n\n<p>The correct way to scan a character is <code>scanf(\"%c\",&amp;x);</code></p>\n\n<p>Also, don't forget your import statements and your <code>return 0;</code> at the end of the program. </p>\n"}], "owner": {"reputation": 1, "user_id": 10809094, "user_type": "registered", "profile_image": "https://graph.facebook.com/2219358454764828/picture?type=large", "display_name": "Iddhima Chong", "link": "https://stackoverflow.com/users/10809094/iddhima-chong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1524, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545202897, "creation_date": 1545192018, "last_edit_date": 1545202897, "question_id": 53844390, "link": "https://stackoverflow.com/questions/53844390/format-specifies-type-char-but-the-argument-has-type-int-any-mistake-i-ma", "title": "Format specifies type &#39;char *&#39; but the argument has type &#39;int&#39;, any mistake I made here?", "body": "<p>There is some error in my code, anyone can help with debugging? Apparently, there is something wrong at the <code>scanf</code> part to get my <code>x</code>.\nThe instructions are as shown below:</p>\n\n<p>This program is a simple introductory of C language application that involves console display, user input, strings, and loops.\nWrite codes that will produce the screen as shown:</p>\n\n<p>Firstly, the program prompts the user to enter his or her name.\nThen, it will display </p>\n\n<pre><code>Hello &lt;user name&gt;\n</code></pre>\n\n<p>Next, it prints out a menu which contains 4 options:</p>\n\n<ol>\n<li>add two integers</li>\n<li>add two strings</li>\n<li>compute factorial for integer less and including <code>10</code> or less than <code>11</code></li>\n<li>quit program</li>\n</ol>\n\n<p>Code all 4 tasks appropriately.</p>\n\n<p>When the task is completed (not including quitting program of course), the menu pops up again and asks the user to try on another task. This repeat until <kbd>q</kbd> or <kbd>Q</kbd> is pressed. You may use <strong>switch- case</strong> or <strong>if-else</strong>, but the former looks more legible.<br>\nEven though you may know how to write functions, do not use functions in this program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar name[20],\n     c[1000],\n     d[1000],\n     x;\nint a, b, i, n,\n    factorial = 1;\n\nint main() {\n    do {\n        printf(\"\\nPlease select one:\\n\");\n        printf(\"**********MENU**********\\n\");\n        printf(\"1 - add two integers\\n\");\n        printf(\"2 - add two strings\\n\");\n        printf(\"3 - compute factorial for integer less and including 10 or less than 11\\n\");\n        printf(\"Q - quit program\\n\");\n        printf(\"************************\\n\");\n\n        scanf(\"%s\", x);\n\n        switch(x) {\n\n        case '1':\n            printf(\"Enter first integer:\\n\");\n            scanf(\"%d\", &amp;a);\n            printf(\"Enter second integer:\\n\");\n            scanf(\"%d\", &amp;b);\n            printf(\"%d + %d = %d\\n\", a, b, a + b);\n            break;\n        case '2':\n            printf(\"Enter first string:\\n\");\n            scanf(\"%s\", c);\n            printf(\"Enter second string:\\n\");\n            scanf(\"%s\", d);\n            strcat(c, d);\n            printf(\"%s\\n\", c);\n            break;\n        case '3':\n            printf(\"Enter integer less than 11:\\n\");\n            scanf(\"%d\", &amp;n);\n            if (n &gt; 0 &amp;&amp; n &lt; 11) {\n                for(i = 1; i &lt;= n; ++i) {\n                    factorial *= i;\n                }\n                printf(\"factorial of %d is %d\\n\", n, factorial);\n                break;\n            }\n            else {\n                printf(\"error, please enter an integer\\n\");\n            }\n\n        case 'Q':\n            printf(\"Program quitting...\\n\");\n            break;\n\n        }\n    } while (x != 'Q');\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1545192136, "post_id": 53844384, "comment_id": 94536581, "body": "Please include the output in the question (copy-and-pasted if possible) as text, formatted as code (use the <b>{}</b> button). Images of text are discouraged."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1545192175, "post_id": 53844384, "comment_id": 94536591, "body": "Please post console output as code formatted text, not images"}, {"owner": {"reputation": 17, "user_id": 10809075, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r88OP5zxm0A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iJzD2yjj9QDyYYHM0ytlzX1StNwg/mo/photo.jpg?sz=128", "display_name": "Harry", "link": "https://stackoverflow.com/users/10809075/harry"}, "edited": false, "score": 0, "creation_date": 1545192542, "post_id": 53844384, "comment_id": 94536658, "body": "Sorry, it&#39;s the first time I use stackoverflow, I will pay attention to it next time."}], "answers": [{"comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1545192228, "post_id": 53844398, "comment_id": 94536602, "body": "You also need to check for EOF here. Probably don&#39;t want to print that."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1545195386, "post_id": 53844398, "comment_id": 94537267, "body": "May also want an <code>else break;</code> after that check on <code>EOF</code> to prevent calling <code>getchar()</code> again on a stream with <code>EOF</code>."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1545192068, "creation_date": 1545192068, "answer_id": 53844398, "question_id": 53844384, "link": "https://stackoverflow.com/questions/53844384/the-c-programming-language-second-edition-practice-1-9/53844398#53844398", "title": "The C programming language Second Edition practice 1-9", "body": "<pre><code>    if (characters == ' '){\n        while ((characters = getchar()) == ' ');\n        putchar(' ');\n    }\n</code></pre>\n\n<p>This code will keep eating characters until it eats a non-space. But you don't want to eat any non-spaces. A simple fix:</p>\n\n<pre><code>    if (characters == ' '){\n        while ((characters = getchar()) == ' ');\n        putchar(' ');\n        putchar(characters);\n    }\n</code></pre>\n\n<p>Now you eat characters until you eat a non-space, then you output one space, then you output the non-space character you ate.</p>\n"}], "owner": {"reputation": 17, "user_id": 10809075, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r88OP5zxm0A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iJzD2yjj9QDyYYHM0ytlzX1StNwg/mo/photo.jpg?sz=128", "display_name": "Harry", "link": "https://stackoverflow.com/users/10809075/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545195184, "creation_date": 1545191983, "last_edit_date": 1545195184, "question_id": 53844384, "link": "https://stackoverflow.com/questions/53844384/the-c-programming-language-second-edition-practice-1-9", "title": "The C programming language Second Edition practice 1-9", "body": "<p>The specific question is this: the user enters the text, for example, if the user enters </p>\n\n<pre><code>hello (spaces) (spaces) world\n</code></pre>\n\n<p>The output that the user gets is </p>\n\n<pre><code>hello (space) world.\n</code></pre>\n\n<p>The following is my code, the adjustment of the number of spaces can be achieved, I am a bit confused because my output will <em>eat the first letter</em>. I want to know why this will happen.</p>\n\n<p><strong>The code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int characters = 0;\n    while ((characters = getchar()) != EOF) {\n\n        if (characters != ' ') {\n            putchar(characters);\n        }\n\n        if (characters == ' ') {\n            while ((characters = getchar()) == ' ');\n            putchar(' ');\n        }\n\n    }\n}\n</code></pre>\n\n<p><strong>The output:</strong></p>\n\n<pre><code>Hello  world  world  world\nHello orld orld orld\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ySy9m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ySy9m.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1545191337, "post_id": 53844292, "comment_id": 94536419, "body": "<code>Temp</code> is already a pointer.  You don&#39;t need to put an asterisk in front of it to dereference it.  You do, however, have to use an arrow to dereference, not a dot, as in <code>temp-&gt;data</code>"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1545191594, "post_id": 53844292, "comment_id": 94536470, "body": "Looks like C to me, not C++. Why does the file have cpp extension?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1545191710, "post_id": 53844292, "comment_id": 94536495, "body": "This is a problem with the compiler, not with your code. Is it this problem? <a href=\"https://github.com/Homebrew/homebrew-core/issues/32516\" rel=\"nofollow noreferrer\">github.com/Homebrew/homebrew-core/issues/32516</a>"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1545191870, "post_id": 53844292, "comment_id": 94536532, "body": "Ah, my mistake. <code>(*temp).next</code> should work just as well."}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1545211888, "creation_date": 1545211888, "answer_id": 53848204, "question_id": 53844292, "link": "https://stackoverflow.com/questions/53844292/collect2-fatal-error-usr-local-bin-gnm-returned-1-exit-status/53848204#53848204", "title": "collect2: fatal error: /usr/local/bin/gnm returned 1 exit status", "body": "<p>When you have a pointer to a structure, as in the case of <code>temp</code> in your <code>insert()</code>, instead of doing stuff like</p>\n\n<pre><code>(*temp).data\n</code></pre>\n\n<p>you can use the arrow operator and do</p>\n\n<pre><code>temp-&gt;data\n</code></pre>\n\n<hr>\n\n<p>Since this is a C program, when declaring structure variables of the structure <code>Node</code>, you must use </p>\n\n<pre><code>struct Node var_name;\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Node var_name;\n</code></pre>\n\n<p>And in C, it's better not to explicitly cast the return value of <code>malloc()</code>.\nSee <a href=\"http://c-faq.com/malloc/mallocnocast.html\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>So change the declaration of <code>temp</code> in <code>insert()</code> to</p>\n\n<pre><code>struct Node *temp = malloc(sizeof(struct Node));\n</code></pre>\n\n<p>in place of <code>Node *temp = (Node*) malloc(sizeof(struct Node));</code>.</p>\n\n<hr>\n\n<p>And if you are trying to add new elements to the start of the linked list, you could change the <code>insert()</code> function to something like</p>\n\n<pre><code>void insert(int x) {\n    struct Node *temp = malloc(sizeof(struct Node));\n    temp-&gt;data = x;\n    temp-&gt;next = NULL;\n    if(head!=NULL)\n    {\n      temp-&gt;next = head;\n    }\n    head = temp;\n}\n</code></pre>\n\n<hr>\n\n<p>With these changes, I got the following output:</p>\n\n<pre><code>How many numbers?\n4\nEnter the number \n12\nList is:  12\nEnter the number \n34\nList is:  34 12\nEnter the number \n56\nList is:  56 34 12\nEnter the number \n778\nList is:  778 56 34 12\n</code></pre>\n"}], "owner": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545211957, "creation_date": 1545191079, "last_edit_date": 1545211957, "question_id": 53844292, "link": "https://stackoverflow.com/questions/53844292/collect2-fatal-error-usr-local-bin-gnm-returned-1-exit-status", "title": "collect2: fatal error: /usr/local/bin/gnm returned 1 exit status", "body": "<p>I wrote a linked list as</p>\n\n<pre><code>In [69]: !cat linked_list.cpp                                                                                                                         \n//linked list: inserting a node at beginning\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\nstruct Node {\n    int data;\n    struct Node *next;\n};\nvoid insert(int x);\nvoid print();\nstruct Node *head; //global variable, can be accessed anywhere\nint main() {\n    head = NULL; //empty list\n    printf(\"How many numbers?\\n\");\n    int n,i, x;\n    scanf(\"%d\", &amp;n);\n    for (i=0; i&lt;n; i++) {\n        printf(\"Enter the number \\n\");\n        scanf(\"%d\", &amp;x);\n        insert(x);\n        print();\n    }\n}\n\nvoid insert(int x) {\n    Node *temp = (Node*) malloc(sizeof(struct Node));\n    (*temp).data = x;\n    (*temp).next = NULL;\n    head = temp;//insert to the head\n    if (head != NULL) (*temp).next = head;\n    head = temp;\n}\n\nvoid print() {\n   struct Node *temp = head;\n   printf(\"List is: \");\n   while(temp != NULL)\n   {\n       printf(\" %d\", (*temp).data);\n       temp = (*temp).next;\n    }\n   printf(\"\\n\");\n}\n</code></pre>\n\n<p>Tried to run but get error report:</p>\n\n<pre><code>gcc linked_list.cpp                                                                                                                         \ncollect2: fatal error: /usr/local/bin/gnm returned 1 exit status\ncompilation terminated.\n</code></pre>\n\n<p>gcc provide few helpful hints. </p>\n\n<p>What's the problem with my code?</p>\n"}, {"tags": ["c", "multithreading", "stack", "stack-frame"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545191181, "post_id": 53843976, "comment_id": 94536397, "body": "When <code>memcpy(from, last, SSIZE*sizeof(int));</code> is executed, <code>last == NULL</code>.  What do you expect to happen with this <code>memcpy()</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1545191543, "post_id": 53843976, "comment_id": 94536459, "body": "@chux This seems quite confusing, but I think <code>f1</code> calls <code>kwrite</code> which calls <code>kyield</code> with <code>from != NULL</code> and therefore before the first <code>kyield</code> call gets to this line, <code>last</code> will be allocated for and <code>memcpy</code>ed to through the other <code>kyield</code> call. Still doesn&#39;t make the intend clear though."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545192197, "post_id": 53843976, "comment_id": 94536596, "body": "@user10605163 Agrreed."}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545209415, "post_id": 53843976, "comment_id": 94542589, "body": "@chux you have to understand that there are two concurrent threads going on here. Even though the code seems simple it is really tricky. Answering your question, when the mentioned memcpy is executed last wont be null as another kyield call have previously allocated it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545234790, "post_id": 53843976, "comment_id": 94557294, "body": "Tretorn, There is only one <a href=\"https://en.wikipedia.org/wiki/Thread_(computing)\" rel=\"nofollow noreferrer\">thread</a> here.  @user10605163 has already explained the code."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545191320, "post_id": 53844303, "comment_id": 94536416, "body": "Agreed, <code>int a[SSIZE]</code> would make more sense."}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "edited": false, "score": 0, "creation_date": 1545209561, "post_id": 53844303, "comment_id": 94542661, "body": "@Georg i answered why this cannot be in the main post. Perhaps i was giving too litle background about what i was doing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "edited": false, "score": 0, "creation_date": 1545235276, "post_id": 53844303, "comment_id": 94557631, "body": "@Tretorn &quot;we are copying the rax last value, the last ebp and the return address of the function.&quot; ---&gt; this depends on select <i>undefined behavior</i> (UB) of <code>memcpy()</code>, on the compiler/platform (post not tagged with either) and your correct interpretations of these.  Without that info, the question is unclear."}], "tags": [], "owner": {"reputation": 94, "user_id": 10704685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffea3502c59f3c3267b64170d78fc78a?s=128&d=identicon&r=PG&f=1", "display_name": "Georg", "link": "https://stackoverflow.com/users/10704685/georg"}, "is_accepted": true, "score": 0, "last_activity_date": 1545191180, "creation_date": 1545191180, "answer_id": 53844303, "question_id": 53843976, "link": "https://stackoverflow.com/questions/53843976/c-context-switch-stack-variable-corruption/53844303#53844303", "title": "C Context switch stack variable corruption", "body": "<p>Your <code>memcpy(frame, a, SSIZE*sizeof(int))</code> looks wrong. Your <code>SSIZE</code> is defined to 15, but <code>a</code> has only a size of 10.</p>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "edited": false, "score": 0, "creation_date": 1545212559, "post_id": 53848149, "comment_id": 94544352, "body": "Thank you for your answer. I knew i had to give them different stacks. i thought i was. Do you have any reference/documentation/example over that approach?"}], "tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 1, "last_activity_date": 1545211654, "creation_date": 1545211654, "answer_id": 53848149, "question_id": 53843976, "link": "https://stackoverflow.com/questions/53843976/c-context-switch-stack-variable-corruption/53848149#53848149", "title": "C Context switch stack variable corruption", "body": "<p>I can see a couple of issues with the design.  The normal way of scheduling different threads is for them to get complete stacks, not to share the same stack.</p>\n\n<p>What that means in this case, is that the stack depends on the addresses being used.</p>\n\n<pre><code>+---------+--------+---------+--------+---------+\n| main    | kyield | f1      | kwrite |  kyield |\n|         |        |         |a[10]   |         |\n+---------+--------+---------+--------+---------+\n\n                        |-------------|  &lt;&lt; copied by the slice of the stack.\n</code></pre>\n\n<p>The slice of the stack you are taking, is independent of the amount used in the function preceding it, so would be broken if the functions calling kwrite  have different stack requirements (different amounts of state would be required).</p>\n\n<p>It is also broken because the amount of information which is captured on the stack is not complete.  The state of execution is based on the stack and the current values in non-volatile registers.  These values can pollute the alternate threads.</p>\n\n<p>Finally the stack also contains addresses.  This scheme could only work, if all the threads executed had identical stack requirements, as if the yield function pastes a value back in which requires addresses, then they always have to align.</p>\n"}], "owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53844303, "answer_count": 2, "score": 0, "last_activity_date": 1545211654, "creation_date": 1545188354, "last_edit_date": 1545211312, "question_id": 53843976, "link": "https://stackoverflow.com/questions/53843976/c-context-switch-stack-variable-corruption", "title": "C Context switch stack variable corruption", "body": "<p>Im trying to implement custom threads in C by creating a simple context switch function plus a FCFS scheduler.</p>\n\n<p>The first step that i want to perform is to copy the entire function stack frame to heap to a saved frame and replace it by the first in queue. </p>\n\n<p>The problem i have is that after finishing task one the stack of the second gets corrupted. I dont have any idea about why.</p>\n\n<p>The code i have is the following:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ITERATIONS 10\n#define SSIZE 15\n\nint * last;\n\nvoid kwrite(const char*);\nvoid kyield(int *);\n\nvoid f1() {\n    int i = ITERATIONS;\n    while (i--) kwrite(\"A\\n\");\n}\n\nvoid f2() {\n    int i = ITERATIONS*2;\n    while (i--) {\n        printf(\"[%d]\", i);\n        kwrite(\"B\\n\");\n        getchar();\n    }\n}\n\nvoid kwrite(const char* str) {\n    int a[10] = {5, 5, 5, 5, 5, 5, 5, 5, 5, 5};\n    write(1, str, strlen(str));\n\n    int *frame = malloc(sizeof(int)*SSIZE);\n    memcpy(frame, a, SSIZE*sizeof(int));\n    kyield(frame);\n    printf(\"ERROR\\n\");\n}\n\nvoid kyield(int * from) {\n    if (from == NULL) {\n        f1();\n        from = malloc(sizeof(int)*SSIZE);\n        memcpy(from, last, SSIZE*sizeof(int));\n    }\n    if (last == NULL) {\n        last = malloc(sizeof(int)*SSIZE);\n        memcpy(last, from, SSIZE*sizeof(int));\n        free(from);\n        f2();\n        exit(0);\n    }\n\n    int a[10] = {3, 3, 3, 3, 3, 3, 3, 3, 3, 3};\n    memcpy(a, last, SSIZE*sizeof(int));\n    memcpy(last, from, SSIZE*sizeof(int));\n    free(from);\n}\n\nint main(int argc, char** argv) {\n    kyield(NULL);\n    free(last);\n}\n</code></pre>\n\n<p>It should call 10 times f1 and 20 f2 then exit. But when the var i of f2 is 8 it gets corrupted on the next iteration. Therefore entering an infinite loop.</p>\n\n<p>Any help or suggestions would be appreciated! Have a nice day.</p>\n\n<p>[edit] \nI suppose the code can be a bit tricky to understand so here it is a little clarification:</p>\n\n<p>main calls kyield with null parameters.</p>\n\n<p>kyield detects it and calls f1</p>\n\n<p>f1 executes until kwrite is called</p>\n\n<p>kwrite calls kyield passing its current stack frame</p>\n\n<p>kyield detects the last stack frame is null so it copies the stack frame (sf from now on) given by kwrite, then calls f2\nf2 does the same as f1</p>\n\n<p>when kyield is executed next, both from and last wont be NULL so it will overwrite its current s f with the one in last, swap it with the one in from and lastly it will return, as the stack has been altered it will jump to the return address of the last kwrite, not the actual one, thus. Jumping from the f1 thread to f2.</p>\n\n<blockquote>\n  <p>Your memcpy(frame, a, SSIZE*sizeof(int)) looks wrong. Your SSIZE is defined to 15, but a has only a size of 10.</p>\n</blockquote>\n\n<p>this is deliberate, as by copying 15 elements of 4 bytes we are copying the rax last value, the last ebp and the return address of the function.</p>\n\n<p><a href=\"https://eli.thegreenplace.net/2011/09/06/stack-frame-layout-on-x86-64/\" rel=\"nofollow noreferrer\">https://eli.thegreenplace.net/2011/09/06/stack-frame-layout-on-x86-64/</a></p>\n"}, {"tags": ["c", "pointers", "struct", "header"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1545186244, "post_id": 53843691, "comment_id": 94535438, "body": "You didn&#39;t define <code>stack</code>!"}, {"owner": {"reputation": 13, "user_id": 10772680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XAFpCyWZmwU/AAAAAAAAAAI/AAAAAAAAAA8/9a0fNezkNl0/photo.jpg?sz=128", "display_name": "bouhou imad", "link": "https://stackoverflow.com/users/10772680/bouhou-imad"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545186292, "post_id": 53843691, "comment_id": 94535445, "body": "is it necessary to define it inside the header .h file ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1545186335, "post_id": 53843691, "comment_id": 94535448, "body": "It is necessary to define it for this question to make sense. You said you&#39;ve got <code>struct stack</code> and <code>s</code>, but you never defined <code>stack</code>"}, {"owner": {"reputation": 13, "user_id": 10772680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XAFpCyWZmwU/AAAAAAAAAAI/AAAAAAAAAA8/9a0fNezkNl0/photo.jpg?sz=128", "display_name": "bouhou imad", "link": "https://stackoverflow.com/users/10772680/bouhou-imad"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545186398, "post_id": 53843691, "comment_id": 94535459, "body": "okey i&#39;ll try ,  thank you"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545187157, "post_id": 53843691, "comment_id": 94535608, "body": "Yes, for the second line of your header to make sense, the header needs to define the type <code>stack</code> before, not only the type <code>struct stack</code>. Or maybe the second line should read <code>struct stack</code> or <code>struct stack*</code>or <code>s</code>. Typedefing pointer types is by the way an idea of questionable wisdom."}, {"owner": {"reputation": 166, "user_id": 10351895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zR6-PTi3rKc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM9kFgVyXnyItj2OBR3ofGDJMetmg/mo/photo.jpg?sz=128", "display_name": "Serafin William", "link": "https://stackoverflow.com/users/10351895/serafin-william"}, "edited": false, "score": 0, "creation_date": 1545188518, "post_id": 53843691, "comment_id": 94535889, "body": "You haven&#39;t define your stack yet. To check if the stack is empty you can do something like <code>if(top == -1)</code> Then <code>return 1</code> else <code>return 0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 0, "last_activity_date": 1545190050, "creation_date": 1545190050, "answer_id": 53844166, "question_id": 53843691, "link": "https://stackoverflow.com/questions/53843691/how-to-initialize-a-pointer-to-a-stack/53844166#53844166", "title": "how to initialize a pointer to a stack", "body": "<p>You could implement your <code>stack empty()</code> function in your <code>stack.c</code> file like this: </p>\n\n<pre><code>struct stack *\nempty() {\n    struct stack *s = malloc(sizeof (struct stack));\n    s-&gt;size = 0.0;\n    return s;\n}\n</code></pre>\n\n<p>But, you should move the entire definition of <code>struct stack</code> into the header file.</p>\n"}], "owner": {"reputation": 13, "user_id": 10772680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XAFpCyWZmwU/AAAAAAAAAAI/AAAAAAAAAA8/9a0fNezkNl0/photo.jpg?sz=128", "display_name": "bouhou imad", "link": "https://stackoverflow.com/users/10772680/bouhou-imad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53844166, "answer_count": 1, "score": -1, "last_activity_date": 1545190050, "creation_date": 1545186058, "question_id": 53843691, "link": "https://stackoverflow.com/questions/53843691/how-to-initialize-a-pointer-to-a-stack", "title": "how to initialize a pointer to a stack", "body": "<p>if we define a stack like this in a HEADER stack.h,</p>\n\n<pre><code>typedef struct stack *s;\nstack empty();\n</code></pre>\n\n<p>and in the stack.c file we have this </p>\n\n<pre><code>struct stack {\n    double size;\n    double values[100];\n};\n</code></pre>\n\n<p>how to write a function to return a created stack <code>stack empty();</code>, in .c the file .</p>\n"}, {"tags": ["c++", "c", "recursion", "iteration"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1545186033, "post_id": 53843647, "comment_id": 94535397, "body": "The &quot;p is doubled&quot; part is supposed to be taken as a modification to the <i>stored</i> value of <code>p</code> (with the result subsequently added to <code>r</code>).  You are instead adding twice <code>p</code> to <code>r</code> without updating <code>p</code>."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1545186447, "post_id": 53843647, "comment_id": 94535465, "body": "Near dupe: <a href=\"https://stackoverflow.com/q/13666591/179910\">stackoverflow.com/q/13666591/179910</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545187340, "post_id": 53843647, "comment_id": 94535642, "body": "You tell us what is not perfect with your algorithms, then we can help find the reason. I.e. please describe what is wrong, what happens unexpectedly, what does not happen though desired, crash, hang, wrong result, in which cases?"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 1, "creation_date": 1545187772, "post_id": 53843647, "comment_id": 94535713, "body": "<code>qp = (q-1)p + p</code> makes sense, but second condition <code>(q&#47;2)(2p) + 2p = 2p+qp != pq</code> can someone explain this for me?"}, {"owner": {"reputation": 447, "user_id": 8187161, "user_type": "registered", "profile_image": "https://graph.facebook.com/1101110429989081/picture?type=large", "display_name": "Binara Medawatta", "link": "https://stackoverflow.com/users/8187161/binara-medawatta"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545187812, "post_id": 53843647, "comment_id": 94535719, "body": "@Yunnosch edited with the issue&#39;"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545188535, "post_id": 53843647, "comment_id": 94535894, "body": "@JohnBollinger pointed out one mistake: <i>&quot;p is doubled&quot;</i> means you should <b>modify <code>p</code></b>, not just use <code>2*p</code> in your expression"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545202316, "post_id": 53843647, "comment_id": 94539485, "body": "For the recursive algorithm, I&#39;d prefer stop condition  <code>if(q==0) return 0;</code> If anybody tried to multiply 7*0, you&#39;d be caught in endless recursion otherwise..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545202664, "post_id": 53843647, "comment_id": 94539640, "body": "Have you tried multiplying 7*-1? Negative input is valid with int, if you cannot cover it correctly, you&#39;re in trouble as well. Easy fix for iterative version: <code>if (q &lt; 0) { q = -q; p = -p; }</code>. You don&#39;t want to have that check in every recursion, so you might have a separate non-recursive entry function calling the recursive one afterwards. The other variant: exclude negative input by using <i>unsigned</i> int..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545202952, "post_id": 53843647, "comment_id": 94539768, "body": "Swapping p and q if abs(p) &lt; abs(q) should - at least for larger values - result in some performance benefit."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545206452, "post_id": 53843647, "comment_id": 94541243, "body": "Side note: Considering the fix of algorithm in given answers, you can merge if and else into one single branch: <code>while(q) { r += q%2 * p; p*=2; q&#47;=2; }</code>: r will be added 0, if q is even, p otherwise; fine so far; after subtracting 1 in case q is odd, next time q <i>is</i> even. And for both <code>q == 2*n</code> and <code>q == 2*n+1</code> the result of <code>q&#47;2</code> is <code>n</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545202317, "post_id": 53845748, "comment_id": 94539486, "body": "Would you like to highlight and maybe even explain the difference?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545204712, "post_id": 53845748, "comment_id": 94540546, "body": "Some part for explanation: Why don&#39;t I have to add on multiplying by 2? Imagine I only divide by two all the time? Answer: At some point, even powers of two will reach value 1, and thus one final add <i>will</i> occur under any circumstances..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545241295, "post_id": 53845748, "comment_id": 94560942, "body": "No it is not. And the fact that you think so is supporting my proposal to make the difference more obvious."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 447, "user_id": 8187161, "user_type": "registered", "profile_image": "https://graph.facebook.com/1101110429989081/picture?type=large", "display_name": "Binara Medawatta", "link": "https://stackoverflow.com/users/8187161/binara-medawatta"}, "edited": false, "score": 0, "creation_date": 1545246388, "post_id": 53845748, "comment_id": 94563158, "body": "@BinaraMedawatta Fact is - the algorithm as described in the question simply is <i>wrong</i> - no matter if you cited from question sheet as is or introduced the error yourself... But if you discover really having cited 1:1, then you should contact professor/examiner/... and hint him/her to the error."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1545249010, "last_edit_date": 1545249010, "creation_date": 1545201181, "answer_id": 53845748, "question_id": 53843647, "link": "https://stackoverflow.com/questions/53843647/stucked-up-with-indirect-multiplication-algorithm/53845748#53845748", "title": "Stucked up with Indirect Multiplication Algorithm", "body": "<p>The algorithm in your quote box is wrong.  It should be:</p>\n\n<blockquote>\n  <p>If the product expected is r (initially 0) then, if q is odd p is added to r and q is reduced by 1, If q is even p is doubled and q is halved(i.e. q becomes q/2)</p>\n</blockquote>\n\n<p>That is, when q is even, you JUST double p, you DO NOT add it to r.</p>\n\n<p>It's also missing the implicit termination condition of q == 0</p>\n\n<p>This corresponds to simple binary long-mulitplication -- for each 1 bit in q you add p left shifted by the position of the 1 bit; for each 0 bit in q you do nothing.</p>\n\n<p>This is usually written as</p>\n\n<pre><code>while (q != 0) {\n    if (q &amp; 1)  // q is odd\n        r += p;\n    p *= 2;\n    q /= 2;\n}\n</code></pre>\n\n<p>That's because when q is odd, subtracting 1 will make it even, so you can immediately do the next step of doubling p and halving q.  Since integer division rounds down, dividing the odd number by 2 also does the -1 implicitly.</p>\n"}, {"comments": [{"owner": {"reputation": 54, "user_id": 10784315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtBov1jbNKk/AAAAAAAAAAI/AAAAAAAACGU/Pa9R61HyPsA/photo.jpg?sz=128", "display_name": "Kazi", "link": "https://stackoverflow.com/users/10784315/kazi"}, "reply_to_user": {"reputation": 447, "user_id": 8187161, "user_type": "registered", "profile_image": "https://graph.facebook.com/1101110429989081/picture?type=large", "display_name": "Binara Medawatta", "link": "https://stackoverflow.com/users/8187161/binara-medawatta"}, "edited": false, "score": 0, "creation_date": 1545242283, "post_id": 53846199, "comment_id": 94561374, "body": "@BinaraMedawatta you&#39;re welcome, but technically the question is wrong. If you decrease the value of q by 1 , it will never give you the correct result. Hope I could help you."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1545247484, "post_id": 53846199, "comment_id": 94563625, "body": "The algorithm given will never terminate once you get q is odd.  Your sample code just uses <code>*</code> (builtin multiply) to avoid that case, but can&#39;t really mulitply as a result."}], "tags": [], "owner": {"reputation": 54, "user_id": 10784315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtBov1jbNKk/AAAAAAAAAAI/AAAAAAAACGU/Pa9R61HyPsA/photo.jpg?sz=128", "display_name": "Kazi", "link": "https://stackoverflow.com/users/10784315/kazi"}, "is_accepted": true, "score": 1, "last_activity_date": 1545203361, "creation_date": 1545203361, "answer_id": 53846199, "question_id": 53843647, "link": "https://stackoverflow.com/questions/53843647/stucked-up-with-indirect-multiplication-algorithm/53846199#53846199", "title": "Stucked up with Indirect Multiplication Algorithm", "body": "<p>The algorithm will work fine if you follow the rule below instead of the one you stated:</p>\n\n<blockquote>\n  <p>If the product expected is r (initially 0) then, if q is odd p is added to r , If q is even p is doubled and q is halved(i.e. q becomes q/2)</p>\n</blockquote>\n\n<p>Sample code:</p>\n\n<pre><code>int mult(int p,int q){\n\nint r=0;\n\nif(q%2==1)\n{\n    if(q!=1)\n    {\n        r+=p;\n        //q--;\n        return r*q;\n    }\n\n    r+=p;\n    return r*q;\n}\n\nelse if(q%2==0)\n{\n    if(q!=0)\n    {\n        p=p*2;\n        r+=p;\n        q=q/2;\n\n        return r*q;\n    }\n\n    return 0;\n\n}}\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 8187161, "user_type": "registered", "profile_image": "https://graph.facebook.com/1101110429989081/picture?type=large", "display_name": "Binara Medawatta", "link": "https://stackoverflow.com/users/8187161/binara-medawatta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 53846199, "answer_count": 2, "score": -2, "last_activity_date": 1577088655, "creation_date": 1545185544, "last_edit_date": 1577088655, "question_id": 53843647, "link": "https://stackoverflow.com/questions/53843647/stucked-up-with-indirect-multiplication-algorithm", "title": "Stucked up with Indirect Multiplication Algorithm", "body": "<p>While I was getting ready for an exam I found a question that asks for an algorithm for indirect multiplication.</p>\n\n<p>Question : </p>\n\n<blockquote>\n  <p>Two integers <em>p</em> and <em>q</em> can be indirectly multiplied by the following method.</p>\n  \n  <p>If the product expected is r (initially 0) then, if q is odd p is added to r and q is reduced by 1, If q is even p is doubled and q is halved(i.e. q becomes q/2)\n  If <em>q</em> is even <em>p</em> is doubled and added to <em>r</em> and <em>q</em> is halved(i.e. <em>q</em> becomes <em>q</em>/2)</p>\n</blockquote>\n\n<p>It is further stated that indirect multiplication is used in digital computers in which the direct multiplication is expensive</p>\n\n<p>And by trying for hours I managed to find an iterative and a recursive algorithm, but they aren't perfect.</p>\n\n<p>Iterative</p>\n\n<pre><code>int multiply(int p, int q){\n    int r=0;\n    while(q!=0){\n        if(q%2==1){\n            r += p;\n            q--;\n        }\n        else{\n            r += 2*p;\n            q = q/2;\n        }\n    }\n    return r;\n}\n</code></pre>\n\n<p>Recursive</p>\n\n<pre><code>int multiplyRec(int p, int q){\n    if(q==1)\n        return p;\n    if(q%2==1){\n        return (p + multiplyRec(p, q-1));\n    }\n    else{\n        return (2*p + multiplyRec(p, q/2));\n    }\n}\n</code></pre>\n\n<p>For example, when I multiply 6 by 5 the answer in both algorithms is 36 while it has to be 30. But if I change it in a way to get 30 then multiplying by 1 fail.</p>\n\n<p>I was surfing the internet but couldn't find a match.\nCan somebody please explain what is wrong with the above algorithms or if there is an error or if there is a better way to do them.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 5, "creation_date": 1545185022, "post_id": 53843568, "comment_id": 94535200, "body": "This code is incomplete.  <code>b</code> and <code>x</code> are not declared, and <code>accNum0</code>, <code>accNum1</code>, and <code>accNum2</code> are unused.  Please update your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that others can compile and run that reproduces your problem along with input, expected output, and actual output."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6728231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1edb86e61c5122efc8f3420e777ca?s=128&d=identicon&r=PG&f=1", "display_name": "rivermouth91", "link": "https://stackoverflow.com/users/6728231/rivermouth91"}, "edited": false, "score": 0, "creation_date": 1545208570, "post_id": 53843630, "comment_id": 94542171, "body": "Thanks! I think that cleared it up. I thought that double eta[n]; would already specify the vector to be 0 but I guess that&#39;s not the case."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 29, "user_id": 6728231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1edb86e61c5122efc8f3420e777ca?s=128&d=identicon&r=PG&f=1", "display_name": "rivermouth91", "link": "https://stackoverflow.com/users/6728231/rivermouth91"}, "edited": false, "score": 0, "creation_date": 1545248173, "post_id": 53843630, "comment_id": 94563881, "body": "C requires explicit initialization for local variables. There is only implicit initialization to zero for variables with static duration (typically global variables)."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 5, "last_activity_date": 1545185364, "creation_date": 1545185364, "answer_id": 53843630, "question_id": 53843568, "link": "https://stackoverflow.com/questions/53843568/cumulative-sum-in-c-is-blowing-up-to-infinity/53843630#53843630", "title": "Cumulative sum in C is blowing up to infinity", "body": "<p>There might be errors with how you are initializing <code>b</code> or <code>x</code>. However, one definite error is that <code>eta</code> is being used uninitialized. This means <code>eta[i]</code> may begin with some arbitrary value instead of <code>0</code> as you are likely expecting.</p>\n\n<p>Add an initialization before accumulating into it.</p>\n\n<pre><code>  for(i = 0; i &lt; n; i++) {\n    eta[i] = 0;\n    for (j = 0; j &lt; p; j++)\n      eta[i] += b[j] * x[n * j + i];\n  }\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6728231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1edb86e61c5122efc8f3420e777ca?s=128&d=identicon&r=PG&f=1", "display_name": "rivermouth91", "link": "https://stackoverflow.com/users/6728231/rivermouth91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545185364, "creation_date": 1545184821, "question_id": 53843568, "link": "https://stackoverflow.com/questions/53843568/cumulative-sum-in-c-is-blowing-up-to-infinity", "title": "Cumulative sum in C is blowing up to infinity", "body": "<p>I'm generally an R user but I am trying to use to C for some lower level cumulative sums and multiplications. </p>\n\n<p>I am trying to generate a cumulative sum of <strong>eta</strong> and storing the result in <strong>tmp0</strong>. However, when I output <strong>tmp0</strong> it either gives me Inf, NaN, or some arbitrarily large number. I double checked the same cumulative sum in R and it works fine; I am not sure why C is not handling it. Below is the code that I am using:</p>\n\n<pre><code>   int i,j;\n   const int p = ncov,  n = nin;\n   double accNum0[n]; //accumulate first part of likelihood sum eta_i\n   double accNum1[n]; //accumulate the backwards numerator\n   double accNum2[n]; //acumulate the forward numerator (weighted)\n   double tmp0 = 0;\n\n  double eta[n]; //calculate linear predictor in this step (X %*% beta)\n  for(i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; p; j++)\n      eta[i] += b[j] * x[n * j + i];\n  }\n\n  for (i = 0; i &lt; n; ++i) {\n    tmp0 += eta[i];\n  }\n\n  return (tmp0);\n</code></pre>\n\n<p>Again, I am fairly new to C so I may be making some rookie mistakes and would greatly appreciate any (and all) suggestions!</p>\n"}, {"tags": ["c++", "c", "amazon-web-services", "ide", "aws-cloud9"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1545184896, "post_id": 53843233, "comment_id": 94535173, "body": "Just install a modern version of the compiler on your own computer instead of mucking with cloud stuff."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 2235373, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b5764df7e5c86e5707ffe73e15e091e7?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2235373/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1555280296, "creation_date": 1555280296, "answer_id": 55680522, "question_id": 53843233, "link": "https://stackoverflow.com/questions/53843233/gcc-or-clang-version-on-amazon-aws-cloud-9/55680522#55680522", "title": "GCC or Clang Version on Amazon AWS Cloud 9?", "body": "<p>The following command got my Cloud 9 IDE up to gcc version 7.2.1</p>\n\n<p>sudo yum -y groupinstall \"Development Tools\"</p>\n\n<p>gcc --version\ngcc (GCC) 7.2.1 20170915 (Red Hat 7.2.1-2)\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n"}], "owner": {"reputation": 11119, "user_id": 714232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5c961cd3b42bb2667dff836fd27c1418?s=128&d=identicon&r=PG", "display_name": "haziz", "link": "https://stackoverflow.com/users/714232/haziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1555280296, "creation_date": 1545181434, "question_id": 53843233, "link": "https://stackoverflow.com/questions/53843233/gcc-or-clang-version-on-amazon-aws-cloud-9", "title": "GCC or Clang Version on Amazon AWS Cloud 9?", "body": "<p>When using Cloud 9 (now owned by Amazon and run as part of their AWS service) as an onlinet IDE for C and C++, and other compiled languages, it seems to create a virtual machine that uses version 4.8.5 of GCC. How do I use a more modern version of GCC, in order to utilize the C11 standard (and C18 revisions) and C++11 (and C++17 revisions) and to better utilize the more comprehensible and more friendly compiler error messages of more recent GCC, and Clang, versions.</p>\n\n<p>How do I \"request\" or install a more modern version of GCC or possibly use a recent version of Clang as the compiler from within the Cloud 9 AWS instance/virtual machine?</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1545181572, "post_id": 53843218, "comment_id": 94534564, "body": "For one thing, you have created a matrix of pointers and then try to stuff chars into it. What do you think char *matrix[rows]; does?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545181595, "post_id": 53843218, "comment_id": 94534570, "body": "What data do you think the definition <code>char *matrix[rows];</code> points at?  The short answer is &#39;none&#39;, so you get crashes. You need to allocate space for the columns.  The simplest would be <code>char matrix[rows][columns];</code> \u2014 but your call.  Change the function interface, too; it is no longer accurate."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545181814, "post_id": 53843218, "comment_id": 94534610, "body": "The message <code>Segmentation fault (core dumped)</code> is a valuable message that tells you that you screwed up (or, if it isn&#39;t your program, someone else screwed up).  And the <code>core dumped</code> part means you could run a debugger on the program and the core dump and you might be able to find out more about what went wrong when the crash happened.  The Windows message says much the same; I&#39;m not sure that you can do a post mortem analysis with a debugger on Windows."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1545186708, "post_id": 53843218, "comment_id": 94535512, "body": "I&#39;ve corrected your title, as you&#39;re not <i>writing</i> anything - fgetc() reads. Also, the first error you describe (<i>NullReferenceException: Object reference not set to an instance of an object</i>) is impossible to get in C, because a) there is nothing even remotely resembling an <i>object</i> in the code you&#39;ve posted).  and b) C does not have <i>objects</i>.. Enable hints and warnings for your compiler, and read those hints and warnings."}], "answers": [{"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 0, "last_activity_date": 1545186974, "creation_date": 1545186974, "answer_id": 53843806, "question_id": 53843218, "link": "https://stackoverflow.com/questions/53843218/reading-file-content-line-by-line-into-a-matrix/53843806#53843806", "title": "Reading file content line by line into a matrix", "body": "<p>You have to allocate memory for each element of <code>matrix</code>. This is the same exact mistake as writing:</p>\n\n<pre><code>char *s = \"string\";\n</code></pre>\n\n<p>As the first act of the program, loop through <code>matrix</code>, and call <code>malloc</code> for each cell:</p>\n\n<pre><code>int i;\nfor (i = 0; i &lt; 5; ++i)\n    if (!(matrix[i] = malloc(MAXLEN))) [\n        perror(\"malloc\");\n        exit(EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>Note: we check the return value of <code>malloc</code> to ensure no errors have occurred.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8554335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1babfb5dbb53dff81f32ca5adadf2391?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Agusto", "link": "https://stackoverflow.com/users/8554335/kevin-agusto"}, "is_accepted": false, "score": 0, "last_activity_date": 1545199660, "creation_date": 1545199660, "answer_id": 53845450, "question_id": 53843218, "link": "https://stackoverflow.com/questions/53843218/reading-file-content-line-by-line-into-a-matrix/53845450#53845450", "title": "Reading file content line by line into a matrix", "body": "<p>with your code, i think the matrix in the file will restricted (you define rows=5 and columns=12). so i think again to write a code that can be flexible, no need to set max row or column again. here we go</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; //malloc realloc\n\n//file read function. returning string with splitted new line\n//ex: (note: newline is '\\n' (ENTER))\n//test.txt:\n//10 20 30(space)(newline)\n//40 50 60(space)(newline)\n\nvoid file_to_matrix(char *filename)\n{\n    FILE * file = fopen(filename, \"r\");\n    char *buff = (char*)malloc(sizeof(char)); //temp string\n    int *matrix_row = (int*)malloc(sizeof(int)); //temp matrix row\n    int **MATRIX = (int**)malloc(sizeof(int*)); //this will become the final matrix\n    int index_buff = 0, index_MATRIX = 0, index_matrix_row = 0; \n    while (1)\n    {\n        char c = getc(file);\n        if (c==EOF)\n        {\n            break;\n        }\n        if (c=='\\n') //if c meet newline, then add the matrix row to final matrix \n        {\n            (*(MATRIX+index_MATRIX)) = matrix_row;\n            index_MATRIX++;\n            MATRIX = realloc(MATRIX, sizeof(MATRIX)*(index_MATRIX+1));\n            matrix_row = (int*)malloc(sizeof(int));\n            index_matrix_row = 0;\n            printf(\"\\n\");\n            continue;\n        }\n        if (c==' ') //if c meet space, then buff wil converted to int\n        {\n            int num = atoi(buff);\n            printf(\"%d \", num);\n            (*(matrix_row+index_matrix_row)) = num;\n            index_matrix_row++;\n            matrix_row = realloc(matrix_row, sizeof(int)*(index_matrix_row+1));\n            free(buff);\n            buff = (char*)malloc(sizeof(char));\n            index_buff=0;\n            continue;\n        }\n\n        //add buff with c\n        (*(buff+index_buff))=c;\n        index_buff++;\n        buff = realloc(buff, sizeof(char)*(index_buff+1));\n    }\n    fclose(file);\n\n\n    //clearing the dynamic memory\n    free(buff);\n    for (int i = 0; i &lt; index_MATRIX; i++)\n    {\n        free(MATRIX[i]);\n    }\n}\n\nint main()\n{\n    file_to_matrix(\"test.txt\");\n    return 0;\n}\n</code></pre>\n\n<p>test.txt:</p>\n\n<pre><code>10 20 30 \n40 50 60 \n70 80 90 \n</code></pre>\n\n<p>if you confused with the test.txt format, i will explain again:</p>\n\n<pre><code>10 20 30(space)(newline)\n30 40 60(space)(newline)\n70 80 90(space)(newline)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10808668, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oYvIXU-CuEc/AAAAAAAAAAI/AAAAAAAAfFY/EWl6DnfQKJE/photo.jpg?sz=128", "display_name": "Morgan Casale", "link": "https://stackoverflow.com/users/10808668/morgan-casale"}, "is_accepted": false, "score": 0, "last_activity_date": 1545262816, "last_edit_date": 1545262816, "creation_date": 1545262257, "answer_id": 53860596, "question_id": 53843218, "link": "https://stackoverflow.com/questions/53843218/reading-file-content-line-by-line-into-a-matrix/53860596#53860596", "title": "Reading file content line by line into a matrix", "body": "<p>Thank you for your replies, I think your solutions are very clever but I was looking  to an easier one.</p>\n\n<p>After a little bit of trial and error I think I found a solution that it isn't very generalized but it's simple and it seems to work fine:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define ROWS &lt;n of rows&gt;\n#define COLS &lt;n of columns&gt;\n\nvoid file_to_matrix(int rows, int cols, char matrix[rows][cols], char file_path[]){\n    FILE *file = fopen(file_path, \"r\");\n    if(file==NULL){\n        printf(\"File error\");\n        exit(1);\n    }\n    int y=0;\n    for(int x=0; (matrix[y][x]=getc(file))!=EOF; ++x){\n        if(matrix[y][x]=='\\n'){\n            matrix[y][x]='\\0';\n            ++y;\n            x=-1;\n        }\n    }\n        fclose(file);\n    }\n\nint main(){\n    char matrix[ROWS][COLS+2];\n    file_to_matrix(ROWS, COLS+2, matrix, \"file path\");\n    for(int i=0; i&lt;=ROWS; ++i){\n        printf(\"%s\\n\", matrix[i]);\n    }\n}\n</code></pre>\n\n<p>Thank you again for your answers</p>\n"}], "owner": {"reputation": 3, "user_id": 10808668, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oYvIXU-CuEc/AAAAAAAAAAI/AAAAAAAAfFY/EWl6DnfQKJE/photo.jpg?sz=128", "display_name": "Morgan Casale", "link": "https://stackoverflow.com/users/10808668/morgan-casale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545262816, "creation_date": 1545181336, "last_edit_date": 1545186541, "question_id": 53843218, "link": "https://stackoverflow.com/questions/53843218/reading-file-content-line-by-line-into-a-matrix", "title": "Reading file content line by line into a matrix", "body": "<p>I was trying to write a function that could copy a text file content line by line to a matrix, so this is what I came up with:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define rows 5\n#define columns 12\n\nvoid file_to_matrix(char *matrix[]){\n    FILE *file = fopen(\"swamp.txt\", \"r\");\n\n    if(file==NULL){\n        printf(\"File error\");\n        exit(1);\n    }\n\n    int y=0;\n\n    for(int x=0; (matrix[y][x]=fgetc(file))!=EOF; ++x){\n        if(matrix[y][x]=='\\n'){\n            ++y;\n            x=0;\n        }\n    }\n\n    fclose(file);\n}\n\nint main(){\n    char *matrix[rows];\n\n    file_to_matrix(matrix);\n\n    for(int i=0; i&lt;5; ++i){\n        for(int j = 0; j &lt; 11; j++){\n            printf(\"%c\", matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>I tried to compile and run it on Windows and Linux but the only thing that it manages to do is giving me errors that are practically useless like:</p>\n\n<pre><code>\"Stopping due to fatal error: NullReferenceException: Object reference not set to an instance of an object\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>\"Segmentation fault (core dumped)\"\n</code></pre>\n"}, {"tags": ["c#", "c", "embedded-linux", "shared-memory", "memory-mapped-files"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545185392, "post_id": 53843144, "comment_id": 94535271, "body": "Have you considered simply leaving the segment mapped instead of opening and mapping it again and again?"}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 2, "last_activity_date": 1545181535, "creation_date": 1545181535, "answer_id": 53843247, "question_id": 53843144, "link": "https://stackoverflow.com/questions/53843144/how-do-i-close-a-shm-open-file-descriptor-without-unlinking-it/53843247#53843247", "title": "How do I close a shm_open file descriptor without unlinking it?", "body": "<p>The <code>close</code> function is the mechanism for closing any type of file descriptor, including ones referring to shared memory.</p>\n"}], "owner": {"reputation": 169, "user_id": 10297190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/371ab8d74f62315f2c852a49221becfa?s=128&d=identicon&r=PG&f=1", "display_name": "cli2", "link": "https://stackoverflow.com/users/10297190/cli2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 53843247, "answer_count": 1, "score": 1, "last_activity_date": 1545181535, "creation_date": 1545180483, "question_id": 53843144, "link": "https://stackoverflow.com/questions/53843144/how-do-i-close-a-shm-open-file-descriptor-without-unlinking-it", "title": "How do I close a shm_open file descriptor without unlinking it?", "body": "<p>I have a common shared memory space that multiple processes can read and write to it. I am running into this problem where I am using <code>shm_open()</code> to the access the shared memory and <code>mmap()</code> to write to the memory mapped file. However, after a few calls to my wrapper method I will run into <code>ERRNO 24</code> (Too many files opened) when I call <code>shm_open()</code>.</p>\n\n<p>I tried using <code>shm_unlink()</code>, but that closes the name associated to the shared memory space, and I am unable to access that memory with the associated name again. How do I close the file descriptor and leave the name associated to the shared memory alone?</p>\n\n<p>Essentially I want the wrapper function to do this:</p>\n\n<pre><code>public static void Write(string name, int size, int offset, List&lt;byte&gt; data)\n{\n    int fd = shm_open(name, O_RDWR, S_IWUSR | S_IWOTH);\n    if(fd &lt; 0)  { // throw error }\n\n    IntPtr *ptr = mmap(null, shmSize, PROT_WRITE, MAP_SHARED, fd, 0);\n    if(ptr &lt; 0) { // throw error }\n\n    foreach(byte in data) { // write to shared memory }\n\n    munmap(ptr, shmSize);\n\n    shm_close(fd) // &lt;-- I want to do equivalent of this\n\n}\n</code></pre>\n\n<p>To make things a little more complicated. I am developing using C# in Linux environment and using DLL imports to call the Linux native functions.</p>\n"}, {"tags": ["c", "memory", "dynamic", "segmentation-fault", "allocation"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1545185959, "post_id": 53843105, "comment_id": 94535379, "body": "Looks like you misread the <code>memccpy</code> description. Pay attention to the last two arguments. There are plenty other problems, but address this first."}, {"owner": {"reputation": 23, "user_id": 9374757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47e4817c0281419e4f241f8d4e85ed41?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz2121", "link": "https://stackoverflow.com/users/9374757/grzegorz2121"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1545187201, "post_id": 53843105, "comment_id": 94535618, "body": "Ahh that was the mistake... I didnt realise that i had used the wrong function! It is supposed to be memcpy not memccpy... Just a stupid typo. Thanks for help!"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1545201062, "post_id": 53843105, "comment_id": 94538975, "body": "OT: <code>if((97&lt;=c &amp;&amp; c&lt;=112) || (65&lt;=c &amp;&amp; c&lt;=90))</code> is unecessary hard to read. Why not <code>if ((&#39;a&#39; &lt;= c &amp;&amp; c &lt;= &#39;z&#39;) || (&#39;A&#39; &lt;= c &amp;&amp; c &lt;= &#39;Z&#39;))</code>? It&#39;s easier to read and produces the exact same code. You may also have a look at <a href=\"https://en.cppreference.com/w/c/string/byte/isalpha\" rel=\"nofollow noreferrer\"><code>isalpha()</code></a>. (It&#39;s usually implemented as look-up in a table.)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1545201367, "post_id": 53843105, "comment_id": 94539104, "body": "Oops. I just realized that 112 is the ASCII of <code>&#39;p&#39;</code>. Either, you made a typo and meant 122 (ASCII of <code>&#39;z&#39;</code>) or my above recommendation should be fixed appropriately. However, it shows impressively why it makes sense to use character constants instead of integer constants for character comparisons. ;-)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545202405, "post_id": 53843105, "comment_id": 94539524, "body": "<code>do {char_ptr = (char*)calloc(1,sizeof(char));} while(char_ptr==NULL);</code> is a horrible way to allocate and validate. If <code>calloc</code> fails, it failed for a reason and it will likely fail for the exact same reason continually resulting in an infinite loop. Further calling <code>calloc</code> to allocate a single character is pointless. You use 8-bytes for the pointer, plus the <code>calloc</code> call to allocate 1-char? Even in a <code>realloc</code> scheme, incremental allocation by <code>1-byte</code> is horribly inefficient. Also see: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a>"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1545223054, "post_id": 53843105, "comment_id": 94550096, "body": "And <code>getch()</code> is not a standard function and is better avoided."}], "owner": {"reputation": 23, "user_id": 9374757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47e4817c0281419e4f241f8d4e85ed41?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz2121", "link": "https://stackoverflow.com/users/9374757/grzegorz2121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545180103, "creation_date": 1545180103, "question_id": 53843105, "link": "https://stackoverflow.com/questions/53843105/custom-console-input-code-sometimes-wrong-output", "title": "Custom console input code, sometimes wrong output", "body": "<p>I was testing my code by writing bunch of characters and \"correcting\" it by using backspace a couple of times in quick succession. Normally the code works but after that brutal treatment the output consists of few letters from the screen and bunch of null characters afterwards. I want to spam proof that function.</p>\n\n<p>The function gets a character from the keyboard then checks if the char is a enter, backspace or lowercase, capital letter\nif it is a enter it adds a null char on the end and returns,\nif it is a letter it expands the array of chars by one and adds the char at the end.\nif it is a backspace it creates another array 1 smaller than previous one and moves 1 element less from the original array to the new one. After that it deletes old array and assigns the new one to the old pointer.</p>\n\n<p>I even fixed the null pointer bug that occurred randomly.</p>\n\n<p>Do anybody have any ideas why does it outputs trash?\nIs there a way to clear the input buffer before it loads another char?</p>\n\n<pre><code>char* readString()\n    {\n        int current_char=0;\n        char *char_ptr;\n\n        do{\n        char_ptr = (char*)calloc(1,sizeof(char));\n        }while(char_ptr==NULL);\n\n        while(true)\n        {\n\n            char c = getch();\n\n            if(c==13)\n            {\n                *(char_ptr+current_char)=0;\n                printf(\"\\n\\n\");\n\n                for(int i=0;i&lt;current_char+1;i++)\n                {\n                    printf(\"%i \\n\", *(char_ptr+i));\n                }\n                return char_ptr;\n            }\n            if((97&lt;=c &amp;&amp; c&lt;=112) || (65&lt;=c &amp;&amp; c&lt;=90))\n            {\n                printf(\"%c\",c);\n                *(char_ptr+current_char)=c;\n                current_char++;\n\n                do\n                {\n                    char_ptr = (char*)realloc(char_ptr, sizeof(char)*(current_char+1));\n                }while(char_ptr==NULL);\n\n\n            }\n            if(c==8)\n            {\n                if(current_char==0)\n                {\n                    continue;\n                }\n                printf(\"%c\",c);\n                printf(\" \");\n                printf(\"%c\",c);\n                current_char--;\n                if(current_char==0)\n                {\n                    free(char_ptr);\n\n                    do{\n                    char_ptr = (char*)calloc(1,sizeof(char));\n                    }while(char_ptr==NULL);\n\n                }\n                else\n                {\n                    char * next_pointer;\n\n                    do{\n                    next_pointer = (char*)calloc((current_char+1),sizeof(char));\n                    }while(next_pointer==NULL);\n\n                    memccpy(next_pointer, char_ptr, (current_char), sizeof(char));\n\n                    free(char_ptr);\n                    char_ptr=next_pointer;\n                    next_pointer=NULL;\n                }\n\n            }\n\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "sockets", "unix", "io"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1545179751, "post_id": 53842980, "comment_id": 94534195, "body": "Those restrictions apply to files opened with update mode. Not sure how that has anything to do with sockets. So I&#39;m pretty sure that you&#39;ve taken something out of context."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1545182049, "post_id": 53842980, "comment_id": 94534644, "body": "Are you using <code>fdopen()</code> to get FILE pointers backed by sockets?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1545183358, "post_id": 53842980, "comment_id": 94534878, "body": "The text you quote is about <code>FILE *</code> file streams.  It does not apply to <code>int</code> file descriptors.  If you convert a socket file descriptor into a read/write file stream, then you have to obey those rules, officially.  But life could get interesting (meaning &#39;confusing&#39;) if you try that \u2014 I recommend against it."}], "owner": {"reputation": 2896, "user_id": 9623401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc011e4b0c3f14ea473726be49db282?s=128&d=identicon&r=PG&f=1", "display_name": "amjad", "link": "https://stackoverflow.com/users/9623401/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545179095, "creation_date": 1545179095, "question_id": 53842980, "link": "https://stackoverflow.com/questions/53842980/standard-i-o-streams-restrictions-on-network-sockets", "title": "Standard I/O streams restrictions on network sockets?", "body": "<p>I'm a beginner in C and Linux, just have a question on standard I/O on socket.\nMy textbook says that there are two restrictions for network socket:</p>\n\n<p><strong><em>An input function cannot follow an output function without an intervening call to fflush, fseek, fsetpos, or rewind. And An output function cannot follow an input function without an intervening call to fseek, fsetpos, or rewind, unless the input function encounters an end-of-file</em></strong></p>\n\n<p>I don't really get it, could anyone provide a code example to explain why</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 1922, "user_id": 831031, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3fd739b62c1895d1db98eab81ffecbef?s=128&d=identicon&r=PG&f=1", "display_name": "SanSolo", "link": "https://stackoverflow.com/users/831031/sansolo"}, "edited": false, "score": 0, "creation_date": 1545184880, "post_id": 53842604, "comment_id": 94535171, "body": "There&#39;s only one way, so there is not much in terms of how many ways. Any C textbook, any <a href=\"https://www.tutorialspoint.com/cprogramming/c_structures.htm\" rel=\"nofollow noreferrer\">tutorial</a> would have it. It is syllabus, not a tricky problem"}, {"owner": {"reputation": 1280, "user_id": 1973651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jvzoF.jpg?s=128&g=1", "display_name": "Circle Hsiao", "link": "https://stackoverflow.com/users/1973651/circle-hsiao"}, "edited": false, "score": 0, "creation_date": 1545186085, "post_id": 53842604, "comment_id": 94535410, "body": "It rather important to provide the context when you are asking about &quot;the best way&quot;. What we are going to compare? performance? design? semantic? You have to be very specific about the prerequisites. Besides, I can&#39;t see why not just use common way any book will teach you for this cause I don&#39;t think there will be significant difference."}], "answers": [{"comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1545192584, "post_id": 53843839, "comment_id": 94536672, "body": "This still creates an <code>Object</code>. The OP is a little unclear in their question, I&#39;m not sure if they&#39;re worried about the class declaration, or the object. It seems they are trying to create all objects once, then perhaps just reference them"}], "tags": [], "owner": {"reputation": 356, "user_id": 7850159, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-waMjeDlXzRE/AAAAAAAAAAI/AAAAAAAAAJM/-nICyEJzQxg/photo.jpg?sz=128", "display_name": "sundb", "link": "https://stackoverflow.com/users/7850159/sundb"}, "is_accepted": true, "score": 0, "last_activity_date": 1545187240, "creation_date": 1545187240, "answer_id": 53843839, "question_id": 53842604, "link": "https://stackoverflow.com/questions/53842604/c-programming-create-instances-of-a-struct-inside-a-function/53843839#53843839", "title": "C programming: create instances of a struct inside a function", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Object\n{\n    int color_;\n    char val_;\n} Object;\n\nObject* createObject(int color, int value) {\n    Object* o = malloc(sizeof(*o));\n    o-&gt;color_ = color;\n    o-&gt;val_ = value;\n    return o;\n}\n\nint main(int argc, char** argv) {\n    Object* olist[10];\n    olist[0] = createObject(1, 1);\n    printf(\"%d:%d\", olist[0]-&gt;color_, olist[0]-&gt;val_);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10676026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913986535f379cf29a439ec155beea9?s=128&d=identicon&r=PG&f=1", "display_name": "FrankS", "link": "https://stackoverflow.com/users/10676026/franks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53843839, "answer_count": 1, "score": -2, "last_activity_date": 1545187240, "creation_date": 1545175889, "question_id": 53842604, "link": "https://stackoverflow.com/questions/53842604/c-programming-create-instances-of-a-struct-inside-a-function", "title": "C programming: create instances of a struct inside a function", "body": "<p>I have a function <code>void createObject(int color, char value)</code>\nEverytime I call this function, an object of</p>\n\n<pre><code>struct Object\n{\n  int color_;\n  char val_;\n};\n</code></pre>\n\n<p>has to be created inside this function. What is the best way to do this? Could someone please just give me an example? EDIT: Is it possible to have these objects collected in a list and/or an array?</p>\n"}, {"tags": ["c", "arrays", "linked-list", "counter"], "comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1545174138, "post_id": 53842300, "comment_id": 94532847, "body": "If you compile that code as written, you&#39;re going to get a warning.  <code>if (current-&gt;name== search_for) </code> is comparing a character pointer:  <code>current-&gt;name</code> to a character: <code>search_for</code>.  Fix that without using a cast and it will have a far better chance of working.  Note that in C you cannot use <code>==</code> to compare two strings.  <code>strcmp()</code> is a function designed to do this."}, {"owner": {"reputation": 33, "user_id": 10808468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf0c7675c7dadfd5c3344ddd22e3cb4?s=128&d=identicon&r=PG&f=1", "display_name": "konoha", "link": "https://stackoverflow.com/users/10808468/konoha"}, "reply_to_user": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1545174615, "post_id": 53842300, "comment_id": 94532986, "body": "so instead of <code>if (current-&gt;name== search_for)</code> I should use <code>if(current-&gt;name==strcmp(search_for,&quot;tom&quot;)</code> ?"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1545176296, "post_id": 53842300, "comment_id": 94533422, "body": "No.  <code>strcmp()</code> takes two pointers to characters and returns an int.  <a href=\"http://man7.org/linux/man-pages/man3/strcmp.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/strcmp.3.html</a>  So you&#39;d pass <code>current-&gt;name</code> and <code>&quot;tom&quot;</code> as parameters, and consider them equal if and only if the return value is zero.  You need to consider changing the second parameter of <code>count()</code> from a <code>char</code> to a <code>char *</code>, that will let you pass in an arbitrary string to search for."}], "answers": [{"tags": [], "owner": {"reputation": 283, "user_id": 10237052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9138fe75c21cb665a08510ef11c7d4?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10237052/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1545186249, "creation_date": 1545186249, "answer_id": 53843712, "question_id": 53842300, "link": "https://stackoverflow.com/questions/53842300/counting-the-number-of-occurences-of-string-in-a-linked-list/53843712#53843712", "title": "counting the number of occurences of string in a linked list", "body": "<p>Your cannot compare two arrays of characters with ==. Instead, you must use the strcmp() function. The first (or second, order doesn't matter) must be the name of the current node in the linked list, and the other one will be the parameter you are passing into the function (search_for). strcmp() will return 0 if they are the same, in which case you would then increment your count variable.</p>\n"}, {"tags": [], "owner": {"reputation": 387, "user_id": 7725203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c6a243e01e63bc4a8efe01ced80888?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Winters", "link": "https://stackoverflow.com/users/7725203/alexis-winters"}, "is_accepted": true, "score": 0, "last_activity_date": 1545188019, "creation_date": 1545188019, "answer_id": 53843935, "question_id": 53842300, "link": "https://stackoverflow.com/questions/53842300/counting-the-number-of-occurences-of-string-in-a-linked-list/53843935#53843935", "title": "counting the number of occurences of string in a linked list", "body": "<p>There are a few errors in your code.</p>\n\n<ol>\n<li>You're count function takes in a node and a character. It should take in a node and a character array (char *).</li>\n<li>When you call count you are calling it with a char array and a char. You should be calling it with a node pointer and char array. Remember to designate strings with \"\" (i.e. \"tom\" not 'tom').</li>\n<li>You cannot compare to char arrays with ==. To do this use <a href=\"http://man7.org/linux/man-pages/man3/strcmp.3.html\" rel=\"nofollow noreferrer\">strcmp</a>.</li>\n</ol>\n\n<p>Here is a working version of your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;string.h&gt;\n\n#define MAXN 50     \n\ntypedef struct node {\n    char name[MAXN];\n    struct node *next;\n}\nnode;\n\nint count( node* head, char * search_for)  //Char * search_for instead of char search_for\n{ \n    node* current = head; \n    int count = 0; \n    while (current != NULL) \n    { \n        if (strcmp(current-&gt;name,search_for) == 0) { //using strcmp instead of ==\n           count++; \n        }\n        current = current-&gt;next; \n    } \n    return count; \n} \n\n\n\nint main (int argc, char **argv) {\n\n    FILE *file = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n    if (file == NULL)\n        return 1;\n\n    char buf[MAXN];\n\n    node *first = NULL, *last = NULL;  \n\n\n    while (fgets (buf, MAXN, file)) {\n\n\n        node *head = malloc (sizeof(node));\n        if (head == NULL) {         \n            perror (\"malloc-node\"); \n            return 1;   \n        }\n\n\n        buf[strcspn(buf, \"\\n\")] = 0;    \n\n\n        strcpy (head-&gt;name, buf);\n        head-&gt;next = NULL;\n\n\n        if (!last)\n            first = last = head;\n        else {\n            last-&gt;next = head;\n            last = head;\n        }\n    }\n\n    if (file != stdin) fclose(file);\n    node *ptr = first;\n    printf(\"count of tom is %d\", count(ptr, \"tom\")); // ptr instead of ptr-&gt;name and \"tom\" instead of 'tom'\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10808468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf0c7675c7dadfd5c3344ddd22e3cb4?s=128&d=identicon&r=PG&f=1", "display_name": "konoha", "link": "https://stackoverflow.com/users/10808468/konoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 53843935, "answer_count": 2, "score": 0, "last_activity_date": 1545188019, "creation_date": 1545173632, "last_edit_date": 1545174130, "question_id": 53842300, "link": "https://stackoverflow.com/questions/53842300/counting-the-number-of-occurences-of-string-in-a-linked-list", "title": "counting the number of occurences of string in a linked list", "body": "<p>Hi I'm a beginner in C Programming. \nI wrote a code that takes contents from an input file to create a linked list.\nSo all the names are linked together.\nTom is linked with Jack and so on.\ninput file:</p>\n\n<pre><code>tom\njack\ntom\nmark\ntom\njake\n</code></pre>\n\n<p>I wrote a function that counts the number of occurrence however no matter what I try I keep on getting warnings and count of <code>tom</code> is always <code>0</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;string.h&gt;\n\n#define MAXN 50     \n\ntypedef struct node {\n    char name[MAXN];\n    struct node *next;\n}\nnode;\n\nint count( node* head, char search_for) \n{ \n    node* current = head; \n    int count = 0; \n    while (current != NULL) \n    { \n        if (current-&gt;name== search_for) \n           count++; \n        current = current-&gt;next; \n    } \n    return count; \n} \n\n\n\nint main (int argc, char **argv) {\n\n    FILE *file = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n    if (file == NULL)\n        return 1;\n\n    char buf[MAXN];\n\n    node *first = NULL, *last = NULL;  \n\n\n    while (fgets (buf, MAXN, file)) {\n\n\n        node *head = malloc (sizeof(node));\n        if (head == NULL) {         \n            perror (\"malloc-node\"); \n            return 1;   \n        }\n\n\n        buf[strcspn(buf, \"\\n\")] = 0;    \n\n\n        strcpy (head-&gt;name, buf);\n        head-&gt;next = NULL;\n\n\n        if (!last)\n            first = last = head;\n        else {\n            last-&gt;next = head;\n            last = head;\n        }\n    }\n\n    if (file != stdin) \n        fclose(file);\n        node *ptr = first;\n        printf(\"count of tom is %d\", count(ptr-&gt;name, 't'));\n\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545170230, "post_id": 53841589, "comment_id": 94531567, "body": "I would just go through numbers <code>[0..2^n-1]</code> and replace bits with letters.."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545170511, "post_id": 53841589, "comment_id": 94531695, "body": "Is it <i>only</i> <code>a</code> and <code>b</code>? Or, could you also have a case where you would use (e.g.) <code>c</code>, <code>d</code>."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545170573, "post_id": 53841589, "comment_id": 94531718, "body": "@CraigEstey  just &#39;a&#39; and &#39;b&#39;"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545170617, "post_id": 53841589, "comment_id": 94531736, "body": "@EugeneSh. what do you mean with &#39;replace bits with letters&#39; or where ?"}, {"owner": {"reputation": 874, "user_id": 3352222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6lYp.jpg?s=128&g=1", "display_name": "ravnsgaard", "link": "https://stackoverflow.com/users/3352222/ravnsgaard"}, "edited": false, "score": 1, "creation_date": 1545170629, "post_id": 53841589, "comment_id": 94531740, "body": "It does indeed go through your nested loop. Your logic is bad, though. You need to start up your debugger and walk through this code. By the time you get through your nested loop once, you&#39;ll know why this doesn&#39;t work. It may also give you an idea of how to re-write this code. Good luck."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1545170784, "post_id": 53841589, "comment_id": 94531807, "body": "@amerov For example for n=3, the numbers would be 0-7, which are represented in binary as <code>000</code>, <code>001</code>, <code>010</code>...<code>111</code>. The only thing you need is to decode these so for every <code>0</code> it will print <code>a</code>, and for every <code>1</code> it will print <code>b</code>."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545170932, "post_id": 53841589, "comment_id": 94531865, "body": "@EugeneSh. for 000 it will print aaa and for 001 aab  right ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545170992, "post_id": 53841589, "comment_id": 94531880, "body": "@Amerov Whatever you define.. You might want to flip the order"}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "edited": false, "score": 0, "creation_date": 1545171421, "post_id": 53841589, "comment_id": 94532013, "body": "Sorry I am missing something you defined in your code <code>n</code> as 5 and you are using as the length of your words to be generated but in your explanation you were talking about words of length 3? Exactly what output are you expecting when n is 5?"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "edited": false, "score": 0, "creation_date": 1545171609, "post_id": 53841589, "comment_id": 94532060, "body": "@FrancescoBoi if n=5 the output would be aaaaa baaaa abaaa.... bbbbb"}, {"owner": {"reputation": 250, "user_id": 10207394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgM4w.png?s=128&g=1", "display_name": "Johnny Johansson", "link": "https://stackoverflow.com/users/10207394/johnny-johansson"}, "edited": false, "score": 0, "creation_date": 1545222902, "post_id": 53841589, "comment_id": 94550024, "body": "Did you intend to print <i>all</i> possible combinations? Because that is not going to happen with those two loops! There are 2^n possible combinations, and you are printing at most n*(n-1) ones."}], "answers": [{"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 0, "last_activity_date": 1545171728, "creation_date": 1545171728, "answer_id": 53841971, "question_id": 53841589, "link": "https://stackoverflow.com/questions/53841589/how-to-swap-between-two-letters-in-a-string-char/53841971#53841971", "title": "How to swap between two letters in a string char[]?", "body": "<p>Just do <code>char word[n] = \"aaaaa\";</code></p>\n\n<p>Full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define n  5\n\nchar word[n] = \"aaaaa\";\nchar noob[n];\n\nvoid\nmyfunction(void)\n{\n    int x, i, j;\n\n    for (i = 0; i &lt; n - 1; i++) {\n        // I did this to convert first from a char to int and then add one in\n        // order to change a to b\n        x = word[i];\n        x++;\n        word[i] = x;\n        puts(word);\n\n        // here is the problem after going through the first loob (i) we have\n        // the word baa and it should go through the second loop j but it\n        // doesn't\n        for (j = 0; j &lt; n - 1; j++) {\n            noob[j] = word[j];\n            word[j + 1] = word[j];\n            word[j] = noob[j];\n            puts(word);\n        }\n\n    }\n}\n\nint\nmain(void)\n{\n    myfunction();\n\n    return 0;\n}\n</code></pre>\n\n<p>Of course this work when you know the length of your words at compile time. It the length would be known only at runtime (for example with a user inputting it) you need do dynamically allocate (with <code>malloc</code> for example) and remove.</p>\n"}], "owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545219640, "creation_date": 1545169730, "last_edit_date": 1545219640, "question_id": 53841589, "link": "https://stackoverflow.com/questions/53841589/how-to-swap-between-two-letters-in-a-string-char", "title": "How to swap between two letters in a string char[]?", "body": "<p>Sorry for the title, but I don't know what is this program called.</p>\n\n<p>I'm trying to write a program that takes an <code>int</code> parameter and print a word of length <code>n</code> that consists of both letters 'a' and 'b'\nfor example:</p>\n\n<pre><code>n= 3 \nthe result =&gt;: `aaa,baa,aba,aab,bba,bab,abb,bbb`\n</code></pre>\n\n<p>And this is my code. There is something wrong in it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define n  5\n\nchar word[n] = \"aaa\";\nchar noob[n];\n\nvoid\nmyfunction(void)\n{\n    int x,\n     i,\n     j;\n\n    for (i = 0; i &lt; n - 1; i++) {\n        // I did this to convert first from a char to int and then add one in\n        // order to change a to b\n        x = word[i];\n        x++;\n        word[i] = x;\n        puts(word);\n\n        // here is the problem after going through the first loob (i) we have\n        // the word baa and it should go through the second loop j but it\n        // doesn't\n        for (j = 0; j &lt; n - 1; j++) {\n            noob[j] = word[j];\n            word[j + 1] = word[j];\n            word[j] = noob[j];\n            puts(word);\n        }\n\n    }\n}\n\nint\nmain(void)\n{\n    myfunction();\n\n    return 0;\n}\n</code></pre>\n\n<p>can someone help me please ???</p>\n"}, {"tags": ["c", "pointers", "memory", "malloc"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1545169727, "post_id": 53841523, "comment_id": 94531360, "body": "<code>mem=curr+sizeof(block_t)                 return mem;</code> is a syntax error. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545191753, "post_id": 53841523, "comment_id": 94536506, "body": "You may also find useful this <a href=\"https://github.com/zyfjeff/C-HOW-TO/blob/master/c-malloc/Malloc_tutorial.pdf\" rel=\"nofollow noreferrer\">awkwardly written, but good basic malloc introduction</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1545180578, "creation_date": 1545180578, "answer_id": 53843153, "question_id": 53841523, "link": "https://stackoverflow.com/questions/53841523/issue-with-pointer-arithmetic-in-my-own-malloc-function/53843153#53843153", "title": "Issue with pointer arithmetic in my own malloc() function", "body": "<p>Whenever you do pointer arithmetic, the values are always scaled by the size of the type the pointer points at.  So when you do</p>\n\n<pre><code>mem = cur + sizeof(block_t);\n</code></pre>\n\n<p>since <code>cur</code> is a <code>block_t *</code>, the addition is scaled by <code>sizeof(block_t)</code> automatically.  Which means that if <code>sizeof(block_t)</code> is 16, this will add 256 bytes to the pointer, which is not what you want.  You probably just want</p>\n\n<pre><code>mem = cur + 1;\n</code></pre>\n\n<p>here, and similar changes elsewhere.</p>\n"}], "owner": {"reputation": 45, "user_id": 9825595, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Elliott Goldstein", "link": "https://stackoverflow.com/users/9825595/elliott-goldstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545189316, "creation_date": 1545169373, "last_edit_date": 1545189316, "question_id": 53841523, "link": "https://stackoverflow.com/questions/53841523/issue-with-pointer-arithmetic-in-my-own-malloc-function", "title": "Issue with pointer arithmetic in my own malloc() function", "body": "<p>I am currently working on implementing my own malloc() function. The one thing that seems to not be working is that I'm unable to correctly return the memory address of the beginning of my current block. My block struct looks like this and is of size 16:</p>\n\n<pre><code>typedef struct block {\n    size_t size;\n    struct block* next;\n    struct block* prev;\n    int free;\n} block_t;\n</code></pre>\n\n<p>My malloc looks like this currently:</p>\n\n<pre><code>void *bmalloc(size_t size)\n{\n    void * mem=0;\n    size_t alloc=size;\n    if (freelist==0)\n    {\n        freelist=&amp;heap[0];\n        freelist-&gt;free=0;\n        freelist-&gt;prev=0;\n        freelist-&gt;size=MAX_HEAP_SIZE;\n        freelist-&gt;next=0;\n        //printf(\"is this happening?\");\n    }\n\n    for (curr=freelist;curr!=NULL;curr=curr-&gt;next)\n    {\n        if (alloc&lt;=curr-&gt;size &amp;&amp; curr-&gt;free==0)\n        {\n            block_t *tmp=curr-&gt;next;\n            curr-&gt;free=1;\n            curr&gt;size=MAX_HEAP_SIZE;\n            curr&gt;next=curr+alloc+sizeof(block_t);\n            //curr-&gt;next-&gt;next=tmp;\n            curr-&gt;next-&gt;size=curr-&gt;size-alloc;\n            curr-&gt;next-&gt;free=0;\n            curr-&gt;next-&gt;prev=curr;\n            mem=curr+sizeof(block_t)\n            return mem;\n        }\n    }\n}           \n</code></pre>\n\n<p><code>Curr</code> and <code>Freelist</code> are both <code>block_t</code> structs. I know the issue must lie in the step where I set <code>mem=curr+sizeof(block_t)</code>, but I'm not really sure how to fix it. Upon some checking I noticed that the first allocation of memory returns an address 276 bytes away from the beginning of the array the blocks live on top of, and after the first allocation the blocks memory addresses are 512 bytes away.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 5, "creation_date": 1545165378, "post_id": 53840605, "comment_id": 94529695, "body": "Could you please explain why you expected the output to be 222?  Walk us through your logic."}, {"owner": {"reputation": 13, "user_id": 10782688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2EtD12dSDPo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-ggFMl6Stg8tUrXeGxe1dQJQUXhPg/mo/photo.jpg?sz=128", "display_name": "Sameer Aggarwal", "link": "https://stackoverflow.com/users/10782688/sameer-aggarwal"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1545165598, "post_id": 53840605, "comment_id": 94529799, "body": "binary of 35 is 00100001,its complement is 11011110 whose decimal equivalent is 222.If the above explanation is wrong then please guide me to the right answer."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1545165960, "post_id": 53840605, "comment_id": 94529963, "body": "binary of 35 is 00100011"}], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1545166280, "post_id": 53840725, "comment_id": 94530109, "body": "Note also that there is a one-bit error: <code>11011100</code> vs <code>11011110</code>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1545166758, "post_id": 53840725, "comment_id": 94530290, "body": "@zwol Correct.  It matches the inverse of what OP <i>though</i> was the binary representation of 35."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1545167613, "post_id": 53840725, "comment_id": 94530555, "body": "Right.  OP made two mistakes, but your answer makes it sound like there was only one.  That&#39;s all I was saying."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1545165634, "creation_date": 1545165634, "answer_id": 53840725, "question_id": 53840605, "link": "https://stackoverflow.com/questions/53840605/expected-answer-is-222-but-output-is-different/53840725#53840725", "title": "Expected answer is 222 but output is different", "body": "<p>The bitwise compliment operator <code>~</code> inverts <strong>all</strong> bits of its operand.  So assuming an <code>int</code> is 32 bits, the binary value:</p>\n\n<pre><code>00000000 00000000 00000000 00100011\n</code></pre>\n\n<p>Becomes this after applying <code>~</code>:</p>\n\n<pre><code>11111111 11111111 11111111 11011100\n</code></pre>\n\n<p>Assuming negative numbers are represented in two's complement representation, this value is -36.</p>\n\n<p>The value 222 you were expecting looks like this in binary as an <code>int</code>:</p>\n\n<pre><code>00000000 00000000 00000000 11011110\n</code></pre>\n\n<p>So it seems you were expecting that only the least significant byte gets inverted, but instead the bits in all bytes get inverted.</p>\n"}, {"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545167908, "post_id": 53841044, "comment_id": 94530678, "body": "warning for the char all depend if it is signed or not, for gcc/g++ a char is unsigned, producing 220 in both case. Use <code>signed char </code>  to have -36"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1545168145, "post_id": 53841044, "comment_id": 94530763, "body": "<code>int</code> is in fact guaranteed by the C standard to be at least 16 bits"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1545167114, "creation_date": 1545167114, "answer_id": 53841044, "question_id": 53840605, "link": "https://stackoverflow.com/questions/53840605/expected-answer-is-222-but-output-is-different/53841044#53841044", "title": "Expected answer is 222 but output is different", "body": "<p>Perhaps you mean 220, as in this case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n  char s = 35;\n  unsigned char u = 35;\n\n  char is = ~s;\n  unsigned char iu = ~u;\n\n  printf(\"~35 (signed) = %d\\n\", is);\n  printf(\"~35 (unsigned) = %d\\n\", iu);\n\n  return 0;\n}\n</code></pre>\n\n<p>Where that prints:</p>\n\n<pre><code>~35 (signed) = -36\n~35 (unsigned) = 220\n</code></pre>\n\n<p>Remember that <code>int</code> is often 32 bits or more, not 8 as you expected.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1545168120, "creation_date": 1545168120, "answer_id": 53841257, "question_id": 53840605, "link": "https://stackoverflow.com/questions/53840605/expected-answer-is-222-but-output-is-different/53841257#53841257", "title": "Expected answer is 222 but output is different", "body": "<p>220 is the unsigned value representing the negation of 35 when stored with an 8-bit data type.</p>\n\n<p><code>int</code> is guaranteed by the C standard to be <em>at least</em> 16 bits, so you will <em>never</em> produce the value of 220 by negating an <code>int</code> containing 35. Use <code>uint8_t</code> in <code>&lt;stdint.h&gt;</code> to store the value of 35 and its negation.</p>\n\n<p>Also note that <code>printf</code>-family functions promote <code>%u</code> and <code>%d</code> arguments to <code>unsigned int</code> and <code>int</code> respectively, so you may want to chop off the higher bits with a bitwise AND when printing.</p>\n"}], "owner": {"reputation": 13, "user_id": 10782688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2EtD12dSDPo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-ggFMl6Stg8tUrXeGxe1dQJQUXhPg/mo/photo.jpg?sz=128", "display_name": "Sameer Aggarwal", "link": "https://stackoverflow.com/users/10782688/sameer-aggarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53841044, "answer_count": 3, "score": -2, "last_activity_date": 1545168120, "creation_date": 1545165087, "last_edit_date": 1545165265, "question_id": 53840605, "link": "https://stackoverflow.com/questions/53840605/expected-answer-is-222-but-output-is-different", "title": "Expected answer is 222 but output is different", "body": "<p>I have made a program using the below initialization </p>\n\n<pre><code>int j=35,l;\nl=~j;\n</code></pre>\n\n<p>if <code>l</code> is printed as <code>%d</code> then the output is -36</p>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1545164821, "post_id": 53840517, "comment_id": 94529442, "body": "You have not shown function <code>test_equal_b</code>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545165323, "post_id": 53840517, "comment_id": 94529669, "body": "what is the interest of <code>test_equal_b</code> while probably <code>arrays_equal</code> return true or false ? to compare true and true ? @Navidms how <code>arrays_equal</code> is implemented ?"}, {"owner": {"reputation": 465, "user_id": 8584675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/666086d04bb306a5829c392e6d8f6fb9?s=128&d=identicon&r=PG&f=1", "display_name": "nullp0tr", "link": "https://stackoverflow.com/users/8584675/nullp0tr"}, "edited": false, "score": 0, "creation_date": 1545165623, "post_id": 53840517, "comment_id": 94529804, "body": "Please format your code properly:)"}, {"owner": {"reputation": 21, "user_id": 8879347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd80e478a635a51f1acc530cf2e7720f?s=128&d=identicon&r=PG&f=1", "display_name": "Navidms", "link": "https://stackoverflow.com/users/8879347/navidms"}, "edited": false, "score": 0, "creation_date": 1545165715, "post_id": 53840517, "comment_id": 94529852, "body": "i edited my text and wrote another functions too."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1545165892, "post_id": 53840517, "comment_id": 94529941, "body": "Your equality test goes out of bounds."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1545166052, "post_id": 53840517, "comment_id": 94530005, "body": "Not an error, but indexing is less easy to get wrong than dereferencing pointer arithmetic."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1545166116, "post_id": 53840517, "comment_id": 94530039, "body": "Also not an error, but <code>if(n == j) {return true;} else {return false;}</code> \u2014&gt; <code>return n == j;</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545167205, "post_id": 53840517, "comment_id": 94530416, "body": "regarding: <code>b = xcalloc(n,sizeof(double));</code>  Where does the function: <code>xcalloc()</code> come from?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545167314, "post_id": 53840517, "comment_id": 94530454, "body": "the posted code does not compile!.  please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce your problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545167533, "post_id": 53840517, "comment_id": 94530514, "body": "regarding: <code>for(int i = 0; i&lt;= n; i++){</code>  In C, an array index can be in the range: 0...(number of elements in array -1 ) So the posted code contains undefined behavior because it is accessing beyond the end of the array  Suggest: <code>for( int i = 0; i&lt;n; i++ ){</code>  Notice the <code>&lt;</code> rather than the <code>&lt;=</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545167784, "post_id": 53840517, "comment_id": 94530624, "body": "OT: for ease of readability and understanding;  1) following the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2) consistently indent the code: indent after every opening brace &#39;{&#39;.  unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces"}, {"owner": {"reputation": 21, "user_id": 8879347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd80e478a635a51f1acc530cf2e7720f?s=128&d=identicon&r=PG&f=1", "display_name": "Navidms", "link": "https://stackoverflow.com/users/8879347/navidms"}, "edited": false, "score": 1, "creation_date": 1545167844, "post_id": 53840517, "comment_id": 94530643, "body": "thank you very much.this was my problem,i should write i &lt; n rather than &lt;= .thanks,i lost 5 hours for this mistake"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1545167915, "post_id": 53840517, "comment_id": 94530681, "body": "Don&#39;t feel bad, we have all done LOTS of such mistakes."}, {"owner": {"reputation": 199, "user_id": 3541440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cjHH.jpg?s=128&g=1", "display_name": "Jenny T-Type", "link": "https://stackoverflow.com/users/3541440/jenny-t-type"}, "edited": false, "score": 0, "creation_date": 1545168861, "post_id": 53840517, "comment_id": 94531020, "body": "it probably doesn&#39;t work because in <code>array_copy()</code> the value of <code>n</code> acts as the number of elements in the array, so a loop like this makes sense: <code>for(i = 0; i &lt; n; i++)</code>   However in <code>arrays_equal()</code> controling statement of the loop differs (<code>i &lt;= n</code>), this means that in the last iteration <code>*(b+i)</code> is accessing any double sized value that just happened to be right after your array in your program heap, in other words, garbage value."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545171654, "post_id": 53840517, "comment_id": 94532077, "body": "<code>fabs(a - b) &lt; 1e-6;</code> is a poor test for &quot;approximately equal&quot;.   If is worthless when <code>a,b</code> are both very large or small.  A good approximate compare takes into account the relative values of <code>a,b</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 1, "last_activity_date": 1545173533, "creation_date": 1545173533, "answer_id": 53842285, "question_id": 53840517, "link": "https://stackoverflow.com/questions/53840517/returning-an-array-with-dinamically-location-in-c/53842285#53842285", "title": "returning an array with dinamically location in c", "body": "<p>Your code have some errors. First of all why you wrote <code>for(int i = 0; i&lt;= n; i++)</code>? It will iterate <code>n+1</code> times in this way. It should be <code>for(int i = 0; i&lt; n; i++)</code>.</p>\n\n<p>Then are you expecting your test to return <code>true</code>: the third element are quite different  <code>a3[2] =  42.43</code>, <code>b3[2] = 42.42</code>, the difference is much bigger than 10e-6 so they are not equal.</p>\n"}], "owner": {"reputation": 21, "user_id": 8879347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd80e478a635a51f1acc530cf2e7720f?s=128&d=identicon&r=PG&f=1", "display_name": "Navidms", "link": "https://stackoverflow.com/users/8879347/navidms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545177044, "creation_date": 1545164670, "last_edit_date": 1545177044, "question_id": 53840517, "link": "https://stackoverflow.com/questions/53840517/returning-an-array-with-dinamically-location-in-c", "title": "returning an array with dinamically location in c", "body": "<p>I must return an array <code>double* b</code> and compare it with <code>double* a</code> inside the function <code>arrays_equal</code>. The code doesn't work and test failed. I write here the related codes:</p>\n\n<pre><code>double* array_copy(/*IN*/ const double* a, int n) {\n\n   double *b;\n   b = xcalloc(n,sizeof(double));\n\n   for(int i = 0; i &lt; n; i++){\n       *(b + i) = *(a + i);    \n       printf(\"%.2f\\n\",b[i]);   \n       }     \n   printf(\"%.2f\\n\",b[0]);\n\n   return  b;\n}\n</code></pre>\n\n<p>and i write here my test funktion,i must got double* b1 from my array_copy function:</p>\n\n<pre><code>void array_copy_test(void) {\n    double a1[] = { 1.50, 2.30, 42.42 };\n    double* b1 = array_copy(a1, 3);\n    test_equal_b(arrays_equal(a1, b1, 3), true);\n    free(b1);\n</code></pre>\n\n<p>equal function:</p>\n\n<pre><code>bool arrays_equal(/*IN*/ const double* a, /*IN*/ const double* b, int n) {\n    int j = 0;\n    for(int i = 0; i&lt;= n; i++){\n        if(approx(*(a+i),*(b+i))){\n\n        j++;\n       }\n    }      \n\nif(n == j){\n      return true;\n     } else{return false;}\n\n}\n\n\nvoid arrays_equal_test(void) {\n\n    double a3[] = { 1.5, 2.3, 42.43 };\n    double b3[] = { 1.5, 2.3, 42.42 };\n    test_equal_b(arrays_equal(a3, b3, 3), false);\n\n\n}\n\nbool approx(double a, double b) {\n    return fabs(a - b) &lt; 1e-6;\n}\n</code></pre>\n\n<p>Can somebody please tell me, where is my problem?</p>\n"}, {"tags": ["c", "types", "assert"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1545164753, "post_id": 53840498, "comment_id": 94529409, "body": "Given that there&#39;s no <code>decltype</code> in C, you&#39;d be stuck comparing typedefs or using <code>typeof</code> extensions even if you had a way to do this test."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1545164766, "post_id": 53840498, "comment_id": 94529414, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6280055/how-do-i-check-if-a-variable-is-of-a-certain-type-compare-two-types-in-c\">How do I check if a variable is of a certain type (compare two types) in C?</a>"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1545164819, "post_id": 53840498, "comment_id": 94529441, "body": "@ShadowRanger: That&#39;s testing a variable against a type, not testing two types against each other."}, {"owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 0, "creation_date": 1545166723, "post_id": 53840498, "comment_id": 94530282, "body": "So this is not part of standard C, I take it? What is the barrier to implementing such a functionality, especially when types are known at compile time? Or is it just a question of &quot;philosophy&quot; in C versus C++?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1545167426, "post_id": 53840498, "comment_id": 94530484, "body": "In what form are the types available? If we can put them into type declarations, then something like <code>typedef T0; typedef T1;</code> may complain if and only if the types are different. (Testing shows it complains even if the types are compatible, such as an incomplete array and a complete array, but I need to check the C standard further.) But this requires they be in a declarable form with the same identifier, such as <code>int x[3]</code>. If we just have <code>int [3]</code>, preprocessor expansion cannot form <code>int x[3]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 0, "creation_date": 1545166639, "post_id": 53840595, "comment_id": 94530243, "body": "Thank you. Do you know why this is not part of standard C, at least in the case where the types are known at compile time?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 1, "creation_date": 1545166949, "post_id": 53840595, "comment_id": 94530353, "body": "No one found it of sufficient importance to push to add it to the standard, or it entails too much extra infrastructure to be accepted, @ZachBoyd."}, {"owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 1, "creation_date": 1545167063, "post_id": 53840595, "comment_id": 94530379, "body": "That makes sense--I suppose that keeping C compilers easy to implement is a valid priority."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1545165041, "creation_date": 1545165041, "answer_id": 53840595, "question_id": 53840498, "link": "https://stackoverflow.com/questions/53840498/how-to-assert-two-types-are-equal-in-c/53840595#53840595", "title": "How to assert two types are equal in c?", "body": "<p>Under gcc, you could do something like this:</p>\n\n<pre><code>#define same_type(a, b) \\ \n    static_assert(__builtin_types_compatible_p(typeof(a), typeof(b)), \"types do not match\")\n\n...\n\nint a, b;\nfloat c;\nsame_type(a,b);\nsame_type(a,c);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545167548, "post_id": 53841007, "comment_id": 94530526, "body": "@EricPostpischil My <code>compare_types(int *, int [3])</code> reports <code>&quot;Different&quot;</code> (gcc version 7.3.0 ).  What compiler/version are you using?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545167726, "post_id": 53841007, "comment_id": 94530601, "body": "Oops, my mistake. <code>int *, int [3]</code> reports \u201cDifferent\u201d. <code>int [3], int *</code> gets a compilation error. Apple LLVM 9.1.0, clang-902.0.39.2."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545181530, "post_id": 53841007, "comment_id": 94534557, "body": "@PSkocik As standard C does not have <code>__typeof</code> nor <code>typeof</code>, using that would make for a compiler specific solution  OK if OP wants that, but so far post is not tagged as such."}, {"owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 0, "creation_date": 1545238516, "post_id": 53841007, "comment_id": 94559519, "body": "I use GCC for compliation and Clang/LLVM for static analysis, so a compiler-specific solution would be fine, although a standard-based solution is of course preferred."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 0, "creation_date": 1545239005, "post_id": 53841007, "comment_id": 94559765, "body": "@ZachBoyd In the end, I suspect that either 1) a standard based solution as above that does not work well  for array and <code>void</code> or 2) a compiler-specific solution is the answer.  In any case, the question implies no compiler-specific solution allowance.  Perhaps explaining <i>why</i> this this ability is needed and how it is used will result in an even better solution that is universal and portable."}, {"owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 1, "creation_date": 1545239388, "post_id": 53841007, "comment_id": 94559965, "body": "Part of the question is just curiosity, but the specific motivating case I was looking at was for a library I rely on where a &quot;real number&quot; type is just floating point double but is not guaranteed to stay that way and/or may be configurable. I wanted to put a check in my code that uses the assumption that the real number type is exactly double to call attention in case of future changes. So in this case, the array case is not needed, although it is of interest in general."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "edited": false, "score": 1, "creation_date": 1545239756, "post_id": 53841007, "comment_id": 94560167, "body": "@ZachBoyd Thanks for that detail.  It is a prudent use of something like <code>_Static_assert(compare_types_strong(double, lib_FP), &quot;Unexpected lib_FP&quot;);</code>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1545189034, "last_edit_date": 1545189034, "creation_date": 1545166960, "answer_id": 53841007, "question_id": 53840498, "link": "https://stackoverflow.com/questions/53840498/how-to-assert-two-types-are-equal-in-c/53841007#53841007", "title": "How to assert two types are equal in c?", "body": "<blockquote>\n  <p>How to assert two types are equal in c?</p>\n</blockquote>\n\n<p>Use <code>_Generic</code> to get you at least mostly there with non-array types.</p>\n\n<pre><code>#define compare_types(T1, T2) _Generic((  (T1){0}  ), \\\n  T2: \"Same\", \\\n  default: \"Different\" \\\n)\n\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main() {\n  // Same range\n  printf(\"%ld %lld\\n\", LONG_MAX, LLONG_MAX);\n  // Same size\n  printf(\"%zu %zu\\n\", sizeof (long), sizeof (long long));\n  // Yet different\n  printf(\"%s\\n\", compare_types(long, long long));\n\n  // int64_t is a long on my machine\n  printf(\"%s\\n\", compare_types(long, int64_t));\n  printf(\"%s\\n\", compare_types(long long, int64_t));\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>9223372036854775807 9223372036854775807\n8 8\nDifferent\nSame\nDifferent\n</code></pre>\n\n<hr>\n\n<p><strong>Improved</strong></p>\n\n<p>Further, a stronger compare employs a <code>A vs B</code> and  <code>B vs A</code> test.   The 2 tests are useful for the controlling expression of <code>_Generic</code> converts arrays to pointers of the first element losing some type information.</p>\n\n<pre><code>#define strong_helper(T1, T2) _Generic(( (T1){0} ), \\\n  T2: 1, \\\n  default: 0 \\\n)\n#define compare_types_strong(T1, T2) (strong_helper(T1,T2) &amp;&amp; strong_helper(T2,T1))\n\nprintf(\"%d\\n\", compare_types_strong(long, int64_t));\nprintf(\"%d\\n\", compare_types_strong(int [3], int *));\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>1\n0\n</code></pre>\n\n<hr>\n\n<p><strong>Still troublesome for arrays and <code>void</code></strong></p>\n\n<p><code>compare_types_strong(int [3], int [3])</code> returns 0 as <code>_Generic</code> converted the controlling expression <code>int [3]</code> to a pointer to the first element type (<code>int *</code>).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/53840498/how-to-assert-two-types-are-equal-in-c/53841007?noredirect=1#comment94534472_53841007\">@PSkocik</a>, in a deleted comment, points out this approach will not work for the <a href=\"https://stackoverflow.com/a/14060799/2410359\"><em>incomplete object type</em> <code>void</code></a>.</p>\n"}], "owner": {"reputation": 329, "user_id": 3652740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfd1fd968e5ba241eeadf17833e76fe?s=128&d=identicon&r=PG", "display_name": "Zach Boyd", "link": "https://stackoverflow.com/users/3652740/zach-boyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 1, "accepted_answer_id": 53841007, "answer_count": 2, "score": 6, "last_activity_date": 1545189034, "creation_date": 1545164600, "last_edit_date": 1545165173, "question_id": 53840498, "link": "https://stackoverflow.com/questions/53840498/how-to-assert-two-types-are-equal-in-c", "title": "How to assert two types are equal in c?", "body": "<p>How do I assert that two types are equal in C? In C++, I would use std::is_same, but searching StackOverflow and elsewhere seems only to give results for C++ and C#. Is there no way to do this in C?</p>\n\n<hr>\n\n<p>Note, this is not asking whether a variable has a certain type but rather whether two types are the same.</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1545163446, "post_id": 53840207, "comment_id": 94528820, "body": "<code>free(image)</code> makes no sense. It&#39;s a <code>FILE*</code>, and you already <code>fclose</code>-d it."}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1545164144, "post_id": 53840207, "comment_id": 94529125, "body": "At first I had use FILE* image = malloc(sizeof(FILE)). But then I removed it because I was getting the seg fault (trial and error!!). I forgot to delete free(image). I have edited the code and it still has that seg fault. Can you see any other problem?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1545164258, "post_id": 53840207, "comment_id": 94529181, "body": "run your program in a debugger so in the future you can see which line is causing the segfault, then you can look into the reason.  Eventually you will be able to read the fclose man page on your own and understand what went wrong.  Debugging is a skill you should strive to learn, even if you can only use printf or a sequence of LED blinks (depending on what your writing/building)."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1545164262, "post_id": 53840207, "comment_id": 94529183, "body": "You still have a case where you will <code>fclose</code> a null pointer too. How is that <code>if</code> condition <i>ever</i> true ? <code>buffer[0] == 0xff</code> must be true, but <code>(buffer[0] &amp; 0xf0) == 0xe0</code> must also be true. But if <code>buffer[0] == 0xff</code> is already true, <code>(buffer[0] &amp; 0xf0)</code> is <code>0xf0</code>, not <code>0xe0</code>., so that block can never test true as a whole, which means <code>image</code> is never opened, which means <code>fclose(image)</code> invokes UB."}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1545164727, "post_id": 53840207, "comment_id": 94529401, "body": "Thank you so much @WhozCraig. The code works great now.That was the problem it should have been (buffer[3] &amp; 0xf0). I looked at the code so many times but couldn&#39;t see that. Very vigilante. That&#39;s a skill i&#39;ll be working on."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545168226, "post_id": 53840207, "comment_id": 94530789, "body": "OT: regarding: <code>fprintf(stderr, &quot;Usage: .&#47;recover filename\\n&quot;);</code>  This code could be executed under any name, just by simply renaming the executable.  Suggest using the more typical: <code>fprintf(stderr, &quot;Usage: %s filename\\n&quot;, argv[0] );</code>  Note: <code>argv[0]</code> always contains a pointer to a string that contains the name of the executable."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545176229, "post_id": 53840207, "comment_id": 94533403, "body": "Do NOT delete information from your original question. That makes all comments and answers prior to the deletion not make sense. Instead, you may edit and <b>add below</b> your original question and correct any non-essential spelling or punctuation or indentation in the original, but don&#39;t delete content from it."}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545298330, "post_id": 53840207, "comment_id": 94579017, "body": "@user3629249 great tip I&#39;ll keep that in mind. Thanks"}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545298437, "post_id": 53840207, "comment_id": 94579065, "body": "@DavidC.Rankin Sure. I didn&#39;t think of that. I&#39;ll remember that from next time. Thanks."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545324348, "post_id": 53840207, "comment_id": 94592790, "body": "regarding: <code>fprintf(stderr, &quot;No file found\\n&quot;);</code>  this not necessarily true.  Much better to use: <code>perror( &quot;fopen failed&quot; );</code> as that will output both your error message AND the text reason the system thinks the error occurred to <code>stderr</code>"}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545390843, "post_id": 53840207, "comment_id": 94614075, "body": "@user3629249 that&#39;s new . I&#39;ll try that out right now. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "edited": false, "score": 0, "creation_date": 1545298240, "post_id": 53842515, "comment_id": 94578956, "body": "That <b>fread(buffer, 512, 1, file) == 1</b> ensures that the loop exits when EOF is reached."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "edited": false, "score": 0, "creation_date": 1545299853, "post_id": 53842515, "comment_id": 94579874, "body": "Can u try without ==1?as I told u in the answer it seems it returns the number of elements that has been read which might not be 1"}, {"owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "edited": false, "score": 1, "creation_date": 1545301865, "post_id": 53842515, "comment_id": 94580918, "body": "Well that was not the problem for the seg fault (you can see the upper comments). It (the seg fault) was because the if condition was never true and I was just closing a NULL pointer image which had never opened. And for this matter instead of <b>fread(buffer, 512, 1, file) == 1</b> I have also tried <b>fread(buffer, 1, 512, file) == 512</b> and both work just fine."}], "tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 1, "last_activity_date": 1545175125, "creation_date": 1545175125, "answer_id": 53842515, "question_id": 53840207, "link": "https://stackoverflow.com/questions/53840207/how-do-i-get-rid-of-the-segmentation-fault/53842515#53842515", "title": "How do I get rid of the Segmentation Fault?", "body": "<p>I don't get any segmentation error but I think you are mistaking the <code>fread</code> function.</p>\n\n<blockquote>\n  <p>Return Value The total number of elements successfully read are\n  returned as a size_t object, which is an integral data type. If this\n  number differs from the nmemb parameter, then either an error had\n  occurred or the End Of File was reached.</p>\n</blockquote>\n\n<p>So I don't know if you entered the loop or you were expecting something different.</p>\n\n<p>You can do just do: <code>while(fread(buffer, 512, 1, file))</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 10807814, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X-XJPgEwiW8/AAAAAAAAAAI/AAAAAAAAABI/nn-5cjevMuc/photo.jpg?sz=128", "display_name": "Prakhar ", "link": "https://stackoverflow.com/users/10807814/prakhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545176132, "creation_date": 1545163237, "last_edit_date": 1545176132, "question_id": 53840207, "link": "https://stackoverflow.com/questions/53840207/how-do-i-get-rid-of-the-segmentation-fault", "title": "How do I get rid of the Segmentation Fault?", "body": "<p>I have been on this for a long time but couldn't figure out the reason for segmentation fault.</p>\n\n<p>I have a feeling that something is wrong with writting into the buffer multiple times but I don't know any alternate methods. Or it might be a problem with memory allocation.                                  </p>\n\n<p>Here's the code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(int argc, char *argv[])\n{\n    if(argc != 2)\n    {\n        fprintf(stderr, \"Usage: ./recover filename\\n\");\n        return 1;\n    }\n\n    FILE* file = fopen(argv[1], \"r\");\n\n    if(!file)\n    {\n        fprintf(stderr, \"No file found\\n\");\n        return 2;\n    }\n\n    fseek(file, 0, SEEK_SET);\n\n    unsigned char buffer[512];\n\n    int counter = 0;\n\n    char imagename[8];\n\n    FILE* image;\n\n    while(fread(buffer, 512, 1, file) == 1)\n    {\n        if(buffer[0] == 0xff &amp;&amp;\n           buffer[1] == 0xd8 &amp;&amp;\n           buffer[2] == 0xff &amp;&amp;\n           (buffer[0] &amp; 0xf0) == 0xe0 )\n        {\n             if(counter &gt; 0)\n             {\n                fclose(image);\n             }\n             sprintf(imagename, \"%03i.jpg\", counter);\n\n             image = fopen(imagename, \"w\");\n\n             if(!image)\n            {\n                    fprintf(stderr, \"No file found\\n\");\n                    return 2;\n            }\n\n             fwrite(buffer, 512, 1, image);\n\n             printf(\"%i\", counter);\n             counter++;\n\n        }\n\n        else if(counter &gt; 0)\n        {\n            fwrite(buffer, 512, 1, image);\n        }\n\n    }\n    fclose(image);\n    fclose(file);\n    free(image);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "thread-safety", "posix", "starvation"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545163455, "post_id": 53840142, "comment_id": 94528827, "body": "Let me make sure I have this straight.  Your several threads are divided into two groups, characterized by an attribute whose two possible values we label &quot;black&quot; and &quot;white&quot;.  Access rights to your managed resources are acquired on a per group basis, so at any given time, each resource is either owned by the black threads, owned by the white threads, or available to be acquired.  Is that right?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545164262, "post_id": 53840142, "comment_id": 94529184, "body": "Also, in addition to current ownership information, you want to maintain per-resource use counts, by which you intend to prevent either thread group from monopolizing any resource."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1545165052, "post_id": 53840142, "comment_id": 94529551, "body": "You have a bug. In <code>take_resource</code>, if (e.g) <code>not_your_turn</code> returns false, the other functions in the <code>while</code> clause are <i>not</i> called (short circuit evaluation) and <code>release_locks</code> will try to do <code>pthread_mutex_unlock</code> on mutexes that have <i>not</i> been acquired (e.g. <code>comparison_mutex</code> and <code>status_mutex</code>)."}, {"owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545165463, "post_id": 53840142, "comment_id": 94529737, "body": "@John you got it right. I think a toilet would be a better example for this problem. Men and women may not be there at the same time, but one cannot limit the access to it only to one gender."}, {"owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545165552, "post_id": 53840142, "comment_id": 94529778, "body": "@Craig, thanks for pointing that out."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1545165711, "post_id": 53840142, "comment_id": 94529849, "body": "Also, you may have a race condition. In <code>take_resource</code>, you do <code>current[type_id]++;</code> <i>without</i> holding any locks, so you&#39;re probably racing against <code>others_not_released</code> in another thread."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1545188762, "post_id": 53840142, "comment_id": 94535939, "body": "I had a feeling that you had a potential deadlock, but didn&#39;t have to time to investigate/prove it. Follow some of the examples below, because your latest code has to do <code>pthread_mutex_lock</code> on the mutex associated with a condition variable <i>before</i> calling <code>pthread_cond_wait</code> with that mutex (i.e.) <code>pthread_cond_wait</code> <i>expects</i> the mutex to be locked, <i>may</i> release it [internally], and returns with the mutex locked"}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1545169581, "post_id": 53841019, "comment_id": 94531304, "body": "CV&#39;s don&#39;t guarantee fairness [because, IIRC, when a CV is released, all threads waiting on it are released, and they scramble/race to acquire it]. What I&#39;ve found useful to promote/guarantee fairness is a &quot;ticket lock&quot;: <a href=\"https://en.wikipedia.org/wiki/Ticket_lock\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Ticket_lock</a>. This is most easily implemented with <code>stdatomic.h</code> which is very lightweight. But, it can be implemented using a [separate] mutex. Or, just acquire the ticket lock in lieu of any other mutex."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1545172855, "post_id": 53841019, "comment_id": 94532434, "body": "Agreed, @CraigEstey, CVs do not themselves ensure fairness.  However, the OP appears already to be maintaining metadata aimed at providing for fairness, and I&#39;m supposing that they would continue to use such a scheme within the context of mutex + CV."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1545167010, "creation_date": 1545167010, "answer_id": 53841019, "question_id": 53840142, "link": "https://stackoverflow.com/questions/53840142/restricting-resource-access-by-type-for-many-to-many/53841019#53841019", "title": "Restricting resource access by type for many-to-many", "body": "<p><strong>General comments</strong></p>\n\n<ol>\n<li><code>sleep()</code> is pretty much never the right solution to synchronization problems.</li>\n<li>Mutexes provide <em>only</em> mutual exclusion.  If you need more inter-thread coordination than that then you should either choose a different kind of synchronization object (sometimes a semaphore is a better fit), or add another kind (condition variables are the usual companion to mutexes).</li>\n<li>It's questionable style to split mutex lock and unlock into different functions.  In the even that you must do so, at least prefer to set up a balanced pairs of functions that perform the locking and unlocking.</li>\n</ol>\n\n<p><strong>Some specifics</strong></p>\n\n<p>You have too many mutexes, and it's getting you into trouble.  I see no need to maintain separate mutexes for the different kinds of resource-management metadata you maintain.  At most, you need two mutexes: one for protecting the group-access metadata (<code>turn</code>, <code>pending</code>, <code>current</code>, and <code>served</code>), and maybe one for protecting the resource itself.  It is not necessary for any thread to hold both of these at the same time, but you must ensure that no shared data is accessed without protection of the appropriate mutex.</p>\n\n<p>You should use a condition variable to help with mediating access to the group-access metadata.  Instead of sleeping, threads will wait on the CV when it is not their group's turn.  This will integrate naturally with the mutex that protects the group-access metadata.</p>\n\n<p>Although implementing these changes will require somewhat of a redesign, the result will be conceptually simpler and practically more robust.  For example, the issue in <code>take_resource()</code> revolving around uncertainty over which mutexes have been acquired will go away, because only one mutex will be involved in that part in the first place.</p>\n"}, {"comments": [{"owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "edited": false, "score": 0, "creation_date": 1545177178, "post_id": 53841962, "comment_id": 94533620, "body": "You are right, sir. I was aware of some of the possible deadlocks, but it seems I failed to post them properly. Nonetheless, I update the code and got stuck elsewhere. I will learn as much as I can from your post, but I will not steal."}, {"owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "edited": false, "score": 0, "creation_date": 1545228146, "post_id": 53841962, "comment_id": 94553069, "body": "It seems you forgot about the turn inside your struct."}, {"owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "edited": false, "score": 0, "creation_date": 1545230968, "post_id": 53841962, "comment_id": 94554749, "body": "IT also seems you forgot paranthesis around bwl-&gt;waiting[!black] &lt; 1 &amp;&amp; bwl-&gt;running[!black] &lt; 1 . This fixed the the logic. Thank you very much ,sir."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "edited": false, "score": 1, "creation_date": 1545236525, "post_id": 53841962, "comment_id": 94558367, "body": "@CyberFox: True; thanks for the pointer. Should be fixed now."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "edited": false, "score": 1, "creation_date": 1545236859, "post_id": 53841962, "comment_id": 94558573, "body": "I did spend a bit of time thinking about how to solve the fairness issue. It isn&#39;t exactly trivial, but using the <code>waiting</code> counter as the ticket (so that those who grabbed a counter value smaller than <code>limit</code> get to start, and the others just decrement their counter value by <code>limit</code> at wakeup, and sleep for the next broadcast) should work.  I haven&#39;t tried that in practice, because this is such an odd use case that I haven&#39;t needed to think about such a scheme, so I cannot be sure; but I do believe that should work to ensure fairness, assuming <code>limit</code> are always constants."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 2, "last_activity_date": 1545236494, "last_edit_date": 1545236494, "creation_date": 1545171683, "answer_id": 53841962, "question_id": 53840142, "link": "https://stackoverflow.com/questions/53840142/restricting-resource-access-by-type-for-many-to-many/53841962#53841962", "title": "Restricting resource access by type for many-to-many", "body": "<p>Consider the following an extended comment to <a href=\"https://stackoverflow.com/a/53841019/1475978\">John Bollingers answer</a>.</p>\n\n<p>The rules OP described are incomplete. For example, consider the case where you have three black threads with the resource, one white thread waiting for the resource, and another black thread arrives desiring to grab the resource. What should happen? If the black thread always gets the resource, then it is possible for black (or white) threads to starve the other type of thread. If the ownership is changed to the other type immediately when possible, we lose most of the benefit of the concurrency across threads of the same type; possibly running just one thread of one type at a time, with all threads sequential, if the distribution of incoming thread types is roughly even!</p>\n\n<p>There are several possible solutions.  The one that seems to fit OP's problem statement is to allow up to <i>N<sub>black</sub></i> black threads to run with the resource, before switching to whites' turn if any are waiting; and up to <i>N<sub>white</sub></i> white threads to run with the resource, before switching to blacks' turn. (A time limit, a grace period when additional threads of the same type may also grab the resource, is probably what you'd actually use in practice.)</p>\n\n<p>We can use the following structure to describe this kind of a lock:</p>\n\n<pre><code>struct bwlock {\n    pthread_mutex_t    lock;        /* Protects the rest of the fields */\n    pthread_cond_t     wait[2];     /* To wait for their turn */\n    volatile int       waiting[2];  /* Number of threads waiting */\n    volatile int       running[2];  /* Number of threads running */\n    volatile int       started[2];  /* Number of threads started in this turn */\n    const int          limit[2];    /* Maximum number of starts per turn */\n    volatile int       black;       /* Black threads' turn */\n};\n#define BWLOCK_INIT(whites, blacks) \\\n    { PTHREAD_MUTEX_INITIALIZER, \\\n      { PTHREAD_COND_INITIALIZER, PTHREAD_COND_INITIALIZER }, \\\n      { 0, 0 }, { 0, 0 }, { 0, 0 }, { whites, blacks }, 0 \\\n    }\n</code></pre>\n\n<p>The <code>lock</code> mutex is only held while examining the fields, not during resource access.</p>\n\n<p>(Also note that although <code>black</code> is initially 0, when there are no runners and no waiters, the turn will change, so it does not matter. The code will work exactly the same if the initial <code>black</code> is 1.)</p>\n\n<p>Let's look at releasing the bwlock first, because it is the more interesting part; it is what controls the turn changes. Let's assume both lock and release have a <code>isblack</code> parameter (which is either 0 or 1). If the releasing thread is the last of its color, and threads of the other color are waiting, it will change the turn, and broadcast on the other color <code>wait</code> condition variable to wake them up:</p>\n\n<pre><code>void bwlock_unlock(struct bwlock *bwl, const int isblack)\n{\n    const int black = !!isblack;  /* 0 if white, 1 if black */\n\n    pthread_mutex_lock(&amp;(bwl-&gt;lock));\n\n    /* This thread is no longer using the resource. */\n    bwl-&gt;running[black]--;\n\n    /* Was this the last of this color, with others waiting? */\n    if ((bwl-&gt;running[black] &lt;= 0) &amp;&amp; (bwl-&gt;waiting[!black] &gt; 0)) {\n        /* Yes. It's their turn. */\n        if (bwl-&gt;black == black) {\n            bwl-&gt;black = !black;\n            /* Clear their started counter. */\n            bwl-&gt;started[!black] = 0;\n        }\n        /* Wake them all up. */\n        pthread_cond_broadcast(&amp;(bwl-&gt;wait[!black]));\n    }\n\n    pthread_mutex_unlock(&amp;(bwl-&gt;lock));\n    return;\n}\n</code></pre>\n\n<p>Grabbing the bwlock is more complicated. The limit only applies if there are no threads of the other type waiting (because threads of a single color would deadlock without the other color if we did).</p>\n\n<pre><code>void bwlock_lock(struct bwlock *bwl, const int isblack)\n{\n    const int  black = !!isblack; /* 0 if white, 1 if black */\n\n    pthread_mutex_lock(&amp;(bwl-&gt;lock));\n    while (1) {\n\n        /* No runners or waiters of the other color? */\n        if ((bwl-&gt;waiting[!black] &lt; 1) &amp;&amp; (bwl-&gt;running[!black] &lt; 1)) {\n            /* No; we can run. Does this change the turn? */\n            if (bwl-&gt;black != black) {\n                bwl-&gt;black = black;\n                /* Clear started counter. */\n                bwl-&gt;started[black] = 0;\n            }\n            break;\n        }\n\n        /* Still our turn, and not too many started threads? */\n        if ((bwl-&gt;black == black) &amp;&amp; (bwl-&gt;started[black] &lt; bwl-&gt;limit[black]))\n            break;\n\n        /* We must wait. */\n        bwl-&gt;waiting[black]++;\n        pthread_cond_wait(&amp;(bwl-&gt;wait[black]), &amp;(bwl-&gt;lock));\n        bwl-&gt;waiting[black]--;\n    }\n\n    bwl-&gt;started[black]++;\n    bwl-&gt;running[black]++;\n\n    pthread_mutex_unlock(&amp;(bwl-&gt;lock));\n}\n</code></pre>\n\n<p>The <code>pthread_cond_wait(&amp;(bwl-&gt;wait[black]), &amp;(bwl-&gt;lock))</code> releases the lock and waits for a signal or broadcast on the condition variable. When signaled, it will re-acquire the lock before returning. (There is no race window on releasing the lock and waiting on the condition variable; it happens atomically, effectively at the same point in time.)</p>\n\n<p>If you consider the logic above, the <code>bwlock_unlock()</code> handles the case when the last running thread of a specific color should handle the \"baton\" to the other thread set.  The <code>bwlock_lock()</code> determines whether a thread can run with the resource, or needs to wait. It will only change the turn when there are no threads of the other color running or waiting their turn.</p>\n\n<p>It is rather simple scheme, but you may need to think of several cases to understand its behaviour.</p>\n\n<p>The <code>started</code> counter is cleared when the turn changes, and incremented for each thread that was started during that turn. When it reaches <code>limit</code>, no more threads of that type will start; they will wait for their turn.</p>\n\n<p>Let's say <code>limit</code> is <code>{3, 3}</code>, and you have four threads of each type, and they basically all rush to the bwlock at the same time. Let's say the first thread to grab the lock is black. The three first black threads will run with the resource, and one black and four white threads will wait on the condition variable. When the turn changes, three of the white threads get to run; one white, a random one, will re-wait until next white turn.</p>\n\n<p>Also, as Craig Estey points out in a comment to John Bollingers answer, this does not guarantee fairness among threads of the same type. For example, if A and B are of the same type, A accesses the bwlock-protected resource multiple times during their turn, and B just once, it is possible for B to have to wait indefinitely before getting a turn because A \"hogs\" all its slots.</p>\n\n<p>To guarantee fairness, we'd need some sort of a ticket lock or ordered wait queues, so that we can wake up the <code>limit</code> longest-waiting threads of a specific color, instead of random waiting ones.</p>\n"}], "owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "accepted_answer_id": 53841962, "answer_count": 2, "score": 0, "last_activity_date": 1545236494, "creation_date": 1545162926, "last_edit_date": 1545229881, "question_id": 53840142, "link": "https://stackoverflow.com/questions/53840142/restricting-resource-access-by-type-for-many-to-many", "title": "Restricting resource access by type for many-to-many", "body": "<p><strong>DISCLAIMER: this post contains edits done on the answers below, all the credits go to their respective owners.</strong></p>\n\n<p>I am trying to implement a problem which states that a resource may be used by two types of threads. There can be more threads of each type. (4 threads of type White and 6 of type Black). Any number of blacks can use the resource at the same time. Same goes for the whites one. I still cannot wrap my head around this...</p>\n\n<p>I tried to implement this using mutexes. I also wanted to take into account the possible starvation this implementation might have, thus I decided to check if the number of served threads of a certain type has been reached, allowing the other type to do work. I cannot seem to be able to implement the latest.</p>\n\n<p>I also wanted to take into account that whenever the other type wants to use the resource, it must await its turn, as well as the others to finish using the resource.</p>\n\n<p>EDIT: I tried to use the solution of <strong>@Nominal-Animal</strong>, but it seems this deadlocks sometimes as well. Moreover, I added the missing turn to the struct. Now, I have got some extra question: </p>\n\n<ul>\n<li>this seems right, but doesn't work, why?</li>\n<li>why does need the double negation for the <code>isBLack</code> parameter inside <code>bwlock_lock()</code></li>\n</ul>\n\n<p>Now, for some code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;wait.h&gt;\n#include &lt;pthread.h&gt;\n\n#define WHITES 31\n#define BLACKS 33\n#define TYPES 2\n#define W_ID 0\n#define B_ID 1\n\nstruct bwlock\n{\n    pthread_mutex_t lock;    /* Protects the rest of the fields */\n    pthread_cond_t wait[2];  /* To wait for their turn */\n    volatile int waiting[2]; /* Number of threads waiting */\n    volatile int running[2]; /* Number of threads running */\n    volatile int started[2]; /* Number of threads started in this turn */\n    const int limit[2];      /* Maximum number of starts per turn */\n    volatile int black;      /* Black threads' turn */\n    volatile int turn;       /*The turn */\n};\n\n#define BWLOCK_INIT(whites, blacks, turn)                         \\\n    {                                                             \\\n        PTHREAD_MUTEX_INITIALIZER,                                \\\n            {PTHREAD_COND_INITIALIZER, PTHREAD_COND_INITIALIZER}, \\\n            {0, 0}, {0, 0}, {0, 0}, {whites, blacks}, 0, turn     \\\n    }\n\nstruct bwlock resource = BWLOCK_INIT(4, 5, W_ID);\n\nvoid bwlock_unlock(struct bwlock *bwl, const int isblack)\n{\n    const int black = !!isblack; /* 0 if white, 1 if black */\n\n    pthread_mutex_lock(&amp;(bwl-&gt;lock));\n\n    /* This thread is no longer using the resource. */\n    bwl-&gt;running[black]--;\n\n    /* Was this the last of this color, with others waiting? */\n    if (bwl-&gt;running[black] &lt;= 0 &amp;&amp; bwl-&gt;waiting[!black])\n    {\n        /* Yes. It's their turn. */\n        if (bwl-&gt;turn == black)\n        {\n            bwl-&gt;turn = !black;\n            /* Clear their started counter. */\n            bwl-&gt;started[!black] = 0;\n        }\n        /* Wake them all up. */\n        pthread_cond_broadcast(&amp;(bwl-&gt;wait[!black]));\n    }\n\n    pthread_mutex_unlock(&amp;(bwl-&gt;lock));\n}\n\nvoid bwlock_lock(struct bwlock *bwl, const int isblack)\n{\n    const int black = !!isblack; /* 0 if white, 1 if black */\n\n    pthread_mutex_lock(&amp;(bwl-&gt;lock));\n    while (1)\n    {\n\n        /* No runners or waiters of the other color? */\n        if (!(bwl-&gt;waiting[!black] &lt; 1) &amp;&amp; bwl-&gt;running[!black] &lt; 1)\n        {\n            /* No; we can run. Does this change the turn? */\n            if (bwl-&gt;turn != black)\n            {\n                bwl-&gt;turn = black;\n                /* Clear started counter. */\n                bwl-&gt;started[black] = 0;\n            }\n            break;\n        }\n\n        /* Still our turn, and not too many started threads? */\n        if (bwl-&gt;turn == black &amp;&amp; bwl-&gt;started[black] &lt; bwl-&gt;limit[black])\n            break;\n\n        /* We must wait. */\n        bwl-&gt;waiting[black]++;\n        pthread_cond_wait(&amp;(bwl-&gt;wait[black]), &amp;(bwl-&gt;lock));\n        bwl-&gt;waiting[black]--;\n    }\n\n    bwl-&gt;started[black]++;\n    bwl-&gt;running[black]++;\n\n    pthread_mutex_unlock(&amp;(bwl-&gt;lock));\n}\n\ntypedef struct\n{\n    int thread_id;\n    char *type;\n    int type_id;\n} data;\n\nvoid use_resource(int thread_id, char *type)\n{\n    printf(\"U: Thread %d of type %s is using the resource!\\n\", thread_id, type);\n}\n\nvoid take_resource(int thread_id, char *type, int type_id)\n{\n    printf(\"W:Thread %d of type %s is trying to get the resource!\\n\", thread_id, type);\n    bwlock_lock(&amp;resource, type_id);\n    printf(\"W:Thread %d of type %sB got resource!\\n\", thread_id, type);\n}\n\nvoid release_resource(int thread_id, char *type, int type_id)\n{\n    bwlock_unlock(&amp;resource, type_id);\n    printf(\"R:Thread %d of type %s has released the resource!\\n\", thread_id, type);\n}\n\nvoid *doWork(void *arg)\n{\n    data thread_data = *((data *)arg);\n\n    int thread_id = thread_data.thread_id;\n    char *type = thread_data.type;\n    int type_id = thread_data.type_id;\n    take_resource(thread_id, type, type_id);\n    use_resource(thread_id, type);\n    release_resource(thread_id, type, type_id);\n\n    return NULL;\n}\n\ndata *initialize(pthread_t threads[], int size, char *type, int type_id)\n{\n    data *args = malloc(sizeof(data) * size);\n    for (int i = 0; i &lt; size; i++)\n    {\n        args[i].type = type;\n        args[i].thread_id = i;\n        args[i].type_id = type_id;\n        pthread_create(&amp;threads[i], NULL, doWork, (void **)&amp;args[i]);\n    }\n    return args;\n}\n\nvoid join(pthread_t threads[], int size)\n{\n    for (int i = 0; i &lt; size; i++)\n    {\n        pthread_join(threads[i], NULL);\n    }\n}\n\nint main()\n{\n    pthread_t whites[WHITES];\n    pthread_t blacks[BLACKS];\n    char *white = \"WHITE\";\n    char *black = \"BLACK\";\n    data *w_args = initialize(whites, WHITES, white, W_ID);\n    data *b_args = initialize(blacks, BLACKS, black, B_ID);\n\n    join(whites, WHITES);\n    join(blacks, BLACKS);\n\n    free(w_args);\n    free(b_args);\n\n    return 0;\n}\n</code></pre>\n\n<p>This has been compiled using <code>gcc -g -o ba blacks_whites.c -Wall -Wextra -pthread</code> .</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1545161180, "post_id": 53839711, "comment_id": 94527818, "body": "C doesn&#39;t have function overloading concept, we should use the same argument &amp; return type in both declaration &amp; definition of the function. Here <code>void vector_append_float(Vector_float *, int);</code>  you are telling to compiler that second argument is of <code>int</code> type but while defining <code>void vector_append_float(Vector_float *vector, float value){ }</code> you are using second argument as <code>float</code> type which results in error. Use the same type."}, {"owner": {"reputation": 5, "user_id": 9876633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2moy-blihU/AAAAAAAAAAI/AAAAAAAAA5U/C7zoH7uJX0k/photo.jpg?sz=128", "display_name": "C\u035d\u0361e\u0362\u0337pt\u0321\u0315i\u0334\u0358\u0338u\u035c\u0360\u035dm", "link": "https://stackoverflow.com/users/9876633/c%cd%9d%cd%a1e%cd%a2%cc%b7pt%cc%a1%cc%95i%cc%b4%cd%98%cc%b8u%cd%9c%cd%a0%cd%9dm"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545161373, "post_id": 53839711, "comment_id": 94527904, "body": "I removed them for simplicity, the actual functions have arguments, so same result as stated above. Will revert."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1545161456, "post_id": 53839711, "comment_id": 94527941, "body": "They are in the question in plain sight. The function declarations (prototypes) are different from the function definitions (implementations)."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545161525, "post_id": 53839711, "comment_id": 94527979, "body": "It looks to me as if vector is some sort of type, is it?"}, {"owner": {"reputation": 5, "user_id": 9876633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2moy-blihU/AAAAAAAAAAI/AAAAAAAAA5U/C7zoH7uJX0k/photo.jpg?sz=128", "display_name": "C\u035d\u0361e\u0362\u0337pt\u0321\u0315i\u0334\u0358\u0338u\u035c\u0360\u035dm", "link": "https://stackoverflow.com/users/9876633/c%cd%9d%cd%a1e%cd%a2%cc%b7pt%cc%a1%cc%95i%cc%b4%cd%98%cc%b8u%cd%9c%cd%a0%cd%9dm"}, "edited": false, "score": 0, "creation_date": 1545161647, "post_id": 53839711, "comment_id": 94528038, "body": "vector is a struct I made. It has size, capacity and data member variables."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545161705, "post_id": 53839711, "comment_id": 94528061, "body": "a header file must contains (or <code>#include</code>) every thing it needs.  In the current posted code, the header file needs the definition of <code>Vector_float</code>"}, {"owner": {"reputation": 5, "user_id": 9876633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2moy-blihU/AAAAAAAAAAI/AAAAAAAAA5U/C7zoH7uJX0k/photo.jpg?sz=128", "display_name": "C\u035d\u0361e\u0362\u0337pt\u0321\u0315i\u0334\u0358\u0338u\u035c\u0360\u035dm", "link": "https://stackoverflow.com/users/9876633/c%cd%9d%cd%a1e%cd%a2%cc%b7pt%cc%a1%cc%95i%cc%b4%cd%98%cc%b8u%cd%9c%cd%a0%cd%9dm"}, "edited": false, "score": 0, "creation_date": 1545162145, "post_id": 53839711, "comment_id": 94528254, "body": "vector_float is included in constants.h"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545162701, "post_id": 53839711, "comment_id": 94528482, "body": "Then, post the contents of <code>constants.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545163046, "post_id": 53839711, "comment_id": 94528625, "body": "code should not contain <code>#include</code> statements that depend on the order of the includes.  Suggest that the file <code>vector.h</code> contain the statement: <code>#include &quot;constants.h&quot;</code>.  Infact since you want to make this into a library, suggest elimination of the file <code>constants.h</code>  and include its&#39; contents in <code>vector.h</code>  That way the user only needs a single header file to be able to use the library"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9876633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2moy-blihU/AAAAAAAAAAI/AAAAAAAAA5U/C7zoH7uJX0k/photo.jpg?sz=128", "display_name": "C\u035d\u0361e\u0362\u0337pt\u0321\u0315i\u0334\u0358\u0338u\u035c\u0360\u035dm", "link": "https://stackoverflow.com/users/9876633/c%cd%9d%cd%a1e%cd%a2%cc%b7pt%cc%a1%cc%95i%cc%b4%cd%98%cc%b8u%cd%9c%cd%a0%cd%9dm"}, "edited": false, "score": 0, "creation_date": 1545161906, "post_id": 53839854, "comment_id": 94528139, "body": "That&#39;s it! I initially created the declarations as int in vector.h but decided to use floats in vector.c, forgetting to change them. Thank you."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1545161474, "creation_date": 1545161474, "answer_id": 53839854, "question_id": 53839711, "link": "https://stackoverflow.com/questions/53839711/implementation-c-file-conflicts-with-its-own-definition-h-file/53839854#53839854", "title": "Implementation (.c) file conflicts with its own definition (.h) file", "body": "<p>As the error messages state, there is a conflict between the declarations of the functions specified and their definitions.  Specifically:</p>\n\n<ul>\n<li><code>vector_append_float</code> has a <code>float</code> for the second parameter but the declaration shows <code>int</code>.</li>\n<li><code>vector_get_float</code> returns <code>float</code> but the declaration says it returns an <code>int</code>.</li>\n<li><code>vector_set_float</code> taks a <code>float</code> for its third parameter but the declaration says it should be an <code>int</code>.</li>\n</ul>\n\n<p>The declaration and definition of a function need to match.  Since the definitions seem to be using the correct type, you need to update the declarations in the header file to match.</p>\n"}], "owner": {"reputation": 5, "user_id": 9876633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2moy-blihU/AAAAAAAAAAI/AAAAAAAAA5U/C7zoH7uJX0k/photo.jpg?sz=128", "display_name": "C\u035d\u0361e\u0362\u0337pt\u0321\u0315i\u0334\u0358\u0338u\u035c\u0360\u035dm", "link": "https://stackoverflow.com/users/9876633/c%cd%9d%cd%a1e%cd%a2%cc%b7pt%cc%a1%cc%95i%cc%b4%cd%98%cc%b8u%cd%9c%cd%a0%cd%9dm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53839854, "answer_count": 1, "score": 0, "last_activity_date": 1545161551, "creation_date": 1545160792, "last_edit_date": 1545161551, "question_id": 53839711, "link": "https://stackoverflow.com/questions/53839711/implementation-c-file-conflicts-with-its-own-definition-h-file", "title": "Implementation (.c) file conflicts with its own definition (.h) file", "body": "<p>I'm trying to create a project that can calculate the weighted average of a class. In this project, I decided to split the declarations and implementations of the header files to separate .h and .c files respectively, then linking them together as object files. This worked well until I created my most recent file, a library of vector functions. When I attempt to build the project, the function signatures from vector.h conflict with the ones from vector.c. Here are the files:</p>\n\n<p>vector.h:</p>\n\n<pre><code>#ifndef VECTOR_H\n#define VECTOR_H\n\nvoid vector_initiate_float(Vector_float *vector);\n\nvoid vector_append_float(Vector_float *vector, int value);\n\nint vector_get_float(Vector_float *vector, int index);\n\nvoid vector_set_float(Vector_float *vector, int value, int index);\n\nvoid vector_double_cap_if_full_float(Vector_float *vector);\n\nvoid vector_free_float(Vector_float *vector);\n\n#endif /* VECTOR_H */\n</code></pre>\n\n<p>vector.c:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include \"constants.h\"\n    #include \"vector.h\"\n    void vector_append_float(Vector_float *vector, float value){\n        vector_double_cap_if_full_float(vector);\n        vector-&gt;data[vector-&gt;size++] = value;\n    }\n\n    float vector_get_float(Vector_float *vector, int index){\n        if (index &gt;= vector-&gt;size || index &lt; 0) {\n        printf(\"Index %d out of bounds for vector of size %d\\n\", index, vector-&gt;size);\n        exit(1);\n      }\n      return vector-&gt;data[index];\n    }\n\n    void vector_set_float(Vector_float *vector, int index, float value){\n       while (index &gt;= vector-&gt;size) {\n        vector_append_float(vector, 0);\n      }\n\n      // set the value at the desired index\n      vector-&gt;data[index] = value;\n    }\n\n    void vector_double_cap_if_full_float(Vector_float *vector){\n        if (vector-&gt;size &gt;= vector-&gt;capacity) {\n        // double vector-&gt;capacity and resize the allocated memory accordingly\n        vector-&gt;capacity *= 2;\n        vector-&gt;data = realloc(vector-&gt;data, sizeof(int) * vector-&gt;capacity);\n      }\n    }\n\n    void vector_free_float(Vector_float *vector){\n        free(vector-&gt;data);\n    }\n</code></pre>\n\n<p>output when I run gcc -c vector.c</p>\n\n<pre><code>vector.c:14:6: error: conflicting types for \u2018vector_append_float\u2019\n void vector_append_float(Vector_float *vector, float value){\n      ^~~~~~~~~~~~~~~~~~~\nIn file included from vector.c:11:\nvector.h:14:6: note: previous declaration of \u2018vector_append_float\u2019 was here\n void vector_append_float(Vector_float *, int);\n      ^~~~~~~~~~~~~~~~~~~\nvector.c:19:7: error: conflicting types for \u2018vector_get_float\u2019\n float vector_get_float(Vector_float *vector, int index){\n       ^~~~~~~~~~~~~~~~\nIn file included from vector.c:11:\nvector.h:16:5: note: previous declaration of \u2018vector_get_float\u2019 was here\n int vector_get_float(Vector_float *, int);\n     ^~~~~~~~~~~~~~~~\nvector.c:27:6: error: conflicting types for \u2018vector_set_float\u2019\n void vector_set_float(Vector_float *vector, int index, float value){\n      ^~~~~~~~~~~~~~~~\nIn file included from vector.c:11:\nvector.h:18:6: note: previous declaration of \u2018vector_set_float\u2019 was here\n void vector_set_float(Vector_float *, int, int);\n</code></pre>\n\n<p>As you can see, the function definitions on both files appear to conflict one another, even though this doesn't happen to any other .c and .h pair of files in my project. Searching the internet didn't bear any fruit, so I'm posting here. </p>\n"}, {"tags": ["c", "linux-kernel", "driver", "bus"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545161017, "post_id": 53839693, "comment_id": 94527751, "body": "Your wording confuses me.  I could imagine that some forms or patterns of access are <i>more affected</i> by PCIe bus latency than others, but I don&#39;t see how they could <i>introduce</i> bus latency.  Isn&#39;t the latency you&#39;re talking about a hardware characteristic?"}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545161479, "post_id": 53839693, "comment_id": 94527951, "body": "@JohnBollinger .. that&#39;s basically my question. My code, as is, wouldn&#39;t <i>introduce</i> bus latency because the <code>ioctl</code> and <code>read&#47;write</code> are the same code, so any bus latency is due to the card or PCI bus itself, not the driver (or necessarily even the kernel). I&#39;ve tried to explain this to the client&#39;s hardware guys and the developer who thinks this, but the developer wants me to give proof, and I&#39;m just the contractor .. so I&#39;m trying to find out how I can test the timing of the bus through my driver based on the function I utilize, or provide other proofs to this fact."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545161621, "post_id": 53839693, "comment_id": 94528026, "body": "The part that really made my ears perk up was the contrast between &quot;communicates 1-4 bytes at a time&quot; and &quot;1-byte communication&quot;.  If the <code>read</code> and <code>write</code> implementations indeed operate only a single byte at a time, but the hardware supports four at a time, then they will indeed suffer from more latency than is necessary.  Whether you provide an <code>ioctl</code> that could do better is unclear."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545161972, "post_id": 53839693, "comment_id": 94528166, "body": "Frankly, it&#39;s also a bit surprising to me that your driver exposes ioctls that can serve the same purpose as <code>read</code> and <code>write</code>.  Of course, the <code>ioctl</code> interface is very generic and can support that, but it normally is used for providing access to device parameters, not for performing I/O."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545162024, "post_id": 53839693, "comment_id": 94528186, "body": "@JohnBollinger .. I edited my question to make that a little more clear; the card <i>can</i> communicate 1, 2 or 4 bytes at a time, depending on how the user specifies, so a 1-byte <code>ioctl</code> call is the same is a 1-byte <code>read</code> (at least that&#39;s the question) ... as an aside, the <code>ioctl</code> to communicate is something they wanted in the driver :/"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545162131, "post_id": 53839693, "comment_id": 94528244, "body": "What is the data transfer rate of the device?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545162493, "post_id": 53839693, "comment_id": 94528400, "body": "It may be worth having a talk with the concerned developer.  Reading between the lines here, I&#39;m guessing that your client&#39;s devs have been involved in preparing Windows drivers for the hardware, and that you have been engaged to prepare a Linux driver.  The client&#39;s devs might then have some specific experience with the hardware that you could benefit from, with their concerns springing from that.  It doesn&#39;t sound like your <code>ioctl</code> would exhibit different performance characteristics than your <code>read</code> and <code>write</code>, but perhaps they could <i>all</i> be better."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545162598, "post_id": 53839693, "comment_id": 94528442, "body": "@CraigEstey they have roughly 50 different PCI DAQ cards, so it can vary, but those rates are card specific and documented in their specs, but they all read/write via the same address&#39;, so the driver doesn&#39;t need to distinguish when it&#39;s a read/write operation. Although, that <i>might</i> be where this dev&#39;s concern come from."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545163473, "post_id": 53839693, "comment_id": 94528838, "body": "The transfer rate matters. For a few thousand bytes/second it doesn&#39;t matter. For millions, using <code>ioctl</code> may be necessary, because you&#39;d need to set up zero-copy buffers mappable in userspace, kernel, and device space. At one company, I did <code>ioctl</code> and another developer did <code>read&#47;write</code> for a DMA video device. We had to switch it to <code>ioctl</code> when the <code>read&#47;write</code> [being a stream of sorts] couldn&#39;t adequately synchronize. Also, you&#39;ll need <code>ioctl</code> to be able to set the BAR registers of the device to get the correct mode for maximum transfer speed"}], "answers": [{"comments": [{"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1545162804, "post_id": 53839941, "comment_id": 94528531, "body": "Based on the other comments and this answer, I&#39;m going to try and reword my explanation to the hardware team, and then have an offline conversation with the dev to ascertain where the concern is, and maybe even walk them through it all ... They&#39;ve seen the code, so I&#39;m hoping it&#39;s just a matter of a deeper conversation .. thanks!"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 1, "creation_date": 1545162850, "post_id": 53839941, "comment_id": 94528548, "body": "It&#39;s an easy thing to misunderstand, particularly for someone who works on hardware a lot and doesn&#39;t work on drivers much. It&#39;s easy to think that because you call a function named <code>read</code>, that means a read operation is performed on the bus. And so on."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1545162993, "post_id": 53839941, "comment_id": 94528607, "body": "<i>that means a read operation is performed on the bus</i> .. great insight! I&#39;m guessing that&#39;s where the confusion is likely coming from."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 2, "last_activity_date": 1545161930, "creation_date": 1545161930, "answer_id": 53839941, "question_id": 53839693, "link": "https://stackoverflow.com/questions/53839693/pcie-bus-latency-when-using-ioctl-vs-read/53839941#53839941", "title": "PCIe bus latency when using ioctl vs read?", "body": "<p>I suspect the client's developer is slightly confused. He's thinking that the distinction between using <code>read</code> or <code>write</code> versus <code>ioctl</code> corresponds to the type of operation performed on the bus. If you explain to him that this is just a software API difference and either option performs the exact same operation on the bus, that should satisfy them.</p>\n"}], "owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 53839941, "answer_count": 1, "score": 1, "last_activity_date": 1545161930, "creation_date": 1545160707, "last_edit_date": 1545161769, "question_id": 53839693, "link": "https://stackoverflow.com/questions/53839693/pcie-bus-latency-when-using-ioctl-vs-read", "title": "PCIe bus latency when using ioctl vs read?", "body": "<p>I've got a hardware client<sup>1</sup> who's line of data acquisition cards I've written a Linux PCI kernel driver for.</p>\n\n<p>The card can only communicate 1-4 bytes at a time depending on how the user specifies to utilize it, given this, I utilize <a href=\"http://man7.org/linux/man-pages/man2/ioctl.2.html\" rel=\"nofollow noreferrer\"><code>ioctl</code></a> for some of the functionality, but also make use of the <a href=\"http://www.tldp.org/LDP/lkmpg/2.4/html/c577.htm\" rel=\"nofollow noreferrer\"><code>file_operations</code></a> structure to treat the card as a basic character device to give the user of the card the ability to just use <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\"><code>read</code></a> or <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\"><code>write</code></a> if they just want simple 1-byte communication with the card.</p>\n\n<p>After discussing the driver with the client, one of their developers is in the understanding that treating the card as a character device by using <code>open/read/write</code> will introduce latency on the PCI <em>bus</em>, versus using <code>open/ioctl</code>.</p>\n\n<p>Given that the driver makes no distinction how it's opened and the <code>ioctl</code>  and <code>read/write</code> functions call the same code, is there any validity to this concern?</p>\n\n<p>If so, how would I test the <em>bus</em> latency from my driver code? Are there kernel functions I can call to test this?</p>\n\n<p>Lastly, wouldn't my test of the bus only be valid for my specific setup (kernel settings, platform, memory timing, CPU, etc.)?</p>\n\n<p><sup>1: they only have 2 other developers, neither of which have ever used Linux</sup></p>\n"}, {"tags": ["c", "linux", "timer", "linux-kernel", "linux-device-driver"], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 0, "creation_date": 1545255468, "post_id": 53842823, "comment_id": 94566861, "body": "Yikes!  And timer_setup was supposed to be an improvement!?!"}, {"owner": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 0, "creation_date": 1545255947, "post_id": 53842823, "comment_id": 94567072, "body": "Anyway, I made the changes (apparently page_cache_release() and get_user_pages() have been similarly improved). But I get compile errors in the callback function with the from_timer() call.    The error is &quot;pointer type mismatch in container_of()&quot;.  Am I supposed to be casting any/all of those arguments? The error message doesn&#39;t give many clues (that I understand) on which argument is flagged."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 2, "creation_date": 1545257123, "post_id": 53842823, "comment_id": 94567508, "body": "@ElRonaldo Error messages about <code>container_of()</code> are quite reasonable if <code>timer_list</code> is declared as pointer in your struct. As mentioned above the example <b><i>is not for case</i></b> <code>typedef struct { struct timer_list *getIntrTimer; &#47;*smth else*&#47; } myDevice;</code>, but <b><i>is for case</i></b> <code>typedef struct { struct timer_list getIntrTimer; &#47;*smth else*&#47; } myDevice;</code>"}, {"owner": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 1, "creation_date": 1545257735, "post_id": 53842823, "comment_id": 94567755, "body": "Ohhhh, you mean I&#39;m supposed to read your <b>whole</b> response!?!!??  I&#39;ve too short an attention span for that, man!"}, {"owner": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 0, "creation_date": 1545260324, "post_id": 53842823, "comment_id": 94568619, "body": "Does from_timer  <b>require</b> that  struct timer_list be the first element in the myDevice struct?  In my case it is not only a pointer, but also not the first element, and frankly I do not follow the container_of() expansion."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 0, "creation_date": 1545262278, "post_id": 53842823, "comment_id": 94569146, "body": "=) It doesn&#39;t have to be the first element."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "reply_to_user": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "edited": false, "score": 0, "creation_date": 1547246434, "post_id": 53842823, "comment_id": 95140909, "body": "@ElRonaldo, new <i>timer_setup()</i> API is definitely an improvement."}, {"owner": {"reputation": 311, "user_id": 1286512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ccb408c91c701217b3a4303fc0b784?s=128&d=identicon&r=PG", "display_name": "Ken A", "link": "https://stackoverflow.com/users/1286512/ken-a"}, "edited": false, "score": 0, "creation_date": 1550766805, "post_id": 53842823, "comment_id": 96400654, "body": "Don&#39;t forget to add     #include &lt;linux/version.h&gt; to your code."}], "tags": [], "owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "is_accepted": true, "score": 15, "last_activity_date": 1545256449, "last_edit_date": 1545256449, "creation_date": 1545177663, "answer_id": 53842823, "question_id": 53839625, "link": "https://stackoverflow.com/questions/53839625/adaptation-from-old-init-timer-to-new-timer-setup/53842823#53842823", "title": "Adaptation from old init_timer to new timer_setup", "body": "<p>The <code>timer_setup()</code> with three args is present since 4.14 Linux kernel (FYI there was <code>setup_timer()</code> in slightly earlier versions). If you maintain some code which should be relevant up to recent kernels - you have to change it in appropriate way every time the API changes. Now you can access your data through the special function <code>from_timer()</code> based on <a href=\"https://stackoverflow.com/questions/15832301/understanding-container-of-macro-in-the-linux-kernel\"><code>container_of()</code></a>.</p>\n\n<p><code>timer_list</code> is normally used not as pointer inside struct, so the example implies normal usage and could be something like:</p>\n\n<pre><code>#if LINUX_VERSION_CODE &lt; KERNEL_VERSION(4,14,0)\n    init_timer(&amp;dev-&gt;getIntrTimer);\n    dev-&gt;getIntrTimer.data = (unsigned long) dev;\n    dev-&gt;getIntrTimer.function = GetIntrTimerCallback;\n    /* ... */\n    add_timer(&amp;dev-&gt;getIntrTimer);\n#else\n    timer_setup(&amp;dev-&gt;getIntrTimer, GetIntrTimerCallback, 0);\n    /* the third argument may include TIMER_* flags */\n    /* ... */\n#endif\n</code></pre>\n\n<hr>\n\n<p>The callback function:</p>\n\n<pre><code>#if LINUX_VERSION_CODE &lt; KERNEL_VERSION(4,14,0)\nvoid GetIntrTimerCallback(unsigned long devAddr)\n{\n    myDevice *dev = (myDevice *) devAddr;\n#else\nvoid GetIntrTimerCallback(struct timer_list *t)\n{\n    myDevice *dev = from_timer(dev, t, getIntrTimer);\n#endif\n    /* Do something with \"dev\" */\n</code></pre>\n\n<p>Read also:</p>\n\n<ul>\n<li><a href=\"https://lwn.net/Articles/735887/\" rel=\"noreferrer\">Linux kernel timers new API</a></li>\n<li><a href=\"https://lwn.net/Articles/735892/\" rel=\"noreferrer\">Example</a></li>\n<li><a href=\"https://stackoverflow.com/questions/16721346/is-there-a-macro-definition-to-check-the-linux-kernel-version\">Linux kernel versions</a></li>\n</ul>\n"}], "owner": {"reputation": 291, "user_id": 1236547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62a2f3e0e645a661535f49e306eb1e3?s=128&d=identicon&r=PG", "display_name": "El Ronaldo", "link": "https://stackoverflow.com/users/1236547/el-ronaldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9531, "favorite_count": 1, "accepted_answer_id": 53842823, "answer_count": 1, "score": 3, "last_activity_date": 1613644186, "creation_date": 1545160347, "last_edit_date": 1613644186, "question_id": 53839625, "link": "https://stackoverflow.com/questions/53839625/adaptation-from-old-init-timer-to-new-timer-setup", "title": "Adaptation from old init_timer to new timer_setup", "body": "<p>I have been trying to port a driver from 2.6 to 4.X without support from the original board manufacturer (and very limited Linux experience).</p>\n<p>The original driver uses <code>init_timer()</code> and passes in a pointer to the <code>timer_list</code> structure. That <code>timer_list</code> structure's <code>data</code> element was set to a pointer to another memory structure and the <code>function</code> element set to the callback.  Inside the callback function the <code>data</code> element was used to access other bits of stuff.</p>\n<p>The current timer <code>init</code>-method uses:</p>\n<pre><code>timer_setup( timer_list *, callback, (unsigned int) flags);\n</code></pre>\n<p>and the <code>timer_list</code> structure was changed to eliminate the <code>data</code> field.</p>\n<p>I'm not sure what is the best/proper way to inform the callback function of the equivalent <code>data</code> element.  Can anyone provide some guidance?</p>\n<p>Here is a snippet of the old driver:</p>\n<pre><code>myDevice * dev;\n\ndev-&gt;getIntrTimer = kmalloc(sizeof(struct timer_list), GFP_KERNEL);    \ninit_timer(dev-&gt;getIntrTimer);\n\ndev-&gt;getIntrTimer-&gt;data = (unsigned long) dev;\ndev-&gt;getIntrTimer-&gt;function = GetIntrTimerCallback;\n</code></pre>\n<p>The callback function starts off like this:</p>\n<pre><code>void GetIntrTimerCallback(unsigned long devAddr)\n{\n    myDevice *dev = (myDevice *) devAddr;\n    dev-&gt;blahBlah++; // etc.\n</code></pre>\n<p>So the old code gets passed the pointer to <code>myDevice</code> so inside the callback that structure can be accessed.</p>\n<p>But with the new timer method only has available an int that is 4 bytes but a pointer is 8 (or whatever).</p>\n<p>What I'd like to do is this:</p>\n<pre><code>dev-&gt;getIntrTimer = kmalloc(sizeof(struct timer_list), GFP_KERNEL);\ntimer_setup(dev-&gt;getIntrTimer, GetIntrTimerCallback, dev);\n</code></pre>\n<p>but of course that generates compile errors because <code>dev</code> is a pointer to type <code>myDevice</code>, which does not fit in an int.</p>\n"}, {"tags": ["c", "vector", "copy"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545158794, "post_id": 53839093, "comment_id": 94526765, "body": "Can you <i>prove</i> that <code>r_i</code> is valid (i.e. non-zero) after the <code>_emd</code> call? But, it looks like you&#39;d want <code>array_copy(r_i, M * N, wn);</code>"}, {"owner": {"reputation": 3, "user_id": 6308117, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154225587512276/picture?type=large", "display_name": "Chuck", "link": "https://stackoverflow.com/users/6308117/chuck"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545235543, "post_id": 53839093, "comment_id": 94557785, "body": "The fix to array_copy seems to work. Now, I&#39;m trying to fix a new problem with MacOS clang. :-(  My Linux virtual box produces a weird segmentation fault where none had existed, even before the fix."}], "owner": {"reputation": 3, "user_id": 6308117, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154225587512276/picture?type=large", "display_name": "Chuck", "link": "https://stackoverflow.com/users/6308117/chuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548962639, "creation_date": 1545157798, "question_id": 53839093, "link": "https://stackoverflow.com/questions/53839093/c-trouble-with-copying-multiple-vectors-containing-matrices-into-a-single-vecto", "title": "C: Trouble with copying multiple vectors containing matrices into a single vector", "body": "<p>Package: GNU C</p>\n\n<p>I'm trying to add function iceemdan() to the open source package libeemd (<a href=\"https://bitbucket.org/luukko/libeemd\" rel=\"nofollow noreferrer\">https://bitbucket.org/luukko/libeemd</a>). It compiles but produces erroneous results. iceemdan() is based on ceemdan() and eemd() in the same package. First, a reduced version of the code:</p>\n\n<pre><code>libeemd_error_code iceemdan(double const* restrict input, size_t N,\n        double* restrict output, size_t M,\n        unsigned int ensemble_size, double noise_strength, unsigned int\n        S_number, unsigned int num_siftings, unsigned long int rng_seed) {\n    ...\n    // Initialize output data to zero\n    memset(output, 0x00, M*N*sizeof(double));\n    // Storage for white noise modes\n    double* wnmodes = malloc(M*ensemble_size*N*sizeof(double));\n    ...\n        for (size_t en_i=0; en_i&lt;ensemble_size; en_i++) {\n            ...\n            // Provide a pointer to the wnnodes vector where these modes will be stored\n            double* const wn = &amp;wnmodes[en_i*M*N];\n            double* r_i = malloc(M*N*sizeof(double));\n            memset(r_i, 0x00, M*N*sizeof(double));\n            // Generate white noise\n            ...\n            // Extract white noise modes to r_i\n            emd_err = _emd(w-&gt;x, w-&gt;emd_w, r_i, M, S_number, num_siftings);\n            ...\n            array_copy(r_i, N, wn);\n            ...\n        }\n    ...\n    // Lots more processing\n}\n</code></pre>\n\n<p>iceemdan()'s argument *output contains the output.   The first memset() initializes it to 0.  *wnnodes effectively contains ensemble_size versions of *output (the *r_i defined in the for loop).  Each iteration first initializes r_i, ensemble member i's version of *output and wn, a pointer to the location in wnnodes in which to store r_i.  array_copy() copies r_i to wn.</p>\n\n<p>Here's the definition of array_copy:</p>\n\n<pre><code>inline static void array_copy(double const* restrict src, size_t n, double* restrict dest) {\n    memcpy(dest, src, n*sizeof(double));\n}\n</code></pre>\n\n<p>The problem is that wnnodes ends up with ensemble_size copies of nonsense.  It has zeroes in the first row, which _emd can't produce with nonzero data. I suspect the problem lies with the definition of wn.  I tried to remove \"&amp;\" from its definition and got an error.  It's probably very obvious to an experienced eye.</p>\n"}, {"tags": ["c", "pointers", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 5, "creation_date": 1545155203, "post_id": 53838452, "comment_id": 94525138, "body": "Rule of Thumb: If the same code produces different output on different compilers you are very likely to have <i>undefined behavior</i> in your code"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545155242, "post_id": 53838452, "comment_id": 94525159, "body": "This code is not very readable. To answer the title - yes, if i contains Undefined behavior, or is relying on implementation defined behavior."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1545155718, "post_id": 53838452, "comment_id": 94525388, "body": "@UnholySheep, I figured I had something to do with it, but I can not visualize it. Thank you very much for your attention."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545155819, "post_id": 53838452, "comment_id": 94525426, "body": "@EugeneSh., Please suggest me so you can improve readability. I&#39;m very grateful."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545156015, "post_id": 53838452, "comment_id": 94525521, "body": "Remove unneeded casts (<code>malloc</code> result and some others), simplify the <code>for</code> construct (number of initializations, operations and comparisons in the <code>for(...)</code>). And add some comments."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 5, "creation_date": 1545156553, "post_id": 53838452, "comment_id": 94525786, "body": "<code>pp</code> is declared as an <code>int **</code>, which is a pointer to a pointer to an <code>int</code>, but is assigned the value of <code>&amp;ALPHA[(NUM_DISK + disk) % 2]</code>, which is a pointer to an array of 3 arrays of 2 <code>const int</code>. The forced cast <code>(int **)</code> masks this error \u2014 <b>Do not use casts in C to force pointer conversion.</b> (It is two errors, actually: A pointer to an array is not a pointer to a pointer, and <code>ALPHA</code> ultimately contains <code>const int</code>, but <code>pp</code> is missing <code>const</code>.)"}, {"owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1545156610, "post_id": 53838452, "comment_id": 94525810, "body": "confirmed wrong results using <code>gcc</code> on my machine (i.e. same as VS above) as well. i.e. undefined behavior in code mentioned by @UnholySheep"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545156853, "post_id": 53838452, "comment_id": 94525913, "body": "The assignment of <code>&amp;pp[k % 3]</code> to <code>list[rank - 1]</code> is similarly wrong."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "edited": false, "score": 0, "creation_date": 1545157136, "post_id": 53838452, "comment_id": 94526064, "body": "@static_cast, I got the same result here: [cpp.sh/5ol45](cpp.sh/5ol45). Thanks."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545157156, "post_id": 53838452, "comment_id": 94526077, "body": "@EugeneSh., Thank you. I&#39;ll do it."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545157443, "post_id": 53838452, "comment_id": 94526178, "body": "@EricPostpischil,I believe you have pointed out all the paths that I must evaluate. I will try to make all the corrections you have shown. I am very grateful for your help."}, {"owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545157580, "post_id": 53838452, "comment_id": 94526240, "body": "@EricPostpischil I was really lost in this code :-)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545165270, "post_id": 53838452, "comment_id": 94529651, "body": "the posted code causes the compiler to output several warning messages about type conversions.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to produce the same results )"}], "owner": {"reputation": 11, "user_id": 10807264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647bcb0d56c082e43b894d35ebb6db0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenedy", "link": "https://stackoverflow.com/users/10807264/kenedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545155084, "creation_date": 1545155084, "question_id": 53838452, "link": "https://stackoverflow.com/questions/53838452/can-pointers-generate-distinct-results-in-different-compilers-whats-the-proble", "title": "Can pointers generate distinct results in different compilers? What&#39;s the problem?", "body": "<p>I'm studying with a bit more depth access to memory in C and I have a question I can not solve. I have the code below, which solve the Towers of Hanoi iteratively. And it works great on both GCC and CLANG, but not on VS2017.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid solve(const int NUM_DISK)\n{\n    const int ALPHA[2][3][2] =\n    {\n        { { 1, 3 }, { 3, 2 }, { 2, 1 } },   /* even */\n        { { 1, 2 }, { 2, 3 }, { 3, 1 } }    /* odd */\n    };\n\n    const int MAX_ITER = 1 &lt;&lt; NUM_DISK;\n\n    int **list = (int **) malloc( (MAX_ITER - 1) * sizeof(int*) );\n\n    int start, gap, disk, k, rank;\n\n    for (start = 1, gap = 2, disk = 1; disk &lt;= NUM_DISK; ++disk, start &lt;&lt;= 1, gap &lt;&lt;= 1)\n    {\n        int **pp = (int **) &amp;ALPHA[(NUM_DISK + disk) % 2];\n\n        for (k = 0, rank = start; rank &lt; MAX_ITER + (disk % 2); rank += gap, ++k)\n        {\n            list[rank - 1] = (int *) &amp;pp[k % 3];\n        }\n    }\n\n    for (rank = 0; rank &lt; (MAX_ITER - 1); ++rank)\n    {\n        char origem  = list[rank][0] + 64;\n        char destino = list[rank][1] + 64;\n        printf(\"%4d ) %c --&gt; %c\\n\", (rank + 1), origem, destino);\n    }\n\n    free(list);\n}\n\nint main(int argc, char **argv)\n{\n    int d = atoi(argv[1]);\n    solve(d);\n    return 0;\n}\n</code></pre>\n\n<p>Assuming we have 3 disks, the results are as follows:</p>\n\n<pre><code>RESULT IN GCC        RESULT IN VS2017\n\n1 ) A --&gt; C          1 ) A --&gt; C\n2 ) A --&gt; B          2 ) A --&gt; B\n3 ) C --&gt; B          3 ) C --&gt; C\n4 ) A --&gt; C          4 ) A --&gt; C\n5 ) B --&gt; A          5 ) C --&gt; B\n6 ) B --&gt; C          6 ) B --&gt; B\n7 ) A --&gt; C          7 ) A --&gt; C\n</code></pre>\n\n<p>Please, can someone tell me what's the problem?</p>\n"}, {"tags": ["c", "linked-list", "int", "nodes", "singly-linked-list"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1545155160, "post_id": 53838425, "comment_id": 94525115, "body": "Fyi, ask yourself what the value of <code>second</code> is in <code>main</code> when you do this: <code>head = newNode(number_1, second);</code> ? If your answer is &quot;i dunno&quot;, you&#39;re on the same page as your program, because it doesn&#39;t either. Pointers hold <i>values</i> (which happened to be addresses). Without assigning them properly(in this case building your list <i>backwards</i>), you&#39;re loading your structure <code>next</code> members with indeterminate values, the later evaluation of which invokes <i>undefined behavior</i>. Regarding your error, why are you assigning a memory address to your <code>int</code> data member ?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1545155232, "post_id": 53838425, "comment_id": 94525152, "body": "your error is unrelated to the problem, but it is a problem as you&#39;re leaking memory - <code>tmp_node-&gt;data</code> is an <code>int</code> and doesn&#39;t need memory allocating for it...especially as you overwrite it&#39;s contents on the line that follows"}, {"owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1545155428, "post_id": 53838425, "comment_id": 94525252, "body": "@WhozCraig <code>second</code>doesn&#39;t have a value i guess, it is just a node that has been initialized, as I want then that <code>head</code> points to <code>second</code>with node (as in ex1).. So I guess the input of second is empty?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1545155626, "post_id": 53838425, "comment_id": 94525352, "body": "@s.r. put another way. If I write <code>int x; printf(&quot;%d\\n&quot;, x);</code> what would you expect to be printed? The only right answer here is &quot;we don&#39;t know what x is, so we have no idea.&quot; The same is true for your <code>second</code> and <code>third</code> pointers in your second code list. They have not been given determinate values at the time you&#39;re using them, so using their values  as input to your function makes no sense. Now, think about what would happen if you build your nodes <i>backwards</i> (third, then second, then head) using the otherwise-same calls you have now, but in reverse order. Just think about it."}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1545155366, "post_id": 53838494, "comment_id": 94525218, "body": "Whilst your answer is pointing out a problem - it doesn&#39;t answer the question being asked"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1545156191, "post_id": 53838494, "comment_id": 94525609, "body": "Thanks @ChrisTurner for pointing. I guess it&#39;s works now. My immediate reply was about OP&#39;s warning message about <code>malloc()</code>."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 1, "last_activity_date": 1545156110, "last_edit_date": 1545156110, "creation_date": 1545155273, "answer_id": 53838494, "question_id": 53838425, "link": "https://stackoverflow.com/questions/53838425/singly-linked-list-newnode-function-doesnt-point-to-next-node/53838494#53838494", "title": "Singly Linked List: newNode function doesn&#39;t point to next Node", "body": "<p>Here</p>\n\n<pre><code>tmp_node-&gt;data = malloc(sizeof(struct Node)); /* remove this statement */\n</code></pre>\n\n<p><code>data</code> is a member of <code>struct Node</code> &amp; that's a integer, for this separately you don't have to allocate memory. you have already allocated for complete structure here</p>\n\n<pre><code>tmp_node = malloc(sizeof(struct Node)); /* this is enough */\n</code></pre>\n\n<p>Also here</p>\n\n<pre><code>head = newNode(number_1, second);\n</code></pre>\n\n<p>what is <code>second</code> ? It should be initialized with <code>NULL</code> like</p>\n\n<pre><code>struct Node *second = NULL;\n</code></pre>\n\n<p>then only in <code>newNode()</code> function <code>tmp_node-&gt;next</code> assigned with correct value</p>\n\n<pre><code>tmp_node-&gt;next = nextnode; /* now nextnode contains NULL, that's correct */\n</code></pre>\n\n<p>Or you can make it like below </p>\n\n<pre><code>head = newNode(number_1, NULL);\nsecond = newNode(number_2, head);\nthird = newNode(number_3, second);\n</code></pre>\n\n<p>and then while calling <code>printNodes()</code> pass the <code>third</code> instead of <code>head</code>. For e.g</p>\n\n<pre><code>printNodes(third);\n</code></pre>\n\n<p>Sample code :</p>\n\n<pre><code>struct Node  {\n    int data;\n    struct Node *next;\n};\n\nstruct Node *newNode(int number_x, struct Node *nextnode) {\n    struct Node *tmp_node;\n    tmp_node = malloc(sizeof(struct Node));\n    tmp_node-&gt;data = number_x;\n    tmp_node-&gt;next = nextnode;\n    return tmp_node;\n}\n\nvoid printNodes(struct Node *current_node) {\n    while(current_node != NULL) {\n        printf(\"Node is: %d\\n\", current_node-&gt;data);\n        current_node = current_node-&gt;next;\n    }\n}\n\nint main(void) {\n    int number_1 = 2;\n    int number_2 = 3;\n    int number_3 = 4;\n\n    struct Node *head = NULL;\n    struct Node *second = NULL;\n    struct Node *third = NULL;\n\n    head = newNode(number_1, NULL);\n    second = newNode(number_2, head);\n    third = newNode(number_3, second);\n    printNodes(third);\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1545156129, "creation_date": 1545156129, "answer_id": 53838703, "question_id": 53838425, "link": "https://stackoverflow.com/questions/53838425/singly-linked-list-newnode-function-doesnt-point-to-next-node/53838703#53838703", "title": "Singly Linked List: newNode function doesn&#39;t point to next Node", "body": "<p>Thanks to @WhozCraig for clarifying.</p>\n\n<p>As he mentioned, the <code>second</code> node doesn't know what his input is.\nTo break it down, the same happens if you write something like this: \n<code>int num; printf(\"%d\",num)</code></p>\n\n<p>The programm doesn't know what's the input since there hasn't been an input initialized.</p>\n\n<p>The same thing happens with my programm, there has been no node initalized so the programm doesn't know where <code>next-node</code> is.\nBut if I write the programm backwards, the programm does now understand what the value is and can work with it:</p>\n\n<pre><code>    //use it backwards\n    third = newNode(number_3, NULL);\n    second = newNode(number_2, third);\n    head = newNode(number_1, second);\n</code></pre>\n\n<p>Now, the output is correctly:</p>\n\n<pre><code>Node is: 2\nNode is: 3\nNode is: 4\n</code></pre>\n\n<p>thanks for helping,\ncheers.</p>\n"}, {"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1545157241, "creation_date": 1545157241, "answer_id": 53838953, "question_id": 53838425, "link": "https://stackoverflow.com/questions/53838425/singly-linked-list-newnode-function-doesnt-point-to-next-node/53838953#53838953", "title": "Singly Linked List: newNode function doesn&#39;t point to next Node", "body": "<p>First, the warning (which should be treated as an error, fyi) you are seeing is not related to your overall problem, but it is nonetheless important. It is both improper, and leaks memory, and has the vague appearance of testing spaghetti. In case you've never done it, an old-school kitchen technique to see if the pasta is \"done\" is to take a strand from the pot and literally throw it at the wall to see if it sticks. This seemingly extraneous line of code looks like just that; like you threw something at the wall to see if it stuck:</p>\n\n<p>This:</p>\n\n<pre><code>tmp_node-&gt;data = malloc(sizeof(struct Node)); // DELETE THIS\n</code></pre>\n\n<p>shouldn't even be in your code <em>at all</em>;  the succeeding line does what should be done, namely this:</p>\n\n<pre><code>tmp_node-&gt;data = number_x; // KEEP THIS\n</code></pre>\n\n<hr>\n\n<p><strong>Wiring A Linked List</strong></p>\n\n<p>While the prior diatribe is concerning, it isn't what is delivering your unenviable position of not wiring your list correctly. That is a problem all unto itself.  Consider the following:</p>\n\n<pre><code>struct Node *head;      // indeterminate\nstruct Node *second;    // indeterminate\nstruct Node *third;     // indeterminate\n</code></pre>\n\n<p>In the first two <code>newNode</code> calls you're passing indeterminate pointer values to what will eventually be the newly allocated node <code>next</code> pointers. This is significant. My reversing the build order you can get behavior you seek.</p>\n\n<pre><code>third = newNode(number_3, NULL);    // third is set, next points to NULL\nsecond = newNode(number_2, third);  // second it set, next points to third\nhead = newNode(number_1, second);   // head is set, next points to second\n</code></pre>\n\n<p>Obviously it's not ideal to have to do this, but to just learn how things are wired this is one way to do it. Another would be to actually assign to the next members directly. For example:</p>\n\n<pre><code>head = newNode(number_1, NULL); \nhead-&gt;next = newNode(number_2, NULL);\nhead-&gt;next-&gt;next = newNode(number_3, NULL);\n</code></pre>\n\n<p>This works as well, but again, isn't ideal. Would you really want to do this for building a linked list of a hundred nodes ?</p>\n\n<p><strong>Forward Chaining A Linked List</strong></p>\n\n<p>There <em>is</em> a very succinct way to build a ascending linked list without having to do the above.  It is called <em>forward-chaining</em> and utilizes a pointer-to-pointer, which initially points to the head pointer itself (which is initially NULL):</p>\n\n<pre><code>struct Node *head = NULL;\nstruct Node **pp = &amp;head; // points to a pointer, initially the head pointer\n</code></pre>\n\n<p>With the above, we can chain together a list of however many elements you want. A hundred ? no problem:</p>\n\n<pre><code>for (int i=1; i&lt;=100; ++i)\n{\n    // allocate a new node, storing the address at whatever pointer\n    // is being addressed by the pointer-to-pointer pp. Initially it\n    // will be the `head` pointer variable.\n\n    *pp = malloc(sizeof **pp);\n    (*pp)-&gt;data = i;\n\n    // move pp to point to the next pointer of the node we just added\n    pp = &amp;(*pp)-&gt;next;\n}\n*pp = NULL; // terminate the list\n\n\nprintNodes(head);\n</code></pre>\n\n<p>This is just one way to build linked lists. There are many others (doing it recursively, for example, is not uncommon when studying recursion in school). But it is probably the simplest, an near-certainly the fastest. </p>\n\n<p>Anyway, that was longer than I intended, but I hope it helped.</p>\n"}], "owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53838494, "answer_count": 3, "score": 2, "last_activity_date": 1545157241, "creation_date": 1545154971, "question_id": 53838425, "link": "https://stackoverflow.com/questions/53838425/singly-linked-list-newnode-function-doesnt-point-to-next-node", "title": "Singly Linked List: newNode function doesn&#39;t point to next Node", "body": "<p>I am currently experimenting with singly-linked-list in C. I have written a \n<code>newNode</code> function to create a Node and a <code>printNodes</code> function to print out all nodes - it looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Node \n{\n  int data;\n  struct Node *next;\n}; \n\nvoid printNodes(struct Node *current_node)\n{\n  while(current_node != NULL)\n  {\n    printf(\"Node is: %d\\n\", current_node-&gt;data);\n    current_node = current_node-&gt;next;\n  }\n}\n\nint main()\n{\n  int number_1 = 2;\n  int number_2 = 3;\n  int number_3 = 4;\n\n  struct Node *head;\n  struct Node *second;\n  struct Node *third;\n\n  head = (struct Node*)malloc(sizeof(struct Node));  \n  second = (struct Node*)malloc(sizeof(struct Node)); \n  third = (struct Node*)malloc(sizeof(struct Node));\n\n  head-&gt;data = number_1;      \n  head-&gt;next = second; \n\n  second-&gt;data = number_2;      \n  second-&gt;next = third; \n\n  third-&gt;data = number_3;     \n  third-&gt;next = NULL; \n\n  printNodes(head);\n\n}\n</code></pre>\n\n<p>output is correctly:</p>\n\n<pre><code>Node is: 2\nNode is: 3 \nNode is: 4\n</code></pre>\n\n<p>Now I wanted to write a function <code>newNode</code> which is used to create a new node, I changed my code to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Node \n{\n    int data;\n    struct Node *next;\n};\n\nstruct Node *newNode(int number_x, struct Node *nextnode)\n{\n    struct Node *tmp_node;\n\n    tmp_node = malloc(sizeof(struct Node));\n    tmp_node-&gt;data = malloc(sizeof(struct Node));\n    tmp_node-&gt;data = number_x;\n    tmp_node-&gt;next = nextnode;\n\n    return tmp_node;\n}   \n\nvoid printNodes(struct Node *current_node)\n{\n    while(current_node != NULL)\n    {\n        printf(\"Node is: %d\\n\", current_node-&gt;data);\n        current_node = current_node-&gt;next;\n    }\n}\n\nint main()\n{\n    int number_1 = 2;\n    int number_2 = 3;\n    int number_3 = 4;\n\n    struct Node *head;\n    struct Node *second;\n    struct Node *third;\n\n    head = newNode(number_1, second);\n    second = newNode(number_2, third);\n    third = newNode(number_3, NULL);\n\n    printNodes(head);\n\n}\n</code></pre>\n\n<p>After compiling I first get this warning message:</p>\n\n<pre><code>test.c:16:20: warning: incompatible pointer to integer conversion \nassigning to 'int' from 'void *' [-Wint-conversion]\ntmp_node-&gt;data = malloc(sizeof(struct Node));\n               ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>And the output looks like this:</p>\n\n<pre><code>Node is: 2\n</code></pre>\n\n<p>It only shows the Node <code>head</code>, I guess there is something wrong with <code>next</code> pointing \n(e.g. <code>head-&gt;next = second</code>), but what is wrong? I am unable to solve this.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545154957, "post_id": 53838395, "comment_id": 94524997, "body": "Tip: Be very careful when using super tiny character buffers like <code>char name[10]</code>. It&#39;s probably better to use <code>char* name</code> instead and dynamically allocate labels at the required length."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545155097, "post_id": 53838395, "comment_id": 94525076, "body": "You need to evaluate the inputs <i>before</i> evaluating the output."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1545155464, "post_id": 53838395, "comment_id": 94525268, "body": "Note that a flipflop is not a combinatorial item (it maintains a state), so it doesn&#39;t quite fit here."}], "answers": [{"comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1545160695, "post_id": 53838453, "comment_id": 94527620, "body": "The last <code>gateor</code> should be <code>gateand</code>, shouldn&#39;t it?"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 3, "last_activity_date": 1545169973, "last_edit_date": 1545169973, "creation_date": 1545155095, "answer_id": 53838453, "question_id": 53838395, "link": "https://stackoverflow.com/questions/53838395/logic-gate-simulation-in-c/53838453#53838453", "title": "logic gate simulation in c", "body": "<p>Recursively you could solve it like this:</p>\n\n<pre><code>int pre (struct gate *root) {\n    if (root-&gt;type == INPUT)\n        return root-&gt;value; // This is the recursion end\n    else if (root-&gt;type == OR) {\n        return gateor(pre(root-&gt;input1), pre(root-&gt;input2)); // Recurse here\n    } else if (root-&gt;type == AND) {\n        return gateand(pre(root-&gt;input1), pre(root-&gt;input2));\n    } // Same for the other operations\n}\n</code></pre>\n\n<p>This should give you an idea how to solve your problem.</p>\n"}], "owner": {"reputation": 71, "user_id": 10500431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37sW2.jpg?s=128&g=1", "display_name": "XLVII", "link": "https://stackoverflow.com/users/10500431/xlvii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 53838453, "answer_count": 1, "score": 1, "last_activity_date": 1545236345, "creation_date": 1545154838, "last_edit_date": 1545236345, "question_id": 53838395, "link": "https://stackoverflow.com/questions/53838395/logic-gate-simulation-in-c", "title": "logic gate simulation in c", "body": "<pre><code> struct gate\n    {\n        char name[10]; \n        int type; //Type of the gate : INPUT,AND, OR, NOT, FLIPFLOP\n        int value;\n        char inputname1[10];\n        char inputname2[10];\n        struct gate *input1;\n        struct gate *input2;\n    };\n</code></pre>\n\n<p>I've created a tree with a struct structure, but I can't find out how to calculate it in a recursive way, can you help?</p>\n\n<p><img src=\"https://i.stack.imgur.com/eX7MX.png\" alt=\"schema\"></p>\n\n<pre><code>int pre(struct gate *root)        //address of root node is pass\n{\n    if(root-&gt;input1-&gt;type==INPUT || root-&gt;input2-&gt;type==INPUT){\n        if(root-&gt;type == OR){\n            root-&gt;type = INPUT;\n            return root-&gt;value = gateor(root-&gt;input1-&gt;value,root-&gt;input2-&gt;value);\n        }\n        if(root-&gt;type == AND){\n            root-&gt;type = INPUT;\n            return root-&gt;value = gateand(root-&gt;input1-&gt;value,root-&gt;input2-&gt;value);\n        }\n        if(root-&gt;type==NOT){\n            root-&gt;type=INPUT;\n            return root-&gt;value = gatenot(root-&gt;input1-&gt;value);\n        }\n        if(root-&gt;type == FLIPFLOP){\n            root-&gt;type = INPUT;\n            return root-&gt;value = gateflipflop(root-&gt;input1-&gt;value,0);\n        }\n    }\n\n    pre(root-&gt;input1);\n    pre(root-&gt;input2);\n\n}\n</code></pre>\n\n<p>i can't think recursive,I was hoping it would work.</p>\n\n<p>a,b,c,d is a struct but it only has value , type and name.<br>\nvalues are 1 and 0<br>\ngate values = -1;<br>\nI don't know if these values \u200b\u200bare necessary.</p>\n"}, {"tags": ["c", "arrays", "while-loop"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1545154594, "post_id": 53838316, "comment_id": 94524785, "body": "missing semicolon after <code>i++</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1545154605, "post_id": 53838316, "comment_id": 94524796, "body": "missing semicolon in the first line. Post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and a proper description of what is not working."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1545154624, "post_id": 53838316, "comment_id": 94524809, "body": "That <code>i++</code> means you&#39;re repeatedly examining uninitialized data in your do-while condition, btw. Even if you fix the syntax, you&#39;re program still invokes <i>undefined behavior</i>. You also make no attempt at validating <code>scanf</code> actually <i>worked</i> (it has a return value for a reason; <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">check your documentation</a>). That&#39;s a buried conditional bug just waiting to happen."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545154690, "post_id": 53838316, "comment_id": 94524838, "body": "You write the user value to <code>numbers[i]</code> (eg <code>numbers[2]</code>), then increment <code>i</code> (eg <code>3</code>) and test <code>numbers[i] &#47;* new i! *&#47;</code> (eg <code>numbers[3]</code>) which is no longer what the user wrote."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "edited": false, "score": 0, "creation_date": 1545165782, "post_id": 53838316, "comment_id": 94529883, "body": "Pmg, Eugene, Whozcraig thanks for the comments. 1.Actually i put those semicolons in my code, i just made a mistake while recopying; 2. What was not working that the table does not want to stop storing values when i input 0."}], "answers": [{"comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1545154935, "post_id": 53838365, "comment_id": 94524982, "body": "P__J__ - you&#39;re correct, but there are other problems with the OP&#39;s code, too.  SUGGESTION: why not give a complete example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "edited": false, "score": 0, "creation_date": 1545165938, "post_id": 53838365, "comment_id": 94529958, "body": "I tried it, and it&#39;s working now. Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "edited": false, "score": 0, "creation_date": 1545170501, "post_id": 53838365, "comment_id": 94531691, "body": "But i don&#39;t really understand it, can you explain how the &quot;while ( number[i++] )&quot; work ?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545170932, "post_id": 53838365, "comment_id": 94531864, "body": "because i++ is increased after the check"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1545155003, "last_edit_date": 1545155003, "creation_date": 1545154716, "answer_id": 53838365, "question_id": 53838316, "link": "https://stackoverflow.com/questions/53838316/while-loop-does-not-want-to-work-properly-in-c/53838365#53838365", "title": "While loop does not want to work properly in C", "body": "<p>They work perfect. </p>\n\n<p>But you increase <code>i</code> before checking the condition.</p>\n\n<p>Try <code>}while (numbers[i++] != 0);</code> and remove <code>i++</code> in the previous line.</p>\n"}, {"comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1545155986, "post_id": 53838514, "comment_id": 94525507, "body": "Q: is the &quot;while()&quot; expression <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>? <a href=\"https://stackoverflow.com/questions/45803172/does-this-code-in-c-fall-into-the-undefined-behavior-category\" title=\"does this code in c fall into the undefined behavior category\">stackoverflow.com/questions/45803172/&hellip;</a>.  I <i>believe</i> it&#39;s OK, because I believe &quot;!=&quot; introduces a sequence point.  Q: Have you tried it?  Does it work?"}, {"owner": {"reputation": 159, "user_id": 2548592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giH3O.png?s=128&g=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2548592/tejas"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1545156861, "post_id": 53838514, "comment_id": 94525917, "body": "afaik, it would be undefined behavior if we had something like <code>numbers[i++] != i</code>. But this does not appear to be undefined behavior, and it works. <b>EDIT:</b> If you use <code>numbers[i++] != i</code> and compile with flags <code>-Wall -Werror</code>, you get an unsequenced modification error. But using <code>numbers[i++] != 0</code> does not throw an error."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1545157972, "post_id": 53838514, "comment_id": 94526405, "body": "Beautiful - that&#39;s what I thought.  Thank you for confirming :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "edited": false, "score": 0, "creation_date": 1545165814, "post_id": 53838514, "comment_id": 94529899, "body": "It&#39;s finally working, thanks tejgop. I just removed the &quot;i++&quot; that was before the condition test and put it in the condition test itself (while number[i++])"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "edited": false, "score": 0, "creation_date": 1545170469, "post_id": 53838514, "comment_id": 94531682, "body": "But i don&#39;t really understand it, can you explain how the &quot;while ( number[i++] )&quot; work ?"}, {"owner": {"reputation": 159, "user_id": 2548592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giH3O.png?s=128&g=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2548592/tejas"}, "edited": false, "score": 0, "creation_date": 1545177983, "post_id": 53838514, "comment_id": 94533820, "body": "Suppose <code>i=0</code>. If you do <code>number[i]</code>, it evaluates to <code>number[0]</code>. If you do <code>number[++i]</code>, it <i>first</i> increments it, resulting in <code>number[1]</code>. But we did <code>number[i++]</code> which first evaluates to <code>number[0]</code>, and <i>then</i> increments to <code>i=1</code>."}], "tags": [], "owner": {"reputation": 159, "user_id": 2548592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giH3O.png?s=128&g=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2548592/tejas"}, "is_accepted": false, "score": 2, "last_activity_date": 1545178026, "last_edit_date": 1545178026, "creation_date": 1545155340, "answer_id": 53838514, "question_id": 53838316, "link": "https://stackoverflow.com/questions/53838316/while-loop-does-not-want-to-work-properly-in-c/53838514#53838514", "title": "While loop does not want to work properly in C", "body": "<p>Expanding on @P__J__'s answer, this works:</p>\n\n<pre><code>int numbers[100];\nint i = 0;\n\ndo\n{\n    printf(\"Enter the %d value : \", (i+1) );\n    scanf(\"%d\", &amp;numbers[i]);\n\n}while (numbers[i++] != 0);\n</code></pre>\n\n<p>There were some missing semicolons, but the major issue is incrementing <code>i</code> before using it in the <code>while</code> condition. <code>i++</code> returns the original value of <code>i</code>, and then increments it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10807394"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1545164775, "accepted_answer_id": 53838365, "answer_count": 2, "score": 0, "last_activity_date": 1545178026, "creation_date": 1545154514, "last_edit_date": 1545168086, "question_id": 53838316, "link": "https://stackoverflow.com/questions/53838316/while-loop-does-not-want-to-work-properly-in-c", "closed_reason": "Not suitable for this site", "title": "While loop does not want to work properly in C", "body": "<p>I want to store some values in an array and want the array to stop storing values when the user inputs 0\nSo i have this code :</p>\n\n<pre><code>int numbers[100];\nint i = 0;\n\ndo\n\n{\n\n        printf(\"Enter the %d value : \", (i+1) );\n        scanf(\"%d\", &amp;numbers[i]);\n\n        i++;\n}while (numbers[i] != 0);\n</code></pre>\n\n<p>But it does not work, i spent like 2 hours on this.\nHelp please\nThanks</p>\n"}, {"tags": ["c", "arrays", "dynamic", "struct"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1545154013, "post_id": 53838163, "comment_id": 94524522, "body": "<code>dynamicString</code> is the only thing that needs <code>malloc</code> initialization. All other fields can be accessed directly, e.g. <code>A a = {0}; a.character = &#39;c&#39;; a.integer = 123; strcpy(a.staticString, &quot;hello&quot;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": true, "score": 0, "last_activity_date": 1545154307, "creation_date": 1545154307, "answer_id": 53838267, "question_id": 53838163, "link": "https://stackoverflow.com/questions/53838163/different-arrays-in-dynamic-struct-creation-writting-reading/53838267#53838267", "title": "Different arrays in dynamic struct, creation, writting, reading", "body": "<p>First things first:</p>\n\n<p>You're using C, and by the way you've defined the structure, you need to declare the pointer like so:</p>\n\n<pre><code>struct A *example;\n</code></pre>\n\n<p>Next, malloc returns a pointer, so you need to cast to a pointer (and not to a structure):</p>\n\n<pre><code>(struct A *)malloc(sizeof(struct A));\n</code></pre>\n\n<p>Secondly, I'm not sure why but hey:\n - you're trying to dynamically allocate an int in the structure. As I said previously, malloc returns a pointer, so in your structure you need an int pointer like so \"<code>int *integer;</code>\"\n - you're trying to allocate a dynamic string, however you're not doing it properly, here is what I think you want</p>\n\n<pre><code>example-&gt;dynamicString = (char *)malloc(sizeof(char) * 10);\n</code></pre>\n\n<p>Where 10 is the size of your dynamic string.</p>\n\n<p>Edit:</p>\n\n<p>you may also populate the integer in your struct statically or dynamically, but I think you intended the static approach:</p>\n\n<pre><code>example-&gt;integer = 123;\n</code></pre>\n\n<p>The dynamic approach would be (assuming you have <code>int *integer</code> in your struct):</p>\n\n<pre><code>example-&gt;integer = (int *)malloc(sizeof(int));\n*(example-&gt;integer) = 123;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545154957, "post_id": 53838348, "comment_id": 94524998, "body": "Additions of sizeofs is most probably a bad idea. Better sizeof the structure, isn&#39;t it?"}, {"owner": {"reputation": 527, "user_id": 10488746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vTDhZ.jpg?s=128&g=1", "display_name": "H.cohen", "link": "https://stackoverflow.com/users/10488746/h-cohen"}, "reply_to_user": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545155369, "post_id": 53838348, "comment_id": 94525220, "body": "@John when you code I agree- but to explain that the 4 bytes (depending on architecture) was allocated when the hole struct was allocated for that int I thought this will make it simpler to get what exactly is done and how much space is allocated  and why there is no need to malloc (sizeof(int)) again."}, {"owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "edited": false, "score": 0, "creation_date": 1545155591, "post_id": 53838348, "comment_id": 94525329, "body": "Ok, I got you intention now."}], "tags": [], "owner": {"reputation": 527, "user_id": 10488746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vTDhZ.jpg?s=128&g=1", "display_name": "H.cohen", "link": "https://stackoverflow.com/users/10488746/h-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1545154644, "creation_date": 1545154644, "answer_id": 53838348, "question_id": 53838163, "link": "https://stackoverflow.com/questions/53838163/different-arrays-in-dynamic-struct-creation-writting-reading/53838348#53838348", "title": "Different arrays in dynamic struct, creation, writting, reading", "body": "<p>Every time you create a new struct the memory in the heap is set to size of :</p>\n\n<p>sizeof(char)*20 + sizeof(char pointer) +sizeof(char)+ sizeof(int). </p>\n\n<p>If you want to save a string that will be pointed to by your char pointer- then you ask for allocation in heap for the size of that string- and malloc returns the pointer to that memory allocation on heap.</p>\n\n<p>So, you already have a space for your char array, char pointer, char and int that was allocated when you asked to make a new struct and do not need to allocate it again.</p>\n\n<p>also, keep in mind malloc returns a pointer to the allocated place on the heap- so if you malloc(sizeof(int)) you get a pointer to a memory allocation for an int on the heap- which is pointed to by a int pointer Not an int.</p>\n\n<p>good luck!</p>\n"}], "owner": {"reputation": 23, "user_id": 9374757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47e4817c0281419e4f241f8d4e85ed41?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz2121", "link": "https://stackoverflow.com/users/9374757/grzegorz2121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 53838267, "answer_count": 2, "score": 1, "last_activity_date": 1545154644, "creation_date": 1545153850, "question_id": 53838163, "link": "https://stackoverflow.com/questions/53838163/different-arrays-in-dynamic-struct-creation-writting-reading", "title": "Different arrays in dynamic struct, creation, writting, reading", "body": "<p>Strait to the point.\nI have a struct with a string, char and int.\nThe struct is created dynamically because i will need it in different parts of my program.</p>\n\n<pre><code>struct A\n{\n  char staticString[20];\n  char* dynamicString;\n  char character;\n  int integer;\n};\n</code></pre>\n\n<p>I know if i want to create a struct i call:</p>\n\n<pre><code>A example = (A)malloc(sizeof(A));\n</code></pre>\n\n<p>In order to populate the dynamicString and int i used:</p>\n\n<pre><code>example-&gt;dynamicString = (char*)malloc(sizeof(char*));\nexample-&gt;integer = (int)malloc(sizeof(int));\n</code></pre>\n\n<p>Unfourtanetly when i tried to populate staticString and char it didn't worked.\nDon't even ask what was my code for those, i tried a lot of combinations from everywhere.</p>\n\n<p>In addition to that can somebody show me examples how to write/read those values?\nThanks in advance.</p>\n"}, {"tags": ["c", "windows", "file"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545153559, "post_id": 53838039, "comment_id": 94524304, "body": "Don&#39;t use C; use Perl or another scripting language (awk, perhaps).  It will be as fast as the C code and more flexible and much (much, much, much) easier to write."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "reply_to_user": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1545153752, "post_id": 53838039, "comment_id": 94524404, "body": "@BurnsBA I have tried it, but I thought that it was not important post my code not working, it will not help. I do not know if C is the best choice for that, it is the lenguaje I know due to that I use it. I have never heard about <code>scripting tools</code> nor <code>scripting languaje</code>. I will read about it"}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 1, "creation_date": 1545153827, "post_id": 53838039, "comment_id": 94524437, "body": "@JuMoGar It will help if you post your code, you should edit it into your post."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545153859, "post_id": 53838039, "comment_id": 94524452, "body": "@JonathanLeffler I have never write any code in Perl, I should learn it and I have no time now :(. Also, I use Windows so I can&#39;t use awk neither"}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "reply_to_user": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1545154511, "post_id": 53838039, "comment_id": 94524742, "body": "@BurnsBA Ok, I will add it"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1545154827, "post_id": 53838039, "comment_id": 94524933, "body": "If you use a POSIXy system (Linux, Mac), you could use a POSIX regular expression to split the input into fields, compiling the expression using <a href=\"http://man7.org/linux/man-pages/man3/regex.3.html\" rel=\"nofollow noreferrer\"><code>regcomp()</code></a>, reading each line using <code>getline()</code>, and applying the expression using <code>regexec()</code>, with each field as a submatch. (Each submatch is given as an offset, length tuple, referring to the input line.) Then, I&#39;d probably just use <code>fwrite()</code> to output the fields, and <code>fputs()</code> for the separators and newline. Should not be many lines of code at all."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545155052, "post_id": 53838039, "comment_id": 94525054, "body": "@NominalAnimal Thank you, but I am using Windows so I am not using POSIX system, so I can not do that"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545155106, "post_id": 53838039, "comment_id": 94525082, "body": "@JuMoGar: Then add a <a href=\"https://stackoverflow.com/questions/tagged/windows\">windows</a> tag, please."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1545155145, "post_id": 53838039, "comment_id": 94525104, "body": "@NominalAnimal Ok, added"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545170602, "post_id": 53838039, "comment_id": 94531727, "body": "Note <code>NAME[strlen(NAME)-1] = &#39;\\0&#39;;</code> is not a good way to trim trailing spaces.  See   <a href=\"https://stackoverflow.com/a/26984026/2410359\">stackoverflow.com/a/26984026/2410359</a> and others."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545171165, "post_id": 53838039, "comment_id": 94531936, "body": "Ok, I will take a look. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545169072, "post_id": 53839501, "comment_id": 94531110, "body": "Thank you so much. It is increible. I have updated question (with an EDIT 2) with a few question about your code. Could you take a look, please?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545169501, "post_id": 53839501, "comment_id": 94531272, "body": "@JuMoGar 6: <code>#define TIMEZONE_FMT &quot;%5d]&quot; int TIMEZONE;</code> --&gt; <code>#define TIMEZONE_FMT &quot;%5[^]]]&quot; char TIMEZONE[5+1];</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545169659, "post_id": 53839501, "comment_id": 94531332, "body": "@JuMoGar 7: <code>#define METHOD_FMT &quot; \\&quot;%s&quot; char METHOD[sizeof line]; </code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545169824, "post_id": 53839501, "comment_id": 94531386, "body": "@JuMoGar 8 <code>#define DIR_FMT &quot; %[^\\&quot;]\\&quot;&quot; char DIR[sizeof line];</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1545169956, "post_id": 53839501, "comment_id": 94531438, "body": "@JuMoGar The <code>n</code> is use to detect if the scan succeeded as posted in this answer with <code>if (n == 0) return Invalid_Input;</code>.  For more details research <code>scan_set</code> and <code>&quot;%n&quot;</code> in <code>sscanf()</code>.  I&#39;ll leave the rest for you."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1545159690, "creation_date": 1545159690, "answer_id": 53839501, "question_id": 53838039, "link": "https://stackoverflow.com/questions/53838039/read-a-log-file-and-write-other-with-the-specified-format/53839501#53839501", "title": "Read a log file and write other with the specified format", "body": "<p><code>sscanf()</code> and <code>\"%n\"</code> can do the job.  Some post process may be needed as with <code>NAME</code>.</p>\n\n<p>With such complex formats, I suggest using string concatenation</p>\n\n<pre><code>// First parameter (IP): catch all up to space\n#define IP_FMT \"%s\"\nchar IP[sizeof line];\n\n// Second parameter (ID): catch all up to space (can be a string or a -)\n#define ID_FMT \"%s\"\nchar ID[sizeof line];\n\n// Third parameter (NAME): catch all up to [ (can be a string with spaces or a -)\n#define NAME_FMT \" %[^[][\"\nchar NAME[sizeof line];\n\n// Fourth parameter (DATE): catch all up to :\n#define DATE_FMT \" %11[^:]:\"\nchar DATE[11+1];\n\n// Fifth parameter (TIME): catch all up to space\n#define TIME_FMT \"%8s\"\nchar TIME[8+1];\n\n// Sixth parameter (TIMEZONE): catch all up to ] (-dddd must be converted in -dd)\n#define TIMEZONE_FMT \"%5d]\"\nint TIMEZONE;\n\n// Other fields left for OP\n\nint n = 0;\nsscanf(s, IP_FMT ID_FMT NAME_FMT DATE_FMT TIME_FMT \" %n\", \n    ID, ID, NAME, DATE, TIME, &amp;TIMEZONE, &amp;n);\n\nif (n == 0) return Invalid_Input;\ntrim(NAME);\n</code></pre>\n"}], "owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53839501, "answer_count": 1, "score": 2, "last_activity_date": 1545168988, "creation_date": 1545153329, "last_edit_date": 1545168988, "question_id": 53838039, "link": "https://stackoverflow.com/questions/53838039/read-a-log-file-and-write-other-with-the-specified-format", "title": "Read a log file and write other with the specified format", "body": "<p>I have a log text file (<code>*.txt</code>) which approx 2.5 millions of entries using C languaje and I have to read it and write into other file with a specific format.</p>\n\n<p>File that must be read is like:</p>\n\n<pre><code>202.32.92.47 - - [01/Jun/1995:00:00:59 -0600] \"GET /~scottp/publish.html\" 200 271 - -\nix-or7-27.ix.netcom.com RFC-1413 John Thomas [01/Jun/1995:00:02:51 -0600] \"GET /~ladd/ostriches.html\" 200 205908 - \"Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\" \nppp-4.pbmo.net - John Thomas [07/Dec/1995:13:20:28 -0600] \"GET /dcs/courses/cai/html/introduction_lesson/index.html HTTP/1.0\" 500 - \"http://www.wikipedia.org/\" \"Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\" \nppp-4.pbmo.net - - [07/Dec/1995:13:20:37 -0600] \"GET /dcs/courses/cai/html/index.html HTTP/1.0\" 500 4528 - - \nlbm2.niddk.nih.gov RFC-1413 - [07/Dec/1995:13:21:03 -0600] \"GET /~ladd/vet_libraries.html\" 200 11337 \"http://www.wikipedia.org/\" - \n</code></pre>\n\n<p>The format of each line of this log (original) file is: <code>IP ID NAME [DATE:TIME TIMEZONE] \"METHOD DIR\" STATUS MB \"WEB\" \"FROM\"</code>. So, I will split previous log example using <code>||</code> for a better visualization: </p>\n\n<pre><code>|| ix-or7-27.ix.netcom.com || RFC-1413 || John Thomas || [01/Jun/1995 || :00:02:51 || -0600] || \"GET || /~ladd/ostriches.html\" || 200 || 205908 || - || \"Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\" ||\n|| ppp-4.pbmo.net || - || John Thomas || [07/Dec/1995 || :13:20:28 || -0600] || \"GET || /dcs/courses/cai/html/introduction_lesson/index.html HTTP/1.0\" || 500 || - || \"http://www.wikipedia.org/\" || \"Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\" ||\n|| ppp-4.pbmo.net || - || - || [07/Dec/1995 || :13:20:37 || -0600] || \"GET || /dcs/courses/cai/html/index.html HTTP/1.0\" || 500 || 4528 || - || - ||\n|| lbm2.niddk.nih.gov || RFC-1413 || - || [07/Dec/1995 || :13:21:03 || -0600] || \"GET || /~ladd/vet_libraries.html\" || 200 || 11337 || \"http://www.wikipedia.org/\" || - ||\n</code></pre>\n\n<p>So, for example, for the first line:</p>\n\n<pre><code>IP = ix-or7-27.ix.netcom.com \nID = RFC-1413 \nNAME = John Thomas \nDATE = 01/Jun/1995\nTIME = 00:02:51 \nTIMEZONE = -0600 \nMETHOD = GET \nDIR: /~ladd/ostriches.html\nSTATUS = 200 \nMB = 205908 \nWEB = -\nFROM = Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\n</code></pre>\n\n<p>( Each field's value can be <code>text</code> or <code>-</code> ).</p>\n\n<p>The expected output is:</p>\n\n<pre><code>ix-or7-27.ix.netcom.com | RFC-1413 | John Thomas | 01/Jun/1995 | 00:02:51 | -06 | GET | /~ladd/ostriches.html | 200 || 205908 | - | Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5)\nppp-4.pbmo.net | - | John Thomas || 07/Dec/1995 | 13:20:28 | -06 | GET | /dcs/courses/cai/html/introduction_lesson/index.html HTTP/1.0 | 500 | - | http://www.wikipedia.org/ | Mozilla/5.0 (X11; U; Linux i686; es-ES;rv:1.7.5) \nppp-4.pbmo.net | - | - || 07/Dec/1995 | 13:20:37 | -06 | GET | /dcs/courses/cai/html/index.html HTTP/1.0 | 500 || 4528 | - | - \nlbm2.niddk.nih.gov | RFC-1413 || - | 07/Dec/1995 | 13:21:03 | -06 | GET | /~ladd/vet_libraries.html | 200 | 11337 | http://www.wikipedia.org/ | - \n</code></pre>\n\n<p>So, the format is split the original line and add <code>|</code> between each field. Each field can be:</p>\n\n<ul>\n<li>First parameter (IP): catch all up to space </li>\n<li>Second parameter (ID): catch all up to space (can be a string or a <code>-</code>)</li>\n<li>Third parameter (NAME): catch all up to [ (can be a string with spaces or a <code>-</code>)</li>\n<li>Fourth parameter (DATE): catch all up to <code>:</code> </li>\n<li>Fifth parameter (TIME): catch all up to space </li>\n<li>Sixth parameter (TIMEZONE): catch all up to ] (-dddd must be converted in -dd)</li>\n<li>Seventh parameter (METHOD): catch all up to space</li>\n<li>Eigth parameter (DIR): catch all up to space</li>\n<li>Ninth parameter (STATUS): catch all up to space</li>\n<li>Tenth parameter (MB): catch all up to space</li>\n<li>Eleventh parameter (WEB): catch all inside \"\" (or <code>-</code>)</li>\n<li>Twelveth parameter (FROM): catch all inside \"\" (or <code>-</code>)</li>\n</ul>\n\n<p>Any idea how could I got it?</p>\n\n<p>Thank you.</p>\n\n<hr/>\n\n<p><b>EDIT 1: </b></p>\n\n<p>The code I use for reading/writting file is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    // variables\n    int line[255];\n    char *token;\n\n    // open files\n    FILE *fpr = fopen(\"myLogFile.txt\",\"r\");\n    FILE *fpw = fopen(\"myFormattedLogFile.txt\",\"w\");\n\n    // read file\n    while (fgets(line, 255, fpr) != NULL) {\n        token = strtok(line, \" \");\n        while (token != NULL) {\n            // write file\n            fprintf(fpw, \"%s | \", token);\n            token = strtok(NULL, \" \");\n        }\n        fprintf(fpw, \"\\n\");\n    }\n\n    // close files\n    fclose(fpr);\n    fclose(fpw);\n\n    return 0;\n}\n</code></pre>\n\n<p>But it does not work due to takes as two values <code>John Thomas</code>, I do not know how can I set the correct format (remove <code>[</code>, <code>]</code>, <code>\"</code>, change number format, split date and time, control if is string or <code>-</code>, ...). </p>\n\n<hr/>\n\n<p><b>EDIT 2: @CHUX'S SOLUTION</b></p>\n\n<p>I have a dudes: </p>\n\n<pre><code>// 6\u00ba pattern. How can I recover it as string?\n// 7\u00ba pattern. How can I remove first \"?\n// 8\u00ba patter. How can I remove last \"?\n// how could catch all inside \"\" ? Which pattern should I use?\n// what is variable n?\n// what is Invalid_Input? It appears as undeclared\n</code></pre>\n\n<p>The code updated after your solution is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define LINE_LENGTH 255\n\n// First parameter (IP): catch all up to space\n#define IP_FMT \"%s\"\nchar IP[LINE_LENGTH];\n\n// Second parameter (ID): catch all up to space (can be a string or a -)\n#define ID_FMT \"%s\"\nchar ID[LINE_LENGTH];\n\n// Third parameter (NAME): catch all up to [ (can be a string with spaces or a -)\n#define NAME_FMT \" %[^[][\"\nchar NAME[LINE_LENGTH];\n\n// Fourth parameter (DATE): catch all up to :\n#define DATE_FMT \" %11[^:]:\"\nchar DATE[11+1];\n\n// Fifth parameter (TIME): catch all up to space\n#define TIME_FMT \"%8s\"\nchar TIME[8+1];\n\n// Sixth parameter (TIMEZONE): catch all up to ] (-dddd must be converted in -dd)\n#define TIMEZONE_FMT \"%5d]\"\nint TIMEZONE;\n\n// Seventh parameter (METHOD): catch all up to space\n#define METHOD_FMT \"%s\"\nchar METHOD[LINE_LENGTH];\n\n// Eigth parameter (DIR): catch all up to space\n#define DIR_FMT \"%s\"\nchar DIR[LINE_LENGTH];\n\n// Ninth parameter (STATUS): catch all up to space\n#define STATUS_FMT \"%s\"\nchar STATUS[LINE_LENGTH];\n\n// Tenth parameter (MB): catch all up to space\n#define MB_FMT \"%s\"\nchar MB[LINE_LENGTH];\n\n// Eleventh parameter (WEB): catch all inside \"\" (or -)\n\n// Twelveth parameter (FROM): catch all inside \"\" (or -)\n\n\n\nint main() {\n    // variables\n    char *line = malloc(LINE_LENGTH);\n    char *token;\n    int position = 0;\n\n    // open files\n    FILE *fpr = fopen(\"log.txt\",\"r\");\n    FILE *fpw = fopen(\"myFormattedLogFile.txt\",\"w\");\n\n    // read file\n    while (fgets(line, LINE_LENGTH, fpr) != NULL) {\n\n        int n = 0; \n\n        sscanf\n            (\n                line, \n                IP_FMT ID_FMT NAME_FMT DATE_FMT TIME_FMT TIMEZONE_FMT METHOD_FMT DIR_FMT STATUS_FMT MB_FMT \" %n\", \n                IP, ID, NAME, DATE, TIME, &amp;TIMEZONE, METHOD, DIR, STATUS, MB, &amp;n\n            ); \n\n        NAME[strlen(NAME)-1] = '\\0';\n\n        fprintf\n            (\n                fpw, \n                \"%s | %s | %s | %s | %s | %d | %s | %s | %s | %s\\n\", \n                IP, ID, NAME, DATE, TIME, TIMEZONE, METHOD, DIR, STATUS, MB\n            );\n\n    }\n\n    // close files\n    fclose(fpr);\n    fclose(fpw);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "edited": false, "score": 0, "creation_date": 1545151235, "post_id": 53837380, "comment_id": 94523005, "body": "In addition to bruno&#39;s answer (see below), this is what <code>strdup</code> does: <a href=\"https://stackoverflow.com/a/252802/3589567\">stackoverflow.com/a/252802/3589567</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "edited": false, "score": 0, "creation_date": 1545151431, "post_id": 53837380, "comment_id": 94523110, "body": "sorry @AlejandroBlasco I removed my comment and put it as an answer"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545152020, "post_id": 53837438, "comment_id": 94523457, "body": "Thank you very much for your detailed answer. Now it works. Helped me a lot! Oh, I see - I have to reserve the memory <b>extra for every element</b> of the struct? <code>strdup()</code> was the function I searched for...! Tried it several times with <code>strcpy()</code>!"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545152368, "post_id": 53837438, "comment_id": 94523678, "body": "When you copy a pointer there is no duplication, when the pointed element have to be duplicated you must do it by yourself. The parameter type in <i>getInputFromFile</i> is false, must be <code>getInputFromFile(struct CAR *arr[])</code> because <i>arr</i> in a vector of pointers to CAR you need to allocate each CAR"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545152525, "post_id": 53837438, "comment_id": 94523764, "body": "<i>strcpy</i> as <i>memcpy</i> copy only, for the string you need both to allocate and copy, this is done by <i>strdup</i>"}, {"owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545242436, "post_id": 53837438, "comment_id": 94561447, "body": "is there another way to do this without strdup()?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545242724, "post_id": 53837438, "comment_id": 94561560, "body": "you can do the strdup by yourself through strlen + malloc + strcpy, but you cannot avoid to do the clone while you use <code>char *</code>. Of course you can replace the <code>char *</code> by a <code>char[&lt;some size&gt;]</code> and just do a strcpy into, but this is less practical because you have to know the longest possible string and you will use a long string even the value inside is small"}, {"owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545243524, "post_id": 53837438, "comment_id": 94561888, "body": "thank you. If I replace the <code>char*</code> with <code>char[size]</code> do I have to allocate each CAR too like we did above?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545244069, "post_id": 53837438, "comment_id": 94562114, "body": "Yes of course CAR has to be allocated, but after <code>arr[i]-&gt;model = strdup(model);</code> is replaced by <code>strcpy(arr[i]-&gt;model, model);</code> and same for <i>nickname</i>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545244279, "post_id": 53837438, "comment_id": 94562212, "body": "But you don&#39;t have to choose between <code>char *</code> and <code>char[]</code> considering that point"}, {"owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545244877, "post_id": 53837438, "comment_id": 94562452, "body": "hm, so it would be easier to implement the <code>strdup</code> as a own function at that point. Thanks for your advices!"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1545151234, "last_edit_date": 1545151234, "creation_date": 1545150917, "answer_id": 53837438, "question_id": 53837380, "link": "https://stackoverflow.com/questions/53837380/saving-input-text-to-struct-in-main/53837438#53837438", "title": "Saving input text to struct in main", "body": "<p>you must duplicate (strdup) each string before to put it in your structure</p>\n\n<pre><code>arr[i]-&gt;model = strdup(model);\narr[i]-&gt;nickname = strdup(nickname);\n</code></pre>\n\n<p>currently all <em>ar[]->model</em> point to the same memory area, and that one was freed, same thing for all <em>arr[]->nickname</em></p>\n\n<p>in your program you forget also to allocate each CAR, so in fact :</p>\n\n<pre><code>arr[i] = (CAR *) malloc(sizeof(CAR));\narr[i]-&gt;model = strdup(model);\narr[i]-&gt;nickname = strdup(nickname);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "edited": false, "score": 0, "creation_date": 1545152072, "post_id": 53837448, "comment_id": 94523489, "body": "Thanks for your answer!"}], "tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 1, "last_activity_date": 1545150978, "creation_date": 1545150978, "answer_id": 53837448, "question_id": 53837380, "link": "https://stackoverflow.com/questions/53837380/saving-input-text-to-struct-in-main/53837448#53837448", "title": "Saving input text to struct in main", "body": "<p>Each struct needs allocated memory for the strings. Currently you have a single string buffer for nickname and model (so its being overwritten) and free it at the end of the loop, so now each struct is pointing to freed memory, not the original strings.</p>\n"}], "owner": {"reputation": 27, "user_id": 10807083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5ba8df2bdc222a9e81eb10def6c2ae?s=128&d=identicon&r=PG&f=1", "display_name": "John M", "link": "https://stackoverflow.com/users/10807083/john-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53837438, "answer_count": 2, "score": 1, "last_activity_date": 1545151234, "creation_date": 1545150746, "question_id": 53837380, "link": "https://stackoverflow.com/questions/53837380/saving-input-text-to-struct-in-main", "title": "Saving input text to struct in main", "body": "<p>got a question how to save a struct to an array and print it out in <code>main()</code>.</p>\n\n<p>My idea is, to get data of a .txt and then save it in a struct array. If i output it directly with <code>printf()</code> it works fine.</p>\n\n<p>But if I want to save it in a <em>struct array</em> <strong>and</strong> print it out <strong><code>at the</code>main()</strong> I get trash values, nothing or just the last read struct will be saved to all positions of the array. </p>\n\n<p><strong>My code looks like this:</strong></p>\n\n<pre><code>typedef struct CAR {\n  char* nickname;\n  char* model;\n} CAR;\n\nvoid getInputFromFile(struct CAR *arr) {\n\n  . . .\n  . . .\n\n  char *nickname = malloc(...);\n  char *model = malloc(...);\n\n  int i=0;\n  while(fscanf(file,\"%s %s\\n\", model, nickname)==2){\n    printf(\"%s %s\\n\", model, nickname);        // this works fine!!!\n\n    // Now when i try to save it in a struct it doesn't work\n    arr[i]-&gt;model = model;\n    arr[i]-&gt;nickname = nickname;\n    i++;\n\n  }\n  free(nickname);\n  free(model);\n}\n\n\nint main (){\n  struct CAR* arr[size];\n  getInput(arr);\n\n  // Now iterate over arr to look at values\n  for(i = 0; i &lt; size; i++){\n     ... \n  }\n}\n</code></pre>\n\n<p><strong>File input format looks like this:</strong></p>\n\n<pre><code>nickname model\\n\nnickname model\\n\n...\n</code></pre>\n\n<p>Thanks for all your help in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 5, "creation_date": 1545149874, "post_id": 53837105, "comment_id": 94522187, "body": "How would you tell your 5-year old nephew to do that (with pen and paper)? That&#39;s your algorithm :)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1545150468, "post_id": 53837105, "comment_id": 94522544, "body": "If you are interested in the decimal representation of a number, why exactly are you converting it to a (binary) integer at all?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1545150558, "post_id": 53837105, "comment_id": 94522608, "body": "If you are going to <code>scanf()</code> the numbers from the user, use <i>string</i> to avoid unnecessary conversions. Your algorithm would then work for numbers or names or whatever."}, {"owner": {"reputation": 21, "user_id": 10407133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dae5d8320c0c19df6fe1fb00a23dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit H.", "link": "https://stackoverflow.com/users/10407133/rabbit-h"}, "edited": false, "score": 0, "creation_date": 1545150642, "post_id": 53837105, "comment_id": 94522661, "body": "I don&#39;t know that and where I&#39;m doing that."}, {"owner": {"reputation": 21, "user_id": 10407133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dae5d8320c0c19df6fe1fb00a23dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit H.", "link": "https://stackoverflow.com/users/10407133/rabbit-h"}, "edited": false, "score": 0, "creation_date": 1545150770, "post_id": 53837105, "comment_id": 94522728, "body": "I don&#39;t know how to use string. I&#39;m doing beginner exercises and learning to use instructions."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1545150823, "post_id": 53837105, "comment_id": 94522751, "body": "Some  <code>{</code> and <code>}</code> are missing, that could be a beginning to have something working"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545158589, "post_id": 53837105, "comment_id": 94526689, "body": "@RabbitH. - edit your last comment into your post please.  (and if you actually mean <i>arrays</i> then say arrays.  eg.  abelenky&#39;s answer does not use vectors, just arrays."}, {"owner": {"reputation": 21, "user_id": 10407133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dae5d8320c0c19df6fe1fb00a23dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit H.", "link": "https://stackoverflow.com/users/10407133/rabbit-h"}, "edited": false, "score": 0, "creation_date": 1545171113, "post_id": 53837105, "comment_id": 94531918, "body": "I&#39;m beginner trying to learn on my own, not sure yet what vectors and arrays specifically are. Hope to find out soon. The set of exercises I&#39;m working on right now does not involve such. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1545151881, "post_id": 53837591, "comment_id": 94523366, "body": "Well, the OP&#39;s example doesn&#39;t show what to do if one of the numbers contains a digit multiple times. I&#39;d expect the OP to want such a digit to only be printed once. So if the OP could clarify what <code>a = 1, b = 11111</code> should produce, that would probably help."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1545152042, "post_id": 53837591, "comment_id": 94523466, "body": "Addressed your concerns:  Now numbers are only printed once, and only in ascending order."}, {"owner": {"reputation": 21, "user_id": 10407133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dae5d8320c0c19df6fe1fb00a23dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit H.", "link": "https://stackoverflow.com/users/10407133/rabbit-h"}, "edited": false, "score": 0, "creation_date": 1545152196, "post_id": 53837591, "comment_id": 94523557, "body": "if a=1 and b=11111 the result should be 1"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 2, "last_activity_date": 1545158415, "last_edit_date": 1545158415, "creation_date": 1545151535, "answer_id": 53837591, "question_id": 53837105, "link": "https://stackoverflow.com/questions/53837105/algorithm-to-find-and-print-figures-that-are-common-to-two-given-long-integers/53837591#53837591", "title": "Algorithm to find and print figures that are common to two given long integers", "body": "<p>This is a fun little problem.</p>\n\n<p>I threw together a quick, simple solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a, b;\n    int d[10]={0};\n    scanf(\"%d %d\", &amp;a, &amp;b);\n\n    while(a)\n    {\n        d[a%10] = 1;\n        a /= 10;\n    }\n\n    while(b)\n    {\n        if (d[b%10]) d[b%10]=2;\n        b /= 10;\n    }\n\n    for(a=0;a&lt;10;++a) if (d[a]==2) printf(\"%d \", a);\n\n    return 0;\n}\n</code></pre>\n\n<p>Link to <a href=\"https://ideone.com/iJwjsR\" rel=\"nofollow noreferrer\">IDE One code</a></p>\n\n<hr>\n\n<p>Here's a short version that does not use arrays:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a, b, c;\n    scanf(\"%d %d\", &amp;a, &amp;b);\n\n    while(a)\n    {\n        c = b;\n        while(c)\n        {\n            if (c%10 == a%10)\n            {\n                printf(\"%d \", c%10);\n                break;\n            }\n            c /= 10;\n        }\n        a /= 10;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This version runs slower than my first one, and does not print out the numbers in ascending order.</p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545157346, "post_id": 53838283, "comment_id": 94526138, "body": "Providing a working example is good, but can you explain, at least just a little, what you did to address the problem?  ( Before <i>Hope this helps.</i> would be a good place. )"}, {"owner": {"reputation": 54, "user_id": 10784315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtBov1jbNKk/AAAAAAAAAAI/AAAAAAAACGU/Pa9R61HyPsA/photo.jpg?sz=128", "display_name": "Kazi", "link": "https://stackoverflow.com/users/10784315/kazi"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545161921, "post_id": 53838283, "comment_id": 94528146, "body": "@ryyker thankyou for your suggestion, I&#39;ve edited my answer."}], "tags": [], "owner": {"reputation": 54, "user_id": 10784315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtBov1jbNKk/AAAAAAAAAAI/AAAAAAAACGU/Pa9R61HyPsA/photo.jpg?sz=128", "display_name": "Kazi", "link": "https://stackoverflow.com/users/10784315/kazi"}, "is_accepted": false, "score": 3, "last_activity_date": 1545161790, "last_edit_date": 1545161790, "creation_date": 1545154375, "answer_id": 53838283, "question_id": 53837105, "link": "https://stackoverflow.com/questions/53837105/algorithm-to-find-and-print-figures-that-are-common-to-two-given-long-integers/53838283#53838283", "title": "Algorithm to find and print figures that are common to two given long integers", "body": "<p>You can convert both the integers to strings and then compare each character of the first string with the second one to check whether any of them matches or not. I've used nested for loops for comparing. </p>\n\n<p>I've used strings because comparing each character of two strings is a lot easier than comparing each digit of two integers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    long int a,b;\n    int i,j;\n\n    scanf(\"%ld %ld\",&amp;a,&amp;b); //taking both inputs\n\n    char temp_a[50],temp_b[50];\n\n\n    sprintf(temp_a, \"%ld\", a); //converting the first integer to a string\n    sprintf(temp_b, \"%ld\", b); //converting the second integer to a string\n\n\n    int length_a=strlen(temp_a); //length of first string\n    int length_b=strlen(temp_b); //length of second string\n\n    // matching whether any character is in common using nested for-loops\n    // printing the character as soon as it matches\n    // if a character matches, the loop breaks.\n\n    for(i=0 ; i&lt;length_a ; i++)\n    {\n        for(j=0 ; j&lt;length_b ; j++)\n        {\n            if(temp_a[i]==temp_b[j])\n            {\n                printf(\"%c\",temp_a[i]);\n                break;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10808684, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/61aa76fddcc88659774b2d2bbcb9d04e?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/10808684/kuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1545179978, "creation_date": 1545179978, "answer_id": 53843085, "question_id": 53837105, "link": "https://stackoverflow.com/questions/53837105/algorithm-to-find-and-print-figures-that-are-common-to-two-given-long-integers/53843085#53843085", "title": "Algorithm to find and print figures that are common to two given long integers", "body": "<p>May it helps:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint original_a, original_b, i;\nshort digit_a, digit_b, digit_common;\nshort find_digit(int num);\nint main()\n{\nprintf(\"Insert 2 numbers a and b\\n\");\nscanf(\"%d %d\", &amp;original_a, &amp;original_b);\ndigit_a = find_digit(original_a);\ndigit_b = find_digit(original_b);\ndigit_common = digit_a &amp; digit_b;\nprintf(\"digit_common: %x\\n\", digit_common);\nprintf(\"Common digits of a and b\\n\");\nfor(i = 0; i &lt; 10; i++){\n    if(digit_common &amp; (1&lt;&lt;i)){\n        printf(\"%d\",i);\n    }\n}\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<pre><code>short find_digit(int num){\nshort result = 0;\nwhile(num&gt;0){\n    result |= (1 &lt;&lt; (num%10));\n    num /= 10;\n}\nreturn result;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 21, "user_id": 10407133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dae5d8320c0c19df6fe1fb00a23dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit H.", "link": "https://stackoverflow.com/users/10407133/rabbit-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53837591, "answer_count": 3, "score": 0, "last_activity_date": 1545179978, "creation_date": 1545149810, "last_edit_date": 1545170933, "question_id": 53837105, "link": "https://stackoverflow.com/questions/53837105/algorithm-to-find-and-print-figures-that-are-common-to-two-given-long-integers", "title": "Algorithm to find and print figures that are common to two given long integers", "body": "<p>Please help me with the appropriate C algorithm without using arrays.</p>\n\n<p>Example:</p>\n\n<p>Input</p>\n\n<p>123456789</p>\n\n<p>2037</p>\n\n<p>Output</p>\n\n<p>Common figures are 2, 3, 7.</p>\n\n<p>My failed attempt:</p>\n\n<pre><code>long a, b, original_a, original_b;\nint i, j, figure_a, figure_b;\n\nprintf(\"a=\");\nscanf_s(\"%li\", &amp;a);\nprintf(\"b=\");\nscanf_s(\"%li\", &amp;b);\n\noriginal_a = a;\noriginal_b = b;\n\nfor (i = 0; i &lt;= 9; i++)\n        for (j = 0; j &lt;= 9; j++){\n            a = original_a;\n            b = original_b;\n\n            while (a||b){\n            figure_a = a % 10;\n            figure_b = b % 10;\n\n            a /= 10;\n            b /= 10;\n\n            if (i == figure_a &amp;&amp; j == figure_b &amp;&amp; i == j)\n                printf(\"%d, \", i);\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "linux", "ipc", "message-queue"], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 1, "last_activity_date": 1545150088, "creation_date": 1545150088, "answer_id": 53837187, "question_id": 53836925, "link": "https://stackoverflow.com/questions/53836925/linux-programming-how-to-send-array-with-message-queue/53837187#53837187", "title": "Linux programming. How to send array with message queue?", "body": "<p>Your code invokes undefined behavior.</p>\n\n<p>Since you want to send integer-by-integer, you should use <code>sizeof(message.a[i])</code>, what is size of one element, instead of <code>sizeof(message.a)</code>, which is size of the whole array <code>a</code>.</p>\n\n<pre><code>msgsnd(msgid, (int *) &amp;message.a[i], sizeof(message.a), 0);\n                                            ^^^^^^^^^\n</code></pre>\n\n<p>In short it means you are passing some garbage behind the array.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "is_accepted": false, "score": 1, "last_activity_date": 1545151387, "last_edit_date": 1545151387, "creation_date": 1545150321, "answer_id": 53837257, "question_id": 53836925, "link": "https://stackoverflow.com/questions/53836925/linux-programming-how-to-send-array-with-message-queue/53837257#53837257", "title": "Linux programming. How to send array with message queue?", "body": "<p>Edit: After reading <strong>man msgsnd</strong> a bit close, it looks like the type is expected to be the first field of each message sent, but you're passing each field of the structure individually to each msgsnd call, so the type won't be included.  You either need to send the entire structure at once or have some intermediate struct type if you want to send individual words.</p>\n\n<p>There could be a few other issues here too.  It seems like the reader is not receiving any messages at all. I would start by checking the return values of all the system calls related to queue opening/sending/receiving and calling perror() in case of an unexpected result.</p>\n\n<p>Third, as the previous comment mentions, the calls to msgsnd are likely not going to go through correctly because you really want sizeof(message.a[i]).  This is defintely an issue, but it shouldn't stop the first message from being sent</p>\n\n<p>Fourth (and this one shouldn't be causing the current issue), once you get your reader receiving, it's going to overwrite the contents of message.a on each call to msgrcv.  You need to find a way to preserve the received data before reading it into message again.</p>\n"}, {"tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": false, "score": 1, "last_activity_date": 1545151310, "creation_date": 1545151310, "answer_id": 53837534, "question_id": 53836925, "link": "https://stackoverflow.com/questions/53836925/linux-programming-how-to-send-array-with-message-queue/53837534#53837534", "title": "Linux programming. How to send array with message queue?", "body": "<p><a href=\"https://linux.die.net/man/2/msgsnd\" rel=\"nofollow noreferrer\">man msgsnd</a> says</p>\n\n<blockquote>\n  <p>The msgp argument is a pointer to caller-defined structure of the following general form:</p>\n</blockquote>\n\n<pre><code>struct msgbuf {\n    long mtype;       /* message type, must be &gt; 0 */\n    char mtext[1];    /* message data */\n};\n</code></pre>\n\n<p>So  </p>\n\n<pre><code>msgsnd(msgid, (int *) &amp;message.a[i], sizeof(message.a[i]), 0);\n</code></pre>\n\n<p>is wrong, you had to have a complete message for each value you want so send</p>\n"}], "owner": {"reputation": 27, "user_id": 10806926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qHlMElyvQNs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jDqUFRzKQ6WdyIE7bKhol4tuwwFw/mo/photo.jpg?sz=128", "display_name": "fingolfin", "link": "https://stackoverflow.com/users/10806926/fingolfin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 53837187, "answer_count": 3, "score": 1, "last_activity_date": 1545151387, "creation_date": 1545149198, "last_edit_date": 1545151233, "question_id": 53836925, "link": "https://stackoverflow.com/questions/53836925/linux-programming-how-to-send-array-with-message-queue", "title": "Linux programming. How to send array with message queue?", "body": "<p>I have writer.c and reader.c and I am trying to send array from writer and then print the numbers in the reader.</p>\n\n<pre><code>        //writer.c\n\n    #include &lt;stdio.h&gt; \n    #include &lt;sys/ipc.h&gt; \n    #include &lt;sys/msg.h&gt; \n\n    // structure for message queue \n    struct mesg_buffer { \n        int mesg_type; \n        int a[5];\n\n    } message; \n\n    int main() \n    { \n    message.a [0] = 5;\n    message.a [1] = 10;\n    message.a [2] = 15;\n    message.a [3] = 34;\n    message.a [4] = 34;\n\n        key_t key; \n        int msgid; \n\n        // ftok to generate unique key \n        key = ftok(\".\", 65); \n\n        // msgget creates a message queue \n        // and returns identifier \n        msgid = msgget(key, 0666 | IPC_CREAT); \n        message.mesg_type = 1; \n\n // msgsnd to send message \n    for(int i=0;i&lt;5;i++)\n    msgsnd(msgid, (int *) &amp;message.a[i], sizeof(message.a[i]), 0);\n\n\n\n        // display the message \n    for(int i=0;i&lt;5;i++)\n        printf(\"Data send is : %d \\n\", message.a[i]); \n\n        return 0; \n    } \n</code></pre>\n\n<p>reader.c</p>\n\n<pre><code> // C Program for Message Queue (Reader Process) \n#include &lt;stdio.h&gt; \n#include &lt;sys/ipc.h&gt; \n#include &lt;sys/msg.h&gt; \n\n// structure for message queue \nstruct mesg_buffer { \n    int mesg_type; \n    int a[5];\n} message; \n\nint main() \n{ \n    key_t key; \n    int msgid; \n\n    // ftok to generate unique key \n    key = ftok(\".\", 65); \n\n    // msgget creates a message queue \n    // and returns identifier \n    msgid = msgget(key, 0666 | IPC_CREAT); \n\n    // msgrcv to receive message\n    for(int i=0; i&lt;5; i++)\n   msgrcv(msgid, &amp;message, sizeof(message.a[i]), 1, 0); \n\n    for(int i=0; i&lt;5; i++)\n    printf(\"Data Received is : %d \\n\",  \n                    message.a[i]); \n\n    // to destroy the message queue \n    msgctl(msgid, IPC_RMID, NULL); \n\n    return 0; \n} \n</code></pre>\n\n<p>I run firstly the writer.c and that's my output:</p>\n\n<blockquote>\n  <p>Data send is : 5</p>\n  \n  <p>Data send is : 10</p>\n  \n  <p>Data send is : 15</p>\n  \n  <p>Data send is :34</p>\n  \n  <p>Data send is : 34</p>\n</blockquote>\n\n<p>But when I run the reader.c the program just stucks and nothing happens. Any suggestion how to pass the array?</p>\n\n<p><strong>edit:</strong> It seems that passing only the message in  msgsnd and msgrcv fixed the problem.</p>\n\n<pre><code>for(int i=0;i&lt;5;i++)\n    msgsnd(msgid, &amp;message, sizeof(message), 0); \n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "struct"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545148581, "post_id": 53836652, "comment_id": 94521485, "body": "The easiest way if you can give the string a fixed maximum size like 256 in your example."}, {"owner": {"reputation": 123, "user_id": 7444984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3039dffc297f654f0d058d953141ac98?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew1024", "link": "https://stackoverflow.com/users/7444984/andrew1024"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545148721, "post_id": 53836652, "comment_id": 94521566, "body": "@Lundin I tried that, however even in that scenario it still gets treated as a pointer."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1545148727, "post_id": 53836652, "comment_id": 94521573, "body": "strings do exist in c .. not entirely sure what you&#39;re asking. You can use <a href=\"https://linux.die.net/man/3/fprintf\" rel=\"nofollow noreferrer\"><code>fprintf</code></a> to write a string to a file. It works just like <code>printf</code> except the first argument is a <code>FILE*</code>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1545148885, "post_id": 53836652, "comment_id": 94521647, "body": "Show us the code where you&#39;re writing the output and we can see where you&#39;re going wrong."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545148900, "post_id": 53836652, "comment_id": 94521654, "body": "Probably you save/load it incorrectly from the file. Please post the relevant code with file I/O."}, {"owner": {"reputation": 123, "user_id": 7444984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3039dffc297f654f0d058d953141ac98?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew1024", "link": "https://stackoverflow.com/users/7444984/andrew1024"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1545148927, "post_id": 53836652, "comment_id": 94521670, "body": "@yano what I meant is that they don&#39;t exists in their usual format so to speak, basically I need to save a struct that contains a string to a file"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1545149460, "post_id": 53836652, "comment_id": 94521985, "body": "a <code>DynamicArray</code> contains a pointer and 2 <code>int</code>s .. it&#39;s size is probably going to be 16 bytes (8 for the pointer, plus 4 each for the <code>int</code>s). It&#39;s not automatically going to write what the pointer is pointing to, it&#39;s going to be a little more work that a one-liner to write all the data in your struct. <code>array</code> points to a <code>tuple_t</code> and a <code>tuple_t</code> has a <code>char</code> pointer as well that you&#39;ll need to follow. And as you&#39;ve noted, writing the pointer value to file is useless, you need to write the data it points to in order to be able to read it back."}, {"owner": {"reputation": 123, "user_id": 7444984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3039dffc297f654f0d058d953141ac98?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew1024", "link": "https://stackoverflow.com/users/7444984/andrew1024"}, "edited": false, "score": 0, "creation_date": 1545149736, "post_id": 53836652, "comment_id": 94522109, "body": "Are you suggesting writing the elements separately for each tuple_t element?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1545149940, "post_id": 53836652, "comment_id": 94522221, "body": "yes, you have to write <i>data</i> to the file. If your struct only had data members (3 <code>int</code>s for instance), you could get away with the one-liner <code>fwrite</code>. Writing a pointer value to file will give you nothing when it&#39;s time to read that data back. That pointer value is some virtual address that is meaningless as soon as the data it points to goes out of scope. You&#39;re going to have to write each data element to file in a way that&#39;s completely recoverable when you read it back, there&#39;s not a single right way to do it, you&#39;ll need to come up with a file format."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1545150723, "post_id": 53836652, "comment_id": 94522696, "body": "here&#39;s an example of one way to write a string (your <code>char *</code>) to file: <a href=\"https://stackoverflow.com/questions/4182876/how-to-write-a-string-to-a-file-in-c\" title=\"how to write a string to a file in c\">stackoverflow.com/questions/4182876/&hellip;</a> . After that, you still need to write the <code>element</code> array and <code>eCount</code>. Should you write the size of <code>element</code> too so that&#39;s recoverable, or is that fixed/able to be deduced from the data? You&#39;ll also need to write <code>used</code> and <code>size</code> from the <code>DynamicArray</code>. You&#39;ll need to write it all in a specific way such that the reader knows the format and can recover all the data exactly."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1545149849, "creation_date": 1545149849, "answer_id": 53837119, "question_id": 53836652, "link": "https://stackoverflow.com/questions/53836652/c-saving-dynamic-array-of-structs-along-with-string/53837119#53837119", "title": "C: Saving dynamic array of structs along with string", "body": "<p>Instead of writing the whole struct in one go, write out the various parts of it utilising your knowledge of what they contain. So for example, if <code>eCount</code> is the amount of values in <code>element</code> you could write this</p>\n\n<pre><code>fwrite(&amp;ToSave.eCount,sizeof(int), 1, filepointer);\nfwrite(ToSave.element,sizeof(int), ToSave.eCount, filepointer);\n</code></pre>\n\n<p>and then to store the string component</p>\n\n<pre><code>size_t length=strlen(ToSave.id);\nfwrite(&amp;length,sizeof(int), 1, filepointer);\nfwrite(ToSave.id,sizeof(char), length, filepointer);\n</code></pre>\n\n<p>Note: <code>sizeof(char)</code> is typically always 1, so you could assume that and put 1 rather than <code>sizeof(char)</code> but I find it makes the code look more uniform to leave it in.</p>\n\n<p>And then you reverse the process when you do the reading</p>\n\n<pre><code>fwrite(&amp;ToLoad.eCount,sizeof(int), 1, filepointer);\nfwrite(ToLoad.element,sizeof(int), ToLoad.eCount, filepointer);\n// etc...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 7444984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3039dffc297f654f0d058d953141ac98?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew1024", "link": "https://stackoverflow.com/users/7444984/andrew1024"}, "is_accepted": false, "score": 0, "last_activity_date": 1545160270, "creation_date": 1545160270, "answer_id": 53839611, "question_id": 53836652, "link": "https://stackoverflow.com/questions/53836652/c-saving-dynamic-array-of-structs-along-with-string/53839611#53839611", "title": "C: Saving dynamic array of structs along with string", "body": "<p>To whom it may help in the future: So after asking around a bit, some people got it to work by treating the identifier as an array instead of a pointer.</p>\n\n<pre><code>char id[256];\n</code></pre>\n\n<p>I said this didn't work before, but it was probably due to another mistake which I didn't spot. Saving each tuple will keep the string identifier intact as long as an array is used.</p>\n"}], "owner": {"reputation": 123, "user_id": 7444984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3039dffc297f654f0d058d953141ac98?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew1024", "link": "https://stackoverflow.com/users/7444984/andrew1024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53837119, "answer_count": 2, "score": 0, "last_activity_date": 1545160270, "creation_date": 1545148239, "last_edit_date": 1545149117, "question_id": 53836652, "link": "https://stackoverflow.com/questions/53836652/c-saving-dynamic-array-of-structs-along-with-string", "title": "C: Saving dynamic array of structs along with string", "body": "<p>I am trying to save a struct (listed)</p>\n\n<pre><code>typedef struct tupleStruct{\n\n    int element[eMax];\n    char * id;\n    int eCount;\n\n}tuple_t;\n\ntypedef struct {\n    tuple_t * array;\n    int used;\n    int size;\n} DynamicArray;\n</code></pre>\n\n<p>As part of an assignment I was instructed to save tuples that are stored in a dynamic array in a file. Unfortunately since strings don't exist in c (at least not like they do in other languages). Whenever I try to save an element of the dynamic array in a file, the string is not stored or loaded properly as it's seen as a pointer. I've even tried by initializing it like so in the struct:</p>\n\n<pre><code>char id[256];\n</code></pre>\n\n<p>Is there any way possible to save the struct and the string in a single file? (Given that I need to store multiple of these)</p>\n\n<p>Edit: Saving and loading code</p>\n\n<p>Loading</p>\n\n<pre><code>DynamicArray loadAllTuples(){\n\n    FILE *filePointer;\n\n    DynamicArray tempArray;\n\n    if((filePointer=fopen(\"SavedTuples.bin\",\"rb\"))==NULL)\n    {\n        fputs(\"Something went wrong while loading!\\nA blank Array will be loaded instead\\n\", stderr);\n        setbuf(stdout, 0);\n\n        //In case of error, blank array is initalised and loaded\n        fclose(filePointer);\n\n        intialiseDynamicArray(&amp;tempArray);\n\n        return tempArray;\n    }\n\n\n\n    fread(&amp;tempArray, sizeof(DynamicArray),1,filePointer);\n\n    //Freeing filePointer memory\n    free(filePointer);\n\n    return tempArray;\n\n}\n</code></pre>\n\n<p>saving</p>\n\n<pre><code>void saveAllTuples(DynamicArray ToSave){\n\n    trimArray(&amp;ToSave,0); //Removing extra space from array\n\n    FILE * filePointer;\n\n    if((filePointer=fopen(\"SavedTuples.bin\",\"wb\"))==NULL)\n    {\n        fputs(\"Something went wrong while saving!\\n\", stderr);\n        setbuf(stdout, 0);\n        return;\n    }\n\n    fwrite(&amp;ToSave, sizeof(ToSave), 1,filePointer);\n    fclose(filePointer);\n\n}\n</code></pre>\n\n<p>called by</p>\n\n<pre><code>saveAllTuples(dynaArray);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>dynaArray=loadAllTuples();\n</code></pre>\n"}, {"tags": ["c", "terminal", "segmentation-fault"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1545152955, "post_id": 53836549, "comment_id": 94524003, "body": "Do yourself a favour: Read <code>man gcc</code> and in particular the part about warnings. If you had turned these on, the compiler would have told you that there&#39;s something fishy going on between the returnvalue of <code>system()</code> and the input for <code>strcpy()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 6, "last_activity_date": 1545148418, "creation_date": 1545148418, "answer_id": 53836715, "question_id": 53836549, "link": "https://stackoverflow.com/questions/53836549/segmentation-fault-while-system-in-c/53836715#53836715", "title": "Segmentation fault while system() in C", "body": "<p>If you read the documentation for <code>system</code> you'll discover that it doesn't return a string - it's defined as:</p>\n\n<pre><code>int system(const char *command);\n</code></pre>\n\n<p>The return value is the return status of the command or -1 if there's an error. You can't get the output using <code>system</code> - the output of the command(s) you run will go straight to stdout.</p>\n\n<p>To get the output from another command you could use something like <code>popen</code>.</p>\n\n<pre><code>FILE *myfile;\nchar buffer[1024];\n\nmyfile=popen(\"echo Hello | base64\",\"r\");\nif(myfile)\n  {\n  while(fgets(buffer,1024,myfile))\n    {\n    printf(\"%s\",buffer);\n    }\n\n  pclose(myfile);\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1545151448, "post_id": 53837518, "comment_id": 94523118, "body": "How can you use <code>printf</code> to write output if you&#39;ve closed stdout?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1545153279, "post_id": 53837518, "comment_id": 94524160, "body": "<code>open(&quot;data.txt&quot;,O_RDWR|0664);</code>??!?!  That won&#39;t create the file if it doesn&#39;t exist.  You&#39;re misusing the <code>flags</code> argument to <code>open()</code> and missing the <code>mode</code> argument.  See <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/open.html</a>  Then, you&#39;re assuming it&#39;s safe to call <code>dup2(0,fd)</code> in an attempt to restore <code>stdout</code> without knowing of <code>stdin</code> is safe for writing.  You&#39;d do much better to <code>dup()</code> the <code>stdin</code> file number <b>before</b> closing it to save it.  Third, you risk a buffer overrun if your <code>read()</code> call fills the <code>a</code> buffer."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1545154601, "post_id": 53837518, "comment_id": 94524793, "body": "I&#39;ve edited @AndrewHenle Can you recheck it ? As per my understanding <code>dup2(0,fd);</code> doesn&#39;t disturb other regular fd&#39;s like <code>stdin</code>, <code>stdout</code> and <code>stderr</code>."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1545156909, "last_edit_date": 1545156909, "creation_date": 1545151216, "answer_id": 53837518, "question_id": 53836549, "link": "https://stackoverflow.com/questions/53836549/segmentation-fault-while-system-in-c/53837518#53837518", "title": "Segmentation fault while system() in C", "body": "<p>Here</p>\n\n<pre><code>strcpy(a, system(\"echo Hello | base64\"));\n</code></pre>\n\n<p><code>system()</code> doesn't stores it's result into array a as <code>system()</code> job is to execute the <code>command</code> provided in the argument &amp; print it on console i.e <code>stdout</code> buffer. From the manual page of <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">system</a></p>\n\n<blockquote>\n  <p><code>system()</code>  executes a command specified in <code>command</code> by calling\n  <code>/bin/sh -c</code>\n         command, and returns after the command has been completed.</p>\n</blockquote>\n\n<p>There is one way to solve the problem i.e instead of printing <code>system()</code> output on <code>stdout</code> you can redirect its <em>output to a file</em> &amp; then <em>read that from file</em> &amp; print. For example</p>\n\n<pre><code>int main(void) {\n        close(1); /* stdout file descriptor is avilable now */\n        /* create the file if doesn't exist, if exist truncate the content to 0 length */\n        int fd = open(\"data.txt\",O_CREAT|O_TRUNC|O_RDWR,0664); /* fd gets assigned with lowest \n                                                  available fd i.e 1 i.e nowonwards stdout output \n                                                  gets rediredcted to file */\n        if(fd == -1) {\n                /* @TODO error handling */\n                return 0;\n        }\n        system(\"echo Hello | base64\"); /* system output gets stored in file */\n        int max_char = lseek(fd,0,2);/* make fd to point to end, get the max no of char */\n        char *a = malloc(max_char + 1); /* to avoid buffer overflow or \n                underflow, allocate memory only equal to the max no of char in file */\n        if(a == NULL) {\n                /* @TODO error handling if malloc fails */\n                return 0;\n        }\n        lseek(fd,0,0);/* from beginning of file */\n        int ret = read(fd,a,max_char);/* now read out put of system() from\n                                          file as array and print it */\n        if(ret == -1) {\n                /* @TODO error handling */\n                return 0;\n        }\n        a[ret] = '\\0';/* \\0 terminated array */\n        dup2(0,fd);/*fd 0 duplicated to file descriptor where fd points i.e */\n        printf(\"output : %s \\n\", a);\n        /* to avoid memory leak, free the dynamic memory */\n        free(a);\n        return 0;\n}\n</code></pre>\n\n<p>My above suggestion is a temporary fix &amp; I won't recommend this, instead use [popen] as suggested by @chris Turner (<a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/popen.3.html</a>) which says</p>\n\n<blockquote>\n  <p>The <code>popen()</code> function opens a process by creating a pipe,  forking, \n  and\n         invoking  the shell.  Since a pipe is by definition unidirectional, the\n         type argument may specify  only  <strong>reading</strong>  or  <strong>writing</strong>,  not  both;  the\n         resulting stream is correspondingly read-only or write-only.</p>\n</blockquote>\n\n<p>For example</p>\n\n<pre><code>int main(void) {\n        char buf[1024];\n        FILE *fp = popen(\"echo Hello | base64\",\"r\");\n        printf(\"%s\\n\",fgets(buf,sizeof(buf),fp));\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9886079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722e5faafcae519ffc0247818d86f8a9?s=128&d=identicon&r=PG&f=1", "display_name": "DeshBhakt", "link": "https://stackoverflow.com/users/9886079/deshbhakt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 53837518, "answer_count": 2, "score": 3, "last_activity_date": 1545156909, "creation_date": 1545147920, "last_edit_date": 1545151960, "question_id": 53836549, "link": "https://stackoverflow.com/questions/53836549/segmentation-fault-while-system-in-c", "title": "Segmentation fault while system() in C", "body": "<p>I want to use the \"base64\" script of linux to encode the data and get it in C.\nWhen I try to compile</p>\n\n<pre><code>char a[200];\nstrcpy(a, \"Hello\");\nprintf(\"%s\", a);\n</code></pre>\n\n<p>I get the output</p>\n\n<pre><code>Hello\n</code></pre>\n\n<p>Now whenever I try the code</p>\n\n<pre><code>char a[200];\nstrcpy(a, system(\"echo Hello | base64\"));\nprintf(\"%s\", a);\n</code></pre>\n\n<p>I get the output</p>\n\n<pre><code>aGVsbG8K\nSegmentation fault\n</code></pre>\n\n<p>Even when I remove the \"printf\" statement, I get the same</p>\n\n<pre><code>aGVsbG8K\nSegmentation fault\n</code></pre>\n\n<p>I want to save the value of the output of </p>\n\n<pre><code>system(\"echo Hello | base64\")\n</code></pre>\n\n<p>in 'a' and not display it. Please help</p>\n"}, {"tags": ["c", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1545175113, "post_id": 53836235, "comment_id": 94533125, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/185452/discussion-on-question-by-aomerk-binary-search-tree-memory-leak-at-insertion\">moved to chat</a>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545224479, "post_id": 53836235, "comment_id": 94550924, "body": "<code>strncpy(new-&gt;name,name,strlen(name));</code> is terribly wrong, inthis case even worse than a plain strcpy()."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1545235582, "post_id": 53836235, "comment_id": 94557810, "body": "You should extract a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, without it, your question is off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "is_accepted": true, "score": 0, "last_activity_date": 1545213799, "creation_date": 1545213799, "answer_id": 53848796, "question_id": 53836235, "link": "https://stackoverflow.com/questions/53836235/binary-search-tree-memory-leak-at-insertion/53848796#53848796", "title": "Binary Search Tree - Memory Leak at insertion", "body": "<p>As we all discussed in the comments, your memory leak is that you're not freeing the <code>node-&gt;name</code> strings that you have allocated. You need to add two more <code>free</code>s to your code:</p>\n\n<ul>\n<li>in bst_insert_node, in the case where you can't insert the node, <code>free(new-&gt;name)</code> before you <code>free(new)</code></li>\n<li>in bst_free_subtree, <code>free(node-&gt;name)</code> before you <code>free(node)</code></li>\n</ul>\n\n<p>There is also an off-by-one error allocating space for a copied string, as in your answer. It might be simplest to just <code>new-&gt;name = strdup(name)</code> instead, which will do both the allocate and the copy in one go.</p>\n\n<p>As an aside, if these are phone numbers then <a href=\"https://stackoverflow.com/q/3483156/243245\">I'd probably store them as strings, not integers</a> (or <a href=\"https://github.com/googlei18n/libphonenumber\" rel=\"nofollow noreferrer\">libphonenumber</a> if you want to go the whole hog, but C++ not C) and if there's a problem inserting one then it might be better to return the error to the calling code (e.g. return true if inserted, false if not) and let that raise errors rather than printing from this code.</p>\n"}], "owner": {"reputation": 1266, "user_id": 8035711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54251e31927388d864e8f2fc49fdce27?s=128&d=identicon&r=PG", "display_name": "keser", "link": "https://stackoverflow.com/users/8035711/keser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 1, "accepted_answer_id": 53848796, "answer_count": 1, "score": 0, "last_activity_date": 1545235249, "creation_date": 1545146760, "last_edit_date": 1545235249, "question_id": 53836235, "link": "https://stackoverflow.com/questions/53836235/binary-search-tree-memory-leak-at-insertion", "title": "Binary Search Tree - Memory Leak at insertion", "body": "<p>I am trying to create a binary search tree and insert a new node in an iterative way. It is all working well except I am getting a memory leak in this function. </p>\n\n<p>Valgrind says 7 blocks (I am adding 7 nodes) are missing.\n I couldn't see where my leak is. I would appreciate another look at my code.   </p>\n\n<pre><code>void bst_insert_node(bstree* bst, unsigned long phone, char *name) {\n    bst_node* current = bst-&gt;root;\n\n    bst_node* parent = NULL;\n\n    bst_node* new = (bst_node *)malloc(sizeof(bst_node));\n    new-&gt;phone  = phone;\n    new-&gt;left   =   new-&gt;right  =   new-&gt;parent =   NULL;\n    new-&gt;name = malloc(sizeof(char) * (strlen(name)+1));\n    strncpy(new-&gt;name,name,(strlen(name)+1));\n\n    while(current != NULL) {\n\n        parent = current;\n\n        if(phone &lt; current-&gt;phone) {\n            current = current -&gt; left;\n        }\n        else if(phone &gt; current-&gt;phone) {\n            current = current -&gt; right;\n        } else {\n            free(new);\n            printf(\"Diese Nummer ist schon bekannt \\n\");\n            return;\n        }\n    }\n\n    new-&gt;parent = parent;\n\n    if(parent == NULL) {\n        bst-&gt;root = new;\n    }\n    else if(new-&gt;phone &lt; parent-&gt;phone) {\n        parent-&gt;left = new;\n    }\n    else {\n        parent-&gt;right = new;\n    }\n}\n</code></pre>\n\n<p>Free methods:</p>\n\n<pre><code>void bst_free_subtree(bst_node* node) {\nif (node == NULL) return;\n\nbst_free_subtree(node-&gt;left);\nbst_free_subtree(node-&gt;right);\nprintf(\"\\n Deleting node: %lu \\t %s\", node-&gt;phone,node-&gt;name);\nfree(node);}\n\nvoid bst_free_tree(bstree* bst) {\n    if(bst != NULL &amp;&amp; bst-&gt;root != NULL) {\n        bst_free_subtree(bst-&gt;root);\n        bst-&gt;root = NULL;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "contiki"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545146769, "post_id": 53835694, "comment_id": 94520409, "body": "The error message appears to be telling you that the compiled code is too large for the target device.  In that case, you might try compiler options to optimize for small code size.  Since you appear to be using GCC, that would be <code>-Os</code>, and be careful to avoid overriding the effects of that via other optimization flags."}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1545146785, "post_id": 53835694, "comment_id": 94520418, "body": "In general, C++ is not supported on Contiki. In particular (your example), the problem most likely is the iostream library - it&#39;s too large to fit on the flash."}, {"owner": {"reputation": 53, "user_id": 9485445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056332a193a098b25a19fd72b1dbc30e?s=128&d=identicon&r=PG&f=1", "display_name": "wellsaid", "link": "https://stackoverflow.com/users/9485445/wellsaid"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545148693, "post_id": 53835694, "comment_id": 94521555, "body": "@JohnBollinger, that doesn&#39;t seem to make difference. I&#39;ve tried to add it in CFLAGS, CXXFLAGS and LDFLAGS"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545149329, "post_id": 53835694, "comment_id": 94521907, "body": "More likely, <code>-Os</code> doesn&#39;t make <i>enough</i> difference to solve the problem.  And if that&#39;s so then now may be a good time to throw in the towel.  It is conceivable that you could find or build a small enough implementation of the C++ standard library that the needed bits would fit, together with your own code, into the target device, but that effort would probably be better spent on converting your C++ library of interest instead, or to finding an alternative."}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1545149531, "post_id": 53835694, "comment_id": 94522016, "body": "@JohnBollinger It does not make a difference because it is already the default optimization level for the target platform."}], "owner": {"reputation": 53, "user_id": 9485445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056332a193a098b25a19fd72b1dbc30e?s=128&d=identicon&r=PG&f=1", "display_name": "wellsaid", "link": "https://stackoverflow.com/users/9485445/wellsaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545148819, "creation_date": 1545144891, "last_edit_date": 1545148819, "question_id": 53835694, "link": "https://stackoverflow.com/questions/53835694/contiki-c-compile-causes-region-flash-cca-overflowed-for-zoul", "title": "contiki C++ compile causes region `FLASH_CCA&#39; overflowed for zoul", "body": "<p>I need to compile a C++ library to use with contiki on the Zolertia Re-Mote. I am trying a simple program first:</p>\n\n<h3>hello-world.c</h3>\n\n<pre><code>#include \"contiki.h\"\n\n#include \"misc.h\"\n/*---------------------------------------------------------------------------*/\nPROCESS(hello_world_process, \"Hello world process\");\nAUTOSTART_PROCESSES(&amp;hello_world_process);\n/*---------------------------------------------------------------------------*/\nPROCESS_THREAD(hello_world_process, ev, data)\n{\n  PROCESS_BEGIN();\n\n  say_hello();\n\n  PROCESS_END();\n}\n/*---------------------------------------------------------------------------*/\n</code></pre>\n\n<h3>misc.cpp</h3>\n\n<pre><code>/* C++ implementation */\n#ifdef CONTIKI_TARGET_ZOUL\nvoid* __dso_handle;\nvoid* __exidx_end;\nvoid* __exidx_start;\n#endif\n\n#include &lt;iostream&gt;\n\nusing namespace std;\nvoid cpp_say_hello(){\n    cout &lt;&lt; \"Hello world!\" &lt;&lt; endl;\n}\n\n/* C wrapper */\nextern \"C\"{\n    #include \"misc.h\"\n\n    void say_hello(){\n        cpp_say_hello();\n    }\n}\n</code></pre>\n\n<h3>misc.h</h3>\n\n<pre><code>#ifndef _MISC_H_\n#define _MISC_H_\n\n/**\n * \\brief Prints hello to stdout\n */\nvoid say_hello();\n\n#endif /* _MISC_H_ */\n</code></pre>\n\n<h3>Makefile</h3>\n\n<pre><code>ifeq ($(TARGET),)\n    TARGET = native\nendif\n\nCONTIKI_PROJECT = hello-world\nall: $(CONTIKI_PROJECT)\n\nPROJECT_LIBRARIES = obj_$(TARGET)/misc.o\n\ninclude $(CONTIKI)/Makefile.include\n\nobj_$(TARGET)/misc.o: misc.cpp\n    @mkdir -p obj_$(TARGET)\n    $(TRACE_CXX)\n    $(Q)$(CXX) $(CFLAGS) $(CXXFLAGS) -c $^ -o $@\n</code></pre>\n\n<p>This (with some modifications to the contiki Makefiles: <a href=\"https://github.com/wellsaid/contiki/commit/b9d0f8b499479e7315d5841aaa038a76d1b13adb\" rel=\"nofollow noreferrer\">here</a>) made possible for me to use C++ code for the 'native' target. However when i try to compile for the Zolertia Re-Mote platform (TARGET=zoul) i obtain the following error:</p>\n\n<pre><code>/usr/lib/gcc/arm-none-eabi/8.2.0/../../../../arm-none-eabi/bin/ld: hello-world.elf section `.ARM.extab.text._Z13cpp_say_hellov' will not fit in region `FLASH_CCA'\n/usr/lib/gcc/arm-none-eabi/8.2.0/../../../../arm-none-eabi/bin/ld: region `FLASH_CCA' overflowed by 788 bytes\ncollect2: error: ld returned 1 exit status\nmake: *** [/home/wellsaid/contiki/cpu/cc2538/Makefile.cc2538:103: hello-world.elf] Error 1\nrm hello-world.co obj_zoul/startup-gcc.o\n</code></pre>\n\n<p>Any way to fix this?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1545144633, "post_id": 53835515, "comment_id": 94519146, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"nofollow noreferrer\"><code>k++</code> invokes Undefined Behaviour</a>: &quot;If both the pointer operand and the result point to elements of <b>the same array object, or one past the last element of the array object</b>, the evaluation shall not produce an overflow; <b>otherwise, the behavior is undefined</b>.&quot;"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1545144680, "post_id": 53835515, "comment_id": 94519180, "body": "@pmg <code>k++</code> is not UB - the result is 1-past the object, whih is ok. <code>*k</code> afterwarrds is."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1545145056, "post_id": 53835515, "comment_id": 94519386, "body": "@EugeneSh. I interpret the Standard as saying <code>k++</code> is UB, and I agree that if UB hasn&#39;t already happenned by the time of <code>*k</code>, then <i>that</i> is UB :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1545145075, "post_id": 53835515, "comment_id": 94519397, "body": "@pmg Or you are saying it is not an <i>array</i> object? Interesting question - can <code>&amp;i</code> be considered as a pointer to array of one element?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1545145123, "post_id": 53835515, "comment_id": 94519429, "body": "<i>Very interesting</i>! I often do <code>sometype foo[1];</code> myself !!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1545146091, "post_id": 53835515, "comment_id": 94520000, "body": "@pmg, the side effect of the postfix <code>++</code> operator on the value of its operand is explicitly defined in terms of the behavior of the infix <code>+</code> operator when the operand is a pointer.  And in that case, &quot;a pointer to an object that is not an element of an array behaves the same as a pointer to the first element of an array of length one with the type of the object as its element type.&quot; (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p7\" rel=\"nofollow noreferrer\">C2011, 6.5.6/7</a>).  There is nothing undefined about the behavior of the expression <code>k++</code> in the OP&#39;s code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545146252, "post_id": 53835515, "comment_id": 94520104, "body": "@JohnBollinger Thanks for this reference. It have covered this hole..."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545146292, "post_id": 53835515, "comment_id": 94520130, "body": "Thank you @JohnBollinger. Right in front of my eyes and I missed that"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1545146416, "post_id": 53835515, "comment_id": 94520209, "body": "<code>&lt;iostream&gt;</code> is not a valid C header. Maybe you wanted C++ tag?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 6, "creation_date": 1545145342, "post_id": 53835610, "comment_id": 94519549, "body": "For clarity: <code>k++</code> is not UB, the following <code>*k</code> is UB."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1545145583, "post_id": 53835610, "comment_id": 94519697, "body": "That&#39;s right. I reworded it a bit to emphasize that the undefined action is reading from the increased value, not the increment itself."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1545145544, "last_edit_date": 1545145544, "creation_date": 1545144651, "answer_id": 53835610, "question_id": 53835515, "link": "https://stackoverflow.com/questions/53835515/if-pointer-stores-the-address-of-a-variable-and-is-itself-a-variable-doesnt-it/53835610#53835610", "title": "If pointer stores the address of a variable and is itself a variable, doesn&#39;t it create infinite pointers and fills the entire system memory?", "body": "<p>Actually, it's undefined behavior. This here:</p>\n\n<pre><code>k++;\n</code></pre>\n\n<p>Increases the pointer so it points to a different memory location, it advances it by the size of an <code>int</code>. If <code>i</code> were an array of multiple ints, it would point to the next one in line. But it isn't, so reading from this pointer in the print later is undefined behavior and it might read from an unspecified place.</p>\n\n<p>When I try this program in MSVC, it doesn't print <code>0</code> or <code>88</code>, it prints <code>-858993460</code> every time. A different compiler may print something entirely else, something that changes, or just crash the program, or even do something different than all of those.</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1545144752, "creation_date": 1545144752, "answer_id": 53835646, "question_id": 53835515, "link": "https://stackoverflow.com/questions/53835515/if-pointer-stores-the-address-of-a-variable-and-is-itself-a-variable-doesnt-it/53835646#53835646", "title": "If pointer stores the address of a variable and is itself a variable, doesn&#39;t it create infinite pointers and fills the entire system memory?", "body": "<p>If uncommenting a line affects the output, it seems likely that your code has undefined behaviour. Which is clear from actually reading the code, especially these two lines.</p>\n\n<p>This line is fine.</p>\n\n<pre><code>int *k=&amp;i;\n</code></pre>\n\n<p>But what do you expect this line to do?</p>\n\n<pre><code>k++;\n</code></pre>\n\n<p><code>i</code> is a single <code>int</code> so pointing <code>k</code> at the <code>int</code> after it has no meaning or use as you could be accessing any part of memory as evident by the fact that sometimes you get 0 or sometimes get 88.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 6377334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef0eab5be85f670805a44e89d1b798?s=128&d=identicon&r=PG&f=1", "display_name": "Manesidlapy", "link": "https://stackoverflow.com/users/6377334/manesidlapy"}, "edited": false, "score": 0, "creation_date": 1545162523, "post_id": 53835803, "comment_id": 94528414, "body": "But here l-k is always coming out to be 1, doesn&#39;t that mean that the value at k+1 is the value at l? And the output is 88 when i simply print the value of l-k in the previous line. Why so?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1545145270, "creation_date": 1545145270, "answer_id": 53835803, "question_id": 53835515, "link": "https://stackoverflow.com/questions/53835515/if-pointer-stores-the-address-of-a-variable-and-is-itself-a-variable-doesnt-it/53835803#53835803", "title": "If pointer stores the address of a variable and is itself a variable, doesn&#39;t it create infinite pointers and fills the entire system memory?", "body": "<p>Whilst</p>\n\n<pre><code>k++;\n</code></pre>\n\n<p>is allowed (you are allowed to set a pointer one past the address of a scalar <em>and</em> read that pointer value), the behaviour of the subsequent <em>dereference</em> of <code>k</code> is <em>undefined</em>. Somewhat paradoxically that means that the behaviour of your entire program is undefined.</p>\n\n<p>The behaviour of <code>l-k</code> would also be undefined. Pointer arithmetic, including the difference between two pointers, is only defined within arrays. For this purpose an object can be regarded as a single element array.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1545156308, "creation_date": 1545156308, "answer_id": 53838759, "question_id": 53835515, "link": "https://stackoverflow.com/questions/53835515/if-pointer-stores-the-address-of-a-variable-and-is-itself-a-variable-doesnt-it/53838759#53838759", "title": "If pointer stores the address of a variable and is itself a variable, doesn&#39;t it create infinite pointers and fills the entire system memory?", "body": "<p>Regarding the question in the title:</p>\n\n<blockquote>\n  <p>If pointer stores the address of a variable and is itself a variable, doesn't it create infinite pointers and fills the entire system memory?</p>\n</blockquote>\n\n<p>No. I added some code to dump the addresses and contents of each of <code>i</code>, <code>j</code>, <code>k</code>, and <code>l</code>, and here is the result:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee31d3a48   37   00   00   00    7...\n\n          j  0x7ffee31d3a44   58   00   00   00    X...\n\n          k  0x7ffee31d3a38   48   3a   1d   e3    H:..\n             0x7ffee31d3a3c   fe   7f   00   00    ....\n\n          l  0x7ffee31d3a30   44   3a   1d   e3    D:..\n             0x7ffee31d3a34   fe   7f   00   00    ....\n</code></pre>\n\n<p>Hopefully the output is self-explanatory - each row shows the name of the item, its address, and its contents (both in hex and as a sequence of bytes).  </p>\n\n<p>I'm on a little-endian system, so multi-byte objects have to be read from bottom to top, right to left.    </p>\n\n<p>Anyway, <code>i</code> lives at address <code>0x7ffee31d3a48</code> and stores the value <code>55</code> (<code>0x37</code>).  <code>k</code> lives at address <code>0x7ffee31d3a38</code> and stores the value <code>0x7ffee31d3a48</code>, which is the address of <code>i</code>.  </p>\n\n<p>There's no infinite regression of addresses.  <code>k</code> is <em>just another variable</em> - the only difference between it and <code>i</code> is that it stores a different type of value.  </p>\n\n<p>As for your other question:</p>\n\n<blockquote>\n  <p>Why does uncommenting previous line changes the output from 0 to 88?</p>\n</blockquote>\n\n<p>The expression <code>k++</code> changes what <code>k</code> points to - it's no longer pointing to <code>i</code>.  Here's the state of the program after that expression:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee31d3a48   37   00   00   00    7...\n\n          j  0x7ffee31d3a44   58   00   00   00    X...\n\n          k  0x7ffee31d3a38   4c   3a   1d   e3    L:..\n             0x7ffee31d3a3c   fe   7f   00   00    ....\n\n          l  0x7ffee31d3a30   44   3a   1d   e3    D:..\n             0x7ffee31d3a34   fe   7f   00   00    ....\n</code></pre>\n\n<p>Instead of storing the address of <code>i</code> (<code>0x7ffee31d3a48</code>), <code>k</code> now stores the address <code>0x7ffeee31d3a4c</code>, which is ... not the address of any object in your program.  At this point, attempting to dereference <code>k</code> invokes <em>undefined behavior</em> - your code may crash, or you may get unexpected output, or through some miracle you may get the result you expect.  Removing the <code>printf</code> statement changes the layout of your program in memory, which will affect what <code>k</code> points to after the <code>k++</code> expression.  </p>\n"}], "owner": {"reputation": 39, "user_id": 6377334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef0eab5be85f670805a44e89d1b798?s=128&d=identicon&r=PG&f=1", "display_name": "Manesidlapy", "link": "https://stackoverflow.com/users/6377334/manesidlapy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53838759, "answer_count": 4, "score": -2, "last_activity_date": 1545162254, "creation_date": 1545144326, "last_edit_date": 1545162254, "question_id": 53835515, "link": "https://stackoverflow.com/questions/53835515/if-pointer-stores-the-address-of-a-variable-and-is-itself-a-variable-doesnt-it", "title": "If pointer stores the address of a variable and is itself a variable, doesn&#39;t it create infinite pointers and fills the entire system memory?", "body": "<p>Here's one more problem with pointers :</p>\n\n<p>How is printing something or not influencing the value stored at a particular address?</p>\n\n<p>l-k has a value equal to 1, that's why i'm checking if the value stored at k+1 is equal to 88 or not.</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main()\n{\n    int i=55;\n    int j=88;\n    int *k=&amp;i;\n    int *l=&amp;j;\n    k++;\n//  printf(\"%p\\n\",l-k); \n/*  Why does uncommenting previous line changes the output from 0 to 88?  */\n    printf(\"%i\",*k);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "curl", "file-upload", "file-uri"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545148974, "post_id": 53835360, "comment_id": 94521690, "body": "What is the return value of <code>curl_easy_perform()</code>?"}, {"owner": {"reputation": 593, "user_id": 2043014, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/95e67cde1917a7e0334411c49f3c6a86?s=128&d=identicon&r=PG", "display_name": "user12345", "link": "https://stackoverflow.com/users/2043014/user12345"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545152605, "post_id": 53835360, "comment_id": 94523808, "body": "@RemyLebeau: I noticed CURLE_URL_MALFORMAT. So I fixed the url format by changing <code>url.c_str()</code>. After that am getting CURLE_WRITE_ERROR(23)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545158517, "post_id": 53835360, "comment_id": 94526651, "body": "&quot;<i>An error occurred when writing received data to a local file, or an error was returned to libcurl from a write callback.</i>&quot; You didnt tell curl where to write the server&#39;s response to. You have no write callback, and no output file."}, {"owner": {"reputation": 593, "user_id": 2043014, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/95e67cde1917a7e0334411c49f3c6a86?s=128&d=identicon&r=PG", "display_name": "user12345", "link": "https://stackoverflow.com/users/2043014/user12345"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545161060, "post_id": 53835360, "comment_id": 94527768, "body": "@RemyLebeau I am new to curl and I am trying to do a file upload to the windows shared network drive. I have referred to the ftpupolad example from curl as reference for my work, do I need to have a write call back even for uploading a file ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545176879, "post_id": 53835360, "comment_id": 94533559, "body": "<code>&quot;file:&#47;&#47;&#47;&#47;&lt;ip_address&gt;&#47;ShareDrive&#47;&quot;</code> has too many slashes, it should be <code>file:&#47;&#47;&lt;ip_address&gt;&#47;ShareDrive&#47;</code> instead. And your command shell example has output, maybe that is what libcurl is trying to write, or maybe that is just handled by the <code>curl.exe</code> wrapper, I don&#39;t know. If you don&#39;t about any output during the upload, try assigning a write callback that does not actually write anything: <code>size_t write_callback(char *ptr, size_t size, size_t nmemb, void *userdata) { return size * nmemb; }  ... curl_easy_setopt(curl_, CURLOPT_WRITEFUNCTION, write_callback);</code>"}, {"owner": {"reputation": 593, "user_id": 2043014, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/95e67cde1917a7e0334411c49f3c6a86?s=128&d=identicon&r=PG", "display_name": "user12345", "link": "https://stackoverflow.com/users/2043014/user12345"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1545199854, "post_id": 53835360, "comment_id": 94538524, "body": "@RemyLebeau When I try with <code>file:&#47;&#47;&lt;ip_address&gt;&#47;ShareDrive&#47;</code> I see an error <code>CURLE_URL_MALFORMAT</code> and the error goes off if I use three forward slashes like<code>file:&#47;&#47;&#47;&lt;ip_address&gt;&#47;ShareDrive&#47;</code>. Even with adding the write_callback I am still seeing the WRITE_ERROR and I have put a breakpoint in both callbacks and the breakpoints were never hit. Am really having no clue on this."}], "owner": {"reputation": 593, "user_id": 2043014, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/95e67cde1917a7e0334411c49f3c6a86?s=128&d=identicon&r=PG", "display_name": "user12345", "link": "https://stackoverflow.com/users/2043014/user12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546418350, "creation_date": 1545143864, "last_edit_date": 1546418350, "question_id": 53835360, "link": "https://stackoverflow.com/questions/53835360/unable-to-copy-files-to-windows-shared-drive-using-libcurl-and-file-protocol", "title": "Unable to copy files to windows shared drive using libCurl and FILE protocol", "body": "<p>I am using the curl-7.62.0 built for VC17 X64 machine to develop a file uploader utility. The file uploader uploads the file to a network drive. The curl build directory has a <code>.exe</code> and a <code>.dll</code> files</p>\n\n<p>I am able to run this command from windows shell and was able to upload the file to the network drive successfully.</p>\n\n<pre><code>&lt;path_to_curl&gt;\\bin\\curl --upload-file C:\\file.txt file:////&lt;ip_address&gt;/ShareDrive/\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1403    0     0  100  1403      0  87687 --:--:-- --:--:-- --:--:-- 87687\n</code></pre>\n\n<p>Now I want to achieve the same programmatically and I am writing my component in C++. I have an upload function as below:</p>\n\n<pre><code>int Uploader::upload(const std::string&amp; url) {\n    CURLcode res;\n    FILE *hd_src;\n    struct stat file_info;\n    curl_off_t fsize;\n\n    if (stat(LOCAL_FILE, &amp;file_info)) {\n        printf(\"Couldnt open '%s': %s\\n\", LOCAL_FILE, strerror(errno));\n            return -1;\n        }\n        fsize = (curl_off_t)file_info.st_size;\n\n        printf(\"Local file size: %\" CURL_FORMAT_CURL_OFF_T \" bytes.\\n\", fsize);\n\n        hd_src = fopen(LOCAL_FILE, \"rb\");\n\n        curl_global_init(CURL_GLOBAL_ALL);\n\n        curl_ = curl_easy_init();\n        if (curl_) {\n        curl_easy_setopt(curl_, CURLOPT_UPLOAD, 1L);\n\n            curl_easy_setopt(curl_, CURLOPT_URL, url.c_str());\n\n            curl_easy_setopt(curl_, CURLOPT_READDATA, hd_src);\n\n            curl_easy_setopt(curl_, CURLOPT_READFUNCTION, read_callback);\n\n            curl_easy_setopt(curl_, CURLOPT_INFILESIZE_LARGE,\n                    (curl_off_t)fsize);\n\n            res = curl_easy_perform(curl_);\n        }\n\n        fclose(hd_src);\n        return 0;\n}\n</code></pre>\n\n<p>And my callback is in global scope: </p>\n\n<pre><code>static size_t read_callback(void *ptr, size_t size, size_t nmemb, void *stream)\n{\n\n    printf(\"Called...\\n\");\n\n    size_t retcode = fread(ptr, size, nmemb, (FILE*)stream);\n    printf(\"*** We read %lld bytes from file\\n\", retcode);\n    return retcode;\n}\n</code></pre>\n\n<p>And my main looks like this: </p>\n\n<pre><code>int main(int argc, char** argv) {\n    Uploader uploader;\n    uploader.upload(\"file:////&lt;ip_address&gt;/ShareDrive/\");       \n}\n</code></pre>\n\n<p>The control never goes to the callback method at all and hence the upload never happens. Does CURL support the FILE Protocol ? I can see the examples of FTPUpload, HTTPupload but there are no examples with the FILE protocol on Windows.</p>\n\n<p>Am I doing it right?</p>\n"}, {"tags": ["c", "visual-studio-2012", "intellisense"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545143935, "post_id": 53834814, "comment_id": 94518706, "body": "Note that although the dupe target does not mention Intellisense, that&#39;s because it&#39;s the wrong knob.  The VS compiler defines <code>__cplusplus</code> only when compiling in C++ mode, not when compiling in C mode.  The dupe target describes both how the compiler chooses the default mode based on filename extensions, and what compiler options serve to override the default language choice."}, {"owner": {"reputation": 1, "user_id": 10806490, "user_type": "registered", "profile_image": "https://graph.facebook.com/2386947661375637/picture?type=large", "display_name": "AndyWro", "link": "https://stackoverflow.com/users/10806490/andywro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545210190, "post_id": 53834814, "comment_id": 94543005, "body": "this is the part of code   #if defined(<i>_cplusplus)  _EXTERN_C_BEGIN</i>  #endif  i want to have undefined grayed the body of #if"}], "owner": {"reputation": 1, "user_id": 10806490, "user_type": "registered", "profile_image": "https://graph.facebook.com/2386947661375637/picture?type=large", "display_name": "AndyWro", "link": "https://stackoverflow.com/users/10806490/andywro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1545143219, "answer_count": 0, "score": 0, "last_activity_date": 1545209734, "creation_date": 1545142022, "last_edit_date": 1545209734, "question_id": 53834814, "link": "https://stackoverflow.com/questions/53834814/visual-studio-2012-intellisense-macro-configuration", "closed_reason": "Duplicate", "title": "Visual Studio 2012 intellisense macro configuration", "body": "<p>how to configure intellisense in visual studio 2012 to disable __cplusplus macro? i have some makefile project created and i want to force it to be C project</p>\n\n<p>edit: i perform compilation of embedded software, using makefile project from visual studio. compilation process is without problem. only thing i need is to run intellisense, which is very useful part of this IDE.\nas i said before, by default, macro __cplusplus is defined, so that's why part of code in intellisense is enabled. i can't change the source code, but only i can disable this macro in some settings of intellisense, but i can't find where to do it in visual studio 2012 professional.\nnote, that previously linked post was related to compilation of C project in VS, which wasn't needed for me.</p>\n"}, {"tags": ["c", "arrays", "sorting", "binary-search-tree"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1545136610, "post_id": 53833141, "comment_id": 94514461, "body": "Hello Sejaad. Observe how I edited your question, formatting your code. Next time, it would be nice, if you would do it yourself. :) An advice to get help in Stackoverflow is to create an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 3, "creation_date": 1545136691, "post_id": 53833141, "comment_id": 94514502, "body": "If for instance you have <code>arr</code> and size = <code>10</code>, then in your two recursive calls you pass <code>arr</code> and size = <code>5</code> respectively <code>arr+5</code> and size = <code>5</code>."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1545138292, "post_id": 53833141, "comment_id": 94515414, "body": "You should post what you&#39;ve done so far for the left side, the approach will be similar for the rest of the array."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1545141209, "post_id": 53833141, "comment_id": 94517167, "body": "Is there nothing stopping you having your function call another function that does have a start variable?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545142319, "post_id": 53833141, "comment_id": 94517811, "body": "This is impossible to answer without knowing what <code>BSTree</code> is. Some implementations just use NULL for the root, and then this prototype is fundamentally flawed and the problem cannot be solved. Please show the type definition for <code>BSTree</code> and how you call this function from main()."}, {"owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1545153964, "post_id": 53833141, "comment_id": 94524502, "body": "@gsamaras thank you for your help."}, {"owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1545153982, "post_id": 53833141, "comment_id": 94524511, "body": "@Groo i am not allowed to have a help function for this one."}, {"owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1545153995, "post_id": 53833141, "comment_id": 94524517, "body": "@Lundin i have edited and added the rest of the code."}, {"owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545154077, "post_id": 53833141, "comment_id": 94524545, "body": "@4386427 the tree will not be balanced if i start from index zero, or have i misunderstood your question perhaps?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "edited": false, "score": 0, "creation_date": 1545154300, "post_id": 53834416, "comment_id": 94524641, "body": "no you understood it correctly, thank you. i am still a beginner but i will try to implement what you suggested"}], "tags": [], "owner": {"reputation": 992, "user_id": 5446276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKM0T.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/5446276/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1545140705, "creation_date": 1545140705, "answer_id": 53834416, "question_id": 53833141, "link": "https://stackoverflow.com/questions/53833141/recursively-splitting-array-in-c/53834416#53834416", "title": "Recursively splitting array in c", "body": "<p>To answer your question, the \"start variable\" should be a pointer to a subarray. Given an array a[10], you should call the function with &amp;a[0] with size 5 and another call with &amp;a[5] with size 5 again.</p>\n\n<p>Correct me if I misunderstood what you meant by start variable.</p>\n"}], "owner": {"reputation": 11, "user_id": 10806056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82dd004d1a93ba7c2e77270ed8220ec?s=128&d=identicon&r=PG&f=1", "display_name": "programmingnoob", "link": "https://stackoverflow.com/users/10806056/programmingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "closed_date": 1545159553, "answer_count": 1, "score": 1, "last_activity_date": 1545159572, "creation_date": 1545136517, "last_edit_date": 1545153373, "question_id": 53833141, "link": "https://stackoverflow.com/questions/53833141/recursively-splitting-array-in-c", "closed_reason": "Duplicate", "title": "Recursively splitting array in c", "body": "<p>I have a function that I got as a school assignment to build a sorted binary search tree from a sorted array. I'm not allowed to edit the function signature. The function signature should be:</p>\n\n<pre><code>static void buildTreeSortedFromArray(BSTree* tree, const int arr[], int size);\n\n//tree\nstruct treeNode\n{\nint data;\nstruct treeNode* left;\nstruct treeNode* right;\n};\n\ntypedef struct treeNode* BSTree;\n\n\n//this is how far i have got\nstatic void buildTreeSortedFromArray(BSTree* tree, const int arr[], int size)\n{\nint mid = size / 2;\n\nif (size &gt; size * 2) {\n    return NULL;\n}\n\n\n//works for the first time only\nif (sizeof(arr) == size) {\n    mid = (size - 1) / 2;\n}\n\n*tree = createNode(arr[mid]);\n\nBSTree treeTemp = *tree;\n\n\n    buildTreeSortedFromArray(&amp;(treeTemp)-&gt;left, arr,mid-1);\n\n\n    buildTreeSortedFromArray(&amp;(treeTemp)-&gt;right, arr, mid+1);\n\n}\n</code></pre>\n\n<p>I have no problem recursively building the left side of the tree because I only need to divide the array by 2 until I reach index 0 but the right side is the tricky bit for me. </p>\n\n<p>I can't grasp how I should reach the right half of the array if I'm not allowed to add a start variable as an argument to the function signature? </p>\n\n<p>I appreciate any advice.</p>\n"}]