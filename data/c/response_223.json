[{"tags": ["c"], "comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1555545894, "post_id": 55737446, "comment_id": 98152722, "body": "&quot;After running the <code>test</code> function, I expected that&quot; - the program terminates after running the <code>test</code> function..."}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1555546093, "post_id": 55737446, "comment_id": 98152760, "body": "I forgot the <code>printf</code> line, sorry! updated!"}, {"owner": {"reputation": 221, "user_id": 9675675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5382c615a2d36b23b1a4dd02dc64?s=128&d=identicon&r=PG", "display_name": "marcelodmmenezes", "link": "https://stackoverflow.com/users/9675675/marcelodmmenezes"}, "edited": false, "score": 0, "creation_date": 1555546128, "post_id": 55737446, "comment_id": 98152765, "body": "You are printing the particles array, not the b[0].p array"}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "edited": false, "score": 0, "creation_date": 1555546179, "post_id": 55737446, "comment_id": 98152778, "body": "yes, I updated again, I am want the changes done on the b[0].p array to be reflected in the particles array"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555605185, "post_id": 55737446, "comment_id": 98177274, "body": "OT:  regarding: <code>int main (int argc, char **argv)</code>  To avoid the compiler outputting two warning messages about unused parameters,  When the parameters to <code>main()</code> are not used, then use the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555605500, "post_id": 55737446, "comment_id": 98177408, "body": "OT:  regarding: <code>bins *b = (bins*) malloc (4 * sizeof(bins));</code>  and <code>particle_t *particles = (particle_t*) malloc (4 * sizeof(particle_t));</code>  1) In c, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  2) Always check (!=NULL) the returned value to assure the operation was successful.  If not successful, call <code>perror( &quot;malloc failed&quot; );</code>   3) before exiting the program, always pass allocated memory pointers to <code>free()</code> to avoid a memory leak."}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555608801, "post_id": 55737446, "comment_id": 98178846, "body": "thanks @user3629249! I am <code>free()</code>ing in my code, just forgot to add to the snippet :)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555608861, "post_id": 55737446, "comment_id": 98178863, "body": "we have to work with what you actually post, we cannot read your mind, not read code that is not posted"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "edited": false, "score": 0, "creation_date": 1555546874, "post_id": 55737533, "comment_id": 98152887, "body": "Thanks! Would you mind helping me take this one step further? How would I make this work if I wanted to split the 4 particles I have in this example among 2 bins, as an example?"}, {"owner": {"reputation": 221, "user_id": 9675675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5382c615a2d36b23b1a4dd02dc64?s=128&d=identicon&r=PG", "display_name": "marcelodmmenezes", "link": "https://stackoverflow.com/users/9675675/marcelodmmenezes"}, "reply_to_user": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "edited": false, "score": 2, "creation_date": 1555547852, "post_id": 55737533, "comment_id": 98153085, "body": "You could, for instance, make the first bin point to the beginning of particles{ b[0].p = particles; } and the second point to the other half { b[1].p = particles + 2; }. But I don&#39;t see why you are doing this kind of stuff. Seems to me that there is no need for the particles array. Just allocate each bin with its own particles..."}, {"owner": {"reputation": 221, "user_id": 9675675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5382c615a2d36b23b1a4dd02dc64?s=128&d=identicon&r=PG", "display_name": "marcelodmmenezes", "link": "https://stackoverflow.com/users/9675675/marcelodmmenezes"}, "reply_to_user": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "edited": false, "score": 0, "creation_date": 1555547980, "post_id": 55737533, "comment_id": 98153108, "body": "If you insist in having everyone sharing the same memory at least make sure that each bin only access its share of the particles array (Make sure the for iterate only for each bin size (num_part))."}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "edited": false, "score": 0, "creation_date": 1555592483, "post_id": 55737533, "comment_id": 98170043, "body": "Thanks again! The reason I have the 2 different arrays is because in the grander scheme of my program, the particles are set with position, velocity, and acceleration and then interact with each other, but only if they are close enough to each other within a predefined space. The bins collect the particles so that I can limit the number of particles each particle checks to see if an interaction should occur.  And yes, I am iterating over num_parts, I had simplified the code here to highlight where I was getting stuck."}], "tags": [], "owner": {"reputation": 221, "user_id": 9675675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5382c615a2d36b23b1a4dd02dc64?s=128&d=identicon&r=PG", "display_name": "marcelodmmenezes", "link": "https://stackoverflow.com/users/9675675/marcelodmmenezes"}, "is_accepted": true, "score": 2, "last_activity_date": 1555546315, "creation_date": 1555546315, "answer_id": 55737533, "question_id": 55737446, "link": "https://stackoverflow.com/questions/55737446/how-to-modify-pointer-to-array-of-structs-inside-another-struct-by-reference/55737533#55737533", "title": "How to modify pointer to array of structs inside another struct by reference", "body": "<p>The problem is that you are allocating a new array for b[0].p and copying the particles array to b[0].p array. Your function changes the memory in b[0].p and not the memory pointed by particles.</p>\n\n<p>Instead of malloc just make your b[0].p array point to particles.</p>\n\n<p>Summing up, change</p>\n\n<pre><code>b[0].p = (particle_t*) malloc (4 * sizeof(particle_t));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>b[0].p = particles;\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55737533, "answer_count": 1, "score": 0, "last_activity_date": 1555546315, "creation_date": 1555545517, "last_edit_date": 1555546134, "question_id": 55737446, "link": "https://stackoverflow.com/questions/55737446/how-to-modify-pointer-to-array-of-structs-inside-another-struct-by-reference", "title": "How to modify pointer to array of structs inside another struct by reference", "body": "<p>I am trying to modify a struct that is a pointer inside of another struct within a function and then have the change reflect back outside of the function.</p>\n\n<p>I have simplified my code below to the exact issue I am having.  I understand that inside my function, as currently constructed, I am modifying the value of x, rather than the utilizing the address of x to modify, but I can't seem to wrap my head around how to properly modify each <code>particle</code> in the array. I have tried</p>\n\n<pre><code>b[0].p-&gt;x++;\n</code></pre>\n\n<p>inside the for loop in the <code>test</code> function, but that only changes <code>p[0]</code> from 1 to 5.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n        int x;\n} particle_t;\n\ntypedef struct {\n        int num_part;\n        particle_t* p;\n} bins;\n\nvoid test (bins *b) {\n        for (int i = 0; i &lt; 4; i++) {\n                b[0].p[i].x++;\n        }\n}\n\nint main (int argc, char **argv) {\n        particle_t *particles = (particle_t*) malloc (4 * sizeof(particle_t));\n        particles[0].x = 1;\n        particles[1].x = 2;\n        particles[2].x = 3;\n        particles[3].x = 4;\n\n        bins *b = (bins*) malloc (4 * sizeof(bins));\n        b[0].num_part = 1;\n        b[0].p = (particle_t*) malloc (4 * sizeof(particle_t));\n\n        for (int i = 0; i &lt; 4; i++) {\n                b[0].p[i] = particles[i];\n        }\n\n        test(b);\n\n        printf(\"%d %d %d %d\\n\",particles[0].x,particles[1].x,particles[2].x,particles[3].x);\n\n        return 0;\n}\n</code></pre>\n\n<p>After running the <code>test</code> function, I expected that printing out <code>particles[i].x</code> would yield 2, 3, 4, and 5, but I am still receiving 1, 2, 3, and 4.</p>\n"}, {"tags": ["c", "makefile", "gnu-make"], "comments": [{"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 2, "creation_date": 1555542653, "post_id": 55737068, "comment_id": 98152137, "body": "How about <code>OBJECTS=$(SOURCES:.c=.o)</code> ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1555542988, "post_id": 55737068, "comment_id": 98152213, "body": "On an unrelated note, you don&#39;t need to make <code>all</code> depend on <code>$(SOURCES)</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1555547659, "post_id": 55737068, "comment_id": 98153042, "body": "<code>make</code> does that automatically."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1555551387, "post_id": 55737068, "comment_id": 98153649, "body": "You would probably be better off with the built-in <code>.c.o</code> rule than with providing your own.  If you <i>do</i> provide your own, however, then get it right: to compile to an object file but avoid linking (at that time) into a program, you need the <code>-c</code> flag -- <code>$(CC) $(CFLAGS) -c -o $@ $&lt;</code>.  But again, <code>make</code> has a built-in <code>.c.o</code> rule that will do the right thing here, and you are needlessly overriding it."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11376271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1EZV9Bf2vcU/AAAAAAAAAAI/AAAAAAAAAFs/YNs2DQtIgb4/photo.jpg?sz=128", "display_name": "bitmeddler", "link": "https://stackoverflow.com/users/11376271/bitmeddler"}, "edited": false, "score": 0, "creation_date": 1555608672, "post_id": 55740544, "comment_id": 98178798, "body": "Thanks man! I appreciate you taking the time to explain everything and correct my code. It works great!!"}], "tags": [], "owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1555570257, "creation_date": 1555570257, "answer_id": 55740544, "question_id": 55737068, "link": "https://stackoverflow.com/questions/55737068/how-do-i-tell-make-to-ignore-files-which-havent-been-updated/55740544#55740544", "title": "How do I tell Make to ignore files which haven&#39;t been updated?", "body": "<p>Okay, let's do it, as it ought to be done ;-)</p>\n\n<pre><code># set up our variables\n# note: you may also prefer := or ?= assignments,\n#       however it's not that important here\nCC=gcc\nCFLAGS=-Igen/display -Igen/logic -Iman -Ilib/include -pipe -march=native\n# linker's flags are different from compiler's\nLDFLAGS=\n# these are really libs, not flags\nLDLIBS=-Llib -lglut32 -loglx -lopengl32\n\n# 1) make is not your shell - it does not expand wildcards by default\n# 2) use := to force immediate wildcard expansion;\n#    otherwise make could perform it several times,\n#    which is, at the least, very ineffective\nSOURCES:=$(wildcard gen/display/*.c gen/logic/*.c man/*.c)\n\n# use the right extensions here: .c -&gt; .o\nOBJECTS=$(SOURCES:.c=.o)\n\n# note: it's okay to omit .exe extension if you're using \"POSIX\"-like make\n# (e.g. cygwin/make or msys/make). However, if your make was built on Windows\n# natively (such as mingw32-make), you'd better to add '.exe' here\nEXECUTABLE=win32/demo\n\n# don't forget to say to make that 'all' is not a real file\n.PHONY: all\n# *.c files are what you write, not make\n# note: in fact, you don't need 'all' target at all;\n#       this is rather a common convention\nall: $(EXECUTABLE)\n\n$(EXECUTABLE): $(OBJECTS)\n    $(CC) $(LDFLAGS) $^ $(LDLIBS) -o $@\n\n# note: 1) suffix rules are deprecated; use pattern rules instead\n#       2) this doesn't add much to the built-in rule, so you can even omit it\n#       3) .o files are created in the same directories where .c files reside;\n#          most of the time this is not the best solution, although it's not\n#          a mistake per se\n%.o: %.c\n    $(CC) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11376271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1EZV9Bf2vcU/AAAAAAAAAAI/AAAAAAAAAFs/YNs2DQtIgb4/photo.jpg?sz=128", "display_name": "bitmeddler", "link": "https://stackoverflow.com/users/11376271/bitmeddler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555570257, "creation_date": 1555542136, "question_id": 55737068, "link": "https://stackoverflow.com/questions/55737068/how-do-i-tell-make-to-ignore-files-which-havent-been-updated", "title": "How do I tell Make to ignore files which haven&#39;t been updated?", "body": "<p>I am new to using Make and I am having some trouble figuring out the syntax. I went through a few examples and I essentially combined a few of them to create my own file. I am not sure how to tell make to ignore already compiled source or header files that haven't changed. How can I get make to compile only the files that have changed?</p>\n\n<p>I looked on the GNU website: <a href=\"https://www.gnu.org/software/make/manual/html_node/Avoiding-Compilation.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/make/manual/html_node/Avoiding-Compilation.html</a></p>\n\n<p>I tried some of those flags, but I still am not getting the results I wanted.</p>\n\n<pre><code># specify compiler\nCC=gcc\n# set compiler flags\nCFLAGS=-Igen/display -Igen/logic -Iman -Ilib/include -pipe -march=native\n# set linker flags\nLDFLAGS=-lglut32 -loglx -lopengl32 -Llib \n# include all sources\nSOURCES=gen/display/*.c gen/logic/*.c man/*.c\n# create objects from the source files\nOBJECTS=$(SOURCES:.cpp=.o)\n# specify the name and the output directory of executable\nEXECUTABLE=win32/demo\n\nall: $(SOURCES) $(EXECUTABLE)\n\n# compile the target file from sources \n# $@ = placeholder for target name\n$(EXECUTABLE): $(OBJECTS) \n    $(CC) $(CFLAGS) $(OBJECTS) $(LDFLAGS) -o $@\n\n.c.o:\n    $(CC) $(CFLAGS) $&lt; -o $@\n\n</code></pre>\n\n<p>I have a number of header and source files in different directories that are being compiled, but no matter what I do everything recompiles.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1555543104, "post_id": 55737063, "comment_id": 98152234, "body": "You go out  of bounds of your array. You have four elements (with indexes <code>0</code> to <code>3</code>, inclusive) but your input loop goes up to index <code>4</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555616386, "post_id": 55737063, "comment_id": 98181954, "body": "regarding: <code>&amp;i+1</code>  in a call to <code>printf()</code> need to pass the actual values, not the address of the values.  Suggest: <code>printf(&quot;Enter value %d. \\n&quot;, i+1);</code>  Notice, no <code>address of</code> (&amp;) operator."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555616509, "post_id": 55737063, "comment_id": 98181997, "body": "regarding: <code>for (i = 0; i &lt; 5; ++i) {</code>  In C, the valid index into an array is 0...(number of elements in array -1)  Because in C, arrays are always 0-indexed.  Suggest: <code>for (i = 0; i &lt; 4; ++i) {</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555616729, "post_id": 55737063, "comment_id": 98182094, "body": "OT:  the posted code contains some &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis.  I.E.  4, 5. &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.   Suggest using an <code>enum</code> statement or <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555616809, "post_id": 55737109, "comment_id": 98182126, "body": "this missed the error in the <code>for()</code> statement in <code>main()</code>"}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 0, "last_activity_date": 1555542419, "creation_date": 1555542419, "answer_id": 55737109, "question_id": 55737063, "link": "https://stackoverflow.com/questions/55737063/how-can-i-allow-a-user-to-input-values-for-an-array-with-a-specified-initial-siz/55737109#55737109", "title": "How can I allow a user to input values for an array with a specified initial size?", "body": "<p>When you wrote <code>&amp;i</code> you accidentally created a pointer to <code>i</code>.  Your pointer will have type <code>int *</code>, because it is a pointer to an int.  The <code>%d</code> format specifier expects an int, not a pointer to an int, so that is why the compiler is giving you that error.  (You should re-reread that error and make sure every word of it makes complete sense to you now.)</p>\n\n<p>The solution is to remove the erroneous <code>&amp;</code> operator:</p>\n\n<pre><code>printf(\"Enter value %d.\\n\", i + 1);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11014206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e6731f3a0dac7aa6ce91c76553d51a5?s=128&d=identicon&r=PG&f=1", "display_name": "G707", "link": "https://stackoverflow.com/users/11014206/g707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 55737109, "answer_count": 1, "score": 0, "last_activity_date": 1555542419, "creation_date": 1555542095, "question_id": 55737063, "link": "https://stackoverflow.com/questions/55737063/how-can-i-allow-a-user-to-input-values-for-an-array-with-a-specified-initial-siz", "title": "How can I allow a user to input values for an array with a specified initial size?", "body": "<p>I want to be able to ask a user of this code for four values for an array. I have some code, but it prints an error that I cannot seem to get around. I'm trying to model some of my code after the example in this video tutorial: <a href=\"https://youtu.be/IPYA3b3_nyk?list=PL6gx4Cwl9DGAKIXv8Yr6nhGJ9Vlcjyymq\" rel=\"nofollow noreferrer\">https://youtu.be/IPYA3b3_nyk?list=PL6gx4Cwl9DGAKIXv8Yr6nhGJ9Vlcjyymq</a> , however, I cannot seem to get it to compile without errors.</p>\n\n<p>The error goes as follows:\n     In function \u2018main\u2019:\n     intitializeint.c:12:9: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018int *\u2019 [-Wformat=]\n              printf(\"Enter value %d. \\n\", &amp;i+`);\n             ^</p>\n\n<p>I've tried using printf() and scanf() for each prompt for a value but discovered that this tutorial and tried to mimic it. I've tried rearranging the \"&amp;i+1\" but it just shoots the same error back. I want to have an increment so that in the output, it shows as if the array started at 1.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stddef.h&gt;\n\n void printArray(int n[]);\n\n int main(void)\n {\n     int i;\n     int n[4];\n\n     for (i = 0; i &lt; 5; ++i) {\n         printf(\"Enter value %d. \\n\", &amp;i+1);\n         scanf(\"%d\", &amp;n[i]);\n     }\n\n     printf(\"%s%13s\\n\", \"Element\", \"Value\");\n     printArray(n);\n\n     return 0;\n }\n\n void printArray(int n[])\n{\n     int i;\n     for (size_t i = 0; i &lt; 4; ++i)  {\n         printf(\"%7zu%13d\\n\", i, n[i]);\n     }\n }\n</code></pre>\n"}, {"tags": ["c", "concurrency", "process", "pipe", "fork"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555541563, "post_id": 55736843, "comment_id": 98151892, "body": "Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> and <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly don&#39;t forget how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 341, "user_id": 8295671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e7c3cca19a2b988aaf7df7b0a70a9?s=128&d=identicon&r=PG&f=1", "display_name": "concurrencyboy", "link": "https://stackoverflow.com/users/8295671/concurrencyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555547435, "creation_date": 1555540464, "last_edit_date": 1555547435, "question_id": 55736843, "link": "https://stackoverflow.com/questions/55736843/server-client-communication-and-forwarding-steps", "title": "server-client communication and forwarding steps", "body": "<p>Firstly, I don't need a code. I can write codes too! I need your advices and ideas. I have two C files one is <code>server</code>, the other one is <code>client-maker</code>. The server has <code>4</code> children(employees of server) to respond incoming requests from children(clients) of the client-maker, that is, client-maker forks number of <code>3, 6, ..</code> children subject to argument specifying client(children) number to be <code>fork</code>ed. There is a well-known FIFO which is known by server ,as well as all children, to receive requests from clients(forked children by client-maker).</p>\n\n<p><em>The server(employer of the 4 children) forwards the requests orderly to the idle children.</em> Each of the children does equally similar jobs. <em>The child done its job must tell its parent(server) that I'm ready to get a new job(answer to client).</em> </p>\n\n<p>My problems are as follows,</p>\n\n<ol>\n<li>How does the server forward the incoming requests to the idle<br>\nchildren(the 4 children of server)? What is the way/method that I need to use?</li>\n<li>How can I know the child is idle at that time?</li>\n<li>How can the child tell its parent(server) that I'm ready to get a\nnew job(answer to client)? By what way/method?</li>\n</ol>\n\n<p>I can't start writing my program since I can't answer the questions. I mean - since I can't build its structure. -</p>\n\n<p>Please, propose solutions only with FIFO or PIPE IPCs and signals.</p>\n\n<p>Maybe I can use a counter which is adjusted by the 4 children by guarding with a semaphore. But I'm not sure.</p>\n"}, {"tags": ["c", "memory-leaks", "malloc"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555540740, "post_id": 55736826, "comment_id": 98151678, "body": "Valgrind analyzes the actual behavior of your program, not your source code.  If it says you have a leak, it&#39;s a pretty darn good bet that you have a leak."}, {"owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 2, "creation_date": 1555540775, "post_id": 55736826, "comment_id": 98151682, "body": "Please include a complete program that can be compiled and run, showing the memory leak issue."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1555540837, "post_id": 55736826, "comment_id": 98151692, "body": "^^ Indeed.  Very likely the problem is not inherent in these functions themselves, but rather arises from how you use them."}, {"owner": {"reputation": 103, "user_id": 10079272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qxxpd.png?s=128&g=1", "display_name": "davmos", "link": "https://stackoverflow.com/users/10079272/davmos"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555542787, "post_id": 55736826, "comment_id": 98152163, "body": "@JohnBollinger, code updated."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1555545823, "post_id": 55736826, "comment_id": 98152712, "body": "and what exactly does it complain about?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1555549274, "post_id": 55736826, "comment_id": 98153344, "body": "You now have presented a complete and pretty minimal program, but it does not reproduce the error.  Valgrind does not detect any leaks in it, at least not for me."}], "owner": {"reputation": 103, "user_id": 10079272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qxxpd.png?s=128&g=1", "display_name": "davmos", "link": "https://stackoverflow.com/users/10079272/davmos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555543976, "creation_date": 1555540342, "last_edit_date": 1555543976, "question_id": 55736826, "link": "https://stackoverflow.com/questions/55736826/how-to-avoid-valgrind-or-other-memcheck-tools-misreporting-when-i-initialize-a", "title": "How to avoid valgrind (or other memcheck tools) misreporting when I initialize a struct which contain a dynamic array?", "body": "<p>I want to initialize a struct which contains a dynamic array, I wrote all this stuff in a function. And there is another function for cleaning this struct, theoretically, there will be no memory leaks. However, when I run the program with valgrind, it report that there was memory leaks when at the entry or init function. </p>\n\n<p>Firstly, I wrote this init function with malloc to allocate memory for this struct. It report memory leak.</p>\n\n<p>Then, I change malloc to realloc(NULL, ...) to avoid this misreport but I failed.</p>\n\n<p>I don't know what the standard way in C is to implement this function.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n\ntypedef enum\n{\n    RUN_SUCCESS,\n    /*Failure*/\n    RUN_FAILURE\n} RunStat;\n\ntypedef struct\n{\n    char *elements;\n    size_t top;\n    size_t size;\n} Stack;\n\nRunStat init_stack(Stack *stack)\n{\n    stack-&gt;elements = (char *)realloc(NULL, 100 * sizeof(char));\n    stack-&gt;size = 100;\n    stack-&gt;top = 0;\n    return RUN_SUCCESS;\n}\n\nRunStat free_stack(Stack *stack)\n{\n    free(stack-&gt;elements);\n    stack-&gt;elements = NULL;\n    stack-&gt;size = 0;\n    stack-&gt;top = 0;\n    return RUN_SUCCESS;\n}\n\n\nint main ()\n{\n    Stack stack;\n    init_stack(&amp;stack);\n    free_stack(&amp;stack);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Every memory here is under my control, I want to make this struct initialized without any memory leak warning. And I want to know the standard way to do that.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555540548, "post_id": 55736770, "comment_id": 98151628, "body": "There is no whole-array assignment in C."}, {"owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555540696, "post_id": 55736770, "comment_id": 98151668, "body": "I know; I wanted to assign a pointer to the whole array, not the whole array itself."}, {"owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555541297, "post_id": 55736770, "comment_id": 98151811, "body": "I changed the title to reflect this intent. How do I unmark it as a duplicate? I found the answer to this question and want to add it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555541342, "post_id": 55736770, "comment_id": 98151830, "body": "Apparently no, you don&#39;t know.  Whole arrays cannot be assigned to.  You cannot assign one array to another, and you certainly can&#39;t assign a pointer, which isn&#39;t even the correct type, to a whole array."}, {"owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555541902, "post_id": 55736770, "comment_id": 98151978, "body": "Again, that&#39;s not what I wanted to do. I wanted to assign the address of the array to the address of another array, as I updated the title and question to reflect. And I can do this, because I just did do this, as reflected in the answer I edited into my question. I simply want to add the answer to this as an answer, which will not work with the other question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555542049, "post_id": 55736770, "comment_id": 98152011, "body": "The error message you report and the code you present contradict your characterization of the situation.  You are trying to assign to an array.  That&#39;s what <code>dr_qf.loko = &amp;(dr[0][0]);</code> describes."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1555542535, "post_id": 55736770, "comment_id": 98152111, "body": "You seem to be confusing arrays and pointers -- they are not the same thing.  The statement &#39;assign the address of the array&#39; is nonsense.  You can only store an address in a pointer."}, {"owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "edited": false, "score": 0, "creation_date": 1555542843, "post_id": 55736770, "comment_id": 98152178, "body": "I didn&#39;t... quite realise that when I made the question. My intent was to assign the pointer of the array to a pointer of another array, but I didn&#39;t take into account the fact that putting an array in a struct puts an entire array in the struct, rather than just putting a pointer to an array in it. So yes, I was, but the intent of the question wasn&#39;t how to do that."}, {"owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "edited": false, "score": 0, "creation_date": 1555543074, "post_id": 55736770, "comment_id": 98152228, "body": "Chris Dodd: I thought arrays, used as input values, were technically pointers? Anyway, I&#39;m not exactly sure how to reflect this in the question. I fixed the error, and now I&#39;m not sure how to reflect that here..."}], "owner": {"reputation": 1, "user_id": 8027213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0RXk81Efyfw/AAAAAAAAAAI/AAAAAAAAAII/PKTFRD-ei_Y/photo.jpg?sz=128", "display_name": "happysmash27", "link": "https://stackoverflow.com/users/8027213/happysmash27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1555540429, "answer_count": 0, "score": 0, "last_activity_date": 1555549829, "creation_date": 1555539983, "last_edit_date": 1555541761, "question_id": 55736770, "link": "https://stackoverflow.com/questions/55736770/assigning-address-of-custom-typed-array-to-same-address-of-same-typed-array-in-s", "closed_reason": "Duplicate", "title": "Assigning address of custom-typed array to same address of same typed array in struct, get &quot;error: assignment to expression with array type&quot;", "body": "<p>I am trying to make an array mirror another array, of the same type, inside a struct, making sure that the arrays both point to the same address. </p>\n\n<p>What I tried initially: </p>\n\n<pre><code>duonrektoqf dr_qf;\ndr_qf.loko = dr[0];\n</code></pre>\n\n<p>What I later tried, after reading a bit about this issue</p>\n\n<pre><code>duonrektoqf dr_qf;\ndr_qf.loko = &amp;(dr[0][0]);\n</code></pre>\n\n<p>Both give the same <code>error: assignment to expression with array type</code></p>\n\n<p>Relevent data types: </p>\n\n<pre><code>typedef mpq_t vektoro[3];\ntypedef vektoro duonrektoqq[2];\ntypedef float vektorof[3];\n\ntypedef struct duonrektoqf {\n  vektoro loko;\n  vektorof vkt;\n} duonrektoqf;\n</code></pre>\n\n<p>Current assignment code: </p>\n\n<pre><code>duonrektoqf dr_qf;\ndr_qf.loko = &amp;(dr[0][0]);\ndr_qf.vkt[0] = (float) mpf_get_d(dr[1][0]);\ndr_qf.vkt[1] = (float) mpf_get_d(dr[1][1]);\ndr_qf.vkt[2] = (float) mpf_get_d(dr[1][2]);\n</code></pre>\n\n<p><code>duonrektoqq dr</code></p>\n\n<p>is a variable which is passed to the function. </p>\n\n<p>I expect <code>dr_qf.loko</code> to point to the same location as <code>dr[0]</code> and <code>dr[0][0]</code>. I expect that when I change, for example, <code>dr[0][0]</code> to 4/5, <code>dr_qf.loko[0]</code> will also be 4/5. I also expect that <code>dr_qf.loko</code> will not take up any more memory than is needed for a simple pointer, as the array already exists, and that I will not have to run the complicated gmp assignment functions to initialise an entirely new version of the array. This is a ray tracer, and I am already using a numbers library, so performance is very very important! </p>\n\n<p>I also expect the <code>dr_qf.vkt</code> numbers to be float versions of their mpq_t counterparts, which does not seem to be a problem. This is only relevant for context purposes. </p>\n\n<p>What actually happens with <code>dr_qf.loko</code>, is that I get the error <code>error: assignment to expression with array type</code>.</p>\n\n<p><code>strcmp</code>, like suggested in similar threads, will not work here, as this is not a string, and I don't want to copy the entire thing... </p>\n\n<p>Edit: tried <code>&amp;(dr_qf.loko) = &amp;(dr[0][0]);</code>, got <code>error: lvalue required as left operand of assignment</code>. </p>\n\n<p>Edit: I think this may be one of the few cases a pointer to an array actually makes sense. I'm going to try that; brb! </p>\n\n<p>Edit: Changing the type to a pointer to an array worked. Thank you! </p>\n\n<p>Edit: I can't figure out how to unmark this as a duplicate after I changed the title to reflect the intent (maybe I should have posted it as a new question? That would take a while though), so I will put the answer to this question here:</p>\n\n<p>Having dr_qf.loko be an array means that an array is actually stored in the struct dr_qf! We don't want that! Rather, we want a pointer to the array! </p>\n\n<p>Therefore, the type will be changed as follows: </p>\n\n<pre><code>typedef struct duonrektoqf {\n  vektoro *loko;\n  vektorof vkt;\n} duonrektoqf;\n</code></pre>\n\n<p>The assignment function, then, is changed to: </p>\n\n<pre><code>duonrektoqf dr_qf;\ndr_qf.loko = &amp;(dr[0]);\ndr_qf.vkt[0] = (float) mpf_get_d(dr[1][0]);\ndr_qf.vkt[1] = (float) mpf_get_d(dr[1][1]);\ndr_qf.vkt[2] = (float) mpf_get_d(dr[1][2]);\n</code></pre>\n\n<p>Anytime we want to access an element in dr_qf.loko, we will use a pointer to it, e.g:</p>\n\n<pre><code>mpq_set_si(*(dr-&gt;loko)[0], -1, 1);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1555536538, "post_id": 55736187, "comment_id": 98150556, "body": "Where do you declare <code>H</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1555536542, "post_id": 55736187, "comment_id": 98150557, "body": "<code>scanf(&quot;%s&quot;, &amp;H.name);</code> is a type error. <code>%s</code> takes a <code>char *</code>, not a <code>char **</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1555536580, "post_id": 55736187, "comment_id": 98150565, "body": "Why does your structure contain pointers? What is <code>H</code> and how did you initialize it?"}, {"owner": {"reputation": 1, "user_id": 11376080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42432f2e2de0f49d3289061b8111ff15?s=128&d=identicon&r=PG&f=1", "display_name": "Guitarman045", "link": "https://stackoverflow.com/users/11376080/guitarman045"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555536738, "post_id": 55736187, "comment_id": 98150618, "body": "@melpomene H is an instance of the structure, i declared it above this code globally but only included this section, I am using pointers because that is what the assignment asks me to put into the structure"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555536788, "post_id": 55736187, "comment_id": 98150634, "body": "How was <code>H</code> initialized?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1555536790, "post_id": 55736187, "comment_id": 98150635, "body": "<code>height</code> and <code>weight</code> should probably be <code>float</code> rather than <code>float*</code>. The other fields make sense as pointers."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555536855, "post_id": 55736187, "comment_id": 98150652, "body": "You have a structure of pointers. But <i>where do those pointers really point?</i>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1555536882, "post_id": 55736187, "comment_id": 98150659, "body": "Also welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1555537039, "post_id": 55736187, "comment_id": 98150715, "body": "Please edit your question to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In particular, you are missing the declaration for the variable named <code>H</code> which causes irrelevant compiler errors when I try to compile your code."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1555537045, "post_id": 55736317, "comment_id": 98150717, "body": "Calling <code>scanf</code> without checking its return value is a bug. Using <code>%s</code> (without a limit) is also a bug."}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 0, "last_activity_date": 1555536980, "creation_date": 1555536980, "answer_id": 55736317, "question_id": 55736187, "link": "https://stackoverflow.com/questions/55736187/how-to-print-pointer-variable-from-a-structure-in-c/55736317#55736317", "title": "How to print pointer variable from a structure in C?", "body": "<p>First of all, instead of declaring <code>float height;</code>, you need to declare <code>struct HealthProfile H;</code>. Better yet, declare <code>struct HealthProfile profile;</code> and replace <code>H</code> everywhere with <code>profile</code>.</p>\n\n<p>Next, fix your <code>scanf()</code> statements. For example</p>\n\n<pre><code>scanf(\"%s\", &amp;H.name);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>scanf(\"%s\", profile.name);\n</code></pre>\n\n<p>Similarly change</p>\n\n<pre><code>scanf(\"%f\", &amp;H.height);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>scanf(\"%f\", profile.height);\n</code></pre>\n\n<p>Now your syntax for <code>printf()</code> will be correct.</p>\n\n<p><strong>However, you will still have problems because non of your pointers have been allocated memory.</strong> Declaring the <code>name</code> and <code>last</code> fields as pointers makes sense. However, I think you should declare <code>float height;</code> and <code>float weight;</code> instead of using pointers for these values. If you do so, then your original <code>scanf()</code> statements with the <code>&amp;</code> operator will be correct.</p>\n"}], "owner": {"reputation": 1, "user_id": 11376080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42432f2e2de0f49d3289061b8111ff15?s=128&d=identicon&r=PG&f=1", "display_name": "Guitarman045", "link": "https://stackoverflow.com/users/11376080/guitarman045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555536980, "creation_date": 1555536275, "question_id": 55736187, "link": "https://stackoverflow.com/questions/55736187/how-to-print-pointer-variable-from-a-structure-in-c", "title": "How to print pointer variable from a structure in C?", "body": "<p>I need to print out a pointer variable within a structure.  I assume i must de-reference but am not sure how without getting a segmentation fault. </p>\n\n<pre><code>struct HealthProfile{ //structure with pointers to all needed variables.\n    char *name;\n    char *last;\n    char *gender;\n    struct date *dob;\n    float *height;\n    float *weight;\n};\n\nvoid readData(){\n    float height;\n    printf(\"What is your name?\\n\");\n    scanf(\"%s\", &amp;H.name); //scan\n    //H.name = name;\n    printf(\"What is your last name? \\n\");\n    scanf(\"%s\", &amp;H.last);\n    //H.last = last;\n    printf(\"What is your Height name? \\n\");\n    scanf(\"%f\", &amp;H.height);\n\n\n    printf(\"Height: %f\\n\", *(H.height));\n    //printf(\"First Name: %s\\n\", H-&gt;name);\n    //printf(\"Last Name: %s\\n\", H-&gt;last);\n}\n</code></pre>\n\n<p>I want it to print out the scanned in height which is a float.</p>\n"}, {"tags": ["c", "local-storage"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1555536159, "post_id": 55736148, "comment_id": 98150400, "body": "Yes, it&#39;s fine."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555536619, "post_id": 55736148, "comment_id": 98150578, "body": "All that matters is that you use the pointer within the lifetime of whatever it points to. How you pass the pointer between functions is irrelevant."}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1555537317, "post_id": 55736148, "comment_id": 98150814, "body": "It would probably be clearer if you just did <code>return &amp;something_non-local;</code> but I can understand why that might be impossible."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1555540042, "post_id": 55736148, "comment_id": 98151516, "body": "&quot; This should be ok yes?&quot; No,  when pointer is invalid, assigning it, printing it, doing anything with it is UB."}, {"owner": {"reputation": 117, "user_id": 1160866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26929c17f57cc8d87c5a477df963cdab?s=128&d=identicon&r=PG", "display_name": "user1160866", "link": "https://stackoverflow.com/users/1160866/user1160866"}, "edited": false, "score": 0, "creation_date": 1555542414, "post_id": 55736148, "comment_id": 98152090, "body": "chux - could you clarify? The previous two people thought it was ok.  Are you suggesting the pointer is invalid somehow?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 1160866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26929c17f57cc8d87c5a477df963cdab?s=128&d=identicon&r=PG", "display_name": "user1160866", "link": "https://stackoverflow.com/users/1160866/user1160866"}, "edited": false, "score": 0, "creation_date": 1555552654, "post_id": 55737740, "comment_id": 98153857, "body": "Thanks for the very thoughtful answer.  It is as I thought but I wasn\u2019t confident.  My example is contrived.  The real code is quite a bit more complicated.  I\u2019m returning a pointer that I copy from a structure that gets freed in this subroutine.  Basically saving the value before the variable that holds it is gone.  The location the pointer references is on the heap."}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 1, "last_activity_date": 1555548475, "creation_date": 1555548475, "answer_id": 55737740, "question_id": 55736148, "link": "https://stackoverflow.com/questions/55736148/clarification-about-return-values-and-variable-lifetime/55737740#55737740", "title": "Clarification about return values and variable lifetime", "body": "<p>You can look at it this way. A variable represents a place in memory. Lifetime of a variable is defined by validity of this place in memory. The place in memory keeps a value. Any copy operation just copies values from one place in memory to another. </p>\n\n<p>Every such memory place has an address. A pointer to a variable is just another variable which value is an address of another variable. A copy of a pointer is just a copy of an address from one place to another.</p>\n\n<p>If a variable is declared in the global scope, than its memory will be valid till the exit of the program. If the variable is declared non-statically in a procedure, then its memory is valid till the end of this procedure. Technically it is probably allocated on stack which gets unallocated when the procedure returns, making this memory not valid.</p>\n\n<p>In your case <strong>if</strong> pointer <code>x</code> points to a variable from a global scope, the variable itself is valid until the exit from the procedure. However, the return statement copies the value from the <code>x</code> into a different location just before the latter becomes invalid. As a result the value of <code>x</code> will end up in <code>bar</code>. This value is the address of a static variable which is still valid.</p>\n\n<p>There would be  a different story if you try to return the address of <code>x</code>, i.e. <code>&amp;x</code>. This would be an address of memory which existed inside of the procedure. After return it will point to an invalid memory location. </p>\n\n<p>So, if your <code>something_non-local</code> points to such a thing, than you are in trouble. It should point to something static or something in heap.</p>\n\n<p>BTW, <code>malloc</code> allocates a memory in heap which is valid till you use <code>free</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 1160866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26929c17f57cc8d87c5a477df963cdab?s=128&d=identicon&r=PG", "display_name": "user1160866", "link": "https://stackoverflow.com/users/1160866/user1160866"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55737740, "answer_count": 1, "score": 1, "last_activity_date": 1555548475, "creation_date": 1555536077, "question_id": 55736148, "link": "https://stackoverflow.com/questions/55736148/clarification-about-return-values-and-variable-lifetime", "title": "Clarification about return values and variable lifetime", "body": "<p>My question is about returning a value from a function call in c. I've read many questions and answers on this topic such as:\n<a href=\"https://stackoverflow.com/questions/43350851/returning-a-local-variable-confusion-in-c\">Returning a local variable confusion in C</a></p>\n\n<p>I also understand that returning a pointer to a local variable is a problem since the local variable has <del>no</del> <i>limited</i> lifetime after the return.  In my case below I am returning a pointer <strong>value</strong> not a pointer to a local variable.  This should be ok yes? (i.e. returning &amp;x would be bad)</p>\n\n<pre><code>int *foo(int a) {\n    int *x;  //local scope local lifetime\n    ...\n    x = &amp;something_non-local;\n    ...\n    return x;  //return value of pointer\n}\nint main(void) {\n    int *bar;\n    bar = foo(10);\n}\n</code></pre>\n"}, {"tags": ["c", "performance"], "answers": [{"comments": [{"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555537351, "post_id": 55736282, "comment_id": 98150824, "body": "But how do i actually implement this?For the record I use Windows and Visual Studio 2017 as IDE."}, {"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "reply_to_user": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555537506, "post_id": 55736282, "comment_id": 98150872, "body": "Perhaps try this example on Windows <a href=\"https://support.microsoft.com/en-us/help/815668/how-to-use-the-queryperformancecounter-function-to-time-code-in-visual\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/815668/&hellip;</a>"}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 2, "last_activity_date": 1555536799, "creation_date": 1555536799, "answer_id": 55736282, "question_id": 55736136, "link": "https://stackoverflow.com/questions/55736136/what-is-the-best-most-efficient-way-to-measure-time-when-running-a-program-in-c/55736282#55736282", "title": "What is the best/most efficient way to measure time when running a program in C?", "body": "<p>Perhaps try a higher resolution timer which may be available on your platform:</p>\n\n<pre><code>Linux: clock_gettime(CLOCK_REALTIME, &amp;timeSpec)\nWindows: QueryPerformanceCounter(&amp;performanceCount)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555590050, "post_id": 55736496, "comment_id": 98168562, "body": "I tried your solution,but I realized that it doesn&#39;t work quite how I expected.For sure,it does record the running time of my program more accurately,however I don&#39;t know how to exactly implement this such that a single data input is generated randomly and then printing the output one single time for that particular input."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555595838, "post_id": 55736496, "comment_id": 98172099, "body": "@Neri-kun If the point is to measure the time needed for your calculation, then you can repeat the calculation with the same input and leave the output until after the loop \u2014 you&#39;re probably not interested in how long <code>printf</code> takes, and including it will only distort the measurement of the calculation. If you really want to measure an average run time with different inputs, then generate random inputs and put them in an array before the loop, and then read them from the array with <code>i</code> as the index."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555596024, "post_id": 55736496, "comment_id": 98172209, "body": "You can obviously get as fancy as you like when you&#39;re measuring your code, but that&#39;s getting into a different question than what you seem to have asked about. The point of running the same code in a loop with the same input is just to multiply the execution time so that you can minimize the effect of inaccuracy due to your clock, system interrupts, etc."}, {"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555612760, "post_id": 55736496, "comment_id": 98180527, "body": "I also forgot to ask you one more thing regarding your solution.Why did you choose a constant integer of 10000?Does it represent a certain number of milliseconds or seconds?"}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555614172, "post_id": 55736496, "comment_id": 98181118, "body": "No particular reason for that number -- it&#39;s just big round number, and it&#39;s easy to do the math in your head. But if you like 9,731 better, use that. Or if you decide that 1,000 reps sufficiently minimizes the error in your measurement, that&#39;s fine too."}], "tags": [], "owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "is_accepted": false, "score": 3, "last_activity_date": 1555538030, "creation_date": 1555538030, "answer_id": 55736496, "question_id": 55736136, "link": "https://stackoverflow.com/questions/55736136/what-is-the-best-most-efficient-way-to-measure-time-when-running-a-program-in-c/55736496#55736496", "title": "What is the best/most efficient way to measure time when running a program in C?", "body": "<blockquote>\n  <p>Is there any method to improve this?</p>\n</blockquote>\n\n<p>If you don't have a better timer, as suggested in jspcal's answer, then another solution is to repeat the same operation a large number of times and then divide the elapsed time by the number of repetitions:</p>\n\n<pre><code>const int REPS = 10000;\nclock_t tStart = clock(),tEnd;\nfor (int i = 0; i &lt; REPS; i++) {\n    // do your work here\n}\ntEnd = clock();\ndouble time = (double)(tEnd - tStart)/REPS;\nprintf(\"Time taken: %.6fs\\n\", time / CLOCKS_PER_SEC);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555589111, "post_id": 55736623, "comment_id": 98168068, "body": "Sounds interesting,however I don&#39;t have UNIX as OS on my laptop."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 1, "last_activity_date": 1555538889, "creation_date": 1555538889, "answer_id": 55736623, "question_id": 55736136, "link": "https://stackoverflow.com/questions/55736136/what-is-the-best-most-efficient-way-to-measure-time-when-running-a-program-in-c/55736623#55736623", "title": "What is the best/most efficient way to measure time when running a program in C?", "body": "<p>In unix,use<code>time</code> , which forks&amp;execs the program, and does a <code>get_rusage()</code> after the child exited.</p>\n\n<p>So, you don't have to instrument the program itself.</p>\n\n<hr>\n\n<pre><code>plasser@pisbak:$ time ./a.out omg.dat \n\nreal    0m10.276s\nuser    0m9.986s\nsys 0m0.291s\nplasser@pisbak:$ \n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555538889, "creation_date": 1555536034, "question_id": 55736136, "link": "https://stackoverflow.com/questions/55736136/what-is-the-best-most-efficient-way-to-measure-time-when-running-a-program-in-c", "title": "What is the best/most efficient way to measure time when running a program in C?", "body": "<p>How can i record the running time of my program every time I insert an input?I tried this particular method:</p>\n\n<pre><code>clock_t tStart = clock(),tEnd;\n</code></pre>\n\n<p>And after printing the ouput:</p>\n\n<pre><code>tEnd = clock();\nprintf(\"Time taken: %.6fs\\n\", (double)(tEnd - tStart) / CLOCKS_PER_SEC);\n</code></pre>\n\n<p>However,I sometimes end up having just a bunch of 0s when calculating the miliseconds.Is there any method to improve this?</p>\n"}, {"tags": ["c", "queue"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1555535961, "post_id": 55736068, "comment_id": 98150311, "body": "<code>a</code> has local scope.  You&#39;re gonna be in trouble when you try to use it after returning from the function."}, {"owner": {"reputation": 25, "user_id": 9406072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c22ca017a94597165a81e7554f1c3ba1?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/9406072/shubham"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555536168, "post_id": 55736068, "comment_id": 98150406, "body": "Then why does it print correctly the first time?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1555536233, "post_id": 55736068, "comment_id": 98150444, "body": "Because it is undefied behaviour and by incident that location in memory was not overwritten by something else yet."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1555536373, "post_id": 55736068, "comment_id": 98150490, "body": "@Shubham btw it is a very basic C knowledge - you need to read about the variable scopes"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1555536475, "post_id": 55736068, "comment_id": 98150533, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13888268/what-happens-when-a-variable-goes-out-of-scope\">What happens when a variable goes out of scope?</a>"}, {"owner": {"reputation": 25, "user_id": 9406072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c22ca017a94597165a81e7554f1c3ba1?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/9406072/shubham"}, "edited": false, "score": 0, "creation_date": 1555536692, "post_id": 55736068, "comment_id": 98150602, "body": "Actually, I do know about scopes. I was just confused as to why is it printing correct one time and incorrect the next time."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555537825, "post_id": 55736068, "comment_id": 98150955, "body": "@ChristianGibbons do you mean &quot;lifetime&quot; instead of &quot;scope&quot;? A variable can very well be read/written to from outside it&#39;s scope as long as it is alive"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1555536143, "creation_date": 1555536143, "answer_id": 55736161, "question_id": 55736068, "link": "https://stackoverflow.com/questions/55736068/how-to-implement-enque-function-without-using-the-inbuilt-malloc-function/55736161#55736161", "title": "How to implement enque function without using the inbuilt malloc function?", "body": "<p>Your program has the UB. This method will not work. If you do not want to use malloc you need to have a global pool of nodes.</p>\n"}, {"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1555548493, "creation_date": 1555548493, "answer_id": 55737742, "question_id": 55736068, "link": "https://stackoverflow.com/questions/55736068/how-to-implement-enque-function-without-using-the-inbuilt-malloc-function/55737742#55737742", "title": "How to implement enque function without using the inbuilt malloc function?", "body": "<p><code>a</code> is a local variable, so the variable <code>a</code> is destroyed when the function <code>enque</code> finishes.</p>\n\n<p>Now, in C and C++, \"destroyed\" doesn't <em>necessarily</em> mean that the data isn't at that address any more. It does mean that the data <em>might</em> not be at that address any more because the address can be reused for other purposes at any time. You can't expect it to still be there. </p>\n\n<p>In practice, <em>if you aren't using optimization</em>, what is <em>most likely</em> to happen is that the space where <code>enque</code>'s local variables were stored will get reused by the next function call. There is no function call in between <code>enque</code> returning and reading <code>(&amp;q)-&gt;front-&gt;data</code> (<code>printf</code> isn't called until after the value is accessed), so the value of 11 is still at that location. Then <code>printf</code> has called, and <code>printf</code> has some local variables that get stored in the same memory location where <code>enque</code>'s local variables used to be. So the second time you read <code>(&amp;q)-&gt;front-&gt;data</code> you are reading one of the local variables from the last printf call, instead of one of the local variables from <code>enque</code>.</p>\n\n<p>Note: <em>This is not reliable at all</em> - you might get different results if you use a different compiler, a different version of the same compiler, a different version of your operating system, a different version of a library, if you turn on optimization, or if the planets aren't aligned properly. It could conceivably give you 11 both times, garbage values both times, crash, or even stranger things (i. That's why this is called <em>undefined behaviour</em> - literally meaning \"the computer might do anything\" - and you should avoid it. (You might think that the worst thing that could happen is that you get a garbage value, but when optimizers get involved they tend to be confused by stuff like this)</p>\n"}], "owner": {"reputation": 25, "user_id": 9406072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c22ca017a94597165a81e7554f1c3ba1?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/9406072/shubham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555548493, "creation_date": 1555535707, "question_id": 55736068, "link": "https://stackoverflow.com/questions/55736068/how-to-implement-enque-function-without-using-the-inbuilt-malloc-function", "title": "How to implement enque function without using the inbuilt malloc function?", "body": "<p>The enque function in queue (using linked data structure) is generally used with malloc() function. However , I am trying to implement it little differrntly by avoiding the use of malloc() as follows.</p>\n\n<p>I am printing the value of what holds in the rear twice.\nIt prints the correct value for the first time, however, it gives a garbage value the second time.</p>\n\n<pre><code> void enque(queue* qp, int x) // queue is a struct that holds front and rear node address\n{\n  queueNode a;  // queueNode is a struct with data and next pointer\n  a.data = x;\n  a.next = NULL;\n\n  if(isEmpty(qp))\n  {\n    qp-&gt;front = &amp;a;\n    qp-&gt;rear = &amp;a;\n  }\n  else\n  {\n    qp-&gt;rear-&gt;next = &amp;a;\n    qp-&gt;rear = qp-&gt;rear-&gt;next;\n  }\n}\n</code></pre>\n\n<p>The main function</p>\n\n<pre><code>int main()\n{\n queue q;\n int c;\n initialize(&amp;q);\n\n enque(&amp;q, 11);\n\n printf(\"\\n %d\",(&amp;q)-&gt;front-&gt;data);\n printf(\"\\n %d\",(&amp;q)-&gt;front-&gt;data);\n\n return 0;\n}\n</code></pre>\n\n<p>The output is as follows : </p>\n\n<p>11</p>\n\n<p>some garbage value</p>\n\n<p>Why does it print the garbage value the second time and not 11?</p>\n"}, {"tags": ["c", "string", "position"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1555535678, "post_id": 55735980, "comment_id": 98150200, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What is <code>d</code>? Variables <code>n</code>, <code>j</code>, and <code>k</code> are local variables inside <code>task</code>, and <code>maus</code> doesn&#39;t seem to be used."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1555535702, "post_id": 55735980, "comment_id": 98150209, "body": "That&#39;s not your only problem <a href=\"https://en.cppreference.com/w/c/string/byte/strcpy\" rel=\"nofollow noreferrer\"><code>strcpy</code></a> has undefined behavior if source and target string buffers overlap (and yours clearly do). I also find the calculations to eventually set <code>n</code> (and for that matter <code>i,j,k</code>) pointless in <code>task</code>, since those variables are all local to the function and have absolutely no bearing on any global variables of the same name."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1555535837, "post_id": 55735980, "comment_id": 98150273, "body": "Never <b><i>ever</i></b> use <code>gets</code>! It&#39;s a <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">dangerous</a> function which have even been removed from the C specification. Use e.g. <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead (but be aware of its semantic differences from <code>gets</code>)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555535891, "post_id": 55735980, "comment_id": 98150291, "body": "As for your problem, this seems like a very good time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555535994, "post_id": 55735980, "comment_id": 98150329, "body": "Oh and you seem to be using global variables. Don&#39;t do that. Not even for small simple programs like this."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1555536913, "creation_date": 1555536913, "answer_id": 55736305, "question_id": 55735980, "link": "https://stackoverflow.com/questions/55735980/delete-text-in-parentheses-from-a-string/55736305#55736305", "title": "Delete text in parentheses from a string?", "body": "<p>Your program does not compile, you suppose you can access in <em>main</em> of local variable <em>j</em> of <em>task</em>, <em>d</em> is unknown etc, and you use <em>strcpy</em> while source and destination may overlap and deprecated <em>gets</em></p>\n\n<p>A proposal using <em>strchr</em>, <em>strrchr</em> and <em>memmove</em> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  puts(\"Text : \");\n\n  char s[256];\n\n  if (fgets(s, sizeof(s), stdin) == NULL)\n    return -1;\n\n  /* may be remove \\n from s */\n\n  char * p1 = strchr(s, '(');\n\n  if (p1 == NULL)\n    fprintf(stderr, \"'(' is missing\\n\");\n  else {\n    char * p2 = strrchr(p1+1, ')');\n\n    if (p2 == NULL)\n      fprintf(stderr, \"')' is missing\\n\");\n    else {\n      memmove(p1, p2 + 1, strlen(p2 + 1) + 1);\n      puts(s);\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall -Wextra p.c\npi@raspberrypi:/tmp $ ./a.out\nText : \naze(qsd)wxc\nazewxc\n</code></pre>\n\n<p>Note all between the first '(' and last ')' is removed even there are more than one '(' or ')' :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ ./a.out\nText : \naze((qsd)wxc\nazewxc\n\npi@raspberrypi:/tmp $ ./a.out\nText : \naze(qsd)iop)wxc\nazewxc\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11231584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b1ca32ce10db34e2bab4ae1f590bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy", "link": "https://stackoverflow.com/users/11231584/zippy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55736305, "answer_count": 1, "score": 0, "last_activity_date": 1555568306, "creation_date": 1555535239, "last_edit_date": 1555568306, "question_id": 55735980, "link": "https://stackoverflow.com/questions/55735980/delete-text-in-parentheses-from-a-string", "title": "Delete text in parentheses from a string?", "body": "<p>My task is to find and delete text in parentheses from string. My idea is to count the position of first '(' and last ')' and afterwards delete d characters from '(' position, problem is, position of '(' and ')' is replaced by 0 if there is something actually in the parentheses.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nvoid task(char *s)\n{\n    int i,d;\n    int j=0;  //position of first '('\n    int k=0; //add 1 for every character in parentheses until reach ')'\n    for(i=0; i&lt;strlen(s); i++)\n    {   \n        if(s[i]=='(')\n        {\n        j=i;\n        }\n            else{\n            if(s[i]==')') \n            k=i;\n            printf(\"k=%d \\n\",k);\n            }\n\n    }\n    d=(k-j-1);\n}\nvoid deleteptext(char *x,int a, int b)\n{\n    if((a+b-1)&lt;=strlen(x))\n    {\n        strcpy(&amp;x[b-1],&amp;x[a+b-1]);\n        puts(x);\n    }\n}\nint main()\n{\n    puts(\"Text: \");\n    gets(s);\n    task(s);\n    deleteptext(s,j,d);\n}   \n</code></pre>\n\n<p>For example, if my input is <code>abc (def)</code>, output is the same(need <code>abc</code>), 'j' value at one point is  4, but it is returned to 0 as it comes across \"d\".</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555532706, "post_id": 55735329, "comment_id": 98149171, "body": "What is <code>allocbuf</code> supposed to be? An array of strings? Will the strings have a fixed static (at compile-time) size? Or will they need to be dynamically allocated?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555532759, "post_id": 55735329, "comment_id": 98149190, "body": "Also, your <code>MakeString</code> function doesn&#39;t &quot;make&quot; a string. And it doesn&#39;t return anything that can be used as a string either. And I really don&#39;t see the need for all that pointer arithmetic either, what&#39;s wrong with a simple index that&#39;s compared to <code>SIZE</code>?"}, {"owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555533471, "post_id": 55735329, "comment_id": 98149447, "body": "Our lecture force us use pointers. I know it unnecessary.... My function Not good also \\: The strings not static BUT dynamically allocated. Must not use [][] ONLY USE POINTERS. @Some programmer dude"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555533581, "post_id": 55735329, "comment_id": 98149487, "body": "So then <code>allocbuf</code> should be an array of <i>pointers</i> really? And your <code>MakeString</code> function needs to allocate the correct size (not forgetting the string null-terminator) and then return the pointer?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1555533736, "post_id": 55735329, "comment_id": 98149550, "body": "The only times you can use <code>[]</code> in an array declaration is in a function parameter or when declaring an array with an initialization list (the size comes from the number of items in the list)."}, {"owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555533855, "post_id": 55735329, "comment_id": 98149607, "body": "You right only in the declaration of function of function parameter you can use [][] to initialization list @Barmar"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555534115, "post_id": 55735329, "comment_id": 98149699, "body": "What is the part talking about voters all about? What does that have to do with this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555534149, "post_id": 55735329, "comment_id": 98149712, "body": "What does this mean: <b>Whatever it takes, and will not stay in the same location all the time.</b>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555534289, "post_id": 55735329, "comment_id": 98149759, "body": "You need to use <code>malloc()</code> in the function to allocate space for the string. It should be <code>SIZE * (SIZE+1)</code> bytes long. This allows space for the space character between the words and a null byte at the end."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555534529, "post_id": 55735329, "comment_id": 98149841, "body": "Also (and something you should have done from the start), please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that replicates the problem you have. Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555933402, "post_id": 55735908, "comment_id": 98256558, "body": "Thanks (: How can i change it get from user matrix? Does declaration of char allocbuf is on main Or in method MakeString() @Barmar?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555950154, "post_id": 55735908, "comment_id": 98264020, "body": "It&#39;s a global variable, just like you wrote in the question."}, {"owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555960191, "post_id": 55735908, "comment_id": 98268485, "body": "I put the char allocbuf above the method in the file.c but it not print anything via main.. and I changed it get values char **smallMat \\:  I will update all up. Thanks @Barmar"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555960281, "post_id": 55735908, "comment_id": 98268513, "body": "Don&#39;t remove your original code when you update the question, add this new code as an addition at the bottom."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555534906, "creation_date": 1555534906, "answer_id": 55735908, "question_id": 55735329, "link": "https://stackoverflow.com/questions/55735329/c-function-returns-a-pointer-to-a-string-from-char-matrix-only-use-pointers/55735908#55735908", "title": "C - function returns a pointer to a string from char matrix ONLY use pointers", "body": "<p>You need to specify the size of <code>allocbuf</code> so it can hold the entire result:</p>\n\n<pre><code>char allocbuf[SIZE * (SIZE + 1)];\n</code></pre>\n\n<p>There's no need for <code>allocp</code>, because the array name will decay to a pointer when used in calculations. In <code>MakeString</code>, you need to loop over the rows and characters of <code>matrix</code>, copying them to <code>allocbuf</code>.</p>\n\n<pre><code>char *MakeString()\n    for (int i = 0; i &lt; SIZE; i++) {\n        memcpy(allocbuf + i * SIZE, matrix + i, SIZE);\n        if (i &lt; SIZE - 1) {\n            // write space between rows\n            *(allocbuf + i * SIZE + SIZE) = ' ';\n        } else {\n            // write null at end\n            *(allocbuf + i * SIZE + SIZE) = 0;\n        }\n    }\n    return allocbuf;\n}\n</code></pre>\n\n<p>The instructions don't mention the <code>n</code> argument to <code>MakeString()</code>, so I removed it.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555928832, "post_id": 55737378, "comment_id": 98254869, "body": "Thanks (: I tried in my linux eclipse... Not work /: Any idea? @David C. Rankin"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "edited": false, "score": 0, "creation_date": 1555945553, "post_id": 55737378, "comment_id": 98262016, "body": "You have an eclipse problem. What compiler is eclipse using? MinGW? VS (<code>cl.exe</code>)? Do you have a <i>Developer Command Prompt</i> or <i>MinGW Msys</i> shell? Let me know and I&#39;ll show you how to compile it from the command line (which you should be doing anyway -- that way you would know what to tell eclipse to do....)"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1555545164, "last_edit_date": 1555545164, "creation_date": 1555544771, "answer_id": 55737378, "question_id": 55735329, "link": "https://stackoverflow.com/questions/55735329/c-function-returns-a-pointer-to-a-string-from-char-matrix-only-use-pointers/55737378#55737378", "title": "C - function returns a pointer to a string from char matrix ONLY use pointers", "body": "<p>If I understand your question, you want write a function to read the characters from <code>matrix</code> (a 2D array of <code>char</code>) into an allocated string placing a space between each rows worth of characters and returning the <em>nul-terminated</em> string back to the calling function. You need to do this using pointers and without array <code>[index]</code> notation.</p>\n\n<p>To begin, your declaration of <code>matrix</code> is wrong. <code>E</code> isn't a character, it is a variable. <code>'E'</code> is a character literal. (note the single-quotes) So a proper declaration of <code>matrix</code> would be:</p>\n\n<pre><code>    char matrix[SIZE][SIZE] = { {'U','N','T','E'},  /* don't use globals   */\n                                {'C','P','G','X'},  /* declare in main and */\n                                {'D','L','A','B'},  /* pass as a parameter */\n                                {'J','T','N','N'} };\n</code></pre>\n\n<p>(<strong>note:</strong> simply <code>char matrix[][SIZE] = {{...}};</code> is sufficient, where the number of rows will be sized based on your initialization)</p>\n\n<p>As noted in the comment, avoid the use of <em>global</em> variables unless absolutely necessary. (very limited cases -- not here). Instead, declare <code>matrix</code> in the scope where it is required and pass <code>matrix</code> as a parameter to any function that needs to process the data. By contrast, defining is constant with <code>#define</code> is perfectly correct, and you should define constants as needed to avoid using <em>magic-numbers</em> in your code.</p>\n\n<p>Since <code>matrix</code> is a 2D array, to pass it as a parameter, you must include the number of columns as part of the parameter passed. You can either declare the parameter as <code>char matrix[SIZE][SIZE]</code> or equivalently as <code>char (*matrix)[SIZE]</code> reflecting the fact that the first level of indirection is converted to a pointer to the first element on access. See: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a> (paying attention to the 4-exceptions)</p>\n\n<p>Within your <code>makestring()</code> function you must allocate storage of at least <code>SIZE * SIZE + SIZE</code> (space for each character + 3 spaces + the <em>nul-terminating</em> character). Assigning the starting address of your new block of memory to a pointer, and then creating a second pointer to the block will allow you to iterate over it, copying characters to it -- while preserving a pointer to the beginning.</p>\n\n<p>Putting those pieces together, you could do something similar to:</p>\n\n<pre><code>char *makestring (char (*a)[SIZE])\n{\n    char *str = malloc (SIZE * SIZE + SIZE), *p = str;  /* allocate */\n    if (!str) {                         /* validate EVERY allocation */\n        perror (\"malloc-str\");\n        return NULL;\n    }\n    for (int i = 0; i &lt; SIZE; i++) {    /* for each row   */\n        if (i)                          /* if row not 1st */\n            *p++ = ' ';                 /*    add space   */\n        for (int j = 0; j &lt; SIZE; j++)  /* for each char  */\n            *p++ = *(*(a + i) + j);     /*    copy to str */\n    }\n    *p = 0;         /* nul-terminate string */\n\n    return str;     /* return pointer to allocated string */\n}\n</code></pre>\n\n<p>(<strong>note:</strong> while not an error, C generally avoids the use of <code>camelCase</code> or <code>MixedCase</code> variable names in favor of all <em>lower-case</em> while reserving <em>upper-case</em> names for use with macros and constants.)</p>\n\n<p>Putting it altogether in a short example, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 4\n\nchar *makestring (char (*a)[SIZE])\n{\n    char *str = malloc (SIZE * SIZE + SIZE), *p = str;  /* allocate */\n    if (!str) {                         /* validate EVERY allocation */\n        perror (\"malloc-str\");\n        return NULL;\n    }\n    for (int i = 0; i &lt; SIZE; i++) {    /* for each row   */\n        if (i)                          /* if row not 1st */\n            *p++ = ' ';                 /*    add space   */\n        for (int j = 0; j &lt; SIZE; j++)  /* for each char  */\n            *p++ = *(*(a + i) + j);     /*    copy to str */\n    }\n    *p = 0;         /* nul-terminate string */\n\n    return str;     /* return pointer to allocated string */\n}\n\nint main (void) {\n\n    char matrix[SIZE][SIZE] = { {'U','N','T','E'},  /* don't use globals   */\n                                {'C','P','G','X'},  /* declare in main and */\n                                {'D','L','A','B'},  /* pass as a parameter */\n                                {'J','T','N','N'} },\n        *str;\n\n    if ((str = makestring (matrix))) {  /* validate call to makestring */\n        printf (\"str: '%s'\\n\", str);    /* output string */\n        free (str);                     /* free allocated memory */\n    }\n}\n</code></pre>\n\n<p>(<strong>note:</strong> don't forget to <code>free</code> the memory you allocate. While it will be freed on program exit, get in the habit of tracking your allocations and ensuring all blocks you allocate are freed)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/makestring\nstr: 'UNTE CPGX DLAB JTNN'\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/makestring\n==6576== Memcheck, a memory error detector\n==6576== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==6576== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==6576== Command: ./bin/makestring\n==6576==\nstr: 'UNTE CPGX DLAB JTNN'\n==6576==\n==6576== HEAP SUMMARY:\n==6576==     in use at exit: 0 bytes in 0 blocks\n==6576==   total heap usage: 1 allocs, 1 frees, 20 bytes allocated\n==6576==\n==6576== All heap blocks were freed -- no leaks are possible\n==6576==\n==6576== For counts of detected and suppressed errors, rerun with: -v\n==6576== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 29, "user_id": 10820475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106536932849120/picture?type=large", "display_name": "Linor Ben Yossef", "link": "https://stackoverflow.com/users/10820475/linor-ben-yossef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555545164, "creation_date": 1555532045, "last_edit_date": 1555534084, "question_id": 55735329, "link": "https://stackoverflow.com/questions/55735329/c-function-returns-a-pointer-to-a-string-from-char-matrix-only-use-pointers", "title": "C - function returns a pointer to a string from char matrix ONLY use pointers", "body": "<p>I need to write a function called MakeString. The function returns a pointer to a string, which contains one word composed of each row of the small matrix in order, so that each line break will be expressed\nas a single space between the words In the string. (After the last word there will be no space.)</p>\n\n<p>Inference: In the function there is no use of [], but executes by working with pointers.</p>\n\n<p>Function. In addition, trips should be carried out with the voters, meaning that they will actually move to vote for each other</p>\n\n<p>Whatever it takes, and will not stay in the same location all the time.\n The 'answer' that the function returns, which is a pointer, will be input into a pointer in MAIN.</p>\n\n<p>I tried to do the function, but It NOT like instruction and not good...</p>\n\n<pre><code>#define SIZE 4\nstatic char allocbuf[SIZE][];\nstatic char *allocp = allocbuf;\n\nchar matrix[SIZE][SIZE]\n{\n    {U,N,T,E},\n    {C,P,G,X},\n    {D,L,A,B},\n    {J,T,N,N}\n};\nchar MakeString(int n)  /*return pointer to n charachters*/\n{\n    if (allocbuf + SIZE - allocp &gt;=n)\n    {\n        allocp += n;\n        return  allocp - n;\n    }\n    else\n        return 0;\n}\n</code></pre>\n\n<p>For example:</p>\n\n<p>Small matrix:</p>\n\n<pre><code>U N T E\n\nC P G X\n\nD L A B\n\nJ T N N\n\npStr = UNTE CPGX DLAB JTNN\n</code></pre>\n\n<p>Thanks (:</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1555530951, "post_id": 55735035, "comment_id": 98148466, "body": "Is there an issue here? Please <b>edit your question</b> using the <code>edit</code> button just below the tags and tell us what the problem is. Thanks."}, {"owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "edited": false, "score": 0, "creation_date": 1555531056, "post_id": 55735035, "comment_id": 98148520, "body": "Would &quot;visitor&quot; pattern be used? Instead of returning found paths, to pass paths to a callback one by one, then callback could count until 8"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1555531244, "post_id": 55735035, "comment_id": 98148598, "body": "Note:your path/len/slash logic can be done before the loop."}], "owner": {"reputation": 11, "user_id": 11045056, "user_type": "registered", "profile_image": "https://graph.facebook.com/2209323952639123/picture?type=large", "display_name": "Seth Kruse", "link": "https://stackoverflow.com/users/11045056/seth-kruse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555530904, "creation_date": 1555530720, "last_edit_date": 1555530904, "question_id": 55735035, "link": "https://stackoverflow.com/questions/55735035/search-function-that-shows-8-results-at-a-time-in-c", "title": "Search Function that Shows 8 results at a time in C", "body": "<p>Im setting up a Recursive Search Function that i want displays the first 8 Results then (when chosen) shows the next 8 Results</p>\n\n<p>Heres my Search Function</p>\n\n<pre><code>static int Search(char *path, const char *file) {\n    DIR *dir;\n\n\n    char *slash = \"/\";\n\n    int ret = 1;\n\n    struct dirent *entry;\n\n    if ((dir = opendir(path)) == NULL) {\n        return EXIT_FAILURE;\n    } \n\n    while ((entry = readdir(dir))) {\n\n\n\n        if (strcmp(entry-&gt;d_name, \".\") == 0 || strcmp(entry-&gt;d_name, \"..\") == 0)\n            continue;\n\n        //we check if the path has already a / if not we add one\n\n        int length = strlen(path);\n\n        if (path[length - 1] != '/') {\n            slash = \"/\";\n        }\n\n        length += strlen(entry-&gt;d_name) + 2;\n        char *newpath = malloc(length);\n        if (!newpath) {\n            break;\n        }\n\n        snprintf(newpath, length, \"%s%s%s\", path, slash, entry-&gt;d_name);\n\n        if (strcmp(entry-&gt;d_name, file) == 0) {\n            printf(\"Was found here %s Search Successful\\n\", newpath);\n\n/* Entries here Show Only 8 First 8 then later show the Next 8 results*/\n\n            ret = EXIT_SUCCESS;\n            break;\n        }\n\n        if (entry-&gt;d_type == DT_DIR)\n            Search(newpath, file);\n        else {\n            free(newpath);\n            continue;\n        }\n\n        free(newpath);\n    }\n    if (closedir(dir) != 0) {\n        return EXIT_FAILURE;\n    }\n\n    return ret;\n\n}\n</code></pre>\n"}, {"tags": ["c", "embed"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1555534363, "post_id": 55734963, "comment_id": 98149785, "body": "C does no have any event bus or other such container.   I can see no alternative to the user  providing function pointers to essential services and/or OS interfaces for queue management, e.g. mutex, semaphore etc."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1555539531, "post_id": 55734963, "comment_id": 98151400, "body": "The C language has no such standard feature, but there are plenty of them available--DBUS, for example."}, {"owner": {"reputation": 511, "user_id": 4200001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d5b83eca46758f641bafe8bfa12ed40f?s=128&d=identicon&r=PG&f=1", "display_name": "Dypso", "link": "https://stackoverflow.com/users/4200001/dypso"}, "edited": false, "score": 0, "creation_date": 1555574735, "post_id": 55734963, "comment_id": 98160320, "body": "I haven&#39;t find if dbus is available on Android... Also, could I rely on this feature if I am not responsible for the plateform : I have only a component (dll,so) that should be embed in third party application...."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 4200001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d5b83eca46758f641bafe8bfa12ed40f?s=128&d=identicon&r=PG&f=1", "display_name": "Dypso", "link": "https://stackoverflow.com/users/4200001/dypso"}, "edited": false, "score": 0, "creation_date": 1555574238, "post_id": 55735930, "comment_id": 98160098, "body": "My module should be thought like a SDK to be incorporated in some others vendors application : alas I could not rely on a proper soft broker."}], "tags": [], "owner": {"reputation": 95, "user_id": 7412864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd746c5e0a51c7e61d9668f671e4250?s=128&d=identicon&r=PG", "display_name": "David W.", "link": "https://stackoverflow.com/users/7412864/david-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1555535014, "creation_date": 1555535014, "answer_id": 55735930, "question_id": 55734963, "link": "https://stackoverflow.com/questions/55734963/is-it-possible-to-have-an-event-bus-in-c/55735930#55735930", "title": "Is it possible to have an event bus in C?", "body": "<p>You might want to consider using a message broker.  I use Apache's Active MQ (<a href=\"http://activemq.apache.org/\" rel=\"nofollow noreferrer\">http://activemq.apache.org/</a>) in many of my c services.  If you want something light weight, try Mosquitto (<a href=\"https://mosquitto.org/\" rel=\"nofollow noreferrer\">https://mosquitto.org/</a>)</p>\n"}], "owner": {"reputation": 511, "user_id": 4200001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d5b83eca46758f641bafe8bfa12ed40f?s=128&d=identicon&r=PG&f=1", "display_name": "Dypso", "link": "https://stackoverflow.com/users/4200001/dypso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555535014, "creation_date": 1555530413, "question_id": 55734963, "link": "https://stackoverflow.com/questions/55734963/is-it-possible-to-have-an-event-bus-in-c", "title": "Is it possible to have an event bus in C?", "body": "<p>I need to create a module (composed by multiple components) for various embedded system (runnning under linux,android, windows ce). And I am still in the design phase : \n  - I have decided to code my component in C in order to favor portability and efficiency :  every other vendors could then incorporate my component in their application on linux, android or windows CE. \n  - I also want to propose to decouple my components from their usage by using a kind of event bus.\n But it is possible to use a portable event bus in pure C  ? Or the best I could offer is a registration of callback functions ?</p>\n"}, {"tags": ["c", "multidimensional-array"], "answers": [{"tags": [], "owner": {"reputation": 883, "user_id": 11322131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da67a1ade1072d432684e55adbb5d57?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/11322131/noah"}, "is_accepted": false, "score": 0, "last_activity_date": 1555535866, "creation_date": 1555535866, "answer_id": 55736104, "question_id": 55734783, "link": "https://stackoverflow.com/questions/55734783/adding-both-string-and-single-char-values-to-same-multi-dimensional-list/55736104#55736104", "title": "Adding both string and single char values to same multi-dimensional list", "body": "<p>So a few things. First, since strings in c are stored as an array of characters you will really need an char*** calendar as you need a row for each appointment number, then 4 rows of there of char* for appointment. Second, instead of reallocing twice, try to read the input into a buffer, scan the buffer, then allocate according to the sizes you need. Without really knowing your project specifications this code should give you an idea of how you could format things.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define maxApt 3\n\nvoid addApt(char *** cal, int aptNum){\n   char month,day, hour,inBuf[20]=\"\";\n   printf(\"give input\\n\");\n   if(fscanf(stdin, \"%s %c %c %c\", inBuf,&amp;month, &amp;day, &amp;hour)!=4){\n   fprintf(stderr,\"poorly formatted input\\n\");\n   return;\n }\n\n cal[aptNum][0]=(char*)malloc(strlen(inBuf));\n strncpy(cal[aptNum][0], inBuf,20);\n for(int i =1;i&lt;4;i++){\n cal[aptNum][i]=(char*)malloc(1);\n\n }\n  cal[aptNum][1][0]=month;\n  cal[aptNum][2][0]=day;\n  cal[aptNum][3][0]=hour;\n\n\n }\n int main(){\nchar ***calendar=(char***)malloc(maxApt*sizeof(char**));\nfor(int i =0;i&lt;maxApt;i++){\n calendar[i]=(char**)malloc(4*sizeof(char*));\n addApt(calendar, i);\n }\n\n  for(int j=0;j&lt;maxApt;j++){\n  for(int i =0;i&lt;4;i++){\n   printf(\"%s \", calendar[j][i]);\n  }\n  printf(\"\\n\");\n  }\n\n\n\n  }\n</code></pre>\n\n<p>Note if you want peoples description to be able to have spaces you will need to parse in a more sophisticated way.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3351375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1509151448/picture?type=large", "display_name": "blunde", "link": "https://stackoverflow.com/users/3351375/blunde"}, "edited": false, "score": 1, "creation_date": 1555592524, "post_id": 55737287, "comment_id": 98170068, "body": "Yeah I ended up doing the same conclusion and went with struct. there is just so much stuff i don&#39;t fully understand on c and keep constantly getting held back by wrong syntaxes or whatever. But yeah thanks, something like this is what I&#39;m gonna go with."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 13, "user_id": 3351375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1509151448/picture?type=large", "display_name": "blunde", "link": "https://stackoverflow.com/users/3351375/blunde"}, "edited": false, "score": 0, "creation_date": 1555613158, "post_id": 55737287, "comment_id": 98180693, "body": "A lot of it is dealing with the growing array (<code>reserve</code>); would recommend first doing it on a fixed size array until it works as expected."}], "tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1555544086, "last_edit_date": 1555544086, "creation_date": 1555543728, "answer_id": 55737287, "question_id": 55734783, "link": "https://stackoverflow.com/questions/55734783/adding-both-string-and-single-char-values-to-same-multi-dimensional-list/55737287#55737287", "title": "Adding both string and single char values to same multi-dimensional list", "body": "<p>Instead of a multidimensional array, I think this would be better suited to a <code>struct</code>: it's clearer and more extensible. If you want to grow the data, than keeping a capacity that grows exponentially has a much nicer limiting behaviour. As well, separating the interface from the logic behind is a good idea.</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* realloc, rand, EXIT_* */\n#include &lt;string.h&gt; /* strncpy */\n#include &lt;stdio.h&gt;  /* printf, perror */\n#include &lt;assert.h&gt; /* assert */\n\nstruct Appointment {\n    char desc[1024];\n    unsigned year, month, day, hour, minute;\n};\n\nstruct Appointments {\n    struct Appointment *a;\n    size_t capacity, next_capacity, number;\n};\n\n/** Ensures that {as} has at least {min} entries.\n @return Success. */\nstatic int reserve(struct Appointments *const as, const size_t min) {\n    struct Appointment *a;\n    size_t c0, c1;\n    assert(as);\n\n    /* Already have enough. */\n    if(min &lt;= as-&gt;capacity) return 1;\n\n    /* Calculate increase by Fibbinocci. */\n    if(!as-&gt;a) c0 = 8, c1 = 13;\n    else c0 = as-&gt;capacity, c1 = as-&gt;next_capacity;\n    while(c0 &lt; min) c0 ^= c1, c1 ^= c0, c0 ^= c1, c1 += c0;\n    assert(c0 &lt; c1);\n\n    /* Grow the capacity. */\n    if(!(a = realloc(as-&gt;a, sizeof *a * c0))) return 0;\n    as-&gt;a = a;\n    as-&gt;capacity = c0;\n    as-&gt;next_capacity = c1;\n    return 1;\n}\n\n/** Add to {as} an appointment with appointment values.\n @return Success. */\nstatic struct Appointment *appointment(struct Appointments *const as,\n    const char *desc, unsigned year, unsigned month, unsigned day,\n    unsigned hour, unsigned minute) {\n    struct Appointment *a;\n    assert(as &amp;&amp; desc &amp;&amp; month &amp;&amp; month &lt;= 12 &amp;&amp; day &amp;&amp; day &lt; 31\n        &amp;&amp; hour &lt; 24 &amp;&amp; minute &lt; 60);\n\n    /* Add a new entry. */\n    if(!reserve(as, as-&gt;number + 1)) return 0;\n    a = as-&gt;a + as-&gt;number++;\n\n    /* Copy (part of?) the data. */\n    strncpy(a-&gt;desc, desc, sizeof a-&gt;desc - 1);\n    a-&gt;desc[sizeof a-&gt;desc - 1] = '\\0';\n    a-&gt;year   = year;\n    a-&gt;month  = month;\n    a-&gt;day    = day;\n    a-&gt;hour   = hour;\n    a-&gt;minute = minute;\n\n    return a;\n}\n\n/** Adds a random appointment to {as}.\n @return Success. */\nstatic struct Appointment *add_appointment(struct Appointments *const as) {\n    char desc[64];\n    /* Shhh, it's a Poisson distibuition. */\n    const size_t desc_len = 31 + rand() / (RAND_MAX / 32 + 1);\n    size_t i;\n    for(i = 0; i &lt; desc_len; i++) desc[i] = (i ? 'a' : 'A')\n        + rand() / (RAND_MAX / 26 + 1);\n    desc[i] = '\\0';\n    /* http://c-faq.com/lib/randrange.html */\n    return appointment(as, desc, 2000 + rand() / (RAND_MAX / 100 + 1),\n        1 + rand() / (RAND_MAX / 12 + 1), 1 + rand() / (RAND_MAX / 28 + 1),\n        rand() / (RAND_MAX / 24 + 1), rand() / (RAND_MAX / 60 + 1));\n}\n\nint main(void) {\n    struct Appointments as = { 0, 0, 0, 0 };\n    size_t i = 99, j;\n    while(--i) if(!add_appointment(&amp;as)) break;\n    for(j = 0; j &lt; as.number; j++) {\n        struct Appointment *a = as.a + j;\n        printf(\"%04u-%02u-%02uT%02u:%02u %s\\n\", a-&gt;year, a-&gt;month, a-&gt;day,\n            a-&gt;hour, a-&gt;minute, a-&gt;desc);\n    }\n    free(as.a), as.a = 0;\n    return i ? perror(\"Appointments\"), EXIT_FAILURE : EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The best way to store a date is a whole different question. For example, <a href=\"https://stackoverflow.com/questions/23648912/what-is-the-best-datatype-to-store-date-in-c-to-then-output-into-a-csv-file\">What is the best datatype to store a date</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 3351375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1509151448/picture?type=large", "display_name": "blunde", "link": "https://stackoverflow.com/users/3351375/blunde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555544086, "creation_date": 1555529520, "last_edit_date": 1555529881, "question_id": 55734783, "link": "https://stackoverflow.com/questions/55734783/adding-both-string-and-single-char-values-to-same-multi-dimensional-list", "title": "Adding both string and single char values to same multi-dimensional list", "body": "<p>So as the title says. I want to do a multi-dimensional list where each rows first column is a description and rest of the columns are month, day and hour of the descripted appointment. So basically the whole list is a calendar where each row is one appointment. Where I'm having serious trouble is handling the fact that the first column is of a different type than the others. I was considering making a linked list instead but I later have to sort out the rows by time and date and the thought of comparing those on a linked list felt difficult.</p>\n\n<p>I think this feels harder than it is. I think I'm messing the memory allocation of the array since I'm pretty new with C.</p>\n\n<pre><code>char** add_appointment(char **calendar,int a){\n    char **pointer;\n    if(a != 0){\n        calendar = realloc(calendar, (a+1)*sizeof(char **));\n        calendar[0] = malloc(20 * sizeof(char));\n        calendar[1] = malloc(1 * sizeof(char));\n        calendar[2] = malloc(1 * sizeof(char));\n        calendar[3] = malloc(1 * sizeof(char));\n    }\n    pointer = calendar;\n    char* description;\n    description = malloc(20*sizeof(char));\n    char month;\n    char day;\n    char hour;\n    int i;\n    printf(\"Add description, month, day and hour of the appointment\\n\");\n    fgets(description, 19, stdin);\n    description = realloc(description, strlen(description)+1);\n    description[strlen(description)+1] = '\\0';\n    scanf(\"%c\", &amp;month);\n    scanf(\"%c\", &amp;day);\n    scanf(\"%c\", &amp;hour);\n    calendar[a][0] = *description;\n    calendar[a][1] = month;\n    calendar[a][2] = day;\n    calendar[a][3] = hour;\n    return pointer;\n</code></pre>\n\n<p>}</p>\n\n<p>So description max size is 20. And I know I should add '\\0' which I desperately try to do. \"a\" comes from main function and tells the current number of appointments in the calendar. The if loop is there because the memory allocation for the first appointment is being made on the main function. The program already fails after writing the description on the command line and refuses to ask even the month after that.</p>\n"}, {"tags": ["c", "multithreading", "operating-system", "sleep"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1555529989, "post_id": 55734782, "comment_id": 98148084, "body": "I don&#39;t understand.  Why can you not just release the mutex before the sleep and reacquire it after?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1555530573, "post_id": 55734782, "comment_id": 98148308, "body": "A thread should never sleep while holding a lock."}, {"owner": {"reputation": 3, "user_id": 11343067, "user_type": "registered", "profile_image": "https://graph.facebook.com/1507153569421979/picture?type=large", "display_name": "Adil Alam", "link": "https://stackoverflow.com/users/11343067/adil-alam"}, "edited": false, "score": 0, "creation_date": 1555530796, "post_id": 55734782, "comment_id": 98148394, "body": "I can not release and then reacquire mutex. In my project, i am doing this  to check synchronization. so when thread sleeps, they are not using resources properly."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1555531123, "post_id": 55734782, "comment_id": 98148551, "body": "What does that mean,  &quot;...to check synchronization?&quot; If you are hoping to write an automated test that will fail if the code is not properly synchronized, then good luck with that! Testing for synchronization bugs is virtually impossible. Improperly synchronized code is never <i>guaranteed</i> to behave badly. If the code passes in your test harness, that&#39;s no guarantee that it won&#39;t fail at a customer site."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1555540191, "post_id": 55734782, "comment_id": 98151552, "body": "Calling <code>pthread_join()</code> is mandatory -- you can&#39;t skip it and expect your program to work correctly.  Call <code>pthread_join</code> in a second for-loop in <code>main()</code>, after your first for-loop has completed.  That will give you both concurrency and a clean exit."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1555543246, "post_id": 55734782, "comment_id": 98152268, "body": "What is the purpose of that <code>while</code> loop? That will do horrible things to the CPU. I&#39;m also somewhat confused -- do you want the lock released while the thread sleeps or not? Your question says yes but your comment says no!"}], "owner": {"reputation": 3, "user_id": 11343067, "user_type": "registered", "profile_image": "https://graph.facebook.com/1507153569421979/picture?type=large", "display_name": "Adil Alam", "link": "https://stackoverflow.com/users/11343067/adil-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555540017, "creation_date": 1555529517, "last_edit_date": 1555540017, "question_id": 55734782, "link": "https://stackoverflow.com/questions/55734782/releasing-of-threads-lock-when-it-sleeps", "title": "Releasing of thread&#39;s lock when it sleeps", "body": "<p>How can I release the lock of thread when it is sleeping?</p>\n\n<p>When I call pthread_join(), it will run just fine, but I have to create more than one threads and I can't call pthread_join() because of their concurrency. How can I resolve this issue without calling join.</p>\n\n<pre><code>pthread_mutex_t mut1;\npthread_mutex_init(&amp;mut1, NULL);\n\nvoid* funA(void* arg){    \n      while(pthread_mutex_trylock(&amp;mut1) != 0);\n      sleep(10);\n      // resources sharing\n      pthread_mutex_unlock(&amp;mut1);\n      pthread_exit(NULL);\n}\n\nint main(){\n      pthread_t id[9];\n      for(int i = 0; i&lt;9; i++){\n          pthread_create(&amp;id[i], NULL, &amp;funA, NULL);\n      }\n}\n</code></pre>\n"}, {"tags": ["c", "char", "type-conversion"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1555529134, "post_id": 55734608, "comment_id": 98147739, "body": "Make an attempt.  When you get stuck, come back with a <b>specific</b> question in the form of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1555531783, "post_id": 55734608, "comment_id": 98148815, "body": "Are the characters raw bytes that should be interpreted numerically, or are they strings? IOW, would the number <code>1234</code> correspond to bytes <code>08 D2</code>, <code>D2 08</code>, or <code>49 50 51 52</code>? And having established that, what else is stopping you from converting to the form you need?"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1555530700, "creation_date": 1555530700, "answer_id": 55735028, "question_id": 55734608, "link": "https://stackoverflow.com/questions/55734608/construct-integer-from-little-endian-values-in-c/55735028#55735028", "title": "Construct integer from little-endian values in C", "body": "<pre><code>int64_t makeint(const char *buff, size_t offset, size_t offsetinint, size_t len, int minus)\n{\n    union\n    {\n        int64_t i64;\n        uint8_t u8[8]\n    }d64;\n\n    offsetinint = offsetinint &amp; 7;\n    memset(&amp;d64, 0, sizeof(d64));\n\n    memcpy(&amp;d64.u8[offsetinint], len &gt; (8 - offsetinint) ? (8 - offsetinint) : len, buff + offset);\n    d64.i64 *= -1 * !!minus;\n    return d64.i64;\n}\n</code></pre>\n"}], "owner": {"reputation": 1205, "user_id": 2425753, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/543dff6e3317d5bd375503b60a669f57?s=128&d=identicon&r=PG", "display_name": "rfg", "link": "https://stackoverflow.com/users/2425753/rfg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555530700, "creation_date": 1555528836, "question_id": 55734608, "link": "https://stackoverflow.com/questions/55734608/construct-integer-from-little-endian-values-in-c", "title": "Construct integer from little-endian values in C", "body": "<p>I have several variables in C:</p>\n\n<ul>\n<li><code>char* data</code> pointer to data (always in LE)</li>\n<li><code>int dataStart</code> - <code>data</code> offset from which my integer starts</li>\n<li><code>int dataLength</code> - number of bytes with integer data (<code>0&lt;=dataLength&lt;=8</code>)</li>\n<li><code>int sign</code> - either <code>1</code> for positive numbers or <code>-1</code> for negative values</li>\n</ul>\n\n<p>How can I convert it to <code>__int64</code> (or do I need something else?) value in C?</p>\n\n<p>I know that integers are limited to <code>2^63\u22121</code>.</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1555538799, "post_id": 55734467, "comment_id": 98151227, "body": "You forgot to call <a href=\"http://man7.org/linux/man-pages/man3/fflush.3.html\" rel=\"nofollow noreferrer\">fflush(3)</a> and you should learn about <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll(2)</a>. Please read <a href=\"http://www.makelinux.net/alp/\" rel=\"nofollow noreferrer\">ALP</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "edited": false, "score": 0, "creation_date": 1555534827, "post_id": 55735623, "comment_id": 98149930, "body": "What do you mean block in scanf? Doesn&#39;t it get the userinput, send it and then go back the beggining of the loop, printing the output?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "edited": false, "score": 0, "creation_date": 1555534941, "post_id": 55735623, "comment_id": 98149971, "body": "Your code calls <code>recv</code> exactly once, then it blocks in <code>scanf</code>. While it&#39;s blocked in <code>scanf</code>, it can&#39;t receive anything from the socket. So, say in your first call to <code>recv</code>, you get just the very first byte of the response. You then block in <code>scanf</code> forever since no input is coming. You either need to loop in calls to <code>recv</code> without calling <code>scanf</code> until you have the entire response or you need to do both at the same time."}, {"owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "edited": false, "score": 0, "creation_date": 1555538606, "post_id": 55735623, "comment_id": 98151176, "body": "Edited my code to be akin to your advice, although it still does not print anything to the screen. :/"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "edited": false, "score": 0, "creation_date": 1555538932, "post_id": 55735623, "comment_id": 98151263, "body": "Your code makes no sense now. The <code>%s</code> format specifier is for strings, but <code>buffer[i]</code> is not a string. Standard output is still line buffered and your code still does not intelligently decide which direction to wait for. (See updates.)"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "edited": false, "score": 0, "creation_date": 1555539531, "post_id": 55735623, "comment_id": 98151398, "body": "I think maybe there&#39;s a higher level concept you might be missing. TCP is not a message protocol, it&#39;s a byte stream protocol. If you want to pass messages using TCP, you can, but you need a message protocol layered on top of TCP in order to do that. It won&#39;t just work by itself. If you&#39;re not experienced with TCP, it&#39;s very helpful to document your message protocol in detail before you even start writing code. The protocol must specify such things as the precise byte contents of a message and how each side will find the boundaries between the messages."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1555539117, "last_edit_date": 1555539117, "creation_date": 1555533448, "answer_id": 55735623, "question_id": 55734467, "link": "https://stackoverflow.com/questions/55734467/why-wont-the-output-of-the-client-be-printed-to-the-screen/55735623#55735623", "title": "Why won&#39;t the output of the client be printed to the screen?", "body": "<p>As soon as you receive even the tiniest drop of data, you block in <code>scanf</code> rather than trying to receive more data. You either need to support moving data in both directions at the same time (waiting for input in <code>scanf</code> and data in <code>recv</code>) at the same time or you need to be smarter about when you change the direction.</p>\n\n<p>Consider the following scenario:</p>\n\n<ol>\n<li>You call <code>ReadAndWriteSocket</code>.</li>\n<li>Your call to <code>recv</code> gets just an \"H\", the very first byte of the message.</li>\n<li>You pass that \"H\" to <code>printf</code>, but nothing gets printed because your standard output is line buffered.</li>\n<li>You call <code>scanf</code> and wait forever, but nothing is coming because the user has no intention of typing anything until they see the received message.</li>\n<li>Your code will never call <code>recv</code> again, too bad since the rest of the received message is waiting in the receive buffer but you're stuck in <code>scanf</code>.</li>\n</ol>\n\n<p>When you have code that moves data in two directions, you must be absolutely sure that you never block waiting to receive data in one direction when the data you should be waiting for is coming in the other direction. Your code has nothing to prevent this.</p>\n\n<p><strong>Update:</strong> Problems with your new code:</p>\n\n<pre><code>void *ReadAndWriteSocket(void *entrypoint) {\n\n    char message[256];\n    char buffer[256];\n\n    while (1) {\n\n    if((sockStructure.n = recv(sockStructure.newsockfd, buffer, strlen(buffer), 0)) &gt; 0) {\n</code></pre>\n\n<p>What's going on here? You can only pass a string to <code>strlen</code>. But <code>buffer</code> doesn't contain a string here (it's uninitialized on the first pass and contains an unrelated length on subsequent passes). So you're passing a nonsensical value for the length to <code>recv</code>.</p>\n\n<pre><code>    for(int i = 0; i &lt; strlen(buffer) - 1; i++) {\n\n    printf(\"%s\", buffer[i]);\n</code></pre>\n\n<p>Two problems here: First, <code>buffer[i]</code> is not a string and the <code>%s</code> format specifier is for strings. Second, standard output is line buffered, so unless the buffer happens to contain a line, it won't show.</p>\n\n<pre><code>    }\n\n    }\n\n\n    }\n    scanf(\"%s\", &amp;message);\n</code></pre>\n\n<p>Why are you waiting for user input here? What if you only received a tiny fraction of the message and didn't even receive an entire line and so haven't ouputted anything yet? How do you know the next thing you need to do is receive input from the user and not receive the rest of the message?</p>\n\n<pre><code>    send(sockStructure.newsockfd, message, strlen(message), 0);\n}\n</code></pre>\n\n<p>If you have some protocol that specifies who will send when and who will receive when and what constitutes a message and when to wait for user input, you have to write code that implements that protocol. Otherwise, you'll get stuck in <code>scanf</code> waiting for input when there's data in the socket's receive buffer.</p>\n"}], "owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555539117, "creation_date": 1555528239, "last_edit_date": 1555538534, "question_id": 55734467, "link": "https://stackoverflow.com/questions/55734467/why-wont-the-output-of-the-client-be-printed-to-the-screen", "title": "Why won&#39;t the output of the client be printed to the screen?", "body": "<p>I'm trying to inject remote code through sockets, but for some reason, when writing the command <code>cd</code> or any other command, which in turn gives me an answer through the client, the answer won't be outputted to the screen.</p>\n\n<p>I've tried various ways of outputting to the screen but none of them work.</p>\n\n<p>Server part which outputs:</p>\n\n<pre><code>void *ReadAndWriteSocket(void *entrypoint) {\n\n        char message[256];\n        char buffer[256];\n\n        while (1) {\n\n        if((sockStructure.n = recv(sockStructure.newsockfd, buffer, strlen(buffer), 0)) &gt; 0) { \n\n\n        for(int i = 0; i &lt; strlen(buffer) - 1; i++) {\n\n        printf(\"%s\", buffer[i]);\n\n        }\n\n        }\n\n\n        }\n        scanf(\"%s\", &amp;message);\n        send(sockStructure.newsockfd, message, strlen(message), 0);\n\n}\n\n</code></pre>\n\n<p>Client code:</p>\n\n<pre><code>require 'socket'\nrequire 'open3'\n\ndef createClient(hostname, port)\n\n  s = TCPSocket.new hostname, port\n\n    while line = s.gets\n      if line == \"exit\"\n        s.close\n      elsif line[0..1] == \"cd\"\n        output = Dir.chdir(Dir.pwd + \"/\" + line[2..line.size].delete(\" \\t\\n\\r\\0\"))\n        s.puts(Dir.pwd)\n      end\n      stdin, stdout, stderr, wait_thr = Open3.popen3(line)\n      s.puts(\"#{stdout.read}\")\n    end\nend\n\ncreateClient(\"127.0.0.1\", 8082);\n\n</code></pre>\n"}, {"tags": ["c", "kernel"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 1, "creation_date": 1555528340, "post_id": 55734452, "comment_id": 98147381, "body": "can you elaborate the question? can you be more specific on which kernel?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555529033, "post_id": 55734452, "comment_id": 98147699, "body": "It sounds like whoever told you that may have had a very specific context in mind, or else may have simply been saying that whatever you do once, you can do again the same way (even though that&#39;s not universally true).  Who knows what features a random kernel for a random OS might have, but I would be surprised to discover one that had a generic replay facility."}, {"owner": {"reputation": 13, "user_id": 10301948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-drhLqU8BkUk/AAAAAAAAAAI/AAAAAAAAAK0/wln-mckjl30/photo.jpg?sz=128", "display_name": "Frankoo", "link": "https://stackoverflow.com/users/10301948/frankoo"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555529289, "post_id": 55734452, "comment_id": 98147814, "body": "@OznOg windows kernel drivers."}, {"owner": {"reputation": 13, "user_id": 10301948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-drhLqU8BkUk/AAAAAAAAAAI/AAAAAAAAAK0/wln-mckjl30/photo.jpg?sz=128", "display_name": "Frankoo", "link": "https://stackoverflow.com/users/10301948/frankoo"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555529330, "post_id": 55734452, "comment_id": 98147835, "body": "@John Bollinger me too and i guess it is possible but idk how to."}], "owner": {"reputation": 13, "user_id": 10301948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-drhLqU8BkUk/AAAAAAAAAAI/AAAAAAAAAK0/wln-mckjl30/photo.jpg?sz=128", "display_name": "Frankoo", "link": "https://stackoverflow.com/users/10301948/frankoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555528177, "creation_date": 1555528177, "question_id": 55734452, "link": "https://stackoverflow.com/questions/55734452/how-to-get-a-second-execution-using-events-in-kernel", "title": "How to get a second execution using events in kernel?", "body": "<p>basically someone told me that if i can execute 1 time in kernel i can obtain execution again so is that possible? if yes could anyone tell how how could i do that because i need to call a function after my DriverEntry has returned.</p>\n"}, {"tags": ["c", "timer", "microcontroller", "atmega"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1555575464, "post_id": 55735116, "comment_id": 98160658, "body": "Thank you for that. I now set the fuses using AVRDUDESS to a Full Swing Oscillator. But the problem still persists.. weird. Do you think that it should work even if I don&#39;t have the correct capacitors? I have ordered a 22pF capacitors but I want to just try and see if it &quot;kinda&quot; works until then. I should note that the fuse CKDIV8 is set, which internally divides the clock by 8. Does this also apply to the crystal frequency?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1555531070, "creation_date": 1555531070, "answer_id": 55735116, "question_id": 55734219, "link": "https://stackoverflow.com/questions/55734219/why-does-not-my-timer0-use-the-oscillator-between-xtal1-and-xtal2-on-my-atmega64/55735116#55735116", "title": "Why does not my TIMER0 use the oscillator between XTAL1 and XTAL2 on my Atmega644 controller?", "body": "<p>You need to set the fuses as well to let know your micro that you are using the external clock. </p>\n\n<p><a href=\"http://www.ladyada.net/learn/avr/fuses.html\" rel=\"nofollow noreferrer\">http://www.ladyada.net/learn/avr/fuses.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1555575484, "post_id": 55735762, "comment_id": 98160673, "body": "Thank you for that input!"}], "tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1555534155, "creation_date": 1555534155, "answer_id": 55735762, "question_id": 55734219, "link": "https://stackoverflow.com/questions/55734219/why-does-not-my-timer0-use-the-oscillator-between-xtal1-and-xtal2-on-my-atmega64/55735762#55735762", "title": "Why does not my TIMER0 use the oscillator between XTAL1 and XTAL2 on my Atmega644 controller?", "body": "<p>Your problem is here <code>TCCR0B = ~(1 &lt;&lt; CS02) | (1 &lt;&lt; CS01) |( 1 &lt;&lt; CS00); //DIVIDE 64</code></p>\n\n<p><code>~(1&lt;&lt;CS02)</code> sets every bit <em>EXCEPT</em> CS02.  So instead of putting <code>00000011</code> into TCCR0B, you are putting <code>11111011</code>.  This means you are setting WGM to a reserved value, instead of leaving it in CTC mode. (Because bit 3 is part of the WGM setting).  </p>\n\n<p>The preferred way to indicate you want to put a zero in that bit position is <code>(0&lt;&lt;CS02)</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555534155, "creation_date": 1555527093, "question_id": 55734219, "link": "https://stackoverflow.com/questions/55734219/why-does-not-my-timer0-use-the-oscillator-between-xtal1-and-xtal2-on-my-atmega64", "title": "Why does not my TIMER0 use the oscillator between XTAL1 and XTAL2 on my Atmega644 controller?", "body": "<p>So I have tried to put a 16 MHz crystal oscillator between XTAL1 and XTAL2 pins on my Atmega644 MCU. But I don't get it to work.</p>\n\n<p>I first define </p>\n\n<pre><code>volatile unsigned int input_timer = 150;\n\nISR (TIMER0_COMPA_vect) {\n   if (input_timer&gt;0){\n      input_timer--;\n   }\n }\n</code></pre>\n\n<p>I have initiated the timer as following </p>\n\n<pre><code> TIMSK0 = (1 &lt;&lt; OCIE0A); //Compare match enabled\n TCCR0A = (1 &lt;&lt; WGM01); //CTC mode\n TCCR0B = ~(1 &lt;&lt; CS02) | (1 &lt;&lt; CS01) |( 1 &lt;&lt; CS00); //DIVIDE 64\n OCR0A = 125; \n</code></pre>\n\n<p>For testing if it works I am doing the following</p>\n\n<pre><code> int p = 0;\n while(1) \n{  \n if (input_timer == 0) {\n    lcd_clrscr();\n    char c[7]\n    itoa(p,c,10);\n    lcd_puts(c);\n    p++;\n }\n</code></pre>\n\n<p>So basically I am updating the lcd screen once everytime the counter has counted down from 150 to 0. If it is with the 16 MHz osc, this should happen every (16e6 / (150*125*64) = 13.3 updates/sec.</p>\n\n<p>If it is done with F_CPU it should happen every (1e6/(125*150*64))= 0.83 updates/sec which is what is happening now.</p>\n\n<p>So how do I actually correctly implement the oscillator on the XTAL1 and XTAL2 pins. It should be noted that I am not using the correct decoupling capacitor right now, not sure if it could matter. </p>\n"}, {"tags": ["c", "fseek"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1555527682, "post_id": 55734105, "comment_id": 98147113, "body": "As far as the C specification is concerned, SEEK_END need not be supported for binary files, and is definitely not supported for text files. One thing is certain: SEEK_END with a positive offset will not wrap around to the front of the file. It&#39;ll either enlarge the file, or fail."}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1555527244, "creation_date": 1555527244, "answer_id": 55734250, "question_id": 55734105, "link": "https://stackoverflow.com/questions/55734105/behaviour-of-fseek-with-seek-end-and-a-positive-offset/55734250#55734250", "title": "Behaviour of fseek with SEEK_END and a positive offset?", "body": "<p>Why not read the <a href=\"https://en.cppreference.com/w/cpp/io/c/fseek\" rel=\"nofollow noreferrer\">documentation</a>?</p>\n\n<blockquote>\n  <p>POSIX allows seeking beyond the existing end of file. If an output is\n  performed after this seek, any read from the gap will return zero\n  bytes. Where supported by the filesystem, this creates a sparse file.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1555528436, "creation_date": 1555528436, "answer_id": 55734511, "question_id": 55734105, "link": "https://stackoverflow.com/questions/55734105/behaviour-of-fseek-with-seek-end-and-a-positive-offset/55734511#55734511", "title": "Behaviour of fseek with SEEK_END and a positive offset?", "body": "<blockquote>\n  <p>My question is, what is the behavior of <code>fseek</code> when we used <code>SEEK_END</code>\n  with a positive offset? Is this behavior undefined, or does it wrap\n  around to the front of the contents of the file?</p>\n</blockquote>\n\n<p>If the stream is a <em>text</em> stream then as far as the C language is concerned, the behavior is undefined, because the standard specfies that:</p>\n\n<blockquote>\n  <p>For a text stream, either <code>offset</code> shall be zero, or <code>offset</code> shall be\n  a value returned by an earlier successful call to the <code>ftell</code> function\n  on a stream associated with the same file and <code>whence</code> shall be\n  <code>SEEK_SET</code>.</p>\n</blockquote>\n\n<p>(<a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2p4\" rel=\"nofollow noreferrer\">C2011, 7.21.9.2/4</a>).  No behavior is defined for the combination of a nonzero offset and <code>SEEK_END</code>.</p>\n\n<p>For a binary stream,</p>\n\n<blockquote>\n  <p>the new position, measured in characters from the beginning of the\n  file, is obtained by adding offset to the position specified by\n  <code>whence</code></p>\n</blockquote>\n\n<p>(<a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2p3\" rel=\"nofollow noreferrer\">C2011, 7.21.9.2/3</a>), so no, it absolutely does not wrap around.  The standard goes on to say that</p>\n\n<blockquote>\n  <p>A binary stream need not meaningfully support <code>fseek</code> calls with a\n  whence value of <code>SEEK_END</code></p>\n</blockquote>\n\n<p>, so such a call as you describe may (definedly) just fail, returning an error code.  If it does succeed, however -- and with some implementations it can be expected to do so for some streams -- then it results in the file position being past the end of the file.  Attempts to read at such a position should have the same result as if the position was at EOF.  Attempts to write have behavior that are dependent on the open mode of the file (all writes to streams opened in append mode go to the current end of the file) and on the implementation.</p>\n\n<p>On a POSIX system, for example, the system's C implementation is specified to allow positioning streams associated with regular files past the end of the file, and successfully writing at such a position has behavior as if bytes with value 0 were written into all positions between that and the previous end of the file.  Furthermore, POSIX does not make any distinction in practice between text and binary streams.</p>\n"}], "owner": {"reputation": 373, "user_id": 6301651, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/d79709b3730e7d12fd8d6b5a534e40b8?s=128&d=identicon&r=PG&f=1", "display_name": "Citut", "link": "https://stackoverflow.com/users/6301651/citut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555528436, "creation_date": 1555526595, "question_id": 55734105, "link": "https://stackoverflow.com/questions/55734105/behaviour-of-fseek-with-seek-end-and-a-positive-offset", "title": "Behaviour of fseek with SEEK_END and a positive offset?", "body": "<p>Lets say we have a file \"x\" containing the string \"0123456789\".</p>\n\n<p>We open the file and have a file descriptor <code>fd</code>.</p>\n\n<p>We can do <code>read(fd, some_buffer, 5)</code> to read 5 values into the buffer from the file.</p>\n\n<p>Similarly, we can use fseek to move the pointer to the individual entries in the file.</p>\n\n<p>My question is, what is the behavior of <code>fseek</code> when we used <code>SEEK_END</code> with a positive offset? Is this behavior undefined, or does it wrap around to the front of the contents of the file?</p>\n\n<p>So if we did <code>fseek(fd, 5, SEEK_END)</code>, where would the pointer be pointing to now?</p>\n"}, {"tags": ["c", "sdl"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555526157, "post_id": 55733978, "comment_id": 98146471, "body": "Just so you know, you&#39;re actually using <code>clang</code> on your mac, not <code>gcc</code>.  Apple aliased the command."}, {"owner": {"reputation": 21, "user_id": 11375468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2288666274744650/picture?type=large", "display_name": "Cl&#233;ment Dubois", "link": "https://stackoverflow.com/users/11375468/cl%c3%a9ment-dubois"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555526247, "post_id": 55733978, "comment_id": 98146509, "body": "Oh so it could be the error ? Do you want to see my Makefile ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1555526257, "post_id": 55733978, "comment_id": 98146511, "body": "<code>gcc     test_grille.c   -o test_grille</code> isn&#39;t linking against SDL2 at all. you probably need <code>-lSDL2 -lSDLImage2</code> or something"}, {"owner": {"reputation": 21, "user_id": 11375468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2288666274744650/picture?type=large", "display_name": "Cl&#233;ment Dubois", "link": "https://stackoverflow.com/users/11375468/cl%c3%a9ment-dubois"}, "edited": false, "score": 0, "creation_date": 1555526342, "post_id": 55733978, "comment_id": 98146555, "body": "``` CC=gcc FLAGS = -Wall -g  SDL_DIR=${HOME}/SDL2 SDLLIB_DIR=${SDL_DIR}/lib SDLINC_DIR=${SDL_DIR}/include  LIBS=-L${SDLLIB_DIR} -lSDL2 -lSDL2_ttf -lSDL2_image INCLUDES=-I${SDLINC_DIR}   PROG=test_grille  all: test_grille  test_sdl: test_grille.c \t${CC} $^ -o $@ ${LIBS} ${INCLUDES} ${FLAGS}   clean:  \trm -f ${PROG} \trm -f *.o ```"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555526407, "post_id": 55733978, "comment_id": 98146583, "body": "No, using <code>clang</code> is probably not a problem.  The two compilers are usually pretty interchangeable.  Just thought you might be interested to know which compiler you&#39;re actually using as it may be worth knowing for you in the future."}, {"owner": {"reputation": 21, "user_id": 11375468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2288666274744650/picture?type=large", "display_name": "Cl&#233;ment Dubois", "link": "https://stackoverflow.com/users/11375468/cl%c3%a9ment-dubois"}, "edited": false, "score": 0, "creation_date": 1555526412, "post_id": 55733978, "comment_id": 98146586, "body": "I do use it !But maybe the Makefile isn&#39;t good Oh yes ok thanks for this info ! :)"}], "owner": {"reputation": 21, "user_id": 11375468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2288666274744650/picture?type=large", "display_name": "Cl&#233;ment Dubois", "link": "https://stackoverflow.com/users/11375468/cl%c3%a9ment-dubois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "closed_date": 1555526404, "answer_count": 0, "score": 1, "last_activity_date": 1555586281, "creation_date": 1555526033, "last_edit_date": 1555586281, "question_id": 55733978, "link": "https://stackoverflow.com/questions/55733978/sdl2-undefined-symbols-for-architecture-x86-64-mac", "closed_reason": "Duplicate", "title": "SDL2 : Undefined symbols for architecture x86_64 / MAC", "body": "<p>I've an error probably due to SDL but I can't find it.</p>\n\n<p>I tried to force the link between SDL2 and my compiler, and to check all characters to avoid a special one which isn't on any libraries.\nI have all the files required in the same directory.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;SDL2/SDL.h&gt;\n#include &lt;SDL2/SDL_ttf.h&gt;\n#include &lt;SDL2/SDL_image.h&gt;\n\n\n//Function with picture display\n\n//Function with text creation and text display\n\n//Here I create an array of transparent pictures to do a Connect 4\n\n//Here it's the thing that always appear in my window\n\n//Here are the button of my main menu\n\n//After all those function there's my main\n\nIt just doesn't compile with this text of error : \n\n    mbp-de-clement:Test grille clementdubois$ make clean; make; ./test_grille\n\n    rm -f test_grille\n\n    rm -f *.o\n\n    gcc     test_grille.c   -o test_grille\n\n    Undefined symbols for architecture x86_64:\n\n      \"_IMG_Load\", referenced from:\n\n          _main in test_grille-b3d516.o\n\n    ... (lot of errors due to SDL) ...\n\n\n    ld: symbol(s) not found for architecture x86_64\n\n    clang: error: linker command failed with exit code 1 (use -v to see invocation)\n\n    make: *** [test_grille] Error 1\n\n    bash: ./test_grille: No such file or directory\n\nI check all the posts on this site but can't find any help. I try to change my Makefile but nothing worked. I'm in desperate need of help for this project. \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1555525666, "post_id": 55733806, "comment_id": 98146256, "body": "<code>ComplexNum mynum[2] = {a,b};</code>? Did you mean <code>ComplexNum mynum = {a, b};</code> instead? You&#39;d also have to modify <code>mynum[0]</code> and <code>mynum[1]</code> accordingly."}, {"owner": {"reputation": 10872, "user_id": 3135417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b989009ea961e780793f80ea6d53240?s=128&d=identicon&r=PG&f=1", "display_name": "Abdou", "link": "https://stackoverflow.com/users/3135417/abdou"}, "edited": false, "score": 0, "creation_date": 1555525751, "post_id": 55733806, "comment_id": 98146295, "body": "Even with <code>ComplexNum mynum = {a, b};</code>, you still need <code>printf(&quot;a + bi = %d + %d%c\\n&quot;,mynum.a, mynum.b, imaginary);</code>."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1555525769, "post_id": 55733806, "comment_id": 98146303, "body": "If you turn on warnings you should see all kinds of problems."}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1555525796, "post_id": 55733806, "comment_id": 98146312, "body": "You clearly missing the real problem here. Printing a char next to an integer is not an issue."}, {"owner": {"reputation": 27, "user_id": 11355688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu7d3.jpg?s=128&g=1", "display_name": "Octavius", "link": "https://stackoverflow.com/users/11355688/octavius"}, "reply_to_user": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1555525961, "post_id": 55733806, "comment_id": 98146386, "body": "Oops! You&#39;re right, @frslm. Thank you\u2014I don&#39;t have the hang of this language quite yet. Still, I wonder why <code>printf(&quot;a + bi = %d + %d %c\\n&quot;,mynum[0],mynum[1],imaginary);</code> did not print for <code>char imaginary = &#39;i&#39;</code>?"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1555526092, "post_id": 55733806, "comment_id": 98146440, "body": "@Octavius It does print the <code>i</code>. The problem is here <code>......\\n&quot;,mynum[0],mynum[1],im.....</code> They need to be <code>mynum.a</code> and <code>mynum.b</code>"}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1555526190, "post_id": 55733806, "comment_id": 98146481, "body": "@Octavius, <code>printf()</code> expects an int for <code>%d</code>, but you&#39;ve passed in <code>mynum[0]</code> and <code>mynum[1]</code> (which are a different type) so you end up with undefined behaviour; anything could happen."}, {"owner": {"reputation": 27, "user_id": 11355688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu7d3.jpg?s=128&g=1", "display_name": "Octavius", "link": "https://stackoverflow.com/users/11355688/octavius"}, "reply_to_user": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1555526535, "post_id": 55733806, "comment_id": 98146642, "body": "@frslm Ah, I think I&#39;m starting to understand. So, because <code>%d</code> was expected but I fed it something else, it&#39;s still anticipating <code>%d</code> and thus giving me some other result instead? I was thrown by it still &quot;spitting back&quot; the value I fed into the input for both <code>%d</code>, and thought that it would accept another <code>type</code> nonetheless."}], "answers": [{"tags": [], "owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "is_accepted": true, "score": 2, "last_activity_date": 1555526490, "creation_date": 1555526490, "answer_id": 55734080, "question_id": 55733806, "link": "https://stackoverflow.com/questions/55733806/printing-a-char-after-an-array-of-a-struct/55734080#55734080", "title": "Printing a Char after an Array of a Struct", "body": "<p>Printing a <code>char</code> next to an <code>int</code> is not a problem.</p>\n\n<p>1) You 're creating an array of <code>ComplexNum</code> when you only need one. You need to change:</p>\n\n<pre><code>ComplexNum mynum[2] = {a,b};\n</code></pre>\n\n<p>to: </p>\n\n<pre><code>ComplexNum mynum = {a,b};\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>ComplexNum mynum;\nmynum.a = a;\nmynum.b = b;\n</code></pre>\n\n<p>2) You have <code>%d</code> and then you 're passing a <code>ComplexNum</code>. You need to change:</p>\n\n<pre><code>printf(\"a + bi = %d + %d%c\\n\",mynum[0],mynum[1],imaginary);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>printf(\"a + bi = %d + %d%c\\n\",mynum.a,mynum.b,imaginary);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11355688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu7d3.jpg?s=128&g=1", "display_name": "Octavius", "link": "https://stackoverflow.com/users/11355688/octavius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55734080, "answer_count": 1, "score": -3, "last_activity_date": 1555526919, "creation_date": 1555525320, "last_edit_date": 1555526919, "question_id": 55733806, "link": "https://stackoverflow.com/questions/55733806/printing-a-char-after-an-array-of-a-struct", "title": "Printing a Char after an Array of a Struct", "body": "<p>When running my code so that it prints an <code>array</code> of <code>struct</code> followed by a <code>char</code>, it will not print the <code>char</code> unless I place it in a separate <code>printf</code> statement. I'm wondering <em>why</em>?</p>\n\n<p>The practice problem prompt:</p>\n\n<ul>\n<li>A complex number is a number of the form a + ib, where a is called\nthe real part, b is called the imaginary part, and i =  .  In this\nproblem, you do NOT calculate a complex number; rather you will just\nread in the real and imaginary parts and print them.  \u2022  \n\n<ul>\n<li>Write a\nprogram that defines a type for a structure for a complex number (it\nshould have two members, for the real and imaginary parts). </li>\n<li>Prompt\nthe user separately to enter values for the real and imaginary parts,\nand store them in a structure variable of this type. </li>\n<li>Print the\ncomplex number in the form a + ib.  (Just print the value of a, then\nthe string   \u201c+ i\u201d, and then the value of b). </li>\n<li><strong>Modify your program to\nhave an array of structures for complex numbers.</strong></li>\n</ul></li>\n</ul>\n\n<p>When I code the solution it the <code>printf</code> statement in this format, it works:</p>\n\n<p><code>printf(\"a + bi = %d + %d\",mynum[0],mynum[1]);\n printf(\"%c\\n\",imaginary);</code></p>\n\n<p>Whereas code in this format omits the <code>char</code> and therefor doesn't work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct{\n    int a, // real part\n        b; // imaginary part\n}ComplexNum;\n\nvoid main()\n{\n    int a, //real part\n        b; //imaginary part\n    char imaginary = 'i'; //imaginary number\n\n    printf(\"Enter the real part: \");\n    scanf(\"%d\",&amp;a);\n    printf(\"Enter the imaginary part: \");\n    scanf(\"%d\",&amp;b);\n    ComplexNum mynum[2] = {a,b};\n    printf(\"a + bi = %d + %d%c\\n\",mynum[0],mynum[1],imaginary);\n\n    return 0;\n}\n</code></pre>\n\n<p>e.g., if I enter 2 and 3 for the input, the output yields \"a + bi = 2 + 3\" rather than \"a + bi = 2 + 3i\".</p>\n\n<p>I realize there are work arounds, e.g., by instead coding it as <code>printf(\"a + bi = %d + %di\\n\",mynum[0],mynum[1]);</code> so that the i is included in the <code>printf</code> statement rather than included in a variable, but again, I want to know <em>why</em> this error is occurring.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 1, "creation_date": 1555525365, "post_id": 55733726, "comment_id": 98146116, "body": "The ASCII value for <code>F</code> is 70 and you&#39;re just printing its hex equivalent. There is no <code>XOR</code> involved in your <code>printf</code>. To be honest your question is a bit terse in that it doesn&#39;t clearly points out what you&#39;re trying to do."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1555525397, "post_id": 55733726, "comment_id": 98146128, "body": "&quot;64F123C0&quot; is a string of <a href=\"https://en.wikipedia.org/wiki/ASCII#Printable_characters\" rel=\"nofollow noreferrer\">ASCII characters</a>. From the linked table, you can see that the character &#39;6&#39; has hex value 0x36, &#39;4&#39; has hex value 0x34, and &#39;F` has value 0x46. So those are the numbers that you&#39;ll find in the array."}, {"owner": {"reputation": 1, "user_id": 10724373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647c6119b4de85d68aa7a5a23c815aa3?s=128&d=identicon&r=PG&f=1", "display_name": "mrEqualsMc", "link": "https://stackoverflow.com/users/10724373/mrequalsmc"}, "edited": false, "score": 0, "creation_date": 1555525654, "post_id": 55733726, "comment_id": 98146248, "body": "Oh that makes sense, is there a good way to convert that string off ASCII characters to a set of Bytes that I can perform Bit wise operations on?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1555525858, "post_id": 55733726, "comment_id": 98146347, "body": "something like <code>strtoul</code>?"}], "owner": {"reputation": 1, "user_id": 10724373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647c6119b4de85d68aa7a5a23c815aa3?s=128&d=identicon&r=PG&f=1", "display_name": "mrEqualsMc", "link": "https://stackoverflow.com/users/10724373/mrequalsmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555525039, "creation_date": 1555525039, "question_id": 55733726, "link": "https://stackoverflow.com/questions/55733726/xor-1-byte-or-nibble-or-unsigned-char-hex-array", "title": "XOR 1 Byte (or Nibble) or Unsigned Char Hex array", "body": "<p>I am attempting to create a random Bit Error with in a defined hex array. My idea is to XOR a random byte with 0x01, 0x02, 0x04 or 0x08, which should flip one bit in the signed char array. However I am having a lot of trouble printf'ing out my unsigned char array.   </p>\n\n<p>Even when I try a simple printf() I seem to be getting the element + 30. For example:</p>\n\n<pre><code>unsigned char randArray[] = \"64F123C0\";\nprintf(\"\\nXor Value: %02x\\n\", randArray[2]);\n</code></pre>\n\n<p>Result: Xor Value: 46</p>\n\n<p>This always seems to return the hex value converted to decimal (0x0F -> 16) added to 30. Can someone explain why this is happening and how to display 1 byte or 1 nibble from this unsigned char array?</p>\n\n<p>anyway here is my code for the random error injection into a array of unsigned hex chars:</p>\n\n<pre><code>unsigned char randArray[] = \"64F123C0\";\nunsigned char testXor[] = {0x01, 0x02, 0x04, 0x08};\n\nsrand(time(0));\n\nint randomError = 0;\nint randomInjectNib = 0;\n\n\nrandomError = rand()%5;\nrandomInjectNib = rand()%8;\n\nprintf(\"\\nThe Error Injected Byte is: %c and it was: %c\\n\\n\", randArray[randomInjectNib]^testXor[randomError], randArray[randomInjectNib])\n</code></pre>\n\n<p>I am printing the %c here to becasue of the issue I was having with printing bytes from the array discussed above.</p>\n\n<p>I would expect the results to look more like this:</p>\n\n<pre><code>unsigned char randArray[] = \"64F123C0\";\nunsigned char testXor[] = {0x01, 0x02, 0x04, 0x08};\n\nprintf(\"\\nThe Error Injected Byte is: %c and it was: %c\\n\\n\", randArray[2]^testXor[2], randArray[2])\n</code></pre>\n\n<p>Result: The Error Injected Byte is D and it was F</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1555522726, "post_id": 55733185, "comment_id": 98144944, "body": "Change <code>Int argc</code> to <code>int argc</code>. C is case-sensistive."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1555522730, "post_id": 55733185, "comment_id": 98144945, "body": "You need to read <code>printf</code> documentation as of now you are abusing it."}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1555522799, "post_id": 55733185, "comment_id": 98144986, "body": "so where is the n initialized"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1555522833, "post_id": 55733185, "comment_id": 98144996, "body": "and where is the number entered?"}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1555522886, "post_id": 55733185, "comment_id": 98145022, "body": "and the last printf should be printf (&quot;%d  dni  %d  ur  %d  minut in  %d sekund&quot;, days, hours, minutes, seconds);"}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "edited": false, "score": 0, "creation_date": 1555524452, "post_id": 55733292, "comment_id": 98145736, "body": "@Matic1295 are you sure you compiled in C ?"}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1555524530, "post_id": 55733292, "comment_id": 98145773, "body": "The fact that your screenshots show that you&#39;re running it as a <code>.ps1</code> file is worrying"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "edited": false, "score": 0, "creation_date": 1555524652, "post_id": 55733292, "comment_id": 98145824, "body": "@Matic1295 online compiling / execution : <a href=\"https://onlinegdb.com/Hy66syB5N\" rel=\"nofollow noreferrer\">onlinegdb.com/Hy66syB5N</a>"}, {"owner": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "edited": false, "score": 0, "creation_date": 1555525016, "post_id": 55733292, "comment_id": 98145956, "body": "@bruno thank you very much for the online solution. It will work for me for now.  But I still dont understand why. Even if I go manual(trough the PowerShell) to execute the file its the same."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "edited": false, "score": 0, "creation_date": 1555525127, "post_id": 55733292, "comment_id": 98146002, "body": "@Matic1295 I don&#39;t think that Windows PowerShell Integrated Scripting Environment (ISE) qualifies as a C compiler."}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1555525186, "post_id": 55733292, "comment_id": 98146026, "body": "I&#39;m not familiar with powershell but from the screenshots it seemed like it was trying to interpret the c instructions as a powershell script. You might want to look into using a c compiler and running the program through powershell instead."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1555523834, "last_edit_date": 1555523834, "creation_date": 1555523048, "answer_id": 55733292, "question_id": 55733185, "link": "https://stackoverflow.com/questions/55733185/i-have-a-problem-with-c-code-and-i-cant-see-the-mistake-its-a-simple-program/55733292#55733292", "title": "I have a problem with C code and i cant see the mistake. Its a simple program", "body": "<p>Corrected version :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n  int n;\n  printf (\"Enter a number: \");\n\n  if (scanf(\"%d\", &amp;n) == 1) {\n    int seconds = (n % 60);\n    int minutes = (n % 3600) / 60;\n    int hours = (n % 86400) / 3600;\n    int days = (n % (86400 * 30)) / 86400;\n\n    printf (\"Pretvorjeno \u0161tevilo v sekunde, minute, ure ter dneve: \");\n    printf (\"%d dni %d ur %d minut in %d sekund\", days, hours, minutes, seconds);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>I removed argc/argv because there are not used</p>\n\n<p>I added a <em>scanf</em> to read the number and of course check if the read success (to check if the number is positive can be interesting too)</p>\n\n<p>I added a newline in the printf and corrected the format</p>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -Wall -Wextra -pedantic c.c\npi@raspberrypi:/tmp $ ./a.out\nEnter a number: 12345678\nPretvorjeno \u0161tevilo v sekunde, minute, ure ter dneve: 22 dni 21 ur 21 minut in 18 sekund\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "is_accepted": false, "score": 1, "last_activity_date": 1555523118, "creation_date": 1555523118, "answer_id": 55733305, "question_id": 55733185, "link": "https://stackoverflow.com/questions/55733185/i-have-a-problem-with-c-code-and-i-cant-see-the-mistake-its-a-simple-program/55733305#55733305", "title": "I have a problem with C code and i cant see the mistake. Its a simple program", "body": "<p>Your first error is coming from what you wrote inside the main method</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nint main(){\n</code></pre>\n\n<p>You need for the user to enter the input, the program doesn't know what is n.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int n;\nprintf (\"Enter a number: \");\nscanf_s(\"%d\", &amp;n);\n</code></pre>\n\n<p>at your final line you need to change it to</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>printf (\"%d dni %d ur %d minut in %d sekund\", days, hours, minutes, seconds);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "edited": false, "score": 0, "creation_date": 1555524555, "post_id": 55733368, "comment_id": 98145784, "body": "That was a mistake yes. And before you asked me if I am sure that im compiling for c. The program makes an automatic .c extension for the file, so I assume that this actually is C :D I made another comment under the first answer with even more errors :O"}], "tags": [], "owner": {"reputation": 160, "user_id": 10447655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a1ff7f91379be737a5f222732a230?s=128&d=identicon&r=PG&f=1", "display_name": "user10447655", "link": "https://stackoverflow.com/users/10447655/user10447655"}, "is_accepted": false, "score": 1, "last_activity_date": 1555524880, "last_edit_date": 1555524880, "creation_date": 1555523361, "answer_id": 55733368, "question_id": 55733185, "link": "https://stackoverflow.com/questions/55733185/i-have-a-problem-with-c-code-and-i-cant-see-the-mistake-its-a-simple-program/55733368#55733368", "title": "I have a problem with C code and i cant see the mistake. Its a simple program", "body": "<p>from</p>\n\n<pre><code>int main(Int argc, char **argv){\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int main(int argc, char **argv) {\n</code></pre>\n\n<p>from</p>\n\n<pre><code>printf (%d +\" dni \"+ %d +\" ur \"+ %d +\" minut in \"+ %d +\" sekund\", days, hours, minutes, seconds);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf (\"%d dni %d ur %d minut in %d sekund\", days, hours, minutes, seconds);\n</code></pre>\n\n<p>Read, read, read. Documentation is very important. Here is a beginner friendly <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_printf.htm\" rel=\"nofollow noreferrer\">site</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 11298227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f383cb03e313dd4e042c895cea345639?s=128&d=identicon&r=PG&f=1", "display_name": "Matic1295", "link": "https://stackoverflow.com/users/11298227/matic1295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1555524880, "creation_date": 1555522624, "last_edit_date": 1555523837, "question_id": 55733185, "link": "https://stackoverflow.com/questions/55733185/i-have-a-problem-with-c-code-and-i-cant-see-the-mistake-its-a-simple-program", "title": "I have a problem with C code and i cant see the mistake. Its a simple program", "body": "<p>I am a beginner in programming. For enviroment I am using Windows PowerShell ISE. I get a strange error and I dont know where could be the problem.</p>\n\n<p>This is the code I am using:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(Int argc, char **argv){\n\nint n;\nprintf (\"Enter a number: \");\n\nint seconds = (n % 60);\nint minutes = (n % 3600) / 60;\nint hours = (n % 86400) / 3600;\nint days = (n % (86400 * 30)) / 86400;\n\nprintf (\"Pretvorjeno \u0161tevilo v sekunde, minute, ure ter dneve: \");\nprintf (%d +\" dni \"+ %d +\" ur \"+ %d +\" minut in \"+ %d +\" sekund\", days, hours, minutes, seconds);\n}\n</code></pre>\n\n<p>The error i get:\n<a href=\"https://i.stack.imgur.com/tE5NZ.png\" rel=\"nofollow noreferrer\">Error message</a></p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 1, "creation_date": 1555522249, "post_id": 55733060, "comment_id": 98144696, "body": "Also checking <code>while(ptr)</code> after reading <code>ptr</code> will lead to trouble for empty lists."}, {"owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1555522430, "post_id": 55733060, "comment_id": 98144777, "body": "I assume the list is not empty."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1555522454, "post_id": 55733060, "comment_id": 98144791, "body": "I do not have compile error/warning even in <code>-pedantic -Wall -Wextra</code> nor problem at the execution but I do not like <code>Node node1 = malloc(sizeof (*node1));</code> and quite surprized this is allowed (node1 already exists ?), can you check doing <code>sizeof(struct node)</code> for all three ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 3, "creation_date": 1555522528, "post_id": 55733060, "comment_id": 98144837, "body": "I <b>hate</b> these typedef hidding pointers ..."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1555522630, "post_id": 55733060, "comment_id": 98144883, "body": "Seems to work fine: <a href=\"https://ideone.com/jfRhV9\" rel=\"nofollow noreferrer\">ideone.com/jfRhV9</a> - have you tried stepping through the code with a debugger to see where the segfault occurs (and what values you have in your pointer at that time)?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1555522654, "post_id": 55733060, "comment_id": 98144900, "body": "<i>valgrind</i> signals nothing"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1555523390, "post_id": 55733060, "comment_id": 98145260, "body": "@bruno The <code>sizeof</code> operator doesn&#39;t care whether or not its parameter exists and it&#39;s not evaluated. It only cares if its type can be determined."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1555523458, "post_id": 55733060, "comment_id": 98145296, "body": "Are you getting the segmentation fault with this exact code? Can you at least use a debugger (or add logging) to figure out precisely where it segfaults?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1555523532, "post_id": 55733060, "comment_id": 98145323, "body": "@DavidSchwartz I mean a non existing identifier cannot have a type ;-) So in fact <code>int a = a;</code> is like <code>int a; a = a;</code> if I can say, it is not intuitive <i>a</i> exists before the &#39;;&#39; of its definition (if you understand what I try to say, I do not speak about initialization)"}], "answers": [{"comments": [{"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 2, "creation_date": 1555524064, "post_id": 55733466, "comment_id": 98145562, "body": "Why should <code>node1</code> be null? And even if it is, the program would have crashed at <code>node1-&gt;x = 1;</code> so this solution doesn&#39;t really work."}], "tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": false, "score": 0, "last_activity_date": 1555523826, "creation_date": 1555523826, "answer_id": 55733466, "question_id": 55733060, "link": "https://stackoverflow.com/questions/55733060/cant-understand-why-i-keep-getting-segmentation-fault-for-this-code/55733466#55733466", "title": "Can&#39;t understand why I keep getting segmentation fault for this code", "body": "<p>You're probably getting a seg fault because of a <code>NULL</code> pointer.</p>\n\n<p>You can easily protect against this in your <code>advance_node</code> function like so:</p>\n\n<pre><code>void advance_node(Node ptr) {\n    if(!ptr) return; //protect against NULL pointer\n    ptr = ptr-&gt;next;\n    while (ptr) {\n        printf(\"%d\\n\", ptr-&gt;x);\n        ptr = ptr-&gt;next;\n    }\n}\n</code></pre>\n\n<p>I made this change and tested your code here: <a href=\"https://onlinegdb.com/B1endJr9E\" rel=\"nofollow noreferrer\">https://onlinegdb.com/B1endJr9E</a></p>\n"}, {"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": false, "score": 0, "last_activity_date": 1555528636, "creation_date": 1555528636, "answer_id": 55734554, "question_id": 55733060, "link": "https://stackoverflow.com/questions/55733060/cant-understand-why-i-keep-getting-segmentation-fault-for-this-code/55734554#55734554", "title": "Can&#39;t understand why I keep getting segmentation fault for this code", "body": "<p>Try declaring your struct as</p>\n\n<pre><code>typedef struct node {\n    int x;\n    struct node* next;\n} Node;\n</code></pre>\n\n<p>Then use <code>Node *node1 = malloc(sizeof (*node1));</code></p>\n"}], "owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555528636, "creation_date": 1555522033, "last_edit_date": 1555522203, "question_id": 55733060, "link": "https://stackoverflow.com/questions/55733060/cant-understand-why-i-keep-getting-segmentation-fault-for-this-code", "title": "Can&#39;t understand why I keep getting segmentation fault for this code", "body": "<p>A very simple code:</p>\n\n<pre><code>typedef struct node {\n    int x;\n    struct node* next;\n} *Node;\n\nvoid advance_node(Node ptr) {\n    ptr = ptr-&gt;next;\n    while (ptr) {\n        printf(\"%d\\n\", ptr-&gt;x);\n        ptr = ptr-&gt;next;\n    }\n}\n\nint main() {\n    Node node1 = malloc(sizeof (*node1));\n    Node node2 = malloc(sizeof (*node2));\n    Node node3 = malloc(sizeof (*node3));\n\n    node1-&gt;x = 1;\n    node1-&gt;next = node2;\n\n    node2-&gt;x = 4;\n    node2-&gt;next = node3;\n\n    node3-&gt;x = 9;\n    node3-&gt;next = NULL;\n\n    advance_node(node1);\n    return 0;\n}\n</code></pre>\n\n<p>I expect to see an output of 4 and 9, yet I keep getting a segmentation fault. Where is my mistake? This is driving me crazy.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1555521752, "post_id": 55732975, "comment_id": 98144484, "body": "Don&#39;t post images or links to external sites - the in and output are plain text copy it into the question"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1555521768, "post_id": 55732975, "comment_id": 98144491, "body": "And explain <i>why</i>  you expect these outputs"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1555521842, "post_id": 55732975, "comment_id": 98144525, "body": "<code>scanf</code> will fail on first failed conversion. Your expectations are not justified."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1555522091, "post_id": 55732975, "comment_id": 98144624, "body": "<code>scanf</code> returns  <code>zero in the event of an early matching failure.</code> That is what happened with your first run. <code>scanf</code> worked as designed contrary to your expectation."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1555522152, "post_id": 55732975, "comment_id": 98144657, "body": "@EugeneSh.: <code>scanf</code> does not fail on the first failed conversion. <code>scanf</code> returns (and hence stops processing) when a directive fails. <code>scanf</code> works properly."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555522232, "post_id": 55732975, "comment_id": 98144682, "body": "@EricPostpischil Right, I noticed this inaccuracy when it was too late to edit."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1555526554, "post_id": 55732975, "comment_id": 98146647, "body": "@Ameen Qadi After the <code>printf(&quot;%d&quot;, x);</code>, Try <code>if (x &lt; 3) { int ch = getchar(); printf(&quot;&lt;%c&gt;\\n&quot;, ch);  }</code> to see what is left in <code>stdin</code> after a &quot;failure&quot;.  The result will be informative."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1555521874, "creation_date": 1555521874, "answer_id": 55733025, "question_id": 55732975, "link": "https://stackoverflow.com/questions/55732975/validation-of-input-type-using-scanf-returned-value-has-failed/55733025#55733025", "title": "validation of input type using scanf returned value has failed", "body": "<p>According to <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">scanf man</a></p>\n\n<blockquote>\n  <p>The format string consists of a sequence of directives which describe\n  how to process the sequence of input characters. If processing of a\n  directive fails, no further input is read, and scanf() returns</p>\n</blockquote>\n\n<hr>\n\n<p>Thus </p>\n\n<p>For Case 1.</p>\n\n<p><code>scanf</code> will stops reading when it detects the mismatch for the first specifier.</p>\n\n<p>For Case 2.</p>\n\n<p><code>scanf</code> will stops reading when it detects the mismatch for the second specifier.</p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1555521963, "creation_date": 1555521963, "answer_id": 55733047, "question_id": 55732975, "link": "https://stackoverflow.com/questions/55732975/validation-of-input-type-using-scanf-returned-value-has-failed/55733047#55733047", "title": "validation of input type using scanf returned value has failed", "body": "<p><code>scanf</code> stops processing input as soon as any conversion fails, going from left to right, it doesn't try to process the remaining inputs. </p>\n\n<p>So when you enter</p>\n\n<pre><code>b b 2.8\n</code></pre>\n\n<p>it fails when trying to do the first <code>%lf</code> conversion. Since no conversions have been done, it returns <code>0</code>.</p>\n\n<p>When you enter</p>\n\n<pre><code>2 x 2.1\n</code></pre>\n\n<p>it successfully converts <code>2</code> to a <code>double</code>, but fails on <code>x</code>, so it doesn't process <code>2.1</code> and returns <code>1</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 11375061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Gaif.jpg?s=128&g=1", "display_name": "Kodak3993", "link": "https://stackoverflow.com/users/11375061/kodak3993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555521963, "creation_date": 1555521639, "last_edit_date": 1555521804, "question_id": 55732975, "link": "https://stackoverflow.com/questions/55732975/validation-of-input-type-using-scanf-returned-value-has-failed", "title": "validation of input type using scanf returned value has failed", "body": "<p>i want to check if all inputs are of type double in this code in c by using the returned value of scanf:</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    double a,b,c;\n    int x = scanf(\"%lf %lf %lf\", &amp;a, &amp;b, &amp;c);\n    printf(\"%d\", x);\n}\n</code></pre>\n\n<p>but this is what i'm getting:</p>\n\n<ul>\n<li>here i expect 1 but i'm getting 0: <br />\n<a href=\"https://i.stack.imgur.com/4fycr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4fycr.png\" alt=\"enter image description here\"></a></li>\n<li>here i expect 2 but i'm getting 1:\n<a href=\"https://i.stack.imgur.com/zcbbH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zcbbH.png\" alt=\"enter image description here\"></a></li>\n</ul>\n"}, {"tags": ["c", "linux", "bluetooth", "bluez"], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "is_accepted": true, "score": 0, "last_activity_date": 1555521861, "creation_date": 1555521861, "answer_id": 55733019, "question_id": 55732966, "link": "https://stackoverflow.com/questions/55732966/not-able-to-link-gcc-against-libbluetooth-library/55733019#55733019", "title": "Not able to link gcc against libbluetooth library", "body": "<p>The \"lib\" is implied, so link against \"bluetooth\" instead of \"libbluetooth\":</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc -o output myfile.c -lbluetooth\n</code></pre>\n"}], "owner": {"reputation": 40, "user_id": 11375143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-giWHqCOLHSE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoTL2DLRygt5u5q1ixhMSQ3BUdTg/mo/photo.jpg?sz=128", "display_name": "PSatishKR", "link": "https://stackoverflow.com/users/11375143/psatishkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 55733019, "answer_count": 1, "score": 0, "last_activity_date": 1555524659, "creation_date": 1555521612, "last_edit_date": 1555524659, "question_id": 55732966, "link": "https://stackoverflow.com/questions/55732966/not-able-to-link-gcc-against-libbluetooth-library", "title": "Not able to link gcc against libbluetooth library", "body": "<p>I am using BlueZ library for developing bluetooth based application for linux using C. I am trying to link libbluetooth-dev to my C file but it is not working.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/usr/bin/ld: cannot find -libbluetooth-dev\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>My project directory is bluez-5.45, i am trying to build the project from this folder and added my .C file in this main folder</p>\n\n<p>I installed libbluetooth-dev library and tryed that linking but not able to do that.\nCommand for linking: \n<code>gcc -o output myfile.c -libbluetooth</code></p>\n\n<p>please let me know the mistake done by me.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1555520425, "post_id": 55732650, "comment_id": 98143907, "body": "This is one reason why <code>scanf</code> is so dangerous.  It&#39;s reading characters from the user, and you haven&#39;t told it that it&#39;s not allowed to read more than 12 characters.  You could use <code>scanf(&quot;%11s&quot;, ...)</code>, but it&#39;s hard to construct that format string from your variable <code>i</code>."}, {"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 4, "creation_date": 1555520449, "post_id": 55732650, "comment_id": 98143919, "body": "What does <code>if (a[i] &gt; i || b[i] &gt; i) { ...</code> do?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1555520581, "post_id": 55732650, "comment_id": 98143981, "body": "There is no point of checking whether user has inputted more than 12 characters as you have already hit UB by reading out of bound. The point is you need to restrict the user from entering 12 chars."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1555522088, "post_id": 55732650, "comment_id": 98144623, "body": "<code>if(a[i] &gt; i)</code>  does not do what you think it does. Indeed, attempting to reference <code>a[i]</code> is an error.  <code>a</code> is an array with 12 elements, so you can read from <code>a[0]</code> through <code>a[11]</code>.  If you want the length of the string in <code>a</code>, you can use <code>strlen(a)</code>.  The size of <code>a</code> is fixed at 12."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1555521045, "creation_date": 1555521045, "answer_id": 55732826, "question_id": 55732650, "link": "https://stackoverflow.com/questions/55732650/how-do-i-control-the-length-of-an-array/55732826#55732826", "title": "how do i control the length of an array", "body": "<pre><code>int i=12;\nchar a[i] ,b[i];\n</code></pre>\n\n<p>So arrays <code>a</code> and <code>b</code> each have 12 elements.</p>\n\n<pre><code>if(a[i]&gt;i || b[i]&gt;i){\n</code></pre>\n\n<p>Nothing has changed the value of <code>i</code>, so <code>i</code> is still 12. So <code>a[i]</code> is equivalent to <code>a[12]</code>. But since <code>a</code> only has 12 elements, there is no thirteenth element (since <code>a[0]</code> is the first element, <code>a[12]</code> is the thirteenth). So this is an attempt to access an entry in an array that doesn't exist.</p>\n\n<p>If you want to detect whether or not a person enters more than 12 characters, you need code that can allow them to enter more than 12 characters. That's not what you've written.</p>\n"}, {"tags": [], "owner": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "is_accepted": false, "score": 1, "last_activity_date": 1555525092, "last_edit_date": 1555525092, "creation_date": 1555523633, "answer_id": 55733431, "question_id": 55732650, "link": "https://stackoverflow.com/questions/55732650/how-do-i-control-the-length-of-an-array/55733431#55733431", "title": "how do i control the length of an array", "body": "<p>What you want to do is difficult with scanf because of problems capturing the newline character.<br>\nWith <code>fgets</code> the newline is captured as part of the char array. Just check if the input contains a newline and you know that there are no more characters to read.<br>\nThere are useful functions in <code>string.h</code> that would make this code much shorter such as <code>strchr</code> and <code>strcspn</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void) {\n    char a[14];\n    char b[14];\n    int toolong = 1;\n\n    do {\n        int retry = 0;//not retry\n        toolong = 1;//too long\n        printf ( \"give string with no more than 12 characters \");\n        if ( fgets ( a, sizeof a, stdin)) {//read a line\n            int each = 0;\n            while ( a[each]) {\n                if ( '\\n' == a[each]) {//found a newline\n                    if ( ! retry) {//not retry\n                        toolong = 0;//not too long\n                        a[each] = 0;//remove newline\n                    }\n                    else {\n                        printf ( \"try again cause you typed more than 12\\n\");\n                    }\n                    break;\n                }\n                each++;\n                if ( ! a[each]) {//found zero terminator at end of line\n                    if ( ! fgets ( a, sizeof a, stdin)) {//read more to find newline\n                        fprintf ( stderr, \"fgets EOF\\n\");\n                        return 0;\n                    }\n                    each = 0;//start over at [0]\n                    retry = 1;//retry\n                }\n            }\n        }\n        else {\n            fprintf ( stderr, \"fgets EOF\\n\");\n            return 0;\n        }\n    } while ( toolong);\n\n    do {\n        int retry = 0;\n        toolong = 1;\n        printf ( \"give second string with no more than 12 characters \");\n        if ( fgets ( b, sizeof b, stdin)) {\n            int each = 0;\n            while ( b[each]) {\n                if ( '\\n' == b[each]) {\n                    if ( ! retry) {\n                        toolong = 0;\n                        b[each] = 0;\n                    }\n                    else {\n                        printf ( \"try again cause you typed more than 12\\n\");\n                    }\n                    break;\n                }\n                each++;\n                if ( ! b[each]) {\n                    if ( ! fgets ( b, sizeof b, stdin)) {\n                        fprintf ( stderr, \"fgets EOF\\n\");\n                        return 0;\n                    }\n                    each = 0;\n                    retry = 1;\n                }\n            }\n        }\n        else {\n            fprintf ( stderr, \"fgets EOF\\n\");\n            return 0;\n        }\n    } while ( toolong);\n\n    printf ( \"you gave %s &amp; %s\\n\", a, b);\n\n    return 0;\n}\n</code></pre>\n\n<p>Using <code>string.h</code> and putting the duplicate code in a function makes it much shorter.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *strlimit ( char *str, int limit) {\n    int toolong = 1;\n\n    do {\n        toolong = 0;// not too long\n        printf ( \"give string with no more than 12 characters \");\n        if ( fgets ( str, limit, stdin)) {//read a line\n            if ( ! strchr ( str, '\\n')) {//no newline\n                while ( ! strchr ( str, '\\n')) {//look for newline\n                    fgets ( str, limit, stdin);//read more\n                }\n                toolong = 1;// too long\n                printf ( \"try again cause you typed more than 12\\n\");\n            }\n            str[strcspn ( str, \"\\n\")] = 0;//remove newline\n        }\n        else {\n            fprintf ( stderr, \"fgets EOF\\n\");\n            return NULL;\n        }\n    } while ( toolong);\n\n    return str;\n}\n\nint main( void) {\n    char a[14];\n    char b[14];\n\n    if ( ! strlimit ( a, sizeof a)) {\n        return 0;\n    }\n\n    if ( ! strlimit ( b, sizeof b)) {\n        return 0;\n    }\n\n    printf ( \"you gave %s &amp; %s\\n\", a, b);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1555598403, "last_edit_date": 1555598403, "creation_date": 1555524043, "answer_id": 55733517, "question_id": 55732650, "link": "https://stackoverflow.com/questions/55732650/how-do-i-control-the-length-of-an-array/55733517#55733517", "title": "how do i control the length of an array", "body": "<p>The trick is to limit the number of characters read into <code>a</code> and <code>b</code>, not to check if the user entered too many characters after the fact (by which time the damage will already have been done).</p>\n\n<p>There are several ways to do this.  One is to use an explicit width on the <code>%s</code> conversion specifier in the <code>scanf</code> call:</p>\n\n<pre><code>scanf( \"%11s\", a );\n</code></pre>\n\n<p>Another use to use <code>fgets</code> instead of <code>scanf</code>:</p>\n\n<pre><code>fgets( a, sizeof a, stdin);\n</code></pre>\n\n<p>Both will prevent more than 11 characters being read into <code>a</code>, and will add the 0-terminator.  </p>\n\n<p><em>However</em>, if the user typed 12 or more characters, those extra characters will still be waiting in the input stream, which will be picked up by your next input operation, which is probably not what you want.  You'll need to scrub the input stream if that's the case.  One approach is to read and discard any non-whitespace characters immediately after your input operation:</p>\n\n<pre><code>if ( fgets( a, sizeof a, stdin ) != NULL ) // if ( scanf( \"%11s\", a ) == 1 )\n{\n  // Successfully read into a\n  // Scrub any non-whitespace characters remaining in the input stream\n  int c;\n  while ( !isspace( c = getchar() ) )\n    ; // empty loop body\n  if ( c != EOF ) \n    ungetc( c, stdin );\n}\nelse\n{\n  // error on input\n}\n</code></pre>\n\n<p>The <code>while</code> loop will keep reading individual characters from the input stream until it sees a whitespace character.  If we do read a whitespace character, we push it back onto the input stream.  </p>\n"}], "owner": {"reputation": 27, "user_id": 5758466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15789af403d2fec9e482fdea5e9af405?s=128&d=identicon&r=PG", "display_name": "ted", "link": "https://stackoverflow.com/users/5758466/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1555598403, "creation_date": 1555520295, "last_edit_date": 1555525170, "question_id": 55732650, "link": "https://stackoverflow.com/questions/55732650/how-do-i-control-the-length-of-an-array", "title": "how do i control the length of an array", "body": "<p>My problem is that array b can take more than 12 characters and if that happends it prints out only array b with no errors</p>\n\n<pre><code>{\nint i=12;\nchar a[i] ,b[i];\nprintf(\"give string with no more than 12 characters \");\nscanf(\"%s\",a);\nprintf(\"give second string with no more than 12 characters\\n\");\nscanf(\"%s\",b);\nif(a[i]&gt;i || b[i]&gt;i){\n    printf(\"try again cause you typed more than 12\\n\");\n    printf(\"first \\n\");\n    scanf(\"%s\",a);\n    printf(\"second \\n\");\n    scanf(\"%s\",b);\n    }\nprintf(\"you gave %s &amp; %s \\n\",a,b);\n</code></pre>\n\n<p>I expect the output \"try again cause you typed more than 12\"\nwhen i type more than 12 characters</p>\n"}, {"tags": ["c", "graph", "representation"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1555519601, "post_id": 55732254, "comment_id": 98143499, "body": "Your graph is undirected, so if U is connected to V, there is also a connection from V to U. You would do the same with an adjacency matrix, where you&#39;d both <code>adj[U][V]</code> and <code>adj[V][U]</code>. Or is your question about the linked list that holds the adjacent nodes?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1555519723, "post_id": 55732254, "comment_id": 98143558, "body": "The question is unclear. Does your program output unexpected data?"}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1555547733, "post_id": 55732254, "comment_id": 98153051, "body": "The program is right. I didn&#39;t write the program. I am just confused about the addEdge function."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1555775071, "post_id": 55732254, "comment_id": 98222589, "body": "An undirected edge (a, b) can be wiewed as a pair of directed edges ((a, b), (b, a))."}, {"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 0, "creation_date": 1613324730, "post_id": 55732254, "comment_id": 117034673, "body": "By the way, this sort of logic is much easier to do in C++, which offers you a rich library of &quot;container classes&quot; so that you don&#39;t have to do nearly as much error-prone &quot;pointer twiddling&quot; ..."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1614180041, "post_id": 66198016, "comment_id": 117307640, "body": "Long time ago, but still thanks !"}], "tags": [], "owner": {"reputation": 11, "user_id": 15207822, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YJBASPeWaV4/AAAAAAAAAAI/AAAAAAAAFLo/AMZuuckwdCr715FxtwAAxgnRP4kwKWZ6BA/s96-c/photo.jpg?sz=128", "display_name": "Trayansh Dewangan", "link": "https://stackoverflow.com/users/15207822/trayansh-dewangan"}, "is_accepted": false, "score": 1, "last_activity_date": 1613323123, "creation_date": 1613323123, "answer_id": 66198016, "question_id": 55732254, "link": "https://stackoverflow.com/questions/55732254/implementing-a-graph-with-adjacency-list-in-c/66198016#66198016", "title": "Implementing a graph with adjacency list in C", "body": "<p>Look its Very simple\nYou're Not Actually Linking One Node To Other Node You're Just Creating a List Which is Containing That this Element is Connected to That Element</p>\n<p>More explanation :--</p>\n<p>Calling</p>\n<pre><code>addEdge(graph, 0,1);\n</code></pre>\n<p>then This Function is Creating a Simple Node of  Name (dest)</p>\n<pre><code>struct AdjListNode* newNode = newAdjListNode(dest);\n</code></pre>\n<p>and as the node Created You First Assigned next ptr of newNode to the Source('src') Node</p>\n<pre><code>newNode-&gt;next = graph-&gt;array[src].head; \n</code></pre>\n<p>And after that You assigned SrcNode to newNode(Very Same Way We use to swap Elements)</p>\n<pre><code>graph-&gt;array[src].head = newNode; \n</code></pre>\n<p>Until Now You have already Linked Both Src And Dest Nodes ( But Only One Way).</p>\n<p>Now Repeat The Above Process from Dest to Src For Making it  A Two Way Path.</p>\n<p>Explanation2 :--</p>\n<pre><code>addEdge(graph, 0, 1); \n</code></pre>\n<p>After This One Lines Comment everything\nand Add</p>\n<pre><code>printf(&quot; %d \\n&quot;,graph-&gt;array[0].head-&gt;dest);\nprintf(&quot; %d \\n&quot;,graph-&gt;array[1].head-&gt;dest);\n</code></pre>\n<p>First Will Output 1\nSecond Will Output 0</p>\n<p>Even While Traversing In BFS Or DFS or another Way we will be needing the list we don't actually need to Connect Them..'</p>\n<p>Hope You Understood!!!!\nPlease Correct Me If am Wrong..\ud83e\udd17\ud83e\udd17\ud83e\udd17\ud83e\udd17</p>\n"}], "owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1773, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1613323123, "creation_date": 1555518660, "last_edit_date": 1555519549, "question_id": 55732254, "link": "https://stackoverflow.com/questions/55732254/implementing-a-graph-with-adjacency-list-in-c", "title": "Implementing a graph with adjacency list in C", "body": "<p>I am now learning graph, when I read about implementing graph with adjacency list from online teaching source, I was confused about the <code>addEdge</code> function.</p>\n\n<p>When <code>addEdge(graph, 0, 1)</code> is executed, the node with 1 value is created, and then <code>newNode-&gt;next</code> is assigned with <code>graph-&gt;array[0].head</code> which is NULL. After that, <code>graph-&gt;array[0].head</code> is assigned with the <code>newNode</code>. Then node 0 and 1 are connected, in the next half of the function, it goes the other way around. I don't know how this approach connects the the two nodes. </p>\n\n<p>Can someone explain to me?</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt; \n\n// A structure to represent an adjacency list node \nstruct AdjListNode \n{ \n    int dest; \n    struct AdjListNode* next; \n}; \n\n// A structure to represent an adjacency list \nstruct AdjList \n{ \n    struct AdjListNode *head;  \n}; \n\n// A structure to represent a graph. A graph \n// is an array of adjacency lists. \n// Size of array will be V (number of vertices  \n// in graph) \nstruct Graph \n{ \n    int V; \n    struct AdjList* array; \n}; \n\n// A utility function to create a new adjacency list node \nstruct AdjListNode* newAdjListNode(int dest) \n{ \n    struct AdjListNode* newNode = \n     (struct AdjListNode*) malloc(sizeof(struct AdjListNode)); \n    newNode-&gt;dest = dest; \n    newNode-&gt;next = NULL; \n    return newNode; \n} \n\n// A utility function that creates a graph of V vertices \nstruct Graph* createGraph(int V) \n{ \n    struct Graph* graph =  \n        (struct Graph*) malloc(sizeof(struct Graph)); \n    graph-&gt;V = V; \n\n    // Create an array of adjacency lists.  Size of  \n    // array will be V \n    graph-&gt;array =  \n      (struct AdjList*) malloc(V * sizeof(struct AdjList)); \n\n    // Initialize each adjacency list as empty by  \n    // making head as NULL \n    int i; \n    for (i = 0; i &lt; V; ++i) \n        graph-&gt;array[i].head = NULL; \n\n    return graph; \n} \n\n// Adds an edge to an undirected graph \nvoid addEdge(struct Graph* graph, int src, int dest) \n{ \n    // Add an edge from src to dest.  A new node is  \n    // added to the adjacency list of src.  The node \n    // is added at the begining \n    struct AdjListNode* newNode = newAdjListNode(dest); \n    newNode-&gt;next = graph-&gt;array[src].head; \n    graph-&gt;array[src].head = newNode; \n\n    // Since graph is undirected, add an edge from \n    // dest to src also \n    newNode = newAdjListNode(src); \n    newNode-&gt;next = graph-&gt;array[dest].head; \n    graph-&gt;array[dest].head = newNode; \n} \n\n// A utility function to print the adjacency list  \n// representation of graph \nvoid printGraph(struct Graph* graph) \n{ \n    int v; \n    for (v = 0; v &lt; graph-&gt;V; ++v) \n    { \n        struct AdjListNode* pCrawl = graph-&gt;array[v].head; \n        printf(\"\\n Adjacency list of vertex %d\\n head \", v); \n        while (pCrawl) \n        { \n            printf(\"-&gt; %d\", pCrawl-&gt;dest); \n            pCrawl = pCrawl-&gt;next; \n        } \n        printf(\"\\n\"); \n    } \n} \n\n// Driver program to test above functions \nint main() \n{ \n    // create the graph given in above fugure \n    int V = 5; \n    struct Graph* graph = createGraph(V); \n    addEdge(graph, 0, 1); \n    addEdge(graph, 0, 4); \n    addEdge(graph, 1, 2); \n    addEdge(graph, 1, 3); \n    addEdge(graph, 1, 4); \n    addEdge(graph, 2, 3); \n    addEdge(graph, 3, 4); \n\n    // print the adjacency list representation of the above graph \n    printGraph(graph); \n\n    return 0; \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555518693, "post_id": 55732236, "comment_id": 98143065, "body": "If you express your solutions as a set of indices, you just have to check that none of those elements are within 1 of each other. If your set is sorted, you can just compare subsequent elements."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1555518772, "post_id": 55732236, "comment_id": 98143104, "body": "Please reduce the white space in the question&#39;s code sample. There is no reason for needing to scroll through the code, it could fit in a single view."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1555518822, "post_id": 55732236, "comment_id": 98143129, "body": "<code>int a[n&#47;2];</code> -- This is not C++.  So which language are you using, C or C++?"}, {"owner": {"reputation": 1, "user_id": 11373373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f066a63753ad2bbd2cee22e38ca47a5?s=128&d=identicon&r=PG", "display_name": "Arkadyuti Banerjee", "link": "https://stackoverflow.com/users/11373373/arkadyuti-banerjee"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555518877, "post_id": 55732236, "comment_id": 98143155, "body": "@Francois So basically run a loop and obtain the elements  where a change in value of variable exc is taking place, then remove adjacent elements from them?"}, {"owner": {"reputation": 1, "user_id": 11373373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f066a63753ad2bbd2cee22e38ca47a5?s=128&d=identicon&r=PG", "display_name": "Arkadyuti Banerjee", "link": "https://stackoverflow.com/users/11373373/arkadyuti-banerjee"}, "edited": false, "score": 0, "creation_date": 1555518951, "post_id": 55732236, "comment_id": 98143187, "body": "Edited. Please check."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555518973, "post_id": 55732236, "comment_id": 98143197, "body": "@ArkadyutiBanerjee My comment was not about finding solutions. It was about verifying the adjacency requirement. It may not even be required, depending on how you choose to generate candidate solutions."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1555519285, "post_id": 55732236, "comment_id": 98143341, "body": "This code doesn&#39;t compile as is.  There&#39;s a missing <code>}</code> somewhere."}, {"owner": {"reputation": 1, "user_id": 11373373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f066a63753ad2bbd2cee22e38ca47a5?s=128&d=identicon&r=PG", "display_name": "Arkadyuti Banerjee", "link": "https://stackoverflow.com/users/11373373/arkadyuti-banerjee"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555519470, "post_id": 55732236, "comment_id": 98143439, "body": "I&#39;m not sure if you need to check that @Fran&#231;oisAndrieux"}], "owner": {"reputation": 1, "user_id": 11373373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f066a63753ad2bbd2cee22e38ca47a5?s=128&d=identicon&r=PG", "display_name": "Arkadyuti Banerjee", "link": "https://stackoverflow.com/users/11373373/arkadyuti-banerjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555519248, "creation_date": 1555518577, "last_edit_date": 1555519248, "question_id": 55732236, "link": "https://stackoverflow.com/questions/55732236/maximum-sum-of-non-contiguous-elements-of-an-array", "title": "Maximum sum of non-contiguous elements of an array", "body": "<p>So I was doing this problem on algorithms where I had to find the maximum sum of non-consecutive elements in an array, going for the DP approach. While the sum is easy to obtain, I cannot figure out how to obtain the individual subsolutions (or the numbers which form the maximum sum). </p>\n\n<p>I have tried checking if the element being inserted is an adjacent element or not.</p>\n\n<pre><code>int MaxSum(int arr[], int n) {\n    int a[n/2];\n    int inc = arr[0]; \n    int exc = 0; \n    int exc_n; \n    int i, pos = -1, j = 0; \n\n    for (i = 1; i &lt; n; i++) \n    { \n        if (inc &gt; exc)\n        {\n            exc_n = inc;\n            if (pos + 1 != i){\n            a[j] = arr[i];  \n            j++;\n            pos = i;\n        }\n        else\n        {\n            exc_n = exc;\n        }\n        inc = exc + arr[i]; \n        exc = exc_n; \n    } \n\n    return ((inc &gt; exc) ? inc : exc); \n}\n</code></pre>\n\n<p>I need to return the elements that form the maximum sum that satisfy the \"non-adjacent\" condition. What am I doing wrong and what can I do to proceed?</p>\n"}, {"tags": ["c", "mpi", "send", "spawn", "recv"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1555545752, "post_id": 55731697, "comment_id": 98152695, "body": "try selecting a single TCP interface. For example, <code>mpirun --mca pml ob1 --mca btl tcp,self --mca btl_tcp_if_include 192.168.0.0&#47;24 -np 1 .&#47;master</code>"}, {"owner": {"reputation": 11, "user_id": 11374609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5bd5e9e7399a47bf5ec5e3ce9db9307?s=128&d=identicon&r=PG", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11374609/lukasz"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1555587633, "post_id": 55731697, "comment_id": 98167235, "body": "That worked, i.e. setting a device for MPI communication solved the problem (for me <code>mpirun --mca btl_tcp_if_include 127.0.0.1&#47;131 -np 1 master</code> has done it). Thanks!"}], "owner": {"reputation": 11, "user_id": 11374609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5bd5e9e7399a47bf5ec5e3ce9db9307?s=128&d=identicon&r=PG", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11374609/lukasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1555516764, "creation_date": 1555516764, "question_id": 55731697, "link": "https://stackoverflow.com/questions/55731697/second-mpi-send-between-parent-and-child-processes-hangs", "title": "Second MPI_Send between Parent and Child processes hangs", "body": "<p>I am testing communication between the Parent and Child processes. Parent spawns one child and <code>MPI_Send</code>'s two messages. Child process correspondingly <code>MPI_Recv</code>'s from the Parent twice. Depending on where I run the code, it either works (MacOS) or hangs after the second <code>MPI_Send</code> (Ubuntu). </p>\n\n<p>Any help would be much appreciated. The test code is as follows:</p>\n\n<p><code>master.c</code>:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) { \n\n    MPI_Comm children;\n    MPI_Init(&amp;argc, &amp;argv); \n\n    MPI_Comm_spawn(\"worker\", MPI_ARGV_NULL, 1,\n             MPI_INFO_NULL, 0, MPI_COMM_SELF, &amp;children,  \n             MPI_ERRCODES_IGNORE);\n\n    int send = 777;\n    MPI_Send(&amp;send, 1, MPI_INT, 0, 0, children);\n    printf(\"Sent: %d\\n\", send);\n\n    send = 111;\n    MPI_Send(&amp;send, 1, MPI_INT, 0, 0, children);\n    printf(\"Sent: %d\\n\", send);\n\n    MPI_Finalize(); \n    return 0; \n}\n</code></pre>\n\n<p><code>worker.c</code>:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) { \n\n    MPI_Comm parent; \n    MPI_Init(&amp;argc, &amp;argv); \n    MPI_Comm_get_parent(&amp;parent); \n\n    int recv;\n    MPI_Recv(&amp;recv, 1, MPI_INT, 0, 0, parent, MPI_STATUS_IGNORE);\n    printf(\"Received: %d\\n\", recv);\n\n    MPI_Recv(&amp;recv, 1, MPI_INT, 0, 0, parent, MPI_STATUS_IGNORE);\n    printf(\"Received: %d\\n\", recv);\n\n    MPI_Finalize(); \n    return 0; \n} \n</code></pre>\n\n<p>I tested this on Open MPI versions: 4.0.0, 3.0.0 and 3.1.3. The code was compiled with <code>mpicc master.c -o master</code>, <code>mpicc worker.c -o worker</code> and run with <code>mpirun -n 1 master</code>.</p>\n\n<p>The desired output would be:</p>\n\n<pre><code>Sent: 777\nReceived: 777\nSent: 111\nReceived: 111\n</code></pre>\n\n<p>However, when MPI hangs, the code prints:</p>\n\n<pre><code>Sent: 777\nReceived: 777\n</code></pre>\n\n<p>Probably worth mentioning is that if I put in the Parent process one <code>MPI_Recv</code> between two <code>MPI_Send</code>'s, and a corresponding <code>MPI_Send</code> in the Child process, the code works and does not hang.</p>\n"}, {"tags": ["c", "srand"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 2, "creation_date": 1555516177, "post_id": 55731494, "comment_id": 98141783, "body": "Just because it&#39;s on the internet, doesn&#39;t mean it&#39;s good. Something to remember."}, {"owner": {"reputation": 1966, "user_id": 10953328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2f9870ea4a1a14bf72bfe62d6f21ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ignatius", "link": "https://stackoverflow.com/users/10953328/ignatius"}, "edited": false, "score": 3, "creation_date": 1555516211, "post_id": 55731494, "comment_id": 98141797, "body": "That&#39;s not a bit operator, but an <i>address-of</i> operator."}, {"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555516247, "post_id": 55731494, "comment_id": 98141814, "body": "What do you mean?"}, {"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "reply_to_user": {"reputation": 1966, "user_id": 10953328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2f9870ea4a1a14bf72bfe62d6f21ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ignatius", "link": "https://stackoverflow.com/users/10953328/ignatius"}, "edited": false, "score": 0, "creation_date": 1555516431, "post_id": 55731494, "comment_id": 98141914, "body": "@Taegyung I&#39;m sorry,you&#39;re right.I wasn&#39;t paying attention to the context this operator was used."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1555516541, "post_id": 55731494, "comment_id": 98141970, "body": "You can find out how <code>time</code> is being invoked by researching the <a href=\"https://en.cppreference.com/w/c/chrono/time\" rel=\"nofollow noreferrer\"><code>time</code> library function</a>. It explains what is happening. The cast is something you should be familiar with (and generally avoid unless you know what you&#39;re doing, and likely even then)."}], "answers": [{"comments": [{"owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "edited": false, "score": 0, "creation_date": 1555517286, "post_id": 55731680, "comment_id": 98142334, "body": "It is kind of ironic the fact that sometimes my laboratory professor at Algorithms Design gives us a link to study some theoretical aspects about data structures such as Doubly-Linked Lists: <a href=\"https://www.tutorialspoint.com/data_structures_algorithms/doubly_linked_list_program_in_c.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/data_structures_algorithms/&hellip;</a> and every time I see code like that it makes me go nuts."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1555519734, "post_id": 55731680, "comment_id": 98143564, "body": "You should <code>#include &lt;time.h&gt;</code> and maybe use <code>int main(void)</code>. Also I prefer <code>srand(time(0))</code> :)"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1555532715, "post_id": 55731680, "comment_id": 98149175, "body": "@pmg time.h fixed. However, I rarely care about void parameters, and especially not for main. Also, I prefer time(NULL) since the argument to time is a pointer."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1555533212, "post_id": 55731680, "comment_id": 98149361, "body": "@pmg Also, for this purpose, You could write a wrapper. <code>void srand(void) { srand(time(NULL)); }</code>, but since you usually call <code>srand</code> just one per program execution I don&#39;t see the point."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1555535747, "post_id": 55731680, "comment_id": 98150234, "body": "@Broman: for pointless things, I&#39;d go with <code>#define INIT_RNG srand(time(NULL &#47;* or 0 *&#47;))</code> :)"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1555574966, "post_id": 55731680, "comment_id": 98160407, "body": "@pmg Actually, it would work with <code>time(NULL || 0)</code> :D"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1558534636, "post_id": 55731680, "comment_id": 99134481, "body": "@pmg Why would you define a macro for something that is only called once?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1558537800, "post_id": 55731680, "comment_id": 99136503, "body": "@Broman: you can, for example, generate code with different PRNGs by using <code>INIT_RNG</code> and <code>NEXT_RNG</code> and &#39;linking&#39; them to the <code>&lt;stdlib.h&gt;</code> version, or Mersenne Twister, or some other method :)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1593030686, "post_id": 55731680, "comment_id": 110640975, "body": "<code>int main()</code> is not strictly allowed by the Standard, unless an implementation decides to allow it explicitly. Use <code>int main(void)</code> instead."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1593031153, "post_id": 55731680, "comment_id": 110641176, "body": "@exnihilo I did consider that, but in practice, at least for a beginner, you&#39;ll have a hard time finding a compiler that does not support it. IMO, it&#39;s unnecessary clutter. Do you know any compiler that does not support it?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1593032250, "post_id": 55731680, "comment_id": 110641637, "body": "@exnihilo added a comment about it"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1593035355, "post_id": 55731680, "comment_id": 110642752, "body": "@klutt -- A beginner should definitely learn the right way; it is really no clutter to use <code>(void)</code> instead of <code>()</code> in one location when defining <code>main</code>. It is a very bad idea to use empty parameter lists in other function declarations when <code>(void)</code> is the intent, if for no other reason than to allow some compiler warnings. I doubt that any implementation will ever <i>not</i> accept it, but IMO it is bad style in C. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.11.6\" rel=\"nofollow noreferrer\">Empty parentheses in function declarators are an obsolescent feature</a>, IAC."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1598878742, "post_id": 55731680, "comment_id": 112591677, "body": "I disagree about not using <code>return 0;</code> in the <code>main()</code> function. Every other function that returns something needs a <code>return &lt;something&gt;;</code> statement. It is more consistent to do it also in the <code>main()</code> function. I also think explicit is better than implicit."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1598879346, "post_id": 55731680, "comment_id": 112591974, "body": "@12431234123412341234123 Yes, as I said. Some people would disagree. IMHO, the &quot;correct&quot; solution would be to declare main as <code>void main(void)</code> but since the standard does not require the compilers to support that, it is not an option. To me it&#39;s just clutter with zero value."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1598888670, "post_id": 55731680, "comment_id": 112596554, "body": "@klutt <code>void main(void)</code> would be confusing on platforms where main is expected to return an exit code, like Linux and Windows. It is correct and often supported on freestanding environments where main never returns. The reason for making C99 not requiring <code>return 0;</code> is &quot;The standard finally having to bow to sloppy existing practices.&quot; <a href=\"http://c0x.coding-guidelines.com/5.1.2.2.3.pdf\" rel=\"nofollow noreferrer\">c0x.coding-guidelines.com/5.1.2.2.3.pdf</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1598910525, "post_id": 55731680, "comment_id": 112604703, "body": "@12431234123412341234123 I know. I just happen to think that this is a moment where &quot;it&#39;s good practice&quot; simply is not a good argument. IMO, unless you actually DO return something else than 0 from main from time to time, I&#39;d say it&#39;s better to just skip it. If you compile with <code>-Wall</code> (which you should anyway) you&#39;ll get a warning if you forget returning from all other non-void functions."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 6, "last_activity_date": 1619027159, "last_edit_date": 1619027159, "creation_date": 1555516721, "answer_id": 55731680, "question_id": 55731494, "link": "https://stackoverflow.com/questions/55731494/how-does-this-implementation-of-randomization-work-in-c/55731680#55731680", "title": "How does this implementation of randomization work in C?", "body": "<p>Yes, it will yield the same result. But the example is badly written.</p>\n<p>I would be careful reading Tutorialspoint. It's a site known for bad C code, and many bad habits you see in questions here at SO can be traced to that site. Ok, it's anecdotal evidence, but I did ask a user here why they cast the result of <code>malloc</code>, and they responded that they had learned that on Tutorialspoint. You can actually see (at least) four examples in this short snippet.</p>\n<ol>\n<li>They cast the result from the call to <code>time()</code> which is completely unnecessary and just clutters the code.</li>\n<li>For some reason they use the variable <code>t</code>, which is completely useless in this example. If you read the documentation for <code>time()</code> you'll see that just passing NULL is perfectly adequate in this example.</li>\n<li>Why use the variable <code>n</code>? For this short example it's perfectly ok with a hardcoded value. And when you use variables to avoid hardcoded values, you should declare them <code>const</code> and give them a much more descriptive name than <code>n</code>. (Ok, I realize I was a bit on the edge when writing this. Omitting <code>const</code> isn't that big of a deal, even if it's preferable. And &quot;n&quot; is a common name meaning &quot;number of iterations&quot;. And using a variable instead of a hard coded value is in general a good thing. )</li>\n<li>Omitted <code>#include&lt;time.h&gt;</code> which would be ok if they also omitted the rest of the includes.</li>\n<li>Using <code>int main()</code> instead of <code>int main(void)</code>.</li>\n</ol>\n<p>For 5, I'd say that in most cases, this does not matter for the <code>main</code> function, but declaring other functions as for example <code>int foo()</code> with empty parenthesis instead of <code>int foo(void)</code> could cause problems, because they mean different things. From the <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.11.6\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n<blockquote>\n<p>The use of function declarators with empty parentheses (not prototype-format parameter type declarators) is an obsolescent feature.</p>\n</blockquote>\n<p>Here is a question related to that: <a href=\"https://stackoverflow.com/q/49472831/6699433\">What are the semantics of function pointers with empty parentheses in each C standard?</a></p>\n<p>One could also argue about a few other things, but some people would disagree about these.</p>\n<ol>\n<li>Why declare <code>i</code> outside the for loop? Declaring it inside have been legal since C99, which is 20 years old.</li>\n<li>Why end the function with <code>return 0</code>? Omitting this is also ok since C99. You only need to have a return in main if you want to return something else than 0. Personally, in general I find &quot;it's good practice&quot; as a complete nonsense statement unless there are some good arguments to why it should be good practice.</li>\n</ol>\n<p>These are good to remember if your goal is to maintain very old C code in environments where you don't have compilers that supports C99. But how common is that?</p>\n<p>So if I got to rewrite the example at tutorialspoint, i'd write it like this:</p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\nint main(void){\n    srand(time(NULL)); \n\n    for (int i = 0; i &lt; 5; i++) {\n        printf(&quot;%d\\n&quot;, rand() % 50);\n    }\n}\n</code></pre>\n<p>Another horrible example can be found here: <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_gets.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_gets.htm</a></p>\n<p>The function <code>gets</code> is removed from standard C, because it's very dangerous. Yet, the site does not even mention that.</p>\n<p>Also, they teach you to cast the result of <code>malloc</code> <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_malloc.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_malloc.htm</a> which is completely unnecessary. Read why here: <a href=\"https://stackoverflow.com/q/605845/6699433\">Do I cast the result of malloc?</a></p>\n<p>And although they mention that <code>malloc</code> returns <code>NULL</code> on failure, they don't show in the examples how to properly error check it. Same goes for functions like <code>scanf</code>.</p>\n"}], "owner": {"reputation": 146, "user_id": 10294354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0c1gTC0Atx4/AAAAAAAAAAI/AAAAAAAAADo/hAAU09GBhiU/photo.jpg?sz=128", "display_name": "Neri-kun", "link": "https://stackoverflow.com/users/10294354/neri-kun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 55731680, "answer_count": 1, "score": 0, "last_activity_date": 1619027159, "creation_date": 1555516047, "last_edit_date": 1591624180, "question_id": 55731494, "link": "https://stackoverflow.com/questions/55731494/how-does-this-implementation-of-randomization-work-in-c", "title": "How does this implementation of randomization work in C?", "body": "<p>Since I found this particular documentation on <strong><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_rand.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_rand.htm</a></strong>,I have been thinking about this particular line of code <code>srand((unsigned)time(&amp;t));</code>.Whenever I had to generate some stuff,I used <code>srand(time(NULL))</code> in order not to generate the same stuff everytime I run the program,but when I came across this,I have been wondering :Is there any difference between <code>srand((unsigned)time(&amp;t))</code> and <code>srand(time(NULL))</code>?Because to me they seem like they do the same thing.Why is a time_t variable used?And why is the adress operator used in <code>srand()</code>?  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(){\n    int i,n;\n    time_t t;\n\n    n = 5;\n\n    srand((unsigned)time(&amp;t)); \n\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%d\\n\", rand() % 50);\n    }\nreturn(0);\n}\n</code></pre>\n"}, {"tags": ["c", "file-io", "memory-leaks"], "comments": [{"owner": {"reputation": 56, "user_id": 10724358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7576393c88f3337b1cdeaa623888e926?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/10724358/philippe"}, "edited": false, "score": 1, "creation_date": 1555515238, "post_id": 55731141, "comment_id": 98141239, "body": "You should check out <a href=\"https://stackoverflow.com/questions/28686220/memory-leak-with-getline-and-strsep\" title=\"memory leak with getline and strsep\">stackoverflow.com/questions/28686220/&hellip;</a>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555515972, "post_id": 55731141, "comment_id": 98141668, "body": "How exactly did you try to <code>free</code> the memory and what error do you get? Does the number of lost blocks correspond to the loop cycles? According to <code>man getline</code> it should allocate the buffer on the first call (<code>line = NULL</code>) and <code>realloc</code> if necessary on subsequent calls, so the number of leaked blocks should correspond to how many times you run the code snippet from your question."}, {"owner": {"reputation": 409, "user_id": 2646908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c4b91d774f3a3a0414830205cf19601?s=128&d=identicon&r=PG&f=1", "display_name": "physics_researcher", "link": "https://stackoverflow.com/users/2646908/physics-researcher"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555516306, "post_id": 55731141, "comment_id": 98141846, "body": "@Bodo I tried &quot;free(line); free(token)&quot; and I get a &quot;Invalid free() / delete / delete[] / realloc()&quot; in valgrind for the line I &quot;free(token)&quot;"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555516542, "post_id": 55731141, "comment_id": 98141971, "body": "<code>free(token)</code> is wrong because <code>token</code> points to somewhere in the memory pointed to by <code>line</code>, see <code>man strsep</code>. <code>free(line);line=NULL;</code> would be correct. Without <code>line=NULL;</code> a subsequent <code>getline</code> would try to re-use the memory you just <code>free</code>d. Please <a href=\"https://stackoverflow.com/posts/55731141/edit\">edit</a> your question and add the information from your comment."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1555517020, "post_id": 55731141, "comment_id": 98142214, "body": "See Philippe&#39;s comment, especially the answer <a href=\"https://stackoverflow.com/a/28686287/10622916\">stackoverflow.com/a/28686287/10622916</a>. You should not pass <code>&amp;line</code> to <code>strsep</code> because it will modify <code>line</code>. Maybe use <code>char *line2 = line; ...strsep(&amp;line2</code>, ...)`"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555517632, "post_id": 55731141, "comment_id": 98142516, "body": "@Bodo I think you&#39;re right.  It sure looks like a dupe to me.  I&#39;ll wait a bit before voting to close.  Others may not wait, however."}], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 2646908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c4b91d774f3a3a0414830205cf19601?s=128&d=identicon&r=PG&f=1", "display_name": "physics_researcher", "link": "https://stackoverflow.com/users/2646908/physics-researcher"}, "edited": false, "score": 0, "creation_date": 1555516163, "post_id": 55731278, "comment_id": 98141775, "body": "I now have a &quot;free(line);&quot; at the end of each iteration of the loop, and a &quot;free(line) ; line=NULL;&quot; after the loop, but valgrind is still registering a memory leak-now it&#39;s just one less block that is not leaked."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1555516341, "post_id": 55731278, "comment_id": 98141864, "body": "It should not be necessary to <code>free</code> the memory in every loop cycle because <code>getline</code> re-uses an existing buffer and uses <code>realloc</code> if necessary. It should be sufficient to <code>free</code> the memory once after the loop."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555517191, "post_id": 55731278, "comment_id": 98142294, "body": "See Philippe&#39;s comment to the question, especially the answer <a href=\"https://stackoverflow.com/a/28686287/10622916\">stackoverflow.com/a/28686287/10622916</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1555517395, "post_id": 55731278, "comment_id": 98142391, "body": "This is wrong on multiple levels. <i>line should be free&#39;d (or copied for later freeing) and set to NULL when you&#39;re done with it</i> combined with <i>It must also be free&#39;d after the loop</i> would result in a double free.  Also, <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code> uses <code>realloc()</code></a>: &quot;an object shall be allocated as if by <code>malloc()</code> or the object shall be reallocated as if by <code>realloc()</code>&quot;"}, {"owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "edited": false, "score": 0, "creation_date": 1555517842, "post_id": 55731278, "comment_id": 98142645, "body": "Ah missed the point about realloc in the man page.  I don&#39;t see how it would result in a double free though if freeing/NULLing in each iteration?"}], "tags": [], "owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "is_accepted": true, "score": 4, "last_activity_date": 1555517697, "last_edit_date": 1555517697, "creation_date": 1555515250, "answer_id": 55731278, "question_id": 55731141, "link": "https://stackoverflow.com/questions/55731141/memory-leak-when-reading-file-line-by-line-using-getline/55731278#55731278", "title": "memory leak when reading file line by line using getline", "body": "<p>You must free the memory returned by getline.  From man(3) getline:</p>\n\n<blockquote>\n  <p>If *lineptr is set to NULL and *n is set 0 before the call, then\n  getline() will allocate a buffer for storing the line.  This buffer\n  should be freed by the user program even if getline() failed.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10395618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2APqyY7LwEI/AAAAAAAAAAI/AAAAAAAAAvw/mQM1wbjmjbs/photo.jpg?sz=128", "display_name": "Simaan Saada", "link": "https://stackoverflow.com/users/10395618/simaan-saada"}, "is_accepted": false, "score": 1, "last_activity_date": 1555517846, "last_edit_date": 1555517846, "creation_date": 1555516992, "answer_id": 55731776, "question_id": 55731141, "link": "https://stackoverflow.com/questions/55731141/memory-leak-when-reading-file-line-by-line-using-getline/55731776#55731776", "title": "memory leak when reading file line by line using getline", "body": "<p>According to this link: <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/getline.3.html</a>\nif there are no enough memory for the new line in the given buffer, the function <strong>getline</strong> will allocate a new memory for the new line using realloc. </p>\n\n<p>In your case, you have initialized your <strong>char* line</strong> to NULL, which means the <strong>getline</strong> function will not find a space for the new line, and will allocate a new memory for it. So, you need to free the line after you stopped using it.</p>\n\n<pre><code>fclose(pf_initial_data);\nfree(line);    //simply add this line\nreturn s_ID;\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 2646908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c4b91d774f3a3a0414830205cf19601?s=128&d=identicon&r=PG&f=1", "display_name": "physics_researcher", "link": "https://stackoverflow.com/users/2646908/physics-researcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "closed_date": 1555517700, "accepted_answer_id": 55731278, "answer_count": 2, "score": 0, "last_activity_date": 1555517846, "creation_date": 1555514812, "last_edit_date": 1555517150, "question_id": 55731141, "link": "https://stackoverflow.com/questions/55731141/memory-leak-when-reading-file-line-by-line-using-getline", "closed_reason": "Duplicate", "title": "memory leak when reading file line by line using getline", "body": "<p>I am using getline to read a file line by line. Valgrind is telling me I am getting a memory leak, and I'm not sure what malloc'ed memory I'm not freeing. </p>\n\n<p>EDIT: In response to the comments I'd like to clarify: I cannot free the \"token\" variable without getting an error message from valgrind, but I can free the \"line\" variable, which I now do after the loop (see the code below). Despite the fact I have the \"free(line)\" at the end of the loop, I am still getting a memory leak message from valgrind. Adding a \"free(line)\" inside the loop does not fix this problem. </p>\n\n<p>I am essentially reading lines of text from a file, then assigning the relevant information from that line to a struct. The relevant code is:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    struct initial_data_params s_ID = {} ;\n\n    char* line  = NULL ;\n    char* token = NULL ;\n    size_t len = 0 ; \n    ssize_t read = 0 ; \n\n    FILE* pf_initial_data = fopen(fN_initial_data, \"r\") ;\n\n    while ((read = getline(&amp;line, &amp;len, pf_initial_data)) != -1) {\n        token = strsep(&amp;line, \"=\") ;\n        if ((token != NULL) &amp;&amp;  (strcmp(token, \"r2Exp_amp\") ==0)) {\n            token = strsep(&amp;line, \"=\") ;\n            if (token != NULL) {\n                s_ID.r2Exp_amp = strtod(token, NULL) ;\n            }\n        }\n        (do something like this 9 more times for 9 other paramters)\n}\nfclose(pf_initial_data) ;\nfree(line) ;\nline = NULL ;\nreturn s_ID ;\n</code></pre>\n\n<p>Valgrind is telling me I have a memory leak at </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>while ((read = getline(&amp;line, &amp;len, pf_initial_data)) != -1) \n</code></pre>\n\n<p>in particular it says at that line that</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>==172360== 1,200 bytes in 10 blocks are definitely lost in loss record 57 of 58\n==172360==    at 0x4C29BC3: malloc (vg_replace_malloc.c:299)\n==172360==    by 0x5CE0744: getdelim (in /usr/lib64/libc-2.17.so)\n==172360==    by 0x416321: read_initial_data (file_io.c:38)\n==172360==    by 0x402FA4: main (main.c:14)\n</code></pre>\n\n<p>I should add: if you think there is a <em>better</em> way to read a file line by line and pick out a specific string/character array from that line in c than using getline, I'd be happy to see that as well. </p>\n"}, {"tags": ["c++", "c", "graphics", "operating-system"], "comments": [{"owner": {"reputation": 313, "user_id": 11200005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de761c377f59b2e8b9f230ee0313b110?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Welch", "link": "https://stackoverflow.com/users/11200005/aidan-welch"}, "edited": false, "score": 0, "creation_date": 1555515085, "post_id": 55731138, "comment_id": 98141164, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2659932/how-to-read-the-screen-pixels\">How to read the screen pixels?</a>"}, {"owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "reply_to_user": {"reputation": 313, "user_id": 11200005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de761c377f59b2e8b9f230ee0313b110?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Welch", "link": "https://stackoverflow.com/users/11200005/aidan-welch"}, "edited": false, "score": 0, "creation_date": 1555520407, "post_id": 55731138, "comment_id": 98143894, "body": "Though it asks the same question I am explicitly asking for the OS APIs of both Linux and Windows while the linked question only gets answerd by code working on Windows with an unspecified Library."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1555563761, "post_id": 55731138, "comment_id": 98156042, "body": "see <a href=\"https://stackoverflow.com/a/38549548/2521214\">How can I access a graphics card&#39;s output directly?</a> I cover OpenGL and WinAPI (VCL based encapsulation)"}, {"owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "edited": false, "score": 1, "creation_date": 1555779057, "post_id": 55731138, "comment_id": 98223660, "body": "This gets close but is there also a way to directly write to the screen, like displaying an &quot;overlay&quot; above whatever the user is currently looking at by writing directly to video memory?"}], "owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1555520607, "creation_date": 1555514791, "last_edit_date": 1555520607, "question_id": 55731138, "link": "https://stackoverflow.com/questions/55731138/reading-and-writing-bytes-directly-to-the-visible-framebuffer-of-the-os", "title": "Reading and writing bytes directly to the visible framebuffer of the OS?", "body": "<p>There are tools like Screenshot tools, Game Macro Tools and others that can read and write pixel data directly from the visible framebuffer that is presented to the user. So there must be an API that allows one to read and possibly write directly to these arrays of pixels.</p>\n\n<p>What are the APIs used to accomplish this in either Linux or Windows? Both OSes must to have some kind of systemcall to do this.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2659932/how-to-read-the-screen-pixels\">How to read the screen pixels?</a> only gets answered by giving a huge code example with an unspecified library without explaining includes or portability (seems to be Windows Exclusive stuff).</p>\n"}, {"tags": ["c", "xcode"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1555515269, "post_id": 55731122, "comment_id": 98141256, "body": "Perhaps change <code>num2=10;</code> to <code>num2=9;</code> so you do not go out of bounds in the array"}, {"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1555516080, "post_id": 55731122, "comment_id": 98141735, "body": "I didn&#39;t really understand that can you please be more specific keep in mind we fixed the input so now it runs with 10 numbers fine."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555515895, "post_id": 55731370, "comment_id": 98141615, "body": "thank you it did fix the input so now it runs with 10 numbers with is great but the program its self still seems to have a bag. I am now getting this instead.                                                    enter the array: 1 2 3 4 5 6 7 8 9 10 270860496 10 9 8 7 6 5 4 3 2 (lldb)"}, {"owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 0, "creation_date": 1555516056, "post_id": 55731370, "comment_id": 98141722, "body": "@ahmedkh Why don&#39;t you try it before posting? <a href=\"https://www.onlinegdb.com/\" rel=\"nofollow noreferrer\">onlinegdb.com</a> gives me the output of 10,8,6... for the input of ..7,8,9,10."}, {"owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 0, "creation_date": 1555516682, "post_id": 55731370, "comment_id": 98142036, "body": "@ahmedkh You should mention that you did the edit in your posting to correct the mistake of <code>function(array,length-2,start+1);</code> it is now <code>function(array,length-1,start+1);</code>"}, {"owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "reply_to_user": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 0, "creation_date": 1555516788, "post_id": 55731370, "comment_id": 98142087, "body": "@\u042f\u0440\u043e\u0441\u043b\u0430\u0432\u041c\u0430\u0448\u043a\u043e Edited. I was focusing in the 9 vs 10 issue I didn&#39;t care a lot what the program does. my bad!"}, {"owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "reply_to_user": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555516828, "post_id": 55731370, "comment_id": 98142106, "body": "@yadinmeretzki try it now"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1555517401, "post_id": 55731370, "comment_id": 98142396, "body": "The parameter name <code>length</code> is misleading. It is really the index of the final element, so <code>end</code> would be better."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1555517509, "post_id": 55731370, "comment_id": 98142452, "body": "What is the <code>if (array == NULL)</code> <code>return;</code> part of <code>function</code> for? It seems redundant."}, {"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555519630, "post_id": 55731370, "comment_id": 98143511, "body": "sorry guys I sould have mentioned that I am only allowed to use 1 function to do it and also I didn&#39;t really understand what you meant in you last comment @lan Abbott"}, {"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555519715, "post_id": 55731370, "comment_id": 98143552, "body": "and also how do I edit my original post and code I uploaded"}, {"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555519784, "post_id": 55731370, "comment_id": 98143587, "body": "and also why would array ever be equal to null"}, {"owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "edited": false, "score": 0, "creation_date": 1555519835, "post_id": 55731370, "comment_id": 98143614, "body": "and the main problem now is the weird number it spits out in the first number it tries to print after the reverse."}], "tags": [], "owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "is_accepted": false, "score": 0, "last_activity_date": 1555521158, "last_edit_date": 1555521158, "creation_date": 1555515571, "answer_id": 55731370, "question_id": 55731122, "link": "https://stackoverflow.com/questions/55731122/reverse-an-array-with-recursion/55731370#55731370", "title": "reverse an array with recursion", "body": "<p>Try this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid function(int array[],int start, int end)\n{\n    if (start &lt; end)\n    {\n      int temp;\n      temp = array[start];\n      array[start] = array[end];\n      array[end] = temp;\n      function(array, start+1, end-1);\n    }\n}\n\nint main()\n{\n    int array[10],num=0,num2=10;\n    printf(\"enter the array:\\n\");\n    for (int i =0; i&lt;num2; i++)\n    {\n        scanf(\"%d\",&amp;array[i]);\n    }\n    function(array,num,num2 - 1);\n    for (int t = 0; t&lt;num2; t++)\n    {\n        printf(\"%d\\n\",array[t]);\n    }\n}\n</code></pre>\n\n<p>Note that in C, the array starts from 0. The last index is 9 not 10. You need to access to the last element using <code>length - 1</code> instead of <code>length</code></p>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": true, "score": 0, "last_activity_date": 1555522621, "creation_date": 1555522621, "answer_id": 55733184, "question_id": 55731122, "link": "https://stackoverflow.com/questions/55731122/reverse-an-array-with-recursion/55733184#55733184", "title": "reverse an array with recursion", "body": "<p>The last index of an array with size 10 is actually 9. So this line:</p>\n\n<pre><code>function(array,num2,num);\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>function(array,num2-1,num);\n</code></pre>\n\n<p>Also, your use of <code>scanf</code> is incorrect. Eliminate the <code>\\n</code> character. Read more about <code>scanf</code> here: <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/scanf/</a></p>\n\n<p>I corrected your code and tested it here: <a href=\"https://onlinegdb.com/B1Yy4yBqN\" rel=\"nofollow noreferrer\">https://onlinegdb.com/B1Yy4yBqN</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11373038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QN3J1O035lI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoL2678MnLxTD9O-r5JNPlT7hXSw/mo/photo.jpg?sz=128", "display_name": "yadin meretzki", "link": "https://stackoverflow.com/users/11373038/yadin-meretzki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55733184, "answer_count": 2, "score": -1, "last_activity_date": 1555522621, "creation_date": 1555514742, "question_id": 55731122, "link": "https://stackoverflow.com/questions/55731122/reverse-an-array-with-recursion", "title": "reverse an array with recursion", "body": "<p>When I try to run this it asks me to input 11 numbers instead of 10 with is really weird then it out puts like an even weirder result please help.</p>\n\n<pre><code>void function(int array[],int length,int start)\n{\n    if (length&lt;start)\n    {\n        return;\n    }\n    int temp=array[start];\n    array[start]=array[length];\n    array[length]=temp;\n    function(array,length-1,start+1);\n}\n\nint main()\n{\n    int array[10],num=0,num2=10;\n    printf(\"enter the array:\\n\");\n    for (int i =0; i&lt;num2; i++)\n    {\n        scanf(\"%d\\n\",&amp;array[i]);\n    }\n    function(array,num2,num);\n    for (int t = 0; t&lt;num2; t++)\n    {\n        printf(\"%d\\n\",array[t]);\n    }\n}\n</code></pre>\n\n<p>then this is the out put for the array 1,2 ... 10,11</p>\n\n<pre><code>enter the array:\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\nreturn\n214696143\n10\n9\n8\n7\n6\n5\n4\n3\n2\n(lldb) \n</code></pre>\n\n<p>please help</p>\n"}, {"tags": ["c", "pthreads", "posix", "mutex"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 2, "creation_date": 1555512721, "post_id": 55730428, "comment_id": 98139636, "body": "gcc .... -lpthread."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555512963, "post_id": 55730428, "comment_id": 98139782, "body": "Well, you have a return with no value in a function that returns <code>void *</code>. return something,."}, {"owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "edited": false, "score": 0, "creation_date": 1555513168, "post_id": 55730428, "comment_id": 98139921, "body": "you&#39;ll may also need -lrt  for sem_* functions - depending on the platform"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555513619, "post_id": 55730428, "comment_id": 98140212, "body": "Your program does not stop, because it never <i>starts</i>.  Your build is failing with some compiler warnings and link errors."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 5456299, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f4be8c391a8390ed88b29b4571c1315e?s=128&d=identicon&r=PG&f=1", "display_name": "arsalunic612", "link": "https://stackoverflow.com/users/5456299/arsalunic612"}, "edited": false, "score": 0, "creation_date": 1555518805, "post_id": 55731556, "comment_id": 98143119, "body": "Thank you for your answer!!  It somewhat solved the issue.  I updated my code with the issue I was having.  You were right about the:       <code>usleep(100)</code>  I changed it to      <code>sleep(100)</code>  and it is working fine.  But could you check the code I just edited, just to be sure if it is fine now?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 129, "user_id": 5456299, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f4be8c391a8390ed88b29b4571c1315e?s=128&d=identicon&r=PG&f=1", "display_name": "arsalunic612", "link": "https://stackoverflow.com/users/5456299/arsalunic612"}, "edited": false, "score": 0, "creation_date": 1555519067, "post_id": 55731556, "comment_id": 98143243, "body": "@arsalunic612 your new version of the code does not solve all the problems, I edited my answer with an execution under <i>valgrind</i> where you can see a lot of random errors (depends on the thread concurrency)"}, {"owner": {"reputation": 129, "user_id": 5456299, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f4be8c391a8390ed88b29b4571c1315e?s=128&d=identicon&r=PG&f=1", "display_name": "arsalunic612", "link": "https://stackoverflow.com/users/5456299/arsalunic612"}, "edited": false, "score": 0, "creation_date": 1555519656, "post_id": 55731556, "comment_id": 98143526, "body": "I will try to work on your proposed solution to have thread identifiers. I will let you know if it takes me anywhere."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1555564445, "post_id": 55731556, "comment_id": 98156256, "body": "Many ports of GCC need <code>-pthread</code> (which implies <code>-lpthread</code>), but sets additional compiler switches, defines, whatever necessary for a multi(p)threaded application to work properly."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1555519556, "last_edit_date": 1555519556, "creation_date": 1555516237, "answer_id": 55731556, "question_id": 55730428, "link": "https://stackoverflow.com/questions/55730428/reader-writer-problem-in-c-using-pthreads/55731556#55731556", "title": "Reader/Writer problem in C using pthreads", "body": "<p>With <em>gcc</em> add the option <code>-lpthread</code> to link with the <em>pthread</em> library, I also encourage you to add the options <code>-pedantic -Wextra -Wall</code></p>\n\n<p>There are several problems in your program, some are indicated by the compiler</p>\n\n<p>In :</p>\n\n<blockquote>\n<pre><code>printf(\"thread %i - \", pthread_self());\nprintf(\"error in process data - %i\\n\", pthread_self());\n</code></pre>\n</blockquote>\n\n<p>In the POSIX standard it is not required that <code>pthread_t</code> is an arithmetic type, so it can be a struct etc and you cannot write it as an <em>int</em>. May be in your case it is an <em>int</em> (more probably an <code>unsigned long</code>) but this is not portable, and it is better to manage by yourself an identifier associated to each thread.</p>\n\n<p>In <code>reader_thread</code> :</p>\n\n<blockquote>\n<pre><code>return;\n</code></pre>\n</blockquote>\n\n<p>but the function return a <code>void*</code>, replace it by <code>return NULL;</code> for instance</p>\n\n<p>In <code>writer_thread</code> :</p>\n\n<blockquote>\n<pre><code>printf(\"thread %d wrote - %s\", buffer);\n</code></pre>\n</blockquote>\n\n<p>has three problems:</p>\n\n<ul>\n<li>an argument of type <em>int</em> is missing (probably you wanted <code>pthread_self()</code>)</li>\n<li><em>buffer</em> is set by <code>get_external_data</code> using <code>strncpy</code>, so the null ending character is <em>not</em> present but required by <em>printf %s</em> (when the missing argument will be added or <em>%d</em> removed)</li>\n<li><em>buffer</em> can be freed by <code>reader_thread</code>, probably you supposed it is protected by the semaphore but this is not the case</li>\n</ul>\n\n<p>In <code>get_external_data</code> <em>status</em> is unused</p>\n\n<p>In <em>main</em></p>\n\n<blockquote>\n<pre><code> usleep(100);\n</code></pre>\n</blockquote>\n\n<p>is a very short time given to the threads to work, and in fact you just want to be blocked, so you can replace it by <code>pthread_join(dummy, NULL);</code></p>\n\n<hr>\n\n<p>A proposal to have thread identifiers : allocate an <em>int</em> in the heap, set it with a unique number and give it in parameter to the created threads :</p>\n\n<pre><code>int main() {\n    ...\n    for(i = 0; i &lt; N; i++) { \n      int * m = malloc(sizeof(int));\n\n      *m = i;\n      pthread_create(&amp;dummy, NULL, reader_thread, m);\n    }\n\n    for(i = 0; i &lt; M; i++) { \n      int * m = malloc(sizeof(int));\n\n      *m = 100 + i;\n      pthread_create(&amp;dummy, NULL, writer_thread, m);\n    }\n    ...\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>void *writer_thread(void *arg) {\n    int id = *((int*) arg);\n    ...\n    free((int*) arg);\n    ...\n    printf(\"thread %d wrote - %s\", id, buffer);\n    ...\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void *reader_thread(void *arg) {\n    int id = *((int*) arg);\n    ...\n    free((int*) arg);\n    ...\n    process_data(removed_node-&gt;data, removed_node-&gt;length, id);\n    ...\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void process_data(char *buffer, int bufferSizeInBytes, int id){\n    ...\n        printf(\"thread %i - \", id);\n...\n        printf(\"error in process data - %i\\n\", id);\n...\n}\n</code></pre>\n\n<hr>\n\n<p>After the previous changes an execution under <em>valgrind</em> with errors dues to the other problems :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -g -pedantic -Wextra -Wall t.c -lpthread\npi@raspberrypi:/tmp $ valgrind ./a.out\n==3847== Memcheck, a memory error detector\n==3847== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==3847== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==3847== Command: ./a.out\n==3847== \n==3847== Thread 22:\n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x484B20C: strlen (vg_replace_strmem.c:458)\n==3847==    by 0x48FD68F: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \nthread 100 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEthread 103 wrote - 0123456789abcdefghijklmnopqrstuvwxyxthread 1 - 0123456789abcdefghijklmnopqrstuvwxyxABCDE\nthread 0 - 0123456789abcdefghijklmnopqrstuvwxyx\nthread 102 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABthread 103 wrote - 0123456thread 2 - 012\nthread 101 wrote - 0123456789abcdefghithread 105 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIJKLMthread 3 - 0123456\nthread 109 wrote - 0123456789abcdefghijklmnopqrstuvwxyxAthread 3 - 0123456789abcdefghi\n==3847== Invalid read of size 1\n==3847==    at 0x484B1EC: strlen (vg_replace_strmem.c:458)\n==3847==    by 0x48FD68F: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847==  Address 0x49fcd18 is 0 bytes inside a block of size 50 free'd\n==3847==    at 0x4848B8C: free (vg_replace_malloc.c:530)\n==3847==  Block was alloc'd at\n==3847==    at 0x4847568: malloc (vg_replace_malloc.c:299)\n==3847== \nthread 107 wrote - 0123456789abcdefgthread 100 wrote - thread 100 wrote - 0123456789athread 101 wrote - 0123456789abcthread 7 - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIJKLM\nthread 7 - 0123456789abcdefghijklmnopqrstuvwxyxAB\nthread 9 - 0123456789abc\nthread 9 - 0123456789abcdefghijklmnopqrstuvwxyxA\nthread 108 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABthread 105 wrote - 01thread 8 - 0123456789ab\nthread 108 wrote - 0123456789abcdefghithread 12 - 0123\nthread 103 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGthread 101 wrote - 0123456789abcdefghijklmnopqrstuvthread 103 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGthread 101 wrote - 0123456789abcdefghijklmnopqrstuvthread 14 - 0123456789a\nthread 101 wrote - 0123456789abcdefghijklthread 101 wrote - 0123456789abcdefghijklmnopqrstuvwxyxthread 101 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHthread 101 wrote - 0123456789abcdefghijklmnopqthread 101 wrote - 0123456789abcdefghijklmnopqrstuthread 101 wrote - 0123thread 102 wrote - thread 2 - 0123456789abcdefghijklmnopqrstuv\nthread 2 - 0123456789abcdefghijklmnopqr\nthread 2 - 0123456789abcdefghi\nthread 2 - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFG\nthread 100 wrote - 0123456789abcthread 100 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIJKthread 4 - 0123456789abcdefghijkl\nthread 109 wrote - thread 13 - 0123456789abcdefghijklmnopqrstuvwxyxAB\nthread 108 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIthread 19 - 0123456789abc\nthread 101 wrote - 0thread 18 - 01\nthread 108 wrote - 0123456thread 108 wrote - 01thread 108 wrote - 0123456789abcdefghijthread 10 - 0123456789abcdefghijklmnopq\nthread 8 - 0123456789abcdefghijklmnopqrstu\n==3847== Thread 30:\n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x484B1F4: strlen (vg_replace_strmem.c:458)\n==3847==    by 0x48FD68F: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBEEC: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBF0C: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x49245B8: _IO_file_xsputn@@GLIBC_2.4 (fileops.c:1294)\n==3847==    by 0x48FBF7B: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBF80: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBF90: vfprintf (vfprintf.c:1637)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBE24: vfprintf (vfprintf.c:1668)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \n==3847== Conditional jump or move depends on uninitialised value(s)\n==3847==    at 0x48FBE6C: vfprintf (vfprintf.c:1668)\n==3847==    by 0x4902ADF: printf (printf.c:33)\n==3847==    by 0x10B83: writer_thread (t.c:144)\n==3847==    by 0x4898FC3: start_thread (pthread_create.c:458)\n==3847==    by 0x498D037: ??? (clone.S:76)\n==3847== \nthread 108 wrote - thread 108 wrote - 0123456789abcdefghijkthread 12 - 0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIJKL\nthread 108 wrote - 0123456789abcdefghijthread 106 wrote - thread 5 - 0123456789abcdefg\nthread 106 wrote - thread 106 wrote - 0123456789abcdefghijklmnopqrstuvwxyxABCDthread 16 - 0123456789abcdefghijklmnopqrstuvwx\nthread 16 - 0123456789abcdefghijklmnopqrstuv\n==3847== \n==3847== HEAP SUMMARY:\n==3847==     in use at exit: 5,444 bytes in 74 blocks\n==3847==   total heap usage: 155 allocs, 81 frees, 8,138 bytes allocated\n==3847== \n==3847== LEAK SUMMARY:\n==3847==    definitely lost: 0 bytes in 0 blocks\n==3847==    indirectly lost: 0 bytes in 0 blocks\n==3847==      possibly lost: 4,080 bytes in 30 blocks\n==3847==    still reachable: 1,364 bytes in 44 blocks\n==3847==         suppressed: 0 bytes in 0 blocks\n==3847== Rerun with --leak-check=full to see details of leaked memory\n==3847== \n==3847== For counts of detected and suppressed errors, rerun with: -v\n==3847== Use --track-origins=yes to see where uninitialised values come from\n==3847== ERROR SUMMARY: 51 errors from 10 contexts (suppressed: 6 from 3)\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 5456299, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f4be8c391a8390ed88b29b4571c1315e?s=128&d=identicon&r=PG&f=1", "display_name": "arsalunic612", "link": "https://stackoverflow.com/users/5456299/arsalunic612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555522062, "creation_date": 1555512579, "last_edit_date": 1555522062, "question_id": 55730428, "link": "https://stackoverflow.com/questions/55730428/reader-writer-problem-in-c-using-pthreads", "title": "Reader/Writer problem in C using pthreads", "body": "<p>I am learning pthreads when I came across the reader/writer problem in C. The problem is very simple where the \"writer\" threads will be accessing data from an external source and the \"reader\" threads will be reading this data from the shared buffer and then pseudo processing the data. The reader and writer threads need to run continuously in a while loop.</p>\n\n<p>I am trying to implement and compile this on a standard unix system with a POSIX interface. </p>\n\n<p>I have looked through some of the stack overflow questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/23094813/reader-writer-program-in-c-using-mutexes-and-pthreads\">Reader Writer program in C using mutexes and pthreads</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/19482648/reader-writer-lock-in-pthread\">reader/writer lock in pthread</a></p>\n\n<p>and I have gotten no where with these.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;assert.h&gt;\n\n#define BUFF_SIZE 50\n#define M 10\n#define N 20\n\nint get_external_data(char *buffer, int bufferSizeInBytes);\nvoid process_data(char *buffer, int bufferSizeInBytes);\n\nint get_external_data(char *buffer, int bufferSizeInBytes){\n    int status;\n    int val;\n    char srcString[] = \"0123456789abcdefghijklmnopqrstuvwxyxABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n    val = (int)(rand() % 62);\n    if (bufferSizeInBytes &lt; val){\n        return (-1);\n    }\n\n    strncpy(buffer, srcString, val);\n    return val;\n}\n\nvoid process_data(char *buffer, int bufferSizeInBytes){\n    int i;\n    if(buffer) {\n        printf(\"thread %li - \", pthread_self());\n\n        for(i = 0; i &lt; bufferSizeInBytes; i++) {\n            printf(\"%c\", buffer[i]);\n        }\n\n        printf(\"\\n\");\n        memset(buffer, 0, bufferSizeInBytes);\n    } else {\n        printf(\"error in process data - %li\\n\", pthread_self());\n    }\n\n    return;\n}\n\n\npthread_mutex_t data_lock = PTHREAD_MUTEX_INITIALIZER;\npthread_mutex_t print_lock = PTHREAD_MUTEX_INITIALIZER;\nsem_t data_count;\n\ntypedef struct node {\n    struct node *next;\n    char *data;\n    int length;\n} node_t;\n\nnode_t *head, *tail;\n\n/**\n * This thread is responsible for pulling data off of the shared data \n * area and processing it using the process_data() API.\n */\n\nvoid *reader_thread(void *arg) {\n    int rc;\n    node_t *removed_node;\n\n    while(1) {\n        rc = sem_wait(&amp;data_count);\n        if (0 != rc) {\n            return NULL;\n        }\n\n        pthread_mutex_lock(&amp;data_lock);\n\n        assert(NULL != head);\n        removed_node = head;\n        head = head-&gt;next;\n\n        pthread_mutex_unlock(&amp;data_lock);\n\n        //Adding this lock for sake of readability at the cost of reduced consumption rate...will run out of memory eventually.\n\n        pthread_mutex_lock(&amp;print_lock);\n\n        process_data(removed_node-&gt;data, removed_node-&gt;length);\n\n        pthread_mutex_unlock(&amp;print_lock);\n\n        free(removed_node-&gt;data);\n        free(removed_node);\n    }\n\n    return NULL;\n}\n\n\n/**\n * This thread is responsible for pulling data from a device using\n * the get_external_data() API and placing it into a shared area\n * for later processing by one of the reader threads.\n */\n\nvoid *writer_thread(void *arg) {\n    int length;\n    char *buffer;\n    node_t *new_node;\n\n    new_node = (node_t*) malloc(sizeof(*new_node));\n    buffer = (char*) malloc(sizeof(*buffer) * BUFF_SIZE);\n\n    while(1) {\n\n        length = get_external_data(buffer, BUFF_SIZE);\n\n        if (length == -1) {\n            //data too big, discard it and try again;\n            continue;\n        }\n\n        new_node-&gt;next = NULL;\n        new_node-&gt;length = length;\n        new_node-&gt;data = buffer;\n\n        pthread_mutex_lock(&amp;data_lock);\n\n\n        if (head == NULL) { //The linked list is completely empty   \n            head = new_node;\n            tail = new_node;        \n        } else { //There are items in the list and we're appending  \n            tail-&gt;next = new_node;\n            tail = new_node;\n        }\n\n        pthread_mutex_unlock(&amp;data_lock);\n\n        pthread_mutex_lock(&amp;print_lock);\n\n        printf(\"thread %ld wrote - %s \\n\", pthread_self(), buffer);\n\n        pthread_mutex_unlock(&amp;print_lock);\n\n        sem_post(&amp;data_count);\n\n        buffer = (char*) malloc(sizeof(*buffer) * BUFF_SIZE);\n        new_node = (node_t*) malloc(sizeof(*new_node));\n    }\n\n    return NULL;\n}\n\nint main(int argc, char **argv) {\n    int i = sem_init(&amp;data_count, 0, 0);\n    pthread_t dummy; //creating a dummy thread\n\n    for(i = 0; i &lt; N; i++) { \n        pthread_create(&amp;dummy, NULL, reader_thread, NULL);\n    }\n\n    for(i = 0; i &lt; M; i++) { \n        pthread_create(&amp;dummy, NULL, writer_thread, NULL);\n    }\n\n    sleep(100);\n    return 0;   \n}\n</code></pre>\n\n<p>The thread synchronization is there without any compilation errors but my program stops after the writer thread writes on a buffer a few times.</p>\n\n<p>The reader and writer threads need to run continuously in a while loop, but they don\u2019t in my case. </p>\n\n<p>Any idea on how to resolve this issue?</p>\n"}, {"tags": ["c", "multithreading", "concurrency", "language-lawyer"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1555513339, "post_id": 55730243, "comment_id": 98140019, "body": "You make a confusion between C and C++. C++ is not C.  The comitee cut this concept out of the standard as it was redundant.  <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_406.htm\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/dr_406.htm</a>"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1555513944, "post_id": 55730243, "comment_id": 98140435, "body": "@alinsoar <i>You make a confusion between C and C++</i> I don&#39;t really understand what you mean by that. I did not even read what&#39;s C++ specifies about it. Also why did you delete the C tag? I quoted N1570 draft. I rolled it back."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1555515325, "post_id": 55730243, "comment_id": 98141281, "body": "mea culpa.  I thought it was quoted from C++ .  But you find the answer in technical corrigendum I posted."}, {"owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "edited": false, "score": 0, "creation_date": 1555519807, "post_id": 55730243, "comment_id": 98143596, "body": "I think you are making an incorrect assumption here that if you start 2 threads in sequence &quot;A&quot; and then &quot;B&quot;, then thread &quot;A&quot; will run before thread &quot;B&quot;.  They will <i>probably</i> execute in that order but it is not guaranteed."}], "answers": [{"tags": [], "owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "is_accepted": false, "score": 1, "last_activity_date": 1555528334, "last_edit_date": 1555528334, "creation_date": 1555517910, "answer_id": 55732060, "question_id": 55730243, "link": "https://stackoverflow.com/questions/55730243/visible-sequence-of-side-effects/55732060#55732060", "title": "Visible sequence of side effects", "body": "<p>The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2310.pdf\" rel=\"nofollow noreferrer\">working draft</a> of the C2x standard incorporates the changes that were made in the C17 (\"bugfix\") standard. The primary purpose of the changes to this section are to align the memory coherence models between C++ and C, and remove the redundancy as noted in the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_406.htm\" rel=\"nofollow noreferrer\">DR406</a> Defect Report.</p>\n\n<p>As you can see, the committee has gone to great pains to try and clarify the memory coherence model and simplify what constitutes a \"data race\".</p>\n\n<p>The tricky part is that only one of the changes in the C17 bugfix is \"normative\", meaning that conforming implementations won't have to consider the changes to this section until the C2x standard is finalized.</p>\n\n<p>As far as your interpretation of the <em>existing</em> section of the current standard, I'd have to say it's a moot point. The standards committee acknowledges the confusion and ambiguity in the current version, and you would probably be better served to wait until this section has a chance to settle down under the new C2x standard before worrying too much about it.</p>\n\n<blockquote>\n  <p><strong>16</strong> An evaluation A <em>inter-thread happens before</em> an evaluation B if A synchronizes with B, A is\n   dependency-ordered before B, or, for some evaluation X:  </p>\n  \n  <ul>\n  <li>A synchronizes with X and X is sequenced before B,</li>\n  <li>A is sequenced before X and X inter-thread happens before B, or</li>\n  <li><p>A inter-thread happens before X and X inter-thread happens before B.  </p>\n  \n  <hr>\n  \n  <p>15)The \"carries a dependency\" relation is a subset of the \"sequenced before\" relation, and is similarly strictly intra-thread.<br>\n  16)The \"dependency-ordered before\" relation is analogous to the \"synchronizes with\" relation, but uses release/consume in\n  place of release/acquire.  </p></li>\n  </ul>\n  \n  <p><strong>17</strong> NOTE 7 The \"inter-thread happens before\" relation describes arbitrary concatenations of \"sequenced before\", \"synchronizes\n  with\", and \"dependency-ordered before\" relationships, with two exceptions. The first exception is that a concatenation is\n  not permitted to end with \"dependency-ordered before\" followed by \"sequenced before\". The reason for this limitation is\n  that a consume operation participating in a \"dependency-ordered before\" relationship provides ordering only with respect\n  to operations to which this consume operation actually carries a dependency. The reason that this limitation applies only\n  to the end of such a concatenation is that any subsequent release operation will provide the required ordering for a prior\n  consume operation. The second exception is that a concatenation is not permitted to consist entirely of \"sequenced before\".\n  The reasons for this limitation are (1) to permit \"inter-thread happens before\" to be transitively closed and (2) the \"happens\n  before\" relation, defined below, provides for relationships consisting entirely of \"sequenced before\".</p>\n  \n  <p><strong>18</strong> An evaluation A <em>happens before</em> an evaluation B if A is sequenced before B or A inter-thread happens\n  before B. The implementation shall ensure that no program execution demonstrates a cycle in the\n  \"happens before\" relation.</p>\n  \n  <p><strong>19</strong> NOTE 8 This cycle would otherwise be possible only through the use of consume operations.</p>\n  \n  <p><strong>20</strong> A visible side effect A on an object M with respect to a value computation B of M satisfies the\n  conditions:  </p>\n  \n  <ul>\n  <li>A happens before B, and</li>\n  <li>there is no other side effect X to M such that A happens before X and X happens before B.\n  The value of a non-atomic scalar object M, as determined by evaluation B, shall be the value stored\n  by the visible side effect A.</li>\n  </ul>\n  \n  <p><strong>21</strong> NOTE 9 If there is ambiguity about which side effect to a non-atomic object is visible, then there is a data race and the\n  behavior is undefined.</p>\n  \n  <p><strong>22</strong> NOTE 10 This states that operations on ordinary variables are not visibly reordered. This is not actually detectable without\n  data races, but it is necessary to ensure that data races, as defined here, and with suitable restrictions on the use of atomics,\n  correspond to data races in a simple interleaved (sequentially consistent) execution.</p>\n  \n  <p><strong>23</strong> The value of an atomic object M, as determined by evaluation B, shall be the value stored by some\n  side effect A that modifies M, where B does not happen before A.</p>\n  \n  <p><strong>24</strong> NOTE 11 The set of side effects from which a given evaluation might take its value is also restricted by the rest of the rules\n  described here, and in particular, by the coherence requirements below.</p>\n  \n  <p><strong>25</strong> If an operation A that modifies an atomic object M happens before an operation B that modifies M,\n  then A shall be earlier than B in the modification order of M.</p>\n  \n  <p><strong>26</strong> NOTE 12 The requirement above is known as \"write-write coherence\".</p>\n  \n  <p><strong>27</strong> If a value computation A of an atomic object M happens before a value computation B of M, and A\n  takes its value from a side effect X on M, then the value computed by B shall either be the value\n  stored by X or the value stored by a side effect Y on M, where Y follows X in the modification\n  order of M.</p>\n  \n  <p><strong>28</strong> NOTE 13 The requirement above is known as \"read-read coherence\".</p>\n  \n  <p><strong>29</strong> If a value computation A of an atomic object M happens before an operation B on M, then A shall\n  take its value from a side effect X on M, where X precedes B in the modification order of M.</p>\n  \n  <p><strong>30</strong> NOTE 14 The requirement above is known as \"read-write coherence\".</p>\n  \n  <p><strong>31</strong> If a side effect X on an atomic object M happens before a value computation B of M, then the\n  evaluation B shall take its value from X or from a side effect Y that follows X in the modification\n  order of M.</p>\n  \n  <p><strong>32</strong> NOTE 15 The requirement above is known as \"write-read coherence\".</p>\n  \n  <p><strong>33</strong> NOTE 16 This effectively disallows compiler reordering of atomic operations to a single object, even if both operations are\n  \"relaxed\" loads. By doing so, it effectively makes the \"cache coherence\" guarantee provided by most hardware available to C\n  atomic operations.</p>\n  \n  <p><strong>34</strong> NOTE 17 The value observed by a load of an atomic object depends on the \"happens before\" relation, which in turn depends\n  on the values observed by loads of atomic objects. The intended reading is that there exists an association of atomic loads\n  with modifications they observe that, together with suitably chosen modification orders and the \"happens before\" relation\n  derived as described above, satisfy the resulting constraints as imposed here.</p>\n</blockquote>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1555528334, "creation_date": 1555512054, "last_edit_date": 1555513993, "question_id": 55730243, "link": "https://stackoverflow.com/questions/55730243/visible-sequence-of-side-effects", "title": "Visible sequence of side effects", "body": "<p>I was confused by the definition of the <strong>visible sequence of side effects</strong> concept defined at <code>5.1.2.4(p22)</code>:</p>\n\n<blockquote>\n  <p>The visible sequence of side effects on an atomic object <code>M</code>, with\n  respect to a value computation <code>B</code> of <code>M</code>, is a maximal contiguous\n  sub-sequence of side effects in the modification order of <code>M</code>, where the\n  first side effect is visible with respect to <code>B</code>, and for every\n  subsequent side effect, it is not the case that <code>B</code> happens before it.</p>\n</blockquote>\n\n<p>Here is my current understanding of the concept:</p>\n\n<p>Since the visible side effect with respect to B should be the \"closest one happens before <code>B</code>\" side effect I can imagine the following case:</p>\n\n<pre><code>_Atomic int i = 10;\n\nvoid *increment(void *ignored){\n    i++;\n    printf(\"%d\\n\", i); //&lt;&lt;----- B\n}\n\nvoid *decrement(void *ignored){\n    i--;\n    printf(\"%d\\n\", i);\n}\n\nint main(void){\n   i = 100;\n   //start two threads with increment and decrement correspondingly\n}\n</code></pre>\n\n<p>Considering the case above I assumed that <code>B</code> is the value computation in the <code>increment</code> function so the visible sequence of side effects with respect to <code>B</code> is \"<code>i++</code>, <code>i--</code>\". Since <code>i = 100</code> is sequenced before creation of the threads it does not belong to visible sequence of side effects with respect to <code>B</code>.</p>\n\n<p>Does my interpretation mean what it really is?</p>\n"}, {"tags": ["android", "c", "linux", "android-ndk", "root"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1555510895, "post_id": 55729619, "comment_id": 98138445, "body": "<code>I need to access the location which requires root access</code> In user build you need to adhere to SE policies."}, {"owner": {"reputation": 15397, "user_id": 3290339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CMy5l.jpg?s=128&g=1", "display_name": "Onik", "link": "https://stackoverflow.com/users/3290339/onik"}, "edited": false, "score": 0, "creation_date": 1555519903, "post_id": 55729619, "comment_id": 98143652, "body": "What about creating a folder with required permissions through <code>shell</code> and put the executable there?"}, {"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "edited": false, "score": 0, "creation_date": 1555554457, "post_id": 55729619, "comment_id": 98154124, "body": "The executable is actually trying to get some data from <code>dev&#47;diag</code> port and it requires su permissions. Putting a executable in a folder with su permissions doesn&#39;t help. I have also tried giving diag port global permissions i.e. <code>chmod 777 dev&#47;diag</code> but it also didn&#39;t help."}, {"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "edited": false, "score": 0, "creation_date": 1555559821, "post_id": 55729619, "comment_id": 98155139, "body": "I have an idea: Is it possible if we can run adb shell from within the android app. If yes, then I can get su permissions within adb by running &#39;su&#39; command and then I can run executable. Please suggest."}, {"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1555560950, "post_id": 55729619, "comment_id": 98155383, "body": "@kiranBiradar Please explain a little more about how we can adhere SE policies for an app and Is it will enable access on diag port without fully rooting the device?"}], "owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555510851, "creation_date": 1555510376, "last_edit_date": 1555510851, "question_id": 55729619, "link": "https://stackoverflow.com/questions/55729619/how-to-run-executableneed-su-permission-code-in-android-application-on-a-partl", "title": "How to run executable(need su permission) code in android application on a partly rooted device", "body": "<p>I have a partly rooted android device that means the root access is only available in adb shell. I can not fully root that device.</p>\n\n<p>I am working on an app where I need to access the location which requires root access. Its a NDK code. I have make an executable and placed that executable in system folder. Then I have given the permissions with 'chmod 777 executable'. I am able to run that executable from adb shell with su permissions.\nNow, I want to run same executable from within android. Please let me know how can I give root access within my android application to run the executable with code like <code>su -c executable</code>.</p>\n\n<p>Please note that I can not install Magisk or SuperSu in that device. This is not acceptable solution. But I can do anything from adb shell. I have searched a lot and I have a solution which may work:</p>\n\n<ul>\n<li>Create a new user <code>adb shell pm create-user name</code></li>\n<li>Give su permissions to that user. I didn't find a way to give su permissions to user.</li>\n<li>Run the application from newly created user space. I am not sure how it will be done.</li>\n</ul>\n\n<p>I am not sure if it will be a successfully solution if I would know above things. </p>\n\n<p>I shall be very thankful to you if you will help me.</p>\n\n<p>Best Regards,</p>\n\n<p>Vatish</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1555510337, "post_id": 55729483, "comment_id": 98138039, "body": "The problem doesn&#39;t appear to be in the code posted. As a side note not related to the bug you describe, the sum function should be rewritten as <code>for(int i=0; i&lt;c; i++) { sum += x[i]; }</code>."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1555510537, "post_id": 55729483, "comment_id": 98138177, "body": "Can you show how you are reading the matrix(<code>getMatrix</code>)?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1555510624, "post_id": 55729483, "comment_id": 98138241, "body": "Please rea this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555511188, "post_id": 55729483, "comment_id": 98138626, "body": "the posted code is missing the prototypes for functions: ` <code>getMatrix()</code> and <code>display()</code> and is missing the `#include`` statements for any needed header files"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555511307, "post_id": 55729483, "comment_id": 98138698, "body": "OT:  variable (and parameter) names should indicate <code>content</code> or <code>usage</code> (or better, both).  names like: a[][], r, c, are meaningless even the current context"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555511476, "post_id": 55729483, "comment_id": 98138807, "body": "OT: regarding: <code>scanf(&quot;%d%d&quot;, &amp;r, &amp;c);</code>  when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful.  Those functions return the number of successful input conversion specifications.  (in this case any returned value other than 2 indicates an error occurred"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1555511609, "post_id": 55729483, "comment_id": 98138891, "body": "regarding: <code>for(i = 0; i &lt; c; i++)</code>   This should be counting the number of rows, not the number of columns"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555512006, "post_id": 55729483, "comment_id": 98139149, "body": "OT: regarding: <code>int sum(int c, int x[c]) {     int sum = 0;</code>   and <code>return sum;</code>   it is a very poor programming practice to name a local variable the same as the function containing that variable"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555512454, "post_id": 55729483, "comment_id": 98139460, "body": "regarding: <code>int a[7][7]</code>  how do you know the values entered by the user for number rows and number of columns will both be 7?    Suggest using the VLA (Variable Length Array) feature of C and not declare that array until after the statement: <code>scanf(&quot;%d%d&quot;, &amp;r, &amp;c);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555512574, "post_id": 55729483, "comment_id": 98139542, "body": "OT:  never trust the user to do the right thing.  Strongly suggest checking the values &#39;r&#39; and &#39;c&#39; to assure they are both above 0 (and not too large)"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555605133, "post_id": 55729483, "comment_id": 98177249, "body": "@Lundin The user has added the missing functions to the question, so I think it should no longer be on hold."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "edited": false, "score": 0, "creation_date": 1555603633, "post_id": 55731341, "comment_id": 98176561, "body": "Hello, Mr. Bodo. I&#39;ve edited the post and also shared the code of display () and getMatrix () functions. Please go through it. And reply if you find any discrepancy."}, {"owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "edited": false, "score": 0, "creation_date": 1555606609, "post_id": 55731341, "comment_id": 98177906, "body": "Thank you! The problem is solved, after following your suggestion."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 0, "last_activity_date": 1555604939, "last_edit_date": 1555604939, "creation_date": 1555515471, "answer_id": 55731341, "question_id": 55729483, "link": "https://stackoverflow.com/questions/55729483/passing-row-of-2-dimensional-array-in-c/55731341#55731341", "title": "Passing Row of 2-Dimensional Array in C", "body": "<p>The error is not in the code visible in the question.</p>\n\n<p>As you didn't show the functions <code>getMatrix</code> and <code>display</code>, I created a minimal example that uses the matrix shown in your question.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint sum(int c, int x[c])\n{\n    int sum = 0;\n\n    for(--c; c &gt;= 0; c--)    \n        sum = sum + x[c];\n\n    return sum;\n}\n\nint main()\n{\n    int a[7][7] = { { 1, 2, 3 }, { 4, 5, 6 }, { 7, 8, 9 } };\n    int r = 3, c = 3, i;\n\n    for(i = 0; i &lt; r; i++) /* since your example has 3 rows and 3 columns you would not notice the wrong loop limit here (c instead of r) */\n        printf(\"%d \\n\", sum(c, a[i]));\n}\n</code></pre>\n\n<p>This prints </p>\n\n<pre><code>6 \n15 \n24 \n</code></pre>\n\n<p>as expected.</p>\n\n<p>I guess function <code>getMatrix</code> doesn't put the data to the correct array elements.<br>\nProbably it uses the number of rows and columns specified as function arguments instead of the real array size <code>int a[7][7]</code>.</p>\n\n<p>Edit: After the missing functions have been added to the question, it is clear that <code>getMatrix</code> and <code>display</code> do not correctly access the array.</p>\n\n<p>When you declare the function as</p>\n\n<pre><code>void getMatrix(int r, int c, int x[][c])\n</code></pre>\n\n<p>and call the function with e.g <code>c=3</code> the function thinks that you are passing an array with 3 columns while in main you declared <code>a[7][7]</code> to have 7 columns. The calculation of the memory location for a two-dimensional array needs the correct number of columns.</p>\n\n<p>A quick fix for your original program would be to declare the functions as</p>\n\n<pre><code>void getMatrix(int r, int c, int x[][7])\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void display (int r, int c, int x[][7])\n</code></pre>\n\n<p>Instead of using a magic number 7 I suggest to use a <code>#define</code> both for declaring the array <code>a</code> and for the function arguments.</p>\n\n<p>BTW: Compare your program with the code in this answer. I fixed the loop around <code>printf(... sum...)</code> which counts the rows, not the columns.</p>\n\n<p>A better solution would be to dynamically allocate the memory for array <code>a</code> based on the number of rows and columns and calculate the index yourself, e.g.</p>\n\n<pre><code>index = selected_row * number_of_columns + selected_column;\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "closed_date": 1555529965, "accepted_answer_id": 55731341, "answer_count": 1, "score": -2, "last_activity_date": 1555604939, "creation_date": 1555510044, "last_edit_date": 1555603551, "question_id": 55729483, "link": "https://stackoverflow.com/questions/55729483/passing-row-of-2-dimensional-array-in-c", "closed_reason": "Not suitable for this site", "title": "Passing Row of 2-Dimensional Array in C", "body": "<p>My objective is to write a simple code that intends to find the sum of all the rows of a matrix. For doing this task I've made a function <code>sum(int c int x[])</code>. In this function, the first argument is the number of columns, and the second argument is a one-dimensional array. The second parameter is supposed to receive a particular row of the matrix at a time so that I can calculate the sum of the elements of it.</p>\n\n<p>For the first row the output is all right, but from the second row onward the output is garbage.</p>\n\n<p>For example, if I give this input matrix ...</p>\n\n<pre><code>1  2  3\n4  5  6\n7  8  9\n</code></pre>\n\n<p>... then the desired output is:</p>\n\n<pre><code>6\n15\n24\n</code></pre>\n\n<p>but, actually I'm getting something like this:</p>\n\n<pre><code>6\n2004638605\n1346689939\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>int sum(int c, int x[c])\n{\n    int sum = 0;\n\n    for(--c; c &gt;= 0; c--)    \n        sum = sum + x[c];\n\n    return sum;\n}\n\nvoid getMatrix(int r, int c, int x[][c])\n{\n     int i, j;\n\n     for(i = 0; i &lt; r; i++)\n     {\n          for(j = 0; j &lt; c; j++)\n          {\n               printf(\"Enter a No. = \");\n               scanf(\"%d\", &amp;x[i][j]);\n          }\n     }\n}\n\nvoid display (int r, int c, int x[][c])\n{\n     int i, j;\n\n     for(i = 0; i &lt; r; i++)\n     {\n          for(j = 0; j &lt; c; j++)\n          {\n               printf(\"%d \\t\", x[i][j]);\n          }\n          printf(\"\\n\");\n     }\n}\nint main()\n{\n    int a[7][7], r, c, i;\n\n    printf(\"Enter the Dimensions of the Matrix: \");\n    scanf(\"%d%d\", &amp;r, &amp;c);\n\n    getMatrix(r, c, a);\n\n    printf(\"SHOWING MATRIX : \\n\");\n    display(r, c, a);\n\n    for(i = 0; i &lt; r; i++)\n        printf(\"%d \\n\", sum(c, a[i]));\n}\n</code></pre>\n\n<p>I'm trying to compile and run this code using the TDM GCC compiler.</p>\n"}, {"tags": ["c", "embedded", "stm32", "qemu"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1555508686, "post_id": 55728952, "comment_id": 98136914, "body": "I would consider it a QEMU bug. Try a different version?"}, {"owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1555510172, "post_id": 55728952, "comment_id": 98137920, "body": "Weird thing is it works for another custom machine that was added before. Do I still need to install and check with another version?"}, {"owner": {"reputation": 5487, "user_id": 4499941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wb0uIu6LiPk/AAAAAAAAAAI/AAAAAAAAABI/HOVGfYywvPE/photo.jpg?sz=128", "display_name": "Peter Maydell", "link": "https://stackoverflow.com/users/4499941/peter-maydell"}, "edited": false, "score": 1, "creation_date": 1556530174, "post_id": 55728952, "comment_id": 98456981, "body": "Your new code in stm32f407ve_scu_init() is passing a NULL pointer as the first argument to armv7m_load_kernel(), which is a bug in your code which eventually makes the code inside that function crash with a segmentation fault. You need to find out what you&#39;re doing wrong that means you don&#39;t have a valid pointer to the CPU."}, {"owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "edited": false, "score": 0, "creation_date": 1557215391, "post_id": 55728952, "comment_id": 98679629, "body": "armv7m_load_kernel(ARM_CPU(first_cpu), machine-&gt;kernel_filename, 2 * 1024 * 1024); I&#39;m sending the arguments as required by the syntax. Could you also please explain how you came to this conclusion , so that I can understand it myself next time? Thanks"}, {"owner": {"reputation": 5487, "user_id": 4499941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wb0uIu6LiPk/AAAAAAAAAAI/AAAAAAAAABI/HOVGfYywvPE/photo.jpg?sz=128", "display_name": "Peter Maydell", "link": "https://stackoverflow.com/users/4499941/peter-maydell"}, "edited": false, "score": 1, "creation_date": 1557492474, "post_id": 55728952, "comment_id": 98793992, "body": "You can see in the backtrace the arguments to armv7m_load_kernel(), and that cpu=0x0. That is a bug in the calling code. If you&#39;re using &quot;ARM_CPU(first_cpu)&quot; as the argument, the problem is that you&#39;re calling armv7m_load_kernel() without having actually created any CPUs."}], "owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1233, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555508571, "creation_date": 1555508571, "question_id": 55728952, "link": "https://stackoverflow.com/questions/55728952/segmentation-fault-core-dumped-in-qemu-when-custom-machine-is-added", "title": "Segmentation fault (core dumped) in QEMU when custom machine is added", "body": "<p>I am trying to build a custom machine in QEMU for STM32 machine and  I have written a simple code to add the machine to the QEMU <code>-machine help</code> list. I have also written a code where I can add all peripherals (general file /main file)</p>\n\n<p>But when I run the code I get <code>Segmentation fault (core dumped)</code> error. When I commented some part , I could pinpoint where I was getting the error:</p>\n\n<pre><code>static Property stm32f407_soc_properties[] = {\n    DEFINE_PROP_STRING(\"cpu-type\", struct stm32f407_soc,cpu_type),\n    DEFINE_PROP_END_OF_LIST(),\n\n};\n</code></pre>\n\n<p>I was getting the error when I fetch the <code>CPU-type</code>. Further when I debugged through GDB, it gave some information as below which I do not understand :</p>\n\n<pre><code>(gdb) run -machine stm32f407ve_scu -kernel test.elf\nStarting program: /usr/local/bin/qemu-system-arm -machine stm32f407ve_scu -kernel test.elf\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7fffe7e4f700 (LWP 3487)]\n[New Thread 0x7fffe764e700 (LWP 3490)]\n[New Thread 0x7fffe69dc700 (LWP 3500)]\n[New Thread 0x7fffe61db700 (LWP 3501)]\n\nThread 1 \"qemu-system-arm\" received signal SIGSEGV, Segmentation fault.\n0x00005555557ea571 in cpu_get_address_space (cpu=0x0, asidx=1) at /home/sups/Documents/stm32/qemu/exec.c:930\n930     return cpu-&gt;cpu_ases[asidx].as;\n(gdb) where\n#0  0x00005555557ea571 in cpu_get_address_space (cpu=0x0, asidx=1) at /home/sups/Documents/stm32/qemu/exec.c:930\n#1  0x00005555559700c6 in armv7m_load_kernel (cpu=0x0, kernel_filename=0x5555568afa00 \"test.elf\", mem_size=2097152)\n    at /home/sups/Documents/stm32/qemu/hw/arm/armv7m.c:297\n#2  0x0000555555999e3e in stm32f407ve_scu_init (machine=0x555556783f00) at /home/sups/Documents/stm32/qemu/hw/arm/stm32f407ve_scu.c:57\n#3  0x0000555555ae9ed9 in machine_run_board_init (machine=0x555556783f00) at hw/core/machine.c:830\n#4  0x0000555555a40372 in main (argc=5, argv=0x7fffffffde98, envp=0x7fffffffdec8) at vl.c:4516\n</code></pre>\n\n<p>I opened all the files mentioned in the errors above and checked what line the errors are and all these lines correspond to machine calls. But I do not know what should I be changing?</p>\n\n<p>Can someone help me?\nThank you.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 327, "user_id": 5797576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3db55e797f0fa188c6ab0025670a6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jain", "link": "https://stackoverflow.com/users/5797576/rahul-jain"}, "edited": false, "score": 0, "creation_date": 1555508865, "post_id": 55728950, "comment_id": 98137033, "body": "Hi @Jens, you can&#39;t do <code>R = z;</code> in the function householder. You have to copy the content of z in R. C uses pass by value. So pointer&#39;s value is passed in R, now you have to change the content of R instead of pointing it to some other memory location. What you are doing is pointing the householder&#39;s R variable to other location while the original pointer is still pointing to older memory location."}, {"owner": {"reputation": 432, "user_id": 4249714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3cdf02d97c4849cdd40b4bfde7f458?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian", "link": "https://stackoverflow.com/users/4249714/sebastian"}, "edited": false, "score": 0, "creation_date": 1555509062, "post_id": 55728950, "comment_id": 98137169, "body": "with <code>Q = q[0];</code> and <code>R = matrix_mul(m,m,n,q[0], A);</code> you are losing the pointers to the outer matrices you instantiated in the main"}, {"owner": {"reputation": 327, "user_id": 5797576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3db55e797f0fa188c6ab0025670a6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jain", "link": "https://stackoverflow.com/users/5797576/rahul-jain"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555509140, "post_id": 55728950, "comment_id": 98137228, "body": "@Lundin this is little different. Sure it can be duplicate of some other existing question but not duplicate to what you mentioned"}, {"owner": {"reputation": 1, "user_id": 9660263, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215714489233291/picture?type=large", "display_name": "Jens &#216;stergaard", "link": "https://stackoverflow.com/users/9660263/jens-%c3%98stergaard"}, "reply_to_user": {"reputation": 327, "user_id": 5797576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3db55e797f0fa188c6ab0025670a6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jain", "link": "https://stackoverflow.com/users/5797576/rahul-jain"}, "edited": false, "score": 0, "creation_date": 1555509303, "post_id": 55728950, "comment_id": 98137344, "body": "@RahulJain Aha, okay, that makes alot of sence. I understand why it is not giving the correct result. Thank you!  Also to you sebastian, as far as i understand you are explaining the same mistake"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 327, "user_id": 5797576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3db55e797f0fa188c6ab0025670a6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jain", "link": "https://stackoverflow.com/users/5797576/rahul-jain"}, "edited": false, "score": 1, "creation_date": 1555509346, "post_id": 55728950, "comment_id": 98137378, "body": "@RahulJain <code>R</code> isn&#39;t returned to the caller so it is an exact duplicate (and a memory leak)."}], "owner": {"reputation": 1, "user_id": 9660263, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215714489233291/picture?type=large", "display_name": "Jens &#216;stergaard", "link": "https://stackoverflow.com/users/9660263/jens-%c3%98stergaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1555509036, "answer_count": 0, "score": 0, "last_activity_date": 1555508565, "creation_date": 1555508565, "question_id": 55728950, "link": "https://stackoverflow.com/questions/55728950/how-to-pass-a-pointerarray-though-function-in-c-qr-factorization", "closed_reason": "Duplicate", "title": "How to pass a pointer(array) though function in c, qr factorization", "body": "<p>When passing the two pointers Q and R through the householders the code works within the function (seen by the print statement in final part of the function), but when printing the matrix ouside (in the main) other values are present. </p>\n\n<p>I have tried to move operations around slightly such that Q=&amp;q[0],*Q=*q[0] and similarly (mostly randomly as I belive I have miss understod the way the pointers function).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void householder(int m, int n, float *A , float *R, float *Q){\n    float *q[m];\n    for (int i=0;i&lt;m;i++) q[i]=malloc(sizeof(float)*m*m);\n    float *z =A;\n    float *z1 =malloc(sizeof(float)*m*n);\n\n    for (int k = 0; k &lt; n &amp;&amp; k &lt; m - 1; k++) {\n        float e[m], x[m], a;\n        z1 = matrix_minor(m,n,k,z);\n        z = z1;\n        sub_matrix(m, n,  z,x,k);\n        a = norm(m,x);\n        if (A[k*n+k] &gt; 0) a = -a;\n        for (int i = 0; i &lt; m; i++)\n            e[i] = (i == k) ? 1 : 0;\n\n        vadd(x, e, a, e, m);\n        vdiv(e, norm(m,e), e, m);\n        q[k] = vmul(e, m);\n        z1 = matrix_mul(m,m,n,q[k], z);\n        z = z1;\n        }\n\n    Q = q[0];\n    R = matrix_mul(m,m,n,q[0], A);\n    for (int i = 1; i &lt; n &amp;&amp; i &lt; m - 1; i++) {\n        z1 = matrix_mul(m,m,m,q[i], Q);\n        Q = z1;\n        free(q[i]);\n    }\n    z = matrix_mul(m,m,n,Q, A);\n    R = z;\n    print_matrix(\"R\",m,n,R);\n\n    matrix_transpose(m,m,Q);\n    print_matrix(\"Q\",m,m,Q);\n}\n</code></pre>\n\n<p>and the main</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(int argc, char const *argv[])\n{\n    int m = 5, n=3;\n    float A[15] = {\n                       12, -51,   4,\n                       6 , 167, -68,\n                       -4,  24, -41,\n                       -1,   1,   0,\n                       2,   0,   3 };\n    float *Am,*v=malloc(sizeof(float)*n);\n    float *R=malloc(sizeof(float)*n*m);\n        float *Q=malloc(sizeof(float)*m*m);\n    print_matrix(\"A\",m,n,A);\n    householder( m,  n,  A ,  R,  Q);\n\n    print_matrix(\"R\",m,n,R);\n    print_matrix(\"Q\",m,m,Q);\n\n    return 0;\n}\n\n</code></pre>\n\n<p>output is </p>\n\n<pre><code>A\n    12.0000   -51.0000     4.0000\n     6.0000   167.0000   -68.0000\n    -4.0000    24.0000   -41.0000\n    -1.0000     1.0000     0.0000\n     2.0000     0.0000     3.0000\n\n R\n    14.1774    20.6666   -13.4016\n    -0.0000   175.0425   -70.0803\n     0.0000    -0.0000   -35.2015\n     0.0000    -0.0000    -0.0000\n    -0.0000     0.0000    -0.0000\n\n Q\n     0.8464    -0.3913     0.3431     0.0815     0.0781\n     0.4232     0.9041    -0.0293     0.0258     0.0447\n    -0.2821     0.1704     0.9329    -0.0474    -0.1374\n    -0.0705     0.0140    -0.0011     0.9804    -0.1836\n     0.1411    -0.0167    -0.1058    -0.1713    -0.9692\n\n R\n     0.0000    -0.0000     0.0000\n    -0.0000    -0.0000     0.0000\n 418152196615397717957410816.0000     0.0000    -0.0000\n     0.0000 421847669749172099851747328.0000     0.0000\n     0.0000     0.0000     0.0000\n\n Q\n     0.0000    -0.0000     0.0000    -0.0000     0.0000\n     0.0000     0.0000     0.0000     0.0000     0.0000\n     0.0000     0.0000     0.0000     0.0000     0.0000\n     0.0000     0.0000     0.0000     0.0000     0.0000\n     0.0000     0.0000     0.0000     0.0000     0.0000\n</code></pre>\n\n<p>Where the first pair R and Q are correct and printed from the function, where the last pair is the print from the main. </p>\n\n<p>m and n are dimensions of the A matrix.</p>\n"}, {"tags": ["c", "libssh2"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1556448717, "post_id": 55728938, "comment_id": 98436091, "body": "which libssh2 version are you using?"}, {"owner": {"reputation": 19204, "user_id": 15862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453f52b2c079b3902a400efc47282fb4?s=128&d=identicon&r=PG", "display_name": "Tometzky", "link": "https://stackoverflow.com/users/15862/tometzky"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1556485139, "post_id": 55728938, "comment_id": 98445452, "body": "I&#39;m testing on libssh2-1.8.1 64bit against openssh 7.8p1 (both included in my Fedora 28 workstation)."}, {"owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1556545289, "post_id": 55728938, "comment_id": 98464766, "body": "Could you add some more info about how to reproduce this? When I try it I get <code>connect: Connection refused</code> -- perhaps some service(s) need to be running on localhost? Maybe something more, like preparing a test user with testusername and testpassword? It would be helpful if you could list all steps needed to run your test case, to arrive at the &quot;internal error&quot; problem."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1556778773, "post_id": 55728938, "comment_id": 98546252, "body": "@Elias you should connect to a working ssh server, you need to customize the command line OP posted."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556775663, "post_id": 55945440, "comment_id": 98545124, "body": "Wait! That looks familiar... <a href=\"https://midnight-commander.org/ticket/3406\" rel=\"nofollow noreferrer\">Midnight Commander - #3406 (-31: SFTP Protocol Error when transferring file via SFTP Link</a>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1556778777, "post_id": 55945440, "comment_id": 98546256, "body": "This is not an answer. I too, can replicate the behavior, same with blocking. I don&#39;t know if the problem lies in the libssh2_sftp_read state machine, or this is expected."}, {"owner": {"reputation": 19204, "user_id": 15862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453f52b2c079b3902a400efc47282fb4?s=128&d=identicon&r=PG", "display_name": "Tometzky", "link": "https://stackoverflow.com/users/15862/tometzky"}, "edited": false, "score": 0, "creation_date": 1556788855, "post_id": 55945440, "comment_id": 98551068, "body": "When you remove the <code>libssh2_session_set_blocking(session, 0)</code> I think you actually remove any pipelining from the protocol, so it&#39;s not actually very similar to the problem I&#39;m originally trying to reproduce. Also - you can install debug symbols for libraries on most distributions - on my Fedora you just need to run <code>sudo dnf install libssh2-debuginfo --enablerepo=fedora-debuginfo --enablerepo=updates-debuginfo</code>."}, {"owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "reply_to_user": {"reputation": 19204, "user_id": 15862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453f52b2c079b3902a400efc47282fb4?s=128&d=identicon&r=PG", "display_name": "Tometzky", "link": "https://stackoverflow.com/users/15862/tometzky"}, "edited": false, "score": 0, "creation_date": 1556854185, "post_id": 55945440, "comment_id": 98576956, "body": "Yep, @Tometzky you&#39;re right -- removing the line just makes it block, so that&#39;s no solution."}, {"owner": {"reputation": 3230, "user_id": 6071729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpjDR.jpg?s=128&g=1", "display_name": "A Farmanbar", "link": "https://stackoverflow.com/users/6071729/a-farmanbar"}, "edited": false, "score": 0, "creation_date": 1557045001, "post_id": 55945440, "comment_id": 98628419, "body": "@TrevorKeller 1+ for your efforts ."}], "tags": [], "owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "is_accepted": false, "score": 2, "last_activity_date": 1556775281, "last_edit_date": 1556775281, "creation_date": 1556769064, "answer_id": 55945440, "question_id": 55728938, "link": "https://stackoverflow.com/questions/55728938/libssh2-sftp-pipelining-multiple-files-sftp-read-internal-error/55945440#55945440", "title": "libssh2 SFTP pipelining multiple files: sftp_read() internal error", "body": "<p>Interesting. I'm using <code>libssh2 1.8.1-1</code> on Arch. I pasted your code into <code>sftp_multifile.c</code>, created a Makefile with </p>\n\n<pre><code>sftp_multifile: sftp_multifile.c\n    gcc -g -O -Wall $&lt; -o $@ -lssh2\n</code></pre>\n\n<p>and wrote the args into <code>55728938.&lt;count&gt;</code> (not going to post that here ;-). With only one file, I get</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ./sftp_multifile $(cat 55728938.one)\nconnect try: ai_family=10 ai_socktype=1 ai_protocol=6 addr=::1 port=22\nopening: path/text1\nreading: path/text1 from 94221524604816 to 140729241245632\nread result: -37\nreading: path/text1 from 94221524604816 to 140729241245632\nread result: 21\nreading: path/text1 from 94221524604816 to 140729241245632\nread result: -37\nreading: path/text1 from 94221524604816 to 140729241245632\nread result: 0\npath/text1: So much depends\nupon\n</code></pre>\n\n<p>... looks good to me. But with two or more files,</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ./sftp_multifile $(cat 55728938.two)\nconnect try: ai_family=10 ai_socktype=1 ai_protocol=6 addr=::1 port=22\nopening: path/text1\nopening: path/text2\nreading: path/text1 from 94473513555856 to 140727557764112\nread result: -37\nreading: path/text2 from 94473513556256 to 140727557765136\nread result: -31\nBad read result: -31\nRead error: path/text2: sftp_read() internal error\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ./sftp_multifile $(cat 55728938.three)\nconnect try: ai_family=10 ai_socktype=1 ai_protocol=6 addr=::1 port=22\nopening: path/text1\nopening: path/text2\nopening: path/text3\nreading: path/text1 from 94652164568976 to 140727538608784\nread result: -37\nreading: path/text2 from 94652164569376 to 140727538609808\nread result: -31\nBad read result: -31\nRead error: path/text2: sftp_read() internal error\n</code></pre>\n\n<p>This is consistent with what you saw. Since the packaged <code>libssh2</code> was not built with debugging symbols, <code>gdb</code> doesn't help much. I'd suggest taking this up with the <a href=\"https://www.libssh2.org/mail.cgi\" rel=\"nofollow noreferrer\">libssh2 mailing list</a>.</p>\n\n<p><em>Edit to add</em>:</p>\n\n<p>Removing the line <code>libssh2_session_set_blocking(session, 0);</code> appears to resolve the problem. </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ make &amp;&amp; ./sftp_multifile $(cat 55728938.four)\ngcc -g -O -Wall sftp_multifile.c -o sftp_multifile -lssh2\nconnect try: ai_family=10 ai_socktype=1 ai_protocol=6 addr=::1 port=22\nopening: /home/pi/stackoverflow/text1\nopening: /home/pi/stackoverflow/text2\nopening: /home/pi/stackoverflow/text3\nopening: /home/pi/stackoverflow/text4\n4 of 4\nreading: /home/pi/stackoverflow/text1 from 5453288 to 2129740008\nread result: 21\n/home/pi/stackoverflow/text1: So much depends\nupon\n\nreading: /home/pi/stackoverflow/text1 from 5453288 to 2129740008\nread result: 0\n3 of 4\nreading: /home/pi/stackoverflow/text2 from 5453640 to 2129741032\nread result: 19\n/home/pi/stackoverflow/text2: a red wheel\nbarrow\n\nreading: /home/pi/stackoverflow/text2 from 5453640 to 2129741032\nread result: 0\n2 of 4\nreading: /home/pi/stackoverflow/text3 from 5455408 to 2129742056\nread result: 23\n/home/pi/stackoverflow/text3: glazed with rain\nwater\n\nreading: /home/pi/stackoverflow/text3 from 5455408 to 2129742056\nread result: 0\n1 of 4\nreading: /home/pi/stackoverflow/text4 from 5455760 to 2129743080\nread result: 27\n/home/pi/stackoverflow/text4: beside the white\nchickens.\n\nreading: /home/pi/stackoverflow/text4 from 5455760 to 2129743080\nread result: 0\n</code></pre>\n\n<p>All four files, present and accounted for. Results are the same on Arch (<code>libssh2-1.8</code>) and Raspbian (<code>libssh-1.7</code>).</p>\n"}], "owner": {"reputation": 19204, "user_id": 15862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453f52b2c079b3902a400efc47282fb4?s=128&d=identicon&r=PG", "display_name": "Tometzky", "link": "https://stackoverflow.com/users/15862/tometzky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1556775281, "creation_date": 1555508516, "last_edit_date": 1555508871, "question_id": 55728938, "link": "https://stackoverflow.com/questions/55728938/libssh2-sftp-pipelining-multiple-files-sftp-read-internal-error", "title": "libssh2 SFTP pipelining multiple files: sftp_read() internal error", "body": "<p>I'm trying to reproduce a problem where when some of our clients can receive a wrong file contents while downloading with SFTP protocol.</p>\n\n<p>Based on our SFTP server (CrushFTP) logs they probably open multiple files in one session and then use some pipelining to download the files. I don't know what kind of library they use as they are using some SAAS provider for this.</p>\n\n<p>I'm trying to reproduce the behavior with libssh2, but I'm getting <code>sftp_read() internal error</code> when calling libssh2_sftp_read asynchronously on the second open file after the first one returned LIBSSH2_ERROR_EAGAIN - even on localhost connection to OpenSSH.</p>\n\n<p>While browsing <a href=\"https://tools.ietf.org/html/draft-ietf-secsh-filexfer-13\" rel=\"noreferrer\">SSH File Transfer Protocol IETF Draft</a> I can see that the protocol allows for opening multiple files simultaneously and requesting their contents with multiple SSH_FXP_READ request without waiting for response.</p>\n\n<p>Below is the code I use for testing (SSCCE, but quite long - C is quite verbose) - compiled with <code>gcc sftp_multifile.c -lssh2 -Wall -g -o sftp_multifile</code> and tested with:</p>\n\n<pre><code>./sftp_multifile localhost 22 testusername testpassword /usr/share/dict/words /usr/share/doc/words/readme.txt\n\nconnect try: ai_family=10 ai_socktype=1 ai_protocol=6 addr=::1 port=22\nopening: /usr/share/dict/words\nopening: /usr/share/doc/words/readme.txt\nreading: /usr/share/dict/words from 10134400 to 140736927200896\nread result: -37\nreading: /usr/share/doc/words/readme.txt from 10135536 to 140736927201920\nread result: -31\nBad read result: -31\nRead error: /usr/share/doc/words/readme.txt: sftp_read() internal error\n</code></pre>\n\n<p>Did I make an error in my code or does libssh2 just not support pipelining libssh2_sftp_read for multiple open files or maybe it's just a bug in libssh2 that should be reported to its maintainer?</p>\n\n<pre><code>#include &lt;libssh2.h&gt;\n#include &lt;libssh2_sftp.h&gt;\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;poll.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define CHUNK_SIZE (1024)\n\nint sftp_connect(char const* hostname, char const* port)\n{\n    struct addrinfo* addrinfo_result, *addrinfo_current;\n    int sfd, s;\n    struct addrinfo addrinfo_hints = {0};\n    addrinfo_hints.ai_family = AF_UNSPEC;\n    addrinfo_hints.ai_socktype = SOCK_STREAM;\n    s = getaddrinfo(hostname, port, &amp;addrinfo_hints, &amp;addrinfo_result);\n    if (s != 0) {\n        fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(s));\n        exit(EXIT_FAILURE);\n    }\n\n    for (addrinfo_current = addrinfo_result; addrinfo_current != NULL; addrinfo_current = addrinfo_current-&gt;ai_next) {\n        char s[INET6_ADDRSTRLEN];\n        sfd = socket(addrinfo_current-&gt;ai_family, addrinfo_current-&gt;ai_socktype, addrinfo_current-&gt;ai_protocol);\n        if (sfd == -1) continue;\n        {\n            void* addr;\n            in_port_t port;\n            switch(addrinfo_current-&gt;ai_family) {\n                case AF_INET: {\n                    struct sockaddr_in* sockaddr = (struct sockaddr_in*)addrinfo_current-&gt;ai_addr;\n                    addr = &amp;(sockaddr-&gt;sin_addr);\n                    port = ntohs(sockaddr-&gt;sin_port);\n                    break;\n                }\n                case AF_INET6: {\n                    struct sockaddr_in6* sockaddr = (struct sockaddr_in6*)addrinfo_current-&gt;ai_addr;\n                    addr = &amp;(sockaddr-&gt;sin6_addr);\n                    port = ntohs(sockaddr-&gt;sin6_port);\n                    break;\n                }\n                default:\n                    fprintf(stderr, \"unknown family: %d\\n\", addrinfo_current-&gt;ai_family);\n                    exit(EXIT_FAILURE);\n            }\n            inet_ntop(addrinfo_current-&gt;ai_family, addr, s, INET6_ADDRSTRLEN);\n            fprintf(stderr, \"connect try: ai_family=%d ai_socktype=%d ai_protocol=%d addr=%s port=%d\\n\", addrinfo_current-&gt;ai_family, addrinfo_current-&gt;ai_socktype, addrinfo_current-&gt;ai_protocol, s, port);\n        }\n        if (connect(sfd, addrinfo_current-&gt;ai_addr, addrinfo_current-&gt;ai_addrlen) != 0) {\n            fprintf(stderr, \"connect: %s\\n\", strerror(errno));\n            close(sfd);\n            continue;\n        }\n        break;\n    }\n    if (addrinfo_current == NULL) {\n        fprintf(stderr, \"connection failed\\n\");\n        exit(EXIT_FAILURE);\n    }\n    freeaddrinfo(addrinfo_result);\n    return sfd;\n}\n\nvoid retrieve_files(int socket, LIBSSH2_SESSION* session, LIBSSH2_SFTP *sftp_session, int filec, char *filev[])\n{\n    LIBSSH2_SFTP_HANDLE* sftp_handles[filec];\n    int finished[filec];\n    int toread = filec;\n    for(int i=0; i&lt;filec; i++) {\n        fprintf(stderr, \"opening: %s\\n\", filev[i]);\n        sftp_handles[i] = libssh2_sftp_open(sftp_session, filev[i], LIBSSH2_FXF_READ, 0);\n        if (!sftp_handles[i]) {\n            char* errmsg;\n            libssh2_session_last_error(session, &amp;errmsg, NULL, 0);\n            fprintf(stderr, \"Failure opening remote file: %s: %s\\n\", filev[i], errmsg);\n            exit(EXIT_FAILURE);\n        }\n        finished[i]=0;\n    }\n    char buffer[CHUNK_SIZE];\n    libssh2_session_set_blocking(session, 0);\n    while (toread) {\n        for(int i=0; i&lt;filec; i++) {\n            if (finished[i]) {\n                continue;\n            } else {\n                int read_result;\n                do {\n                    fprintf(stderr, \"reading: %s from %ld to %ld\\n\", filev[i], (long)sftp_handles[i], (long)(buffer+CHUNK_SIZE*i));\n                    read_result = libssh2_sftp_read(sftp_handles[i], buffer, CHUNK_SIZE);\n                    fprintf(stderr, \"read result: %d\\n\", read_result);\n                    if (read_result &gt; 0) {\n                        printf(\"%s: \", filev[i]);\n                        fwrite(buffer, sizeof(char), read_result, stdout);\n                        printf(\"\\n\");\n                    } else {\n                        break;\n                    }\n                } while (1);\n                if (read_result == LIBSSH2_ERROR_EAGAIN) {\n                    continue;\n                } else if (read_result == 0) {\n                    finished[i] = 1;\n                    toread--;\n                } else {\n                    fprintf(stderr, \"Bad read result: %d\\n\", read_result);\n                    char* errmsg;\n                    libssh2_session_last_error(session, &amp;errmsg, NULL, 0);\n                    fprintf(stderr, \"Read error: %s: %s\\n\", filev[i], errmsg);\n                    exit(EXIT_FAILURE);\n                }\n            }\n        }\n        if (toread) {\n            struct pollfd fds[1] = {0};\n            fds[0].fd = socket;\n            fds[0].events = POLLIN;\n            poll(fds, 1, 3000);\n        }\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    LIBSSH2_SESSION *session;\n    LIBSSH2_SFTP *sftp_session;\n    int rc, sock;\n\n    if (argc&lt;6) {\n        fprintf(stderr, \"Usage: %s hostname port username password file1 [file2] [file3...]\\n\", argv[0]);\n        return EXIT_FAILURE;\n    }\n\n    sock = sftp_connect(argv[1], argv[2]);\n    session = libssh2_session_init();\n    if (!session) {\n        return EXIT_FAILURE;\n    }\n    rc = libssh2_session_handshake(session, sock);\n    if (rc) {\n        char* errmsg;\n        libssh2_session_last_error(session, &amp;errmsg, NULL, 0);\n        fprintf(stderr, \"Failure establishing SSH session: %s\\n\", errmsg);\n        return EXIT_FAILURE;\n    }\n    rc = libssh2_userauth_password(session, argv[3], argv[4]);\n    if (rc) {\n        char* errmsg;\n        libssh2_session_last_error(session, &amp;errmsg, NULL, 0);\n        fprintf(stderr, \"%s\\n\", errmsg);\n        return EXIT_FAILURE;\n    }\n\n    sftp_session = libssh2_sftp_init(session);\n    if (sftp_session == NULL) {\n        char* errmsg;\n        libssh2_session_last_error(session, &amp;errmsg, NULL, 0);\n        fprintf(stderr, \"Unable to init SFTP session: %s\\n\", errmsg);\n        return EXIT_FAILURE;\n    }\n\n    retrieve_files(sock, session, sftp_session, argc-5, argv+5);\n\n    libssh2_session_set_blocking(session, 1);\n    libssh2_sftp_shutdown(sftp_session);\n    libssh2_session_disconnect(session, \"\");\n    libssh2_session_free(session);\n    libssh2_exit();\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "while-loop"], "comments": [{"owner": {"reputation": 678, "user_id": 3469811, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/47c3ec236e8af5520866fdbc2a6523b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3469811", "link": "https://stackoverflow.com/users/3469811/user3469811"}, "edited": false, "score": 0, "creation_date": 1555507906, "post_id": 55728708, "comment_id": 98136428, "body": "where is the declaration of <code>i</code>, do you initialize it with 0?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1555507914, "post_id": 55728708, "comment_id": 98136435, "body": "Have you initialized <code>i</code>? If not there will be a random value in it which easily can be greater than <code>arrayLength</code>. In that case the loop will never be entered. Probably a good moment to learn a bit about Debuggers and how to step through your code line by line."}, {"owner": {"reputation": 19, "user_id": 10743752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d03ac7d621a61c6c64427808160fb2?s=128&d=identicon&r=PG&f=1", "display_name": "Frankie Boyle", "link": "https://stackoverflow.com/users/10743752/frankie-boyle"}, "edited": false, "score": 0, "creation_date": 1555508045, "post_id": 55728708, "comment_id": 98136518, "body": "yes I have, right at the beginning I initialise it as <code>i=0</code>"}, {"owner": {"reputation": 678, "user_id": 3469811, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/47c3ec236e8af5520866fdbc2a6523b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3469811", "link": "https://stackoverflow.com/users/3469811/user3469811"}, "edited": false, "score": 0, "creation_date": 1555508188, "post_id": 55728708, "comment_id": 98136598, "body": "so you are keeping off some code, this makes it tough for others to help you:(<a href=\"https://stackoverflow.com//help/mcve\">stackoverflow.com//help/mcve</a>)."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1555508638, "post_id": 55728708, "comment_id": 98136875, "body": "@FrankieBoyle do you flush the output witting a <code>\\n</code> after the <i>while</i> ? (answer edited)"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1555509190, "post_id": 55728708, "comment_id": 98137262, "body": "I get the feeling that you are just reusing <code>i</code> from your for loop in your while loop do you? Because if so <code>i</code> will already be equal to <code>arrayLength</code> and thus the while loop will never be entered"}, {"owner": {"reputation": 678, "user_id": 3469811, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/47c3ec236e8af5520866fdbc2a6523b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3469811", "link": "https://stackoverflow.com/users/3469811/user3469811"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1555509594, "post_id": 55728708, "comment_id": 98137558, "body": "@Yastanub then there will be the output of <code>putchar()</code> in the for-loop. with no mcve, we can only speculate"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1555508783, "last_edit_date": 1555508783, "creation_date": 1555507908, "answer_id": 55728757, "question_id": 55728708, "link": "https://stackoverflow.com/questions/55728708/how-to-output-a-char-array-with-while-and-putchar/55728757#55728757", "title": "How to output a char array with while and putchar", "body": "<p>in</p>\n\n<pre><code>for (i = 0; i &lt;arrayLength; i++)\n        putchar(output[i]);\n</code></pre>\n\n<p>i is initialized by the <em>for</em>, but in</p>\n\n<pre><code>while (i &lt; arrayLength){\n\n        putchar(output[i]);\n        i++;\n    }\n</code></pre>\n\n<p><em>i</em> is not initialized before the while, probably its value is <code>&gt; arrayLength</code> so the <em>while</em> never executes its body, just add <code>i = 0;</code> before the <em>while</em></p>\n\n<hr>\n\n<p><strong>(edit)</strong></p>\n\n<p>You say you initialize <em>i</em> with 0 somewhere before, do you flush the output writing a <code>\\n</code> after the <em>while</em> ?</p>\n"}, {"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1555508568, "creation_date": 1555508568, "answer_id": 55728951, "question_id": 55728708, "link": "https://stackoverflow.com/questions/55728708/how-to-output-a-char-array-with-while-and-putchar/55728951#55728951", "title": "How to output a char array with while and putchar", "body": "<p>There are a lot of possible reasons why does something like that happens, more over because you explained in your comment:</p>\n\n<pre><code>yes I have, right at the beginning I initialise it as i=0\n</code></pre>\n\n<p>Please check this code and tell us what are the differences between this one and your actual code (which by the way you do not show it us):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main ( void )\n{\n    char output[] = \"ABCDEFG\";\n    size_t i = 0, j = 0;\n    size_t arrayLength = strlen( output );\n\n    for ( i = 0 ; i &lt; arrayLength ; i++ )\n    {\n        putchar(output[i]);\n    }\n    printf( \"\\n\" );\n\n    j = 0;\n    while ( j &lt; arrayLength )\n    {\n\n        putchar( output[j] );\n        j++;\n    }\n}\n</code></pre>\n\n<p>You should provide a code which we can test it.</p>\n\n<p>Are you running both LOOPs in the same code?\nSomething like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main ( void )\n{\n    char output[] = \"ABCDEFG\";\n    size_t i = 0;\n    size_t arrayLength = strlen( output );\n\n    for ( i = 0 ; i &lt; arrayLength ; i++ )\n    {\n        putchar(output[i]);\n    }\n    printf( \"\\n\" );\n\n    while ( i &lt; arrayLength )\n    {\n\n        putchar( output[i] );\n        i++;\n    }\n}\n</code></pre>\n\n<p>?</p>\n"}], "owner": {"reputation": 19, "user_id": 10743752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d03ac7d621a61c6c64427808160fb2?s=128&d=identicon&r=PG&f=1", "display_name": "Frankie Boyle", "link": "https://stackoverflow.com/users/10743752/frankie-boyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555508783, "creation_date": 1555507764, "question_id": 55728708, "link": "https://stackoverflow.com/questions/55728708/how-to-output-a-char-array-with-while-and-putchar", "title": "How to output a char array with while and putchar", "body": "<p>I have a for loop to output an array but would like to rewrite it with a while loop.</p>\n\n<p>I have the following for loop that works fine:</p>\n\n<pre><code> for (i = 0; i &lt;arrayLength; i++)\n        putchar(output[i]);\n</code></pre>\n\n<p>and I have tried to rewrite the code above in a while loop:</p>\n\n<pre><code>\nwhile (i &lt; arrayLength){\n\n        putchar(output[i]);\n        i++;\n    }\n\n</code></pre>\n\n<p>The problem is that when I run the code with the while loop,  I get no output but the program ends</p>\n\n<p>when I run it with a for loop, I get the expected output of</p>\n\n<p><code>defghi</code></p>\n\n<p>What have I done wrong here.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "string", "performance", "file", "io"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1555506423, "post_id": 55728231, "comment_id": 98135428, "body": "It is possible the stdio library internally read the whole string and gives it to you with fgetc one char at a time."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555506664, "post_id": 55728231, "comment_id": 98135580, "body": "Reading the whole file might fail if the file is very big. Probably you need a bigger file to see a possible performance difference. If it is a text file I recommend processing it line by line (<code>fgets</code>), for binary files using a fixed block size (<code>fread</code>)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1555508746, "post_id": 55728231, "comment_id": 98136959, "body": "Try <code>getc()</code> instead of <code>fgetc()</code>, and compile with sufficient optimisations."}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1555509457, "post_id": 55728231, "comment_id": 98137464, "body": "@wildplasser I dont see diffrence, maybe 1%..."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1555513330, "post_id": 55728231, "comment_id": 98140013, "body": "Use <code>times your_program</code> to obtain the timing. (here getc() is about 10% faster)"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1555583033, "post_id": 55728231, "comment_id": 98164774, "body": "@wildplasser You right, there is diffrence when i check time using <code>times</code> or <code>clock()</code> in program?"}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1555508290, "post_id": 55728505, "comment_id": 98136644, "body": "Thanks for clear answer, i making tests with 1GB file and more operations and still no diffrence so must be some hidden buffering."}], "tags": [], "owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "is_accepted": true, "score": 1, "last_activity_date": 1555507190, "creation_date": 1555507190, "answer_id": 55728505, "question_id": 55728231, "link": "https://stackoverflow.com/questions/55728231/performace-read-from-file-fgetc-vs-fread-entire-string/55728505#55728505", "title": "Performace read from file fgetc vs fread entire string", "body": "<p>It is probably the reading of the file that limits the performance, the operations you do on the data have a negligible cost compared to reading the file. To make that efficient it should be best to do it in large enough chunks, so one byte at a time could in principle be bad.</p>\n\n<p>However, in practice, there is probably some clever buffering going on behind the scenes. So even if your program just asks for one byte at a time, the file is in reality read in large chunks, giving you roughly the same performance as your first approach.</p>\n\n<p>(The above was assuming that the reading of the file dominated the cost completely. If that was not the case, and if memory access was slow, it could happen that the one-byte-at-a-time approach could be faster since that approach avoiding accessing the same part of memory twice.)</p>\n"}], "owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 55728505, "answer_count": 1, "score": 0, "last_activity_date": 1555507190, "creation_date": 1555506299, "question_id": 55728231, "link": "https://stackoverflow.com/questions/55728231/performace-read-from-file-fgetc-vs-fread-entire-string", "title": "Performace read from file fgetc vs fread entire string", "body": "<p>I try check what is faster:</p>\n\n<ol>\n<li>Calculate size of file, read entire content to string (char*), operations on string <br>\nVS.<br></li>\n<li>Read char by char using fgetc and making operations on single char.</li>\n</ol>\n\n<p>My results say there are no diffrence. What do you think?</p>\n\n<ol>\n<li>What is real faster?</li>\n<li>Complexity operation matters?</li>\n<li>Type od hard disk matters (HDD / SSD)?</li>\n<li>First case use more memory so in big files will be worse, right?</li>\n<li>There is diffrence when file is small?</li>\n<li>Operating system matters? (i use linux Ubuntu 14)</li>\n</ol>\n\n<p>My code below:</p>\n\n<p>Begin:</p>\n\n<pre><code>    size_t start = clock();\n    volatile size_t some = 0;\n    FILE* fh = fopen(\"/home/xxx/test/file.txt\", \"r\");\n</code></pre>\n\n<ol>\n<li>case</li>\n</ol>\n\n<pre><code>    size_t size = 0;\n    fseek(fh, 0L, SEEK_END);\n    size = ftell(fh);\n    rewind(fh);\n    char* result = (char*) malloc(sizeof(char) * (size + 1));\n    fread((void*) result, sizeof(char), size, fh);\n    result[size] = '\\0';\n\n    for (size_t i = 0; i &lt; size; i++)\n    {\n        if (result[i] % 2)\n        {\n            some++;\n        }\n    }\n\n    free(result);\n</code></pre>\n\n<ol start=\"2\">\n<li>case</li>\n</ol>\n\n<pre><code>    int c = fgetc(fh);\n    while (c != EOF)\n    {\n        if (c % 2)\n        {\n            some++;\n        }\n\n        c = fgetc(fh);\n    }\n</code></pre>\n\n<p>End:</p>\n\n<pre><code>    fclose(fh);\n    size_t end = clock();\n    printf(\"TIME = %zu\\n\", end - start);\n</code></pre>\n\n<p>In my case operation is simple condition, volatile prevent compilator optimalization.</p>\n"}, {"tags": ["c", "time"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 7, "creation_date": 1555506084, "post_id": 55728094, "comment_id": 98135167, "body": "You can not expect your computer to &quot;work the same under same inputs&quot; there might be a heavier task with higher priority which gets the upper hand in scheduling and thus your task will need to wait. Thats why in performance mesurement you usually mesure hundrets of times and then calculate an average value. Execution times can vary every execution."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555521326, "post_id": 55728094, "comment_id": 98144307, "body": "The second time you run the same program, all of the program and data are in cache, so no, it will not run the same every time with the same input."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1555596283, "post_id": 55728094, "comment_id": 98172360, "body": "Beware that the first calculation is done in floating point while the second (you eliminated the cast) is being done in integer arithmetic!!!"}], "answers": [{"tags": [], "owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "is_accepted": true, "score": 1, "last_activity_date": 1555507934, "creation_date": 1555507934, "answer_id": 55728768, "question_id": 55728094, "link": "https://stackoverflow.com/questions/55728094/why-is-the-time-changing/55728768#55728768", "title": "Why is the time changing?", "body": "<p>The computation you try to measure is much too fast for you to get any meaningful timing measurements in that way.</p>\n\n<p>Try this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\n\nint main(){\n    clock_t beg = clock();\n    clock_t end = clock();\n    double deltaT = (double)(end - beg)/CLOCKS_PER_SEC;\n    printf(\"Time take is: %lf seconds\\n\", deltaT); \n}\n</code></pre>\n\n<p>Then you will probably find that you get similar \"Time taken\" output, even though nothing at all is done between the two <code>clock()</code> calls. What you are seeing is just a result of the significant overhead of calling the <code>clock()</code> function.</p>\n\n<p>To get meaningful measurements of the performance of your sort function, either sort a much larger list, or repeat the sort many times in a loop, so that you get long enough times to measure.</p>\n\n<p>To answer the question about why the time was changing, I think the answer to that is just that it changed a little bit randomly, run a few more times and you may get the other value again.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1555596534, "creation_date": 1555596534, "answer_id": 55747830, "question_id": 55728094, "link": "https://stackoverflow.com/questions/55728094/why-is-the-time-changing/55747830#55747830", "title": "Why is the time changing?", "body": "<p>Think twice when you try to measure time in clock ticks.  The answer is an integer number of clock ticks that depend on the architecture.  This means that sometimes you can get one clock tick (that translated to microseconds can mean something) and sometimes two (doubling the original time).</p>\n\n<p>better use <code>clock_gettime(2)</code> or <code>gettimeofday(2)</code>  (the former has nanosecond resolution, while precission can be lower, and the later has microsecond resolution)  Anycase you don't have <code>1.0E6</code> or <code>1.0E9</code> tics per second.</p>\n"}], "owner": {"reputation": 175, "user_id": 6911945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7bfed910d4e5654f30970ca452ece2da?s=128&d=identicon&r=PG&f=1", "display_name": "Suhrid Mulay", "link": "https://stackoverflow.com/users/6911945/suhrid-mulay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55728768, "answer_count": 2, "score": 0, "last_activity_date": 1555596534, "creation_date": 1555505893, "question_id": 55728094, "link": "https://stackoverflow.com/questions/55728094/why-is-the-time-changing", "title": "Why is the time changing?", "body": "<p>So this is what I did. First we have my simple insertion sort code. I decide to time it. this is what the code looks like:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\n\nint insertion_sort(int arr[], int len){\n    int i;\n    int key;\n    for(i = 1; i &lt; len; i++){\n        key = arr[i];\n        int j = i - 1;\n        while(arr[j] &gt;= key &amp;&amp; j &gt;= 0){\n            arr[j + 1] = arr[j];\n            j--;\n        }\n    arr[j + 1] = key;\n    }\n}\n\n\nint main(){\n    int arr[5] = {3, 2, 5, 1, 4};\n    clock_t beg = clock();\n    insertion_sort(arr, 5);\n    clock_t end = clock();\n    int i;\n    for(i = 0; i &lt; 5; i++)\n    {\n        printf(\"%d\\n\", arr[i]);\n    }\n    double deltaT = (double)(end - beg)/CLOCKS_PER_SEC;\n    printf(\"Time take is: %lf seconds\\n\", deltaT); \n}\n</code></pre>\n\n<p>So next I compile and run my code. The output is:</p>\n\n<pre><code>1\n2\n3\n4\n5\nTime take is: 0.000002 seconds\n</code></pre>\n\n<p>Then i decided that the seconds timer is too small and we would need to use milliseconds instead. So I multiply the calculation by thousand like:</p>\n\n<pre><code>deltaT = (end - beg) * 1000 / CLOCKS_PER_SEC\n</code></pre>\n\n<p>and then changed the relevant printf.\nTime reading still remains the same at 2\u03bcs. The real magic happens when I re-remove the 1000 and revert the code back to the old form.</p>\n\n<p>This time the time changes miraculously to a rather slow 3\u03bcs. What is the reason for this abrupt change. We expect our machines to work the same under same inputs but why does the performance vary on the same input when I try it? </p>\n"}, {"tags": ["c", "synchronization", "pthreads", "glibc"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555505431, "post_id": 55727735, "comment_id": 98134741, "body": "You shouldn&#39;t be caring about the members (unless you&#39;re using it as an example of how to write your own rwlock). Just use it with the appropriate functions and treat it like a black box."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555505458, "post_id": 55727735, "comment_id": 98134763, "body": "@Shawn OP says they are trying to debug a deadlock; in that context, this is a legitimate question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1555505502, "post_id": 55727735, "comment_id": 98134796, "body": "The <code>pthread_rwlock_t</code> <i>type</i> is standardized, but its members seem not to be.  There&#39;s undoubtedly someone who knows what they mean, but most of us will only be able to guess based on their names, or would need to study the implementation."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1555505666, "post_id": 55727735, "comment_id": 98134906, "body": "@zwol OP needs to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates a deadlock to get help with it, then."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555505800, "post_id": 55727735, "comment_id": 98134988, "body": "I was about to suggest an MCVE myself, but primarily from the perspective of the exercise of creating one serving as a debugging methodology.  Of course, once an MCVE is in hand, if the issue has not yet become clear to the OP then it will serve as a good basis for this or another SO question."}, {"owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555506136, "post_id": 55727735, "comment_id": 98135204, "body": "@Shawn What if the members can give me a clue about what is going wrong? Actually I am worried about the case where there is corruption of the lock structure. I won&#39;t able to realise if its actually a corruption without having some ideas about the members of the structure."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1555506506, "post_id": 55727735, "comment_id": 98135482, "body": "@ashish John Bollinger has good advice -- in the process of attempting to cut your program down to the smallest possible test program that still reproduces the deadlock, you may realize what the problem is for yourself.  I realise this may be anywhere from very difficult to totally impractical, depending on how big a program you&#39;re starting with and what it does, which is why I&#39;m taking your question seriously -- but it&#39;s one that no one here may be able to answer, and in fact <i>no one at all</i> may be able to answer anymore."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1555506843, "post_id": 55727735, "comment_id": 98135684, "body": "Note that there are only two ways to get a deadlock:  lock escalation (for example, where you hold a read lock and try to get a write lock on the same object), and mixed locking order.  If you <b>never</b> escalate a lock and <b>always</b> lock objects in the same order, you will <b>never</b> get a deadlock."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555507181, "post_id": 55727735, "comment_id": 98135929, "body": "If I were to speculate based on member names, I would guess the lock data depict a state in which the read lock is held 24644 times (possibly by fewer distinct threads).  The fact that the <code>__writer_wakeup</code> member has the same value could be taken (even more speculatively) as a sign of internal consistency.  Why such a state would cause threads to block on acquiring the <i>read</i> lock is opaque to me, but if the read lock really is held that many times, then that in itself is pretty suspicious.  Of course, if the read lock is held even once then that will block acquisition of the <i>write</i> lock."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555506264, "post_id": 55728158, "comment_id": 98135309, "body": "FWIW, the <code>pthread_lock_t</code> members the OP presents match the structure as defined in glibc 2.17 for x86_64 (and presumably some other versions in that vicinity).  v2.17 is the version of glibc provided by the RHEL 7 flavor of distros, but also by various others, I&#39;m sure."}, {"owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "edited": false, "score": 0, "creation_date": 1555506456, "post_id": 55728158, "comment_id": 98135445, "body": "@zwol rpm -q glibc glibc-2.17-260.el7_6.3.x86_64 cat /etc/redhat-release  CentOS Linux release 7.6.1810 (Core)"}, {"owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555506494, "post_id": 55728158, "comment_id": 98135470, "body": "@JohnBollinger By any chance, would you be knowing what __lock = 2 represents?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "edited": false, "score": 1, "creation_date": 1555506819, "post_id": 55728158, "comment_id": 98135666, "body": "No, @ashish, I am not among those with knowledge of the details of the glibc pthreads implementation.  I just know how to find and read headers."}, {"owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1555507039, "post_id": 55728158, "comment_id": 98135812, "body": "@JohnBollinger yeah, I did try to read the header. <a href=\"https://code.woboq.org/userspace/glibc/nptl/pthread_rwlock_common.c.html#__pthread_rwlock_wrlock_full\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/nptl/&hellip;</a>. &quot;#2    0   0   &gt;0  0   Readers have acquired the lock.&quot; But it seems this stored in __readers not in __lock. Anyways, will continue checking.."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1555506074, "creation_date": 1555506074, "answer_id": 55728158, "question_id": 55727735, "link": "https://stackoverflow.com/questions/55727735/description-of-the-members-of-struct-pthread-rwlock-t/55728158#55728158", "title": "Description of the members of struct pthread_rwlock_t", "body": "<p>Current versions of GNU libc (version 2.25 and later) ship gdb extensions that will decode the members of various pthread structures, including <code>pthread_rwlock_t</code>.  However, looking at the code for this extension, it expects the contents of <code>pthread_rwlock_t</code> to be quite different from what you have shown, so manually applying it to your data dump will be of no use.  For the same reason, I can't tell you what the fields mean.</p>\n\n<p>If you tell us exactly which Linux distribution you are using, its age, and what the output of running <code>/lib/libc.so.6</code> as if it were a program is (if that file doesn't exist, look for it in subdirectories of <code>/lib</code> and <code>/lib64</code>), we might be able to be more helpful.</p>\n\n<p>It would also be worth attempting to move your program onto a newer Linux distribution and seeing if you can still reproduce the problem.  Then you can use the gdb extensions yourself.</p>\n"}], "owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555927578, "creation_date": 1555504617, "last_edit_date": 1555927578, "question_id": 55727735, "link": "https://stackoverflow.com/questions/55727735/description-of-the-members-of-struct-pthread-rwlock-t", "title": "Description of the members of struct pthread_rwlock_t", "body": "<p>Can somebody please summarize what the different members of the pthread_rwlock_t means?</p>\n\n<pre><code>    struct\n { \n   int __lock;\n   unsigned int __nr_readers;\n   unsigned int __readers_wakeup;\n   unsigned int __writer_wakeup;\n   unsigned int __nr_readers_queued;\n   unsigned int __nr_writers_queued;\n   int __writer;\n   int __shared; \n   unsigned long int __pad1;\n   unsigned long int __pad2;\n   /* FLAGS must stay at this position in the structure to maintain\n      binary compatibility.  */\n   unsigned int __flags;\n } __data;\n</code></pre>\n\n<p>I am debugging one deadlock where the lock states looks like:</p>\n\n<pre><code>{__data = {\n   __lock = 2,\n   __nr_readers = 24644,\n   __readers_wakeup = 28432136,\n   __writer_wakeup = 24644,\n   __nr_readers_queued = 0,\n   __nr_writers_queued = 0,\n   __writer = 0,\n   __shared = 0,\n   __pad1 = 0, __pad2 = 0,\n   __flags = 0}, \n __size = \"\\002\\000\\000\\000D`\\000\\000\\b\u05f1\\001D`\", '\\000' &lt;repeats 41 times&gt;,\n __align = 105845174042626}\n</code></pre>\n\n<p>And the thread is blocked while trying to acquire read lock on it. Is the lock structure looks sane?</p>\n\n<p>The operating system is CentOS 7.6, with glibc-2.17-260.el7_6.3.x86_64.</p>\n"}, {"tags": ["javascript", "c", "ieee-754"], "comments": [{"owner": {"reputation": 14807, "user_id": 6870228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13425c63b585e3bba05d30509e9e2b00?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/6870228/keith"}, "edited": false, "score": 0, "creation_date": 1555506808, "post_id": 55727695, "comment_id": 98135659, "body": "You can compile C code for use in browsers that support WebAssembly, <a href=\"https://caniuse.com/#feat=wasm\" rel=\"nofollow noreferrer\">caniuse.com/#feat=wasm</a>  Support is pretty descent nowadays too.  So rather than converting your C code, just re-use it."}, {"owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "reply_to_user": {"reputation": 14807, "user_id": 6870228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13425c63b585e3bba05d30509e9e2b00?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/6870228/keith"}, "edited": false, "score": 0, "creation_date": 1555507082, "post_id": 55727695, "comment_id": 98135850, "body": "@Keith I thought about this as well, but the C code is part of a huge project that isn&#39;t very well structured, and it would basically mean re-writing the same logic in C."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1555511440, "post_id": 55727695, "comment_id": 98138777, "body": "Maybe OT, but shouldn&#39;t those tests, which are dealing with floating point numbers, take into account rounding errors in the first place?"}, {"owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1555516020, "post_id": 55727695, "comment_id": 98141696, "body": "@Bob__ I tried to apply some rounding when comparing the result, but the problem is that I&#39;m dealing with 3D meshes which are run through translation matrices, and the resulting rounding errors go up above the decimal point. What I&#39;m doing is comparing the final meshes, and if I just compare the n-th power of 10, the tests become kind of useless."}], "answers": [{"comments": [{"owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "edited": false, "score": 0, "creation_date": 1555507165, "post_id": 55728367, "comment_id": 98135916, "body": "Thanks a lot, this looks promising! Any idea how to round back the computed result to 32-bit float to get rid of the additional digits? Is rounding to 8 digits enough?"}, {"owner": {"reputation": 14807, "user_id": 6870228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13425c63b585e3bba05d30509e9e2b00?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/6870228/keith"}, "reply_to_user": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "edited": false, "score": 0, "creation_date": 1555507425, "post_id": 55728367, "comment_id": 98136079, "body": "@phreezie <code>Math.round(5.479318618774414 * Math.pow(10, 8)) &#47; Math.pow(10, 8);</code>"}, {"owner": {"reputation": 415, "user_id": 8806162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a593ee55add9855e5b0f1ddef474a?s=128&d=identicon&r=PG", "display_name": "Ashen Gunaratne", "link": "https://stackoverflow.com/users/8806162/ashen-gunaratne"}, "reply_to_user": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "edited": false, "score": 0, "creation_date": 1555509034, "post_id": 55728367, "comment_id": 98137151, "body": "@phreezie The <code>toFixed</code> shall do it; <code>(5.479318618774414).toFixed(8)</code>"}, {"owner": {"reputation": 415, "user_id": 8806162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a593ee55add9855e5b0f1ddef474a?s=128&d=identicon&r=PG", "display_name": "Ashen Gunaratne", "link": "https://stackoverflow.com/users/8806162/ashen-gunaratne"}, "edited": false, "score": 0, "creation_date": 1555509978, "post_id": 55728367, "comment_id": 98137816, "body": "Prepending the expression with <code>+</code> should do the trick; <code>+(5.479318618774414).toFixed(8)</code>"}, {"owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "edited": false, "score": 0, "creation_date": 1555510769, "post_id": 55728367, "comment_id": 98138362, "body": "I think I&#39;ll also need to consider how many digits are before the dot. Something like <code>const f = Math.pow(10, 8 - Math.floor(Math.log10(Math.abs(f8)))); return Math.round(f8 * f) &#47; f;</code>, right?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555515812, "post_id": 55728367, "comment_id": 98141570, "body": "The \u201cadded digits\u201d are merely an artifact of JavaScript\u2019s default formatting of numbers. You should not try to get rid of them by doing arithmetic on the number\u2014that will produce a number that is different from the 32-bit floating-point value you seek. Instead, using formatting functions/controls to format the output with the desired number of digits."}, {"owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "edited": false, "score": 0, "creation_date": 1555516114, "post_id": 55728367, "comment_id": 98141756, "body": "Understood, this is only applied to the final result I&#39;m comparing."}], "tags": [], "owner": {"reputation": 415, "user_id": 8806162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a593ee55add9855e5b0f1ddef474a?s=128&d=identicon&r=PG", "display_name": "Ashen Gunaratne", "link": "https://stackoverflow.com/users/8806162/ashen-gunaratne"}, "is_accepted": true, "score": 1, "last_activity_date": 1555506738, "creation_date": 1555506738, "answer_id": 55728367, "question_id": 55727695, "link": "https://stackoverflow.com/questions/55727695/single-precision-math-in-javascript/55728367#55728367", "title": "Single precision math in JavaScript", "body": "<p>Your attempt should be fruitful if your were to convert the operands prior applying the operation;</p>\n\n<pre><code>Math.fround(Math.fround(-3.12744117) + Math.fround(8.60676003))\n</code></pre>\n\n<p>Alternately, the JavaScript <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array\" rel=\"nofollow noreferrer\">Float32Array</a> typed arrays shall be an alternate means. For instance;</p>\n\n<pre><code>(new Float32Array([-3.12744117, 8.60676003])).reduce((a, e) =&gt; Math.fround(a + e))\n</code></pre>\n\n<p>The both expedients yield a value of <em>5.479318618774414</em> which is equivalent to the expected C counterpart answer rounded to eight decimal place.</p>\n"}], "owner": {"reputation": 324, "user_id": 313537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ev5c.jpg?s=128&g=1", "display_name": "phreezie", "link": "https://stackoverflow.com/users/313537/phreezie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 55728367, "answer_count": 1, "score": 2, "last_activity_date": 1555506738, "creation_date": 1555504488, "question_id": 55727695, "link": "https://stackoverflow.com/questions/55727695/single-precision-math-in-javascript", "title": "Single precision math in JavaScript", "body": "<p>I'm re-implementing some C code in JavaScript, and in order to pass tests, I need the JavaScript code return the same result as the C code. The C code exclusively deals with single precision floating-point numbers (while JavaScript's <code>number</code> is double precision).</p>\n\n<p>For example, in C, <code>-3.12744117f + 8.60676003f</code> equals <code>5.47931862f</code>. In JavaScript, <code>-3.12744117 + 8.60676003</code> equals <code>5.47931886</code>, which is different (<code>Math.fround</code> returns <code>5.479319095611572</code>, which is even more off).</p>\n\n<p>I'm aware that the JavaScript result is technically \"more correct\", but what I'm aiming at here is coherence with the less precise C-counterpart.</p>\n\n<p>Is there a way to apply 32-bit operations in JavaScript? Do I manually need to implement the IEEE 574 standard by hand, or are there other ways?</p>\n"}, {"tags": ["c", "makefile", "compilation", "executable"], "answers": [{"tags": [], "owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "is_accepted": true, "score": 2, "last_activity_date": 1555508699, "last_edit_date": 1555508699, "creation_date": 1555505411, "answer_id": 55727947, "question_id": 55727692, "link": "https://stackoverflow.com/questions/55727692/how-does-make-build-an-executable-file-from-a-c-source-file-when-the-implicit-ru/55727947#55727947", "title": "How does make build an executable file from a C source file when the implicit rule says nothing about executables?", "body": "<p>There are different implicit rules in the built-in database. And make never has objections if the pattern rules are ambiguous, as it always sets the priorities for them.</p>\n\n<p>In this case, the rules <code>%: %.o</code> and <code>%.o: %.c</code> are superseded by the rule <code>%: %.c</code> (because one step is better than two ;-)), which does compiling into an executable without ever creating object files (yes, gcc can do this).</p>\n\n<p>However, you can force .o creation with this command:</p>\n\n<pre><code>make helloworld.o helloworld\n</code></pre>\n\n<p>Here, after helloworld.o successfully created, make will prefer <code>%: %.o</code> rule over <code>%: %.c</code>, so it works as expected.</p>\n"}, {"comments": [{"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "edited": false, "score": 0, "creation_date": 1555509703, "post_id": 55727962, "comment_id": 98137625, "body": "Thank you! You&#39;re right. I do get those lines when running <code>make -d</code>"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1555505440, "last_edit_date": 1592644375, "creation_date": 1555505440, "answer_id": 55727962, "question_id": 55727692, "link": "https://stackoverflow.com/questions/55727692/how-does-make-build-an-executable-file-from-a-c-source-file-when-the-implicit-ru/55727962#55727962", "title": "How does make build an executable file from a C source file when the implicit rule says nothing about executables?", "body": "<p>There are many implicit rules. In this case there is one for building an executable directly from a C file. In your output from <code>make -d helloworld</code> you should see something like:</p>\n<blockquote>\n<p>Trying implicit prerequisite 'helloworld.c'.</p>\n<p>Found an implicit rule for 'helloworld'.</p>\n</blockquote>\n"}], "owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 55727947, "answer_count": 2, "score": 0, "last_activity_date": 1555508699, "creation_date": 1555504483, "question_id": 55727692, "link": "https://stackoverflow.com/questions/55727692/how-does-make-build-an-executable-file-from-a-c-source-file-when-the-implicit-ru", "title": "How does make build an executable file from a C source file when the implicit rule says nothing about executables?", "body": "<p>From the <a href=\"https://www.gnu.org/software/make/manual/html_node/Catalogue-of-Rules.html#Catalogue-of-Rules\" rel=\"nofollow noreferrer\">GNU Make Manual</a> I understand there is an implicit rule for <code>.c</code> programs:</p>\n\n<blockquote>\n  <p>n.o is made automatically from n.c with a recipe of the form \u2018$(CC) $(CPPFLAGS) $(CFLAGS) -c\u2019</p>\n</blockquote>\n\n<p>When, for example, I type <code>make helloworld</code> and only have a <code>helloworld.c</code> file in my working directory, I see the following is executed:</p>\n\n<p><code>cc helloworld.c -o helloworld</code></p>\n\n<p>If I type <code>make -d helloworld</code> I see that at no time does <code>make</code> look for an intermediate <code>helloworld.o</code> file.</p>\n\n<p>In the end, I don't see a <code>.o</code> file in my directory, only the executable file. How does <code>make</code> build the executable from the source file if the implicit rule for <code>.c</code> program says it should build a <code>.o</code> file?</p>\n"}, {"tags": ["c", "winapi", "proxy", "winhttp"], "comments": [{"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1555555443, "post_id": 55727644, "comment_id": 98154326, "body": "Put <code>hB0=WinHttpOpen()</code> in a single line and <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen#return-value\" rel=\"nofollow noreferrer\">check the error code by calling GetLastError()</a> after it."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "reply_to_user": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1555576255, "post_id": 55727644, "comment_id": 98161073, "body": "@RitaHan-MSFT I&#39;m doing that by IDA - it says empty response I think. But recently I&#39;ve been thinking that maybe it is not working since ExpressVPN is a VPN and not a proxy."}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1555635122, "post_id": 55727644, "comment_id": 98186846, "body": "Yes, you need to confirm this first."}], "owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555504342, "creation_date": 1555504342, "question_id": 55727644, "link": "https://stackoverflow.com/questions/55727644/how-to-connect-to-expressvpn", "title": "How to connect to expressVPN?", "body": "<p>Here is what I've tried so far:</p>\n\n<ol>\n<li><p>using WINHTTP_OPTION_PROXY_PASSWORD &amp; WINHTTP_OPTION_PROXY_PASSWORD</p></li>\n<li><p>using WinHttpSetCredentials</p></li>\n<li><p>using plain text like so L\"<a href=\"https://username:password@norway-ubuntu-l2tp.expressprovider.com\" rel=\"nofollow noreferrer\">https://username:password@norway-ubuntu-l2tp.expressprovider.com</a>\"</p></li>\n</ol>\n\n<p>Here is my full code with the latest try:</p>\n\n<pre><code>fetch(WCHAR uri_sprintf[])\n{ \n    extern DWORD dwReadBytes, chBuffer;\n    HINTERNET hB1, hB0, hB2;\n    WinHttpSendRequest(hB2=WinHttpOpenRequest(hB1=WinHttpConnect(hB0=WinHttpOpen\n        (L\"\",WINHTTP_ACCESS_TYPE_NAMED_PROXY,L\"https://username:password@norway-ubuntu-l2tp.expressprovider.com\",\n            WINHTTP_NO_PROXY_BYPASS,0),L\"www.google.com\",INTERNET_DEFAULT_HTTPS_PORT,0),\n        NULL,uri_sprintf,NULL,WINHTTP_NO_REFERER,WINHTTP_DEFAULT_ACCEPT_TYPES,WINHTTP_FLAG_SECURE),\n        WINHTTP_NO_ADDITIONAL_HEADERS,0,WINHTTP_NO_REQUEST_DATA,0,0,0),\n\n        WinHttpReceiveResponse(hB2,NULL),\n\n        WinHttpQueryDataAvailable(hB2,&amp;dwReadBytes),\n\n        WinHttpReadData(hB2,&amp;chBuffer,dwReadBytes,&amp;dwReadBytes),\n\n        WinHttpCloseHandle(hB2),\n\n    WinHttpCloseHandle(hB1), WinHttpCloseHandle(hB0);\n} \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1555501816, "post_id": 55726915, "comment_id": 98132484, "body": "Is there a question here?"}, {"owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1555501952, "post_id": 55726915, "comment_id": 98132551, "body": "I have a problem to make a text file named by user that contains the structure and then download it back to stdout and I don&#39;t know how to fix my functions to do this correctly"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555502059, "post_id": 55726915, "comment_id": 98132610, "body": "Take a debugger and step through the code."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1555502150, "post_id": 55726915, "comment_id": 98132663, "body": "L0KiZ:   Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1555591954, "creation_date": 1555591954, "answer_id": 55746483, "question_id": 55726915, "link": "https://stackoverflow.com/questions/55726915/c-problem-with-saving-structure-to-text-file-and-downloading-it-back-to-stdout/55746483#55746483", "title": "C problem with saving structure to text file and downloading it back to stdout", "body": "<p>You call <code>save_file(countrydata, filename, i);</code> without having set <code>filename</code>. Change to <code>save_file(countrydata, line, i);</code> since for whatever reason you expect the command character <code>W</code> to precede the name.</p>\n\n<p>Then in <code>save_file()</code> the condition in <code>while (data[a].country[0] != 0)</code> is unusable, since the data element after the last one is not initialized. Use <code>while (a &lt; i)</code> instead.</p>\n"}], "owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555591954, "creation_date": 1555501721, "last_edit_date": 1555502112, "question_id": 55726915, "link": "https://stackoverflow.com/questions/55726915/c-problem-with-saving-structure-to-text-file-and-downloading-it-back-to-stdout", "title": "C problem with saving structure to text file and downloading it back to stdout", "body": "<p>Hey I have a problem with my code project where I try to create a project that keeps up wit Olympic medals. I have a problem of creating a text file that contains the structure and is named by user. I also have a problem to download the structure. </p>\n\n<p>PROBLEM: I have a problem to make a text file named by user that contains the structure and then download it back to stdout. I don't know how to fix my functions to do this correctly. Now my function save_file can't even produce the file.  </p>\n\n<p>Example if the input:</p>\n\n<p>A Canada</p>\n\n<p>A USA</p>\n\n<p>M USA 2 1 1</p>\n\n<p>M Canada 0 0 1</p>\n\n<p>M USA 1 3 1</p>\n\n<p>M USA -1 0 0</p>\n\n<p>L</p>\n\n<p>W medals</p>\n\n<p>Q</p>\n\n<p>I have defined my structure this way:</p>\n\n<pre><code>typedef struct Olympia\n    {\n        char* country;\n        int gold;\n        int silver;\n        int bronze;\n    }Olympia;\n</code></pre>\n\n<p>Then I have a function that adds country</p>\n\n<pre><code>int add_country(struct Olympia* data, char* str, int i)\n{\n    if (str[0] == '\\0') //checking that input is correct\n    {\n        printf(\"Error! Try again!\\n\");\n    }\n\n    else\n    {\n        data[i].country = malloc(strlen(str) + 2);  //allocating memory for country name\n        strcpy(data[i].country, str);   //adding country to database\n        data[i].gold = 0;   //setting medals to zero\n        data[i].silver = 0;\n        data[i].bronze = 0;\n        i++;\n    }\n    return i;\n}\n</code></pre>\n\n<p>Next I add medals to the each country</p>\n\n<pre><code>int update_medals(struct Olympia* data, char* str, int add_gold, int add_silver, int add_bronze, int i)\n{\n    int a = 0;\n    int b = 0;\n\n    if (str[0] == '\\0') //checking that input is correct\n    {\n        printf(\"Error! Try again!\");\n    }\n\n    else\n    {\n        while (a &lt; i)\n        {\n            if (strcmp(data[a].country, str) == 0)  //adding medals to right country\n            {\n                data[a].gold = data[a].gold + add_gold;\n                data[a].silver = data[a].silver + add_silver;\n                data[a].bronze = data[a].bronze + add_bronze;\n                b++;\n            }\n            a++;\n        }\n\n        if (b == 0) //and if the country didn't participate to the olympics\n        {\n            printf(\"This country isn't in the Olympics! Try Again!\\n\");\n        }\n    }\n}\n</code></pre>\n\n<p>Next there is print function</p>\n\n<pre><code>int print_data(struct Olympia* data, int i)\n{\n    for (int a = 0; a &lt; i; a++)\n    {\n        printf(\"%s %d %d %d\\n\", data[a].country, data[a].gold, data[a].silver, data[a].bronze);\n    }\n}\n</code></pre>\n\n<p>And then there are the two function that doesn't work. What should I do?</p>\n\n<pre><code>Olympia *save_file(Olympia* data, const char* filename, int i)\n{\n    if (strlen(filename) &gt; 100)\n    {\n        printf(\"Filename is too long: Maxium lenght for filename is 100 characters\");\n        return data;\n    }\n\n    char name[100];\n    int ret = sscanf(filename, \"W %s\", name);\n    if (ret != 1)\n    {\n        printf(\"Error! Try again!\");\n        return data;\n    }\n\n\n    FILE* file = fopen(name, \"w\");\n    if (!file)\n    {\n        printf(\"Error saving file! Try again\");\n        return data;\n    }\n\n    int a = 0;\n    while (data[a].country[0] != 0)\n    {\n        fprintf(file, \"%s %d %d %d\\n\", data[a].country, data[a].gold, data[a].silver, data[a].bronze);\n        a++;\n    }\n\n    fclose(file);\n    return 0;\n}\n\nint load_file(struct Olympia* data, char* filename, int i)\n{\n    int a = 0;\n\n    FILE* file = fopen(filename, \"r\");\n    if (!file)\n    {\n        printf(\"Error opening file! Try again\");\n    }\n\n    struct Olympia* arr = malloc(sizeof(Olympia));\n\n    while (fscanf(file, \"%s %d %d %d\", data[a].country, data[a].gold, data[a].silver, data[a].bronze))\n    {\n        i++;\n        a++;\n        arr = realloc(arr, sizeof(Olympia) * (i + 2));\n    }\n    arr[a].country[0] = 0;\n    fclose(file);\n    return arr;\n}\n</code></pre>\n\n<p>And the main function</p>\n\n<pre><code>int main(void)\n{\n    char command;\n    int gold = 0;\n    int silver = 0;\n    int bronze = 0;\n    int i = 0;\n\n    char* line = (char*)malloc((100) * sizeof(char)); //allocating memory for one stdin line\n    char* countryname = (char*)malloc(20 * sizeof(char)); // allocating memory for country name\n    char* filename = (char*)malloc(100 * sizeof(char));\n    struct Olympia* countrydata = malloc(sizeof(struct Olympia) * 1); //allocating memory for structure\n\n    line = fgets(line, 100, stdin);\n\n    while(1)\n    {\n        sscanf(line, \"%c %s %d %d %d\", &amp;command, countryname, &amp;gold, &amp;silver, &amp;bronze);\n\n        switch (command)\n        {\n            case 'A':\n\n                i = add_country(countrydata, countryname, i);\n                countrydata = realloc(countrydata, sizeof(struct Olympia) * (i + 1));\n                break;\n\n            case 'M':\n\n                update_medals(countrydata, countryname, gold, silver, bronze, i);\n                break;\n\n            case 'L':\n\n                print_data(countrydata, i);\n                break;\n\n            case 'W':\n\n                save_file(countrydata, filename, i);\n                break;\n\n            case 'O':\n\n                i = load_file(countrydata,filename, i);\n                break;\n\n            case 'Q':\n\n                free(line);\n                free(countryname);\n                free(countrydata);\n                return(EXIT_SUCCESS);\n        }\n\n        line = fgets(line, 100, stdin);\n\n        if (line == NULL)\n        {\n            free(line);\n            free(countryname);\n            free(countrydata);\n            return(EXIT_SUCCESS);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "elf"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555500447, "post_id": 55726319, "comment_id": 98131697, "body": "Your code correctly prints the names of the functions in the order they are called. The libelf listing are the names of functions and object in the executable; it doesn&#39;t tell you the order in which they are called. What do you want?"}, {"owner": {"reputation": 412, "user_id": 10347292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhMMolLithM/AAAAAAAAAAI/AAAAAAAAATI/pCcptXjRUQA/photo.jpg?sz=128", "display_name": "Zahreddine Laidi", "link": "https://stackoverflow.com/users/10347292/zahreddine-laidi"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555500557, "post_id": 55726319, "comment_id": 98131757, "body": "To retrieve only functions that i called, like Main(), toto(), tutu() and mdr(). @PaulOgilvie"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555500614, "post_id": 55726319, "comment_id": 98131783, "body": "Retrieve from what?"}, {"owner": {"reputation": 412, "user_id": 10347292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhMMolLithM/AAAAAAAAAAI/AAAAAAAAATI/pCcptXjRUQA/photo.jpg?sz=128", "display_name": "Zahreddine Laidi", "link": "https://stackoverflow.com/users/10347292/zahreddine-laidi"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555500762, "post_id": 55726319, "comment_id": 98131890, "body": "To retrieve it with the ELF Lib, i don&#39;t know if this is possible.. (And by the way, the functions are not called in the order, see it, i normally call main firstly, and toto, tutu, and for finish, mdr. But it print me mdr, toto, tutu and main, so i don&#39;t understand too how can i print them with the good order, but this is a differant problem.) @PaulOgilvie"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1555501143, "post_id": 55726319, "comment_id": 98132115, "body": "I am sorry, I just don&#39;t understand what you want."}, {"owner": {"reputation": 412, "user_id": 10347292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhMMolLithM/AAAAAAAAAAI/AAAAAAAAATI/pCcptXjRUQA/photo.jpg?sz=128", "display_name": "Zahreddine Laidi", "link": "https://stackoverflow.com/users/10347292/zahreddine-laidi"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555501570, "post_id": 55726319, "comment_id": 98132348, "body": "I actually retrieve the second code prog posted, but i only want to have a prog, who can retrieve from the ELF Library, the called function in my C prog, created by me. But i wanna have this, in this order: main() -&gt; toto() -&gt; printf() -&gt; tutu() -&gt; printf() -&gt; mdr -&gt; printf() -&gt; printf() -&gt; printf() -&gt; printf() -&gt; end of the prog. I hope this is possible! @PaulOgilvie"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1555502798, "post_id": 55726319, "comment_id": 98133069, "body": "Do you want to write some decompiler?"}, {"owner": {"reputation": 412, "user_id": 10347292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhMMolLithM/AAAAAAAAAAI/AAAAAAAAATI/pCcptXjRUQA/photo.jpg?sz=128", "display_name": "Zahreddine Laidi", "link": "https://stackoverflow.com/users/10347292/zahreddine-laidi"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1555504147, "post_id": 55726319, "comment_id": 98133903, "body": "Among others .. @Mathieu"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1555504600, "post_id": 55726319, "comment_id": 98134204, "body": "are you looking for a <a href=\"https://en.wikipedia.org/wiki/Profiling_(computer_programming)#Call-graph_profiler\" rel=\"nofollow noreferrer\">profiler</a> ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1555504605, "post_id": 55726319, "comment_id": 98134207, "body": "Filter the result above? <code>... | grep FUNC | grep -v _</code>"}], "owner": {"reputation": 412, "user_id": 10347292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhMMolLithM/AAAAAAAAAAI/AAAAAAAAATI/pCcptXjRUQA/photo.jpg?sz=128", "display_name": "Zahreddine Laidi", "link": "https://stackoverflow.com/users/10347292/zahreddine-laidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555504207, "creation_date": 1555499774, "last_edit_date": 1555500403, "question_id": 55726319, "link": "https://stackoverflow.com/questions/55726319/retrieve-names-of-called-functions-in-a-c-program-lib-elf", "title": "Retrieve names of called functions in a C program (Lib ELF)", "body": "<p>I'm trying to get the name of the called functions in a C program.</p>\n\n<p>For exemple, this is my code:</p>\n\n<pre><code>void toto(void)\n{\n    printf(\"toto\\n\");\n}\n\nvoid tutu(void)\n{\n    printf(\"tutu\\n\");\n}\n\nvoid mdr(void)\n{\n    printf(\"tutu\\n\");\n    printf(\"tutu\\n\");\n    printf(\"tutu\\n\");\n    printf(\"tutu\\n\");\n}\n\nint main(int ac, char **av)\n{\n    toto();\n    tutu();\n    mdr();\n}\n</code></pre>\n\n<p>I only wanna have on results : Main(), toto(), tutu() and mdr().\nBut the problem is, that when i'm using the Libelf, i retrieve some informations on the Symbol Table, but it gives me my functions called and more, like this example :</p>\n\n<pre><code>...\n    57: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_\n    58: 0000000000401148    47 FUNC    GLOBAL DEFAULT   13 mdr\n    59: 0000000000401126    17 FUNC    GLOBAL DEFAULT   13 toto\n    60: 0000000000404020     0 NOTYPE  GLOBAL DEFAULT   23 __data_start\n    61: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n    62: 0000000000402008     0 OBJECT  GLOBAL HIDDEN    15 __dso_handle\n    63: 0000000000401137    17 FUNC    GLOBAL DEFAULT   13 tutu\n    64: 0000000000402000     4 OBJECT  GLOBAL DEFAULT   15 _IO_stdin_used\n    65: 00000000004011a0   101 FUNC    GLOBAL DEFAULT   13 __libc_csu_init\n    66: 0000000000404028     0 NOTYPE  GLOBAL DEFAULT   24 _end\n    67: 0000000000401070     5 FUNC    GLOBAL HIDDEN    13 _dl_relocate_static_pie\n    68: 0000000000401040    47 FUNC    GLOBAL DEFAULT   13 _start\n    69: 0000000000404024     0 NOTYPE  GLOBAL DEFAULT   24 __bss_start\n    70: 0000000000401177    37 FUNC    GLOBAL DEFAULT   13 main\n    71: 0000000000404028     0 OBJECT  GLOBAL HIDDEN    23 __TMC_END__\n    72: 0000000000401000     0 FUNC    GLOBAL HIDDEN    11 _init\n</code></pre>\n\n<p>So how can i only retrieve my called functions ? Thanks again for the help</p>\n"}, {"tags": ["c", "cuda", "gpu", "nvcc"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9186308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef5280b0679616bccc053d887d0224e?s=128&d=identicon&r=PG&f=1", "display_name": "onie", "link": "https://stackoverflow.com/users/9186308/onie"}, "edited": false, "score": 0, "creation_date": 1555502029, "post_id": 55726248, "comment_id": 98132595, "body": "Thank you so much, Mr. Crovella. I really appreciate it. The following worked,  <code>c_out[i] = (int)pow((float)m_in[i], e)\t%\tn;</code>"}, {"owner": {"reputation": 393, "user_id": 10933512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ee6f66a6609042b7b00591c99aa654?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Bauer", "link": "https://stackoverflow.com/users/10933512/daniel-bauer"}, "edited": false, "score": 0, "creation_date": 1555567195, "post_id": 55726248, "comment_id": 98157089, "body": "for cryptography you will want very pecise answers, so you should notice what the last block in the answer said about truncation."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": false, "score": 1, "last_activity_date": 1555500913, "last_edit_date": 1555500913, "creation_date": 1555499581, "answer_id": 55726248, "question_id": 55725825, "link": "https://stackoverflow.com/questions/55725825/struggles-with-rsa-encryption-on-cuda/55726248#55726248", "title": "Struggles with RSA Encryption on CUDA", "body": "<p>In C or C++, this:</p>\n\n<pre><code>(x^y) \n</code></pre>\n\n<p>does not raise x to the power of y.  <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/bitwise-exclusive-or-operator-hat?view=vs-2019\" rel=\"nofollow noreferrer\">It performs a bitwise exclusive-or operation</a>.  That is why your first realization does not give the correct answer.</p>\n\n<p>In C or C++, the modulo arithmetic operator:</p>\n\n<pre><code>%\n</code></pre>\n\n<p>is <a href=\"https://stackoverflow.com/questions/6102948/why-does-modulus-division-only-work-with-integers\">only defined for integer arguments</a>.  Even though you are passing integers to the <code>__pow()</code> function, the return result of that function is a <code>double</code> (i.e. a floating-point quantity, not an integer quantity).</p>\n\n<p>I don't know the details of the math you need to perform, but if you cast the result of <code>__pow</code> to an <code>int</code> (for example) this compile error will disappear.  <strong>That may or may not be valid for whatever arithmetic you wish to perform</strong>.  (For example, you may wish to cast it to a \"long\" integer quantity.)</p>\n\n<p>After you do that, you will run into another compile error. The easiest approach is to use <code>pow()</code> instead of <code>__pow()</code>:</p>\n\n<pre><code>c_out[i] = (int)pow(m_in[i], e) % n;\n</code></pre>\n\n<p>If you were actually trying to use <a href=\"https://docs.nvidia.com/cuda/cuda-math-api/modules.html#modules\" rel=\"nofollow noreferrer\">the CUDA fast-math intrinsic</a>, you should use <code>__powf</code> not <code>__pow</code>:</p>\n\n<pre><code>c_out[i] = (int)__powf(m_in[i], e) % n;\n</code></pre>\n\n<p>Note that fast-math intrinsics generally have reduced precision.</p>\n\n<p>Since these raise-to-power functions are performing floating-point arithmetic (even though you are passing integers) it is possible to get some possibly unexpected results.  For example, if you raise 5 to the power of 2, its possible to get 24.9999999999 instead of 25.  If you simply cast this to an integer quantity, you will get truncation to 24.  Therefore you may need to explore rounding your result to the nearest integer, instead of casting.  But again, I haven't studied the math you desire to perform.</p>\n"}], "owner": {"reputation": 13, "user_id": 9186308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef5280b0679616bccc053d887d0224e?s=128&d=identicon&r=PG&f=1", "display_name": "onie", "link": "https://stackoverflow.com/users/9186308/onie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555500913, "creation_date": 1555498212, "question_id": 55725825, "link": "https://stackoverflow.com/questions/55725825/struggles-with-rsa-encryption-on-cuda", "title": "Struggles with RSA Encryption on CUDA", "body": "<p>I am trying to accelerate encryption using the RSA algorithm using CUDA. I can't properly perform power-modulo in the kernel function.</p>\n\n<p>I am using Cuda compilation tools on AWS, release 9.0, V9.0.176 to compile.</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;math.h&gt;\n#include \"main.h\"\n\n// Kernel function to encrypt the message (m_in) elements into cipher (c_out)\n__global__\nvoid enc(int numElements, int e, int n, int *m_in, int *c_out)\n{\n    int index = blockIdx.x * blockDim.x + threadIdx.x;\n    int stride = blockDim.x * gridDim.x;\n\n    printf(\"e = %d, n = %d, numElements = %d\\n\", e, n, numElements);\n    for (int i = index; i &lt; numElements; i += stride)\n    {\n// POINT OF ERROR //\n        // c_out[i] = (m_in[i]^e) % n;     //**GIVES WRONG RESULTS**\n         c_out[i] = __pow(m_in[i], e) % n; //**GIVES, error: expression must have integral or enum type**\n    }\n\n\n}\n</code></pre>\n\n<pre><code>// This function is called from main() from other file.\nint* cuda_rsa(int numElements, int* data, int public_key, int key_length)\n{\n    int e = public_key;\n    int n = key_length;\n\n    // Allocate Unified Memory \u2013 accessible from CPU or GPU\n    int* message_array;\n    cudaMallocManaged(&amp;message_array, numElements*sizeof(int));\n    int* cipher_shared_array;       //Array shared by CPU and GPU\n    cudaMallocManaged(&amp;cipher_shared_array, numElements*sizeof(int));\n\n    int* cipher_array = (int*)malloc(numElements * sizeof(int));\n\n    //Put message array to be encrypted in a managed array\n    for(int i=0; i&lt;numElements; i++)\n    {\n        message_array[i] = data[i];\n    }\n\n    // Run kernel on 16M elements on the GPU\n    enc&lt;&lt;&lt;1, 1&gt;&gt;&gt;(numElements, e, n, message_array, cipher_shared_array);\n\n    // Wait for GPU to finish before accessing on host\n    cudaDeviceSynchronize();\n\n    //Copy into a host array and pass it to main() function for verification. \n    //Ignored memory leaks.\n    for(int i=0; i&lt;numElements; i++)\n    {\n        cipher_array[i] = cipher_shared_array[i];\n    }\n    return (cipher_array);\n}\n</code></pre>\n\n<p>Please help me with this error. \nHow can I implement power-modulo (as follows) on CUDA kernel?</p>\n\n<pre><code>(x ^ y) % n;\n</code></pre>\n\n<p>I would really appreciate any help.</p>\n"}, {"tags": ["c", "bitwise-operators"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1555498014, "post_id": 55725713, "comment_id": 98130319, "body": "Well, you appear to have 6 significant bits, so you should probably left-shift by 6 and 12, respectively."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555498125, "post_id": 55725713, "comment_id": 98130380, "body": "If <code>b1</code> and <code>b2</code> are supposed to have 6 bits each you would have to use <code>(b3&lt;&lt;12)|(b2&lt;&lt;6)|b1</code>. Please also show the declarations of <code>b1</code>, <code>b2</code>, <code>b3</code>."}, {"owner": {"reputation": 47, "user_id": 11032665, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqKBf63iTEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPXW2kA-yTs_fRpWyak8sdnnnQsrA/mo/photo.jpg?sz=128", "display_name": "Teo Laferla", "link": "https://stackoverflow.com/users/11032665/teo-laferla"}, "edited": false, "score": 0, "creation_date": 1555498253, "post_id": 55725713, "comment_id": 98130441, "body": "If you guys mean like combine=(*b1&lt;&lt;12)|(*b2&lt;&lt;6)|*b3; i&#39;ve tried it, same result;4097."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555498797, "post_id": 55725713, "comment_id": 98130726, "body": "You still didn&#39;t show the declaration of <code>b1</code>, <code>b2</code> and <code>b3</code>. You use them as pointers, so you might even have undefined behavior. We don&#39;t know without seeing the missing code."}], "answers": [{"tags": [], "owner": {"reputation": 6451, "user_id": 1827457, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36a4fa28b2cfce2c219592f7880e4008?s=128&d=identicon&r=PG", "display_name": "LtWorf", "link": "https://stackoverflow.com/users/1827457/ltworf"}, "is_accepted": false, "score": 0, "last_activity_date": 1555498266, "creation_date": 1555498266, "answer_id": 55725843, "question_id": 55725713, "link": "https://stackoverflow.com/questions/55725713/how-to-combine-3-binary-data-in-c/55725843#55725843", "title": "How to combine 3 binary data in C?", "body": "<ol>\n<li>You are shifting too much, you end up leaving zeroes in between your numbers</li>\n<li>Do not use <code>int</code>, you probably want to use <code>unsigned long long int</code> for this or <code>uint64_t</code> Int's size is not specified in the C standard.</li>\n<li>I tried running your code in python and it results 763905 to me, so you might have some other bugs that are not shown here.</li>\n<li>Why are you using them as pointers? That seems unrelated to the question you're asking here.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 11032665, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqKBf63iTEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPXW2kA-yTs_fRpWyak8sdnnnQsrA/mo/photo.jpg?sz=128", "display_name": "Teo Laferla", "link": "https://stackoverflow.com/users/11032665/teo-laferla"}, "edited": false, "score": 0, "creation_date": 1555499169, "post_id": 55725849, "comment_id": 98130924, "body": "I am sorry i couldn&#39;t i understand how you calculated 6795. printf(&quot;%d&quot;, combine) gives 4097. Was i doing something wrong?"}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1555500373, "last_edit_date": 1555500373, "creation_date": 1555498290, "answer_id": 55725849, "question_id": 55725713, "link": "https://stackoverflow.com/questions/55725713/how-to-combine-3-binary-data-in-c/55725849#55725849", "title": "How to combine 3 binary data in C?", "body": "<p>So when br3 is MSB it should be:</p>\n\n<pre><code>int combine=(*b3&lt;&lt;12)|(*b2&lt;&lt;6)|*b1;\n\n\n  0b0001     (1d)  * 4096  (12 left shift)  = 4096\n +0b101010   (42d) *   64  (6 left shift)   = 2688\n +0b001011   (11d) *    1                   =   11\n  _________________________________________________\n                                               6795\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 47, "user_id": 11032665, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqKBf63iTEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPXW2kA-yTs_fRpWyak8sdnnnQsrA/mo/photo.jpg?sz=128", "display_name": "Teo Laferla", "link": "https://stackoverflow.com/users/11032665/teo-laferla"}, "edited": false, "score": 0, "creation_date": 1555500754, "post_id": 55726277, "comment_id": 98131882, "body": "@teolaferla If this is what you need, you could accept the answer."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 0, "last_activity_date": 1555501227, "last_edit_date": 1555501227, "creation_date": 1555499673, "answer_id": 55726277, "question_id": 55725713, "link": "https://stackoverflow.com/questions/55725713/how-to-combine-3-binary-data-in-c/55726277#55726277", "title": "How to combine 3 binary data in C?", "body": "<p>Your function <code>get_bits</code> doesn't return an <code>int</code> or similar which you could combine by bit shifting and bitwise OR. It returns an <code>int</code> array where every element contains the value of a single bit. </p>\n\n<p>(It would be possible to combine the data from these arrays as needed by processing the bits one by one, but this concept has other pitfalls because you would have to make sure you don't access the dynamically allocate memory out of bounds.)</p>\n\n<p>Here is a modified version of your program that works with <code>unsigned int</code> instead of <code>int</code> arrays.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int get_bits(unsigned int n, int bitswanted){\n    return n &amp; ((1&lt;&lt;bitswanted)-1);\n}\n\nint main()\n{\n    unsigned long r=0b0010110100111110000010110110101010000001;\n    int i;\n    int byte1,byte2,byte3,byte4,byte5;\n\n    int bw6=6,bw4=4;\n\n    byte1 = (r&gt;&gt;32) &amp; 0xFF;\n    byte2 = (r&gt;&gt;24) &amp; 0xFF;\n    byte3 = (r&gt;&gt;16) &amp; 0xFF;\n    byte4 = (r&gt;&gt;8) &amp; 0xFF;\n    byte5 = (r&gt;&gt;0) &amp; 0xFF;\n\n   int Lbits=get_bits(byte3,bw6);\n   int Mbits=get_bits(byte4,bw6);\n   int Hbits=get_bits(byte5,bw4);\n\n   int combine=(Hbits&lt;&lt;12)|(Mbits&lt;&lt;6)|Lbits;\n\n   printf(\"%d\\n\",combine);\n}\n</code></pre>\n\n<p>The program prints the result <code>6795</code>.</p>\n\n<p>see <a href=\"https://ideone.com/44pjjF\" rel=\"nofollow noreferrer\">https://ideone.com/44pjjF</a></p>\n"}], "owner": {"reputation": 47, "user_id": 11032665, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqKBf63iTEc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPXW2kA-yTs_fRpWyak8sdnnnQsrA/mo/photo.jpg?sz=128", "display_name": "Teo Laferla", "link": "https://stackoverflow.com/users/11032665/teo-laferla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 55726277, "answer_count": 3, "score": 0, "last_activity_date": 1555506065, "creation_date": 1555497799, "last_edit_date": 1555506065, "question_id": 55725713, "link": "https://stackoverflow.com/questions/55725713/how-to-combine-3-binary-data-in-c", "title": "How to combine 3 binary data in C?", "body": "<p>I am trying to combine following bit sequences into one variable then i will turn it to a decimal. </p>\n\n<pre><code>*b1=0b001011;\n*b2=0b101010;\n*b3=0b0001;\n</code></pre>\n\n<p>Bit order should be like following;</p>\n\n<p>newBin=0001101010001011 (newBin=b3b2b1)</p>\n\n<p>I tried following code piece but couldn't get correct decimal equivalent.</p>\n\n<pre><code>int combine=(*b1&lt;&lt;16)|(*b2&lt;&lt;10)|*b3;\n</code></pre>\n\n<p>when i printf the combine it is giving 4097 but it should give 6795.</p>\n\n<p>I would appreciate any help / suggestion.</p>\n\n<p>Important notes: I had i already tried combine=(*b1&lt;&lt;12)|(*b2&lt;&lt;6)|*b3; and combine=(*b3&lt;&lt;16)|(*b2&lt;&lt;10)|*b1; results are all same;4097.</p>\n\n<p>in the complete program i am parsing an 32 bit value. I used the code given by \"forefinger\" from below link.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2249731/how-do-i-get-bit-by-bit-data-from-an-integer-value-in-c#comment24029766_2249738\">How do I get bit-by-bit data from an integer value in C?</a></p>\n\n<p>Following is the complete code of my version;</p>\n\n<pre><code>int *get_bits(int n, int bitswanted){\n  int *bits = malloc(sizeof(int) * bitswanted);\n\n  int k;\n  for(k=0; k&lt;bitswanted; k++){\n    int mask =  1 &lt;&lt; k;\n    int masked_n = n &amp; mask;\n    int thebit = masked_n &gt;&gt; k;\n    bits[k] = thebit;\n  }\n\n  return bits;\n}\n\nint main()\n{\n    long r=0b0010110100111110000010110110101010000001;\n    int i;\n    int byte1,byte2,byte3,byte4,byte5;\n    //int *Lbits,*Mbits,*Hbits;\n    int bw6=6,bw4=4;\n\n    byte1 = (r&gt;&gt;32) &amp; 0xFF;\n    byte2 = (r&gt;&gt;24) &amp; 0xFF;\n    byte3 = (r&gt;&gt;16) &amp; 0xFF;\n    byte4 = (r&gt;&gt;8) &amp; 0xFF;\n    byte5 = (r&gt;&gt;0) &amp; 0xFF;\n\n   int *Lbits=get_bits(byte3,bw6);\n   int *Mbits=get_bits(byte4,bw6);\n   int *Hbits=get_bits(byte5,bw4);\n\n   int combine=(Hbits&lt;&lt;12)|(&amp;Mbits&lt;&lt;6)|Lbits;\n\n\n\n  for(i=bw6-1; i&gt;=0;i--)\n  {\n    printf(\"%d\", Lbits[i]);\n  }\n  printf(\"\\n\");\n\n  for(i=bw6-1; i&gt;=0;i--)\n  {\n    printf(\"%d\", Mbits[i]);\n  }\n  printf(\"\\n\");\n\n  for(i=bw4-1; i&gt;=0;i--)\n  {\n    printf(\"%d\", Hbits[i]);\n  }\n  printf(\"\\n\");\n\n  printf(\"%d\",combine);\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555607649, "post_id": 55725033, "comment_id": 98178396, "body": "the posted code is missing the statement: <code>#include &lt;unistd.h&gt;</code>, needed for the <code>sleep()</code> function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555607852, "post_id": 55725033, "comment_id": 98178478, "body": "OT: regarding; <code>return NULL;</code>  A much better way to exit a thread function is to use the function: <code>pthread_exit( NULL );</code>"}], "answers": [{"tags": [], "owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "is_accepted": false, "score": 0, "last_activity_date": 1555496495, "last_edit_date": 1555496495, "creation_date": 1555495699, "answer_id": 55725092, "question_id": 55725033, "link": "https://stackoverflow.com/questions/55725033/how-this-program-with-threads-works/55725092#55725092", "title": "How this program with threads works?", "body": "<p>You are passing address of i as an argument. After the loop ends, value of i will be 5. All the threads sleeps for 2 seconds and prints the same value.</p>\n\n<blockquote>\n  <p>(void*)&amp;i</p>\n</blockquote>\n\n<pre><code>pthread_create(&amp;id[i], NULL, dretva, (void*)&amp;i);\n</code></pre>\n\n<p>you can use an array to store the tid.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\nvoid *dretva (void *x)\n{\n   sleep(2);\n   printf(\"%d\\n\", *((int *)x));\n\nreturn NULL;\n}\nint main()\n{\n   pthread_t id[5];\n   int args[5];\n   int i;\n   for(i=0;i&lt;5;i++)\n   {   int j;\n       args[i] = i; // storing tid\n       pthread_create(&amp;id[i], NULL, dretva, &amp;args[i]);\n   }    \n   sleep(5);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "is_accepted": false, "score": 1, "last_activity_date": 1555496616, "last_edit_date": 1555496616, "creation_date": 1555496211, "answer_id": 55725264, "question_id": 55725033, "link": "https://stackoverflow.com/questions/55725033/how-this-program-with-threads-works/55725264#55725264", "title": "How this program with threads works?", "body": "<blockquote>\n  <p>The program write five times five.(Why just five? Why not 1,2,3 or 4)</p>\n</blockquote>\n\n<p>When all the threads started executing, the value of <code>i</code> was already set to 5 in the main thread. But it is not guaranteed to print 5 five times always. Whatever the value of i at the time of execution of a thread will be, that value will be printed.</p>\n\n<blockquote>\n  <p>what is the difference when I comment line sleep(5)</p>\n</blockquote>\n\n<p>The developer of this code is making the main thread wait for 5 seconds. You should use join to block the main thread until the other threads have returned.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11344608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ConXkpyyX0A/AAAAAAAAAAI/AAAAAAAAABE/lk9Sgh3Fhms/photo.jpg?sz=128", "display_name": "Joerg Neumann external", "link": "https://stackoverflow.com/users/11344608/joerg-neumann-external"}, "reply_to_user": {"reputation": 111, "user_id": 9960511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9b9b2b5a773c69018b12614449952f?s=128&d=identicon&r=PG&f=1", "display_name": "josf", "link": "https://stackoverflow.com/users/9960511/josf"}, "edited": false, "score": 1, "creation_date": 1555497530, "post_id": 55725284, "comment_id": 98130029, "body": "That depends on the scheduler, on factors like which priority you assigned, which other threads are active and other factors not in your hand ( such as interrupt load )"}], "tags": [], "owner": {"reputation": 11, "user_id": 11344608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ConXkpyyX0A/AAAAAAAAAAI/AAAAAAAAABE/lk9Sgh3Fhms/photo.jpg?sz=128", "display_name": "Joerg Neumann external", "link": "https://stackoverflow.com/users/11344608/joerg-neumann-external"}, "is_accepted": false, "score": 1, "last_activity_date": 1555496268, "creation_date": 1555496268, "answer_id": 55725284, "question_id": 55725033, "link": "https://stackoverflow.com/questions/55725033/how-this-program-with-threads-works/55725284#55725284", "title": "How this program with threads works?", "body": "<p>You face likely a race condition here. The point is - as Naveen Kumar pointed out - by the time your threads become active, the content at address of i is 5, hence each of your threads prints out what it finds on address of i.\nIf you alternatively provide the value, you should get your desired result.\nWith the sleep-statement, you are sending your main thread into background keeping contents at the address of i intact. Without this statement, your main thread terminates thus freeing the memory at address of i. As result your threads may find random numbers to print. If you want to avoid that, try getting familiar with pthread_join.</p>\n"}, {"comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1555575011, "post_id": 55725362, "comment_id": 98160424, "body": "@LovroSindi\u010di\u0107: does this answer your question?"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1555496507, "creation_date": 1555496507, "answer_id": 55725362, "question_id": 55725033, "link": "https://stackoverflow.com/questions/55725033/how-this-program-with-threads-works/55725362#55725362", "title": "How this program with threads works?", "body": "<p>You cannot accurately predict the output in this case because the order in which the threads run is not guaranteed. And because of the <code>sleep</code> in each of the threads, it so happens (in this particular case) that the value of <code>i</code> has already been incremented to <code>5</code> in the <code>for</code> loop before the first thread has executed.</p>\n\n<p>If you want to see the output of <code>i</code> in an ascending order, just call <code>pthread_join</code> in the <code>for</code> loop. </p>\n\n<pre><code>for(i=0;i&lt;5;i++)\n{\n    pthread_create(&amp;id[i], NULL, dretva, (void*)&amp;i);\n    pthread_join(id[i], NULL);\n} \n</code></pre>\n\n<p>See <a href=\"http://coliru.stacked-crooked.com/a/6f76b0b1235b129b\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 111, "user_id": 9960511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9b9b2b5a773c69018b12614449952f?s=128&d=identicon&r=PG&f=1", "display_name": "josf", "link": "https://stackoverflow.com/users/9960511/josf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1555496616, "creation_date": 1555495496, "question_id": 55725033, "link": "https://stackoverflow.com/questions/55725033/how-this-program-with-threads-works", "title": "How this program with threads works?", "body": "<p>I try to learn basics about thread programming in c. And I found some problem which I can't figure it out.\nThe program write five times five.(Why just five? Why not 1,2,3 or 4)\nand what is the difference when I comment line sleep(5) and not?   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\nvoid *dretva (void *x)\n{\n   sleep(2);\n   printf(\"%d\\n\", *((int *)x));\n\nreturn NULL;\n}\nint main()\n{\n   pthread_t id[5];\n   int i;\n   for(i=0;i&lt;5;i++)\n   {\n       pthread_create(&amp;id[i], NULL, dretva, (void*)&amp;i);\n   }    \n   sleep(5); // why is different when this line is commented?\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "cmake", "gnu-make", "ninja"], "comments": [{"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "edited": false, "score": 2, "creation_date": 1555495320, "post_id": 55724934, "comment_id": 98128742, "body": "On unix systems, you could do something like <code>make 2&gt;&amp;1 | tee myLogFile</code>, which does print everything to stdout as well as to <code>myLogFile</code>. Should be identical with <code>ninja</code>."}, {"owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "reply_to_user": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "edited": false, "score": 1, "creation_date": 1555496139, "post_id": 55724934, "comment_id": 98129212, "body": "As @lubgr said, plus: When doing this in the cosole window, since you should start to resolve the compiler errors from top to bottom, simply pipe the output to <code>less</code> or <code>more</code>: <code>make 2&gt;&amp;1 | less</code>."}, {"owner": {"reputation": 171, "user_id": 8091812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89a2a9bb4ef0a14d2603bcef8a9425f?s=128&d=identicon&r=PG&f=1", "display_name": "user654789384", "link": "https://stackoverflow.com/users/8091812/user654789384"}, "edited": false, "score": 0, "creation_date": 1555585409, "post_id": 55724934, "comment_id": 98166061, "body": "ok thank you i will have a look at it. but the translation for this is: reroute stdout, store and alalyse by hand? i was hoping there might be a happy-coder already facing this issue in the past :)"}], "owner": {"reputation": 171, "user_id": 8091812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89a2a9bb4ef0a14d2603bcef8a9425f?s=128&d=identicon&r=PG&f=1", "display_name": "user654789384", "link": "https://stackoverflow.com/users/8091812/user654789384"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555495189, "creation_date": 1555495189, "question_id": 55724934, "link": "https://stackoverflow.com/questions/55724934/logging-make-ninja-warnings-to-a-file", "title": "Logging Make/Ninja Warnings to a file", "body": "<p>The make/ninja-build output is missing the possibility to have a clear overview of warnings and other messages. I search a solution to log warnings, messages and other compiler information somehow to a file, and sort the information as well as remove dublicates.</p>\n\n<p>Problems with the stdout which the compiler produces:</p>\n\n<ul>\n<li>Warnings and messages from header files are printed X-times instead of once</li>\n<li>the terminal coloring is not really helpful</li>\n<li>the terminal has a max line (back feed) where i can scroll back, the rest is lost</li>\n</ul>\n\n<p>As for those who work with Eclipse CDT:\nAt the end of the build you get a list in the \"Problems\" window as follows:\nFILENAME, LINE, WARNING /INFO</p>\n\n<p>If there would be a solution to mirror this output into a file, this would be very helpful</p>\n"}, {"tags": ["c", "if-statement", "struct", "concat", "conditional-operator"], "comments": [{"owner": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "edited": false, "score": 1, "creation_date": 1555494817, "post_id": 55724673, "comment_id": 98128443, "body": "There&#39;s no <code>String</code> in C, it&#39;s in C++. Please amend the tags accordingly."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555495263, "post_id": 55724673, "comment_id": 98128710, "body": "Arduino is programmed in C++, not C."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "edited": false, "score": 0, "creation_date": 1555495318, "post_id": 55724673, "comment_id": 98128740, "body": "@montonero There&#39;s no <code>String</code> in C++ either."}, {"owner": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1555500944, "post_id": 55724673, "comment_id": 98131997, "body": "@interjay My point was about incorrect tags, not about if <code>String</code> is a part of C++ standards. Obviously that the string comparison used by OP isn&#39;t possible in C but quite legal in C++."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1555495089, "post_id": 55724876, "comment_id": 98128616, "body": "We don&#39;t compare strings like that."}, {"owner": {"reputation": 3, "user_id": 7442225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e28c5f31559a6bd640ba9ba5da58e02b?s=128&d=identicon&r=PG&f=1", "display_name": "Paxulol", "link": "https://stackoverflow.com/users/7442225/paxulol"}, "edited": false, "score": 0, "creation_date": 1555495525, "post_id": 55724876, "comment_id": 98128868, "body": "Yes, that is a very very good question. Especially because it works... Thanks man!"}, {"owner": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "reply_to_user": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 1, "creation_date": 1555501167, "post_id": 55724876, "comment_id": 98132131, "body": "@Mazhar if by &quot;we&quot; you mean &quot;we, C developers&quot;, then you&#39;re totally correct. But unfortunately this question is not about C."}], "tags": [], "owner": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "is_accepted": true, "score": 0, "last_activity_date": 1555495005, "creation_date": 1555495005, "answer_id": 55724876, "question_id": 55724673, "link": "https://stackoverflow.com/questions/55724673/how-to-compose-a-variable-name-in-one-line-as-part-of-struct-call/55724876#55724876", "title": "How to compose a variable name in one line, as part of struct call?", "body": "<p>Why don't use a usual condition?</p>\n\n<pre><code>dir == \"Ccw\"? Intersection-&gt;incomming-&gt;leadingToCcw : Intersection-&gt;incomming-&gt;leadingToCw\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555495324, "creation_date": 1555495324, "answer_id": 55724986, "question_id": 55724673, "link": "https://stackoverflow.com/questions/55724673/how-to-compose-a-variable-name-in-one-line-as-part-of-struct-call/55724986#55724986", "title": "How to compose a variable name in one line, as part of struct call?", "body": "<p>There is nothing like <code>String</code> in the C. You can use <code>char *</code> instead like below</p>\n\n<pre><code>char *dir = \"Ccw\";\n\nif (strcmp(dir, \"Ccw\") == 0)\n{\n// Do whatever you want to do with Intersection-&gt;incomming-&gt;leadingToCcw\n}\nelse if (strcmp(dir, \"Cw\") == 0)\n{\n// Do whatever you want to do with Intersection-&gt;incomming-&gt;leadingToCw\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7442225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e28c5f31559a6bd640ba9ba5da58e02b?s=128&d=identicon&r=PG&f=1", "display_name": "Paxulol", "link": "https://stackoverflow.com/users/7442225/paxulol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55724876, "answer_count": 2, "score": 0, "last_activity_date": 1555495324, "creation_date": 1555494377, "question_id": 55724673, "link": "https://stackoverflow.com/questions/55724673/how-to-compose-a-variable-name-in-one-line-as-part-of-struct-call", "title": "How to compose a variable name in one line, as part of struct call?", "body": "<p>I have NO idea if what i'm trying to accomplish is doable at all. I'm pretty new to C.</p>\n\n<p>I have a struct that contains a pointer to another struct, that contains yet another pointer to another struct.\nThe last struct contains two pointers to structs called \"leadingToCw\" and \"leadingToCcW\". I also have a global String variable dir which can change from Cw to Ccw at any point in time. It looks someting like this:</p>\n\n<pre><code>#define concat(a,b) a##b\nString dir = \"Ccw\"; // or \"Cw\"\n\nstruct Intersection {\n    struct Sector *incoming;\n}\n\nstruct Sector {\n    struct Sector *leadingToCcw;\n    struct Sector *leadingToCw;\n};\n</code></pre>\n\n<p>Now the thing i want to is call the leadingToCcw or leadingToCw depending on the \"dir\" string, so that the output would look like this:</p>\n\n<pre><code>Intersection-&gt;incoming-&gt;leadingToCcw\n</code></pre>\n\n<p>I've tried something like this:</p>\n\n<pre><code>Intersection-&gt;incomming-&gt;(dir == \"Ccw\" ? concat(leadingTo, Ccw) : concat(leadingTo, Cw))\n</code></pre>\n\n<p>but i get this error:</p>\n\n<pre><code>error: expected unqualified-id before '(' token\n</code></pre>\n\n<p>I don't know if it's worth mentioning but it is for an Arduino project :-)\nI hope someone can help me, or kick me in the butt and tell me that it is not feasible!</p>\n"}, {"tags": ["c", "string", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1555494358, "creation_date": 1555494358, "answer_id": 55724665, "question_id": 55724619, "link": "https://stackoverflow.com/questions/55724619/why-different-string-pointers-to-the-same-content-have-the-same-adders-in-c/55724665#55724665", "title": "why different string pointers to the same content have the same adders in c?", "body": "<p>It's your compiler optimization in effect.</p>\n\n<p>Your compiler decided to allocate memory for only one string literal, <code>\"hello\"</code>, and make both <code>str1</code> and <code>str2</code> to point to that memory. Given the nature of string literals (i.e., no modifications are expected), this usage would be sufficient. </p>\n\n<p>However, if you try to print the address of <code>str1</code> and <code>str2</code>, you would see they are different.</p>\n\n<p>On the other hand, <code>str3</code>, is, however, an array, initialized with the content from the string literal <code>\"hello\"</code>, that's why it is stored in a separate location in memory. </p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1555498435, "post_id": 55724668, "comment_id": 98130547, "body": "Does the compiler build some sort of binary search tree in case a program hosts many different sting literals to compare and decide to allocate or not?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1555500864, "post_id": 55724668, "comment_id": 98131945, "body": "@machine_1 I guess there&#39;s a lot of potential for optimization here, but the standard doesn&#39;t require anything like that to be done. There&#39;s not even a guarantee that two equal string literals will only result in one copy of it in the program. On my machine, when I have two <code>&quot;hello&quot;</code> they will return the same address, but if I have <code>&quot;ello&quot;</code> it is stored separately, even though it is in the <code>&quot;Hello&quot;</code> string. It&#39;s entirely up to the implementation. There&#39;s a good question that goes into detail on this here: <a href=\"https://stackoverflow.com/q/52423837/10411602\">stackoverflow.com/q/52423837/10411602</a>"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555503241, "post_id": 55724668, "comment_id": 98133340, "body": "@EricPostpischil good point. I edited the answer to reflect how it&#39;s not necessarily read-only, just shouldn&#39;t be modified."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1555503195, "last_edit_date": 1555503195, "creation_date": 1555494369, "answer_id": 55724668, "question_id": 55724619, "link": "https://stackoverflow.com/questions/55724619/why-different-string-pointers-to-the-same-content-have-the-same-adders-in-c/55724668#55724668", "title": "why different string pointers to the same content have the same adders in c?", "body": "<p>When you have a string literal, the actual string is stored in a location that is possibly read-only and for that reason shouldn't be modified. The <code>char*</code> you get points to that place. So when you have the exact same literal multiple times, it doesn't need multiple copies of the same string and it can just make them point to the same actual string. However, this is not guaranteed to happen, it's up to the compiler.</p>\n\n<p>When you do this on the other hand:</p>\n\n<pre><code>char str3[8] = \"hello\";\n</code></pre>\n\n<p>You get a copy of the string on the stack, so that's why its address is different.</p>\n"}], "owner": {"reputation": 11, "user_id": 11367367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e35f31cfb6a279f15e9539f4c5c3cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Hillel Horgen", "link": "https://stackoverflow.com/users/11367367/hillel-horgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1555494383, "answer_count": 2, "score": 1, "last_activity_date": 1555503195, "creation_date": 1555494217, "last_edit_date": 1555494481, "question_id": 55724619, "link": "https://stackoverflow.com/questions/55724619/why-different-string-pointers-to-the-same-content-have-the-same-adders-in-c", "closed_reason": "Duplicate", "title": "why different string pointers to the same content have the same adders in c?", "body": "<p>I assign two different pointers with the same content(not value!) to strings and when I print they address I saw they have the same adders and the none pointer string has different adders, can someone explain why is it happening?\nSomeone told me it had something to do with string literals, but I don't sure.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char* str1 = \"hello\";\nchar* str2 = \"hello\";\nchar str3[8] = \"hello\";\n\nprintf(\"%p %p %p\", str1, str2, str3);\n</code></pre>\n\n<h2>output:</h2>\n\n<pre class=\"lang-c prettyprint-override\"><code>0x01077B30\n0x01077B30\n0x0107F6E8\n</code></pre>\n"}, {"tags": ["c", "eclipse"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555495972, "post_id": 55724556, "comment_id": 98129114, "body": "That does not exist. You can use <code>printf</code> to print their values."}, {"owner": {"reputation": 9, "user_id": 7263509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bac15aaa2b4a1e57121c62b75819bce?s=128&d=identicon&r=PG&f=1", "display_name": "Fakhfekh Ziad", "link": "https://stackoverflow.com/users/7263509/fakhfekh-ziad"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555504592, "post_id": 55724556, "comment_id": 98134198, "body": "no, I must not touch the function, I need an automatic way"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1555505459, "post_id": 55724556, "comment_id": 98134764, "body": "You want to modify your program or create another program which will control the first program execution?"}, {"owner": {"reputation": 9, "user_id": 7263509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bac15aaa2b4a1e57121c62b75819bce?s=128&d=identicon&r=PG&f=1", "display_name": "Fakhfekh Ziad", "link": "https://stackoverflow.com/users/7263509/fakhfekh-ziad"}, "edited": false, "score": 0, "creation_date": 1555579498, "post_id": 55724556, "comment_id": 98162855, "body": "I want another program that retrieves the value of input variables and global variabe, automatic, that means it detects by itself the global variable and the variables entered in the functions and displays it, and that works for any program"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555613535, "post_id": 55724556, "comment_id": 98180854, "body": "in the function(s) that call the target functions,  Capture the variable values before making the actual call.  Otherwise, all knowledge about the variable values is &#39;lost&#39;"}], "owner": {"reputation": 9, "user_id": 7263509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bac15aaa2b4a1e57121c62b75819bce?s=128&d=identicon&r=PG&f=1", "display_name": "Fakhfekh Ziad", "link": "https://stackoverflow.com/users/7263509/fakhfekh-ziad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555494042, "creation_date": 1555494042, "question_id": 55724556, "link": "https://stackoverflow.com/questions/55724556/how-to-retrieve-input-parameter-values-from-a-c-language-function", "title": "How to retrieve input parameter values from a C language function", "body": "<p>I have a program contains 2 function;</p>\n\n<pre><code>  int computation (int a, int b) \n\n {\n\n ..\n\n..\n\n ..\n\n }\n\n void computation2 (int v, int k, int c) \n\n{\n\n..\n\n..\n\n}\n</code></pre>\n\n<p>I need to create a function that automatically retrieves the value of input variables for each function after it has been executed.\nand show something like this:</p>\n\n<ul>\n<li>a = 52     -b = 4      -v = 41     -k = 53      -c = 12</li>\n</ul>\n\n<p>-I need an automatic way that gets the values of the inputs of any function. if it exists</p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 1, "creation_date": 1555493627, "post_id": 55724355, "comment_id": 98127676, "body": "Did you try it?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1555493778, "post_id": 55724355, "comment_id": 98127748, "body": "1. show us your code (an example) if you want help to improve it; 2. enums are basically a comfortable way to name numeric values.  You won&#39;t get a runtime error when casting an integer to an enum (though you might loose data if the enum data uses less bits than the integer type)..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 1, "creation_date": 1555502974, "post_id": 55724355, "comment_id": 98133179, "body": "@user7176709: The question asks whether there is a better method. How does one try \u201cIs there a better method?\u201d?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1555503000, "post_id": 55724355, "comment_id": 98133195, "body": "@Myst: This is not a \u201cWhat is wrong with this code?\u201d question, so there is no need to supply sample code for it."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1555504388, "post_id": 55724355, "comment_id": 98134054, "body": "@EricPostpischil , the question asks for a better method - but without seeing the code, how can we tell? Is OP using a switch statement, if statements or a map (array)... true, example code isn\u2019t required - but it would help."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1555507138, "post_id": 55724355, "comment_id": 98135894, "body": "@Myst: The question describes two methods: Manually checking each member of the enumeration and using a cast. Those suffice to frame the question."}], "answers": [{"comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1555494316, "post_id": 55724513, "comment_id": 98128083, "body": "Is it specifically an <code>int</code> type? I recall it can be a smaller or larger integer type depending on the defined enums values?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1555494354, "post_id": 55724513, "comment_id": 98128108, "body": "@FireLancer: That&#39;s the C++ rule, not the C one (although I&#39;m starting to doubt)."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1555494415, "post_id": 55724513, "comment_id": 98128164, "body": "@FireLancer: I think you might be correct. I&#39;ll amend this answer."}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "edited": false, "score": 0, "creation_date": 1555497409, "post_id": 55724513, "comment_id": 98129947, "body": "In my case the enum values are not necessarily continuous."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "edited": false, "score": 0, "creation_date": 1555497442, "post_id": 55724513, "comment_id": 98129966, "body": "@TylerDurden: Well you need to settle down to a fair bit of typing then."}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "edited": false, "score": 0, "creation_date": 1555497544, "post_id": 55724513, "comment_id": 98130041, "body": "So, from your code I gather that foo x = (foo)88 will not generate a runtime error, even though 88 is not a valid value."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "edited": false, "score": 0, "creation_date": 1555497894, "post_id": 55724513, "comment_id": 98130248, "body": "@TylerDurden: What I&#39;m trying to say is that 88 <b>is</b> a valid value, as far as the enumerator is concerned."}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "edited": false, "score": 0, "creation_date": 1555499252, "post_id": 55724513, "comment_id": 98130969, "body": "For my purposes, a &quot;valid&quot; value is one which is found in the enum. So if I have enum values 1, 2, 5 and 7, then only an integer having one of those values is part of the set of values in the enum and is valid."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1555494456, "last_edit_date": 1555494456, "creation_date": 1555493942, "answer_id": 55724513, "question_id": 55724355, "link": "https://stackoverflow.com/questions/55724355/how-do-i-validate-an-enum-value-read-from-a-file/55724513#55724513", "title": "How do I validate an enum value read from a file?", "body": "<p>In C, all <code>enum</code>s are actually integral types.</p>\n\n<p>So <em>any</em> value of that integral type is a valid value for your <code>enum</code>.</p>\n\n<p>If you are careful and set up the <code>enum</code> labels so they are consecutive (the default is consecutive from 0), it's a simple case of checking if the value from the file is in that range. Otherwise, yes, it's tedious.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1555494472, "post_id": 55724517, "comment_id": 98128202, "body": "Upvoted as this has always been correct, and it&#39;s a nice way of doing this."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1555494941, "post_id": 55724517, "comment_id": 98128519, "body": "This isn&#39;t really major issue in this answer, but I would rather use <code>foo_end</code> or <code>foo_count</code> instead of <code>foo_max</code>. Maximum is typically <i>inclusive</i> boundary, and in this case it&#39;s used as <i>exclusive</i> boundary."}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 4, "last_activity_date": 1555494680, "last_edit_date": 1555494680, "creation_date": 1555493958, "answer_id": 55724517, "question_id": 55724355, "link": "https://stackoverflow.com/questions/55724355/how-do-i-validate-an-enum-value-read-from-a-file/55724517#55724517", "title": "How do I validate an enum value read from a file?", "body": "<p><code>enum</code> in C works like an integer, and so it can be forced to any value by any kind of read function taking a pointer, or directly casting it from integer types.</p>\n\n<p>If the enum has only sequential values, some programs have a <code>max</code> enum value for their  enum. These can either have explicit values, or have the implicit values which will always start from <code>0</code> and go up sequentially. This way they can just check the value is in the allowed range (0 to <code>max - 1</code>), rather than checking it for every allowed value.</p>\n\n<pre><code>typedef enum foo { \n    foo_a,\n    foo_b,\n    foo_c,\n    foo_max //last\n} foo;\nint main(void)\n{\n    foo x = (foo)88; // from somewhere\n    if (x &gt;= 0 &amp;&amp; x &lt; foo_max)\n        printf(\"valid\\n\");\n    else printf(\"invalid\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1555497457, "creation_date": 1555493477, "last_edit_date": 1555497457, "question_id": 55724355, "link": "https://stackoverflow.com/questions/55724355/how-do-i-validate-an-enum-value-read-from-a-file", "title": "How do I validate an enum value read from a file?", "body": "<p>If I am reading binary values from a file in C, then an integer that is supposed to be a member of an enum can be checked manually by looping through the enum itself and verifying that the integer is one of those values, but this seems like a somewhat tedious process. If I just cast the read value to the enum, then I assume some kind of runtime error will occur if the value is invalid.</p>\n\n<p>Is there a better method of validating the enum than doing a manual check loop?</p>\n\n<p>Note that in my case, the enum(s) in question do not necessarily have consecutive values, so min/max checking is not a solution.</p>\n"}, {"tags": ["c", "linux", "dns", "nameservers"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555497902, "post_id": 55724014, "comment_id": 98130253, "body": "For Systemd-based systems see <a href=\"https://github.com/systemd/systemd/blob/master/src/hostname/hostnamectl.c\" rel=\"nofollow noreferrer\"><code>hostnamectl.c</code></a>. I believe systemd has an API, but I am not sure if hostname is exposed."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1555522153, "post_id": 55724014, "comment_id": 98144659, "body": "<code>struct sockaddr_in</code> is not the same as <code>struct in_addr</code>."}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555534063, "post_id": 55724014, "comment_id": 98149683, "body": "@stark absolutely correct, thanks, I corrected the code - but I still have the same problem"}], "owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1555565875, "creation_date": 1555492484, "last_edit_date": 1555565875, "question_id": 55724014, "link": "https://stackoverflow.com/questions/55724014/set-dns-nameserver-programatically-and-permanently-on-linux", "title": "Set DNS / Nameserver programatically and permanently on Linux", "body": "<p>I want to update the nameserver programmatically. \nIn this question <a href=\"https://stackoverflow.com/questions/5034143/programmatically-set-dns-nameserver-on-linux\">programmatically-set-dns-nameserver-on-linux</a> was mentioned to manipulate <code>_res.nsaddr_list</code> -- so I did.</p>\n\n<pre><code>void setNameServer(const std::string&amp; rstr_addr)\n{\n  struct sockaddr_in x_addr;\n  inet_pton(AF_INET,rstr_addr.c_str(),&amp;x_addr.sin_addr);\n  res_init();\n  _res.nsaddr_list[0] = x_addr;\n}\n</code></pre>\n\n<p><strong>This is not working.</strong> <code>getaddrinfo</code> is now returning with error: \"Name or service not known\"</p>\n\n<p>So there a basically two questions: </p>\n\n<ol>\n<li><p>What is the correct way to set the nameserver ip programmatically</p></li>\n<li><p>How to set it permanently in a proper way (ATM I just write it to <code>/etc/resolv.conf</code> by myself)</p></li>\n</ol>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 3, "creation_date": 1555492009, "post_id": 55723820, "comment_id": 98126746, "body": "You do not increase <code>count</code>"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1555492054, "post_id": 55723820, "comment_id": 98126773, "body": "You should also add in a check to never get to <code>count &gt;= 50</code>. Also why do you store the chars as ints?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555492132, "post_id": 55723820, "comment_id": 98126821, "body": "Why set <code>count</code> to zero inside the loop? It will now just set <code>safe[0]</code> to i. You must increment it: <code>safe[count++]= i;</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1555492277, "post_id": 55723820, "comment_id": 98126894, "body": "In addition to breaking out if <code>count</code> reaches 50, you should also break out when <code>i</code> equals <code>EOF</code>. Also, <code>safe[]</code> can use type <code>char</code> instead of <code>int</code> to save space."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1555492258, "creation_date": 1555492258, "answer_id": 55723939, "question_id": 55723820, "link": "https://stackoverflow.com/questions/55723820/save-whole-input-in-integer-array-read-with-getchar/55723939#55723939", "title": "Save whole input in integer array (read with getchar)", "body": "<p>See the comments as to the why, but the following is correct:</p>\n\n<pre><code>int main() {\n    count= 0;\n    while (count&lt;49) {\n        i = getchar();\n        if (i == '/')\n            break;\n        safe[count++] = i;\n    }\n    safe[count]= '\\0';\n }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11372705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FlO-qEEKW4o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceIIT4TfP13SLLEkO7FyEHHGdvxw/mo/photo.jpg?sz=128", "display_name": "fox", "link": "https://stackoverflow.com/users/11372705/fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555493546, "creation_date": 1555491889, "question_id": 55723820, "link": "https://stackoverflow.com/questions/55723820/save-whole-input-in-integer-array-read-with-getchar", "title": "Save whole input in integer array (read with getchar)", "body": "<p>I'm only allowed to use the stdio.h library. So I want to read the user input with getchar until the first \"/\" and then want to save the read input in an integer array. Checking the input out of the while-loop, i recognized that only the last string is safed. </p>\n\n<p>For example I type in \"test/hello\", I want to safe \"test\" in the integer array called \"safe\" so that I can work with it  out of the while-loop too.</p>\n\n<p>I have checked the input out of the while-loop with \"putchar(safe[count]);\" but the only safed input is the letter \"t\". (Based on the example above)</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int count;\n    char i;\n    int safe[50];\n\n    int main() {\n        while (1) {\n            i = getchar();\n            count = 0;\n            if (i == '/')\n                break;\n            safe[count] = i;\n        }\n        // putchar(safe[count]);\n     }\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "arduino", "function-pointers"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 1, "creation_date": 1555491191, "post_id": 55723559, "comment_id": 98126293, "body": "Where is this logic <code>cthis + i</code> (where <code>i</code> &gt; 0) supposed to point to when you pass <code>&amp;txobj</code>?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1555491803, "post_id": 55723559, "comment_id": 98126627, "body": "If you want to try pointer arithmetic you could do <code>uint8_t dataptr = cthis-&gt;tx; for (int i = 0; i &lt; 8; i++) { *(dataptr++) = arr[i]; }</code>. BTW: I suggest to replace the magic number <code>8</code>with a <code>#define</code> or <code>enum</code> value in <code>txstruct_t</code> and use <code>sizeof(cthis-&gt;tx)</code> to limit the loop in your <code>send</code> function."}, {"owner": {"reputation": 147, "user_id": 11270701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d670e7ef47dad15901cfb607b47bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenp", "link": "https://stackoverflow.com/users/11270701/sorenp"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555492476, "post_id": 55723559, "comment_id": 98127005, "body": "Yes thank you @Bodo of course. This was merely a quick and dirty test :) But you are absolutely right!"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 11270701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d670e7ef47dad15901cfb607b47bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenp", "link": "https://stackoverflow.com/users/11270701/sorenp"}, "edited": false, "score": 1, "creation_date": 1555491977, "post_id": 55723591, "comment_id": 98126726, "body": "I added the cthis = cthis + i; in a desperate attempt of foolishness. since it didn&#39;t work as intended.  It works now .. Don&#39;t know what I did .. Classic.."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1555491186, "creation_date": 1555491186, "answer_id": 55723591, "question_id": 55723559, "link": "https://stackoverflow.com/questions/55723559/for-looping-struct-members-with-a-pointer-to-a-struct/55723591#55723591", "title": "For looping struct members with a pointer to a struct", "body": "<p><code>cthis = cthis + i;</code> can be removed. It makes no sense at all as it's an undefined attempt to somehow reset the pointer to the <code>struct</code>. You don't do that in the <em>unrolled</em> version of the loop, do you?</p>\n\n<p>The other components of the loop are fine.</p>\n"}], "owner": {"reputation": 147, "user_id": 11270701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d670e7ef47dad15901cfb607b47bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenp", "link": "https://stackoverflow.com/users/11270701/sorenp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55723591, "answer_count": 1, "score": 2, "last_activity_date": 1555491186, "creation_date": 1555491058, "question_id": 55723559, "link": "https://stackoverflow.com/questions/55723559/for-looping-struct-members-with-a-pointer-to-a-struct", "title": "For looping struct members with a pointer to a struct", "body": "<p>I think my pointer game is rusty, I can't seem to get the for loop implementation to work. It's like the pointer isn't incremented along with the array. \nAny suggestions?</p>\n\n<p>I implemented a \"manual\" version of what i want the loop to do. It worked as expected.</p>\n\n<pre><code>typedef struct txstruct_t\n{\n    uint8_t tx[8];\n    void(*send)(struct txstruct_t *cthis, uint8_t arr[8]);\n\n}txstruct_t;\n\nvoid send(txstruct_t *cthis, uint8_t arr[8]);\n\n\nvoid loop() \n{\n    txstruct_t txobj;\n    uint8_t buf[8] = { 1, 0, 1, 0, 1, 0, 1, 0 };\n    send(&amp;txobj, buf);\n\n}\n\n// This works\nvoid send(txstruct_t *cthis, uint8_t arr[8])\n{\n    cthis-&gt;tx[0] = arr[0];\n    cthis-&gt;tx[1] = arr[1];\n    cthis-&gt;tx[2] = arr[2];\n    cthis-&gt;tx[3] = arr[3];\n    cthis-&gt;tx[4] = arr[4];\n    cthis-&gt;tx[5] = arr[5];\n    cthis-&gt;tx[6] = arr[6];\n    cthis-&gt;tx[7] = arr[7];\n\n    return;\n};\n\n/*\n//This doesn't work :(\nvoid send(txstruct_t *cthis, uint8_t arr[8])\n{\n\n    for (int i = 0; i &lt; 8; i++)\n    {\n        cthis = cthis + i;\n        cthis-&gt;tx[i] = arr[i];\n    }\n\n    return;\n};*/\n\n</code></pre>\n\n<p>I would love some clarification on this, so I could learn how to avoid this in the future! Maybe even a better method of implementing such buffers.</p>\n"}, {"tags": ["c", "multithreading", "concurrency", "stdatomic"], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1555510094, "post_id": 55724629, "comment_id": 98137876, "body": "I did not notice the <code>7.17.3(p12)</code>: <i>Atomic read-modify-write operations shall always read the last value (in the modification order) stored before the write associated with the read-modify-write operation.</i>. So it seems I may well specify even <code>memory_order_relaxed</code> and it would not cause data race, correct?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1555518239, "post_id": 55724629, "comment_id": 98142851, "body": "Correct. The memory ordering specifies how this atomic operation interacts with other operations, as the various memory orderings explain in their descriptive texts."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 4, "last_activity_date": 1555494249, "creation_date": 1555494249, "answer_id": 55724629, "question_id": 55723397, "link": "https://stackoverflow.com/questions/55723397/memory-order-introduced-by-atomic-exchange-explicit-atomic-exchange/55724629#55724629", "title": "Memory order introduced by atomic_exchange_explicit/atomic_exchange", "body": "<p>You are incorrect. Regardless of the memory ordering requested, the exchange is atomic. Memory ordering explains how this read, write, or read-modify-write operation interacts with other operations, but the operation is <em>always</em> atomic.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55724629, "answer_count": 1, "score": 1, "last_activity_date": 1555494249, "creation_date": 1555490509, "last_edit_date": 1555493421, "question_id": 55723397, "link": "https://stackoverflow.com/questions/55723397/memory-order-introduced-by-atomic-exchange-explicit-atomic-exchange", "title": "Memory order introduced by atomic_exchange_explicit/atomic_exchange", "body": "<p>I'm trying to understand memory ordering intoduced by <code>atomic_exchange[_explicit]</code> and wrote the following code:</p>\n\n<pre><code>static _Atomic int i = 123;\n\nvoid *update(void *ignored){\n    if(atomic_exchange_explicit(&amp;i, 200, memory_order_release) != 200){ //1\n        printf(\"Updated\\n\", stdout);\n    } \n}\n\nint main(int args, const char *argv[]){\n    pthread_t t1;\n    pthread_create(&amp;t1, NULL, &amp;update, NULL);\n\n    pthread_t t2;\n    pthread_create(&amp;t2, NULL, &amp;update, NULL);\n\n    sleep(1000);\n}\n</code></pre>\n\n<p><em>Question</em>: Is it possible the <code>Updated\\n</code> will be printed twice (by both of the threads)? </p>\n\n<p>I think <em>the behavior is undefined</em>. The UB is held even if we replace <code>memory_order_release</code> with <code>memory_order_acquire</code> at <code>//1</code>. The generated code is the same for acq/rel/acq_rel: <a href=\"https://godbolt.org/z/sFjcve\" rel=\"nofollow noreferrer\">https://godbolt.org/z/sFjcve</a> .</p>\n\n<p>This is because we have data race since for synchronize with relation to be held we need one operation is an <code>acquire</code> operation and the next operation is a <code>release</code> operation and the release operation reads a value written by a side effect from a release sequence of the acquire operation <code>5.1.2.4(p11)</code>:</p>\n\n<blockquote>\n  <p>In particular, an atomic operation A that performs a release operation\n  on an object M synchronizes with an atomic operation B that performs\n  an acquire operation on M and reads a value written by any side effect\n  in the release sequence headed by A.</p>\n</blockquote>\n\n<p>So the only way to make this code's behavior well-defined is to replace <code>atomic_exchange_explicit(&amp;i, 200, memory_order_release) != 200</code> with <code>atomic_exchange(&amp;i, 200) != 200</code></p>\n"}, {"tags": ["c", "assembly", "arm", "gdb", "qemu"], "answers": [{"comments": [{"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1555598985, "post_id": 55748372, "comment_id": 98173953, "body": "Note: I haven&#39;t actually used overlays for this issue, but have used the other two.  My memory recall might not be perfect though.  Feel free to edit if you see obvious mistakes."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1555605854, "post_id": 55748372, "comment_id": 98177568, "body": "Another tact you can take is to use the linker and <code>AT</code> directive to set the non-MMU code address.  The load address will be the MMU variant.  So the binary is contiguous.  The loader needs to put every thing at the physical location.  This would require known/consistent MMU/non-MMU addresses for loaders and your &#39;application&#39; build.  I suspect PIC by itself won&#39;t solve your issues.  Data is more difficult to handle and the ancillary library routines that may be inadvertently used."}], "tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": false, "score": 1, "last_activity_date": 1555603869, "last_edit_date": 1555603869, "creation_date": 1555598296, "answer_id": 55748372, "question_id": 55722837, "link": "https://stackoverflow.com/questions/55722837/debugging-early-kernel-startup-code-in-qemu/55748372#55748372", "title": "Debugging early kernel startup code in QEMU", "body": "<p>I don't think your issue is particular to QEMU (or even ARM). I believe there are at least three ways to handle this,</p>\n\n<ol>\n<li>Just use assembler</li>\n<li>Use <code>symbol-file</code></li>\n<li>Overlays</li>\n</ol>\n\n<h2>Assembler</h2>\n\n<p>I had this problem, but would just switch to examine assembler. It is fairly easy especially if you <code>objdump -S</code> the MMU/normal address version to match the assembler.  You can pipe the objdump output to a file and remove non-relocated code if you want.  However, most editors will be able to handle the large file.</p>\n\n<p>Looking at the assembler may be very helpful as often some sort of relocation constant or non-PIC type reference is not correct.  You need both code/data to be correct and your PIC code may call some gcc library routine linked some place you didn't account for.  So although this is primitive, it does have some advantages.</p>\n\n<h2>Symbol-file</h2>\n\n<p>Another way is to use what you have with <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/GDB_002fMI-File-Commands.html#index-_002dfile_002dsymbol_002dfile\" rel=\"nofollow noreferrer\"><code>symbol-file</code></a>. Use the physical link with <code>symbol-file</code> during boot and then <code>symbol-file</code> of the MMU/normal link after the MMU switch. Obviously load the MMU version. </p>\n\n<h2>Overlays</h2>\n\n<p>I think you could handle this with <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/Automatic-Overlay-Debugging.html#Automatic-Overlay-Debugging\" rel=\"nofollow noreferrer\">overlays</a> although you are actually doing an inverse. VMA is the MMU address and LMA is the physical boot address. Mark it as mapped initially and then you can update with <code>_ovly_debug_event()</code> when you turn on the MMU. </p>\n\n<p>The overlays take code, but it is the most convenient. I would attempt that if you already have a 'debug' build targets in your software development system and conditionalized that code.  However if you use actual overlays in <code>ld</code>, it may actually solve some of your issues and you might find this the most robust.  The overlay resource impact is pretty minimal, but it exists.</p>\n\n<hr>\n\n<h2>Reference</h2>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/15137214/how-to-run-code-from-ram-on-arm-architecture\">How to run code from RAM on ARM</a> - similar issues to MMU/non-MMU.</li>\n<li><a href=\"https://stackoverflow.com/questions/15671717/relocation-in-assembly\">Relocation in ARM assembler</a> - code for getting an offset (to adjust pointers).</li>\n</ul>\n\n<p>The references are coding issue as to why you might want to debug this.</p>\n"}], "owner": {"reputation": 51, "user_id": 11372547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02678224f009b24d7293dd94f1b90d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/11372547/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1555603869, "creation_date": 1555488588, "question_id": 55722837, "link": "https://stackoverflow.com/questions/55722837/debugging-early-kernel-startup-code-in-qemu", "title": "Debugging early kernel startup code in QEMU", "body": "<p>I have some code (a mix of assembly and C) compiled into an ELF binary, that some firmware/bootloader code in QEMU loads at a particular physical address. The ELF is linked using virtual addresses; however, the code is meant to be run with the MMU turned off, which means that it needs to be position-independent.</p>\n\n<p>The problem is that the PC is set to the entry point's physical address, which makes sense, but since all symbols are referenced using virtual addresses, GDB does not know where the entry point is.</p>\n\n<p>I can still set a breakpoint on a function that will be called when the MMU is turned on (and hence the PC will be dealing with virtual addresses at that point), but this is not good enough to debug early code, including single-stepping it.</p>\n\n<p>I've been able to debug this code by linking it using physical addresses, but clearly this will create problems as soon as I turn on the MMU.</p>\n\n<p>Does anyone know what I'm missing here?</p>\n"}, {"tags": ["c", "struct", "strcpy"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1555488121, "post_id": 55722681, "comment_id": 98124594, "body": "<code>input_node-&gt;name = input_name;</code> should be fine, given that the <code>input_name</code> does not change later on."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1555488161, "post_id": 55722681, "comment_id": 98124616, "body": "That depends on the semantics you want: Does the <code>struct</code> have to <i>own</i> the referenced string, and how does it have to be allocated?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555488184, "post_id": 55722681, "comment_id": 98124633, "body": "If you have a pointer, you need to make it point somewhere valid before using <code>strcpy</code>. As for which to use, that really depends. Will you <i>always</i> be using string literals? Do you need to modify the strings? Append to them?"}, {"owner": {"reputation": 129, "user_id": 10993171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a852550457e6d60b6b54751c3a1e3752?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSoul", "link": "https://stackoverflow.com/users/10993171/digitalsoul"}, "edited": false, "score": 0, "creation_date": 1555488693, "post_id": 55722681, "comment_id": 98124888, "body": "No, I don&#39;t need to modify the string, the &quot;string&quot; that I will be using is read from a file, so does this indicate that I should use direct assignment instead of strcpy family functions?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1555488725, "post_id": 55722681, "comment_id": 98124905, "body": "&quot;string&quot;  will be same for all the nodes?"}, {"owner": {"reputation": 129, "user_id": 10993171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a852550457e6d60b6b54751c3a1e3752?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSoul", "link": "https://stackoverflow.com/users/10993171/digitalsoul"}, "edited": false, "score": 0, "creation_date": 1555488973, "post_id": 55722681, "comment_id": 98125048, "body": "No, the reason why I use double quotes to include string is that I don&#39;t know whether I should use string or string literal to describe this &quot;string&quot;. The actual string / string literal is per line that is in my file, but that is not part of this question anyway."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555491245, "post_id": 55722681, "comment_id": 98126315, "body": "If you read a string from a file you can&#39;t just do assignments, as the assignments will just make all pointers point to the very same buffer (the buffer you read). You need to allocate memory for each string. Either dynamically, or turn your pointers into arrays."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1555497044, "post_id": 55723074, "comment_id": 98129734, "body": "you do <code>malloc()</code>, you gotta <code>free()</code>."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 3, "last_activity_date": 1555497004, "last_edit_date": 1555497004, "creation_date": 1555489423, "answer_id": 55723074, "question_id": 55722681, "link": "https://stackoverflow.com/questions/55722681/string-vs-string-literal-direct-assignment-or-strcpy-strncpy/55723074#55723074", "title": "String vs String Literal: Direct assignment or strcpy/strncpy?", "body": "<p>In case of pointer assignment, pointers in each node will point to same location. Thus nodes will be always pointing to updated value. If you are intended to make each node to contain different <code>input</code> then this approach does not suit your requirement.</p>\n\n<pre><code>input_node-&gt;name = input_name;\n</code></pre>\n\n<p>In case of <code>strcpy</code>, pointers in each node will point to different location. Before to that you need to create memory for each pointer.</p>\n\n<pre><code>input_node-&gt;name = malloc(strlen(input_name)+1); //Allocate memory first.\nstrcpy(input_node-&gt;name, input_name);// Suppose it's safe in this case.\n</code></pre>\n\n<p><strong>To visualize:</strong>\n<a href=\"https://i.stack.imgur.com/nAOkv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nAOkv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 3, "last_activity_date": 1555489434, "creation_date": 1555489434, "answer_id": 55723077, "question_id": 55722681, "link": "https://stackoverflow.com/questions/55722681/string-vs-string-literal-direct-assignment-or-strcpy-strncpy/55723077#55723077", "title": "String vs String Literal: Direct assignment or strcpy/strncpy?", "body": "<blockquote>\n  <p>... when passing to a function, <code>const char *</code> indicates this is a string literal, while <code>char *</code> indicates a string.</p>\n</blockquote>\n\n<p>Not exactly. <code>const char *</code> declares that the function will not try to modify the string. So it is perfectly suited for string litteral because they cannot be modified.</p>\n\n<p>For your question, the answer is <em>it depends on your real requirements</em>. But simply storing the passed pointer if dangerous if the struct can persist after the function and if the string can be changed in the caller. Let us look at the following code:</p>\n\n<pre><code>void load_buffer(struct node *input_node, const char *input_name) {\n    input_node-&gt;name = name;\n}\n\nstruct node nodes[2];\nchar buf[4];\nconst char *data[] = { \"foo\", \"bar\"};\nfor (int i=0; i&lt;2; i++) {\n    strcpy(buf, data[i]);    // suppose it is read from somewhere (file, stdin, socket)\n    load_buffer(node + i, buf);\n}\n</code></pre>\n\n<p>Both <code>node</code> objects will have their <code>name</code> member pointing to the string <code>buf</code> from caller and will both point to <code>\"bar\"</code> (the content of <code>buf</code> at the end of the loop)!</p>\n\n<p>If you want to keep the value of the string at call time, you should copy it in allocated memory:</p>\n\n<pre><code>void load_buffer(struct node *input_node, const char *input_name) {\n    input_node-&gt;name = strdup(name);  // allocation errors should be tested...\n}\n</code></pre>\n\n<p>But you should then free the <code>name</code> member, when the node is no longer in use...</p>\n"}, {"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1555491488, "creation_date": 1555491488, "answer_id": 55723683, "question_id": 55722681, "link": "https://stackoverflow.com/questions/55722681/string-vs-string-literal-direct-assignment-or-strcpy-strncpy/55723683#55723683", "title": "String vs String Literal: Direct assignment or strcpy/strncpy?", "body": "<p>First to address some terminology:</p>\n\n<ul>\n<li>this is a string literal: <code>\"I am a string literal\"</code></li>\n<li>this is a type: <code>char*</code> (aka pointer to char)</li>\n<li>this is also a type: <code>const char*</code> (aka pointer to constant char)</li>\n<li>this is the declaration of a variable of type <code>char*</code>: <code>char* str</code></li>\n<li>this is the declaration of a variable of type <code>const char*</code>: <code>const char* cstr</code></li>\n</ul>\n\n<p>A pointer is not a string literal. A pointer can point to string literal, an array, just to a single element or can be null.</p>\n\n<p>In <code>C</code> a string is a null-terminated char array.</p>\n\n<p>In <code>C</code> you can assign a <code>char*</code> variable to a string literal, but modifying the string literal is illegal, so it is strongly advised to never do that. The reason why this is allowed are historical.</p>\n\n<pre><code>char* a = \"asd\"; // allowed, but frowned upon\n// a points to a string literal, so we can say a is a string\n// a is not a string literal\n\nchar b = 'x';\nchar* c = &amp;b;\n// c points to a single char\n// we cannot say c is a string\n\nchar d[10] = \"asd\";\n// d is a char array. Its content is a string, so we can say d is a string.\n// d is not a string literal\n// the string literal is copied into the array d\n\nchar* e = d; // or equivalent char* e = &amp;d[0];\n// e points to a string\n\nchar f[4] = {'a', 's', 'd', '\\0'};\n// f is an array. Its content is a string, so we can say f is a string\n\nchar* g = f;\n// g points to a string. We can say g is a string\n\nchar h[3] = {'a', 's', 'd'};\n// h is an array. Its content is NOT a string, because the char array is not null terminated\n\nchar* i = h;\n// i is not a string\n</code></pre>\n\n<p>And now go through all the above once more, but not replace <code>char</code> with <code>const char</code> and all the comments still stand (except that `const char* a = \"asd\" is now ok).</p>\n\n<hr>\n\n<p>And now to the problem at hand.</p>\n\n<p>There are two scenarios:</p>\n\n<ol>\n<li><p>Each node has its own string and \"owns\" that string. Each node is responsible for allocating memory for the string and freeing that memory. The string lives as long as the node lives. In this case use <code>malloc</code> and <code>strcpy</code> to create a string for each node. Don't forget to <code>free</code> the string when the node is destroyed. This is the most common scenario and probably what you want.</p></li>\n<li><p>A node doesn't own its own string, but rather points to an external string. It is not allowed to neither allocate nor free memory for that string. There is another entity responsible for managing the lifetime of that string and making sure the string is alive at least as the node is alive. The string can outlive the node without a memory leak.</p></li>\n</ol>\n\n<p>For example consider this scenario:</p>\n\n<ul>\n<li>there is a list R of string resources. This list owns those resources. This list would use scenario 1</li>\n<li>we need to keep two different sort orders of R. So we have two lists A and B that would use scenario 2: each node in A and B just points to a string of R.</li>\n</ul>\n"}], "owner": {"reputation": 129, "user_id": 10993171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a852550457e6d60b6b54751c3a1e3752?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSoul", "link": "https://stackoverflow.com/users/10993171/digitalsoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 55723074, "answer_count": 3, "score": 2, "last_activity_date": 1555497004, "creation_date": 1555487959, "question_id": 55722681, "link": "https://stackoverflow.com/questions/55722681/string-vs-string-literal-direct-assignment-or-strcpy-strncpy", "title": "String vs String Literal: Direct assignment or strcpy/strncpy?", "body": "<p>I think I have some issue understanding string and string literal.</p>\n\n<p>This is what I learned from my class, when passing to a function, const char * indicates this is a string literal, while char * indicates a string.</p>\n\n<p>Suppose I have a struct declaration:</p>\n\n<pre><code>struct node{\n    char *name;\n    struct node *next;\n};\n</code></pre>\n\n<p>and a function, this is the function I want to implement:</p>\n\n<pre><code>void load_buffer(struct node *input_node, char *input_name);\n</code></pre>\n\n<p>This function is supposed to assign input_name to the struct's member name.</p>\n\n<p>My confusion comes from here. Within the body of load_buffer, should I write:</p>\n\n<pre><code>input_node-&gt;name = input_name;\n</code></pre>\n\n<p>Or I should use strcpy/strncpy to do this?</p>\n\n<pre><code>strcpy(input_node-&gt;name, input_name);// Suppose it's safe in this case.\n</code></pre>\n\n<p>To summarize, I am not sure if I should use direct assignment or strcpy family functions to assign a string/string literal to the member of my struct.</p>\n\n<p>Thanks for help. :)</p>\n"}, {"tags": ["c", "rest", "http", "curl", "google-drive-api"], "comments": [{"owner": {"reputation": 511, "user_id": 8078036, "user_type": "registered", "profile_image": "https://graph.facebook.com/644697915727001/picture?type=large", "display_name": "Vanessa Leung", "link": "https://stackoverflow.com/users/8078036/vanessa-leung"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1555487853, "post_id": 55722357, "comment_id": 98124407, "body": "@KamilCuk forgot to mention, I run <code>.&#47;a.out</code> after that"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555488436, "post_id": 55722357, "comment_id": 98124756, "body": "You have many errors in your code. Please provide a better MCVE. <code>chunk.memory</code> - chunk is a pointer and <code>memory</code> is unknown field member. <code>res</code> is` CURLcode<code>. </code>chunk5` is probably <code>chunk</code>. <code>curl_handle</code> is <code>CURL *</code>. Would be nice to add <code>stat</code> call and <code>size_t WriteMemoryCallback(char *ptr, size_t size, size_t nmemb, void *userdata) {         printf(&quot;%s %p %zu %zu %p &#39;%.*s&#39;\\n&quot;, __func__, ptr, size, nmemb, userdata, nmemb, ptr);         return nmemb; } </code> declaration."}, {"owner": {"reputation": 511, "user_id": 8078036, "user_type": "registered", "profile_image": "https://graph.facebook.com/644697915727001/picture?type=large", "display_name": "Vanessa Leung", "link": "https://stackoverflow.com/users/8078036/vanessa-leung"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555488817, "post_id": 55722357, "comment_id": 98124962, "body": "@KamilCuk Hi, I&#39;ve updated my post, please have a look, thx!"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555488946, "post_id": 55722357, "comment_id": 98125033, "body": "Puff, I get the same error. But, the request here is <code>PUT &#47;upload&#47;drive&#47;v3&#47;files</code> , but the <a href=\"https://developers.google.com/drive/api/v3/manage-uploads\" rel=\"nofollow noreferrer\">site</a> says it should be <code>POST</code>. I think I will post that as an answer."}, {"owner": {"reputation": 511, "user_id": 8078036, "user_type": "registered", "profile_image": "https://graph.facebook.com/644697915727001/picture?type=large", "display_name": "Vanessa Leung", "link": "https://stackoverflow.com/users/8078036/vanessa-leung"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1555489370, "post_id": 55722357, "comment_id": 98125259, "body": "@KamilCuk yes, you&#39;re right, but I followed the libcurl example of fileupload, still searching for other ways of posting file by libcurl"}, {"owner": {"reputation": 511, "user_id": 8078036, "user_type": "registered", "profile_image": "https://graph.facebook.com/644697915727001/picture?type=large", "display_name": "Vanessa Leung", "link": "https://stackoverflow.com/users/8078036/vanessa-leung"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1555489762, "post_id": 55722357, "comment_id": 98125493, "body": "@KamilCuk I edited my question with changing <code>PUT</code> method to <code>POST</code>, please have a look, thx!"}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1555491669, "creation_date": 1555491669, "answer_id": 55723745, "question_id": 55722357, "link": "https://stackoverflow.com/questions/55722357/c-error-408-response-of-uploading-file-to-google-drive-via-http-request/55723745#55723745", "title": "C: Error 408 response of uploading file to Google Drive via HTTP request", "body": "<p>This:</p>\n\n<pre><code>curl_easy_setopt(curl_handle, CURLOPT_POSTFIELDS, \"uploadType=media\");\n</code></pre>\n\n<p>is the same as:</p>\n\n<pre><code>curl_easy_setopt(curl_handle, CURLOPT_READDATA, \"uploadType=media\");\ncurl_easy_setopt(curl_handle, CURLOPT_READFUNCTION, a_fucntion_that_reads_that_string);\n</code></pre>\n\n<p>The <code>CURLOPT_POSTFIELDS</code> set's the POST body. You set the post body to <code>uploadType=media</code>. You don't want to send that string, you want to send the file. The string <code>uploadType=media</code> is part of the url and you should just add it to the url. Google reponded with 404 not found - the url <code>/upload/drive/v3/files</code> is invalid, should be <code>/upload/drive/v3/files?uploadType=media</code>.</p>\n\n<p>You should set the url right:</p>\n\n<pre><code>curl_easy_setopt(curl_handle, CURLOPT_URL, \"https://www.googleapis.com/upload/drive/v3/files?uploadType=media\");\n</code></pre>\n\n<p>remove the </p>\n\n<pre><code>// remove\n// curl_easy_setopt(curl_handle, CURLOPT_POSTFIELDS, \"uploadType=media\");\n</code></pre>\n\n<p>and just read the data from <code>FILE*</code> using <code>CURLOPT_READDATA</code>.</p>\n\n<p>I was left with the following program (sorry for the mess):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;curl/curl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/stat.h&gt;\n\nconst char access_token[] = \"Proceeding at three quarters impulse. Make it so, commander!\";\n\nint main() {\n\n    CURL * curl_handle = curl_easy_init();\n    struct stat file_info;\n    FILE *fd;\n\n    stat(\"grinch.jpg\", &amp;file_info);\n    printf(\"%zu\\n\", file_info.st_size);\n\n    /* get a FILE * of the image */\n    fd = fopen(\"grinch.jpg\", \"rb\");\n    if (fd == NULL) {\n        abort();\n    }\n\n    struct curl_slist *chunk = NULL;\n\n    /* Content-Type: image/jpeg */\n    chunk = curl_slist_append(chunk, \"Content-Type: image/jpeg\");\n\n    /* Content-Length: [NUMBER_OF_BYTES_IN_FILE] */\n    char size[200];\n    snprintf(size, 200, \"Content-Length: %lld\", (long long int)file_info.st_size);\n\n    chunk = curl_slist_append(chunk, size);\n\n    /* Authorization: Bearer [YOUR_AUTH_TOKEN] */\n    char auth[300];\n    strcat(auth, \"Authorization: Bearer \");\n    strcat(auth, access_token);\n\n    chunk = curl_slist_append(chunk, auth);\n\n    curl_easy_setopt(curl_handle, CURLOPT_HTTPHEADER, chunk);\n    curl_easy_setopt(curl_handle, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);\n    curl_easy_setopt(curl_handle, CURLOPT_URL, \"https://www.googleapis.com/upload/drive/v3/files?uploadType=media\");\n    curl_easy_setopt(curl_handle, CURLOPT_POST, 1L);\n    curl_easy_setopt(curl_handle, CURLOPT_READDATA, fd);\n    curl_easy_setopt(curl_handle, CURLOPT_VERBOSE, 1L);\n    CURLcode res = curl_easy_perform(curl_handle);\n\n    /* Print response */\n    if(res != CURLE_OK) {\n        fprintf(stderr, \"curl_easy_perform() failed: %s\\n\", curl_easy_strerror(res));\n    }\n    else {\n        printf(\" SUCCESS  \\n\");\n    }\n\n    curl_easy_cleanup(curl_handle);\n    curl_global_cleanup();\n\n}\n</code></pre>\n\n<p>For the request I get the response:</p>\n\n<pre><code>{\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"authError\",\n    \"message\": \"Invalid Credentials\",\n    \"locationType\": \"header\",\n    \"location\": \"Authorization\"\n   }\n  ],\n  \"code\": 401,\n  \"message\": \"Invalid Credentials\"\n }\n}\n</code></pre>\n\n<p>But that's most probably that my credentials are bad ;) .</p>\n"}], "owner": {"reputation": 511, "user_id": 8078036, "user_type": "registered", "profile_image": "https://graph.facebook.com/644697915727001/picture?type=large", "display_name": "Vanessa Leung", "link": "https://stackoverflow.com/users/8078036/vanessa-leung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 55723745, "answer_count": 1, "score": 3, "last_activity_date": 1555492629, "creation_date": 1555486898, "last_edit_date": 1555492629, "question_id": 55722357, "link": "https://stackoverflow.com/questions/55722357/c-error-408-response-of-uploading-file-to-google-drive-via-http-request", "title": "C: Error 408 response of uploading file to Google Drive via HTTP request", "body": "<p>I have followed the <a href=\"https://developers.google.com/drive/api/v3/manage-uploads\" rel=\"nofollow noreferrer\">Google Tutorial</a> &amp; <a href=\"https://curl.haxx.se/libcurl/c/fileupload.html\" rel=\"nofollow noreferrer\">libcurl example</a> to <code>simple upload</code> an image to Google Drive via HTTP, but got the error <code>404 Not Found</code>, which should only happen under <code>resumable upload</code>, according to <a href=\"https://developers.google.com/drive/api/v3/manage-uploads#errors\" rel=\"nofollow noreferrer\">Google Guide</a>. </p>\n\n<p>Google Sample code:</p>\n\n<pre><code>POST https://www.googleapis.com/upload/drive/v3/files?uploadType=media HTTP/1.1\nContent-Type: image/jpeg\nContent-Length: [NUMBER_OF_BYTES_IN_FILE]\nAuthorization: Bearer [YOUR_AUTH_TOKEN]\n\n[JPEG_DATA]\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>/* for storing the response */\nstruct MemoryStruct {\n    char *memory;\n    size_t size;\n};\n\nstatic size_t WriteMemoryCallback(void *contents, size_t size, size_t nmemb, void *userp)\n{\n    size_t realsize = size * nmemb;\n    struct MemoryStruct *mem = (struct MemoryStruct *)userp;\n\n    char *ptr = realloc(mem-&gt;memory, mem-&gt;size + realsize + 1);\n    if(ptr == NULL) {\n        /* out of memory! */\n        printf(\"not enough memory (realloc returned NULL)\\n\");\n        return 0;\n    }\n    mem-&gt;memory = ptr;\n    memcpy(&amp;(mem-&gt;memory[mem-&gt;size]), contents, realsize);\n    mem-&gt;size += realsize;\n    mem-&gt;memory[mem-&gt;size] = 0;\n\n    return realsize;\n}\n\nint main(void){\n    CURL *curl_handle;\n    CURLcode res;\n\n    struct MemoryStruct chunk;\n\n    chunk.memory = malloc(1);\n    chunk.size = 0;\n\n    curl_global_init(CURL_GLOBAL_ALL);\n\n    curl_handle = curl_easy_init();\n    struct stat file_info;\n    FILE *fd;\n\n    /* get a FILE * of the image */\n    fd = fopen(\"grinch.jpg\", \"rb\");\n    if(!fd)\n        return 1;\n\n    if(fstat(fileno(fd), &amp;file_info) != 0)\n        return 1;\n\n    struct curl_slist *chunk = NULL;\n\n    /* Content-Type: image/jpeg */\n    chunk = curl_slist_append(chunk5, \"Content-Type: image/jpeg\");\n\n    /* Content-Length: [NUMBER_OF_BYTES_IN_FILE] */\n    char size[200];\n    snprintf(size, 200, \"Content-Length: %lld\", (curl_off_t)file_info.st_size);\n\n    chunk = curl_slist_append(chunk, size);\n\n    /* Authorization: Bearer [YOUR_AUTH_TOKEN] */\n    char auth[300];\n    strcat(auth, \"Authorization: Bearer \");\n    strcat(auth, access_token);\n\n    chunk = curl_slist_append(chunk, auth);\n\n    curl_easy_setopt(curl_handle, CURLOPT_HTTPHEADER, chunk);\n\n    /* POST https://www.googleapis.com/upload/drive/v3/files?uploadType=media */\n    curl_easy_setopt(curl_handle, CURLOPT_URL, \"https://www.googleapis.com/upload/drive/v3/files\");\n\n    curl_easy_setopt(curl_handle, CURLOPT_POSTFIELDS, \"uploadType=media\");\n\n    /* [JPEG_DATA] */\n    curl_easy_setopt(curl_handle, CURLOPT_POST, 1L);\n\n    curl_easy_setopt(curl_handle, CURLOPT_READDATA, fd);\n\n    curl_easy_setopt(curl_handle, CURLOPT_INFILESIZE_LARGE, (curl_off_t)file_info.st_size);\n\n    /* Save response */\n    curl_easy_setopt(curl_handle, CURLOPT_VERBOSE, 1L);\n\n    curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, WriteMemoryCallback);\n\n    curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, (void *)&amp;chunk);\n\n    curl_easy_setopt(curl_handle, CURLOPT_USERAGENT, \"libcurl-agent/1.0\");\n\n    res = curl_easy_perform(curl_handle);\n\n    /* Print response */\n    if(res != CURLE_OK) {\n        fprintf(stderr, \"curl_easy_perform() failed: %s\\n\", \n    curl_easy_strerror(res));\n    }\n    else {\n        printf(\"%s\\n\", chunk.memory);\n    }\n</code></pre>\n\n<p>But the response I got didn't match with the tutorial. </p>\n\n<p>Google said it should respond:</p>\n\n<pre><code>HTTP/1.1 200\nContent-Type: application/json\n\n{\n  \"name\": \"myObject\"\n}\n</code></pre>\n\n<p>Response I got when I run directly in XCode:</p>\n\n<pre><code>POST /upload/drive/v3/files HTTP/1.1\nHost: www.googleapis.com\nUser-Agent: libcurl-agent/1.0\nAccept: */*\nContent-Type: image/jpeg\nContent-Length: 5123\nAuthorization: Bearer [my access token]\n\n* upload completely sent off: 16 out of 16 bytes\n&lt; HTTP/1.1 408 Request Timeout\n&lt; Content-Type: text/html; charset=UTF-8\n&lt; Referrer-Policy: no-referrer\n&lt; Content-Length: 1557\n&lt; Date: Wed, 17 Apr 2019 08:32:18 GMT\n&lt; Alt-Svc: quic=\":443\"; ma=2592000; v=\"46,44,43,39\"\n&lt; Connection: close\n&lt; \n* Closing connection 0\n&lt;!DOCTYPE html&gt;\n&lt;html lang=en&gt;\n  &lt;meta charset=utf-8&gt;\n  &lt;meta name=viewport content=\"initial-scale=1, minimum-scale=1, width=device-width\"&gt;\n  &lt;title&gt;Error 408 (Request Timeout)!!1&lt;/title&gt;\n  &lt;style&gt;\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* &gt; body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  &lt;/style&gt;\n  &lt;a href=//www.google.com/&gt;&lt;span id=logo aria-label=Google&gt;&lt;/span&gt;&lt;/a&gt;\n  &lt;p&gt;&lt;b&gt;408.&lt;/b&gt; &lt;ins&gt;That\u2019s an error.&lt;/ins&gt;\n  &lt;p&gt;Your client has taken too long to issue its request.  &lt;ins&gt;That\u2019s all we know.&lt;/ins&gt;\n\nProgram ended with exit code: 0\n</code></pre>\n\n<p>I can't find the explanation of <code>Error 408 (Request Timeout)!!</code> in <a href=\"https://developers.google.com/drive/api/v3/manage-uploads#errors\" rel=\"nofollow noreferrer\">Google Tutorial</a></p>\n"}, {"tags": ["c", "codeblocks", "libcurl"], "comments": [{"owner": {"reputation": 1514, "user_id": 1291628, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7eca596c7dc7b82b63243bb8af928128?s=128&d=identicon&r=PG", "display_name": "ikkentim", "link": "https://stackoverflow.com/users/1291628/ikkentim"}, "edited": false, "score": 0, "creation_date": 1555488099, "post_id": 55721877, "comment_id": 98124582, "body": "Why did you append port 8080 to the URL? <a href=\"https://www.google.fr:8080\" rel=\"nofollow noreferrer\">google.fr:8080</a>  Google does not listen on port 8080."}], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 10160890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4sOQ.png?s=128&g=1", "display_name": "axel7083", "link": "https://stackoverflow.com/users/10160890/axel7083"}, "edited": false, "score": 0, "creation_date": 1555489753, "post_id": 55722650, "comment_id": 98125484, "body": "Hey, yes you were right, my school is using a proxy. Thanks to the post <a href=\"https://superuser.com/questions/346372/how-do-i-know-what-proxy-server-im-using\" title=\"how do i know what proxy server im using\">superuser.com/questions/346372/&hellip;</a> I get the proxy of the server and add it into the configuration of the connection of curl, and now It work fine."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 540, "user_id": 10160890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4sOQ.png?s=128&g=1", "display_name": "axel7083", "link": "https://stackoverflow.com/users/10160890/axel7083"}, "edited": false, "score": 0, "creation_date": 1555497402, "post_id": 55722650, "comment_id": 98129945, "body": "@axel7083 You already used a proxy in your question. What did you need to change to make it work? Was ist just the wrong port or something else?"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "edited": false, "score": 0, "creation_date": 1555501169, "post_id": 55722650, "comment_id": 98132132, "body": "This particular line was added in an edit and was not in the original post."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1555508199, "post_id": 55722650, "comment_id": 98136603, "body": "This line was already present in first revision: &quot;After I tried to setup a proxy in the LibCurl connection. But it didn&#39;t change anything.&quot;"}, {"owner": {"reputation": 540, "user_id": 10160890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4sOQ.png?s=128&g=1", "display_name": "axel7083", "link": "https://stackoverflow.com/users/10160890/axel7083"}, "edited": false, "score": 0, "creation_date": 1556219796, "post_id": 55722650, "comment_id": 98373808, "body": "In fact I was using a random proxy, not the proxy of my school, so I used some tools to get the proxy of my school and after using it, it was working fine"}], "tags": [], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1555487845, "creation_date": 1555487845, "answer_id": 55722650, "question_id": 55721877, "link": "https://stackoverflow.com/questions/55721877/libcurl-failed-to-connect-to-www-google-fr-connection-refused/55722650#55722650", "title": "Libcurl : Failed to connect to www.google.fr connection refused", "body": "<p>If your connection is fine, this error is probably due to a proxy server: is your school using a proxy?</p>\n\n<p>If so, you need to explicitely tell curl to make this request through your proxy. This can be done with</p>\n\n<p><code>curl_easy_setopt(curl, CURLOPT_PROXY, \"http://proxy:80\");</code></p>\n\n<p>You can find more informations on proxy there: <a href=\"https://curl.haxx.se/libcurl/c/CURLOPT_PROXY.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/libcurl/c/CURLOPT_PROXY.html</a></p>\n\n<p>Alternatively, you can try to use this in command line with <code>curl -x http://proxy_server:proxy_port --proxy-user username:password -L http://url</code></p>\n"}], "owner": {"reputation": 540, "user_id": 10160890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4sOQ.png?s=128&g=1", "display_name": "axel7083", "link": "https://stackoverflow.com/users/10160890/axel7083"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 55722650, "answer_count": 1, "score": 0, "last_activity_date": 1555487845, "creation_date": 1555485156, "last_edit_date": 1555487048, "question_id": 55721877, "link": "https://stackoverflow.com/questions/55721877/libcurl-failed-to-connect-to-www-google-fr-connection-refused", "title": "Libcurl : Failed to connect to www.google.fr connection refused", "body": "<p>I'm using curl-7.64.1 (<a href=\"https://curl.haxx.se/windows/\" rel=\"nofollow noreferrer\">https://curl.haxx.se/windows/</a>) 32 bit, with OpenSSL 1.1.1b (32 bit) and tidy-5.0.0 for XML parsing.</p>\n\n<p>When I'm home making any connection work fine, but when I'm at School, connected to the Wifi of this one. All the connection are refused.</p>\n\n<p>I tried to make a connection to <a href=\"https://www.google.fr/\" rel=\"nofollow noreferrer\">https://www.google.fr/</a> and with CURLOPT_VERBOSE I get on the screen the message :</p>\n\n<ul>\n<li>Trying 172.217.18.227...</li>\n<li>TCP_NODELAY set</li>\n<li>connect to 172.217.18.227 port 443 failed: Connection refused</li>\n<li>Failed to connect to www.google.fr port 443: Connection refused</li>\n<li>Closing connection 0\nFailed to connect to www.google.fr port 443: Connection refused</li>\n</ul>\n\n<p>I tried first to change the port, to 8080. I wrote <a href=\"https://www.google.fr:8080\" rel=\"nofollow noreferrer\">https://www.google.fr:8080</a> as URL for libCurl.\nBut still have :\nFailed to connect to www.google.fr port 8080: Connection refused</p>\n\n<p>After I tried to setup a proxy in the LibCurl connection. But it didn't change anything.</p>\n\n<pre><code> CURL *curl;\n char curl_errbuf[CURL_ERROR_SIZE];\n TidyDoc tdoc;\n TidyBuffer docbuf = {0};\n TidyBuffer tidy_errbuf = {0};\n int err;\n\n curl = curl_easy_init();\n curl_easy_setopt(curl, CURLOPT_URL, \"https://www.google.fr:8080\");\n curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, curl_errbuf);\n //curl_easy_setopt(curl, CURLOPT_NOPROGRESS, 0L);\n curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);\n curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_cb);\n\n curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, FALSE);\n\n tdoc = tidyCreate();\n tidyOptSetBool(tdoc, TidyForceOutput, yes);\n tidyOptSetInt(tdoc, TidyWrapLen, 4096);\n tidySetErrorBuffer(tdoc, &amp;tidy_errbuf);\n tidyBufInit(&amp;docbuf);\n\n curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;docbuf);\n\n curl_easy_setopt(curl, CURLOPT_PROXY, \"http://212.129.52.155:8080\");\n\n err = curl_easy_perform(curl);\n</code></pre>\n\n<p>I would like make the connection work on the Wifi of my School.</p>\n\n<h1>EDIT 1 :</h1>\n\n<p>Following the advise in this post : <a href=\"https://stackoverflow.com/questions/9391137/can-servers-block-curl-requests\">Can servers block curl requests?</a></p>\n\n<p>I exacted the headers from Chrome and added it into LibCurl.</p>\n\n<pre><code>struct curl_slist *list = NULL;\n\nlist = curl_slist_append(list, \"accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\");\nlist = curl_slist_append(list, \"accept-encoding: gzip, deflate, br\");\nlist = curl_slist_append(list, \"accept-language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7\");\nlist = curl_slist_append(list, \"cache-control: max-age=0\");\nlist = curl_slist_append(list, \"upgrade-insecure-requests: 1\");\n\ncurl_easy_setopt(curl, CURLOPT_HTTPHEADER, list);\n</code></pre>\n\n<p>I enable the UserAgent settings :</p>\n\n<pre><code>curl_easy_setopt(curl, CURLOPT_USERAGENT, \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36\");\n</code></pre>\n\n<p>And I added cookies :</p>\n\n<pre><code>curl_easy_setopt(curl, CURLOPT_COOKIESESSION, 1L);\ncurl_easy_setopt(curl, CURLOPT_COOKIEJAR, \"cookies.txt\");\n</code></pre>\n\n<p>But after all the connection still failed. </p>\n"}, {"tags": ["c++", "c", "odbc"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555484583, "post_id": 55721692, "comment_id": 98122764, "body": "What&#39;s <code>temp</code>&#39;s type?"}, {"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555485052, "post_id": 55721692, "comment_id": 98122960, "body": "That is char temp[256];"}, {"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555485244, "post_id": 55721692, "comment_id": 98123047, "body": "It is piece of code from the old version of postgresql odbc driver"}], "answers": [{"comments": [{"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555489222, "post_id": 55722599, "comment_id": 98125187, "body": "To test quickly I have changed the SQLGetPrivateProfileString to SQLGetPrivateProfileStringW with the same parameters. But it returns empty string."}, {"owner": {"reputation": 941, "user_id": 1849287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14e272de9cfe3615952604a7392ebdc?s=128&d=identicon&r=PG", "display_name": "Nellie Danielyan", "link": "https://stackoverflow.com/users/1849287/nellie-danielyan"}, "reply_to_user": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555489410, "post_id": 55722599, "comment_id": 98125280, "body": "How do you check if it is empty? In a Unicode string any one byte can be \\0, each character will be represented as 2 bytes, because ODBC uses UCS-2. so you cannot expect your char array to be null terminated."}, {"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555493614, "post_id": 55722599, "comment_id": 98127669, "body": "I see in the VS debugger temp=&quot;&quot;"}, {"owner": {"reputation": 941, "user_id": 1849287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14e272de9cfe3615952604a7392ebdc?s=128&d=identicon&r=PG", "display_name": "Nellie Danielyan", "link": "https://stackoverflow.com/users/1849287/nellie-danielyan"}, "reply_to_user": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555493760, "post_id": 55722599, "comment_id": 98127742, "body": "This just indicates that the first byte is 0"}, {"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555494762, "post_id": 55722599, "comment_id": 98128403, "body": "I have checked : the first 5 bytes =0, then some character, then again many zeroes...."}, {"owner": {"reputation": 941, "user_id": 1849287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14e272de9cfe3615952604a7392ebdc?s=128&d=identicon&r=PG", "display_name": "Nellie Danielyan", "link": "https://stackoverflow.com/users/1849287/nellie-danielyan"}, "reply_to_user": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555495171, "post_id": 55722599, "comment_id": 98128660, "body": "And what did the function return? It is supposed to return the number of read characters. You can check for errors using <code>SQLInstallerError </code>.  I assume that other arguments you passed to the function might need conversion to Unicode UCS_2 encoding."}, {"owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "edited": false, "score": 0, "creation_date": 1555498632, "post_id": 55722599, "comment_id": 98130635, "body": "There is in v11 (line 600) <a href=\"https://git.postgresql.org/gitweb/?p=psqlodbc.git;a=blob;f=dlg_specific.c;h=309b9bcd546c95aeecf1fa1084a942f0117ddbee;hb=HEAD\" rel=\"nofollow noreferrer\">git.postgresql.org/gitweb/&hellip;</a>  It works in both cases: ANSI and UNICODE. And no any additional conversions"}], "tags": [], "owner": {"reputation": 941, "user_id": 1849287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14e272de9cfe3615952604a7392ebdc?s=128&d=identicon&r=PG", "display_name": "Nellie Danielyan", "link": "https://stackoverflow.com/users/1849287/nellie-danielyan"}, "is_accepted": true, "score": 3, "last_activity_date": 1555488146, "last_edit_date": 1555488146, "creation_date": 1555487685, "answer_id": 55722599, "question_id": 55721692, "link": "https://stackoverflow.com/questions/55721692/sqlgetprivateprofilestring-reads-unicode-characters-incorrectly/55722599#55722599", "title": "SQLGetPrivateProfileString reads Unicode characters incorrectly", "body": "<p>Unicode version of the function needs to be called, which is <code>SQLGetPrivateProfileStringW</code>.\nSee <a href=\"https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/function-mapping-in-the-driver-manager?view=sql-server-2017\" rel=\"nofollow noreferrer\">this Microsoft doc</a></p>\n\n<blockquote>\n  <p>If the application is compiled with the _UNICODE #define the ODBC\n  header file will map undecorated function calls to the Unicode\n  version.</p>\n</blockquote>\n\n<p>and <a href=\"https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/unicode-applications?view=sql-server-2017\" rel=\"nofollow noreferrer\">this one</a></p>\n\n<blockquote>\n  <p>You can recompile an application as a Unicode application in one of two ways:</p>\n  \n  <ul>\n  <li>Include the Unicode #define contained in the Sqlucode.h header file in the application.</li>\n  <li>Compile the application with the compiler's Unicode option. (This option will be different for different compilers.)</li>\n  </ul>\n</blockquote>\n\n<p>See <em>odbcinst.h</em>:</p>\n\n<pre><code>#ifdef  UNICODE\n...\n#define  SQLGetPrivateProfileString     SQLGetPrivateProfileStringW\n...\n</code></pre>\n\n<p>where <code>SQLGetPrivateProfileStringW</code> is declared as:</p>\n\n<pre><code>int  INSTAPI SQLGetPrivateProfileStringW\n(\n    _In_opt_ LPCWSTR lpszSection,\n    _In_opt_ LPCWSTR lpszEntry,\n    _In_opt_ LPCWSTR lpszDefault,\n    _Out_writes_opt_(cchRetBuffer) LPWSTR lpszRetBuffer,\n    int              cchRetBuffer,\n    _In_opt_ LPCWSTR lpszFilename\n);\n</code></pre>\n\n<p>The Unicode version of the function recevies <code>LPCWSTR</code> and <code>LPWSTR</code>, which are pointers to a string of 16-bit Unicode characters. Whatever other function will receive those values will also need to be the Unicode version.</p>\n"}], "owner": {"reputation": 4315, "user_id": 566745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FgNyj.jpg?s=128&g=1", "display_name": "ZedZip", "link": "https://stackoverflow.com/users/566745/zedzip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 55722599, "answer_count": 1, "score": 2, "last_activity_date": 1555509759, "creation_date": 1555484480, "last_edit_date": 1555509759, "question_id": 55721692, "link": "https://stackoverflow.com/questions/55721692/sqlgetprivateprofilestring-reads-unicode-characters-incorrectly", "title": "SQLGetPrivateProfileString reads Unicode characters incorrectly", "body": "<p>I use in <code>SQLGetPrivateProfileString</code> to read DSN parameters from <code>odbcinst.ini</code> (Registry).</p>\n\n<p>But if I use characters like <code>UID='K\u00f6nig'</code> in the DSN and call</p>\n\n<pre><code>SQLGetPrivateProfileString(DSN, INI_USERNAME, \"\", temp, sizeof(temp), ODBC_INI)\n</code></pre>\n\n<p>the variable <code>temp='K?nig'</code></p>\n\n<p>Naturally, odbc cannot connect to the data source.\nHow to read correct values? </p>\n"}, {"tags": ["c", "malloc", "strlen"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1555484771, "post_id": 55721440, "comment_id": 98122843, "body": "Why are you allocating <code>((length + 1) * sizeof(char)) &#47; 2 - 1</code> bytes of memory? It should be <code>ch_pointer = malloc(length + 1);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11372135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa951d5e220ce2c8975a87213a6f72c1?s=128&d=identicon&r=PG&f=1", "display_name": "barakadax", "link": "https://stackoverflow.com/users/11372135/barakadax"}, "edited": false, "score": 1, "creation_date": 1555483826, "post_id": 55721506, "comment_id": 98122432, "body": "I feel stupid, thank you very much for clarifying this, will use: while( ch_pointer[something] != &#39;\\0&#39;) or use the length the user writes, thanks very much"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 37, "user_id": 11372135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa951d5e220ce2c8975a87213a6f72c1?s=128&d=identicon&r=PG&f=1", "display_name": "barakadax", "link": "https://stackoverflow.com/users/11372135/barakadax"}, "edited": false, "score": 1, "creation_date": 1555484249, "post_id": 55721506, "comment_id": 98122630, "body": "@barakadax: <code>while( ch_pointer[something] != &#39;\\0&#39;)</code> will be just as undefined behavior. You must write values to the bytes pointed to by <code>ch_pointer</code>. Conversely, allocating the memory with <code>calloc()</code> returns a block with all bytes initialized to <code>0</code>, hence <code>strlen(ch_pointer)</code> would return <code>0</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1555483956, "last_edit_date": 1555483956, "creation_date": 1555483708, "answer_id": 55721506, "question_id": 55721440, "link": "https://stackoverflow.com/questions/55721440/my-strlen-works-differently-in-2-different-compilers-any-explanation/55721506#55721506", "title": "my strlen works differently in 2 different compilers, any explanation?", "body": "<p>The problem is, <code>malloc()</code> returns a pointer to the allocated memory, the content of which is indeterminate. </p>\n\n<p>Quoting <code>C11</code>, chapter 7.22.3.4</p>\n\n<blockquote>\n  <p><em>The <code>malloc</code> function allocates space for an object whose size is specified by <code>size</code> and\n  whose value is indeterminate.</em></p>\n</blockquote>\n\n<p>That said, for the <code>strlen()</code> from chapter 7.24.6.3,</p>\n\n<blockquote>\n  <p><em>The <code>strlen</code> function computes the length of the string pointed to by <code>s</code>.</em></p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p><em>The <code>strlen</code> function returns the number of characters that precede the terminating null\n  character.</em></p>\n</blockquote>\n\n<p>So, <code>strlen()</code> experts the argument to be a <em>string</em>.</p>\n\n<p>Now, by definition, the memory pointed to by the pointer returned by <code>malloc()</code> does not guarantee a null terminator to be present anywhere in the memory. Thus, you cannot run <code>strlen()</code> on that. You'll most likely invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a> by memory overrrun.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1555484049, "post_id": 55721523, "comment_id": 98122533, "body": "<code>ch_pointer[strlen(ch_pointer) - 1] = &#39;\\0&#39;;</code> is not a no operation, <code>ch_pointer[strlen(ch_pointer)] = &#39;\\0&#39;;</code> is"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1555484092, "post_id": 55721523, "comment_id": 98122562, "body": "@chqrlie oh yes, not having finished my coffee means higher probability of off by ones."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 2, "last_activity_date": 1555484879, "last_edit_date": 1555484879, "creation_date": 1555483788, "answer_id": 55721523, "question_id": 55721440, "link": "https://stackoverflow.com/questions/55721440/my-strlen-works-differently-in-2-different-compilers-any-explanation/55721523#55721523", "title": "my strlen works differently in 2 different compilers, any explanation?", "body": "<p>There's a fundamental misunderstanding here: <code>strlen</code> doesn't know a thing about the allocated size of the array you pass in; it just walks it until it finds a null character, and returns how many characters it had to skip.</p>\n\n<p>As <code>malloc</code> returns a pointer to uninitialized memory, its content is unpredictable, so calling <code>strlen</code> over it is undefined behavior - in the worst case where the memory block has no zero in it, it will even go on reading outside it, hopefully crashing the program. </p>\n"}], "owner": {"reputation": 37, "user_id": 11372135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa951d5e220ce2c8975a87213a6f72c1?s=128&d=identicon&r=PG&f=1", "display_name": "barakadax", "link": "https://stackoverflow.com/users/11372135/barakadax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1555483851, "answer_count": 2, "score": 0, "last_activity_date": 1555484879, "creation_date": 1555483475, "last_edit_date": 1555484000, "question_id": 55721440, "link": "https://stackoverflow.com/questions/55721440/my-strlen-works-differently-in-2-different-compilers-any-explanation", "closed_reason": "Duplicate", "title": "my strlen works differently in 2 different compilers, any explanation?", "body": "<p>I'm using the gcc compiler I installed which I run from my cmd (write in the editor visual code) &amp; for debugging I also installed visual studio.\nIt's my second semester and I just learned about <code>malloc</code>/<code>calloc</code> etc.</p>\n\n<p>so the line:</p>\n\n<pre><code>ch_pointer = (char *)malloc(length * sizeof(char));\n</code></pre>\n\n<p>in my gcc compiler gives in return when I use <code>strlen(ch_pointer)</code>, <code>2</code> or <code>4</code> as an answer.</p>\n\n<p>If I use a number too big (example 100) for length it also just says <code>strlen(ch_pointer) == 0</code>.</p>\n\n<p>It works perfectly fine if I write it in visual studio as:</p>\n\n<pre><code>ch_pointer = (char *)malloc(((length + 1) * sizeof(char)) / 2 - 1);\n</code></pre>\n\n<p>and that's the only case it worked perfectly.</p>\n\n<p><code>get_number()</code> function is fine it's just making sure you will type an int type.</p>\n\n<pre><code>void main() {\n    char *ch_pointer = '\\0';\n    int length = 0;\n    printf(\"Please write down your sentence length in characters (including spaces): \");\n    length = get_number();\n\n    ch_pointer = (char *)malloc(((length + 1) * sizeof(char)) / 2 - 1); \n    ch_pointer[strlen(ch_pointer) - 1] = '\\0';\n\n    printf(\"Please write down your sentence: \");\n    for (int filling = 0; filling &lt; strlen(ch_pointer); filling++)\n        scanf(\" %c\", &amp;ch_pointer[filling]);\n    for (int printing = 0; printing &lt; strlen(ch_pointer); printing++)\n        printf(\"%c\", ch_pointer[printing]);\n\n    free(ch_pointer);\n}\n</code></pre>\n\n<p>For both compilers to work the same if I write down <code>4</code> or even <code>100</code> to get an array length <code>5</code> or <code>101</code> that ends in <code>'\\0'</code> &amp; let me type and print perfectly:</p>\n\n<pre><code>length = 4\nstrlen(ch_pointer) == 4\n</code></pre>\n\n<p>or</p>\n\n<pre><code>length = 100\nstrlen(ch_pointer) == 100\n</code></pre>\n"}, {"tags": ["c++", "c", "algorithm"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 7, "creation_date": 1555482982, "post_id": 55721267, "comment_id": 98122099, "body": "HSL has no relation to opacity.  Alpha is always a 4th, separate channel, whether RGBA or HSLA"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1555483137, "post_id": 55721267, "comment_id": 98122153, "body": "Also you can produce any hue from a single texture by multiplying a white texture by the desired color."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1555483362, "post_id": 55721267, "comment_id": 98122252, "body": "To use alpha in this way, try writing out the linear equations for R, G, B in terms of R0, G0, B0 (the fully saturated color for the specified hue), substitute those into the alpha blend formula, and solve for A."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1555483388, "post_id": 55721267, "comment_id": 98122264, "body": "But I would still just apply the hue to a greyscale texture using multiplication."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1555489698, "post_id": 55721267, "comment_id": 98125447, "body": "Not sure but seems you misinterpret the correct image... For me alpha is not related to other values, you have vertical alpha component gradually going from 1 to 0 and independant horizontal saturation/luminosity grading"}], "answers": [{"comments": [{"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "reply_to_user": {"reputation": 33, "user_id": 10769706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22fc8a2d92801e3d46de7691310c15e9?s=128&d=identicon&r=PG&f=1", "display_name": "alice", "link": "https://stackoverflow.com/users/10769706/alice"}, "edited": false, "score": 0, "creation_date": 1555538978, "post_id": 55733783, "comment_id": 98151278, "body": "Looks like something&#39;s applying a gamma adjustment"}], "tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": true, "score": 2, "last_activity_date": 1555525252, "creation_date": 1555525252, "answer_id": 55733783, "question_id": 55721267, "link": "https://stackoverflow.com/questions/55721267/algorithm-for-bitmap/55733783#55733783", "title": "Algorithm For Bitmap", "body": "<p>If I understand you correctly, you want a grey scale bitmap with alpha that you can compose on top of any pure color.</p>\n\n<p>Easily done.  Imagine that the color underneath is red, for example.  Then you can calculate the color you would want at every pixel.  There are multiple ways to do that, but your 'correct bitmap' looks like this way:</p>\n\n<p><strong>TARGET = lum * ( WHITE * (1-sat) + RED * sat )</strong></p>\n\n<p><strong>TARGET = WHITE * lum * (1-sat) + RED * lum * sat</strong></p>\n\n<p>You want the RED component to be provided by transparency, and the WHITE component to be provided by the bitmap gray:</p>\n\n<p><strong>TARGET = WHITE * gray_level/255 * alpha/255 + RED * (1-alpha/255)</strong></p>\n\n<p>Looks like you got the alpha part right:</p>\n\n<p><strong>1-alpha/255 = lum * sat</strong></p>\n\n<p><strong>alpha = (1 - (lum * sat)) * 255</strong> </p>\n\n<p>BUT, you got the gray level wrong:</p>\n\n<p><strong>gray_level/255 * alpha/255 = lum * (1-sat)</strong></p>\n\n<p><strong>gray_level = 255 * (lum - (lum * sat)) / (1 - (lum * sat))</strong></p>\n\n<p>Be careful about the instability in the division when lum*sat is very close to 1.</p>\n"}], "owner": {"reputation": 33, "user_id": 10769706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22fc8a2d92801e3d46de7691310c15e9?s=128&d=identicon&r=PG&f=1", "display_name": "alice", "link": "https://stackoverflow.com/users/10769706/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "closed_date": 1555677945, "accepted_answer_id": 55733783, "answer_count": 1, "score": 2, "last_activity_date": 1558643005, "creation_date": 1555482734, "last_edit_date": 1558643005, "question_id": 55721267, "link": "https://stackoverflow.com/questions/55721267/algorithm-for-bitmap", "closed_reason": "Needs details or clarity", "title": "Algorithm For Bitmap", "body": "<p>I'm creating a HSL gradient from raw pixel data, ignoring the hue how should I determine opacity based off of saturation &amp; luminosity.</p>\n\n<p>Also remember this is somewhat of an optical illusion, where the blue is in the image, it's actually becoming more transparent ( essentially there's a gradient with a blue rectangle below the gradient ).</p>\n\n<pre><code>            double saturation    =  pixel.x / image.width,\n                   luminosity    = 1.0 - ( pixel.y / image.height );\n\n            double alpha_channel = 255.0 * ( 1.0 - ( ( luminosity ) * ( saturation ) ) );\n\n            // Luminosity Channel to fade from white to black.\n            double luminosity_amount = 255.0 * ( luminosity );\n\n            // Set the pixels    Red / Green / Blue   Alpha\n            pixel.color = color( luminosity_amount , alpha_channel );\n</code></pre>\n\n<p>Outcome Version:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ScEPj.png\" alt=\"img\"></p>\n\n<p>Correct Version:</p>\n\n<p><img src=\"https://i.stack.imgur.com/H9LAk.png\" alt=\"img\">.</p>\n\n<p>It becomes less saturated towards the right-middle. Meaning the bitmaps opacity is greater there. </p>\n\n<p>If anyone could come up with an algorithm that would correctly fade the alpha channel from saturation &amp; luminosity that'd be amazing.</p>\n\n<p>Also reason why I'm doing this is so I don't need to create 360 textures for 360 degrees of hue. So I'd rather just create the gradient and layer the gradient over the hue.</p>\n"}, {"tags": ["c", "tcp", "linux-kernel"], "comments": [{"owner": {"reputation": 155, "user_id": 11097663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b26a14f8802d6b94163c676c34ecb470?s=128&d=identicon&r=PG&f=1", "display_name": "Random", "link": "https://stackoverflow.com/users/11097663/random"}, "edited": false, "score": 0, "creation_date": 1594113536, "post_id": 55721118, "comment_id": 111005171, "body": "Did you find an answer for your question ? if so please post it here because i&#39;m confused too about this topic."}], "owner": {"reputation": 55, "user_id": 5674389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73823ebcda49a48966af2fddf8e87592?s=128&d=identicon&r=PG&f=1", "display_name": "27Blend", "link": "https://stackoverflow.com/users/5674389/27blend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594112982, "creation_date": 1555482076, "last_edit_date": 1555670117, "question_id": 55721118, "link": "https://stackoverflow.com/questions/55721118/kernel-tcp-ip-implementation-about-accept-queue-length", "title": "kernel TCP/IP implementation - about accept queue length", "body": "<p>I'm recently learning the TCP/IP implementation in linux kernel(version 4.4), and got really confused about the accept queue. I know there is a queue in <code>struct inet_connection_sock</code> which is called a <strong>accept queue</strong>:</p>\n\n<pre><code>struct inet_connection_sock {\n    ...\n    /* @icsk_accept_queue:     FIFO of established children */\n    struct request_sock_queue icsk_accept_queue;\n    ...\n}\n</code></pre>\n\n<p>and there is a <code>qlen</code> member in it, I think it is used to indicate the length of the queue. </p>\n\n<pre><code>struct request_sock_queue {\n    ...\n    /* length of the queue? */\n    atomic_t        qlen;\n    ...\n};\n</code></pre>\n\n<p>Here is what I think I know: when a LISTEN socket receives a SYN packet, in function <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/net/ipv4/tcp_input.c#L6298\" rel=\"nofollow noreferrer\"><code>tcp_conn_request</code></a>, <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/net/ipv4/inet_connection_sock.c#L638\" rel=\"nofollow noreferrer\"><code>inet_csk_reqsk_queue_hash_add</code></a> is called to put the newly created NEW_SYN_RECV sock into ehash table (not <code>icsk_accept_queue</code>)</p>\n\n<pre><code>void inet_csk_reqsk_queue_hash_add(struct sock *sk, struct request_sock *req,\n                   unsigned long timeout)\n{\n    reqsk_queue_hash_req(req, timeout);  // add to ehash table\n    inet_csk_reqsk_queue_added(sk);      // increment icsk_accept_queue.qlen\n}\n</code></pre>\n\n<p>But in this funcfion, <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/include/net/inet_connection_sock.h#L282\" rel=\"nofollow noreferrer\"><code>inet_csk_reqsk_queue_added</code></a> is called to increment <code>icsk_accept_queue.qlen</code>. My question is why increment <code>qlen</code> since nothing is inserted to <code>icsk_accept_queue</code>? Is it not the length of icsk_accept_queue?</p>\n\n<p>Also, <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/net/ipv4/tcp_input.c#L6291\" rel=\"nofollow noreferrer\"><code>tcp_conn_request</code></a> called <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/net/ipv4/inet_connection_sock.c#L793\" rel=\"nofollow noreferrer\"><code>inet_csk_reqsk_queue_add</code></a> to add a fast open sock(if enabled) to <code>icsk_accept_queue</code>:</p>\n\n<pre><code>struct sock *inet_csk_reqsk_queue_add(struct sock *sk,\n                      struct request_sock *req,\n                      struct sock *child)\n{\n    struct request_sock_queue *queue = &amp;inet_csk(sk)-&gt;icsk_accept_queue;\n\n    spin_lock(&amp;queue-&gt;rskq_lock);\n    if (unlikely(sk-&gt;sk_state != TCP_LISTEN)) {\n        inet_child_forget(sk, req, child);\n        child = NULL;\n    } else {\n        req-&gt;sk = child;\n        req-&gt;dl_next = NULL;\n        if (queue-&gt;rskq_accept_head == NULL)\n            queue-&gt;rskq_accept_head = req;\n        else\n            queue-&gt;rskq_accept_tail-&gt;dl_next = req;\n        queue-&gt;rskq_accept_tail = req;\n        sk_acceptq_added(sk);    // increment sk.sk_ack_backlog\n    }\n    spin_unlock(&amp;queue-&gt;rskq_lock);\n    return child;\n}\n</code></pre>\n\n<p>But this function ended up incrementing <code>sk.sk_ack_backlog</code> (by calling <a href=\"https://elixir.bootlin.com/linux/v4.4.131/source/include/net/sock.h#L791\" rel=\"nofollow noreferrer\"><code>sk_acceptq_added</code></a>) instead of <code>icsk_accept_queue.qlen</code>. Why not?</p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555481971, "post_id": 55720940, "comment_id": 98121741, "body": "First of all, please learn how to create a <a href=\"https://stackoverflow.com/help/mcve\"><b>Minimal</b>, Complete, and Verifiable Example</a>. Secondly please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1555482032, "post_id": 55720940, "comment_id": 98121758, "body": "Also please don&#39;t use global variables. If multiple functions need to use them, then pass them around as arguments instead. Also please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555487651, "post_id": 55720940, "comment_id": 98124286, "body": "Failing to check the return of EVERY <code>fscanf</code> invites <i>Undefined Behavior</i>. Pay careful attention to the comment by @Someprogrammerdude above."}], "answers": [{"tags": [], "owner": {"reputation": 3357, "user_id": 3194340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b99bac217534b05a3f7b957e14025ccc?s=128&d=identicon&r=PG&f=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/3194340/n0p"}, "is_accepted": false, "score": 1, "last_activity_date": 1555483240, "last_edit_date": 1555483240, "creation_date": 1555481827, "answer_id": 55721060, "question_id": 55720940, "link": "https://stackoverflow.com/questions/55720940/how-can-i-print-out-scanned-in-structure-to-file-properly-c/55721060#55721060", "title": "How can I print out scanned in structure to file properly? (C)", "body": "<p>Compiler is right: \n<code>andmed_failidesse</code> expects an <code>int</code> as last parameter and you're passing <code>Hinne</code> which is an array of <code>int</code>, aka <code>int*</code>. </p>\n\n<p>As <code>Tud2</code> is not used anyway in your current code you can remove it from function signature or rework your function to use it.\nYour compiler should also warn you that you have other unused parameters in your function.</p>\n\n<p>It is obviously a work in progress: take a break, re-read your C courses and try to figure out what your function is supposed to do, and which parameters it needs.</p>\n"}], "owner": {"reputation": 65, "user_id": 11371944, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D_VQ-eXGmbg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reNh6QO4oHlDL5EqGrLiyDxe7Wfsw/mo/photo.jpg?sz=128", "display_name": "Frode", "link": "https://stackoverflow.com/users/11371944/frode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555483240, "creation_date": 1555481247, "last_edit_date": 1555483156, "question_id": 55720940, "link": "https://stackoverflow.com/questions/55720940/how-can-i-print-out-scanned-in-structure-to-file-properly-c", "title": "How can I print out scanned in structure to file properly? (C)", "body": "<p>I am trying to read from <em>2 files (f1.txt and f2.txt)</em> using <code>structures</code> and <code>print</code> them out to the <em>third file (f3.txt)</em>, but I seem to be getting some errors. Issues did not occur before I tried printing out the values to the file <code>(fprintf command)</code>, and I cant seem to find a way to fix it..</p>\n\n<p>This is for a homework assignment, but since I've been struggling to fix this issue for months now (yes, I'm pretty bad), I thought maybe anyone here knows how I can fix this.</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n#define MAX_NIME_PIKKUS 100\n#define MAX_AINE_PIKKUS 100\n#define MAX_KOOD 10\n#define MAX_HINNE 5\n\n#define DEBUG 0\n\n    int n;\n    int m;\n\nstruct Tudeng{\n    char Nimi[MAX_NIME_PIKKUS];\n    char Kood[MAX_KOOD];\n};\nstruct Tudeng *pTudeng;\n\nstruct Aine{\n    char Nimetus[MAX_AINE_PIKKUS];\n    char aineKood[MAX_KOOD];\n};\nstruct Aine *pAine;\n\nstruct Tud{\n    char Tudengikood[MAX_KOOD];\n    int Hinne[MAX_HINNE];\n};\nstruct Tud *pTud;\n\nchar f1[] = \"f1.txt\";\nchar f2[] = \"f2.txt\";\nchar f3[] = \"f3.txt\";\nFILE *fp1,*fp2,*fp3;\n\nint sisendf1_kontroll();\nint sisendf2_kontroll();\nvoid tekita_failid();\nvoid andmed_failidesse(char Tudeng1, char Tudeng2, char Aine1, char Aine2, char Tud1, int Tud2);\n\nint main(void){\n    int a;\n    int b;\n    int c;\n    n = sisendf1_kontroll();\n    printf(\"Failist %s loeti %d tudengi andmed.\\n\", f1, n);\n    m = sisendf2_kontroll();\n    printf(\"Failist %s loeti %d aine andmed.\\n\", f2, m);\n    fp1 = fopen(f1,\"r\");\n    fp2 = fopen(f2, \"r\");\n    int i = 0;\n\n    a = sizeof(struct Tudeng);\n    b = sizeof(struct Aine);\n    c = sizeof(struct Tud);\n\n    pTudeng = malloc(a * n);\n    pAine = malloc(b * m);\n    pTud = malloc(c * m);\n\n    if(DEBUG)printf(\"Struktuuri Tudeng baidi aadress on %p, \u00fche kirje andmeteks eraldati m\u00e4lu %d baiti, m\u00e4lu eraldati massiivile kokku %d baiti \\n\", pTudeng, a, a * n);\n    if(DEBUG)printf(\"Struktuuri Aine baidi aadress on %p, \u00fche kirje andmeteks eraldati m\u00e4lu %d baiti, m\u00e4lu eraldati massiivile kokku %d baiti \\n\", pAine, b, b * m);\n    if(DEBUG)printf(\"Struktuuri Tud baidi aadress on %p, \u00fche kirje andmeteks eraldati m\u00e4lu %d baiti, m\u00e4lu eraldati massiivile kokku %d baiti \\n\", pTud, c, c * m);\n    int loopiks;\n\nwhile(loopiks == 0){\n    while(!feof(fp1)){\n        fscanf(fp1,\"%s\",(pTudeng+i)-&gt;Nimi);\n        fscanf(fp1,\"%s\",(pTudeng+i)-&gt;Kood);\n        i++;\n    }\n\n    while(!feof(fp2)){\n        fscanf(fp2,\"%s\",(pAine+i)-&gt;Nimetus);\n        fscanf(fp2,\"%s\",(pAine+i)-&gt;aineKood);\n        fscanf(fp2,\"%s\",(pTud+i)-&gt;Tudengikood);\n        fscanf(fp2,\"%d\",(pTud+i)-&gt;Hinne);\n        i++;\n    }\n    loopiks = 1;\n    tekita_failid();\n    andmed_failidesse((pTudeng+i-&gt;Nimi), (pTudeng+i)-&gt;Kood, (pAine+i)-&gt;Nimetus, (pAine+i)-&gt;aineKood, (pTud+i)-&gt;Tudengikood, (pTud+i)-&gt;Hinne);\n\n    free(pTudeng);\n    free(pAine);\n    free(pTud);\n}\n\n    //fprintf(fp3, \"%s %s\\n\",(pTudeng+i)-&gt;Nimi,(pTudeng+i)-&gt;Kood);\n\n    fclose(fp1);\n    fclose(fp2);\n    return 0;    \n}\n\nint sisendf1_kontroll(void){\n    char rida[122];\n    int n = 0, p;\n    fp1 = fopen(f1,\"r\");\n\n    if(fp1 == NULL){\n        printf(\"Sisendfaili %s avamine ebaonnestus!\", f1);\n        exit(1);\n    }else{\n        while(!feof(fp1)){\n            fgets(rida, 122, fp1);\n            p = strlen(rida);\n            if (p &gt; 1) n++;\n        }\n    }\n    fclose(fp1);\n    return n;\n}\n\nint sisendf2_kontroll(void){\n    char rida2[122];\n    int m = 0, o;\n    fp2 = fopen(f2,\"r\");\n\n    if(fp2==NULL){\n        printf(\"Sisendfaili %s avamine ebaonnestus!\", f2);\n        exit(1);\n    }else{\n        while(!feof(fp2)){\n            fgets(rida2, 122, fp2);\n            o = strlen(rida2);\n            if (o &gt; 1) m++;\n        }\n    }\n    fclose(fp2);\n    return m;\n}\n\nvoid tekita_failid(){\n    fp3 = fopen(f3, \"w\");\n    fclose(fp3);\n    return;\n}\n\nvoid andmed_failidesse(char Tudeng1, char Tudeng2, char Aine1, char Aine2, char Tud1, int Tud2){\n    fp3 = fopen(f3, \"a\");\n    int i;\n    int j;\n    while(i &lt; n &amp;&amp; j &lt; m){\n        for(i = 0; i &lt; n; i++){\n            fprintf(fp3, \"%s %s \",(pTudeng+i)-&gt;Nimi,(pTudeng+i)-&gt;Kood);\n        }\n        for(j = 0; j &lt; m; j++){\n            fprintf(fp3, \"%s %s %s %d \\n\",(pAine+i)-&gt;Nimetus,(pAine+i)-&gt;aineKood, (pTud+i)-&gt;Tudengikood, (pTud+i)-&gt;Hinne);\n    }\n}\n        return;\n}\n</code></pre>\n\n<p>I expected the program to output the information from <em>f1.txt and f2.txt</em> to <em>f3.txt,</em> but currently compiler tells me that I cannot do that, since I'm using <code>* int</code> in last function, but it says that regular int is required.</p>\n"}, {"tags": ["c", "shell"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1555479361, "post_id": 55720119, "comment_id": 98120794, "body": "Since <code>strtok()</code> obliterates the delimiters, it is unlikely to be the weapon of choice.  Are you ready to deal with <code>&quot;arguments in double quotes (\\&quot;) containing escaped double quotes&quot;</code>? Also remember that you can write <code>-DVERSION=&quot;macOS 10.14.4 Mojave&quot;</code> or even <code>-DVERSION=&#39;&quot;macOS 10.14.4 Mojave&quot;&#39;</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1555479431, "post_id": 55720119, "comment_id": 98120815, "body": "When you come across a starting quote, you need to scan for the matching close quote according to the appropriate rules \u2014 which (in a standard POSIX shell) are different for single quotes and double quotes (because backslashes have no special meaning inside single quotes, but do inside double quotes)."}, {"owner": {"reputation": 404, "user_id": 10485803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7c4b92d7ae60dd2b5566a365111bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jae Yang", "link": "https://stackoverflow.com/users/10485803/jae-yang"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1555479437, "post_id": 55720119, "comment_id": 98120818, "body": "I am not concerned with escaped characters for now. I only want to cover the base of a un-nested single/double quote."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1555479666, "post_id": 55720119, "comment_id": 98120904, "body": "Look up <code>strcspn()</code> \u2014 and <code>strspn()</code> and <code>strpbrk()</code>.  They&#39;re all standard (since C90) functions, so they&#39;re available &quot;everywhere&quot;.  And they will help you analyze your strings without damaging them.  Even without escaped characters, you&#39;ll be able to handle both the &#39;version&#39; arguments I showed in an earlier comment (the second is a minor variant of your embedded single quote example), where the quotes are not at the start of the string, as well as the ones you mention in your question.  Yes, the opening quote is removed as usual, and the matching close quote."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555606631, "post_id": 55720119, "comment_id": 98177920, "body": "OT:  regarding: <code>int main(int argc, char* argv[]){</code>  when the parameters to <code>main()</code> are not used, then to avoid two warning messages from the compiler about unused parameters, use the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555606980, "post_id": 55720119, "comment_id": 98178087, "body": "regarding: <code>printf(&quot;mypersonalshell[%d]&gt; &quot;,++cmdNum);</code>  The variable: <code>cmdNum</code> is initialized to 1 and the value is pre-incremented.  so the first time this statement is executed, it will output: <code>mypersonalshell[2]&gt;</code>  Probably not quite what you want"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555607406, "post_id": 55720119, "comment_id": 98178291, "body": "regarding: <code>if ( strcmp(input, &quot;&quot;) == 0){</code>  The function: <code>getline()</code> includes the trailing <code>newline</code>, if any,  in the input, so the resulting string will never be equal to &quot;&quot;"}], "owner": {"reputation": 404, "user_id": 10485803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7c4b92d7ae60dd2b5566a365111bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jae Yang", "link": "https://stackoverflow.com/users/10485803/jae-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555477451, "creation_date": 1555476623, "last_edit_date": 1555477451, "question_id": 55720119, "link": "https://stackoverflow.com/questions/55720119/how-to-handle-quoted-arguments-as-a-single-argument", "title": "How to handle quoted arguments as a single argument?", "body": "<p>I am working on making a shell which takes input from stdin.</p>\n\n<p>I am trying to parse <strong>un-nested</strong>, quoted arguments containing matching, single or double quotes. (can be mixed with non-quoted arguments)</p>\n\n<p>I want each quoted string to be treated as a single argument so I can put into an array of arguments. Then I want to try to keep all the arguments in an array.</p>\n\n<p>This is similar to how the C executables take arguments in bash shell.</p>\n\n<p>EX: </p>\n\n<pre><code>mypersonalshell&gt; first second \"Hello World\" fourth\nresults: [first, second, Hello World, fourth]\n\nmypersonalshell&gt; first second 'Hello World' fourth\nresults: [first, second, Hello World, fourth]\n\nmypersonalshell&gt; first \"Hello ' World\"\nresults: [first, Hello ' World]\n</code></pre>\n\n<p>I am assuming to use a combination of strtok on spaces and quotes but unsuccessful in using that combination properly.</p>\n\n<p>What I have so far</p>\n\n<pre><code>int main(int argc, char* argv[]){\n    int cmdNum = 1;\n    char *input = NULL;\n    size_t len = 0;\n    ssize_t nread;\n    printf(\"mypersonalshell[%d]&gt; \",cmdNum);\n    while((nread = getline(&amp;input, &amp;len, stdin)) != -1){\n        trim(input);\n        if ( strcmp(input, \"\") == 0){\n            continue;\n        }\n        char *inputArgs[10];\n        char *token;\n        token = strtok(input, \" \");\n        while(token != NULL){\n            // add to string array and parse here\n            token = strtok(NULL, s);\n        }\n        printf(\"mypersonalshell[%d]&gt; \",++cmdNum);\n    }\n    free(input);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c", "pointers", "static"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555484131, "post_id": 55719929, "comment_id": 98122582, "body": "There&#39;s nothing stopping you from it, but passing around pointers to static members does however almost certainly mean that your program design is bad."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555486346, "post_id": 55719929, "comment_id": 98123613, "body": "Usually I would agree with you, but in this case it&#39;s about making an exception to the rule. This is for an input buffer for an external device, which I pass to the host&#39;s usart. I could just as easily put this one member as a standalone array and it would mean doing basically the exact same thing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555486776, "post_id": 55719929, "comment_id": 98123865, "body": "Starting to sound like more than just bad design. Why doesn&#39;t the UART handle its own buffer? How do you solve re-entrancy if the UART driver doesn&#39;t &quot;own&quot; the memory?"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555487053, "post_id": 55719929, "comment_id": 98124008, "body": "It has the pointer to the memory and this isn&#39;t an interrupt driven design."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555487104, "post_id": 55719929, "comment_id": 98124037, "body": "If you&#39;re interested to know more, I&#39;ll tag you when I release the design manifesto next week :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555487270, "post_id": 55719929, "comment_id": 98124107, "body": "Ok but then you have a tight coupling between the UART protocol pace and the real-time performance of your program. That&#39;s ok if you have a real-time spec for how slow the background program is allowed to be."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555487725, "post_id": 55719929, "comment_id": 98124326, "body": "How would one go about decoupling that? I figured that the UART will take as long as it does and then return."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555487818, "post_id": 55719929, "comment_id": 98124394, "body": "By using interrupts/DMA :) Otherwise if you only use polling, you have to do so frequently enough to never get an overrun of the UART rx buffer. Unless you are fine with losing packages, just discard the lost one."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1555488106, "post_id": 55719929, "comment_id": 98124585, "body": "Yeh so in this design there is an interface function that loops through a set number of iterations, each iteration calling the actual read/write uart fn, which writes once and then returns. I don&#39;t know how to send a message but I would love to have your input on this design. Like I said, I&#39;m gonna open the whole thing up with some examples. It&#39;s mainly about decoupling HALs using a middleware of generic callback functions :) it&#39;s mainly aimed at RTOS dev."}], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1555476257, "post_id": 55720010, "comment_id": 98119852, "body": "Yeh I figured as much re:knowledge about RAM, but thanks for clarifying that about linkage. Also: this is huge news, thank you so much. :)"}], "tags": [], "owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "is_accepted": true, "score": 3, "last_activity_date": 1555476074, "creation_date": 1555476074, "answer_id": 55720010, "question_id": 55719929, "link": "https://stackoverflow.com/questions/55719929/embedded-c-can-i-pass-members-of-a-static-struct-to-function-in-another-file-i/55720010#55720010", "title": "Embedded C: Can I pass members of a static struct to function in another file, IF a pointer to the member is passed by a fn in the same file", "body": "<p>C by itself doesn't know anything about restricted space in RAM. If you hide a variable as static it only won't get external linkage. That means it won't have a symbol outside of its compilation unit that you can reference to but it will have a regular address in the RAM or ROM (if you architecture supports that and the variable is constant) and that address is accessible for everybody. </p>\n\n<p>Or in short: You can pass pointers to static variables in the same way as you can pass pointer to other variables or locations in RAM.</p>\n"}], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 55720010, "answer_count": 1, "score": 1, "last_activity_date": 1555481337, "creation_date": 1555475487, "last_edit_date": 1555481337, "question_id": 55719929, "link": "https://stackoverflow.com/questions/55719929/embedded-c-can-i-pass-members-of-a-static-struct-to-function-in-another-file-i", "title": "Embedded C: Can I pass members of a static struct to function in another file, IF a pointer to the member is passed by a fn in the same file", "body": "<p>I have a struct like this:</p>\n\n<pre><code>typedef struct {\n\n   uint8_t var_1;\n   uint8_t var_2;\n\n}TYPE_struct_variables;\n\nstatic TYPE_struct_variables variables;\n</code></pre>\n\n<p>For argument sake, I want to pass one of the members in this struct down another layer towards the metal. For this example, this is a data struct for an external device and I want to pass the member '<code>variables-&gt;var_1</code>' / '<code>variables.var_1</code>' to the usart interface of a host micro-controller. HOWEVER, I still want to restrict access to this struct for all functions outside this file. Would it work to send a pointer to this member if that pointer was sent by a fn in the same file as the struct? </p>\n\n<p>Or would the program crash upon realizing it's a pointer inside a 'restricted' space?</p>\n"}, {"tags": ["c", "pthreads", "system-calls"], "comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 1, "creation_date": 1555472826, "post_id": 55719548, "comment_id": 98119062, "body": "Why are you using <code>open()</code> and <code>read()</code> and not <code>fopen()</code> and <code>fgets()</code> ?  (<code>fgets()</code> will read line-by-line)."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1555472888, "post_id": 55719548, "comment_id": 98119076, "body": "1. I am not familiar with the other functions. 2. The assignment requires that."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1555473651, "post_id": 55719548, "comment_id": 98119231, "body": "In that case, you have to buffer in the input, and after each read, process any &quot;lines&quot; found in the input.  What ever remains after this is the first-part of the next (yet incomplete) line."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1555477878, "post_id": 55719548, "comment_id": 98120343, "body": "&quot;<i>no line&#39;s length can exceed SBUFSIZE bytes</i>&quot; or has exactly that size?"}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1555478099, "post_id": 55719548, "comment_id": 98120406, "body": "@alk It can be less that SBUFSIZE bytes (and it often is), but SBUFSIZE is the maximum number. The lines have different lengths."}], "answers": [{"tags": [], "owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "is_accepted": false, "score": 2, "last_activity_date": 1555473911, "creation_date": 1555473911, "answer_id": 55719702, "question_id": 55719548, "link": "https://stackoverflow.com/questions/55719548/reading-in-file-line-by-line-read-grabs-whole-file/55719702#55719702", "title": "Reading in file line by line, read() grabs whole file", "body": "<p>You can process line-by-line as follows:</p>\n\n<pre><code>char buf[SBUFSIZE + 1];\nsize_t bufsize = 0;\n\nfor(;;)\n{\n    ssize_t nread = read(input_fd, buf + bufsize, SBUFSIZE - bufsize);\n    if(nread &lt; 0)\n        perror(\"read failed\");\n\n    bufsize += nread;\n    if(!bufsize)\n        break; // end of file\n\n    const char *eol = memchr(buf, '\\n', bufsize);\n    if(!eol)\n        eol = buf + bufsize++;\n    *eol = 0;\n\n    printf(\"processing line: |%s|\\n\", buf);\n    process_line(buf);\n\n    ++eol;\n    bufsize -= eol - buf;\n    memmove(buf, eol, bufsize);\n}\n</code></pre>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555473911, "creation_date": 1555472619, "question_id": 55719548, "link": "https://stackoverflow.com/questions/55719548/reading-in-file-line-by-line-read-grabs-whole-file", "title": "Reading in file line by line, read() grabs whole file", "body": "<p>I'm having trouble reading in a file line by line. Apparently the <code>read()</code> system call grabs the whole file. I'm trying to read in a file with lines of variable length, however I do know that no line's length can exceed <code>SBUFSIZE</code> bytes. I'm supposed to read in each line in the file and put each line of the file onto a data structure. However my approach pushes the whole file as one line onto the data structure, which is not acceptable. Is there a modified version of <code>read()</code> which stops at the <code>'\\n'</code> character?</p>\n\n<pre><code>#define SBUFSIZE 1025\n\npthread_mutex_t buffer_lock;\n\nvoid* process_file(void* file_name)\n{\n    int input_fd;\n    /* Temporary buffer, for reading in the files, one line at a time. */\n    char buf[SBUFSIZE];\n    memset(buf, '\\0', SBUFSIZE);\n\n    if ((input_fd = open((char*) file_name, O_RDONLY)) == -1) {\n        fprintf(stderr, \"Cannot open the file '%s'\\n\", (char*) file_name);\n        pthread_exit((void*) 1);  /* This is my error flag. */\n    }\n\n    while (read(input_fd, buf, SBUFSIZE)) {\n        int ret;\n        printf(\"|%s|\\n\", buf);\n        while (true) {\n            pthread_mutex_lock(&amp;buffer_lock);\n            ret = stack_push(buf);\n            if (ret == STACK_FULL) {\n                pthread_mutex_unlock(&amp;buffer_lock);\n                usleep(rand() % 101);\n            } else {\n                break;\n            }\n        }\n        pthread_mutex_unlock(&amp;buffer_lock);\n        memset(buf, '\\0', SBUFSIZE);\n\n        if (ret != STACK_SUCCESS) {\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    close(input_fd);\n    pthread_exit((void*) 0);  /* This is my good flag. */\n}\n\n</code></pre>\n"}, {"tags": ["c", "u-boot"], "comments": [{"owner": {"reputation": 1973, "user_id": 7721600, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WsGqD.jpg?s=128&g=1", "display_name": "Moritz Schmidt", "link": "https://stackoverflow.com/users/7721600/moritz-schmidt"}, "edited": false, "score": 1, "creation_date": 1555468006, "post_id": 55719002, "comment_id": 98118153, "body": "<a href=\"https://stackoverflow.com/questions/351134/how-to-get-functions-name-from-functions-pointer-in-c\" title=\"how to get functions name from functions pointer in c\">stackoverflow.com/questions/351134/&hellip;</a> probably?"}, {"owner": {"reputation": 1037, "user_id": 3693586, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7d0b965f5de3f6f49f5c37b078be22d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3693586", "link": "https://stackoverflow.com/users/3693586/user3693586"}, "reply_to_user": {"reputation": 1973, "user_id": 7721600, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WsGqD.jpg?s=128&g=1", "display_name": "Moritz Schmidt", "link": "https://stackoverflow.com/users/7721600/moritz-schmidt"}, "edited": false, "score": 0, "creation_date": 1555469458, "post_id": 55719002, "comment_id": 98118409, "body": "In U-boot we will not be having /proc/, backtrace() also not available in U-boot."}, {"owner": {"reputation": 300, "user_id": 8800091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230f0c9c6f2224071a4c4dc45bd1087f?s=128&d=identicon&r=PG&f=1", "display_name": "andi8086", "link": "https://stackoverflow.com/users/8800091/andi8086"}, "edited": false, "score": 0, "creation_date": 1555507565, "post_id": 55719002, "comment_id": 98136179, "body": "Subtract the load address and then look up the symbol table of the compiled binary"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555617005, "post_id": 55719002, "comment_id": 98182197, "body": "regarding the example output: &quot;initcall: 80809c05&quot; This is NOT the output from the posted code, because the call to <code>printf()</code> has a &#39;S&#39; after the address."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555617063, "post_id": 55719002, "comment_id": 98182216, "body": "The output format specifier is expecting a <code>void*</code>, not a <code>char*</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555617452, "post_id": 55719002, "comment_id": 98182363, "body": "regarding: <code>printf(&quot;initcall: %pS \\n&quot;, (char *)*init_fnc_ptr - reloc_ofs);</code>  why not simply use: <code>printf(&quot;initcall: %s\\n&quot;, &quot;init_fnc_ptr&quot;);</code> or, more generic: <code>printf(&quot;initcall: %s \\n&quot;, __func__);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 3670607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0ac3a4aac38bc184c7b6c1e45e98e1?s=128&d=identicon&r=PG", "display_name": "Xypron", "link": "https://stackoverflow.com/users/3670607/xypron"}, "is_accepted": false, "score": 0, "last_activity_date": 1555521922, "creation_date": 1555521922, "answer_id": 55733035, "question_id": 55719002, "link": "https://stackoverflow.com/questions/55719002/getting-caller-function-name-from-the-function-address/55733035#55733035", "title": "Getting caller function name from the function address", "body": "<p>When building U-Boot a file u-boot.map is written. You can look up the the addresses of the functions (before relocation) there.</p>\n"}], "owner": {"reputation": 1037, "user_id": 3693586, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7d0b965f5de3f6f49f5c37b078be22d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3693586", "link": "https://stackoverflow.com/users/3693586/user3693586"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555521922, "creation_date": 1555467615, "question_id": 55719002, "link": "https://stackoverflow.com/questions/55719002/getting-caller-function-name-from-the-function-address", "title": "Getting caller function name from the function address", "body": "<p>I have printed the address of the function in U-boot by adding the following print.</p>\n\n<pre><code>  printf(\"initcall: %pS \\n\", (char *)*init_fnc_ptr - reloc_ofs);\n</code></pre>\n\n<p>Following line printed by adding debug prints. Is there anyway to know the function name from the function address.</p>\n\n<pre><code>  initcall: 80809c05\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1555466721, "post_id": 55718881, "comment_id": 98117898, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> must include the code as <i>text</i>, in the <i>body</i> of the question. Please edit it in and remove the links to outside resources."}, {"owner": {"reputation": 35, "user_id": 3267410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mFQNe.jpg?s=128&g=1", "display_name": "Yossiri", "link": "https://stackoverflow.com/users/3267410/yossiri"}, "edited": false, "score": 0, "creation_date": 1555466791, "post_id": 55718881, "comment_id": 98117915, "body": "Sorry, I am trying to add image."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1555466958, "post_id": 55718881, "comment_id": 98117947, "body": "You cannot post code in an image. See <a href=\"https://meta.stackoverflow.com/a/285557/62576\">this Meta post</a> for a list of the many reasons why.  Code is text, and should be copied and pasted directly into your question as such."}, {"owner": {"reputation": 35, "user_id": 3267410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mFQNe.jpg?s=128&g=1", "display_name": "Yossiri", "link": "https://stackoverflow.com/users/3267410/yossiri"}, "edited": false, "score": 0, "creation_date": 1555467070, "post_id": 55718881, "comment_id": 98117965, "body": "Sorry I am trying to add code."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1555482759, "post_id": 55718881, "comment_id": 98122012, "body": "I suspect a strange line wrapping in the output window. Can you scroll a bit to the right? Maybe there is a stray digit after the tab."}, {"owner": {"reputation": 35, "user_id": 3267410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mFQNe.jpg?s=128&g=1", "display_name": "Yossiri", "link": "https://stackoverflow.com/users/3267410/yossiri"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1555518728, "post_id": 55718881, "comment_id": 98143086, "body": "@Gerhardh You are right. I found them there at the right corner. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "reply_to_user": {"reputation": 35, "user_id": 3267410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mFQNe.jpg?s=128&g=1", "display_name": "Yossiri", "link": "https://stackoverflow.com/users/3267410/yossiri"}, "edited": false, "score": 0, "creation_date": 1555467432, "post_id": 55718945, "comment_id": 98118041, "body": "@Yossiri you are welcome! If you need help feel free to ask. If this solved your issue it would be appreciated if you can approve this answer on the left side with the grey tick and clicking on it. Enjoy coding !"}], "tags": [], "owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "is_accepted": false, "score": 2, "last_activity_date": 1555467160, "creation_date": 1555467160, "answer_id": 55718945, "question_id": 55718881, "link": "https://stackoverflow.com/questions/55718881/why-does-the-result-of-printf-number-change-when-include-tab/55718945#55718945", "title": "Why does the result of printf number change when include tab?", "body": "<p>It is printing correctly, but because of the online compiler cutting off the first digit (for some reason) you are unable to see it. If you click the 3rd button above the output screen (which will copy the output) and paste it into notepad you will see that your output is correct.</p>\n"}, {"tags": [], "owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "is_accepted": true, "score": 1, "last_activity_date": 1555467581, "creation_date": 1555467581, "answer_id": 55718994, "question_id": 55718881, "link": "https://stackoverflow.com/questions/55718881/why-does-the-result-of-printf-number-change-when-include-tab/55718994#55718994", "title": "Why does the result of printf number change when include tab?", "body": "<p>Indeed. It is the out steam that cuts off the first character of the next line</p>\n"}], "owner": {"reputation": 35, "user_id": 3267410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mFQNe.jpg?s=128&g=1", "display_name": "Yossiri", "link": "https://stackoverflow.com/users/3267410/yossiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1556524385, "accepted_answer_id": 55718994, "answer_count": 2, "score": -3, "last_activity_date": 1555467581, "creation_date": 1555466617, "last_edit_date": 1555467528, "question_id": 55718881, "link": "https://stackoverflow.com/questions/55718881/why-does-the-result-of-printf-number-change-when-include-tab", "closed_reason": "Not suitable for this site", "title": "Why does the result of printf number change when include tab?", "body": "<p>The below code show wrong result for 44 and 84.</p>\n\n<p><a href=\"https://i.stack.imgur.com/i8cBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i8cBa.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, I tried to change \\t into space and the numbers were shown correctly as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K4Q1o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4Q1o.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why just having tab in printf cause the number to be print incorrectly?\nI have tried to change 4 into 7 and 8 and the same problem occurred.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    for (int count = 1; count &lt;= 100 ; ++count)\n    {\n        if((count % 4) == 0 )\n            printf(\"%d\\t\", count);\n    }\n\n    return 0;\n}\n\n\n</code></pre>\n\n<p>and </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    for (int count = 1; count &lt;= 100 ; ++count)\n    {\n        if((count % 4) == 0 )\n            printf(\"%d \", count);\n    }\n\n    return 0;\n}\n\n\n</code></pre>\n"}, {"tags": ["c", "linux", "windows", "cuda", "inline-assembly"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1555465391, "post_id": 55718729, "comment_id": 98117617, "body": "why not just install the CUDA toolchain on windows? It is the only supported method, and it is integrated into MSVC/Visual Studio"}, {"owner": {"reputation": 11, "user_id": 11371337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6ca2f74e24eeb3c10c30dd6f9179f?s=128&d=identicon&r=PG&f=1", "display_name": "user11371337", "link": "https://stackoverflow.com/users/11371337/user11371337"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1555466441, "post_id": 55718729, "comment_id": 98117831, "body": "I have a CUDA toolchain on Windows with MSVC. Problem is - MSVC does not recognize inline asm (like examples above) - so I either have to rewrite it in MSVC-recognizable syntax (which I have no clue how to do) or compile kernels to PTX in Linux and then somehow link this PTX to rest of the code on Windows..."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555469065, "post_id": 55718729, "comment_id": 98118335, "body": "Sounds to me like you&#39;re trying to compile CUDA source code with MSVC which obviously won&#39;t work. You have to compile your CUDA sources with nvcc or some other compiler that supports CUDA (clang would be the only alternative I&#39;m currently aware of). As far as I know, g++ does currently not support CUDA either by the way, it&#39;s unclear to me how that is supposed to work on Linux as you claim\u2026"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 2, "creation_date": 1555469442, "post_id": 55718729, "comment_id": 98118403, "body": "I guess what&#39;s needed here is a clear description of how exactly you&#39;re currently trying to build your code\u2026"}, {"owner": {"reputation": 11, "user_id": 11371337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6ca2f74e24eeb3c10c30dd6f9179f?s=128&d=identicon&r=PG&f=1", "display_name": "user11371337", "link": "https://stackoverflow.com/users/11371337/user11371337"}, "edited": false, "score": 0, "creation_date": 1555476605, "post_id": 55718729, "comment_id": 98119947, "body": "when I say MSVC or g++ I, of course, mean nvcc with MSVC or g++ backend    (nvcc is not really a standalone compiler, it relies on backend compilers)"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 1, "creation_date": 1555484757, "post_id": 55718729, "comment_id": 98122836, "body": "I use cuda&#39;s asm with visual studio all the time.  If this isn&#39;t working for you, I&#39;m guessing you haven&#39;t got your build environment set up correctly.  Can you tell us more about your project?  Is this in a .cu file?  When you build, do you see the <code>nvcc</code> command being executed?  Is the &quot;error&quot; an actual build error?  Or just an intellisense error?"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1555490859, "post_id": 55718729, "comment_id": 98126108, "body": "Your problem description makes no sense. CUDA inline assembler on device code never gets anywhere near the host compiler unless you do something like put it in a <code>__host__ __device__</code>  function and that should fail on every platform. Can you provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> rather than a lot of hand waving?"}, {"owner": {"reputation": 11, "user_id": 11371337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6ca2f74e24eeb3c10c30dd6f9179f?s=128&d=identicon&r=PG&f=1", "display_name": "user11371337", "link": "https://stackoverflow.com/users/11371337/user11371337"}, "edited": false, "score": 0, "creation_date": 1555494384, "post_id": 55718729, "comment_id": 98128142, "body": "OK, thanks to everybody and sorry for my silly explanations, turns out these assembly instructions relied on right preprocessing, and it somehow worked on Linux but gave &quot;expected an asm string&quot; on Windows, for example for instructions above it used this define   <code>#define q2_s              &quot;0xAF48A03B&quot;</code> . So I just hardcoded these hex values in asm strings and everything compiled well on Windows."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1555497199, "post_id": 55718729, "comment_id": 98129821, "body": "@user11371337: Please add your diagnosis of the problem and solution as a short answer to this question for future visitors"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11371337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6ca2f74e24eeb3c10c30dd6f9179f?s=128&d=identicon&r=PG&f=1", "display_name": "user11371337", "link": "https://stackoverflow.com/users/11371337/user11371337"}, "is_accepted": false, "score": 1, "last_activity_date": 1555563367, "creation_date": 1555563367, "answer_id": 55739372, "question_id": 55718729, "link": "https://stackoverflow.com/questions/55718729/translation-of-cuda-inline-asm-from-gas-to-intel/55739372#55739372", "title": "Translation of CUDA inline asm from GAS to Intel", "body": "<p>Turns out, problem was not with inline asm, but with preprocessing, e.g. for example, asm string</p>\n\n<pre><code>asm volatile (\"subc.cc.u32 %0, %0, \"q2_s\";\": \"+r\"(c[2]));\n</code></pre>\n\n<p>relied on this define</p>\n\n<pre><code>#define q2_s \"0xAF48A03B\"\n</code></pre>\n\n<p>On Linux it compiled without errors, but on Windows gave \"expected an asm string\" error.\nSo, workaround for Windows was just to hardcode hex values in asm strings, and it has nothing to do with assembly syntax, sorry for misguiding.</p>\n"}], "owner": {"reputation": 11, "user_id": 11371337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6ca2f74e24eeb3c10c30dd6f9179f?s=128&d=identicon&r=PG&f=1", "display_name": "user11371337", "link": "https://stackoverflow.com/users/11371337/user11371337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1555563367, "creation_date": 1555465202, "last_edit_date": 1555471450, "question_id": 55718729, "link": "https://stackoverflow.com/questions/55718729/translation-of-cuda-inline-asm-from-gas-to-intel", "title": "Translation of CUDA inline asm from GAS to Intel", "body": "<p>I have some C-CUDA code that contains <a href=\"https://docs.nvidia.com/cuda/inline-ptx-assembly/index.html\" rel=\"nofollow noreferrer\">inline PTX assembly</a>, which compiles OK on Linux with g++ backend.</p>\n\n<p>I need to build it under Windows, and clearly MSVC backend does not recognize inline asm properly - gives errors like \"not an asm string\". I assume it has to do with syntax this PTX assembly is written, for example: </p>\n\n<pre><code>    asm volatile (\"subc.cc.u32 %0, %0, \"q2_s\";\": \"+r\"(c[2]));\n    asm volatile (\"subc.cc.u32 %0, %0, \"q3_s\";\": \"+r\"(c[3]));\n</code></pre>\n\n<p>I don't know much about assembly, and am wondering - is there some translator from GAS(at&amp;t) style to Intel syntax?</p>\n\n<p>Or is there some workaround to build CUDA kernels to PTX on Linux, and then build PTX &amp; link to remaining code on Windows?\nI've tried that, but PTX compiler on linux gives kernel functions some unrecognizable _Z-starting names and linker does not know how to link the stuff.</p>\n"}, {"tags": ["c", "algorithm", "2d", "intersection", "aabb"], "comments": [{"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 2, "creation_date": 1555467561, "post_id": 55718695, "comment_id": 98118077, "body": "I would first test whether the AABB of the triangle intersects the other AABB: this is very easy to do, and if the answer is &quot;no&quot;, you have no further work to do.  If the answer is &quot;yes&quot;, you will need a more accurate test.  I would test the 3 triangle lines for intersection with the 4 lines x=0, x=1, y=0 and y=1, stopping at the first hit.  If you have the parametric equations of the lines for the 3 triangle sides (e.g. x = x1*(1-t) + x2*t, etc.) this is very easy to do -- just apply the constraint (e.g. x=1), solve for t and see if it&#39;s in the range [0, 1]."}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 1, "creation_date": 1555523207, "post_id": 55718695, "comment_id": 98145187, "body": "Whoops, forgot a couple of important cases: The AABB could completely contain the triangle, or vice versa.  Testing the former is easy: just see if each triangle vertex is in the unit square. For the latter, it&#39;s enough to pick a single vertex of the AABB (e.g. (0, 0)) and test whether it&#39;s inside the triangle; one way is by computing, for each triangle vertex, the cross product of the vector from there to the next triangle vertex and the vector from there to the point. Only the signs of the 3rd components of these cross products are needed: iff they are all the same, the point is inside."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 0, "creation_date": 1555524537, "post_id": 55718695, "comment_id": 98145776, "body": "@j_random_hacker Good point. My algorithm covers the case where the triangle is inside the AABB but I&#39;m not absolutely sure if it covers all cases where the triangle contains the whole AABB..."}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "reply_to_user": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 0, "creation_date": 1555547085, "post_id": 55718695, "comment_id": 98152924, "body": "@j_random_hacker:  As I only test collisions between a rectangle and a triangle =&gt;got from the quadtree&lt;= I already know that the aabbs intersect. If there was no intersection, I wouldn&#39;t have this triangle to check.  Your solution is the generic solution I was talking about. Even if it may work, it&#39;s a pretty generic and bruteforce approach.   It&#39;s not what I am looking for, as explained in the first post. Still : thanks for the answer, it may help someone else.  Today, I started to work on an other solution (which I explain below)."}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 0, "creation_date": 1555589343, "post_id": 55718695, "comment_id": 98168193, "body": "It&#39;s best to state things you already know, like that the triangle&#39;s AABB and the given AABB intersect, in the question.  I expect this generic approach will be faster than jdehesa&#39;s approach, but I think the main drag is the line segment intersection tests, which AFAICS any method needs to fall back in the worst case.  Will be interesting to see which is actually faster."}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555720837, "post_id": 55718695, "comment_id": 98212358, "body": "Honestly I can&#39;t say because I haven&#39;t tested yet. Programming the doom engine is a work with a lot of &quot;todos&quot; that keeps adding. Yesterday I did the sky (which is NOT a skybox, as the sky can hide stuff. In doom the sky is just a wall/floor/ceiling with sky painted on it with some effect to give the illusion it&#39;s far etc. You can hide stuff behind a wall ? Then you can hide stuff behind the sky).  Even the first map hides things behind the sky (you have screens here) <a href=\"https://hub.jmonkeyengine.org/t/portal-effect-with-depth-buffer/36398\" rel=\"nofollow noreferrer\">hub.jmonkeyengine.org/t/portal-effect-with-depth-buffer/3639&zwnj;&#8203;8</a> (old projet, in java and only for the rendering)"}], "answers": [{"comments": [{"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 1, "creation_date": 1555525720, "post_id": 55728825, "comment_id": 98146284, "body": "For speed, you could encode the answer for each possible input to <code>regions_intersect_3()</code> using 2 bits each in a 128-byte constant array. Then that function becomes <code>return ((answer[(r1|r2|r3)&gt;&gt;2] &gt;&gt; (((r1|r2|r3) &amp; 3) &lt;&lt; 1)) &amp; 3) - 1;</code>. This would also make <code>regions_intersect_2()</code> unnecessary.   (I fixed a bug!)"}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555548466, "post_id": 55728825, "comment_id": 98153195, "body": "Ok, the size for comments is very very short here.  So : thanks I&#39;ll try your code. I already started to work on an other solution.  Comment from my code for this &quot;other solution&quot; is here:  <a href=\"https://pastebin.com/3RuSsbdf\" rel=\"nofollow noreferrer\">pastebin.com/3RuSsbdf</a>  I am not sure it will work but I will be able to:  1) detect a thing is against a wall 2) have the linedef to adjust its movement.  But I&#39;ll keep and test your code and mark it as better answer if it is working. Not before tomorrow evening (still at roughly the same hour)  Thanks a lot !"}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 0, "creation_date": 1555587405, "post_id": 55728825, "comment_id": 98167113, "body": "@j_random_hacker Cool idea! I don&#39;t have now the time to work out that array, but yea that would make things simpler and faster."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 1, "creation_date": 1555587450, "post_id": 55728825, "comment_id": 98167135, "body": "@Bubuche Thanks for your comments. Note you can post and accept an asnwer to your own question if you do reach to a satisfying solution."}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555638991, "post_id": 55728825, "comment_id": 98187410, "body": "I validated your answer. Note that it could be improved to fit the original request (for example, when you find the Regions, you could avoid passing the AABB, as it&#39;s supposed to be a 1*1 box starting at (0,0).  Plus, side note:  1/ The action we have are either &quot;reject&quot; (no intersection), &quot;accept&quot; (intersection) or &quot;do a segment test&quot;.   2/ These actions, paradoxally, does not require regions (they are only use to detect the situation)  3/ So =&gt; It would be possible to have ONE switch.  4/ But this switch will have a lot of cases so :   (message in two part, sorry, limitation)"}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555639854, "post_id": 55728825, "comment_id": 98187526, "body": "It would be &quot;unordered sampling with replacement&quot; with 9 element (top-left etc.) and 3 sampling.  BUT : there are equivalent cases. For example &quot;top-left, right, bottom-left&quot; is equivalent to &quot;top-left, bottom, top-right&quot;. How hard would it be to merge these cases ?  For example, if we store each corner on an even index, and each middle on an odd index, by doing &quot;&gt;&gt; 2&quot; we are just rotating the square.  With the rule &quot;at most one trailing 0&quot; and with the function __builtin_ctz (counting trailing zeros) or equivalent, the number of cases in the switch could drop dramatically. I don&#39;t know."}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "reply_to_user": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555677628, "post_id": 55728825, "comment_id": 98198523, "body": "@Bubuche: That entire function can be replaced with the 9-operation branch-free array lookup in my comment.  All you need to do is determine what the array should contain, which you can do by running the current version of the function over all 512 possible inputs once beforehand."}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555720371, "post_id": 55728825, "comment_id": 98212289, "body": "switch are also optimized by the compiler. It can use binary search (&quot;if ( v &gt; 5 ) jumpto blabla&quot; and at blabla : &quot;if ( v &gt; 7 ) jump to blibli&quot; etc) But it can also use jump tables, or even arithmetic (&quot;jumpto value * 3&quot; if cases are all separated with break and values are continuous etc).   If we are talking about generating stuffs, generating the switch instead of the array would lead to better results."}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 0, "creation_date": 1555814364, "post_id": 55728825, "comment_id": 98230322, "body": "If you&#39;re talking about a 512-case switch statement, probably the optimal way for the compiler to implement that is using the table I described (it&#39;s basically the same as your &quot;jump to value * 3&quot;, but there&#39;s no need to run more code at some jump target, because we already have the answer).  Binary search will almost certainly be slower because of hard-to-predict conditional branches."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1555872645, "post_id": 55728825, "comment_id": 98242066, "body": "So as I see it, <code>r1|r2|r3</code> may have one, two or three in nine bits set, which I think amounts to 129 possible combinations, so a 129-branch switch? (I suppose you can skip some with <code>default</code>). However, the biggest posible value would be <code>0b111000000</code>, that is 448, so you would need an array of 449. I think I&#39;d still go with the array, neither is great to maintain but I feel more comfortable with a &quot;magic string of numbers&quot; than with a &quot;magic switch-case statement&quot;. In any case thank you both for the comments."}, {"owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555893188, "post_id": 55728825, "comment_id": 98246121, "body": "The biggest value is actually:  0b100000000  Because all the three points can&#39;t be on the same location. And you don&#39;t have 448 values. At all. For example, you don&#39;t have the value   0b111100000  Because it has 4 &quot;1&quot;.  It&#39;s why I walk talking about &quot;unordered sampling with replacement&quot;. =&gt; &quot;I have 9 tokens, with numbers from 1 to 9. Three times, I pick a token, note its number, then put it back. How many combinations&quot;.  (I don&#39;t know, way too far away ^^)"}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "reply_to_user": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "edited": false, "score": 0, "creation_date": 1555946346, "post_id": 55728825, "comment_id": 98262383, "body": "@Bubuche: The biggest value is not 0b100000000, because for example 0b110100000 is also valid and bigger than that.  And you have misunderstood what jdehesa meant about 448.  He didn&#39;t say there are 448 values; he said you would need an array of size 449 in order to use my single-array-lookup trick.  (A slightly smaller array would suffice since no triangle with bitmap 0b111000000 could intersect a rectangle.)  The number of combinations -- the number you couldn&#39;t be bothered calculating -- is the number he already stated in his comment, 129."}, {"owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "edited": false, "score": 1, "creation_date": 1555946753, "post_id": 55728825, "comment_id": 98262565, "body": "@jdehesa: You&#39;re right, not all 512 bit patterns are possible, and you only need a case statement for those that are.  The switch statement could be faster, but my money&#39;s definitely on the array!  Either way, I would definitely <i>generate</i> the source code (array declaration or switch statement), using your existing code to calculate the correct answer for each of the 129 cases."}], "tags": [], "owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "is_accepted": true, "score": 1, "last_activity_date": 1555510832, "last_edit_date": 1555510832, "creation_date": 1555508139, "answer_id": 55728825, "question_id": 55718695, "link": "https://stackoverflow.com/questions/55718695/in-2d-how-to-find-if-a-triangle-and-an-aabb-intersect/55728825#55728825", "title": "In 2D, how to find if a triangle and an AABB intersect", "body": "<p>Here is my attempt. In principle you can always test for segment intersections, but if you want to save floating point operations, there are cases where you can take a shortcut. An AABB divides the plane in nine regions (top-left, top, top-right, left, inside, right, bottom-left, bottom and bottom-right). If you just look at the regions in which the points of the triangle fall, you may be able to determine that an intersection must or cannot take place. There are some cases which cannot be decided on this basis, though, and falling back to geometrical intersection is necessary. Here is my code, which I <em>think</em> is correct (as in, all the region-based tests are well defined), although I didn't test thoroughly. It is rather long, but most of it is bitwise operations so it should actually be quite fast. The entry point is the function <code>intersects</code>, and there is an example in the main function.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\n#define EPSILON 1e-6\n\ntypedef struct AABB {\n    float x0, y0, x1, y1;\n} AABB;\n\ntypedef struct Point {\n    float x, y, z;\n} Point;\n\ntypedef struct Triangle {\n    Point p1, p2, p3;\n} Triangle;\n\n// Naming assumes (0, 0) is top-left corner\ntypedef enum Region {\n    TOP_LEFT     = 1 &lt;&lt; 0,\n    TOP          = 1 &lt;&lt; 1,\n    TOP_RIGHT    = 1 &lt;&lt; 2,\n    LEFT         = 1 &lt;&lt; 3,\n    INSIDE       = 1 &lt;&lt; 4,\n    RIGHT        = 1 &lt;&lt; 5,\n    BOTTOM_LEFT  = 1 &lt;&lt; 6,\n    BOTTOM       = 1 &lt;&lt; 7,\n    BOTTOM_RIGHT = 1 &lt;&lt; 8\n} Region;\n\n// Find the region in which a point is with respect to the AABB\nRegion aabb_region(const AABB* aabb, const Point* point) {\n    if (point-&gt;x &lt; aabb-&gt;x0) {\n        if (point-&gt;y &lt; aabb-&gt;y0) {\n            return TOP_LEFT;\n        } else if (point-&gt;y &gt; aabb-&gt;y1) {\n            return BOTTOM_LEFT;\n        } else {\n            return LEFT;\n        }\n    } else if (point-&gt;x &gt; aabb-&gt;x1) {\n        if (point-&gt;y &lt; aabb-&gt;y0) {\n            return TOP_RIGHT;\n        } else if (point-&gt;y &gt; aabb-&gt;y1) {\n            return BOTTOM_RIGHT;\n        } else {\n            return RIGHT;\n        }\n    } else {\n        if (point-&gt;y &lt; aabb-&gt;y0) {\n            return TOP;\n        } else if (point-&gt;y &gt; aabb-&gt;y1) {\n            return BOTTOM;\n        } else {\n            return INSIDE;\n        }\n    }\n}\n\n// 1: There is intersection\n// 0: There may or may not be intersection\nint regions_intersect_2(Region r1, Region r2) {\n    if ((((r1 | r2) &amp; INSIDE) != 0) ||\n        ((r1 | r2) == (LEFT | RIGHT)) ||\n        ((r1 | r2) == (TOP | BOTTOM))) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\n// 1: There is intersection\n// 0: There may or may not be intersection\n// -1: There is no intersection\n// Does not check cases already covered by regions_intersect_2\nint regions_intersect_3(Region r1, Region r2, Region r3) {\n    Region r23 = r2 | r3;\n    switch (r1) {\n    case TOP_LEFT:\n        if (r23 == (BOTTOM | RIGHT) ||\n            r23 == (BOTTOM | TOP_RIGHT) ||\n            r23 == (RIGHT | BOTTOM_LEFT)) {\n            return 1;\n        } else if ((r23 &amp; (TOP_LEFT | LEFT | BOTTOM_LEFT)) == r23 ||\n                   (r23 &amp; (TOP_LEFT | TOP | TOP_RIGHT)) == r23) {\n            return -1;\n        }\n    case TOP:\n        if (r23 == (LEFT | BOTTOM_RIGHT) ||\n            r23 == (RIGHT | BOTTOM_LEFT)) {\n            return 1;\n        } else if ((r23 &amp; (TOP_LEFT | TOP | TOP_RIGHT)) == r23) {\n            return -1;\n        }\n    case TOP_RIGHT:\n        if (r23 == (BOTTOM | LEFT) ||\n            r23 == (BOTTOM | TOP_LEFT) ||\n            r23 == (LEFT | BOTTOM_RIGHT)) {\n            return 1;\n        } else if ((r23 &amp; (TOP_RIGHT | RIGHT | BOTTOM_RIGHT)) == r23 ||\n                   (r23 &amp; (TOP_RIGHT | TOP | TOP_LEFT)) == r23) {\n            return -1;\n        }\n    case LEFT:\n        if (r23 == (TOP | BOTTOM_RIGHT) ||\n            r23 == (BOTTOM | TOP_RIGHT)) {\n            return 1;\n        } else if ((r23 &amp; (TOP_LEFT | LEFT | BOTTOM_LEFT)) == r23) {\n            return -1;\n        }\n    case RIGHT:\n        if (r23 == (TOP | BOTTOM_LEFT) ||\n            r23 == (BOTTOM | TOP_LEFT)) {\n            return 1;\n        } else if ((r23 &amp; (TOP_RIGHT | RIGHT | BOTTOM_RIGHT)) == r23) {\n            return -1;\n        }\n    case BOTTOM_LEFT:\n        if (r23 == (TOP | RIGHT) ||\n            r23 == (TOP | BOTTOM_RIGHT) ||\n            r23 == (RIGHT | TOP_LEFT)) {\n            return 1;\n        } else if ((r23 &amp; (BOTTOM_LEFT | LEFT | TOP_LEFT)) == r23 ||\n                   (r23 &amp; (BOTTOM_LEFT | BOTTOM | BOTTOM_RIGHT)) == r23) {\n            return -1;\n        }\n    case BOTTOM:\n        if (r23 == (LEFT | TOP_RIGHT) ||\n            r23 == (RIGHT | TOP_LEFT)) {\n            return 1;\n        } else if ((r23 &amp; (BOTTOM_LEFT | BOTTOM | BOTTOM_RIGHT)) == r23) {\n            return -1;\n        }\n    case BOTTOM_RIGHT:\n        if (r23 == (TOP | LEFT) ||\n            r23 == (TOP | BOTTOM_LEFT) ||\n            r23 == (LEFT | TOP_RIGHT)) {\n            return 1;\n        } else if ((r23 &amp; (BOTTOM_RIGHT | RIGHT | TOP_RIGHT)) == r23 ||\n                   (r23 &amp; (BOTTOM_RIGHT | BOTTOM | BOTTOM_LEFT)) == r23) {\n            return -1;\n        }\n    default:\n        return 0;\n    }\n    return 0;\n}\n\n// Check if a segment intersects with the AABB\n// Does not check cases already covered by regions_intersect_2 or regions_intersect_3\nint segment_intersects(const AABB* aabb, const Point* p1, const Point* p2, Region r1, Region r2) {\n    // Skip if intersection is impossible\n    Region r12 = r1 | r2;\n    if ((r12 &amp; (TOP_LEFT | TOP | TOP_RIGHT)) == r12 ||\n        (r12 &amp; (BOTTOM_LEFT | BOTTOM | BOTTOM_RIGHT)) == r12 ||\n        (r12 &amp; (TOP_LEFT | LEFT | BOTTOM_LEFT)) == r12 ||\n        (r12 &amp; (TOP_RIGHT | RIGHT | BOTTOM_RIGHT)) == r12) {\n        return 0;\n    }\n    float dx = p2-&gt;x - p1-&gt;x;\n    float dy = p2-&gt;y - p1-&gt;y;\n    if (fabsf(dx) &lt; EPSILON || fabs(dy) &lt; EPSILON) {\n        // Vertical or horizontal line (or zero-sized vector)\n        // If there were intersection we would have already picked it up\n        return 0;\n    }\n    float t = (aabb-&gt;x0 - p1-&gt;x) / dx;\n    if (t &gt;= 0.f &amp;&amp; t &lt;= 1.f) {\n        return 1;\n    }\n    t = (aabb-&gt;x1 - p1-&gt;x) / dx;\n    if (t &gt;= 0.f &amp;&amp; t &lt;= 1.f) {\n        return 1;\n    }\n    t = (aabb-&gt;y0 - p1-&gt;y) / dy;\n    if (t &gt;= 0.f &amp;&amp; t &lt;= 1.f) {\n        return 1;\n    }\n    t = (aabb-&gt;y1 - p1-&gt;y) / dy;\n    if (t &gt;= 0.f &amp;&amp; t &lt;= 1.f) {\n        return 1;\n    }\n    return 0;\n}\n\nint intersects(const AABB* aabb, const Triangle* triangle) {\n    // Find plane regions for each point\n    Region r1 = aabb_region(aabb, &amp;triangle-&gt;p1);\n    Region r2 = aabb_region(aabb, &amp;triangle-&gt;p2);\n    Region r3 = aabb_region(aabb, &amp;triangle-&gt;p3);\n    // Check if any pair of regions implies intersection\n    if (regions_intersect_2(r1, r2) ||\n        regions_intersect_2(r1, r3) ||\n        regions_intersect_2(r2, r3)) {\n        return 1;\n    }\n    // Check if the three regions imply or forbid intersection\n    switch (regions_intersect_3(r1, r2, r3)) {\n    case 1:\n        return 1;\n    case -1:\n        return 0;\n    }\n    // Check segment intersections\n    if (segment_intersects(aabb, &amp;triangle-&gt;p1, &amp;triangle-&gt;p2, r1, r2)) {\n        return 1;\n    } else if (segment_intersects(aabb, &amp;triangle-&gt;p1, &amp;triangle-&gt;p3, r1, r3)) {\n        return 1;\n    } else if (segment_intersects(aabb, &amp;triangle-&gt;p2, &amp;triangle-&gt;p3, r2, r3)) {\n        return 1;\n    }\n    return 0;\n}\n\nint main(int argc, char* argv[]) {\n    AABB aabb = {\n        /* x0 = */ 2.f,\n        /* y0 = */ 1.f,\n        /* x1 = */ 5.f,\n        /* y1 = */ 6.f };\n    Triangle triangle = {\n        {1.f, 0.f}, {2.f, 2.f}, {2.f, -3.f}\n    };\n    int inter = intersects(&amp;aabb, &amp;triangle);\n    printf(\"Intersects: %s.\\n\", inter ? \"yes\" : \"no\");\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Intersects: yes.\n</code></pre>\n\n<p><a href=\"https://rextester.com/MOTPE58272\" rel=\"nofollow noreferrer\">See it in Rextester</a></p>\n"}], "owner": {"reputation": 33, "user_id": 11371277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219877459073311/picture?type=large", "display_name": "Bubuche", "link": "https://stackoverflow.com/users/11371277/bubuche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 1, "accepted_answer_id": 55728825, "answer_count": 1, "score": 2, "last_activity_date": 1555510832, "creation_date": 1555464933, "question_id": 55718695, "link": "https://stackoverflow.com/questions/55718695/in-2d-how-to-find-if-a-triangle-and-an-aabb-intersect", "title": "In 2D, how to find if a triangle and an AABB intersect", "body": "<p>I am coding a physic engine for a custom doom engine. </p>\n\n<p>I don't aim to replicate the exact behavior of the original doom.</p>\n\n<p>In doom, every \"thing\" (player, monsters etc) is an axis aligned bounding box. I want to keep that.</p>\n\n<p>I already have a working tesselation algorithm for the sectors.</p>\n\n<p>I already have a working quadtree, using AABB boxes of triangles of sectors.</p>\n\n<p>The quad tree will return a list of candidate for intersection with a given AABB (the player, for example).</p>\n\n<p>What I want : an algorithm to test if a triangle intersect an AABB in 2D.</p>\n\n<p>What I can do : split the AABB into two triangles, then do triangle-triangle intersection check.\nWhat I can do : use a \"triangle vs aabb\" algorithm working with 3D and set the \"z\" to 0.\nWhat I can do : </p>\n\n<p>1/ check if a point of the triangle is inside the AABB.</p>\n\n<p>2/ check if the center of the AABB is inside the triangle (the center is the better candidate to avoid rounding problems).</p>\n\n<p>3/ check if a line segment of the triangle intersects a segment of the AABB.</p>\n\n<p>I don't want to do that because : I think that given this precise situation, there should be a more optimized way to do it.\nIt is precisely something that the GPU has to face often : find if a triangle is inside the viewport. I think that question, more than any other question, has been solved to hell.</p>\n\n<p>Note that the situation can be even simpler : I can translate everything so the AABB start at (0,O). I can resize everything so the question becomes: \n\"how to determine if a triangle intersect [0,1][0,1]\".</p>\n\n<p>I already did some research but:</p>\n\n<p>1/ most results are for 3D stuff. </p>\n\n<p>2/ this is strangely enough a not often covered case. Even in the book \"game physics cookbook\" this question is not mentionned.</p>\n\n<p>3/ answers I found goes the hard, generic, way, with SAT (separation axis theorem) or equivalent stuff. </p>\n\n<p>I'll have to do this test for a lot of \"thing\" (player, monster) everyframe for every candidate triangle given by the quadtree. </p>\n\n<p>There is one last option I have, but I really don't know where to start or even if it's a good idea. Here is a quick summary of what I have in my minds.</p>\n\n<p>1/ as the gpu already has all these triangles.</p>\n\n<p>2/ as it's massively parallelizable.</p>\n\n<p>3/ as, passed the fixed cost, there'll be no additionnal cost.</p>\n\n<p>=> ask the gpu. </p>\n\n<p>But I don't know how to do that. The communication cpu/gpu will have a cost, but a fixed cost (it will roughly cost the same thing for 1 or 100.000 things). \nI prefer to avoid this solution (but as the website ask me to say the ideas I had, I am talking about it).</p>\n\n<p>Please note that this is my first message on this website. \nPlease note that english is not my native language.\nPlease note that, right now right here, it's 3:32 am (in the night).\nPlease note that I will not be able to answer before tomorrow at roughly the same hour (and this is true for every day actually). </p>\n\n<p>Thanks for reading, thanks in advance for answers.</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1555476095, "post_id": 55718577, "comment_id": 98119796, "body": "It is strange. You can have a global counter. Increment the counter in the beginning of the thread function and see how many threads have been created. Note: Use the counter with a global mutex."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1555480975, "post_id": 55718577, "comment_id": 98121351, "body": "The code shown looks good so far. So the issue must dues to the code you do not show. Dare showing it as well? Shouldn&#39;t be to much."}], "owner": {"reputation": 323, "user_id": 1552271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb85c887297daa6b53b3c854d04a694?s=128&d=identicon&r=PG", "display_name": "faeophyta", "link": "https://stackoverflow.com/users/1552271/faeophyta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555463915, "creation_date": 1555463915, "question_id": 55718577, "link": "https://stackoverflow.com/questions/55718577/thread-entry-point-called-twice-for-one-thread-in-array", "title": "Thread entry point called twice for one thread in array", "body": "<p>It seems to me that the entry routine is called twice (see duplicated <code>thread 3 is waiting</code> in output below) for one of the threads I create in an array. I suspect it might be a race condition, but wasn't able to fix it. Is there something I missed?</p>\n\n<p>main</p>\n\n<pre><code>pthread_t threads[numthreads];\n    fw_t *threadinfo = malloc(sizeof(fw_t) * numthreads);\n    int n_thread = file_len / sqrt(numthreads);\n\n    for (int i = 0; i &lt; numthreads; ++i) {\n        threadinfo[i].id = i;\n        threadinfo[i].n = n_thread;\n        printf(\"i: %i\\n\", i);\n        if (pthread_create(&amp;threads[i], NULL, &amp;fwParallelCommon, (void *)(&amp;threadinfo[i])))\n        {\n            printf(\"wasn't able to make the thread :(\\n\");\n        }\n    }\n    pthread_cond_signal(&amp;cond);\n</code></pre>\n\n<p>fwParallelCommon</p>\n\n<pre><code>    fw_t *threadinfo = (fw_t *) arg;\n    printf(\"thread %i is waiting\\n\", threadinfo-&gt;id);\n    pthread_cond_wait(&amp;cond, &amp;lock);\n    printf(\"created new thread %i\\n\", threadinfo-&gt;id);\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>dima@DESKTOP-6PQ42D9:~/dva$ ./fw 4 adj1.txt\n4 threads\ni: 0\ni: 1\nthread 0 is waiting\ni: 2\nthread 1 is waiting\ni: 3\nthread 2 is waiting\nthread 3 is waiting\nthread 3 is waiting\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1555463882, "post_id": 55718568, "comment_id": 98117312, "body": "Two things will help considerably here: One, make sure your program is minimal, but complete enough to compile. Tracking down which <code>#include</code> headers takes away time that could have been spent coming up with a solution. This is missing important context. Two, make sure you indent your code so we can understand its structure and intent."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555530661, "post_id": 55718568, "comment_id": 98148340, "body": "You can&#39;t push a string, only pull."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1555585917, "post_id": 55718568, "comment_id": 98166314, "body": "PLEASE, READ <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>  Your example doesn&#39;t even compile."}], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 10168590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5484b587c0114f37f8323164e249256?s=128&d=identicon&r=PG&f=1", "display_name": "Suven Pandey", "link": "https://stackoverflow.com/users/10168590/suven-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1555466179, "last_edit_date": 1555466179, "creation_date": 1555465789, "answer_id": 55718801, "question_id": 55718568, "link": "https://stackoverflow.com/questions/55718568/i-am-kinda-new-to-c-programming-i-need-help-to-push-a-string-from-a-filetest-t/55718801#55718801", "title": "I am kinda new to C programming. I Need help to push a string from a file(test.txt) into an array without the commas", "body": "<p>First of all DO NOT use global variables unless it is absolutely requires.\nI am assuming you want str as array of pointers and str[0] stores first line, str[1] stores second line and so on.\nFor this:</p>\n\n<pre><code>int line_pos = 0; //stores line_number\nint char_pos = 0; //stores position in str[line_pos]\nwhile(fgets(line, sizeof(line), stream))\n    {\n        printf (\"%s\", line); \n        int length = strlen(line);\n        strcpy(ch,line);\n\n        str[line_pos] = calloc(length, sizeof(char)); //allocating memory \n\n        for (i=0;i&lt;length;i++)\n        {\n            if (ch[i] != ',')\n            {\n\n                *(str[line_pos]+char_pos) = ch[i]; //setting value of str[line][pos]\n                char_pos++;\n            }\n\n        }\n        char_pos = 0;\n        line_pos++;\n    }  \nprintf(\"%s\", str[0]); //print first line without comma   \n</code></pre>\n\n<p>Note that it only works for 20 lines (because you declared *str[20]) and then for 21st or later lines it leads to overflow and can cause variety of disasters. You can include:</p>\n\n<pre><code>if (line_pos &gt;= 20)\n    break;\n</code></pre>\n\n<p>as a safety measure.</p>\n\n<p>Note that slighty more memory is allocated for str(memory allocated = memory_required + number of comma). To prevent this you can set <code>ch</code> to text without comma:</p>\n\n<pre><code>for (i=0;i&lt;length;i++)\n        {\n            int j = 0; //stores position in ch\n            if (line[i] != ',')\n            {\n\n                ch[j++] = line[i]; \n            }\n</code></pre>\n\n<p>Then allocate memory for str[line_pos] like:\n<code>str[line_pos] = calloc(strlen(ch0, sizeof(char));</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11162426, "user_type": "registered", "profile_image": "https://graph.facebook.com/2198060786944926/picture?type=large", "display_name": "Swarnava Chatterjee", "link": "https://stackoverflow.com/users/11162426/swarnava-chatterjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555466179, "creation_date": 1555463767, "question_id": 55718568, "link": "https://stackoverflow.com/questions/55718568/i-am-kinda-new-to-c-programming-i-need-help-to-push-a-string-from-a-filetest-t", "title": "I am kinda new to C programming. I Need help to push a string from a file(test.txt) into an array without the commas", "body": "<p>I am trying to solve a problem on  Dynamic memory allocation by reading the input from a file by malloc(),free(),realloc(); i just need help to push the strings into an array from the file, without the commas . My test.txt file are as follows:</p>\n\n<p>a,5,0</p>\n\n<p>a,25,1</p>\n\n<p>a,1,2</p>\n\n<p>r,10,1,3</p>\n\n<p>f,2</p>\n\n<pre><code>int i;\n\nint count;\n\nchar line[256];\n\nchar *str[20];//to store the strings without commas\n\nchar ch[20];\n\nint main (void) \n\n{\n\nFILE *stream;\n\nif ( (stream = fopen ( \"test.txt\", \"r\" )) == NULL )\n\n{ printf (\"Cannot read the new file\\n\");\n\nexit (1);\n\n}\n\nwhile(fgets(line, sizeof line, stream))\n\n{\n\nprintf (\"%s\", line); \n\nint length = strlen(line);\n\nstrcpy(ch,line);\n\nfor (i=0;i&lt;length;i++)\n\n{\n\n if (ch[i] != ',')\n       {\n\n printf (\"%c\", ch[i]);   \n        }\n\n    }\n\n\n}     \n\n   //i++;\n\n\n\n\n//FREE(x);\n//FREE(y);\n//FREE(z);\n\nfclose (stream);\n</code></pre>\n\n<p>the str[] array should only store values like a520. (excluding the commas)</p>\n"}, {"tags": ["c", "c99"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1555463669, "post_id": 55718529, "comment_id": 98117278, "body": "That&#39;s not the way console output works. If you want it to work like a word processor, write a word processor."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1555463676, "post_id": 55718529, "comment_id": 98117279, "body": "<i>&quot;I expect the result to be like a word processor&quot;</i> - I can assure even console-based simple editors are considerably more complicated than that."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1555463940, "post_id": 55718529, "comment_id": 98117320, "body": "word processors keep information about location and characteristics of every letter on screen because they put it there as pixels. The only thing you can read from a screen is an array of pixels, unlesss you piggyback on a program which already manages text for you."}], "answers": [{"tags": [], "owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "is_accepted": false, "score": -1, "last_activity_date": 1555470458, "creation_date": 1555470458, "answer_id": 55719299, "question_id": 55718529, "link": "https://stackoverflow.com/questions/55718529/allowing-the-user-to-edit-text-already-printed-on-the-screen-in-c/55719299#55719299", "title": "Allowing the user to edit text already printed on the screen in C", "body": "<p>Under Linux you can use the readline library and there each line read will be using a system defined line reader, which will allow edits , tossing arrows and such until you press enter. See <a href=\"http://web.mit.edu/gnu/doc/html/rlman_2.html\" rel=\"nofollow noreferrer\">http://web.mit.edu/gnu/doc/html/rlman_2.html</a>. </p>\n\n<p>In the other hand, if you want to build your own be line editor, or mini word processor, then you will have to keep, at least, the relative position of your current cursor, erase and redraw the line on each meet press, and reposition there caret.</p>\n\n<p>Here is an example of a line editor <a href=\"https://www.dreamincode.net/forums/topic/136583-line-editor-in-c/\" rel=\"nofollow noreferrer\">https://www.dreamincode.net/forums/topic/136583-line-editor-in-c/</a></p>\n"}], "owner": {"reputation": 141, "user_id": 9542344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7e3a52bd647d67bd0d0ae43711a6738?s=128&d=identicon&r=PG", "display_name": "scopessuckM8", "link": "https://stackoverflow.com/users/9542344/scopessuckm8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555470458, "creation_date": 1555463286, "question_id": 55718529, "link": "https://stackoverflow.com/questions/55718529/allowing-the-user-to-edit-text-already-printed-on-the-screen-in-c", "title": "Allowing the user to edit text already printed on the screen in C", "body": "<p>I want to change the text on my screen like a word processor by user input, so can i do gets(\"text the user can edit\", variable to edit by text)</p>\n\n<p>I have tried arrays, and have tried researching dynamically created variables for this. My code is below: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\nint run;\nint run = 1;\nchar string;\ndo\n{\nchar string = getchar();\n} while (run == 1);\n}\n</code></pre>\n\n<p>I expect the result to be like a word processor, and allow the user to edit the text already displayed on the screen. The results I have is the program acting like a typewriter for each paragraph, making it unable to be edited after I pressed enter</p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1555463529, "post_id": 55718484, "comment_id": 98117260, "body": "The wrong format specifier throughout notwithstanding, it was your intent for the first condition to print 4.2 <i>billion</i> IP addresses, the second 16.7 million, the third 64K, and the fourth 255 ? Rly ? Secondly, <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a> seems more appropriate for this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 1, "creation_date": 1555463634, "post_id": 55718484, "comment_id": 98117274, "body": "Your <code>ipAddress</code> is not initialized. No one knows which <code>if</code> will happen (most likely none of them). <code>The code basically detects xxx in ipAddress[0-4] and then prints the block ips.</code> - can you please clarify?"}, {"owner": {"reputation": 183, "user_id": 3190757, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d49d8ea15e16efb2c05f243fb771c645?s=128&d=identicon&r=PG&f=1", "display_name": "schmidt73", "link": "https://stackoverflow.com/users/3190757/schmidt73"}, "edited": false, "score": 0, "creation_date": 1555463705, "post_id": 55718484, "comment_id": 98117282, "body": "Hey, this question is a little ambiguous in nature, it is unclear exactly what you are asking. Ideally, one wouldn&#39;t have to read your code to understand your problem. If you could describe what you are trying to do more precisely, I would be happy to help."}, {"owner": {"reputation": 183, "user_id": 3190757, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d49d8ea15e16efb2c05f243fb771c645?s=128&d=identicon&r=PG&f=1", "display_name": "schmidt73", "link": "https://stackoverflow.com/users/3190757/schmidt73"}, "edited": false, "score": 0, "creation_date": 1555463824, "post_id": 55718484, "comment_id": 98117302, "body": "@dyukha I think he is using the assumption that they are all initialized to 0 as that is the behavior most runtime systems use."}, {"owner": {"reputation": 21, "user_id": 10778616, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d0WYrHQM5DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gElov4dULKx045uNh6fEaK9PWUew/mo/photo.jpg?sz=128", "display_name": "Jefke22", "link": "https://stackoverflow.com/users/10778616/jefke22"}, "edited": false, "score": 0, "creation_date": 1555464491, "post_id": 55718484, "comment_id": 98117434, "body": "Sorry guys, i updated my question. I&#39;m trying to loop through all possible ip addresses depending on my argv[1] input (if the ip contains 255). If it contains 255 in any of the ip 4 subblocks 111.222.333.444 it will include that whole block range of ips and print it."}, {"owner": {"reputation": 21, "user_id": 10778616, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d0WYrHQM5DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gElov4dULKx045uNh6fEaK9PWUew/mo/photo.jpg?sz=128", "display_name": "Jefke22", "link": "https://stackoverflow.com/users/10778616/jefke22"}, "edited": false, "score": 0, "creation_date": 1555464558, "post_id": 55718484, "comment_id": 98117448, "body": "For example ./displayallips 198.1.255.255 would print all ips from 192.1.0.0 until 198.1.255.255."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 0, "creation_date": 1555464808, "post_id": 55718484, "comment_id": 98117486, "body": "I sounds strange. So for <code>1.255.1.1</code> you want to print everything between <code>1.0.0.0</code> and <code>1.255.255.255</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 0, "creation_date": 1555464958, "post_id": 55718484, "comment_id": 98117513, "body": "In any case, I would write a recursive function, similar to this: <a href=\"https://www.geeksforgeeks.org/recursive-program-to-generate-power-set/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/recursive-program-to-generate-power-set</a>. You run recursion from the first index, whose value is <code>255</code>."}, {"owner": {"reputation": 21, "user_id": 10778616, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d0WYrHQM5DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gElov4dULKx045uNh6fEaK9PWUew/mo/photo.jpg?sz=128", "display_name": "Jefke22", "link": "https://stackoverflow.com/users/10778616/jefke22"}, "edited": false, "score": 0, "creation_date": 1555465000, "post_id": 55718484, "comment_id": 98117524, "body": "@dyukha yes that is my purpose, thanks will have a look."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1555466556, "post_id": 55718484, "comment_id": 98117856, "body": "Be careful with recursive functions and multiple levels of recursion. Your worst case is <code>256^4</code> (that is 4294967296 recursive calls -- each requiring the setup of its own function stack)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1555474965, "post_id": 55718484, "comment_id": 98119508, "body": "@DavidC.Rankin, there are 5 levels of recursion."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "is_accepted": true, "score": 0, "last_activity_date": 1555476084, "last_edit_date": 1555476084, "creation_date": 1555475479, "answer_id": 55719927, "question_id": 55718484, "link": "https://stackoverflow.com/questions/55718484/multiple-for-loops-depending-on-conditions/55719927#55719927", "title": "Multiple for loops depending on conditions", "body": "<p>This kind of recursion is a standard approach when you have to run the same <code>for</code> loop on multiple layers.</p>\n\n<pre><code>void printAll(short ipAddress[], int index) {\n    if (index == 4) {\n        printf(\"%d.%d.%d.%d\\n\", ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);\n        return;\n    }\n    for (int i = 0; i &lt; 256; i++) {\n        ipAddress[index] = i;\n        printAll(ipAddress, index + 1);\n    }\n\n}\n\nint main() {\n    short ipAddress[4];\n    ... // initialize\n    for (int i = 0; i &lt; 4; i++) {\n        if (ipAddress[i] == 255) {\n            printAll(ipAddress, i);\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10778616, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d0WYrHQM5DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gElov4dULKx045uNh6fEaK9PWUew/mo/photo.jpg?sz=128", "display_name": "Jefke22", "link": "https://stackoverflow.com/users/10778616/jefke22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 55719927, "answer_count": 1, "score": 0, "last_activity_date": 1555476084, "creation_date": 1555462892, "last_edit_date": 1555464351, "question_id": 55718484, "link": "https://stackoverflow.com/questions/55718484/multiple-for-loops-depending-on-conditions", "title": "Multiple for loops depending on conditions", "body": "<p>I wrote the below code, it's working fine.\nBut somehow i as a newbie don't feel comfortable and think it's possible to write it shorter.</p>\n\n<p>The code basically detects xxx in ipAddress[0-4] and then prints the block ips.</p>\n\n<p>My question is if it's possible to write this shorter and more efficient, in other words can i make the depth of my for loop depend on the value of ipaddress[0]-[4]</p>\n\n<p>Thanks.</p>\n\n<pre><code>   short ipAddress[4];\n\n   extractIpAddress(argv[1],&amp;ipAddress[0]);\n\n\n\nprintf(\"\\nIp Address: %03d. %03d. %03d. %03d\\n\",ipAddress[0],ipAddress[1],ipAddress[2],ipAddress[3]);\n\nif(ipAddress[0] == 255) {\n for ( ipAddress[0]=0; ipAddress[0] &lt;= 255; ++ipAddress[0] )\n    for ( ipAddress[1]=0; ipAddress[1] &lt;= 255; ++ipAddress[1] )\n        for (ipAddress[2]=0; ipAddress[2] &lt;= 255; ++ipAddress[2] )\n            for (ipAddress[3]=0; ipAddress[3] &lt;= 255; ++ipAddress[3] )\n                printf( \"%d.%d.%d.%d\\n\", ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);\n}\nelse if(ipAddress[1] ==255) {\n    for ( ipAddress[1]=0; ipAddress[1] &lt;= 255; ++ipAddress[1] )\n        for (ipAddress[2]=0; ipAddress[2] &lt;= 255; ++ipAddress[2] )\n            for (ipAddress[3]=0; ipAddress[3] &lt;= 255; ++ipAddress[3] )\n                printf( \"%d.%d.%d.%d\\n\", ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);\n}\nelse if(ipAddress[2] == 255) {\n        for (ipAddress[2]=0; ipAddress[2] &lt;= 255; ++ipAddress[2] )\n            for (ipAddress[3]=0; ipAddress[3] &lt;= 255; ++ipAddress[3] )\n                printf( \"%d.%d.%d.%d\\n\", ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);\n}\nelse if(ipAddress[3] == 255) {\n            for (ipAddress[3]=0; ipAddress[3] &lt;= 255; ++ipAddress[3] )\n                printf( \"%d.%d.%d.%d\\n\", ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);\n}\n</code></pre>\n\n<p>--Update--</p>\n\n<p>Thanks and sorry for not formulating my question clear.</p>\n\n<p>I'm trying to generate a list of ip addresses, based if the (argv[1] input ipaddress) contains anywhere 255 in it the program will print that complete ip block range, all possible ip addresses.</p>\n\n<p>It's working fine but i just wanted to know and understand if it's possible to write this shorter and more efficiently.</p>\n"}, {"tags": ["c", "gcc", "cproto"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1555482751, "post_id": 55718347, "comment_id": 98122009, "body": "Why are you actually using the cproto tool?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555486423, "post_id": 55718347, "comment_id": 98123657, "body": "What cproto version are you using? I think it should just ignore the compilers extensions. My version 4.7m does."}, {"owner": {"reputation": 11, "user_id": 11365942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hhOCQ3whSk8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftuJF7hC0RmzHigrXXaQ9gfNbl0Q/mo/photo.jpg?sz=128", "display_name": "iris", "link": "https://stackoverflow.com/users/11365942/iris"}, "edited": false, "score": 0, "creation_date": 1555526722, "post_id": 55718347, "comment_id": 98146703, "body": "Thanks very much for the replies! I am actually compiling some old codes which used cproto. The cproto version I am using is 4.6 on CentOS 6.8. I&#39;ll find and try cproto 4.7m to see if it works for me."}, {"owner": {"reputation": 11, "user_id": 11365942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hhOCQ3whSk8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftuJF7hC0RmzHigrXXaQ9gfNbl0Q/mo/photo.jpg?sz=128", "display_name": "iris", "link": "https://stackoverflow.com/users/11365942/iris"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1555532039, "post_id": 55718347, "comment_id": 98148913, "body": "@Kamil Cuk I tried cproto4.7m and I no longer see these errors. Thank you so much!"}], "owner": {"reputation": 11, "user_id": 11365942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hhOCQ3whSk8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftuJF7hC0RmzHigrXXaQ9gfNbl0Q/mo/photo.jpg?sz=128", "display_name": "iris", "link": "https://stackoverflow.com/users/11365942/iris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555482454, "creation_date": 1555461583, "last_edit_date": 1555482454, "question_id": 55718347, "link": "https://stackoverflow.com/questions/55718347/how-to-fix-usr-include-string-h-line-44-syntax-error-at-token-dest-wh", "title": "How to fix &quot;&quot;/usr/include/string.h&quot;, line 44: syntax error at token &#39;__dest&#39;&quot; when using cproto", "body": "<p>I am compiling a C program on CentOS 6.8 and I see a lot of syntax errors in gcc include header files at token '<strong>???</strong>', but it can generate the binary eventually. </p>\n\n<p>The cproto version I am using is 4.6 and I have tried gcc 4.4.7 and gcc 5.4. I am confused what went wrong with my /usr/include/*.h. Any help would be really appreciated.</p>\n\n<p>Here is part of the log:</p>\n\n<pre><code>cproto -D__extension__=\" \"  -DCPROTO -S -f 2 -I. -I/home/XXX/include -o test.pl test.c\n\"/usr/include/stdarg.h\", line 40: syntax error at token '__builtin_va_list'\n\"/usr/include/libio.h\", line 491: syntax error at token '__gnuc_va_list'\n\"/usr/include/stdio.h\", line 197: syntax error at token '__asm__'\n\"/usr/include/stdio.h\", line 282: syntax error at token '__filename'\n......\n\"/usr/include/stdio.h\", line 734: syntax error at token '__ptr'\n\"/usr/include/stdio.h\", line 779: syntax error at token '__asm__'\n\"/usr/include/stdio.h\", line 801: syntax error at token '__stream'\n\"/usr/include/stdio.h\", line 803: syntax error at token '__asm__'\n\"/usr/include/stdlib.h\", line 165: syntax error at token '__nptr'\n......\n\"/usr/include/stdlib.h\", line 210: syntax error at token '__nptr'\n\"/usr/include/stdlib.h\", line 215: syntax error at token '__nptr'\n\"/usr/include/sys/select.h\", line 109: syntax error at token '__readfds'\n\"/usr/include/stdlib.h\", line 360: syntax error at token '__buf'\n\"/usr/include/stdlib.h\", line 366: syntax error at token '__statebuf'\n\"/usr/include/stdlib.h\", line 371: syntax error at token '__statebuf'\n......\n\"/usr/include/string.h\", line 44: syntax error at token '__dest'\n\"/usr/include/string.h\", line 57: syntax error at token '__dest'\n......\n\"/usr/include/fcntl.h\", line 209: syntax error at token '__asm__'\n\"/usr/include/sys/stat.h\", line 219: syntax error at token '__file'\n\"/usr/include/sys/stat.h\", line 222: syntax error at token '__asm__'\n\"/usr/include/sys/stat.h\", line 269: syntax error at token '__file'\n\"/usr/include/sys/stat.h\", line 412: syntax error at token '__asm__'\n\"/usr/include/sys/stat.h\", line 415: syntax error at token '__asm__'\n\"/usr/include/sys/stat.h\", line 418: syntax error at token '__asm__'\n\"/usr/include/sys/stat.h\", line 421: syntax error at token '__asm__'\ngcc -g -c -m64 -gdwarf-2 -g -D__USE_XOPEN2K8 -std=gnu89 -DTPI_DEBUG -c -I. -I/home/XXX/include ./test.c\n</code></pre>\n"}, {"tags": ["c++", "c", "opengl", "gcc", "build"], "comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1555465565, "post_id": 55718248, "comment_id": 98117655, "body": "Note that the accepted answer on that duplicate seems unnecessarily complicated and doesn&#39;t result in a static build, though.  (Some of the lower voted answers seem like they could offer some good advice though)"}], "answers": [{"tags": [], "owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1555461713, "creation_date": 1555461713, "answer_id": 55718359, "question_id": 55718248, "link": "https://stackoverflow.com/questions/55718248/novice-how-can-i-learn-how-to-build-glew-with-mingw/55718359#55718359", "title": "Novice: How can I learn how to build GLEW with MinGW?", "body": "<p>Can't you use the Makefile? (It should be included in the MinGW evironment, I think)</p>\n\n<p>In which case I think you should just be able to do something along the lines of:</p>\n\n<pre><code>cd thefolderwithmakefile\nmake all GLEW_STATIC=1\n</code></pre>\n\n<p>Then you need to define GLEW_STATIC ( as you said by <code>-DGLEW_STATIC</code> or by <code>#define GLEW_STATIC</code> )when you are building your project files as well.</p>\n"}], "owner": {"reputation": 23, "user_id": 11371102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Pr20GF1t9cs/AAAAAAAAAAI/AAAAAAAAAAs/TJWVcWi40Ao/photo.jpg?sz=128", "display_name": "jseas", "link": "https://stackoverflow.com/users/11371102/jseas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3376, "favorite_count": 0, "closed_date": 1555504008, "answer_count": 1, "score": 1, "last_activity_date": 1555500360, "creation_date": 1555460596, "last_edit_date": 1555500360, "question_id": 55718248, "link": "https://stackoverflow.com/questions/55718248/novice-how-can-i-learn-how-to-build-glew-with-mingw", "closed_reason": "Duplicate", "title": "Novice: How can I learn how to build GLEW with MinGW?", "body": "<p>I'm a daft C/C++ novice using Windows, building with MinGW through console. I have been looking for days on how to build GLEW so that I can statically link it with my incredibly simple SDL+OpenGL program. For static linking, GLEW supposedly requires a special lib apart from lglew32 called lglew32s, and this is what I cannot get my hands on.</p>\n\n<p>I'm trying to learn to use gcc/g++ right now, and to understand the options and the whole preprocess/compile/link thing in general. I'm about 5% there. I found some GLEW building batch file examples around the net, most being pretty old, but even one of them that was new didn't compile lglew32s for me, so I can dynamically link but I can't statically link.</p>\n\n<p>So because I can't find glew32s.lib anywhere online built with anything other than VS, I have to learn to understand what this means and somehow figure out how to compile glew32s with what I've learned from it:</p>\n\n<pre><code>gcc.exe -DGLEW_NO_GLU -O2 -Wall -W -Iinclude  -DGLEW_BUILD -o src/glew.o -c src/glew.c\ngcc.exe -fno-builtin -fno-stack-protector -shared -Wl,-soname,libglew32.dll -Wl,--out-implib,lib/libglew32.dll.a    -o lib/glew32.dll src/glew.o -L/mingw/lib -lglu32 -lopengl32 -lgdi32 -luser32 -lkernel32 -nostdlib\nar.exe cr lib/libglew32.a src/glew.o\ngcc.exe -DGLEW_NO_GLU -DGLEW_MX -O2 -Wall -W -Iinclude  -DGLEW_BUILD -o src/glew.mx.o -c src/glew.c\ngcc.exe  -fno-builtin -fno-stack-protector -shared -Wl,-soname,libglew32mx.dll -Wl,--out-implib,lib/libglew32mx.dll.a -o lib/glew32mx.dll src/glew.mx.o -L/mingw/lib -lglu32 -lopengl32 -lgdi32 -luser32 -lkernel32 -nostdlib\nar.exe cr lib/libglew32mx.a src/glew.mx.o\n</code></pre>\n\n<p>I have learned to compile my own .cpp and .c projects using gcc/g++ (again I'm barely out of the \"hello world\" phase in terms of actual code), and also how to dynamically link them to the SDL and GLEW libraries. I understand very well now what this all means:</p>\n\n<pre><code>g++ sdlglew.cpp -o sdlglew -Wall -lmingw32 -lSDL2main -lSDL2 -lglew32 -lopengl32 -I \"C:\\SDL2-2.0.9\\i686-w64-mingw32\\include\\SDL2\" -L \"C:\\SDL2-2.0.9\\i686-w64-mingw32\\lib\" -mwindows\n</code></pre>\n\n<p>(My SDL stuff is off in its own directory. GLEW's headers and libs are in MinGW's dir) </p>\n\n<p>I think I need either -DGLEW_STATIC in my command OR #define GLEW_STATIC in my sdlglew.cpp to compile GLEW statically, but those options with lglew32 give me no errors upon compile and fail to start due to the missing glew32.dll. Compiler spits out errors with -static because SDL has not been set up for it yet.</p>\n\n<p>Basically, if you have any resources on understanding what exactly the mentioned compile script is doing per line and how I could build glew32s, I'd be real happy :S I want to understand it, but it really seems like there's no documentation on it for us newbies</p>\n"}, {"tags": ["c", "struct", "parameter-passing"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1555461952, "post_id": 55718245, "comment_id": 98116966, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4983010/invalid-type-argument-of-c-structs\">Invalid type argument of -&gt; C structs</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11371182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nk2q_SlG21w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reJH_iP7BoIeCENEKevTPanoHGCKA/mo/photo.jpg?sz=128", "display_name": "Wingeds", "link": "https://stackoverflow.com/users/11371182/wingeds"}, "edited": false, "score": 0, "creation_date": 1555560326, "post_id": 55718436, "comment_id": 98155239, "body": "That is it ! Thank you very much"}], "tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": false, "score": 0, "last_activity_date": 1555462457, "creation_date": 1555462457, "answer_id": 55718436, "question_id": 55718245, "link": "https://stackoverflow.com/questions/55718245/problem-with-struct-invalid-type-argument-of/55718436#55718436", "title": "Problem with struct: invalid type argument of &#39;-&gt;&#39;", "body": "<p>You only need to use the <code>-&gt;</code> operator on <code>cb</code> and then the other members can be accessed using the <code>.</code> operator.</p>\n\n<p>For example, this:</p>\n\n<pre><code>cb-&gt;cocom[numcontas]-&gt;pessoass[num].tipopessoa = 1;\n</code></pre>\n\n<p>Needs to be this:</p>\n\n<pre><code>cb-&gt;cocom[numcontas].pessoass[num].tipopessoa = 1;\n</code></pre>\n\n<p>This needs to be corrected for all the lines that the compiler is listing.</p>\n"}], "owner": {"reputation": 1, "user_id": 11371182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nk2q_SlG21w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reJH_iP7BoIeCENEKevTPanoHGCKA/mo/photo.jpg?sz=128", "display_name": "Wingeds", "link": "https://stackoverflow.com/users/11371182/wingeds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555462457, "creation_date": 1555460573, "last_edit_date": 1555460900, "question_id": 55718245, "link": "https://stackoverflow.com/questions/55718245/problem-with-struct-invalid-type-argument-of", "title": "Problem with struct: invalid type argument of &#39;-&gt;&#39;", "body": "<p>I'm having problemns with passing-arguments in structs.\nWhen i execute the problem apear the following errors;</p>\n\n<pre><code>C:\\Users\\Jordao\\Desktop\\Algoritmos\\Cesumar\\Estrutura de Dados 2019\\AepBanco.c: In function 'criarpessoafisica': \nC:\\Users\\Jordao\\Desktop\\Algoritmos\\Cesumar\\Estrutura de Dados 2019\\AepBanco.c:95:23: error: invalid type argument of '-&gt;' (have 'cc {aka struct Contacomum}') \ncb-&gt;cocom[numcontas]-&gt;pessoass[num].tipopessoa = 1; \n^~ \n\nC:\\Users\\Jordao\\Desktop\\Algoritmos\\Cesumar\\Estrutura de Dados 2019\\AepBanco.c:100:41: error: invalid type argument of '-&gt;' (have 'cc {aka struct Contacomum}') \nscanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;cocom[numcontas]-&gt;pessoas[num].nome); \n^~ \n\nC:\\Users\\Jordao\\Desktop\\Algoritmos\\Cesumar\\Estrutura de Dados 2019\\AepBanco.c:102:41: error: invalid type argument of '-&gt;' (have 'cc {aka struct Contacomum}') \nscanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco ); \n^~ \n</code></pre>\n\n<pre><code>//AEP 30/04/2019\n//Algoritmo para um sistema banc\u00e1rio\n//Created by Jord\u00e3o Qualho da silva\n//.\n//Last Update 15/04/2019 23:30\n//------------------------------------------------------------------------------\n//Bibliotecas\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;locale.h&gt;\n//------------------------------------------------------------------------------\nint num=0; //numero de pessoas inseridas\nint numcontas=0; //numero de contas inseridas\nint tipoconta=-1; //-1=inicio 0=comum 1=especial 2=poupanca\n//------------------------------------------------------------------------------\nvoid gotoxy(int x, int y){\n     SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),(COORD){x-1,y-1});\n     //muda o cursor para a posi\u00e7\u00e3o x,y\n   }\n//------------------------------------------------------------------------------\nvoid fazerjanela (int ci,int li,int lf,int cf){\n  //faz uma janela c=coluna l=linha i=incial f=final\n  int i,y;\n  for ( i = ci+1; i &lt; cf; i++) {\n    gotoxy(i,ci);printf(\"%c\",196 );\n  }\n  for ( i = ci+1; i &lt; cf; i++) {\n    gotoxy(i,lf);printf(\"%c\",196 );\n  }\n  for ( i = li; i &lt; lf; i++) {\n    gotoxy(ci,i);printf(\"%c\",179 );\n  }\n  for ( i = li; i &lt; lf; i++) {\n    gotoxy(cf,i);printf(\"%c\",179 );\n  }\n  gotoxy(ci,li);printf(\"%c\",218 );\n  gotoxy(cf,lf);printf(\"%c\",217 );\n  gotoxy(cf,li);printf(\"%c\", 191);\n  gotoxy(ci,lf);printf(\"%c\", 192);\n  gotoxy(cf,lf+1);printf(\"\\n\");\n}\n//------------------------------------------------------------------------------\ntypedef struct Pessoa{\n  char nome [100];\n  char endereco [100];\n  char telefone [12];\n  float renda;\n  int tipopessoa; //1=fisica e 2=Juridica\n  char cpf [20],cnpj [20];\n}pe;\ntypedef struct Historico{\n  char numconta [10];//verificar depois\n  char data [8];\n  char tipodoc [20];\n  float valor;\n}hist;\ntypedef struct Contacomum{\n  char senha [50];\n  char numconta [10];\n  char agencia [10];\n  float saldo;\n  hist historicos [100];\n  pe pessoas [100];\n  int pessoa;\n}cc;\ntypedef struct Contaespecial{\n  char senha [50];\n  char numconta [10];\n  char agencia [10];\n  float saldo;\n  hist historicos [100];\n  pe pessoas [100];\n  int pessoa;\n  float limite;\n}ce;\ntypedef struct contapoupanca{\n  char senha [50];\n  char numconta [10];\n  char agencia [10];\n  float saldo;\n  hist historicos [100];\n  pe pessoas [100];\n  int pessoa;\n}cp;\ntypedef struct contabancaria{\n  cp copou [20];\n  ce coesp [20];\n  cc cocom [20];\n}cb;\n//------------------------------------------------------------------------------\nvoid criarpessoafisica (cb *cb){\n  cb-&gt;cocom[numcontas]-&gt;pessoass[num].tipopessoa = 1;\n  system(\"cls\");    fazerjanela(1,1,15,50);\n  gotoxy (15,2); printf(\"Cadastro de Pessoa Fisica\");\n  gotoxy (3,4); printf(\"Pesssoa N00%i \", num+1);\n  gotoxy (3,6); printf(\"Nome: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;cocom[numcontas]-&gt;pessoas[num].nome);\n  gotoxy (3,7); printf(\"Endereco: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco );\n  gotoxy (3,8); printf(\"Telefone: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].telefone );\n  gotoxy (3,9); printf(\"Renda Mensal: \");fflush (stdin);\n  scanf(\"%f\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].renda );\n  do {\n    gotoxy (3,12); printf(\"                                            \");\n    gotoxy (3,14); printf(\"                                            \");\n    gotoxy (3,10); printf(\"                                     \");\n    gotoxy (3,10); printf(\"CPF: \");fflush (stdin);\n    scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].cpf );\n    tam = strlen (cb-&gt;cocom[numcontas]-&gt;pessoas[num].cpf);\n    if (tam != 11) {\n      gotoxy (3,12); printf(\"Error 404: CPF Invalido !\");\n      gotoxy (3,14); system (\"PAUSE\");\n      flag=1;\n    }else{\n     flag=0;\n    }\n  } while(flag);\n  gotoxy (3,12); printf(\"Pessoa cadastrada com sucesso !\");\n  gotoxy (3,14); system(\"PAUSE\"); system (\"cls\");\n  transformarnomevolta (&amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].nome);\n  transformarnomevolta (&amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco);\n  transformarCPF(&amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].cpf );\n  fprintf(arq,\"\\n%s %s %s %.1f %s\",\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].nome,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].telefone,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].renda,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].cpf);\n  num++;\n}\n//------------------------------------------------------------------------------\nvoid criarpessoajuridica (cb *cb) {\n  cb-&gt;cocom[numcontas]-&gt;cocom[numcontas]-&gt;pessoass[num].tipopessoa = 2;\n  system(\"cls\");    fazerjanela(1,1,15,50);\n  gotoxy (15,2); printf(\"Cadastro de Pessoa Juridica\");\n  gotoxy (3,4); printf(\"Pesssoa N000%i \", num+1);\n  gotoxy (3,6); printf(\"Nome: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].nome);\n  gotoxy (3,7); printf(\"Endereco: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco );\n  gotoxy (3,8); printf(\"Telefone: \");fflush (stdin);\n  scanf(\"%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].telefone );\n  gotoxy (3,9); printf(\"Renda Mensal: \");fflush (stdin);\n  scanf(\"%f\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].renda );\n  gotoxy (3,10);    printf(\"CNPJ: \");fflush (stdin);\n  scanf(\"%%[^\\n]s\", &amp;cb-&gt;cocom[numcontas]-&gt;pessoas[num].cnpj );\n  gotoxy (3,12); printf(\"Pessoa cadastrada com sucesso !\");\n  gotoxy (3,14); system(\"PAUSE\"); system (\"cls\");\n  fprintf(arq,\"%s %s %s %f %s\",\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].nome,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].endereco,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].telefone,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].renda,\n  cb-&gt;cocom[numcontas]-&gt;pessoas[num].cnpj);\n  num++;\n}\n//------------------------------------------------------------------------------\nvoid cadastrarpessoa (cb *cb){\n  int pos1=1, flag=0, tam;\n  char opc;\n  FILE *arq; int i=0;\n    arq = fopen(\"Pessoas.txt\",\"a\");\n  do{\n      system(\"cls\"); fazerjanela (1,1,15,50);\n      gotoxy (6,5);  printf(\"Que tipo de pessoa deseja cadastrar ?\");\n      gotoxy (6,8);  printf(\"   Pessoa Fisica\");\n      gotoxy (25,8); printf(\"   Pessoa Juridica\");\n      gotoxy (40,14);printf(\"   Voltar\");\n      switch (pos1){\n        case 1: gotoxy(6,8);    printf(\"-&gt; Pessoa Fisica\");break;\n        case 2: gotoxy(25,8);   printf(\"-&gt; Pessoa Juridica\");break;\n        case 3: gotoxy(40,14);  printf(\"-&gt; Voltar\");break;\n      }\n       opc=getchar();\n       if (opc==-32){ //tecla especial necessita pegar segundo valor\n          opc=getchar();\n          switch (opc) {\n            case 75:pos1--; break; //SETA PRA CIMA\n            case 77:pos1++; break; //SETA PRA BAIXO\n          }\n       }\n     if (pos1==0) pos1=3;\n     if (pos1==4) pos1=1;\n     if (opc == 13) //ENTER\n       switch (pos1){\n         case 1:\n           criarpessoafisica (&amp;cb);\n         break;\n         case 2:\n           criarpessoajuridica (&amp;cb);\n         break;\n         case 3:\n                opc=27;\n         break;\n       }\n   }\n   while (opc!=27);\n   fclose (arq);\n}\n//------------------------------------------------------------------------------\nvoid criarcontacomum(cb *cb){\n  int pos1=1;\n  char opc;\n  tipoconta = 0;\n  do{\n    system (\"cls\");  fazerjanela(1,1,15,50);\n    gotoxy (2,4);   printf(\"-----------------(Conta Comum)------------------\");\n    gotoxy (5,7);   printf(\"   Cadastrar Nova Pessoa \");\n    gotoxy (5,9);  printf(\"   Usar Pessoa Existente \");\n    gotoxy (2,12);  printf(\"------------------------------------------------\");\n    gotoxy (42,14); printf(\"   Sair\");\n    switch (pos1){\n      case 1: gotoxy(5,7);  printf(\"-&gt; Cadastrar Nova Pessoa \");           break;\n      case 2: gotoxy(5,9); printf(\"-&gt; Usar Pessoa Existente \");        break;\n      case 3: gotoxy(42,14);printf(\"-&gt; Sair\");                  break;\n    }\n     opc=getch();\n     if (opc==-32){ //tecla especial necessita pegar segundo valor\n        opc=getch();\n        switch (opc) {\n          case 72:pos1--; break; //SETA PRA CIMA\n          case 80:pos1++; break; //SETA PRA BAIXO\n        }\n     }\n   if (pos1==0) pos1=3;\n   if (pos1==4) pos1=1;\n   if (opc == 13) //ENTER\n       switch (pos1){\n         case 1:\n          cadastrarpessoa (&amp;cb);\n         break;\n         case 2:\n\n         break;\n         case 3:\n                opc=27;\n         break;\n       }\n   }\n   while (opc!=27);\n }\n//------------------------------------------------------------------------------\nvoid criarcontaespecial(cb *cb){\n\n}\n//------------------------------------------------------------------------------\nvoid criarcontapoupanca(cb *cb){\n\n}\n//------------------------------------------------------------------------------\nvoid criarconta(cb *cb) {\n  int pos1=1;\n  char opc ;\n  do{\n      system (\"cls\");  fazerjanela(1,1,15,50);\n      gotoxy (2,4);   printf(\"--------------------(Conta)---------------------\");\n      gotoxy (5,6);   printf(\"   Conta Comum \");\n      gotoxy (5,8);   printf(\"   Conta Especial \");\n      gotoxy (5,10);   printf(\"   Conta Poupanca \");\n      gotoxy (2,12);  printf(\"------------------------------------------------\");\n      gotoxy (42,14); printf(\"   Sair\");\n      switch (pos1){\n        case 1: gotoxy(5,6);  printf(\"-&gt; Conta Comum\");           break;\n        case 2: gotoxy(5,8);  printf(\"-&gt; Conta Especial\");        break;\n        case 3: gotoxy(5,10);  printf(\"-&gt; Conta Poupanca\" );       break;\n        case 4: gotoxy(42,14);printf(\"-&gt; Sair\");                  break;\n      }\n       opc=getch();\n       if (opc==-32){ //tecla especial necessita pegar segundo valor\n          opc=getch();\n          switch (opc) {\n            case 72:pos1--; break; //SETA PRA CIMA\n            case 80:pos1++; break; //SETA PRA BAIXO\n          }\n       }\n     if (pos1==0) pos1=4;\n     if (pos1==5) pos1=1;\n     if (opc == 13) //ENTER\n       switch (pos1){\n         case 1:\n          criarcontacomum (&amp;cb);\n         break;\n         case 2:\n          criarcontaespecial (&amp;cb);\n         break;\n         case 3:\n          criarcontapoupanca (&amp;cb);\n         case 4:\n          opc=27;\n         break;\n       }\n   }\n   while (opc!=27);\n}\n//------------------------------------------------------------------------------\nvoid acessarconta(cb *cb){\n\n}\n//------------------------------------------------------------------------------\n/*void transformarnome (char *nome){\n  int i,tam;\n  tam = strlen (nome);\n  for (i = 0; i &lt; tam; i++) {\n    if (nome [i] == '.') {\n      nome[i]=' ';\n    }\n  }\n}*/\n//------------------------------------------------------------------------------\n/*void transformarnomevolta (char *nome){\n  int i,tam;\n  tam = strlen (nome);\n  for (i = 0; i &lt; tam; i++) {\n    if (nome [i] == ' ') {\n      nome[i]='.';\n    }\n  }\n}*/\n//------------------------------------------------------------------------------\n/*void transformarCPF (char *cpf){\n  int i,tam;\n  cpf[13]=cpf[10];cpf[12]=cpf[9];cpf[11]='-';\n  cpf[10]=cpf[8]; cpf[9]=cpf[7]; cpf[8]=cpf[6];cpf[7]='.';\n  cpf[6]=cpf[5];  cpf[5]=cpf[4]; cpf[4]=cpf[3];cpf[3]='.';\n}*/\n//------------------------------------------------------------------------------\n/*void lerarquivo (cb *cb){\n    FILE *arq; int i=0;\n    arq = fopen(\"Pessoas.txt\",\"r\");\n      system (\"cls\");\n    while ( !feof(arq)) {\n      fscanf(arq,\"%s\" \"%s\" \"%f\" \"%s\",&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].nome,&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].endereco,&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].renda,&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].cpf);\n      transformarnome (&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].nome);\n      transformarnome (&amp;cb-&gt;contacomum[0]-&gt;pessoas[i].endereco);\n      i++;num++;\n    }\n}*/\n//------------------------------------------------------------------------------\n/*void procurarpessoa (cb *cb){\n  int opcao,i,col=5;\n  if (num &gt; 0) {\n    system (\"cls\");\n    fazerjanela(1,1,15,50);\n    gotoxy (13,2); printf(\"Pessoas Inseridas: %i\", num-1);\n    for ( i = 0; i &lt; num; i++) {\n      gotoxy (3,(i+4)); printf(\"%i. %s\",(i+1),cb-&gt;pessoas[i].nome);\n    }\n    gotoxy (3,(i+5)); printf(\"Insira o numero da pessoa que desja editar: \" );\n    fflush (stdin);scanf(\"%i\", &amp;opcao);\n    system (\"cls\");\n    fazerjanela(1,1,12,50);\n    opcao=opcao-1;\n    gotoxy (16,3);  printf(\"Pesssoa Fisica N00%i \", opcao+1);\n    gotoxy (3,6);   printf(\"    Nome: %s\", cb-&gt;pessoas[opcao].nome);\n    gotoxy (3,7);   printf(\"Endereco: %s\", cb-&gt;pessoas[opcao].endereco );\n    gotoxy (3,8);   printf(\"   Renda: %.1f\", cb-&gt;pessoas[opcao].renda );\n    gotoxy (3,9); printf(\"     CPF: %s\", cb-&gt;pessoas[opcao].cpf );\n    gotoxy (3,11); system (\"PAUSE\");\n  }\n}*/\n//------------------------------------------------------------------------------\nint main() {\n  system(\"mode con:cols=50 lines=17\");\n  cb contabancaria;\n  int pos1=1;\n  char opc;\n  //lerarquivo (&amp;contabancaria); //arumar &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;------\n  do{\n      system(\"cls\"); fazerjanela (1,1,15,50);\n      gotoxy (2,4);   printf(\"--------------------(Conta)---------------------\");\n      gotoxy (5,8);   printf(\"   Criar \");\n      gotoxy (31,8);  printf(\"   Acessar \");\n      gotoxy (2,12);  printf(\"------------------------------------------------\");\n      gotoxy (42,14); printf(\"   Sair\");\n      switch (pos1){\n        case 1: gotoxy(5,8);  printf(\"-&gt; Criar\");       break;\n        case 2: gotoxy(31,8); printf(\"-&gt; Acessar\");       break;\n        case 3: gotoxy(42,14);printf(\"-&gt; Sair\");           break;\n      }\n       opc=getch();\n       if (opc==-32){ //tecla especial necessita pegar segundo valor\n          opc=getch();\n          switch (opc) {\n            case 75:pos1--; break; //SETA PRA ESQUERDA\n            case 77:pos1++; break; //SETA PRA DIREITA\n          }\n       }\n     if (pos1==0) pos1=3;\n     if (pos1==4) pos1=1;\n     if (opc == 13) //ENTER\n       switch (pos1){\n         case 1:\n          criarconta(&amp;contabancaria);\n         break;\n         case 2:\n          acessarconta(&amp;contabancaria);\n         break;\n         case 3:\n          opc=27;\n         break;\n       }\n   }\n   while (opc!=27);\n   system(\"cls\");\n   printf(\"\\nPrograma Finalizado com suscesso !\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "byte", "bit-shift"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1555454892, "post_id": 55717567, "comment_id": 98115507, "body": "how long shift 1 bit or 8 bits?"}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1555455614, "post_id": 55717567, "comment_id": 98115686, "body": "Well ideally i want to shift through all bytes (all LEDs) per each layer."}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "edited": false, "score": 0, "creation_date": 1555455835, "post_id": 55717567, "comment_id": 98115741, "body": "Can you pack your 4 bytes into one big <code>uint32_t</code>? If yes, then all you need to do is perform a 1 bit left shift: <code>my_uint32_variable &lt;&lt;= 1;</code> \u2014 or <code>my_uint32_variable *= 2;</code> for that matter."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555456806, "post_id": 55717567, "comment_id": 98115955, "body": "I have to specify which LED_Buffer[y][x] I am using to shift the values in. Say I wanted to shift 0xAA value  starting from LED_Buffer[0][0] and finishing outside of LED_Buffer[0][3], so it sweeps through entire display. That is my end goal.  * I added some code to give a better idea how it is done. I am using PIC16F1829 microcontroller to develop this."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555457071, "post_id": 55717567, "comment_id": 98116006, "body": "I guess the main problem is that I am updating the display using bytes whereas shifting is usually done in terms of single bits, correct?"}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "edited": false, "score": 0, "creation_date": 1555457255, "post_id": 55717567, "comment_id": 98116037, "body": "@RytisBe Nope. See the answer."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555485784, "post_id": 55717847, "comment_id": 98123313, "body": "Thanks for the answer! However, I am working with 2-D arrays. To be more specific LED_Buffer[y][x] is used in the code. Idealy &quot;y&quot; parameter is just to tell which layer I am working with. I tried modifying the code, but <code>error: (202) only lvalues can be assigned to or modified</code> emerged."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555486997, "post_id": 55717847, "comment_id": 98123981, "body": "@RytisBe Given a 2D array declared as <code>unsigned char buffer[ROWS][COLS]</code>, you can shift each row with <code>for (int i = 0; i &lt; ROWS; i++) shiftArrayLeft(buffer[i], COLS, 1);</code>"}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555922181, "post_id": 55717847, "comment_id": 98252368, "body": "Ok i got that. However, having a difficulty with modifying the code to allow entire 4 byte array to shift by 32 places."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555969699, "post_id": 55717847, "comment_id": 98271781, "body": "@RytisBe I&#39;m not sure what you mean. Shift by 32 all at once, or shift by 32 one bit at a time?"}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555974188, "post_id": 55717847, "comment_id": 98272891, "body": "1 bit at a time. I want to sweep it through entire 32 LEDS  that I am driving."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1555977807, "post_id": 55717847, "comment_id": 98273660, "body": "@RytisBe I see. That seems like the topic for a new question."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1556030786, "post_id": 55717847, "comment_id": 98294375, "body": "Thanks, i shall start a new topic with a descent explanation what I am trying to achieve."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 1, "last_activity_date": 1555457023, "creation_date": 1555457023, "answer_id": 55717847, "question_id": 55717567, "link": "https://stackoverflow.com/questions/55717567/how-to-shift-a-byte-through-multiple-byte-array/55717847#55717847", "title": "How to shift a byte through multiple byte array", "body": "<p>The following code will shift an array of bytes to the left. The number of bits to shift must be between 1 and 7. Shifting by more than 7 would require additional code.</p>\n\n<pre><code>void shiftArrayLeft(unsigned char array[], int length, int shift) // 1 &lt;= shift &lt;= 7\n{\n    unsigned char carry = 0;                        // no carry into the first byte\n    for (int i = length-1; i &gt;= 0; i--)\n    {\n        unsigned char temp = array[i];              // save the value\n        array[i] = (array[i] &lt;&lt; shift) | carry;     // update the array element\n        carry = temp &gt;&gt; (8 - shift);                // compute the new carry\n    }\n}\n</code></pre>\n\n<p>It works by storing the old value from the array. Then update the current array element by shifting it and logical-OR a carry from the previous byte. Then compute the new carry (the upper bits of the original value).</p>\n\n<p>The function can be called with code like this</p>\n\n<pre><code>unsigned char array[] = { 0x00, 0x00, 0x00, 0xAA };\nint length = sizeof(array) / sizeof(array[0]);\nshiftArrayLeft(array, length, 1);\n</code></pre>\n\n<p>which will change the array to <code>{ 0x00, 0x00, 0x01, 0x54 }</code></p>\n"}], "owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555600387, "creation_date": 1555454638, "last_edit_date": 1555468550, "question_id": 55717567, "link": "https://stackoverflow.com/questions/55717567/how-to-shift-a-byte-through-multiple-byte-array", "title": "How to shift a byte through multiple byte array", "body": "<p>I am working on LED Tower that contains 15 layers, where each of them contains 4 bytes (32 LEDs). I would like to be able to shift a byte from right to left. However there is an issue with multiple bytes, can't figure out how to continously transition the shifting.  </p>\n\n<p>Additional information:</p>\n\n<pre><code>void Invert_Display(void){\nfor (int y = 0; y &lt; LAYERS; y++){\n    for (int x = 0; x &lt; BYTES; x++){\n        LED_Buffer[y][x] ^= (0b11111111);\n    }\n}\nUpdate_Display();\n</code></pre>\n\n<p>Where UpdateDisplay function is as follows:</p>\n\n<pre><code>void Update_Display(void){\n\n    while(!TRMT);           // Wait until transmission register is empty\n\n    for (int y = 0; y &lt; LAYERS; y++){\n        for (int x = 0; x &lt; BYTES; x++){\n        TXREG = LED_Buffer[y][x];\n        while (!TRMT);\n        }\n    }\n\n    LE = 1;                 // Data is loaded to the Output latch\n    NOP();              \n    LE = 0;                 // Data is latched into the Output latch\n</code></pre>\n\n<p>The expected outcome is attached below.<a href=\"https://i.stack.imgur.com/7H7sq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7H7sq.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1555450700, "post_id": 55716825, "comment_id": 98114422, "body": "you need to takie a sheet of paper, a pen and draw the array and array of pointers and what and where they can point."}], "answers": [{"tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": true, "score": 2, "last_activity_date": 1555450368, "creation_date": 1555450368, "answer_id": 55716908, "question_id": 55716825, "link": "https://stackoverflow.com/questions/55716825/what-is-the-difference-between-2d-array-pointers-and-arr/55716908#55716908", "title": "What is the difference between 2d array pointers and *arr[]?", "body": "<p>A multi-dimensional array is a single block of memory.  An array of pointers to data that is not necessarily contiguous (a single block).</p>\n\n<p>The latter is useful for managing sparse arrays or where each pointed to subarray  isn't necessarily the same size. </p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1555451755, "creation_date": 1555451755, "answer_id": 55717144, "question_id": 55716825, "link": "https://stackoverflow.com/questions/55716825/what-is-the-difference-between-2d-array-pointers-and-arr/55717144#55717144", "title": "What is the difference between 2d array pointers and *arr[]?", "body": "<blockquote>\n  <p>Can someone explain to me please why this behavior is happening?</p>\n</blockquote>\n\n<p>With ...</p>\n\n<blockquote>\n<pre><code>int* foo[2] = {arr1, arr2}; // Let's say the length of arr1 is 3 and arr2 is 1\n</code></pre>\n</blockquote>\n\n<p>... <code>foo</code> is declared as an array whose elements are of type <code>int *</code>.  You do not present the definitions of <code>arr1</code> and <code>arr2</code>, but let's say they are arrays of <code>int</code> -- then in the initializer expressions they \"decay\" to pointers to their first elements, which have the correct type for elements of <code>foo</code>, so that's all fine.</p>\n\n<p>But pointers are <em>not</em> integers.  You declare <code>pFoo</code> as an <code>int *</code>, but you initialize it with an <code>int **</code> <em>converted to</em> <code>int *</code>:</p>\n\n<blockquote>\n<pre><code>int* pFoo = (int*)foo;\n</code></pre>\n</blockquote>\n\n<p>Converting the pointer's type does nothing to the data to which it (actually) points, and since <code>pFoo</code> ends up pointing to data that aren't actually <code>int</code>s, accessing those data through <code>pFoo</code> produces undefined behavior.</p>\n\n<p>Perhaps you were looking for this:</p>\n\n<pre><code>int **pFoo2 = foo;  // note: no cast needed\n</code></pre>\n\n<p>Now <code>pFoo2</code>'s type, <code>int **</code>, is the same as the type to which <code>foo</code> naturally decays, and you can access the elements correctly:</p>\n\n<pre><code>printf(\"%d\", pFoo2[0][0]);\n</code></pre>\n\n<p>Note that you are still accessing <code>arr1</code> and <code>arr2</code> through <code>pFoo2</code>, indirectly.  You must still respect their lengths, even though those lengths are not the same as each other, and are not evident from the type of <code>pFoo2</code> or of <code>foo</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55716908, "answer_count": 2, "score": 2, "last_activity_date": 1555451755, "creation_date": 1555449898, "question_id": 55716825, "link": "https://stackoverflow.com/questions/55716825/what-is-the-difference-between-2d-array-pointers-and-arr", "title": "What is the difference between 2d array pointers and *arr[]?", "body": "<p>I'm trying to understand what is the difference between an array like this:</p>\n\n<pre><code>int arr[2][2] = {{0, 1}, {2, 3}};\nint* pArr = (int*)arr;\nfor(int i = 0; i &lt; 4; i++)\n{\n    printf(\"%d \", pArr[i]);\n}\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>int* foo[2] = {arr1, arr2}; // Let's say the length of arr1 is 3 and arr2 is 1\nint* pFoo = (int*)foo;\nfor(int i = 0; i &lt; 4; i++)\n{\n    printf(\"%d \", pFoo[i]);\n}\n\n</code></pre>\n\n<p>They look pretty much the same to me but the output is completely different.\nI'm getting strange results, if i do what i gave here as an example than it give me big integers, but if i add more arrays and items it gives me smaller integers too.\noutput example:\n<a href=\"https://i.stack.imgur.com/0RmfV.png\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p>*in the outout image: The upper integers are the first 2d array and the bottom integers are the second array pointer.</p>\n\n<p>Can someone explain to me please why this behavior is happening?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 11076781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AEbp_l4M20o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNq9wzZW_MtnAU7_RDtc7xasFybGA/mo/photo.jpg?sz=128", "display_name": "VietHTran", "link": "https://stackoverflow.com/users/11076781/viethtran"}, "is_accepted": true, "score": 3, "last_activity_date": 1555448719, "creation_date": 1555448719, "answer_id": 55716594, "question_id": 55716318, "link": "https://stackoverflow.com/questions/55716318/syntax-for-a-user-input-2d-array-within-a-nested-struct/55716594#55716594", "title": "Syntax for a User Input 2D Array within a Nested Struct?", "body": "<p>You don't have to initialize <code>myline</code> with any values. You just need to declare it.</p>\n\n<pre><code>lineseg myline;\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11355688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu7d3.jpg?s=128&g=1", "display_name": "Octavius", "link": "https://stackoverflow.com/users/11355688/octavius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 55716594, "answer_count": 1, "score": 1, "last_activity_date": 1555449728, "creation_date": 1555447325, "question_id": 55716318, "link": "https://stackoverflow.com/questions/55716318/syntax-for-a-user-input-2d-array-within-a-nested-struct", "title": "Syntax for a User Input 2D Array within a Nested Struct?", "body": "<p><strong>The problem:</strong></p>\n\n<ul>\n<li><strong>Create a nested structure to store coordinates of end points of a\nline segment.</strong></li>\n<li><strong>In a program, prompt the user for the coordinates and\nprint them.</strong></li>\n</ul>\n\n<p>I was able to create the code and get it working, as can be seen below, but I had to do so by filling in the values for an array beforehand, then having the user's input replace these pre-assigned values. My intuition is that there is a better way of doing this (e.g., by declaring an empty array to begin with), and I'd like to know how.</p>\n\n<p>Though I was able to get the code working by using:\n        <code>lineseg myline = {{4,2},{5,9}};</code>, this is not what I want.</p>\n\n<p>I made a number of attempts at creating an empty array, but none worked. </p>\n\n<p>e.g., by trying <code>lineseg myline[2][2];</code> instead.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct\n{\n    int x,\n        y;\n} point;\n\ntypedef struct\n{\n    point pt1,\n          pt2;\n} lineseg;\n\nvoid main()\n{\n    lineseg myline = {{4,2},{5,9}};\n\n    printf(\"Enter x coordinate for the first point: \");\n    scanf(\"%d\",&amp;myline.pt1.x);\n    printf(\"Enter y coordinate for the first point: \");\n    scanf(\"%d\",&amp;myline.pt1.y);\n    printf(\"Enter x coordinate for the second point: \");\n    scanf(\"%d\",&amp;myline.pt2.x);\n    printf(\"Enter y coordinate for the second point: \");\n    scanf(\"%d\",&amp;myline.pt2.y);\n    printf(\"\\nPoint 1: (%d,%d)  Point 2: (%d,%d)\",myline.pt1.x,\n           myline.pt1.y,myline.pt2.x,myline.pt2.y);\n    return 0;\n}\n</code></pre>\n\n<p>When I enter 3 ,1, 4, and 8, the output statement correctly prints \"Point 1: (3,1)  Point 2: (4,8)\"</p>\n\n<p>Any suggestions on how to do so without writing over a declared array would be terrific.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 548, "user_id": 2507644, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PR7QV.jpg?s=128&g=1", "display_name": "mshindal", "link": "https://stackoverflow.com/users/2507644/mshindal"}, "edited": false, "score": 0, "creation_date": 1555447628, "post_id": 55716316, "comment_id": 98113182, "body": "Initialize it to something it should never be passed in as - like null or -1. Then in your conditional check to see if it&#39;s null or -1. If so, it&#39;s the first time the function was called."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1555448439, "post_id": 55716316, "comment_id": 98113530, "body": "Are you using C or C++? There are C++ solutions that can&#39;t be used in C, like <code>std::optional</code>."}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555448618, "post_id": 55716316, "comment_id": 98113609, "body": "@Barmar For both...I have the problem solved now thanks to Sergey, I look std::optional on my own :)"}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "edited": false, "score": 0, "creation_date": 1555448006, "post_id": 55716393, "comment_id": 98113348, "body": "The problem is, as you said, in this case all values are possible (it is a 16 bit register so anything is possible). What do you mean by two variables? can you please give an example?"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 2, "last_activity_date": 1555448308, "last_edit_date": 1555448308, "creation_date": 1555447719, "answer_id": 55716393, "question_id": 55716316, "link": "https://stackoverflow.com/questions/55716316/how-to-use-static-variable-to-remember-last-passed-argument/55716393#55716393", "title": "How to use static variable to remember last passed argument", "body": "<p>Your scenario <code>B</code> is almost correct, but you need a way to see if you had at least one execution or not. You can do it with <code>std::optional</code> or a simple boolean flag - I will go with the flag for simplicity:</p>\n\n<pre><code>// Scenario B\nvoid foo(uint16_t stuff) {\n\n    static uint16_t lastStuff;\n    static bool last_inited = false;\n\n    // lastStuff will be impossible value on the first execution\n    if(lastStuff != stuff || !last_inited) {\n        last_inited = true;\n        doStuff();\n    }\n    lastStuff = stuff;\n}\n</code></pre>\n\n<p>What it will do is to initialize static bool variable to <code>false</code> on the first function execution, and than it will be set to <code>true</code> and will remain true for all next executions.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1555448386, "last_edit_date": 1555448386, "creation_date": 1555448339, "answer_id": 55716514, "question_id": 55716316, "link": "https://stackoverflow.com/questions/55716316/how-to-use-static-variable-to-remember-last-passed-argument/55716514#55716514", "title": "How to use static variable to remember last passed argument", "body": "<p>You'll need a separate flag variable to see if the funcition was called at least once:</p>\n\n<pre><code>void foo(uint16_t stuff) {\n\n    static int firstTime = 1;\n    static uint16_t lastStuff = 0;        \n\n    // lastStuff will always be equal to stuff\n    if(!firstTime &amp;&amp; (lastStuff != stuff)) {\n        doStuff();\n    }    \n\n    lastSutff = stuff;\n    firstTime = 0;\n} \n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 55716393, "answer_count": 2, "score": 0, "last_activity_date": 1555451022, "creation_date": 1555447314, "question_id": 55716316, "link": "https://stackoverflow.com/questions/55716316/how-to-use-static-variable-to-remember-last-passed-argument", "title": "How to use static variable to remember last passed argument", "body": "<p>I have a function that receives an argument and does something. I want to check if the parameter is different than the last call to the function. As far I understood, I can easily use a golbal variable or global static (only in the current translation  unit). But is it possible to achieve the same thing using static variable inside the function (I would argue it is more readable and the code will be cleaner if I would have many similar functions).</p>\n\n<p>The problem is what should I init the variable so I make sure the next time I Call the function it works?</p>\n\n<pre><code>// Scenario A\nvoid foo(uint16_t stuff) {\n\n    // Error: Obviously lastStuff is not declared yet!\n    if(lastStuff != stuff) {\n        doStuff();\n    }\n\n    static uint16_t lastStuff = stuff;\n\n} \n\n// Scenario B\nvoid foo(uint16_t stuff) {\n\n    static uint16_t lastStuff = stuff;        \n\n    // lastStuff will always be equal to stuff\n    if(lastStuff != stuff) {\n        doStuff();\n    }    \n} \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555446781, "post_id": 55716162, "comment_id": 98112816, "body": "A string &#39;%s&#39; is not the same as a char &#39;%c&#39;"}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555447059, "post_id": 55716162, "comment_id": 98112916, "body": "Yeah, I had an issue with using &#39;%c&#39; . Every time I entered a character, it would include the enter input, thus it would run the loop twice until asking me for a new character."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1555447235, "post_id": 55716162, "comment_id": 98112986, "body": "When reading from a user input, you usually want to read a whole line, including the line terminator, and then extract the part that you want."}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "edited": false, "score": 0, "creation_date": 1555448062, "post_id": 55716162, "comment_id": 98113366, "body": "1. I switched scanf(&quot;%1s&quot;, &amp;userLetter); to scanf(&quot; %c&quot;, &amp;userLetter); noting the space. This terminated the program after each input."}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "edited": false, "score": 0, "creation_date": 1555448230, "post_id": 55716162, "comment_id": 98113446, "body": "2. I switched the user input to a string and did conditionals based on the first character in the string entered and my character (compared the values). This gave me the same result as I had with the above program and did not evaluate the second while loop when userLetter == myLetter."}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "edited": false, "score": 0, "creation_date": 1555448252, "post_id": 55716162, "comment_id": 98113453, "body": "I changed both xing"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555448889, "post_id": 55716162, "comment_id": 98113722, "body": "You don&#39;t need the second <code>while</code> loop. If you get out of the first loop, it means that the char matches."}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "edited": false, "score": 0, "creation_date": 1555449066, "post_id": 55716162, "comment_id": 98113808, "body": "I took out the second while loop and left the printf statement. I guess the issue is that I cannot get out of the first loop."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1555449138, "post_id": 55716162, "comment_id": 98113842, "body": "It also works for me when I change the scanf pattern."}, {"owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "edited": false, "score": 0, "creation_date": 1555449957, "post_id": 55716162, "comment_id": 98114158, "body": "Xing, your comment about changing the scanf pattern worked after trying it again with the help from Barmar. Thank you guys."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1555449420, "creation_date": 1555449420, "answer_id": 55716736, "question_id": 55716162, "link": "https://stackoverflow.com/questions/55716162/trying-to-create-a-guess-my-letter-code-how-do-i-incorporate-the-case-where-the/55716736#55716736", "title": "Trying to create a guess my letter code. How do I incorporate the case where the input char from the user equals my letter?", "body": "<p>The proper format operator for reading a single character is <code>%c</code>, not <code>%1s</code>. The latter reads a single character, but writes it into a null-terminated string, so it will write a null byte outside the <code>userLetter</code> variable, which causes undefined behavior.</p>\n\n<p>You should put a space before the operator to make <code>scanf</code> skip over whitespace before reading the character. This is needed to make it ignore the newline after each response.</p>\n\n<p>You should also turn off output buffering or flush the buffer after each prompt, since they don't end with a newline.</p>\n\n<p>There's no need for the <code>while</code> loop at the end, since you don't get out of the first loop until the characters match.</p>\n\n<p>This is a working version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char myLetter = 'a';\n\n    setbuf(stdout, NULL);\n    printf(\"insert a char:\");\n\n    char userLetter;\n    scanf(\" %c\", &amp;userLetter);\n\n    while (userLetter !=  myLetter)\n    {\n        printf(\"%c does not match mine, try again:\", userLetter);\n        scanf(\" %c\", &amp;userLetter);\n    }\n\n    printf(\"char matches! program will terminate now.\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1555450438, "post_id": 55716797, "comment_id": 98114332, "body": "There are several errors in this answer. It should be <code>&amp;userLetter</code>, and you need a space before <code>%c</code>. If you declare it as an array, the element type should be <code>char</code>, not <code>char*</code>, and it needs to be at least <code>[2]</code> to allow room for the null terminator."}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1556477817, "post_id": 55716797, "comment_id": 98443675, "body": "Hi! I checked your answers and questions on all the sites where you are active. I think you are <i>good</i>, it is very well visible on your posts. The problem is that your writing style creates a bad first impression. The problem is that saying this to new users is not allowed: <i>&quot;I is always uppercase in English, I hate if you write &quot;i&quot;, so I vote you down&quot;</i>. But actually doing it is okay. And, honestly, this is really one of the first thing anybody learns on his first English courses in his life. So, please, please, please, <a href=\"https://meta.stackoverflow.com/a/291370/1783163\">read this</a>."}], "tags": [], "owner": {"reputation": 13, "user_id": 11316059, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ymah-W76W10/AAAAAAAAAAI/AAAAAAAAAME/jiUJ7BWqPLM/photo.jpg?sz=128", "display_name": "Ezio", "link": "https://stackoverflow.com/users/11316059/ezio"}, "is_accepted": false, "score": 0, "last_activity_date": 1556473057, "last_edit_date": 1556473057, "creation_date": 1555449759, "answer_id": 55716797, "question_id": 55716162, "link": "https://stackoverflow.com/questions/55716162/trying-to-create-a-guess-my-letter-code-how-do-i-incorporate-the-case-where-the/55716797#55716797", "title": "Trying to create a guess my letter code. How do I incorporate the case where the input char from the user equals my letter?", "body": "<p>If you are comparing 2 char why don't you get user letter with <code>scanf(\"%c\", userLetter)</code> and then you can compare them with <code>=</code> or <code>!=</code> operator. If you are getting input expecting a string value, then I suggest you to declare <code>userLetter</code> like this:</p>\n\n<pre><code>char* userLetter[1];\n</code></pre>\n\n<p>and then use scanf the way you did in your code BUT you have to compare the strings with <code>strcmp</code> function.</p>\n"}], "owner": {"reputation": 3, "user_id": 11370389, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-thz4AJXP7dw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsnaoxWru82GnZE6HpDyywoZKfAw/mo/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11370389/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55716736, "answer_count": 2, "score": 0, "last_activity_date": 1556473057, "creation_date": 1555446633, "last_edit_date": 1555449001, "question_id": 55716162, "link": "https://stackoverflow.com/questions/55716162/trying-to-create-a-guess-my-letter-code-how-do-i-incorporate-the-case-where-the", "title": "Trying to create a guess my letter code. How do I incorporate the case where the input char from the user equals my letter?", "body": "<p>I am trying to create a program that compares the letter a user inputs to my letter. If the letters are the same, the program should say that they are the same, then terminate. If they are not the same, then the user should be prompted to enter another character until they guess it correctly. </p>\n\n<p>I have tried nesting an if statement and nesting a while loop to achieve the case where the letters are equal. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char myLetter = 'a';\n\n    printf(\"insert a char:\");\n\n    char userLetter;\n\n    scanf(\"%1s\", &amp;userLetter);\n\n    while (userLetter !=  myLetter)\n    {\n        printf(\"%c does not match mine, try again:\", userLetter);\n\n        scanf(\"%1s\", &amp;userLetter);\n    }\n\n    while (userLetter == myLetter)\n    {\n        printf(\"char matches! program will terminate now. \");\n\n        break;\n    }\n}\n</code></pre>\n\n<p>expected:</p>\n\n<pre><code>insert a char:h\nh does not match mine, try again:j\nj does not match mine, try again:g\ng does not match mine, try again:f\nf does not match mine, try again:a\nchar matches! program will terminate now.\n</code></pre>\n\n<p>actual:</p>\n\n<pre><code>insert a char:h\nh does not match mine, try again:j\nj does not match mine, try again:g\ng does not match mine, try again:f\nf does not match mine, try again:a\na does not match mine, try again:a does not match mine, try again:^C\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1555445694, "post_id": 55715926, "comment_id": 98112365, "body": "<code>array[5]</code> is out of bounds. Also I would suggest to think about a way to avoid floating point numbers here."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1555445787, "post_id": 55715926, "comment_id": 98112412, "body": "You can&#39;t print a whole array like that: you must print each element in a loop."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555447108, "post_id": 55715926, "comment_id": 98112930, "body": "If you want to do exact arithmetic, use int.  Double is for inexact arithmetic over a greater range than an int can hold."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1555448392, "post_id": 55715926, "comment_id": 98113515, "body": "What is the purpose of the line <code>array[i] = a;</code>, followed immediately by another (different) assignment to array[i]?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1555466772, "post_id": 55715926, "comment_id": 98117909, "body": "<code>void main()</code> is wrong. <a href=\"https://stackoverflow.com/q/204476/995714\">What should main() return in C and C++?</a>, <a href=\"https://stackoverflow.com/q/12570837/995714\">main() always returns int?</a>. And the output isn&#39;t returned, it&#39;s printed out"}], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 11076781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AEbp_l4M20o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNq9wzZW_MtnAU7_RDtc7xasFybGA/mo/photo.jpg?sz=128", "display_name": "VietHTran", "link": "https://stackoverflow.com/users/11076781/viethtran"}, "is_accepted": false, "score": 0, "last_activity_date": 1555449969, "creation_date": 1555449969, "answer_id": 55716839, "question_id": 55715926, "link": "https://stackoverflow.com/questions/55715926/my-code-doesnt-returns-an-output-it-returns-only-exit-code/55716839#55716839", "title": "My code doesn&#39;t returns an output. It returns only exit code", "body": "<p>I agree with @Eugene Sh.'s and @FredK's suggestions. The line <code>array[5]</code> in the line <code>printf(\"%d\", array[5]);</code> is out of bound since <code>array</code> only have indexes from 0 to 4. Since I assume you want to print out the last element in the array, you should change it to <code>printf(\"%d\", array[4]);</code>. Another thing is that your assignment expression <code>array[i] = a;</code> is wrong. I assume the expression is part of the swapping process from element in index <code>i</code> with element in index <code>rev</code>. If that was the case then you should change it to <code>a = array[i];</code> instead. I update you code according to my suggestion and it outputs the correct result. I added the for loop to verify that the <code>array</code> values are reversed for testing purpose. You can delete it after you're done testing.</p>\n\n<pre><code>#include &lt;math.h&gt;\nint main() {\n    double size = 5;\n    int array[5] = {1, 2, 3, 4, 5};\n    int half_size = ceil(size / 2);\n    for(int i = 0; i &lt; half_size; i++){\n        int a;\n        int rev = size - (i + 1);\n        a = array[i];\n        array[i] = array[rev];\n        array[rev] =  a;\n    }\n    for (int i = 0; i &lt; size; ++i) {\n        printf(\"%d \", array[i]);\n    }\n    printf(\"\\n\");\n    printf(\"%d\", array[4]);\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10787905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qlc35jXDHI4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jfCsLBr0e4YHk_TlpPwL_avKqDYQ/mo/photo.jpg?sz=128", "display_name": "alper ortac", "link": "https://stackoverflow.com/users/10787905/alper-ortac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1555464145, "creation_date": 1555445479, "last_edit_date": 1555464145, "question_id": 55715926, "link": "https://stackoverflow.com/questions/55715926/my-code-doesnt-returns-an-output-it-returns-only-exit-code", "title": "My code doesn&#39;t returns an output. It returns only exit code", "body": "<p>I wanted to reverse half of the arrays inputs with the other half.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n    void main() {\n       double size = 5;\n       int array[5] = {1, 2, 3, 4, 5};\n       int half_size = ceil(size / 2);\n       for(int i = 0; i &lt; half_size; i++){\n           int a;\n           int rev = size - (i + 1);\n           array[i] = a;\n           array[i] = array[rev];\n           array[rev] =  a;`enter code here`\n           }\n       printf(\"%d\", array[5]);\n       }\n\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "atmega", "atmel"], "comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1555586114, "post_id": 55715919, "comment_id": 98166398, "body": "What is PD5 and how/where is it defined? PLEASE READ <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and edit your question by submitting such an example code, the expected result and the actual one.  What do you mean with <i>Do I have to define what &quot;PD5&quot; is?</i> Should we define it for you?  What do you mean when you say <i>does not work</i> ???"}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1555586356, "post_id": 55715919, "comment_id": 98166553, "body": "Very good point. Thank you for pointing that out."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1555445836, "post_id": 55715979, "comment_id": 98112430, "body": "Oh really? This is a really basic mistake then, thanks for clearing that up. So what would be the correct syntax for setting bit 5 of PORTD (that is PIND5) to 1? At the end of the day I want to be able to only set the bit at PIND5 to 0 or 1 without altering the other bits."}, {"owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "reply_to_user": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1555446162, "post_id": 55715979, "comment_id": 98112568, "body": "I don&#39;tt use AtMega but I know they are similar to PICs, after some research you need to clear and set the appropriate bit using the first type of assignment. I&#39;ve updated answer with some code how to do that."}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1555446855, "post_id": 55715979, "comment_id": 98112842, "body": "I found out how to do it, you can just do it like this PORTD |= (1 &lt;&lt; PD5); so I had done it wrong. Maybe you can update the answer with it."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1555447381, "post_id": 55715979, "comment_id": 98113053, "body": "I&#39;m sorry, but your hypothesis about what&#39;s going on here is incorrect. The AVR headers define <code>PD5</code> as 5, not as a macro to access bit 5 of <code>PIND</code>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1555586369, "post_id": 55715979, "comment_id": 98166561, "body": "Sorry, but <code>10 == (0x0a)</code>, not <code>0x12</code>, I&#39;m afraid....  Also, better <code>#define LEDON (PORTD |= 0x00100000)</code> (with parenthesis) or, even better <code>#define LEDON do{PORTD |= 0b00100000;}while(0)</code>."}], "tags": [], "owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "is_accepted": true, "score": 0, "last_activity_date": 1555593280, "last_edit_date": 1555593280, "creation_date": 1555445739, "answer_id": 55715979, "question_id": 55715919, "link": "https://stackoverflow.com/questions/55715919/when-programming-my-atmega644-mcu-why-does-portd-0b00100000-work-but-not-po/55715979#55715979", "title": "When programming my Atmega644 MCU. Why does PORTD |= 0b00100000 work, but not PORTD |= (PD5 &lt;&lt;1)?", "body": "<p>The assignments differ.</p>\n\n<pre><code>PORTD |= 0b00100000;\n</code></pre>\n\n<p>sets bit 5 of PORT D to 1</p>\n\n<p>whereas</p>\n\n<pre><code>PORTD |= (PD5 &lt;&lt;1);\n</code></pre>\n\n<p>set bit 1 and 2 of PORTD to 1 (as PD5 == 5 and PD5 &lt;&lt; 1 == 10 (0x0A) i.e. 1010 binary)</p>\n\n<p>Define some macro to set the LED on or off to prevent having to set the 'bits' each time</p>\n\n<pre><code>#define LEDON PORTD |= 0b00100000\n#define LEDOFF PORTD &amp;= ~0b00100000\n</code></pre>\n\n<p>Example usage</p>\n\n<pre><code>if ( put_led_on )\n    LEDON;\nelse\n    LEDOFF;\n</code></pre>\n\n<p>Or thanks to your own research</p>\n\n<pre><code>PORTD |= (1&lt;&lt;PD5);\n</code></pre>\n\n<p>which will set bit 5 to 1</p>\n"}, {"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 1, "last_activity_date": 1555447292, "creation_date": 1555447292, "answer_id": 55716311, "question_id": 55715919, "link": "https://stackoverflow.com/questions/55715919/when-programming-my-atmega644-mcu-why-does-portd-0b00100000-work-but-not-po/55716311#55716311", "title": "When programming my Atmega644 MCU. Why does PORTD |= 0b00100000 work, but not PORTD |= (PD5 &lt;&lt;1)?", "body": "<blockquote>\n  <p>PORTD |= (PD5 &lt;&lt;1);</p>\n</blockquote>\n\n<p><code>PD5</code> is defined as the number 5. Left-shifting it by one bit gives you 10, which has no relation to the value you want.</p>\n\n<p><code>1 &lt;&lt; PD5</code>, on the other hand, will give you the result of left-shifting 1 by 5 bits, which is equal to <code>0b00100000</code> -- exactly what you're after.</p>\n"}], "owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 55715979, "answer_count": 2, "score": 0, "last_activity_date": 1555593280, "creation_date": 1555445432, "question_id": 55715919, "link": "https://stackoverflow.com/questions/55715919/when-programming-my-atmega644-mcu-why-does-portd-0b00100000-work-but-not-po", "title": "When programming my Atmega644 MCU. Why does PORTD |= 0b00100000 work, but not PORTD |= (PD5 &lt;&lt;1)?", "body": "<p>I have been trying to understand why the line </p>\n\n<pre><code> PORTD |= 0b00100000;\n</code></pre>\n\n<p>works, but not</p>\n\n<pre><code>PORTD |= (PD5 &lt;&lt;1);\n</code></pre>\n\n<p>I have a LED attached to PD5 which only lights up for the first command.\nDo I have to define what \"PD5\" is? I never had to do that on my Atmega328P, but now on the Atmega644 it does not work?</p>\n\n<p>Here is the libraries that I include </p>\n\n<pre><code>  #define F_CPU 1000000UL  // 1MHz internal clock\n  #include &lt;avr/io.h&gt;\n  #include &lt;util/delay.h&gt;\n  #include &lt;stdio.h&gt;\n  #include &lt;stdlib.h&gt;\n  #include &lt;string.h&gt;\n  #include &lt;avr/interrupt.h&gt;\n  #include \"lcd.h\"\n</code></pre>\n\n<p>Not sure if anything can cause troubles? Am I missing something very basic here?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1555445121, "post_id": 55715832, "comment_id": 98112133, "body": "Describe your problem better. Does it compile? If no, what error? If yes, how does the code not work as it should?"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555445318, "post_id": 55715832, "comment_id": 98112216, "body": "I guess you are looking for c++"}, {"owner": {"reputation": 9, "user_id": 11072668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzWmS.png?s=128&g=1", "display_name": "omlk", "link": "https://stackoverflow.com/users/11072668/omlk"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555445457, "post_id": 55715832, "comment_id": 98112270, "body": "@OznOg :) no, I need use only &quot;C&quot;"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 2, "creation_date": 1555445745, "post_id": 55715832, "comment_id": 98112394, "body": "IMHO, what I understand you are trying to do is not feasible. How would the function know about it to be called thru a pointer held in a structure? Usually in C, when you mock object oriented programming, you pass the &quot;object&quot; expllicitly to the function, thus would be <code>setId(Hero *, int id)</code>."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555445865, "post_id": 55715832, "comment_id": 98112443, "body": "Moreover, what would be supposed to happen if there is no Hero in the first place when calling the function? (save the pointer and call it from nowhere)"}, {"owner": {"reputation": 9, "user_id": 11072668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzWmS.png?s=128&g=1", "display_name": "omlk", "link": "https://stackoverflow.com/users/11072668/omlk"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555446017, "post_id": 55715832, "comment_id": 98112504, "body": "@OznOg I agree with you, but your option is not appropriate for me, you may be able to get addresses using assembler inserts, or understand how it is implemented in C ++"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555446094, "post_id": 55715832, "comment_id": 98112545, "body": "well, in C++, the object is passed :); any trick by assembly or compiler is not C anyway."}, {"owner": {"reputation": 9, "user_id": 11072668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzWmS.png?s=128&g=1", "display_name": "omlk", "link": "https://stackoverflow.com/users/11072668/omlk"}, "edited": false, "score": 0, "creation_date": 1555446132, "post_id": 55715832, "comment_id": 98112557, "body": "I simplified the code so that only the essence of the question can be seen"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1555446301, "post_id": 55715832, "comment_id": 98112639, "body": "The answer hasn&#39;t changed: You need to pass it yourself. There is no trick."}], "answers": [{"comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 1, "creation_date": 1555527800, "post_id": 55716655, "comment_id": 98147151, "body": "and this is particularly visible when writing a lambda that needs to call a member function, <code>this</code> needs to be captured. If the guess from the pointer was possible, capturing <code>this</code> wouldn&#39;t be needed"}], "tags": [], "owner": {"reputation": 917, "user_id": 3882565, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/60a6de623a7590ebbc824e228562b045?s=128&d=identicon&r=PG&f=1", "display_name": "stonar96", "link": "https://stackoverflow.com/users/3882565/stonar96"}, "is_accepted": false, "score": 0, "last_activity_date": 1555527361, "last_edit_date": 1555527361, "creation_date": 1555449039, "answer_id": 55716655, "question_id": 55715832, "link": "https://stackoverflow.com/questions/55715832/how-to-get-pointer-address-in-function-that-called-through-this-pointer/55716655#55716655", "title": "How to get pointer address in function that called through this pointer", "body": "<p>It looks like you are trying to implement virtual functions in C, by using function pointers. In object-oriented programming languages like C++ or Java such functions or methods inside classes have an implicit <code>this</code> pointer as argument, which is hidden. That means that the <code>int getId()</code> function actually has the signature <code>int getId(Hero* this)</code> and the <code>void setId(int id)</code> function actually has the form <code>void setId(Hero* this, int id)</code>. As I have already said, in object-oriented programming languages you don't see or add the <code>this</code> pointer and you also don't pass the argument when you invoke the function. The compiler does this for you. It always automatically passes the pointer to the instance as <code>this</code> pointer, on which the function was invoked. In C, however, these features don't exist. So you have to add the <code>this</code> argument and pass it when invoking the function by yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 43248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55aC0.jpg?s=128&g=1", "display_name": "John G. Waggenspack", "link": "https://stackoverflow.com/users/43248/john-g-waggenspack"}, "is_accepted": false, "score": 0, "last_activity_date": 1555451106, "creation_date": 1555451106, "answer_id": 55717021, "question_id": 55715832, "link": "https://stackoverflow.com/questions/55715832/how-to-get-pointer-address-in-function-that-called-through-this-pointer/55717021#55717021", "title": "How to get pointer address in function that called through this pointer", "body": "<p>You could do the equivalent of what C++ does behind the scenes.</p>\n\n<p><strong>file: hero.h</strong></p>\n\n<pre><code>typedef struct hero {\n    int     id;\n    void    (*setId)(struct hero*, int);\n    int     (*getId)(struct hero*);\n} Hero, *HeroPtr;\n\nvoid constructHero(HeroPtr this);\n</code></pre>\n\n<p><strong>file: hero.c</strong></p>\n\n<pre><code>#include \"hero.h\"                                       \nstatic void setId(HeroPtr this, int id);                \nstatic int getId(HeroPtr this);                         \n\nHero initObj = {                                        \n .setId = &amp;setId,                                   \n .getId = &amp;getId,                                   \n};                                                      \n\nvoid constructHero(HeroPtr this)                        \n{                                                       \n    *this = initObj;                                \n}                                                       \n\nvoid setId(HeroPtr this, int id) {                      \n    HeroPtr hero_obj = this;                            \n    hero_obj-&gt;id = id;                              \n}                                                       \n\nint getId(HeroPtr this) {                               \n    HeroPtr hero_obj = this;                            \n\n    return hero_obj-&gt;id;                                \n}                                                       \n</code></pre>\n\n<p><strong>file: main.c</strong></p>\n\n<pre><code>#include \"hero.h\"\n#include \"stdio.h\"\n\nint main() {\n    Hero hero1;\n    Hero hero2;\n    HeroPtr hero_obj1=&amp;hero1;\n    HeroPtr hero_obj2=&amp;hero2;\n    constructHero(hero_obj1);\n    constructHero(hero_obj2);\n    hero_obj1-&gt;setId(hero_obj1, 1);\n    hero_obj2-&gt;setId(hero_obj2, 2);\n    printf(\"hero_obj1 id = %d\\n\", hero_obj1-&gt;getId(hero_obj1));\n    printf(\"hero_obj2 id = %d\\n\", hero_obj2-&gt;getId(hero_obj2));\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11072668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzWmS.png?s=128&g=1", "display_name": "omlk", "link": "https://stackoverflow.com/users/11072668/omlk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1555527361, "creation_date": 1555445020, "last_edit_date": 1555446042, "question_id": 55715832, "link": "https://stackoverflow.com/questions/55715832/how-to-get-pointer-address-in-function-that-called-through-this-pointer", "title": "How to get pointer address in function that called through this pointer", "body": "<p>I read <a href=\"https://gnu.huihoo.org/gcc/gcc-3.1.1/gcc/Return-Address.html#Return%20Address\" rel=\"nofollow noreferrer\">this article</a> but it doesn't answer my question.</p>\n\n<p><strong>file: hero.h</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct {\n    int     id;\n    void    (*setId)();\n    int     (*getId)();\n} Hero, *HeroPtr;\n</code></pre>\n\n<p><strong>file: hero.c</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"hero.h\"\n\nstatic void setId(int id);\n\nHero obj = {\n     .setId = setId,\n     .getId = getId,\n};\n\nvoid setId(int id) {\n    HeroPtr hero_obj = 0x0; //TODO how get address: hero_obj1 (1 &gt; ) OR \n                            //                      hero_obj2 (2 &gt; )\n    hero_obj-&gt;id = id;\n}\n\nvoid getId() {\n    HeroPtr hero_obj = 0x0; //TODO how get address: hero_obj1 (1 &gt; ) OR \n                            //                      hero_obj2 (2 &gt; )\n    return hero_obj-&gt;id;\n}\n</code></pre>\n\n<p><strong>file: main.c</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"hero.h\"\n\nint main() {\n    Hero hero_obj1, hero_obj2;\n//1 &gt;\n    hero_obj1-&gt;setId(1);\n//2 &gt;\n    hero_obj2-&gt;setId(2);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "void"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1555444867, "post_id": 55715794, "comment_id": 98112025, "body": "Please learn to indent the code in a proper way"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1555444987, "post_id": 55715794, "comment_id": 98112075, "body": "How is this function called?  Please include that in the question."}, {"owner": {"reputation": 1, "user_id": 11370499, "user_type": "registered", "profile_image": "https://graph.facebook.com/395934834511845/picture?type=large", "display_name": "\u0394\u03ad\u03c3\u03c0\u03bf\u03b9\u03bd\u03b1 \u0398\u03c9\u03bc\u03b1\u0390\u03b4\u03b7", "link": "https://stackoverflow.com/users/11370499/%ce%94%ce%ad%cf%83%cf%80%ce%bf%ce%b9%ce%bd%ce%b1-%ce%98%cf%89%ce%bc%ce%b1%ce%90%ce%b4%ce%b7"}, "edited": false, "score": 0, "creation_date": 1555445163, "post_id": 55715794, "comment_id": 98112152, "body": "I have named the function emporeuma."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1555445549, "post_id": 55715794, "comment_id": 98112309, "body": "@\u0394\u03ad\u03c3\u03c0\u03bf\u03b9\u03bd\u03b1\u0398\u03c9\u03bc\u03b1\u0390\u03b4\u03b7 Not the name of the function, the call to invoke this function with all necessary variables.  Your question should be in the form of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that others can compile and run to reproduce the problem."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1555447453, "post_id": 55715794, "comment_id": 98113087, "body": "Use English names for your variables, so that non Greek speakers can understand what you mean."}], "answers": [{"tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": false, "score": 0, "last_activity_date": 1555445406, "creation_date": 1555445406, "answer_id": 55715914, "question_id": 55715794, "link": "https://stackoverflow.com/questions/55715794/void-function-that-returns-average-max-min-and-takes-as-parameter-an-array-and-t/55715914#55715914", "title": "Void function that returns average,max,min,and takes as parameter an array and the number of inputs", "body": "<pre><code>    avg=0;\n    ...\n    *avg=sum/plithos;\n</code></pre>\n\n<p>crashes your program. You probably want to write <code>*avg = 0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1555445415, "creation_date": 1555445415, "answer_id": 55715916, "question_id": 55715794, "link": "https://stackoverflow.com/questions/55715794/void-function-that-returns-average-max-min-and-takes-as-parameter-an-array-and-t/55715916#55715916", "title": "Void function that returns average,max,min,and takes as parameter an array and the number of inputs", "body": "<p>The loop is one too short, and the max and min tracking is back-to-front. Here is a suggested edit of that part:</p>\n\n<pre><code>for(j = 1; j &lt; plithos; j++) {    // extend to the last element\n    if (array[j] &gt; *max) {\n        *max = array[j];          // update the max\n    }\n    if (array[j] &lt; *min) {\n        *min = array[j];          // update the min\n    }\n    sum += array[j];              // ready to calculate avg\n}\navg = sum / plithos;              // average\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11370499, "user_type": "registered", "profile_image": "https://graph.facebook.com/395934834511845/picture?type=large", "display_name": "\u0394\u03ad\u03c3\u03c0\u03bf\u03b9\u03bd\u03b1 \u0398\u03c9\u03bc\u03b1\u0390\u03b4\u03b7", "link": "https://stackoverflow.com/users/11370499/%ce%94%ce%ad%cf%83%cf%80%ce%bf%ce%b9%ce%bd%ce%b1-%ce%98%cf%89%ce%bc%ce%b1%ce%90%ce%b4%ce%b7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1555445415, "creation_date": 1555444833, "question_id": 55715794, "link": "https://stackoverflow.com/questions/55715794/void-function-that-returns-average-max-min-and-takes-as-parameter-an-array-and-t", "title": "Void function that returns average,max,min,and takes as parameter an array and the number of inputs", "body": "<p>So I'm trying to create a program that returns the average ,min and max from a void function. I can't really see what is wrong with the code and I'm hoping someone can help.The compiler doesn't find any error or warning but when i run the program i get \"Process exited with return value 3221225477\".\nThe problem seems to be in the function i created.\nThanks in advance.</p>\n\n<pre><code>    void emporeuma(double array[], int plithos, double* avg, double* max, \n    double* min, int* plit)\n    {\n    int j;\n    double sum;\n    avg=0;\n    sum=0;\n   *plit=plithos;\n    for(j=0;j&lt;plithos-1;j++){\n\n     sum=sum + array[j];\n        }\n    *avg=sum/plithos;\n     *min=array[0];\n     *max=array[0];\n     for(j=1;j&lt;plithos-1;j++)\n     {\n       if (array[j]&gt;*max)\n        {\n          array[j]=*max;\n           }\n\n       if (array[j]&lt;*min)\n        {\n        array[j]=*min;\n         }\n\n         }\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "sleep"], "comments": [{"owner": {"reputation": 8374, "user_id": 3691891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcCUM.jpg?s=128&g=1", "display_name": "Arkadiusz Drabczyk", "link": "https://stackoverflow.com/users/3691891/arkadiusz-drabczyk"}, "edited": false, "score": 0, "creation_date": 1555447220, "post_id": 55715722, "comment_id": 98112978, "body": "Replace <code>printf</code> with <code>puts</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1555449331, "post_id": 55715722, "comment_id": 98113923, "body": "Voting to close: OP admits the MCVE they provided is different from the actual problem they are solving, suggest new question. To quote OP: <code>I tried adding the fflush(stdout); like you suggested, but it doesn&#39;t work for my code - probably because I&#39;m using mvprintw (from ncurses) instead of printf</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "is_accepted": false, "score": 1, "last_activity_date": 1555444756, "creation_date": 1555444756, "answer_id": 55715770, "question_id": 55715722, "link": "https://stackoverflow.com/questions/55715722/how-do-i-implement-the-sleep-function-in-my-for-loop-correctly-ubuntu/55715770#55715770", "title": "How do I implement the sleep function in my for loop correctly? (Ubuntu)", "body": "<p>In UNIX, process streams buffer - they accumulate I/O and do not \"flush\" to the underlying device immediately on write, per default.  So - you need to flush the stream:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n\n{\n    for (int i = 0; i &lt; 21; i++)\n    {\n        printf(\"Hello\");\n        fflush(stdout);\n        sleep(1);           \n    }\n\n}\n</code></pre>\n\n<p>It would also work if you output a newline '\\n' after \"Hello\", I believe.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 10614090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db4ada90893e9ee7e67ab3c47151f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Sawy3r", "link": "https://stackoverflow.com/users/10614090/sawy3r"}, "edited": false, "score": 0, "creation_date": 1555449074, "post_id": 55715826, "comment_id": 98113811, "body": "Is there a way to use another function to achieve the same thing? I tried adding the <code>fflush(stdout);</code> like you suggested, but it doesn&#39;t work for my code - probably because I&#39;m using <code>mvprintw</code> (from ncurses) instead of <code>printf</code>. I thought I would be able to apply the same solution but apparently not. Is there something else I can use instead of sleep?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 83, "user_id": 10614090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db4ada90893e9ee7e67ab3c47151f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Sawy3r", "link": "https://stackoverflow.com/users/10614090/sawy3r"}, "edited": false, "score": 0, "creation_date": 1555449287, "post_id": 55715826, "comment_id": 98113902, "body": "@Sawy3r it would be of tremendous help for you and people answering your question if your MCVE is actually MCVE. You now have two answers which took your question on it&#39;s face value. I suggest you ask a <b>different</b> question with proper MCVE."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1555444986, "creation_date": 1555444986, "answer_id": 55715826, "question_id": 55715722, "link": "https://stackoverflow.com/questions/55715722/how-do-i-implement-the-sleep-function-in-my-for-loop-correctly-ubuntu/55715826#55715826", "title": "How do I implement the sleep function in my for loop correctly? (Ubuntu)", "body": "<p><code>printf</code> output is buffered - which means, it is not guaranteed to appear on the screen immediately. Rather, it appears when one of the following happens:</p>\n\n<ul>\n<li>when the buffer becomes full, - at which time the old contents of buffer is displayed to the screen and the buffer is cleared fresh for the new output - this is called <em>buffer flushing</em></li>\n<li>when the application terminates - which forces flushing of all the <code>printf</code> buffers, and this is what you see on the screen</li>\n<li>When buffer is flushed by the programmer.</li>\n</ul>\n\n<p>The last case is most interesting for you, and there are two ways you can do this - either include <code>\\n</code> (new line) control character in your string, like </p>\n\n<pre><code> printf(\"Hello\\n\");\n</code></pre>\n\n<p>or call <code>fflush</code> for stdout stream, like</p>\n\n<pre><code> printf(\"Hello\");\n fflush(stdout);\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 10614090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db4ada90893e9ee7e67ab3c47151f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Sawy3r", "link": "https://stackoverflow.com/users/10614090/sawy3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1555444986, "creation_date": 1555444580, "question_id": 55715722, "link": "https://stackoverflow.com/questions/55715722/how-do-i-implement-the-sleep-function-in-my-for-loop-correctly-ubuntu", "title": "How do I implement the sleep function in my for loop correctly? (Ubuntu)", "body": "<p>I'm trying to make my code print something to the screen, then wait 1 second, then go around the for loop and print it again 21 times. It works when I do this in Windows in CodeBlocks by using #include  and then Sleep(1000). But when I'm doing it on my Ubuntu VM by using #include  and sleep(1), everything disappears from my terminal for 21 seconds then all appears at once. I think I'm using the wrong function or something.</p>\n\n<p>Any ideas?</p>\n\n<p>This is the code in Ubuntu terminal which ends up removing everything already on my terminal, waits 21 seconds then just prints \"Hello\" 21 times.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n\n{\n    for (int i = 0; i &lt; 21; i++)\n    {\n        printf(\"Hello\");\n        sleep(1);           \n    }\n\n}\n</code></pre>\n\n<p>This is the code in Windows which prints \"Hello\" every second for 21 seconds therefore printing 21 Hello's on my screen over 21 seconds. Which is what I'm trying to achieve in my Ubuntu VM.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;windows.h&gt;\n\n    int main() {\n        for (int i = 0; i &lt; 21; i++)\n        {\n            printf(\"Hello\");\n            Sleep(1000);\n        }\n\n        return 0; \n    }\n</code></pre>\n"}, {"tags": ["c", "select", "fuse"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555471129, "post_id": 55716139, "comment_id": 98118719, "body": "Thanks for the reply. Yes there is no such mechanism to get automatically unblocked on spcae availability. But in my case the APPLICATION_2 actually does this. And the APPLICATION_2 on available space will send a POLLOUT event on the fd_write on which APPLICATION_1 is waiting. Well that&#39;s my plan.  But here the issue is SELECT is not getting blocked on the APPLICATION_1, it&#39;s immediately getting unblocked and the fd_write is getiing set immediately as if something is there on the FD. But APPLICATION_2 is not setting that FD(fd_write) for sure."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555471379, "post_id": 55716139, "comment_id": 98118774, "body": "The select is not getting blocked because the lack of space does not make the descriptor unready for writing. That a write will produce an error (such as out of space) doesn&#39;t mean the descriptor isn&#39;t ready for that write. You can only wait for something that would block."}, {"owner": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555473728, "post_id": 55716139, "comment_id": 98119248, "body": "My intention is to Block APPLICATION_1 (so that it do not write() anything) unless APPLICATION_2 sends POLLOUT. Sending POLLOUT from APPLICATION_2 is working. But how do I block APPLICATION_1?  Thanks for the patience though."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555473905, "post_id": 55716139, "comment_id": 98119282, "body": "@Shantanu As I said, you can&#39;t. There is no way to block until space is available. The descriptor is ready when it could not block and it could not block."}, {"owner": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555474377, "post_id": 55716139, "comment_id": 98119383, "body": "In my case write() is getting ENOSPC. So, in that condition I am trying to Block it using SELECT(). But it&#39;s getting unblocked immediately."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "edited": false, "score": 0, "creation_date": 1555475213, "post_id": 55716139, "comment_id": 98119562, "body": "@Shantanu Right. Because, as I explained, the descriptor is ready for writing now since it will not block. So you cannot wait for space to be available because the descriptor is ready for writing whether or not space is available. If an operation will produce an error, so long as that error is not &quot;would have blocked&quot;, the descriptor is ready for that operation and so there is nothing to wait for."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1555446525, "creation_date": 1555446525, "answer_id": 55716139, "question_id": 55715670, "link": "https://stackoverflow.com/questions/55715670/select-to-block-on-receving-enospc-while-write/55716139#55716139", "title": "Select to Block on Receving ENOSPC while write", "body": "<p>There is no supported mechanism for getting automatically unblocked when space is available on a device. You will have to retry periodically.</p>\n"}], "owner": {"reputation": 27, "user_id": 1201257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNRAQ.jpg?s=128&g=1", "display_name": "Shantanu", "link": "https://stackoverflow.com/users/1201257/shantanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555446525, "creation_date": 1555444270, "question_id": 55715670, "link": "https://stackoverflow.com/questions/55715670/select-to-block-on-receving-enospc-while-write", "title": "Select to Block on Receving ENOSPC while write", "body": "<p>My Application is continuously writing on a file through fuse. And whenever there is no space available in file my application should wait untill space is available.\nSo, basically my Complete System is like the following:\nTop Layer: Application_1\nMiddle Layer: libfuse\nLower Layer: Application_2</p>\n\n<p>Now, Application_1 is continuously calling write on a file which is available in Application_2 through the libfuse. So, at certain instance the Application_2 cannot accomodate data and it returns ENOSPC to Application_1. On receiving ENOSPC Application_1 must wait on the file FD to receive POLLOUT. And on receiving the POLLOUT on the file it must resume write(). </p>\n\n<p>For this I am using the SELECT() api to wait on the file_fd to receive the POLLOUT. Hence, on ENOSPC I am doing following:</p>\n\n<pre><code>           fd_set fdSetWrite;\n           FD_ZERO(&amp;fdSetWrite);\n           FD_SET(fd_write, &amp;fdSetWrite);\n           if (-1 == select(fd_write + 1, NULL, &amp;fdSetWrite,NULL,0))\n           {\n              printf(\"\\n\\t\\t error select \");\n              close(fd_write);\n              exit(0);\n           }\n           else\n              printf(\"Select is unblocked\\n\");\n\n           if (FD_ISSET(fd_write, &amp;fdSetWrite))\n           {\n              printf(\"Write FD is Set\");\n           }\n</code></pre>\n\n<p>But what I can see is the select() is getting unblocked immediately. Application_2 is not setting POLLOUT event here. I had blocked that for confirmation. But it is getting unblocked.</p>\n\n<p>Really don't know how this is happening.</p>\n"}, {"tags": ["c", "logic"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1555443852, "post_id": 55715475, "comment_id": 98111590, "body": "Use a counter and linked lists."}, {"owner": {"reputation": 17, "user_id": 10604736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020b4dca4bb3b397cb72932e5d35ac1?s=128&d=identicon&r=PG&f=1", "display_name": "DragonBase", "link": "https://stackoverflow.com/users/10604736/dragonbase"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1555444091, "post_id": 55715475, "comment_id": 98111682, "body": "Sorry I dont quite get it. How can a list help me here?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1555444203, "post_id": 55715475, "comment_id": 98111740, "body": "A <i>linked</i> list. If you have a list where each structure has a pointer to the next structure (in order of priority) your job will be much easier."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555444397, "post_id": 55715475, "comment_id": 98111813, "body": "There are many ways to approach this problem. You should give more of the context it arises in\u2014show the course assignment you were given. A simple way to approach it is to write code that goes through a list of the <code>Cars</code> and compares each one to the best one so far. When it finds a car with a greater claim to priority than the best so far, it updates the best so far.\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555444422, "post_id": 55715475, "comment_id": 98111826, "body": "\u2026 More complicated approaches include sorting the list of cars by the priority of their claim, maintaining a list in sorted order and inserting new cars in the list in their appropriate position, and using more sophisticated data structures to maintain information about order. Which you should use depends on where you are in your studies, what the course is teaching, and what the specific assignment is."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555444486, "post_id": 55715475, "comment_id": 98111858, "body": "To start, though, it would probably be helpful to write a function that takes two parameters, a <code>struct Cars A</code> and a <code>struct Cars B</code>, and returns a value that indicates whether, between just <code>A</code> and <code>B</code>, <code>A</code> should go first or <code>B</code> should go first."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1555444563, "post_id": 55715475, "comment_id": 98111902, "body": "Also think about how you want to handle when cars pass through the intersection. Are they removed from the list and the job then is just picking a car from those remaining in the list? Or are they kept in the list but marked in some way as having passed through? In the latter case, how does that affect the function I suggested in my previous comment?"}, {"owner": {"reputation": 17, "user_id": 10604736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020b4dca4bb3b397cb72932e5d35ac1?s=128&d=identicon&r=PG&f=1", "display_name": "DragonBase", "link": "https://stackoverflow.com/users/10604736/dragonbase"}, "edited": false, "score": 0, "creation_date": 1555444857, "post_id": 55715475, "comment_id": 98112018, "body": "When the car is done passing the intersection, another variable of the object changes and the state of the car is set in another way, but the priority doesnt change. This is an embedded application, for a computer engineering assignment. There are 4 cars in the intersection, and the rule of determining which car gets which priority to pass is determined by the order of the cars that reached the intersection. This isnt too important though"}, {"owner": {"reputation": 17, "user_id": 10604736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020b4dca4bb3b397cb72932e5d35ac1?s=128&d=identicon&r=PG&f=1", "display_name": "DragonBase", "link": "https://stackoverflow.com/users/10604736/dragonbase"}, "edited": false, "score": 0, "creation_date": 1555444916, "post_id": 55715475, "comment_id": 98112044, "body": "The function that compares the priorities of two cars sounds pretty easy, but I do have to write a program that is the same and runs on ALL cars."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10604736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020b4dca4bb3b397cb72932e5d35ac1?s=128&d=identicon&r=PG&f=1", "display_name": "DragonBase", "link": "https://stackoverflow.com/users/10604736/dragonbase"}, "edited": false, "score": 0, "creation_date": 1555446092, "post_id": 55715781, "comment_id": 98112544, "body": "Hmm yes it could work for me, I do need to modify it a bit for what I need, but it&#39;s the closest to what I want so far. Thanks for the help mate"}], "tags": [], "owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "is_accepted": true, "score": 0, "last_activity_date": 1555445111, "last_edit_date": 1555445111, "creation_date": 1555444809, "answer_id": 55715781, "question_id": 55715475, "link": "https://stackoverflow.com/questions/55715475/how-to-order-structure-instances-based-on-the-value-of-a-member/55715781#55715781", "title": "How to order structure instances based on the value of a member", "body": "<p>You might be better first with a 'passed' variable as part of Cars and actually maybe rename Cars to Car as it represents just one car. It might help you visualize the problem better.</p>\n\n<pre><code>struct Car{\n    int priority;\n    int passed; // lets set this to 1 if passed\n};\n</code></pre>\n\n<p>And an intersection structure</p>\n\n<pre><code>struct Intersection\n{\n    struct Car cars[4]; // let's give an intersection 4 cars\n}\n</code></pre>\n\n<p>Set up the intersection structure with some cars, initializing their 'passed' variable to 0 meaning 'not passed'. </p>\n\n<pre><code>struct Intersection intersection;\n\n// set the car priority\nintersection.cars[0].priority = 2;\nintersection.cars[1].priority = 1;\nintersection.cars[2].priority = 3;\nintersection.cars[3].priority = 0;\n\nintersection.cars[0].passed = 0;\nintersection.cars[1].passed = 0;\nintersection.cars[2].passed = 0; /** Could do a loop here to initialize instead! */\nintersection.cars[3].passed = 0;\n</code></pre>\n\n<p>You can use a loop, looping until all cars have passed</p>\n\n<p>An example program (not terribly efficient) as I'm taking into account the possibility you are new to C and have probably not yet learned the likes of linked lists or pointers etc.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    struct Car{\n        int priority;\n        int passed;\n    };\n\n    // four cars per intersection\n    struct Intersection{\n        struct Car cars[4];\n    };\n\n    struct Intersection intersection;\n\n    // set the car priority\n    intersection.cars[0].priority = 2;\n    intersection.cars[1].priority = 1;\n    intersection.cars[2].priority = 3;\n    intersection.cars[3].priority = 0;\n\n    intersection.cars[0].passed = 0;\n    intersection.cars[1].passed = 0;\n    intersection.cars[2].passed = 0;\n    intersection.cars[3].passed = 0;\n\n    // keep looping until all cars passed\n    while (!intersection.cars[0].passed ||\n        !intersection.cars[1].passed ||   /* &lt;--- this could be improved !! */\n        !intersection.cars[2].passed ||\n        intersection.cars[3].passed)\n    {\n\n        int best_priority = -1;\n        int best_car_index = -1;\n\n        // look for next car that can pass\n        for (int i = 0; i &lt; 4; i++)\n        {\n            // this car hasn't passed yet -- check priority\n            if (!intersection.cars[i].passed)\n            {\n                           // if not found a car yet to pass or this car is better, then choose this one so far...                  \n                if ((best_priority == -1) || (intersection.cars[i].priority &lt; best_priority))\n                {\n                    best_car_index = i;\n                    best_priority = intersection.cars[i].priority;\n                }\n            }\n        }\n\n        if (best_car_index == -1)\n            break; // nothing found\n        else\n        {\n            // set the car with best priority to 'passed'\n            intersection.cars[best_car_index].passed = 1;\n\n            printf(\"Car ID %d with priority %d just passed the intersection!\\r\\n\", best_car_index, best_priority);\n        }\n    }\n\n    return 0;\n\n}\n</code></pre>\n\n<p>Program output</p>\n\n<pre><code>Car ID 3 with priority 0 just passed the intersection!\nCar ID 1 with priority 1 just passed the intersection!\nCar ID 0 with priority 2 just passed the intersection!\nCar ID 2 with priority 3 just passed the intersection!\n</code></pre>\n\n<p>The program probably doesn't do what you want but hopefully you'll be able to manipulate it the way you want. </p>\n\n<p>(You could fill a new list instead of printing the data)</p>\n"}], "owner": {"reputation": 17, "user_id": 10604736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020b4dca4bb3b397cb72932e5d35ac1?s=128&d=identicon&r=PG&f=1", "display_name": "DragonBase", "link": "https://stackoverflow.com/users/10604736/dragonbase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55715781, "answer_count": 1, "score": 0, "last_activity_date": 1555447519, "creation_date": 1555443334, "last_edit_date": 1555447519, "question_id": 55715475, "link": "https://stackoverflow.com/questions/55715475/how-to-order-structure-instances-based-on-the-value-of-a-member", "title": "How to order structure instances based on the value of a member", "body": "<p>I'm trying to make an algorithm for cars passing through an intersection. I'm currently having problems on deciding which car is supposed to cross depending on other cars's priority.</p>\n\n<p>Here's an example code of what I'm doing</p>\n\n<pre><code>int main(void)\n{\n    struct Cars{\n        int priority;\n    };\n\n    struct Cars c1;\n    struct Cars c2;\n    struct Cars c3;\n    struct Cars c4;\n\n    c1.priority=2;\n    c2.priority=1;\n    c3.priority=3;\n    c4.priority=0;\n\n    int Priorities[4] = {c1.priority,c2.priority,c3.priority,c4.priority};\n\n    int Order[4];\n}\n</code></pre>\n\n<p>What I am trying to do is trying to figure how to fill the Order array with the id of the car that is next to pass.\nAs in this example I want the Order array to be [4,2,1,3]. 0 being highest priority, 3 lowest</p>\n\n<p>Although you could help me even more if you can help me figure out WHICH CAR has \nwhich priority so I could write some if's like:</p>\n\n<pre><code>if(the car with priority 0 has passed AND the car with priority 1 has passed)\n{\n    car with priority 2 can pass\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "optimization", "profiling", "cpu"], "comments": [{"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1555443096, "post_id": 55715302, "comment_id": 98111275, "body": "Using a textual format for your image is easily going to be the biggest bottleneck here."}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1555443179, "post_id": 55715302, "comment_id": 98111314, "body": "It&#39;s part of the specification that I read/write in textual format @ybungalobill"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1555443254, "post_id": 55715302, "comment_id": 98111344, "body": "Try reading the full file before the loop into a buffer and <code>sscanf</code> from the buffer, then write the result into a separate buffer and write the result to file at the end."}, {"owner": {"reputation": 1514, "user_id": 6751133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I9Jqg.png?s=128&g=1", "display_name": "Lulceltech", "link": "https://stackoverflow.com/users/6751133/lulceltech"}, "edited": false, "score": 0, "creation_date": 1555444963, "post_id": 55715302, "comment_id": 98112069, "body": "This should be on CodeReview not StackOverflow"}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1555445475, "post_id": 55715302, "comment_id": 98112277, "body": "I had no idea CodeReview was a thing. Would you suggest I post on there?"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1555446426, "post_id": 55715302, "comment_id": 98112682, "body": "@p.luck: Is your code even correct? You read sequential 16 pixels from <b>one row</b> and then average <i>them</i> into one pixel."}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1555447880, "post_id": 55715302, "comment_id": 98113296, "body": "@ybungalobill You are correct, I had problems reading the data in a non-linear fashion. I can kind of get the program functioning on one PPM image and it seems to pixelate it okay, so I have decided to leave it as it is for the time being."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555609211, "post_id": 55715302, "comment_id": 98179004, "body": "OT: regarding: <code>pixel *data = (pixel *)calloc(width * height, sizeof(pixelInt))</code>  1)  the returned type, in C, is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug,  Suggest removing that &#39;cast&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555609359, "post_id": 55715302, "comment_id": 98179075, "body": "the posted code fails to take into account that row of pixels must contain a count of pixels that is a multiple of 2.  So always have to round up the &#39;width&#39; to a multiple of 2"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555609511, "post_id": 55715302, "comment_id": 98179138, "body": "When asking a question, about a runtime problem, as this question is doing, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555609676, "post_id": 55715302, "comment_id": 98179200, "body": "regarding: <code>typedef struct {                                &#47;&#47;struct holding RGB type unsigned char     unsigned char r, g, b;  &#47;&#47;3 bytes } pixel;</code>  one of the fields in the image header states how many bites are in each pixel.  Depending on the specific image, that can be 1byte, 2bytes, 3bytes, 4bytes per pixel"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555609976, "post_id": 55715302, "comment_id": 98179333, "body": "OT:  variable (and parameter) names should indicate <code>content</code> or <code>usage</code>  (or better, both).  Names like <code>xx</code> <code>yy</code> <code>bx</code> <code>by</code>, etc are meaningless, even in the current context.  I.E. Please use meaningful names, not 1 or 2 letter random sequences"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555610143, "post_id": 55715302, "comment_id": 98179416, "body": "the posted code is failing to check that the <code>4x4</code> grid does not exceed the boundary of the pixel data Either horizontally nor vertically"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555610394, "post_id": 55715302, "comment_id": 98179532, "body": "regarding: <code>f_output</code>  The expectation is that this a <code>FILE *</code>  but such a file is never opened (not closed) in the posted code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555610747, "post_id": 55715302, "comment_id": 98179700, "body": "OT: when calling any of the heap allocation functions: <code>malloc()</code> <code>calloc()</code> <code>realloc()</code> Always check (!=NULL) the returned value to assure the operation was successful.  If not successful, then call <code>perror()</code>, cleanup, then call <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555611212, "post_id": 55715302, "comment_id": 98179886, "body": "regarding: <code>int width, height;    &#47;&#47;image variable declarations  &#47;&#47;Raw 1 dimensional store of pixel data - will contain all the data for each pixel in the image pixel *data = (pixel *)calloc(width * height, sizeof(pixelInt));</code>   The variables <code>width</code> and <code>height</code> are being used uninitialized"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1555611965, "post_id": 55715302, "comment_id": 98180191, "body": "regarding: <code>&#47;&#47;average pixel color of cell                         cell_tot.r += r;                         cell_tot.g += g;                         cell_tot.b += b;</code>  This contains the sum of ALL the pixels, not just one row or one 4x4 block"}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1555766211, "post_id": 55715302, "comment_id": 98220279, "body": "@user3629249 Really appreciate the effort you went through to help me, I&#39;ve used your advice and have changed my code to function correctly."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1555448474, "post_id": 55716186, "comment_id": 98113542, "body": "Thanks for posting your optimised solution. Can I ask what data type you declared variable <code>c</code> as in your code? If I define it as <code>unsigned int c = 0</code> I get this exception: <code>Unhandled exception at 0x008D1169 in Assignment.exe: 0xC0000094: Integer division by zero</code> on this line: <code>unsigned *accum = (unsigned*)malloc(6 * sizeof(unsigned)*w);</code>"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "reply_to_user": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1555448609, "post_id": 55716186, "comment_id": 98113606, "body": "@p.luck: <code>c</code> is the variable from your code and equals <code>4</code> in your example."}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1555449614, "post_id": 55716186, "comment_id": 98114022, "body": "Of course- sorry, I wasn&#39;t thinking straight. I am however getting <code>Assignment.exe has triggered a breakpoint.</code> on the line <code>fwrite(line, 12 * w, 1, f_output);</code>. Any idea what&#39;s causing this?"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "reply_to_user": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1555449888, "post_id": 55716186, "comment_id": 98114136, "body": "@p.luck: hmm, it&#39;s really hard to tell. Make sure that <code>w</code> and <code>width</code> are correct and that <code>width</code> is divisible by <code>c</code>. Double-check that you copied everything correctly."}], "tags": [], "owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "is_accepted": true, "score": 2, "last_activity_date": 1555448846, "last_edit_date": 1555448846, "creation_date": 1555446743, "answer_id": 55716186, "question_id": 55715302, "link": "https://stackoverflow.com/questions/55715302/how-to-optimise-an-image-pixelation-program/55716186#55716186", "title": "How to optimise an image pixelation program", "body": "<p>On a 1024x1024 image on my machine your code executes in <code>0.325s</code>. The following code executes in <code>0.182s</code>:</p>\n\n<pre><code>unsigned w = width/c, h = height/c;\nunsigned *accum = (unsigned*)malloc(3*sizeof(unsigned)*w);\nchar *line = (char*)malloc(12*w);\nunsigned denom = c*c;\n\n//Loop through entire input image \nfor (int yy = 0; yy &lt; h; ++yy)\n{\n    memset(accum, 0, 3*sizeof(unsigned)*w);\n\n    // read and accumulate c lines\n    for(int y = 0; y &lt; c; ++y)\n    {\n        for (int xx = 0; xx &lt; w; ++xx)\n        {\n            for (int x = 0; x &lt; c; ++x)\n            {\n                unsigned char r, g, b;\n                fscanf(f, \"%hhu %hhu %hhu\", &amp;r, &amp;g, &amp;b);\n                accum[3*xx+0] += r;\n                accum[3*xx+1] += g;\n                accum[3*xx+2] += b;\n            }\n        }\n    }\n\n    // format a line\n    for(int xx = 0; xx &lt; w; ++xx)\n    {\n        char *cell = line + 12*c*xx; \n        snprintf(cell, 12, \"%3u%4u%4u\", accum[3*xx]/denom, accum[3*xx+1]/denom, accum[3*xx+2]/denom);\n        cell[11] = '\\t';\n        for(int x = 1; x &lt; c; ++x)\n            memcpy(cell + 12*x, cell, 12);\n    }\n\n    // write it out times c\n    line[12*w-1] = '\\n';\n    for(int y = 0; y &lt; c; ++y)\n        fwrite(line, 12*w, 1, f_output);\n}\n</code></pre>\n\n<p>The trick here is to format the averaged values only once and then duplicate the formatted strings. Also by acting on one row at a time I have better chances of utilizing the memory caches.</p>\n\n<p>To go beyond that you would need to re-implement the <code>fscanf</code> to parse the integers faster.</p>\n"}], "owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55716186, "answer_count": 1, "score": 2, "last_activity_date": 1555448846, "creation_date": 1555442610, "last_edit_date": 1555442697, "question_id": 55715302, "link": "https://stackoverflow.com/questions/55715302/how-to-optimise-an-image-pixelation-program", "title": "How to optimise an image pixelation program", "body": "<p>I have written some serial code which I would like to optimise as much as possible before I parallelise it using OpenMP. The program reads in a PPM file by iterating through the pixel data in 4x4 cells (variable <code>c</code>),  then it finds the average RGB value of each of those 4x4 cells, and then finally writes to a new file by outputing the average colour value, again of each of the 4x4 cells. This creates a sort of mosaic/pixelation effect. </p>\n\n<p>Having performance profiled my code, the main bottlenecks are <code>fscanf</code> and <code>fprintf</code>. I am ignoring execution time to read/write to disk, so these two functions do not matter. </p>\n\n<p>My effort to optimise so far: </p>\n\n<ul>\n<li><p>Loop jamming: There are two nested FOR loops within the code which have the exact same loop conditions. However, the second set of nested FOR loops requires that the functions needed to calculate the average RGB value are kept outside of that specific set. The average RGB value calculations are then needed for use in the third set of nested FOR loops (which have the same loop conditions as the second set). Because of this, I have struggled to combine the second and third sets of nested FOR loops despite their similarity. </p></li>\n<li><p>Loop invariant computations: I have tried to move certain operations outside of the loop where possible, but this has proven to be difficult. </p></li>\n</ul>\n\n<p><strong>To summarise:</strong> How can I optimise this program to reduce the execution time as much as possible? </p>\n\n<p>My code: </p>\n\n<pre><code>typedef struct {                                //struct holding RGB type int\n    int r, g, b;    //12 bytes\n} pixelInt;\ntypedef struct {                                //struct holding RGB type unsigned char\n    unsigned char r, g, b;  //3 bytes\n} pixel;\n\nint c = 4;             // Variable of 4x4 grids\nint width, height;    //image variable declarations\n\n//Raw 1 dimensional store of pixel data - will contain all the data for each pixel in the image\npixel *data = (pixel *)calloc(width * height, sizeof(pixelInt));\n\n//Loop through entire input image \n        for (int yy = 0; yy &lt; height; yy += c)\n        {\n            for (int xx = 0; xx &lt; width; xx += c)\n            {\n                //the total colour of cell of size 'c'\n                pixelInt cell_tot = { 0, 0, 0 };        //zero initialize struct containing mosaic cell pixel totals.\n\n                unsigned int counter = 0; //the counter for how many pixels are in a 4x4 cell\n\n                int bx = xx + c;  //used in loop conditions\n                int by = yy + c;\n\n                // Store each color from the cell into cell_tot struct\n                for (int y = yy; y &lt; by; y++)\n                {\n                    for (int x = xx; x &lt; bx; x++)\n                    {\n                        unsigned int index_1d = x + y * width;      //calculate 1d index from x-index (x), y-index(y) and width;\n\n                        unsigned char r, g, b; //maximum vales are 255, i.e. unsigned char data type                    \n\n                        fscanf(f, \"%hhu %hhu %hhu\", &amp;r, &amp;g, &amp;b); //%hhu is unsigned char specifier\n\n                        //store the pixel value into data array\n                        data[index_1d].r = r;\n                        data[index_1d].g = g;\n                        data[index_1d].b = b;\n\n                        counter++; //increment counter\n\n                        //average pixel color of cell\n                        cell_tot.r += r;\n                        cell_tot.g += g;\n                        cell_tot.b += b;\n\n                    }\n                }\n\n                //average colour of cell found by dividing cell total by loop counter \n                pixel cell_average;\n                cell_average.r = cell_tot.r / counter;\n                cell_average.g = cell_tot.g / counter;\n                cell_average.b = cell_tot.b / counter;\n\n                //Loop through the new image in cells of size c \n                for (int y = yy; y &lt; by; y++)\n                {\n                    for (int x = xx; x &lt; bx; x++)\n                    {\n                        unsigned int index_1d = x + y * width;      //calculate 1d index from x-index (x), y-index(y) and width;\n\n                        //Assign average cell value to the pixels in the cell\n                        data[index_1d].r = cell_average.r;\n                        data[index_1d].g = cell_average.g;\n                        data[index_1d].b = cell_average.b;\n\n                        //Output the average colour value for the image  \n                        fprintf(f_output, \"%hhu %hhu %hhu \\t\", data[index_1d].r, data[index_1d].g, data[index_1d].b);\n                    }\n                    fprintf(f_output, \"\\n\");    //Prints new line \n                }\n            }\n        } \n</code></pre>\n"}]