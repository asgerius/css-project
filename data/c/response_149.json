[{"tags": ["c", "file", "sorting"], "comments": [{"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "reply_to_user": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1510790394, "post_id": 47319209, "comment_id": 81589891, "body": "@MitchWheat but if I take the sort criteria as a string from command line, how can I access the member of struct? If copying into the rows of sort criteria makes it slower, is it better to write sorting functions for all the cases?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1510792057, "post_id": 47319209, "comment_id": 81590308, "body": "It <b>really</b> depends on what you would do with that structure later, but I&#39;d personally go for dynamic array and quicksort. If your file size will differ largely, maybe the binary tree is a good approach"}, {"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1510792332, "post_id": 47319209, "comment_id": 81590381, "body": "@Fureeish Hi thanks for the feedback! What if I need to go for merge sort? Is linked list a good data structure for fast performance?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1510792943, "post_id": 47319209, "comment_id": 81590561, "body": "<code>malloc</code> and <code>quicksort</code> are easiest and fastest, it should be option 1. If you have an old computer from 30 years ago then you will find linked list is slightly faster."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1510792970, "post_id": 47319209, "comment_id": 81590572, "body": "No. Mergesort is preferred for Linked Lists, but it is so because other sorts are either impossible to implement or really inefficient for this data structure. Your best average performance would be array + quicksort, but if you are stuck using Mergesort, use either of those two. The problem here lies in the fact that Mergesort, in addition to having time complexity of <code>O(n*log_2(n))</code>, also uses additional <code>O(n)</code> space, thus it will be <b>really</b> inefficient in your &quot;<i>file with a large quantity of records</i>&quot;."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1510797516, "post_id": 47319209, "comment_id": 81591779, "body": "@Fureeish - merge sort for a linked list list does not require O(n) space. For bottom merge sort, a fixed size array of pointers to nodes is used to hold intermediate list (O(1) space). Top down merge sort for linked lists is inefficient due to scanning of lists to split them."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1510799824, "post_id": 47319209, "comment_id": 81592347, "body": "@rcgldr very good point, sir"}, {"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1510802400, "post_id": 47319209, "comment_id": 81593058, "body": "@barmarkShemirani  Hi I think I am going to use quicksort but I&#39;m concerning if quicksort raise security problems when the file I am sorting is significantly large?"}, {"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1510803619, "post_id": 47319209, "comment_id": 81593348, "body": "And how about hashmap? will it be faster If I hash the index and make a hashmap?"}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1510798053, "creation_date": 1510798053, "answer_id": 47320391, "question_id": 47319209, "link": "https://stackoverflow.com/questions/47319209/c-sorting-records-from-a-file/47320391#47320391", "title": "C Sorting records from a file", "body": "<p>Sorting an array of pointers to structures would be faster than sorting a linked list of structures. If the structures aren't too big, then directly sorting an array of structures would be faster than sorting an array of pointers to structures, but this means using O(n) space (a temporary array) if using merge sort.</p>\n\n<p>Since your structures have pointers to strings, merge sort should be faster than quick sort. Merge sort does more moves, but fewer compares than quick sort, and in this case, it's mostly moving pointers, but having to compare strings.</p>\n\n<p>It may be faster to have fixed sized structures with maximum length allocated for the strings, so that the strings are moved during the sort. If the strings aren't too big, this will help with cache locality during the sort.</p>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1510898096, "post_id": 47341808, "comment_id": 81640121, "body": "Hi thanks for the feedback! But if I remove the sort criteria and Im getting the sort criteria from the command line as string, how can my program access the correct struct members?"}, {"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1510898393, "post_id": 47341808, "comment_id": 81640241, "body": "Also isn&#39;t quicksort comes with security issue when dealing with large quantity of records? For a more stable sorting algorithm such as mergesort, wouldn&#39;t sorting an array of pointers takes more time for swapping elements (copying) than linked list?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1510952229, "post_id": 47341808, "comment_id": 81671004, "body": "@woshidashen, using an array of pointers, separate from the actual data, means ONLY the pointers in the array of pointers needs to be moved.  I&#39;m not familiar with any security risk with using the quicksort function.  You could use what ever algorithm for sorting you want, including a mergesort.  Just remember that the only data movement is the pointers, so there is no need to have a linked list"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1510881423, "creation_date": 1510881423, "answer_id": 47341808, "question_id": 47319209, "link": "https://stackoverflow.com/questions/47319209/c-sorting-records-from-a-file/47341808#47341808", "title": "C Sorting records from a file", "body": "<p>in general, you will not need the sort criteria listed in each instance of the struct, so suggest removing those two fields.</p>\n\n<p>The quickest way to sort, is to not have to perform a 'deep copy' of each of the data fields that are being pointed to by the <code>char*</code> fields.</p>\n\n<p>To avoid a deep copy (and even to avoid a simple copy of the struct instances.  Develop an array of pointers to the struct instances.\nThen implement something like a 'qsort()' that performs the comparisons in the fields of the struct instances, and actually only modifying the pointers to those instances.</p>\n\n<p>Then traversing the sorted array by traversing the array of pointers to the struct instances.</p>\n"}], "owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510881423, "creation_date": 1510789393, "last_edit_date": 1510803631, "question_id": 47319209, "link": "https://stackoverflow.com/questions/47319209/c-sorting-records-from-a-file", "title": "C Sorting records from a file", "body": "<p>Hi Everyone I am working on a project to sort a file with a large quantity of records based on the given criteria (name or age or gender or hometown) and write to the output file in the format of the original file. However I am debating what is the fastest approach to do so. The file contains records such as:</p>\n\n<pre><code>Name Age gender hometown\nAdam 28  Male   New york\nKevin 42 Male   Boston\n...\n</code></pre>\n\n<p>My thought is to read the file and create a linked-list of struct:</p>\n\n<pre><code>struct record\n{   \nchar * SortCriteriaString;\nint SortCriteriaInt;\nchar * Name;\nint Age;\nchar * Gender;\nchar * Hometown;};\n</code></pre>\n\n<p>and then mersort the linked list based on the criteria I read from command line and store in the SortCriteriaInt or SortCriteriaString members of the struct.</p>\n\n<p>Here is what I plan to do with this project. But I was asked to come up with the fastest sorter possible, so my question is: What are the fastest data structure and sorting algorithm for this task if not the one I described above? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 235857, "user_id": 65387, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c0377fc1b08293d3362611978913a32b?s=128&d=identicon&r=PG", "display_name": "mpen", "link": "https://stackoverflow.com/users/65387/mpen"}, "edited": false, "score": 0, "creation_date": 1510789743, "post_id": 47319207, "comment_id": 81589670, "body": "pretty sure you&#39;re comparing the pointer-value (offset of data in memory) to <code>&#39;0&#39;</code> rather than the character itself (<code>*p</code>)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5412127"}, "edited": false, "score": 0, "creation_date": 1510789769, "post_id": 47319237, "comment_id": 81589676, "body": "Thank you, I&#39;m still trying to fully wrap my head around pointers haha. First year computer eng student and everythings moving so quick.  Whats the difference between comparing *p with &#39;9&#39; and p with &#39;9&#39;"}, {"owner": {"reputation": 44103, "user_id": 6568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29526c0a49238ab7f1d375f0e63edd1a?s=128&d=identicon&r=PG", "display_name": "Dave Costa", "link": "https://stackoverflow.com/users/6568/dave-costa"}, "edited": false, "score": 0, "creation_date": 1510789956, "post_id": 47319237, "comment_id": 81589739, "body": "<code>p</code> is a pointer variable.  The value it actually contains is the address of another location in memory.  That&#39;s the value you are using when you simply write <code>p</code>.  <code>*p</code> means to get the value in the location that p points to.  In this case, since the type of <code>p</code> is <code>char *</code>, it would read <code>sizeof(char)</code> bytes at that location."}], "tags": [], "owner": {"reputation": 44103, "user_id": 6568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29526c0a49238ab7f1d375f0e63edd1a?s=128&d=identicon&r=PG", "display_name": "Dave Costa", "link": "https://stackoverflow.com/users/6568/dave-costa"}, "is_accepted": false, "score": 2, "last_activity_date": 1510789585, "creation_date": 1510789585, "answer_id": 47319237, "question_id": 47319207, "link": "https://stackoverflow.com/questions/47319207/how-to-compare-if-a-char-is-greater-than-or-equal-to-another-string-number/47319237#47319237", "title": "How to compare if a char* is greater than or equal to another string/number?", "body": "<p>Well, if what you want to do is test whether the first character of the string is between '0' and '9', you should do:</p>\n\n<pre><code>(*p &gt;= '0' &amp;&amp; *p &lt;= '9')\n</code></pre>\n\n<p>But if you want to compare strings as strings, the old school C library function for that is <code>strcmp</code>.  I'm sure these days there are lots of other libraries that may offer more functionality.</p>\n"}, {"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1510789638, "creation_date": 1510789638, "answer_id": 47319247, "question_id": 47319207, "link": "https://stackoverflow.com/questions/47319207/how-to-compare-if-a-char-is-greater-than-or-equal-to-another-string-number/47319247#47319247", "title": "How to compare if a char* is greater than or equal to another string/number?", "body": "<p><code>if(p&gt;='0' &amp;&amp; p&lt;='9'){</code></p>\n\n<p><code>p</code> is a <code>char*</code>, <code>'0'</code> is a char. Your compiler should have warned you about comparing incompatible types. Use <code>*p</code>  instead (same applies to <code>'9</code>' obviously). In my head <code>*p</code> gets read as \"contents of p\" (in this context)</p>\n\n<p>In the more general case, use <code>strcmp()</code> to compare strings.</p>\n\n<p>If your compiler did warn you about the bad compare: take it on board, most compiler warnings should be listened to and not ignored. If your compiler didn't warn you look up how to enable all the warnings.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5412127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510789638, "creation_date": 1510789383, "question_id": 47319207, "link": "https://stackoverflow.com/questions/47319207/how-to-compare-if-a-char-is-greater-than-or-equal-to-another-string-number", "title": "How to compare if a char* is greater than or equal to another string/number?", "body": "<p>I'm using scanf to input numbers and +,-,/ operators into a stack.</p>\n\n<pre><code>int scan = 1;\nchar * p = malloc(sizeof(char)*5);\nwhile (scan = 1) {\n    scanf(\"%1s\", p);\n    if(p&gt;='0' &amp;&amp; p&lt;='9'){\n        push(stack, p);\n        print(stack);\n    }\n}\n</code></pre>\n\n<p>Why does it never meet the condition? How can you compare strings?</p>\n"}, {"tags": ["c++", "c", "gcc", "makefile"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1047683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4e6acbea8dfe8e7ff22543c02b261ef?s=128&d=identicon&r=PG", "display_name": "Jacky Chen", "link": "https://stackoverflow.com/users/1047683/jacky-chen"}, "edited": false, "score": 0, "creation_date": 1510850609, "post_id": 47324753, "comment_id": 81621251, "body": "Thanks for the answer. But I don&#39;t want to patch and change libgnu. There was a elfutils-portabiliy.patch for elfutils to solve this issue but this patch had disappeared since 0.164 version. Any idea to fix this compilation error? And I can&#39;t send email to elfutils-devel@sourceware.org. Where should I send email to ask question on elfutils?"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 127, "user_id": 1047683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4e6acbea8dfe8e7ff22543c02b261ef?s=128&d=identicon&r=PG", "display_name": "Jacky Chen", "link": "https://stackoverflow.com/users/1047683/jacky-chen"}, "edited": false, "score": 0, "creation_date": 1510853756, "post_id": 47324753, "comment_id": 81623369, "body": "You either need to apply something like this patch or compile on Linux or one of the supported BSDs."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 2, "last_activity_date": 1510820529, "creation_date": 1510820529, "answer_id": 47324753, "question_id": 47319122, "link": "https://stackoverflow.com/questions/47319122/elfutils-compilation-error-implicit-function-declaration/47324753#47324753", "title": "elfutils compilation error implicit-function-declaration", "body": "<p>elfutils incorrectly uses <code>htobe64</code>, which is not in any standard and only available in glibc and a subset of the BSDs.</p>\n\n<p>Since you use GCC, you can use Ulf Hermann's patch to work around this issue:</p>\n\n<ul>\n<li><a href=\"https://sourceware.org/ml/elfutils-devel/2017-q2/msg00147.html\" rel=\"nofollow noreferrer\">Add replacement endian.h and byteswap.h to libgnu</a></li>\n</ul>\n\n<p>It adds an implementation of <code>htobe64</code> based on GCC built-in functions, so it is available when GCC is used as the compiler, independently of what the C library provides.</p>\n"}], "owner": {"reputation": 127, "user_id": 1047683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4e6acbea8dfe8e7ff22543c02b261ef?s=128&d=identicon&r=PG", "display_name": "Jacky Chen", "link": "https://stackoverflow.com/users/1047683/jacky-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1510820529, "creation_date": 1510788790, "question_id": 47319122, "link": "https://stackoverflow.com/questions/47319122/elfutils-compilation-error-implicit-function-declaration", "title": "elfutils compilation error implicit-function-declaration", "body": "<p>I downloaded elfutils 0.170 and 0.169, but can't use gcc to compile either of them because of implicit-function-declaration. I can't find any place in elfutils makefile which specifies -Werror or -Werror=implicit-function-declaration.  Any idea to fix this compilation error?</p>\n\n<p><a href=\"https://sourceware.org/elfutils/ftp/0.170/\" rel=\"nofollow noreferrer\">https://sourceware.org/elfutils/ftp/0.170/</a>\nMy steps</p>\n\n<p>1: bzip2 -d elfutils-0.170.tar.bz2\n2: tar -xvf elfutils-0.170.tar\n3: ./configure<br>\n4: make</p>\n\n<p>Then below errors show up.\nelf_compress_gnu.c: In function 'elf_compress_gnu':\nelf_compress_gnu.c:114:28: error: implicit declaration of function 'htobe64' [-Werror=implicit-function-declaration]\n       uint64_t be64_size = htobe64 (orig_size);\n                            ^\nelf_compress_gnu.c:163:15: error: implicit declaration of function 'be64toh' [-Werror=implicit-function-declaration]\n       gsize = be64toh (gsize);\n               ^\ncc1: all warnings being treated as errors</p>\n"}, {"tags": ["c", "concatenation", "virtual-memory", "mmu"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1510789501, "post_id": 47318611, "comment_id": 81589593, "body": "How is C involved in this?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1510789508, "post_id": 47318611, "comment_id": 81589597, "body": "The VPO seems to be only 6 bits, so by 0x14 they really mean b010100. So when you combine a PPN of 0x0D (b00001101) with it, you get b00001101010100, which is 0x354."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1510789814, "post_id": 47318611, "comment_id": 81589690, "body": "Do realize that the MMU is <i>only</i> hardware. It can do whatever it wants with the addresses (such as: split the address line in two parts, and treat these parts differently)"}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1511066915, "post_id": 47318611, "comment_id": 81700171, "body": "I suggest finding another source to learn from."}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1510789628, "post_id": 47319218, "comment_id": 81589638, "body": "His example was (0x0D &lt;&lt; 6) | 0x14 = 0x354."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1510789673, "post_id": 47319218, "comment_id": 81589647, "body": "@LeeDanielCrocker I think it&#39;s OCR problems from the bad source: check the image and also the <code>O</code> (the letter <code>O</code>) in <code>OxOD</code>. Either way, as soon as &quot;the formula&quot; is known it&#39;s not a problem to substitute other operands."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1510789819, "post_id": 47319218, "comment_id": 81589691, "body": "I was reading the text--you&#39;re right, it doesn&#39;t match the image. But the math, oddly, still works."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1510789850, "post_id": 47319218, "comment_id": 81589704, "body": "@LeeDanielCrocker yep, it&#39;s either text and image were different initially, or just a funny coincidence :-)"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 1, "last_activity_date": 1510789447, "creation_date": 1510789447, "answer_id": 47319218, "question_id": 47318611, "link": "https://stackoverflow.com/questions/47318611/concatenation-of-two-hex-decimal-addresses-ppn-and-vpo-forming-a-physical-add/47319218#47319218", "title": "Concatenation of two hex-decimal addresses (PPN and VPO), forming a physical address", "body": "<p>It's basically</p>\n\n<pre><code>(0xf &lt;&lt; 6) | 0x14 // 0x3d4\n</code></pre>\n\n<p>So you take 6 bits from VPO and prepend it with bits from VPN.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 47319218, "answer_count": 1, "score": 1, "last_activity_date": 1541278562, "creation_date": 1510785901, "last_edit_date": 1510788884, "question_id": 47318611, "link": "https://stackoverflow.com/questions/47318611/concatenation-of-two-hex-decimal-addresses-ppn-and-vpo-forming-a-physical-add", "title": "Concatenation of two hex-decimal addresses (PPN and VPO), forming a physical address", "body": "<p>I'm reading about MMU translation and how a CPU can execute a load instruction that reads a byte at an address, leading to it concatenating the PPN from the PTE with the VPO from a virtual address, making a physical address. But I'm not sure how this concatenation is done. This is the paragraph I'm referring to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hGgdG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hGgdG.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>To begin, the MMU extracts the VPN ( OxOF) from the virtual address and\n  checks with the TLB to see if it has cached a copy of PTE OxOF from some previous\n  memory reference. The TLB extracts the TLB index (Ox03) and the TLB tag (Ox03)\n  from the VPN, hits on a valid match in the second entry of set Ox3, and returns\n  the cached PPN (OxOD) to the MMU.\n  If the TLB had missed, then the MMU would need to fetch the PTE from main\n  memory. However, in this case, we got lucky and had a TLB hit. The MMU now\n  has everything it needs to form the physical address. It does this by concatenating\n  the PPN (OxOD) from the PTE with the VPO (Ox14) from the virtual address, which\n  forms the physical address (Ox354).</p>\n</blockquote>\n\n<p>But my question is, how are (0x14) and (0x0d) concatenated? Could someone possibly show me the steps to how this is done?</p>\n"}, {"tags": ["c", "sockets", "networking", "network-programming", "udp"], "comments": [{"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 3, "creation_date": 1510785777, "post_id": 47318569, "comment_id": 81588335, "body": "UDP doesn&#39;t have clients. Applications may have clients."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1510785837, "post_id": 47318569, "comment_id": 81588359, "body": "1) Can you ping the server? 2) Can you talk to the server via netcat? 3) Have you used wireshark or some other packet sniffer to see if your packets are making it to the wire? There&#39;s a lot of variables in network communication, using established tools and network analyzers helps isolate problems."}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1510785904, "post_id": 47318569, "comment_id": 81588383, "body": "@yano We are actually using netcat via <code>echo &quot;hello world&quot; | netcat -ul &lt;port&gt;</code>. We&#39;ve also tried it with a simple Python server (which works with a Python client), with the same result."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1510786069, "post_id": 47318569, "comment_id": 81588444, "body": "you&#39;re saying netcat can&#39;t talk to the server? the <code>l</code> option for netcat tells it to listen. Which side is supposed to initiate the communication?"}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "edited": false, "score": 0, "creation_date": 1510786108, "post_id": 47318569, "comment_id": 81588458, "body": "No, netcat is the server (one of them)."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1510786173, "post_id": 47318569, "comment_id": 81588480, "body": "can two netcats talk to each other? What I&#39;m getting at is there may be a firewall or AV or something blocking the communication."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1510786343, "post_id": 47318569, "comment_id": 81588531, "body": "Have you considered asking specifically for an IPv4 (respectively IPv6, as appropriate) address by setting <code>ai_family = AF_INET</code> (or <code>AF_INET6</code>) in your <code>getaddrinfo()</code> hints?"}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "edited": false, "score": 0, "creation_date": 1510786482, "post_id": 47318569, "comment_id": 81588581, "body": "Ok, I have tried to get two netcats talking to each other like this: <code>echo &quot;hello world&quot; | netcat -ul 12000</code> and <code>echo &quot;test&quot; | netcat -u localhost 12000</code>. The result is <code>read(net): Connection refused</code> on the client side. However, netcat + Python server or Python server + client work fine on the same port. i&#39;m on a freshly installed macOS 10.12."}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510786629, "post_id": 47318569, "comment_id": 81588641, "body": "@JohnBollinger Wow, that did the trick.Thank you and thanks @ yano."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1510788224, "post_id": 47318569, "comment_id": 81589198, "body": "<code>..., &amp;(p-&gt;ai_addrlen)</code> is suspect"}], "owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510785631, "creation_date": 1510785631, "question_id": 47318569, "link": "https://stackoverflow.com/questions/47318569/udp-client-in-c-not-idea-why-it-doesnt-work", "title": "UDP client in C: Not idea why it doesn&#39;t work", "body": "<p>We are supposed to write a simple UDP client for a Networking class, the code below is our approach. We followed several examples pretty closely, yet the client doesn't produce a response. We have a server that logs its incoming messages, but no messages from our client show up. </p>\n\n<p>We have tried do debug this for several hours now, but to no avail. If someone could point us into the right direction we'd really appreciate it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#define MAX 1024\n\n\nint main(int argc, char* argv[]) {\n\n    int sockfd, actualSize;\n    char buf[MAX];\n    struct addrinfo hints, *res, *p;\n\n    memset(&amp;hints, 0, sizeof hints);\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_DGRAM;\n\n    if (getaddrinfo(argv[1], argv[2], &amp;hints, &amp;res) != 0){\n        fprintf(stderr, \"getaddrinfo: failed\\n\");\n        return 1;\n    }\n\n    for (p = res; p != NULL; p = p-&gt;ai_next) {\n\n        if ((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype, p-&gt;ai_protocol)) == -1) {\n            perror(\"client: socket\");\n            continue;\n        } else {\n            printf(\"Please enter a message: \");\n            fgets(buf, MAX, stdin);\n\n            if (sendto(sockfd, buf, strlen(buf), 0, p-&gt;ai_addr, p-&gt;ai_addrlen) == -1) {\n                perror(\"Error while sending to server\");\n                exit(1);\n            }\n\n            if ((actualSize = recvfrom(sockfd, buf, MAX-1, 0, p-&gt;ai_addr, &amp;(p-&gt;ai_addrlen))) == -1) {\n                perror(\"recv\");\n                exit(1);\n            }\n            buf[actualSize] = '\\0';\n\n            break;\n        }\n\n    }\n\n    printf (\"%s\\n\", buf);\n    close(sockfd);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510784043, "post_id": 47318155, "comment_id": 81587537, "body": "Also if <code>open</code> failed the file descriptor is invalid, so you shouldn&#39;t try to <code>close</code> it (move <code>close</code> into the <code>else</code> block)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1510784227, "post_id": 47318155, "comment_id": 81587629, "body": "What is the boolean result of &#39;open(&quot;test.txt&quot;, O_RDWR | O_CREAT | O_APPEND) == - 1&#39; likely to be, and why are you assigning it to an fd?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1510784283, "post_id": 47318155, "comment_id": 81587653, "body": "&quot;If the file does not exist, create it. If the O_CREAT option is used, then you must include the third parameter.&quot; See <a href=\"http://codewiki.wikidot.com/c:system-calls:open\" rel=\"nofollow noreferrer\">codewiki.wikidot.com/c:system-calls:open</a>"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510784368, "post_id": 47318155, "comment_id": 81587695, "body": "@AnttiHaapala this is not a duplicate."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1510784388, "post_id": 47318155, "comment_id": 81587709, "body": "Ah and naturally you have the parentheses missing in num_written too"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1510784407, "post_id": 47318155, "comment_id": 81587718, "body": "@RichardChambers yes it is. If there are <i>more</i> duplicates, point them out and I will add them too"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510784469, "post_id": 47318155, "comment_id": 81587755, "body": "I have no idea how this code can behave as described:("}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510784841, "post_id": 47318155, "comment_id": 81587937, "body": "@MartinJames <code>open(&quot;test.txt&quot;, O_RDWR | O_CREAT | O_APPEND) == - 1</code> will evaluate to <code>0</code>. So the string is written to standard <i>input</i> which is opened to terminal. Therefore the string is displayed there, because even <code>stdin</code> is opened in read mode."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510784888, "post_id": 47318155, "comment_id": 81587962, "body": "Owait - the file opens OK, the compare is false and so fd gets loaded with 0, so that the write is to stdin.. :("}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510784937, "post_id": 47318155, "comment_id": 81587992, "body": "yes. OP just misses two sets of parentheses and the mode argument, for example <code>0644</code>."}, {"owner": {"reputation": 1577, "user_id": 533761, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dd2f17a9eab392890121e77c74559f2?s=128&d=identicon&r=PG", "display_name": "Neilvert Noval", "link": "https://stackoverflow.com/users/533761/neilvert-noval"}, "edited": false, "score": 0, "creation_date": 1510785209, "post_id": 47318155, "comment_id": 81588111, "body": "To answer the &quot;What am I doing wrong?!&quot; part, Add a parenthesis pair in your if-write line and everything works fine. from:   if(numWritten = write(fd, &quot;Test Text\\n&quot;, 10) == -1) to:   if( (numWritten = write(fd, &quot;Test Text\\n&quot;, 10)) == -1)"}], "owner": {"reputation": 19, "user_id": 8948053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ac4316ebd919cee2e3cc2384ea2afbf?s=128&d=identicon&r=PG&f=1", "display_name": "rla", "link": "https://stackoverflow.com/users/8948053/rla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "closed_date": 1510784003, "answer_count": 0, "score": 0, "last_activity_date": 1510785090, "creation_date": 1510783768, "question_id": 47318155, "link": "https://stackoverflow.com/questions/47318155/using-open-write-and-close-system-calls-in-c", "closed_reason": "Duplicate", "title": "Using Open, Write and Close System Calls in C", "body": "<p>I'm having problems with very basic use of Open, Write and Close system calls in C, the following code is compiling but showing 0 bytes written to the file and no content being output into the file. What am I doing wrong?!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void)\n{\n    int fd;\n    ssize_t numWritten;\n\n    if(fd = open(\"test.txt\", O_RDWR | O_CREAT | O_APPEND) == - 1)\n        printf(\"There has been an error opening the file\\n\");\n    else\n    {\n        if(numWritten = write(fd, \"Test Text\\n\", 10) == -1)\n            printf(\"There has been an error writing to the file!\\n\");\n        else\n            printf(\"You have written %ld bytes\\n\", (long)numWritten);\n    }\n\n    close(fd);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510782304, "post_id": 47317781, "comment_id": 81586657, "body": "do <code>token = strtok(line, &quot; &quot;);</code> once, then loop on <code>token = strtok(NULL, &quot; &quot;);</code> until it returns <code>NULL</code>, that&#39;s how it works, else you&#39;re rearming strtok with the start of the line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510860474, "post_id": 47317781, "comment_id": 81627268, "body": "<code>strtok()</code> is a 2nd class tool to look for <code>int</code>, use <code>strtol()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510787235, "post_id": 47317898, "comment_id": 81588850, "body": "Additionally, include <code>errrno.h</code> and <code>limits.h</code> and replace <code>n = atoi(token);</code> with <code>errno = 0; long tmp = strtol (token); if (errno) { &#47;* handle error *&#47; }; if (tmp &lt; INT_MIN || INT_MAX &lt; tmp) { &#47;* handle tmp too large *&#47; }; n = (int)tmp;</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510812687, "post_id": 47317898, "comment_id": 81596292, "body": "@DavidC.Rankin yeah, <code>atoi</code> sucks, <code>strtok</code> super-sucks . But let OP learn. Good answer of yours."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510813016, "post_id": 47317898, "comment_id": 81596408, "body": "Yes, thanks. I always shake my head when I see it. It should be labeled &quot;<i>for basic example purposes only...</i>&quot; It must be in a whole lot of books,  because you see it so often <code>:)</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510825132, "post_id": 47317898, "comment_id": 81602940, "body": "should go to the trash next to <code>gets</code> and K&amp;R C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510858816, "post_id": 47317898, "comment_id": 81626292, "body": "Note: OP&#39;s file (viewable in the editor) appears to have a blank line.  So this code may call <code>n = atoi(NULL);</code> (Cancel that - instead code is doing <code>atoi(&quot;\\n&quot;)</code>.  Suggest <code>while(1)</code> --&gt; <code>while(token)</code>.  Also the <code>j++</code> being after the <code>if (token==NULL) break;</code> is too late as it  makes for an off by one if <code>j</code> was used after the while loop as a token count."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510859013, "post_id": 47317898, "comment_id": 81626401, "body": "Rather than <code>strtok(..., &quot; &quot;);</code> use <code>strtok(..., &quot; \\n&quot;);</code> to avoid <code>atoi(&quot;\\n&quot;);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510859387, "post_id": 47317898, "comment_id": 81626628, "body": "&quot;tested &amp; works on your data&quot; results in an extra 0 if the line does not end with a digit-<code>&#39;\\n</code> but with digit-spaces-<code>&#39;\\n</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510862869, "post_id": 47317898, "comment_id": 81628494, "body": "@chux: the token count idea was added afterwards. Of course, you&#39;re right for your 3 comments. Edited to store the number of items in the first position of each row."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510863992, "post_id": 47317898, "comment_id": 81629065, "body": "Nice improvement. BTW <code>if (token==NULL) break;</code> not needed."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510864212, "post_id": 47317898, "comment_id": 81629192, "body": "thanks. Removed (for once a conditional <code>while</code> makes sense)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1510864148, "last_edit_date": 1510864148, "creation_date": 1510782647, "answer_id": 47317898, "question_id": 47317781, "link": "https://stackoverflow.com/questions/47317781/using-strtok-to-store-numeric-values-in-a-2d-array/47317898#47317898", "title": "Using strtok() to store numeric values in a 2D array", "body": "<p>there are multiple issues here.</p>\n\n<p>First <code>j=0</code> must be done after <code>fgets</code> or it's never reset.</p>\n\n<p>Second, the biggest error is that when you do <code>strtok(line,\" \")</code> you're initializing <code>strtok</code> state machine, and you must loop using <code>NULL</code> as first argument until <code>strtok</code> returns <code>NULL</code>, but you're not doing that: you're looping on both calls. AS an improvement, pass multiple choices as a separator: linefeed, tabulation, and space.</p>\n\n<p>So the second time the string is already tokenized and the loop ends, but with only the first item.</p>\n\n<p>Also, you have to store the value of <code>j</code> for each line, else you lose track of how many elements there are on each line (since it's variable). In the code below, I'm using the first position to store the size, then come the items.</p>\n\n<p>My fix proposal (tested &amp; works on your data):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    const char *spaces = \"\\n\\t \";\n    int myArray[240][30];\n    char line[240];\n    char *token;\n    int i, n, j;\n    FILE *fp;\n    fp=fopen(\"array_list.txt\", \"rt\");\n    i = 0;\n    while(fgets(line, sizeof(line), fp))\n    {\n        j = 1;\n        token = strtok(line, spaces);  // initialize line tokens\n        while(token)  // won't enter if the line is empty, and stops when no more tokens\n        {\n            n = atoi(token);  // strtol + error checking would be better\n            myArray[i][j] = n;\n            j++;\n            printf(\"%d \", myArray[i][j]);\n            token = strtok(NULL, spaces);  // next token\n        }\n        myArray[i][0] = j;  // use first array position to store the size\n\n        printf(\"\\n\");\n        i++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>the program is still missing a few things:</p>\n\n<ul>\n<li>protecting against \"too many elements for array\". If you have too many elements in your text file (too many lines / too many items in one line) you can corrupt your memory. Check <code>i</code> &amp; <code>j</code> &amp; abort if they're going past the limits.</li>\n<li><code>atoi</code> has no error checking, so entering \"whatever\" leads to a 0 value. <code>strtol</code> allows error checking.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510860090, "post_id": 47320765, "comment_id": 81627052, "body": "<code>if (p == ep) p++;</code> makes some sense, but not <code>if (errno || ...)  p++;</code>.  On overflow, should handle like <code>p = ep;</code>.  Still, nice to look for troublesome data."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510860344, "post_id": 47320765, "comment_id": 81627195, "body": "The &quot;find beginning of next number in buf&quot; <code>for()</code> loops seems unnecessary.  Consider just consuming white-space instead."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510868126, "post_id": 47320765, "comment_id": 81631173, "body": "Agreed. For regular files it is not required as you point out, it was provided to enable reading files like the the <code>10intmess.txt</code> above where input file format may contain some combination of row-names, extraneous punctuation, etc.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510869145, "post_id": 47320765, "comment_id": 81631734, "body": "OK, yet I think  <code>if (... p == ep)  p++;</code> and <code>for (; *p; p++) { ...</code> both handle (consume) the extraneous text."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510869736, "post_id": 47320765, "comment_id": 81631999, "body": "Ah, I got you. That was to explicitly handle <code>&#39;--&#39;</code> prefixes (and the like), but since that is also covered in the <code>for</code>, you are entirely correct here. That check existed before the <code>for</code> in a version that used <code>strpbrk</code> with <code>&quot;+-0123456789&quot;</code> which needed the <code>p++</code> to handle the <code>--</code> case,"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510870087, "post_id": 47320765, "comment_id": 81632142, "body": "@chux, thank you, eliminated the cruft and turned the test around."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510870262, "post_id": 47320765, "comment_id": 81632232, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/159190/discussion-between-chux-and-david-c-rankin\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1510872213, "last_edit_date": 1510872213, "creation_date": 1510800690, "answer_id": 47320765, "question_id": 47317781, "link": "https://stackoverflow.com/questions/47317781/using-strtok-to-store-numeric-values-in-a-2d-array/47320765#47320765", "title": "Using strtok() to store numeric values in a 2D array", "body": "<p>While you can use <code>strtok</code> to split words in your file and then use <code>atoi</code> to perform the conversion to <code>int</code>, there are significant drawbacks to that approach. First and foremost, <code>atoi</code> (and all the <code>atoX</code> functions) provide absolutely no way to validate whether you actually converted <code>atoi(word)</code> to a number. (Is it really <code>0</code>? -- or did the conversion just fail?)</p>\n\n<p>Further, <code>strtok</code> + <code>atoi</code> is part of what <code>strtol</code> does for you. The rest of what <code>long strtol (const char *nptr, char **endptr, int base)</code> does for you is provide extensive error checking through <code>errno</code>, and range checking returning <code>LONG_MIN</code> on <em>underflow</em> and <code>LONG_MAX</code> on <em>overflow</em>. It provides further checking by setting <code>endptr = nptr</code> in the case no digits were found during conversion. Even better, when the conversion succeeds, <code>endptr</code> is set to the next character following the last character that was converted. (it sets you up for your next read!)</p>\n\n<p>Further, with minimal effort, you can test whether the next character should be skipped before calling <code>strtol</code> again, allowing you to parse numbers from the file regardless of what is contained in the file. In other words, you can write an integer read routine once, and then use it with minimum modification for reading whatever file you are given.</p>\n\n<p>While you do not specify how you want to fill <code>myArray[240][30];</code> from the 144-values you show for your file, the following example shows you how to read those values (and values from just about any file) into an array. You need only add an additional counter or loop to put x-number of values per-row in your array, etc..</p>\n\n<p>Use the constants provided for you in the various header files (e.g. <code>errno.h</code>, <code>limits.h</code>) to help you with your task. The following example reads from the filename  given on the command line (or from <code>stdin</code> by default if no filename is given) and will read any integer found in the file into the array <code>arr</code> up to a maximum of <code>1024</code> values, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     /* for strtol */\n#include &lt;string.h&gt;     /* for strlen */\n#include &lt;limits.h&gt;     /* for INT_MIN, INT_MAX */\n#include &lt;errno.h&gt;      /* for errno */\n\n#ifndef BUF_SIZ         /* set input buffer size */\n#define BUF_SIZ 8192    /* gcc default, cl.exe (VS) uses 512 */\n#endif\n\n#define BASE 10         /* conversion base 10 */\n#define AMAX 1024       /* max number of values to read */\n\nint main (int argc, char **argv) {\n\n    int arr[AMAX] = {0},            /* array to hold values */\n        n = 0;                      /* number of values read */\n    char buf[BUF_SIZ] = \"\";         /* line buffer */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (fgets (buf, BUF_SIZ, fp)) {      /* read each line */\n        char *p = buf,                      /* pointer to buf */\n            *ep = p;                        /* end pointer for strtol */\n        size_t len = strlen (buf);          /* length of buf */\n\n        /* validate complete line read */\n        if (len == BUF_SIZ - 1 &amp;&amp; buf[len - 1] != '\\n') {\n            fprintf (stderr, \"error: line too long.\\n\");\n            break;\n        }\n\n        while (n &lt; AMAX &amp;&amp; *p) {    /* n &lt; AMAX &amp; each starting char */\n            errno = 0;                          /* reset errno */\n            long tmp = strtol (p, &amp;ep, BASE);   /* convert to long */\n\n            /* validate conversion */\n            if (p != ep) {                  /* digits converted */\n                /* if no error and in range - assign to array */\n                if (!errno &amp;&amp; INT_MIN &lt;= tmp &amp;&amp; tmp &lt;= INT_MAX)\n                    arr[n++] = (int)tmp;\n                p = ep;     /* set p to 1-past converted string */\n            }\n\n            /* find beginning of next number in buf */\n            for (; *p; p++) {\n                if ('0' &lt;= *p &amp;&amp; *p &lt;= '9')  /* positive value */\n                    break;          /* explicitly signed value */\n                if ((*p == '+' || *p == '-') &amp;&amp; '0' &lt;= *(p+1) &amp;&amp; *(p+1) &lt;= '9')\n                    break;\n            }\n        }\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (int i = 0; i &lt; n; i++)     /* output values read */\n        printf (\" arr[%3d] = %d\\n\", i, arr[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Input Files</strong></p>\n\n<p>This way, you can read from just about any file containing integer values. The following files all contain the same 10-integer values. The read does not require a POSIX EOF for the read of the last value in the file to succeed (e.g. <code>'\\n'</code> following the last line). Each of the files below are read and properly parsed by the code above -- without modification.</p>\n\n<pre><code>$ cat dat/10int_comma.txt\n8572,-2213,6434,16330,3034,12346,4855,16985,11250,1495\n\n$ cat dat/10int.csv\n8572, -2213, 6434, 16330, 3034\n12346, 4855, 16985, 11250, 1495\n\n$ cat dat/10int_5x2.txt\n[[  8572  -2213  ]\n [  6434  16330  ]\n [  3034  12346  ]\n [  4855  16985  ]\n [ 11250   1495  ]]\n\n$ cat dat/10intmess.txt\n8572,;a -2213,;--a 6434,;\na- 16330,;a\n\n- The Quick\nBrown%3034 Fox\n12346Jumps Over\nA\n4855,;*;Lazy 16985/,;a\nDog.\n11250\n1495\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>The output produced by reading each of the files above is the same.</p>\n\n<pre><code>$ ./bin/fgets_strtol &lt;dat/10intmess.txt\n arr[  0] = 8572\n arr[  1] = -2213\n arr[  2] = 6434\n arr[  3] = 16330\n arr[  4] = 3034\n arr[  5] = 12346\n arr[  6] = 4855\n arr[  7] = 16985\n arr[  8] = 11250\n arr[  9] = 1495\n</code></pre>\n\n<p>While you are free to use <code>strtok</code> and <code>atoi</code>, the C library provides a tool for that job in <code>strtol</code> (and for all the different numeric types in the remaining <code>strtoX</code> functions). Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1510874917, "last_edit_date": 1510874917, "creation_date": 1510874612, "answer_id": 47340839, "question_id": 47317781, "link": "https://stackoverflow.com/questions/47317781/using-strtok-to-store-numeric-values-in-a-2d-array/47340839#47340839", "title": "Using strtok() to store numeric values in a 2D array", "body": "<p>I think OP has been given some subtly tricky input.</p>\n\n<p>What looks like 6 lines of input may be something else.  Although I edited OP's post, I stayed away from the <code>\"array_list.txt\"</code> data section as in the editor, it <em>appears</em> to have lines with spaces after the last number, a blank line, and maybe a line with more than 30 numbers.</p>\n\n<p>In other words, <code>\"array_list.txt\"</code> may not be as well formatted as first thought and code needs to take defensive action to avoid over-runs, etc.</p>\n\n<hr>\n\n<p><strong>Set up constants</strong></p>\n\n<p>The magic numbers 240, 30, 240 carry little meaning and since 2 numbers are the same value, there role in code can get muddled - use constants.</p>\n\n<pre><code>//int myArray[240][30];\n//char line[240];\n#define LINE_N 240\n#define INT_PER_LINE_N 30\n\n// I think this should be more like (INT_PER_LINE_N * 13)\n#define LINE_SIZE 240\n\nint myArray[LINE_N][INT_PER_LINE_N];\nchar line[LINE_SIZE];\n</code></pre>\n\n<p><strong>Prefer <code>strtol()</code> over <code>strtok()</code></strong></p>\n\n<p><code>strtok()</code> is fine looking for tokens.  Code supplies a delimiter set like <code>\" \\n\\t\"</code> and life is good.  Yet what to do with non-delimiters, non-numerics?  <code>strtol()</code> handles that well for integers.</p>\n\n<pre><code>for (i=0; i&lt;LINE_N; i++ {  // Do not read too many lines\n  myArray[i][0] = 0;\n  if (fgets(line, sizeof line, fp)) {\n    char *p = line;\n    int j = 0;\n    while (j &lt; (INT_PER_LINE_N - 1) &amp;&amp; *p) {\n      char *endptr;\n      errno = 0;\n      long value = strtol(p, &amp;endptr);\n      if (p == endptr) {  // no conversion\n        p++; // TBD code, for now, simple advance to the next character; \n      } else {\n        if (errno || value &lt; INT_MIN || value &gt; INT_MAX) {  // some overflow?\n          ; // TBD code: for now, ignore out of range int\n        } else {\n          myArray[i][++j] = (int) value;\n        }\n        p = endptr;  // go to text after this numeric token \n      }\n      // Consume trailing white-space, helps code get to the string end better\n      while (isspace((unsigned char)*p) p++;\n    }  \n    myArray[i][0] = j;\n  } // end for\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8947871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154957841551766/picture?type=large", "display_name": "Kidanny Mendez", "link": "https://stackoverflow.com/users/8947871/kidanny-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1510943853, "creation_date": 1510782212, "last_edit_date": 1510943853, "question_id": 47317781, "link": "https://stackoverflow.com/questions/47317781/using-strtok-to-store-numeric-values-in-a-2d-array", "title": "Using strtok() to store numeric values in a 2D array", "body": "<p>I'm trying to write a program that takes a list of numbers from a file and stores each row of numbers in a 2D array using strtok(). The problem I'm having is that when I try to store values in the rows of my 2D array, the while loop goes into an infinite loop, but when i use the line token = strtok(NULL, \" \") to stop the loop, I just store the first value of each line into the first cell of each column. </p>\n\n<p>What am I doing wrong? Heres is my code</p>\n\n<pre><code>int main() {\n  int myArray[240][30];\n  char line[240];\n  char *token;\n  int i, n, j;\n  FILE *fp;\n  fp = fopen(\"array_list.txt\", \"rt\");\n  j = 0;\n  i = 0;\n  while (fgets(line, sizeof(line), fp)) {\n    token = strtok(line, \" \");\n\n    while (token != NULL) {\n      n = atoi(token);\n      myArray[i][j] = n;\n      token = strtok(line, \" \");\n      printf(\"%d \", myArray[i][j]);\n      token = strtok(NULL, \" \");\n      j++;\n    }\n\n    printf(\"\\n\");\n    i++;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Here is an example of the file I'm trying to read.</p>\n\n<p>1 98 48 55 46 12 48 43 7 73 47 33<br>\n                                                                                                                                                                    97 26 67 25 67 47 46 74 67 43 78 98 90 58 6 5 53 19 37 42<br>\n81 84 36 70 59 65 99 56 94 23\n79 73 27 47 98 78 8 2 3 43 84 19 59 98 51 72 2 13 55 3\n20 61 25 84 28 70 56 23 52 69\n86 70 60 90 72\n51 71 92 91 55 6 72 67 73 64 78 43 65 30 49\n99 82 40 72 5 44 20 21 22 72 99 74 27 59 25 1 26 26 22 66\n63 27 54 46 46\n91 65 77 45 94 94 95 11 77 46 64 14\n69 70 75 48 68 22 55 78 1 4\n31 76 55 12 93</p>\n"}, {"tags": ["c++", "c", "shared-libraries", "dlopen", "ldd"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510782182, "post_id": 47317750, "comment_id": 81586606, "body": "can&#39;t you try libpython3.5m.so, then libpython3.4m.so, then libpython2.7.so... until it succeeds?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1510782899, "post_id": 47317750, "comment_id": 81586977, "body": "@Jean-Fran&#231;oisFabre I don&#39;t think it would work like that... you could load an incorrect library"}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 2272506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d910c6f729897b6af6fa867a794001?s=128&d=identicon&r=PG", "display_name": "Jesin", "link": "https://stackoverflow.com/users/2272506/jesin"}, "is_accepted": false, "score": 0, "last_activity_date": 1510798854, "creation_date": 1510798854, "answer_id": 47320507, "question_id": 47317750, "link": "https://stackoverflow.com/questions/47317750/check-c-shared-dependencies-at-runtime-ldd-on-self/47320507#47320507", "title": "Check C++ shared dependencies at runtime (ldd on self)", "body": "<p>On Linux, you can read <code>/proc/self/maps</code> or <code>/proc/self/map_files</code>, but this is not portable to other platforms.</p>\n"}, {"comments": [{"owner": {"reputation": 3608, "user_id": 887074, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/da9c9afc19776841b62f8980a40c02ec?s=128&d=identicon&r=PG", "display_name": "Erotemic", "link": "https://stackoverflow.com/users/887074/erotemic"}, "edited": false, "score": 0, "creation_date": 1510925397, "post_id": 47320610, "comment_id": 81655537, "body": "It turns out to not be pointless when loading pybind11 plugins. If you don&#39;t call dlopen, then you can get into issues (e.g. can&#39;t find PyFloat_Type) when executing python code that imports modules like ctypes. I don&#39;t need to ever call <code>dlsym</code>. However, dl_iterate_phdr seems like exactly what I was looking for."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 3608, "user_id": 887074, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/da9c9afc19776841b62f8980a40c02ec?s=128&d=identicon&r=PG", "display_name": "Erotemic", "link": "https://stackoverflow.com/users/887074/erotemic"}, "edited": false, "score": 0, "creation_date": 1510931322, "post_id": 47320610, "comment_id": 81659595, "body": "@Erotemic Your explanation of what goes wrong makes no sense to me. If you are already linked against <code>libfoo.so</code>, then calling <code>dlopen(&quot;libfoo.so&quot;, RTLD_LAZY)</code> is surely a no-op. I&#39;d be curious to see a <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> where such <code>dlopen</code> makes a difference."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 2, "last_activity_date": 1510931462, "last_edit_date": 1510931462, "creation_date": 1510799672, "answer_id": 47320610, "question_id": 47317750, "link": "https://stackoverflow.com/questions/47317750/check-c-shared-dependencies-at-runtime-ldd-on-self/47320610#47320610", "title": "Check C++ shared dependencies at runtime (ldd on self)", "body": "<blockquote>\n  <p>I want to call <code>void *handle = dlopen(\"...\", ...)</code></p>\n</blockquote>\n\n<p>Presumably you want to then call <code>dlsym(handle, \"SomePythonSymbol\")</code>.</p>\n\n<p>That is a <em>pointless</em> thing to do. Instead of performing dynamic lookup, simply call the <code>SomePythonSymbol</code> directly.</p>\n\n<p>To answer your original \"what version of libpython am I linked to\" question, on a GLIBC-based system you can use <a href=\"http://man7.org/linux/man-pages/man3/dl_iterate_phdr.3.html\" rel=\"nofollow noreferrer\">dl_iterate_phdr</a> to enumerate all currently loaded shared libraries.</p>\n\n<p>If you already have a symbol that you know is defined in libpython, <a href=\"http://man7.org/linux/man-pages/man3/dladdr.3.html\" rel=\"nofollow noreferrer\">dladdr1</a> will make finding the library even easier.</p>\n"}], "owner": {"reputation": 3608, "user_id": 887074, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/da9c9afc19776841b62f8980a40c02ec?s=128&d=identicon&r=PG", "display_name": "Erotemic", "link": "https://stackoverflow.com/users/887074/erotemic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 1, "accepted_answer_id": 47320610, "answer_count": 2, "score": 2, "last_activity_date": 1510931462, "creation_date": 1510782098, "question_id": 47317750, "link": "https://stackoverflow.com/questions/47317750/check-c-shared-dependencies-at-runtime-ldd-on-self", "title": "Check C++ shared dependencies at runtime (ldd on self)", "body": "<p>Is there a way to check or access the names of the libraries a C++ binary  is dynamically linked to within the binary itself?</p>\n\n<p>Essentially I want to run <code>ldd</code> on a binary, without running <code>ldd</code>. </p>\n\n<p>The use case is using <code>dlopen</code> from <code>dlfcn.h</code>. I have a C++ library which is linked to <code>libpython</code>, but I don't know if its <code>libpython3.5m.so</code>, <code>libpython3.4m.so</code>, <code>libpython2.7.so</code>, etc... </p>\n\n<p>I want to call </p>\n\n<pre><code>void* handle = dlopen( \"@PYTHON_LIBRARY@\", RTLD_LAZY | RTLD_GLOBAL );\n</code></pre>\n\n<p>where <code>\"@PYTHON_LIBRARY@\"</code> resolves to the path to whatever the current libpython the module is currently dynamically linked to. </p>\n\n<p>Is there any way to do this?</p>\n"}, {"tags": ["c", "arrays", "pointers", "indexing", "char"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1510779585, "post_id": 47317112, "comment_id": 81585267, "body": "You want to increment the <i>integer</i> pointed to by <code>a</code>. That is: <code>(*a) ++</code>! Likewise for the final one, I guess you want <code>*a = *a + 2</code> i.e. <code>*a += 2</code>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1510779658, "post_id": 47317112, "comment_id": 81585302, "body": "...but of course the function returns <code>void</code>..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510779698, "post_id": 47317112, "comment_id": 81585322, "body": "Also you&#39;re not zero-terminating <code>fill_this</code>"}, {"owner": {"reputation": 183, "user_id": 7521901, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbyYjo227po/AAAAAAAAAAI/AAAAAAAAAFI/10r5zP2BUUI/photo.jpg?sz=128", "display_name": "Robert James Mieta", "link": "https://stackoverflow.com/users/7521901/robert-james-mieta"}, "edited": false, "score": 0, "creation_date": 1510779704, "post_id": 47317112, "comment_id": 81585326, "body": "Easy fix! Thank you!"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1510779751, "post_id": 47317112, "comment_id": 81585353, "body": "... and you should guard against the case that the string doesn&#39;t contain <code>until_char</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1510779892, "post_id": 47317112, "comment_id": 81585439, "body": "@Robert James Mieta  What is the purpose of this statement  a = a +  2;?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1510781944, "post_id": 47317112, "comment_id": 81586473, "body": "Please do not edit answers into the question. Answers go into the Answer box. You can accept a posted answer, or you can post your own answer if none are suitable"}, {"owner": {"reputation": 183, "user_id": 7521901, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbyYjo227po/AAAAAAAAAAI/AAAAAAAAAFI/10r5zP2BUUI/photo.jpg?sz=128", "display_name": "Robert James Mieta", "link": "https://stackoverflow.com/users/7521901/robert-james-mieta"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1510801555, "post_id": 47317112, "comment_id": 81592836, "body": "@Vlad from Moscow it\u2019s a part of a much larger program where incoming words are separated with \u201c, \u201d hence advancing 2 index numbers ahead to the next word. I would pass \u2018,\u2019 as argument to until_char instead"}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 5, "last_activity_date": 1510785583, "last_edit_date": 1510785583, "creation_date": 1510779664, "answer_id": 47317154, "question_id": 47317112, "link": "https://stackoverflow.com/questions/47317112/use-pointer-to-an-int-as-an-array-index/47317154#47317154", "title": "Use pointer to an int as an array index", "body": "<p>You're not modifying the integer in some cases, you're modifying the pointer to it. For example:</p>\n\n<pre><code>a++\na = a + 2\n</code></pre>\n\n<p>both do <strong>pointer arithmetic</strong> - they modify the pointer, not the value pointed to by it. What you want instead is:</p>\n\n<pre><code>(*a)++\n*a += 2\n</code></pre>\n\n<p>These perform the modifications on the value itself, not the pointer.</p>\n\n<hr>\n\n<p>Note that as you're not doing bounds-checking, you can run over the end of the array (if the character you're searching for isn't in the array), which is undefined behaviour. You should also be sure to null-terminate your output string - add a <code>\\0</code> after the last character. Not doing this can cause undefined behaviour later on if you try to print the string.</p>\n"}], "owner": {"reputation": 183, "user_id": 7521901, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wbyYjo227po/AAAAAAAAAAI/AAAAAAAAAFI/10r5zP2BUUI/photo.jpg?sz=128", "display_name": "Robert James Mieta", "link": "https://stackoverflow.com/users/7521901/robert-james-mieta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1779, "favorite_count": 0, "closed_date": 1510785914, "accepted_answer_id": 47317154, "answer_count": 1, "score": 0, "last_activity_date": 1510785583, "creation_date": 1510779509, "last_edit_date": 1510781898, "question_id": 47317112, "link": "https://stackoverflow.com/questions/47317112/use-pointer-to-an-int-as-an-array-index", "closed_reason": "Not suitable for this site", "title": "Use pointer to an int as an array index", "body": "<p>I have the following code which is a piece of a larger program. I am attempting to pass an int to a function that will copy part of a char array ( name[100] ) to another until a certain character is reached, and update the int value.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid time_loop(int *a, char name[100], char *data, char until_char)\n{\n    int c = 0;    \n    while(name[*a] != until_char)\n    {\n        data[c] = name[*a];\n        a++;\n        c++;\n    }\n    a = a +  2;\n}\n\nint main()\n{\n    int i = 3;\n    char name[100] = {' ', ' ', ' ', 'f', 'o', 'o', ':', '\\0'};\n    char fill_this[15];\n\n    time_loop(&amp;i, name, fill_this, ':');\n    printf(\"current char index: %d\\n\", i);\n    printf(\"the word is: %s\", fill_this);\n\n    return 0;\n}\n</code></pre>\n\n<p>Currently the code runs until it hits the:</p>\n\n<pre><code>while(name[*a] != until_char)\n</code></pre>\n\n<p>piece of code, with a problem accessing *a.</p>\n\n<p>I could always just take the easy way out and change the function to:</p>\n\n<pre><code>int time_loop(int a, char name[100], char *data, char until_char)\n</code></pre>\n\n<p>and return an int, but there has to be a way to do this correctly.</p>\n\n<p><strong>Q: What is the correct way to pass a type int* as an index number for an array?</strong></p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1510779386, "post_id": 47317048, "comment_id": 81585144, "body": "Well, <code>sem_wait()</code> is a cancellation point. Whether this should absolutely be considered a terrible idea is another matter."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1510781099, "post_id": 47317048, "comment_id": 81586056, "body": "There are some ways.  1) Don&#39;t bother, just let the OS terminate the threads at process termination.  2) Give the consumer thread a normally-false boolean &#39;terminateNow&#39; flag and test it after every sema wait() return.   Just before the producer exits, set the flag and signal the semaphore.  3) If the semaphore is managing a producer-consumer queue, just post a &#39;poison-pill&#39; message that instructs the consumers to terminate.  The consumer threads get the message, push it back onto the queue and terminate."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510782052, "post_id": 47317048, "comment_id": 81586528, "body": "I suppose I should add, at the risk of some devloper&#39;s heads exploding, that (1) above is the most reliable mechanism by far. With the others, your app can easily fail to exit.  If one of the threads gets stuck ,either looping or blocked, on some bad task queued to it, then it will not get back to the semaphore and so will not terminate, the main thread gets stuck on the &#39;join&#39; call-of-death, and your customers have to shut down the process with the Task Manager or &#39;kill -9&#39;.  Messy, unwanted and avoidable :("}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510882229, "post_id": 47317048, "comment_id": 81636010, "body": "here is the prototype for <code>pthread_exit()</code>  <code>void pthread_exit(void *retval);</code>  Notice the parameter is a <code>void*</code> not an <code>int</code>.  Therefore, each of the calls should be: <code>pthread_exit( NULL );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510782620, "post_id": 47317730, "comment_id": 81586806, "body": "&quot;Destroying  a  semaphore  that  other  processes or threads are currently blocked on (in <code>sem_wait</code>(3)) produces undefined behavior.&quot;"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510782660, "post_id": 47317730, "comment_id": 81586833, "body": "Well, that&#39; different.  Why do that?  If the threads are stuck on the semaphore, why not just, well, signal it?"}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510782741, "post_id": 47317730, "comment_id": 81586883, "body": "@MartinJames, the thread will be place on sleep mode by OS. So you can not send a signal to it."}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510782822, "post_id": 47317730, "comment_id": 81586931, "body": "@JohnBollinger, I am giving this advice because Martin once to do that just before exit from the program. But not a good idea."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1510783852, "post_id": 47317730, "comment_id": 81587445, "body": "I guess that&#39;s a matter of opinion, @Abhijit.  Myself, I cannot recommend ever knowingly invoking undefined behavior.  <i>By definition</i> you have no reason to expect it to be of any benefit, whereas you do need to fear that it will be harmful.  And if it turns out to be harmful, there&#39;s no good reason to suppose that the harm will be limited to the process wherein the undefined behavior is triggered."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510862691, "post_id": 47317730, "comment_id": 81628399, "body": "@Abhijit I meant signal the semaphore, not send a unix signal:)"}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 0, "creation_date": 1510865641, "post_id": 47317730, "comment_id": 81629890, "body": "Did you try anything from your side?"}], "tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1510781998, "creation_date": 1510781998, "answer_id": 47317730, "question_id": 47317048, "link": "https://stackoverflow.com/questions/47317048/how-to-exit-from-thread-which-is-suspended-by-semaphore/47317730#47317730", "title": "How to exit from thread which is suspended by semaphore?", "body": "<p>first try with <code>pthread_kill()</code>. For this first call <code>pthread_cancel</code> and followed by <code>pthread_kill()</code> with signal SIGSTOP. Even if after that it is not working for your try to destroy the semaphore with <code>sem_destroy()</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1510783256, "creation_date": 1510783256, "answer_id": 47318021, "question_id": 47317048, "link": "https://stackoverflow.com/questions/47317048/how-to-exit-from-thread-which-is-suspended-by-semaphore/47318021#47318021", "title": "How to exit from thread which is suspended by semaphore?", "body": "<blockquote>\n  <p>I don't understand how can i exit threads which are suspended by semaphore?</p>\n</blockquote>\n\n<p>In the most literal sense, you can't.  A thread that is suspended waiting to acquire a semaphore cannot do <em>anything</em> until it stops waiting, including terminate.  The primary question, then, is really how to make such threads stop waiting.</p>\n\n<p>There are at least four ways you can accomplish this:</p>\n\n<ul>\n<li><p>increment the semaphore so that the thread can acquire it.  This is the cleanest and best approach.  The trick is then to provide a mechanism by which the thread, when it wakes, can recognize that it should terminate instead of proceeding as normal.</p></li>\n<li><p>use <code>sem_timedwait()</code> instead of <code>sem_wait()</code>, and wait for the timeout to expire.  This is a bit dodgy, for although you can determine whether <code>sem_timedwait()</code> returned because of a timeout, it's not necessarily clear what the thread should then do about it.</p></li>\n<li><p>use <code>pthread_cancel()</code> to send a cancellation request to the thread.  This <em>should</em> be effective on a thread blocked in a <code>sem_wait()</code>, but it's rather heavy-handed.  In particular, it starts a chain of events that leads more or less directly to thread termination.</p></li>\n<li><p>send a signal to the thread via <code>pthread_kill()</code>.  Be careful, however, for signal dispositions are process-wide.  In particular, then, if the chosen signal's disposition is \"stop\" or \"terminate\" (and it is not blocked) then that will affect the whole process.  This relies on the signal not being configured with the <code>SA_RESTART</code> flag.</p></li>\n</ul>\n\n<p>Other than <code>pthread_cancel()</code>, all of these have in common the requirement that the thread waiting on the semaphore needs to check when it returns from its wait <em>why</em> it returned.  It must check the return value of <code>sem_[timed]wait()</code> and possibly the value of <code>errno</code>, and it may need to check one or more for-purpose shared variables.</p>\n"}], "owner": {"reputation": 21, "user_id": 7727633, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a26b2c836ea13bcb234dbc379ca7f768?s=128&d=identicon&r=PG&f=1", "display_name": "AnorLondo", "link": "https://stackoverflow.com/users/7727633/anorlondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1510783256, "creation_date": 1510779221, "question_id": 47317048, "link": "https://stackoverflow.com/questions/47317048/how-to-exit-from-thread-which-is-suspended-by-semaphore", "title": "How to exit from thread which is suspended by semaphore?", "body": "<p>In main function I create one producer thread and two consumer threads.\nProducer doing some work, then with \"if\" statement checks if it should to break and then increments semaphore. Consumers are waiting for semaphore become greater then 0 and do some work, then waiting again. When producer exited, consumers should finish their work and exit too. I don't understand how can i exit threads which are suspended by semaphore? Here is my code:</p>\n\n<pre><code>sem_t ready;\n\nvoid *prod_routine(void*){\n    while(true){\n        //do_something\n        //here i have if statement with break.\n        sem_post(&amp;ready);\n    }   \npthread_exit(0);\n}\n\nvoid *cons_routine(void*){\n    while(true){\n        sem_wait(&amp;ready);\n        //do something\n    }\npthread_exit(0);\n}\n\nint main(int argc, char *argv[]){\n\npthread_t prod, cons1, cons2;\n\nsem_init(&amp;ready, 0 , 0);\n\npthread_create(&amp;prod, NULL, &amp;prod_routine, NULL);\npthread_create(&amp;cons1, NULL, &amp;cons_routine, NULL);\npthread_create(&amp;cons2, NULL, &amp;cons_routine, NULL);\n\npthread_join(prod, NULL);\npthread_join(cons1, NULL);\npthread_join(cons2, NULL);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1510779342, "post_id": 47316945, "comment_id": 81585119, "body": "It is very hard to follow what is going on here; you&#39;re also missing the definition of <code>A</code> and <code>B</code>. However this could occur if you&#39;ve defined <code>A[2][3]</code> and using it as if <code>A[3][2]</code>..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1510779409, "post_id": 47316945, "comment_id": 81585161, "body": "Also, why are you using an <code>if</code> choosing between the matrix?! Instead pass either <code>A</code> or <code>B</code> into the function as an argument."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1510779410, "post_id": 47316945, "comment_id": 81585163, "body": "It would be better to use a pair of nested loops for the 2 dimensions, and test the <code>fscanf</code> return value for <code>1</code>, if not that is a fault."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1510779517, "post_id": 47316945, "comment_id": 81585227, "body": "please work out a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If the fault occurs with the code that reads in A, there is no need to have <i>any</i> code that reads in <code>B</code>. Also please add a <code>main</code> function that demonstrates this and how are you printing it."}, {"owner": {"reputation": 47, "user_id": 6679847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5578f10025b3cd5420e1602b124715b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnzye", "link": "https://stackoverflow.com/users/6679847/shawnzye"}, "edited": false, "score": 0, "creation_date": 1510779623, "post_id": 47316945, "comment_id": 81585288, "body": "The A and B are defined on the global, and I don&#39;t pass them to the function because I didn&#39;t know how I would depict between which is A and Which is B."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1510779822, "post_id": 47316945, "comment_id": 81585396, "body": "@Shawnzye Just pass the array <code>A</code> or <code>B</code> as an argument to the function."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1510779831, "post_id": 47316945, "comment_id": 81585406, "body": "You can have a parameter like <code>int matrix[][3]</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510779849, "post_id": 47316945, "comment_id": 81585421, "body": "and you can use <code>A</code> or <code>B</code> as an argument"}, {"owner": {"reputation": 47, "user_id": 6679847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5578f10025b3cd5420e1602b124715b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnzye", "link": "https://stackoverflow.com/users/6679847/shawnzye"}, "edited": false, "score": 0, "creation_date": 1510780046, "post_id": 47316945, "comment_id": 81585521, "body": "But if both matrixes are 3x3 Then how I depict which is which?"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1510782142, "post_id": 47316945, "comment_id": 81586583, "body": "What is <code>k</code> in calling <code>readFile(argv[1], k, 1);</code>?"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1510782171, "post_id": 47316945, "comment_id": 81586598, "body": "wrong <code>k</code> cause your undesired output"}], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1510783606, "creation_date": 1510783606, "answer_id": 47318116, "question_id": 47316945, "link": "https://stackoverflow.com/questions/47316945/c-array-is-overwriting-an-index/47318116#47318116", "title": "C array is overwriting an index", "body": "<p>Your problem probably with <code>while( fscanf(txt, \"%d\", &amp;c) != EOF )</code>. Just try with <code>while( fscanf(txt, \"%d\", &amp;c))</code> and check.</p>\n"}], "owner": {"reputation": 47, "user_id": 6679847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5578f10025b3cd5420e1602b124715b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnzye", "link": "https://stackoverflow.com/users/6679847/shawnzye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1510783606, "creation_date": 1510778819, "last_edit_date": 1510779995, "question_id": 47316945, "link": "https://stackoverflow.com/questions/47316945/c-array-is-overwriting-an-index", "title": "C array is overwriting an index", "body": "<p>I am reading from 2 different files and running this function on each. \nThe file format is </p>\n\n<pre><code>2\n3  \n8 7 6 \n5 4 3  \n</code></pre>\n\n<p>The code I am using is </p>\n\n<pre><code>void readFile(char txtName[], int k, int matrix){\n    int c = 0;\n    int i = 0;\n    int j = 0;\n    int x = 0;\n    //Open file\n    FILE *txt;\n    txt = fopen(txtName, \"r\");\n    //Go till the end of the file\n    while( fscanf(txt, \"%d\", &amp;c) != EOF ){\n        //For assigning matrix A\n        if(matrix == 1){\n            //Used to skip over the first 2 inputs.\n            if(x &gt; 1){\n                //Got to the end of the row increase to the next row.\n                if(j == k){\n                    i++;\n                    j = 0;\n                }\n                //Assiging c to A\n                A[i][j] = c;\n                printf(\"%d A in matrix %d %d\\n\", A[i][j], i, j);\n                j++;\n            }\n        x++;\n        }            \n    }\n    fclose(txt);\n}\n\nint main( int argc, char *argv[] )  {\n    readFile(argv[1], k, 1);\n    int m = 2;\n    int k = 3;\n    int i;\n    int j;\n    for(i=0; i &lt; m; i++){\n        for(j=0; j &lt; k; j++){\n            printf(\"%d\", A[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>I am trying to initialize an 2 dimensional array with the file so that it is a matrix. The first value of the file is the m and the second is the k. So from the file posted. it is a 2x3 matrix with the values below it. A is a global array set to A[2][3];</p>\n\n<p>The issue I am having is when I run this code my array comes out with </p>\n\n<pre><code>8 7 5\n5 4 3\n</code></pre>\n\n<p>and I have no clue why. I have put a lot of print statements for debugging. When it comes to i = 0 and j = 2 it prints out 6. But when I print the array after the function A[0][2] = 5. Where is the error that I am making? </p>\n"}, {"tags": ["c", "linked-list", "binary-search-tree"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510778727, "post_id": 47316893, "comment_id": 81584774, "body": "You should step through with a debugger to see where the behaviour diverges from what you expected."}, {"owner": {"reputation": 169, "user_id": 8877836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nmPOw.jpg?s=128&g=1", "display_name": "TheShield", "link": "https://stackoverflow.com/users/8877836/theshield"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510778768, "post_id": 47316893, "comment_id": 81584799, "body": "Any recommendations for choice of debugger?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510781868, "post_id": 47316893, "comment_id": 81586430, "body": "Too bad I&#39;ve used all my votes, this would have been one of the couple C questions that deserved an upvote instead of the usual down, close and delete votes."}, {"owner": {"reputation": 169, "user_id": 8877836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nmPOw.jpg?s=128&g=1", "display_name": "TheShield", "link": "https://stackoverflow.com/users/8877836/theshield"}, "edited": false, "score": 0, "creation_date": 1510782781, "post_id": 47316893, "comment_id": 81586906, "body": "What do you mean you&#39;ve used all your votes? Sorry, I&#39;m new to stack overflow I don&#39;t really understand how it fully works."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510783096, "post_id": 47316893, "comment_id": 81587081, "body": "@TheShield everyone is limited to only 40 votes (up or down) each day (the day starts at UTC 00:00). I used mine mostly downvoting bad C questions. You&#39;ve got &gt;15 reputation, so you can upvote, but not yet downvote."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1510779019, "post_id": 47316971, "comment_id": 81584940, "body": "Wow, that almost makes C++&#39;s iterator pairs seem sane."}, {"owner": {"reputation": 169, "user_id": 8877836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nmPOw.jpg?s=128&g=1", "display_name": "TheShield", "link": "https://stackoverflow.com/users/8877836/theshield"}, "edited": false, "score": 0, "creation_date": 1510779228, "post_id": 47316971, "comment_id": 81585058, "body": "Oh that makes so much sense, thank you so much I&#39;ve been stuck on this forever."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1510778913, "creation_date": 1510778913, "answer_id": 47316971, "question_id": 47316893, "link": "https://stackoverflow.com/questions/47316893/binary-search-tree-to-linked-list-conversion-converts-only-half-of-the-entries/47316971#47316971", "title": "Binary Search Tree to Linked List conversion converts only half of the entries", "body": "<p>When you get the leftmost tree, you're cutting off all but the head of the left tree and pointing that to the current node.  You want to walk to the <em>end</em> of that tree and point the end to the current node.</p>\n\n<pre><code>if (root-&gt;left != NULL)  \n{\n    ListNodePtr tail;\n    head = convertBSTtoLinkedList(root-&gt;left);\n    tail = head;\n    while (tail-&gt;next != NULL) {\n        tail = tail-&gt;next;\n    }\n    tail-&gt;next = list;\n    return head;\n}\n</code></pre>\n\n<p>Also, a minor optimization on your print function:</p>\n\n<pre><code>void printList(ListNodePtr head)\n{\n  while (head != NULL)\n  {\n    printf(\"%d \",(head-&gt;key));\n    head = head-&gt;next;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 8877836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nmPOw.jpg?s=128&g=1", "display_name": "TheShield", "link": "https://stackoverflow.com/users/8877836/theshield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 47316971, "answer_count": 1, "score": 2, "last_activity_date": 1510778913, "creation_date": 1510778623, "question_id": 47316893, "link": "https://stackoverflow.com/questions/47316893/binary-search-tree-to-linked-list-conversion-converts-only-half-of-the-entries", "title": "Binary Search Tree to Linked List conversion converts only half of the entries", "body": "<p>I have a binary search tree:</p>\n\n<pre><code>                3\n               / \\\n              1   6\n                   \\\n                    17\n                   /\n                 15\n                /  \\ \n               13   15\n              /\n             6\n              \\\n               12 \n              /\n             9\n</code></pre>\n\n<p>And my function that converts the BST to a linked list where root points to the root of the BST:</p>\n\n<pre><code>ListNodePtr convertBSTtoLinkedList(TreeNodePtr root)\n{\n    ListNodePtr list,head;\n    list = malloc(sizeof(struct ListNode));\n    list-&gt;key = root-&gt;key;\n    if (root-&gt;right != NULL)\n    {\n        list-&gt;next = convertBSTtoLinkedList(root-&gt;right);\n    }\n    if (root-&gt;left != NULL)  \n    {\n        head = convertBSTtoLinkedList(root-&gt;left);\n        head-&gt;next = list;\n        return head;\n    }\n    return list;\n}\n</code></pre>\n\n<p>I have manually gone over my function for hours now and can't see what I've done wrong. I have verified that I am inputting a correctly made BST. My function to print out the list where head points to the start of the linked list:</p>\n\n<pre><code>void printList(ListNodePtr head)\n{\n  while (head-&gt;next != NULL)\n  {\n    printf(\"%d \",(head-&gt;key));\n    head = head-&gt;next;\n  }\n  printf(\"%d \",(head-&gt;key));\n}\n</code></pre>\n\n<p>Although I doubt that this function is incorrect.</p>\n\n<p>My intended output is:</p>\n\n<pre><code>BST\n1 3 6 6 9 12 13 15 15 17 \nLinked list\n1 3 6 6 9 12 13 15 15 17 \n</code></pre>\n\n<p>However what comes out is:</p>\n\n<pre><code>BST\n1 3 6 6 9 12 13 15 15 17 \nLinked list\n1 3 6 6 17 \n</code></pre>\n"}, {"tags": ["c", "shell", "sh"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510777419, "post_id": 47316538, "comment_id": 81584024, "body": "Are you on a system which have a shell that can execute the commands? Then what have you tried? How did your attempt work, or not work? Can you please to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> of your attempt and show us?"}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "edited": false, "score": 0, "creation_date": 1510777832, "post_id": 47316538, "comment_id": 81584230, "body": "I&#39;ve just edited my question, please take a look again!"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1510777861, "post_id": 47316538, "comment_id": 81584243, "body": "First find out how to run your script from the terminal, then use that same command in your call to <code>system</code>"}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "edited": false, "score": 0, "creation_date": 1510777957, "post_id": 47316538, "comment_id": 81584292, "body": "Well i do know how to do it, but i don&#39;t know how to use command &quot;bash test.sh&quot;  inside a C program... that&#39;s why i&#39;m asking"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510777991, "post_id": 47316538, "comment_id": 81584314, "body": "Is <code>test.sh</code> in the correct location? Is it marked executable? Does it have a <a href=\"https://en.wikipedia.org/wiki/Shebang_(Unix)\" rel=\"nofollow noreferrer\"><i>shebang</i></a>? If you make the path to it (in the program) absolute, make it executable and add a shebang, does it work then?"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1510778024, "post_id": 47316538, "comment_id": 81584337, "body": "@FrankPonte You just put any shell command in the string you pass to <code>system</code>, e.g.  <code>system(&quot;bash test.sh&quot;);</code>"}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "edited": false, "score": 0, "creation_date": 1510778178, "post_id": 47316538, "comment_id": 81584437, "body": "Yes, i&#39;ve just realize that what you write inside a system() function works exactly as writing it on terminal line! Thank you very much to every1 who gave me ideas: system(&quot;bash test.sh&quot;) just did the job!!"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510778151, "post_id": 47316722, "comment_id": 81584418, "body": "And what if the script is not in the current working directory of the process? <code>.</code> doesn&#39;t mean the same directory as the executable."}, {"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510778548, "post_id": 47316722, "comment_id": 81584646, "body": "Right <code>.</code> - current working directory. Note necessarily the one of the executable."}], "tags": [], "owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "is_accepted": false, "score": 1, "last_activity_date": 1510778659, "last_edit_date": 1510778659, "creation_date": 1510777934, "answer_id": 47316722, "question_id": 47316538, "link": "https://stackoverflow.com/questions/47316538/executing-a-homemade-shell-script-inside-a-c-program/47316722#47316722", "title": "Executing a homemade shell script inside a C program", "body": "<p>Try</p>\n\n<pre><code>system(\"./test.sh\");\n</code></pre>\n\n<p>And make sure the file is executable and exists at the specified path. The above works only if the file is in the <strong>current working directory</strong>.</p>\n"}], "owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510778659, "creation_date": 1510777201, "last_edit_date": 1510777997, "question_id": 47316538, "link": "https://stackoverflow.com/questions/47316538/executing-a-homemade-shell-script-inside-a-c-program", "title": "Executing a homemade shell script inside a C program", "body": "<p>I have a \"test.sh\" script and i need to run it inside a C program. Both files are in same folder. I've seen that people paste script code inside C program using #Define. I wonder if i can call that script without doing that. I'm looking for some function like \"Call(test.sh)\" inside C to execute and return the script. Any ideas?</p>\n\n<p>Test script code:</p>\n\n<pre><code> echo \"Hi, you're printing me from C program\"\n exit 1\n</code></pre>\n\n<p>Sorry, was kinda distracted! I'm working in ubuntu. I've done several scripts before and i need that script to re-execute my C program after it ends. I'm developing a simple game and i need the script to re-execute my program to play again without closing my terminal. Is this better clear? I'm doing it this way right now but is not working:</p>\n\n<pre><code>int main(){\n system(\"test.sh\");\n return 0;\n}\n</code></pre>\n\n<p>terminal says:\n     \" sh: 1: test.sh: not found\"</p>\n"}, {"tags": ["c", "pointers", "undefined-behavior"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1510777052, "post_id": 47316476, "comment_id": 81583823, "body": "Prototype for foo should be before using it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510777233, "post_id": 47316476, "comment_id": 81583938, "body": "Do you compile with warnings? At least -Wall."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1510777237, "post_id": 47316476, "comment_id": 81583941, "body": "@Siena  The program has undefined behavior."}, {"owner": {"reputation": 1555, "user_id": 3410584, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hVfv4.jpg?s=128&g=1", "display_name": "ValLeNain", "link": "https://stackoverflow.com/users/3410584/vallenain"}, "edited": false, "score": 1, "creation_date": 1510777402, "post_id": 47316476, "comment_id": 81584014, "body": "<code>*p1 = &amp;j</code> means that <code>*p1</code> stores the value of the address of the value 15. So you print <code>**p1</code> it will be 15. And since you&#39;ve passed <code>&amp;p</code> to the <code>foo</code>function <code>**p1</code>and <code>*p</code>refers to the same thing."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510777483, "post_id": 47316476, "comment_id": 81584058, "body": "Please edit the question to add the warnings you get with strict compilation for the code which has the prototype before the calling. There might be a problem around feeding a const-involving thing to a const-free parameter."}, {"owner": {"reputation": 568, "user_id": 4673017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b447a082ec2767cab280baf0c028d7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Siena", "link": "https://stackoverflow.com/users/4673017/siena"}, "edited": false, "score": 0, "creation_date": 1510777545, "post_id": 47316476, "comment_id": 81584097, "body": "yes, the program does throw warning. came across a quiz portal, but couldn&#39;t understand the output."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510777573, "post_id": 47316476, "comment_id": 81584115, "body": "Show the warnings. Pretty please."}, {"owner": {"reputation": 568, "user_id": 4673017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b447a082ec2767cab280baf0c028d7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Siena", "link": "https://stackoverflow.com/users/4673017/siena"}, "edited": false, "score": 0, "creation_date": 1510777652, "post_id": 47316476, "comment_id": 81584146, "body": "Using this IDE.  <a href=\"http://ide.geeksforgeeks.org/4l7xu0\" rel=\"nofollow noreferrer\">ide.geeksforgeeks.org/4l7xu0</a>"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1510777781, "post_id": 47316476, "comment_id": 81584204, "body": "You need to either put foo before main or predeclare it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1510777907, "post_id": 47316476, "comment_id": 81584264, "body": "Please understand, the answer to &quot;Why strange behaviour?&quot; of any program wiht undefined behaviour is &quot;Because undefined behaviour.&quot; So if you want an interesting answer you have to get rid of the UB by editing your code. @VladfromMoscow has noted UB for your code. I guess he thinks of similar things as I hint at with the prototype and the warnings. So please, please, please show the warnings and your thoughts on them. And do so directly, text here, not an external link. If you cannot demonstrate your question/problem without UB, then the answer will stay &quot;UB&quot;."}, {"owner": {"reputation": 568, "user_id": 4673017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b447a082ec2767cab280baf0c028d7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Siena", "link": "https://stackoverflow.com/users/4673017/siena"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510778940, "post_id": 47316476, "comment_id": 81584896, "body": "@Yunnosch I have edited the code. It&#39;s running without any warning now. However, the intent was to understand the address assignment to pointer-to-pointer variable P1"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510780699, "post_id": 47316476, "comment_id": 81585853, "body": "there is nothing to understand from this program."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510779822, "post_id": 47316820, "comment_id": 81585397, "body": "Code by OP has no <code>const</code> anymore (sorry for probably causing the target to move). You might want to comment, or maybe adapt the good answer."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1510780337, "last_edit_date": 1510780337, "creation_date": 1510778351, "answer_id": 47316820, "question_id": 47316476, "link": "https://stackoverflow.com/questions/47316476/unable-to-understand-the-pointer-to-pointer-output-15-15/47316820#47316820", "title": "Unable to understand the pointer to pointer output : 15 15", "body": "<p>The program has undefined behavior.</p>\n\n<p>To understand what is wrong in the program let's introduce a typedef for the pointer type.</p>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef int * T;\n\nint main(void) \n{\n    int i = 10;\n    const T p = &amp;i;\n\n    printf( \"%d\\n\", *p );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>10\n</code></pre>\n\n<p>As it is seen the variable <code>p</code> is declared with the qualifier const.</p>\n\n<p>Now let's try to add the function <code>foo</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef int * T;\n\nvoid foo( T *pp )\n{\n\n}\n\nint main(void) \n{\n    int i = 10;\n    const T p = &amp;i;\n\n    foo( &amp;p );\n\n    printf( \"%d\\n\", *p );\n\n    return 0;\n}\n</code></pre>\n\n<p>Oops, the compiler issued an error</p>\n\n<pre><code>prog.c:15:7: error: passing argument 1 of \u2018foo\u2019 discards \u2018const\u2019 qualifier from pointer target type [-Werror=discarded-qualifiers]\n  foo( &amp;p );\n       ^\nprog.c:5:6: note: expected \u2018int **\u2019 but argument is of type \u2018int * const*\u2019\n void foo( T *pp )\n</code></pre>\n\n<p>Indeed the variable <code>p</code> is declared with the qualifier <code>const</code></p>\n\n<pre><code>    const T p = &amp;i;\n</code></pre>\n\n<p>So a pointer to the variable must have the type <code>const T *</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef int * T;\n\nvoid foo( const T *pp )\n{\n\n}\n\nint main(void) \n{\n    int i = 10;\n    const T p = &amp;i;\n\n    foo( &amp;p );\n\n    printf( \"%d\\n\", *p );\n\n    return 0;\n}\n</code></pre>\n\n<p>Now if to dereference the parameter <code>pp</code> within the function we get a constant object that may not be changed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef int * T;\n\nvoid foo( const T *pp )\n{\n    int j = 15;\n    *pp = &amp;j;\n}\n\nint main(void) \n{\n    int i = 10;\n    const T p = &amp;i;\n\n    foo( &amp;p );\n\n    printf( \"%d\\n\", *p );\n\n    return 0;\n}\n</code></pre>\n\n<p>So the compiler again will issue an error</p>\n\n<pre><code>prog.c: In function \u2018foo\u2019:\nprog.c:8:6: error: assignment of read-only location \u2018*pp\u2019\n  *pp = &amp;j;\n      ^\n</code></pre>\n\n<p>And moreover you are trying to assign the address of a local variable that after exiting the function will be invalid. So even if the pointer was not constant in any case the program had undefined behavior.</p>\n\n<p>EDIT:\nAfter you seriously changed your program (that is a bad idea) in the question removing the <code>const</code> qualifier from the declaration of the pointer <code>p</code> nevertheless as I already said the program has undefined behavior because the pointer is assigned with the value of a local variable. So the pointer will have invalid value because the variable is not alive any more after exiting the function though you can get an expected result.</p>\n\n<pre><code>void foo(int **p1)\n{\n    int j = 15;\n    // Assigning the original variable p pointed to by the parameter p1\n    // the address of the local variable j.\n    *p1 = &amp;j; //I don't get this line\n    printf(\"%d\\n\", **p1); \n}\n</code></pre>\n\n<p>As for this statement</p>\n\n<pre><code>*p1 = &amp;j;\n</code></pre>\n\n<p>then the pointer p1 points to the original pointer <code>p</code>. So dereferencing the pointer <code>p1</code> you get the original pointer <code>p</code> to which the address of the local variable <code>j</code> is assigned.</p>\n"}, {"comments": [{"owner": {"reputation": 568, "user_id": 4673017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b447a082ec2767cab280baf0c028d7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Siena", "link": "https://stackoverflow.com/users/4673017/siena"}, "edited": false, "score": 0, "creation_date": 1510812812, "post_id": 47317455, "comment_id": 81596335, "body": "thanks John! concept very clearly explained"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1510780878, "creation_date": 1510780878, "answer_id": 47317455, "question_id": 47316476, "link": "https://stackoverflow.com/questions/47316476/unable-to-understand-the-pointer-to-pointer-output-15-15/47317455#47317455", "title": "Unable to understand the pointer to pointer output : 15 15", "body": "<p>Ignoring the undefined behavior<sup>1</sup> for a minute, here's what's happening, or at least the <em>intent</em> of the example.</p>\n\n<p>First, you have an integer object <code>i</code> containing the value <code>10</code>:</p>\n\n<pre><code>   +----+\ni: | 10 |\n   +----+\n</code></pre>\n\n<p>You create a pointer object <code>p</code> that points to <code>i</code>:</p>\n\n<pre><code>   +---+          +----+\np: |   | ----&gt; i: | 10 |\n   +---+          +----+\n</code></pre>\n\n<p>You pass the address of <code>p</code> to <code>foo</code>.  The function parameter <code>p1</code> points to <code>p</code>:</p>\n\n<pre><code>    +---+          +---+          +----+\np1: |   | ----&gt; p: |   | ----&gt; i: | 10 |\n    +---+          +---+          +----+\n</code></pre>\n\n<p>Within <code>foo</code> you create the integer object <code>j</code> with the value <code>15</code>:</p>\n\n<pre><code>   +----+\nj: | 15 |\n   +----+\n</code></pre>\n\n<p>Now, here's the fun part - you set <code>p</code> to point to <code>j</code> by <em>dereferencing</em> <code>p1</code> and assigning the address of <code>j</code> to the result.  <code>*p1 == p</code>, so by extension <code>*p1 = &amp;j</code> is effectively the same as writing <code>p = &amp;j</code>. After that line, you have the following situation:</p>\n\n<pre><code>    +---+          +---+          +----+\np1: |   | ----&gt; p: |   | ----&gt; j: | 15 |\n    +---+          +---+          +----+\n</code></pre>\n\n<p>That's why printing the value of <code>**p1</code> in <code>foo</code> outputs 15.  <code>p1 == &amp;p</code>, so <code>*p1 == p == &amp;j</code>, so <code>**p1 == *p == j == 15</code>.  </p>\n\n<p>Now, when the function <code>foo</code> exits, <code>j</code> <em>ceases to exist</em>, so <code>p</code> is no longer a <em>valid</em> pointer - it no longer points to an active object. Since it's no longer valid, the behavior on dereferencing it is <em>undefined</em>; your code may crash, or it may corrupt data, or it may appear to work as expected, or do something else entirely.  </p>\n\n<p>The <em>logical</em> object <code>j</code> ceased to exist, but the memory it used to occupy is still there, and will contain the last thing written to it, which is the value <code>15</code>.  As long as nothing else overwrites that memory, you'll continue to see <code>*p == 15</code>. But this behavior is not guaranteed, and you should not rely on it.  </p>\n\n<p>That's far from the only problem with this code, as Vlad and others have pointed out. But again, that's basically what's happening.</p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Including but not limited to: type mismatch between the implicit <em>declaration</em> of <code>foo</code> (function returning <code>int</code>) and the explicit <em>definition</em> of <code>foo</code> (function returning <code>void</code>), attempting to write to a <code>const</code>-qualified pointer through a non-<code>const</code> expression and dereferencing an invalid pointer.  \n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 568, "user_id": 4673017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b447a082ec2767cab280baf0c028d7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Siena", "link": "https://stackoverflow.com/users/4673017/siena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1510781046, "accepted_answer_id": 47317455, "answer_count": 2, "score": -2, "last_activity_date": 1510780878, "creation_date": 1510776969, "last_edit_date": 1510778769, "question_id": 47316476, "link": "https://stackoverflow.com/questions/47316476/unable-to-understand-the-pointer-to-pointer-output-15-15", "closed_reason": "Not suitable for this site", "title": "Unable to understand the pointer to pointer output : 15 15", "body": "<p>Could someone please help to understand on how the output of the following code is 15 15?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo(int **p1);\nint main()\n{\n    int i = 10;\n    int *p = &amp;i;\n    foo(&amp;p);  //address of constant pointer p passed to function\n    printf(\"%d\\n\", *p);\n\n}\nvoid foo(int **p1)\n{\n    int j = 15;\n    *p1 = &amp;j; //I don't get this line\n    printf(\"%d\\n\", **p1); \n}\n</code></pre>\n\n<p>Let's assume that addr(i)=ff2, addr(pointer p)=ff4, addr(j)=ff6</p>\n\n<p>i=10, j=15</p>\n\n<p>p= address(i), so p= ff2</p>\n\n<p>p1=address(p), so p1= ff4</p>\n"}, {"tags": ["c++", "c", "header"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 9, "creation_date": 1510777039, "post_id": 47316473, "comment_id": 81583815, "body": "Because they&#39;re in the sub-directory &#39;sys&#39; of wherever the include files are."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1510777052, "post_id": 47316473, "comment_id": 81583824, "body": "These headers aren&#39;t defined by the C(++) standards - these are OS-specific."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 1, "creation_date": 1510782367, "post_id": 47316473, "comment_id": 81586680, "body": "Suppose i write a <code>source.c</code> file inside a folder named test. If iput all headers defined by me inside inner folder <code>hd</code>, for using header i must write their addresses something like: <code>#include &lt;hd&#47;myheader.h&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1510781786, "post_id": 47317444, "comment_id": 81586385, "body": "Well, <i>sys/</i>, <i>net/</i> etc, and headers under them is defined by POSIX standard (I believe, did not verify), so it&#39;s not just a convention any more than C standard headers are a convention."}], "tags": [], "owner": {"reputation": 604, "user_id": 8908931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9a2630c9ff44937efd1bcb036b018e?s=128&d=identicon&r=PG&f=1", "display_name": "OriBS", "link": "https://stackoverflow.com/users/8908931/oribs"}, "is_accepted": false, "score": 4, "last_activity_date": 1510780831, "creation_date": 1510780831, "answer_id": 47317444, "question_id": 47316473, "link": "https://stackoverflow.com/questions/47316473/why-do-some-c-c-headers-have-sys-in-front-of-them/47317444#47317444", "title": "Why do some C/C++ headers have &quot;sys/&quot; in front of them?", "body": "<p>Practically, this shows those file are under a sub-folder named \"sys\" in  one of the standard list of system directories (e.g compiler default search path, or folder given as a parameter during the build).</p>\n\n<p>The reason they are in a sub-folder is to indicate they are not a part of the c or c++ standard libraries, but rather a specific extension, usually provided by the operating system you are working in.</p>\n\n<p>Note that this is only a matter of conventions, and not part of the specified behavior by C or C++. Usually to really understand those kind of header you will look at further documentation provided by the operating system you are working under.</p>\n"}], "owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 1, "closed_date": 1510781682, "answer_count": 1, "score": 0, "last_activity_date": 1510781544, "creation_date": 1510776946, "question_id": 47316473, "link": "https://stackoverflow.com/questions/47316473/why-do-some-c-c-headers-have-sys-in-front-of-them", "closed_reason": "Needs details or clarity", "title": "Why do some C/C++ headers have &quot;sys/&quot; in front of them?", "body": "<p>Some C/C++ headers like <code>&lt;sys/ioctl.h&gt;</code> have a \"sys/\" prefix in front of them.</p>\n\n<p>(There are also some with a \"net/\" prefix.)</p>\n\n<p>Why is this?</p>\n"}, {"tags": ["c", "for-loop", "switch-statement", "case"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1510776977, "post_id": 47316456, "comment_id": 81583778, "body": "A char holds one character. Not 2."}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 2, "last_activity_date": 1510777522, "creation_date": 1510777522, "answer_id": 47316623, "question_id": 47316456, "link": "https://stackoverflow.com/questions/47316456/find-sum-difference-etc-for-two-numbers-in-c-while-user-dont-exit/47316623#47316623", "title": "Find sum, difference, etc. for two numbers in C while user don&#39;t exit", "body": "<p>getchar returns a single character. if you want to use string 'xy', 'd99' etc you will have to read a string. <a href=\"https://stackoverflow.com/questions/314401/how-to-read-a-line-from-the-console-in-c\">How to read a line from the console in C?</a></p>\n\n<p>Second you cannot switch on a string you need to do</p>\n\n<pre><code>if(strcmp(input,\"SU\")==0)\n{\n....\n}\nelse if (strcmp(input, \"DQ\") == 0)\n{\n}\n...\nelse\n{\n... error\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 1293, "user_id": 7492420, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ca34e32c5b0e1aae0c1d5976cdd8ad60?s=128&d=identicon&r=PG&f=1", "display_name": "jovicbg", "link": "https://stackoverflow.com/users/7492420/jovicbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510777522, "creation_date": 1510776875, "last_edit_date": 1510777220, "question_id": 47316456, "link": "https://stackoverflow.com/questions/47316456/find-sum-difference-etc-for-two-numbers-in-c-while-user-dont-exit", "title": "Find sum, difference, etc. for two numbers in C while user don&#39;t exit", "body": "<p>I need to find the sum, diff, etc for two numbers that user input. But program first displays the menu, after that ask a user to input those numbers and do the operation. After that, it should ask a user if want to calculate something again, and if they want did it want with the old numbers or new.</p>\n\n<p>I'm a total beginner at C, so I need a help with a few thing. \nI got an error at Cases : </p>\n\n<blockquote>\n  <p><strong>cfinal.c:49:14:</strong> warning: multi-character character constant\n  [-Wmultichar]</p>\n</blockquote>\n\n<p>And this one:</p>\n\n<blockquote>\n  <p><strong>cfinal.c:49:14:</strong> warning: overflow converting case value to switch\n  condition\n            type (21075 to 83) [-Wswitch]</p>\n</blockquote>\n\n<p>There is something wrong and I can't figure it out. \nAnd the second problem is that I need to ask the user if they want to repeat all over again and if they choose Yes, did they want to do it with the new numbers or numbers used in previously calculation. \nThat's something I didn't even start, I don't know how. \nThanks. </p>\n\n<p>Code I've so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (void)\n{\n    char choice;                //Define choice character type\n    int first_number, second_number, firstSquare, secondSquare, firstQube, secondQube, cont;  //define intigers\n    printf(\"Select operation you would like to do by typing shortcut:\\n\");\n    printf(\"SU - sum\\n\");\n    printf(\"DI - difference\\n\");\n    printf(\"MU - multiplication\\n\");\n    printf(\"RA - ratio\\n\");\n    printf(\"SS - Sum of Squares\\n\");\n    printf(\"SQ - Sum of Qubes\\n\");\n    printf(\"RS - Sum of Squares\\n\");\n    printf(\"RQ - Sum of Qubes\\n\");\n    choice = (char)toupper(getchar());\n    getchar ();\n    printf(\"Enter the first number: \");\n    scanf(\"%d\", &amp;first_number);\n    getchar ();\n    printf(\"Enter the second number:\");\n    scanf(\"%d\", &amp;second_number);\n    getchar ();\n    firstSquare = first_number * first_number;\n    secondSquare = second_number * second_number;\n    firstQube = first_number * first_number * first_number;\n    secondQube = second_number * second_number * second_number;\n    printf(\"\\n\");\n    printf(\"Result is\");\n    switch(choice)\n    {\n        case 'SU':\n            printf(\"%d + %d = %d\", first_number, second_number, first_number + second_number);\n            break;\n        case 'DI':\n            printf(\"%d - %d = %d\", first_number, second_number, first_number - second_number);\n            break;\n        case 'MU':\n            printf(\"%d * %d = %d\", first_number, second_number, first_number * second_number);\n            break;\n        case 'SS':\n            printf(\"%d * %d + %d * %d = %d\", first_number, first_number, second_number, second_number);\n            break;\n        case 'SQ':\n            printf(\"%d * %d * %d + %d * %d * %d = %d\", first_number, first_number, first_number, second_number, second_number, second_number, firstQube + secondQube);\n            break;\n        case 'RS':\n            printf(\"(%d * %d) / (%d * %d) = %d\", first_number, first_number, second_number, second_number, firstSquare / secondSquare);\n            break;\n        case 'RQ':\n            printf(\"(%d * %d * %d) / (%d * %d * %d) = %f\", first_number, first_number, first_number, second_number, second_number, second_number, firstQube / secondQube);\n            break;\n        case 'RA':\n            if (second_number == 0)\n                fprintf(stderr, \"The divisor can't be 0\");\n            else\n            {\n                printf(\"%d / %d = %f\", first_number, second_number, (double)first_number / second_number);\n            }\n            break;\n        default :\n            fprintf(stderr, \"Invalid entry\");\n            break;\n    }\n    printf(\"\\n\");\n    for (;;)\n    {\n      printf(\"Continue (Type Y for yes or N for no)? \");\n      cont = toupper(getchar());\n      getchar ();\n      if (cont == 'Y')\n          return main(); // the difference.\n      else if (cont == 'N')\n          return EXIT_SUCCESS;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1510776354, "post_id": 47316304, "comment_id": 81583482, "body": "Are you ever allocating anything? This &quot;object&quot; is an array of pointers."}, {"owner": {"reputation": 129, "user_id": 7419652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e1fa1bb27a5e810acb7030d2888711d?s=128&d=identicon&r=PG&f=1", "display_name": "Mikkel bruun", "link": "https://stackoverflow.com/users/7419652/mikkel-bruun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510777024, "post_id": 47316304, "comment_id": 81583804, "body": "No the structs are never initialized. s is just an array of pointers, as you said. But what i want to know is, why does one work when the other doesn&#39;t?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1510777747, "post_id": 47316304, "comment_id": 81584188, "body": "You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, but if the <code>struct</code>s are not initialized, as you said in a comment, then this is undefined behavior: <code>printf(&quot;%d&quot;,(*s)-&gt;member1);</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1510779163, "post_id": 47316304, "comment_id": 81585025, "body": "Undefined behavior doesn&#39;t have to cause an error. It&#39;s undefined, so anything can happen, including something that appears to work. Your first example got lucky and didn&#39;t happen to indirect through an invalid address."}], "owner": {"reputation": 129, "user_id": 7419652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e1fa1bb27a5e810acb7030d2888711d?s=128&d=identicon&r=PG&f=1", "display_name": "Mikkel bruun", "link": "https://stackoverflow.com/users/7419652/mikkel-bruun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510776286, "creation_date": 1510776286, "question_id": 47316304, "link": "https://stackoverflow.com/questions/47316304/arrays-of-structs-and-pointers-to-them", "title": "arrays of structs and pointers to them", "body": "<p>I have a struct with some members. In my main, the object i'm working on is defined like so</p>\n\n<pre><code>myStruct* s[1];\n</code></pre>\n\n<p>I then use it in a function like so</p>\n\n<pre><code>myFyn(myStruct **s){\n  printf(\"%d\",(*s)-&gt;member1);\n}\nmyFun(&amp;s[0]);\n</code></pre>\n\n<p>This works just fine and lets me print member1.\nHowever, if I define mystruct like</p>\n\n<pre><code>mystruct* s[2];\nmyFun(&amp;s[0]);\n</code></pre>\n\n<p>I'm met with segmentation faults every time i try to run the program. </p>\n\n<p>Why is this? Is the something fundemental about pointers/arrays I'm misunderstanding?</p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1510775626, "post_id": 47316019, "comment_id": 81583091, "body": "Look ok to me. The only question is: how did the higher level code call the function? See <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a> in the <a href=\"https://stackoverflow.com/help\">help center</a>."}, {"owner": {"reputation": 105, "user_id": 7718012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a098dad80211e12587efd7b30b2157d?s=128&d=identicon&r=PG&f=1", "display_name": "HaroldF", "link": "https://stackoverflow.com/users/7718012/haroldf"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1510776988, "post_id": 47316019, "comment_id": 81583783, "body": "@user3386109 I edited my question with some more details"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1510794920, "post_id": 47316019, "comment_id": 81591128, "body": "The function declaration says that both <code>a</code> and <code>b</code> have <code>SIZE</code> columns. There are two problems with that. 1) You haven&#39;t shown the definition of <code>SIZE</code> (which means you didn&#39;t read about <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>). 2) The arrays in <code>main</code> don&#39;t have the same number of columns."}], "owner": {"reputation": 105, "user_id": 7718012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a098dad80211e12587efd7b30b2157d?s=128&d=identicon&r=PG&f=1", "display_name": "HaroldF", "link": "https://stackoverflow.com/users/7718012/haroldf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 734, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510776953, "creation_date": 1510775174, "last_edit_date": 1510776953, "question_id": 47316019, "link": "https://stackoverflow.com/questions/47316019/c-function-that-checks-if-a-matrix-is-a-submatrix-of-another", "title": "C: function that checks if a matrix is a submatrix of another", "body": "<p>Given two matrices I want to check if one is contained in the other, i have the dimension of the matrices, and i have written a function which doesn't work and i don't know why: here is the code explained:</p>\n\n<pre><code>               /*Where m,n are the dimensions of the first matrix \n                and u,v the dimensions of the second one, the integer\n                 pointers are to remember from where,row and column,\n                 (for the first time) the matrices overlap */        \n\n\n            int function(int a[][SIZE],int m,int n, int  b[][SIZE],int u,int v, int *r,int *c)\n                    {\n                     int i,j,x,y,cont=0;\n\n        /*The first two 'for' cycles are to choose a suitable starting point for the confrontation  */ \n                     for(i=0;i&lt;m-u+1;i++)        \n                     {\n                         for(j=0;j&lt;n-v+1;j++)\n                         {\n                             cont=0; /*Every time it choose the starting point, the counter start from 0 */\n                                 for(x=0;x&lt;u;x++)\n                                 {\n                                     for(y=0;y&lt;v;y++)\n                                     {\n                                         if(a[i+x][j+y] == b[x][y]) /*Here there is the confrontation between the elements*/\n                                         {\n                                             cont++; /*This counts the number of equal elements between the second matrix b and the (same-dimension-part of) first matrix*/\n\n\n                                         }\n\n                                     } \n                                 }      /*It does the confrontations as many times as the elements of b, so u*v times */\n\n                                if(cont==u * v) /*If the elements are equal for every element of b, the program return 1*/\n                                 {\n                                     *r=i;\n                                     *c=j;\n                                     return 1;\n\n\n                                 }\n\n                         }\n                     }\n\n                   /*If it has never returned one, it return 0*/\n                     return 0;\n                    }\n</code></pre>\n\n<p>Here there is an example of usage of the function:</p>\n\n<pre><code>int function(int a[][SIZE],int m,int n, int  b[][SIZE],int u,int v, int *r,int *c);\n\n        int main()\n        {\n         int i,j,x=0,y=0;\n         int a[10][10],b[2][2];\n         int *r=&amp;x,*c=&amp;y;\n\n        srand(time(NULL));\n\n        for(i=0;i&lt;10;i++)\n         {\n         for(j=0;j&lt;10;j++)\n        {\n             if(i&lt;2 &amp;&amp; j&lt;2)\n                 b[i][j]=rand()%2;\n\n         a[i][j]=rand()%2;\n        }\n        }\n        i=function(a,10,10,b,2,2,r,c);\n        if(i==1)\n             printf(\"(%d , %d)\\n\", *r,*c);\n        else\n             printf(\"b is not a submatrix of a\\n\");\n\n        return 0;\n        } \n</code></pre>\n\n<p>P.s. I tried to print, for every time <code>a[i+x][j+y]==b[x][y]</code>, the elements <code>a[i+x][j+y]</code> and <code>b[x][y]</code>. But it happens that b[x][y] is, sometime, the wrong value (e.g. if b is made of ones only, it happens that after a confrontation b[x][y] is printed as zero). </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1510775270, "post_id": 47316006, "comment_id": 81582901, "body": "Did you enable compiler warnings?"}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 1, "creation_date": 1510775334, "post_id": 47316006, "comment_id": 81582934, "body": "Try <code>scanf(&quot;%d\\n&quot;, &amp;temp_fahr);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510775719, "post_id": 47316006, "comment_id": 81583142, "body": "Your calculation is <b>integer arithmetic</b>, which is then passed to <code>printf</code> to satisfy a <code>double</code> argument expected."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510775810, "post_id": 47316006, "comment_id": 81583195, "body": "... so it needs to be <code>(double)(temp_fahr-MINUS)*TIMES</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1510776783, "post_id": 47316006, "comment_id": 81583676, "body": "Among other things, the value of <code>TIMES</code> is 0. If you write <code>(double)(temp_fahr-MINUS)*TIMES</code>, it will work, but not for the reason you might expect. That never computes the value of <code>5.0&#47;9.0</code> (approximately 0.555); rather, it&#39;s equivalent to <code>((double)(temp_fahr-32)*5)&#47;9</code>. The <code>5</code> is promoted to floating-point for the multiplication, then the <code>9</code> is promoted to floating-point for the division. Use <code>#define TIMES (5.0&#47;9.0)</code>; using floating-point constants avoids truncating integer division, and the parentheses force it to  be evaluated as a single expression."}, {"owner": {"reputation": 879, "user_id": 4037594, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kYIVz.png?s=128&g=1", "display_name": "Haem", "link": "https://stackoverflow.com/users/4037594/haem"}, "edited": false, "score": 0, "creation_date": 1510778796, "post_id": 47316006, "comment_id": 81584817, "body": "By the by, was that a freeze you were getting or a crash? Those are two different things."}], "answers": [{"tags": [], "owner": {"reputation": 879, "user_id": 4037594, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kYIVz.png?s=128&g=1", "display_name": "Haem", "link": "https://stackoverflow.com/users/4037594/haem"}, "is_accepted": false, "score": 1, "last_activity_date": 1510775734, "creation_date": 1510775734, "answer_id": 47316169, "question_id": 47316006, "link": "https://stackoverflow.com/questions/47316006/why-does-it-keep-freezing/47316169#47316169", "title": "Why does it keep freezing", "body": "<p>Your problem is the line </p>\n\n<pre><code>scanf(\"%d\\n\",temp_fahr);\n</code></pre>\n\n<p>As the compiler warnings will tell you, it expects an input of type <code>int *</code> but receives an integer instead. So, it tries to write into the address <code>temp_fahr</code> points to which causes a segmentation fault.</p>\n\n<p>Second, if you fix it by supplying a pointer to <code>temp_fahr</code>, <code>scanf</code> keeps waiting for the newline which gets trimmed from standard input, so it gets stuck there. So, the correct line is </p>\n\n<pre><code>scanf(\"%d\",&amp;temp_fahr);\n</code></pre>\n\n<p>You'll also notice that the <code>%f</code>format expects an argument of type <code>double</code> and receives an integer instead, so you'll want to cast the result to double at some point before passing it to <code>printf</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 8559099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4071bde55ab79f9fe9dc4958a9cf8973?s=128&d=identicon&r=PG&f=1", "display_name": "Arik gorun", "link": "https://stackoverflow.com/users/8559099/arik-gorun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1510775734, "creation_date": 1510775146, "question_id": 47316006, "link": "https://stackoverflow.com/questions/47316006/why-does-it-keep-freezing", "title": "Why does it keep freezing", "body": "<p>I have tried switching the defines to consts but it doesn't seem to work either</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define TIMES 5/9\n#define MINUS 32\nint main()\n{\n    int temp_fahr = 0;\n    printf(\"Enter the temperature in fahrenheit\\n\");\n    scanf(\"%d\\n\",temp_fahr);\n    printf(\"The temperature in celcious is: %.3f\\n\",(temp_fahr-MINUS)*TIMES);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "c++11", "language-lawyer", "c11"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510775044, "post_id": 47315902, "comment_id": 81582765, "body": "So long as you don&#39;t search beyond the end of the range, it&#39;s defined."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510775105, "post_id": 47315902, "comment_id": 81582806, "body": "Thanks @AndyG - what do you mean by &quot;you&quot; here? Do you mean &quot;so long as the <code>memchr</code> implementation wouldn&#39;t be required to search beyond the end of the range&quot;?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510775176, "post_id": 47315902, "comment_id": 81582846, "body": "@AndyG: Do you have a reference that explains exactly why <code>memchr</code> isn&#39;t allowed to touch <code>buf[19]</code> if <code>buf[3]</code> contains a match?  So you&#39;re allowed to pass a length that goes into an unmapped page?  <code>memchr</code> doesn&#39;t work like <code>memchr(char buf[static count], char needle, size_t count)</code>?"}, {"owner": {"reputation": 10649, "user_id": 255803, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/k9vUb.png?s=128&g=1", "display_name": "AVH", "link": "https://stackoverflow.com/users/255803/avh"}, "edited": false, "score": 0, "creation_date": 1510775181, "post_id": 47315902, "comment_id": 81582850, "body": "Assuming <a href=\"http://en.cppreference.com/w/c/string/byte/memchr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/string/byte/memchr</a> is correct, accessing beyond the actual limits leads to undefined behavior. I.e. there&#39;s no issue as long as a result is found before an access occurs past the end of the actual array."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510775418, "post_id": 47315902, "comment_id": 81582978, "body": "@PeterCordes: It was easier to put it into an answer. Pulling from n1548 here. cppreference also corroborates this."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1510780127, "post_id": 47315902, "comment_id": 81585559, "body": "See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1533.htm\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n1533.htm</a>"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1510818975, "post_id": 47315902, "comment_id": 81599186, "body": "@T.C. - thanks! Good to see it has explicitly been discussed."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1510775563, "post_id": 47316040, "comment_id": 81583057, "body": "Ok, that does explicitly disallow an asm implementation that assumes it can safely touch all the bytes out to <code>buf[count-1]</code> (e.g. with a SIMD vector), without some kind of implementation-specific check that it can&#39;t actually fault (like <a href=\"https://stackoverflow.com/questions/37800739/is-it-safe-to-read-past-the-end-of-a-buffer-within-the-same-page-on-x86-and-x64\">checking that it doesn&#39;t cross a page boundary on a typical CPU</a>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1510776300, "post_id": 47316040, "comment_id": 81583444, "body": "What is the wording in <code>C99</code>?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1510776536, "post_id": 47316040, "comment_id": 81583574, "body": "@BeeOnRope: Updated post with exact wording from both C99 and C11"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1510776725, "post_id": 47316040, "comment_id": 81583650, "body": "@JohannesSchaub-litb: It certainly doesn&#39;t disallow SIMD, it just mildly constrains your start-up options for doing an unaligned multi-byte load.  (Aligned loads can never cross cache-line or page boundaries, so they&#39;re always safe if they include any bytes you know you&#39;re allowed to touch.)  Interesting point about a C implementation that catches access violations, though.  That would be possible if it didn&#39;t provide POSIX signal handling, e.g. maybe a bare-metal one that didn&#39;t expose #GP exceptions in C."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1510777103, "post_id": 47316040, "comment_id": 81583857, "body": "I suppose you could also have an implementation that still exposed the #GP exceptions in C, but only after filtering them. I.e., the implementation handles them initially, checks if they are caused by one of the &quot;might GP&quot; routines and handles them internally in that case, otherwise passes them on to the user handler. Java is a little bit like that: it uses GPs to catch unusual cases like rare null pointers access (implicit null), and recovers if the GP occurred in such a context. In other contexts it will panic with info about the GP (dunno if user native code can handle GP in that case)."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510777432, "post_id": 47316040, "comment_id": 81584033, "body": "@PeterCordes sorry, I figured I would first read more carefully to comment again. Looks like your reply raced with my deletion."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510777857, "post_id": 47316040, "comment_id": 81584240, "body": "@PeterCordes I think I understand now. You say if the first few bytes are within the last word of the page, and it starts SIMD-reading from the provided address, the vector could cross a page boundary. It seems that would be a poor implementation, because all subsequent SIMD-reads would also be unaligned. I would expect the implementation to have a pre-loop code that patches the address up to be aligned first, reading the first bytes using &quot;char*&quot;."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1510778447, "post_id": 47316040, "comment_id": 81584586, "body": "@JohannesSchaub-litb: often a good SIMD strategy is a (possibly) unaligned first vector, then aligned later vectors.  Overlap between the unaligned load and the aligned loads happens only if the pointer is actually not aligned.  It&#39;s potentially good for <code>memchr</code> because all results from 0 to 15 have the same branching.  (packed compare -&gt; count is branchless)  <a href=\"https://stackoverflow.com/questions/43483378/why-arent-stdcount-and-stdfind-optimised-to-use-memchr/47301272?noredirect=1#comment81583474_47301272\">See discussion on another Q&amp;A about memchr strategies.</a>"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1510779375, "post_id": 47316040, "comment_id": 81585138, "body": "@JohannesSchaub-litb - in addition to what has been mentioned there, unaligned access has gotten <i>a lot</i> better in the last decade on mainstream implementations such as Intel x86. On the last few generations of Intel chips the unaligned penalty has disappeared or nearly so for many algorithms. For example, Intel chips have basically zero penalty for unaligned loads that don&#39;t cross a cache line, and those that do can still execute 1 per cycle (versus two per cycle for non-crossing): since most loops probably don&#39;t exceed 1 load/cycle even this penalty is often invisible."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1510779511, "post_id": 47316040, "comment_id": 81585224, "body": "So setting up &quot;lead in&quot; code that tries to get to an aligned state might kill your performance with short strings/regions, which is often exactly what matters. A reasonable strategy is to do some unaligned (cheap) stuff for a few iterations until you have reached some crossover point at which point you assume the string is long enough and you flip to aligned. Sometimes just never flipping to aligned at all is probably better on modern hardware."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510802675, "post_id": 47316040, "comment_id": 81593131, "body": "I&#39;ll remark that changes between standard revisions to the behaviour of library functions  can be risky to rely on in practice, since compilers and libraries are developed separately; e.g. there are plenty of implementations of GCC 7 for Windows, that don&#39;t support %zu in printf"}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": true, "score": 12, "last_activity_date": 1510776514, "last_edit_date": 1510776514, "creation_date": 1510775241, "answer_id": 47316040, "question_id": 47315902, "link": "https://stackoverflow.com/questions/47315902/is-it-legal-to-call-memchr-with-a-too-long-length-if-you-know-the-character-wil/47316040#47316040", "title": "Is it legal to call memchr with a too-long length, if you know the character will be found before reaching the end of the valid region?", "body": "<p>In C11 and C++17 (<strong>emphasis mine</strong>)</p>\n\n<blockquote>\n  <p><code>void *memchr(const void *s, int c, size_t n);</code> <br/><br/>\n  The <code>memchr</code> function locates the first occurrence of <code>c</code> (converted to an <code>unsigned char</code>) in the initial <code>n</code> characters (each interpreted as <code>unsigned char</code>) of the object\n  pointed to by <code>s</code>. <strong>The implementation shall behave as if it reads the characters sequentially\n  and stops as soon as a matching character is found.</strong></p>\n</blockquote>\n\n<p>So long as <code>memchr</code> finds what it's looking for before you step out of bounds, you're okay.</p>\n\n<hr>\n\n<p>C++11 and C++14 both use C99, which doesn't have such wording. (They refer to ISO/IEC 9899:1999)</p>\n\n<p>C99 wording:</p>\n\n<blockquote>\n  <p><code>void *memchr(const void *s, int c, size_t n);</code> <br/><br/>The <code>memchr</code> function locates the first occurrence of <code>c</code> (converted to an <code>unsigned char</code>) in the initial <code>n</code> characters (each interpreted as <code>unsigned char</code>) of the object\n  pointed to by <code>s</code>.</p>\n</blockquote>\n\n<p>By not defining what happens if you pass too large of a size, the behavior is <em>undefined</em> in C99</p>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "accepted_answer_id": 47316040, "answer_count": 1, "score": 10, "last_activity_date": 1510802452, "creation_date": 1510774787, "last_edit_date": 1510802452, "question_id": 47315902, "link": "https://stackoverflow.com/questions/47315902/is-it-legal-to-call-memchr-with-a-too-long-length-if-you-know-the-character-wil", "title": "Is it legal to call memchr with a too-long length, if you know the character will be found before reaching the end of the valid region?", "body": "<p>Is the following defined behavior in C11 and C++11<sup>1</sup>?</p>\n\n<pre><code>bool has4() {  \n    char buf[10] = {0, 1, 2, 4};\n    return memchr(buf, 4, 20);\n}\n</code></pre>\n\n<p>Here we pass a too-long length to <code>memchr</code>. The array has 10 elements but we pass 20. The element we are searching for, however, is always found before the end. It is clear to me if this is legal.</p>\n\n<p>If this is allowed, it would limit implementation flexibility, since the implementation cannot rely on the size being a valid indication of the size of the accessible memory region and hence must be careful about reading beyond the found element. An example would be an implementation that wants to do a 16 byte SIMD load starting at the passed-in pointer and then check all the 16 bytes in parallel. If the user passes a length of 16, this would be safe only if the entire length was required to be accessible.</p>\n\n<p>Otherwise (if the above code is legal) the implementation must avoid potentially faulting on elements past the target element, for example by aligning the load (potentially expensive) or checking if the pointer is near the <a href=\"https://stackoverflow.com/q/37800739/149138\">end of a protection boundary</a>.</p>\n\n<hr>\n\n<p><sup>1</sup> Here's one of those rare questions where I guess tagging both C and C++ is valid: as far as I can tell the C++ standard just defers directly to the C standard here, via reference, in terms of behavior, but if that's not the case I want to know.</p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510786035, "post_id": 47315816, "comment_id": 81588436, "body": "Also, note that the count_array only needs <code>MAX_VALUE</code> items"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1510775109, "creation_date": 1510775109, "answer_id": 47315992, "question_id": 47315816, "link": "https://stackoverflow.com/questions/47315816/count-sort-in-c-could-only-sort-first-4-numbers/47315992#47315992", "title": "Count sort in C could only sort first 4 numbers", "body": "<p>The error is in the code that distributes the counts back to the output array. You end iterations of counts upon reaching the length of the original array, while you should be ending it when you reach the max value:</p>\n\n<pre><code>void count_sort_write_output_array(int output_array[], int len, int count_array[]){\n    k=0;\n    for (j=0;j&lt;MAX_LAENGE;j++)\n    {\n        for (i=0; i&lt;count_array[j]; i++)\n        {\n            output_array[k++] = j;\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/3dq4ql\" rel=\"nofollow noreferrer\">Demo.</a></p>\n\n<p>To earn some \"points for style\" consider hiding the array of counts inside a single sorting function that computes counts and distributes the values back to the output array. After all, counts is an intermediate result that should be of no interest to users of your code, so you should not ask users of your sorting function to allocate it.</p>\n"}], "owner": {"reputation": 29, "user_id": 8826905, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f5c7eb4b2ef872f0c96cc5d35ff0fe88?s=128&d=identicon&r=PG&f=1", "display_name": "Ryoine", "link": "https://stackoverflow.com/users/8826905/ryoine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 47315992, "answer_count": 1, "score": 0, "last_activity_date": 1510775311, "creation_date": 1510774431, "last_edit_date": 1510775311, "question_id": 47315816, "link": "https://stackoverflow.com/questions/47315816/count-sort-in-c-could-only-sort-first-4-numbers", "title": "Count sort in C could only sort first 4 numbers", "body": "<p>I am just working for a C programm using counting sort to sort numbers, here is my code, and I am using a external txt file for input. and the library arrayio.h is a given code for input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"arrayio.h\"\n\nint MAX_LAENGE = 1000;\nint MAX_VALUE = 100;\nint i,j,k;\n\nvoid count_sort_calculate_counts(int input_array[], int len, int count_array[]) {\n    for (i=0; i&lt;len;i++) {\n        count_array[i] = 0;\n    }\n    for (j=0; j&lt;len;j++) {\n        count_array[input_array[j]] = count_array[input_array[j]] + 1;\n    }\n}\n\nvoid count_sort_write_output_array(int output_array[], int len, int count_array[]) {\n    k=0;\n    for (j=0;j&lt;len;j++) {\n        for (i=0; i&lt;count_array[j]; i++) {\n            output_array[k] = j;\n            k = k + 1;\n        }\n    }\n}\n\nint main(int argc, char *argv[]) {\n    if (argc &lt; 2){\n        printf(\"Aufruf: %s &lt;Dateiname&gt;\\n\", argv[0]);\n        printf(\"Beispiel: %s zahlen.txt\\n\", argv[0]);\n        exit(1);\n    }\n    char *filename = argv[1];\n\n    int input_array[MAX_LAENGE];\n    int len = read_array_from_file(input_array, MAX_LAENGE, filename);\n\n    printf(\"Unsortiertes Array:\");\n    print_array(input_array, len);\n\n    int count_array[MAX_LAENGE];\n    int output_array[MAX_LAENGE];\n    count_sort_calculate_counts(input_array, len, count_array);\n    count_sort_write_output_array(output_array, len, count_array);\n\n    printf(\"Sortiertes Array:\");\n    print_array(output_array, len);\n    return 0;\n}\n</code></pre>\n\n<p>My problem is that when I run this program, it returns only the first 4 numbers.\nfor example, when I input:</p>\n\n<pre><code>90 38 42 34 8 0 77 1 84 5 25 72 44 42 90 63 23\n</code></pre>\n\n<p>It returns:</p>\n\n<pre><code>0 1 5 8 0 0 0 0 0 0 0 0 0 0 0 0 0\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2017"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1510774272, "post_id": 47315733, "comment_id": 81582381, "body": "Why are you reassigning <code>pStruct1</code> immediately after initializing it by calling <code>GetStruct1()</code>?"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1510774282, "post_id": 47315733, "comment_id": 81582391, "body": "<code>Object9</code> isnt the most meaningful name, is it? Less offtopic: &quot;... //Disables some errors that migth occure&quot; would be the first thing i would remove when debugging this"}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510774331, "post_id": 47315733, "comment_id": 81582407, "body": "I have debugged the code without success."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1510774343, "post_id": 47315733, "comment_id": 81582414, "body": "It should be <code>malloc(sizeof(Object9 *))</code>. When calling <code>malloc()</code> the type in <code>sizeof</code> should always have one less <code>*</code> than the pointer you&#39;re assigning to."}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510774371, "post_id": 47315733, "comment_id": 81582425, "body": "The object9 struct and the header files are created by the teacher."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1510774396, "post_id": 47315733, "comment_id": 81582437, "body": "send your teacher a big LOL from me ;)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1510774403, "post_id": 47315733, "comment_id": 81582441, "body": "@SanderTs. During your debugging, did you determine what line the error is happening on? Please include this in the question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1510774485, "post_id": 47315733, "comment_id": 81582487, "body": "You keep on reassigning pointers, causing lots of memory leaks. Like <code>p = (Object9 *)malloc(sizeof(Object9)); p = *pStruct1;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1510774506, "post_id": 47315733, "comment_id": 81582501, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc in C</a>"}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510774698, "post_id": 47315733, "comment_id": 81582603, "body": "The p = *pStruct1 was just a way to try and see if it works. Most of the code comes from the lessons materials."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1510789704, "post_id": 47315733, "comment_id": 81589653, "body": "There are no execptions in C."}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510826723, "post_id": 47315733, "comment_id": 81604139, "body": "Olaf, I don&#39;t fully understand what exactly do you mean by that. Where is the execption in my code ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510775326, "post_id": 47315948, "comment_id": 81582929, "body": "Thanks. But now I have this error: &quot;Exception thrown: read access violation. p was 0x1110112.&quot; in the same line where I am trying to print it out."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510775638, "post_id": 47315948, "comment_id": 81583101, "body": "I&#39;ve updated the answer to show the correct way to use <code>p</code>."}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510775880, "post_id": 47315948, "comment_id": 81583228, "body": "p = pStruct1 gives this error C2440: &#39;=&#39;: cannot convert from &#39;Object9 **&#39; to &#39;Object9 *&#39;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510775941, "post_id": 47315948, "comment_id": 81583251, "body": "It should be declared <code>Object9 **</code>."}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510776145, "post_id": 47315948, "comment_id": 81583354, "body": "The first line now gives this error C2040: &#39;p&#39;: &#39;Object9 **&#39; differs in levels of indirection from &#39;Object9 *&#39;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510776201, "post_id": 47315948, "comment_id": 81583382, "body": "You didn&#39;t change the declaration as I said."}, {"owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "edited": false, "score": 0, "creation_date": 1510777714, "post_id": 47315948, "comment_id": 81584168, "body": "I did exactly like you wrote, but still getting errors: Exception thrown at 0x01053BE5 in Project1.exe: 0xC0000005: Access violation reading location 0x00000000. I guess I have to find another ways to do this. I really appreciate the help."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1510775931, "last_edit_date": 1510775931, "creation_date": 1510774934, "answer_id": 47315948, "question_id": 47315733, "link": "https://stackoverflow.com/questions/47315733/exception-thrown-read-access-violation-cannot-print-info-from-a-header-file/47315948#47315948", "title": "Exception thrown: read access violation. Cannot print info from a header file", "body": "<p>The problem is that you're overwriting the pointer returned by <code>GetStruct1</code> with a new pointer from <code>malloc()</code> and this points to uninitialized data, not the array of structures. Get rid of the line:</p>\n\n<pre><code>pStruct1 = (Object9 **)malloc(sizeof(Object9 **));\n</code></pre>\n\n<p>You also don't need this line:</p>\n\n<pre><code>p = (Object9 *)malloc(sizeof(Object9));\n</code></pre>\n\n<p>since you immediately overwrite <code>p</code> with:</p>\n\n<pre><code>p = *pStruct1;\n</code></pre>\n\n<p>You're also using <code>p</code> wrong. <code>pStruct1</code> is a pointer to an array of pointers. When you set <code>p</code> as above, it's set to the first pointer in the array. Adding to <code>p</code> doesn't get you the next pointer in the array, it points outside the object that <code>p</code> pointed to. You need to set <code>p</code> to <code>pStruct</code>, add to this, and then indirect through that to get the pointer in the array.</p>\n\n<pre><code>Object9 **p = pStruct1;\nfor (int i = 0; i &lt; 35; i++) }\n    printf(\"%p\\n\", *(p + i));\n    printf(\"%s\\n\", (*(p + i))-&gt;pID);\n}        \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7643304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a11b1c64efaacb7ade46702ed3102?s=128&d=identicon&r=PG&f=1", "display_name": "Sander Ts.", "link": "https://stackoverflow.com/users/7643304/sander-ts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510828983, "creation_date": 1510774123, "last_edit_date": 1510828983, "question_id": 47315733, "link": "https://stackoverflow.com/questions/47315733/exception-thrown-read-access-violation-cannot-print-info-from-a-header-file", "title": "Exception thrown: read access violation. Cannot print info from a header file", "body": "<p>I am trying to print out the information from pID pointer that is located in Objects.h header file. Whatever I try to do I get the \"Exception thrown: read access violation. p was 0xCEDECEDF.\" error in Visual Studio 2017. In other words it is unable to read memory.\nThis is the code part from main.cpp file. The error comes in from the For cycle where I am trying to print out the info. I have debugged the code with no success.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"DateTime.h\"\n#include \"Objects.h\"\n#include \"Headers.h\"\n#include \"Structs.h\"\n#include \"malloc.h\"\n#pragma warning ( disable : 4996 )  //Disables some errors that might occure\n\nvoid PrintObjects(Object9 **ppStruct1);\n//int InsertNewObject(HeaderA **ppStruct1, char *pNewID, int NewCode);\n//Object9* RemoveExistingObject(HeaderA **pStruct1, char *pExistingID);\n\nint main()\n{\n    Object9 **pStruct1 = (Object9 **)GetStruct1(9, 35);\n\n    Object9 **p = pStruct1;\n    int i;\n    for (i = 0; i &lt; 35; i++)\n    {\n        printf(\"%p\\n\", *(p + i));\n        printf(\"%s\\n\", (*(p + i))-&gt;pID); //This is the line where the error \n        //occures\n    }\n\n    if (pStruct1 == NULL)\n        printf(\"pStrcut on NULL\\n\");\n    else\n        printf(\"Ok\\n\");\n    PrintObjects(pStruct1);\n\n    return 0;\n}\n</code></pre>\n\n<p>This is the part from the Objects.h file.</p>\n\n<pre><code>typedef struct ob9\n{  // formatting string for printf is \"%s %lu %02d %s %04d\\n\", the result is \n      for example \"Abcde 100 01 Detsember 2010\"\n   // or \"Abcde Fghij 100 01 Detsember 2010\"\n    char *pID;\n    unsigned long int Code;\n    Date3 *pDate3; // Declaration of Date3 is in file DateTime.h\n    struct ob9 *pNext;\n} Object9;\n</code></pre>\n\n<p>The GetStruct1 function comes from the Structure.h header file. I don't know if this helps to determine the problem or not, but just in case I'm also adding the entire Structs.h file code.\nI need to use: \"void **GetStruct1(int ObjectType, int nObjects);\" function.</p>\n\n<pre><code>//\n//            Structures: function prototypes\n//            -------------------------------\n\nvoid **GetStruct1(int ObjectType, int nObjects);\nHeaderA *GetStruct2(int ObjectType, int nObjects);\nHeaderB *GetStruct3(int ObjectType, int nObjects);\nHeaderC *GetStruct4(int ObjectType, int nObjects);\nHeaderA **GetStruct5(int ObjectType, int nObjects);\nHeaderA *GetStruct6(int ObjectType, int nObjects);\nHeaderD *GetStruct7(int ObjectType, int nObjects);\n\n/* ObjectType - 1, 2,...10 - type of objects to be inserted into the data \n structure.\n   nTypes -number of objects to be inserted into the data structure.\n   ObjectType and nObjects are specified by the instructor.\n   Return value - pointer to the first byte of data structure.\n\n   Examples for structure from 25 objects of type 4:\n   Object4 **pStruct1 = (Object4 **)GetStruct1(4, 25);\n   HeaderA *pStruct2 = GetStruct2(4, 25);\n   HeaderB *pStruct3 = GetStruct3(4, 25);\n   HeaderC *pStruct4 = GetStruct4(4, 25);\n   HeaderA **pStruct5 = GetStruct5(4, 25);\n*/\n</code></pre>\n\n<p>I can print out the address but not the info I need. I know I am doing something wrong but don't know exactly what. Any help would be appreciated.</p>\n\n<p>EDIT: Changed the code a bit.</p>\n"}, {"tags": ["c", "unix", "getopt"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510773950, "post_id": 47315677, "comment_id": 81582224, "body": "So.. what are the some example of how you are running it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1510774158, "post_id": 47315677, "comment_id": 81582330, "body": "Options should start with <code>-</code> or <code>--</code>."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 2016231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x2mFs.jpg?s=128&g=1", "display_name": "Smaointe", "link": "https://stackoverflow.com/users/2016231/smaointe"}, "edited": false, "score": 0, "creation_date": 1510775019, "post_id": 47315796, "comment_id": 81582753, "body": "So, in relation to <code>?</code> and <code>optopt</code>, I should remove <code>case &#39;?&#39;:</code> and I should also change <code>fprintf(stderr, &quot;Error - No such opt, &#39;%c&#39;\\n&quot;, opt); </code> to <code>fprintf(stderr, &quot;Error - No such opt, &#39;%c&#39;\\n&quot;, optopt);</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 111, "user_id": 2016231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x2mFs.jpg?s=128&g=1", "display_name": "Smaointe", "link": "https://stackoverflow.com/users/2016231/smaointe"}, "edited": false, "score": 0, "creation_date": 1510775202, "post_id": 47315796, "comment_id": 81582865, "body": "@Smaointe Yes, remove the existing <code>case &#39;?&#39;:</code>, change the <code>default</code> case to <code>case &#39;?&#39;:</code>, and print <code>optopt</code> in that case."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1510774359, "creation_date": 1510774359, "answer_id": 47315796, "question_id": 47315677, "link": "https://stackoverflow.com/questions/47315677/getopt-always-returning-1-getopt-not-doing-anything/47315796#47315796", "title": "getopt always returning -1 / getopt not doing anything", "body": "<p>You're not actually passing an option here:</p>\n\n<pre><code>$ ./test f\n</code></pre>\n\n<p>Options are expected to start with a <code>-</code> character.  <code>f</code> does not, so it is not considered an option.  If you call it like this:</p>\n\n<pre><code>$ ./test -f\n</code></pre>\n\n<p>You'll get this:</p>\n\n<pre><code>./test: option requires an argument -- 'f'\nUsage Instructions Here ...\n</code></pre>\n\n<p>Also, the <code>?</code> character has special meaning to <code>getopt</code>.  It is returned when an unknown option is found, with a copy of the invalid option stored in <code>optopt</code>.  So you probably don't want to use <code>?</code> in your option string.</p>\n"}], "owner": {"reputation": 111, "user_id": 2016231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x2mFs.jpg?s=128&g=1", "display_name": "Smaointe", "link": "https://stackoverflow.com/users/2016231/smaointe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 47315796, "answer_count": 1, "score": 0, "last_activity_date": 1510774359, "creation_date": 1510773877, "last_edit_date": 1510774160, "question_id": 47315677, "link": "https://stackoverflow.com/questions/47315677/getopt-always-returning-1-getopt-not-doing-anything", "title": "getopt always returning -1 / getopt not doing anything", "body": "<p>I am trying to parse command line arguments using getopt(). Below is my code. getopt() is always returning -1 no matter what arguments I pass when running the program. </p>\n\n<p>For example: </p>\n\n<pre><code>$ gcc -o test test.c\n$ ./test f\n</code></pre>\n\n<p>Can anybody see what I am doing wrong? Thank you.   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;getopt.h&gt;\n\nvoid usage (char * progname)\n{\n    fprintf(stderr, \"Usage Instructions Here ...\\n\");\n    exit(-1);\n}\n\n\nint main (int argc, char *argv[]) \n{\n    int opt;\n\n    while((opt = getopt(argc, argv, \"?hf:\")) != -1) {\n        switch(opt) {\n            case '?':\n            case 'h':\n                usage(argv[0]);\n                break;\n            case 'f':\n                {\n                    FILE *fp;\n                    char *filename = strdup(optarg);\n\n                    if((fp = fopen(filename, \"r\")) == NULL) {\n                        usage(argv[0]);\n                    } \n                }\n                break;\n            default:\n                fprintf(stderr, \"Error - No such opt, '%c'\\n\", opt);\n                usage(argv[0]);\n        }\n    }\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "implementation", "terminate"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510773915, "post_id": 47315585, "comment_id": 81582208, "body": "There is no good reason to use <code>pow</code> for a cube, and it might introduce more inaccuracy than the simple multiplications would."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1510775838, "post_id": 47315585, "comment_id": 81583213, "body": "For which input interval do you observe the described behaviour?"}, {"owner": {"reputation": 21, "user_id": 8827975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb9e1cd586440763bca157c3d5ebeec?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8827975/alex"}, "edited": false, "score": 0, "creation_date": 1510776405, "post_id": 47315585, "comment_id": 81583508, "body": "@M Oehm 3rd time it loops (counter =3 moving to counter  =4)"}, {"owner": {"reputation": 21, "user_id": 8827975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb9e1cd586440763bca157c3d5ebeec?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8827975/alex"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510776555, "post_id": 47315585, "comment_id": 81583581, "body": "@WeatherVane I tried doing it with a simple * it had no observable results as for as I can tell. I kept pow in the code ultimately to keep it cleaner"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1510776634, "post_id": 47315585, "comment_id": 81583612, "body": "No, no, I mean what are your input values <code>a</code> and &#180;b`?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510776973, "post_id": 47315585, "comment_id": 81583775, "body": "Minor: <code>int root1</code> and <code>int root2</code> are being passed as the <code>float</code> argument for <code>bolzano()</code>. You have a function prototype for <code>bolzano</code> so the argument type is converted, but please enable compiler warnings to catch this type of error."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1510777273, "post_id": 47315585, "comment_id": 81583959, "body": "<code>counter</code> should probably be a local variable. You don&#39;t reset it between calls to <code>bolzano</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1510777308, "post_id": 47315585, "comment_id": 81583975, "body": "@MOehm just pipped you!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510883045, "post_id": 47315585, "comment_id": 81636233, "body": "when calling any of the <code>scanf()</code> family of function, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510883210, "post_id": 47315585, "comment_id": 81636264, "body": "the statement: <code>system(&quot;pause&quot;);  is not portable.  Suggest using: </code>int *ch; while( (ch = getchar()) != EOF &amp;&amp; &#39;\\n&#39; != ch );  getchar();`"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1510777269, "creation_date": 1510777269, "answer_id": 47316551, "question_id": 47315585, "link": "https://stackoverflow.com/questions/47315585/unexpected-c-behavior-in-bisection-method-implementation/47316551#47316551", "title": "Unexpected C behavior in bisection method implementation", "body": "<p>You are using the global</p>\n\n<pre><code>int counter = 0;\n</code></pre>\n\n<p>to control the operations in function <code>bolzano</code> which is never reset.</p>\n\n<p>Please add this line at the start of <code>bolzano</code></p>\n\n<pre><code>counter = 0;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8827975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb9e1cd586440763bca157c3d5ebeec?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8827975/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47316551, "answer_count": 1, "score": 0, "last_activity_date": 1510777269, "creation_date": 1510773514, "last_edit_date": 1510773836, "question_id": 47315585, "link": "https://stackoverflow.com/questions/47315585/unexpected-c-behavior-in-bisection-method-implementation", "title": "Unexpected C behavior in bisection method implementation", "body": "<p>I'm trying to implement Bolzano's Bisection method in C, and while the algorithm appears to work, it terminates unexpectedly at around 4 steps\nand the 4th step appears to increase the \"err\" and \"divid\" rather than have it continuously decrease. I'm trying to keep the code as simple as possible so no pointer/references/arrays/arguments in main etc please.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n//#define delta 0.00000000005\n//#define epsilon 0.000000000005\n//#define root1 1\n//#define root2 -1\n//#define maxit 7000\n\nvoid bolzano(double a,double b, float root);\ndouble function(double x);\n\nint counter = 0;\n//double err_global;//eps = 0.5e-6;\ndouble maxit = 300;\ndouble epsilon = 0.5E-6;\ndouble delta = 0.5E-10;\nint root1 = 1;\nint root2 = -1;\n\nint main(void){\n    double a,b;\n    printf(\"Eisagete tis times toy diastimatos [a,b]:  \");\n    scanf(\"%lf%lf\",&amp;a,&amp;b);\n    printf(\"[a,b] = [%lf \\\\,%lf]\\n\",a, b);\n    printf(\"                   ksi = %d\\n\", root1);\n    printf(\"                            n   Xn   En   En+1/En\");\n    bolzano(a,b,root1);\n    system(\"pause\");\n    printf(\"[a,b] = [%lf \\\\, %lf]\\n\",a, b);\n    printf(\"                   ksi = %d\", root2);\n    bolzano(a,b,root2);\n    system(\"pause\");\n    return 0;\n}\n\n\ndouble function(double x){\n    return pow(x-1,3) * (x+1);\n}\n\n\nvoid bolzano(double a, double b, float root){\n    double c,err,divit,err_global;\n    while(b - a &gt; epsilon &amp;&amp; counter &lt; maxit){\n        //system(\"pause\");\n        c = (a + b)/2;\n        err = fabs(c - root);\n        if(counter == 0 ){\n            err_global = err;\n            printf(\"                           %d   %lf   %lf      \\n\", counter, c, err);\n            counter++;\n                if(function(a) * function(c) &lt; 0){\n                    b = c;\n                    continue;\n                }\n                else{\n                    a = c;\n                    continue;\n                }\n        }\n        divit = err/err_global;\n        printf(\"                   \");\n        printf(\"                           %d   %lf   %lf       %lf\\n\",counter, c ,err, divit);\n        err_global = err;\n        if(fabs(function(c)) &lt; delta){\n              break;\n        }\n        else if(function(a) * function(c) &lt; 0){\n            counter++;\n            b = c;\n            //continue;\n        }\n        else{\n            counter++;\n            a = c;\n            //continue;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510772490, "post_id": 47315266, "comment_id": 81581356, "body": "Sweet! \ud83d\udc1eIt&#39;s debugger time!\ud83d\udc1e"}, {"owner": {"reputation": 527, "user_id": 8833934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2039472bf2e02e55b7c1ff8f2ee175?s=128&d=identicon&r=PG&f=1", "display_name": "James K", "link": "https://stackoverflow.com/users/8833934/james-k"}, "edited": false, "score": 1, "creation_date": 1510772583, "post_id": 47315266, "comment_id": 81581420, "body": "This is either far from complete, or has some serious uninitialized variable use issues.  To start off with, you set <code>out</code> equal to <code>buf</code>, but <code>buf</code> has never been set to anything."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1510772673, "post_id": 47315266, "comment_id": 81581469, "body": "It&#39;s likely your trying to access something not properly allocated. In which case you need to provide more of your code."}, {"owner": {"reputation": 2741, "user_id": 2036161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba65c6994b3945d68ea848b7d8a27253?s=128&d=identicon&r=PG", "display_name": "ventsyv", "link": "https://stackoverflow.com/users/2036161/ventsyv"}, "edited": false, "score": 1, "creation_date": 1510772699, "post_id": 47315266, "comment_id": 81581483, "body": "I suspect <code>s[len]</code> is out of bound. C is 0 index language."}, {"owner": {"reputation": 527, "user_id": 8833934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2039472bf2e02e55b7c1ff8f2ee175?s=128&d=identicon&r=PG&f=1", "display_name": "James K", "link": "https://stackoverflow.com/users/8833934/james-k"}, "edited": false, "score": 1, "creation_date": 1510772701, "post_id": 47315266, "comment_id": 81581488, "body": "Debug tips: 1. compile with <code>-g</code> to include debug symbols.  2. run newly compiled version in <code>gdb</code>.  3. upon segfault, it will show you where that happened.  4. run with <code>valgrind --tool=memcheck</code>, which will tell you many things about your memory misuse issues."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1510772896, "post_id": 47315266, "comment_id": 81581611, "body": "@Sharat The usual approach here is to run your code until it explodes, then observe where the problem appears to be. Set a breakpoint a few steps before that and single-step towards where you&#39;re expecting it to blow up, carefully observing variables and return values. When it does blow up you should have a better idea of what the problem is."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 527, "user_id": 8833934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2039472bf2e02e55b7c1ff8f2ee175?s=128&d=identicon&r=PG&f=1", "display_name": "James K", "link": "https://stackoverflow.com/users/8833934/james-k"}, "edited": false, "score": 0, "creation_date": 1510773054, "post_id": 47315266, "comment_id": 81581714, "body": "@JamesK since <code>buf</code> was not defined locally, it is global, therefore it was initialised."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510772945, "post_id": 47315406, "comment_id": 81581648, "body": "That &quot;solves&quot; the issue at the expense of creating a memory leak. Far from ideal."}, {"owner": {"reputation": 1659, "user_id": 6939341, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/THLA7.jpg?s=128&g=1", "display_name": "Parkar", "link": "https://stackoverflow.com/users/6939341/parkar"}, "edited": false, "score": 0, "creation_date": 1510773541, "post_id": 47315406, "comment_id": 81581994, "body": "*** Error in `./huf&#39;: free(): invalid next size (normal): 0x000000000229c030 *** Aborted (core dumped)"}, {"owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "reply_to_user": {"reputation": 1659, "user_id": 6939341, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/THLA7.jpg?s=128&g=1", "display_name": "Parkar", "link": "https://stackoverflow.com/users/6939341/parkar"}, "edited": false, "score": 0, "creation_date": 1510774103, "post_id": 47315406, "comment_id": 81582301, "body": "@Sharat hm, interesting... there is no free() in your code... It could be &quot;hidden&quot; in a call to fclose(), however. There seems to be another heap corruption somewhere, it is really hard to say without actual input and debugger. You could try to start your program with <code>valgrind</code>, which should easily show you invalid memory accesses"}, {"owner": {"reputation": 1659, "user_id": 6939341, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/THLA7.jpg?s=128&g=1", "display_name": "Parkar", "link": "https://stackoverflow.com/users/6939341/parkar"}, "edited": false, "score": 0, "creation_date": 1510775034, "post_id": 47315406, "comment_id": 81582761, "body": "Actual input could be any string. Concept of this program is to read some data from txt file then Encode it using Huffman coding technique. Then Decode the Encoded value to get the original message."}], "tags": [], "owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "is_accepted": false, "score": 3, "last_activity_date": 1510772962, "last_edit_date": 1510772962, "creation_date": 1510772871, "answer_id": 47315406, "question_id": 47315266, "link": "https://stackoverflow.com/questions/47315266/how-to-solve-sigsegv-segmentation-fault-in-c/47315406#47315406", "title": "How to solve SIGSEGV, Segmentation fault in C?", "body": "<p>The debugger message shows, that indeed the call to <code>strcpy()</code> is the culprit:</p>\n\n<blockquote>\n  <p>__strcpy_sse2 () at ../sysdeps/x86_64/multiarch/../strcpy.S:57</p>\n</blockquote>\n\n<p>Judging from the code you share, the buffer <code>buf</code> to which <code>out</code> points does not seem to be large enough to hold a string of length <code>len</code>, which you try to copy into it. Alternatively it could be possible, that <code>buf</code> is not in a writable part of your process memory.</p>\n\n<p>In any case, make sure that <code>out</code> points to a writable buffer, which is large enough, perhaps by allocating some space to it, for example with:</p>\n\n<pre><code>static char *out = NULL;\n\nif (out == NULL)\n    out = malloc(len);\n</code></pre>\n\n<p>This should solve your issue.</p>\n"}], "owner": {"reputation": 1659, "user_id": 6939341, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/THLA7.jpg?s=128&g=1", "display_name": "Parkar", "link": "https://stackoverflow.com/users/6939341/parkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2661, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510773077, "creation_date": 1510772405, "last_edit_date": 1510773077, "question_id": 47315266, "link": "https://stackoverflow.com/questions/47315266/how-to-solve-sigsegv-segmentation-fault-in-c", "title": "How to solve SIGSEGV, Segmentation fault in C?", "body": "<p>I am working on a program to read data from a text file and encode it with a Huffman encoding.  I've run it 2-3 times, and it shows nothing but an error message:</p>\n\n<blockquote>\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n__strcpy_sse2 () at ../sysdeps/x86_64/multiarch/../strcpy.S:57\n57    ../sysdeps/x86_64/multiarch/../strcpy.S: No such file or directory.\n</code></pre>\n</blockquote>\n\n<p>When I debugged the program,  I traced the problem to the following function:</p>\n\n<pre><code>// walk the tree and put 0s and 1s\nvoid build_bcode_from_tree(node n, char *s, int len)\n{\n    static char *out = buf;\n    if (n-&gt;c) {\n        s[len] = 0;\n        strcpy(out, s);\n        code[n-&gt;c] = out;\n        out += len + 1;\n        return;\n    }\n\n    s[len] = '0'; build_bcode_from_tree(n-&gt;left,  s, len + 1);\n    s[len] = '1'; build_bcode_from_tree(n-&gt;right, s, len + 1);\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node_t {\n    struct node_t *left, *right;\n    int freq;\n    char c;\n} *node;\n\nstruct node_t pool[256] = {{0}};\nnode qqq[255], *q = qqq - 1;\nint n_nodes = 0, qend = 1;\nchar *code[128] = {0}, buf[1024];\n\n//creating tree\nnode create_tree(int freq, char c, node a, node b)\n{\n    node n = pool + n_nodes++;\n    if (freq) n-&gt;c = c, n-&gt;freq = freq;\n    else {\n        n-&gt;left = a, n-&gt;right = b;\n        n-&gt;freq = a-&gt;freq + b-&gt;freq;\n    }\n    return n;\n}\n\n// priority queue according to frequency\nvoid qinsert(node n)\n{\n    int j, i = qend++;\n    while ((j = i / 2)) {\n        if (q[j]-&gt;freq &lt;= n-&gt;freq) break;\n        q[i] = q[j], i = j;\n    }\n    q[i] = n;\n}\n\nnode qremove()\n{\n    int i, l;\n    node n = q[i = 1];\n\n    if (qend &lt; 2) return 0;\n    qend--;\n    while ((l = i * 2) &lt; qend) {\n        if (l + 1 &lt; qend &amp;&amp; q[l + 1]-&gt;freq &lt; q[l]-&gt;freq) l++;\n        q[i] = q[l], i = l;\n    }\n    q[i] = q[qend];\n    return n;\n}\n\n// walk the tree and put 0s and 1s\nvoid build_bcode_from_tree(node n, char *s, int len)\n{\n    static char *out = buf;\n    if (n-&gt;c) {\n        s[len] = 0;\n        strcpy(out, s);\n        code[n-&gt;c] = out;\n        out += len + 1;\n        return;\n    }\n\n    s[len] = '0'; build_bcode_from_tree(n-&gt;left,  s, len + 1);\n    s[len] = '1'; build_bcode_from_tree(n-&gt;right, s, len + 1);\n}\n\n// individual binary representation\nvoid ind_repre(const char *s)\n{\n    int i, freq[128] = {0};\n    char c[16];\n\n    while (*s) freq[(int)*s++]++;\n\n    for (i = 0; i &lt; 128; i++)\n        if (freq[i]) qinsert(create_tree(freq[i], i, 0, 0));\n\n    while (qend &gt; 2)\n        qinsert(create_tree(0, 0, qremove(), qremove()));\n\n    build_bcode_from_tree(q[1], c, 0);\n}\n\n// endode the whole file data\nvoid compress(const char *s, char *out)\n{\n    while (*s) {\n        strcpy(out, code[*s]);\n        out += strlen(code[*s++]);\n    }\n}\n\n//showing decode data\nvoid decompress(const char *s, node t)\n{\n    FILE *filew;\n    filew = fopen(\"output.txt\", \"w\");\n    node n = t;\n    while (*s) {\n        if (*s++ == '0') n = n-&gt;left;\n        else n = n-&gt;right;\n        // if (n-&gt;c) putchar(n-&gt;c), n = t;\n        if (n-&gt;c) fprintf(filew,\"%c\", n-&gt;c), n = t;\n    }\n    putchar('\\n');\n    if (t != n) printf(\"wrong input\\n\");\n  fclose(filew);\n\n}\n\n// main function\nint main(void)\n{\n    int i;\n    const char *str;\n  char buff[1024];\n    // read from file\n    char txt[1024];\n    FILE *file;\n    size_t nread;\n\n    file = fopen(\"index.html\", \"r\");\n    if (file == NULL) {\n            printf(\"There is no file with this name!!\\n\");\n            exit(-1);\n    } else {\n\n            while ((nread = fread(txt, 1, sizeof txt, file)) &gt; 0)\n                    fwrite(txt, 1, nread, stdout);\n            if (ferror(file)) {\n\n            }\n            fclose(file);\n    }\n\n str = txt;\n    ind_repre(str);\n    for (i = 0; i &lt; 128; i++)\n        if (code[i]) printf(\"'%c': %s\\n\", i, code[i]);\n\n    compress(str, buff);\n    printf(\"compressedData: %s\\n\", buff);\n\n    decompress(buff, q[1]);\n    printf(\"decoding done ! check output file\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "linux-kernel"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1510772136, "post_id": 47315064, "comment_id": 81581144, "body": "Here&#39;s some general information about the iov_iter interface that might help you: <a href=\"https://lwn.net/Articles/625077/\" rel=\"nofollow noreferrer\">lwn.net/Articles/625077</a>"}], "answers": [{"tags": [], "owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "is_accepted": true, "score": 3, "last_activity_date": 1510943407, "creation_date": 1510943407, "answer_id": 47357072, "question_id": 47315064, "link": "https://stackoverflow.com/questions/47315064/how-do-i-fill-out-the-iov-iter-structure-for-use-with-msghdr/47357072#47357072", "title": "How do I fill out the iov_iter structure for use with msghdr?", "body": "<p>After some playing around and reading the guide posted by Ctx (<a href=\"http://lwn.net/Articles/625077\" rel=\"nofollow noreferrer\">lwn.net/Articles/625077</a>), I figured it out.</p>\n\n<pre><code>unsigned long nr_segments = 1;\nsize_t count = 1;\nstruct msghdr msg = {};\nstruct iovec iov = {}; \n\niov.iov_base = data;\niov.iov_len = dataLen;\n\niov_iter_init(&amp;msg.msg_iter, READ, &amp;iov, nr_segments, count);\n</code></pre>\n"}], "owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 2, "accepted_answer_id": 47357072, "answer_count": 1, "score": 2, "last_activity_date": 1510943407, "creation_date": 1510771742, "question_id": 47315064, "link": "https://stackoverflow.com/questions/47315064/how-do-i-fill-out-the-iov-iter-structure-for-use-with-msghdr", "title": "How do I fill out the iov_iter structure for use with msghdr?", "body": "<p>I am trying to send a UDP packet from a driver using sock_sendmsg().</p>\n\n<p>There are several guides on how to use sock_sendmsg() and msghdr to fill out at a UDP packet and transmit it, but they are all for older kernel versions. Sometime between 3.13 and 4.8, the struct msghdr changed from:</p>\n\n<pre><code>struct msghdr {\n    void    *   msg_name;   /* Socket name          */\n    int     msg_namelen;    /* Length of name       */\n    struct iovec *  msg_iov;    /* Data blocks          */\n    __kernel_size_t msg_iovlen; /* Number of blocks     */\n    void    *   msg_control;    /* Per protocol magic (eg BSD file descriptor passing) */\n    __kernel_size_t msg_controllen; /* Length of cmsg list */\n    unsigned int    msg_flags;\n};\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>struct msghdr {\n    void        *msg_name;  /* ptr to socket address structure */\n    int     msg_namelen;    /* size of socket address structure */\n    struct iov_iter msg_iter;   /* data */\n    void        *msg_control;   /* ancillary data */\n    __kernel_size_t msg_controllen; /* ancillary data buffer length */\n    unsigned int    msg_flags;  /* flags on received message */\n    struct kiocb    *msg_iocb;  /* ptr to iocb for async requests */\n};\n</code></pre>\n\n<p>Instead of setting  msg_iov to point to an iovec with the data:</p>\n\n<pre><code>struct msghdr msg = {};\nstruct iovec iov = {}; \n\niov.iov_base = data;\niov.iov_len = dataLen;\nmsg.msg_iov = &amp;iov;\nmsg.msg_iovlen = 1;\n</code></pre>\n\n<p>There is now an iov_iter structure:</p>\n\n<pre><code>struct iov_iter {\n    int type;\n    size_t iov_offset;\n    size_t count;\n    union {\n        const struct iovec *iov;\n        const struct kvec *kvec;\n        const struct bio_vec *bvec;\n        struct pipe_inode_info *pipe;\n    };\n    union {\n        unsigned long nr_segs;\n        struct {\n            int idx;\n            int start_idx;\n        };\n    };\n};\n</code></pre>\n\n<p>How do I fill out the iov_iter structure inside of msghdr with data so that I can pass it to sock_sendmsg?</p>\n"}, {"tags": ["c", "arrays", "animation"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1510771462, "post_id": 47314959, "comment_id": 81580771, "body": "First of all <code>system(&quot;clear&quot;)</code> is terrible practice. Second, using the terminal for an &quot;<i>animation</i>&quot; is not going to work very good, and if you can do it anyway it appears that you are required to know a lot more than you do."}, {"owner": {"reputation": 23, "user_id": 8947088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dea4c5895522c401fea9b73582b4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Void", "link": "https://stackoverflow.com/users/8947088/void"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1510771619, "post_id": 47314959, "comment_id": 81580861, "body": "I know that it is a terrible practice but I have to do this for university project. Is there any simply way to make an &quot;animation&quot; with parametric equation (like an circle equation above in my code)?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510771846, "post_id": 47314959, "comment_id": 81581000, "body": "Write the data into the buffer and discharge the whole buffer. Instead of testing some weird stuff, use a single loop (rotation) and just write the next dot into the correct place in the buffer, then print the whole buffer. Horrible. But better yet is to explore console <code>gotoxy</code> functions, which are available in libraries."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8947088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dea4c5895522c401fea9b73582b4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Void", "link": "https://stackoverflow.com/users/8947088/void"}, "edited": false, "score": 0, "creation_date": 1510773889, "post_id": 47315278, "comment_id": 81582191, "body": "Thanks for the answer. The circle animation is just a simpler version of animation i have to do this for a university project. I&#39;m just trying to make this simple animation work and then go on with the main project (it will be a point that is slowly drawing a spiral in a terminal and some other parametric equation). How do i store the result of each animation in a buffer?"}, {"owner": {"reputation": 2429, "user_id": 1460929, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/720a677756da76903bec783c6534a0b2?s=128&d=identicon&r=PG", "display_name": "ctietze", "link": "https://stackoverflow.com/users/1460929/ctietze"}, "reply_to_user": {"reputation": 23, "user_id": 8947088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dea4c5895522c401fea9b73582b4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Void", "link": "https://stackoverflow.com/users/8947088/void"}, "edited": false, "score": 0, "creation_date": 1510994695, "post_id": 47315278, "comment_id": 81681169, "body": "Depends on what you are more comfortable with. One option: think of characters on screen as pixels. Then create a 2-dimensional bool array of the appropriate width and height where you flick the entry from <code>false</code> to <code>true</code> if a pixel should be drawn: <code>pixels[x][y] = true</code>. If you do not want this abstraction from characters to booleans, you can represent your circle as an list of lines (themselves <code>char</code> arrays) with space characters and set  <code>text[x][y] = &#39;.&#39;</code>. Then print the whole result."}], "tags": [], "owner": {"reputation": 2429, "user_id": 1460929, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/720a677756da76903bec783c6534a0b2?s=128&d=identicon&r=PG", "display_name": "ctietze", "link": "https://stackoverflow.com/users/1460929/ctietze"}, "is_accepted": false, "score": 0, "last_activity_date": 1510772441, "creation_date": 1510772441, "answer_id": 47315278, "question_id": 47314959, "link": "https://stackoverflow.com/questions/47314959/c-creating-animation-in-terminal-auto-updating-2d-array/47315278#47315278", "title": "C - Creating animation in terminal - auto-updating 2D array", "body": "<p>What is the animation supposed to look like? Do you want the circle to grow slowly? Then you need to add a <em>delay</em> (<code>sleep</code> or similar) or else it will finish the whole process too quickly for the screen to draw and for your eyes to notice. </p>\n\n<p>Also you should not clear the progress after every new dot (of the 360 dots in total, it seems). To achieve that, you will need to change your approach a bit. Here's what the loop could look like:</p>\n\n<ol>\n<li>Draw nothing</li>\n<li>Draw dot 1</li>\n<li>Clear</li>\n<li>Draw dot 1 and 2</li>\n<li>Clear</li>\n<li>Draw dot 1 and 2 and 3</li>\n</ol>\n\n<p>You see that after clearing, you need to repeat printing the progress so far. At loop iteration 180, you need to print the last 179 dots again <em>plus</em> the 180th. Wait a few milliseconds, then clear, then the same for 181.</p>\n\n<p>How you do that? You repeat the <code>for</code> loop:</p>\n\n<pre><code>int dot, maxDots;\nfor (maxDots = 0; maxDots &lt; 360; maxDots++) {\n    for (dot = 0; dot &lt; maxDots; dot++) {\n        // your location calculations and printing for each dot\n    }\n    system(\"clear\");\n }\n</code></pre>\n\n<p>This should at least give you some kind of growing circle. But you will notice that the printing approach is hard to get right, because once a line has been finished, you cannot go back.  If you start at the top and go your way around 180 degrees, down line by line, you will then need to go up line by line until you reach the top again. That won't work easily. Instead of printing directly, as @Weather Vane suggested, store the to-be-printed result of each animation stage in a buffer. That is an abstraction of on-screen coordinates. A very simple approach would be a two-dimensional array that you can manipulate freely, then print the whole array en bloc.</p>\n"}], "owner": {"reputation": 23, "user_id": 8947088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dea4c5895522c401fea9b73582b4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Void", "link": "https://stackoverflow.com/users/8947088/void"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510772441, "creation_date": 1510771337, "question_id": 47314959, "link": "https://stackoverflow.com/questions/47314959/c-creating-animation-in-terminal-auto-updating-2d-array", "title": "C - Creating animation in terminal - auto-updating 2D array", "body": "<p>I'm trying to make an animation which will make a basic circle from dots. I got stuck, because i do not know how to make an array to auto-update herself to make an animation. My program has an issue, because it shows only the last point on circle and other, previous points has vanished due to system(\"clear\") command, but i do not know how to make it the proper way.\nThanks in advance!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(void){\n\nchar tab[43][132];\nint a, b, t;\ndouble x_kropki, y_kropki;\n\nfor (t=0 ; t&lt;360 ; t++) {\n    x_kropki=floor(10*cos((t*pi)/180))+60;\n    y_kropki=floor(10*sin((t*pi)/180))+20;\n    for (a=0 ; a&lt;43 ; a++, printf(\"\\n\")) for (b=0 ; b&lt;132 ; b++) {\n    if ((int)y_kropki==a &amp;&amp; (int)x_kropki==b){\n        tab[a][b]='.';\n        printf(\"%c\", tab[a][b]);\n        }else {\n            tab[a][b]=' ';\n            printf(\"%c\", tab[a][b]);\n        }\n    }\n    system(\"clear\");\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["android", "c", "android-ndk", "libc", "bionic"], "owner": {"reputation": 49, "user_id": 8825881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9769467920ba658d11653424a4902d5?s=128&d=identicon&r=PG&f=1", "display_name": "A. Zhabolenko", "link": "https://stackoverflow.com/users/8825881/a-zhabolenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1609843329, "creation_date": 1510770398, "last_edit_date": 1510775204, "question_id": 47314714, "link": "https://stackoverflow.com/questions/47314714/cross-compiling-of-c-code-for-android", "title": "Cross-compiling of C code for Android", "body": "<p>I cross-compiled my C application for <em>Android ARM</em> with <em>arm-linux-gnueabi</em> tool under <em>Ubuntu 16.04 LTS</em>. I compiled it with static linking flag. This C application is big and it has complicated makefile. It compiled successfully without any errors. But it behaves <strong>differently</strong> on Android phone and Ubuntu PC. More precisely i have two problems:</p>\n\n<ol>\n<li><code>popen()</code> and <code>system()</code> functions don't work on Android. They are carried out but do nothing and don't give any errors. This problem i solved with dirty hack.</li>\n<li><code>fgets()</code> functions works strange on Android.</li>\n</ol>\n\n<p><strong>1. About first problem.</strong></p>\n\n<p>I did small research and found that Android doesn't use ordinary <em>libc</em>  library (<em>glibc</em> or another library which implements POSIX standard properly). It uses <em>Bionic</em> library instead of it (sorry, Android is new OS for me). I looked into <code>popen()</code> and <code>system()</code> functions code and noticed that these functions use <code>_PATH_BSHELL</code> macros. <code>_PATH_BSHELL</code> is path to the actual system shell. This path is \"<strong>/system/bin/sh</strong>\" on Android and \"<strong>/bin/sh</strong>\" on Ubuntu. </p>\n\n<p>When i understood it i tried to hook <code>popen()</code> and <code>system()</code> functions. I copied code of these functions from the <em>Bionic</em> source, than i defined macros <code>#define _MY_PATH_BSHELL \"/system/bin/sh\"</code> and replaced calls like <code>execve(_MY_PATH_BSHELL, argp, environ);</code> by <code>execve(_MY_PATH_BSHELL, argp, environ);</code> calls. So it started work properly. </p>\n\n<p><strong>2. About second problem.</strong></p>\n\n<p>On Ubuntu this code works properly:</p>\n\n<pre><code>is_received = false;\nwhile(!is_received) {\n    FILE *cmd = popen(command, \"r\");\n    is_received = fgets(buf, sizeof(buf), cmd) == NULL ? false : true; \n}\n</code></pre>\n\n<p>But on Android <code>fgets()</code> always returns <code>NULL</code> and this loop works <em>infinitely long</em>. I tried to use <code>read()</code> function instead of <code>fgets()</code> and it worked.\nOn Android this code with <code>read()</code> works properly:</p>\n\n<pre><code>is_received = false;\nwhile(!is_received) {\n    FILE *cmd = hooked_popen(command, \"r\");\n    int fd = fileno(cmd);\n    is_received = read(fd, buf, sizeof(buf)) == 0 ? false : true;\n}\n</code></pre>\n\n<p><strong>My questions.</strong></p>\n\n<ol>\n<li>How to solve my problems with <code>popen()</code> and <code>system()</code> neatly and correctly? I think i have to link statically with <em>Bionic</em> library. Is it right? How can i do it in console without Android Studio? I read that it is necessary to use <em>NDK</em> but it is not clear to me how. </li>\n<li>Why <code>fgets()</code> behavior isn't similar on Android and Ubuntu?</li>\n</ol>\n"}, {"tags": ["c", "aes", "libcrypto", "libressl"], "answers": [{"comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 2, "creation_date": 1510774469, "post_id": 47315647, "comment_id": 81582479, "body": "The OP is asking about AES-256-<b>GCM</b> which includes zero padding, PKCS#7 padding is not used with GCM mode. See <a href=\"https://crypto.stackexchange.com/questions/42412/gcm-padding-or-not\">GCM padding or not?</a> and <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\" rel=\"nofollow noreferrer\">Galois/Counter Mode</a>"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1510795430, "post_id": 47315647, "comment_id": 81591250, "body": "Oh my, it looks like we are stuck with an answer that is wrong. <b>Sad!</b>"}], "tags": [], "owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "is_accepted": false, "score": -1, "last_activity_date": 1510773781, "creation_date": 1510773781, "answer_id": 47315647, "question_id": 47314544, "link": "https://stackoverflow.com/questions/47314544/encryption-with-aes-256-gcm-using-libressl-libcrypto/47315647#47315647", "title": "Encryption with AES-256-GCM using (LibreSSL) libcrypto", "body": "<p>The issue here is, that you do not implement proper padding as PKCS#7 requires. <code>openssl</code> expects correct padding to be present in the decoded message. Rules are:</p>\n\n<ul>\n<li>There has to be <em>always</em> at least 1 byte of padding</li>\n<li>It has to be padded to block size of the cipher</li>\n</ul>\n\n<p>Now with AES-256 you have a block size of 128 bit (16 byte). This means, you have to add 1-16 padding bytes. The padding bytes to add are always the <em>size</em> of the padding, so if you have to add 9 bytes of padding, you would add 9 <code>0x09</code> bytes.</p>\n\n<p>If you properly add this padding to your original plaintext, then openssl should stop complaining on decrypt.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1741222"}, "is_accepted": true, "score": 0, "last_activity_date": 1511313577, "creation_date": 1511313577, "answer_id": 47425364, "question_id": 47314544, "link": "https://stackoverflow.com/questions/47314544/encryption-with-aes-256-gcm-using-libressl-libcrypto/47425364#47425364", "title": "Encryption with AES-256-GCM using (LibreSSL) libcrypto", "body": "<p>I was completely failing to get the GCM authentication tag after encryption and then providing it during decryption.</p>\n\n<p>The \"bad decrypt\" message was misleading \u2014 the decryption was going fine, but the tag providing authentication was not provided.</p>\n\n<p>The tag can be gotten at <strong>after</strong> the call to <code>EVP_EncryptFinal_ex</code> with</p>\n\n<pre><code>unsigned char *tag = malloc(TAGSIZE);\nEVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_GCM_GET_TAG, TAGSIZE, tag);\n</code></pre>\n\n<p><code>TAGSIZE</code> is the size in bytes of the tag, and may be a number of different values. This is discussed on <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode#Security\" rel=\"nofollow noreferrer\">Wikipedia</a> among other places.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1741222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "accepted_answer_id": 47425364, "answer_count": 2, "score": 2, "last_activity_date": 1511313577, "creation_date": 1510769699, "last_edit_date": 1510792374, "question_id": 47314544, "link": "https://stackoverflow.com/questions/47314544/encryption-with-aes-256-gcm-using-libressl-libcrypto", "title": "Encryption with AES-256-GCM using (LibreSSL) libcrypto", "body": "<p>Given an appropriate <code>key</code> and <code>iv</code>, this C program should encrypt <code>stdin</code>, outputting to <code>stdout</code>.</p>\n\n<pre><code>EVP_CIPHER_CTX *ctx = EVP_CIPHER_CTX_new();\nEVP_EncryptInit(ctx, EVP_aes_256_gcm(), key, iv);\n\nconst size_t block_size = 128;\nunsigned char inbuf[block_size];\nunsigned char outbuf[block_size + EVP_MAX_BLOCK_LENGTH];\nint inlen, outlen;\nfor (;;)\n{\n        inlen = fread(inbuf, 1, block_size, stdin);\n        if (inlen &lt;= 0)\n                break;\n\n        EVP_EncryptUpdate(ctx, outbuf, &amp;outlen, inbuf, inlen)\n        fwrite(outbuf, 1, outlen, stdout);\n}\nEVP_EncryptFinal_ex(ctx, outbuf, &amp;outlen)\nfwrite(outbuf, 1, outlen, stdout);\n</code></pre>\n\n<p>(Error checking removed for brevity.)</p>\n\n<p>I am verifying the output of this code by running</p>\n\n<p><code>openssl aes-256-gcm -in ciphertext.txt -K &lt;key&gt; -iv &lt;iv&gt; -d</code></p>\n\n<p>This successfully and reliably decrypts the ciphertext, but writes <strong>bad decrypt</strong> afterwards, for instance</p>\n\n<pre><code>$ openssl aes-256-gcm ...\nHello World.\nbad decrypt\n</code></pre>\n\n<p>What could be going wrong to cause it to say this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1510769381, "post_id": 47314442, "comment_id": 81579582, "body": "Undefined behavior for writing beyond the bounds of an object."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1510769593, "post_id": 47314442, "comment_id": 81579705, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/47314442/edit\">edit your question</a> to include more information."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1510769632, "post_id": 47314442, "comment_id": 81579728, "body": "Welcome to Stack Overflow! Questions about a problem that can no longer be reproduced or that was caused by a simple typographical error are usually off-topic. While similar questions may be on-topic here, this one was resolved in a manner unlikely to help future readers. This can often be avoided by identifying and closely inspecting the shortest program necessary to reproduce the problem before posting."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510769671, "post_id": 47314442, "comment_id": 81579754, "body": "In this case this is a typo of indexing from 1 to 10 instead of 0 to 9, and missing the braces for the block inside <code>else</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1510769694, "post_id": 47314442, "comment_id": 81579763, "body": "Arrays are zero-indexed, which means the first element of <code>A</code> is <code>A[0]</code>, not <code>A[1]</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510772578, "post_id": 47314442, "comment_id": 81581416, "body": "A major requirement to writing software is to have a clearly understood set of requirements.  It is a total waste of time to write code without first having that clear understanding.  Suggest determining what the actual requirements are, then edit the question to clearly state those requirements."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510772732, "post_id": 47314442, "comment_id": 81581507, "body": "regarding: <code>printf(&quot;Enter a number between 0 and 10\\n&quot;);</code>  is misleading as it excludes 0 and 10.  Suggest: <code>printf(&quot;Enter a number in the range 0...10\\n&quot;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "is_accepted": false, "score": 0, "last_activity_date": 1510769460, "creation_date": 1510769460, "answer_id": 47314477, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314477#47314477", "title": "Getting asked twice to insert integer", "body": "<p>arrays start at index 0 in C so your for loop should go be <code>for(i=0;i&lt;10;i++)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8946854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1709477729110778/picture?type=large", "display_name": "\u0393\u03b9\u03ac\u03bd\u03bd\u03b7\u03c2 \u03a0\u03af\u03c4\u03c3\u03bf\u03c2", "link": "https://stackoverflow.com/users/8946854/%ce%93%ce%b9%ce%ac%ce%bd%ce%bd%ce%b7%cf%82-%ce%a0%ce%af%cf%84%cf%83%ce%bf%cf%82"}, "edited": false, "score": 0, "creation_date": 1510769854, "post_id": 47314483, "comment_id": 81579861, "body": "Wow, that was simple enough! Many thanks!"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1510769934, "last_edit_date": 1510769934, "creation_date": 1510769473, "answer_id": 47314483, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314483#47314483", "title": "Getting asked twice to insert integer", "body": "<h3>Why 2 inputs?</h3>\n\n<p>What you wrote </p>\n\n<pre><code>     else\n     printf(\"Enter a number between 0 and 10\\n\");\n     scanf(\"%d\", &amp;j);\n</code></pre>\n\n<p>which is same as</p>\n\n<pre><code>     else {\n     printf(\"Enter a number between 0 and 10\\n\");\n     }\n     scanf(\"%d\", &amp;j);\n</code></pre>\n\n<p>What you want is:-</p>\n\n<pre><code>    else {\n     printf(\"Enter a number between 0 and 10\\n\");\n     scanf(\"%d\", &amp;j);\n    }\n</code></pre>\n\n<p>This is what is told very early stage. It is clear this is why you need to enter 2 numbers even when you are giving correct input.</p>\n\n<hr>\n\n<h3>Undefined behavior:-</h3>\n\n<p>Also you have 10 location in <code>A</code> why write at <code>A[10]</code>. C arrays are 0-indexed. You are dealing with undefined behavior.</p>\n\n<pre><code>for ( i = 0; i&lt;10; i++)\n</code></pre>\n\n<h3>Error in logic?</h3>\n\n<p>What happens when a user gives two times a wrong input? You need to use a <code>while</code> loop. ( You can't expect all user to be right the second time).</p>\n\n<h3>Scanf returns something ...</h3>\n\n<p>Check the return type of <code>scanf</code> to check if the <code>scanf</code> call is doing what you expect it to do.</p>\n\n<hr>\n\n<p>Other bits that I will tell you will be use <code>size_t</code> in the looping variable.</p>\n"}, {"tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 1, "last_activity_date": 1510769583, "creation_date": 1510769583, "answer_id": 47314507, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314507#47314507", "title": "Getting asked twice to insert integer", "body": "<p>In this particular case, adding braces:</p>\n\n<p><code>\n   //     V-- brace\n     else {\n           printf(\"Enter a number between 0 and 10\\n\");\n         scanf(\"%d\", &amp;j);\n     }\n   //^-- brace\n</code></p>\n\n<p>shoud solve the problem you described in your message.  Without the braces, only the first thing after the <code>else</code> is part of the conditional.  Therefore, <code>scanf</code> was always being executed, whether or not the number was between 0 and 10.</p>\n\n<p>I also agree with the other answers --- zero-indexing and for-loop bounds are important.  <strong>Edit</strong>  Specifically, in C arrays the first element is 0.  Thus you are better off to number your tests 0..9 instead of 1..10.  You should also name your variables what they are, thus: </p>\n\n<pre><code>int which_test;\nfor (which_test = 0; which_test &lt; 10; ++which_test) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510773196, "post_id": 47314512, "comment_id": 81581817, "body": "the statement: <i>In your code size of array A is 10 bytes.</i>  is only true if a <code>int</code> is one byte.   On modern CPUs, each <code>int</code> is 4 or 8 bytes (32bit or 64bit architecture)  So the array <code>A</code> has 10 entries and each entry is (4 or 8) bytes. So the actual number of bytes in the array is 40 or 80, not 10"}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1510809410, "last_edit_date": 1510809410, "creation_date": 1510769603, "answer_id": 47314512, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314512#47314512", "title": "Getting asked twice to insert integer", "body": "<p><code>A[i] = j;</code> invoked undefined behaviour because C does not check array bound.</p>\n\n<p><strong>C11 J.2 Undefined behavior</strong></p>\n\n<blockquote>\n  <ul>\n  <li>Addition or subtraction of a pointer into, or just beyond, an array object and an integer type produces a result that points just beyond\n  the array object and is used as the operand of a unary <code>*</code> operator that\n  is evaluated (6.5.6).</li>\n  </ul>\n</blockquote>\n\n<p>In your code size of array <code>A</code> is <code>10*sizeof(int)</code> bytes. So, you can store array elements 0 to 9.</p>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510772869, "post_id": 47314554, "comment_id": 81581592, "body": "this statement: <code>while(A[i]&lt;0 || A[i]&gt;10);</code>  says to exit the loop if the number entered by the user is in the range 0...10.  That is not what the OPs question asks for."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510773110, "post_id": 47314554, "comment_id": 81581750, "body": "@user3629249 This condition says to keep taking input for a particular grade value if user has entered value <i>less than 0</i> or <i>greater than 10</i>  as OP wants to have <i>grade of each being between 0 and 10</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510781615, "post_id": 47314554, "comment_id": 81586306, "body": "your right, I misunderstood what the OP was trying to do at this particular code block."}], "tags": [], "owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "is_accepted": false, "score": 0, "last_activity_date": 1510769882, "last_edit_date": 1510769882, "creation_date": 1510769745, "answer_id": 47314554, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314554#47314554", "title": "Getting asked twice to insert integer", "body": "<p>Maybe this is what you are looking for. You should try this using do-while loop.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int A[10]; \n    int i, j;\n    for ( i = 0; i&lt;10; i++)\n    {\n        do{\n            printf(\"Enter %d grade \\n\", i+1);\n            scanf(\"%d\", &amp;A[i]);\n        }while(A[i]&lt;0 || A[i]&gt;10);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1510769834, "creation_date": 1510769834, "answer_id": 47314575, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer/47314575#47314575", "title": "Getting asked twice to insert integer", "body": "<p>Look closely here:</p>\n\n<pre><code>    if (j&lt;=10 &amp;&amp; j&gt;=0)\n     A[i] = j;\n    else\n     printf(\"Enter a number between 0 and 10\\n\");\n     scanf(\"%d\", &amp;j);\n</code></pre>\n\n<p>There are no braces around the <code>else</code> clause, so only the first statement after the  <code>else</code> applies to it.  The above is the same as:</p>\n\n<pre><code>    if (j&lt;=10 &amp;&amp; j&gt;=0) {\n     A[i] = j;\n    } else {\n     printf(\"Enter a number between 0 and 10\\n\");\n    }\n    scanf(\"%d\", &amp;j);\n</code></pre>\n\n<p>So the second <code>scanf</code> is being executed every time.</p>\n\n<p>Always put braces around <code>if</code>/<code>else</code>, <code>for</code>, and <code>while</code> blocks:</p>\n\n<pre><code>    if (j&lt;=10 &amp;&amp; j&gt;=0) {\n       A[i] = j;\n    } else {\n       printf(\"Enter a number between 0 and 10\\n\");\n       scanf(\"%d\", &amp;j);\n    }\n</code></pre>\n\n<p>Also, your array <code>int A[10];</code> has a total of 10 elements with indexes ranging from 0 to 9.  Your <code>for</code> loop uses indexes from 1 to 10, so you end up writing past the end of the array.  Fix this to use the proper indexes:</p>\n\n<pre><code>for ( i = 0; i&lt;10; i++)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8946854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1709477729110778/picture?type=large", "display_name": "\u0393\u03b9\u03ac\u03bd\u03bd\u03b7\u03c2 \u03a0\u03af\u03c4\u03c3\u03bf\u03c2", "link": "https://stackoverflow.com/users/8946854/%ce%93%ce%b9%ce%ac%ce%bd%ce%bd%ce%b7%cf%82-%ce%a0%ce%af%cf%84%cf%83%ce%bf%cf%82"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1510850358, "answer_count": 6, "score": -3, "last_activity_date": 1510809410, "creation_date": 1510769313, "last_edit_date": 1510769429, "question_id": 47314442, "link": "https://stackoverflow.com/questions/47314442/getting-asked-twice-to-insert-integer", "closed_reason": "Not suitable for this site", "title": "Getting asked twice to insert integer", "body": "<p>I have some homework to do for the University, and since I'm a beginner I don't know how to code yet. So, there are 10 tests with the grade of each being between 0 and 10. I have to make sure that I don't get any negative number or a number greater than 10. while running the code I have to put 2 numbers in order to proceed to the next one, when, I clearly want just the one saved to A[i]. I hope you understand even though I can't even explain the problem. :)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int A[10]; \n    int i, j;\n    for ( i = 1; i&lt;11; i++)\n    {\n        printf(\"Enter %d grade \\n\", i);\n        scanf(\"%d\", &amp;j);\n        if (j&lt;=10 &amp;&amp; j&gt;=0)\n         A[i] = j;\n        else\n         printf(\"Enter a number between 0 and 10\\n\");\n         scanf(\"%d\", &amp;j);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510769429, "post_id": 47314417, "comment_id": 81579608, "body": "I tried this function but didn&#39;t quite get it how to use it properly. Could You please give me the example of usage?"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510769541, "post_id": 47314417, "comment_id": 81579682, "body": "<a href=\"http://c-for-dummies.com/blog/?p=1112\" rel=\"nofollow noreferrer\">c-for-dummies.com/blog/?p=1112</a> instead of stdin you would put your filestream"}, {"owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510769633, "post_id": 47314417, "comment_id": 81579729, "body": "I mean I see the example in the link you shown below, but how do I declare the array then? Can I somehow cast the ssize_t to use it for creating the array?"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510769710, "post_id": 47314417, "comment_id": 81579769, "body": "By char array do you mean a string, or do you you want to store an array of strings?"}, {"owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510769962, "post_id": 47314417, "comment_id": 81579943, "body": "I mean a string containing the whole line."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510770002, "post_id": 47314417, "comment_id": 81579965, "body": "the string containing the whole line gets stored in lineptr"}, {"owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "edited": false, "score": 0, "creation_date": 1510770086, "post_id": 47314417, "comment_id": 81580011, "body": "Ah, ofc. Sry, I&#39;m a total beginner in that. Also, my English is not so good so I don&#39;t understand everything. Thanks for the help!"}], "tags": [], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "is_accepted": true, "score": 1, "last_activity_date": 1510769232, "creation_date": 1510769232, "answer_id": 47314417, "question_id": 47314338, "link": "https://stackoverflow.com/questions/47314338/getting-lines-one-by-one-to-the-dynamically-allocated-char-array/47314417#47314417", "title": "Getting lines one by one to the dynamically allocated char array", "body": "<p>from\n<a href=\"https://linux.die.net/man/3/getline\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/getline</a></p>\n\n<pre><code>ssize_t getline(char **lineptr, size_t *n, FILE *stream);\n</code></pre>\n\n<p>getline automatically allocates lineptr if it is NULL or not large enough to contain the string</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1510773709, "creation_date": 1510773709, "answer_id": 47315631, "question_id": 47314338, "link": "https://stackoverflow.com/questions/47314338/getting-lines-one-by-one-to-the-dynamically-allocated-char-array/47315631#47315631", "title": "Getting lines one by one to the dynamically allocated char array", "body": "<p>Your question:</p>\n\n<p><em>Is this possible to get lines from file one by one and save them to the char array which size is determined by the number of characters in each line?</em></p>\n\n<p>The answer:</p>\n\n<p><code>Yes</code></p>\n\n<p>To actually accomplish this, suggest looking at the functions: <code>fgets()</code>  and <code>getline()</code>.  Both are found in the header file: <code>stdio.h</code>.   Read their associated MAN pages for details.</p>\n"}], "owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "closed_date": 1510779724, "accepted_answer_id": 47314417, "answer_count": 2, "score": -3, "last_activity_date": 1510773709, "creation_date": 1510768930, "question_id": 47314338, "link": "https://stackoverflow.com/questions/47314338/getting-lines-one-by-one-to-the-dynamically-allocated-char-array", "closed_reason": "Needs details or clarity", "title": "Getting lines one by one to the dynamically allocated char array", "body": "<p>Is this possible to get lines from file one by one and save them to the char array which size is determined by the number of characters in each line?</p>\n"}, {"tags": ["c", "serial-port", "glib"], "comments": [{"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1510768915, "post_id": 47313957, "comment_id": 81579352, "body": "From what I understand you should be returning false on an error to close the channel."}, {"owner": {"reputation": 554, "user_id": 7784533, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fc139ffba834d42fa5d9118dad85502d?s=128&d=identicon&r=PG&f=1", "display_name": "romaric crailox", "link": "https://stackoverflow.com/users/7784533/romaric-crailox"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1510821069, "post_id": 47313957, "comment_id": 81600261, "body": "I try and with this solution callback will never be called, even if a new caracter is comming. For me, returning FALSE is usefull if the event source should be removed"}], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "is_accepted": false, "score": 1, "last_activity_date": 1510823548, "creation_date": 1510823548, "answer_id": 47325606, "question_id": 47313957, "link": "https://stackoverflow.com/questions/47313957/notification-on-data-waiting-to-be-read-on-serial-link/47325606#47325606", "title": "notification on data waiting to be read on serial link", "body": "<p>Try adding <code>g_io_channel_unref(channel)</code> immediatley after g_io_add_watch. Then in your callback add</p>\n\n<pre><code>if(G_IO_STATUS_EOF == status)\n return FALSE;\n</code></pre>\n\n<blockquote>\n  <p>g_io_channel_*_new() returns a GIOChannel\n  object with a reference count of one.  g_io_add_watch() adds a further\n  reference count - if you decrement it by 1, the callback will be\n  disconnected and the relevant GSource object removed when the callback\n  returns FALSE, which it should do when it detects end-of-file, or if\n  you call g_source_remove() on the return value of g_io_add_watch()</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 838, "user_id": 3572445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa0c79a45ded7868ccd0c22cdd27be1?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/3572445/ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510901569, "creation_date": 1510901569, "answer_id": 47344886, "question_id": 47313957, "link": "https://stackoverflow.com/questions/47313957/notification-on-data-waiting-to-be-read-on-serial-link/47344886#47344886", "title": "notification on data waiting to be read on serial link", "body": "<p>On Linux, GLib g_io_add_watch method adds your file descriptor to poll(). poll on /dev files is not same as sockets descriptors or normal files. Check struct fops structure in your driver to know whether poll operation is supported by your driver or not. Usually they do support unless you are using some custom driver. Also cross check your code with any other /dev file.</p>\n\n<p>Check whether the status returned from g_io_channel_read_line in the callback is G_IO_STATUS_AGAIN which mean resource is temporarily unavailable; so, a event happened on your file descriptor but there is no immediate data available to read from the driver buffers.</p>\n"}], "owner": {"reputation": 554, "user_id": 7784533, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fc139ffba834d42fa5d9118dad85502d?s=128&d=identicon&r=PG&f=1", "display_name": "romaric crailox", "link": "https://stackoverflow.com/users/7784533/romaric-crailox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 47344886, "answer_count": 2, "score": 1, "last_activity_date": 1510901569, "creation_date": 1510767566, "question_id": 47313957, "link": "https://stackoverflow.com/questions/47313957/notification-on-data-waiting-to-be-read-on-serial-link", "title": "notification on data waiting to be read on serial link", "body": "<p>I try to add to my g_main_loop a new source that is a file descriptor on a serial line peripheric.</p>\n\n<p>I try this code :</p>\n\n<pre><code>GError* error;\nGIOChannel* channel;\nchannel=g_io_channel_unix_new(fd_serial_line_dev);\ng_io_add_watch(channel, G_IO_IN, cb_1, NULL);\ng_io_channel_set_close_on_unref(channel, TRUE);\ng_io_channel_set_encoding(channel, NULL, &amp;error);\ng_io_channel_set_buffered(channel, FALSE);\n</code></pre>\n\n<p>The callback is :</p>\n\n<pre><code>gboolean cb_1 (GIOChannel *source, GIOCondition condition, gpointer data)\n{\n  gchar** line=NULL;\n  GIOStatus status;\n  GError* error;\n\n  printf(\"cb\\n\");\n\n  status=g_io_channel_read_line(source, line, NULL, NULL, &amp;error);\n\n  if(G_IO_STATUS_NORMAL == status)\n  {\n    printf(\"callback : data : %s\\n\", *line);\n    g_free(*line);\n    //g_io_channel_seek_position(source, 0, G_SEEK_CUR, NULL);\n  }\n\n  return TRUE;\n}\n</code></pre>\n\n<p>When I send data on the serial line, I obtain an infinite loop that call cb_1 each time.</p>\n\n<p>I don't see where is my mistake, I expected that a read within file descriptor of the serial line will be suffisant to stop call to the callback during the next g main loop iteration... </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1510767331, "post_id": 47313858, "comment_id": 81578486, "body": "Something odd like that can be a tell of <i>undefined behaviour</i> somewhere."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510767724, "post_id": 47313858, "comment_id": 81578705, "body": "Aside: what is the variable <code>l</code> (ell)? It is a very poor choice of name anyway, since if you have say <code>int hell = l;</code> you have to look carefully to see that is not a <code>1</code> (one)."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1510769026, "post_id": 47313858, "comment_id": 81579411, "body": "Not that it should be a problem since you&#39;re looking at &quot;.&quot;, but if <code>dir</code> is <code>NULL</code> you shouldn&#39;t just print something out - you should return from the function as well"}, {"owner": {"reputation": 25, "user_id": 7595241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a619cf7ef308f7d3b9c4d38774c26f?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe Ear", "link": "https://stackoverflow.com/users/7595241/philippe-ear"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1510770732, "post_id": 47313858, "comment_id": 81580364, "body": "@WeatherVane The l was to know if the option -l has been entered. (The program is to reproduce ls with some options). It&#39;s indeed something to avoid but since it&#39;s only for a short program and homework, I didn&#39;t really thought about it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1510771031, "post_id": 47313858, "comment_id": 81580529, "body": "My point is proven in your comment where <b>l</b> (lower ell) and <b>I</b> (upper me) are indistinguishable. I suggest <code>int option_l;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1510767614, "post_id": 47313921, "comment_id": 81578645, "body": "@DanKorn Yes, I was in the process of editing to make this suggestion. Thanks!"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1510767589, "last_edit_date": 1510767589, "creation_date": 1510767443, "answer_id": 47313921, "question_id": 47313858, "link": "https://stackoverflow.com/questions/47313858/core-dumped-when-using-closedir-if-pathname-is-not-printed-after-opendir/47313921#47313921", "title": "Core dumped when using closedir if pathname is not printed after opendir", "body": "<p>You are not allocating <code>filestat</code> correctly: this line</p>\n\n<pre><code>struct stat * filestat = malloc(sizeof(struct stat *))\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>struct stat * filestat = malloc(sizeof(struct stat))\n</code></pre>\n\n<p>with no asterisk. Currently, the call to <code>stat</code> writes past the allocated memory block, causing undefined behavior.</p>\n\n<p>Note that you don't need to allocate <code>filestat</code> dynamically: make it a local variable, and pass <code>&amp;filestat</code> to <code>stat</code> call:</p>\n\n<pre><code>struct stat filestat;\n...\nif(stat(filename, &amp;filestat) != 0) {\n    ...\n}\n...\nprintf(\"%ld %-s \", filestat.st_ino, filename);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7595241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a619cf7ef308f7d3b9c4d38774c26f?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe Ear", "link": "https://stackoverflow.com/users/7595241/philippe-ear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 47313921, "answer_count": 1, "score": 1, "last_activity_date": 1510767589, "creation_date": 1510767223, "question_id": 47313858, "link": "https://stackoverflow.com/questions/47313858/core-dumped-when-using-closedir-if-pathname-is-not-printed-after-opendir", "title": "Core dumped when using closedir if pathname is not printed after opendir", "body": "<p>I have to code a ls like in C but I have some problems.\nAfter opening a directory using opendir, if I'm not printing the pathname using printf or puts, I'll get a core dumped error when executing at closedir but if I do print the path, the code works fine.</p>\n\n<pre><code>const char * cwd=\".\";\nDIR * dir=opendir(cwd);\n//that print --&gt; printf(\"%s\",cwd);\nif(dir==NULL){\n    puts(\"ohlala\");\n}\nchar * filename;\nstruct dirent * truc;\nstruct stat * filestat=malloc(sizeof(struct stat *));\nwhile((truc=readdir(dir))!=NULL){\n    filename=truc-&gt;d_name;\n    if(strcmp(filename,\"..\")!=0 &amp;&amp; strcmp(filename,\".\")!=0){\n        if(l==0){\n            printf(\"%-s \",filename);\n        }else if(l==1){\n            if(stat(filename,filestat)!=0){\n                printf(\"Erreur stat de %s\\n\",filename);\n                exit(1);\n            }\n            printf(\"%ld %-s \",filestat-&gt;st_ino,filename);\n\n        }\n    }\n}\n//gdb is telling me the probleme is here\nclosedir(dir);\nreturn 0;\n</code></pre>\n\n<p>Any ideas ? Thanks.</p>\n"}, {"tags": ["c", "struct", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1510765922, "post_id": 47313404, "comment_id": 81577664, "body": "this code can&#39;t cause anything because it doesn&#39;t have <code>main</code>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1510766033, "post_id": 47313404, "comment_id": 81577730, "body": "you don&#39;t need to/shouldn&#39;t define your own <code>NULL</code>. What&#39;s <code>hash</code>? I assume <code>numb</code> in the <code>addNumber</code> function is supposed to be <code>number</code>? But to answer your question, invoking undefined behavior is what causes segmentation fault sometimes."}, {"owner": {"reputation": 4676, "user_id": 2052730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atz9A.jpg?s=128&g=1", "display_name": "Sasha Pachev", "link": "https://stackoverflow.com/users/2052730/sasha-pachev"}, "edited": false, "score": 1, "creation_date": 1510766079, "post_id": 47313404, "comment_id": 81577756, "body": "Make sure to post the code that compiles and actually segfaults in its entirety, not some edited version. The code you posted will not compile, as hash variable is not defined. You should also check the return value of malloc() for error."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1510766084, "post_id": 47313404, "comment_id": 81577766, "body": "Where do you init the member <code>next</code> before you do  <code>ptr=ptr-&gt;next;</code>? I can&#39;t see it anywhere near malloc."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1510766270, "post_id": 47313404, "comment_id": 81577865, "body": "Code shown also doesn&#39;t declare &quot;hash&quot; anywhere. Clearly you&#39;re not posting the code you&#39;re using."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1510766296, "post_id": 47313404, "comment_id": 81577877, "body": "Please show a  <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b> and the input if any."}, {"owner": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "edited": false, "score": 0, "creation_date": 1510767117, "post_id": 47313404, "comment_id": 81578354, "body": "My bad, i added the main.c. Right in the editor on stackoverflow, i edited the code variables just to make sure that its clear what i mean, but however ive missed one of them."}, {"owner": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1510767179, "post_id": 47313404, "comment_id": 81578391, "body": "@Yunnosch Thats the mistakte that causes the error, it looks like. I thought its initialised with 0, but it isnt."}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "edited": false, "score": 0, "creation_date": 1510767232, "post_id": 47313622, "comment_id": 81578421, "body": "Thanks, this is the solution for me. However i thought its automaticly initialised with 0, but that clearly wasnt the case. Thank you."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "edited": false, "score": 2, "creation_date": 1510767513, "post_id": 47313622, "comment_id": 81578587, "body": "@Tjatte no, <code>malloc</code> doesn&#39;t initialize memory to 0. In order to do that you can <code>malloc</code> followed by a <a href=\"https://linux.die.net/man/3/memset\" rel=\"nofollow noreferrer\"><code>memset</code></a> or you can use <a href=\"https://linux.die.net/man/3/calloc\" rel=\"nofollow noreferrer\"><code>calloc</code></a>"}, {"owner": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "edited": false, "score": 0, "creation_date": 1510767696, "post_id": 47313622, "comment_id": 81578687, "body": "Thanks for the explanation, i will keep that in mind."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 5, "last_activity_date": 1510774738, "last_edit_date": 1510774738, "creation_date": 1510766441, "answer_id": 47313622, "question_id": 47313404, "link": "https://stackoverflow.com/questions/47313404/segmentation-fault-using-malloc-struct/47313622#47313622", "title": "Segmentation fault using malloc/struct", "body": "<p>Just after malloc you do init one member.  </p>\n\n<pre><code>node-&gt;number = number;\n</code></pre>\n\n<p>But you do not init the other member, there is no </p>\n\n<pre><code>node-&gt;next = NULL;\n</code></pre>\n\n<p>Also, in your loop condition inside <code>print()</code>, you check ptr against NULL, but that is in most of the looping the non-initialised ptr->next from previous loop.</p>\n\n<pre><code>ptr = ptr-&gt;next;\n</code></pre>\n\n<p>I.e. you rely on it to be initialised to NULL.<br>\nThat is probably causing the segfault.</p>\n\n<p>Useful background, as pointed out by yano (thanks):<br>\nMalloc doesn't initialize memory to 0. In order to do that you can malloc followed by a memset or you can use calloc.</p>\n"}], "owner": {"reputation": 211, "user_id": 6291931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aca7ecf839e315922ded2236a7b7003?s=128&d=identicon&r=PG&f=1", "display_name": "Tjatte", "link": "https://stackoverflow.com/users/6291931/tjatte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "accepted_answer_id": 47313622, "answer_count": 1, "score": 0, "last_activity_date": 1510774738, "creation_date": 1510765789, "last_edit_date": 1510767622, "question_id": 47313404, "link": "https://stackoverflow.com/questions/47313404/segmentation-fault-using-malloc-struct", "title": "Segmentation fault using malloc/struct", "body": "<p>I am trying to code an easy list in C, which is able to store numbers.<br>\nWith number <code>SIZE</code>, an index will be calculated and the numbers have to be stored in a kind of linear list at the array index.<br>\nHowever, sometimes I get a \"segmentation fault\", like 2 of 10 tries the output is correct.<br>\nI've gone a long search, but I couldn't find the problem.<br>\nPlease keep in mind that my \"solution\" isn't implemented fully, so currently it's only working when the calculated index has no pointer thats stored. (Couldn't continue to code because of the error.)</p>\n\n<p>Here is my code: </p>\n\n<pre><code>#define SIZE 3\n#define NULL 0\n\ntypedef struct node_s node_t;\n\nstruct node_s {\n  node_t* next;\n  int number;\n};\n\nstatic node_t nodeArray[SIZE];\n\nint addNumber(int numb){\n  int index = number % SIZE;\n  if(nodeArray[index].next == NULL){\n    node_t* node = (node_t*) malloc(sizeof(node_t));\n    node-&gt;number = number;\n    nodeArray[hash].next = node;\n  }\n}\n\nvoid print(){\n  for(int i = 0; i &lt; SIZE; i++){\n    node_t* ptr = nodeArray[i].next;\n    while(ptr != NULL){\n      printf(\"%d -&gt; \", ptr-&gt;number);\n      ptr = ptr-&gt;next;\n    }\n    printf(\"\\n\");\n  }\n}\n\n#include \"dictionary.h\"\n#include &lt;stdio.h&gt;\n\nint main(){\n  insert(1);\n  insert(2);\n  print();\n  return 0;\n}\n</code></pre>\n\n<p>What causes the \"segmentation fault\" sometimes?\nI appreciate any kind of help, thanks in advance!</p>\n"}, {"tags": ["c", "linux", "sockets", "timestamp", "udp"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1510771389, "post_id": 47313383, "comment_id": 81580741, "body": "In your &quot;Update 2&quot;, you need to at least fill in <code>ifr.ifr_name</code> with the actual device name (e.g. &quot;eth0&quot;).  You should probably also check what kinds of timestamping your network card/driver supports, run the command <code>ethtool -T   eth0</code>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1510773233, "post_id": 47313383, "comment_id": 81581838, "body": "Sorry, but your question can&#39;t be answer in this sate you have not give, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, we can&#39;t verify that your code is not wrong (that include error handling), so I vote to close your question for the lack of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1510773642, "post_id": 47313383, "comment_id": 81582057, "body": "as a guess I will try to add <code>SOF_TIMESTAMPING_SOFTWARE</code> and <code>SOF_TIMESTAMPING_RAW_HARDWARE</code> to the bit field <code>timestampOn = SOF_TIMESTAMPING_TX_SOFTWARE | SOF_TIMESTAMPING_TX_HARDWARE;</code> and <code>timestampOn = SOF_TIMESTAMPING_RX_SOFTWARE | SOF_TIMESTAMPING_RX_HARDWARE;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510774843, "post_id": 47313383, "comment_id": 81582667, "body": "the posted code snippets do not compile, so we cannot reproduce the problem.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for the UDP sender and a second one for the UDP receiver.  Otherwise, we are unlikely to be able to help you."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1510778614, "post_id": 47313383, "comment_id": 81584688, "body": "Here is the compilable version:  <a href=\"https://pastebin.com/qd0gspRc\" rel=\"nofollow noreferrer\">pastebin.com/qd0gspRc</a>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1510782063, "post_id": 47313383, "comment_id": 81586535, "body": "&quot;I&#39;ll go back to the docs and figure out how to interpret this.&quot;, I thing that you should read &quot;2.1 SCM_TIMESTAMPING records&quot; of <a href=\"https://www.kernel.org/doc/Documentation/networking/timestamping.txt\" rel=\"nofollow noreferrer\">kernel.org/doc/Documentation/networking/timestamping.txt</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1510955597, "post_id": 47329376, "comment_id": 81672480, "body": "Thank you for taking the time to produce this working example.  Some things are definitely improved!  I am still having a few problems with it, though.  Your sending function omits the code necessary to get the TX timestamp, so I added it back in.  Unfortunately, I get nothing at all back from recvmsg on MSG_ERRQUEUE, not even the original datagram that was sent.  I&#39;ve tried changing the options for SO_TIMESTAMPING, but nothing.  I used to get <i>something</i> back from MSG_ERRQUEUE, so I don&#39;t know what&#39;s changed.  Any ideas?"}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1511208677, "post_id": 47329376, "comment_id": 81753939, "body": "Thanks again for your help with this.  I copied and pasted your exact code, but I&#39;m still getting some odd behaviors.  If I send to &quot;127.0.0.1&quot;, then the recvmsg from MSG_ERRQUEUE always comes back with EAGAIN.  If I provide the address of another machine, the first datagram gets a message from the error channel where only ts[0] is nonzero.  But after that, ALL subsequent recvmsg from MSG_ERRQUEUE come back with EAGAIN.  Each run, the sending kernel timestamp is different, but I can&#39;t figure out why it won&#39;t let met get a kernel timestamp for more than one datagram sent per run."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1511209736, "post_id": 47329376, "comment_id": 81754504, "body": "I figured out why recvmsg from MSG_ERRQUEUE is only working the first time.  It&#39;s because <i>every</i> subsequent call to sendmsg fails with EINVAL.  The first one always succeeds, and I get a timestamp.  Then something breaks or I&#39;m failing to take some important action.  So then I tried closing and reopening the socket for every transmission, and it works!  But why do I have to open the socket fresh for every datagram?"}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1511210891, "post_id": 47329376, "comment_id": 81755130, "body": "One more observation.  Leaving everything else the same (i.e. same socket options, etc.), I don&#39;t have to keep closing and reopening the socket if I simply don&#39;t do the recvmsg on MSG_ERRQUEUE.  So doing a single recvmsg on MSG_ERRQUEUE trashes the socket somehow."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1511211826, "post_id": 47329376, "comment_id": 81755617, "body": "I tried various combinations SO_TIMESTAMPING flags for the sender.  Removing RX flags did nothing.  Any combo that doesn&#39;t include SOF_TIMESTAMPING_TX_SOFTWARE is able to send any number of datagrams, but the recvmsg from MSG_ERRQUEUE always comes up empty (that returns EAGAIN).  Any combo <i>with</i> SOF_TIMESTAMPING_TX_SOFTWARE is able to get back a timestamp for the <i>first</i> datagram sent, but after that all calls to sendmsg fail with EINVAL."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 5, "last_activity_date": 1511194144, "last_edit_date": 1511194144, "creation_date": 1510834307, "answer_id": 47329376, "question_id": 47313383, "link": "https://stackoverflow.com/questions/47313383/linux-udp-datagrams-and-kernel-timestamps-lots-of-examples-and-stackoversflow/47329376#47329376", "title": "Linux, UDP datagrams, and kernel timestamps: Lots of examples and stackoversflow entries later, and still cannot get timestamps at all", "body": "<p>Like I say in comment the use of <code>SOF_TIMESTAMPING_SOFTWARE</code> and <code>SOF_TIMESTAMPING_RAW_HARDWARE</code> is necessary because if I understand correctly <a href=\"https://www.kernel.org/doc/Documentation/networking/timestamping.txt\" rel=\"nofollow noreferrer\">the documentation</a>, some bits are to generate the timestamp and some bits are here to report them in control message:</p>\n\n<blockquote>\n  <p>1.3.1 Timestamp Generation</p>\n  \n  <p>Some bits are requests to the stack to try to generate timestamps. Any\n  combination of them is valid. Changes to these bits apply to newly\n  created packets, not to packets already in the stack. As a result, it\n  is possible to selectively request timestamps for a subset of packets\n  (e.g., for sampling) by embedding an <code>send()</code> call within two <code>setsockopt</code>\n  calls, one to enable timestamp generation and one to disable it.\n  Timestamps may also be generated for reasons other than being\n  requested by a particular socket, such as when receive timestamping is\n  enabled system wide, as explained earlier.</p>\n  \n  <p>1.3.2 Timestamp Reporting</p>\n  \n  <p>The other three bits control which timestamps will be reported in a\n  generated control message. Changes to the bits take immediate effect\n  at the timestamp reporting locations in the stack. Timestamps are only\n  reported for packets that also have the relevant timestamp generation\n  request set.</p>\n</blockquote>\n\n<p>After, to use the data documentation say:</p>\n\n<blockquote>\n  <p>2.1 <code>SCM_TIMESTAMPING</code> records</p>\n  \n  <p>These timestamps are returned in a control message with cmsg_level\n  <code>SOL_SOCKET</code>, cmsg_type <code>SCM_TIMESTAMPING</code>, and payload of type</p>\n  \n  <p><code>struct scm_timestamping {    struct timespec ts[3]; };</code></p>\n  \n  <p>...</p>\n  \n  <p>The structure can return up to three timestamps. This is a legacy\n  feature. At least one field is non-zero at any time. Most timestamps\n  are passed in <code>ts[0]</code>. Hardware timestamps are passed in <code>ts[2]</code>.</p>\n</blockquote>\n\n<p>To get transmit timestamp this require some configuration, first you need to know <a href=\"https://stackoverflow.com/a/11747460/7076153\">that software timestamp are not always available</a>, I only achieve to get hardware transmit timestamp. But I'm not an expert in these domain, I just try to implemented timestamp with information that I found.</p>\n\n<p>Secondly, I needed to activate hardware feature with <a href=\"http://linuxptp.sourceforge.net/\" rel=\"nofollow noreferrer\">linuxptp tool</a>, I use <a href=\"https://www.mankier.com/8/hwstamp_ctl\" rel=\"nofollow noreferrer\">hwstamp_cli</a>:</p>\n\n<pre><code>hwstamp_ctl -i eth0 -r 1 -t 1\n</code></pre>\n\n<p>With this and some modification on your code I achieve to get hardware transmit timestamp but only with ethX interface because lo interface don't have these feature AFAIK so the final code is:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;linux/errqueue.h&gt;\n#include &lt;linux/net_tstamp.h&gt;\n#include &lt;linux/sockios.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\n#define UDP_MAX_LENGTH 1500\n\ntypedef struct {\n  int fd;\n  int port;\n  int err_no;\n  struct sockaddr_in local;\n  struct sockaddr_in remote;\n  struct timeval time_kernel;\n  struct timeval time_user;\n  int64_t prev_serialnum;\n} socket_info;\n\nstatic int setup_udp_receiver(socket_info *inf, int port) {\n  inf-&gt;port = port;\n  inf-&gt;fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n  if (inf-&gt;fd &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_server: socket failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return inf-&gt;fd;\n  }\n\n  int timestampOn =\n      SOF_TIMESTAMPING_RX_SOFTWARE | SOF_TIMESTAMPING_TX_SOFTWARE |\n      SOF_TIMESTAMPING_SOFTWARE | SOF_TIMESTAMPING_RX_HARDWARE |\n      SOF_TIMESTAMPING_TX_HARDWARE | SOF_TIMESTAMPING_RAW_HARDWARE |\n      // SOF_TIMESTAMPING_OPT_TSONLY |\n      0;\n  int r = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_TIMESTAMPING, &amp;timestampOn,\n                     sizeof timestampOn);\n  if (r &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_server: setsockopt failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return r;\n  }\n\n  int on = 1;\n  r = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_REUSEPORT, &amp;on, sizeof on);\n  if (r &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_server: setsockopt2 failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return r;\n  }\n\n  inf-&gt;local = (struct sockaddr_in){.sin_family = AF_INET,\n                                    .sin_port = htons((uint16_t)port),\n                                    .sin_addr.s_addr = htonl(INADDR_ANY)};\n  r = bind(inf-&gt;fd, (struct sockaddr *)&amp;inf-&gt;local, sizeof inf-&gt;local);\n  if (r &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_server: bind failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return r;\n  }\n\n  inf-&gt;prev_serialnum = -1;\n\n  return 0;\n}\n\nstatic int setup_udp_sender(socket_info *inf, int port, char *address) {\n  inf-&gt;port = port;\n  inf-&gt;fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n  if (inf-&gt;fd &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_client: socket failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return inf-&gt;fd;\n  }\n\n  int timestampOn =\n      SOF_TIMESTAMPING_RX_SOFTWARE | SOF_TIMESTAMPING_TX_SOFTWARE |\n      SOF_TIMESTAMPING_SOFTWARE | SOF_TIMESTAMPING_RX_HARDWARE |\n      SOF_TIMESTAMPING_TX_HARDWARE | SOF_TIMESTAMPING_RAW_HARDWARE |\n      // SOF_TIMESTAMPING_OPT_TSONLY |\n      0;\n  int r = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_TIMESTAMPING, &amp;timestampOn,\n                     sizeof timestampOn);\n  if (r &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"setup_udp_server: setsockopt failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n    return r;\n  }\n\n  inf-&gt;remote = (struct sockaddr_in){.sin_family = AF_INET,\n                                     .sin_port = htons((uint16_t)port)};\n  r = inet_aton(address, &amp;inf-&gt;remote.sin_addr);\n  if (r == 0) {\n    fprintf(stderr, \"setup_udp_client: inet_aton failed\\n\");\n    inf-&gt;err_no = 0;\n    return -1;\n  }\n\n  inf-&gt;local = (struct sockaddr_in){.sin_family = AF_INET,\n                                    .sin_port = htons(0),\n                                    .sin_addr.s_addr = htonl(INADDR_ANY)};\n  inf-&gt;prev_serialnum = -1;\n\n  return 0;\n}\n\nstatic void handle_scm_timestamping(struct scm_timestamping *ts) {\n  for (size_t i = 0; i &lt; sizeof ts-&gt;ts / sizeof *ts-&gt;ts; i++) {\n    printf(\"timestamp: %lld.%.9lds\\n\", (long long)ts-&gt;ts[i].tv_sec,\n           ts-&gt;ts[i].tv_nsec);\n  }\n}\n\nstatic void handle_time(struct msghdr *msg) {\n\n  for (struct cmsghdr *cmsg = CMSG_FIRSTHDR(msg); cmsg;\n       cmsg = CMSG_NXTHDR(msg, cmsg)) {\n    printf(\"level=%d, type=%d, len=%zu\\n\", cmsg-&gt;cmsg_level, cmsg-&gt;cmsg_type,\n           cmsg-&gt;cmsg_len);\n\n    if (cmsg-&gt;cmsg_level == SOL_IP &amp;&amp; cmsg-&gt;cmsg_type == IP_RECVERR) {\n      struct sock_extended_err *ext =\n          (struct sock_extended_err *)CMSG_DATA(cmsg);\n      printf(\"errno=%d, origin=%d\\n\", ext-&gt;ee_errno, ext-&gt;ee_origin);\n      continue;\n    }\n\n    if (cmsg-&gt;cmsg_level != SOL_SOCKET)\n      continue;\n\n    switch (cmsg-&gt;cmsg_type) {\n    case SO_TIMESTAMPNS: {\n      struct scm_timestamping *ts = (struct scm_timestamping *)CMSG_DATA(cmsg);\n      handle_scm_timestamping(ts);\n    } break;\n    case SO_TIMESTAMPING: {\n      struct scm_timestamping *ts = (struct scm_timestamping *)CMSG_DATA(cmsg);\n      handle_scm_timestamping(ts);\n    } break;\n    default:\n      /* Ignore other cmsg options */\n      break;\n    }\n  }\n  printf(\"End messages\\n\");\n}\n\nstatic ssize_t udp_receive(socket_info *inf, char *buf, size_t len) {\n  char ctrl[2048];\n  struct iovec iov = (struct iovec){.iov_base = buf, .iov_len = len};\n  struct msghdr msg = (struct msghdr){.msg_control = ctrl,\n                                      .msg_controllen = sizeof ctrl,\n                                      .msg_name = &amp;inf-&gt;remote,\n                                      .msg_namelen = sizeof inf-&gt;remote,\n                                      .msg_iov = &amp;iov,\n                                      .msg_iovlen = 1};\n  ssize_t recv_len = recvmsg(inf-&gt;fd, &amp;msg, 0);\n  gettimeofday(&amp;inf-&gt;time_user, NULL);\n\n  if (recv_len &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"udp_receive: recvfrom failed: %s\\n\",\n            strerror(inf-&gt;err_no));\n  }\n\n  handle_time(&amp;msg);\n\n  return recv_len;\n}\n\nstatic ssize_t udp_send(socket_info *inf, char *buf, size_t len) {\n  struct iovec iov = (struct iovec){.iov_base = buf, .iov_len = len};\n  struct msghdr msg = (struct msghdr){.msg_name = &amp;inf-&gt;remote,\n                                      .msg_namelen = sizeof inf-&gt;remote,\n                                      .msg_iov = &amp;iov,\n                                      .msg_iovlen = 1};\n  gettimeofday(&amp;inf-&gt;time_user, NULL);\n  ssize_t send_len = sendmsg(inf-&gt;fd, &amp;msg, 0);\n  if (send_len &lt; 0) {\n    inf-&gt;err_no = errno;\n    fprintf(stderr, \"udp_send: sendmsg failed: %s\\n\", strerror(inf-&gt;err_no));\n  }\n\n  return send_len;\n}\n\nstatic ssize_t meq_receive(socket_info *inf, char *buf, size_t len) {\n  struct iovec iov = (struct iovec){.iov_base = buf, .iov_len = len};\n  char ctrl[2048];\n  struct msghdr msg = (struct msghdr){.msg_control = ctrl,\n                                      .msg_controllen = sizeof ctrl,\n                                      .msg_name = &amp;inf-&gt;remote,\n                                      .msg_namelen = sizeof inf-&gt;remote,\n                                      .msg_iov = &amp;iov,\n                                      .msg_iovlen = 1};\n  ssize_t recv_len = recvmsg(inf-&gt;fd, &amp;msg, MSG_ERRQUEUE);\n  if (recv_len &lt; 0) {\n    inf-&gt;err_no = errno;\n    if (errno != EAGAIN) {\n      fprintf(stderr, \"meq_receive: recvmsg failed: %s\\n\",\n              strerror(inf-&gt;err_no));\n    }\n    return recv_len;\n  }\n  handle_time(&amp;msg);\n\n  return recv_len;\n}\n\ntypedef struct {\n  int64_t serialnum;\n\n  int64_t user_time_serialnum;\n  int64_t user_time;\n\n  int64_t kernel_time_serialnum;\n  int64_t kernel_time;\n\n  size_t message_bytes;\n} message_header;\n\nstatic const size_t payload_max = UDP_MAX_LENGTH - sizeof(message_header);\n\nstatic ssize_t generate_random_message(socket_info *inf, char *buf,\n                                       size_t len) {\n  if (len &lt; sizeof(message_header)) {\n    return -1;\n  }\n  message_header *header = (message_header *)buf;\n  char *payload = (char *)(header + 1);\n  size_t payload_len = (size_t)random() % (payload_max + 1);\n  if (payload_len &gt; len - sizeof(message_header)) {\n    payload_len = len - sizeof(message_header);\n  }\n  for (size_t i = 0; i &lt; payload_len; i++) {\n    payload[i] = (char)random();\n  }\n\n  static int64_t serial_num = 0;\n  *header = (message_header){\n      .user_time_serialnum = inf-&gt;prev_serialnum,\n      .user_time = inf-&gt;time_user.tv_sec * 1000000000L + inf-&gt;time_user.tv_usec,\n      .kernel_time_serialnum = inf-&gt;prev_serialnum,\n      .kernel_time =\n          inf-&gt;time_kernel.tv_sec * 1000000000L + inf-&gt;time_kernel.tv_usec,\n      .serialnum = serial_num,\n      .message_bytes = payload_len};\n  size_t total = payload_len + sizeof *header;\n\n  printf(\"uts%5\" PRId64 \": kt=%\" PRId64 \", ut=%\" PRId64 \", sn=%\" PRId64\n         \": s=%zu\\n\",\n         header-&gt;user_time_serialnum, header-&gt;kernel_time, header-&gt;user_time,\n         header-&gt;serialnum, total);\n\n  inf-&gt;prev_serialnum = serial_num++;\n\n  return (ssize_t)total;\n}\n\nstatic void sender_loop(char *host) {\n  socket_info inf;\n  int ret = setup_udp_sender(&amp;inf, 8000, host);\n  if (ret &lt; 0) {\n    return;\n  }\n\n  for (int i = 0; i &lt; 2000; i++) {\n    useconds_t t = random() % 2000000;\n    usleep(t);\n    char packet_buffer[4096];\n    ssize_t len =\n        generate_random_message(&amp;inf, packet_buffer, sizeof packet_buffer);\n    if (len &lt; 0) {\n      return;\n    }\n    udp_send(&amp;inf, packet_buffer, (size_t)len);\n    while (meq_receive(&amp;inf, packet_buffer, sizeof packet_buffer) != -1) {\n    }\n  }\n}\n\nstatic void receiver_loop(void) {\n  socket_info inf;\n  int ret = setup_udp_receiver(&amp;inf, 8000);\n  if (ret &lt; 0) {\n    return;\n  }\n\n  for (int i = 0; i &lt; 1000; i++) {\n    char packet_buffer[4096];\n    udp_receive(&amp;inf, packet_buffer, sizeof packet_buffer);\n  }\n}\n\n#define USAGE \"Usage: %s [-r | -s host]\\n\"\n\nint main(int argc, char *argv[]) {\n  if (argc &lt; 2) {\n    fprintf(stderr, USAGE, argv[0]);\n    return 0;\n  }\n\n  if (0 == strcmp(argv[1], \"-s\")) {\n    if (argc &lt; 3) {\n      fprintf(stderr, USAGE, argv[0]);\n      return 0;\n    }\n    sender_loop(argv[2]);\n  } else if (0 == strcmp(argv[1], \"-r\")) {\n    receiver_loop();\n  } else {\n    fprintf(stderr, USAGE, argv[0]);\n  }\n}\n</code></pre>\n\n<p>Exemple output:</p>\n\n<pre><code>$ ./a.out -r\nlevel=1, type=37, len=64\ntimestamp: 1511196758.087209387s\ntimestamp: 0.000000000s\ntimestamp: 0.000000000s\nEnd messages\nlevel=1, type=37, len=64\ntimestamp: 1511196759.333507671s\ntimestamp: 0.000000000s\ntimestamp: 0.000000000s\nEnd messages\n$ ./a.out -s \"8.8.8.8\"\nuts   -1: kt=238059712, ut=140918979990070, sn=0: s=482\nuts    0: kt=238059712, ut=1511197522000237457, sn=1: s=132\nlevel=1, type=37, len=64\ntimestamp: 0.000000000s\ntimestamp: 0.000000000s\ntimestamp: 1511197359.637050597s\nlevel=0, type=11, len=48\nerrno=42, origin=4\nEnd messages\nuts    1: kt=238059712, ut=1511197523000483805, sn=2: s=1454\nlevel=1, type=37, len=64\ntimestamp: 0.000000000s\ntimestamp: 0.000000000s\ntimestamp: 1511197360.883295397s\nlevel=0, type=11, len=48\nerrno=42, origin=4\nEnd messages\n</code></pre>\n\n<p>Live test: <a href=\"http://rextester.com/ZCI27564\" rel=\"nofollow noreferrer\">sender</a>, <a href=\"http://rextester.com/NPZT9983\" rel=\"nofollow noreferrer\">receiver</a></p>\n"}], "owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3165, "favorite_count": 2, "accepted_answer_id": 47329376, "answer_count": 1, "score": 6, "last_activity_date": 1511194144, "creation_date": 1510765736, "last_edit_date": 1510780310, "question_id": 47313383, "link": "https://stackoverflow.com/questions/47313383/linux-udp-datagrams-and-kernel-timestamps-lots-of-examples-and-stackoversflow", "title": "Linux, UDP datagrams, and kernel timestamps: Lots of examples and stackoversflow entries later, and still cannot get timestamps at all", "body": "<p>I have been trying and failing to get Linux (kernel 4.1.4) to give me timestamps for when UDP datagrams are sent and received.  I have read the original kernel docs (<a href=\"https://www.kernel.org/doc/Documentation/networking/timestamping.txt\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/networking/timestamping.txt</a>), along with lots of examples and a number of stackoverflow entries.  I can send datagrams between sender and receiver with no problems.  But I cannot get timestamps for sending or receiving datagrams, and I can't figure out what I'm doing wrong.  </p>\n\n<p>One bizarre thing is that when I use the MSG_ERRQUEUE channel for getting timestamp info on a sent datagram, I do get the original outgoing packet, and I do get the first ancillary message (SOL_IP, IP_RECVERR), but I do not get a second message (which should be level SOL_SOCKET, type SCM_TIMESTAMPING).</p>\n\n<p>In another stackoverflow entry on getting timestamps for sent packets (<a href=\"https://stackoverflow.com/questions/11731445/timestamp-outgoing-packets\">Timestamp outgoing packets</a>), someone mentioned that some drivers might not implement the call to <code>skb_tx_timestamp</code>, but I checked mine (Realtek), and that call is definitely in there.</p>\n\n<p>Here's how I set up the UDP receiver (error handling code not shown):</p>\n\n<pre><code>inf-&gt;fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\ntimestampOn = SOF_TIMESTAMPING_RX_SOFTWARE | SOF_TIMESTAMPING_RX_HARDWARE;\nr = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_TIMESTAMPING, &amp;timestampOn, sizeof(timestampOn));\n\nr = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_REUSEPORT, &amp;on, sizeof(on));\n\nmemset(&amp;(inf-&gt;local), 0, sizeof(struct sockaddr_in));\ninf-&gt;local.sin_family = AF_INET;\ninf-&gt;local.sin_port = htons(port);\ninf-&gt;local.sin_addr.s_addr = htonl(INADDR_ANY);\n\nr = bind(inf-&gt;fd, (struct sockaddr *)&amp;(inf-&gt;local), sizeof(struct sockaddr_in));\n</code></pre>\n\n<p>Using SO_REUSEPORT or not doesn't seem to matter.</p>\n\n<p>For receiving, my understanding is that we don't use MSG_ERRQUEUE.  That's only if we want timestamps for sent messages.  Besides, when I use MSG_ERRQUEUE with recvmsg, I get \"resource temporarily unavailable.\"  Here's how I receive datagrams:</p>\n\n<pre><code>int recv_len;\nstruct msghdr   msg;\nstruct iovec    iov;\n\nmemset(&amp;msg, 0, sizeof(msg));\nmemset(&amp;iov, 0, sizeof(iov));\n\n// Space for control message info plus timestamp\nchar ctrl[2048];\nmemset(ctrl, 0, sizeof(ctrl));\n//struct cmsghdr *cmsg = (struct cmsghdr *) &amp;ctrl;\n\n// Ancillary data buffer and length\nmsg.msg_control      = (char *) ctrl;\nmsg.msg_controllen   = sizeof(ctrl);\n\n// Dest address info\nmsg.msg_name         = (struct sockaddr *) &amp;(inf-&gt;remote);\nmsg.msg_namelen      = sizeof(struct sockaddr_in);\n\n// Array of data buffers (scatter/gather)\nmsg.msg_iov          = &amp;iov;\nmsg.msg_iovlen       = 1;\n\n// Data buffer pointer and length\niov.iov_base         = buf;\niov.iov_len          = len;\n\nrecv_len = recvmsg(inf-&gt;fd, &amp;msg, 0);\n</code></pre>\n\n<p>And then I pass a pointer to msg to another function (<code>handle_time</code>) that does this:</p>\n\n<pre><code>struct timespec* ts = NULL;\nstruct cmsghdr* cmsg;\nstruct sock_extended_err *ext;\n\nfor( cmsg = CMSG_FIRSTHDR(msg); cmsg; cmsg = CMSG_NXTHDR(msg,cmsg) ) {\n    printf(\"level=%d, type=%d, len=%zu\\n\", cmsg-&gt;cmsg_level, cmsg-&gt;cmsg_type, cmsg-&gt;cmsg_len);\n}\n</code></pre>\n\n<p><strong>Zero messages are received.</strong>  So that's the first problem.  My setup code above matches like half a dozen other examples I've found on the web, but I'm getting no ancillary data from this.</p>\n\n<p>Next, let's turn to sending datagrams.  Here's the setup:</p>\n\n<pre><code>inf-&gt;port = port;\ninf-&gt;fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nmemset(&amp;(inf-&gt;remote), 0, sizeof(struct sockaddr_in));\ninf-&gt;remote.sin_family = AF_INET;\ninf-&gt;remote.sin_port = htons(port);\n\ntimestampOn = SOF_TIMESTAMPING_TX_SOFTWARE | SOF_TIMESTAMPING_TX_HARDWARE;\nr = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_TIMESTAMPING, &amp;timestampOn, sizeof(timestampOn));\n\non = 1;\nr = setsockopt(inf-&gt;fd, SOL_SOCKET, SO_BROADCAST, &amp;on, sizeof(on));\n\nr = inet_aton(address, &amp;(inf-&gt;remote.sin_addr));\n</code></pre>\n\n<p>And this is how I send a datagram:</p>\n\n<pre><code>int send_len, r, i;\nstruct msghdr   msg;\nstruct iovec    iov;\n\nmemset(&amp;msg, 0, sizeof(msg));\nmemset(&amp;iov, 0, sizeof(iov));\n\n// Space for control message info plus timestamp\nchar ctrl[2048];\nmemset(ctrl, 0, sizeof(ctrl));\n//struct cmsghdr *cmsg = (struct cmsghdr *) &amp;ctrl;\n\n// Ancillary data buffer and length\n//msg.msg_control      = (char *) ctrl;\n//msg.msg_controllen   = sizeof(ctrl);    \n\n// Dest address info\nmsg.msg_name         = (struct sockaddr *) &amp;(inf-&gt;remote);\nmsg.msg_namelen      = sizeof(struct sockaddr_in);\n\n// Array of data buffers (scatter/gather)\nmsg.msg_iov          = &amp;iov;\nmsg.msg_iovlen       = 1;\n\n// Data buffer pointer and length\niov.iov_base         = buf;\niov.iov_len          = len;\n\nsend_len = sendmsg(inf-&gt;fd, &amp;msg, 0);\n</code></pre>\n\n<p>Examples I've seen reuse the msg and iov data structures, but in my experimentation, I added code to make sure things were cleared, just in case the send left anything behind, although it didn't make any difference.  Here's the code for getting the timestamp:</p>\n\n<pre><code>memset(&amp;msg, 0, sizeof(msg));\nmemset(&amp;iov, 0, sizeof(iov));\nmemset(ctrl, 0, sizeof(ctrl));\nmsg.msg_control      = (char *) ctrl;\nmsg.msg_controllen   = sizeof(ctrl);\nmsg.msg_name         = (struct sockaddr *) &amp;(inf-&gt;remote);\nmsg.msg_namelen      = sizeof(struct sockaddr_in);\nmsg.msg_iov          = &amp;iov;\nmsg.msg_iovlen       = 1;\niov.iov_base         = junk_buf;\niov.iov_len          = sizeof(junk_buf);\n\nfor (;;) {\n    r = recvmsg(inf-&gt;fd, &amp;msg, MSG_ERRQUEUE);\n    if (r&lt;0) {\n        fprintf(stderr, \"Didn't get kernel time\\n\");\n        return send_len;\n    }\n\n    printf(\"recvmsg returned %d\\n\", r);\n    handle_time(&amp;msg);\n}\n</code></pre>\n\n<p>The data buffer contains the original datagram as expected.  The ancillary data I get back includes a single message, which handle_time prints as:</p>\n\n<pre><code>level=0, type=11, len=48\n</code></pre>\n\n<p>This is level SOL_IP and type IP_RECVERR, which is expected according to the docs.  Looking into the payload (a struct sock_extended_err), the errno is 42 (ENOMSG, No message of desired type) and origin is 4 (SO_EE_ORIGIN_TXSTATUS).  From the docs, this is supposed to happen and demonstrates that in fact I did manage to inform the kernel that I want TX status messages.  But there is no second ancillary message!</p>\n\n<p>I have tried to see if there is any kernel compile option that might disable this, but I haven't found any.  So I'm just completely baffled here.  Can anyone help me figure out what I'm doing wrong?  </p>\n\n<p>Thanks!</p>\n\n<p><strong>UPDATE:</strong>  I tried running this same code on another Linux machine, this time CentOS 7 (kernel 3.10.0-693.2.2.el7.x86_64).  I can't figure out what what kind of NIC that machine has, but when I try to send datagrams, I get some other weird behavior.  For the very first datagram, when I start this program, I get back the message and a single ancillary message, just as above.  For every subsequent <code>sendmsg</code> call, errno tells me that I get an \"Invalid argument\" error.  This error goes away if I don't enable timestamps on the socket.</p>\n\n<p><strong>UPDATE 2:</strong>  I discovered that I had not been making an ioctl necessary to enable timestamps in the driver.  Unfortunately, when I do this call, I get ENODEV from errno (no such device).  Here's how I'm trying to do it (which I'm imitating from <a href=\"https://github.com/majek/openonload/blob/master/src/tests/onload/hwtimestamping/tx_timestamping.c\" rel=\"nofollow noreferrer\">https://github.com/majek/openonload/blob/master/src/tests/onload/hwtimestamping/tx_timestamping.c</a>):</p>\n\n<pre><code>struct ifreq ifr;\nstruct hwtstamp_config hwc;\n\ninf-&gt;fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nmemset(&amp;ifr, 0, sizeof(ifr));\nhwc.flags = 0;\nhwc.tx_type = HWTSTAMP_TX_ON;\nhwc.rx_filter = HWTSTAMP_FILTER_ALL;\nifr.ifr_data = (char*)&amp;hwc;\nr = ioctl(inf-&gt;fd, SIOCSHWTSTAMP, &amp;ifr);\n</code></pre>\n\n<p>That being said, I'd be relatively happy with software timestamps, which should not need this call.  So I'm not sure this is helpful anyhow.</p>\n\n<p><strong>UPDATE 3:</strong>  A compilable example was requested.  The whole program is pretty minimal, so I put it into pastebin here:  <a href=\"https://pastebin.com/qd0gspRc\" rel=\"nofollow noreferrer\">https://pastebin.com/qd0gspRc</a></p>\n\n<p>Also, here's the output from ethtool:</p>\n\n<pre><code>Time stamping parameters for eth0:\nCapabilities:\n        software-transmit     (SOF_TIMESTAMPING_TX_SOFTWARE)\n        software-receive      (SOF_TIMESTAMPING_RX_SOFTWARE)\n        software-system-clock (SOF_TIMESTAMPING_SOFTWARE)\nPTP Hardware Clock: none\nHardware Transmit Timestamp Modes: none\nHardware Receive Filter Modes: none\n</code></pre>\n\n<p>Since this obviously doesn't support hardware timestamps, the ioctl is moot.  I tried changing the SO_TIMESTAMPING setting to SOF_TIMESTAMPING_TX_SOFTWARE and SOF_TIMESTAMPING_RX_SOFTWARE for sender and receiver.  That didn't help.  </p>\n\n<p>Then I tried adding SOF_TIMESTAMPING_SOFTWARE to both.  I finally started getting something:</p>\n\n<pre><code>level=1, type=37, len=64\n</code></pre>\n\n<p>Level 1 is SOL_SOCKET, and type 37 is SCM_TIMESTAMPING.  I'll go back to the docs and figure out how to interpret this.  It says something about passing an array of three time structures.  The driver's call to <code>skb_tx_timestamp</code> should have been sufficient so that it wouldn't require that I enable \"fake\" software timestamps to get something out.</p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1510765682, "post_id": 47313346, "comment_id": 81577529, "body": "<code>mode == ASCII_PPM</code>. Or <code>switch&#47;case</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1728, "user_id": 960044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e7a7e4ffd73076bb4e327011365326?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/960044/alan"}, "is_accepted": false, "score": 3, "last_activity_date": 1510765835, "creation_date": 1510765835, "answer_id": 47313417, "question_id": 47313346, "link": "https://stackoverflow.com/questions/47313346/enum-as-parameter-in-c-function/47313417#47313417", "title": "enum as parameter in c function", "body": "<p>enums are not strings, so you should not use strcmp. They are basically integers under the hood.  You need to change your if statement to...</p>\n\n<pre><code>if (ASCII_PPM == mode)\n</code></pre>\n\n<p>or you can use switch statement, E.g.</p>\n\n<pre><code>switch (mode)\n{\n    case ASCII_PPM:\n        ProcessAsciiPpm();\n        break;\n\n    case BINARY_PPM:\n        ProcessBinaryPpm();\n        break;\n\n    default:\n        break;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 4, "last_activity_date": 1510766209, "last_edit_date": 1510766209, "creation_date": 1510765900, "answer_id": 47313440, "question_id": 47313346, "link": "https://stackoverflow.com/questions/47313346/enum-as-parameter-in-c-function/47313440#47313440", "title": "enum as parameter in c function", "body": "<p><code>strcmp</code> is used for strings. <code>enum</code> is actually a type of <code>int</code>, so <code>mode == ASCII_PPM</code> will be the right way of comparison</p>\n\n<p><strong>6.7.2.2 Enumeration specifiers</strong></p>\n\n<blockquote>\n  <p>The identifiers in an enumerator list are declared as constants <strong>that have type int</strong> and may appear wherever such are permitted.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 1, "last_activity_date": 1510781307, "creation_date": 1510781307, "answer_id": 47317551, "question_id": 47313346, "link": "https://stackoverflow.com/questions/47313346/enum-as-parameter-in-c-function/47317551#47317551", "title": "enum as parameter in c function", "body": "<p>this code:</p>\n\n<pre><code>enum jmpr_PNMMode\n{\n    BINARY_PPM,             /* Binary Portable Pixmap (P6)  */\n    ASCII_PPM,          /* Portable pixmap ASCII (P3)   */\n    BINARY_PGM,         /* Portable Graymap binary (P5) */\n    ASCII_PGM            /* Portable Graymap ASCII (P2) */\n};\n</code></pre>\n\n<p>gives meaningful names to 4 integers, where <code>BINARY_PPM</code> is 0 and each following line increments that number by 1.</p>\n\n<p>so the code in the called function could be using: </p>\n\n<pre><code>if ( BINARY_PPM == mode )\n    ...\nelse if( ASCII_PPM == mode )\n    ...\nelse if( BINARY_PGM == mode )\n    ...\nelse if( ASCII_PGM == mode )\n    ...\nelse\n{\n    perror( \"invalid mode sent to jmpr_savePNM()\" );\n    exit( EXIT_FAILURE );\n}\n</code></pre>\n\n<p>or could be using: </p>\n\n<pre><code>switch( mode )\n    case BINARY_PPM: \n        ...\n        break;\n\n    case ASCII_PPM:\n        ...\n        break;\n\n    case BINARY_PGM:\n        ...\n        break;\n\n    case ASCII_PGM:\n        ...\n        break;\n\n    default:\n        perror( \"invalid mode sent to jmpr_savePNM()\" );\n        exit( EXIT_FAILURE );\n        break;\n} // end switch()\n</code></pre>\n\n<p>for clarity in the code and ease of readability and understanding, I would use the <code>switch()</code> statement.</p>\n"}], "owner": {"reputation": 148, "user_id": 7847845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1617113984984989/picture?type=large", "display_name": "Alexander Tepe", "link": "https://stackoverflow.com/users/7847845/alexander-tepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 47317551, "answer_count": 3, "score": 0, "last_activity_date": 1510781307, "creation_date": 1510765634, "question_id": 47313346, "link": "https://stackoverflow.com/questions/47313346/enum-as-parameter-in-c-function", "title": "enum as parameter in c function", "body": "<p>I am writing a Library to load and save ascii and binary images. I defined an Enum containing 4 different flags for 4 different ways to save a bitmap:</p>\n\n<pre><code>enum jmpr_PNMMode\n{\n    BINARY_PPM,             /* Binary Portable Pixmap (P6)  */\n    ASCII_PPM,          /* Portable pixmap ASCII (P3)   */\n    BINARY_PGM,         /* Portable Graymap binary (P5) */\n    ASCII_PGM            /* Portable Graymap ASCII (P2) */\n};\n</code></pre>\n\n<p>I pass those to my save-function as a parameter:</p>\n\n<pre><code>void jmpr_savePNM(char* filename, jmpr_Image* img, enum jmpr_PNMMode mode)\n{\n\n}\n</code></pre>\n\n<p>Now how can I check which distinct instance of the enum I got? it doesn't work with:</p>\n\n<pre><code>if (strcmp(mode, \"ASCII_PPM\") != 0)\n</code></pre>\n\n<p>since the second parameter is technically not a char*.</p>\n"}, {"tags": ["c++", "c", "virtual-functions", "memory-layout", "vptr"], "comments": [{"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1510764896, "post_id": 47313094, "comment_id": 81577005, "body": "Structs do not have any member functions in c."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510765006, "post_id": 47313094, "comment_id": 81577090, "body": "@user0042 When compiled in C, there are no member functions defined. It is entirely valid to have a POD struct which includes member functions in C++, which will have exactly the same memory layout when used in C."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1510765495, "post_id": 47313094, "comment_id": 81577414, "body": "I&#39;d advise at trying to commingle C and C++ in that fashion.  Keep them separate.  Have a C++ class that has-a member variable of the POD struct.  If you need to, pass a token (a void*) to the C side of the API for the C++ class instance, and package it (to a void*, or back to a C++ class pointer) at that C/C++ API barrier."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1511389703, "post_id": 47313094, "comment_id": 81844936, "body": "In general, polymorphic classes cannot be made compatible with C &quot;equivalent&quot; because C has no equivalent. You would need to know how these classes are compiled. Then your code would only work for the ABI of the compiler."}], "answers": [{"comments": [{"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1510772254, "post_id": 47313408, "comment_id": 81581228, "body": "I&#39;m not a fan of this answer as it makes usage clunky. For example, initialisation in C would be like <code>MyStrImpl* impl = (MyStrImpl*) malloc(sizeof(MyStrImpl)); MyStr str; str.impl = impl;</code>, and using methods in C++ will take the form <code>str.impl-&gt;toString()</code>. This might be fine for internal code, but it&#39;s just not acceptable for an API."}, {"owner": {"reputation": 6892, "user_id": 429879, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VyTUw.png?s=128&g=1", "display_name": "Germ&#225;n Diago", "link": "https://stackoverflow.com/users/429879/germ%c3%a1n-diago"}, "reply_to_user": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1510772747, "post_id": 47313408, "comment_id": 81581512, "body": "If you need something more fancy, anyway, the solution amounts to duplicate a C and a C++ implementation if you want different interfaces. You could add C functions for construct/destruct with current solution."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1510773127, "post_id": 47313408, "comment_id": 81581762, "body": "Sure, I could make a constructor function in C. This would have to assume that the caller is OK with using malloc (which may not always be the case). It&#39;s more about the ease-of-use. The user of the struct whether in C or C++ should never have to worry about implementation details, and just write code semantically. I&#39;m wondering if user-defined packing will do what I want."}, {"owner": {"reputation": 6892, "user_id": 429879, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VyTUw.png?s=128&g=1", "display_name": "Germ&#225;n Diago", "link": "https://stackoverflow.com/users/429879/germ%c3%a1n-diago"}, "reply_to_user": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1510774069, "post_id": 47313408, "comment_id": 81582284, "body": "The fact that you hide the constructor behind a C interface does not mean malloc will be used. I get your idea about ease of use but that is going to complicate the implementation a lot. My recommendation here would be to split the C and C++ implementation in that case or you just have the option to clutter things with #ifdefs. You cannot guarantee a layout without an indirection AFAIK."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1510778293, "post_id": 47313408, "comment_id": 81584510, "body": "I peronsally prefer the hard way of doing things. If I can make it easy to use, with proper abstraction, I will. I can avoid lots of <code>#ifdefs</code> anyway by splitting the C and C++ headers."}], "tags": [], "owner": {"reputation": 6892, "user_id": 429879, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VyTUw.png?s=128&g=1", "display_name": "Germ&#225;n Diago", "link": "https://stackoverflow.com/users/429879/germ%c3%a1n-diago"}, "is_accepted": false, "score": 2, "last_activity_date": 1510765807, "creation_date": 1510765807, "answer_id": 47313408, "question_id": 47313094, "link": "https://stackoverflow.com/questions/47313094/using-c-struct-with-virtual-members-i-e-non-pod-in-c/47313408#47313408", "title": "Using C++ struct with virtual members (i.e. non-POD) in C", "body": "<p>I do not recommend you to clutter your header file with <code>#ifdefs</code>. </p>\n\n<p>The first thing you should do in this case if you want to retain some kind of virtualization and C compatibility at the same time is:</p>\n\n<ol>\n<li>Make your C++ and C type an opaque pointer to the representation.</li>\n<li>Put implementation details in a .cpp file.</li>\n</ol>\n\n<p>An idea follows.</p>\n\n<p>Header file:</p>\n\n<pre><code>struct MyStrImpl;\n\nstruct MyStr {\n   MyStrImpl * impl;\n};\n\nextern \"C\" MyReturnType myFunction(MyStr myStr);\n</code></pre>\n\n<p>Implementation in <code>.cpp</code> file:</p>\n\n<pre><code>struct MyCppString {\n    virtual ...\n};\n\n#ifdef __cplusplus\nstruct MyStrImpl : public MyCppString {\n\n};\n#else\nstruct MyStrImpl {\n\n};\n#endif\nMyStr::MyStr() : impl{new MyStrImpl{}} {\n\n}\n</code></pre>\n\n<p>This way you have a type that can be used from both C and C++.</p>\n\n<p>Advantages:</p>\n\n<ul>\n<li>No <code>#ifdef</code> in header file.</li>\n<li>Compatible with C/C++ and consumable from both languages.</li>\n</ul>\n\n<p>Disadvantages:</p>\n\n<ul>\n<li>Lose overloading due to extern \"C\".</li>\n<li>Must use a C-style interface (but can implement with C++-like with virtual functions interface in your .cpp file.</li>\n</ul>\n\n<p>You cannot have both a C-compatible type and virtual functions in a header file at the same time without cluttering it with <code>#ifdef</code>, something that I do not recommend since it can be inconvenient if you need to refactor code.</p>\n"}], "owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1511191815, "creation_date": 1510764857, "last_edit_date": 1511191815, "question_id": 47313094, "link": "https://stackoverflow.com/questions/47313094/using-c-struct-with-virtual-members-i-e-non-pod-in-c", "title": "Using C++ struct with virtual members (i.e. non-POD) in C", "body": "<p>In questions such as <a href=\"https://stackoverflow.com/questions/1429440/c-class-or-struct-compatiblity-with-c-struct\">this</a>, compatibility between C++ classes/structs and C structs is explained as possible as long as all members are of the same type, in the same order, and no virtual members are declared.</p>\n\n<p>That's my problem. I have virtual methods, and I would very much like to keep them when manipulating the struct in C++.</p>\n\n<p>Let's examine this toy example. It's meant to be a C and C++ compatible struct defined in a single header file.</p>\n\n<p>mystr.h:</p>\n\n<pre><code>#ifdef __cplusplus\n#include &lt;string&gt;\nstruct mystr_base {\n    virtual ~mystr_base() {}\n\n    virtual std::string toString() = 0;\n};\n#endif\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nstruct mystr\n#ifdef __cplusplus\n: public mystr_base\n#endif\n{\n    const char* data;\n\n#ifdef __cplusplus\n    std::string toString() {\n        return std::string(data);\n    }\n#endif\n};\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>This may not be exactly pretty, but will do for the example. In a real scenario, the C and C++ variants may be in separate headers, with the C++ struct extending a POD struct. Regardless of implementation, the issue of alignment is still present.</p>\n\n<p>With this example, if a C program was written that passes an instance of <code>mystr</code> to a C++ function, the vtable will interfere with the alignment:</p>\n\n<p>test.h:</p>\n\n<pre><code>#include \"mystr.h\"\n\n#ifdef __cplusplus\nextern \"C\"\n#endif\nvoid mycxxfunc(struct mystr str);\n</code></pre>\n\n<p>test.cpp:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nvoid mycxxfunc(mystr str) {\n    printf(\"mystr: %s\\n\", str.data);\n}\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include \"test.h\"\n\nint main(int argc, char** argv) {\n    const char* testString = \"abc123\";\n    struct mystr str;\n    str.data = testString;\n    mycxxfunc(str);\n}\n\n$ g++ -c test.cpp &amp;&amp; gcc main.c test.o\n$ ./a.out\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>(presuming that this is because the C++ function is attempting to read <code>data</code> from beyond the end of the struct's allocated memory)</p>\n\n<p>What's the best way to enable this C-C++ interoperability while still retaining the ability to use virtual functions in C++?</p>\n"}, {"tags": ["c", "pipe", "fork", "file-pointer"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1510764197, "post_id": 47312825, "comment_id": 81576487, "body": "<code>pipe(pip);</code> should be before the <code>fork();</code>."}, {"owner": {"reputation": 129, "user_id": 7419652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e1fa1bb27a5e810acb7030d2888711d?s=128&d=identicon&r=PG&f=1", "display_name": "Mikkel bruun", "link": "https://stackoverflow.com/users/7419652/mikkel-bruun"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1510764304, "post_id": 47312825, "comment_id": 81576555, "body": "Is it impossible to create a pipe after forking?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1510764463, "post_id": 47312825, "comment_id": 81576675, "body": "With the <code>pipe</code> function, yes. Also you are using <code>write</code> and <code>read</code> wrong, the second parameter is the buffer, not a pointer to a <code>FILE</code>. and you forgot the <code>=</code> after <code>FILE* fp</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1510764937, "post_id": 47312825, "comment_id": 81577043, "body": "You can create a pipe at any time, but in a case like yours it&#39;s only <i>useful</i> to do it before the fork, because only that way do parent and child share the same one."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1510824492, "post_id": 47312825, "comment_id": 81602522, "body": "@Mikkelbruun, not, it&#39;s not impossible... but if you do the <code>pipe(2)</code> after forking, you&#39;ll get two pipe descriptors in each process (four in total), without any relation to each other (between pipes).... the trick of piping before fork is to use one of the descriptors in the parent process and the other in the child....  for that, the <code>pipe(2)</code> call must be done in the common part."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1510766645, "creation_date": 1510766645, "answer_id": 47313682, "question_id": 47312825, "link": "https://stackoverflow.com/questions/47312825/writing-file-through-pipe/47313682#47313682", "title": "Writing FILE* through pipe", "body": "<blockquote>\n  <p>Is it possible to write directly from one file to another?</p>\n</blockquote>\n\n<p>C does not provide any mechanism for that, and it seems like it would require specialized hardware support.  The standard I/O paradigm is that data get read from their source into memory or written from memory to their destination.  That pesky \"memory\" in the middle means copying from one file to another cannot be direct.</p>\n\n<p>Of course, you can write a function or program that performs such a copy, hiding the details from you.  This is what the <code>cp</code> command does, after all,  but the C standard library does not contain a function for that purpose.</p>\n\n<blockquote>\n  <p>Especially if the process reading doesn't know the size of the file it's trying to read?</p>\n</blockquote>\n\n<p>That bit isn't very important.  One simply reads and then writes (only) what one has read, repeating until there is nothing more to read.  \"Nothing more to read\" means that a read attempt indicates by its return value that the end of the file has been reached.</p>\n\n<p>If you want one process to read one file and the other to write that data to another file, using a pipe to convey data between the two, then you need both processes to implement that pattern.  One reads from the source file and writes to the pipe, and the other reads from the pipe and writes to the destination file.</p>\n\n<p>Special note: for the process reading from the pipe to detect EOF on that pipe, the other end has to be closed, in both processes.  After the fork, each process can and should close the pipe end that it doesn't intend to use.  The one using the write end then closes that end when it has nothing more to write to it.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1510829940, "creation_date": 1510829940, "answer_id": 47327897, "question_id": 47312825, "link": "https://stackoverflow.com/questions/47312825/writing-file-through-pipe/47327897#47327897", "title": "Writing FILE* through pipe", "body": "<p>In other unix systems, like BSD, there's a call to connect directly two file descriptors to do what you want, but don't know if there's a system call to do that in linux.  Anywya, this cannot be done with <code>FILE *</code> descriptors, as these are the <em>instance of a buffered file</em> used by <code>&lt;stdio.h&gt;</code> library to represent a file.  You can get the file descriptor (as the system knows it) of a <code>FILE *</code> instance by  a call to the <code>getfd(3)</code> function call.</p>\n\n<p>The semantics you are trying to get from the system are quite elaborate, as you want something to pass directly the data from one file descriptor to another, without intervention of any process (directly in the kernel), and the kernel needs for that a pool of threads to do the work of copying directly from the read calls to the write ones.</p>\n\n<p>The old way of doing this is to create a thread that makes the work of reading from one file descriptor (not a <code>FILE *</code> pointer) and write to the other.</p>\n\n<p>Another thing to comment is that the <code>pipe(2)</code> system call gives you two <em>connected</em> descriptors, that allow you to <code>read(2)</code> in one (the <code>0</code> index) what is <code>write(2)</code>n in the second (the <code>1</code> index).  If you <code>fork(2)</code> a second process, and you do the <code>pipe(2)</code> call on both, you will have two pipes (with two descriptors each), one in each process, with no relationship between them.  You will be able only to communicate each process with itself, but not with the other (which doesn't know anything about the other process' pipe descriptors) so no communication between them will be possible.</p>\n\n<p>Next is a complete example of what you try to do:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\n#define length 100\n\n#define FMT(fmt) \"pid=%d:\"__FILE__\":%d:%s: \" fmt, getpid(), __LINE__, __func__\n#define ERR(fmt, ...) do {                  \\\n             fprintf(stderr,                     \\\n                     FMT(fmt \": %s (errno = %d)\\n\"), \\\n                     ##__VA_ARGS__,                  \\\n                     strerror(errno), errno);        \\\n             exit(1);                            \\\n        } while(0)\n\nvoid copy(int fdi, int fdo)\n{\n    unsigned char buffer[length];\n    ssize_t res, nread;\n\n    while((nread = res = read(fdi, buffer, sizeof buffer)) &gt; 0) {\n        res = write(fdo, buffer, nread);\n        if (res &lt; 0) ERR(\"write\");\n    } /* while */\n    if (res &lt; 0) ERR(\"read\");\n} /* copy */\n\nint main()\n{\n    int pip[2];\n    int res;\n\n    res = pipe(pip);\n    if (res &lt; 0) ERR(\"pipe\");\n\n    char *filename;\n\n    switch (res = fork()) {\n    case -1: /* error */\n         ERR(\"fork\");\n\n    case 0:  /* child */\n         filename = \"file1\";\n         res = open(filename, O_RDONLY);\n         if (res &lt; 0) ERR(\"open \\\"%s\\\"\", filename);\n         close(pip[0]);\n         copy(res, pip[1]);\n         break;\n\n    default: /* parent, we got the child's pid in res */\n         filename = \"file2\";\n         res = open(filename, O_CREAT | O_TRUNC | O_WRONLY, 0666);\n         if (res &lt; 0) ERR(\"open \\\"%s\\\"\", filename);\n         close(pip[1]);\n         copy(pip[0], res);\n         int status;\n         res = wait(&amp;status); /* wait for the child to finish */\n         if (res &lt; 0) ERR(\"wait\");\n         fprintf(stderr,\n                 FMT(\"The child %d finished with exit code %d\\n\"),\n                 res,\n                 status);\n         break;\n    } /* switch */\n    exit(0);\n} /* main */\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 7419652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e1fa1bb27a5e810acb7030d2888711d?s=128&d=identicon&r=PG&f=1", "display_name": "Mikkel bruun", "link": "https://stackoverflow.com/users/7419652/mikkel-bruun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 47313682, "answer_count": 2, "score": 1, "last_activity_date": 1510829940, "creation_date": 1510764052, "question_id": 47312825, "link": "https://stackoverflow.com/questions/47312825/writing-file-through-pipe", "title": "Writing FILE* through pipe", "body": "<p>I have two file open in two different processes. There's a pipe connecting the two. Is it possible to write directly from one file to another? Especially if the process reading doesn't know the size of the file it's trying to read?</p>\n\n<p>I was hoping to do something like this</p>\n\n<pre><code>#define length 100\nint main(){\n  int frk = fork();\n  int pip[2];\n  pipe(pip);\n  if (frk==0){ //child\n    FILE* fp fopen(\"file1\", \"r\");\n    write(pip[1],fp,length);\n  }\n  else {\n    FILE* fp fopen(\"file2\", \"w\");\n    read(pip[0],fp,length);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510763714, "post_id": 47312529, "comment_id": 81576165, "body": "Where you have <code>display(int a[21]); return 0;</code> at the end of <code>main()</code>, you have an improper declaration of <code>display()</code> (improper because there&#39;s no return type stated; OK in C90, sort of, but not in C99 or C11) and not a call to the function.  You need <code>display(a);</code> there."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510764600, "post_id": 47312529, "comment_id": 81576774, "body": "You should also check that each <code>fscanf()</code> call succeeds (returns <code>1</code>).  If you get any other return value, there&#39;s a data problem.  It isn&#39;t clear why <code>display()</code> is defined to return an <code>int</code>.  It would be more sensible if it explicitly returned nothing (<code>void</code>).  And then you&#39;d get warnings about conflicting declarations for the function <code>display()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510789447, "post_id": 47312529, "comment_id": 81589573, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "edited": false, "score": 0, "creation_date": 1510764317, "post_id": 47312623, "comment_id": 81576564, "body": "If i change to display(a); then I get in the display function, that a[i] subscripted value is neither array nor pointer nor vector."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1510764361, "post_id": 47312623, "comment_id": 81576595, "body": "To be clear, he was telling you to change it to <code>display(a)</code> when you call the function, not where you define the function or the prototype."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1510764457, "post_id": 47312623, "comment_id": 81576671, "body": "@Christian You shall <b>only</b> change <code>display(int a[21]);</code> that is just above the <code>return 0;</code> The two other places shall be left as is. So <code>display(int a[21]);     return 0;</code> --&gt; `    display(a);     return 0; `"}, {"owner": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1510764731, "post_id": 47312623, "comment_id": 81576866, "body": "@ChristianGibbons I have made these changes, but I get different values, for my integers, when a[0] should be 6, i get 1065353216. when a[9] should be -17, i get -1048051712."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "edited": false, "score": 0, "creation_date": 1510764937, "post_id": 47312623, "comment_id": 81577042, "body": "@Christian How exactly is your data file laid out?  If the numbers are separated <i>only</i> by spaces and/or newlines, it should be printing out what was read.  If you have commas in the file, your format string isn&#39;t accounting for those."}, {"owner": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1510765149, "post_id": 47312623, "comment_id": 81577188, "body": "@ChristianGibbons The data is only separated by newlines?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "edited": false, "score": 2, "creation_date": 1510765362, "post_id": 47312623, "comment_id": 81577334, "body": "@Christian At this point, you may want to post a separate question with your updated code, a copy of your input file, and the expected and actual output.  If this answer solved your original problem, consider <a href=\"https://stackoverflow.com/help/accepted-answer\">accepting it</a>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1510764536, "last_edit_date": 1510764536, "creation_date": 1510763451, "answer_id": 47312623, "question_id": 47312529, "link": "https://stackoverflow.com/questions/47312529/passing-an-array-to-a-function-thats-been-scanned/47312623#47312623", "title": "Passing an array to a function that&#39;s been scanned", "body": "<p>At the end of <code>main</code>, this is not a function call:</p>\n\n<pre><code>        \u2026\n    }\n    display(int a[21]);\n    return 0;\n}\n</code></pre>\n\n<p>Because the type of the parameter is included, this is considered a <em>declaration</em> (without a return type, so implicitly <code>int</code>).  To call a function, just pass the required parameters:</p>\n\n<pre><code>display(a);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510777862, "post_id": 47313806, "comment_id": 81584244, "body": "Interesting\u2026does that mean that the code you showed on SO wasn&#39;t the code you ran on your machine? At all times, the code here showed the <code>fscanf()</code> using <code>%d</code>. Oh well, please be careful next time! And please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1510767038, "creation_date": 1510767038, "answer_id": 47313806, "question_id": 47312529, "link": "https://stackoverflow.com/questions/47312529/passing-an-array-to-a-function-thats-been-scanned/47313806#47313806", "title": "Passing an array to a function that&#39;s been scanned", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint display(int a[21]);\n\nint main(){\n    int i;\n    int a[21];\n    FILE*fpointer;\n    fpointer=fopen(\"data.txt\",\"r\");\n    if (fpointer==NULL){\n        printf(\"\\nFile could not be found.\");\n        exit(1);}\n\n    else{\n        for (i=0;i&lt;21;i++){\n        fscanf(fpointer, \"%d\",&amp;a[i]);}  \n\n        fclose(fpointer);}\n        display(a);\nreturn 0;\n}\nint display(int a[21]){\n    int i;\n    for (i=0;i&lt;21;i++){\n      printf(\"%d\\n\",a[i]);}\nreturn 0;\n}\n</code></pre>\n\n<p>Results are now displayed. I was scanning a %f rather than a %d, also the display(a) in the main function rather than display(int a[])</p>\n"}], "owner": {"reputation": 1, "user_id": 8946404, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210795961275826/picture?type=large", "display_name": "Christian", "link": "https://stackoverflow.com/users/8946404/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510768185, "creation_date": 1510763174, "last_edit_date": 1510768185, "question_id": 47312529, "link": "https://stackoverflow.com/questions/47312529/passing-an-array-to-a-function-thats-been-scanned", "title": "Passing an array to a function that&#39;s been scanned", "body": "<p>I'm struggling with sending array data that's been previously scanned to a function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint display(int a[21]);\n\nint main(){\n    int i;\n    int a[21];\n    FILE*fpointer;\n    fpointer=fopen(\"data.txt\",\"r\");\n    if (fpointer==NULL){\n        printf(\"\\nFile could not be found.\");\n        exit(1);\n    }\n    else{\n        for (i=0;i&lt;21;i++){\n            fscanf(fpointer, \"%d\",&amp;a[i]);   \n        }\n        fclose(fpointer);\n    }\n    display(int a[21]);\n    return 0;\n}\n\nint display(int a[21]){\n    int i;\n    for (i=0;i&lt;21;i++){\n        printf(\"%d\\n\",a[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I want to use the display() function to display each value from data.txt. I am able to fscanf every into the array, I just can't seem the send the array to the function.</p>\n\n<p>data.txt:</p>\n\n<pre><code>1\n6\n4\n7\n3\n4\n12\n14\n15\n-17\n-19\n21\n-23\n0\n37\n0\n-31\n32\n34\n-37\n-39\n</code></pre>\n\n<p>Output values:</p>\n\n<pre><code>1065353216\n1086324736\n1082130432\n1088421888\n1077936128\n1082130432\n1094713344\n1096810496\n1097859072\n-1048051712\n-1047003136\n1101529088\n-1044905984\n0\n1108606976\n0\n-1040711680\n1107296256\n1107820544\n-1038876672\n-1038352384\n</code></pre>\n"}, {"tags": ["c", "client", "protocols", "sctp"], "answers": [{"tags": [], "owner": {"reputation": 195, "user_id": 6677813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jv095.png?s=128&g=1", "display_name": "Alexander Zinovyev", "link": "https://stackoverflow.com/users/6677813/alexander-zinovyev"}, "is_accepted": true, "score": 0, "last_activity_date": 1510784357, "creation_date": 1510784357, "answer_id": 47318285, "question_id": 47312506, "link": "https://stackoverflow.com/questions/47312506/how-can-you-retrieve-rto-mtu-and-srtt-information-from-a-sctp-message/47318285#47318285", "title": "How can you retrieve (RTO-, MTU- and SRTT-) information from a SCTP message?", "body": "<p>RTO, MTU and SRTT are not part of SCTP messages. Endpoints do not exchange this information. Each side calculates its own SRTT and RTO and has it is own MTU.</p>\n\n<p>From your endpoint you cannot obtain information about SRTT, RTO and MTU another side has.</p>\n\n<p>SRTT, RTO and MTU values of your side for the peer can be found in <a href=\"http://elixir.free-electrons.com/linux/v4.9/source/include/uapi/linux/sctp.h#L947\" rel=\"nofollow noreferrer\">sctp_info structure</a>.</p>\n\n<p>You can obtain this structure with following API call:\n<code>\nint sctp_get_sctp_info(struct sock *sk, struct sctp_association *asoc,\n                       struct sctp_info *info);\n</code>\nSee definition of sctp_get_sctp_info at <a href=\"http://elixir.free-electrons.com/linux/v4.9/source/include/net/sctp/sctp.h#L133\" rel=\"nofollow noreferrer\">sctp.h</a> </p>\n"}], "owner": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 47318285, "answer_count": 1, "score": 0, "last_activity_date": 1510784357, "creation_date": 1510763105, "question_id": 47312506, "link": "https://stackoverflow.com/questions/47312506/how-can-you-retrieve-rto-mtu-and-srtt-information-from-a-sctp-message", "title": "How can you retrieve (RTO-, MTU- and SRTT-) information from a SCTP message?", "body": "<p>How can you retrieve furhter information (like RTO, MTU and SRTT) from a <code>struct sctp_rcvinfo</code> of a received SCTP message?</p>\n\n<p>Everytime a SCTP-message is reveived and processed via a callback function like</p>\n\n<p><code>static int\nreceive_cb(struct socket *sock, union sctp_sockstore addr, void *data,\n           size_t datalen, struct sctp_rcvinfo rcv, int flags, void *ulp_info)\n{...</code></p>\n\n<p><code>struct sctp_rcvinfo</code> is filled with these additional information (I suppose).</p>\n\n<p>You can find an <a href=\"https://github.com/sctplab/usrsctp/blob/master/programs/client.c\" rel=\"nofollow noreferrer\">example-client here</a>.</p>\n\n<p>But I need to <em>convert</em> this to data like </p>\n\n<p><code>struct sctp_paddrinfo moreInfo; moreInfo.spinfo_rto</code> .. and so on. </p>\n\n<p>How can you achive this?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 7928, "user_id": 592958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVNmU.jpg?s=128&g=1", "display_name": "phuzi", "link": "https://stackoverflow.com/users/592958/phuzi"}, "edited": false, "score": 0, "creation_date": 1510832225, "post_id": 47312043, "comment_id": 81607887, "body": "Formatted code for easier reading"}], "answers": [{"tags": [], "owner": {"reputation": 800, "user_id": 8208981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9eeb707bfd44f3aac336e6da2a2954b7?s=128&d=identicon&r=PG&f=1", "display_name": "vonaka", "link": "https://stackoverflow.com/users/8208981/vonaka"}, "is_accepted": true, "score": 1, "last_activity_date": 1510768855, "last_edit_date": 1510768855, "creation_date": 1510765778, "answer_id": 47313399, "question_id": 47312043, "link": "https://stackoverflow.com/questions/47312043/var-condition-threads-in-a-specific-order/47313399#47313399", "title": "Var condition threads in a specific order", "body": "<p>If your order is <code>1 3 1 2 1 3 ...</code> and you really want to use threads then you need three condition variables - one for each thread and each time we will signal to next desirable thread.</p>\n\n<p>This is the basic code for thread <code>N</code>:</p>\n\n<pre><code>pthread_mutex_lock(m);\nwhile(!awakenedN)\n    pthread_cond_wait(condN, m);\nprintf(\"thread N\"); //Nth thread's work\npthread_cond_signal(...); //awaken next thread\nawakened... = 1;\nawakenedN = 0;\npthread_mutex_unlock(m);\n</code></pre>\n\n<p>So all you need is to choose what does <code>...</code> stands for and the choice is pretty obvious:</p>\n\n<pre><code>int awakened1 = 1, awakened2 = 0, awakened3 = 0;\nint turn = 1;\n\n// thread 1\npthread_mutex_lock(m);\nwhile(!awakened1)\n    pthread_cond_wait(cond1, m);\nprintf(\"thread 1\");\n// after first thread we can call second or third:\nswitch(turn) {\n    case 1:\n        turn = 2;\n        awakened3 = 1;\n        pthread_cond_signal(cond3);\n        break;\n    case 2:\n        turn = 1;\n        awakened2 = 1;\n        pthread_cond_signal(cond2);\n        break;\n}\nawakened1 = 0;\npthread_mutex_unlock(m);\n\n// thread 2\npthread_mutex_lock(m);\nwhile(!awakened2)\n    pthread_cond_wait(cond2, m);\nprintf(\"thread 2\");\nawakened1 = 1;\nawakened2 = 0;\npthread_cond_signal(cond1);\npthread_mutex_unlock(m);\n\n// thread 3\npthread_mutex_lock(m);\nwhile(!awakened3)\n    pthread_cond_wait(cond3, m);\nprintf(\"thread 3\");\nawakened1 = 1;\nawakened3 = 0;\npthread_cond_signal(cond1);\npthread_mutex_unlock(m);\n</code></pre>\n\n<p>After that you can easily generalize this for <code>N</code> (number of threads) greater than 3.</p>\n"}], "owner": {"reputation": 70, "user_id": 7621702, "user_type": "registered", "profile_image": "https://graph.facebook.com/1314078941943347/picture?type=large", "display_name": "Andres Mejia", "link": "https://stackoverflow.com/users/7621702/andres-mejia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 47313399, "answer_count": 1, "score": 0, "last_activity_date": 1510832225, "creation_date": 1510761788, "last_edit_date": 1510832225, "question_id": 47312043, "link": "https://stackoverflow.com/questions/47312043/var-condition-threads-in-a-specific-order", "title": "Var condition threads in a specific order", "body": "<p>How can I show the threads in a specific order?\nI need to print with condition variables the following order of execution, but I do not understand how I can do it.</p>\n\n<p>is order I  need print</p>\n\n<p>1\n3\n1\n2\n1</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\nstruct DatoHilo{int dato;};\nvoid * funhilos(void *);\nint turno = 0;\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t  cond  = PTHREAD_COND_INITIALIZER;\n\nint main(){\n    clock_t t_ini, t_fin;\n    double secs;\n    int nhilos = 0, i=0;\n    pthread_t *pidhilos = NULL;\n    struct DatoHilo *datohilo;  \n    printf(\"Numero de hilos\\n\");\n    scanf(\"%d\", &amp;nhilos);       \n    //creacion de hilos\n    pidhilos = (pthread_t *) calloc(nhilos, sizeof(pthread_t));\n    for(i=0; i&lt;nhilos; i++){    \n        datohilo = (struct DatoHilo*)malloc(sizeof(struct DatoHilo));\n        datohilo-&gt;dato = i;\n        pthread_create(&amp;pidhilos[i], NULL, funhilos, (void*)datohilo);\n    }\n    t_ini = clock();\n    for(i=0; i&lt;nhilos; i++)\n        pthread_join(pidhilos[i], NULL);\n    t_fin = clock();\n    secs = (double)(t_fin - t_ini) / CLOCKS_PER_SEC;\n    printf(\"%.16g milisegundos\\n\", secs * 1000.0); \n\n    free(pidhilos);\n    return 0;\n}\n\nvoid * funhilos( void *arg){\n    int myturno = ((struct DatoHilo *)arg)-&gt;dato;\n\n    pthread_mutex_lock(&amp;mutex);\n    while(turno != myturno) pthread_cond_wait(&amp;cond, &amp;mutex);\n    printf(\"Hilo turno %d\\t[%u]\\n\", myturno, (unsigned int)pthread_self());\n    turno ++;\n    pthread_cond_broadcast(&amp;cond);\n    pthread_mutex_unlock(&amp;mutex);    \n    free(arg);\n    pthread_exit(0);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1510761961, "post_id": 47311945, "comment_id": 81574905, "body": "<i>After reading i found that kernel knows only my process and it will be unaware of threads(posix library will take care).</i> Where did you read that?  That <i>may</i> be true of some implementation, but as a general statement, it&#39;s somewhere between badly outdated and completely wrong."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510762146, "post_id": 47311945, "comment_id": 81575048, "body": "Whereas it is <i>conceivable</i> that the pthreads API could be implemented purely in userspace, so that different threads indeed cannot be scheduled on different cores at the same time, that&#39;s not how Glibc&#39;s implementation on Linux actually works."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510762299, "post_id": 47311945, "comment_id": 81575159, "body": "You may have been confused by the fact that Linux does not make a strong distinction between processes and threads, but that&#39;s not at all the same thing as the kernel being unaware of your threads for scheduling purposes."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1510773734, "post_id": 47311945, "comment_id": 81582119, "body": "The scheduler prefers to run threads on the same core because then they use the same cache.  That gives better performance."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1510823318, "post_id": 47311945, "comment_id": 81601692, "body": "It does, so I don&#39;t fully understand your question."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4998777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b6d320cd2d47585a19f3185ee0b9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Balaganesh", "link": "https://stackoverflow.com/users/4998777/balaganesh"}, "edited": false, "score": 0, "creation_date": 1511061153, "post_id": 47317453, "comment_id": 81699236, "body": "Thanks for the info . We can refer the below link also <a href=\"http://marc.merlins.org/linux/linux.conf.au_2001/Day1/threads.pdf\" rel=\"nofollow noreferrer\">marc.merlins.org/linux/linux.conf.au_2001/Day1/threads.pdf</a>."}, {"owner": {"reputation": 69, "user_id": 4998777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b6d320cd2d47585a19f3185ee0b9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Balaganesh", "link": "https://stackoverflow.com/users/4998777/balaganesh"}, "edited": false, "score": 0, "creation_date": 1511061231, "post_id": 47317453, "comment_id": 81699251, "body": "Seems Linux is not perfectly POSIX compliant as it treats Threads as LWP.(1:1 model) to support SMP systems."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1510780856, "creation_date": 1510780856, "answer_id": 47317453, "question_id": 47311945, "link": "https://stackoverflow.com/questions/47311945/posix-threads-on-smp-system/47317453#47317453", "title": "Posix threads on smp system", "body": "<p>Historically, there have been quite a few libraries which implemented POSIX-threads-like functionality.  LinuxThreads came with glibc, but had severe conformance issues due to limitations of earlier kernels (such as a thread-specific current directory and umask).  It could actually run multiple threads in the same process on different CPUs at the same time (people didn't speak of cores back then).  FSU Threads had better POSIX conformance (even in the area of PI scheduling, if I recall correctly), but was restricted to one CPU per process.  Many thread libraries also experimented with an n:m scheme, where a larger number of user space threads was executed on a small number of kernel-scheduled threads (which could run in parallel on different CPUs).</p>\n\n<p>For Linux and C/C++, this pretty much stopped when NPTL was added to glibc and more and more tightly integrated with the rest of the library.  NPTL has a 1:1 model: each user space thread is visible to the kernel and can run in parallel, as long sufficient hardware resources are available.</p>\n"}], "owner": {"reputation": 69, "user_id": 4998777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b6d320cd2d47585a19f3185ee0b9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Balaganesh", "link": "https://stackoverflow.com/users/4998777/balaganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510780856, "creation_date": 1510761520, "question_id": 47311945, "link": "https://stackoverflow.com/questions/47311945/posix-threads-on-smp-system", "title": "Posix threads on smp system", "body": "<p>I have developed a C app in linux sytem with 12 posix threads in it.It is a multicore system.\nAfter reading i found that kernel knows only my process and it will be unaware of threads(posix library will take care).\nIn this case does my 12 threads will be using only onecore in which the process is sceduled or my threads can run in all available cores ?\nDoes Posix library can schedule threads to other cores ?</p>\n"}, {"tags": ["c", "serial-port", "baud-rate"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1510760800, "post_id": 47311500, "comment_id": 81573982, "body": "Not quite sure but to what number should eg. B300 be converted? To 300?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1510760815, "post_id": 47311500, "comment_id": 81573998, "body": "The switch-case-structure seems like a good solution... maybe encapsuled in a conversion function <code>speed_t baudrate(int br) { ... }</code>, then your code looks quite elegant with <code>cfsetispeed(term, baudrate(19200));</code> or similar...."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1510761449, "post_id": 47311500, "comment_id": 81574504, "body": "const lookup table?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510761550, "post_id": 47311500, "comment_id": 81574592, "body": "Those BXXX things should really have been an enum."}, {"owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1510763947, "post_id": 47311500, "comment_id": 81576318, "body": "@MichaelWalz I&#39;m asking about int-&gt;size_t, not the opposite."}, {"owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510764024, "post_id": 47311500, "comment_id": 81576371, "body": "@MartinJames Lookup table doesn&#39;t make sense because most of the array elements would be blank: lookup[50] = B50, etc."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1510764396, "post_id": 47311500, "comment_id": 81576618, "body": "@Sparkler ok, then please <a href=\"https://stackoverflow.com/posts/47311500/edit\">edit</a> your question and show some examples of what should be converted to what."}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 0, "creation_date": 1510829780, "post_id": 47313155, "comment_id": 81606303, "body": "I would indeed prefer a switch/case here, the compiler can optimize that better."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 0, "creation_date": 1510829884, "post_id": 47313155, "comment_id": 81606374, "body": "@Karim probably true, but there is probably no need to optimize this unless <code>convertbaudrate</code> is called a lot of times which is most likely not the case."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 0, "creation_date": 1510830159, "post_id": 47313155, "comment_id": 81606557, "body": "@Karim beware of premature optimization."}, {"owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 3, "creation_date": 1510830304, "post_id": 47313155, "comment_id": 81606668, "body": "Now this comment isn&#39;t fair here, keeping it simple with a switch/case statement and letting the compiler do the optimization is the exact opposite of premature optimization."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 0, "creation_date": 1510830392, "post_id": 47313155, "comment_id": 81606717, "body": "@Karim not quite sure you understood my point, google &quot;premature optimization&quot;"}, {"owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 4, "creation_date": 1510830612, "post_id": 47313155, "comment_id": 81606875, "body": "Ok, I did: <code>&quot;Premature optimization&quot; is a phrase used to describe a situation where a programmer lets performance considerations affect the design of a piece of code. This can result in a design that is not as clean as it could have been or code that is incorrect, because the code is complicated by the optimization and the programmer is distracted by optimizing.</code> Now, what did I understand wrong? I suggested to leave the code clean and simple and give the compiler the opportunity to optimize, this is exactly the opposite from premature optimization"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 3, "last_activity_date": 1510765044, "creation_date": 1510765044, "answer_id": 47313155, "question_id": 47311500, "link": "https://stackoverflow.com/questions/47311500/how-to-efficiently-convert-baudrate-from-int-to-speed-t/47313155#47313155", "title": "How to efficiently convert baudrate from int to speed_t?", "body": "<p>You need a lookup table, but not a naive one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;    \n#include &lt;termios.h&gt;       \n\nstruct\n{\n  int rawrate;\n  int termiosrate;\n} conversiontable[] =\n{\n  {0, B0},\n  {50, B50},\n  {75, B75},\n  // you need to complete the table with B110 to B38400\n};\n\nint convertbaudrate(int rawrate)\n{\n  for (int i = 0; i &lt; sizeof(conversiontable) / sizeof(conversiontable[0]); i++)\n  {\n    if (conversiontable[i].rawrate == rawrate)\n    {\n      return conversiontable[i].termiosrate;\n    }\n  }\n\n  return -1;    // invalid baud rate\n}\n\nint main()\n{\n  printf(\"%d -&gt; %d\\n\", 50, convertbaudrate(50));\n  printf(\"%d -&gt; %d\\n\", 75, convertbaudrate(75));\n}\n</code></pre>\n\n<p>That should autoexplain. If not, please comment.</p>\n"}, {"comments": [{"owner": {"reputation": 2209, "user_id": 883572, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2df953841a456c642ce0d2a66b8cb919?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/883572/danny"}, "edited": false, "score": 0, "creation_date": 1600911585, "post_id": 49711070, "comment_id": 113241032, "body": "Careful that <code>speed_t</code> in linux is unsigned so returning -1 might not be what you want.  See <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/bits/termios.h.html\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/bits/&zwnj;&#8203;&hellip;</a>"}], "tags": [], "owner": {"reputation": 3080, "user_id": 961720, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a178e1b40f467e9de8d3d3ae1a85b4b0?s=128&d=identicon&r=PG", "display_name": "Noel", "link": "https://stackoverflow.com/users/961720/noel"}, "is_accepted": false, "score": 5, "last_activity_date": 1523128580, "creation_date": 1523128580, "answer_id": 49711070, "question_id": 47311500, "link": "https://stackoverflow.com/questions/47311500/how-to-efficiently-convert-baudrate-from-int-to-speed-t/49711070#49711070", "title": "How to efficiently convert baudrate from int to speed_t?", "body": "<p>I came across needing this. Pasting the switch case statement here for you to copy.</p>\n\n<pre><code>int get_baud(int baud)\n{\n    switch (baud) {\n    case 9600:\n        return B9600;\n    case 19200:\n        return B19200;\n    case 38400:\n        return B38400;\n    case 57600:\n        return B57600;\n    case 115200:\n        return B115200;\n    case 230400:\n        return B230400;\n    case 460800:\n        return B460800;\n    case 500000:\n        return B500000;\n    case 576000:\n        return B576000;\n    case 921600:\n        return B921600;\n    case 1000000:\n        return B1000000;\n    case 1152000:\n        return B1152000;\n    case 1500000:\n        return B1500000;\n    case 2000000:\n        return B2000000;\n    case 2500000:\n        return B2500000;\n    case 3000000:\n        return B3000000;\n    case 3500000:\n        return B3500000;\n    case 4000000:\n        return B4000000;\n    default: \n        return -1;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3026, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1523128580, "creation_date": 1510760383, "last_edit_date": 1510765261, "question_id": 47311500, "link": "https://stackoverflow.com/questions/47311500/how-to-efficiently-convert-baudrate-from-int-to-speed-t", "title": "How to efficiently convert baudrate from int to speed_t?", "body": "<p>The functions <code>cfsetospeed</code> and <code>cfsetispeed</code> <a href=\"https://linux.die.net/man/3/cfsetospeed\" rel=\"nofollow noreferrer\">take baud rate as type <code>speed_t</code></a>:</p>\n\n<pre><code>int cfsetispeed(struct termios *termios_p, speed_t speed);\nint cfsetospeed(struct termios *termios_p, speed_t speed);\n</code></pre>\n\n<p>The type <code>speed_t</code> is basically an integer, but casting is not a solution, as can be seen from the baudrate definitions in <a href=\"http://www.delorie.com/djgpp/doc/incs/termios.h\" rel=\"nofollow noreferrer\"><code>termios.h</code></a>:</p>\n\n<pre><code>#define B0  0x00000000\n#define B50 0x00000001\n#define B75 0x00000002\n// ...\n#define B9600   0x0000000d\n#define B19200  0x0000000e\n#define B38400  0x0000000f\n</code></pre>\n\n<p>When I process user input (e.g. from file), I convert a string such as \"9600\" to integer 9600, and then to B9600. I'm basically looking for a generic way to convert the following:</p>\n\n<pre><code>// 0 -&gt; B0\n// 50 -&gt; B50\n// 75 -&gt; B75\n// ...\n// 9600 -&gt; B9600 \n// 19200 -&gt; B19200\n// 38400 -&gt; B38400\n</code></pre>\n\n<p><a href=\"https://www.teuniz.net/RS-232/\" rel=\"nofollow noreferrer\">One way</a> to convert from <code>int</code> (such as 9600) to <code>speed_t</code> (such as B9600) is a switch-case structure. Is there a better way to achieve this?</p>\n"}, {"tags": ["python", "c", "struct", "ctypes", "mpfr"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510760301, "post_id": 47311220, "comment_id": 81573584, "body": "Do you <i>need</i> the types <code>mpq</code> or <code>mprf</code>?! if they&#39;re <i>opaque</i> types, then know that <i>any</i> pointer to struct would do there - all struct pointers are guaranteed to have the same presentation. If not, then you <i>need</i> to create the definition for <code>mpq</code> and <code>mpfr</code> naturally."}, {"owner": {"reputation": 318, "user_id": 3687776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0ab5956270f8e930019810e50f72766?s=128&d=identicon&r=PG&f=1", "display_name": "Jovan Andonov", "link": "https://stackoverflow.com/users/3687776/jovan-andonov"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510859868, "post_id": 47311220, "comment_id": 81626929, "body": "@AnttiHaapala I need them both. And I am also interested about the general case... Is there a way to load some types from a c shared library, use them as such in python and then pass them to a c function that is loaded from a different c shared library?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510866518, "post_id": 47311220, "comment_id": 81630345, "body": "The shared library <i>doesn&#39;t</i> have the types; only the header file (i.e. <code>mpfr.h</code>) has them"}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 3687776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0ab5956270f8e930019810e50f72766?s=128&d=identicon&r=PG&f=1", "display_name": "Jovan Andonov", "link": "https://stackoverflow.com/users/3687776/jovan-andonov"}, "is_accepted": true, "score": 0, "last_activity_date": 1512074544, "creation_date": 1512074544, "answer_id": 47582260, "question_id": 47311220, "link": "https://stackoverflow.com/questions/47311220/how-can-i-create-a-corresponding-struct-containing-mpfr-h-types-using-ctypes-in/47582260#47582260", "title": "How can I create a corresponding struct containing mpfr.h types using ctypes in python?", "body": "<p>I solved this by tracking all the typedefs in the mpfr.h and gmp.h files and creating all necessary structs in python as:</p>\n\n<pre><code>class Mpz(Structure):\n     # define struct manually\n\nclass Mpq(Structure):\n     # define struct manually\n\nclass Mpfr(Structure):\n     # define struct manually\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 3687776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0ab5956270f8e930019810e50f72766?s=128&d=identicon&r=PG&f=1", "display_name": "Jovan Andonov", "link": "https://stackoverflow.com/users/3687776/jovan-andonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 47582260, "answer_count": 1, "score": 0, "last_activity_date": 1512074544, "creation_date": 1510759605, "question_id": 47311220, "link": "https://stackoverflow.com/questions/47311220/how-can-i-create-a-corresponding-struct-containing-mpfr-h-types-using-ctypes-in", "title": "How can I create a corresponding struct containing mpfr.h types using ctypes in python?", "body": "<p>I have a C API with functions that work on the following C struct:</p>\n\n<pre><code>typedef struct s_t{\n    mpq_ptr mpq;\n    mpfr_ptr mpfr;\n} s_t;\n</code></pre>\n\n<p>I am building a python wrapper for this C API, so I need to define this struct as a class that inherits from the 'Structure' class in ctypes and then give value to _field_. However mpq_ptr, mpfr_ptr are types from mpfr.h and there are no corresponding ctypes types for them. Is there a way to solve this problem?</p>\n\n<p>What I want to obtain in python is something like:</p>\n\n<pre><code>class S_t(Structure):\n    _fields_ = [('mpq', CTYPEFOR(mpq_ptr)),('mpfr', CTYPEFOR(mpfr_ptr))]\n</code></pre>\n\n<p>So that I can create such objects in python and pass them to the corresponding C functions that take s_t as an input argument. </p>\n"}, {"tags": ["c", "file", "io", "binary"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1510758749, "post_id": 47310831, "comment_id": 81572299, "body": "Is this book old? There is no need to cast to <code>void *</code>, every pointer in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> is convertible from <code>void *</code> and back without casting"}, {"owner": {"reputation": 722, "user_id": 8809003, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/951122398362512/picture?type=large", "display_name": "Abdul Ahad", "link": "https://stackoverflow.com/users/8809003/abdul-ahad"}, "edited": false, "score": 0, "creation_date": 1510759009, "post_id": 47310831, "comment_id": 81572505, "body": "uint64_t buf[20] would need to read more void*, but you can do file io with anything really"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1510758984, "post_id": 47310946, "comment_id": 81572487, "body": "IMHO it&#39;s bad style to have redundant pointer casts. Converting to/from <code>void *</code> is implicit for good reasons..."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1510759140, "post_id": 47310946, "comment_id": 81572606, "body": "@FelixPalmen I Don&#39;t know. I see it a lot. A function expects <code>int*</code> but instead is provided a <code>unsigned int*</code>. The fix I see many times for this is <code>(void*)</code>. About bad style - totally agree. I don&#39;t write such code"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1510759829, "post_id": 47310946, "comment_id": 81573194, "body": "The only &quot;good&quot; reason for a pointer to pointer cast is bad design."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1510760081, "post_id": 47310946, "comment_id": 81573394, "body": "Indeed. But sadly not all of us write code top to bottom. Upon seeing such a problem that stems from bad design - this is a simple fix"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1510820769, "post_id": 47310946, "comment_id": 81600107, "body": "@JensGustedt Or printing a pointer (more general, passing a generic pointer to a variadic function). Or aliasing with <code>char *</code> to examine the representation. But I  agree you should avoid pointer casts because anywhere you need them is a place in the code that needs extra care not to violate strict aliasing etc. -- that&#39;s my primary argument against <a href=\"https://stackoverflow.com/q/605845/2371524\">casting the <code>malloc()</code> result</a>."}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 0, "last_activity_date": 1510759236, "last_edit_date": 1510759236, "creation_date": 1510758867, "answer_id": 47310946, "question_id": 47310831, "link": "https://stackoverflow.com/questions/47310831/in-c-language-binary-file-io/47310946#47310946", "title": "In C language binary file io", "body": "<p>The cast to <code>void*</code> is because this is what the functions expect. See <a href=\"http://www.cplusplus.com/reference/cstdio/fread/\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.cplusplus.com/reference/cstdio/fwrite/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Your code will compile without this cast, because cast to <code>void*</code> is not necessary (see quote below), but I guess the author wanted to be exact as possible.</p>\n\n<p><strong>6.3.2.3 Pointers</strong></p>\n\n<blockquote>\n  <p>1 A pointer to void may be converted to or from a pointer to any incomplete or object type. A pointer to any incomplete or object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer.</p>\n</blockquote>\n\n<p>Another thing - <code>(void*)</code> is a good way to suppress compiler warnings. It may not be a good thing to begin with (warning are there for a reason), but if need be, this is a simple way to ignore wrong pointer type in function arguments. </p>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1510758920, "creation_date": 1510758920, "answer_id": 47310967, "question_id": 47310831, "link": "https://stackoverflow.com/questions/47310831/in-c-language-binary-file-io/47310967#47310967", "title": "In C language binary file io", "body": "<p>This is so that you can pass any pointer type. So for example, if you want to write a structure like for example</p>\n\n<pre><code>struct point {\n    int x;\n    int y;\n};\n\nstruct point my_point = {1, 2};\nFILE *file = fopen(\"sample-file.bin\", \"w\");\nif (file != NULL) {\n    // Normally check that this returns the number of\n    // written items\n    fwrite(&amp;my_point, 1, sizeof(my_point), file);\n    fclose(file);\n}\n</code></pre>\n\n<p>would work, and when you open the file for reading you can <code>fread(&amp;my_point ...)</code> too.</p>\n\n<p>Note that casting to <code>void *</code> is not necessary in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>, nor is it needed to cast from <code>void *</code> to another pointer type, for instance</p>\n\n<pre><code>char *example = malloc(size + 1);\n</code></pre>\n\n<p>is perfectly valid and <code>malloc()</code> returns <code>void *</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1510758939, "creation_date": 1510758939, "answer_id": 47310974, "question_id": 47310831, "link": "https://stackoverflow.com/questions/47310831/in-c-language-binary-file-io/47310974#47310974", "title": "In C language binary file io", "body": "<p>Because <code>fread()</code> &amp; <code>fwrite()</code> are <strong>generic function</strong> for reading and writing binary data into file <code>irrespective</code> of their <code>data type</code>.</p>\n\n<p>man page of fwrite() says,</p>\n\n<pre><code>size_t fwrite(const void *ptr, size_t size, size_t nmemb,\n                     FILE *stream);\n</code></pre>\n\n<p>what is first arguement, its <code>const void *ptr</code> means its expecting address. it can be any variable address int or char or any other data type . </p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 8946374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2511d19087624da1a83e6a7997d681?s=128&d=identicon&r=PG&f=1", "display_name": "mattc", "link": "https://stackoverflow.com/users/8946374/mattc"}, "is_accepted": false, "score": 0, "last_activity_date": 1510762292, "creation_date": 1510762292, "answer_id": 47312220, "question_id": 47310831, "link": "https://stackoverflow.com/questions/47310831/in-c-language-binary-file-io/47312220#47312220", "title": "In C language binary file io", "body": "<p>This should probably be a comment but i don't have the reputation for that. In your code:</p>\n\n<blockquote>\n  <p><code>if (src == NULL || des == NULL) {\n      puts(\"File open failed\");\n      return -1;\n  }</code></p>\n</blockquote>\n\n<p>There is a chance that either src or des may have been opened correctly and therefore should have <code>fclose();</code> called for it.</p>\n\n<p>Something like: </p>\n\n<pre><code>if (src == NULL || des == NULL) \n{\n      if(src)\n      {\n        fclose(src);\n      }\n      if(des)\n      {\n        fclose(des);\n      }\n      puts(\"File open failed\");\n      return -1;\n  }\n</code></pre>\n\n<p>would be better.</p>\n"}], "owner": {"reputation": 1, "user_id": 7529357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086f7a4912cccda20f11b327ec4b89d6?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7529357/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1510762292, "creation_date": 1510758543, "question_id": 47310831, "link": "https://stackoverflow.com/questions/47310831/in-c-language-binary-file-io", "title": "In C language binary file io", "body": "<p>if I input a binary file to array buf, why do I have to input it by (void*) ??\nand why do I have to write it by (void*)?? please observe this code and please explain this code to me. (I just copy this code from my book)</p>\n\n<pre><code>int main(void) {\nFILE * src = fopen(\"a.png\", \"rb\");\nFILE * des = fopen(\"b.png\", \"wb\");\n\nchar buf[20];\nint readCnt;\n\nif (src == NULL || des == NULL) {\n    puts(\"File open failed\");\n    return -1;\n}\n\nwhile (1) {\n    readCnt = fread((void*)buf, 1, sizeof(buf), src);\n\n    if (readCnt &lt; sizeof(buf)) {\n        if (feof(src) != 0) {\n            fwrite((void*)buf, 1, readCnt, des);\n            puts(\"File copy complete\");\n            break;\n        }\n        else\n            puts(\"File copy Failed\");\n\n        break;\n    }\n    fwrite((void*)buf, 1, sizeof(buf), des);\n}\nfclose(src);\nfclose(des);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1510757805, "post_id": 47310546, "comment_id": 81571593, "body": "Because <code>struct anything_at_all</code> is an incomplete type. <code>anything_at_all_2</code> is not."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1510757826, "post_id": 47310546, "comment_id": 81571607, "body": "The compiler cannot confirm what type of identifier (value or type and if it&#39;s a type then what kind of type) <code>anything_at_all_2</code> is, whereas for <code>struct anything_at_all</code>  it&#39;s pretty clear."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": -1, "last_activity_date": 1510757821, "creation_date": 1510757821, "answer_id": 47310585, "question_id": 47310546, "link": "https://stackoverflow.com/questions/47310546/why-does-typedef-struct-anything-at-all-boom-compile-without-errors/47310585#47310585", "title": "Why does &quot;typedef struct anything_at_all boom;&quot; compile without errors?", "body": "<p>You can declare a <code>struct</code> without defining it.  This is called a <strong>forward declaration</strong>.  It allows you to do things like this:</p>\n\n<pre><code>struct s1;\n\nstruct s2 {\n    int x;\n    struct s1 *p;\n};\n\nstruct s1 {\n    int y;\n    struct s2 *p;\n};\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 5746496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ced699056b37c0dc8e03cf9c1fbae?s=128&d=identicon&r=PG&f=1", "display_name": "ccoder987", "link": "https://stackoverflow.com/users/5746496/ccoder987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1510757789, "accepted_answer_id": 47310585, "answer_count": 1, "score": 0, "last_activity_date": 1510757821, "creation_date": 1510757710, "question_id": 47310546, "link": "https://stackoverflow.com/questions/47310546/why-does-typedef-struct-anything-at-all-boom-compile-without-errors", "closed_reason": "Duplicate", "title": "Why does &quot;typedef struct anything_at_all boom;&quot; compile without errors?", "body": "<p>Why does</p>\n\n<pre><code>//The type anything_at_all exists nowhere.\ntypedef struct anything_at_all lol;\n</code></pre>\n\n<p>compile without errors, whereas</p>\n\n<pre><code>//The type anything_at_all_2 exists nowhere.\ntypedef anything_at_all_2 rofl;\n</code></pre>\n\n<p>produces errors?</p>\n\n<p>What's so special about structs? In a way I'm glad it works like this because it allows us to create opaque structs. But it would be nice to understand <em>why</em> it works.</p>\n"}, {"tags": ["c", "compiler-errors", "constants"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1510756692, "post_id": 47309966, "comment_id": 81570682, "body": "Note that this wouldn&#39;t be a problem if you initialized it inside a function instead (from C99 onwards)."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1510760403, "post_id": 47309991, "comment_id": 81573669, "body": "enlightenment, anyone?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": -1, "last_activity_date": 1510756421, "last_edit_date": 1510756421, "creation_date": 1510756100, "answer_id": 47309991, "question_id": 47309966, "link": "https://stackoverflow.com/questions/47309966/c-initializer-element-is-not-constant/47309991#47309991", "title": "C initializer element is not constant", "body": "<p>In <code>C</code>, using a <code>const</code> modifier does not produce a compile-time constant value.</p>\n\n<p>Then, as per the rules of initialization, <code>C11</code>, chapter \u00a76.7.9</p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has static or thread storage duration\n  shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>you'll be needing a constant-expression (compile time constat).</p>\n\n<p>You may use a <code>#define</code> MACRO instead to get the result you want. Something like (warning: Code not tested)</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n\ntypedef struct {\n    const int x;\n    const int y;\n} my_struct;\n\n//const int a = 8;\n//const int b = 12;\n\n#define a 8                  //use preprocessor MACROs\n#define b 12                 //use preprocessor MACROs\n\nmy_struct test = { a, b };\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1510758990, "last_edit_date": 1510758990, "creation_date": 1510756221, "answer_id": 47310034, "question_id": 47309966, "link": "https://stackoverflow.com/questions/47309966/c-initializer-element-is-not-constant/47310034#47310034", "title": "C initializer element is not constant", "body": "<p>Besides <a href=\"https://stackoverflow.com/a/47309991/2932052\">macros</a> (which have their <a href=\"https://stackoverflow.com/questions/1944041/advantage-and-disadvantages-of-define-vs-constants?noredirect=1&amp;lq=1#comment1854616_1944041\">downsides</a>), unnamed enumerations are often used for the purpose to just provide compile-time constants. This would change your code like this.</p>\n\n<pre><code>typedef struct {\n    const int x;\n    const int y;\n} my_struct;\n\nenum {\n    a = 8,\n    b = 12, \n};\n\nmy_struct test = { a, b };\n</code></pre>\n\n<p>... also expressions involving compile-time constants can be compile-time constants themselves ...</p>\n\n<pre><code>my_struct test1 = { a+1, b };\nmy_struct test2 = { a, 'H' };\n</code></pre>\n\n<p>Also the <code>sizeof</code> operator can produce compile-time constants:</p>\n\n<pre><code>my_struct test3 = { sizeof(my_struct), b };\n</code></pre>\n\n<p>Even if this example looks not very useful, <a href=\"https://ideone.com/yEt0yv\" rel=\"nofollow noreferrer\">it compiles</a>.</p>\n\n<p>For learning what exactly constant expressions are, see for example <a href=\"http://en.cppreference.com/w/c/language/constant_expression\" rel=\"nofollow noreferrer\">Constant expressions</a> - despite the URL (<code>cppreference.com</code>), this is the <em>C reference</em> part.</p>\n"}], "owner": {"reputation": 1, "user_id": 8788197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YdOh13tugZk/AAAAAAAAAAI/AAAAAAAAAHo/N-w1AOhIDKs/photo.jpg?sz=128", "display_name": "MMBC Productions", "link": "https://stackoverflow.com/users/8788197/mmbc-productions"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "closed_date": 1510756258, "answer_count": 2, "score": -4, "last_activity_date": 1510758990, "creation_date": 1510756040, "last_edit_date": 1510758127, "question_id": 47309966, "link": "https://stackoverflow.com/questions/47309966/c-initializer-element-is-not-constant", "closed_reason": "Duplicate", "title": "C initializer element is not constant", "body": "<p>I'm getting a \"error: initializer element is not constant\"\nwith this code:</p>\n\n<pre><code>typedef struct {\n    const int x;\n    const int y;\n} my_struct;\n\nconst int a = 8;\nconst int b = 12;\n\nmy_struct test = { a, b };\n</code></pre>\n\n<p>Any idea of what's going on and how to fix it ?</p>\n"}, {"tags": ["c", "interrupt", "stm32f4discovery", "usart", "stm32-hal"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1510757452, "post_id": 47309874, "comment_id": 81571295, "body": "You mean, <code>X</code> is always <code>0.012</code> inside <code>HAL_UART_RxCpltCallback</code>, and it&#39;s not being written from anywhere else, but a random value is printed inside some other function? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1510757498, "post_id": 47309874, "comment_id": 81571335, "body": "You don&#39;t seem to have any means to protect the shared data, so you&#39;ll most likely have massive race conditions. You need to implement semaphores or similar. In addition, having floating point calculations inside an ISR is not a great idea. It doesn&#39;t look like you <i>need</i> floating point either, since you wish to parse out an exact 4 digit value from ASCII, you can do this better and faster with unsigned 16. Do you at least have a FPU on the microcontroller? Also, what&#39;s at index 0 of that string and why do you skip it?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1510757692, "post_id": 47309874, "comment_id": 81571506, "body": "@Lundin: my guess is the sign character (i.e. <code>&quot; 0.012&quot;</code> or something like that), since the decimal dot at idx <code>[2]</code> is also skipped. But yes, this will work by pure luck. If a single byte is ever skipped or inserted into the stream, it will read incorrect values forever."}, {"owner": {"reputation": 1, "user_id": 8945602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105b2721f50ef9fb4e185339228eca6?s=128&d=identicon&r=PG&f=1", "display_name": "\u6797\u9f0e\u502b", "link": "https://stackoverflow.com/users/8945602/%e6%9e%97%e9%bc%8e%e5%80%ab"}, "edited": false, "score": 0, "creation_date": 1510831727, "post_id": 47309874, "comment_id": 81607568, "body": "So I should use mutex or semaphores to send data?"}], "answers": [{"tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 0, "last_activity_date": 1526374499, "creation_date": 1526374499, "answer_id": 50346057, "question_id": 47309874, "link": "https://stackoverflow.com/questions/47309874/stm32-usart-interrupt-cannot-translate-correct-data-to-other-functions/50346057#50346057", "title": "STM32 usart interrupt cannot translate correct data to other functions", "body": "<p>Without knowing if your MCU actually supports floating point etc, I would probably do something like this in order to diagnose/debug what is happening:</p>\n\n<pre><code>void UART7_IRQHandler()\n{\n    HAL_UART_IRQHandler(&amp;huart7);\n    HAL_UART_Receive_IT(&amp;huart7, (uint8_t *)UART7RxBuffer, 16);\n}\n\nchar d1;\nchar d2;\nchar d3;\nchar d4;\nfloat X1;\nfloat X2;\nfloat X3;\nfloat X4;\nfloat X;\n\nvoid HAL_UART_RxCpltCallback(UART_HandleTypeDef* huart)  \n{   \n    if(huart-&gt;Instance == UART7) {\n        d1 = UART7RxBuffer[1]-48;  /* add breakpoint here, and single step from here while inspecting variables */\n        d2 = UART7RxBuffer[3]-48;\n        d2 = UART7RxBuffer[4]-48;\n        d3 = UART7RxBuffer[5]-48;\n        X1 = d1;\n        X2 = d2 * 0.1;\n        X3 = d3 * 0.01;\n        X4 = d4 * 0.001;\n        X = X1 + X2 + X3 + X4;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8945602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105b2721f50ef9fb4e185339228eca6?s=128&d=identicon&r=PG&f=1", "display_name": "\u6797\u9f0e\u502b", "link": "https://stackoverflow.com/users/8945602/%e6%9e%97%e9%bc%8e%e5%80%ab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526374499, "creation_date": 1510755769, "question_id": 47309874, "link": "https://stackoverflow.com/questions/47309874/stm32-usart-interrupt-cannot-translate-correct-data-to-other-functions", "title": "STM32 usart interrupt cannot translate correct data to other functions", "body": "<p>I have some problem when I use a stm32 discovery board send data to another one and it can get correct data and print in callback function, but cannot print correctly in other function.</p>\n\n<pre><code>void UART7_IRQHandler()\n{\n    HAL_UART_IRQHandler(&amp;huart7);\n    HAL_UART_Receive_IT(&amp;huart7, (uint8_t *)UART7RxBuffer, 16);\n}\nvoid HAL_UART_RxCpltCallback(UART_HandleTypeDef* huart)  \n{   \n    if(huart-&gt;Instance == UART7) {\n        X = (UART7RxBuffer[1]-48) + (UART7RxBuffer[3]-48)*0.1 + (UART7RxBuffer[4]-48)*0.01 + (UART7RxBuffer[5]-48)*0.001;           \n    }\n}\n</code></pre>\n\n<p>But I receive wrong data like this</p>\n\n<pre><code>void controller(){\n    printf(\"%.3f\\t\\n\", X);\n}\n</code></pre>\n\n<p>It should be 0.012, and it correct in HAL_UART_RxCpltCallback(), I receive -38.02, -0.009, 0.512, 0.012, -1.948 and so on in controller. How should I do to prevent this situation?</p>\n"}, {"tags": ["c", "multithreading", "cygwin"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1510754838, "post_id": 47309426, "comment_id": 81569252, "body": "You have data race in the access/update to <code>evenCounter</code>."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510754864, "post_id": 47309426, "comment_id": 81569272, "body": "8 attempts is not enough to lose a race condition. Try a few million times. Especially since the printing you do takes at least a few tens of thousands times more time than the bit with the race.  Also, you do have a hidden lock in your code that synchronises the threads. Printf, or whatever it prints to has a lock and that accidentally synchronizes your threads."}, {"owner": {"reputation": 759, "user_id": 5410948, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fabc426325c7ee30f3200419d02e2a63?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5410948/john"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510755899, "post_id": 47309426, "comment_id": 81570022, "body": "@Art, I tried a lot more then 8 times, but used a small number here only for simplicity. Also, I edited my code - now I&#39;m taking the value of nextEven() before the call to printf, so no mutex in here as far as I know (but still getting same results)."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510756171, "post_id": 47309426, "comment_id": 81570276, "body": "To properly see if race happens: increment a global variable 500 million times in a thread. Increment the same global variable 500 million times in the main thread. Check if the value of the global variable is a billion. That should start getting close to reliable race condition territory. Most likely, your two increments are just replaced by one addition by two by the compiler because the compiler doesn&#39;t want to waste time."}], "owner": {"reputation": 759, "user_id": 5410948, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fabc426325c7ee30f3200419d02e2a63?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5410948/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510755809, "creation_date": 1510754571, "last_edit_date": 1510755809, "question_id": 47309426, "link": "https://stackoverflow.com/questions/47309426/pthread-and-main-thread-are-running-on-same-core-by-default-in-cygwin", "title": "pthread and main thread are running on same core by default in cygwin?", "body": "<p>I'm using multi-core machine, and tried to run this simple code few times:                  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt; \n#include &lt;unistd.h&gt;\n\nint evenCounter = 0;\n\nint nextEven()\n{\n    ++evenCounter;\n    ++evenCounter;\n    return evenCounter;\n}\n\nvoid* pThreadFunction()\n{\n    int i, val;\n    for (i = 0; i &lt; 8; i++)\n    {\n        val = nextEven();\n        printf(\"*** increase from pThread - new Value is: %d\\n\", val);\n    }\n    pthread_exit(NULL);\n}\n\nvoid main(){\n    pthread_t pThread;\n    int i, val;\n    if (pthread_create(&amp;pThread, NULL, pThreadFunction, NULL) != 0) \n    {\n        puts(\"failed to create print thread\");\n        return 1;\n    }\n    for (i = 0; i &lt; 8; i++)\n    {\n        val = nextEven();\n        printf(\"increase from main - new Value is: %d\\n\", val);\n    }\n}          \n</code></pre>\n\n<p>And got results like those all the time:                   </p>\n\n<pre><code>increase from main - new Value is: 2\n*** increase from pThread - new Value is: 4\nincrease from main - new Value is: 6\n*** increase from pThread - new Value is: 8\nincrease from main - new Value is: 10\n*** increase from pThread - new Value is: 12\nincrease from main - new Value is: 14\n*** increase from pThread - new Value is: 16\nincrease from main - new Value is: 18\n*** increase from pThread - new Value is: 20\nincrease from main - new Value is: 22\n*** increase from pThread - new Value is: 24\nincrease from main - new Value is: 26\n*** increase from pThread - new Value is: 28\nincrease from main - new Value is: 30\n*** increase from pThread - new Value is: 32               \n</code></pre>\n\n<p>(The order between the first printings was different sometimes, but the values were the same).<br>\nIf those two threads run on different cores - I would expect some wrong values (like odd values) in the printings, so for my understanding - those threads run on the same core.             </p>\n\n<p>Is it really like that in cygwin?\nAnd if it is, how can I make main thread and the pthread run on different cores?<br>\nI saw an option for using <code>sched_setaffinity</code> , but it doesn't work in cygwin.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1510756846, "post_id": 47309375, "comment_id": 81570809, "body": "No, they are completely unrelated. They are implemented differently, and they solve different problems. Where did you get the idea they are similar?"}, {"owner": {"reputation": 11, "user_id": 8940747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d73457ddaaa62834e28d177c349343?s=128&d=identicon&r=PG&f=1", "display_name": "Purushoth", "link": "https://stackoverflow.com/users/8940747/purushoth"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1511781292, "post_id": 47309375, "comment_id": 81974926, "body": "Since Hash Map can be implemented using Adjacency list. I thought both are same in terms of implementation."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1511781504, "post_id": 47309375, "comment_id": 81975057, "body": "It&#39;s the other way around, you can implement an adjacency list using a hash map. So a hash map is a basic data structure, and you use it to build other more complex structures, but an adjacency list is usually implemented using a <i>linked list</i> (hence the name). And even in the &quot;common&quot; case, it would be wrong to say that an adjacency list and a linked list are the same thing (or to say that &quot;dynamic programming and arrays are the same thing&quot; because you use arrays for solving DP problems -- it just doesn&#39;t make sense)."}], "owner": {"reputation": 11, "user_id": 8940747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d73457ddaaa62834e28d177c349343?s=128&d=identicon&r=PG&f=1", "display_name": "Purushoth", "link": "https://stackoverflow.com/users/8940747/purushoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510754428, "creation_date": 1510754428, "question_id": 47309375, "link": "https://stackoverflow.com/questions/47309375/is-hashmap-and-adjacency-listsused-to-represent-graph-are-same", "title": "Is HashMap and Adjacency Lists(used to represent graph) are same?", "body": "<p>I am trying to understand Hash-Map and an Adjacency List. Are they both same in terms of how they are implemented? </p>\n"}, {"tags": ["c", "termios"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 3, "creation_date": 1510753639, "post_id": 47308872, "comment_id": 81568423, "body": "Isn&#39;t the whole point of macros to be able to have different values on different platforms?"}, {"owner": {"reputation": 690, "user_id": 3972710, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ae8581ca6140db037bea59ada58d1ec?s=128&d=identicon&r=PG&f=1", "display_name": "NGI", "link": "https://stackoverflow.com/users/3972710/ngi"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1510753888, "post_id": 47308872, "comment_id": 81568617, "body": "@Groo yes for sure. I thought this piece of software would be completely common even down to such definitions."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510758177, "post_id": 47308872, "comment_id": 81571874, "body": "You work in terms of the macro names so that the numbers don\u2019t matter. You should expect every implementation to use different numbers. The anomaly is when several implementations use the same number. That usually means there was history behind it; there were implementations that used numbers before it was standardized."}], "owner": {"reputation": 690, "user_id": 3972710, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ae8581ca6140db037bea59ada58d1ec?s=128&d=identicon&r=PG&f=1", "display_name": "NGI", "link": "https://stackoverflow.com/users/3972710/ngi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510754333, "creation_date": 1510753042, "last_edit_date": 1510754333, "question_id": 47308872, "link": "https://stackoverflow.com/questions/47308872/termios-h-defined-value-difference-between-sources", "title": "termios.h defined value difference between sources", "body": "<p>I was astonished to find differences between macro definition of termios.h</p>\n\n<p>On RHEL or Centos 7 I have the (also confusing octal) values</p>\n\n<pre><code>#define PARENB  0000400\n#define PARODD  0001000\n</code></pre>\n\n<p>On other sources we see</p>\n\n<pre><code>#define PARENB      0x00001000  /* parity enable */\n#define PARODD      0x00002000  /* odd parity, else even */\n</code></pre>\n\n<p>For PARENB 0x1000 = 4096 = 10000octal which is not 0000400</p>\n\n<p>I thought it would be the same on all platforms/distributions (apart maybe for 32 bits/64bits distinction).</p>\n\n<p>Why such difference ? Can we by mistake use one instead of the other ? is there an historical reason ?</p>\n"}, {"tags": ["c", "lua", "dynamic-library"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510753780, "post_id": 47308814, "comment_id": 81568534, "body": "From <i><a href=\"http://lua.2524044.n2.nabble.com/How-to-reload-C-functions-added-with-quot-require-quot-td7585583.html\" rel=\"nofollow noreferrer\">this conversation</a></i> it appears that re-loading a library in lua requires using C.  The link provides some example code on how the problem was approached, but it did require using C."}, {"owner": {"reputation": 75, "user_id": 7895503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b33fcc98dc365f3826fa3338f17b88?s=128&d=identicon&r=PG&f=1", "display_name": "Knova Chan", "link": "https://stackoverflow.com/users/7895503/knova-chan"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510754168, "post_id": 47308814, "comment_id": 81568802, "body": "@ryyker yes, that&#39;s the temporary solution I mentioned"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510755900, "post_id": 47308814, "comment_id": 81570023, "body": "The answer to your question <i>can I do this by lua code itself?</i> is no.  evidently, it us because <code>lua</code> is an interpreted language.  U,e, its library is <i>in use</i>, so attempting to unload the library by calling <code>lua</code> syntax that is being interpreted and executed by the library at that time is not possible."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7895503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b33fcc98dc365f3826fa3338f17b88?s=128&d=identicon&r=PG&f=1", "display_name": "Knova Chan", "link": "https://stackoverflow.com/users/7895503/knova-chan"}, "edited": false, "score": 0, "creation_date": 1510899739, "post_id": 47310841, "comment_id": 81640727, "body": "yes, and maybe we should commit a patch for lua to solve this"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 75, "user_id": 7895503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b33fcc98dc365f3826fa3338f17b88?s=128&d=identicon&r=PG&f=1", "display_name": "Knova Chan", "link": "https://stackoverflow.com/users/7895503/knova-chan"}, "edited": false, "score": 0, "creation_date": 1510934351, "post_id": 47310841, "comment_id": 81661602, "body": "@KnovaChan - Your suggestion suggests you still do not understand <i>why</i> this cannot be done.  Can you sit in a chair with you feet off of the ground, then remove the chair?  or can you remove your shoes when you are standing on them?  Replacing any executable by calling one of it&#39;s libraries, or functions, while it is being used is the same."}, {"owner": {"reputation": 75, "user_id": 7895503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b33fcc98dc365f3826fa3338f17b88?s=128&d=identicon&r=PG&f=1", "display_name": "Knova Chan", "link": "https://stackoverflow.com/users/7895503/knova-chan"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510993532, "post_id": 47310841, "comment_id": 81680955, "body": "@ryyker thx again, but I still think that as long as it can be done in C, we can always wrap it and make an API for lua to invoke right? In fact, when we want to unload a library, we certainly won&#39;t be using it any longer. You can take a look at the link you give in your first comment, if that code is in origin lua core, then unloadlib can be done in pure lua."}], "tags": [], "owner": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "is_accepted": true, "score": 2, "last_activity_date": 1510758573, "creation_date": 1510758573, "answer_id": 47310841, "question_id": 47308814, "link": "https://stackoverflow.com/questions/47308814/how-to-unload-dynamic-lib-in-lua/47310841#47310841", "title": "how to unload dynamic lib in lua", "body": "<p>Sadly, this is not possible.</p>\n\n<p>You'd have to approach the situation using C/C++, but not using Lua, due to the way in which Lua works, and I wish there would've been a different answer but Lua has got it's limits.</p>\n"}], "owner": {"reputation": 75, "user_id": 7895503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b33fcc98dc365f3826fa3338f17b88?s=128&d=identicon&r=PG&f=1", "display_name": "Knova Chan", "link": "https://stackoverflow.com/users/7895503/knova-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 47310841, "answer_count": 1, "score": 3, "last_activity_date": 1510758573, "creation_date": 1510752907, "question_id": 47308814, "link": "https://stackoverflow.com/questions/47308814/how-to-unload-dynamic-lib-in-lua", "title": "how to unload dynamic lib in lua", "body": "<p>I'm using luajit2.0.4 as lua interpreter. here is the situation:</p>\n\n<p>after I load a dynamic lib like cjson.so with</p>\n\n<pre><code>cjson = require('cjson')\na=cjson.new() -- blahblah... do things i want\n</code></pre>\n\n<p>then I need to overwrite the lib file, ( a situation of hot upgrade, and here cjson.so_1 and cjson.so might be the same)</p>\n\n<pre><code>[root@localhost lib]# cp cjson.so_1 cjson.so\ncp: overwrite `cjson.so'? y\n</code></pre>\n\n<p>it will force kernel to truncate the physical memory of cjson.so's pmap, and causing a page missing\nthen when I call</p>\n\n<pre><code>a=cjson.new()\n</code></pre>\n\n<p>again, the kernel will recopy the cjson.so lib into memory, this time not parsing the global symbols. so when I call <em>new()</em> which need to call external functions like <em>malloc()</em>, a segment fault will occur.</p>\n\n<p>I've already found a way to reload by writing a unload funtion in C,</p>\n\n<p>and my question is can I do this by lua code itself?</p>\n"}, {"tags": ["c", "ide", "codeblocks"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510754073, "post_id": 47308777, "comment_id": 81568739, "body": "What compiler??"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1510754114, "post_id": 47308777, "comment_id": 81568770, "body": "This doesn&#39;t appear to be a coding issue, but an issue with your IDE?"}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510755284, "post_id": 47308777, "comment_id": 81569560, "body": "@ryyker I had the macros for FOO() swapped but otherwise the (incorrect) #ifndef behavior is as stated."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1510755329, "post_id": 47308777, "comment_id": 81569586, "body": "@ChrisTurner IDE, I even did bold the part about compiler being a-okay :-p"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510758707, "post_id": 47308777, "comment_id": 81572261, "body": "After re-reading the question, (and running similar code in my <code>Code::Blocks</code> environment) I see the problem you are referring to, i.e. in the editor, <code>Code::Blocks</code> greys out the wrong logical branch.  Have you registered this problem <i><a href=\"http://forums.codeblocks.org/\" rel=\"nofollow noreferrer\">HERE</a></i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510758760, "post_id": 47308777, "comment_id": 81572306, "body": "How would the editor know which header to parse.  There might be multiple variants of the header selected by different compilation options with different results.  It would surprise me if it does it."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510759912, "post_id": 47308777, "comment_id": 81573271, "body": "@ryyker Someone did this way back in 2012: <a href=\"http://forums.codeblocks.org/index.php?topic=16576.0\" rel=\"nofollow noreferrer\">forums.codeblocks.org/index.php?topic=16576.0</a> and there&#39;s a bug registered for it since 2014: <a href=\"https://sourceforge.net/p/codeblocks/tickets/100/\" rel=\"nofollow noreferrer\">sourceforge.net/p/codeblocks/tickets/100</a> Not that I couldn&#39;t refresh it a bit.."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1510759974, "post_id": 47308777, "comment_id": 81573320, "body": "@JonathanLeffler - I think this a a problem with the C/C++ lexer commonly in use by the Code::Blocks IDE.  I have seen this problem for several versions.  (In fact, I cannot recall <i>not</i> seeing this since starting to use Code::Blocks years ago)  I just did another test this morning to confirm locally defined symbols are highlighted correctly, while symbols defined in a header file are not."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510760304, "post_id": 47308777, "comment_id": 81573587, "body": "This post is a rare example of one that would benefit from an embedded  image to show exactly what you are talking about.  I admit I did not read it carefully the first time, and because the text of your post does not show the greying out of the &quot;true&quot; path of the #ifndef directive, I missed the point."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510761307, "post_id": 47308777, "comment_id": 81574393, "body": "@ryyker so have extra 1001 words."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510761722, "post_id": 47308777, "comment_id": 81574724, "body": "I was editing a similar illustration of the problem when you posted yours.  If you like, I will remove mine, as it is not really an answer, just a clarification of the problem."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1510769932, "post_id": 47308777, "comment_id": 81579921, "body": "@ryyker Nah. They&#39;re aware of the issue apparently, the previous bug was unrelated, this one&#39;s spot on: <a href=\"https://sourceforge.net/p/codeblocks/tickets/541/\" rel=\"nofollow noreferrer\">sourceforge.net/p/codeblocks/tickets/541</a> although that&#39;s still &quot;not going to be fixed soon&quot; but at least someone&#39;s paying attention to it."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "edited": false, "score": 0, "creation_date": 1510768981, "post_id": 47311967, "comment_id": 81579387, "body": "A partial solution is to use Eclipse.. If you can put up with either ancient apt version or don&#39;t mind muddling through the installation process (yes, installer on linux!). For the heretics there&#39;s the Visual Studio linux plugin."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1510770876, "last_edit_date": 1510770876, "creation_date": 1510761596, "answer_id": 47311967, "question_id": 47308777, "link": "https://stackoverflow.com/questions/47308777/codeblocks-does-not-parse-header-define/47311967#47311967", "title": "Code::Blocks does not parse header #define", "body": "<p><em>This post is not intended as an answer, just a clarification.\nAn image is included to highlight the problem discussed in the \noriginal post, and hopefully draw the attention of Code::Blocks \ndevelopers to an</em> <em><a href=\"http://forums.codeblocks.org/index.php?topic=16576.0\" rel=\"nofollow noreferrer\">existing bug registered at least 5 years ago</a></em> - <em><a href=\"https://sourceforge.net/p/codeblocks/tickets/541/\" rel=\"nofollow noreferrer\">and similar</a></em>.</p>\n\n<p>As of today I am not aware of any patches or fixes or revisions to address this problem...  </p>\n\n<p>The following image was captured in Code::Blocks version 13.12 in a\nC project, and <em>illustrates</em> the OP syntax highlighting problem. (Note: \nOP version is even newer: 16.01)</p>\n\n<p>Although Code::Blocks (and GCC) correctly executes only the \"true\"\nbranches of an #ifdef (or #ifndef) directive, syntax highlighting is reveresed for \nsymbols defined in any file other than the one it is being used.</p>\n\n<p>For example, MRAA__ is defined in a file other than this .c file,\nand when it is used here, the \"true\" branch of the #ifdef is greyed out.\nBut for ABCD__, which is defined in this file, the \"false\" branch is greyed out.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZCpmJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZCpmJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "edited": false, "score": 0, "creation_date": 1552307273, "post_id": 55075463, "comment_id": 96946435, "body": "The compiler is irrelevant since this is an editor bug."}], "tags": [], "owner": {"reputation": 627, "user_id": 4127305, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Omtkx.jpg?s=128&g=1", "display_name": "Omonto Oyonde", "link": "https://stackoverflow.com/users/4127305/omonto-oyonde"}, "is_accepted": false, "score": 0, "last_activity_date": 1552120442, "creation_date": 1552120442, "answer_id": 55075463, "question_id": 47308777, "link": "https://stackoverflow.com/questions/47308777/codeblocks-does-not-parse-header-define/55075463#55075463", "title": "Code::Blocks does not parse header #define", "body": "<p>Please whatever problem you may be experiencing here and for anyone who comes along with such a similar problem please consider what compiler you are using in your code blocks. It can save a life somewhere</p>\n"}], "owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1552120442, "creation_date": 1510752809, "last_edit_date": 1510761277, "question_id": 47308777, "link": "https://stackoverflow.com/questions/47308777/codeblocks-does-not-parse-header-define", "title": "Code::Blocks does not parse header #define", "body": "<p>Code::Blocks has a surprising shortcoming \u2014 its editor is unable to parse multiple source files correctly to do #ifdef / #ifndef style code path highlighting correctly. It only works for the file where you define macros directly in but not on any other related project file. For example:</p>\n\n<p>MyHeader.h</p>\n\n<pre><code>#define MRAA__\n</code></pre>\n\n<p>MyProgram.c </p>\n\n<pre><code>#include \"MyHeader.h\"\n#ifndef MRAA__\n#define FOO() Foo_Bcm2835()\n#else \n#define FOO() Foo_Mraa()\n#endif\n</code></pre>\n\n<p>The #ifndef MRAA__ evaluates as true although you have defined MRAA__ in your header file. Now the <strong>compiler</strong> handles this just fine but visually in editor it's wrong. </p>\n\n<p>Yes, you can turn off the graying-out entirely but it's pretty handy feature to have around... Is there really no plugin / patch to fix this functionality? I could find people complaining about it in 2012. </p>\n\n<p><a href=\"https://i.stack.imgur.com/6k6oK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6k6oK.png\" alt=\"Editor showing inactive code incorrectly\"></a></p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510752855, "post_id": 47308719, "comment_id": 81567875, "body": "Because they aren&#39;t mature?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510752889, "post_id": 47308719, "comment_id": 81567904, "body": "one possibility may be: the makefiles are just used to batch compile everything. But if you change something, you have to clean the project to be sure it recompiles. Developpers use another dev. system and don&#39;t want to impose it to people who just want to build it once: configure =&gt; make =&gt; done. Plus it is faster because no need to compute dependencies using <code>gcc -MM</code> to append to the existing makefiles."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510752914, "post_id": 47308719, "comment_id": 81567925, "body": "@AndrewHenle: Torvalds will not be pleased with your remarks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1510753773, "post_id": 47308719, "comment_id": 81568527, "body": "Linux does calculate header dependencies and incorporate them into the build with <code>include</code> directives in the Makefile. If you doubt this, run an actual build, change a header file, and run it again. It can be difficult to find all the rules through the maze of <code>include</code>d files, but it works. You won&#39;t find a big <i>static</i> list of header file dependencies because it&#39;s all dynamically generated."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 2, "creation_date": 1510763403, "post_id": 47308719, "comment_id": 81575949, "body": "lz4 looks like it doesn&#39;t build object files as separate targets at all.  From a quick peek it invokes a single instance of the compiler and passes all the <i>source</i> files to it, then creates a library from them all in the same rule.  So, header prerequisites are useless.  I don&#39;t know why you list <code>linux</code> and <code>FFmpeg</code> in your examples, they both clearly DO have automatically generated header file prerequisites."}, {"owner": {"reputation": 189, "user_id": 2798232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d188ba46fb316f901f3f5441a04209ce?s=128&d=identicon&r=PG&f=1", "display_name": "M. Berk", "link": "https://stackoverflow.com/users/2798232/m-berk"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1510847070, "post_id": 47308719, "comment_id": 81618672, "body": "@MadScientist I follow your description of the rules for lz4 but I don&#39;t understand why it follows that header prerequisites are useless. I don&#39;t see how, based on this description, the library will be rebuilt if a header file is changed. As for including <code>linux</code> and <code>FFmpeg</code>, it&#39;s not clear to me that they do have automatically generated header file prerequisites. Of course, a good answer to this question is one that shows why I&#39;m mistaken."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1510854984, "post_id": 47308719, "comment_id": 81624060, "body": "True if the changes are solely to headers and no change to any source file then things won&#39;t be rebuilt.  Probably this single rule should also depend on all header files as well as all source files.  The current makefile is sufficient for downstream people who just want to build the code without doing development on it.  Don&#39;t know what the developers do."}], "answers": [{"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1510763260, "post_id": 47309003, "comment_id": 81575819, "body": "Any system that uses automake (most software with a <code>configure</code> script will be using both autoconf and automake) has header file dependency generation built in automatically: it&#39;s a feature that comes standard with automake."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1510763471, "post_id": 47309003, "comment_id": 81576001, "body": "@MadScientist makes sense. However, on my MSYS system, I don&#39;t have <code>autoconf</code> or <code>automake</code> handy. I&#39;m not saying that <i>all</i> project don&#39;t generate dependencies, just saying that it&#39;s not needed by 95% of people who just need to recompile (and which would have probably liked to avoid even recompilation), so some projects probably skip that."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 1, "creation_date": 1510764579, "post_id": 47309003, "comment_id": 81576762, "body": "Sure.  I just meant, if you have a project that contains a <code>configure</code> script it most likely already has support for header file dependencies built in.  Not all, of course.  Some use autoconf without automake, and some create a <code>configure</code> script by hand rather than using either autoconf or automake."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1510764793, "post_id": 47309003, "comment_id": 81576925, "body": "Agreed. OP must be talking about those special &quot;lazy&quot; cases else it makes no sense"}, {"owner": {"reputation": 189, "user_id": 2798232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d188ba46fb316f901f3f5441a04209ce?s=128&d=identicon&r=PG&f=1", "display_name": "M. Berk", "link": "https://stackoverflow.com/users/2798232/m-berk"}, "edited": false, "score": 0, "creation_date": 1510912743, "post_id": 47309003, "comment_id": 81647482, "body": "Could this be summarised as there is (depending on the project) a distinction between Makefiles used for installation purposes and those used during development?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 189, "user_id": 2798232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d188ba46fb316f901f3f5441a04209ce?s=128&d=identicon&r=PG&f=1", "display_name": "M. Berk", "link": "https://stackoverflow.com/users/2798232/m-berk"}, "edited": false, "score": 0, "creation_date": 1510914593, "post_id": 47309003, "comment_id": 81648808, "body": "@M.Berk yes, that seems reasonable"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 3, "last_activity_date": 1510753418, "creation_date": 1510753418, "answer_id": 47309003, "question_id": 47308719, "link": "https://stackoverflow.com/questions/47308719/why-arent-changes-to-header-files-accounted-for-in-the-makefiles-of-mature-c-pr/47309003#47309003", "title": "Why aren&#39;t changes to header files accounted for in the Makefiles of mature C projects?", "body": "<p>I'll attempt to answer.</p>\n\n<p>The source distros of some projects include a <code>configure</code> script which creates a makefile from a template/whatever.</p>\n\n<p>So the end user which needs to recompile the package for his/her target just has to do:</p>\n\n<pre><code>$ configure --try-options-until-it-works\n$ make\n</code></pre>\n\n<p>Things can go wrong during the <code>configure</code> phase, but this has nothing to do with the makefile itself. User has to download stuff, adjust paths or configure switches and run again until makefile is successfully generated.</p>\n\n<p>But once the makefile is generated, things <em>should</em> go pretty smooth from there for the user which only needs to build the product once to be able to use it.</p>\n\n<p>A few portion of users will need to change some source code. In that case, they'll have to clean everything, <em>because the makefile provided isn't the way the actual developpers manage their builds</em>. They may use other systems (code::blocks, Ant, gprbuild...) , and just provide the makefile to automate production from scratch and avoid to depend on a complex production system. <code>make</code> is fairly standard even on Windows/MinGW.</p>\n\n<p>Note that there are some filesystems which provide build audit (Clearcase) where the dependencies are automatically managed (<code>clearmake</code>).</p>\n\n<p>If you see the makefile as a batch script to build all the sources, you don't need to bother adding a dependency system using</p>\n\n<ul>\n<li>a template makefile</li>\n<li>a <code>gcc -MM</code> command to append dependencies to it (which takes time)</li>\n</ul>\n\n<p>Note that you can build it yourself with some extra work (adding a <code>depend</code> target to your makefile)</p>\n"}], "owner": {"reputation": 189, "user_id": 2798232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d188ba46fb316f901f3f5441a04209ce?s=128&d=identicon&r=PG&f=1", "display_name": "M. Berk", "link": "https://stackoverflow.com/users/2798232/m-berk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 47309003, "answer_count": 1, "score": 4, "last_activity_date": 1510753418, "creation_date": 1510752666, "question_id": 47308719, "link": "https://stackoverflow.com/questions/47308719/why-arent-changes-to-header-files-accounted-for-in-the-makefiles-of-mature-c-pr", "title": "Why aren&#39;t changes to header files accounted for in the Makefiles of mature C projects?", "body": "<p>I have been reading up on <code>make</code> and looking at the Makefiles for popular <a href=\"https://github.com/topics/c\" rel=\"nofollow noreferrer\"><code>C</code> projects on GitHub</a> to cement my understanding.</p>\n\n<p>One thing I am struggling to understand is why none of the examples I've looked at (e.g. <a href=\"https://github.com/lz4/lz4/\" rel=\"nofollow noreferrer\">lz4</a>, <a href=\"https://github.com/torvalds/linux\" rel=\"nofollow noreferrer\">linux</a> and <a href=\"https://github.com/FFmpeg/FFmpeg\" rel=\"nofollow noreferrer\">FFmpeg</a>) seem to account for header file dependencies.</p>\n\n<p>For my own project, I have header files that contain:</p>\n\n<ol>\n<li>Numeric and string constants</li>\n<li>Macros</li>\n<li>Short, inline functions</li>\n</ol>\n\n<p>It would seem essential, therefore, to take any changes to these into account when determining whether to recompile.</p>\n\n<p>I have discovered that <code>gcc</code> can automatically generate Makefile fragments from dependencies as in <a href=\"https://stackoverflow.com/a/2501673/2798232\">this SO answer</a> but I haven't seen this used in any of the projects I've looked at.</p>\n\n<p>Can you help me understand why these projects apparently ignore header file dependencies?</p>\n"}, {"tags": ["c", "ipc", "shared-memory", "ipcs"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510752984, "post_id": 47308654, "comment_id": 81567976, "body": "What is <code>key</code>?  Where is it defined?  Please post <b>complete</b> code."}, {"owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510753185, "post_id": 47308654, "comment_id": 81568104, "body": "edited with key,defined at same place"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1510754577, "post_id": 47308654, "comment_id": 81569084, "body": "where you define the structure &quot;AlgoShm&quot; ? Does head, tail &amp; fFlag are members of this structure ?"}, {"owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "edited": false, "score": 0, "creation_date": 1510755043, "post_id": 47308654, "comment_id": 81569420, "body": "they are defined in a header file which is included in both processes,edited the code."}, {"owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "edited": false, "score": 0, "creation_date": 1510755405, "post_id": 47308654, "comment_id": 81569637, "body": "when i commented those &#39;memcpy&#39; in both processes,i get 0 for both head and tail for the second process,seems it&#39;s displaying the default value for the structure and not the one in the shared memory."}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 1, "last_activity_date": 1510758487, "last_edit_date": 1510758487, "creation_date": 1510757406, "answer_id": 47310439, "question_id": 47308654, "link": "https://stackoverflow.com/questions/47308654/processes-accessing-a-shared-memory-segment-returning-different-values/47310439#47310439", "title": "Processes accessing a Shared Memory segment returning different values", "body": "<p>first thing, if you are using <code>shared memory</code> then why <code>malloc()</code> ? shared memory itself will attach <code>shmid</code> with <code>shared memory</code> you don't have to do  explicitly malloc().</p>\n\n<p>second thing, you are attaching <code>shmaddr</code> pointer with memory returned by <code>shmat()</code> but <strong>putting data</strong> into <code>ptr</code>, <strong>ptr</strong> is attached with <strong>heap memory</strong> not with <strong>shared memory</strong>. So either put the data into <code>shmaddr</code> pointer or replace this </p>\n\n<pre><code>shmaddr = (struct AlgoShm *)shmat(shmid,0,0);\n</code></pre>\n\n<p>with </p>\n\n<pre><code>ptr = (struct AlgoShm *)shmat(shmid,0,0);\n</code></pre>\n\n<p>and don't allocate memory using mallocc().then do </p>\n\n<pre><code>                ptr-&gt;head = 5;\n                ptr-&gt;tail = 3;\n                ptr-&gt;fFlag = '0';\n                ptr-&gt;algoshm.time = 0;\n                ptr-&gt;algoshm.pno = 1;\n</code></pre>\n\n<p>do all these modification in both process. and finally you should do <code>shmdt()</code> for de-attaching shared memory otherwise it will be a <code>memory leakage</code>.</p>\n\n<p>I modified your code as\n<strong>one.c</strong> :</p>\n\n<pre><code>int main()\n{\n        int shmid ;\n        struct timeval CurTime;\n        struct timespec nTime;\n        struct AlgoShm *shmaddr,*ptr;\n        if((shmid = shmget(key,SHM_SIZE,0644 |IPC_CREAT)) &lt; 0)\n        {\n                perror(\"shmget:error\");\n        }\n        else\n        {\n                printf(\"Shm created key=[%d] \\n Segment Id [%d] \",key,shmid);\n                ptr = (struct AlgoShm *)shmat(shmid,0,0);\n                if(shmaddr &lt; 0)\n                {\n                        perror(\" shmat :error\");\n                }\n                else\n                {\n                        printf(\" SHM Segment attached at [%x] \",ptr);\n                }\n                clock_gettime(CLOCK_REALTIME,&amp;nTime);\n                printf(\" Time in N secs[%ld] \\n \",nTime.tv_nsec);\n                ptr-&gt;head = 5;\n                ptr-&gt;tail = 3;\n                ptr-&gt;fFlag = 'a';\n                ptr-&gt;algoshm.time = 10;\n                ptr-&gt;algoshm.pno = 11;\n                printf(\" AlgoThrottle|ptr-&gt;head [%x] \",ptr-&gt;head);\n\n        }\n        system(\"./AlgoRead\");\n        return 0;\n}\n</code></pre>\n\n<p><strong>two.c</strong> :</p>\n\n<pre><code>int main()\n{\n        int shmid ;\n        struct AlgoShm *shmaddr,*ptr1 ;\n        if((shmid = shmget(key,SHM_SIZE,0)) &lt; 0)\n        {\n\n                perror(\" AlgoRead|shmget:error \");\n        }\n        else\n        {\n                printf(\" AlgoRead|SHM Created shmid [%d] \",shmid);\n\n                if((ptr1 = (struct AlgoShm *)shmat(shmid,0,0)) &lt; 0)\n                {\n                        perror(\"AlgoRead|shmat error\");\n                }\n                else\n                        printf(\" AlgoRead|Attached to Segment at Address[%x] \\n \",ptr1);\n                printf(\" AlgoRead|ptr1-&gt;head [%d] ptr1-&gt;tail [%d] ptr1-&gt;fFlag[%c] \\n \",ptr1-&gt;head,ptr1-&gt;tail,ptr1-&gt;fFlag);\n        }\n        shmdt(ptr1);\n        return 0;\n}\n</code></pre>\n\n<p>I hope it helps you and my advise to you is to go through man page of shmget(), shmat() &amp; shmdt() properly.</p>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 1, "last_activity_date": 1510761164, "last_edit_date": 1510761164, "creation_date": 1510759706, "answer_id": 47311251, "question_id": 47308654, "link": "https://stackoverflow.com/questions/47308654/processes-accessing-a-shared-memory-segment-returning-different-values/47311251#47311251", "title": "Processes accessing a Shared Memory segment returning different values", "body": "<p>Please see your mistakes below\nwhy are you allocating 10 times of the structure?</p>\n\n<p>correct line </p>\n\n<pre><code> ptr = (struct AlgoShm *)malloc(10*sizeof(struct AlgoShm));\n</code></pre>\n\n<p>to:-</p>\n\n<pre><code>ptr = (struct AlgoShm *)malloc(sizeof(struct AlgoShm));\n</code></pre>\n\n<p>Do the above changes at both the c files</p>\n\n<p>Now in <code>memcpy</code> why are you providing the address of a pointer <code>ptr</code> like <code>&amp;ptr</code>? Just remove the <code>&amp;</code>. This is not a object hence you just need to provide the pointer <code>ptr</code>. Correct it like below</p>\n\n<pre><code>memcpy(shmaddr,ptr,sizeof(ptr));\n</code></pre>\n\n<p>Instead of <code>memcpy</code> better use like below.</p>\n\n<pre><code>shmaddr-&gt;head = ptr-&gt;head;\nshmaddr-&gt;tail = ptr-&gt;tail;\nshmaddr-&gt;fFlag=ptr-&gt;fFlag;\n</code></pre>\n\n<p>I have re-write you code below. Try with that. Better correct your own code as per my advice.</p>\n\n<blockquote>\n  <p>AlgoThrottle.c</p>\n</blockquote>\n\n<pre><code>int main()\n{\n    int shmid ;\n    struct timeval CurTime;\n    struct timespec nTime;\n    struct AlgoShm *shmaddr,*ptr;\n\n    ptr = (struct AlgoShm *)malloc(sizeof(struct AlgoShm));\n    //Creating Shared Memory\n    if((shmid = shmget(key,SHM_SIZE,0644 |IPC_CREAT)) &lt; 0)\n    {\n        perror(\"shmget:error\");\n    }\n    else\n    {\n        printf(\"Shm created key=[%d] \\n Segment Id [%d] \",key,shmid);\n        //Attaching to Shared Memory\n        shmaddr = (struct AlgoShm *)shmat(shmid,0,0);\n        if(shmaddr &lt; 0)\n        {\n                perror(\" shmat :error\");\n        }\n        else\n        {\n                printf(\" SHM Segment attached at [%x] \",shmaddr);\n        }\n        //Loading/Initializing Data Blocks in SHM\n        clock_gettime(CLOCK_REALTIME,&amp;nTime);\n        printf(\" Time in N secs[%ld] \\n \",nTime.tv_nsec);\n        ptr-&gt;head = 5;\n        ptr-&gt;tail = 3;\n        ptr-&gt;fFlag = '0';\n        ptr-&gt;algoshm.time = 0;\n        ptr-&gt;algoshm.pno = 1;\n        //memcpy(shmaddr,ptr,sizeof(ptr));\n        shmaddr-&gt;head = ptr-&gt;head;\n        shmaddr-&gt;tail = ptr-&gt;tail;\n        shmaddr-&gt;fFlag=ptr-&gt;fFlag;\n        printf(\" AlgoThrottle|ptr-&gt;head [%d] \\n\",ptr-&gt;head);\n        //sleep(1);\n        system(\"./AlgoRead\"); \n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>AlgoRead.c</p>\n</blockquote>\n\n<p>int main()\n    {</p>\n\n<pre><code>    int shmid ;\n    struct AlgoShm *shmaddr,*ptr1 ;\n    ptr1 = (struct AlgoShm *)malloc(sizeof(struct AlgoShm));\n\n    if((shmid = shmget(key,SHM_SIZE,0)) &lt; 0)\n    {\n\n    perror(\" AlgoRead|shmget:error \");\n    }\n    else\n    {\n            printf(\" AlgoRead|SHM Created shmid [%d] \",shmid);\n\n            if((shmaddr = (struct AlgoShm *)shmat(shmid,0,0)) &lt; 0)\n            {\n                    perror(\"AlgoRead|shmat error\");\n            }\n            else\n            {\n                    memcpy(ptr1,shmaddr,sizeof(struct AlgoShm));\n                    printf(\" AlgoRead|Attached to Segment at Address[%x] \\n \",shmaddr);\n                    printf(\" AlgoRead|ptr1-&gt;head [%d] ptr1-&gt;tail [%d] ptr1-&gt;fFlag[%c] \\n \",ptr1-&gt;head,ptr1-&gt;tail,ptr1-&gt;fFlag);\n            }\n    }\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 1, "accepted_answer_id": 47310439, "answer_count": 2, "score": 0, "last_activity_date": 1510761164, "creation_date": 1510752483, "last_edit_date": 1510755087, "question_id": 47308654, "link": "https://stackoverflow.com/questions/47308654/processes-accessing-a-shared-memory-segment-returning-different-values", "title": "Processes accessing a Shared Memory segment returning different values", "body": "<p>I'm new to the IPCS concept,i want to achieve that one process creates and initializes a shared memory and then calls another process which attaches to the same shared memory segment and prints the data in the shared memory.\nHowever i'm unable to achieve it:</p>\n\n<p>AlgoCommon.h</p>\n\n<pre><code>struct sub_algo_shm\n{\nint time;\nint pno;\n};\nstruct AlgoShm\n{\nint head;\nint tail;\nchar fFlag;\nstruct sub_algo_shm algoshm;\n};\n</code></pre>\n\n<p>AlgoThrottle.c</p>\n\n<pre><code>#define key (key_t)111119\n#define SHM_SIZE 1024\n\n    int main()\n        {\n                int shmid ;\n                struct timeval CurTime;\n                struct timespec nTime;\n                struct AlgoShm *shmaddr,*ptr;\n\n                ptr = (struct AlgoShm *)malloc(10*sizeof(struct AlgoShm));\n                //Creating Shared Memory\n                if((shmid = shmget(key,SHM_SIZE,0644 |IPC_CREAT)) &lt; 0)\n                {\n                        perror(\"shmget:error\");\n                }\n                else\n                {\n                        printf(\"Shm created key=[%d] \\n Segment Id [%d] \",key,shmid);\n                        //Attaching to Shared Memory\n                        shmaddr = (struct AlgoShm *)shmat(shmid,0,0);\n                        if(shmaddr &lt; 0)\n                        {\n                                perror(\" shmat :error\");\n                        }\n                        else\n                        {\n                                printf(\" SHM Segment attached at [%x] \",shmaddr);\n                        }\n                        //Loading/Initializing Data Blocks in SHM\n                        clock_gettime(CLOCK_REALTIME,&amp;nTime);\n                        printf(\" Time in N secs[%ld] \\n \",nTime.tv_nsec);\n                        ptr-&gt;head = 5;\n                        ptr-&gt;tail = 3;\n                        ptr-&gt;fFlag = '0';\n                        ptr-&gt;algoshm.time = 0;\n                        ptr-&gt;algoshm.pno = 1;\n                        //memcpy(shmaddr,&amp;ptr,sizeof(ptr));\n                        printf(\" AlgoThrottle|ptr-&gt;head [%d] \",ptr-&gt;head);\n                //      sleep(1);\n                        system(\"./AlgoRead\"); \n\n                }\n\n        return 0;\n        }\n</code></pre>\n\n<p>AlgoRead.c</p>\n\n<pre><code>#define key (key_t)111119\n#define SHM_SIZE 1024\n\n    int main()\n    {\n\n    int shmid ;\n    struct AlgoShm *shmaddr,*ptr1 ;\n    ptr1 = (struct AlgoShm *)malloc(10*sizeof(struct AlgoShm));\n\n    if((shmid = shmget(key,SHM_SIZE,0)) &lt; 0)\n    {\n\n    perror(\" AlgoRead|shmget:error \");\n    }\n    else\n    {\n            printf(\" AlgoRead|SHM Created shmid [%d] \",shmid);\n\n            if((shmaddr = (struct AlgoShm *)shmat(shmid,0,0)) &lt; 0)\n            {\n                    perror(\"AlgoRead|shmat error\");\n            }\n            else\n            {\n                    //memcpy(ptr1,shmaddr,sizeof(struct AlgoShm));\n                    printf(\" AlgoRead|Attached to Segment at Address[%x] \\n \",shmaddr);\n                    printf(\" AlgoRead|ptr1-&gt;head [%d] ptr1-&gt;tail [%d] ptr1-&gt;fFlag[%c] \\n \",ptr1-&gt;head,ptr1-&gt;tail,ptr1-&gt;fFlag);\n            }\n    }\n\n    return 0;\n    }\n</code></pre>\n\n<p>This is my output:</p>\n\n<pre><code>Shm created key=[111119]\n Segment Id [1179615678]  SHM Segment attached at [4a6b4000]  Time in N secs[114594083]\n AlgoRead|SHM Created shmid [1179615678]  AlgoRead|Attached to Segment at Address[624cb000]\n  AlgoRead|ptr1-&gt;head [36810768] ptr1-&gt;tail [0] ptr1-&gt;fFlag[\u2592]\n   AlgoThrottle|ptr-&gt;head [5]\n</code></pre>\n\n<p>Also,system call's output is showing first then the printf statement even after i used a sleep(1) before invoking system()</p>\n"}, {"tags": ["c", "embedded", "embedded-linux", "interrupt-handling", "interrupted-exception"], "comments": [{"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 2, "creation_date": 1510752338, "post_id": 47308496, "comment_id": 81567488, "body": "<a href=\"https://unix.stackexchange.com/questions/17998/what-are-software-and-hardware-interrupts-and-how-are-they-processed\">Possible Duplicate</a>"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 4, "creation_date": 1510752354, "post_id": 47308496, "comment_id": 81567497, "body": "A software interrupt is an instruction in a program. A hardware interrupt is generated by the processor, or some connected external device."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1510753488, "post_id": 47308496, "comment_id": 81568320, "body": "You will have an interrupt service routine which has to do a certain action, depending on a certain event. The event itself can be an instruction (i.e. triggered from your own code), or a hardware event. That&#39;s the only difference, as @BoPersson wrote. And once you trigger it, if the priority level of this newly triggered interrupt is higher that the code currently being executed, it will suspend current code and jump to the higher priority interrupt routine. If not, a flag will be raised and the routine will start executing when all higher priority interrupts are done executing."}], "answers": [{"tags": [], "owner": {"reputation": 25477, "user_id": 978756, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6fc641bdddde78a51c0db6b8527c54f7?s=128&d=identicon&r=PG", "display_name": "Polynomial", "link": "https://stackoverflow.com/users/978756/polynomial"}, "is_accepted": false, "score": 3, "last_activity_date": 1510752862, "creation_date": 1510752862, "answer_id": 47308797, "question_id": 47308496, "link": "https://stackoverflow.com/questions/47308496/difference-between-software-and-hardware-interrupts/47308797#47308797", "title": "Difference between Software and Hardware Interrupts", "body": "<p>Hardware interrupts are generated by physical signals, either from within the microcontroller itself (e.g. as part of a bus controller) or from an external GPIO configured as an interrupt. These interrupts are usually related to interactions with hardware external to the microcontroller, e.g. SPI or I2C bus interrupts generated when an event occurs on the bus. These hardware interrupts are usually configured via a combination of control registers, which specify hardware behaviour, and interrupt masking, which allows certain interrupts to be enabled or disabled at any point in time. Internal hardware events such as power events, timers, etc. also trigger interrupts.</p>\n\n<p>Software interrupts are generated by instructions executed by the microcontroller. For example, on x86 platforms you can use an <code>INT3</code> instruction to raise a TRAP interrupt for debugging purposes. Software interrupts are commonly used as a way to switch privilege levels, e.g. with syscalls, since code running in a low-privilege mode can trigger an interrupt which executes in a high-privilege mode, which can then dispatch the syscall request appropriately.</p>\n\n<p>In both cases, interrupt handlers are generally configured using an interrupt vector table. Interrupt vectors are simply pointers to functions that handle each interrupt. The table usually exists at a fixed memory location in the microcontroller's flash or ROM space, but in many situations the interrupt table location can be configured as part of the programming process. Generally, each interrupt type is given a number which corresponds to its index in the interrupt table, so you know where to put each individual handler's vector.</p>\n"}, {"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 2, "last_activity_date": 1510758070, "creation_date": 1510758070, "answer_id": 47310671, "question_id": 47308496, "link": "https://stackoverflow.com/questions/47308496/difference-between-software-and-hardware-interrupts/47310671#47310671", "title": "Difference between Software and Hardware Interrupts", "body": "<p>they are all interrupts it just has to do with the source.  there are some interrupts (these are signals too) that are generated by instructions or faults, etc (undefined, unaligned, etc).  And some that are available to the chip vendor.  ARM makes IP not chips, the chip vendor is provided with a number of interrupts they can choose to use however they wish.  Often they are tied to peripherals like usb, gpio, uart, spi, etc.</p>\n\n<p>ARM has one called swi software interrupt or svc.  And like the number of soft interrupts in x86, this is for example so that an application can make a service call.  On a full sized arm this can be executed at the lower/est execution levels but is serviced by a higher more privileged mode or execution level.  basically allowing you to have an operating system.  Can use this feature on the cortex-m but doesnt have the protection layers it provides a common interface for example when you have downloaded an rtos and want to write applications for it, the rtos is generic-ish and the applications are yours doing what you want or need to get done and can make calls into the rtos (defined by the rtos) using this interface.  be it arm or x86 the calls are really arbitrary, logic doesnt dictate, the software dictates, traditionally x86 has bios handlers for specific interrupts, but that is arbitrary, you can write your own bios/handler that is incompatible with tradition and it will work just fine so long as both sides agree on the interface, likewise swi/svc calls for arm are not necessarily a standard, linux might have one but freertos doesnt have to conform to that if they dont want to.</p>\n\n<p>another difference in the case of the cortex-m but is not necessarily a universal differences nor required, is that the so called external interrupts which are external to the core but generally tied to items provided by the chip vendor, have or may have an extra layer of masking, so that you can disable them using an interrupt controller, where the event type interrupts like undefined, systick, etc although are just signals do not go through a masked layer.  not universally true for all architectures from all vendors (arm, intel, mips, etc), but if I remember right in the case of the cortex-m this is how they implemented it.  granted there continue to be new cores coming out and there is no reason whatsoever for them to design all of them the same way.</p>\n"}, {"tags": [], "owner": {"reputation": 394, "user_id": 4179130, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ChCmGcSyIbE/AAAAAAAAAAI/AAAAAAAAFOg/Ce-4JcP2VSk/photo.jpg?sz=128", "display_name": "jedzej", "link": "https://stackoverflow.com/users/4179130/jedzej"}, "is_accepted": false, "score": 6, "last_activity_date": 1510840986, "creation_date": 1510840986, "answer_id": 47331677, "question_id": 47308496, "link": "https://stackoverflow.com/questions/47308496/difference-between-software-and-hardware-interrupts/47331677#47331677", "title": "Difference between Software and Hardware Interrupts", "body": "<p>I think you're trying to figure out what are software interrupts needed for and how to use them rather than the difference.</p>\n\n<p>Let's start with what's common for software and hardware interrupt: they're both used to switch from main execution context to low-level interrupt handler in order to perform some low level operations - mainly on peripheral register.</p>\n\n<p>The purpose of this switch for <strong>hardware interrupts</strong> is that the <strong>hardware</strong> wants to pass some data to the <strong>program</strong> (GPIO toggled, new chars on UART arrived, etc). It's easy to understand, since when you're writing your program, all you need to do is to implement the handlers - whenever HW needs your action, the handler is called.</p>\n\n<p>The purpose of this switch for <strong>software interrupts</strong> is that the <strong>program</strong> wants to pass some data to the <strong>hardware</strong>. More specifically, it wants to access some resources which cannot be accessed from current context. It applies to a common design, where we don't want high level applications to mess with the hardware, e.g. write directly to flash or change USB control registers, so we block it from upper layers and delegate this task to the OS core (like linux kernel). The core receives requests via software interrupt from upper layers, performs some HW-related operations and returns responses. \nSoftware interrupts are also be used to trigger OS maintenance tasks - e.g. context switch when currently executed task blocks on mutex.</p>\n\n<p>It's harder to understand, since in contrary to HW interrupts the programmer must implement both - handlers and callers.</p>\n\n<hr>\n\n<p>Of course my explanation is a big simplification, but I hope it should help you to understand the general idea. If you are not implementing you OS or very complex bare metal app, you probably don't need this at all. And you should rather avoid modifying software interrupts related code when using OS, since the system may rely on them.</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10798176, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/65688ebf31508ffba6732a1412655769?s=128&d=identicon&r=PG", "display_name": "AMOS Mwololo Jkuat kenya", "link": "https://stackoverflow.com/users/10798176/amos-mwololo-jkuat-kenya"}, "is_accepted": false, "score": 0, "last_activity_date": 1544981705, "creation_date": 1544981705, "answer_id": 53804794, "question_id": 47308496, "link": "https://stackoverflow.com/questions/47308496/difference-between-software-and-hardware-interrupts/53804794#53804794", "title": "Difference between Software and Hardware Interrupts", "body": "<p>Hardware interrupt is triggered by hardware like soundchip while software interrupt is triggered by software since it is a program instruction</p>\n"}], "owner": {"reputation": 63, "user_id": 7364080, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a5c2d0faf8d6436bbde38b956c2e846?s=128&d=identicon&r=PG&f=1", "display_name": "anandamu16", "link": "https://stackoverflow.com/users/7364080/anandamu16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9824, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1544981705, "creation_date": 1510752080, "question_id": 47308496, "link": "https://stackoverflow.com/questions/47308496/difference-between-software-and-hardware-interrupts", "title": "Difference between Software and Hardware Interrupts", "body": "<p>I have recently started working on ARM Cortex Microcontrollers. While reading different articles over Internet, I usually found 2 common terms as Software Interrupt and Hardware Interrupt.\nWhat is the actual difference in both? Can you explain with an example?</p>\n"}, {"tags": ["c", "fits"], "owner": {"reputation": 31, "user_id": 8853394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bvTW7.jpg?s=128&g=1", "display_name": "Samuel Gill", "link": "https://stackoverflow.com/users/8853394/samuel-gill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510750643, "creation_date": 1510750643, "question_id": 47308036, "link": "https://stackoverflow.com/questions/47308036/what-is-the-correct-way-to-access-a-large-fits-grid-in-c-with-cfitsio", "title": "What is the correct way to access a large fits grid in C with CFITSIO", "body": "<p>I have two fits grid which I am accessing with CFITSIO (<a href=\"https://heasarc.gsfc.nasa.gov/fitsio/c\" rel=\"nofollow noreferrer\">https://heasarc.gsfc.nasa.gov/fitsio/c</a>). Now, the first grid is 1071 (row) x 3 (cols) and of the float data type. I can access this fine and print the output of each entry. When I repeat this code for my second grid (a large grid (1.1 Gb) which is 1071 x 262144 and also of the float data type, I get a Segmentation fault. Before I carry on, here's the code:</p>\n\n<pre><code>#FILE Cspec.c\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include \"fitsio.h\"\n#include \"load_data.h\"\n#include \"general_functions.h\"\n\n\n#define MAX_ROW 230746\n#define N 131072\n#define WAVEMIN 450.0\n#define WAVEMAX 650.0\n\n\nvoid printerror( int status)\n{\n/*****************************************************/\n/* Print out cfitsio error messages and exit program */\n/*****************************************************/\n\n\nif (status)\n{\n   fits_report_error(stderr, status); /* print error report */\n\n   exit( status );   \n}\nreturn;\n}\n\n\n\nint main()\n{   /*----------------------------\n    Now load the table\n----------------------------*/\nprintf(\"\\n\\n--------------------\\nLoading the models..\\n--------------------\");\nfflush(stdout);\n\n// Imports and definitions\nfitsfile *fptr;       /* pointer to the FITS file, defined in fitsio.h */\nint status, anynull;\nlong naxes[2], fpixel, nbuffer, npixels, ii;\nchar filename[]  = \"models.fits\";     /* name of existing FITS file   */\nstatus = 0;\n\n// Open the file and kick off if its not there\nif ( fits_open_file(&amp;fptr, filename, READONLY, &amp;status) )\n    printerror( status );\n\n/* read the NAXIS1 and NAXIS2 keyword to get image size */\n//if ( fits_read_keys_lng(fptr, \"NAXIS\", 1, 2, naxes, &amp;nfound, &amp;status) )\n//      printerror( status );\n\n// Define the rows and columns of fits image and thus the buffer size\nnaxes[0] = 1017;\nnaxes[1] = 262144;\n    size_t buffsize = ((size_t) (naxes[1] * naxes[0]) + (naxes[1] * sizeof(float)));\nfloat nullval, buffer[buffsize];\nnpixels  = naxes[0] * naxes[1];         /* number of pixels in the image */\nfpixel   = 1;\nnullval  = 0;                /* don't check for null values in the image */\n\nwhile (npixels &gt; 0)\n{\n    nbuffer = npixels;\n    if (npixels &gt; buffsize)\n    nbuffer = buffsize;     /* read as many pixels as will fit in buffer */\n\n    if ( fits_read_img(fptr, TFLOAT, fpixel, nbuffer, &amp;nullval,\n      buffer, &amp;anynull, &amp;status) )\n    printerror( status );\n\n    for (ii = 0; ii &lt; nbuffer; ii++)  \n    {\n        // Output the value\n        printf(\"%f\\t\", buffer[ii]);\n    }\n    npixels -= nbuffer;    /* increment remaining number of pixels */\n    fpixel  += nbuffer;    /* next pixel to be read in image */\n}\n\nif ( fits_close_file(fptr, &amp;status) )\n    printerror( status );\n\nreturn 0;\n}\n</code></pre>\n\n<p>I compile using:</p>\n\n<pre><code>nvcc Cspec2.c general_functions.c load_data.c -I/iraf/iraf/vendor/cfitsio  /iraf/iraf/vendor/cfitsio/libcfitsio.a  -lm -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\n</code></pre>\n\n<p>The other c files (general_functions.c and load_data.c) are not relevant. The reason for the last two flags comes from <a href=\"https://heasarc.gsfc.nasa.gov/fitsio/c/f_user/node13.html\" rel=\"nofollow noreferrer\">https://heasarc.gsfc.nasa.gov/fitsio/c/f_user/node13.html</a> which describe the size limits when working with fits files. One thing this says (para 4):</p>\n\n<p>\"If CFITSIO is compiled with the -D_LARGEFILE_SOURCE and -D_FILE_OFFSET_BITS=64 flags on a platform that supports large files, then it can read and write FITS files that contain up to 2**31 2880-byte FITS records, or approximately 6 terabytes in size. It is still required that the value of the NAXISn and PCOUNT keywords in each extension be within the range of a signed 4-byte integer (max value = 2,147,483,648). Thus, each dimension of an image (given by the NAXISn keywords), the total width of a table (NAXIS1 keyword), the number of rows in a table (NAXIS2 keyword), and the total size of the variable-length array heap in binary tables (PCOUNT keyword) must be less than this limit.\" </p>\n\n<p>I assumed that adding these flags would sort this out since 1071*262,144 = 280,756,224 which is below the range of a signed 4-byte integer (max value = 2,147,483,648). There is also more information here ( <a href=\"https://heasarc.gsfc.nasa.gov/fitsio/c/c_user/node32.html\" rel=\"nofollow noreferrer\">https://heasarc.gsfc.nasa.gov/fitsio/c/c_user/node32.html</a> ). Where am I going wrong? Why does this cause a seg fault? This code works fine with the smaller grid (1071*3). I assume I have to add some extra compiler flags or change something in my code? Could the problem lie in the fact I am using cfitsio from an IRAF distribution? </p>\n\n<p>One thing I found from de-bugging is that I could not output the \"buffsize\" variable - this on it's own lead to a seg fault. </p>\n\n<p>I am running 64 bit Ubuntu 16.04 LTS and I am using the nvcc compiler as I plan to offload some later work to the GPU. I'm still relatively new to C (from python). </p>\n\n<p>Thanks</p>\n\n<p>Sam</p>\n"}, {"tags": ["python", "c", "python-2.7"], "comments": [{"owner": {"reputation": 3925, "user_id": 3815611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b153a6443c973aea03f8314127f33a?s=128&d=identicon&r=PG&f=1", "display_name": "BlackJack", "link": "https://stackoverflow.com/users/3815611/blackjack"}, "edited": false, "score": 0, "creation_date": 1510759762, "post_id": 47307993, "comment_id": 81573142, "body": "In the title it says <i>exception</i> but in the text is says <i>crash</i> - which is it? You are not checking the result of the <code>PyImport_Import()</code> call."}, {"owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "reply_to_user": {"reputation": 3925, "user_id": 3815611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b153a6443c973aea03f8314127f33a?s=128&d=identicon&r=PG&f=1", "display_name": "BlackJack", "link": "https://stackoverflow.com/users/3815611/blackjack"}, "edited": false, "score": 0, "creation_date": 1510774507, "post_id": 47307993, "comment_id": 81582502, "body": "@BlackJack I don&#39;t know if is a exception. If I add import Adafruit_ILI9341 in python file, my C program close when call PyModule_GetDict(pModule) function"}, {"owner": {"reputation": 3925, "user_id": 3815611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b153a6443c973aea03f8314127f33a?s=128&d=identicon&r=PG&f=1", "display_name": "BlackJack", "link": "https://stackoverflow.com/users/3815611/blackjack"}, "edited": false, "score": 0, "creation_date": 1510780399, "post_id": 47307993, "comment_id": 81585697, "body": "Again: you are not checking the result of the <code>PyImport_Import()</code> call."}, {"owner": {"reputation": 3925, "user_id": 3815611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b153a6443c973aea03f8314127f33a?s=128&d=identicon&r=PG&f=1", "display_name": "BlackJack", "link": "https://stackoverflow.com/users/3815611/blackjack"}, "edited": false, "score": 0, "creation_date": 1510842008, "post_id": 47307993, "comment_id": 81614833, "body": "<a href=\"http://www.effbot.org/pyfaq/what-does-systemerror-pyimport-fixupextension-module-yourmodule-not-loaded-mean.htm\" rel=\"nofollow noreferrer\">What does &quot;SystemError: _PyImport_FixupExtension: module yourmodule not loaded&quot; mean?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 0, "creation_date": 1510839425, "post_id": 47326821, "comment_id": 81612835, "body": "Thanks @BlackJack. The last night I added the NULL check and PyErr_Print and I saw why it fails, but not seems easy to fix. I&#39;m coding other modules and I forgotten comment here."}, {"owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 0, "creation_date": 1510840470, "post_id": 47326821, "comment_id": 81613678, "body": "I edited my question, but I think that I must open new question for this"}], "tags": [], "owner": {"reputation": 3925, "user_id": 3815611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b153a6443c973aea03f8314127f33a?s=128&d=identicon&r=PG&f=1", "display_name": "BlackJack", "link": "https://stackoverflow.com/users/3815611/blackjack"}, "is_accepted": true, "score": 1, "last_activity_date": 1510826920, "creation_date": 1510826920, "answer_id": 47326821, "question_id": 47307993, "link": "https://stackoverflow.com/questions/47307993/exception-when-call-pymodule-getdict-with-a-specific-python-import/47326821#47326821", "title": "Exception when call PyModule_GetDict() with a specific python import", "body": "<p>I see at least five problems, with all but two being not checking for <code>NULL</code> values.</p>\n\n<p>You are not checking the return value of <code>PyImport_Import()</code>.  If there is a problem/exception while importing the <code>lcd</code> module your code continues as if nothing happened.</p>\n\n<p>Also the return value of <code>PyDict_GetItemString()</code> isn't really checked against <code>NULL</code>.  <code>PyCallable_Check()</code> is applied, but it is somewhat redundant because <code>PyObject_CallObject()</code> already checks if the argument is callable.</p>\n\n<p>Of course you are not checking the return value of <code>PyObject_CallObject()</code> if it is <code>NULL</code>.</p>\n\n<p><code>PyErr_Print()</code> is potentially called even when there is no error/exception which the documentation clearly states will cause a fatal error.</p>\n\n<p>Finally <code>PyInt_AsLong()</code> is called with a potentially uninitialized <code>presult</code> pointer.  And given the example code it is definately uninitialized because the Python code contains no <code>initLCD()</code> so <code>pFunc</code> is <code>NULL</code> and <code>presult</code> never gets assigned a value.</p>\n\n<p>So you better initialize each pointer to <code>NULL</code> and check each and every return value.</p>\n\n<pre><code>PyObject *pName = NULL;\nPyObject *pModule = NULL;\nPyObject *pFunc = NULL;\nPyObject *presult = NULL;\n\nsetenv(\"PYTHONPATH\", \".\", 1);\nPy_Initialize();\n\nif ((pName = PyString_FromString(\"lcd\"))) {\n    if ((pModule = PyImport_Import(pName))) {   \n        if ((pFunc = PyObject_GetAttrString(pModule, \"initLCD\"))) {\n            if ((presult = PyObject_CallObject(pFunc, NULL))) {\n                printf(\"Result is %d\\n\", (int) PyInt_AsLong(presult));\n            }\n        }\n    }\n}\nif (PyErr_Occurred()) PyErr_Print();\n\nPy_XDECREF(presult);\nPy_XDECREF(pFunc);\nPy_XDECREF(pModule);\nPy_XDECREF(pName);\n\nPy_Finalize();\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 47326821, "answer_count": 1, "score": 1, "last_activity_date": 1510840300, "creation_date": 1510750482, "last_edit_date": 1510840300, "question_id": 47307993, "link": "https://stackoverflow.com/questions/47307993/exception-when-call-pymodule-getdict-with-a-specific-python-import", "title": "Exception when call PyModule_GetDict() with a specific python import", "body": "<p>I want manage a LCD from my C code doing calls to python. I'm newbie in that.\nMy python app works perfectly with LCD. No problems with libraries that are used in my python code. Python2.7\nMy problem ocurrs when I call to PyModule_GetDict function. If I added a specific library import into python file, my C program crash.\nThe library is Adafruit_ILI9341, and if I not import it, the C program runs correct.</p>\n\n<p>Is it possible that there are incompatible libraries with Python interpeter?\nHow I can debug this problem?</p>\n\n<p>Thanks a lot!</p>\n\n<p>This is my C code:</p>\n\n<pre><code>// Set PYTHONPATH TO working directory\nsetenv(\"PYTHONPATH\",\".\",1);\n\nPyObject *pName, *pModule, *pDict, *pFunc, *presult;\n// Initialize the Python Interpreter\nPy_Initialize();\n\n// Build the name object\npName = PyString_FromString((char*)\"lcd\");\n\n// Load the module object\npModule = PyImport_Import(pName);\n\n// pDict is a borrowed reference \npDict = PyModule_GetDict(pModule);\n\n// pFunc is also a borrowed reference \npFunc = PyDict_GetItemString(pDict, (char*)\"initLCD\");\n\nif (PyCallable_Check(pFunc)) {\n    printf(\"Let's give this a shot!\\n\");\n    presult=PyObject_CallObject(pFunc,NULL);\n    PyErr_Print();\n} else {\n    PyErr_Print();\n}\nprintf(\"Result is %d\\n\",PyInt_AsLong(presult));\n\n// Clean up\nPy_DECREF(pModule);\nPy_DECREF(pName);\n\n// Finish the Python Interpreter\nPy_Finalize();\n</code></pre>\n\n<p>and this is the python code:</p>\n\n<pre><code>from PIL import Image\nfrom PIL import ImageDraw\nfrom PIL import ImageFont\nimport os\nimport threading\nfrom threading import Timer\n\nimport Adafruit_ILI9341 as ADAFRUIT_TFT\nimport Adafruit_GPIO as GPIO\nimport Adafruit_GPIO.SPI as SPI\nimport RPi.GPIO as LCD_GPIO\n\nimport time\nimport locale\n\ndef iniciaDisplay():\n    LCD_GPIO.setwarnings(False)\n    LCD_GPIO.setmode(LCD_GPIO.BCM)\n    LCD_GPIO.setup(5, LCD_GPIO.OUT)\n    p = LCD_GPIO.PWM(5, 100)\n    p.start(1)\n    DC = 24\n    RST = 25\n    SPI_PORT = 0\n    SPI_DEVICE = 0\n\n    disp = ADAFRUIT_TFT.ILI9341(DC, rst=RST, spi=SPI.SpiDev(SPI_PORT, SPI_DEVICE, max_speed_hz=64000000))\n    disp.begin()\n    disp.clear()\n    disp.display(getLogo(0))\n\n    return 0\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Following the advices of @BlackJack I added the NULL check and PyErr_Print and I saw why it fails. The problem is caused by a _io library import.<br>\nThis is the output checking NULL values and PyErr_Print:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"/home/pi/pruebas/DESFIREXip32/tft.py\", line 18, in &lt;module&gt;\n    import Adafruit_ILI9341 as ADAFRUIT_TFT\n  File \"build/bdist.linux-armv7l/egg/Adafruit_ILI9341/__init__.py\", line 21, in &lt;module&gt;\n  File \"build/bdist.linux-armv7l/egg/Adafruit_ILI9341/ILI9341.py\", line 23, in &lt;module&gt;\n  File \"/usr/lib/python2.7/dist-packages/numpy/__init__.py\", line 153, in &lt;module&gt;\n    from . import add_newdocs\n  File \"/usr/lib/python2.7/dist-packages/numpy/add_newdocs.py\", line 13, in &lt;module&gt;\n    from numpy.lib import add_newdoc\n  File \"/usr/lib/python2.7/dist-packages/numpy/lib/__init__.py\", line 22, in &lt;module&gt;\n    from .npyio import *\n  File \"/usr/lib/python2.7/dist-packages/numpy/lib/npyio.py\", line 4, in &lt;module&gt;\n    from . import format\n  File \"/usr/lib/python2.7/dist-packages/numpy/lib/format.py\", line 141, in &lt;module&gt;\n    import io\n  File \"/usr/lib/python2.7/io.py\", line 51, in &lt;module&gt;\n    import _io\nSystemError: _PyImport_FixupExtension: module _io not loaded\n</code></pre>\n\n<p>I think this error should treat it in a new thread.</p>\n"}, {"tags": ["c++", "sql", "c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1510750924, "post_id": 47307877, "comment_id": 81566476, "body": "Google Pro<i>C and copy pasta parts of your code, and you get very similar blobs of magic numbers. Of course this is auto-generated, I would be _very_ concerned if a human wrote ugly code like that. Perhaps it originates from Pro</i>C and is maintained manually? However, I don&#39;t know these tools so I&#39;ll refrain from posting an answer."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1510751701, "post_id": 47307877, "comment_id": 81567006, "body": "I suspect that you might be getting a &quot;programmer&#39;s answer&quot; - the file <i>in its current state</i> wasn&#39;t generated by Pro*C since it&#39;s been edited by hand. (Some programmers will provide an answer to what you say rather than to what you mean.)"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 1765967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/68f5edbdbcbc5366d8643fb3364c2833?s=128&d=identicon&r=PG", "display_name": "varrtto", "link": "https://stackoverflow.com/users/1765967/varrtto"}, "is_accepted": true, "score": 0, "last_activity_date": 1512567918, "creation_date": 1512567918, "answer_id": 47675829, "question_id": 47307877, "link": "https://stackoverflow.com/questions/47307877/was-my-c-file-generated-from-proc/47675829#47675829", "title": "Was my C file generated from Pro*C", "body": "<p>Yes, it was generated by Pro<em>C. sqlcud or CUD (Compilation Unit Data) Array, is generated by Pro</em>C, but it\u00b4s structure was not revealed by Oracle.</p>\n\n<p>Also, we found an old manual in the developers site where it proudly stated that Pro*C was used to create the software.</p>\n\n<p>Thanks everyone.</p>\n"}], "owner": {"reputation": 101, "user_id": 1765967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/68f5edbdbcbc5366d8643fb3364c2833?s=128&d=identicon&r=PG", "display_name": "varrtto", "link": "https://stackoverflow.com/users/1765967/varrtto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 47675829, "answer_count": 1, "score": 0, "last_activity_date": 1512567918, "creation_date": 1510750159, "last_edit_date": 1510750384, "question_id": 47307877, "link": "https://stackoverflow.com/questions/47307877/was-my-c-file-generated-from-proc", "title": "Was my C file generated from Pro*C", "body": "<p>We are in the process of inhereting an application from another developer. To support it properly we are first auditing what's working and what's missing in the application, and if all the fonts compile to the matching binaries.</p>\n\n<p>During this process, we found a C file, which to my little knowledge in the subject, seems to have been generated from a Pro*C file.</p>\n\n<p>When confronted, the previous developer says it is NOT generated from a Pro*C and that he just modifies it in Visual Studio (Odd). It seems close to imposible to maintain such a file as it is. Let me show you some things in it:</p>\n\n<pre><code>/* CUD (Compilation Unit Data) Array */\nstatic short sqlcud0[] =\n{12,4130,31,0,0,\n5,0,0,0,0,0,27,980,0,0,4,4,0,1,0,1,9,0,0,1,10,0,0,1,10,0,0,1,10,0,0,\n36,0,0,2,60,0,4,984,0,0,1,0,0,1,0,2,3,0,0,\n55,0,0,3,74,0,2,1000,0,0,3,3,0,1,0,1,3,0,0,1,3,0,0,1,3,0,0,\n82,0,0,4,0,0,29,1077,0,0,0,0,0,1,0,\n</code></pre>\n\n<p>This array goes on for over 17 thousand characters.</p>\n\n<p>Or even:</p>\n\n<pre><code>static struct sqlcxp sqlfpn =\n{\n    10,\n    \"nameoftheCfile.pc\"\n};\n</code></pre>\n\n<p>So, I was wondering, is it possible that he is really using some Visual Studio tool to generate this C file, and it's not really a Pro<em>C?\nIs it possible that Visual Studio or other tool generates this file, and he is unaware that it comes from a Pro</em>C file?\nIs it possible to confirm a 100% that this is actually a compiled Pro*C file?</p>\n\n<p>I'm hoping this is just a misunderstanding with the previous developer and not that he is refusing to give us the original fonts...</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "macos", "api"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8946374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2511d19087624da1a83e6a7997d681?s=128&d=identicon&r=PG&f=1", "display_name": "mattc", "link": "https://stackoverflow.com/users/8946374/mattc"}, "is_accepted": true, "score": 1, "last_activity_date": 1510762843, "creation_date": 1510762843, "answer_id": 47312404, "question_id": 47307840, "link": "https://stackoverflow.com/questions/47307840/how-to-retrieve-os-version-details-and-all-network-adapter-info-in-macos/47312404#47312404", "title": "How to retrieve OS version details and all network adapter info in macOS?", "body": "<p><strong>For the OS version:</strong></p>\n\n<p>On the command line:</p>\n\n<pre><code>$ sysctl kern.osrelease\nkern.osrelease: 12.0.0\n$ sysctl kern.osversion\nkern.osversion: 12A269\n</code></pre>\n\n<p>Programmatically:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;sys/sysctl.h&gt;\n\nchar str[256];\nsize_t size = sizeof(str);\nint ret = sysctlbyname(\"kern.osrelease\", str, &amp;size, NULL, 0);\n</code></pre>\n\n<p>Darwin version to OS X release:</p>\n\n<pre><code>16.x.x  macOS 10.12.x Sierra\n15.x.x  OS X  10.11.x El Capitan\n14.x.x  OS X  10.10.x Yosemite\n13.x.x  OS X  10.9.x  Mavericks\n12.x.x  OS X  10.8.x  Mountain Lion\n11.x.x  OS X  10.7.x  Lion\n10.x.x  OS X  10.6.x  Snow Leopard\n 9.x.x  OS X  10.5.x  Leopard\n 8.x.x  OS X  10.4.x  Tiger\n 7.x.x  OS X  10.3.x  Panther\n 6.x.x  OS X  10.2.x  Jaguar\n 5.x    OS X  10.1.x  Puma\n</code></pre>\n\n<p>For the network adapter you could run something like:</p>\n\n<pre><code>networksetup -listallhardwareports\n</code></pre>\n\n<p>And parse it out </p>\n"}], "owner": {"reputation": 180, "user_id": 1145755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5GhI4.jpg?s=128&g=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/1145755/sourabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 47312404, "answer_count": 1, "score": 0, "last_activity_date": 1510762843, "creation_date": 1510750061, "last_edit_date": 1510751438, "question_id": 47307840, "link": "https://stackoverflow.com/questions/47307840/how-to-retrieve-os-version-details-and-all-network-adapter-info-in-macos", "title": "How to retrieve OS version details and all network adapter info in macOS?", "body": "<p>I am developing a tool which supposes to collect information about a client if installed by the user. This tool will be collecting information like \nOS version, MAC addresses, IP4, registered username and computer name.</p>\n\n<p>I am very new to macOS, so please help me out and give references or any relevant links.</p>\n"}, {"tags": ["c", "stdin"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1510749057, "post_id": 47307428, "comment_id": 81565107, "body": "&quot;but react to every character before the input of the next character&quot; This is absolutely not possible in standard C. You have to use third-party or platform-dependent APIs."}, {"owner": {"reputation": 1085, "user_id": 5077133, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ygDcH.jpg?s=128&g=1", "display_name": "Mickey", "link": "https://stackoverflow.com/users/5077133/mickey"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510749146, "post_id": 47307428, "comment_id": 81565174, "body": "@BadMiscuit But that wouldn&#39;t help me in applying calculations before the input of the next characters, or I didn&#39;t understand you"}, {"owner": {"reputation": 1085, "user_id": 5077133, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ygDcH.jpg?s=128&g=1", "display_name": "Mickey", "link": "https://stackoverflow.com/users/5077133/mickey"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510749182, "post_id": 47307428, "comment_id": 81565200, "body": "@n.m. wow, that is pretty surprising.. I come from other languages."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510749282, "post_id": 47307428, "comment_id": 81565287, "body": "What languages?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1510749626, "post_id": 47307428, "comment_id": 81565559, "body": "This might help: <a href=\"https://stackoverflow.com/a/7469410/1679849\">stackoverflow.com/a/7469410/1679849</a>"}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1510753303, "post_id": 47307885, "comment_id": 81568206, "body": "<code>c != EOF</code> - This does not make sense as <code>c</code> is a char. EOF is outside the range of <code>char</code>"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1510753623, "post_id": 47307885, "comment_id": 81568413, "body": "This code also suffers from the exact same line buffering problem that the OP is trying to overcome."}], "tags": [], "owner": {"reputation": 1, "user_id": 8907248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c03db66f640048b85045b8b5597a12f7?s=128&d=identicon&r=PG&f=1", "display_name": "Chandanard", "link": "https://stackoverflow.com/users/8907248/chandanard"}, "is_accepted": false, "score": -2, "last_activity_date": 1510750699, "last_edit_date": 1510750699, "creation_date": 1510750184, "answer_id": 47307885, "question_id": 47307428, "link": "https://stackoverflow.com/questions/47307428/reading-character-by-character-from-stdin-until-eof-in-c/47307885#47307885", "title": "Reading character by character from stdin until EOF in C", "body": "<p>scanf manual says :</p>\n\n<p>\"The  value  EOF is returned if the end of input is reached before either the first successful conversion or a\n       matching failure occurs.  EOF is also returned if a read error occurs, in which case the error indicator  for\n       the stream (see ferror(3)) is set, and errno is set indicate the error.\"</p>\n\n<p>.. better use a do..while approch with scanf in this case (and if you want store return of scanf to check for errors) :</p>\n\n<pre><code>char c;\n\ndo{\n  scanf(\"%c\",&amp;c);\n  /* DO SOME CALCULATIONS ON 'c' */\n}while(c != EOF);\n</code></pre>\n\n<p>same with getchar() in raw mode will react to each user keystroke</p>\n\n<p>see this for using raw mode : <a href=\"https://stackoverflow.com/a/22517349/8907248\">https://stackoverflow.com/a/22517349/8907248</a></p>\n"}], "owner": {"reputation": 1085, "user_id": 5077133, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ygDcH.jpg?s=128&g=1", "display_name": "Mickey", "link": "https://stackoverflow.com/users/5077133/mickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1705, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510750699, "creation_date": 1510748870, "question_id": 47307428, "link": "https://stackoverflow.com/questions/47307428/reading-character-by-character-from-stdin-until-eof-in-c", "title": "Reading character by character from stdin until EOF in C", "body": "<p>I'm trying to read a string in C until EOF, but react to every character before the input of the next character.\nFor example: \nA user inputs <code>abcd</code>, and right after every character input, I will do some calculations on each character.\nI have tried to approach this in two different ways:</p>\n\n<p>Option 1, using getchar():</p>\n\n<pre><code>int d;\nchar c;\n\nwhile ((d = getchar()) != EOF) {\n    c = (char)d;\n    &lt;&lt;&lt; DO SOME CALCULATIONS ON 'c'&gt;&gt;&gt;\n    }\n</code></pre>\n\n<p>Option 2, using scanf:</p>\n\n<pre><code>char c;\nwhile (scanf(\" %c\",&amp;c) != EOF) {\n    &lt;&lt;&lt; DO SOME CALCULATIONS ON 'c'&gt;&gt;&gt;\n}\n</code></pre>\n\n<p>However, both approaches seem to fail. It seems that the getchar() and scanf() gets all the characters until it encounters the 'EOF', and only then enters the while loop.</p>\n\n<p>Would love some help on this,\nThanks!</p>\n"}, {"tags": ["c", "linux", "fork", "waitpid"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510748863, "post_id": 47307350, "comment_id": 81564947, "body": "Third instance of this homework:("}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510748865, "post_id": 47307350, "comment_id": 81564948, "body": "That&#39;s not how it works. I recommend you <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">read the <code>waitpid</code> manual page</a> and check what it <i>returns</i>."}, {"owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "edited": false, "score": 0, "creation_date": 1510749314, "post_id": 47307350, "comment_id": 81565310, "body": "You mean &quot;check stop&quot; of WIFSTOPPED() is different from what I said?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1510751892, "post_id": 47307350, "comment_id": 81567140, "body": "What do you think it means for a process to be stopped? Your incomplete program fragment doesn&#39;t give us many clues, but you should know that neither <code>pause()</code> nor <code>sleep()</code> have anything to do with it. &quot;Stopped&quot; means &quot;suspended&quot;."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1510770869, "post_id": 47307350, "comment_id": 81580449, "body": "<code>waitpid()</code>  (when not used in conjunction with a <code>ptrace</code>d process) needs <code>WUNTRACED</code> to receive <code>WIFSTOPPED</code> notifications."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "edited": false, "score": 0, "creation_date": 1510798681, "post_id": 47314701, "comment_id": 81592060, "body": "Thank you for help. now I realize I used wrong function. waitpid is for detecting more critical problems, not  pause()"}, {"owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "edited": false, "score": 0, "creation_date": 1510798723, "post_id": 47314701, "comment_id": 81592067, "body": "I should have to use other methods like proc/pid/status"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1510770364, "creation_date": 1510770364, "answer_id": 47314701, "question_id": 47307350, "link": "https://stackoverflow.com/questions/47307350/getpid-wifshstoppedstate-to-check-child-process-sleeping/47314701#47314701", "title": "getpid(), WIFSHSTOPPED(state) to check child process sleeping", "body": "<p>if <code>child</code> is completed <code>normally</code>( after delay got over) then you can use <code>WIFEXITED(status)</code>, it will be true if child has exited normally.</p>\n\n<p>if child got <code>killed</code>(using kill command from other terminal) or suspended by any <strong>signal</strong> from other process or same process then you can use <code>WIFSIGNALED(status)</code>. </p>\n\n<p>according to your requirement I modify your code as</p>\n\n<pre><code>int main()\n{\n\n        if(fork()==0) // p1\n        {\n                int t;\n                srand(getpid());\n                t = rand()%10 +1;//generating delay b/w 1 to 10 seconds\n                printf(\"child1 delay : [%d] pid : [%d] ppid : [%d] \\n\",t,getpid(),getppid());\n                sleep(t);\n                printf(\"child1 pid : [%d] and its ppid : [%d] exiting \\n\",getpid(),getppid());\n                exit(0);\n        }\n        else\n        {\n                if(fork()==0) // p2\n                {\n                        int t;\n                        srand(getpid());\n                        t = rand()%10 +1;//generating delay b/w 1 to 10 seconds\n                        printf(\"child2 delay : [%d] pid : [%d] ppid : [%d] \\n\",t,getpid(),getppid());\n                        sleep(t);\n                        printf(\"child2 pid : [%d] and its ppid : [%d] exiting \\n\",getpid(),getppid());\n                        exit(1);\n                }\n                else // p3\n                {\n                        int status;\n                        printf(\"In parent...[%d]\\n\",getpid());\n                        int ret;\n                        while((ret = waitpid(-1,&amp;status,0))!=-1)//when there is no child left it returns -1\n                        {\n                                if(WIFEXITED(&amp;status))//if child is completed normally after sleep is over\n                                {\n                                        printf(\"child [%d] terminates normally : %d\\n\",ret,WEXITSTATUS(status));\n                                }\n                                if(WIFSIGNALED(&amp;status))//true if child was killed by any signal from other process or same process\n                                {\n                                        printf(\"child [%d] terminates normally : %d\\n\",ret,WTERMSIG(status));//it will print the signal no by which it was killed\n                                }\n                        }\n                }\n        }\n        return 0;\n}\n</code></pre>\n\n<p>there is no need to <code>pause()</code> because you should use <code>pause()</code> when one process should blocked until it is not received signal from other process.</p>\n\n<p>Kindly go through man page of <code>waitpid()</code>.</p>\n"}], "owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510770364, "creation_date": 1510748655, "question_id": 47307350, "link": "https://stackoverflow.com/questions/47307350/getpid-wifshstoppedstate-to-check-child-process-sleeping", "title": "getpid(), WIFSHSTOPPED(state) to check child process sleeping", "body": "<p>Hello Im making program using 3 process P0,P1,P2\nI wanna make a CYCLE like below</p>\n\n<pre><code>init: P0 P1,P2 paused, signal to P0\nP0 : wake up by signal -&gt; finish job -&gt; signal to P3 -&gt; pause\nP1 : wake up by signal -&gt; finish job -&gt; signal to P2 -&gt; pause\nP2 : wake up by signal -&gt; finish job -&gt; signal to P3 -&gt; pause\nrepeat 0~2\n</code></pre>\n\n<p>Unfortunatly, SOMETIMES signal comes before target process sleep</p>\n\n<p>So I wanna check target process is paused or not.\nI insert [checking code] like this</p>\n\n<pre><code>//end job here here\n//\nint status = 0;\ndo {\n    waitpid(target_pid, &amp;status, WNOHANG); // WNOHANG : check child status without waiting\n} while ( ! WIFSTOPPED(status));           // linux man said that WIFSTOPPED\n                                           // return true if process stopped\n//signal to target_pid and pause() here\n</code></pre>\n\n<p>but it's not working.</p>\n\n<p>if i use</p>\n\n<pre><code> while( ! WIFSTOPPED(status))\n</code></pre>\n\n<p>program 100% can't get out of loop.</p>\n\n<p>if I use</p>\n\n<pre><code> while(   WIFSTOPPED(status))\n</code></pre>\n\n<p>It work as same as before I put [checking code]</p>\n\n<p>I know that waitpid function is for checking process ends.</p>\n\n<p>but CAN'T waitpid() JUST USED FOR CHECK PAUSED OR NOT?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1510748735, "post_id": 47307286, "comment_id": 81564868, "body": "make that <code>RF_InfoVal *info;</code> or call as <code>RF_getInfo(handle, infoType, &amp;info);</code>"}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 1, "creation_date": 1510748736, "post_id": 47307286, "comment_id": 81564869, "body": "The function takes a pointer to a union as argument,. You are giving it a union"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1510748842, "post_id": 47307286, "comment_id": 81564931, "body": "Please always copy&amp;paste your exact error message and don&#39;t type from your memory. You must have missed a &#39;*&#39; from the error message."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1510749392, "post_id": 47307286, "comment_id": 81565373, "body": "@PaulOgilvie: First suggestion will crash at runtime without malloc, so probably it would be better not to confuse OP."}, {"owner": {"reputation": 103, "user_id": 6817276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b99966733aa09850cc53f98bdfba4c9?s=128&d=identicon&r=PG&f=1", "display_name": "OcK", "link": "https://stackoverflow.com/users/6817276/ock"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1510750737, "post_id": 47307286, "comment_id": 81566337, "body": "@Paul Ogilvie that worked. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6817276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b99966733aa09850cc53f98bdfba4c9?s=128&d=identicon&r=PG&f=1", "display_name": "OcK", "link": "https://stackoverflow.com/users/6817276/ock"}, "edited": false, "score": 0, "creation_date": 1510750460, "post_id": 47307496, "comment_id": 81566133, "body": "yes thats true! Next time it will be a copy and paste :D."}], "tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": false, "score": 3, "last_activity_date": 1510749039, "creation_date": 1510749039, "answer_id": 47307496, "question_id": 47307286, "link": "https://stackoverflow.com/questions/47307286/argument-of-type-x-is-incompatible-with-parameter-of-type-x/47307496#47307496", "title": "argument of type &quot;x&quot; is incompatible with parameter of type x", "body": "<p>What you're doing wrong is that you aren't paying attention to what you're reading. <strong>Punctuation matters.</strong> <code>RF_InfoVal</code> and <code>RF_InfoVal*</code> are not the same thing. The first is a union, the second is a pointer to a union.</p>\n\n<p>The error message that you retranscribed had a <code>*</code>. That <code>*</code> is important.</p>\n\n<p>Here we can figure out that you made a mistake when retranscribing the error message \u2014\u00a0but that's because the mistake you made there is the same mistake that you made in your code. You should never retranscribe an error message. <strong>Always copy-paste</strong>. The same goes for your code: <a href=\"https://stackoverflow.com/help/mcve\">always copy-paste a full piece of code that reproduces the problem</a>.</p>\n"}], "owner": {"reputation": 103, "user_id": 6817276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b99966733aa09850cc53f98bdfba4c9?s=128&d=identicon&r=PG&f=1", "display_name": "OcK", "link": "https://stackoverflow.com/users/6817276/ock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510758940, "creation_date": 1510748474, "last_edit_date": 1510758940, "question_id": 47307286, "link": "https://stackoverflow.com/questions/47307286/argument-of-type-x-is-incompatible-with-parameter-of-type-x", "title": "argument of type &quot;x&quot; is incompatible with parameter of type x", "body": "<p>There is a <code>union</code>:</p>\n\n<pre><code>typedef union {\n    RF_CmdHandle ch;                              \n    uint16_t     availRatCh;                     \n    bool         bRadioState;                     \n    void         *pScheduleMap;                   \n} RF_InfoVal;\n</code></pre>\n\n<p>which is used by a function:</p>\n\n<pre><code>RF_Stat RF_getInfo(RF_Handle h, RF_InfoType type, RF_InfoVal *pValue)\n</code></pre>\n\n<p>My variables are as following:</p>\n\n<pre><code>RF_handle handle;\nRF_InfoType infoType = 0;\nRF_InfoVal info;\n</code></pre>\n\n<p>when I use the function like this:</p>\n\n<pre><code>RF_Stat status =  RF_getInfo(handle, infoType, info);\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>argument of type \"RF_InfoVal\" is incompatible with parameter of type RF_InfoVal.\n</code></pre>\n\n<p>I would be very happy about an explanation what I'm doing wrong here.</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1510746699, "post_id": 47306632, "comment_id": 81563554, "body": "No, not for <i>any library</i>. Also, <code>string.h</code> is not a library. It is a header. Also this is very vague. What compiler, which operating system, <i>which library</i>?"}, {"owner": {"reputation": 9, "user_id": 8850944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6573c928f01c76cd4c6f37372e1ea80d?s=128&d=identicon&r=PG&f=1", "display_name": "Milo\u0161", "link": "https://stackoverflow.com/users/8850944/milo%c5%a1"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510746814, "post_id": 47306632, "comment_id": 81563631, "body": "Okay, my mistake, i did not know that, i am a begginer. I want to find list of all functions of string.h in c without searching for it online"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1510746872, "post_id": 47306632, "comment_id": 81563672, "body": "Here&#39;s the <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">list in C11 standard draft</a>. It is one document that you can download."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 1, "creation_date": 1510746923, "post_id": 47306632, "comment_id": 81563715, "body": "Just open and look inside <code>string.h</code> (OK, it&#39;s hard, but it answers question)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1510747408, "post_id": 47306632, "comment_id": 81564025, "body": "You find out which functions a library contains by reading its documentation. Which you must do anyway, in order to use those functions. Questions asking where to find documentation are off-topic here."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1510751076, "post_id": 47306632, "comment_id": 81566595, "body": "Read the header file. You have all the functions listed there."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 0, "last_activity_date": 1510747828, "last_edit_date": 1510747828, "creation_date": 1510747378, "answer_id": 47306917, "question_id": 47306632, "link": "https://stackoverflow.com/questions/47306632/finding-a-list-of-functions-in-library-in-c/47306917#47306917", "title": "Finding a list of functions in library in C", "body": "<p>You can just read it.</p>\n\n<p>It generally doesn't have much stuff other than function declarations. If you want to be sure you don't miss any includes from <code>string.h</code> recursively, you can read the prepossessed result:</p>\n\n<pre><code>cc -E  -include string.h -x c /dev/null \n</code></pre>\n\n<p>However, note that <code>string.h</code> is not a library. It's just a header that provides the declarations for a subset of a standard libc library (a library that gets linked to every hosted C program by default).</p>\n\n<p>Also, you should generally limit yourself to using those declarations in the header that are <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.24\" rel=\"nofollow noreferrer\">standardized</a> (in case some implementation declares any extras in its <code>string.h</code>), and to using them in a standard-sanctioned way.</p>\n"}], "owner": {"reputation": 9, "user_id": 8850944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6573c928f01c76cd4c6f37372e1ea80d?s=128&d=identicon&r=PG&f=1", "display_name": "Milo\u0161", "link": "https://stackoverflow.com/users/8850944/milo%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 47306917, "answer_count": 1, "score": -3, "last_activity_date": 1510751134, "creation_date": 1510746527, "question_id": 47306632, "link": "https://stackoverflow.com/questions/47306632/finding-a-list-of-functions-in-library-in-c", "title": "Finding a list of functions in library in C", "body": "<p>Is there a way of finding a list of functions of any library in c?</p>\n\n<p>For example, i would like to find all functions of library string.h without looking it up online.</p>\n"}, {"tags": ["c", "windows"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7162576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8b5cf261daf9dcc1965f43123bd6d02?s=128&d=identicon&r=PG&f=1", "display_name": "C.Edelweiss", "link": "https://stackoverflow.com/users/7162576/c-edelweiss"}, "edited": false, "score": 0, "creation_date": 1510844020, "post_id": 47312218, "comment_id": 81616329, "body": "thanks a lot, seems to be working, trying to implement it right now."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1510762285, "creation_date": 1510762285, "answer_id": 47312218, "question_id": 47306626, "link": "https://stackoverflow.com/questions/47306626/c-recursive-search-for-a-file-in-a-folder-and-subfolders/47312218#47312218", "title": "C Recursive search for a file in a folder and subfolders", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364418(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>FindFirstFile</code></a> to list all the files in a directory, then compare with each file. Or do a recursive search and search each sub directory.</p>\n\n<p>You can adjust the \"wildcard\" also.</p>\n\n<p>This example looks for <code>\"something.png\"</code> on <code>\"c:\\\\test\"</code>, if it doesn't find it, it will look in sub directories of <code>\"c:\\\\test\"</code></p>\n\n<p>Make sure you don't do a recursive search on <code>\"C:\\\"</code> because that's going to go through all the files on the drive.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;Windows.h&gt;\n\nint findfile_recursive(const char *folder, const char *filename, char *fullpath)\n{\n    char wildcard[MAX_PATH];\n    sprintf(wildcard, \"%s\\\\*\", folder);\n    WIN32_FIND_DATA fd;\n    HANDLE handle = FindFirstFile(wildcard, &amp;fd);\n    if(handle == INVALID_HANDLE_VALUE) return 0;\n    do  \n    {\n        if(strcmp(fd.cFileName, \".\") == 0 || strcmp(fd.cFileName, \"..\") == 0) \n            continue;\n        char path[MAX_PATH];\n        sprintf(path, \"%s\\\\%s\", folder, fd.cFileName);\n\n        if(_stricmp(fd.cFileName, filename) == 0) \n            strcpy(fullpath, path);\n        else if(fd.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY)\n            findfile_recursive(path, filename, fullpath);\n        if(strlen(fullpath))\n            break;\n    } while(FindNextFile(handle, &amp;fd));\n    FindClose(handle);\n    return strlen(fullpath);\n}\n\nint main(void)\n{\n    char fullpath[MAX_PATH] = { 0 };\n    if(findfile_recursive(\"c:\\\\test\", \"something.png\", fullpath))\n        printf(\"found: %s\\n\", fullpath);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7162576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8b5cf261daf9dcc1965f43123bd6d02?s=128&d=identicon&r=PG&f=1", "display_name": "C.Edelweiss", "link": "https://stackoverflow.com/users/7162576/c-edelweiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 47312218, "answer_count": 1, "score": 0, "last_activity_date": 1510762285, "creation_date": 1510746505, "question_id": 47306626, "link": "https://stackoverflow.com/questions/47306626/c-recursive-search-for-a-file-in-a-folder-and-subfolders", "title": "C Recursive search for a file in a folder and subfolders", "body": "<p>My program is getting the input path from the user, and is looking for files with a name corresponding with a column from a .csv file where <code>oldpath</code> is the userinput path, and then i'm using <code>get_between_delimiter</code> in a while loop to get the name of the file i'm looking for from the first cell of each line in the .csv</p>\n\n<p>What I can't figure out is how do I check all the subdirectories for that file if it does not exist in the base directory or right away, while keeping my program's functionality?</p>\n\n<pre><code>  strcpy(oldnp, oldpath);\n  strcat(oldnp, \"/\");\n  strcat(oldnp, get_between_delimiter(commande[cnt] , 0));\n  strcat(oldnp, \".png\");\n  source = fopen(oldnp, \"r\");\n  if ((source = fopen(oldnp, \"r\")) == NULL)\n   file_found();\n  else\n   ;?\n</code></pre>\n"}, {"tags": ["c", "linux", "assembly"], "comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1510747597, "post_id": 47306553, "comment_id": 81564140, "body": "Try to add C variant of the same function to see what C compiler will produce. The problem looks to be in <code>ret 8</code>, that&#39;s not correct linux 32b calling convention. Check <a href=\"https://github.com/hjl-tools/x86-psABI/wiki/intel386-psABI-1.1.pdf\" rel=\"nofollow noreferrer\">github.com/hjl-tools/x86-psABI/wiki/intel386-psABI-1.1.pdf</a> (Paragraphs 2.x mainly, Table 2.3, Table 2.4) -&gt; <code>esp</code> should be preserved, so you should use <code>ret</code> instead. Where did you get the <code>ret 8</code>? (that looks like win32 knowledge)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1510752258, "post_id": 47306553, "comment_id": 81567426, "body": "In addition to the <code>ret 8</code> problem, you are also not preserving <code>ebx</code> which is a callee-saved register."}, {"owner": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1510754165, "post_id": 47306553, "comment_id": 81568800, "body": "@Ped7g When I add the C variant of the Assembly min function and preserve import of the out_format it works ok. Also if I remove just remove C printf command, but leave the imports and calling the Assembly min function, it also works but I don&#39;t see result, because the code doesn&#39;t print anything. The ret 8 is used because the Assembly min function should use stdcall convenction insetad of the default cedcl. According to the stdcall even if I change the import of the function min in C code to look like this: extern int __attribute__((stdcall)) min(int x, int y); I always get the same error :("}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1510756756, "post_id": 47306553, "comment_id": 81570745, "body": "I meant: try to add C variant (also make it <code>stdcall</code>), and check the disassembly / debugger, how it differs from yours. In OP there was no mention of stdcall, so it will not work by default. If you add <code>stdcall</code> specifier, you can still check disassembly if the <code>main</code> takes that into account and calls it correctly, expecting the <code>esp</code> to be modified. ... also if you use cdecl, fix <code>ret</code> and fix <code>ebx</code>, does it work then?"}, {"owner": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "edited": false, "score": 0, "creation_date": 1510757457, "post_id": 47306553, "comment_id": 81571303, "body": "After preserving ebx in Assembly code right below the enter command it works. That was the catch, I forgot to do that at all. Thaks for your help and also to Jester."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "edited": false, "score": 0, "creation_date": 1510753928, "post_id": 47307032, "comment_id": 81568643, "body": "Sorry but what exactly you did and it worked? I tried to put same thing in my code, explicitly in C code from the above, also I tried to change the out_format in Assembly code according to your snippet but I always get the same error."}, {"owner": {"reputation": 372, "user_id": 8612418, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669640159713786/picture?type=large", "display_name": "Younghwa Park", "link": "https://stackoverflow.com/users/8612418/younghwa-park"}, "reply_to_user": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "edited": false, "score": 0, "creation_date": 1510801209, "post_id": 47307032, "comment_id": 81592715, "body": "you need implementation of min(). it should be on different source code or library. if not, implement min() function."}, {"owner": {"reputation": 372, "user_id": 8612418, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669640159713786/picture?type=large", "display_name": "Younghwa Park", "link": "https://stackoverflow.com/users/8612418/younghwa-park"}, "reply_to_user": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "edited": false, "score": 0, "creation_date": 1510801239, "post_id": 47307032, "comment_id": 81592727, "body": "int min (int x, int y) { if (x&lt;y) return x; return y}"}, {"owner": {"reputation": 372, "user_id": 8612418, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669640159713786/picture?type=large", "display_name": "Younghwa Park", "link": "https://stackoverflow.com/users/8612418/younghwa-park"}, "reply_to_user": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "edited": false, "score": 0, "creation_date": 1510802186, "post_id": 47307032, "comment_id": 81593005, "body": "I see you want to use assembly and C. out_format is char in C code, in assembly code it&#39;s string - array of character. use out_format[] in C code"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510806888, "post_id": 47307032, "comment_id": 81594219, "body": "The problem is the <code>ret 8</code> in the asm which doesn&#39;t match the standard Linux calling convention (where the caller pops the args).  There was nothing wrong with the OP&#39;s format string or using the asm-defined data."}], "tags": [], "owner": {"reputation": 372, "user_id": 8612418, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669640159713786/picture?type=large", "display_name": "Younghwa Park", "link": "https://stackoverflow.com/users/8612418/younghwa-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1510802010, "last_edit_date": 1510802010, "creation_date": 1510747706, "answer_id": 47307032, "question_id": 47306553, "link": "https://stackoverflow.com/questions/47306553/c-printf-segmentation-fault-core-dumped-while-mixing-with-assembly-code/47307032#47307032", "title": "C printf Segmentation fault (core dumped) while mixing with Assembly code", "body": "<p>if min() works good, check out_format.</p>\n\n<p>following code works.</p>\n\n<pre><code>printf(\"%d %d %d\\n\", x1, x2, r);\n</code></pre>\n\n<p>full code </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint min(int x, int y)\n{\n    if (x&lt;y) return x;\n    return y;\n}\n\nint main() {\n    int x1, x2, r;\n    scanf(\"%i%i\", &amp;x1, &amp;x2);\n    r = min(x1, x2);\n    printf(\"%d %d %d\\n\", x1, x2, r);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510763921, "post_id": 47310588, "comment_id": 81576298, "body": "Or better, use <code>ret</code> instead of <code>ret 8</code> to use the normal calling convention.  This would be a better answer if you described what you changed.  (Just the <code>__attribte__((stdcall))</code>?)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1510763958, "post_id": 47310588, "comment_id": 81576331, "body": "Also, you can use <code>extern char out_format[]</code> to use a more accurate declaration."}], "tags": [], "owner": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "is_accepted": false, "score": 0, "last_activity_date": 1510757829, "creation_date": 1510757829, "answer_id": 47310588, "question_id": 47306553, "link": "https://stackoverflow.com/questions/47306553/c-printf-segmentation-fault-core-dumped-while-mixing-with-assembly-code/47310588#47310588", "title": "C printf Segmentation fault (core dumped) while mixing with Assembly code", "body": "<p>At the end I just want to leave the code that works.</p>\n\n<p>File b.s:</p>\n\n<pre><code>.intel_syntax noprefix\n.arch i386\n\n.data\n    .globl out_format\n    out_format:\n        .asciz \"min(%i, %i) = %i\\n\"\n\n.text\n    .globl min\n    .type min, @function\n    min:\n        enter 0, 0\n        push ebx\n        mov ebx, [ebp + 8]\n        cmp ebx, [ebp + 12]\n        jle 1f\n        mov eax, [ebp] + 12\n        jmp 2f\n        1:\n            mov eax, ebx\n        2:\n            pop ebx\n            leave\n        ret 8\n\n.end\n</code></pre>\n\n<p>File a.c:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nextern char out_format;\n\nextern int __attribute__((stdcall)) min(int x, int y);\n\nint main() {\n    int x1, x2, r;\n    scanf(\"%i%i\", &amp;x1, &amp;x2);\n    r = min(x1, x2);\n    printf(&amp;out_format, x1, x2, r);\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks everyone for their help.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 0, "last_activity_date": 1510807414, "creation_date": 1510807414, "answer_id": 47321787, "question_id": 47306553, "link": "https://stackoverflow.com/questions/47306553/c-printf-segmentation-fault-core-dumped-while-mixing-with-assembly-code/47321787#47321787", "title": "C printf Segmentation fault (core dumped) while mixing with Assembly code", "body": "<p>The asm uses <code>ret 8</code> to pop the args from the stack as it returns.</p>\n\n<p>The standard 32-bit x86 Linux calling convention (<a href=\"https://github.com/hjl-tools/x86-psABI/wiki/X86-psABI\" rel=\"nofollow noreferrer\">i386 System V ABI</a>) is caller-pops.  <strong>Functions just use <code>ret</code> to return</strong> and the caller can clean up the stack if / when it wants.  (e.g. use <code>mov</code> stores to write new args before another <code>call</code> instead of adjusting <code>esp</code> and using <code>push</code> again.)</p>\n\n<p>As the OP's self answer points you, you could instead declare <code>min</code> as</p>\n\n<pre><code>extern int __attribute__((stdcall)) min(int x, int y);\n</code></pre>\n\n<p>so the compiler-generated code will agree with the asm on the calling convention.  This calling convention is sometimes used on Windows.</p>\n\n<p>Single-stepping with a debugger would have revealed this (if you knew what to look for).  Always use a debugger to figure out where your code segfaults, then look at registers and work backwards to find out why.</p>\n"}], "owner": {"reputation": 1, "user_id": 8944573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e1b4b2883f980d6ac98ef5deabb704?s=128&d=identicon&r=PG&f=1", "display_name": "8uII6", "link": "https://stackoverflow.com/users/8944573/8uii6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510807414, "creation_date": 1510746262, "question_id": 47306553, "link": "https://stackoverflow.com/questions/47306553/c-printf-segmentation-fault-core-dumped-while-mixing-with-assembly-code", "title": "C printf Segmentation fault (core dumped) while mixing with Assembly code", "body": "<p>I tried some basic example of mixing C code and x86 Assembly code.\nIt is simple <strong>Find smaller number</strong> example.</p>\n\n<p>Here is Assembly code in b.s file (I have to use intel syntax with no prefix and i386 architecture):</p>\n\n<pre><code>.intel_syntax noprefix\n.arch i386\n\n.data\n    .globl out_format\n    out_format:\n        .asciz \"min(%i, %i) = %i\\n\"\n\n.text\n    .globl min\n    .type min, @function\n    min:\n        enter 0, 0\n        mov ebx, [ebp + 8]\n        cmp ebx, [ebp + 12]\n        jle 1f\n        mov eax, [ebp] + 12\n        jmp 2f\n        1:\n            mov eax, ebx\n        2:\n            leave\n        ret 8\n\n.end\n</code></pre>\n\n<p>Here is the C code in a.c file:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nextern char out_format;\n\nextern int min(int x, int y);\n\nint main() {\n    int x1, x2, r;\n    scanf(\"%i%i\", &amp;x1, &amp;x2);\n    r = min(x1, x2);\n    printf(&amp;out_format, x1, x2, r);\n\n    return 0;\n}\n</code></pre>\n\n<p>I compile it with gcc on x64 Arch Linux:</p>\n\n<pre><code>gcc -m32 -Wall -Werror -g -o p b.s a.c\n</code></pre>\n\n<p>But when I start the executable file p, and insert 2 numbers and hit enter\nI get:</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>I researched all previous similar questions, and I tried several things but every time I get the same error.\nI also tried to debug it with gdb, and I see that Assembly function <strong><em>min</em></strong> returns the right result, but somehow it always stuck on C <strong><em>printf</em></strong> function.</p>\n\n<p>I tried to not import string <strong><em>out_format</em></strong> from Assembly file, and define it directly in C file (I defined it as simple array of chars, and also as char pointer using <strong><em>malloc</em></strong> and <strong><em>free</em></strong> functions) but it didn't help.</p>\n\n<p>Otherwise the program doesn't give such error if I intialize variable <strong><em>r</em></strong> with some integer instead with result of Assembly function <strong><em>min</em></strong>. But it doesn't have any sense to me as I already checked it with gdb and the Assembly function correctly intialize the variable <strong>r</strong> with correct smaller number.</p>\n\n<p>Please, can anyone help me with this?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "string", "while-loop", "strcat"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7191279"}, "edited": false, "score": 0, "creation_date": 1510745862, "post_id": 47306359, "comment_id": 81563016, "body": "Is <code>term_command</code> memory properly allocated ?"}, {"owner": {"reputation": 31, "user_id": 8920192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cac8b4d8d533f69657a6677018fb562?s=128&d=identicon&r=PG&f=1", "display_name": "FilBr", "link": "https://stackoverflow.com/users/8920192/filbr"}, "edited": false, "score": 0, "creation_date": 1510746090, "post_id": 47306359, "comment_id": 81563172, "body": "for the sake of simplicity I didn&#39;t allocate it dynamcally, I just went for &quot;char term_command[500];&quot;"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1510746146, "post_id": 47306359, "comment_id": 81563210, "body": "<code>while(fscanf(fp, &quot;%s&quot;, fname) != EOF){</code> - <code>fname</code> only has space for 2 chars + EOS."}, {"owner": {"reputation": 3440, "user_id": 4108223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/e6wAC.jpg?s=128&g=1", "display_name": "Ren&#233; Pijl", "link": "https://stackoverflow.com/users/4108223/ren%c3%a9-pijl"}, "edited": false, "score": 1, "creation_date": 1510746268, "post_id": 47306359, "comment_id": 81563286, "body": "The fscanf() may be overwriting beyond the 3 char&#39;s allocated for fname, with unpredictable effects."}, {"owner": {"reputation": 31, "user_id": 8920192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cac8b4d8d533f69657a6677018fb562?s=128&d=identicon&r=PG&f=1", "display_name": "FilBr", "link": "https://stackoverflow.com/users/8920192/filbr"}, "edited": false, "score": 0, "creation_date": 1510746669, "post_id": 47306359, "comment_id": 81563539, "body": "I know it&#39;s not a safe way to allocate the string, but I was trying to isolate the problem in a controlled environment, where I&#39;m sure all fnames have length &lt; 3 (except for list.txt which I didn&#39;t account for, so I increased string size to 20, but nothing changed)"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1510747036, "post_id": 47306359, "comment_id": 81563786, "body": "Works ok on my pc (VisualStudio 2013). And on ideone (modified to use stdin): <a href=\"https://ideone.com/k8Oclg\" rel=\"nofollow noreferrer\">ideone.com/k8Oclg</a>"}, {"owner": {"reputation": 31, "user_id": 8920192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cac8b4d8d533f69657a6677018fb562?s=128&d=identicon&r=PG&f=1", "display_name": "FilBr", "link": "https://stackoverflow.com/users/8920192/filbr"}, "edited": false, "score": 0, "creation_date": 1510747309, "post_id": 47306359, "comment_id": 81563958, "body": "Still not working on my PC.. I can&#39;t understand why. I&#39;ll try on a different machine as soon as I get a chance"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1510748338, "post_id": 47306359, "comment_id": 81564620, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>. Don&#39;t try on a different machine. Debug it on your current machine."}, {"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 0, "creation_date": 1510749061, "post_id": 47306359, "comment_id": 81565111, "body": "You can put a sentinel variable with a defined between the two arrays and see whether tit&#39;s overwritten.    <code>char term_command[500];char guard;     char fname[20]; guard = 42; </code> and later  <code>if (guard != 42) panik</code>"}, {"owner": {"reputation": 31, "user_id": 8920192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cac8b4d8d533f69657a6677018fb562?s=128&d=identicon&r=PG&f=1", "display_name": "FilBr", "link": "https://stackoverflow.com/users/8920192/filbr"}, "edited": false, "score": 0, "creation_date": 1510827033, "post_id": 47306359, "comment_id": 81604369, "body": "Turns out it was a problem caused by the text editor. I don&#39;t know why, but it stopped saving the changes I made to the program. So.. other than the wrong memory allocation for fname, everything else turned out to be working. Thanks guys!"}], "owner": {"reputation": 31, "user_id": 8920192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cac8b4d8d533f69657a6677018fb562?s=128&d=identicon&r=PG&f=1", "display_name": "FilBr", "link": "https://stackoverflow.com/users/8920192/filbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1510746376, "creation_date": 1510745678, "last_edit_date": 1510746376, "question_id": 47306359, "link": "https://stackoverflow.com/questions/47306359/strcat-not-working-string-is-formatted-each-time", "title": "strcat not working, string is formatted each time", "body": "<p>This is part of a larger program, but I found it to be super buggy and totally incorrect\nThis is the program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char const *argv[])\n{\n    char term_command[500];\n    char fname[20];\n    FILE *fp;\n\n    //open list of files\n    fp = fopen(\"list.txt\", \"r+\");\n\n    //check \n    if(fp == NULL){\n        fprintf(stderr, \"ERROR OPENING FILE list.txt\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    strcpy(term_command, \"sort -m -n \");\n    printf(\"com: %s\\n\", term_command);\n\n    while(fscanf(fp, \"%s\", fname) != EOF){\n        printf(\"com: %s\\n\", term_command);\n        if(strcmp(fname, \"list.txt\") != 0){\n            strcat(term_command, fname);\n            strcat(term_command, \" \");\n        }\n    }\n\n    strcat(term_command, \"-o all_sorted.txt\");\n    printf(\"com1: %s\\n\", term_command);\n\n    return 0;\n}\n</code></pre>\n\n<p>And this is the output I get</p>\n\n<pre><code>com: sort -m -n \ncom: \ncom: \ncom: \ncom: \ncom: \ncom: \ncom: -o all_sorted.txt\n</code></pre>\n\n<p>I don't understand why the string fname isn't attached to the term_command string, and why the term_command string is empty as soon as I get in the while loop.</p>\n\n<p>edit:</p>\n\n<p>This is an example of file \"list.txt\"</p>\n\n<pre><code>f0\nf1\nf2\nf3\nf4\nf5\nlist.txt\n</code></pre>\n\n<p>I changed fname size to 20 but nothing changed</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1510749762, "post_id": 47305941, "comment_id": 81565638, "body": "Are you aware of <code>copy_to_user</code> and <code>copy_from_user</code> kernel&#39;s functions? If not, it is time to learn about them. Because accessing (read/write) user memory should be performed only with given functions (and some variations of them)."}, {"owner": {"reputation": 367, "user_id": 876832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FMJrU.jpg?s=128&g=1", "display_name": "Fadeway", "link": "https://stackoverflow.com/users/876832/fadeway"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510750940, "post_id": 47305941, "comment_id": 81566487, "body": "I used them, but I wasn&#39;t aware that that&#39;s all it takes. Writing wherever the user tells me to, with no explicit checking on my part seemed pretty reckless :)"}, {"owner": {"reputation": 424, "user_id": 2857238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1e9f4d477fb2ed1d17cb776be2f3e9?s=128&d=identicon&r=PG", "display_name": "Chris Tsui", "link": "https://stackoverflow.com/users/2857238/chris-tsui"}, "edited": false, "score": 0, "creation_date": 1510845114, "post_id": 47305941, "comment_id": 81617230, "body": "<code>copy_to_user</code> and  <code>copy_from_user</code> do basic checks and they could failed to finish copy."}], "answers": [{"tags": [], "owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "is_accepted": true, "score": 1, "last_activity_date": 1510745774, "creation_date": 1510745774, "answer_id": 47306386, "question_id": 47305941, "link": "https://stackoverflow.com/questions/47305941/safe-handling-of-userspace-pointers-in-a-driver/47306386#47306386", "title": "Safe handling of userspace pointers in a driver?", "body": "<blockquote>\n  <p>How do I handle these userspace pointers responsibly in my driver?</p>\n</blockquote>\n\n<p>You don't, simply because there are no ways to check if the pointers points to anything valid. It is up to the user of the ioctl() to provide proper parameters. If they fail to do that, then tough luck for them.</p>\n"}], "owner": {"reputation": 367, "user_id": 876832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FMJrU.jpg?s=128&g=1", "display_name": "Fadeway", "link": "https://stackoverflow.com/users/876832/fadeway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47306386, "answer_count": 1, "score": 1, "last_activity_date": 1510745774, "creation_date": 1510744490, "question_id": 47305941, "link": "https://stackoverflow.com/questions/47305941/safe-handling-of-userspace-pointers-in-a-driver", "title": "Safe handling of userspace pointers in a driver?", "body": "<p>I'm writing an ioctl driver that needs to read and write data to userspace. For visualization, here's a typical argument that goes in a driver call:</p>\n\n<pre><code>typedef struct {\nunsigned int* src;\nunsigned int* dst;\nunsigned int buffer_size;\nunsigned int key[8];\n} aes_data\n</code></pre>\n\n<p>I'm not very well-versed in how virtual memory works, but I think there's a risk here. The userspace process could have provided a pointer to memory it does not own. The provided buffer size could cause an overflow into the memory of some other process as well. How do I handle these userspace pointers responsibly in my driver?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510749276, "post_id": 47305810, "comment_id": 81565280, "body": "Another &#39;p1-&gt;p2-&gt;p3-&gt;p1&#39; homework:(   Three named semaphores, (again)."}, {"owner": {"reputation": 64, "user_id": 8920003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889142c973666044a866a4a622737865?s=128&d=identicon&r=PG&f=1", "display_name": "r3dr4bb1t", "link": "https://stackoverflow.com/users/8920003/r3dr4bb1t"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510753058, "post_id": 47305810, "comment_id": 81568025, "body": "I didnt learn named semaphore  i looked it up but  idk how to use it"}], "owner": {"reputation": 64, "user_id": 8920003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889142c973666044a866a4a622737865?s=128&d=identicon&r=PG&f=1", "display_name": "r3dr4bb1t", "link": "https://stackoverflow.com/users/8920003/r3dr4bb1t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510744089, "creation_date": 1510744089, "question_id": 47305810, "link": "https://stackoverflow.com/questions/47305810/how-to-increment-the-number-in-shared-file-using-3-processes-signal", "title": "how to increment the number in shared file using 3 processes&#39; signal", "body": "<p>Guys I've been working on this project for 3 days and it's still hard for me to understand what's wrong I have to make file with '0' in it([argv[2]). Each process increase it by 1 and wake next process up and go to sleep. (p1->p2->p3->p1 ,,, until it reaches argv[1]). Currently  I don't know why it firstly sends 2 signals without going into while loop.(initial0, 2xxxx, 2xxxx, 02xxxx,02xxxx ,,,,) and it doesn't increase one by one. should i use sigprocmask?</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;fcntl.h&gt;\n#define buf 10\nvoid sig_usr (int signo)\n{\n/*      sigset_t sigset;\n        sigemptyset(&amp;sigset);\n        sigaddset(&amp;sigset, SIGUSR1);\n        sigprocmask(SIG_BLOCK,&amp;sigset, NULL);\n\n        */printf(\"%d\\n\",getpid());\n//      longjmp(jumpbuffer,1);\n}\n\nint main(int argc, char **argv)\n{       int fd;\n        int count = 0;\n        char buff[buf];\n        struct sigaction usrsig;\n        usrsig.sa_handler =sig_usr;\n        sigemptyset(&amp;usrsig.sa_mask);\n        usrsig.sa_flags=0;\n        sigaction(SIGUSR1,&amp;usrsig,0);\n     if(!(argv[1]&gt;0))\n                printf(\"insert positive integer\");\n        fd = open(argv[2],O_RDWR|O_CREAT|O_TRUNC);\n        pwrite(fd,\"0\",3,0);\n        read(fd,buff,10);\n        printf(\"initial%s\\n\",buff);\n\n//      jmp_buf jumpbuffer;\n        pid_t next,ppid,granmaduh;\n        granmaduh = getpid();\n        if ((next = fork()) &lt;0 )\n        { \n                        fprintf(stderr, \"fork() error\");\n                        exit(1);\n         }\n        else if (next == 0  )\n        {\n\n  next = fork();\n                if (next &gt;0)\n                {\n                        sleep(6);\n                }\n                else \n                {\n                        next = granmaduh;       \n                        sleep(10);\n                }\n        }\n        //setjmp(jumpbuffer);\n        while(1)\n        {\n                //write(fd,buff[0],sizeof(buf));\n                sleep(1);\n  kill(next, SIGUSR1);\n                printf(\"%s\",buff);\n                pause();\n                sleep(1);\n\n        }\n//      while(1)\n//      {}\n\n\n        }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1510743420, "post_id": 47305335, "comment_id": 81561449, "body": "<code>&quot;%[^\\n]s&quot;</code> --&gt; <code>&quot;%[^\\n]&quot;</code>: the <code>s</code> is not part of the scanset directive. Also note that <code>fflush(stdin)</code> causes undefined behavior according to the Standard (though the behavior is defined on some systems) and is at best not portable. There are better ways of dealing with extra characters left in the input stream. You may be able to get away with adding a leading space to the format string to consume previous newline characters: <code>&quot; %[^\\n]&quot;</code>."}, {"owner": {"reputation": 5167, "user_id": 2290369, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da4ab370f060fc87a6ea6dcc502e507b?s=128&d=identicon&r=PG", "display_name": "Ismail Yavuz", "link": "https://stackoverflow.com/users/2290369/ismail-yavuz"}, "edited": false, "score": 0, "creation_date": 1510743518, "post_id": 47305335, "comment_id": 81561519, "body": "First of all, it looks like you don&#39;t have any i++ in your loop or sth like that."}, {"owner": {"reputation": 1, "user_id": 8805746, "user_type": "registered", "profile_image": "https://graph.facebook.com/926374734185990/picture?type=large", "display_name": "Tha ", "link": "https://stackoverflow.com/users/8805746/tha"}, "edited": false, "score": 0, "creation_date": 1510744167, "post_id": 47305335, "comment_id": 81561963, "body": "Thanks for the reply sir. I&#39;ve corrected it. appreciate it so much &lt;3"}], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 8652760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yFbhM.jpg?s=128&g=1", "display_name": "Jasmeet", "link": "https://stackoverflow.com/users/8652760/jasmeet"}, "is_accepted": false, "score": 0, "last_activity_date": 1510743388, "creation_date": 1510743388, "answer_id": 47305587, "question_id": 47305335, "link": "https://stackoverflow.com/questions/47305335/scanning-an-array-and-assign-it-into-other-place-in-c/47305587#47305587", "title": "scanning an array and assign it into other place in C", "body": "<p>There is no change to value of variable i which is set to 0 during initialization.Hence it will never enter the for loop in case 2.</p>\n"}], "owner": {"reputation": 1, "user_id": 8805746, "user_type": "registered", "profile_image": "https://graph.facebook.com/926374734185990/picture?type=large", "display_name": "Tha ", "link": "https://stackoverflow.com/users/8805746/tha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510746658, "creation_date": 1510742687, "last_edit_date": 1510746658, "question_id": 47305335, "link": "https://stackoverflow.com/questions/47305335/scanning-an-array-and-assign-it-into-other-place-in-c", "title": "scanning an array and assign it into other place in C", "body": "<p>help me. I've been assign to make an application for some test result. but why can't I print out what user have inputted at case 2. I've tried other approach but it's not working. this is the closest I could get there. Any help would be appreciated. super thanks +_+</p>\n\n<p>this is my code :</p>\n\n<pre><code>int main(){\n    int option;\n    char namamurid[30][15];\n    int i=0,j=0;\n    int listening[15];\n    int reading[15];\n    int essay[15];\n    int score[15];\n\n    do{ printf(\"\\\"Smart English\\\" Course Center\\n********************************\\n\");\n        printf(\"1.Add new data\\n2.View data\\n3.View summary\\n4.Exit\\n\\n\");\n        printf(\"your option[1..4]: \");\n        scanf(\"%d\",&amp;option);\n        fflush(stdin);\n\n        switch(option){\n            case 1: \n                do{\n                    printf(\"Input student's name[1..25 char]: \");\n                    scanf(\"%[^\\n]s\",namamurid[i]);\n                    fflush(stdin);\n                }while(strlen(namamurid[i])&lt;1 || strlen(namamurid[i])&gt;25);\n\n                do{\n                    printf(\"Correct answer for listening section[0..20]: \");\n                    scanf(\"%d\",&amp;listening[i]);\n                    fflush(stdin);\n                }while(listening[i]&lt;0 || listening[i]&gt;20);\n\n                do{\n                    printf(\"Correct answer for reading section[0..30]: \");\n                    scanf(\"%d\",&amp;reading[i]);\n                    fflush(stdin);\n\n                }while(reading[i]&lt;0 || reading[i]&gt;30);\n\n                do{\n                    printf(\"Correct answer for essay section[0..25]: \");\n                    scanf(\"%d\",&amp;essay[i]);\n                    fflush(stdin);\n\n                }while(essay[i]&lt;0 || essay[i]&gt;25);\n                break;\n\n\n            case 2:\n                printf(\"Name\\t\\tListening\\tReading\\tEssay\\tScore\\tGrade\\n\");\n                for(j=0;j&lt;i;j++)\n                {\n                    printf(\"%-1s\\t\\t%d\\t%d\\t%d\\t%d\\n\",namamurid[j],listening[j],reading[j],essay[j],score[j]);\n                }\n\n                break;\n        }\n    } while(option&lt;1 || option&gt;4 || option !=4);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc"], "answers": [{"tags": [], "owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "is_accepted": false, "score": 4, "last_activity_date": 1510742720, "creation_date": 1510742720, "answer_id": 47305346, "question_id": 47305324, "link": "https://stackoverflow.com/questions/47305324/when-i-compile-c-file-it-always-creates-exe-file-with-name-a/47305346#47305346", "title": "When I compile .c file it always creates .exe file with name &#39;a&#39;", "body": "<p>Just tell GCC the output name you want.</p>\n\n<pre><code>gcc hello.c -o hello\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3208, "user_id": 4705190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qmkvx.jpg?s=128&g=1", "display_name": "Ali Sajid", "link": "https://stackoverflow.com/users/4705190/ali-sajid"}, "is_accepted": false, "score": 0, "last_activity_date": 1510743009, "creation_date": 1510743009, "answer_id": 47305457, "question_id": 47305324, "link": "https://stackoverflow.com/questions/47305324/when-i-compile-c-file-it-always-creates-exe-file-with-name-a/47305457#47305457", "title": "When I compile .c file it always creates .exe file with name &#39;a&#39;", "body": "<p>You need to understand the syntax of output. Following is the description of the command:</p>\n\n<pre><code>$ gcc [options] [source files] [object files] -o output file\n</code></pre>\n\n<p>In your case you should execute the commands as following:</p>\n\n<pre><code>$ gcc myfile.c -o myfile\n$ ./myfile\n</code></pre>\n\n<p>For more descriptions and more optimized ways refer to the following url:\n<a href=\"http://www.rapidtables.com/code/linux/gcc/gcc-o.htm\" rel=\"nofollow noreferrer\">http://www.rapidtables.com/code/linux/gcc/gcc-o.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 7690030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11846ade17a8760f2501ab72fcc1f37?s=128&d=identicon&r=PG", "display_name": "Martin Chekurov", "link": "https://stackoverflow.com/users/7690030/martin-chekurov"}, "is_accepted": false, "score": 1, "last_activity_date": 1510744219, "creation_date": 1510744219, "answer_id": 47305846, "question_id": 47305324, "link": "https://stackoverflow.com/questions/47305324/when-i-compile-c-file-it-always-creates-exe-file-with-name-a/47305846#47305846", "title": "When I compile .c file it always creates .exe file with name &#39;a&#39;", "body": "<p>You have to specify the name of the executable</p>\n\n<pre><code>gcc -c hello.c // compiling\n\ngcc -o hello hello.o // linking\n         ^------------------------- name of the executable\n</code></pre>\n\n<p>you can do the compiling and the linking in one command</p>\n\n<pre><code>gcc -o hello hello.c\n         ^------------------------- name of the executable\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8433118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aOEtD_6M1Uc/AAAAAAAAAAI/AAAAAAAAAHI/TTbIRWUsLDU/photo.jpg?sz=128", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/8433118/abhishek-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3208, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510744282, "creation_date": 1510742659, "last_edit_date": 1510742749, "question_id": 47305324, "link": "https://stackoverflow.com/questions/47305324/when-i-compile-c-file-it-always-creates-exe-file-with-name-a", "title": "When I compile .c file it always creates .exe file with name &#39;a&#39;", "body": "<p>I use GCC compiler to compile and run C program on CMD.\nWhen I compile C program using command <code>gcc hello.c</code> it creates an executable file file with name <code>a.exe</code> but when I use IDE it uses the name same as .c file as <code>hello.exe</code>.\nIs it possible to create .exe file name same as .c file on CMD?</p>\n"}, {"tags": ["c", "linux", "ipc", "ftok", "msgsend"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1510750143, "post_id": 47305128, "comment_id": 81565909, "body": "How is defined <code>mbuf</code>? Why the <code>&amp;</code> when calling <code>printf(&quot;queue id: %i \\n&quot;, &amp;msgqid);</code> and <code>printf(&quot;queue key: %d \\n&quot;, &amp;key);</code>?"}, {"owner": {"reputation": 379, "user_id": 7473663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x93kx.png?s=128&g=1", "display_name": "siery", "link": "https://stackoverflow.com/users/7473663/siery"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1510751201, "post_id": 47305128, "comment_id": 81566674, "body": "You are right, I make mistake here, so the only data thats not matching here is the queue id."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510884590, "post_id": 47305128, "comment_id": 81636607, "body": "in the <code>add_queue.c</code> file, the parameters to <code>main()</code> are not being used.  To avoid the compiler outputting two warning messages, suggest using the other valid signature for main()  <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510888022, "post_id": 47305128, "comment_id": 81637499, "body": "you need to post the contents of the header file: <code>..&#47;..&#47;lib&#47;shared_msgbuf.h</code>.  Note: that header file needs to have the <code>struct msgbuf</code> defined where the field: <code>mtext</code> is the (max) length of the message text.  Then an instance of that struct must be in each *.c file that calls <code>msgget()</code> or <code>msgsnd()</code> or <code>msgrcv()</code> or <code>msgctl()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 7473663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x93kx.png?s=128&g=1", "display_name": "siery", "link": "https://stackoverflow.com/users/7473663/siery"}, "edited": false, "score": 0, "creation_date": 1510928874, "post_id": 47309628, "comment_id": 81657902, "body": "Thank you, that explains why the <code>msgqid</code> value been equal 0."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 2, "last_activity_date": 1510755120, "creation_date": 1510755120, "answer_id": 47309628, "question_id": 47305128, "link": "https://stackoverflow.com/questions/47305128/error-invalid-argument-while-sending-msgsnd-message-not-matching-queue-id/47309628#47309628", "title": "error: Invalid argument; while sending msgsnd() message; not matching queue ID", "body": "<p>Your error comes from this line:</p>\n\n<pre><code>if (msgqid = msgget(key, 0666) == FAILED) {\n</code></pre>\n\n<p>It should be </p>\n\n<pre><code>if ((msgqid = msgget(key, 0666)) == FAILED) {\n</code></pre>\n\n<p>In first case, because of <a href=\"https://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B#Operator_precedence\" rel=\"nofollow noreferrer\">operator priority</a>, comparison (<code>==</code>) is done before assignation (<code>=</code>).</p>\n\n<p>In second case, paranthesis tells compiler what must be done first.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1510888355, "last_edit_date": 1510888355, "creation_date": 1510885953, "answer_id": 47342383, "question_id": 47305128, "link": "https://stackoverflow.com/questions/47305128/error-invalid-argument-while-sending-msgsnd-message-not-matching-queue-id/47342383#47342383", "title": "error: Invalid argument; while sending msgsnd() message; not matching queue ID", "body": "<p>these are the header files needed for <code>msgsnd()</code></p>\n\n<pre><code>   #include &lt;sys/types.h&gt;\n   #include &lt;sys/ipc.h&gt;\n   #include &lt;sys/msg.h&gt;\n</code></pre>\n\n<p>The posted code, for portability, is missing two of those header file include statements</p>\n\n<p>===========</p>\n\n<p>this statement:</p>\n\n<pre><code>if (msgqid = msgget(key, 0666) == FAILED) {\n</code></pre>\n\n<p>is missing the the <code>IPC_CREAT</code> that should be part of the <code>0666</code> parameter</p>\n\n<p>===========</p>\n\n<p>the <code>mbuf</code> has two fields, the <code>mtype</code> field, which MUST be positive, > 0\nand the <code>mtext</code> field.</p>\n\n<p>The posted code is setting the <code>mtext</code> field, but failing to set the <code>mtype</code> field.</p>\n\n<p>=============</p>\n\n<p>this statement:</p>\n\n<pre><code>printf(\"Connecting to the queue... \\n\", s);\n</code></pre>\n\n<p>has the problem that there is a input parameter, but their is no format specifier in the 'format string'</p>\n\n<p>============</p>\n\n<p>The <code>key</code> value must be the same for every access to the same message queue.</p>\n\n<p>so the calls to <code>ftok()</code> must all have the same parameter, otherwise they will generate different/unique message queues via the call to <code>msgget()</code></p>\n\n<p>============</p>\n\n<p>Note: message queues do not 'go away' just because a program exits.  Therefore, the controlling program (or the last user of the last message) should be calling <code>msgctl()</code> to remove the message queue</p>\n"}], "owner": {"reputation": 379, "user_id": 7473663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x93kx.png?s=128&g=1", "display_name": "siery", "link": "https://stackoverflow.com/users/7473663/siery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1304, "favorite_count": 0, "accepted_answer_id": 47309628, "answer_count": 2, "score": 1, "last_activity_date": 1510888355, "creation_date": 1510742124, "last_edit_date": 1510751514, "question_id": 47305128, "link": "https://stackoverflow.com/questions/47305128/error-invalid-argument-while-sending-msgsnd-message-not-matching-queue-id", "title": "error: Invalid argument; while sending msgsnd() message; not matching queue ID", "body": "<p>I was just learning IPC on linux and come up with three simple programs. One is made to create (and administrate in the feature) the message queue. The second should just send the message to the queue created by the first one. The third program is receiving data from the queue.</p>\n\n<p>All programs are inheriting from the same root directory and spiting in to separate directories per source and binaries.</p>\n\n<p>So lets just focus on creating and sending part, and that shall help me fix the third program as well.</p>\n\n<p>add queue main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n\n#define FAILED -1\n\n\nint main(int argc, char *argv[]) {\n  // message data\n  key_t key;\n  int msgqid;\n\n  if ((key = ftok(\"../src/main.c\", 'Z')) == FAILED) {\n    perror(\"ftok\");\n    exit(1);\n  }\n\n  if ((msgqid = msgget(key, 0666 | IPC_CREAT)) == FAILED) { /* create an message queue with owner &amp; group &amp; others permission set to rw- */\n    perror(\"msgget\");\n    exit(1);\n  }\n\n  printf(\"Message Queue %i with key %i, been created [press return to delete]\", msgqid, key);\n  getchar();\n\n  if (msgctl(msgqid, IPC_RMID, NULL) == FAILED) {\n    perror(\"msgctl\");\n    exit(1);\n  }\n  printf(\"I'm outta here! \\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>send main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;string.h&gt;\n\n#include \"../../lib/shared_msgbuf.h\" /* mbuf, MSGSZ */\n\n#define FAILED -1\n\n\nint main(void) {\n  char s[MSGSZ];\n\n  printf(\"Enter a message: \");\n\n  if (fgets(s, sizeof s, stdin) == NULL)\n    perror(\"fgets\");\n  else \n    strcpy(mbuf.mtext, s);\n\n  printf(\"Connecting to the queue... \\n\", s);\n\n  // Setup\n  key_t key;\n  int msgqid;\n\n  if ((key = ftok(\"../../adqueue/src/main.c\", 'Z')) == FAILED) {\n    perror(\"ftok\");\n    exit(1);\n  }\n\n  if (msgqid = msgget(key, 0666) == FAILED) {\n    perror(\"msget\");\n    exit(1);\n  }\n\n  printf(\"\\n*CONNECTION ESTABLISHED* \\n\");\n  printf(\"queue id: %i \\n\", msgqid);\n  printf(\"queue key: %d \\n\", key);\n  printf(\"message: %s \\n\", s);\n\n  printf(\"Sending the message... \\n\");\n  if (msgsnd(msgqid, &amp;mbuf, MSGSZ, 0) == FAILED) {\n    perror(\"msgsnd\");\n    exit(0);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>So the problem is that I'm getting <code>Invalid argument</code> error number when trying to send the message. Looking at the data, I can't get why the id is not matching since connection to the queue seems to work...</p>\n\n<p>Exemplar data:</p>\n\n<pre><code>./cadqueue \nMessage Queue 327680 with key 1510081535, been created [press return to delete]\n\n./send \nEnter a message: test\nConnecting to the queue... \n\n*CONNECTION ESTABLISHED* \nqueue id: 0 \nqueue key: 1510081535 \nmessage: test\n\nSending the message... \nmsgsnd: Invalid argument\n</code></pre>\n"}, {"tags": ["c", "linux", "mmap"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1510741227, "post_id": 47304716, "comment_id": 81560018, "body": "Check if you have a ulimit set. Alternatively, your address space may not have any contiguous space left (look at /proc/&lt;pid&gt;/maps), if that&#39;s the case then you&#39;re out of luck and probably need to map the file in smaller bits."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1510741246, "post_id": 47304716, "comment_id": 81560030, "body": "I assume that you are using a 32-bit architecture. Have your program open <code>&#47;proc&#47;self&#47;maps</code> immediately after the <code>mmap</code> fails, and dump its contents to <code>stdout</code>.  I suspect you will find that there is no <i>contiguous</i> 900MB address space range, because there is something else in the way, such as shared libraries or the <code>malloc</code> heap.  I don&#39;t have any suggestions for how to move them, though."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510743088, "post_id": 47304716, "comment_id": 81561214, "body": "@Art, I&#39;m intersted in the same issue, what ulimit set I&#39;ve to use. I&#39;m using ulimit -a to see all ulimit items.   I see (focused): <code>POSIX message queues     (bytes, -q) 819200</code>, <code>data seg size           (kbytes, -d) unlimited</code>. Which is that impacts the issue!?"}, {"owner": {"reputation": 11, "user_id": 5854182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--x4iVia6A8A/AAAAAAAAAAI/AAAAAAAAAis/BfhHDrr7bsI/photo.jpg?sz=128", "display_name": "alex", "link": "https://stackoverflow.com/users/5854182/alex"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510745113, "post_id": 47304716, "comment_id": 81562544, "body": "@Art, no problem with ulimit as unlimited is present for vmem/file locks/max memory size/file size/data seg size. I&#39;m launching a script with execlp that show /proc/$PID/maps in the loop but didn&#39;t get any good return of it yet."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1510745280, "post_id": 47304716, "comment_id": 81562657, "body": "<code>errno == 12</code>?!?!  No.  Don&#39;t do that. Use the proper macro definition."}, {"owner": {"reputation": 11, "user_id": 5854182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--x4iVia6A8A/AAAAAAAAAAI/AAAAAAAAAis/BfhHDrr7bsI/photo.jpg?sz=128", "display_name": "alex", "link": "https://stackoverflow.com/users/5854182/alex"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510745434, "post_id": 47304716, "comment_id": 81562765, "body": "@AndrewHenle this bunch is just for test purpose"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510745670, "post_id": 47304716, "comment_id": 81562890, "body": "<i>this bunch is just for test purpose</i> So? It&#39;s still wrong."}, {"owner": {"reputation": 11, "user_id": 5854182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--x4iVia6A8A/AAAAAAAAAAI/AAAAAAAAAis/BfhHDrr7bsI/photo.jpg?sz=128", "display_name": "alex", "link": "https://stackoverflow.com/users/5854182/alex"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510839362, "post_id": 47304716, "comment_id": 81612795, "body": "@Art have you any info on how to map it in small bit ?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510928338, "post_id": 47304716, "comment_id": 81657545, "body": "&quot;But I don&#39;t understant why there is a HUGE GAP of ~880Mb between the heap and the first library&quot; Well, probably that gap is there, so that you heap may actually <i>grow</i> (via the <code>brk()</code> syscall). Your heap is just 16 MiB, your kernel cannot expect all programs to be happy with a max heap size that small..."}, {"owner": {"reputation": 11, "user_id": 5854182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--x4iVia6A8A/AAAAAAAAAAI/AAAAAAAAAis/BfhHDrr7bsI/photo.jpg?sz=128", "display_name": "alex", "link": "https://stackoverflow.com/users/5854182/alex"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510931546, "post_id": 47304716, "comment_id": 81659767, "body": "@cmaster I got your point but I&#39;m surely don&#39;t need a heap of 900Mb. Is there a way to move the start address of the library ?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1510932867, "post_id": 47304716, "comment_id": 81660641, "body": "You may know that you don&#39;t need a 900Mb heap, but your kernel doesn&#39;t... Anyway, I don&#39;t think there is a way to move a library in the virtual address space once it&#39;s loaded. As such, you would need to encode your placement wishes right into your ELF file, somehow. However, I have no clue how to achieve that, sorry. There could be some linker option for that, that&#39;s at least the direction I would start investigating if I were you."}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 0, "creation_date": 1517489757, "post_id": 47304716, "comment_id": 84122233, "body": "1) Swap has nothing to do with it. memory backed files already have a backing store (the file). 2) maybe you can swap vmem used by kernel and hypervisor."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 6338663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5f222cd2762b4493fcf4761dc51f59?s=128&d=identicon&r=PG&f=1", "display_name": "CK98", "link": "https://stackoverflow.com/users/6338663/ck98"}, "is_accepted": false, "score": 0, "last_activity_date": 1535350289, "last_edit_date": 1535350289, "creation_date": 1535339194, "answer_id": 52032057, "question_id": 47304716, "link": "https://stackoverflow.com/questions/47304716/mmap-returning-enomem/52032057#52032057", "title": "mmap returning ENOMEM", "body": "<p>Maybe you should look at /proc/&lt;pid&gt;/limits while running your process, find \"Max address space\" row and see its \"Soft Limit\" column. mmap will cause ENOMEM for limited address space. For this situation, you can call <a href=\"https://linux.die.net/man/2/setrlimit\" rel=\"nofollow noreferrer\">setrlimit(2)</a> in your program to modify Max address space of process.<br>\n<br>\nFor example:</p>\n\n<pre><code>// set maximum size of the virtual address space to 1GiB\nstruct rlimit rlim;\nrlim_t max_mem = 1 &lt;&lt; 30;\nrlim.rlim_cur = max_mem;\nsetrlimit(RLIMIT_AS, &amp;rlim);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5854182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--x4iVia6A8A/AAAAAAAAAAI/AAAAAAAAAis/BfhHDrr7bsI/photo.jpg?sz=128", "display_name": "alex", "link": "https://stackoverflow.com/users/5854182/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1258, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535350289, "creation_date": 1510740969, "last_edit_date": 1517490604, "question_id": 47304716, "link": "https://stackoverflow.com/questions/47304716/mmap-returning-enomem", "title": "mmap returning ENOMEM", "body": "<p>I read every post linked to this topic and didn't find anything that was able to solve my problem.</p>\n\n<p>I'm trying to map a 900Mb MAP_SHARED backed by an underlying file.\nWe have 2Gb of RAM and only 2Gb of VIRTUAL MEMORY available (1Gb reserved for Kernel + 1Gb reserved for Hypervisor).</p>\n\n<pre><code>ptr = mmap(NULL, size, PROT_READ, MAP_SHARED, fd, 0);\n</code></pre>\n\n<p>I was thinking about a lack of VMEM available so I tried to put \"sysctl -w vm.overcommit_memory=1\" but it failed with this too.</p>\n\n<p>I made a little loop (below) to know at which size mmap is really failing and I found it was next to 700Mb, so it works fine up to 700Mb and then failed.</p>\n\n<pre><code>ptr = mmap(NULL, size, PROT_READ, MAP_SHARED, fd, 0);\nif ((MAP_FAILED == ptr) &amp;&amp; (errno == ENOMEM)) {\n    for (i = 0; i &lt; 16; i++) {\n        ptr = mmap(NULL, size / 16, PROT_READ, MAP_SHARED, fd, (size / 16) * i);\n        if (MAP_FAILED == ptr) {\n            printf(\"map num:%d failed errno:%d\", i, errno);\n            break;\n        }\n    }\n</code></pre>\n\n<p>Thanks for your help.</p>\n\n<p>PS: shm_open and ftruncate are not returning any error. ftruncate and mmap are working with the same size.</p>\n\n<p>free -m is returning Swap 0 0 0.</p>\n\n<hr>\n\n<p>EDIT 1:\nObviously it cames up that I've no 900Mb contiguous space in VMEM, like I said with little mmap, stair by stair, I'm able to reach a mmap of ~720Mo but I didn't find a workaround about this contiguous limitation. Do I have to split it on several file descriptor or something like that ?</p>\n\n<hr>\n\n<p>EDIT 2:</p>\n\n<p>With some shmem size improvement I'm now able to mmap(870Mb), almost there :D\nBut I don't understand why there is <strong><em>a HUGE GAP of ~880Mb</em></strong> between the heap and the first library, does someone have an hint for me?</p>\n\n<p>Below the result of proc/$PID/maps</p>\n\n<pre><code>08048000-08081000 r-xp 00000000 08:02 2564       /usr/bin/myapp\n08081000-0820a000 rw-p 00038000 08:02 2564       /usr/bin/myapp\n0820a000-09151000 rwxp 00000000 00:00 0          [heap]\n40000000-40022000 r-xp 00000000 08:02 14697      /lib/ld-2.22.so\n40022000-40023000 r--p 00021000 08:02 14697      /lib/ld-2.22.so\n40023000-40024000 rw-p 00022000 08:02 14697      /lib/ld-2.22.so\n40024000-40025000 rw-p 00000000 00:00 0 \n40027000-40040000 r-xp 00000000 08:02 14692      /lib/libpthread-2.22.so\n40040000-40041000 r--p 00018000 08:02 14692      /lib/libpthread-2.22.so\n40041000-40042000 rw-p 00019000 08:02 14692      /lib/libpthread-2.22.so\n40042000-40044000 rw-p 00000000 00:00 0 \n40044000-4004b000 r-xp 00000000 08:02 14686      /lib/librt-2.22.so\n4004b000-4004c000 r--p 00006000 08:02 14686      /lib/librt-2.22.so\n4004c000-4004d000 rw-p 00007000 08:02 14686      /lib/librt-2.22.so\n4004d000-401b2000 r-xp 00000000 08:02 39034      /usr/lib/libxml2.so.2.9.2\n401b2000-401b7000 rw-p 00164000 08:02 39034      /usr/lib/libxml2.so.2.9.2\n401b7000-401b8000 rw-p 00000000 00:00 0 \n401b8000-40368000 r-xp 00000000 08:02 14699      /lib/libc-2.22.so\n40368000-40369000 ---p 001b0000 08:02 14699      /lib/libc-2.22.so\n40369000-4036b000 r--p 001b0000 08:02 14699      /lib/libc-2.22.so\n4036b000-4036c000 rw-p 001b2000 08:02 14699      /lib/libc-2.22.so\n4036c000-4036f000 rw-p 00000000 00:00 0 \n4036f000-40372000 r-xp 00000000 08:02 14881      /lib/libdl-2.22.so\n40372000-40373000 r--p 00002000 08:02 14881      /lib/libdl-2.22.so\n40373000-40374000 rw-p 00003000 08:02 14881      /lib/libdl-2.22.so\n40374000-40375000 rw-p 00000000 00:00 0 \n40375000-4038a000 r-xp 00000000 08:02 14698      /lib/libz.so.1.2.8\n4038a000-4038b000 rw-p 00015000 08:02 14698      /lib/libz.so.1.2.8\n4038b000-403d6000 r-xp 00000000 08:02 14664      /lib/libm-2.22.so\n403d6000-403d7000 r--p 0004a000 08:02 14664      /lib/libm-2.22.so\n403d7000-403d8000 rw-p 0004b000 08:02 14664      /lib/libm-2.22.so\n403d8000-403da000 rw-p 00000000 00:00 0 \n403da000-40b6a000 rw-s 17180000 00:05 2845       /dev/vmfileshm20\n40b6a000-40b6b000 ---p 00000000 00:00 0 \n40b6b000-4136b000 rw-p 00000000 00:00 0 \n4136b000-4156c000 rw-s 17a00000 00:05 2758       /dev/vmfileshm12\n4156c000-4176d000 rw-s 17c80000 00:05 2801       /dev/vmfileshm16\n4176d000-4176e000 ---p 00000000 00:00 0 \n4176e000-41f6e000 rw-p 00000000 00:00 0 \n41f6e000-42e6f000 rw-s 17f00000 00:05 2670       /dev/vmfileshm4\n42f00000-42f21000 rw-p 00000000 00:00 0 \n42f21000-43000000 ---p 00000000 00:00 0 \n43000000-43021000 rw-p 00000000 00:00 0 \n43021000-43100000 ---p 00000000 00:00 0 \n43100000-44001000 rw-s 1ad80000 00:05 2713       /dev/vmfileshm8\n44001000-44002000 ---p 00000000 00:00 0 \n44002000-44802000 rw-p 00000000 00:00 0 \n44802000-449ff000 rw-s 1d300000 00:05 2890       /dev/vmfileshm24\n449ff000-44a00000 ---p 00000000 00:00 0 \n44a00000-45200000 rw-p 00000000 00:00 0 \n45200000-45201000 ---p 00000000 00:00 0 \n45201000-45a01000 rw-p 00000000 00:00 0 \n45a01000-47570000 rw-s 1d780000 00:05 2933       /dev/vmfileshm28\n47570000-47aef000 rw-s 28380000 00:05 2967       /dev/vmfileshm31\n47aef000-47af0000 ---p 00000000 00:00 0 \n47af0000-482f0000 rw-p 00000000 00:00 0 \n482f0000-490e1000 r--s 2c480000 00:05 3025       /dev/vmfileshm37\n490e1000-49ed2000 r--s 2c480000 00:05 3025       /dev/vmfileshm37\n49ed2000-4acc3000 r--s 2c481000 00:05 3025       /dev/vmfileshm37\n4acc3000-4bab4000 r--s 2c482000 00:05 3025       /dev/vmfileshm37\n4bab4000-4c8a5000 r--s 2c483000 00:05 3025       /dev/vmfileshm37\n4c8a5000-4d696000 r--s 2c484000 00:05 3025       /dev/vmfileshm37\n4d696000-4e487000 r--s 2c485000 00:05 3025       /dev/vmfileshm37\n4e487000-4f278000 r--s 2c486000 00:05 3025       /dev/vmfileshm37\n4f278000-50069000 r--s 2c486000 00:05 3025       /dev/vmfileshm37\n50069000-50e5a000 r--s 2c487000 00:05 3025       /dev/vmfileshm37\n50e5a000-51c4b000 r--s 2c488000 00:05 3025       /dev/vmfileshm37\n51c4b000-52a3c000 r--s 2c489000 00:05 3025       /dev/vmfileshm37\n52a3c000-5382d000 r--s 2c48a000 00:05 3025       /dev/vmfileshm37\n5382d000-5461e000 r--s 2c48b000 00:05 3025       /dev/vmfileshm37\n5461e000-5540f000 r--s 2c48c000 00:05 3025       /dev/vmfileshm37\n5540f000-56200000 r--s 2c48d000 00:05 3025       /dev/vmfileshm37\n56200000-56ff1000 r--s 2c48d000 00:05 3025       /dev/vmfileshm37\n56ff1000-57de2000 r--s 2c48e000 00:05 3025       /dev/vmfileshm37\n57de2000-58bd3000 r--s 2c48f000 00:05 3025       /dev/vmfileshm37\n58bd3000-599c4000 r--s 2c490000 00:05 3025       /dev/vmfileshm37\n599c4000-5a7b5000 r--s 2c491000 00:05 3025       /dev/vmfileshm37\n5a7b5000-5b5a6000 r--s 2c492000 00:05 3025       /dev/vmfileshm37\n5b5a6000-5c397000 r--s 2c493000 00:05 3025       /dev/vmfileshm37\n5c397000-5d188000 r--s 2c494000 00:05 3025       /dev/vmfileshm37\n5d188000-5df79000 r--s 2c494000 00:05 3025       /dev/vmfileshm37\n5df79000-5ed6a000 r--s 2c495000 00:05 3025       /dev/vmfileshm37\n5ed6a000-5fb5b000 r--s 2c496000 00:05 3025       /dev/vmfileshm37\n5fb5b000-6094c000 r--s 2c497000 00:05 3025       /dev/vmfileshm37\n6094c000-6173d000 r--s 2c498000 00:05 3025       /dev/vmfileshm37\n6173d000-6252e000 r--s 2c499000 00:05 3025       /dev/vmfileshm37\n6252e000-6331f000 r--s 2c49a000 00:05 3025       /dev/vmfileshm37\n6331f000-64110000 r--s 2c49b000 00:05 3025       /dev/vmfileshm37\n64110000-64f01000 r--s 2c49b000 00:05 3025       /dev/vmfileshm37\n64f01000-65cf2000 r--s 2c49c000 00:05 3025       /dev/vmfileshm37\n65cf2000-66ae3000 r--s 2c49d000 00:05 3025       /dev/vmfileshm37\n66ae3000-678d4000 r--s 2c49e000 00:05 3025       /dev/vmfileshm37\n678d4000-686c5000 r--s 2c49f000 00:05 3025       /dev/vmfileshm37\n686c5000-694b6000 r--s 2c4a0000 00:05 3025       /dev/vmfileshm37\n694b6000-6a2a7000 r--s 2c4a1000 00:05 3025       /dev/vmfileshm37\n6a2a7000-6b098000 r--s 2c4a1000 00:05 3025       /dev/vmfileshm37\n6b098000-6be89000 r--s 2c4a2000 00:05 3025       /dev/vmfileshm37\n6be89000-6cc7a000 r--s 2c4a3000 00:05 3025       /dev/vmfileshm37\n6cc7a000-6da6b000 r--s 2c4a4000 00:05 3025       /dev/vmfileshm37\n6da6b000-6e85c000 r--s 2c4a5000 00:05 3025       /dev/vmfileshm37\n6e85c000-6f64d000 r--s 2c4a6000 00:05 3025       /dev/vmfileshm37\n6f64d000-7043e000 r--s 2c4a7000 00:05 3025       /dev/vmfileshm37\n7043e000-7122f000 r--s 2c4a8000 00:05 3025       /dev/vmfileshm37\n7122f000-72020000 r--s 2c4a8000 00:05 3025       /dev/vmfileshm37\n72020000-72e11000 r--s 2c4a9000 00:05 3025       /dev/vmfileshm37\n72e11000-73c02000 r--s 2c4aa000 00:05 3025       /dev/vmfileshm37\n73c02000-749f3000 r--s 2c4ab000 00:05 3025       /dev/vmfileshm37\n749f3000-757e4000 r--s 2c4ac000 00:05 3025       /dev/vmfileshm37\n757e4000-765d5000 r--s 2c4ad000 00:05 3025       /dev/vmfileshm37\n765d5000-773c6000 r--s 2c4ae000 00:05 3025       /dev/vmfileshm37\n773c6000-781b7000 r--s 2c4af000 00:05 3025       /dev/vmfileshm37\n781b7000-78fa8000 r--s 2c4af000 00:05 3025       /dev/vmfileshm37\n78fa8000-79d99000 r--s 2c4b0000 00:05 3025       /dev/vmfileshm37\n79d99000-7ab8a000 r--s 2c4b1000 00:05 3025       /dev/vmfileshm37\n7ab8a000-7b97b000 r--s 2c4b2000 00:05 3025       /dev/vmfileshm37\n7b97b000-7c76c000 r--s 2c4b3000 00:05 3025       /dev/vmfileshm37\n7c76c000-7d55d000 r--s 2c4b4000 00:05 3025       /dev/vmfileshm37\n7d55d000-7e34e000 r--s 2c4b5000 00:05 3025       /dev/vmfileshm37\n7e34e000-7f13f000 r--s 2c4b6000 00:05 3025       /dev/vmfileshm37\n7f91e000-7f93f000 rw-p 00000000 00:00 0          [stack]\n00000000-00000000 r-xp 00000000 00:00 0          [vdso]\n</code></pre>\n\n<hr>\n\n<p>EDIT 3:\nNow I've moved all little shared memories (see below) just after the heap and let the >900Mb one above the lib (in order to have the maximum available space for my big shared mem)</p>\n\n<pre><code>08048000-08081000 r-xp 00000000 08:02 2652       /usr/bin/myapp\n08081000-0820a000 rw-p 00038000 08:02 2652       /usr/bin/myapp\n0820a000-09151000 rwxp 00000000 00:00 0          [heap]\n0b001000-0b791000 rw-s 17180000 00:05 2655       /dev/shm20\n0b791000-0b992000 rw-s 17a00000 00:05 2567       /dev/shm12\n0b992000-0bb93000 rw-s 17c80000 00:05 2611       /dev/shm16\n0bb93000-0ca94000 rw-s 17f00000 00:05 2479       /dev/shm4\n0ca94000-0d995000 rw-s 19e00000 00:05 2523       /dev/shm8\n0d995000-0db92000 rw-s 1ad80000 00:05 2700       /dev/shm24\n0db92000-0f701000 rw-s 1b680000 00:05 2743       /dev/shm28\n0f701000-0fc80000 rw-s 1eb80000 00:05 2776       /dev/shm31\n40000000-40022000 r-xp 00000000 08:02 14697      /lib/ld-2.22.so\n40022000-40023000 r--p 00021000 08:02 14697      /lib/ld-2.22.so\n40023000-40024000 rw-p 00022000 08:02 14697      /lib/ld-2.22.so\n40024000-40025000 rw-p 00000000 00:00 0 \n40027000-40040000 r-xp 00000000 08:02 14692      /lib/libpthread-2.22.so\n40040000-40041000 r--p 00018000 08:02 14692      /lib/libpthread-2.22.so\n40041000-40042000 rw-p 00019000 08:02 14692      /lib/libpthread-2.22.so\n40042000-40044000 rw-p 00000000 00:00 0 \n40044000-4004b000 r-xp 00000000 08:02 14686      /lib/librt-2.22.so\n4004b000-4004c000 r--p 00006000 08:02 14686      /lib/librt-2.22.so\n4004c000-4004d000 rw-p 00007000 08:02 14686      /lib/librt-2.22.so\n4004d000-401b2000 r-xp 00000000 08:02 39031      /usr/lib/libxml2.so.2.9.2\n401b2000-401b7000 rw-p 00164000 08:02 39031      /usr/lib/libxml2.so.2.9.2\n401b7000-401b8000 rw-p 00000000 00:00 0 \n401b8000-40368000 r-xp 00000000 08:02 14699      /lib/libc-2.22.so\n40368000-40369000 ---p 001b0000 08:02 14699      /lib/libc-2.22.so\n40369000-4036b000 r--p 001b0000 08:02 14699      /lib/libc-2.22.so\n4036b000-4036c000 rw-p 001b2000 08:02 14699      /lib/libc-2.22.so\n4036c000-4036f000 rw-p 00000000 00:00 0 \n4036f000-40372000 r-xp 00000000 08:02 14881      /lib/libdl-2.22.so\n40372000-40373000 r--p 00002000 08:02 14881      /lib/libdl-2.22.so\n40373000-40374000 rw-p 00003000 08:02 14881      /lib/libdl-2.22.so\n40374000-40375000 rw-p 00000000 00:00 0 \n40375000-4038a000 r-xp 00000000 08:02 14698      /lib/libz.so.1.2.8\n4038a000-4038b000 rw-p 00015000 08:02 14698      /lib/libz.so.1.2.8\n4038b000-403d6000 r-xp 00000000 08:02 14664      /lib/libm-2.22.so\n403d6000-403d7000 r--p 0004a000 08:02 14664      /lib/libm-2.22.so\n403d7000-403d8000 rw-p 0004b000 08:02 14664      /lib/libm-2.22.so\n403d8000-403da000 rw-p 00000000 00:00 0 \n403da000-403db000 ---p 00000000 00:00 0 \n403db000-40bdb000 rw-p 00000000 00:00 0 \n40bdb000-40bdc000 ---p 00000000 00:00 0 \n40bdc000-413dc000 rw-p 00000000 00:00 0 \n41400000-41421000 rw-p 00000000 00:00 0 \n41421000-41500000 ---p 00000000 00:00 0 \n41500000-41521000 rw-p 00000000 00:00 0 \n41521000-41600000 ---p 00000000 00:00 0 \n41600000-41601000 ---p 00000000 00:00 0 \n41601000-41e01000 rw-p 00000000 00:00 0 \n41e01000-41e02000 ---p 00000000 00:00 0 \n41e02000-42602000 rw-p 00000000 00:00 0 \n42602000-42603000 ---p 00000000 00:00 0 \n42603000-42e03000 rw-p 00000000 00:00 0 \n42e03000-42e04000 ---p 00000000 00:00 0 \n42e04000-43604000 rw-p 00000000 00:00 0 \n43604000-47065000 r--s 22280000 00:05 2835       /dev/shm37\n47065000-4aac6000 r--s 22283000 00:05 2835       /dev/shm37\n4aac6000-4e527000 r--s 22287000 00:05 2835       /dev/shm37\n4e527000-51f88000 r--s 2228a000 00:05 2835       /dev/shm37\n51f88000-559e9000 r--s 2228e000 00:05 2835       /dev/shm37\n559e9000-5944a000 r--s 22292000 00:05 2835       /dev/shm37\n5944a000-5ceab000 r--s 22295000 00:05 2835       /dev/shm37\n5ceab000-6090c000 r--s 22299000 00:05 2835       /dev/shm37\n6090c000-6436d000 r--s 2229d000 00:05 2835       /dev/shm37\n6436d000-67dce000 r--s 222a0000 00:05 2835       /dev/shm37\n67dce000-6b82f000 r--s 222a4000 00:05 2835       /dev/shm37\n6b82f000-6f290000 r--s 222a8000 00:05 2835       /dev/shm37\n6f290000-72cf1000 r--s 222ab000 00:05 2835       /dev/shm37\n72cf1000-76752000 r--s 222af000 00:05 2835       /dev/shm37\n76752000-7a1b3000 r--s 222b3000 00:05 2835       /dev/shm37\n7a1b3000-7dc14000 r--s 222b6000 00:05 2835       /dev/shm37\n7ff25000-7ff46000 rw-p 00000000 00:00 0          [stack]\n00000000-00000000 r-xp 00000000 00:00 0          [vdso]\n</code></pre>\n\n<p>As mmap continued to fail with ENOMEM error even if it got enough place to map it I decided to chunk the mmap.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for (i = 0; ((i &lt; NB_CHUNK) &amp;&amp; (ptr != MAP_FAILED)); i++) {\n              ptr = mmap(NULL,\n                         ALIGN_ON_PAGE_SIZE((BIG_SIZE / NB_CHUNK)),\n                         PROT_READ,\n                         MAP_SHARED,\n                         fd,\n                         (off_t)ALIGN_ON_PAGE_SIZE((BIG_SIZE / NB_CHUNK) * i));\n}\n</code></pre>\n\n<p>Now I've no more ENOMEM error and the mmap is doing well but when I try to read a value in it I'm only reading zeroed memory.</p>\n\n<p>The question is, Can I chunk a mmap this way ?</p>\n"}, {"tags": ["c", "algorithm", "strcpy"], "comments": [{"owner": {"reputation": 4038, "user_id": 2159939, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/d4Hlu.jpg?s=128&g=1", "display_name": "Ivan Smirnov", "link": "https://stackoverflow.com/users/2159939/ivan-smirnov"}, "edited": false, "score": 1, "creation_date": 1510741171, "post_id": 47304639, "comment_id": 81559988, "body": "What is the problem statement? It is hard to guess how does the output depend on the input."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1510741251, "post_id": 47304639, "comment_id": 81560034, "body": "A debugger will tell you where the seg fault occurs. Your problem statement is vague. <code>stringArray</code> seems to describe edges of a graph and your output should be paths to A. Please edit this into the question."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1510741564, "post_id": 47304639, "comment_id": 81560222, "body": "If you replace strcpy with strcat, segfault still occurs?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1510747166, "post_id": 47304639, "comment_id": 81563868, "body": "You&#39;re going to have to explain how that input is supposed to give that output."}, {"owner": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "edited": false, "score": 0, "creation_date": 1510752734, "post_id": 47304639, "comment_id": 81567772, "body": "Ignore the algorithm! I changed the question accoring asking only about the error occuring."}], "answers": [{"comments": [{"owner": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "edited": false, "score": 0, "creation_date": 1510752909, "post_id": 47305033, "comment_id": 81567922, "body": "Thanks it worked for the first iteration <code>B-F-D-A</code> but afterwards the error appears again."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "edited": false, "score": 0, "creation_date": 1510755753, "post_id": 47305033, "comment_id": 81569906, "body": "Hmmm. I can&#39;t reproduce that. Anyway, you seem to have found a solution."}, {"owner": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "edited": false, "score": 0, "creation_date": 1510756544, "post_id": 47305033, "comment_id": 81570579, "body": "I&#39;m compilig with <code>gcc -Wall -O3 -DNDEBUG -static -std=c99 -pipe -o &quot;%e&quot; &quot;%f&quot; -lm</code> on ubuntu 16.04"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "edited": false, "score": 0, "creation_date": 1510757183, "post_id": 47305033, "comment_id": 81571076, "body": "If I take the code from your question, just fi what I&#39;ve shown above and then compile, it works. I don&#39;t see how putting the memory on the heap fixes the problem. (You never free the memory from <code>malloc</code> or <code>strdup</code>, so you have many memory leaks.) I&#39;m also unsure why you activate the heavy optimisation for a simple program."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 2, "last_activity_date": 1510741876, "creation_date": 1510741876, "answer_id": 47305033, "question_id": 47304639, "link": "https://stackoverflow.com/questions/47304639/segmentation-fault-core-dumped-with-the-strcpy-function-in-c/47305033#47305033", "title": "Segmentation fault (core dumped) with the strcpy-function in c", "body": "<p>The segmentation violation occurs in this line:</p>\n\n<pre><code>    usedString[lentemp - index - 1] = 0;\n</code></pre>\n\n<p>Here, you're trying to find the index from the end, but your <code>strlstchar</code> returns the index from the beginning, although it starts searching from the end. And you want truncate the string at the found character, of course.</p>\n\n<p>Replace this line with just:</p>\n\n<pre><code>    usedString[index] = 0;\n</code></pre>\n\n<p>and you get the desired output.</p>\n"}], "owner": {"reputation": 921, "user_id": 5473482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeaae36b0eddf68059ee247bb5372dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Blind0ne", "link": "https://stackoverflow.com/users/5473482/blind0ne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 47305033, "answer_count": 1, "score": -2, "last_activity_date": 1510754127, "creation_date": 1510740800, "last_edit_date": 1510753466, "question_id": 47304639, "link": "https://stackoverflow.com/questions/47304639/segmentation-fault-core-dumped-with-the-strcpy-function-in-c", "title": "Segmentation fault (core dumped) with the strcpy-function in c", "body": "<p>I am trying to write a function which will read two strings <code>stringArray[MAX]=\"ABADDFDEFBFCCHCGGEHJJI\"</code> and <code>popArr[MAX]=\"ABCDEFGHIJ\"</code> and generate an output like this:</p>\n\n<pre><code>A\nB-F-D-A\nC-F-D-A\nD-A\nE-G-C-F-D-A\nF-D-A\nG-C-F-D-A\nH-C-F-D-A\nI-J-H-C-F-D-A\nJ-H-C-F-D-A\n</code></pre>\n\n<p>However I'm getting a <code>Segmentation fault (core dumped)</code> Error. Why? This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX 100\n\nsize_t strlstchar(const char *str, const char ch)\n{\n    char *chptr = strrchr(str, ch);\n    return chptr - str;\n}\n\nint main(){ \n    // Input strings    \n    char stringArray[MAX]=\"ABADDFDEFBFCCHCGGEHJJI\";\n    char popArr[MAX]=\"ABCDEFGHIJ\";\n\n    int index=2, lenpop, lentemp;\n    char usedString[MAX]=\"\";    \n    char tempChar;\n\n    lenpop    = strlen(popArr); \n\n    printf(\"%c\\n\", stringArray[0]); \n\n    for(int i=1;i&lt;lenpop;i++){\n        strcpy(usedString, stringArray);\n        printf(\"%c\", popArr[i]);\n        tempChar = popArr[i];\n\n        while(tempChar!=stringArray[0]){\n            while(index%2==0){\n                index = strlstchar(usedString, tempChar);\n                lentemp = strlen(usedString);\n                usedString[lentemp-index-1]=0;\n                }   \n\n            printf(\"-%c\", usedString[index-1]);\n            tempChar=usedString[index-1];   \n            index=2;        \n            }\n            printf(\"\\n\");       \n        }\n\n    return 0;\n    }\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1510740740, "post_id": 47304565, "comment_id": 81559696, "body": "Read as a string, remove all commas from the string, parse string to convert it to an integer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8944219"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510744343, "post_id": 47304565, "comment_id": 81562072, "body": "@Someprogrammerdude Thanks. That&#39;s my initial thought as well. I probably need to read on how to do that."}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 8902785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B1H0GeRlI4c/AAAAAAAAAAI/AAAAAAAABZY/qiTZOYLEe-0/photo.jpg?sz=128", "display_name": "Elad Hazan", "link": "https://stackoverflow.com/users/8902785/elad-hazan"}, "is_accepted": false, "score": 1, "last_activity_date": 1510742271, "last_edit_date": 1510742271, "creation_date": 1510741388, "answer_id": 47304851, "question_id": 47304565, "link": "https://stackoverflow.com/questions/47304565/how-to-read-a-number-above-999-that-is-separated-by-a-comma-eg-10-000/47304851#47304851", "title": "How to read a number above 999 that is separated by a comma (eg. 10,000)?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid RemoveChar(char* Number, char chartoberemoved)\n{\n    char *p, *s;\n    p = s = Number;\n    while (*s)//Run until last \\r\\n\n    {\n\n        if (*s != chartoberemoved)\n        {\n            *p++ = *s;\n        }\n        /* We always advance s. */\n        s++;\n\n    }\n    /* We 0-terminate p. */\n    *p = 0;\n}\n\n\nint main(int argc, char* argv[])\n{\n    char array[32];\n    if (!argv[1])\n        return -1;\n    strcpy(array, argv[1]);\n    RemoveChar(array, ',');\n    int num = atoi(array);\n    printf(\"%d\\n\", num);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7126135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e074dec32535b0cd178f7e88abe45f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Ayush. S", "link": "https://stackoverflow.com/users/7126135/ayush-s"}, "is_accepted": false, "score": -1, "last_activity_date": 1510741394, "creation_date": 1510741394, "answer_id": 47304853, "question_id": 47304565, "link": "https://stackoverflow.com/questions/47304565/how-to-read-a-number-above-999-that-is-separated-by-a-comma-eg-10-000/47304853#47304853", "title": "How to read a number above 999 that is separated by a comma (eg. 10,000)?", "body": "<p>use <code>strtok</code> its information and documentation can be found here. <a href=\"http://www.cplusplus.com/reference/cstring/strtok/\" rel=\"nofollow noreferrer\">link</a></p>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 1289198, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ed1ed50abd03457dd455c60a4e80d7c6?s=128&d=identicon&r=PG", "display_name": "yakoudbz", "link": "https://stackoverflow.com/users/1289198/yakoudbz"}, "is_accepted": false, "score": 1, "last_activity_date": 1510743903, "last_edit_date": 1510743903, "creation_date": 1510743429, "answer_id": 47305604, "question_id": 47304565, "link": "https://stackoverflow.com/questions/47304565/how-to-read-a-number-above-999-that-is-separated-by-a-comma-eg-10-000/47305604#47305604", "title": "How to read a number above 999 that is separated by a comma (eg. 10,000)?", "body": "<p>Most implementation of scanf and printf on Linux support <code>'</code> to tell that the number may have a thousands separator:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n\n\nint main(int argc, char const *argv[])\n{\n    setlocale(LC_NUMERIC, \"\"); // set the locale so that \",\" is a thousands separator\n\n    const char* string = \"10,000\";\n\n    float num = 0;\n    sscanf(string, \"%'f\", &amp;num);\n    printf(\"%f\\n\", num);\n\n    return 0;\n}\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>10000.000000\n</code></pre>\n\n<p><a href=\"https://www.systutorials.com/docs/linux/man/3-printf/\" rel=\"nofollow noreferrer\">https://www.systutorials.com/docs/linux/man/3-printf/</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8944219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1510744588, "creation_date": 1510740622, "last_edit_date": 1510744588, "question_id": 47304565, "link": "https://stackoverflow.com/questions/47304565/how-to-read-a-number-above-999-that-is-separated-by-a-comma-eg-10-000", "title": "How to read a number above 999 that is separated by a comma (eg. 10,000)?", "body": "<p>I'm new to C (and programming) and it's possible that my question can be answered with some basic searching and reading; please point me to an answer to the question if it exists.</p>\n\n<p>Let's say that I want to read a number that can possibly be above 999 from the user. From my experience, if I enter the value 10,000 (including the comma), the program would read the number until the comma and then stop taking input. Thus, the input would be 10 instead of 10000.</p>\n\n<p><strong>How can I make it read '10,000' as if it is 10000?</strong></p>\n"}, {"tags": ["c", "setjmp"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1510740665, "post_id": 47304514, "comment_id": 81559658, "body": "I suggest that you read e.g. <a href=\"https://stackoverflow.com/questions/1715413/longjmp-from-signal-handler\">longjmp() from signal handler</a> first. What you do might be a bad idea."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1510740750, "post_id": 47304514, "comment_id": 81559704, "body": "@Someprogrammerdude lots of &quot;bad ideas&quot; here, like calling non async-safe functions from a signal handler."}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1510740906, "post_id": 47304514, "comment_id": 81559827, "body": "@EOF please elaborate. It is my first time using setjmp and longjmp"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1510740910, "post_id": 47304514, "comment_id": 81559831, "body": "Apart from the bad ideas, it does seem to &quot;work&quot; here on Ubuntu 16.04 Linux"}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "reply_to_user": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1510740965, "post_id": 47304514, "comment_id": 81559868, "body": "@marcolz can you please share the output. It doesnot seem to work for me"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1510740993, "post_id": 47304514, "comment_id": 81559883, "body": "@nalinkanoongo The problem is not specific to <code>setjmp()</code>. Research &quot;async-safety&quot; for C functions."}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1510741207, "post_id": 47304514, "comment_id": 81560009, "body": "@nalinkanoongo Sure. I added an include for unistd.h (for alarm()) and it gave me: <a href=\"https://pastebin.com/zacDk7mx\" rel=\"nofollow noreferrer\">pastebin.com/zacDk7mx</a>"}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1510741697, "post_id": 47304514, "comment_id": 81560316, "body": "@EOF what could be the possible outcomes of calling a longjmp from a signal handler."}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "edited": false, "score": 0, "creation_date": 1510741743, "post_id": 47304514, "comment_id": 81560344, "body": "@marcoz thank you. Is it platform dependent? I dont get the output but you can run it on Ubuntu 16.04"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1510746901, "post_id": 47304514, "comment_id": 81563692, "body": "&quot;I am trying to learn setjump and longjump in C&quot; Why? There is no reason to learn about these functions - they should never be used for any purpose."}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "edited": false, "score": 0, "creation_date": 1510750110, "post_id": 47304514, "comment_id": 81565891, "body": "Actually i was going through one of the daemon codes of freebsd. They had used it.. Part of the job"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1510750770, "post_id": 47304514, "comment_id": 81566359, "body": "<code>int q = setjmp(po);</code> You <b>cannot</b> assign (or even worse: use it as an initializer expression) the &quot;return value&quot; from setjump, you can only test it."}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1510750986, "post_id": 47304514, "comment_id": 81566528, "body": "@wildplasser have a look at this link.<a href=\"https://www.techonthenet.com/c_language/standard_library_functions/setjmp_h/setjmp.php\" rel=\"nofollow noreferrer\">techonthenet.com/c_language/standard_library_functions/&zwnj;&#8203;setjmp_h/&hellip;</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1510752198, "post_id": 47304514, "comment_id": 81567380, "body": "<code>static void ti() {</code>--&gt; <code>static void ti(int signum) {</code> And sigsetjmp() / siglongjmp()"}], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 3623560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004089845757/picture?type=large", "display_name": "yabhishek", "link": "https://stackoverflow.com/users/3623560/yabhishek"}, "is_accepted": true, "score": 2, "last_activity_date": 1522554113, "last_edit_date": 1522554113, "creation_date": 1510745107, "answer_id": 47306177, "question_id": 47304514, "link": "https://stackoverflow.com/questions/47304514/set-jump-and-long-jump-codeflow-in-c/47306177#47306177", "title": "set jump and long jump codeflow in c", "body": "<p>Since I can't comment on any post other than mine as my reputations are less than 50, here is the output when your code is executed on mac os:</p>\n\n<p>I don't see any problem with your code as <code>alarm(5)</code> is being called as many number of times as <code>funcall()</code> is called.</p>\n\n<p>For each call to <code>funcall()</code>, first call to <code>alarm(5)</code> sets the <strong>SIGALRM</strong> signal to be delivered to the calling process (which is nothing but the function being executed/thread executing the function) after 5 seconds while the remaining part of the code executes.</p>\n\n<p>Since in each call to <code>funcall()</code> static variable <strong>p</strong> is set to 0, <code>if(p &gt; 0){...}</code> block will not be executed until <code>p</code> is greater than 0 which happens only if the next statement following the body of this block, <code>p++</code> incrementing <code>p</code> and making it greater than zero, is executed.</p>\n\n<p>Execution of the aforementioned <strong>if</strong> block and therefore call to <code>alarm(0)</code> depends on the time taken by the <code>for</code> loop following <code>p++</code> to terminate. If execution of <code>for</code> loop finishes within 5 seconds, <code>return 0</code> statement will return the control to the calling function. The <code>return</code> will cancel all the alarm requests and destroy the function call stack. So, in this case <code>alarm(0)</code> is not called.</p>\n\n<p>Next, if execution of <code>for</code> loop takes > 5 seconds (ignoring all the scheduling delays that can happen and may result in unexpected behaviors at times), the pending alarm will be fired, resulting in invocation of signal handler <code>ti()</code>. When the signal handler <code>ti()</code> is invoked, the call to <code>longjump()</code> is made and execution starts again at the calling instruction of the <code>setjump()</code>. By the time control reaches at <code>alarm(0)</code>(assuming the <code>for</code> loop keeps executing for as long as preceding <code>if</code> block does not get executed for the second time), all the remaining alarm requests get cancelled by this call. So, <code>alarm(0)</code> cancels all the pending alarm requests after p>0 and <code>for</code> loop takes longer than 5 seconds. </p>\n\n<p>Here is the execution recorded through <strong>asciinema</strong>\n<a href=\"https://asciinema.org/a/fyZX7CRoikq5kLJS2t0Og2rot\" rel=\"nofollow noreferrer\">https://asciinema.org/a/fyZX7CRoikq5kLJS2t0Og2rot</a></p>\n\n<p>And here is a screen shot of the asciinema session after execution completes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8pWbS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8pWbS.png\" alt=\"screen shot of output from asciinema session\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "accepted_answer_id": 47306177, "answer_count": 1, "score": 1, "last_activity_date": 1522554113, "creation_date": 1510740483, "last_edit_date": 1510751538, "question_id": 47304514, "link": "https://stackoverflow.com/questions/47304514/set-jump-and-long-jump-codeflow-in-c", "title": "set jump and long jump codeflow in c", "body": "<p>I am trying to learn setjump and longjump in C. Can anyone help me with the output of the following code along with the code flow and the explanation for the the cases.i have called a function funcall() in the code. The alarm is being called for the first iteration but in the subsequent iterations the alarm is not being called. Why is it so? Does alarm(0) prevents any future alarm requests?</p>\n\n<p>EDIT : Even after deleting the \"print_T()\" line in the signal handler the code doesnot seem to run.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;time.h&gt;\n\n#define LEN 50\n\njmp_buf po;\n\nvoid print_T() {\n    time_t rawtime;\n    struct tm * timeinfo;\n\n    time(&amp;rawtime);\n    timeinfo = localtime ( &amp;rawtime );\n    printf ( \"Current local time and date: %s\", asctime (timeinfo) );\n}\n\n\n\nstatic void ti() {\n    print_T();\n    longjmp(po,1);\n}\nint funcall(int reply) {\n\n\n    static int p;\n    p = 0;\n    signal(SIGALRM, ti);\n    int q = setjmp(po);\n    if(q == 0)  \n        printf(\"the value BEFORE setjmp %d for reply %d\\n\", p, reply);\n    else \n        printf(\"the value AFTER setjmp %d for reply %d\\n\", p, reply);\n    alarm(5);\n\n    if(p &gt; 0) {\n        printf(\"INVOKING THE ALARM\");\n        alarm(0);\n        return -1;\n    }\n\n    p++;    \n    for(int i = 0; i &lt; 100000; i++) \n        for(int j = 0; j &lt; 100000; j++);\n    return 0;\n\n}\n\nint main() {\n\n    int a;\n    int reply;\n    time_t start, end;\n    for(reply=0; ; reply++) {\n        printf(\"~~~~~~~~~~~~~~~~~~~~~~~~~ITERATION NUMBER  %d\\n\", reply);\n\n        time(&amp;start);\n        a = funcall(reply);\n        time(&amp;end);\n        double tin = difftime(end, start);\n        printf(\"*********************ITERATION END  and a returned is %d after %f\\n\", a, tin );\n        double tidiff = difftime(end, start);\n        if(a &lt; 0)\n            if(reply == 10) {\n                break;\n           }\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1510740466, "post_id": 47304287, "comment_id": 81559529, "body": "You should consult the relevant documentation about the meaning of <code>fscanf()</code>s return value."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1510740934, "creation_date": 1510740934, "answer_id": 47304701, "question_id": 47304287, "link": "https://stackoverflow.com/questions/47304287/read-from-a-formatted-test-file-using-fscanf-in-c/47304701#47304701", "title": "read from a formatted test file using fscanf() in c", "body": "<p>I would use this algorithm:</p>\n\n<ol>\n<li><p>Read while char read isn't ':'</p></li>\n<li><p>Start storing all next chars on username var while the char read is !=' '</p></li>\n<li><p>Remove the last space on the username string</p></li>\n<li><p>Repeat step 1.</p></li>\n<li><p>Same as step 2 but now we store the read data on password value while the read char is != ''\\n'</p></li>\n<li><p>Repeat while ! end of file</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1510741758, "post_id": 47304781, "comment_id": 81560354, "body": "<code>fscanf(fp, &quot;Username:%s Password:%s\\n&quot;,username,password)</code> -- note that it is bad practice to use trailing whitespace characters in <code>scanf()</code> format strings. Since the input is from a file, this will work as expected, but this is a common error when using <code>scanf()</code> for interactive input where it causes problems. Better to place a space at the beginning of the format string to consume previous newline characters: <code>fscanf(fp, &quot; Username:%s Password:%s&quot;,username,password)</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1510742038, "post_id": 47304781, "comment_id": 81560553, "body": "Also, maximum widths should be specified when reading strings using <code>%s</code> or <code>%[]</code> to avoid buffer overflow: <code>fscanf(fp, &quot; Username:%127s Password:%127s&quot;,username,password)</code>."}, {"owner": {"reputation": 878, "user_id": 6911973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-l6J99KFNfBM/AAAAAAAAAAI/AAAAAAAAAWs/QMDeg2Waeoc/photo.jpg?sz=128", "display_name": "Jay Joshi", "link": "https://stackoverflow.com/users/6911973/jay-joshi"}, "edited": false, "score": 0, "creation_date": 1510742201, "post_id": 47304781, "comment_id": 81560661, "body": "why you checked ret value to be 2 ? in if(ret == 2) ?"}, {"owner": {"reputation": 1113, "user_id": 3336541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a2fe96f859a541bd9f0fb375800922d?s=128&d=identicon&r=PG", "display_name": "Prabhakar Lad", "link": "https://stackoverflow.com/users/3336541/prabhakar-lad"}, "reply_to_user": {"reputation": 878, "user_id": 6911973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-l6J99KFNfBM/AAAAAAAAAAI/AAAAAAAAAWs/QMDeg2Waeoc/photo.jpg?sz=128", "display_name": "Jay Joshi", "link": "https://stackoverflow.com/users/6911973/jay-joshi"}, "edited": false, "score": 2, "creation_date": 1510742337, "post_id": 47304781, "comment_id": 81560764, "body": "@JayJoshi  you need to look at fscanf function return value:  On  success, these functions return the number of input items successfully matched and assigned; this can be fewer than provided        for, or even zero, in the event of an early matching failure.         The value EOF is returned if the end of input is reached before either the first successful conversion  or  a  matching  failure        occurs.   EOF  is also returned if a read error occurs, in which case the error indicator for the stream (see ferror(3)) is set,        and errno is set to indicate the error."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1510743816, "post_id": 47304781, "comment_id": 81561750, "body": "@PrabhakarLad -- &quot;EOF is also returned if a read error occurs, in which case the error indicator for the stream (see ferror(3)) is set, and errno is set to indicate the error. &quot; Note that this is not in the Standard, but is a POSIX extension."}, {"owner": {"reputation": 1113, "user_id": 3336541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a2fe96f859a541bd9f0fb375800922d?s=128&d=identicon&r=PG", "display_name": "Prabhakar Lad", "link": "https://stackoverflow.com/users/3336541/prabhakar-lad"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1510744859, "post_id": 47304781, "comment_id": 81562383, "body": "@DavidBowling thank you that was more clearer explanation."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1510828738, "post_id": 47304781, "comment_id": 81605570, "body": "the call to <code>printf()</code> modifies the value of <code>errno</code>.  so the first couple of lines of the read loop should be: <code>while (1) { if( 2 != fscanf(fp, &quot; Username:%127s Password:%127s&quot;, username, password ) )  { perror( &quot;fscanf failed&quot; ); fclose(fp); exit( EXIT_FAILURE ); }   &#47;&#47; implied else, fread successful  printf(&quot;%s %s\\n&quot;, username, password); }</code>"}], "tags": [], "owner": {"reputation": 1113, "user_id": 3336541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a2fe96f859a541bd9f0fb375800922d?s=128&d=identicon&r=PG", "display_name": "Prabhakar Lad", "link": "https://stackoverflow.com/users/3336541/prabhakar-lad"}, "is_accepted": true, "score": 1, "last_activity_date": 1510741174, "creation_date": 1510741174, "answer_id": 47304781, "question_id": 47304287, "link": "https://stackoverflow.com/questions/47304287/read-from-a-formatted-test-file-using-fscanf-in-c/47304781#47304781", "title": "read from a formatted test file using fscanf() in c", "body": "<p>Try the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, char *argv[])\n{\n    char username[128];\n    char password[128];\n    FILE *fp;\n    int ret;\n\n    fp = fopen(\"read.txt\", \"r\");\n    if (!fp) {\n        printf(\"Failed to open a file\\n\");\n        return 1;\n    }\n\n    while (1) {\n        ret = fscanf(fp, \"Username:%s Password:%s\\n\",username,password);\n        if (ret == EOF)\n            break;\n        if (ret == 2)\n            printf(\"%s %s\\n\", username, password);\n        else {\n            printf(\"%d\\n\", ret);\n            perror(\"fscanf:\");\n            break;\n        }\n    }\n\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 878, "user_id": 6911973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-l6J99KFNfBM/AAAAAAAAAAI/AAAAAAAAAWs/QMDeg2Waeoc/photo.jpg?sz=128", "display_name": "Jay Joshi", "link": "https://stackoverflow.com/users/6911973/jay-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 47304781, "answer_count": 2, "score": 2, "last_activity_date": 1510741174, "creation_date": 1510739867, "question_id": 47304287, "link": "https://stackoverflow.com/questions/47304287/read-from-a-formatted-test-file-using-fscanf-in-c", "title": "read from a formatted test file using fscanf() in c", "body": "<p>Here is the text file</p>\n\n<pre><code>Username:user1  Password:pass1\nUsername:user2  Password:pass2\n</code></pre>\n\n<p>I want to read the username and password from the text. the problem is there is not way to change the format of the text. i tried to read but as there is not space between colon(:), it gives whole <code>username:user1</code> as string but i want only user1. i referred to <a href=\"https://stackoverflow.com/questions/26528212/using-fscanf-to-skip-a-string\">this</a> question but it did not help as there is no space between colon.</p>\n\n<p>I tried :</p>\n\n<pre><code> while ((fscanf(fp,\"Username:%s Password:%s\",username,password))!=EOF)\n</code></pre>\n\n<p>but it gives many undefined characters after user1 and loop never ends.</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 3, "creation_date": 1510739829, "post_id": 47304208, "comment_id": 81559124, "body": "could you reformulate, the question is hard to understand; what quind of code would you like to write, and where in this code do you think there is a problem?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1510740301, "post_id": 47304208, "comment_id": 81559438, "body": "Don&#39;t hide pointers by <code>typedef</code>."}, {"owner": {"reputation": 97, "user_id": 5843979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cd6fe784e4a2bc3dcfec5392bc9c70?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Blanco", "link": "https://stackoverflow.com/users/5843979/daniel-blanco"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1510741164, "post_id": 47304208, "comment_id": 81559986, "body": "@OznOg edited with more information"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1510741595, "last_edit_date": 1510741595, "creation_date": 1510739747, "answer_id": 47304250, "question_id": 47304208, "link": "https://stackoverflow.com/questions/47304208/pointer-to-variable-inside-a-struct/47304250#47304250", "title": "Pointer to variable inside a struct", "body": "<p><em>I define a global variable abb,</em></p>\n\n<p>It is not a variable, it is a <code>type</code>. </p>\n\n<hr>\n\n<p>As an answer to the question after the edit:-</p>\n\n<p>Now you can use <code>abb</code>, as a type similar to <code>struct celda*</code>.</p>\n\n<p>After the edit the answer is simply what the problem demands.</p>\n\n<p>For example:</p>\n\n<p>if each instance of the <code>struct celda</code> is needed to contain a block information then it is better to allow a pointer to it inside the <code>structure</code>. That is a better thing in terms of design where closely related data are kept closely.</p>\n\n<p>And another thing is suppose you keep a pointer to <code>tipoelem</code> outside of the structure variable. Then suppose after some time you will need another pointer to <code>tipoelem</code> then these two pointer to <code>tipoelem</code> is different in meaning. That's why it's better to keep in structure. </p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1510740227, "creation_date": 1510740227, "answer_id": 47304411, "question_id": 47304208, "link": "https://stackoverflow.com/questions/47304208/pointer-to-variable-inside-a-struct/47304411#47304411", "title": "Pointer to variable inside a struct", "body": "<p>To access the <em>int</em> inside info with a variable of <em>type abb</em> I would use this main:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main(){\n    abb variable;\n    printf(\"comp_lexico es %d\",variable-&gt;info.comp_lexico);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 5843979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cd6fe784e4a2bc3dcfec5392bc9c70?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Blanco", "link": "https://stackoverflow.com/users/5843979/daniel-blanco"}, "edited": false, "score": 0, "creation_date": 1510740894, "post_id": 47304509, "comment_id": 81559816, "body": "It is a bit different. What I want to do is edit object one having <code>ptOne = &amp;(pTwo-&gt;objectOne)</code> and then <code>ptOne-&gt;c = &#39;H&#39;</code>. I do not know if that is safe."}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510757772, "last_edit_date": 1510757772, "creation_date": 1510740473, "answer_id": 47304509, "question_id": 47304208, "link": "https://stackoverflow.com/questions/47304208/pointer-to-variable-inside-a-struct/47304509#47304509", "title": "Pointer to variable inside a struct", "body": "<p>Yes, it is safe to access like that.\nConsider this example,</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct stOne {\n    int a;\n    int b;\n    char c;\n};\n\nstruct stTwo {\n    struct stOne ObjectOne;\n    struct sttwo *pTwo;\n};\n\nstruct stOne *pOne;\nstruct stTwo *pTwo;\nstruct stTwo ObjectstTwo;\n\nint main() {\n\n    pTwo = &amp;ObjectstTwo;   \n    pTwo-&gt;ObjectOne.c = 'H';\n    printf(\"%c\", ObjectstTwo.ObjectOne.c);\n\n    pOne = &amp;pTwo-&gt;ObjectOne;\n    pOne-&gt;c = 'D';\n    printf(\" %c\", ObjectstTwo.ObjectOne.c);\n}\n</code></pre>\n\n<p>This code prints</p>\n\n<pre><code>H\n</code></pre>\n\n<p>as output.</p>\n\n<p>Similarly you can modify a member of the <code>struct tipoelem</code>, for example <code>comp_lexico</code> which is an <code>int</code>. </p>\n\n<pre><code>struct celda objectCelda;\n\n//Assuming abb is a pointer, Make abb point to an object\nabb = &amp;objectCelda;\n\n//Modify the value of comp_lexico\nabb-&gt;info.comp_lexico = 0xAA;\n</code></pre>\n\n<p>Now changing the code,</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct stOne {\n    int a;\n    int b;\n    char c;\n};\n\nstruct stTwo {\n  struct stOne ObjectOne;\n  struct sttwo *pTwo;\n};\n\nstruct stOne *pOne;\nstruct stTwo *pTwo;\nstruct stTwo ObjectstTwo;\n\nint main() {\n\n    pTwo = &amp;ObjectstTwo;   \n    pTwo-&gt;ObjectOne.c = 'H';\n    printf(\"%c\", ObjectstTwo.ObjectOne.c);\n\n    pOne = &amp;pTwo-&gt;ObjectOne;\n    pOne-&gt;c = 'D';\n    printf(\" %c\", ObjectstTwo.ObjectOne.c);\n}\n</code></pre>\n\n<p>This prints </p>\n\n<pre><code>H D\n</code></pre>\n\n<p>on console as output. So it is perfectly okay to do it either way.</p>\n"}], "owner": {"reputation": 97, "user_id": 5843979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cd6fe784e4a2bc3dcfec5392bc9c70?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Blanco", "link": "https://stackoverflow.com/users/5843979/daniel-blanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2015, "favorite_count": 0, "accepted_answer_id": 47304509, "answer_count": 3, "score": 2, "last_activity_date": 1510757772, "creation_date": 1510739611, "last_edit_date": 1510741120, "question_id": 47304208, "link": "https://stackoverflow.com/questions/47304208/pointer-to-variable-inside-a-struct", "title": "Pointer to variable inside a struct", "body": "<p>I have a struct like this:</p>\n\n<pre><code>typedef struct{\n    char *lexema;\n    int comp_lexico;\n    union{\n        double v;\n        double (*fnctptr)();\n    } valor;\n}tipoelem;\n\nstruct celda {\n    tipoelem info;\n    struct celda *izq, *der;\n};\n\ntypedef struct celda * abb;\n</code></pre>\n\n<p>Then I define a global variable <code>abb</code>, which has a global scope. If I get somehow the memory direction of the field info of <code>celda</code>, would I be able to modify it safely or It is better to define the field as a <code>tipoelem</code> pointer such as <code>(tipoelem *info)</code>?</p>\n\n<p>The thing is, is it safe to edit the <code>tipoelem info</code> field with a <code>tipoelem *pointerToInfo</code> from other part of the prrogram or it is better to declare it as a pointer <code>tipoelem *info</code> in the struct celda?</p>\n\n<p>Edited with more information:\nThe way I want to modify <code>tipoelem info</code> is the next one, and I do not know if it is safe.</p>\n\n<pre><code>abb a;\nint main(){\n    tipoelem *ptr = a-&gt;info;\n    ptr-&gt;comp_lexico = 2;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "msdn", "pci-e", "xeon-phi"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 1, "creation_date": 1510739861, "post_id": 47303689, "comment_id": 81559149, "body": "Use CPUID instruction. With <code>MOV EAX, 00H CPUID</code> instructions sequence for basic info. On return exam EAX, for a <b>Intel&#174; Xeon Phi\u2122 coprocessor</b>, it will contain <b>04H</b> for basic information query and <b>80000008H</b> for extended. Look for <b>CPUID</b> in the doc <a href=\"https://software.intel.com/sites/default/files/forum/278102/327364001en.pdf\" rel=\"nofollow noreferrer\">software.intel.com/sites/default/files/forum/278102/&hellip;</a>."}, {"owner": {"reputation": 51, "user_id": 5570701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jzZFM.jpg?s=128&g=1", "display_name": "nithinj", "link": "https://stackoverflow.com/users/5570701/nithinj"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1511966343, "post_id": 47303689, "comment_id": 82067420, "body": "@Frankie_C, Can it be used to find to find Xeon Phi PCIe chip, or just the standalone CPU?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1512036054, "post_id": 47303689, "comment_id": 82098427, "body": "Did you open the link I provided in my comment? It is the CPU instructions manual for the <b>Xeon Phi coprocessor</b>. The Xeon <b>is</b> an X86 processor multicore, the CPUID instruction give info about the chip where it is executed."}], "owner": {"reputation": 51, "user_id": 5570701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jzZFM.jpg?s=128&g=1", "display_name": "nithinj", "link": "https://stackoverflow.com/users/5570701/nithinj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510738163, "creation_date": 1510738163, "question_id": 47303689, "link": "https://stackoverflow.com/questions/47303689/how-to-detect-intel-xeon-phi-coprocessor-on-windows", "title": "How to detect Intel Xeon Phi coprocessor on Windows?", "body": "<p>Is there any C/C++ API's which I can use to detect whether the system has a xeon phi co-processor in it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "edited": false, "score": 0, "creation_date": 1510736457, "post_id": 47303098, "comment_id": 81557080, "body": "But the highest bit is 0b10000000 not 0b01000000 for 8 bits?"}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 2, "creation_date": 1510736465, "post_id": 47303098, "comment_id": 81557085, "body": "(sizeof(type) * 8) - 1?"}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "reply_to_user": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "edited": false, "score": 0, "creation_date": 1510736485, "post_id": 47303098, "comment_id": 81557102, "body": "@arminb maybe it&#39;s signed."}, {"owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "edited": false, "score": 1, "creation_date": 1510736529, "post_id": 47303098, "comment_id": 81557133, "body": "Though it can be set."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510736545, "post_id": 47303098, "comment_id": 81557141, "body": "you can use a check method whether the variable sign changes."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "reply_to_user": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "edited": false, "score": 1, "creation_date": 1510736573, "post_id": 47303098, "comment_id": 81557163, "body": "@arminb yes you are right. <code>(sizeof(type) * 8) - 1</code> will be sufficient if the sign doesn&#39;t matter then."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1510736631, "post_id": 47303098, "comment_id": 81557203, "body": "Did you test version 1 for signed types?"}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510736647, "post_id": 47303098, "comment_id": 81557211, "body": "I&#39;m using 8 but you might consider it CHAR_BIT :) Since I didn&#39;t use any other before."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "reply_to_user": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510736923, "post_id": 47303098, "comment_id": 81557362, "body": "@TahaPaksu CHAR_BIT is better because the standard does not guarantee that a char is exactly 8 bits large."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1510736966, "post_id": 47303098, "comment_id": 81557382, "body": "@WernerHenze yes thank you."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1510738151, "post_id": 47303098, "comment_id": 81558075, "body": "I suggest you, when you use bit masks and bit operations, to use (or consider) always unsigned variables. :)"}], "answers": [{"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1510737176, "post_id": 47303300, "comment_id": 81557503, "body": "Even with two&#39;s complement the first version will not work for signed types."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 2, "last_activity_date": 1510737364, "last_edit_date": 1510737364, "creation_date": 1510736961, "answer_id": 47303300, "question_id": 47303098, "link": "https://stackoverflow.com/questions/47303098/finding-the-largest-possible-bit-for-a-specific-type/47303300#47303300", "title": "Finding the largest possible bit for a specific type", "body": "<p>Your methods work almost for unsigned types.\nIn the second case, you just forgot to convert the <code>1</code> to the target type before doing the shift.</p>\n\n<pre><code>type value = ((type)1) &lt;&lt; ((sizeof(type) * CHAR_BIT) - 1);\n</code></pre>\n\n<p>For signed types they are not portable:</p>\n\n<ul>\n<li><p>the first because the sign representation might not be two's complement</p></li>\n<li><p>the second because shifting into the sign bit is undefined</p></li>\n</ul>\n\n<p>For a signed type the easiest should be to bit-complement the maximal value, e.g</p>\n\n<pre><code>~INT_MAX\n</code></pre>\n\n<p>\"Usually\" this is the same value as <code>INT_MIN</code> (and similar for other types), but on weird architectures it might be a negative <code>0</code> or even a trap. </p>\n"}], "owner": {"reputation": 363, "user_id": 4914582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d7ee0046625d38a23d7ad4dd5854f21f?s=128&d=identicon&r=PG&f=1", "display_name": "CMPXCHG8B", "link": "https://stackoverflow.com/users/4914582/cmpxchg8b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 47303300, "answer_count": 1, "score": 1, "last_activity_date": 1510741646, "creation_date": 1510736250, "last_edit_date": 1510741646, "question_id": 47303098, "link": "https://stackoverflow.com/questions/47303098/finding-the-largest-possible-bit-for-a-specific-type", "title": "Finding the largest possible bit for a specific type", "body": "<p>What is the cleanest method for finding the largest possible bit of a specific type in C?</p>\n\n<p>I have found two methods that seem to work thus far:</p>\n\n<pre><code>type value = ~(((type) - 1) &gt;&gt; 1);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type value = 1 &lt;&lt; ((sizeof(type) * CHAR_BIT) - 1);\n</code></pre>\n\n<p>What I'm trying to do here is get a value that represents the largest bit that you can set in any type, ie, for char (8 bits), that would be:</p>\n\n<pre><code>10000000b\n</code></pre>\n\n<p>Which is what the above two lines do. Is there any better way of handling this? Are there any obvious downsides to using either of the above lines to calculate this?</p>\n"}, {"tags": ["c", "arrays", "syntax", "malloc"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510736253, "post_id": 47303047, "comment_id": 81556967, "body": "an array of what? char or int?? use <code>int **a = malloc(sizeof(int *)*nbOfStudents);</code> first. You want a bidimensional array."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1510743587, "post_id": 47303047, "comment_id": 81561581, "body": "@Sarah Collins  You are here about three years and till now are you so bad?:)"}], "answers": [{"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1510736224, "creation_date": 1510736224, "answer_id": 47303089, "question_id": 47303047, "link": "https://stackoverflow.com/questions/47303047/how-do-i-create-arrays-within-an-array-in-c-without-a-predefined-size/47303089#47303089", "title": "How do I create arrays within an array in C without a predefined size?", "body": "<p>Use pointer instead of array and allocates the memory of that pointer dynamically using <code>malloc</code> or <code>calloc</code> function.</p>\n\n<p>Like this:</p>\n\n<pre><code>int *a;\n\na = malloc((sizeof(int)*noOfItems);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 4, "creation_date": 1510736572, "post_id": 47303107, "comment_id": 81557162, "body": "Never heard of <code>mallocate</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1510747165, "post_id": 47303107, "comment_id": 81563865, "body": "Either update the answer or remove it, it&#39;s no good to anyone. To best, it is misleading and not helpful."}, {"owner": {"reputation": 158, "user_id": 7129470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9073f6713e2ed92a736a5e025c48ded?s=128&d=identicon&r=PG&f=1", "display_name": "Harvett", "link": "https://stackoverflow.com/users/7129470/harvett"}, "edited": false, "score": 0, "creation_date": 1510900928, "post_id": 47303107, "comment_id": 81641198, "body": "sorry, that&#39;s a typo"}], "tags": [], "owner": {"reputation": 158, "user_id": 7129470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9073f6713e2ed92a736a5e025c48ded?s=128&d=identicon&r=PG&f=1", "display_name": "Harvett", "link": "https://stackoverflow.com/users/7129470/harvett"}, "is_accepted": false, "score": -2, "last_activity_date": 1510824447, "last_edit_date": 1510824447, "creation_date": 1510736281, "answer_id": 47303107, "question_id": 47303047, "link": "https://stackoverflow.com/questions/47303047/how-do-i-create-arrays-within-an-array-in-c-without-a-predefined-size/47303107#47303107", "title": "How do I create arrays within an array in C without a predefined size?", "body": "<p>You may try the function <code>malloc</code>, which dynamically allocates memory and returns a pointer to it. Then you can cast the pointer to a pointer pointing to an array of a certain type.</p>\n"}, {"comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 4, "creation_date": 1510736772, "post_id": 47303140, "comment_id": 81557277, "body": "You can also use <code>int (*a)[noOfStudents] = malloc(sizeof *a * noOfItems);</code> instead of a VLA of pointers."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1510737503, "post_id": 47303140, "comment_id": 81557695, "body": "@mch no doubt, just another approach."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1510736417, "creation_date": 1510736417, "answer_id": 47303140, "question_id": 47303047, "link": "https://stackoverflow.com/questions/47303047/how-do-i-create-arrays-within-an-array-in-c-without-a-predefined-size/47303140#47303140", "title": "How do I create arrays within an array in C without a predefined size?", "body": "<p>You can make use of a <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">VLA (Variable length array)</a>.</p>\n\n<p>You need to rearrange your code like</p>\n\n<pre><code>int noOfStudents = -1, noOfItems = -1;\nint *grades;                                //is it used?\nint i;\n\nprintf(\"Please enter number of students\\n\");\nscanf(\"%d\", &amp;noOfStudents);\n\n//fail check\n\nint *a[noOfStudents];             // this needs to be proper.\n\n//VLA\n\nprintf(\"Please enter number of items\\n\");\nscanf(\"%d\", &amp;noOfItems);\n\n//fail check\n\nfor (i = 0; i &lt; noOfStudents; i++)\n{\n    a[i] = malloc(noOfItems * sizeof(a[i]));   //do not cast\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 2, "last_activity_date": 1510736862, "last_edit_date": 1510736862, "creation_date": 1510736449, "answer_id": 47303153, "question_id": 47303047, "link": "https://stackoverflow.com/questions/47303047/how-do-i-create-arrays-within-an-array-in-c-without-a-predefined-size/47303153#47303153", "title": "How do I create arrays within an array in C without a predefined size?", "body": "<p>You want a bi-dimensional array, to hold the list of lists of integer items. You can do that by declaring a pointer on integer pointers.</p>\n\n<p>So you want to declare</p>\n\n<pre><code>int **a;\n</code></pre>\n\n<p>then</p>\n\n<pre><code>printf(\"Please enter number of students\\n\");\nif (scanf(\"%d\", &amp;noOfStudents)==0 &amp;&amp; noOfStudents&lt;=0)  // bonus: small safety\n{\n    printf(\"input error\\n\");\n    exit(1);\n}\n// now we are sure that noOfStudents is strictly positive &amp; properly entered\na = malloc(sizeof(int*)*noOfStudents);\n</code></pre>\n\n<p>Then you have your array of pointers allocated, and the rest of your code is OK (don't cast the return value of <code>malloc</code> BTW)</p>\n\n<p>A variant is:</p>\n\n<pre><code>a = malloc(sizeof(*a)*noOfStudents);\n</code></pre>\n\n<p>(so if type of <code>a</code> changes, the size follows, not that it matters here since they're all pointers)</p>\n"}], "owner": {"reputation": 205, "user_id": 4298924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/zpZKC.jpg?s=128&g=1", "display_name": "Sarah Collins", "link": "https://stackoverflow.com/users/4298924/sarah-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1510824447, "creation_date": 1510736065, "last_edit_date": 1510747101, "question_id": 47303047, "link": "https://stackoverflow.com/questions/47303047/how-do-i-create-arrays-within-an-array-in-c-without-a-predefined-size", "title": "How do I create arrays within an array in C without a predefined size?", "body": "<p>I would like to create arrays within an array in C without a pre-defined number of characters or input in the array.\nThe following is my code:</p>\n\n<pre><code>{\n    int noOfStudents,noOfItems;\n    int *grades;\n    int i;\n    char a[];\n    printf(\"Please enter number of students\\n\");\n    scanf(\"%d\", &amp;noOfStudents);\n    printf(\"Please enter number of items\\n\");\n    scanf(\"%d\", &amp;noOfItems);\n\n    for (i = 0; i &lt; noOfStudents; i++)\n    {\n        a[i] = (int *)malloc((sizeof(int))*noOfItems);\n    }\n</code></pre>\n\n<p>I've been thrown an error </p>\n\n<blockquote>\n  <p>c(2133): 'a': unknown size</p>\n</blockquote>\n\n<p>How do I successfully create arrays within an array by means of malloc?</p>\n"}, {"tags": ["c", "arrays", "algorithm", "multidimensional-array"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 7129470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9073f6713e2ed92a736a5e025c48ded?s=128&d=identicon&r=PG&f=1", "display_name": "Harvett", "link": "https://stackoverflow.com/users/7129470/harvett"}, "is_accepted": false, "score": 0, "last_activity_date": 1510736100, "creation_date": 1510736100, "answer_id": 47303056, "question_id": 47302781, "link": "https://stackoverflow.com/questions/47302781/shrink-the-size-of-2d-array-by-removing-specific-rows-and-columns-from-it/47303056#47303056", "title": "Shrink the size of 2D array by removing specific rows and columns from it", "body": "<p>I think it's quite simple.</p>\n\n<p>One of brutal methods is 1) scan the whole input matrix and find the numbers of rows and columns that should be removed according to those '-', '|', '+' found in the input matrix, say they are r, c, 2) the numbers of rows and columns in the output matrix can be inferred, which are x - r, y - c, assuming x, y are the numbers of rows and columns in the input matrix.</p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 0, "last_activity_date": 1510736365, "creation_date": 1510736365, "answer_id": 47303130, "question_id": 47302781, "link": "https://stackoverflow.com/questions/47302781/shrink-the-size-of-2d-array-by-removing-specific-rows-and-columns-from-it/47303130#47303130", "title": "Shrink the size of 2D array by removing specific rows and columns from it", "body": "<p>You cannot shrink a statically defined array as the one in your example. You can mark a column or a row though, so that when the printing phase comes around, you simply skip the invalidated column(s) and row(s).</p>\n\n<p>Example for the <code>'|'</code> case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N 3\n#define M 3\n\nvoid invalidate_col(char mat[N][M], const int col)\n{\n    for(int i = 0; i &lt; N; ++i)\n    {\n        mat[i][col] = 'n';\n    }\n}\n\nvoid print(char mat[N][M])\n{\n    for(int i = 0; i &lt; N; ++i)\n    {\n        for(int j = 0; j &lt; M; ++j)\n        {\n            if(mat[i][j] != 'n')\n                printf(\"%c \", mat[i][j]);        \n        }\n        printf(\"\\n\");\n    } \n}\n\nint main(void) {\n    char mat[N][M] = {{'|', '*', '*'},\n                  {'*', '*', '*'},\n                  {'*', '*', '*'}};\n    for(int i = 0; i &lt; N; ++i)\n    {\n        for(int j = 0; j &lt; M; ++j)\n        {\n            if(mat[i][j] == '|')\n            {\n                invalidate_col(mat, j);\n            }\n        }\n    }\n    print(mat);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>* * \n* * \n* * \n</code></pre>\n\n<hr>\n\n<p>If you really need to delete these column(s) and row(s), then you need to dynamically allocate the matrix (check <a href=\"https://gsamaras.wordpress.com/code/2d-dynamic-array-c/\" rel=\"nofollow noreferrer\">my example</a>), use <code>realloc()</code> to shrink it accordingly, and at the end <code>free()</code> to dellocate that memory.</p>\n"}], "owner": {"reputation": 23, "user_id": 8943531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0402b2cc5a3875ce57df225618f890db?s=128&d=identicon&r=PG", "display_name": "user8943531", "link": "https://stackoverflow.com/users/8943531/user8943531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 47303130, "answer_count": 2, "score": 2, "last_activity_date": 1510736393, "creation_date": 1510735130, "last_edit_date": 1510736393, "question_id": 47302781, "link": "https://stackoverflow.com/questions/47302781/shrink-the-size-of-2d-array-by-removing-specific-rows-and-columns-from-it", "title": "Shrink the size of 2D array by removing specific rows and columns from it", "body": "<p>I'm learning C, and I can't find a solution to this problem.</p>\n\n<p>If I have a matrix of random size filled with '*'(star), '-'(horizontal bar), '|'(vertical bar),'+'(plus sign) and I want to remove every row that has a '-', every column that has a '|', every row and column in which there is a '+'. </p>\n\n<p>How would i reduce the size of the matrix so that when i print the remaining '*'(star) there are no rows and columns between them that were removed?</p>\n\n<p>For example:</p>\n\n<pre><code>char mat[3][3] = {{'|', '*', '*'},\n                  {'*', '*', '*'},\n                  {'*', '*', '*'}};\n</code></pre>\n\n<p>The output would be: </p>\n\n<pre><code>**\n**\n**\n</code></pre>\n\n<p>Another example:</p>\n\n<pre><code>char mat[3][3] = {{'*', '*', '*'},\n                  {'*', '+', '*'},\n                  {'*', '*', '*'}};\n</code></pre>\n\n<p>The output would be: </p>\n\n<pre><code>**\n**\n</code></pre>\n\n<p>Larger matrix:</p>\n\n<pre><code>char mat[4][5] = {{'*', '|', '*', '|', '*'},\n                  {'*', '*', '*', '*', '*'},\n                  {'*', '+', '*', '-', '*'}\n                  {'*', '*', '*', '*', '-'}};\n</code></pre>\n\n<p>The output would be: </p>\n\n<pre><code>***\n***\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1510735046, "post_id": 47302713, "comment_id": 81556269, "body": "Can you please elaborate on the &quot;doesn&#39;t work&quot; part? <b><i>How</i></b> doesn&#39;t it work? What is your input? What is your expected output? What is the actual output? Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. And also please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1510735206, "post_id": 47302713, "comment_id": 81556367, "body": "What do you input, what do you get, how does this differ from what you expected?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1510735379, "post_id": 47302713, "comment_id": 81556446, "body": "You probably want <code>scanf(&quot;%c\\n&quot;,&amp;a[i][j])</code> (extra <code>&#39;\\n&#39;</code> at the end)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 2, "creation_date": 1510735809, "post_id": 47302713, "comment_id": 81556712, "body": "@BarmakShemirani Better to add a space <i>before</i> the format. Otherwise the last <code>scanf</code> call will block until a non-space character is entered."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510737119, "post_id": 47302713, "comment_id": 81557472, "body": "@Some programmer dude, right. I think it wouldn&#39;t need <code>\\n</code> at all, just <code>&quot; %c&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8810007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40a26eed15a57514aa7d01bd2859ab1f?s=128&d=identicon&r=PG&f=1", "display_name": "mr_mohapatra", "link": "https://stackoverflow.com/users/8810007/mr-mohapatra"}, "edited": false, "score": 0, "creation_date": 1510738663, "post_id": 47303193, "comment_id": 81558402, "body": "Works like a charm! Thank you so much :)"}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": true, "score": 1, "last_activity_date": 1510737269, "last_edit_date": 1510737269, "creation_date": 1510736584, "answer_id": 47303193, "question_id": 47302713, "link": "https://stackoverflow.com/questions/47302713/how-to-take-input-in-a-2d-char-array-using-c/47303193#47303193", "title": "how to take input in a 2D char array using C?", "body": "<p>Assuming you insert the input like this:</p>\n\n<ol>\n<li>a</li>\n<li>whitespace</li>\n<li>b</li>\n<li>whitespace</li>\n<li>c</li>\n<li>enter...</li>\n</ol>\n\n<p>then your program has too many <code>char</code>s in the input buffer. You want to read 9 <code>char</code> with <code>scanf(\"%c\")</code> and indeed 9 <code>char</code>s enter the buffer, but they include things you don't want (whitespaces and newlines).</p>\n\n<p>Fix: add whitespace before %c like this - <code>scanf(\" %c\",&amp;a[i][j]);</code>. This would ignore any sort of whitespace between <code>char</code>s read (<code>'\\n' '\\t'\" ' '</code>).</p>\n"}], "owner": {"reputation": 17, "user_id": 8810007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40a26eed15a57514aa7d01bd2859ab1f?s=128&d=identicon&r=PG&f=1", "display_name": "mr_mohapatra", "link": "https://stackoverflow.com/users/8810007/mr-mohapatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4137, "favorite_count": 0, "closed_date": 1510747584, "accepted_answer_id": 47303193, "answer_count": 1, "score": -1, "last_activity_date": 1510737269, "creation_date": 1510734873, "last_edit_date": 1510736620, "question_id": 47302713, "link": "https://stackoverflow.com/questions/47302713/how-to-take-input-in-a-2d-char-array-using-c", "closed_reason": "Duplicate", "title": "how to take input in a 2D char array using C?", "body": "<p>I am getting weird results when I try to take input of a 2D <strong>char</strong> array for some reason. I have always taken integer 2D arrays in the past this way but somehow this method doesn't work for char arrays.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i,j,n;\n    scanf(\"%d\",&amp;n);\n    char a[n][n];\n    for(i=0;i&lt;n;i++)\n    {\n        for(j=0;j&lt;n;j++)\n            scanf(\"%c\",&amp;a[i][j]);\n    }\n\n    for(i=0;i&lt;n;i++)\n    {\n        for(j=0;j&lt;n;j++)\n            printf(\"%c\",a[i][j]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Excepted Input</strong>:</p>\n\n<p>3</p>\n\n<p>a b c</p>\n\n<p>d e f</p>\n\n<p>g h i</p>\n\n<p><strong>Expected Output</strong>:</p>\n\n<p>a b c</p>\n\n<p>d e f</p>\n\n<p>g h i</p>\n\n<p>What happens:</p>\n\n<p>3</p>\n\n<p>a b c</p>\n\n<p>d e f</p>\n\n<p>(Input abruptly stops)</p>\n\n<p>Output:</p>\n\n<p>a b c</p>\n\n<p>d</p>\n"}, {"tags": ["c", "matrix", "openmp"], "answers": [{"comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1510895688, "post_id": 47326413, "comment_id": 81639360, "body": "If this is a pedagogic exercise (i.e. learning how to use OpenMP), fine. If you want a high performance matrix multiply, stop now. Instead go and find libraries such as Intel MKL which have many more optimizations (such as cache-blocking). Indeed, It may be interesting for you to compare the performance of your naive parallelization with that of MKL..."}], "tags": [], "owner": {"reputation": 301, "user_id": 4180354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A8DHr.jpg?s=128&g=1", "display_name": "Mattenii", "link": "https://stackoverflow.com/users/4180354/mattenii"}, "is_accepted": false, "score": 2, "last_activity_date": 1510825829, "creation_date": 1510825829, "answer_id": 47326413, "question_id": 47302694, "link": "https://stackoverflow.com/questions/47302694/optimization-for-matrix-multiply-openmp-c/47326413#47326413", "title": "Optimization for Matrix Multiply (OpenMP) - C", "body": "<p>Your current implementation can probably not be improved a lot. At this point it comes down to the compiler and cache usage. An interesting point is made <a href=\"https://software.intel.com/en-us/articles/matrix-multiplication-performance-and-scalability-in-openmp-student-challenge/\" rel=\"nofollow noreferrer\">here by Intel</a> that GCC requires two loops to be swapped in order to vectorize the multiplications (i.e. use SIMD). For very large matrices, you might consider dividing the matrices not in stripes but in blocks. This introduces complexity and overhead, but can improve cache usage.</p>\n\n<p>The reduction clause is only needed if you are summing a single variable with multiple threads, which is not the case here since you only sum over <code>k</code>.</p>\n\n<p>Finally (but this is completely personal) note that you can replace the two directives by a single one</p>\n\n<pre><code>#pragma omp parallel for\n</code></pre>\n\n<p>which in my opinion looks somewhat cleaner.</p>\n"}], "owner": {"reputation": 103, "user_id": 8586428, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6c4d4d0a5c15989d018097e024f1e931?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/8586428/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510825829, "creation_date": 1510734822, "question_id": 47302694, "link": "https://stackoverflow.com/questions/47302694/optimization-for-matrix-multiply-openmp-c", "title": "Optimization for Matrix Multiply (OpenMP) - C", "body": "<p>I am learning a little bit about openMP and trying to use it here to multiply two matrices together.</p>\n\n<pre><code>void matrix_multiply(matrix *A, matrix *B, matrix *C) {\n\n    #pragma omp parallel\n    {\n        #pragma omp for \n        for(int i = 0; i &lt; A-&gt;dim.rows; i++) {\n            for(int j = 0; j &lt; B-&gt;dim.cols; j++) {\n                C-&gt;data[i][j] = 0;\n                for (int k = 0; k &lt; A-&gt;dim.cols; k++) {\n                C-&gt;data[i][j] += A-&gt;data[i][k] * B-&gt;data[k][j];\n               }\n           }\n       }\n   }\n}\n\ntypedef struct shape {\n    int rows;\n    int cols;\n} shape;\n\ntypedef struct matrix {\n    shape dim;\n    float** data;\n} matrix;\n</code></pre>\n\n<p>Still a little new to this, so are there any simple changes to improve performance or have I already done that? Also am I running into any data races by not using reduction? </p>\n"}, {"tags": ["c", "arrays", "struct", "c99"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1510733831, "post_id": 47302374, "comment_id": 81555576, "body": "You are probably allocating too little memory, just so you know. Unless your example is poorly written pseudo code."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1510733904, "post_id": 47302374, "comment_id": 81555611, "body": "Think about what you&#39;re doing.  If there are n keys, then you&#39;re allocating n bytes.  You need to allocate n <code>struct bucket</code>.  Hint:  You need to use <code>sizeof</code> to calculate the number of bytes."}, {"owner": {"reputation": 132, "user_id": 8939032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce63c1c3754a5f470b9559b864b338f7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/8939032/sean"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1510733914, "post_id": 47302374, "comment_id": 81555618, "body": "@StoryTeller sorry forgot to include the 2nd malloc for arrayOfArrays"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1510733977, "post_id": 47302374, "comment_id": 81555653, "body": "No, I&#39;m talking about the first malloc, actually"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510733993, "post_id": 47302374, "comment_id": 81555664, "body": "That is absolutely not the error you&#39;re getting. Do not invent error messages. Copy-paste them verbatim."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1510734033, "post_id": 47302374, "comment_id": 81555687, "body": "The error message talks about <code>id</code>. There is nothing called <code>id</code> in the code you show."}, {"owner": {"reputation": 13757, "user_id": 1270003, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5ed9123b92a6e4dffa75f9f6dd9e382?s=128&d=identicon&r=PG&f=1", "display_name": "texasbruce", "link": "https://stackoverflow.com/users/1270003/texasbruce"}, "edited": false, "score": 0, "creation_date": 1510734644, "post_id": 47302374, "comment_id": 81556035, "body": "btw this is not hash map should be implemented"}, {"owner": {"reputation": 132, "user_id": 8939032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce63c1c3754a5f470b9559b864b338f7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/8939032/sean"}, "reply_to_user": {"reputation": 13757, "user_id": 1270003, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5ed9123b92a6e4dffa75f9f6dd9e382?s=128&d=identicon&r=PG&f=1", "display_name": "texasbruce", "link": "https://stackoverflow.com/users/1270003/texasbruce"}, "edited": false, "score": 0, "creation_date": 1510735183, "post_id": 47302374, "comment_id": 81556351, "body": "@texasbruce so how would you suggest implementing it?"}, {"owner": {"reputation": 132, "user_id": 8939032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce63c1c3754a5f470b9559b864b338f7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/8939032/sean"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510737090, "post_id": 47302374, "comment_id": 81557449, "body": "@AnttiHaapala not inventing errors just did not see the higher error in the console have updated it to the one that was above it now"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510743932, "post_id": 47302374, "comment_id": 81561823, "body": "@Sean it is not true. The error message in the original edit <i>was not</i> a verbatim copy of the actual error that you received."}], "answers": [{"tags": [], "owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "is_accepted": true, "score": 0, "last_activity_date": 1510734483, "last_edit_date": 1510734483, "creation_date": 1510733807, "answer_id": 47302408, "question_id": 47302374, "link": "https://stackoverflow.com/questions/47302374/array-of-array-of-structs-in-c99/47302408#47302408", "title": "Array of Array of structs in c99", "body": "<pre><code>struct bucket * arrayOfArrays;\narrayOfArrays[0] = buckets;\n</code></pre>\n\n<p>Change this to</p>\n\n<pre><code>struct bucket ** arrayOfArrays;\narrayOfArrays = malloc(sizeof(struct bucket *) * numberOfArrays);\narrayOfArrays[0] = buckets;\n</code></pre>\n\n<p>And it should work for you.</p>\n\n<p>You also need to change the first allocation to get enough bytes:</p>\n\n<pre><code>struct bucket * buckets;\nbuckets = malloc(sizeof(struct bucket) * numberOfBuckets);\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 8939032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce63c1c3754a5f470b9559b864b338f7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/8939032/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47302408, "answer_count": 1, "score": -2, "last_activity_date": 1510736996, "creation_date": 1510733678, "last_edit_date": 1510736996, "question_id": 47302374, "link": "https://stackoverflow.com/questions/47302374/array-of-array-of-structs-in-c99", "title": "Array of Array of structs in c99", "body": "<p>I am trying to implement hash maps in c. I am trying to go about this by creating a struct to hold the hash and key like this.</p>\n\n<pre><code>struct bucket{\nchar * key;\nchar * value;\n};\n</code></pre>\n\n<p>Then i am create an array of these structs to hold all the hashs that are the same but with different keys. like so:</p>\n\n<pre><code>struct bucket * buckets;\nbuckets = malloc(numberOfBuckets);\n</code></pre>\n\n<p>Then where i am getting stuck is making an array to store these arrays in. I thought it was done like this:</p>\n\n<pre><code>struct bucket * arrayOfArrays;\narrayOfArrays = malloc(++numberOfKeys);\narrayOfArrays[0] = buckets;\n</code></pre>\n\n<p>which is giving me the error:</p>\n\n<pre><code>incompatible types when assigning to type 'struct bucket' from type 'struct bucket *'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1427, "user_id": 5624602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca1e4cf5aa20f7f5b921f3d2eb95220b?s=128&d=identicon&r=PG&f=1", "display_name": "STF", "link": "https://stackoverflow.com/users/5624602/stf"}, "edited": false, "score": 0, "creation_date": 1510733654, "post_id": 47302339, "comment_id": 81555471, "body": "Can you show the file?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 2, "creation_date": 1510734180, "post_id": 47302339, "comment_id": 81555751, "body": "fwite(data,size of one, count, file). You hahe two times sizeof"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 3, "creation_date": 1510734201, "post_id": 47302339, "comment_id": 81555761, "body": "All other things aside, you forgot to check return values of <code>fopen</code> and <code>fwrite</code>, and you didn&#39;t <code>fclose</code> the file."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7964981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS7HR.png?s=128&g=1", "display_name": "Rismosch", "link": "https://stackoverflow.com/users/7964981/rismosch"}, "edited": false, "score": 0, "creation_date": 1510734519, "post_id": 47302375, "comment_id": 81555953, "body": "I think I understand my mistake. But how do I fix it? Do I need to convert it into a string or something like that?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 57, "user_id": 7964981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS7HR.png?s=128&g=1", "display_name": "Rismosch", "link": "https://stackoverflow.com/users/7964981/rismosch"}, "edited": false, "score": 0, "creation_date": 1510737712, "post_id": 47302375, "comment_id": 81557813, "body": "@Rismosch You need to serialize it somehow. A file is a stream of bytes, so if you want to write something sensible to a file, you have to assemble a sensible chunk of bytes and write them to the file. Strings would be one way."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1510734041, "last_edit_date": 1510734041, "creation_date": 1510733687, "answer_id": 47302375, "question_id": 47302339, "link": "https://stackoverflow.com/questions/47302339/c-fwrite-creates-gibberish/47302375#47302375", "title": "C - fwrite creates gibberish", "body": "<p>You are failing to distinguish between <em>values</em> and <em>representations</em>. Understanding this difference is a vital skill every programmer needs, it's as important as understanding the distinction between things and stuff.</p>\n\n<p>If you want to write the values of the array to a file, you'll have to convert them into a sensible representation to write to the file. Your code never does that.</p>\n\n<p>Suppose I want to tell you how many cars I own. And it's two cars. I have to convert the number two into some form that I can communicate to you. Since we both speak English, I can say the word \"two\". But if I just tried to present to you the internal way my brain encodes the number of cars I have, you wouldn't be able to make any sense out of it. That encoding will only make sense to my brain.</p>\n\n<p>Your code tries to write the internal encoding of the array to the file directly. But who knows how to make sense of that internal encoding? It will look like gibberish.</p>\n\n<p>It's like trying to actually write the number three on a piece of paper. You can write a representation of it, like \"three\" or \"3\" or \"III\". But you can't just take the number itself and somehow write it on the paper. That's a category error.</p>\n\n<p>Similarly, if you are happy and want to tell people that you are happy, you have to pick a language and a way to encode that language (spoken or written) and represent the idea that you are happy in that chosen language and form. You can't just output that fact that you happy without first choosing an appropriate representation and encoding the idea appropriately for transport to others. Again, that's a category error.</p>\n\n<p>Punch \"serialization\" -- the process of converting internal encodings into sensible streams of bytes with a well-defined format -- into your favorite search engine.</p>\n"}], "owner": {"reputation": 57, "user_id": 7964981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS7HR.png?s=128&g=1", "display_name": "Rismosch", "link": "https://stackoverflow.com/users/7964981/rismosch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "closed_date": 1510734088, "answer_count": 1, "score": 0, "last_activity_date": 1608893734, "creation_date": 1510733547, "last_edit_date": 1608893734, "question_id": 47302339, "link": "https://stackoverflow.com/questions/47302339/c-fwrite-creates-gibberish", "closed_reason": "Duplicate", "title": "C - fwrite creates gibberish", "body": "<p>I want to write the content of an array into a file. The code below is a simplified program of mine. It does create the file \"test.txt\", but it only writes a bunch of 0 and \\ into the file. What am I doing wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\n    int a[10],i;\n    for(i=0;i&lt;10;i++) a[i]=i;\n\n    FILE* f = NULL;\n    f = fopen(\"test.txt\",\"ab+\");\n    fwrite(&amp;a,sizeof(int),sizeof(a),f);\n\n    return 0;\n}\n</code></pre>\n\n<p>These are the contents of the file:</p>\n\n<p>\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\u200c\u200b\\00\\00\\00\\00\\00\\00\\0\u200c\u200b0\\00 \\00\\00\\00\\90@\\0\u200c\u200b0\\00\\00\\00\\00P8\\00\\0\u200c\u200b0\\00\\00\\00\\00\\00\\00 \\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\00\\B9\\C5?\\00\\00\\00\\00\\00\\00 \\00\\00\\008%j\\FC\\00\\00\\00\\00\\00\\00\\00\\00\\00\\80@\\00\\00\\00\\00\\0\u200c\u200b0\\00\\00\\00\\00\\00\\00\\\u200c\u200b00\\00\\AD\\E6\\FE\\8A\\F6\u200c\u200bT\\90@\\00\\00\\00\\00\\00\u200c\u200b0%j\\FC\\00\\00\\00\\00\\0\u200c\u200b0\\00\\00\\00\\00\\00\\00\\\u200c\u200b00\\00\\00\\00\\00\\00\\00</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 65734, "user_id": 37020, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c52ad00ba2f2602661c49f896733229?s=128&d=identicon&r=PG", "display_name": "orip", "link": "https://stackoverflow.com/users/37020/orip"}, "edited": false, "score": 0, "creation_date": 1510733740, "post_id": 47302319, "comment_id": 81555517, "body": "What would you like to happen when you get to a float? Do you want to keep a rounded or <code>floor</code>d int value of the float? Do you want to keep the ints as floats? Do you want to have an array for ints and an array for floats?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510733774, "post_id": 47302319, "comment_id": 81555533, "body": "The simple answer is: &quot;you can&#39;t use <code>fscanf</code> for this&quot;. Read the line as a string and parse using other means. Use <code>strtol</code> and <code>strtod</code> with error detection."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510733805, "post_id": 47302319, "comment_id": 81555557, "body": "Rethink how you view the problem. You don&#39;t have ints or floats in the file. You have strings that are separated by newlines. Read one line at a time and decide what you want to do with it based on its content."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1510733873, "post_id": 47302319, "comment_id": 81555601, "body": "Or, <code>42</code> can still be parsed using <code>%lf</code> into a double."}, {"owner": {"reputation": 411, "user_id": 7185787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oxHzU.jpg?s=128&g=1", "display_name": "Jonath P", "link": "https://stackoverflow.com/users/7185787/jonath-p"}, "edited": false, "score": 0, "creation_date": 1510734307, "post_id": 47302319, "comment_id": 81555828, "body": "Thanks for your comments. I&#39;ve edited my op to point out that I would later expect to read the table and print its content."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1510734697, "post_id": 47302319, "comment_id": 81556068, "body": "Don&#39;t read using fscanf() . Use fgets(). Now check whether string returned by fgets() contain any floating point no or not.. Implement your own atoi and atof to convert string into int and float"}, {"owner": {"reputation": 411, "user_id": 7185787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oxHzU.jpg?s=128&g=1", "display_name": "Jonath P", "link": "https://stackoverflow.com/users/7185787/jonath-p"}, "edited": false, "score": 0, "creation_date": 1510735224, "post_id": 47302319, "comment_id": 81556379, "body": "Thanks all for your replies and comments. It helped me understand what I was trying to achieve and gave me good leads to keep going."}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 4887888, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnInc.jpg?s=128&g=1", "display_name": "Ruocco", "link": "https://stackoverflow.com/users/4887888/ruocco"}, "is_accepted": true, "score": 1, "last_activity_date": 1510733951, "creation_date": 1510733951, "answer_id": 47302453, "question_id": 47302319, "link": "https://stackoverflow.com/questions/47302319/read-int-or-float-from-file-in-c/47302453#47302453", "title": "Read int OR float from file in C", "body": "<p>Do you only need integers? If so you can read float and convert them into integers before putting them in the array:</p>\n\n<pre><code>float tmp;\nwhile ((lu = fscanf(flux, \"%f\", &amp;tmp)) !=EOF &amp;&amp; i&lt;10){\n    array[i] = (int)tmp; //you could use some rounding here\n    printf(\"lu %i\\n\", lu );\n    printf(\"array[%i] %i\\n\", i, array[i] );\n    printf(\"\\n\");\n    i++;\n}\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 7185787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oxHzU.jpg?s=128&g=1", "display_name": "Jonath P", "link": "https://stackoverflow.com/users/7185787/jonath-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 47302453, "answer_count": 1, "score": 0, "last_activity_date": 1510734224, "creation_date": 1510733446, "last_edit_date": 1510734224, "question_id": 47302319, "link": "https://stackoverflow.com/questions/47302319/read-int-or-float-from-file-in-c", "title": "Read int OR float from file in C", "body": "<p>Let's consider a file of less than 10 numbers which can either int or float. I want to read them and add them to an array.</p>\n\n<p>The issue I'm facing is that I can do that well if I have only ints for example,  but it messes things up whenever it reaches a float</p>\n\n<p>in file.data</p>\n\n<pre><code>11\n22\n33.3\n44\n55\n</code></pre>\n\n<p>my code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid usage(char * message) ;\n\n\nint main(int argc, char * argv[]){\n\n    //opening the file\n    FILE * flux = fopen(\"file.data\", \"r\");\n    if (!flux) usage(\"error opening the file\");\n\n    int array[10]; //array to host the data\n    int i=0;\n    int lu;\n\n    while ((lu = fscanf(flux, \"%i\", &amp;array[i])) !=EOF &amp;&amp; i&lt;10){\n        printf(\"lu %i\\n\", lu );\n        printf(\"array[%i] %i\\n\", i, array[i] );\n        printf(\"\\n\");\n        i++;\n    }\n\n    return 0 ; }\n\nvoid usage(char * message) { fprintf(stderr, \"%s\\n\", message) ; exit(1) ;}\n</code></pre>\n\n<p>output :</p>\n\n<pre><code>lu 1\narray[0] 11\n\nlu 1\narray[1] 22\n\nlu 1\narray[2] 33\n\nlu 0\narray[3] 0\n\nlu 0\narray[4] 4196464\n\nlu 0\narray[5] 0\n\nlu 0\narray[6] 4195936\n\nlu 0\narray[7] 0\n\nlu 0\narray[8] 904651696\n\nlu 0\narray[9] 32766\n</code></pre>\n\n<p>How can I use fscanf so that it doesn't get bogged down when it reaches a float?</p>\n\n<p>(I can tell that it doesn't seem right to declare an array of int and to try to input some float... any way around that?)</p>\n\n<p><strong>edit:</strong> \nmy goal is to be able to read my array and print its content with their index, for example with my data :</p>\n\n<pre><code>0. 11\n1. 22\n2. 33.3\n3. 44\n4. 55\n</code></pre>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1510731710, "post_id": 47301796, "comment_id": 81554440, "body": "Is the typedef what is confusing here? Are you intending the line <code>typedef struct driver_t USB_driver;</code> to declare a USB_driver variable?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1510732161, "post_id": 47301796, "comment_id": 81554665, "body": "<code>init = &amp;USB_init;</code> No, this doesn&#39;t work in standard C. You can&#39;t run code at file scope, you can only declare variables there."}, {"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510747538, "post_id": 47301796, "comment_id": 81564103, "body": "Joe, you are completely right, as alseether! typedef struct driver_t USB_driver; defines USB_driver as type, NOT variable. I predefined it, in correct way, so All Good! Did not do embedded C for 7 years, as we speak, but I am returning quickly to my senses. Now, everything is working! :-)"}, {"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510747612, "post_id": 47301796, "comment_id": 81564151, "body": "Lundin, this idiotic mistake I did since I tried something else (to predefine structure as .init etc), but situation suddenly went out of my control, and I got lost. :-(("}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510732411, "post_id": 47301846, "comment_id": 81554777, "body": "Nope, This does not work. I did what you have suggested. I put the definition inside the main, ONLY USB_driver.init =  &amp;USB_init;, and got the same error!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510732471, "post_id": 47301846, "comment_id": 81554813, "body": "@nobody that is previous to my edit or after that?"}, {"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510732588, "post_id": 47301846, "comment_id": 81554879, "body": "Sourav, I added to the comment. You can copy and paste in you Linux and try it yourself, to see the same I am seeing. Thank you."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510732652, "post_id": 47301846, "comment_id": 81554911, "body": "@nobody please see &quot;You need to have a variable of this type&quot;...part."}, {"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510737079, "post_id": 47301846, "comment_id": 81557439, "body": "Sourav, you are correct. I made very stupid overlook, since I tried to experiment out of exe code, rather with structures, and somehow I switched in desperation to exe code outside of the scope! But I needed also to predefine as definition USB_driver variable! Thank you!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1510732504, "last_edit_date": 1510732504, "creation_date": 1510731598, "answer_id": 47301846, "question_id": 47301796, "link": "https://stackoverflow.com/questions/47301796/array-of-function-pointers-as-a-member-of-a-c-struct/47301846#47301846", "title": "Array of function pointers as a member of a C struct", "body": "<p>First of all, <code>USB_driver</code> is a <em>type</em>, not a variable. You need to have a variable of this type first to access the members (for example, initialize the values of the members).</p>\n\n<p>That said, at a first look, it seems</p>\n\n<pre><code>    USB_driver.init = &amp;USB_init;\n    USB_driver.open = &amp;USB_open;\n    USB_driver.read  = &amp;USB_read;\n    USB_driver.write = &amp;USB_write;\n    USB_driver.close = &amp;USB_close;\n    USB_driver.exit  = &amp;USB_exit;\n</code></pre>\n\n<p>these statements, the assignment statements, resides in file scope. That is not allowed. Assignment operation (different than initialization) is allowed only in block scope.</p>\n\n<p>You need them to have them in block scope, inside some function, <code>main()</code>, probably.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510732763, "post_id": 47301850, "comment_id": 81554970, "body": "This will not work. It is obvious. USB_driver is already defined as: typedef struct driver_t USB_driver; and if I replace mine with your definition. there is nowhere USB_init etc. set of function pointers involved."}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "reply_to_user": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510733961, "post_id": 47301850, "comment_id": 81555646, "body": "Not so obvious, i think. <code>typedef struct driver_t USB_driver</code> defines <code>USB_driver</code> <b>as a type</b>, not a variable. When you try to call <code>USB_driver.init()</code> that&#39;s a <i>static like</i> call (if this was OOP), but is C and that kind of function call is not supported"}, {"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 1, "creation_date": 1510737268, "post_id": 47301850, "comment_id": 81557567, "body": "I fixed the problem. I finally defined out of exe scope USB_driver variable as variable! Now everuthing does work. :-)"}], "tags": [], "owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "is_accepted": false, "score": -1, "last_activity_date": 1510731608, "creation_date": 1510731608, "answer_id": 47301850, "question_id": 47301796, "link": "https://stackoverflow.com/questions/47301796/array-of-function-pointers-as-a-member-of-a-c-struct/47301850#47301850", "title": "Array of function pointers as a member of a C struct", "body": "<p>You must declare a <strong>variable</strong> of type <code>USB_driver</code> like</p>\n\n<pre><code>void main(void) {\n    USB_driver dr\n    dr.init(0x01);\n    dr.open(0x02);\n    dr.read(0x03);\n    dr.write(0x04);\n    dr.close(0x05);\n    dr.exit(0x06);\n}\n</code></pre>\n\n<p>Try with that</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "edited": false, "score": 0, "creation_date": 1510826318, "post_id": 47302147, "comment_id": 81603847, "body": "Exactly!  An excellent answer... I did achieved this two days ago, but today I did the Politically Correct one with Designated Initializator: <a href=\"https://stackoverflow.com/questions/330793/how-to-initialize-a-struct-in-accordance-with-c-programming-language-standards\" title=\"how to initialize a struct in accordance with c programming language standards\">stackoverflow.com/questions/330793/&hellip;</a>. This one I wanted to achieve, and I did it, with all your help! Thank You again!"}], "tags": [], "owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "is_accepted": false, "score": 1, "last_activity_date": 1510733391, "last_edit_date": 1510733391, "creation_date": 1510732813, "answer_id": 47302147, "question_id": 47301796, "link": "https://stackoverflow.com/questions/47301796/array-of-function-pointers-as-a-member-of-a-c-struct/47302147#47302147", "title": "Array of function pointers as a member of a C struct", "body": "<p>Make <code>USB_driver</code> a variable by just removing the <code>typedef struct</code> from <code>typedef struct driver_t USB_driver;</code> and use the code in the <code>main</code> to init it.</p>\n\n<p>Like this:</p>\n\n<pre><code>driver_t USB_driver;\n\nint main(void) {\n    USB_driver.init = &amp;USB_init;\n    USB_driver.open = &amp;USB_open;\n    USB_driver.read  = &amp;USB_read;\n    USB_driver.write = &amp;USB_write;\n    USB_driver.close = &amp;USB_close;\n    USB_driver.exit  = &amp;USB_exit;\n\n    USB_driver.init(0x01);\n    USB_driver.open(0x02);\n    USB_driver.read(0x03);\n    USB_driver.write(0x04);\n    USB_driver.close(0x05);\n    USB_driver.exit(0x06);\n\n    return 0;\n}\n</code></pre>\n\n<p>Or better yet make new create function:</p>\n\n<pre><code>void USB_Driver_create(driver_t *driver)\n{\n    driver-&gt;init = &amp;USB_init;\n    driver-&gt;open = &amp;USB_open;\n    driver-&gt;read  = &amp;USB_read;\n    driver-&gt;write = &amp;USB_write;\n    driver-&gt;close = &amp;USB_close;\n    driver-&gt;exit  = &amp;USB_exit;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6926905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166658314415ef93197487aa63334ffa?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/6926905/nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "closed_date": 1510733136, "answer_count": 3, "score": -1, "last_activity_date": 1510733531, "creation_date": 1510731402, "last_edit_date": 1510732271, "question_id": 47301796, "link": "https://stackoverflow.com/questions/47301796/array-of-function-pointers-as-a-member-of-a-c-struct", "closed_reason": "Duplicate", "title": "Array of function pointers as a member of a C struct", "body": "<p>I have built the following C example trying to simulate simplistic generic driver code which can be used in small ARM micro-controllers:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef unsigned char uint8_t;\ntypedef void (*generic_func_t)(uint8_t);\n\ntypedef struct {\n        generic_func_t init;\n        generic_func_t open;\n        generic_func_t read;\n        generic_func_t write;\n        generic_func_t close;\n        generic_func_t exit;\n} driver_t;\n\nvoid USB_init(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_open 0x%x\\n\", x);\n}\n\nvoid USB_open(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_open 0x%x\\n\", x);\n}\n\nvoid USB_read(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_read 0x%x\\n\", x);\n}\n\nvoid USB_write(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_write 0x%x\\n\", x);\n}\n\nvoid USB_close(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_close 0x%x\\n\", x);\n}\n\nvoid USB_exit(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_close 0x%x\\n\", x);\n}\n\ntypedef struct driver_t USB_driver;\n\n#if 1\n        USB_driver.init = &amp;USB_init;\n        USB_driver.open = &amp;USB_open;\n        USB_driver.read  = &amp;USB_read;\n        USB_driver.write = &amp;USB_write;\n        USB_driver.close = &amp;USB_close;\n        USB_driver.exit  = &amp;USB_exit;\n#endif\n\n#if 1\nvoid main(void) {}\n#endif\n#if 0\nvoid main(void) {\n        USB_driver.init(0x01);\n        USB_driver.open(0x02);\n        USB_driver.read(0x03);\n        USB_driver.write(0x04);\n        USB_driver.close(0x05);\n        USB_driver.exit(0x06);\n}\n#endif\n</code></pre>\n\n<p>The following error appears:</p>\n\n<pre><code>[user@localhost fn-ptr]$ emacs fn-ptr.c\n\n(emacs:4983): Gtk-WARNING **: Allocating size to Emacs 0xdb4270 without calling gtk_widget_get_preferred_width/height(). How does the code know the size to allocate?\n[user@localhost fn-ptr]$ gcc fn-ptr.c\nfn-ptr.c:78:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.init = &amp;USB_init;\n           ^\nfn-ptr.c:79:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.open = &amp;USB_open;\n           ^\nfn-ptr.c:80:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.read  = &amp;USB_read;\n           ^\nfn-ptr.c:81:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.write = &amp;USB_write;\n           ^\nfn-ptr.c:82:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.close = &amp;USB_close;\n           ^\nfn-ptr.c:83:11: error: expected identifier or \u2018(\u2019 before \u2018.\u2019 token\n USB_driver.exit  = &amp;USB_exit;\n           ^\n[user@localhost fn-ptr]$ \n</code></pre>\n\n<p>The question here is: what should I do to make this code to work, since the following single function pointer example, upon which this code is built, works perfectly:</p>\n\n<pre><code>typedef unsigned char uint8_t;\ntypedef void (*generic_func_t)(uint8_t);\n\ngeneric_func_t init;\n\nvoid USB_init(uint8_t x)\n{\n        /* here body of this f-n */\n        printf(\"USB_open 0x%x\\n\", x);\n}\n\ninit = &amp;USB_init;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1510730772, "post_id": 47301556, "comment_id": 81553988, "body": "Only stack-allocated data goes into the stack \u2014 non-static local variables. That applies whether the variables are initialized or not. Static local variables go in the data segment.  They might be in the BSS section if they&#39;re not explicitly initialized, or in the initialized part of the data segment if they&#39;re initialized to non-zero values."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1510730661, "creation_date": 1510730661, "answer_id": 47301604, "question_id": 47301556, "link": "https://stackoverflow.com/questions/47301556/difference-between-stack-segment-and-uninitialized-data-segment/47301604#47301604", "title": "difference between stack segment and uninitialized data segment", "body": "<blockquote>\n  <p><em>the uninitialized data of the local function goes to the uninitialized data segment.</em></p>\n</blockquote>\n\n<p>Well, that is not entirely true.</p>\n\n<p>Read carefully, (<a href=\"http://www.geeksforgeeks.org/memory-layout-of-c-program/\" rel=\"nofollow noreferrer\">from the same link</a>, emphasis mine)</p>\n\n<blockquote>\n  <p>[...] uninitialized data starts at the end of the data segment and <strong>contains all global variables and static variables that are initialized to zero or do not have explicit initialization in source code.</strong> [...]</p>\n</blockquote>\n\n<p>So, the automatic storage variables still resides in stack segment, irrespective of the fact whether they are initialized or not.</p>\n\n<p><em>That said, a word of caution, this is \"A typical memory representation\", not universal. C standard does not mandate to have a stack segment (or any other), for the matter.</em></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "edited": false, "score": 0, "creation_date": 1510732999, "post_id": 47301825, "comment_id": 81555093, "body": "Can you please elaborate on &quot;static storage duration&quot; ? So the local static uninitialized variable end up in .data right?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "edited": false, "score": 0, "creation_date": 1510733067, "post_id": 47301825, "comment_id": 81555134, "body": "@nalinkanoongo Everything is explained in the link posted."}, {"owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "edited": false, "score": 0, "creation_date": 1510733291, "post_id": 47301825, "comment_id": 81555287, "body": "Got it. Thank you"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1510740878, "post_id": 47301825, "comment_id": 81559804, "body": "&quot;Including any such variable which is explicitly initialised to value zero.&quot;. Large footnote here. Various toolchains have changed their mind on this a few times and different systems may configure this differently. Got bitten by it after having updated either gcc or ld or whatever it was and a method to binary patch a kernel no longer worked (we were dumping a ramdisk image into a large array in the kernel and the toolchain moved it from data to bss). I know that some systems explicitly changed the default behavior of the toolchain when they ran into similar problems."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1510731493, "creation_date": 1510731493, "answer_id": 47301825, "question_id": 47301556, "link": "https://stackoverflow.com/questions/47301556/difference-between-stack-segment-and-uninitialized-data-segment/47301825#47301825", "title": "difference between stack segment and uninitialized data segment", "body": "<p>I would not recommend reading \"geeksforgeeks\" tutorials. You have some misconceptions.</p>\n\n<p>What they call \"uninitialized data\", the <code>.bss</code> segment, is in fact a store for variables of static storage duration that are <em>zero-initialized</em>. Including any such variable which is explicitly initialized to value zero.\nAn explanation of static storage duration and the different common segments, with examples, can be found <a href=\"https://electronics.stackexchange.com/questions/237740/what-resides-in-the-different-memory-types-of-a-microcontroller/237759#237759\">here</a>.</p>\n\n<p><em>Only</em> variables with static storage duration end up in <code>.bss</code> and <code>.data</code>. Local variables always end up on the stack, or in CPU registers, no matter if they are initialized or not.</p>\n\n<p>(Please note that none of this is specified by the ISO C standard, but rather by industry de facto standards.)</p>\n"}], "owner": {"reputation": 31, "user_id": 8943517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab1cf77f7928a05b02fafaf7e708f9b?s=128&d=identicon&r=PG&f=1", "display_name": "nalin kanoongo", "link": "https://stackoverflow.com/users/8943517/nalin-kanoongo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1510731493, "creation_date": 1510730492, "last_edit_date": 1510730982, "question_id": 47301556, "link": "https://stackoverflow.com/questions/47301556/difference-between-stack-segment-and-uninitialized-data-segment", "title": "difference between stack segment and uninitialized data segment", "body": "<p>I was trying to get a hand over the memory allocation in c. </p>\n\n<p>According to the <a href=\"http://www.geeksforgeeks.org/memory-layout-of-c-program/\" rel=\"nofollow noreferrer\">following link</a>, the stack and the uninitialized data segment are different and the uninitialized data of the local function goes to the uninitialized data segment. </p>\n\n<p>If that is the case then what is stored in the stack segment in case of a code with uninitialized local variables? Is it empty?  </p>\n"}, {"tags": ["c", "c-strings"], "answers": [{"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1510790820, "creation_date": 1510790820, "answer_id": 47319413, "question_id": 47301459, "link": "https://stackoverflow.com/questions/47301459/assigning-value-to-element-of-a-cstring/47319413#47319413", "title": "Assigning value to element of a cstring", "body": "<p>No it's not allowed. As you said, this is overwriting the null-character at the end. It doesn't cause an error at this point, because you are accessing a valid index.</p>\n\n<p>But if you try to print the string, then the print function doesn't know where the string ends. The print function will keep printing the characters until it reaches a zero byte by accident, or something else goes horribly wrong with buffer overflow. This is undefined behavior. The same problem will occur with other string functions, <code>strcpy</code>, <code>strlen</code>, <code>strcmp</code>... who all rely on the null-character to find the end of string.</p>\n"}], "owner": {"reputation": 422, "user_id": 6642021, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/x5GTR.jpg?s=128&g=1", "display_name": "Howard Wang", "link": "https://stackoverflow.com/users/6642021/howard-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510790820, "creation_date": 1510730114, "last_edit_date": 1510745767, "question_id": 47301459, "link": "https://stackoverflow.com/questions/47301459/assigning-value-to-element-of-a-cstring", "title": "Assigning value to element of a cstring", "body": "<p>Just learned about cstrings in my computer science class and it just hit me,\nthis is legal </p>\n\n<pre><code>char ch[] = \"hello\";\n</code></pre>\n\n<p>However, it seems that I can also assign to the \"5th\" element in this array</p>\n\n<pre><code>ch[5] = \"!\";\n</code></pre>\n\n<p>Is this allowed? Or am I just overriding the null character at the end of the array?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1510730126, "post_id": 47301417, "comment_id": 81553672, "body": "As long as the user don&#39;t input 8 (or more) characters there&#39;s nothing wrong with that <code>strcmp</code> call. Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510730227, "post_id": 47301417, "comment_id": 81553721, "body": "By the way, <code>&amp;emt_card</code> in the <code>scanf</code> call is semantically wrong. It works because it happens to point to the correct location, but it is the wrong type (the <code>&quot;%s&quot;</code> format expects a pointer to char, i.e. <code>char *</code>, but <code>&amp;emt_card</code> is of type <code>char (*)[8]</code>). Use either <code>&amp;emt_card[0]</code> or its equivalent <code>emt_card</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1510734475, "post_id": 47301417, "comment_id": 81555930, "body": "Oh and I suggest you take some time to <a href=\"https://msdn.microsoft.com/en-us/library/w40768et.aspx\" rel=\"nofollow noreferrer\">read this <code>scanf_s</code> reference</a>. Because <i>that&#39;s</i> the cause of the crash, not the <code>strcmp</code> call."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1510734484, "post_id": 47301417, "comment_id": 81555936, "body": "Reading documentation mostly is a good idea: <a href=\"https://msdn.microsoft.com/de-de/library/w40768et.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/de-de/library/w40768et.aspx</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1510735930, "last_edit_date": 1510735930, "creation_date": 1510734277, "answer_id": 47302534, "question_id": 47301417, "link": "https://stackoverflow.com/questions/47301417/win-32-console-app-crashes-when-running-strcmp-code/47302534#47302534", "title": "win 32 console app crashes when running strcmp code", "body": "<p><code>scanf_s()</code> is <strong>not</strong> a drop-in replacement for <code>scanf()</code>. With <code>scanf_s()</code>, a <code>%s</code>, <code>%c</code> or <code>%[</code> conversion needs <strong>two</strong> arguments, the second one is the size of the target buffer.</p>\n\n<p>Originally, <code>scanf_s()</code> (and \"friends\") is a Microsoft idea, and the Microsoft definition is slightly different from the now standardized <code>scanf_s()</code>. The Microsoft version defines the size in <em>bytes</em> of type <code>unsigned</code>, while the C standard defines it in <em>elements</em> of type <code>rsize_t</code> (which is the same number here, but still incompatible ...).</p>\n\n<p>Correct usage of <code>scanf_s()</code> would look like this in your code:</p>\n\n<pre><code>char emt_card[8];\n[...]\nint rc = scanf_s(\"%s\", emt_card, 8U); // microsoft\nint rc = scanf_s(\"%s\", emt_card, (rsize_t)8); // standard C\nif (rc &lt; 1)\n{\n    // handle error, either EOF or 0 (buffer was too small for input)\n}\n</code></pre>\n\n<p>Note also there's no <em>address-of</em> operator in the call. <code>emt_card</code> already evaluates to a pointer to the first element (<code>char *</code>), while <code>&amp;emt_card</code> would be a pointer to the array (<code>char (*)[8]</code>). The values are the same, still <code>&amp;emt_card</code> would have the wrong type, so it's undefined behavior.</p>\n\n<hr>\n\n<p>The \"funny\" thing is that you forgot exactly the size which was the reason to introduce <code>scanf_s()</code> in the first place. <code>scanf(\"%s\", ...)</code> is <strong>alyways a bug</strong> because it will overflow any buffer. But there's a way to write this code correctly with just <code>scanf()</code> as well by using a <em>field width</em>:</p>\n\n<pre><code>int rc = scanf(\"%7s\", emt_card); // read up to 7 bytes, leaving room for the `0` byte\nif (rc &lt; 1)\n{\n    // handle error\n}\n</code></pre>\n\n<p>The difference here is that if the input is too long, the <code>scanf()</code> with a field-width will just stop consuming input, while <code>scanf_s()</code> with a size given and without field-width would <strong>fail</strong> the conversion.</p>\n\n<hr>\n\n<p>I'd personally suggest to never use <code>scanf_s()</code> and friends because of the incompatible definitions. <code>scanf()</code> is sufficient if you use field widths. On a side note, <code>scanf()</code> for interactive input is almost always very problematic, I'd suggest to not use it at all. See my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners' guide away from <code>scanf()</code></a> for more information and alternatives.</p>\n"}], "owner": {"reputation": 9, "user_id": 8943473, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606373146094265/picture?type=large", "display_name": "Ram Swaren", "link": "https://stackoverflow.com/users/8943473/ram-swaren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510735930, "creation_date": 1510729974, "question_id": 47301417, "link": "https://stackoverflow.com/questions/47301417/win-32-console-app-crashes-when-running-strcmp-code", "title": "win 32 console app crashes when running strcmp code", "body": "<pre><code>void emt_card_discount()\n{\n    char emt_card[8];\n    char*none[5];\n    int new_total_amt;\n\n    printf(\"\\tkey in EMT card number (7 figure) if present or type 'none': \\n\\t &gt;&gt; \");\n    scanf_s(\"%s\", &amp;emt_card);\n\n    if (strcmp(emt_card,\"none\") == 0)\n    {\n        printf(\"\\tyour seat price is: %.2f\\n\",total_amt);\n    }\n\n    else\n    { \n        new_total_amt = total_amt*0.15;\n        printf(\"\\tyour seat price is(RM):%.2f\\n\", new_total_amt);\n    }\n}\n</code></pre>\n\n<p>This is my code for strcmp.this particular basically functions to provide the user booking the ticket to enter card info to get a special discount..but whenever i get to this part of the code the whole console app crashes..</p>\n\n<p>.</p>\n"}, {"tags": ["c", "winapi", "driver", "inf"], "comments": [{"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510730358, "post_id": 47301356, "comment_id": 81553779, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10538050/how-to-find-the-names-of-the-installed-drivers-in-my-computer-in-c\">How to find the names of the installed drivers in my computer in C?</a>"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "reply_to_user": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510730589, "post_id": 47301356, "comment_id": 81553879, "body": "How could it be duplicate of that, if they are trying to enumerete the hardware devices, while my question is about if the driver is preinstalled?"}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510733631, "post_id": 47301356, "comment_id": 81555457, "body": "Seems you don&#39;t read comments at all. There was useful comment about winapi <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682619(v=vs.85).aspx\" rel=\"nofollow noreferrer\">EnumDeviceDrivers</a>. Method is - enumerate all drivers and find yours in the list."}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "reply_to_user": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510736489, "post_id": 47301356, "comment_id": 81557105, "body": "It gives the list of drivers, but my driver is not in the list. I&#39;ve checked and my driver is in <code>System32&#47;drivers</code> directory, what  conditions need to be met to have my driver in the list? It only appears there if I create device associated with the driver."}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510742191, "post_id": 47301356, "comment_id": 81560654, "body": "Hm..., seems that this api enumerates <i>loaded</i> drivers in memory - for active devices. Yes, you need something different - to get driver if device was active at some point in the past. Probably <a href=\"https://stackoverflow.com/questions/27144063/check-if-a-windows-driver-exists-for-a-given-device-id\">this thread</a> will help you"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "reply_to_user": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1510746627, "post_id": 47301356, "comment_id": 81563514, "body": "Thanks for your help, but that&#39;s not the point. How can I check if driver is preinstalled on clean windows? In clean windows I mean OS which had never had my software (and of course my driver) installed before?"}, {"owner": {"reputation": 428, "user_id": 5923576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96pUL.jpg?s=128&g=1", "display_name": "kvr", "link": "https://stackoverflow.com/users/5923576/kvr"}, "edited": false, "score": 0, "creation_date": 1510785552, "post_id": 47301356, "comment_id": 81588248, "body": "How about checking the registry under the services key? Not sure how reliable it is, but I recall drivers are typically registered there..."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1510789408, "post_id": 47301356, "comment_id": 81589561, "body": "Sounds like an <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a>. What are you <i>really</i> trying to accomplish?"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "reply_to_user": {"reputation": 428, "user_id": 5923576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96pUL.jpg?s=128&g=1", "display_name": "kvr", "link": "https://stackoverflow.com/users/5923576/kvr"}, "edited": false, "score": 0, "creation_date": 1510814040, "post_id": 47301356, "comment_id": 81596866, "body": "<code>I&#39;m curious if there is some other way of checking if driver is preinstalled using winapi?</code> why do you think its <code>XY Problem</code>? @kvr which registry keys cointain such information?"}, {"owner": {"reputation": 428, "user_id": 5923576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96pUL.jpg?s=128&g=1", "display_name": "kvr", "link": "https://stackoverflow.com/users/5923576/kvr"}, "edited": false, "score": 0, "creation_date": 1510858030, "post_id": 47301356, "comment_id": 81625840, "body": "@Ojs Check HKLM\\System\\CurrentControlSet\\Services and check each subkey, and look at the ImagePath, and Type values etc."}], "owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510730731, "creation_date": 1510729780, "last_edit_date": 1510730731, "question_id": 47301356, "link": "https://stackoverflow.com/questions/47301356/winapi-how-to-check-if-driver-is-preinstalled-on-system", "title": "Winapi: How to check if driver is preinstalled on system?", "body": "<p>I'm working with drivers and recently I ran to this problem. Before performing some operations, our software checks if specific driver is preinstalled using this function</p>\n\n<pre><code>  SetupCopyOEMInf(sourceInf, NULL, SPOST_NONE,\n                  SP_COPY_REPLACEONLY | SP_COPY_NOOVERWRITE,\n                      NULL, 0, NULL, NULL);\n</code></pre>\n\n<p>It was copying the inf and if we got <code>ERROR_FILE_EXISTS</code> error, we assumed that driver was preinstalled.</p>\n\n<p>For some reason this function doesn't work on recent windows 10, Even if inf file already exist in <code>Windows/inf</code>, it returns true every time. </p>\n\n<p>I'm curious if there is some other way of checking if driver is preinstalled using winapi? Thanks.</p>\n\n<p><strong>P.S</strong></p>\n\n<p>I've checked <a href=\"https://stackoverflow.com/questions/10538050/how-to-find-the-names-of-the-installed-drivers-in-my-computer-in-c\">this</a> question and it didn't help me because, I don't have a device to plug in, my driver creates virtual network adapters.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 3, "creation_date": 1510729435, "post_id": 47301176, "comment_id": 81553362, "body": "Do you mean <code>a = (a &amp; 0xFFffFFffFFffFF00) | b;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510729559, "post_id": 47301273, "comment_id": 81553416, "body": "maybe there should be a <code>b &amp; 0xFF</code> to keep other things safe."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510729603, "post_id": 47301273, "comment_id": 81553437, "body": "@TahaPaksu - Safe from what? The static type of <code>b</code> is already an unsigned char."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510729633, "post_id": 47301273, "comment_id": 81553450, "body": "Yep, I didn&#39;t look at the type. Sorry."}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1510729695, "post_id": 47301273, "comment_id": 81553482, "body": "isn&#39;t that b = ((a &gt;&gt; CHAR_BIT) &lt;&lt; CHAR_BIT) | b; i mean the question is &quot;set rightmost 8 bit of a 64bit int to a char var?&quot;"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1510729743, "post_id": 47301273, "comment_id": 81553500, "body": "@potato - The OP&#39;s own code sample assigns to <code>a</code>. I gathered that&#39;s what they wanted."}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1510729825, "post_id": 47301273, "comment_id": 81553530, "body": "@StoryTeller its only a matter of applying correct logic OP should be able to get that"}, {"owner": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510729865, "post_id": 47301273, "comment_id": 81553556, "body": "Will this change left 56 bits of a? I need left 56 bits remain unchanged"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510729932, "post_id": 47301273, "comment_id": 81553589, "body": "@Sato - It won&#39;t. So long as you make sure it shifts right first."}, {"owner": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510729990, "post_id": 47301273, "comment_id": 81553607, "body": "@StoryTeller oh, i need left 56 bits remain unchanged. only rightmost 8 bits set to <code>b</code>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510730058, "post_id": 47301273, "comment_id": 81553639, "body": "@Sato - I gathered that. That&#39;s why I propsed a s&#242;ution that <b>will not</b> change them."}, {"owner": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510730167, "post_id": 47301273, "comment_id": 81553691, "body": "@StoryTeller which is?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "edited": false, "score": 0, "creation_date": 1510730200, "post_id": 47301273, "comment_id": 81553708, "body": "@Sato - The one in my answer."}, {"owner": {"reputation": 814, "user_id": 5171437, "user_type": "registered", "accept_rate": 84, "profile_image": "https://lh5.googleusercontent.com/-dVd6QfUoAc8/AAAAAAAAAAI/AAAAAAAAAEQ/Xxcp3CY7CF8/photo.jpg?sz=128", "display_name": "noman pouigt", "link": "https://stackoverflow.com/users/5171437/noman-pouigt"}, "edited": false, "score": 0, "creation_date": 1510730490, "post_id": 47301273, "comment_id": 81553826, "body": "nice. #define CLEAR_RIGHT_X_BITS(a, x) ((a) = ((a &gt;&gt; (x)) &lt;&lt; (x))) should do for x bits."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1510729444, "creation_date": 1510729444, "answer_id": 47301273, "question_id": 47301176, "link": "https://stackoverflow.com/questions/47301176/how-to-set-rightmost-8-bit-of-a-64bit-int-to-a-char-var/47301273#47301273", "title": "How to set rightmost 8 bit of a 64bit int to a char var?", "body": "<p>There's a useful macro defined in <code>limits.h</code> that can help make it portable. It's <code>CHAR_BIT</code>.</p>\n\n<pre><code>a = ((a &gt;&gt; CHAR_BIT) &lt;&lt; CHAR_BIT) | b;\n</code></pre>\n\n<p>And that's it. The piece in parentheses clears the least significant <code>CHAR_BIT</code>s of <code>a</code>, and then that can be bitwise-ored with <code>b</code>.</p>\n"}], "owner": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47301273, "answer_count": 1, "score": 2, "last_activity_date": 1510730198, "creation_date": 1510729052, "last_edit_date": 1510730198, "question_id": 47301176, "link": "https://stackoverflow.com/questions/47301176/how-to-set-rightmost-8-bit-of-a-64bit-int-to-a-char-var", "title": "How to set rightmost 8 bit of a 64bit int to a char var?", "body": "<p>For example, I have a 64 bit var <code>a</code>, and a 8 bit char <code>b</code></p>\n\n<pre><code>unsigned long long a = 0x1234567890123456;\nunsigned char b = 0x78;\n</code></pre>\n\n<p>I want <code>a</code> to become 0x12345678901234<strong>78</strong></p>\n\n<p>I want rightmost 8 bit of <code>a</code> to set to <code>b</code>, and remain left 56 bits untouched, how can i do this?</p>\n\n<pre><code>a = a &amp; (0xFFffFFffFFffFFff | b); //is this correct?\n</code></pre>\n\n<p>??</p>\n"}, {"tags": ["android", "c", "android-ndk", "stack-trace"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9718249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51065727ae85fac0d3d7a66a1c5d5b85?s=128&d=identicon&r=PG&f=1", "display_name": "CFan", "link": "https://stackoverflow.com/users/9718249/cfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1526311763, "creation_date": 1526311763, "answer_id": 50334012, "question_id": 47301148, "link": "https://stackoverflow.com/questions/47301148/how-to-find-which-method-caused-crash-from-ndk-stack-trace/50334012#50334012", "title": "How to find which method caused crash from NDK stack trace", "body": "<p>I too was looking for ways to trace SIGSEGV faults. I decided to do my own trace.\n<a href=\"https://github.com/claytonfan/trace\" rel=\"nofollow noreferrer\">https://github.com/claytonfan/trace</a>\nIntended usage:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include \"trace.h\n\nvoid sig_handler(int signo)\n{\n    if( signo ==  SIGSEGV ) {\n        traceDump(\"Signal SIGSEGV\");\n    }\n    // may handle other signo's\n    exit( signo );\n}\n\nint main(int argc, char **argv)\n{\n    traceInit( \"Prgram Test\", &amp;printf, 0 );\n    signal( SIGSEGV, sig_handler );\n    //\n    // and possibly other signals\n    //\n    // . . . main() logic . . .\n    return( 0 );\n}\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 1481, "user_id": 6059583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BdoQK.png?s=128&g=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/6059583/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526311763, "creation_date": 1510728937, "last_edit_date": 1510729742, "question_id": 47301148, "link": "https://stackoverflow.com/questions/47301148/how-to-find-which-method-caused-crash-from-ndk-stack-trace", "title": "How to find which method caused crash from NDK stack trace", "body": "<p>My app crashes due to .so file.<br/>\nI followed this link <a href=\"https://developer.android.com/ndk/guides/ndk-stack.html\" rel=\"nofollow noreferrer\">https://developer.android.com/ndk/guides/ndk-stack.html</a><br/>\nUsing the above link i am able to take stack-trace dump from log cat.<br/>\nAnd from stack trace it shows me all functions name using  <strong>ndk-stack tool</strong>.<br/>But i am unable to find out which method exactly caused my app to crash??<br/></p>\n\n<p>This is the log from my app stating fatal signal.<br/></p>\n\n<pre><code>id: 26940, tid: 27543, name: Thread-579  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\n</code></pre>\n\n<p>Its stating fault address 0x34.but using ndk-stack tool it shows all threads with function names but which one caused crash??<br/><br/></p>\n\n<pre><code>********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 26940, tid: 27543, name: Thread-579  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155638  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_thread_create at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:570 (discriminator 5)\nStack frame #01 pc 0011973f  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:667 (discriminator 2)\nStack frame #02 pc 00155471  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:214 (discriminator 2)\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 28169, tid: 28422, name: Thread-618  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155638  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_thread_create at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:570 (discriminator 5)\nStack frame #01 pc 0011973f  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:667 (discriminator 2)\nStack frame #02 pc 00155471  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:214 (discriminator 2)\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 29519, tid: 30349, name: Thread-620  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 10036, tid: 10963, name: Thread-755  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 11338, tid: 11813, name: Thread-751  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 12197, tid: 12384, name: Thread-801  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-2/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 14140, tid: 14798, name: Thread-808  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n\n********** Crash dump: **********\nBuild fingerprint: 'Xiaomi/land/land:6.0.1/MMB29M/V8.5.4.0.MALMIED:user/release-keys'\npid: 15644, tid: 16119, name: Thread-839  &gt;&gt;&gt; com.nexge.nexgeotpdialer &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x34\nStack frame #00 pc 00155660  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (pj_thread_destroy+3): Routine pj_enter_critical_section at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:1094\nStack frame #01 pc 00119763  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (start_signal+238): Routine check_rx_late_pkt at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjmedia/build/../src/pjmedia/compressed_rtp.c:672\nStack frame #02 pc 00155499  /data/app/com.nexge.nexgeotpdialer-1/lib/arm/libpjsua2.so (thread_main+40): Routine pj_init at /home/protocol/Jeeva/PJSIPWorks/AESEncryption/pjlib/build/../src/pj/os_core_unix.c:218\nStack frame #03 pc 0004185b  /system/lib/libc.so (_ZL15__pthread_startPv+30)\nStack frame #04 pc 000192a5  /system/lib/libc.so (__start_thread+6)\nCrash dump is completed\n</code></pre>\n"}, {"tags": ["c", "arrays", "linux"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1510728739, "post_id": 47301092, "comment_id": 81552998, "body": "It&#39;s in a string literal. It doesn&#39;t <i>do</i> anything in C."}, {"owner": {"reputation": 12716, "user_id": 2110496, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/a9ZWC.jpg?s=128&g=1", "display_name": "vp_arth", "link": "https://stackoverflow.com/users/2110496/vp-arth"}, "edited": false, "score": 1, "creation_date": 1510728941, "post_id": 47301092, "comment_id": 81553119, "body": "@rsp, incorrect, not &quot;It doesn&#39;t do anything&quot;, but &quot;It doesn&#39;t do anything <b>in C</b>&quot;"}, {"owner": {"reputation": 4293, "user_id": 7035151, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce9aa200c854d26a2cd263f6fc8c24eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jayesh", "link": "https://stackoverflow.com/users/7035151/jayesh"}, "edited": false, "score": 1, "creation_date": 1510730090, "post_id": 47301092, "comment_id": 81553655, "body": "I think the question is not bad. Why so many downvotes?"}], "answers": [{"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 3, "last_activity_date": 1510728862, "creation_date": 1510728862, "answer_id": 47301128, "question_id": 47301092, "link": "https://stackoverflow.com/questions/47301092/what-does-do/47301128#47301128", "title": "What does &quot;~[]&quot; do?", "body": "<p>It does <strong>nothing</strong>.</p>\n\n<pre><code>puts(\"sigprocmask(SIG_UNBLOCK, ~[], []) = 0\");\n     ^                                     ^\n</code></pre>\n\n<p>It's a string literal. This line is probably used to generate a program in another language, which at least isn't C.</p>\n"}, {"comments": [{"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1510729310, "post_id": 47301229, "comment_id": 81553304, "body": "open that github link and see the extension of file name."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 1, "creation_date": 1510729361, "post_id": 47301229, "comment_id": 81553321, "body": "@rsp - the file could be pre- or post-processed. Google using a web technology to perform the processing sounds plausible to me. Or maybe its like someone else commented, that it is some contraption invented by AOSP. That&#39;s my guess, at least."}], "tags": [], "owner": {"reputation": 532, "user_id": 6623469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ebc0962a7ca106f4294fe9cd3ba0c3?s=128&d=identicon&r=PG&f=1", "display_name": "krish___na", "link": "https://stackoverflow.com/users/6623469/krish-na"}, "is_accepted": false, "score": 0, "last_activity_date": 1510729224, "creation_date": 1510729224, "answer_id": 47301229, "question_id": 47301092, "link": "https://stackoverflow.com/questions/47301092/what-does-do/47301229#47301229", "title": "What does &quot;~[]&quot; do?", "body": "<p>The syntax ~[] is part of Javascript bitwise NOT empty array expression. C does not have any such operator.</p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 3, "last_activity_date": 1510729814, "last_edit_date": 1510729814, "creation_date": 1510729496, "answer_id": 47301290, "question_id": 47301092, "link": "https://stackoverflow.com/questions/47301092/what-does-do/47301290#47301290", "title": "What does &quot;~[]&quot; do?", "body": "<p>The linked program seems to be logging its actions in some invented semi-formalized language. This logging \"language\" is not C. The string literal in your question is just a line in that invented \"language\", which the program will send to standard output. Therefore the <code>~[]</code> bit has notrhing to do with C and has no special meaning in C context.</p>\n\n<p>After each (supposedly succesful) <code>k_sigprocmask</code> call the progrtam logs that call by sending such strings to the output.</p>\n\n<p>For example, when the program outputs <code>sigprocmask(SIG_SETMASK, [], NULL) = &lt;something&gt;</code> it basically just tells the user \"I just called <code>k_sigprocmask</code> function with first argument <code>SIG_SETMASK</code>, empty set of bits as the second argument and a null pointer as the third argument. And I received <code>&lt;something&gt;</code> as the error code.\"</p>\n\n<p><code>[]</code> stands for all-bits-zero bit mask (empty set). <code>[HUP INT QUIT]</code> stands for a mask with only <code>HUP</code>, <code>INT</code> and <code>QUIT</code> bits set to 1. <code>~[HUP]</code> stands for a mask with all bits set to 1 except <code>HUP</code> bit.</p>\n\n<p><code>~[]</code> stands for a strange argument value <code>new_set - 1</code>, which does not immediately make sense to me (since <code>new_set</code> is a pointer). I presume it somehow results in a set with all elements included (all bits set to 1).</p>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 1, "last_activity_date": 1510735156, "creation_date": 1510735156, "answer_id": 47302787, "question_id": 47301092, "link": "https://stackoverflow.com/questions/47301092/what-does-do/47302787#47302787", "title": "What does &quot;~[]&quot; do?", "body": "<p>The <a href=\"https://linux.die.net/man/1/strace\" rel=\"nofollow noreferrer\">reference</a> say's :</p>\n\n<blockquote>\n  <p>On the other hand, <strong>bit-sets</strong> are <strong>also shown using square brackets</strong> but\n  set elements are separated only by a space. Here is the shell\n  preparing to execute an external command:</p>\n\n<pre><code>sigprocmask(SIG_BLOCK, [CHLD TTOU], []) = 0\n</code></pre>\n  \n  <p>Here <strong>the second argument is a bit-set of two signals, SIGCHLD and\n  SIGTTOU. In some cases the bit-set is so full that printing out the\n  unset elements is more valuable</strong>. In that case, the bit-set is prefixed\n  by a tilde like this:</p>\n\n<pre><code>sigprocmask(SIG_UNBLOCK, ~[], NULL) = 0\n</code></pre>\n  \n  <p>Here the second argument represents the full set of all signals.</p>\n</blockquote>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 47301290, "answer_count": 4, "score": -4, "last_activity_date": 1510739645, "creation_date": 1510728684, "last_edit_date": 1510739645, "question_id": 47301092, "link": "https://stackoverflow.com/questions/47301092/what-does-do", "title": "What does &quot;~[]&quot; do?", "body": "<p>I saw the following line of code <a href=\"https://github.com/aosp-mirror/platform_external_strace/blob/master/tests-mx32/sigprocmask.c#L76\" rel=\"nofollow noreferrer\">here</a> .</p>\n\n<pre><code>puts(\"sigprocmask(SIG_UNBLOCK, ~[], []) = 0\");\n</code></pre>\n\n<p>I don't understand, what does empty array script(<code>[]</code>) do?</p>\n\n<p>Also, What is the purpose of <code>~[]</code> in C?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1510727199, "post_id": 47300650, "comment_id": 81552331, "body": "will your data frame length be dynamic? for example if your data contains 12 bytes, will your frame length n + 12? or will you send all 16 bytes and your frame length will be n + 16 for every case?"}, {"owner": {"reputation": 1999, "user_id": 3188346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fbdb414d9dcf1e2a79fe37eb16aec9?s=128&d=identicon&r=PG&f=1", "display_name": "luantkow", "link": "https://stackoverflow.com/users/3188346/luantkow"}, "edited": false, "score": 0, "creation_date": 1510727727, "post_id": 47300650, "comment_id": 81552556, "body": "is the message format enforced on you? can you amend it? If you switch the checksum and message payload order your task should be easier."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510727871, "post_id": 47300650, "comment_id": 81552613, "body": "The problem is portability. All you are guaranteed with a <code>struct</code> is that the address of the <code>struct</code> will be the same as that of its first member. After that compiler handling of padding can cause problems. So copying address past the first to your array becomes problematic. <code>offsetof</code> in <code>stddef.h</code> can help with the member addresses, but a fixed array sure sounds easier."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1510730202, "post_id": 47300650, "comment_id": 81553709, "body": "You may also want to look at a serialization library like <a href=\"https://github.com/troydhanson/tpl\" rel=\"nofollow noreferrer\">tpl</a>, <a href=\"https://github.com/liteserver/binn\" rel=\"nofollow noreferrer\">binn</a>, <a href=\"https://github.com/protobuf-c/protobuf-c\" rel=\"nofollow noreferrer\">protobuf-c</a>"}, {"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510734216, "post_id": 47300650, "comment_id": 81555769, "body": "Taha Paksu, yes frame length will be dynamic with the length of the data portion. So the frame size is a constant overhead with variable data length."}, {"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510734382, "post_id": 47300650, "comment_id": 81555875, "body": "user3188346, yes the message format is enforced. How I build the message is essentially completely up to me. Yes data portion at the end of the struct would be much easier."}, {"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510734613, "post_id": 47300650, "comment_id": 81556014, "body": "David C. Rankin unfortunately my data portion of the frame is not fixed, so a fixed array would then have to be special cased when the array isnt full. I will checkout the serialization libraries you suggested. I have two structs like this so felt using a serializer might be a bit overkill. Appreciate the suggestions."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510738038, "post_id": 47300771, "comment_id": 81558001, "body": "Unfortunately only the actual number of bytes of data must be sent. So the data length will be 16 most of the time sometimes it could be 1 byte, and 1 byte only must be sent, in addition to the  constant frame overhead."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510739699, "post_id": 47300771, "comment_id": 81559052, "body": "Ok, but somewhere you&#39;ll know how much bytes are sent - so if the number &lt; 16 pad the rest with 0"}, {"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510741531, "post_id": 47300771, "comment_id": 81560201, "body": "I can&#39;t pad with 0s. I must send only the number of bytes, without padding."}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 0, "last_activity_date": 1510727340, "creation_date": 1510727340, "answer_id": 47300771, "question_id": 47300650, "link": "https://stackoverflow.com/questions/47300650/convert-struct-with-pointer-to-char-array/47300771#47300771", "title": "Convert struct with pointer to char array", "body": "<blockquote>\n  <p>I am trying to find the simplest way to convert the struct to an array of unsigned chars without copying out each entry in the struct to the array but don't seem to be able to find a way.</p>\n</blockquote>\n\n<p>If <code>data</code> would contain up to 16 bytes, I would just declare it as 16-char array, like so: </p>\n\n<pre><code>#define MAX_DATA_LEN 16\nstruct {\n    unsigned char header;\n    unsigned char msgSizeL;\n    unsigned char msgSizeH;\n    unsigned char data[MAX_DATA_LEN]; // 16-char array instead of pointer\n    unsigned char checksum;\n    ....\n    ....\n    ....\n    ....\n    unsinged char endFrame;\n} Frame;\n</code></pre>\n\n<p>If this is done, then all your data inside this struct has a pre-defined size (i.e. number of <code>unsigned char * sizeof(unsigned char)</code>, and so on with other data types...) and you can use simple <code>memcpy</code> to copy the struct to an array:</p>\n\n<pre><code>size_t struct_len = /* computing the length of the data */ 100;\nmemcpy(frame, struct Frame, struct_len);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "edited": false, "score": 0, "creation_date": 1510738328, "post_id": 47301018, "comment_id": 81558194, "body": "The dynamic frame length suggestion would work. This keeps the struct and doesn&#39;t make the struct to array conversion too messy.  The static frame length is out as i must transmit only the number of bytes available and not pad the size out with trailing 0s. Appreciate your response!"}], "tags": [], "owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "is_accepted": false, "score": 0, "last_activity_date": 1510728432, "creation_date": 1510728432, "answer_id": 47301018, "question_id": 47300650, "link": "https://stackoverflow.com/questions/47300650/convert-struct-with-pointer-to-char-array/47301018#47301018", "title": "Convert struct with pointer to char array", "body": "<p>You have two options: </p>\n\n<p><strong>1. dynamic frame length</strong></p>\n\n<pre><code>struct {\n    unsigned char header;\n    unsigned char msgSizeL; // this will be dynamic from 0x06 (empty) to 0x16 (full)\n    unsigned char msgSizeH; // this will be always 0x00\n    unsigned char dataSize; // specify the data size here\n    unsigned char data[16]; // use a static memory area for the package\n    unsigned char checksum;\n    unsigned char endFrame;\n} Frame;\n</code></pre>\n\n<p>then you can do this:</p>\n\n<pre><code>Frame xFrame;\nunsigned char ucaData[17] = {0}; // your data \nunsigned int uiDataLength = 6; // for example\nmemset(&amp;xFrame, 0, sizeof(Frame)); // just to be sure\nxFrame.header = 0x01;\nxFrame.msgSizeL = uiDataLength;\nxFrame.msgSizeH = 0;\nxFrame.dataSize = uiDataLength;\nmemcpy(xFrame.data, ucaData, uiDataLength);\nxFrame.checksum = CRC8(&amp;xFrame, uiDataLength + 4); // crc for filled area\nxFrame.endFrame = 0xFF;\n</code></pre>\n\n<p>then when building the package:</p>\n\n<pre><code>unsigned char xDataFrame[1000];\nmemcpy(xDataFrame, xFrame, 4 + uiDataLength);\nmemcpy(xDataFrame + 4 + uiDataLength, &amp;xFrame + 20, 2);\ntransmit(xDataFrame, 6 + uiDataLength);\n</code></pre>\n\n<p>This way, you will discard empty bytes from sending and from calculating checksum for.</p>\n\n<p><strong>2. static frame length</strong></p>\n\n<p>Then you can use a struct like this:</p>\n\n<pre><code>struct {\n    unsigned char header;\n    unsigned char msgSizeL; // this will be always 0x16 (22)\n    unsigned char msgSizeH; // this will be always 0x00\n    unsigned char dataSize; // specify the data size here\n    unsigned char data[16]; // use a static memory area for the package\n    unsigned char checksum;\n    unsigned char endFrame;\n} Frame;\n</code></pre>\n\n<p>This way you can calculate the checksum for the first 20 bytes of this structure, but be aware of that this structure may contain padding areas which may move your data around the defined and padded memory area. <code>sizeof(Frame)</code> may be calculated by hand as 22 bytes but the compiler may decide that it should use 32 bytes or 24 bytes of memory related with the <code>pack</code> setting. You may use </p>\n\n<pre><code>#pragma pack(1) // disable padding\n[structure code]\n#pragma pack()  // back to the original setting\n</code></pre>\n\n<p>More info about packing: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/3318410/pragma-pack-effect\">#pragma pack effect</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8943033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeaed482942b1d8f24c86484f4fd92a?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Davy", "link": "https://stackoverflow.com/users/8943033/shaun-davy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 847, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510728432, "creation_date": 1510726810, "question_id": 47300650, "link": "https://stackoverflow.com/questions/47300650/convert-struct-with-pointer-to-char-array", "title": "Convert struct with pointer to char array", "body": "<p>I am currently trying to find the simplest way to convert a struct which contains a char * to a char array for transmitting a serial data frame.</p>\n\n<p>The struct stores the frame headers, checksum, msg size etc along with the data to be transmit. eg</p>\n\n<pre><code>struct {\n    unsigned char header;\n    unsigned char msgSizeL;\n    unsigned char msgSizeH;\n    unsigned char *data;\n    unsigned char checksum;\n    ....\n    ....\n    ....\n    ....\n    unsinged char endFrame;\n} Frame;\n</code></pre>\n\n<p>The data is a pointer as the amount of data can change with each frame transmit in the range from 1 to 16 bytes.</p>\n\n<p>I am trying to find the simplest way to convert the struct to an array of unsigned chars without copying out each entry in the struct to the array but don't seem to be able to find a way.</p>\n\n<p>Alternately I don't have to use a struct, as i am generating the frame contents excluding the data contents from scratch, I just want to avoid a case of -</p>\n\n<pre><code>unsigned char frame[1000];\nframe[0] = 0x01; // header\nframe[1] = msgSizeL; // msg size low byte\nframe[2] = msgSizeH; // msg size high byte\nframe[3] = data[0]; // data contents 0    Over simplification\nframe[4] = data[1]; // data contents 1    for data copying - \nframe[5] = data[2]; // data contents 2    data length is variable.\nframe[6] = data[3]; // data contents 3\nframe[7] = data[4]; // data contents 4\nframe[8] = data[5]; // data contents 5\nframe[9] = data[6]; // data contents 6\nframe[10] = data[7]; // data contents 7\nframe[3 + msgSize]; = getChecksum(data);\n....\n....\n....\n....\nframe [3 + msgSize + 20] = 0xFF; // end frame\n</code></pre>\n\n<p>where i write data to what reads as a random array index rather than something meaningful like <code>frame.checksum = getChecksum(data);</code>.</p>\n\n<p>Open to suggestions and a little bit of flaming for asking a general question rather than a specific one :-)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1510727357, "post_id": 47300646, "comment_id": 81552401, "body": "You need to put some effort in writing your question. As it stands here nobody understands what you want."}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1510727526, "post_id": 47300646, "comment_id": 81552469, "body": "well i said that we get a number and a string like the string is Zig and the number is 3 the output should be Clj ! for example A (65) + 3(the number) = D(68)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1510728567, "post_id": 47300646, "comment_id": 81552897, "body": "Please show the code which only has the problem of doing the rotation part. I understand that it works as long the letter value is smaller than <code>(&#39;Z&#39;-n)</code> or <code>(&#39;z&#39;-n)</code>."}, {"owner": {"reputation": 3744, "user_id": 4298200, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/photo.jpg?sz=128", "display_name": "Neuron", "link": "https://stackoverflow.com/users/4298200/neuron"}, "edited": false, "score": 2, "creation_date": 1510728569, "post_id": 47300646, "comment_id": 81552899, "body": "please add any relevant information to the question by using the &quot;edit&quot; button. thabks!"}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510729216, "post_id": 47300646, "comment_id": 81553261, "body": "I edited my question take a look at it :))"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510745067, "post_id": 47301227, "comment_id": 81562522, "body": "Do you know a code that shows that there is no difference between capital letters and small letters , I mean if u gives the program w and W it thinks both of them are the same ?"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1510766806, "post_id": 47301227, "comment_id": 81578168, "body": "You could convert all lowercase to uppercase by subtracting 32 and leave the uppercase as is. That way all uppercase letters would represent either itself or it\u2019s lowercase equivalent."}], "tags": [], "owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "is_accepted": false, "score": 0, "last_activity_date": 1510729213, "creation_date": 1510729213, "answer_id": 47301227, "question_id": 47300646, "link": "https://stackoverflow.com/questions/47300646/alphabet-and-code-ascii/47301227#47301227", "title": "Alphabet and code ascii", "body": "<blockquote>\n  <p>I have a problem with the part that it should start from A(for capitals) &amp; a again</p>\n</blockquote>\n\n<p>When you get to Z (decimal 90) you can easily subtract 25 (ASCII char \"EM\") to get back to A (decimal 65). Similarly you can repeat subtraction of 25 when you reach z and it will cycle back to </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510729815, "post_id": 47301289, "comment_id": 81553528, "body": "no cause if u enter your string Zig and  your number 3 it gives u ]lj , it should give back Clj"}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510730019, "post_id": 47301289, "comment_id": 81553617, "body": "yessss it doessss thank you :)) can you describe it please :)"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510730656, "post_id": 47301289, "comment_id": 81553920, "body": "I fixed another bug but it basically just finds the difference that it overflows from &#39;Z&#39; and adds it to &#39;A&#39; creating a loop. p.s please accept my answer if you want lol."}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510730726, "post_id": 47301289, "comment_id": 81553970, "body": "sorry but it still has a small problem , like if the word is capital like N + 20 should be I but it shows b :("}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510731498, "post_id": 47301289, "comment_id": 81554340, "body": "yesss it does :))) can you explain why you put &#39;A&#39; + a[i] - &#39;Z&#39;"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510731815, "post_id": 47301289, "comment_id": 81554503, "body": "It may help to think of the range &#39;A&#39; to &#39;Z&#39; in the ascii table as an array where &#39;A&#39; is the 0th index and &#39;Z&#39; is the last index. Assuming str[i] is greater than the last index (&#39;Z&#39;), you subtract the difference between the two and that gives you how far over the acceptable range you went. All you do then is add that difference that you went over to the 0th index (&#39;A&#39;) in order to simulate a loop. &#39;A&#39; + (str[i] - &#39;Z&#39;) might be a clearer way to show what&#39;s happening"}, {"owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "edited": false, "score": 0, "creation_date": 1510740074, "post_id": 47301289, "comment_id": 81559300, "body": "Do you know a code that shows that there is no difference between capital letters and small letters , I mean if u gives the program w and W it thinks both of them are the same ?"}], "tags": [], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "is_accepted": true, "score": 0, "last_activity_date": 1510730983, "last_edit_date": 1510730983, "creation_date": 1510729495, "answer_id": 47301289, "question_id": 47300646, "link": "https://stackoverflow.com/questions/47300646/alphabet-and-code-ascii/47301289#47301289", "title": "Alphabet and code ascii", "body": "<p>Fixed Bug</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;strings.h&gt;\n\n\nint main(){\n  char str [80];\n  int number;\n\n  printf (\"Enter your string: \");\n  scanf (\"%79s\",str);  \n\n\n  printf (\"Enter your number: \");\n  scanf (\"%d\",&amp;number);\n\n  for(int i= 0; i &lt; strlen(str);i++){\n    str[i]+=number;\n    while(str[i]&gt;'Z' &amp;&amp; str[i] &lt; 'a'){\n        str[i] = 'A'+ str[i] - 'Z';\n    }\n    while(str[i]&gt;'z'){\n        str[i] = 'a'+ str[i] - 'z';\n    }\n  }\n\n  printf(\"%s\",str);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8923788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b23d3aed4456e165afbf6d10793c9dc?s=128&d=identicon&r=PG&f=1", "display_name": "arina sbz", "link": "https://stackoverflow.com/users/8923788/arina-sbz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 47301289, "answer_count": 2, "score": -2, "last_activity_date": 1510730983, "creation_date": 1510726798, "last_edit_date": 1510729288, "question_id": 47300646, "link": "https://stackoverflow.com/questions/47300646/alphabet-and-code-ascii", "title": "Alphabet and code ascii", "body": "<p>I am trying to create a program in c language that gets a number and a string, for example the number is 3 and the string is \"Zig\". \nThe output should be alphabet's codes + the number. If the character's number goes more than \"Z\" (90) it should start from \"A\" again. Similarily, for lower case characters, when going beyond \"z\" start again from \"a\".\ninput  : \"Zig\"<br>\nnumber : 3<br>\noutput : \"Clj\"<br>\nI have a problem with the part that it should start from A(for capitals) &amp; a again.\nthis is my code now ! I have a problem with rotation part how to start from A or a again :)</p>\n\n<pre><code>char a[50];\n\nint n,i;\nprintf(\"enter your number:\\t\");\n\nscanf(\"%d\",&amp;n);\nprintf(\"enter your string:\\t\");\n\nfflush(stdin);\n\ngets(a);\n\nwhile('A'&lt;= a[i] &lt;= 'Z'){\n    if(a[i]+n &gt; 'Z'){\n\n    }\n    else{\n    a[i]=a[i]+n;\n}\ni++;\n}\nwhile('a' &lt;= a[i] &lt;= 'z'){\n    if(a[i]+n &gt; 'z'){\n\n}\n    else{\n        a[i]=a[i]+n;\n    }\n    i++;\n}\nprintf(\"string:\\n\");\nputs(a);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "windows", "winapi", "kernel"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510731715, "post_id": 47300622, "comment_id": 81554442, "body": "The names of the bit flags are pretty clear. For instance, surely you can understand what IsWow64Process means."}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510734563, "post_id": 47300622, "comment_id": 81555977, "body": "@DavidHeffernan: Sure if you want me to list those that aren&#39;t clear for me. Here you go: <code>IsProtectedProcess</code>, <code>IsProcessDeleting</code>, <code>IsCrossSessionCreate</code>, <code>IsFrozen</code>, <code>IsBackground</code>, <code>IsStronglyNamed</code>, <code>IsSubsystemProcess</code>. Sorry if I&#39;m the only one who doesn&#39;t know what those mean."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510736098, "post_id": 47300622, "comment_id": 81556884, "body": "Well, <code>IsProtectedProcess</code> identifies a protected process, and so on. It&#39;s plain English. So the next question I suppose is what information you are looking for. And why you feel the answer can be found in this undocumented structure."}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510736567, "post_id": 47300622, "comment_id": 81557157, "body": "@DavidHeffernan: You&#39;re a genius. And <code>IsFrozen</code> defines a frozen process, right?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1510736778, "post_id": 47300622, "comment_id": 81557278, "body": "By jove I think you are getting the hang of this. So, what information are you looking for. Asking for a definition of these 9 distinct process states is far too broad. What specific information are you looking for that led you to this structure?"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1510739446, "post_id": 47300622, "comment_id": 81558883, "body": "Users have minimal access to protected processes; even debug privilege won&#39;t grant full access. Common examples are system processes such as smss.exe, csrss.exe, wininit.exe, and services.exe. A process will be in the deleting state once terminated (but not reaped yet since there&#39;s a handle). A cross-session create is when the parent process is in a different session -- commonly a session 0 service such as the task scheduler. A frozen process is suspended. UWP app packages can run in the background and are strongly named. NT subsystems have a server process, such as csrss.exe (per session)."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510743826, "post_id": 47300622, "comment_id": 81561758, "body": "<code>IsStronglyNamed</code> in my tests have all and only UWP apps, <code>IsFrozen</code> if process suspended (usual some UWP apps running in background, or process stopped under debugger). <code>IsCrossSessionCreate</code> if parent process run in another logon (not terminal) session. <code>IsBackground</code>, <code>IsSecureProcess</code>, <code>IsSubsystemProcess</code> - i never view in test. <code>IsProcessDeleting</code> - process already terminated, but somebody hold reference on it - so process object still exist. <code>IsProtectedProcess</code> - system protected process. <code>IsWow64Process</code> - think clear"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510746187, "post_id": 47300622, "comment_id": 81563232, "body": "@RbMm, when I create a Session 0 process as another user from Session 0, <code>IsCrossSessionCreate</code> is false, so it&#39;s unrelated to the logon session. In my tests, it&#39;s only true when the process is created in another terminal Session. A simple example is <code>psexec -si cmd</code>. Both the parent (psexesvc.exe in Session 0) and the child (cmd.exe in the active console Session) use the same SYSTEM logon session (0x3e7), but <code>IsCrossSessionCreate</code> is true for cmd.exe because it&#39;s in a different terminal Session from the parent."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510746707, "post_id": 47300622, "comment_id": 81563558, "body": "@eryksun - i have another result. <code>IsCrossSessionCreate</code> exactly when parent run in another logon session. say for example when we exec from not elevated (explorer) elevated process. if want you can test with <a href=\"https://www.sendspace.com/file/1mr8gj\" rel=\"nofollow noreferrer\">this</a> - here 2 my utilities. which show <code>PROCESS_EXTENDED_BASIC_INFORMATION</code> for all processes in system(+some additional info). another tool like sysinternal utilit for show logon sessions, but with fixed errors and more info"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510747191, "post_id": 47300622, "comment_id": 81563886, "body": "@eryksun so simplest way got <code>IsCrossSessionCreate</code> - run as admin program from explorer. say notepad or regedit. and it will be have <code>IsCrossSessionCreate</code>"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510747267, "post_id": 47300622, "comment_id": 81563937, "body": "@RbMm, elevating makes a remote procedure call to the Application Information service in Session 0, which calls <code>CreateProcessAsUser</code> and fakes the parent process via <code>PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510747416, "post_id": 47300622, "comment_id": 81564036, "body": "@eryksun - yes, of course. but i mean under parent process not creator, but exactly inherited from process. so creator will be svchost, but inherited from (via PROC_THREAD_ATTRIBUTE_PARENT_PROCESS) however explorer"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510747508, "post_id": 47300622, "comment_id": 81564083, "body": "I take back my comment about <code>IsSubsystemProcess</code> however. I thought that was obviously from the <code>SubsystemProcess</code> in the <code>EPROCESS</code> structure, which is true only for instances of csrss.exe, which makes perfect sense. But I disabled the protection on it; queried <code>PROCESS_EXTENDED_BASIC_INFORMATION</code>; and was surprised to see that <code>IsSubsystemProcess</code> wasn&#39;t set, so I have no idea what this flag means, other than that the name is misleading."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510747910, "post_id": 47300622, "comment_id": 81564320, "body": "@RbMm, but what matters is that the real parent is the Appinfo service in Session 0. It seems the <code>EPROCESS</code> <code>CrossSessionCreate</code> flag is set early on and not affected by <code>PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</code>. ISTM, that&#39;s the only explanation for what I observe otherwise when creating across <i>terminal</i> sessions using the same SYSTEM logon session (ID 0x3e7). If it were just a matter of the logon session, then <code>CrossSessionCreate</code> would be false in those cases."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510748411, "post_id": 47300622, "comment_id": 81564666, "body": "@eryksun - yes, you absolute right and i mistake here. really <code>IsCrossSessionCreate</code> related to terminal sessions. check now this (create notepad in 0 session from elevated tool). both processes run in same logon session, but in different terminal (0 and 1) and notepad have <code>IsCrossSessionCreate</code> set"}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510766397, "post_id": 47300622, "comment_id": 81577933, "body": "Thank you, @RbMm and eryksun for the info. That&#39;s an interesting discussion."}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510855142, "post_id": 47300622, "comment_id": 81624146, "body": "@eryksun: I&#39;m curious, guys, is <code>IsProtectedProcess</code> bit the same what is returned by <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms687420(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ZwQueryInformationProcess(ProcessBreakOnTermination)</a> call or a newer <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dn386160(v=vs.85).aspx\" rel=\"nofollow noreferrer\">IsProcessCritical()</a> API?"}], "answers": [{"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1511106965, "post_id": 47347441, "comment_id": 81709786, "body": "Protected processes were <a href=\"https://technet.microsoft.com/en-us/library/46ed60f1-e02c-48db-9eba-eddbd106d54f\" rel=\"nofollow noreferrer\">added in Vista</a> as a way to restrict access that even the debug privilege can&#39;t sidestep. The system was extended to Protected Light processes (PPL) in Windows 8, which introduces signer levels of protection: None, Authenticode, CodeGen, Antimalware, Lsa, Windows, WinTcb, WinSystem, and App. Generally a process running at a higher signer level dominates a process at a lower level. A protected process also restricts DLL loading based on the process <code>SignatureLevel</code>."}], "tags": [], "owner": {"reputation": 14722, "user_id": 670017, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/14e34b1f97f25732aad207e006497f90?s=128&d=identicon&r=PG", "display_name": "ahmd0", "link": "https://stackoverflow.com/users/670017/ahmd0"}, "is_accepted": false, "score": 2, "last_activity_date": 1510911491, "creation_date": 1510911491, "answer_id": 47347441, "question_id": 47300622, "link": "https://stackoverflow.com/questions/47300622/meaning-of-flags-in-process-extended-basic-information-struct/47347441#47347441", "title": "Meaning of flags in PROCESS_EXTENDED_BASIC_INFORMATION struct?", "body": "<p>The following is a <em>highly undocumented</em> stuff that Microsoft probably doesn't want you to use. Do so at your own risk.</p>\n\n<p><em>PS. But, you actually had an interesting question. So just for general education:</em></p>\n\n<ul>\n<li><p><strong>IsProtectedProcess</strong> (0x001) System protected process: other processes can't read/write its VM or inject a remote thread into it. (Old style. If I'm not mistaking, it was available since XP SP3.)</p></li>\n<li><p><strong>IsWow64Process</strong> (0x002) <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684139(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WOW64</a> process, or 32-bit process running on a 64-bit Windows.</p></li>\n<li><p><strong>IsProcessDeleting</strong> (0x004) Process was terminated, but there're open handles to it -- a very transient stage. <em>(That should be of any interest to you only if you're a kernel driver.)</em></p></li>\n<li><p><strong>IsCrossSessionCreate</strong> (0x008) Process was created across terminal sessions. <em>Ex: Read <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682429(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CreateProcessAsUser</a> for details.</em></p></li>\n<li><p><strong>IsFrozen</strong> (0x010) <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh448383(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Immersive process</a> is suspended (applies only to UWP processes.) For example, Immersive process can be suspended if a user moves it to the background or minimizes it. Used mostly for power saving. <a href=\"https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/optimize-suspend-resume#suspend\" rel=\"nofollow noreferrer\">More info</a>.</p></li>\n<li><p><strong>IsBackground</strong> (0x020) Immersive process is in the Background task mode. UWP process may temporarily switch into performing a <a href=\"https://docs.microsoft.com/en-us/windows/uwp/launch-resume/guidelines-for-background-tasks\" rel=\"nofollow noreferrer\">background task</a>. Used mostly for power saving.</p></li>\n<li><p><strong>IsStronglyNamed</strong> (0x040) UWP Strongly named process. The UWP package is digitally signed. Any modifications to files inside the package can be tracked. <em>This usually means that if the package signature is broken the UWP app will not start.</em></p></li>\n<li><p><strong>IsSecureProcess</strong> (0x080) <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/mt809132%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Isolated User Mode</a> process -- new security mode in Windows 10, with more stringent restrictions on what can \"tap\" into this process.</p></li>\n<li><p><strong>IsSubsystemProcess</strong> (0x100) Set when the type of the process subsystem is other than Win32 (like *NIX, such as Ubuntu.) Yes, you read it right, you can <a href=\"https://msdn.microsoft.com/en-us/commandline/wsl/about\" rel=\"nofollow noreferrer\">run Linux</a> natively on Windows 10. (<a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff559960(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Ref1</a>, <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/mt805892(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Ref2</a>.)</p></li>\n</ul>\n\n<p><em>PS2. I'm open for corrections, if any ...</em></p>\n"}], "owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510911491, "creation_date": 1510726681, "question_id": 47300622, "link": "https://stackoverflow.com/questions/47300622/meaning-of-flags-in-process-extended-basic-information-struct", "title": "Meaning of flags in PROCESS_EXTENDED_BASIC_INFORMATION struct?", "body": "<p>Can someone explain what all those bits stand for in <code>PROCESS_EXTENDED_BASIC_INFORMATION</code>?</p>\n\n<pre><code>typedef struct _PROCESS_EXTENDED_BASIC_INFORMATION {\n    SIZE_T Size;    // Ignored as input, written with structure size on output\n    PROCESS_BASIC_INFORMATION BasicInfo;\n    union {\n        ULONG Flags;\n        struct {\n            ULONG IsProtectedProcess : 1;\n            ULONG IsWow64Process : 1;\n            ULONG IsProcessDeleting : 1;\n            ULONG IsCrossSessionCreate : 1;\n            ULONG IsFrozen : 1;\n            ULONG IsBackground : 1;\n            ULONG IsStronglyNamed : 1;\n            ULONG IsSecureProcess : 1;\n            ULONG IsSubsystemProcess : 1;\n            ULONG SpareBits : 23;\n        } DUMMYSTRUCTNAME;\n    } DUMMYUNIONNAME;\n} PROCESS_EXTENDED_BASIC_INFORMATION, *PPROCESS_EXTENDED_BASIC_INFORMATION;\n</code></pre>\n\n<p>Microsoft showed this <code>struct</code> in <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/mt809132%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">this article</a> but gave no explanation for what those flags stand for.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 331, "user_id": 8902785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B1H0GeRlI4c/AAAAAAAAAAI/AAAAAAAABZY/qiTZOYLEe-0/photo.jpg?sz=128", "display_name": "Elad Hazan", "link": "https://stackoverflow.com/users/8902785/elad-hazan"}, "edited": false, "score": 0, "creation_date": 1510725830, "post_id": 47300370, "comment_id": 81551760, "body": "p2 is p1&#39;s child and p3 is p2&#39;s child but no connection between p1 and p3...  that&#39;s your problem with this implementation"}, {"owner": {"reputation": 64, "user_id": 8920003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889142c973666044a866a4a622737865?s=128&d=identicon&r=PG&f=1", "display_name": "r3dr4bb1t", "link": "https://stackoverflow.com/users/8920003/r3dr4bb1t"}, "reply_to_user": {"reputation": 331, "user_id": 8902785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B1H0GeRlI4c/AAAAAAAAAAI/AAAAAAAABZY/qiTZOYLEe-0/photo.jpg?sz=128", "display_name": "Elad Hazan", "link": "https://stackoverflow.com/users/8902785/elad-hazan"}, "edited": false, "score": 0, "creation_date": 1510725959, "post_id": 47300370, "comment_id": 81551815, "body": "no i added p3&#39;s next as p1&#39;s pid.(next=granmaduh) so when p3 is about to send signal, it will send to p1 isnt&#39;t it?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1510743960, "post_id": 47300370, "comment_id": 81561842, "body": "Deja-vu.  Use three named semaphores."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 8902785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B1H0GeRlI4c/AAAAAAAAAAI/AAAAAAAABZY/qiTZOYLEe-0/photo.jpg?sz=128", "display_name": "Elad Hazan", "link": "https://stackoverflow.com/users/8902785/elad-hazan"}, "edited": false, "score": 0, "creation_date": 1510729920, "post_id": 47301378, "comment_id": 81553582, "body": "It&#39;s an infrastructure 3 inter process communication - hope you can continue from here"}], "tags": [], "owner": {"reputation": 331, "user_id": 8902785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B1H0GeRlI4c/AAAAAAAAAAI/AAAAAAAABZY/qiTZOYLEe-0/photo.jpg?sz=128", "display_name": "Elad Hazan", "link": "https://stackoverflow.com/users/8902785/elad-hazan"}, "is_accepted": false, "score": 0, "last_activity_date": 1510729836, "creation_date": 1510729836, "answer_id": 47301378, "question_id": 47300370, "link": "https://stackoverflow.com/questions/47300370/how-to-send-a-synchronized-signal-among-three-processes-in-c/47301378#47301378", "title": "How to send a synchronized signal among three processes in C", "body": "<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\nstatic void signal_handler(int);\nint i, pid1, pid2,pid3, status;\n\nint main( int argc, char *argv[], char *env[] )\n{\n    int exit_status;\n\n    if( signal( SIGUSR1, signal_handler) == SIG_ERR  )\n    {\n        printf(\"P\u00e6rent: Unable to create handler for SIGUSR1\\n\");\n    }\n\n    // if( signal( SIGUSR2, signal_handler) == SIG_ERR  )\n    // {\n    //     printf(\"P\u00e6rent: Unable to create handler for SIGUSR2\\n\");\n    // }\n\n    printf( \"Parent pid = %d\\n\", pid1=getpid() );\n\n    if( (pid2 = fork()) == 0 )\n    {\n        printf( \"Child pid = %d\\n\", getpid() );\n        //printf( \"Child: %d sending parent SIGUSR1\\n\", getpid() ); //kill( pid1, SIGUSR1 );\n\n         if( (pid3 = fork()) == 0 )\n        {\n        printf( \"GranChild pid = %d\\n\", getpid() );\n        printf( \"Child: %d sending parent SIGUSR1\\n\", getpid() ); kill( pid2, SIGUSR1 );\n        }\n        for( ;; ); /* loop forever */\n\n    }\n    else\n    {\n        /* \n         * This waits for ANY child to die.  It doesn't matter if the child\n         * dies normally or from a signal.  The satus information is then\n         * stored in the status integer.\n         *\n         * If you want to wait on a particular process use waitpid():\n         *      waitpid( childPID, &amp;status, 0 );\n         * is the common usage.\n         *\n         * Solaris acts weirdly when a signal is given to the parent process.\n         * Therefore we place the wait() inside a while loop so that wait()\n         * will not return before the child has died.\n         */\n         /*   while( (wait( &amp;status ) == -1) &amp;&amp; (errno == EINTR) ) {} */\n\n        wait(&amp;status);\n\n        /*\n         * The information in status is *NOT* the return code!!  To make use\n         * of the information we must macros to extract the needed\n         * information.\n         */\n\n        /* WIFEXITED() determines if the process exited normally (returned a\n         * number).  This can be done through a return or exit()\n         */\n\n        if( WIFEXITED( status ) )\n        {\n            /* \n             * Now we know the process exited properly so we can get the\n             * return value\n             *\n             * Note that WEXITSTATUS only retuns the lower 8 bits!  That means\n             * that if we ever expect a negative number then we have to count\n             * the 8th bit as a sign bit.\n             */\n\n            exit_status = WEXITSTATUS( status );\n\n            /* \n             * Since we expect negative numbers...\n             *\n             * If the exit_status is greater than 2^7 (128), th\u00e6n the eigth bit\n             * is a 1, so we subtract 2^8 (256) from it to make it look like \n             * a negative number.\n             */\n            if( exit_status &gt; 128 )\n            {\n                exit_status -= 256;\n            }\n\n            printf( \"Child return - %d\\n\", WEXITSTATUS( status ) );\n        }\n        else\n        {\n            /* Well it didn't exit properly.  Was it a signal? */\n            if( WIFSIGNALED( status ) )\n            {\n                /* \n                 * Yes. A signal killed the child process.  Now we can extract\n                 * the signal information from status\n                 */\n\n                printf( \"Child died on signal - %d\\n\", WTERMSIG( status ));\n            }\n        }\n\n        /* \n         * There are two other macros most UNIXes use.  They are:\n         *  WIFSTOPPED() and WSTOPSIG().  See the man pages on the dells for\n         *  more information.\n         *\n         *  To wait on a particular pid - see waitpid()\n         */\n    }\n\n    return 0;\n}\n\nstatic void signal_handler(int signo)\n{\n\n    /* signo contains the signal number that was received */\n    switch( signo )\n    {\n        /* Signal is a SIGUSR1 */\n        case SIGUSR1:\n            printf( \"Process %d: received SIGUSR1 \\n\", getpid() );\n            if(pid1==getpid()) /* it is the parent */\n            {\n                  printf( \"Process %d is passing SIGUSR1 to %d...\\n\", getpid(),pid2 );\n                  kill( pid2, SIGUSR1 );\n            }\n            else if(pid2==getpid()) /* it is the child */\n            {\n                    printf( \"Process %d is passing SIGUSR2 to itself...\\n\", getpid());\n                    kill(getpid(), SIGUSR2);\n            }\n            else\n            {\n              printf( \"Process %d is passing SIGUSR2 to itself...\\n\", getpid());\n                    kill(pid3, SIGUSR2);\n            }\n\n            break;\n\n        /*  It's a SIGUSR2 */\n        case SIGUSR2:\n            printf( \"Process %d: received SIGUSR2 \\n\", getpid() );\n            if(pid1==getpid())\n            {\n                  printf( \"Process %d is passing SIGUSR2 to %d...\\n\", getpid(),pid2 );\n                  kill( pid2, SIGUSR2 );\n            }\n            else if(pid2==getpid())/* it is the child */\n            {\n                     printf( \"Process %d is passing SIGUSR2 to %d...\\n\", getpid(),pid3 );\n                    kill(pid3, SIGINT);\n            }\n            else /* it is the child */\n            {\n                     printf( \"Process %d is passing SIGUSR2 to %d...\\n\", getpid() );\n                    kill(getpid(), SIGINT);\n            }\n            break;\n\n        default:\n                break;\n    }\n\n    return;\n}\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 8920003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889142c973666044a866a4a622737865?s=128&d=identicon&r=PG&f=1", "display_name": "r3dr4bb1t", "link": "https://stackoverflow.com/users/8920003/r3dr4bb1t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1510729836, "creation_date": 1510725544, "question_id": 47300370, "link": "https://stackoverflow.com/questions/47300370/how-to-send-a-synchronized-signal-among-three-processes-in-c", "title": "How to send a synchronized signal among three processes in C", "body": "<p>I have to send signal p1 -> p2 -> p3 ->p1 ... in order to change the value of shared file. however p3 -> p1 is not working(p1 doesn't catch the signal). I put sleep to make time difference between each transition but idk what's wrong. </p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;setjmp.h&gt;\nvoid sig_usr (int signo)\n{\n        printf(\"%d\\n\",getpid());\n//      longjmp(jumpbuffer,1);\n}\n\nint main(int argc, char **argv)\n{\n        signal(SIGUSR1, sig_usr);\n        jmp_buf jumpbuffer;\n        pid_t next,ppid,granmaduh;\n        granmaduh = getpid();\n        if ((next = fork()) &lt;0 )\n        { \n                        fprintf(stderr, \"fork() error\");\n                        exit(1);\n         }\n        else if (next == 0  )\n        {\n\n                next = fork();\n                if (next &gt;0)\n                {\n\n                        sleep(6);\n                }\n                else \n                {\n                        next = granmaduh;       \n                        sleep(10);\n                }\n        }\n        sleep(2);\n        printf(\"%d\\n\",next);\n        //setjmp(jumpbuffer);\n\n\n        kill(next, SIGUSR1);\n        exit(1);\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 1, "last_activity_date": 1510726318, "last_edit_date": 1510726318, "creation_date": 1510725953, "answer_id": 47300451, "question_id": 47300202, "link": "https://stackoverflow.com/questions/47300202/confusing-documentation-of-flock2/47300451#47300451", "title": "Confusing documentation of flock(2)", "body": "<p><em>treated independently by <code>flock()</code></em> means that <code>flock()</code> will not \"ask\" one descriptor, when attempting to modify the other. However, it doesn't mean they are truly independent. If <code>flock()</code> tries to lock one, while the other is already locked, this attempt may block.</p>\n\n<p>Think of it as 2-levels mechanism. <code>flock()</code> looks at only one descriptor at a time, but eventually, upon the lock attempt, the system tries to move to the dipper level and actually lock, and there the problem occurs.</p>\n\n<blockquote>\n  <p>Also if I unlock one of the descriptor, would other descriptors unlock as well?</p>\n</blockquote>\n\n<p>I'm not sure. This quote (below) states that this indeed is the case if a file has multiple descriptors from <code>fork(2), dup(2)</code>. However there is nothing that says so in the 2nd paragraph that treats multiple <code>open(2)</code> which leads me to believe that it is just not a good thing to do :)</p>\n\n<p>From <a href=\"http://man7.org/linux/man-pages/man2/flock.2.html\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>Locks created by flock() are associated with an open file description\n         (see open(2)).  This means that duplicate file descriptors (created\n         by, for example, fork(2) or dup(2)) refer to the same lock, and this\n         lock may be modified or released <strong>using any</strong> of these file descriptors.\n         Furthermore, the lock is released either by an explicit LOCK_UN\n         operation on any of these duplicate file descriptors, or when all\n         such file descriptors have been closed.</p>\n  \n  <p>If a process uses open(2) (or similar) to obtain more than one file\n         descriptor for the same file, these file descriptors are treated\n         independently by flock().  An attempt to lock the file using one of\n         these file descriptors may be denied by a lock that the calling\n         process has already placed via another file descriptor.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1510734142, "creation_date": 1510734142, "answer_id": 47302506, "question_id": 47300202, "link": "https://stackoverflow.com/questions/47300202/confusing-documentation-of-flock2/47302506#47302506", "title": "Confusing documentation of flock(2)", "body": "<p>Suppose your process has two file descriptors, <code>fd1</code> and <code>fd2</code>, that operate on the same file.  If you lock a segment of the file on <code>fd1</code>, and then lock another overlapping segment also on <code>fd1</code>, the two locks won't interfere with each other because they're on the same file descriptor.</p>\n\n<p>However, if the second lock was applied on <code>fd2</code> instead of <code>fd1</code>, then the locks would be overlapping and the second lock would be deemed to interfere with first and would fail, despite the fact that it is the same process doing the locking.</p>\n\n<p>This is the sense in which the locks on the file descriptors are independent of each other \u2014 the locking system doesn't check which process owns the interfering locks on a different file descriptor; it is sufficient that it is not the current file descriptor.</p>\n\n<p>When you unlock one descriptor, you don't change the locks on any other file descriptor.</p>\n"}], "owner": {"reputation": 177, "user_id": 3773184, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/07d10d146becc8e35b3a284b49038c60?s=128&d=identicon&r=PG&f=1", "display_name": "silverwen", "link": "https://stackoverflow.com/users/3773184/silverwen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510734142, "creation_date": 1510724641, "question_id": 47300202, "link": "https://stackoverflow.com/questions/47300202/confusing-documentation-of-flock2", "title": "Confusing documentation of flock(2)", "body": "<blockquote>\n  <p>If a process uses open(2) (or similar) to obtain more than one\n  descriptor for the same file, these descriptors are treated\n  independently by flock(). An attempt to lock the file using one of\n  these file descriptors may be denied by a lock that the calling\n  process has already placed via another descriptor.</p>\n</blockquote>\n\n<p>If <strong>flock()</strong> treats the descriptors independently, why locking the file using one of the file descriptors would be denied by a lock placed via another descriptor? What does <em>independent</em> here mean?</p>\n\n<p>Also if I unlock one of the descriptor, would other descriptors unlock as well?</p>\n"}]