[{"tags": ["c", "arrays", "loops", "segmentation-fault", "quicksort"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1462406126, "post_id": 37040048, "comment_id": 61629859, "body": "Did you use a debugger to determine which line is failing?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1462406571, "post_id": 37040048, "comment_id": 61629957, "body": "There&#39;s a comment in the code that says where the segfault occurs. What OP doesn&#39;t seem to know is that the array <code>a[end]</code> doesn&#39;t increase in size as <code>end</code> is increased."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1462406644, "post_id": 37040048, "comment_id": 61629973, "body": "<code>end+1-end</code> is <code>1</code>. Are you sure this is what you want?"}, {"owner": {"reputation": 11, "user_id": 5657246, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065807583451415/picture?type=large", "display_name": "Daniel Wasserlauf", "link": "https://stackoverflow.com/users/5657246/daniel-wasserlauf"}, "edited": false, "score": 0, "creation_date": 1462407064, "post_id": 37040048, "comment_id": 61630081, "body": "I just changed it, it doesnt do anything nor should it i think because its just the range of numbers im placing into the array not doing anything with accessing memory locations"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5657246, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065807583451415/picture?type=large", "display_name": "Daniel Wasserlauf", "link": "https://stackoverflow.com/users/5657246/daniel-wasserlauf"}, "edited": false, "score": 1, "creation_date": 1462406927, "post_id": 37040168, "comment_id": 61630046, "body": "they are modified at the end before the last bracket where i modify end+=500"}], "tags": [], "owner": {"reputation": 26, "user_id": 6293264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e794f2778108c1801476f61252018?s=128&d=identicon&r=PG&f=1", "display_name": "rwaeng", "link": "https://stackoverflow.com/users/6293264/rwaeng"}, "is_accepted": false, "score": 0, "last_activity_date": 1462406814, "creation_date": 1462406814, "answer_id": 37040168, "question_id": 37040048, "link": "https://stackoverflow.com/questions/37040048/segmentation-fault-loop-c99/37040168#37040168", "title": "Segmentation Fault Loop C99", "body": "<p>Your outer <code>while</code> loop never exits because you never modify the values of <code>end</code> or <code>final</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "is_accepted": true, "score": 2, "last_activity_date": 1462406941, "creation_date": 1462406941, "answer_id": 37040189, "question_id": 37040048, "link": "https://stackoverflow.com/questions/37040048/segmentation-fault-loop-c99/37040189#37040189", "title": "Segmentation Fault Loop C99", "body": "<p>This line: </p>\n\n<pre><code>int a[end]\n</code></pre>\n\n<p>creates an array of 500 ints (end is set to 500 in the line before)</p>\n\n<p>This line</p>\n\n<pre><code>a[beginning]=rand()%(end+1-end)+end;\n</code></pre>\n\n<p>writes to <code>a[beginning]</code> which is OK as long as <code>beginning</code> is less than 500.</p>\n\n<p>This seems to be checked by this line just above:</p>\n\n<pre><code>while(beginning&lt;end)\n</code></pre>\n\n<p>but later on in your code, you have:</p>\n\n<pre><code>end+=500;\n</code></pre>\n\n<p>so suddenly, end can be > 500, which means beginning can be > 500. Which means you write outside your array boundaries.</p>\n\n<p>One fix would be to change your declaration so that <code>a</code> is big enough:</p>\n\n<pre><code>int a[final]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5657246, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065807583451415/picture?type=large", "display_name": "Daniel Wasserlauf", "link": "https://stackoverflow.com/users/5657246/daniel-wasserlauf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 37040189, "answer_count": 2, "score": 0, "last_activity_date": 1462422891, "creation_date": 1462406083, "last_edit_date": 1462422891, "question_id": 37040048, "link": "https://stackoverflow.com/questions/37040048/segmentation-fault-loop-c99", "title": "Segmentation Fault Loop C99", "body": "<p>This code is a part of a much larger program. There is a <code>main</code> function within the code and it runs fine, sorry if its messy. Within the function <code>Quick_mode_time</code> in the second <code>while</code> loop I get a segmentation error, and I dont understand how I'm messing the array up to cause this. If someone could point me in the right direction I would be very happy! </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define timing_start() start = clock();\n#define timing_end(f) msec = (double)(clock()-start) * 1000000.0 /CLOCKS_PER_SEC; \\\n    printf(\"Calling \"#f \" takes %10.2f microseconds!\\n\", msec);\n\nvoid Quick_mode_time()\n{\n    srand(time(NULL));\n    int end=500,final=5000;\n    int a[end],beginning=0;\n    double t1,t2,t_tot;\n    printf(\"***************COMPARISON***************\\n\");\n\n    printf(\"                quicksort       bubblesort      (in microseconds)\\n\");\n    while(end!=final){\n\n        while(beginning&lt;end)\n        {\n            a[beginning]=rand()%end;  // &lt;--- This causes a segmentation fault\n            beginning++;\n        }\n        printf(\"N=%d\",end);\n\n        t1=clock();\n        quicksort_time(a,0,end);\n\n        t2=clock();\n        t_tot= (double)(t2-t1)*1000/CLOCKS_PER_SEC;\n        printf(\"\\t%7.3f\\t\", t_tot);\n        end+=500;\n    }\n}\n\nvoid quicksort_time(int x[],int first,int last){\n    int pivot,j,temp,i;\n    // The Quick Sorting algorithim is below!\n    if(first&lt;last){\n        pivot=first;\n        i=first;\n        j=last;\n\n        while(i&lt;j){\n            while(x[i]&lt;=x[pivot]&amp;&amp;i&lt;last)\n                i++;\n            while(x[j]&gt;x[pivot])\n                j--;\n            if(i&lt;j){\n                temp=x[i];\n                x[i]=x[j];\n                x[j]=temp;\n            }\n        }\n\n        temp=x[pivot];\n        x[pivot]=x[j];\n        x[j]=temp;\n        quicksort_time(x,first,j-1);\n        quicksort_time(x,j+1,last);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "caching", "memory", "arm"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462412931, "post_id": 37040006, "comment_id": 61631485, "body": "If you&#39;re always going to use column-major order, consider whether you can treat columns as rows and rows as columns by reversing the sense of array indices \u2014 where you had <code>A[row][col]</code>, use <code>A[col][row]</code>.  That gives you the caching benefit of accessing the data in memory sequence.  It is not something to undertake lightly \u2014 measure and test very carefully."}, {"owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462434703, "post_id": 37040006, "comment_id": 61638820, "body": "@JonathanLeffler  Hi Jonathan, Thank you for the reply. But I cannot do so. I have to strictly stay in collumn major access. I can not change the inner equation or the order of the 3 loops or the dimensions of arrays. I can only use prefetch to get the next loop data of A and B of the same column. I know this is kind of odd I am asking. What do you think ?"}, {"owner": {"reputation": 7979, "user_id": 104109, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ef4d8fdadddc19a7314267a649bc10c?s=128&d=identicon&r=PG", "display_name": "BitBank", "link": "https://stackoverflow.com/users/104109/bitbank"}, "edited": false, "score": 0, "creation_date": 1462436140, "post_id": 37040006, "comment_id": 61639569, "body": "Going &quot;against the grain&quot; with your memory access pattern will definitely hurt performance. A better plan would be to prefetch the entire array into cache before it arrives at this code. As written, you&#39;re prefetching won&#39;t help; you need to give a hint to the CPU and then give it time to actually do the reading."}, {"owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "reply_to_user": {"reputation": 7979, "user_id": 104109, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ef4d8fdadddc19a7314267a649bc10c?s=128&d=identicon&r=PG", "display_name": "BitBank", "link": "https://stackoverflow.com/users/104109/bitbank"}, "edited": false, "score": 0, "creation_date": 1462436603, "post_id": 37040006, "comment_id": 61639792, "body": "@BitBank: I tried to prefetch everything before, it was not helpful so much ."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1462453199, "post_id": 37040006, "comment_id": 61649783, "body": "<a href=\"https://gcc.gnu.org/git/?p=gcc.git;a=blob;f=gcc/config/arm/arm.c;h=71b51439dc7ba5be67671e9fb4c3f18040cce58f;hb=HEAD#l3369\" rel=\"nofollow noreferrer\">Try compiler switches</a>.  <a href=\"https://gcc.gnu.org/git/?p=gcc.git;a=blob;f=gcc/config/arm/arm.md;h=47171b99682207226aa4f9a76d4dfb54d6c2814b;hb=HEAD#l10838\" rel=\"nofollow noreferrer\">gcc knows</a> about the <code>PLD</code> instruction and should use it.  You can use compile specific options for a function.  It is not likely to help manually if gcc doesn&#39;t think it will by itself; <code>pld</code> will function best with some unrolling to only issue a <code>pld</code> to fill the cache lines.  Too many <code>pld</code> is harmful."}, {"owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "edited": false, "score": 0, "creation_date": 1462544294, "post_id": 37040006, "comment_id": 61693982, "body": "I receive 7% improvement from PLD. How much maximum speed up can be achieved? any guess."}, {"owner": {"reputation": 1217, "user_id": 1670021, "user_type": "registered", "profile_image": "https://graph.facebook.com/545823017/picture?type=large", "display_name": "Todd Christensen", "link": "https://stackoverflow.com/users/1670021/todd-christensen"}, "edited": false, "score": 0, "creation_date": 1462743122, "post_id": 37040006, "comment_id": 61752151, "body": "It really depends, but if it were me I would try for a little more than 7%.  Since you&#39;re multiplying doubles, memory access may not be the most dominant part of the time... PLD can&#39;t help with time spent in the FP unit.  10-15% might be achievable, as a guess."}, {"owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "reply_to_user": {"reputation": 1217, "user_id": 1670021, "user_type": "registered", "profile_image": "https://graph.facebook.com/545823017/picture?type=large", "display_name": "Todd Christensen", "link": "https://stackoverflow.com/users/1670021/todd-christensen"}, "edited": false, "score": 0, "creation_date": 1462967532, "post_id": 37040006, "comment_id": 61858927, "body": "Thank you @ToddChristensen"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "edited": false, "score": 0, "creation_date": 1462434563, "post_id": 37040837, "comment_id": 61638764, "body": "but I am using ARMv7 processor. Will __builtin_prefetch work there? I think PLD should be the instruction to do so."}, {"owner": {"reputation": 1217, "user_id": 1670021, "user_type": "registered", "profile_image": "https://graph.facebook.com/545823017/picture?type=large", "display_name": "Todd Christensen", "link": "https://stackoverflow.com/users/1670021/todd-christensen"}, "reply_to_user": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "edited": false, "score": 0, "creation_date": 1462461895, "post_id": 37040837, "comment_id": 61655763, "body": "Yes, that&#39;s how you tell gcc/clang to emit that instruction."}], "tags": [], "owner": {"reputation": 1217, "user_id": 1670021, "user_type": "registered", "profile_image": "https://graph.facebook.com/545823017/picture?type=large", "display_name": "Todd Christensen", "link": "https://stackoverflow.com/users/1670021/todd-christensen"}, "is_accepted": false, "score": 4, "last_activity_date": 1462438529, "last_edit_date": 1462438529, "creation_date": 1462411857, "answer_id": 37040837, "question_id": 37040006, "link": "https://stackoverflow.com/questions/37040006/prefetch-in-armv7-in-c/37040837#37040837", "title": "Prefetch in ARMv7 in C", "body": "<p>The preload instruction has its own cost as well.  Typically you want to preload ahead of when you're actually reading, and profile carefully.</p>\n\n<p>That being said, if this is gcc or clang, you're better off using <code>__builtin_prefetch</code> rather than explicit inline asm, as that will compile to a PLD for targets which support it (ARMv5TE and later), but be harmless otherwise.  I found this blog post showing some example real-world usage:</p>\n\n<p><a href=\"http://www.naftaliharris.com/blog/2x-speedup-with-one-line-of-code/\" rel=\"nofollow\">http://www.naftaliharris.com/blog/2x-speedup-with-one-line-of-code/</a></p>\n\n<p>This is also a very helpful link on understanding the usage of PLD:</p>\n\n<p><a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.faqs/ka13544.html\" rel=\"nofollow\">http://infocenter.arm.com/help/topic/com.arm.doc.faqs/ka13544.html</a></p>\n\n<p>Note that this page shows that it can, sometimes, be disadvantageous to use PLD.  My guess is that you won't want to issue it in your inner loop, at least.  You should definitely trial different cases.</p>\n\n<p>Depending on the most common sizes of your matrices, you might also find it beneficial to special-case certain nmax/mmax values.</p>\n"}], "owner": {"reputation": 11, "user_id": 5174379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-26kAbbrKUz0/AAAAAAAAAAI/AAAAAAAABgs/BhsXqQK4fw8/photo.jpg?sz=128", "display_name": "karnajitsen", "link": "https://stackoverflow.com/users/5174379/karnajitsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462438529, "creation_date": 1462405792, "last_edit_date": 1462433714, "question_id": 37040006, "link": "https://stackoverflow.com/questions/37040006/prefetch-in-armv7-in-c", "title": "Prefetch in ARMv7 in C", "body": "<p>I have to implement Khatri Rao product between 2 matrices in C. Mathematically this is a column major access of data and I can not change that. But if I use preload ( PLD instruction in ARMv7 ) to prefetch every next loop data will that solve the problem of performance in stead of using a row major access of data.</p>\n\n<p>If yes how to preload properly?</p>\n\n<p>Please check my preload code below,</p>\n\n<pre><code>void khatrirao_pref(double *C, double *A, double *B,\n                  int nmax, int mmax, int pmax)\n {\n  int i,k,l;\n  for (i=0;i&lt;nmax;i++)\n    {\n    for (k=0;k&lt;mmax;k++)\n      {\n        asm(\"PLD [%0]\\n\\t\" :: \"r\" (A+i+((nmax+1)*k)));       \n      for (l=0;l&lt;pmax;l++)\n    {\n            asm(\"PLD [%0]\\n\\t\" :: \"r\" (B+i+((nmax+1)*l)));\n           C[i+(nmax*((k*pmax)+l))]=A[i+(nmax*k)]*B[i+(nmax*l)];\n    }}}\n }\n</code></pre>\n"}, {"tags": ["c", "text", "binary", "char"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1462405301, "post_id": 37039843, "comment_id": 61629607, "body": "If you have done the extraction correctly then you already have the message characters in the array. Try using <code>%c</code> rather than <code>%x</code> in the <code>printf</code> to display the data as a character."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1462405840, "post_id": 37039843, "comment_id": 61629790, "body": "Returning address of non-static local variable doesn&#39;t seem good because the variable will vanish on returning from the function and dereferencing the address in caller will invoke <i>undefined behavior</i>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1462405994, "post_id": 37039843, "comment_id": 61629827, "body": "@kaylum <code>dMsg[j]</code> will be 0 or 1 in this program and simply changiing <code>%x</code> to <code>%c</code> won&#39;t give what should be wanted."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1462406164, "post_id": 37039843, "comment_id": 61629869, "body": "@MikeCAT I didn&#39;t look at the code in detail because it really is unclear what it is doing. The OP wrote &quot;giving me something such as 00110000&quot; so I was taking that as the intention and thus prefaced my comment with &quot;If you have done the extraction correctly..&quot;. Just trying to point the OP in the right direction with the main point being that the extracted data should already be a valid character if extracted correctly."}, {"owner": {"reputation": 1031, "user_id": 3622460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8011aa4a2c0dce02a11fa0538ee78122?s=128&d=identicon&r=PG&f=1", "display_name": "user3622460", "link": "https://stackoverflow.com/users/3622460/user3622460"}, "edited": false, "score": 0, "creation_date": 1462412106, "post_id": 37039843, "comment_id": 61631272, "body": "The image the embedding program is making is looking pretty good.  Its changing the values I want, I&#39;m just running into issues extracting data from it.  My extractor should be able to just extract the message from the image itself.  Right now I&#39;m popping off LSB and forming a long INT string.  I&#39;m up for any suggestions on how to improve this"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 6269182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fJejV0kRfzE/AAAAAAAAAAI/AAAAAAAADsQ/CGsew1gPlhk/photo.jpg?sz=128", "display_name": "William Gerecke", "link": "https://stackoverflow.com/users/6269182/william-gerecke"}, "is_accepted": false, "score": 1, "last_activity_date": 1462406791, "creation_date": 1462406791, "answer_id": 37040165, "question_id": 37039843, "link": "https://stackoverflow.com/questions/37039843/how-to-convert-lsb-extracted-data-to-text-or-binary-to-text/37040165#37040165", "title": "How to convert LSB extracted data to text or binary to text", "body": "<p>I don't know what you are doing specifically with your file and assigning each bit to a position in an array but you can print binary sequences stored in a <code>unsigned int</code>. Try using something like this...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    unsigned int arr[] = {00110110, 00111100, 10111011};\n    int i = sizeof(arr)/sizeof(arr[0]);\n    while(i--&gt;0) {\n        printf(\"%c, \", arr[i]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1031, "user_id": 3622460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8011aa4a2c0dce02a11fa0538ee78122?s=128&d=identicon&r=PG&f=1", "display_name": "user3622460", "link": "https://stackoverflow.com/users/3622460/user3622460"}, "edited": false, "score": 0, "creation_date": 1462413166, "post_id": 37040178, "comment_id": 61631525, "body": "I have a giant string which is an unsigned char *.  I&#39;m trying to access certain ones and store the LSB of a value into something.  Once I have 8 LSB, this should form a letter.  The idea would be to convert that string to the unsigned char it represented.  However, whenever I attempt to assigned an unsigned char to any value in my unsigned char * string-  it returns blank.  I can assigned an INT to it, but not a char"}, {"owner": {"reputation": 1031, "user_id": 3622460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8011aa4a2c0dce02a11fa0538ee78122?s=128&d=identicon&r=PG&f=1", "display_name": "user3622460", "link": "https://stackoverflow.com/users/3622460/user3622460"}, "edited": false, "score": 0, "creation_date": 1462413350, "post_id": 37040178, "comment_id": 61631555, "body": "basically reading a PPM p3 image-  it has values such as 16 37 29 17 etc.  I stored all of this as an unsigned char*.  I then went and flipped values such as the 37 to say 36 - creating the output 16 36 29 17.  By doing this I stored a piece of my message in the LSB of the second cause 37, making it 36.  My embedding seems to work -  but when I go to extract it those values from the LSBs, I run into an issue of not being able to store these values as anything but an INT.  If I returned out of the function I lose the scope."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 1, "last_activity_date": 1462406895, "creation_date": 1462406895, "answer_id": 37040178, "question_id": 37039843, "link": "https://stackoverflow.com/questions/37039843/how-to-convert-lsb-extracted-data-to-text-or-binary-to-text/37040178#37040178", "title": "How to convert LSB extracted data to text or binary to text", "body": "<p>You can use bit operations to gather these bits into a byte.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BYTE_LENGTH 8\n\n#if 1\n/* MSB is in data[0], LSB is in data[BYTE_LENGTH - 1] */\nint arrayToChar(const int data[]) {\n    int c = 0;\n    int i;\n    for (i = 0; i &lt; BYTE_LENGTH; i++) {\n        if (data[i]) c |= (1 &lt;&lt; (BYTE_LENGTH - 1 - i));\n    }\n    return c;\n}\n#else\n/* LSB is in data[0], MSB is in data[BYTE_LENGTH - 1] */\nint arrayToChar(const int data[]) {\n    int c = 0;\n    int i;\n    for (i = 0; i &lt; BYTE_LENGTH; i++) {\n        if (data[i]) c |= (1 &lt;&lt; i);\n    }\n    return c;\n}\n#endif\n\nint main(void) {\n    int data[8] = {0, 0, 1, 1, 0, 0, 0, 0};\n    int c = arrayToChar(data);\n    printf(\"%d %c\\n\", c, c);\n    return 0;\n}\n</code></pre>\n\n<p>If you want to produce one byte from 7 bits, change <code>BYTE_LENGTH</code> to 7.</p>\n\n<p>If you want to deal with long sequence of bits, apply <code>arrayToChar</code> repeatedly with changing the (address of) first element to be passed.</p>\n"}], "owner": {"reputation": 1031, "user_id": 3622460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8011aa4a2c0dce02a11fa0538ee78122?s=128&d=identicon&r=PG&f=1", "display_name": "user3622460", "link": "https://stackoverflow.com/users/3622460/user3622460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1462411966, "creation_date": 1462404813, "last_edit_date": 1462411966, "question_id": 37039843, "link": "https://stackoverflow.com/questions/37039843/how-to-convert-lsb-extracted-data-to-text-or-binary-to-text", "title": "How to convert LSB extracted data to text or binary to text", "body": "<p>UPDATE***********************\nFor reference I included the program I made for opening a PPM image -  embedding a message into the image and then saving out a new image with the embedded text.  With the function below I'm hoping to extra that message, (hidden in the LSB) and then converting it to text to display it.  Thanks for the replies so far - I'm going to start testing them out and see if anything works.</p>\n\n<hr>\n\n<p>I'm trying to write a function that extracts the LSB of an unsigned char value -  puts them bits together to form an extracted message.  I have the length of how many LSBs I need to extract from the file, but I'm having trouble with how to convert this into a message.</p>\n\n<p>At first I extracted the first 8 bits into an int array - giving me something such as 00110000. Now I have an INT array with that value, and I need to convert it to a single char for the letter representation.  However, I think I should be taking in all of the LSBs into an array that is messageLength * 7 and somehow converting that int array into the text.  It would be giving me the binary represenation of the text before converting.  Maybe theirs a way to convert a long string of 1's and 0's to text?  </p>\n\n<pre><code>unsigned char * extBits(PPMImage *img, int messageLen, unsigned char * decMsg)\n{\n    //int count = 2;\n    int embCount = 0;\n    int deM = messageLen * 7;\n    int count = 0;\n    unsigned char byte;\n//  int mask;\n//  unsigned char update;\n//  unsigned char flipOne = 0x01;  //0x01\n//  unsigned char flipZero = 0xFE;  //0x00\n    unsigned char dMsg[deM];\n    int byteArray[7];\n    int takeByte = 0;\n    unsigned char *extMsg;\n    char c;\n\n    for(int j = 0; j &lt; 7; j++)\n    {\n        if(takeByte == 8)\n        {\n            //first letter extracted\n\n            takeByte = 0;               \n        }\n        //byte = msgOne[j];\n    //  byte = img-&gt;pixel[j];\n        //encMsg[j] = byte;\n        byte = img-&gt;pixel[j];\n        //printf(\"byte: %c\\n\", byte); \n    //  printf(\"byte: %x\\n\", byte); \n        byte &amp;= 1;\n        //printf(\"byte after: %x\\n\", byte); \n        dMsg[j] = byte; \n        byteArray[j] = byte;\n        data[j] = byteArray[j];\n        printf(\"dMsg:%x \", dMsg[j]);        \n    //  printf(\"pixel:%c \\n\", img-&gt;pixel[j]);       \n        embCount++; \n        takeByte++;\n    }\n/*  \n    for(int r=0;r&lt;7;r++)\n    {\n        printf(\"\\n%d\\n\", byteArray[r]);\n    }   \n    printf(\"count: %d\", embCount);\n    printf(\"%s \", dMsg);\n*/\n    return decMsg = dMsg;\n}\n</code></pre>\n\n<p>embedding program*******</p>\n\n<pre><code>//////////////////////////////////////////////////////////////\n/*\n    execute as ./emb -i &lt;img2embed&gt; -i &lt;text file&gt; -o &lt;embedIMG&gt;\n\n*/\n//////////////////////////////////////////////////////////////\n\n\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\n\ntypedef struct {\n    int x, y;\n    unsigned char *pixel;\n} PPMImage;\n\n#define RGB_COMPONENT_COLOR 255\n\nstatic PPMImage *readPPM(const char *filename)\n{\n    FILE * fp;\n    PPMImage *img;\n        int rgb_comp_color;\n    int size = 0;\n    fp = fopen(filename, \"a+\");\n\n    fseek(fp, 0, SEEK_END);\n    size = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n\n    unsigned char *buff;\n    unsigned char stuff[16];\n    int c;\n    int x,y;\n    buff = (unsigned char*) malloc(sizeof(unsigned char)*size +1);\n    memset(buff, '\\0', sizeof(unsigned char)*size+1);\n\n        fgets(stuff, sizeof(stuff), fp);\n\n    if (stuff[0] != 'P' || stuff[1] != '3') {\n    fprintf(stderr, \"Invalid image format (must be 'P3')\\n\");\n    exit(1);\n    }\n\n    //alloc memory form image\n    img = (PPMImage*)malloc(sizeof(PPMImage));\n    if (!img) {\n        fprintf(stderr, \"Unable to allocate memory\\n\");\n        exit(1);\n    }\n\n    c = getc(fp);\n    while (c == '#') {\n        while (getc(fp) != '\\n') ;\n        c = getc(fp);\n    }\n\n    ungetc(c, fp);\n\n    if (fscanf(fp, \"%d %d\", &amp;img-&gt;x, &amp;img-&gt;y) != 2) {\n        fprintf(stderr, \"Invalid image size (error loading '%s')\\n\", filename);\n        exit(1);\n    }\n\n    if (fscanf(fp, \"%d\", &amp;rgb_comp_color) != 1) {\n        fprintf(stderr, \"Invalid rgb component (error loading '%s')\\n\", filename);\n        exit(1);\n    }\n    if (rgb_comp_color!= RGB_COMPONENT_COLOR) {\n        fprintf(stderr, \"'%s' does not have 8-bits components\\n\",filename);\n        exit(1);\n    }\n\n    //printf(\"x: %d y: %d\\n\", img-&gt;x, img-&gt;y);\n\n    unsigned char buffer[1024];\n    memset(buffer,0,1024);  \n    fgets(buffer,1024,fp);\n\n    fread(buff, 1, size, fp);   \n\n    img-&gt;pixel = buff;\n/*  \n    for(int h = 0; h &lt; 20; h++)\n    {\n        printf(\"%c\", buff2[h]);\n\n    }\n\n\n    printf(\"%s\", buff2);\n*/\n    fclose(fp);\n\n    return img;\n\n} \n\nvoid writePPM(const char *filename, unsigned char * img, int x, int y)\n{\n    FILE *fp;\n    //open file for output\n    fp = fopen(filename, \"wb\");\n    if (!fp) {\n        fprintf(stderr, \"Unable to open file '%s'\\n\", filename);\n        exit(1);\n    }\n\n    //write the header file\n    //image format\n    fprintf(fp, \"P3\\n\");\n\n    //comments\n   // fprintf(fp, \"# Created by %s\\n\",CREATOR);\n\n    //image size\n    fprintf(fp, \"%d %d\\n\",x,y);\n\n    // rgb component depth\n    fprintf(fp, \"%d\\n\",RGB_COMPONENT_COLOR);\n\n    // pixel pixel\n    fwrite(img,1, strlen(img), fp);\n    fclose(fp);\n}\n\n//unsigned char * embBits(PPMImage *img, int messageLen, unsigned char*msgOne, unsigned char *encMsg)\nint embBits(PPMImage *img, int messageLen, unsigned char*msgOne, int embLen)\n{\n    //int count = 2;\n    int embCount = 0;\n    int count = 0;\n    unsigned char *eMsg;    \n    unsigned char byte;\n    int mask;\n    unsigned char update;\n    unsigned char flipOne = 0x01;  //0x01\n    unsigned char flipZero = 0xFE;  //0x00\n\n    for(int j = 0; j &lt; messageLen; j++)\n    {\n        byte = msgOne[j];\n        //encMsg[j] = byte;\n\n        for(int k=7; 0 &lt; k; k--)\n        {\n            update = byte;  \n\n            update = update &amp; (1&lt;&lt;k);\n            //printf(\"pixel:%c\\n\", img-&gt;pixel[count]);      \n            //printf(\"pixel+1:%c\\n\", img-&gt;pixel[count+1]);      \n        //  printf(\"pixel+2:%c\\n\", img-&gt;pixel[count+2]);        \n            if(update == 0)\n            {\n                // if i see 1   |=\n                // if i see a 0 &amp;=\n                //img-&gt;pixel[count] = img-&gt;pixel[count] &amp;= flipZero;        \n                img-&gt;pixel[count+2] &amp;= flipZero;        \n            }   \n            else\n            {\n                //flip bit\n                //red\n                    //check LSB and FLIP \n                //  img-&gt;pixel[count] = img-&gt;pixel[count] |= flipOne;       \n                img-&gt;pixel[count+2] |= flipOne;     \n            }       \n\n            //mask--;   \n            //eMsg[count] = img-&gt;pixel[count];\n            //printf(\"count: %d\\n\", count);\n            count = count + 3;\n        }   \n//      eMsg[j] = byte; \n    }\n\n    //return encMsg = eMsg;\n    //unsigned char *yes = \"sucess\";\n    /*\n    for(int a = 0; a &lt; messageLen; a++)\n    {\n        printf(\"pixel: %c\", img-&gt;pixel[a]);     \n        printf(\"msg: %c\\n\", eMsg[a]);       \n    //  eMsg[a] = img-&gt;pixel[a];\n    }\n*/\n\n    embCount = count;   \n    return embLen = embCount;\n}\n\nint main(int argc, char **argv){\n\n    int messageLen;\n    int i = 0; \n    PPMImage *img;\n    int size = 0;\n    FILE * fp;\n    int testSize;\n    fp = fopen(argv[4], \"a+\");\n\n    fseek(fp, 0, SEEK_END);\n    size = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n\n    unsigned char *buff;\n    buff = (unsigned char*) malloc(sizeof(unsigned char)*size +1);\n    memset(buff, '\\0', sizeof(unsigned char)*size+1);\n    fread(buff, 1, size, fp);\n\n    fclose(fp);\n//  printf(\"text encryption: %s\\n\", buff);\n    testSize = strlen(buff);    \n//  printf(\"Size of text %d\\n\", testSize);\n\n    messageLen = strlen(buff); \n\n    img = readPPM(argv[2]);\n/*\n    int testing = strlen(img-&gt;pixel);\n    for (int f=0;f&lt;6;f++)\n    {   \n        //f2 = 1\n        //f3 = 6\n        printf(\"%c\", img-&gt;pixel[f]);            \n    }       \n*/\n\n//  printf(\"%c \\n\", img-&gt;pixel[2]);\n//  printf(\"%c \\n\", img-&gt;pixel[5]);\n    printf(\"\\n\");\n//  unsigned char * encMsg;\n\n    int encMsg = 0;         \n    encMsg = embBits(img, messageLen, buff, encMsg);\n\n//  printf(\"cipher msg:%s\\n\", img-&gt;pixel);\n    printf(\"message length: %d\\n\", messageLen);\n//  printf(\"cipher msg length: %d\\n\", encMsg);\n\n\n    writePPM(argv[6], img-&gt;pixel, img-&gt;x, img-&gt;y);\n\n    printf(\"Please press enter to complete\\n\");\n    getchar();\n}\n</code></pre>\n"}, {"tags": ["c", "eof"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 5, "creation_date": 1462404624, "post_id": 37039786, "comment_id": 61629390, "body": "Well it&#39;s pretty obvious, you&#39;ve stored the EOF, stop doing that."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1462404692, "post_id": 37039786, "comment_id": 61629412, "body": "You should test for EOF after reading a character and before writing it.  Here, you read a character, write it, and <i>then</i> test for EOF."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 6, "creation_date": 1462404717, "post_id": 37039786, "comment_id": 61629417, "body": "<code>while((c = fgetc(fpin)) != EOF) fputc(c, fpout);</code>"}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1462405086, "post_id": 37039786, "comment_id": 61629538, "body": "Consider using a buffer with <code>fread</code> and <code>fwrite</code> instead of character-by-character I/O for efficiency, anyway."}, {"owner": {"reputation": 3242, "user_id": 445525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac37c182e46d085a1b3d1042a7419682?s=128&d=identicon&r=PG", "display_name": "James Youngman", "link": "https://stackoverflow.com/users/445525/james-youngman"}, "edited": false, "score": 0, "creation_date": 1462430190, "post_id": 37039786, "comment_id": 61636567, "body": "You should just add a &quot;t&quot; to the mode you specify to the fopen call when opening original_file, assuming your code is running on Windows."}], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1462405729, "post_id": 37039932, "comment_id": 61629754, "body": "Your method #1 is <i>unsafe</i> as it checks <code>curr_char</code> before being initialized!"}, {"owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462405815, "post_id": 37039932, "comment_id": 61629784, "body": "Thanks you very much, but can you explain in the example 3 why if I put the call of getc and the assignment to curr_char inside of the controlling expression of the while loop it is like I do  if(curr_char == EOF) break;"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462407147, "post_id": 37039932, "comment_id": 61630100, "body": "@RonyCohen The result of an assignment is whatever value is assigned.  The result of the assignment in this case is <code>getc(original_file)</code>. Then you compare that to EOF."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462442993, "post_id": 37039932, "comment_id": 61643470, "body": "@RonyCohen See the expanded answer."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 4, "last_activity_date": 1462442970, "last_edit_date": 1462442970, "creation_date": 1462405403, "answer_id": 37039932, "question_id": 37039786, "link": "https://stackoverflow.com/questions/37039786/solve-%c3%bf-end-of-file-in-c/37039932#37039932", "title": "Solve &#255; end of file in C", "body": "<p>For each character you read, you have two things to do:</p>\n\n<ol>\n<li>Check to see if it's EOF.</li>\n<li>If not, write it to the output.</li>\n</ol>\n\n<p>Your problem is you're doing these two things in the wrong order.</p>\n\n<p>There are potentially several different ways of solving this.  Which one you pick depends on how much you care about your program looking good, as opposed to merely working.</p>\n\n<p>One. Starting with the code you wrote, we could change it to:</p>\n\n<pre><code>while (curr_char != EOF)\n    {\n    curr_char = getc(original_file);\n    if(curr_char == EOF) break;\n    putc(curr_char, second_file);\n    }\n</code></pre>\n\n<p>Here, we explicitly test to see if the character is EOF, immediately after reading it, before writing it.  If it's EOF, we break out of the loop early.  This will work, but it's ugly: there are two different places where we test for EOF, and one of them never \"fires\".  (Also, as a commentator reminded me, there's the problem that the first time through the loop, we're testing <code>curr_char</code> before we've ever set it.)</p>\n\n<p>Two.  You could rearrange it like this:</p>\n\n<pre><code>curr_char = getc(original_file);\nwhile (curr_char != EOF)\n    {\n    putc(curr_char, second_file);\n    curr_char = getc(original_file);\n    }\n</code></pre>\n\n<p>Here, we read an initial character, and as long as it's not EOF, we write it and read another.  This will work just fine, but but it's still a little bit ugly, because this time there are two different places where we read the character.</p>\n\n<p>Three.  You could rearrange it like this:</p>\n\n<pre><code>while ((curr_char = getc(original_file)) != EOF)\n    {\n    putc(curr_char, second_file);\n    }\n</code></pre>\n\n<p>This is the conventional way of writing a character-copying loop in C.  The call to <code>getc</code> and the assignment to <code>curr_char</code> are buried inside of the controlling expression of the <code>while</code> loop.  It depends on the fact that in C, an assignment expression has a value just like any other expression.  That is, the value of the expression <code>a = b</code> is whatever value we just assigned to <code>a</code> (that is, <code>b</code>'s value).  So the value of the expression <code>curr_char = getc(original_file)</code> is the character we just read.  So when we say <code>while ((curr_char = getc(original_file)) != EOF)</code>, what we're actually saying is, \"Call <code>getc</code>, assign the result to <code>curr_char</code>, and if it's not equal to <code>EOF</code>, take another trip around the loop.\"</p>\n\n<p>(If you're still having trouble seeing this, I've written other explanations in <a href=\"https://www.eskimo.com/~scs/cclass/krnotes/sx4f.html\" rel=\"nofollow\">these notes</a> and <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx6b.html\" rel=\"nofollow\">this writeup</a>.)</p>\n\n<p>This code is both good and bad.  It's good because we've got exactly one place we read characters, one place we test characters, and one place we write characters.  But it's a little bit bad because, let's admit it, it's somewhat cryptic at first.  It's hard to think about that assignment-buried-inside-the-<code>while</code>-condition.  It's code like this that gives C a reputation as being full of obscure gobbledegook.</p>\n\n<p>But, at least in this case, it really is worth learning the idiom, and becoming comfortable with it, because the reductions to just one read and one test and one write really <em>are</em> virtues.  It doesn't matter so much in a trivial case like this, but in real programs which are complicated for other reasons, if there's some key piece of functionality that happens in two different places, it's extremely easy to overlook this fact, and to make a change to one of them but forget to make it to the other.</p>\n\n<p>(In fact, this happened to me just last week at work.  I was trying to fix a bug in somebody else's code.  I finally figured out that when the code did X, it was inadvertently clearing Y.  I found the place where it did X, and I added some new code to properly recreate Y.  But when I tested my fix, it didn't work!  It turned out there were two separate places where the code did X, and I had found and fixed the wrong one.)</p>\n\n<p>Finally, here's an equivalently minimal but unconventional way of writing the loop:</p>\n\n<pre><code>while (1)\n    {\n    curr_char = getc(original_file);\n    if(curr_char == EOF) break;\n    putc(curr_char, second_file);\n    }\n</code></pre>\n\n<p>This is kind of like number 1, but it gets rid of the redundant condition in the <code>while</code> loop, and replaces it with the constant <code>1</code>, which is \"true\" in C.  This will work just fine, too, and it shares the virtue of having one read, one test, and one write.  It actually ends up doing exactly the same operations and in exactly the same order as number 3, but by being laid out linearly it may be easier to follow.</p>\n\n<p>The only problem with number 4 is that it's an unconventional, \"break in the middle\" loop.  Personally, I don't have a problem with break-in-the-middle loops, and I find they come up from time to time, but if I wrote one and someone said \"Steve, that's ugly, it's not an idiom anyone recognizes, it will confuse people\", I'd have to agree.</p>\n\n<p>P.S. I have replaced your calls to <code>fgetc</code> and <code>fputc</code> with the more conventional <code>getc</code> and <code>putc</code>.  I'm not sure who told you to use <code>fgetc</code> and <code>fputc</code>, and there are obscure circumstances where you need them, but they're so rare that in my opinion one might as well forget that the \"f\" variants exist, and always use <code>getc</code> and <code>putc</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2420, "favorite_count": 1, "accepted_answer_id": 37039932, "answer_count": 1, "score": 0, "last_activity_date": 1588860553, "creation_date": 1462404498, "last_edit_date": 1462405224, "question_id": 37039786, "link": "https://stackoverflow.com/questions/37039786/solve-%c3%bf-end-of-file-in-c", "title": "Solve &#255; end of file in C", "body": "<p>When I copy the content of a file to another in C at the end of the output file I have this character <code>\u00ff</code>. I understand thanks to this forum that it is the EOF indicator but I don't understand what to do in order to get rid of it in the output file.</p>\n\n<p>This is my code:</p>\n\n<pre><code>second_file = fopen(argv[2], \"w+\");\nwhile (curr_char != EOF)\n{\n    curr_char = fgetc(original_file);\n    fputc(curr_char, second_file);\n}\nprintf(\"Your file has been successfully copy\\n\");\nfclose(second_file);\nfclose(original_file);\n</code></pre>\n"}, {"tags": ["c", "semaphore"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1462402539, "post_id": 37039416, "comment_id": 61628761, "body": "Did you read the <a href=\"http://man7.org/linux/man-pages/man3/sem_getvalue.3.html\" rel=\"nofollow noreferrer\"><code>sem_getvalue</code> man page</a>? What does it tell you its parameter types need to be and what did you give it? Also, what does reading the warning message tell you very directly &quot;expected..but argument is..&quot;?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462402637, "post_id": 37039416, "comment_id": 61628796, "body": "You got a clear, (or as clear as can be expected:), compiler error message, complaining of a type mismatch on the second parameter of &#39;sem_getvalue&#39;.  That happened because you have a  type mismatch on the second parameter of &#39;sem_getvalue&#39;."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462403703, "post_id": 37039416, "comment_id": 61629106, "body": "Remove the <code>sem_getvalue</code> calls. They have no purpose as used. When <code>pthread_create</code> is called, it does <i>not</i> dereference the value for <i>reading</i>. It only uses the pointer to <i>set</i> a tid value on return (i.e.) the value set before the call is ignored [and replaced]. Further, because a <code>sem_init</code> is done before the <code>sem_getvalue</code>, the value will always be zero."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5635213, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bcW3Fp2HsdI/AAAAAAAAAAI/AAAAAAAAAMU/DLqFjgr4iCU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5635213/kris"}, "edited": false, "score": 0, "creation_date": 1462402848, "post_id": 37039474, "comment_id": 61628865, "body": "Changing it to int gets another error though, for pthread_create"}], "tags": [], "owner": {"reputation": 164, "user_id": 6242852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa542ff7f836ca10b739b25594ef16af?s=128&d=identicon&r=PG&f=1", "display_name": "A. FLAISCHER", "link": "https://stackoverflow.com/users/6242852/a-flaischer"}, "is_accepted": false, "score": 0, "last_activity_date": 1462402637, "creation_date": 1462402637, "answer_id": 37039474, "question_id": 37039416, "link": "https://stackoverflow.com/questions/37039416/output-of-semaphore-values/37039474#37039474", "title": "Output of semaphore values", "body": "<p>From <a href=\"http://linux.die.net/man/3/sem_getvalue\" rel=\"nofollow\">sem_getvalue</a>, values should be int :</p>\n\n<p>Declare <code>int s1_val, s2_val;</code></p>\n\n<pre><code>  sem_init(&amp;s1, 0, 0);\n  sem_getvalue(&amp;s1, &amp;s1_val);\n  sem_init(&amp;s2, 0, 0);\n  sem_getvalue(&amp;s2, &amp;s2_val);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1462402657, "creation_date": 1462402657, "answer_id": 37039476, "question_id": 37039416, "link": "https://stackoverflow.com/questions/37039416/output-of-semaphore-values/37039476#37039476", "title": "Output of semaphore values", "body": "<p>The second parameter is expected to be a pointer to <code>int</code>, where as you are passing in the address of a <code>pthread_t</code>. A <code>pthread_t</code> is not an <code>int</code> on your system.</p>\n"}], "owner": {"reputation": 3, "user_id": 5635213, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bcW3Fp2HsdI/AAAAAAAAAAI/AAAAAAAAAMU/DLqFjgr4iCU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5635213/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1464482593, "creation_date": 1462402312, "last_edit_date": 1464482593, "question_id": 37039416, "link": "https://stackoverflow.com/questions/37039416/output-of-semaphore-values", "title": "Output of semaphore values", "body": "<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n\nsem_t s1, s2;\npthread_t foo_tid, bar_tid;\n\nvoid *foo(void*) {\n  while(1) {\n    sem_wait(&amp;s1);\n    printf(\"HI \");\n    sem_post(&amp;s2);\n  }\n}\n\nvoid *bar(void*) {\n  while(1) {\n    sem_wait(&amp;s2);\n    printf(\"HO \");\n    sem_post(&amp;s1);\n  }\n}\n\nint main() {\n  sem_init(&amp;s1, 0, 0);\n  sem_getvalue(&amp;s1, &amp;foo_tid);\n  sem_init(&amp;s2, 0, 0);\n  sem_getvalue(&amp;s2, &amp;bar_tid);\n  pthread_create(&amp;foo_tid, NULL, foo, NULL);\n  pthread_create(&amp;bar_tid, NULL, bar, NULL);\n  return 0;\n}\n</code></pre>\n\n<p>I'm trying to get the output of the semaphores <code>s1</code> and <code>s2</code>. But I keep getting these errors:</p>\n\n<pre><code>sema.c: In function 'main':\nsema.c:29:3: warning: passing argument 2 of 'sem_getvalue' from incompatible pointer type [enabled by default]\nIn file included from sema.c:6:0:\n/usr/include/semaphore.h:72:12: note: expected 'int * __restrict__' but argument is of type 'pthread_t *'\nsema.c:31:3: warning: passing argument 2 of 'sem_getvalue' from incompatible pointer type [enabled by default]\nIn file included from sema.c:6:0:\n/usr/include/semaphore.h:72:12: note: expected 'int * __restrict__' but argument is of type 'pthread_t *'`\n</code></pre>\n\n<p>I just haven not been able to get rid of this error. If anyone could help me out with this, that'd be greatly appreciated!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1462402043, "post_id": 37039332, "comment_id": 61628602, "body": "your function doesn&#39;t look like it displays anything at all"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462402229, "post_id": 37039332, "comment_id": 61628656, "body": "There is clearly not enough information for anybody to see what you are doing since the code references arrays whose initializations are not shown."}, {"owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462403606, "post_id": 37039332, "comment_id": 61629075, "body": "No I have another function who is a display function. This is just a sort function"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462408068, "post_id": 37040221, "comment_id": 61630312, "body": "Thanks I fix the problem"}], "tags": [], "owner": {"reputation": 781, "user_id": 3802059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bc9b09003456393fe147dce385b444?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/3802059/ian"}, "is_accepted": true, "score": 0, "last_activity_date": 1462407167, "creation_date": 1462407167, "answer_id": 37040221, "question_id": 37039332, "link": "https://stackoverflow.com/questions/37039332/prime-number-into-an-array-in-c/37040221#37040221", "title": "Prime number into an array in C", "body": "<p>I see 3 problems with the code:\n1. You should return k, not j.  k is the size of sort_arr\n2. You should loop until arr[i] / 2, not one less than that (see &lt;= in code below)\n3. You do not handle negative numbers. Change your loop to the following:</p>\n\n<pre><code>for (j = 2; j &lt;= abs(arr[i])/2; j++)\n</code></pre>\n\n<p>Without the code that prints your values, I'm not sure exactly what you're looking for, but hopefully fixing these will fix your problem.</p>\n"}], "owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "closed_date": 1462438138, "accepted_answer_id": 37040221, "answer_count": 1, "score": -3, "last_activity_date": 1462412711, "creation_date": 1462401888, "last_edit_date": 1462412711, "question_id": 37039332, "link": "https://stackoverflow.com/questions/37039332/prime-number-into-an-array-in-c", "closed_reason": "Not suitable for this site", "title": "Prime number into an array in C", "body": "<p>I try to do a function in order to sort an array and display after that only the prime number. But all the elements of my array are random numbers, and the problem is that the function display only negative prime numbers and not positive like 7 and 3, what can I do in order to solve the problem</p>\n\n<pre><code>int prime_arr(int size, int *arr, int *sort_arr)\n{\n    int i, j, k = 0, flag;\n    for (i = 0; i &lt; size; i++)\n    {\n        flag = 0;\n        for (j = 2; j &lt; arr[i]/2; j++)\n        {\n            if (arr[i] % j == 0){\n                flag = 1;\n                break;\n            }\n        }\n        if (flag == 0){\n            sort_arr[k++] = arr[i];\n        }\n    }\n    return j;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "vectorization", "auto-vectorization"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462442815, "post_id": 37039329, "comment_id": 61643382, "body": "Does it vectorize if <code>i</code> is changed to <code>int</code> in the second example?"}, {"owner": {"reputation": 361, "user_id": 1706587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55ccfb19b731a8669175ad1a642a0cf5?s=128&d=identicon&r=PG", "display_name": "tozak", "link": "https://stackoverflow.com/users/1706587/tozak"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462448149, "post_id": 37039329, "comment_id": 61646596, "body": "Yes it does vectorize when i is changed to int."}], "owner": {"reputation": 361, "user_id": 1706587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55ccfb19b731a8669175ad1a642a0cf5?s=128&d=identicon&r=PG", "display_name": "tozak", "link": "https://stackoverflow.com/users/1706587/tozak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1462401881, "creation_date": 1462401881, "question_id": 37039329, "link": "https://stackoverflow.com/questions/37039329/why-the-gcc-auto-vectorization-is-also-dependent-on-the-type-of-the-loop-itera", "title": "Why the GCC auto-vectorization is -also- dependent on the type of the loop iteration variable?", "body": "<p>I have a simple function with a loop. GCC is able to vectorize the loop in this function. My GCC version is 4.7.4.</p>\n\n<pre><code>void  __attribute__ ((noinline)) foo(int *__restrict__ ptr1,  int *__restrict__ ptr2, int *__restrict__ ptr3, unsigned int cnt)\n{\nunsigned int i;\n\nptr1 = __builtin_assume_aligned (ptr1, 32);\nptr2 = __builtin_assume_aligned (ptr2, 32);\nptr3 = __builtin_assume_aligned (ptr3, 32);\n\nfor(i = 0; i &lt; cnt; i++)\n {\n    ptr3[i] = ptr1[i] * ptr2[i];\n }\n}\n</code></pre>\n\n<p>However, when I change the type of the function parameter cnt from unsigned int to int, GCC is not able to optimize the loop.</p>\n\n<pre><code>void  __attribute__ ((noinline)) foo(int *__restrict__ ptr1,  int *__restrict__ ptr2, int *__restrict__ ptr3, int cnt)\n{\nunsigned int i;\n\nptr1 = __builtin_assume_aligned (ptr1, 32);\nptr2 = __builtin_assume_aligned (ptr2, 32);\nptr3 = __builtin_assume_aligned (ptr3, 32);\n\nfor(i = 0; i &lt; cnt; i++)\n {\n    ptr3[i] = ptr1[i] * ptr2[i];\n }\n}\n</code></pre>\n\n<p>The loop is not vectorized in this new version of foo. And the GCC output for the loop is:</p>\n\n<p><strong>142: not vectorized: data ref analysis failed D.62366_17 = *D.62365_16;</strong></p>\n\n<p>It seems that GCC requires the parameter and the variable it uses in the loop iterarion with the same exact type. Why the vectorization is dependent on the loop iteration variable type in this case? </p>\n"}, {"tags": ["c", "unix", "signals", "kill"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1462402376, "post_id": 37039328, "comment_id": 61628705, "body": "You&#39;ve stopped the process so it doesn&#39;t execute the <code>signal</code> call."}], "answers": [{"tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": false, "score": 1, "last_activity_date": 1462402291, "creation_date": 1462402291, "answer_id": 37039410, "question_id": 37039328, "link": "https://stackoverflow.com/questions/37039328/signal-and-kill-c/37039410#37039410", "title": "Signal and kill C", "body": "<p>It's not avoided, but the order of operations is different.  Your server gets a STOP signal before you've registered the handler.  When you send it SIGCONT, it continues, then registers the handler and exits without ever receiving another signal.  The handler will not be executed for signals that occur before the handler is registered.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 2, "last_activity_date": 1462402306, "creation_date": 1462402306, "answer_id": 37039414, "question_id": 37039328, "link": "https://stackoverflow.com/questions/37039328/signal-and-kill-c/37039414#37039414", "title": "Signal and kill C", "body": "<p>When the call to <code>signal()</code> is written after <code>kill()</code> in your server, it means the signal handler won't get installed until after the server receives <code>SIGCONT</code>. This is because the <code>kill()</code> call in the server takes effect immediately to suspend the server process.</p>\n\n<p>At the point the server receives <code>SIGCONT</code>, the default handler will be used, since no other handler has been installed yet.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 6117655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nx8g8.jpg?s=128&g=1", "display_name": "yamorn", "link": "https://stackoverflow.com/users/6117655/yamorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1462406601, "creation_date": 1462406601, "answer_id": 37040139, "question_id": 37039328, "link": "https://stackoverflow.com/questions/37039328/signal-and-kill-c/37040139#37040139", "title": "Signal and kill C", "body": "<p>you can use raise(SIGCONT) function like this:</p>\n\n<pre><code>void handler_sigcont(int sig){\n  printf(\"SIGCONT server\\n\");\n}\n\nint main(){\n  signal(SIGCONT,handler_sigcont);\n  printf(\"%d\\n\",getpid());\n  raise(SIGCONT);\n  printf(\"server!\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 37039414, "answer_count": 3, "score": 1, "last_activity_date": 1462406601, "creation_date": 1462401873, "question_id": 37039328, "link": "https://stackoverflow.com/questions/37039328/signal-and-kill-c", "title": "Signal and kill C", "body": "<p>I am learning about <code>signal()</code> and i have this two files:</p>\n\n<p>server.c: </p>\n\n<pre><code>void handler_sigcont(){\n  printf(\"SIGCONT server\\n\");\n}\n\nint main(){\n  signal(SIGCONT,handler_sigcont);\n  printf(\"%d\\n\",getpid());\n  kill(getpid(),SIGSTOP);\n  printf(\"server!\\n\");\n}\n</code></pre>\n\n<p>client.c:</p>\n\n<pre><code>int main(int argc, char** argv){\n  kill(atoi(argv[1]),SIGCONT);\n  printf(\"client!\\n\");\n}\n</code></pre>\n\n<p>First i execute server.c, this is the output:</p>\n\n<pre><code>6999\n\n[7]+  Stopped                 ./sobusrv\n</code></pre>\n\n<p>Then i execute client.c like this:</p>\n\n<pre><code>./client 6999\n</code></pre>\n\n<p>To wake up process 6999.\nThe output is the following one:</p>\n\n<pre><code>client!\nSIGCONT server\nserver!\n[8]   Done                    ./sobusrv\n</code></pre>\n\n<p>But if, in server.c, i change the <code>signal()</code> after <code>kill()</code>, like this:</p>\n\n<pre><code>void handler_sigcont(){\n  printf(\"SIGCONT server\\n\");\n}\n\nint main(){\n\n  printf(\"%d\\n\",getpid());\n  kill(getpid(),SIGSTOP);\n  printf(\"server!\\n\");\n  signal(SIGCONT,handler_sigcont);\n}\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>client!\nserver!\n[8]   Done                    ./sobusrv\n</code></pre>\n\n<p>I want to know why the handler is avoided when <code>signal()</code> is written after <code>kill()</code>. </p>\n"}, {"tags": ["c", "windows", "winapi"], "comments": [{"owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462399122, "post_id": 37038766, "comment_id": 61627566, "body": "Wow, One downvote for 3 views, why?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 6, "creation_date": 1462400643, "post_id": 37038766, "comment_id": 61628150, "body": "Don&#39;t use SetWindowsLong to change the enable state, use EnableWindow."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 2, "creation_date": 1462402980, "post_id": 37038766, "comment_id": 61628905, "body": "<code>WM_ENABLE</code> is simply a notification message, you don&#39;t have to <b>do</b> anything. The <code>WS_DISABLED</code> bit is changed for you."}, {"owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1462431675, "post_id": 37038766, "comment_id": 61637306, "body": "@RossRidge: Thanks for comment, but if someone else use SetWindowLong to change WS_DISABLED, my boolen flag dont reflect this."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1462433530, "post_id": 37038766, "comment_id": 61638231, "body": "Then that someone else is making a mistake and there&#39;s not much you can do about it."}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462440054, "post_id": 37045531, "comment_id": 61641658, "body": "Thanks for answer, I know EnableWindow and IsWindowEnabled. But my problem is related to question: Is better repond WM_ENABLE message or is better always check WS_DISABLED bit. Also for my control InvalidateRect works perfect, with only one problem and this is this question."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462440885, "post_id": 37045531, "comment_id": 61642214, "body": "Just use <code>EnableWindow</code> and <code>IsWindowEnabled</code> as stated in <a href=\"https://msdn.microsoft.com/en-ca/library/windows/desktop/ms632600%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">doucmentation</a>: <i>To change this after a window has been created, use the EnableWindow function</i>"}, {"owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462441261, "post_id": 37045531, "comment_id": 61642456, "body": "You dont understand. I dont use EnableWindow, because my control is used 3rd party people. If they use EnableWindow or SendMessage(WM_ENABLE), I dont care. I have only problem, if someone trying use SetWindowLong(WS_DISABLED)."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462442663, "post_id": 37045531, "comment_id": 61643306, "body": "I understand your question. As stated in comments and documentation the correct way is to use <code>EnableWindow</code>. You will have to catch <code>WM_STYLECHANGED</code> if you want to detected messages sent as <code>SetWindowLong(... WS_DISABLED)</code> but it&#39;s not done that way."}, {"owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462443316, "post_id": 37045531, "comment_id": 61643670, "body": "I have WM_STYLECHANGED handler, so this is OK. So you recommend always use IsWindowEnabled and forgot about WM_ENABLE. Yes?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "edited": false, "score": 0, "creation_date": 1462443893, "post_id": 37045531, "comment_id": 61643998, "body": "I think you do need <code>WM_ENABLE</code>. I assume you have a custom control and you want to repaint the control when it is disabled. Other programs will most likely call <code>EnableWindow</code> which results in <code>WM_ENABLE</code> message --- In the off chance that the other program is badly written and uses <code>SetWindowLong(... WS_DISABLED)</code>, you would need to check <code>WM_STYLECHANGED</code> as well as <code>WM_ENABLE</code>"}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1462442488, "last_edit_date": 1462442488, "creation_date": 1462435526, "answer_id": 37045531, "question_id": 37038766, "link": "https://stackoverflow.com/questions/37038766/wm-enable-default-processing/37045531#37045531", "title": "WM_ENABLE default processing", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646291%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>EnableWindow(hwnd, enable)</code></a>  to enable/disable window</p>\n\n<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646303%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>IsWindowEnabled(hwnd)</code></a> to check if window is enabled or disabled.</p>\n\n<p>Calling <code>Invalidate</code> after enable/disable may not have any visible effect. For example if there is a OK button, the OK button may still appear as enabled even if window is disabled. If you want to disable the child controls then use the following:</p>\n\n<pre><code>HWND child = GetWindow(hwnd, GW_CHILD);\nwhile (child)\n{\n    EnableWindow(child, enable);\n    child = GetWindow(child, GW_HWNDNEXT);\n}\n</code></pre>\n\n<p>The following functions will work too, but there is no reason to use them over <code>EnableWindow</code> and <code>IsWindowEnabled</code></p>\n\n<pre><code>//don't use\nBOOL enabled = !(GetWindowLong(hbutton, GWL_STYLE) &amp; WS_DISABLED);\n\n//disable - don't use\nSetWindowLong(hwnd, GWL_STYLE, GetWindowLong(hwnd, GWL_STYLE) | WS_DISABLED);\n\n//enable - don't use\nSetWindowLong(hwnd, GWL_STYLE, GetWindowLong(hwnd, GWL_STYLE) &amp; ~WS_DISABLED);\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 2120666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5286b924ee914b1e479d0ff2db3f73f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2120666", "link": "https://stackoverflow.com/users/2120666/user2120666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 37045531, "answer_count": 1, "score": 0, "last_activity_date": 1462442488, "creation_date": 1462398938, "last_edit_date": 1462399294, "question_id": 37038766, "link": "https://stackoverflow.com/questions/37038766/wm-enable-default-processing", "title": "WM_ENABLE default processing", "body": "<p>I have problem in my control window. How to respond to the WM_ENABLE message?</p>\n\n<p>I have bool flag bEnable which controls WM_ENABLE message:</p>\n\n<pre><code>LRESULT WINAPI OnEnable(HWND hWindow, WPARAM wParam, LPARAM lParam)\n{\n    LRESULT lReturn = 0;\n    BOOL bEnabled = (BOOL)wParam;\n    UNREFERENCED_PARAMETER(lParam);\n    g_bEnabled = bEnabled;\n    InvalidateRect(hWindow, NULL, TRUE);\n    return lReturn;\n}\n</code></pre>\n\n<p>But this not affect setting WS_DISABLED by SetWindowLong.</p>\n\n<p>So how I make my OnEnable handler reflects this changes?</p>\n\n<p>Is proper way:</p>\n\n<pre><code>LONG lStyles = GetWindowLong(hWindow, GWL_STYLE);\n\nif (bEnable)\n{\n        lStyles = lStyles &amp; ~WS_DISABLED;\n        g_bEnable = TRUE;\n}\nelse\n{\n         lStyles = lStyles | WS_DISABLED;\n         g_bEnable = FALSE;\n}\n</code></pre>\n\n<p>or is another way?</p>\n"}, {"tags": ["c++", "c", "cuda", "gpgpu"], "answers": [{"tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": false, "score": 1, "last_activity_date": 1462411313, "last_edit_date": 1495535632, "creation_date": 1462409081, "answer_id": 37040488, "question_id": 37038317, "link": "https://stackoverflow.com/questions/37038317/using-c-header-structure-for-cuda-code/37040488#37040488", "title": "Using C++ header structure for CUDA code", "body": "<p>No, this will not work:</p>\n\n<pre><code>class MyClass\n{\n    ...\n      __global__ void myKernel();\n</code></pre>\n\n<p>the compiler will not let you define a class member function that is a <code>__global__</code> function (try it).  Even if you could, such a function running on the device would not have the usual class access to other class data or function members.  So the usual advice is to declare your kernel definition outside the scope of the class, and have a wrapper member function in the class that calls the kernel.</p>\n\n<p>Some additional discussion is <a href=\"https://stackoverflow.com/questions/13748231/cuda-kernel-as-member-function-of-a-class\">here</a> and <a href=\"https://stackoverflow.com/questions/17535959/member-function-of-a-c-object-as-a-cuda-global-function\">here</a></p>\n"}], "owner": {"reputation": 75, "user_id": 4333489, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1231f660f0d045108c46ce96818d1b96?s=128&d=identicon&r=PG&f=1", "display_name": "WaffleMan0310", "link": "https://stackoverflow.com/users/4333489/waffleman0310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1462411313, "creation_date": 1462397160, "last_edit_date": 1462408781, "question_id": 37038317, "link": "https://stackoverflow.com/questions/37038317/using-c-header-structure-for-cuda-code", "title": "Using C++ header structure for CUDA code", "body": "<p>I know that this question has probably been asked, but I can't find an answer that particularly answers my question so here it goes...</p>\n\n<p>The question is pretty simple, I am trying to use a C++ style header for CUDA (.cu/.cuh) code.</p>\n\n<pre><code>//MyClass.cuh\n#ifndef MY_CLASS\n#define MY_CLASS\n#include ...cuda.h, etc.\nclass MyClass\n{\n   public:\n      void myFunction();   \n   private:\n      __global__ void myKernel();\n}\n#endif\n\n//MyClass.cu\n#include \"MyClass.cuh\"\nvoid MyClass::myFunction()\n{\n   //myFunction definition...\n}\n\n__global__ void MyClass::myKernel()\n{\n   //myKernel definition...\n}\n</code></pre>\n\n<p>Will this work?</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 4230, "user_id": 945873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d561be4c73996732e6639b5421abfb97?s=128&d=identicon&r=PG&f=1", "display_name": "itdoesntwork", "link": "https://stackoverflow.com/users/945873/itdoesntwork"}, "edited": false, "score": 0, "creation_date": 1462395447, "post_id": 37037754, "comment_id": 61625841, "body": "at a high level: while iterating through the nunber, check if a digit is too high. Then return early with the desired error values."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462395780, "post_id": 37037754, "comment_id": 61626011, "body": "I would be tempted to use less code and more lookup tables. 35 lookup strings that directly convert an input char in the addressed base to either its binary value, or -1 if illegal in that base."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462396377, "post_id": 37037754, "comment_id": 61626287, "body": "@MartinJames: On faster embedded systems such tables can slow down your code significantly."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462396598, "post_id": 37037754, "comment_id": 61626392, "body": "@Olaf I would not be surprised by that.  OTOH, a table-driven converter is more likely to .. work correctly."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1462396760, "post_id": 37037754, "comment_id": 61626477, "body": "Why would you want it to report &quot;-1&quot; for base 10, but &quot;ERROR&quot; for the user-specified base? -1 is a legitimate output value for the input string &quot;-1&quot;.  The easiest way to report an error is to add another argument to the function:"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462396956, "post_id": 37037754, "comment_id": 61626565, "body": "For typical applications, the base is a constant, so an assertion (or a run-time failure) should be sufficient. A unit-test can easily ensure correct calls."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462397997, "post_id": 37037754, "comment_id": 61627072, "body": "Side comment: You can make your code easier to write, easier to read, <i>and</i> more portable (triple win!) by replacing e.g. 48 with <code>&#39;0&#39;</code>, 65 with <code>&#39;A&#39;</code>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 0, "last_activity_date": 1462491006, "last_edit_date": 1462491006, "creation_date": 1462400509, "answer_id": 37039061, "question_id": 37037754, "link": "https://stackoverflow.com/questions/37037754/a-function-that-will-convert-number-bases-and-errors-for-illegal-inputs/37039061#37039061", "title": "A Function that will convert number bases and Errors for illegal inputs", "body": "<p>You can write a function that maps a character to its ordinal value for a given base.</p>\n\n<pre><code>int map_digit_to_ordinal (int x) {\n    static int map[MAX_CHAR];\n    const char *digits = \"0123456789abcdefghijklmnopqrstuvwxyz\";\n    const char *p;\n    if (x &lt; 0 || x &gt;= MAX_CAR) return -1;\n    if (map['1'] == 0) {\n        for (p = digits; *p; ++p) {\n            map[*p] = 1 + p - digits;\n            map[toupper(*p)] = 1 + p - digits;\n        }\n    }\n    return map[x] - 1;\n}\n</code></pre>\n\n<p>You can have a different function to check if the digit falls within your desired base.</p>\n\n<pre><code>int digit_in_base (int digit, int base) {\n    if (base &gt; 36) return -1;\n    if (digit &lt; base) return digit;\n    return -1;\n}\n</code></pre>\n\n<p>Then, your conversion function can use this function to map the potential digit to the right value. If the returned value is <code>-1</code>, your function should return early, writing <code>\"ERROR\"</code> to the destination.</p>\n\n<p>Now, your conversion function loop can make the appropriate checks.</p>\n\n<pre><code>while(s[i]) {\n    temp = map_digit_to_ordinal(s[i]);\n    temp = digit_in_base(temp, sb);\n    if (temp == -1) {\n        strcpy(d, \"ERROR\");\n        return -1;\n    }\n    v = v * sb + temp;\n    i++;\n}\n/* rest of function ... */\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6292420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531f58e8b164e26f09413ddf79fedddf?s=128&d=identicon&r=PG&f=1", "display_name": "NegrodaMOS", "link": "https://stackoverflow.com/users/6292420/negrodamos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 37039061, "answer_count": 1, "score": 1, "last_activity_date": 1462495763, "creation_date": 1462394992, "last_edit_date": 1462495763, "question_id": 37037754, "link": "https://stackoverflow.com/questions/37037754/a-function-that-will-convert-number-bases-and-errors-for-illegal-inputs", "title": "A Function that will convert number bases and Errors for illegal inputs", "body": "<p>I have written a function that will convert strings between different user specified number bases. For example octal is 8, decimal is 10. Letters A to Z could be considered up to base 26. </p>\n\n<pre><code>    #define _CRT_SECURE_NO_WARNINGS\n    #include &lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n    #include&lt;string.h&gt;\n    #include&lt;ctype.h&gt;\n    #include&lt;math.h&gt;\n    #define MAXBUF 64\n\n    int baseconv(char s[], int sb, char d[], int db);\n\n    void main()\n    {\n        char s[MAXBUF+1], d[MAXBUF+1]; // source, destination value (as char string)\n        int sb,db;                     // source, destination base\n        int decval;                    // calculated decimal value\n        char buf[MAXBUF+10];           // temp buffer\n        char *p;                       // pointer to string\n\n        printf(\"Enter src value, src base, dst base: \");\n        gets(buf);\n        p=strtok(buf,\" ,\");\n        while(stricmp(p,\"END\"))\n        {\n            strcpy(s,p);\n            p=strtok(NULL,\" ,\");        // or sb=atoi(strtok(NULL,\" ,\"))\n            sb=atoi(p);\n\n            p=strtok(NULL,\" ,\");        // or db=atoi(strtok(NULL,\" ,\"))\n            db=atoi(p);\n\n            decval = baseconv(s,sb,d,db);\n\n            printf(\"%s|%d = %d|10 = %s|%d\\n\", s,sb,decval,d,db);\n            printf(\"Enter src value, src base, dst base: \");\n            gets(buf);\n            p=strtok(buf,\" , \");\n        }\n    }\n\n    // actual baseconv() function \n\n    int baseconv(char s[], int sb, char d[], int db)\n    {\n        char t1[MAXBUF+10];\n        char t[MAXBUF+10];\n        int v=0,i=0,j=0,temp,k=0;\n        while(s[i]) \n        {\n            if(s[i]&gt;=48 &amp;&amp; s[i] &lt; 58)    \n                v = v * sb + (s[i]-48);    \n            else if(s[i]&gt;=65 &amp;&amp; s[i]&lt;71) \n                v = v * sb + (s[i]-65)+10;  \n            else if(s[i]&gt;=97 &amp;&amp; s[i]&lt;103) \n                v = v * sb + (s[i]-97)+10;\n            i++;   \n        }\n        temp=v;\n        while(v)\n        {\n            if(v%db+48 &gt;= 48 &amp;&amp; v%db+48 &lt; 58)   \n                t[j] =(v%db)+48;\n            else if(v%db+55 &gt;=65)            \n                t[j] =(v%db)+55;       \n            else if(v%db+87 &gt;=97)      \n                t[j] =(v%db)+87;\n            v = v/db; \n            j++;\n        }\n\n        for(int n=j-1;n&gt;=0;n--) \n        {\n            t1[k]=t[n]; \n            k++;\n        }\n        t1[j]='\\0';\n        strcpy(d,t1);  \n        return temp;\n    }\n</code></pre>\n\n<p>Output is like this-</p>\n\n<pre><code>Enter source value, source base, dest base: 1234, 8, 16\n1234|8 = 668|10 = 29C|16\"\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Enter source value, source base, dest base: face, 16, 8\nface|16 = 64206|10 = 175316|8\"\n</code></pre>\n\n<p>However, I cannot get it to specify if the source value is illegal for the specified source base (for example 1234|3, return -1, and place the value \"ERROR\" in d[]. </p>\n\n<p>Output WOULD be like this-</p>\n\n<pre><code>Enter source value, source base, dest base: 12345, 5, 10\n12345|5 = -1|10 = ERROR|10\"\n</code></pre>\n\n<p>How would I implement the return -1 and ERROR?</p>\n"}, {"tags": ["c", "gtk", "gtk3", "gobject"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3479085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b2181af5b5674f3981d811f06423eec?s=128&d=identicon&r=PG&f=1", "display_name": "Snorklebort", "link": "https://stackoverflow.com/users/3479085/snorklebort"}, "edited": false, "score": 0, "creation_date": 1462396770, "post_id": 37037717, "comment_id": 61626485, "body": "Did you mean it&#39;s better to use GObject instead of GtkWidget (because when you use a widget you have to convert back to object type, atleast based on the code above) when you go down to the line that starts with: window ="}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "reply_to_user": {"reputation": 93, "user_id": 3479085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b2181af5b5674f3981d811f06423eec?s=128&d=identicon&r=PG&f=1", "display_name": "Snorklebort", "link": "https://stackoverflow.com/users/3479085/snorklebort"}, "edited": false, "score": 0, "creation_date": 1462397619, "post_id": 37037717, "comment_id": 61626900, "body": "I personaly think that GtkWidget is a better choice as you will most likely use a widget type in gtk applications and not an object type... Imagine the fist example with a gtk_widget_show() or a gym_widget_destroy(), than you need a widget"}], "tags": [], "owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "is_accepted": true, "score": 4, "last_activity_date": 1462394869, "creation_date": 1462394869, "answer_id": 37037717, "question_id": 37037344, "link": "https://stackoverflow.com/questions/37037344/using-gtkwidget-window-vs-gobject-window-in-c/37037717#37037717", "title": "Using &quot; GtkWidget *window &quot; vs &quot; GObject *window &quot; in C", "body": "<p>Both should work, but I think it is more reasonable to use <code>GtkWidget</code> as you will need this type a lot more, so you do not need to write <code>GTK_WIDGET(obj)</code> all the time. You just need to 'convert' it once.</p>\n\n<p>Please note that the official guide uses <code>GObject</code> type. (<a href=\"https://developer.gnome.org/gtk3/stable/ch01s03.html\" rel=\"nofollow\" title=\"Official GTK Builder Guide\">here</a>)</p>\n\n<p>But after all you can decide, as you can easily 'convert' it to the type you need...</p>\n"}], "owner": {"reputation": 93, "user_id": 3479085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b2181af5b5674f3981d811f06423eec?s=128&d=identicon&r=PG&f=1", "display_name": "Snorklebort", "link": "https://stackoverflow.com/users/3479085/snorklebort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 37037717, "answer_count": 1, "score": 0, "last_activity_date": 1462394869, "creation_date": 1462393422, "question_id": 37037344, "link": "https://stackoverflow.com/questions/37037344/using-gtkwidget-window-vs-gobject-window-in-c", "title": "Using &quot; GtkWidget *window &quot; vs &quot; GObject *window &quot; in C", "body": "<p>What is the correct syntax when using GTK+ 3 (and glade) for creating a simple window from an xml glade file? I have seen two methods that seem to do the same thing however the syntax is slightly different.</p>\n\n<p>Example 1:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nint\nmain (int argc, char *argv[])\n{\n  GtkBuilder *builder;\n  GObject *window;\n\n  gtk_init (&amp;argc, &amp;argv);\n\n  builder = gtk_builder_new ();\n  gtk_builder_add_from_file (builder, \"builder.glade\", NULL);\n\n  window = gtk_builder_get_object (builder, \"window\");\n  g_signal_connect (window, \"destroy\", G_CALLBACK (gtk_main_quit), NULL);\n\n  gtk_main ();\n\n  return 0;\n}\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nvoid \non_window_destroy (GtkWidget *object, gpointer user_data)\n{\n    gtk_main_quit ();\n}\n\nint\nmain (int argc, char *argv[])\n{\n    GtkBuilder *builder; \n    GtkWidget *window;\n\n    gtk_init (&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new ();\n    gtk_builder_add_from_file (builder, \"builder.glade\", NULL);\n\n    window = GTK_WIDGET (gtk_builder_get_object (builder, \"window\"));\n    gtk_builder_connect_signals (builder, NULL);\n\n    g_object_unref (G_OBJECT (builder));\n\n    gtk_widget_show (window);                \n    gtk_main ();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "edited": false, "score": 0, "creation_date": 1462393517, "post_id": 37037299, "comment_id": 61624876, "body": "It might help to see the implementation for the other functions as well as it could be a problem with how those operate."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1462394331, "post_id": 37037299, "comment_id": 61625279, "body": "Your implementation is faulty. If the root node is a sentinel with auto storage, you shouldn&#39;t set the pointers in any other node to NULL. The first node inserted should point to the root, and the root can even point to itself when initialized. Your API implementation will instantly become less complex and full of <code>if</code>s."}, {"owner": {"reputation": 21, "user_id": 5932685, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k1URZgLYcAU/AAAAAAAAAAI/AAAAAAAAAJg/eFo0AiUiwmc/photo.jpg?sz=128", "display_name": "TheTastyTaco", "link": "https://stackoverflow.com/users/5932685/thetastytaco"}, "edited": false, "score": 0, "creation_date": 1462395227, "post_id": 37037299, "comment_id": 61625725, "body": "i can only change the code in delete first, i was thinking of utilizing     newnode-&gt;fwd-&gt;bwd = newnode-&gt;bwd; newnode-&gt;fwd-&gt;fwd-&gt;bwd = NULL;"}], "answers": [{"comments": [{"owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "reply_to_user": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1462396641, "post_id": 37038115, "comment_id": 61626413, "body": "@SandBag_1996 Yes I did and it works, though I didn&#39;t spend a lot of time making sure there weren&#39;t memory leaks or anything as I would have to pretty much rewrite half the code to get it to an acceptable level and that kind of defeats the purpose lol."}, {"owner": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1462396704, "post_id": 37038115, "comment_id": 61626449, "body": "Then you and I are looking at different codes, because it shouldnt work, and I just tested, it doesnt work.."}, {"owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "reply_to_user": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1462396756, "post_id": 37038115, "comment_id": 61626476, "body": "@SandBag_1996 Oh no I didn&#39;t see its still printing out the deleted node, thats just great. One second I&#39;ll go think why that&#39;s happening."}, {"owner": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1462396884, "post_id": 37038115, "comment_id": 61626535, "body": "Thats it.. that should do"}], "tags": [], "owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "is_accepted": true, "score": 1, "last_activity_date": 1462397136, "last_edit_date": 1462397136, "creation_date": 1462396339, "answer_id": 37038115, "question_id": 37037299, "link": "https://stackoverflow.com/questions/37037299/traverse-backward-dll-after-deleting-first-node/37038115#37038115", "title": "Traverse backward DLL after deleting first node", "body": "<p>I believe the problem is because the odd way you are storing the head and tail pointers to the start and end of the list in a root node and then mixing that interchangeably with the actual nodes of the list. This confusion could be eliminated if you just have simple <code>Node *head</code> and <code>Node *tail</code> pointers, but that is only a suggestion.</p>\n\n<p>In your delete function, you set the root node to effectively <code>rt-&gt;fwd</code>, which is fine for forwards traversal as <code>rt-&gt;fwd-&gt;fwd</code> is what is desired, but you forget to consider the value of <code>rt-&gt;fwd-&gt;bwd</code> which is always pointing at NULL  for the first item in the list (as there is nothing technically before this node), not the actual tail of the list which is the desired functionality by that logic.</p>\n\n<p>This obviously causes a problem when you try to use it to iterate backwards as it thinks the list is empty. You should change your deletion code to something like this:</p>\n\n<pre><code>void deleteFirst(Node *rt)\n{\n  if (rt == NULL)\n  {\n    return; /* Return if an invalid root was passed in */\n  }\n\n  if (rt-&gt;fwd == NULL) {\n    return; /* Return if the list is already empty */\n  }\n\n  Node *tmpfwd = rt-&gt;fwd; /* Store the current \"head\" */\n\n  rt-&gt;fwd = rt-&gt;fwd-&gt;fwd; /* Set the root's head to the current head's next node */\n  rt-&gt;fwd-&gt;bwd = NULL; /* Set the new head's previous node to NULL as it is the start of the list */\n\n  free(tmpfwd); /* Delete the old \"head\" */\n}\n</code></pre>\n\n<p>There are a lot of other problems here regarding edge cases and things the comments have mentioned (just the overall design makes this very problematic) but I think this is the problem you are having currently.</p>\n"}], "owner": {"reputation": 21, "user_id": 5932685, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k1URZgLYcAU/AAAAAAAAAAI/AAAAAAAAAJg/eFo0AiUiwmc/photo.jpg?sz=128", "display_name": "TheTastyTaco", "link": "https://stackoverflow.com/users/5932685/thetastytaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 37038115, "answer_count": 1, "score": 1, "last_activity_date": 1462406597, "creation_date": 1462393250, "last_edit_date": 1462406597, "question_id": 37037299, "link": "https://stackoverflow.com/questions/37037299/traverse-backward-dll-after-deleting-first-node", "title": "Traverse backward DLL after deleting first node", "body": "<p>I have doubly linked list set up using an insertion method which works.\nUsing this struct:</p>\n\n<pre><code>struct NODE\n{\n    struct NODE *fwd;\n    struct NODE *bwd;\n    int value;\n };\ntypedef struct NODE Node;\n</code></pre>\n\n<p>And this initialization:</p>\n\n<pre><code>void initializeList(Node *rt)\n{\n    rt-&gt;fwd = NULL;\n    rt-&gt;bwd = NULL;\n    rt-&gt;value = 0;\n}\n</code></pre>\n\n<p>My main function is:</p>\n\n<pre><code>main()\n{\n    Node root;\n    int j;\n    initializeList(&amp;root);\n    for (j = 0; j &lt; 15; j++)\n        insertFirst(&amp;root, j);\n    printf(\"The list traversed forward \\n\");\n    traverseForward(root);\n    printf(\"\\n\");\n    printf(\"The list traversed backward \\n\");\n    traverseBackward(root);\n    printf(\"\\n\");\n    printf(\"After first deletion traverse forward\\n\");\n    deleteFirst(&amp;root);\n    traverseForward(root);\n    printf(\"\\n\");\n    printf(\"After first deletion traverse backwards\\n\");\n    printf(\"\\n\");\n    traverseBackward(root);\n}\n</code></pre>\n\n<p>My deletefirst function is:</p>\n\n<pre><code>void deleteFirst(Node *rt)\n{\n    Node *newnode = rt;\n    Node *tmp = NULL;\n    if (newnode != NULL)\n    {\n        if (newnode-&gt;fwd != NULL)\n        {\n            newnode = newnode-&gt;fwd;\n            tmp = newnode-&gt;bwd;\n            *rt = *newnode;\n        }\n        else\n            tmp = newnode;\n    }\n    free(tmp);\n    }\n</code></pre>\n\n<p>Insert function:</p>\n\n<pre><code>int insertFirst(Node *rt, int val)\n{\n    Node *node = (Node *)malloc(sizeof(Node));\n    if (node == NULL) return 0;\n    node-&gt;value = val;\n    /* For a previously empty list */\n    if (rt-&gt;fwd == NULL)\n    {\n        rt-&gt;fwd = node;\n        rt-&gt;bwd = node;\n        node-&gt;fwd = NULL;\n        node-&gt;bwd = NULL;\n    }\n    /* For a list with at least one node */\n    else\n    {\n        /* previous first node now new node's successor */\n        rt-&gt;fwd-&gt;bwd = node;\n        node-&gt;fwd = rt-&gt;fwd;\n        /* no predecessor to the new first node */\n        node-&gt;bwd = NULL;\n        /* root points to this new first */\n        rt-&gt;fwd = node;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>Traverse functions:</p>\n\n<pre><code>void traverseForward(Node root)\n{\n    Node *q = root.fwd;\n    while (q)\n    {\n        printf(\"%d \", q-&gt;value);\n        q = q-&gt;fwd;\n    }\n}\nvoid traverseBackward(Node root)\n{\n    Node *q = root.bwd;\n    while (q)\n    {\n        printf(\"%d \", q-&gt;value);\n        q = q-&gt;bwd;\n    }\n}\n</code></pre>\n\n<p>The system prints out the list traversed forward</p>\n\n<pre><code>14 13 12 11 10 9 8 7 6 5 4 3 2 1 0 \n</code></pre>\n\n<p>The system prints out the list traversed backward</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \n</code></pre>\n\n<p>After first deletion forward traversal</p>\n\n<pre><code>13 12 11 10 9 8 7 6 5 4 3 2 1 0\n</code></pre>\n\n<p>After first deletion backward traversal</p>\n\n<p>(Nothing is printed)</p>\n\n<p>I cant figure out how to adjust the pointers to get it to work.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1462392900, "post_id": 37037165, "comment_id": 61624514, "body": "Your function expects to return char, but are you returning char?"}, {"owner": {"reputation": 675, "user_id": 3461734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YkaA-W2CW_Y/AAAAAAAAAAI/AAAAAAAAAIM/3YpNnmUqk60/photo.jpg?sz=128", "display_name": "ar-ms", "link": "https://stackoverflow.com/users/3461734/ar-ms"}, "edited": false, "score": 2, "creation_date": 1462392935, "post_id": 37037165, "comment_id": 61624532, "body": "candidate is not a char"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1462392956, "post_id": 37037165, "comment_id": 61624550, "body": "Your function is declared as returning <code>char</code> but you are trying to return a <code>char *</code>."}, {"owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "edited": false, "score": 0, "creation_date": 1462393095, "post_id": 37037165, "comment_id": 61624630, "body": "candidate is a char array, not a char and your function is declared so that the return value is expected to be that of a char."}], "answers": [{"tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": false, "score": 2, "last_activity_date": 1462393315, "last_edit_date": 1495542236, "creation_date": 1462392925, "answer_id": 37037216, "question_id": 37037165, "link": "https://stackoverflow.com/questions/37037165/return-makes-integer-from-pointer-without-a-cast-wint-conversion-return-candi/37037216#37037216", "title": "return makes integer from pointer without a cast [-Wint-conversion] return candidate", "body": "<p><code>getkey</code> has been declared to return a <code>char</code>, but you're trying to return <code>candidate</code> which is a <code>char</code> array.</p>\n\n<p>You probably meant to return one of the elements in the array, i.e. something like <code>candidate[x]</code>.</p>\n\n<p>The reason for the error message saying \"pointer\" instead of \"array\" is that the compiler is converting <code>candidate</code> to a pointer to the first element in the array, which happens implicitly in some contexts, for example when returning, since arrays can't be returned (or passed as parameters) by value in C (see <a href=\"https://stackoverflow.com/q/1461432/3425536\">What is array decaying?</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 4, "creation_date": 1462393079, "post_id": 37037241, "comment_id": 61624623, "body": "Is it really known as &quot;equivalence of arrays and pointers in C&quot;? Because that&#39;s not true. Arrays can decay into pointers under certain contexts (i.e. passing and returning) but they are not pointers."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1462393395, "post_id": 37037241, "comment_id": 61624800, "body": "@Kevin &quot;Equivalence&quot; is what we used to call it.  (Does nobody use that term any more?) &quot;Equivalence&quot; does not mean they&#39;re the same thing; just that they&#39;re closely -- even intimately -- related.  See <a href=\"http://c-faq.com/aryptr/aryptrequiv.html\" rel=\"nofollow noreferrer\">c-faq.com/aryptr/aryptrequiv.html</a> ."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1462393614, "post_id": 37037241, "comment_id": 61624935, "body": "No, arrays and pointers are not closely related. One is a memory address, the other is <i>n</i> elements laid out contiguously in memory."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1462393938, "post_id": 37037241, "comment_id": 61625081, "body": "@tuple_cat &quot;If arrays and pointers are not closely related&quot;, asks user5672720, &quot;then when I tried to return an array from my function, why did it return a pointer instead?&quot;"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1462394973, "post_id": 37037241, "comment_id": 61625582, "body": "@Adam Thanks, didn&#39;t think about that in this case.  Edited some more."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462395526, "post_id": 37037241, "comment_id": 61625882, "body": "@SteveSummit: Actually &quot;we&quot; never used the term &quot;equivalent&quot;, because it is plain wrong: <code>sizeof(int [10])</code> and <code>sizeof(&amp;(int[10]))</code>) are not equivalent. But your rephreased text is fine."}, {"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1462395678, "post_id": 37037241, "comment_id": 61625964, "body": "Thanks Steve, that looks much better."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 6, "last_activity_date": 1462395658, "last_edit_date": 1462395658, "creation_date": 1462392994, "answer_id": 37037241, "question_id": 37037165, "link": "https://stackoverflow.com/questions/37037165/return-makes-integer-from-pointer-without-a-cast-wint-conversion-return-candi/37037241#37037241", "title": "return makes integer from pointer without a cast [-Wint-conversion] return candidate", "body": "<p>Your local variable <code>candidate</code> is an array of char.  When you say</p>\n\n<pre><code>return candidate;\n</code></pre>\n\n<p>you return a pointer to char.  (This is due to the very close relationship between arrays and pointers in C, which you will have to learn about if you don't know yet.)  But you've stated that your function <code>getkey</code> returns a char, not a pointer-to-char.</p>\n\n<p>You need to make the function's return value match its type.  You might want change the <code>return</code> statement so it returns a single char.  If you want to have the function return a whole string, you could change its declaration to <code>char *getkey()</code>, but in that case you'll also have to take care of the allocation of the <code>candidate</code> array.</p>\n\n<p>Here's what the warning means.  You tried to return a pointer.  The function is supposed to return a character, which is represented as a small integer.  The compile is willing to try to convert the pointer to an integer, in case that's what you really want to do, but since that's not usually a good idea, it warns you.  Indeed, in this case the warning tells you that you probably made a mistake.</p>\n"}], "owner": {"reputation": 59, "user_id": 5672720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e270b36c80d0931358974e19b0d89f19?s=128&d=identicon&r=PG&f=1", "display_name": "user5672720", "link": "https://stackoverflow.com/users/5672720/user5672720"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18382, "favorite_count": 1, "accepted_answer_id": 37037241, "answer_count": 2, "score": 3, "last_activity_date": 1462402672, "creation_date": 1462392751, "last_edit_date": 1462392931, "question_id": 37037165, "link": "https://stackoverflow.com/questions/37037165/return-makes-integer-from-pointer-without-a-cast-wint-conversion-return-candi", "title": "return makes integer from pointer without a cast [-Wint-conversion] return candidate", "body": "<p>I'm learning C, but I find those vague compiler error messages increasingly frustrating. Here's my code:</p>\n\n<pre><code>char getkey (int minimo, int maximo, int alphalen, int index, char alpha[])  \n{  \n    int cociente, residuo, cont;\n    int i = 0;\n    char cand[maximo+1];\n    char candidate[maximo+1];\n\n    while (index != 0)\n    {\n        cociente = index / alphalen;\n        residuo = index%alphalen;\n        cand[i] = residuo;\n        index = cociente;\n        i+=1;\n    }\n\n    for (cont=i-1; cont&gt;=0; cont--)  \n    {   \n        int pos = cand [cont];\n        candidate[i] = alpha[pos];      \n    }\n    return candidate;\n}\n</code></pre>\n\n<p>This generates one warning:</p>\n\n<ul>\n<li>return makes integer from pointer without a cast\n\n<ul>\n<li>return candidate;</li>\n</ul></li>\n</ul>\n\n<p>Can someone explain these warning?</p>\n"}, {"tags": ["c++", "c", "windows", "compilation", "wxwidgets"], "comments": [{"owner": {"reputation": 453, "user_id": 5128148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9952b45bc2ee14566935d8d86eb02b?s=128&d=identicon&r=PG&f=1", "display_name": "LBerger", "link": "https://stackoverflow.com/users/5128148/lberger"}, "edited": false, "score": 0, "creation_date": 1462392187, "post_id": 37036764, "comment_id": 61624122, "body": "I think you have to modify FindwxWidgets.cmake in cmake-3.x/share/cmake-3.x/modules. at line 468 you can insert wxWidgets-3.1.0. On my computer I have defined too wxDir=c:\\wxWidgets-3.1.0 and wxWin=c:\\wxWidgets-3.1.0"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1462458895, "post_id": 37036764, "comment_id": 61653779, "body": "@DiegoCoelho, did you compile the wxWidgets? If yes - did you use MinGW or VS? Keep in mind you can directly use VS to compile it and then link to you own project - no CMake is required.  OK, Looking at the question I believe you should declare wxwidgets_LIBRARIES and wxwidgets_INCLUDE_DIRS instead of the &quot;R3D_ALT...&quot; ones, just like the error says."}, {"owner": {"reputation": 1560, "user_id": 2030219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6314bf166040bf1eb9deb3a6c03d6864?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/2030219/joel"}, "edited": false, "score": 0, "creation_date": 1462458953, "post_id": 37036764, "comment_id": 61653826, "body": "<b>1.-</b> Do you have the lastest version of cmake?"}, {"owner": {"reputation": 21, "user_id": 6292500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SgwVQin-rkQ/AAAAAAAAAAI/AAAAAAAAABk/1XZirHq2JcM/photo.jpg?sz=128", "display_name": "Diego Coelho", "link": "https://stackoverflow.com/users/6292500/diego-coelho"}, "edited": false, "score": 0, "creation_date": 1462471501, "post_id": 37036764, "comment_id": 61661656, "body": "Joel, yes, I just downloaded/installed yesterday. Igor, Many thanks, I settled that yesterday and compiled with VS too (not only MinGW) and it worked!!! Many thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 5012918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6227136f7222e8f6d7f95d7e0d19df?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5012918/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1462394300, "creation_date": 1462394300, "answer_id": 37037568, "question_id": 37036764, "link": "https://stackoverflow.com/questions/37036764/problems-to-compile-source-code-with-wxwidgets-mingw-mode-on-windows-10/37037568#37037568", "title": "Problems to compile source code with wxWidgets (MinGW mode) on Windows 10", "body": "<p>I'm not very familiar with wxWidgets (so this should probably be a comment, but I can't comment because reasons......), but a quick hack that should work is just throwing the path to the library in LD_LIBRARY_PATH or including it by adding</p>\n\n<pre><code>CPPFLAGS += -L C:\\wxWidgets-3.1.0\\lib\\gcc_dll -I C:\\wxWidgets-3.1.0\\include\n</code></pre>\n\n<p>to your makefile.</p>\n\n<p>Failing that, you could explicitly set the environmental variables it's complaining about outside of the makefile.</p>\n\n<p>Again, sorry, this should be a comment. It's not... If someone wants to copy it to a comment and delete this, that'd be grand.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6292500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SgwVQin-rkQ/AAAAAAAAAAI/AAAAAAAAABk/1XZirHq2JcM/photo.jpg?sz=128", "display_name": "Diego Coelho", "link": "https://stackoverflow.com/users/6292500/diego-coelho"}, "is_accepted": false, "score": 0, "last_activity_date": 1462471683, "creation_date": 1462471683, "answer_id": 37057389, "question_id": 37036764, "link": "https://stackoverflow.com/questions/37036764/problems-to-compile-source-code-with-wxwidgets-mingw-mode-on-windows-10/37057389#37057389", "title": "Problems to compile source code with wxWidgets (MinGW mode) on Windows 10", "body": "<p>Thank all of you. Solved! Yesterday I compiled both with MinGW and VS and settled the wxWidgets-3.1.0_INCLUDE_DIRS and it worked!</p>\n"}], "owner": {"reputation": 21, "user_id": 6292500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SgwVQin-rkQ/AAAAAAAAAAI/AAAAAAAAABk/1XZirHq2JcM/photo.jpg?sz=128", "display_name": "Diego Coelho", "link": "https://stackoverflow.com/users/6292500/diego-coelho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1462471683, "creation_date": 1462391354, "last_edit_date": 1462391707, "question_id": 37036764, "link": "https://stackoverflow.com/questions/37036764/problems-to-compile-source-code-with-wxwidgets-mingw-mode-on-windows-10", "title": "Problems to compile source code with wxWidgets (MinGW mode) on Windows 10", "body": "<p>I am having serious problems to compile a code in Windows (regard3d at <a href=\"http://www.regard3d.org\" rel=\"nofollow\">http://www.regard3d.org</a>). I have read so many post (two days blocked on this problem) here at stackoverflow and other sites, but without success.</p>\n\n<p>The problem is that it needs wxWidgets. For that I am using MinGW. I have VS Community (the latest version). I run my CMakeLists.txt and everytime I get the message</p>\n\n<pre><code>Could NOT find wxWidgets (missing: wxwidgets_LIBRARIES wxwidgets_INCLUDE_DIRS)\n</code></pre>\n\n<p>I included the wxWidgets installation directory (which is <code>C:\\wxWidgets-3.1.0</code>) in <code>PATH</code> variable (I restarted to it takes effect) and created the variable <code>WXWIN</code> (that also contains the installation directory).</p>\n\n<p>The question: What can I do to solve it?</p>\n\n<p>I think the problem is not building the wxWidgets, but make it be found my cmake.  As mentioned, I built it using MinGW, thus I have the folder <code>C:\\wxWidgets-3.1.0\\lib\\gcc_dll</code> and the folder <code>C:\\wxWidgets-3.1.0\\include</code> which contains two more folders named <code>wx</code> and <code>msvc</code>. I am using the following settings before call the cmake:</p>\n\n<pre><code>set wxWidgets_ROOT_DIR=C:\\wxWidgets-3.1.0\nset R3D_ALT_wxWidgets_INCLUDE_DIRS=include\nset R3D_ALT_wxWidgets_LIBRARIES=lib\\gcc_dll \nset wxWidgets_CONFIG_EXECUTABLE=build\\msw \n</code></pre>\n"}, {"tags": ["c", "linux", "linker"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 2009075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d94d9bf96e9dc2dd49ea64f61f1b14?s=128&d=identicon&r=PG", "display_name": "mgambhir", "link": "https://stackoverflow.com/users/2009075/mgambhir"}, "edited": false, "score": 0, "creation_date": 1462392949, "post_id": 37036815, "comment_id": 61624546, "body": "Thank you for your response. Yes, that seems accurate! I changed one of the inflate calls to inflate_fast, which has version info in the libz symbol table. The version info gets added to my binary&#39;s symbol table. It also added a version dependency in .gnu.version_r section of my binary."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1462391552, "creation_date": 1462391552, "answer_id": 37036815, "question_id": 37036249, "link": "https://stackoverflow.com/questions/37036249/how-to-add-shared-library-version-info-in-the-symbol-table/37036815#37036815", "title": "How to add shared library version info in the symbol table", "body": "<p>Just because your libz contains versioning information does not mean that every symbol within is versioned.  In my libz (version 1.2.3 (yes, really)), some of the external symbols are versioned and some are not, as I can determine via <code>readelf</code>.  Specifically, all of the symbols you asked about are defined by my DSO, but none of them are versioned.</p>\n\n<p>If you link against unversioned symbols, you should neither expect nor want the corresponding symbol references in your binary to be versioned.</p>\n"}], "owner": {"reputation": 60, "user_id": 2009075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d94d9bf96e9dc2dd49ea64f61f1b14?s=128&d=identicon&r=PG", "display_name": "mgambhir", "link": "https://stackoverflow.com/users/2009075/mgambhir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 37036815, "answer_count": 1, "score": 0, "last_activity_date": 1462391731, "creation_date": 1462389577, "last_edit_date": 1462391731, "question_id": 37036249, "link": "https://stackoverflow.com/questions/37036249/how-to-add-shared-library-version-info-in-the-symbol-table", "title": "How to add shared library version info in the symbol table", "body": "<p>I wrote a small simple test program that uses libz. I compiled it using</p>\n\n<pre><code>$gcc -o test test.c -lz\n</code></pre>\n\n<p>To see how libz functions are added to my symbol table I ran the following command </p>\n\n<pre><code>$ readelf -s test | grep inflate\n</code></pre>\n\n<p>Here is the output </p>\n\n<pre><code> 1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflateEnd\n 8: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflate\n13: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflateInit_\n51: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflateEnd\n62: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflate\n73: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflateInit_\n</code></pre>\n\n<p>libz that I am using has .gnu.version_d section defined as follows </p>\n\n<pre><code>Version definition section '.gnu.version_d' contains 7 entries:\nAddr: 0x0000003175e014c0  Offset: 0x0014c0  Link: 4 (.dynstr)\n000000: Rev: 1  Flags: BASE   Index: 1  Cnt: 1  Name: libz.so.1\n0x001c: Rev: 1  Flags: none  Index: 2  Cnt: 1  Name: ZLIB_1.2.0\n0x0038: Rev: 1  Flags: none  Index: 3  Cnt: 2  Name: ZLIB_1.2.0.2\n0x0054: Parent 1: ZLIB_1.2.0\n0x005c: Rev: 1  Flags: none  Index: 4  Cnt: 2  Name: ZLIB_1.2.0.8\n0x0078: Parent 1: ZLIB_1.2.0.2\n0x0080: Rev: 1  Flags: none  Index: 5  Cnt: 2  Name: ZLIB_1.2.2\n0x009c: Parent 1: ZLIB_1.2.0.8\n0x00a4: Rev: 1  Flags: none  Index: 6  Cnt: 2  Name: ZLIB_1.2.2.3\n0x00c0: Parent 1: ZLIB_1.2.2\n0x00c8: Rev: 1  Flags: none  Index: 7  Cnt: 2  Name: ZLIB_1.2.2.4\n0x00e4: Parent 1: ZLIB_1.2.2.3\n</code></pre>\n\n<p>So why is libz version not part of libz function symbols in my symbol table. I expect to see something like - </p>\n\n<pre><code>1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND inflateEnd@@ZLIB_1.2.0\n...\n</code></pre>\n\n<p>Also .gnu.version_r section of my binary does not list libz version as a requirement. How can I add libz version dependency here? </p>\n\n<pre><code>$readelf -V test\n\n...\nVersion needs section '.gnu.version_r' contains 1 entries:\nAddr: 0x0000000000400618  Offset: 0x000618  Link: 6 (.dynstr)\n000000: Version: 1  File: libc.so.6  Cnt: 1\n 0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 2\n</code></pre>\n"}, {"tags": ["c", "struct", "constants"], "comments": [{"owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "edited": false, "score": 0, "creation_date": 1462390133, "post_id": 37036176, "comment_id": 61623011, "body": "const stands for constant value.a.k.a a value that a variable that cannot have its value changed. For example, this : <code>const int x=1;x=2;</code> will give an error. In my gcc version, the error will be <code>assignment of read-only variable x</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1462393932, "post_id": 37036176, "comment_id": 61625078, "body": "You can&#39;t make a dynamically-allocated structure immutable, because you have to modify it to assign the initial values after allocating it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "edited": false, "score": 0, "creation_date": 1462396694, "post_id": 37036176, "comment_id": 61626439, "body": "@Mike: This is wrong! C does not have symbolic constants, except <i>enum-constants</i>. <code>const</code> qualified objects are still variables, but the programmer guarantees not to change them, i.e. the value <b>will</b> not change. It very well <b>can</b> change if the programmer breaks this contract, resulting in undefined behaviour. The diagnostics by the compiler is kind of courtesy, but not guaranteed, e.g. if you cast away the <code>const</code> or use pointers (there are scenarios the compiler will not detect such cases even without a cast)."}], "answers": [{"comments": [{"owner": {"reputation": 1836, "user_id": 1642116, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/db9865f69b27f7844a4ba786f4e66cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Trauer", "link": "https://stackoverflow.com/users/1642116/trauer"}, "edited": false, "score": 0, "creation_date": 1462402081, "post_id": 37037847, "comment_id": 61628614, "body": "Very thorough answer, thank you. I actually dislike Java.  My preference for immutability comes from a functional background. Pure functions and immutable objects not only are beautiful, but easier to reason about, imo."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1462395338, "creation_date": 1462395338, "answer_id": 37037847, "question_id": 37036176, "link": "https://stackoverflow.com/questions/37036176/how-to-manipulate-an-array-of-structs-with-const-members/37037847#37037847", "title": "How to manipulate an array of structs with const members", "body": "<p><code>const</code> qualification of a type means that lvalue expressions of that type are not modifiable.  In particular, lvalues of <code>const</code> type or of composite type with at least one <code>const</code> member, recursively, cannot be the left-hand side of an assignment operator, and pointers to such objects cannot be <code>free()</code>d.</p>\n\n<p>Moreover, qualified, including <code>const</code>-qualified, types are different types from their unqualified counterparts and from differently-qualified versions of the underlying unqualifed type.  This has implications on compatibility of composite types that have qualified members.</p>\n\n<p>On the other hand, do not mistake <code>const</code> to be a promise that the value is actually constant.  It can be the case that the same object can designated by multiple lvalues, some <code>const</code> and others non-<code>const</code>.  In that case, the object can be modified via any of the non-<code>const</code> lvalues that designate it, and those modifications will be visible even via the <code>const</code> lvalues that designate it.</p>\n\n<p>With respect to the specifics of your question:</p>\n\n<ul>\n<li>I agree that your function <code>polygon2_create()</code> is valid and has well-defined behavior.  In particular, <code>const</code> members of a struct can be initialized in an initializer, and functions such as <code>memcpy()</code> can modify memory in which an object that can be referenced via a <code>const</code> lvalue is stored.  Your compiler might warn about the <code>memcpy()</code>, though.</li>\n<li>More generally, the initialization and assignment behavior and constraints you describe are correct.</li>\n<li>As for <code>poly-&gt;points[3] = (struct vector2){7.1, 5.3};</code>, how would it make sense for that to be acceptable if the members of <code>struct vector2</code> were <code>const</code>?  If allowed, the assignment certainly would modify them, and preventing that is exactly the point of <code>const</code>.  Or if you prefer a citation to authority, C2011 6.3.2.1/1 specifies that if a structure type has any <code>const</code> members, then lvalue expressions of that type are not modifiable.</li>\n</ul>\n\n<p>It sounds like you are confused about the semantics of whole-struct assignment.  If you assign one struct to a different struct, you are not replacing one struct with the other; rather you are copying the <em>value</em> of one struct to the other.  This is exactly analogous to assignments to simple types, such as <code>int</code>.</p>\n\n<p>You asked,</p>\n\n<blockquote>\n  <p>how can I achieve the following:</p>\n  \n  <ul>\n  <li>create a \"immutable\" vector2 struct</li>\n  </ul>\n</blockquote>\n\n<p>You already know how to do this, to the extent that it is possible.  If you make all the members <code>const</code> then they cannot be modified via an expression of type <code>struct vector2</code>.  As I remarked before, however, this does not confer absolute immutability.  C has no such thing.</p>\n\n<blockquote>\n  <ul>\n  <li>create a polygon struct whose points or count member can't be changed, but the things pointed by points can be 'swaped'.</li>\n  </ul>\n</blockquote>\n\n<p>I'm not sure I understand how an ability to swap points is consistent with your desired level of unmodifiability.  Certainly, if <code>struct vector2</code> has <code>const</code> members then you cannot assign to lvalue expressions of that type.  You could still perform swapping via <code>memcpy()</code>, though, or by casting to a modifiable type.  These mechanisms do, however, violate at least the spirit of <code>const</code>-ness.  Your compiler will likely warn about them.</p>\n\n<p>You could consider changing <code>points</code> from a <code>struct vector2 * const</code> to a <code>struct vector2 ** const</code>.  You can then swap the (non-<code>const</code>) <code>struct vector *</code> objects accessible via <code>*points</code>:</p>\n\n<pre><code>struct vector *temp = poly-&gt;points[3];\npoly-&gt;points[3] = poly-&gt;points[2];\npoly-&gt;points[2] = temp;\n</code></pre>\n\n<p>Your focus on immutability makes me wonder whether you come from a Java background; either way, that's more Java-esque, since all non-primitives in Java are references, which are more or less pointers.</p>\n\n<p>Overall, however, I think you are overly focused on immutability.  <code>const</code>-ness will cause you trouble, especially with memory management.  Consider doing without, at least for your struct members themselves.  At most, use <code>const</code> qualification on function parameter types to express that the function will not modify the actual argument, and perhaps on global variables where you want at least to be warned about any possibility that they will be modified.</p>\n"}], "owner": {"reputation": 1836, "user_id": 1642116, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/db9865f69b27f7844a4ba786f4e66cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Trauer", "link": "https://stackoverflow.com/users/1642116/trauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 37037847, "answer_count": 1, "score": 2, "last_activity_date": 1462395338, "creation_date": 1462389327, "last_edit_date": 1495540363, "question_id": 37036176, "link": "https://stackoverflow.com/questions/37036176/how-to-manipulate-an-array-of-structs-with-const-members", "title": "How to manipulate an array of structs with const members", "body": "<p>I'm trying to understand how 'const' works in C.\nWhat I would like to create is a <code>polygon struct</code> whose members cannot be mutated.</p>\n\n<p>I started by creating the following structs</p>\n\n<pre><code>struct vector2{\n    float x;\n    float y;\n};\n\nstruct polygon2{\n    const size_t count;\n    struct vector2* const points;\n};\n</code></pre>\n\n<p>To create a polygon I created the following function:</p>\n\n<pre><code>struct polygon2* polygon2_create(size_t count)\n{\n    struct vector2* points = calloc(count, sizeof *points);\n    struct polygon2 temp = {.count = count,\n                            .points = points};\n    struct polygon2* actual = malloc(sizeof *actual);\n    memcpy(actual, &amp;temp, sizeof(*actual));\n\n    return actual;\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/9691556/1642116\">I believe this function doesn't cause undefined behavior.</a></p>\n\n<p>This way I can do things like</p>\n\n<pre><code>struct polygon2* poly = polygon2_create(30);\npoly-&gt;points[3] = (struct vector2){7.1, 5.3};\n</code></pre>\n\n<p>But I can't do</p>\n\n<pre><code>poly-&gt;points = NULL;\n</code></pre>\n\n<p>Nor</p>\n\n<pre><code>poly-&gt;count = 3;\n</code></pre>\n\n<p>Which is great. I'm sure that I won't accidentally change the contents of <code>struct polygon</code>.</p>\n\n<p>But I'd like to make <code>vector2</code>'s members const too.\nIf I change <code>vector2</code> to:</p>\n\n<pre><code>struct vector2{\n    const float x;\n    const float y;\n};\n</code></pre>\n\n<p>I no longer am able to do this:</p>\n\n<pre><code>poly-&gt;points[3] = (struct vector2){7.1, 5.3};\n</code></pre>\n\n<p>I'd like to know why. I expected that making vector2's members const I wouldn't be able to do this</p>\n\n<pre><code>poly-&gt;points[3].x = 3\n</code></pre>\n\n<p>But I'd still be able to do this</p>\n\n<pre><code>poly-&gt;points = otherpoint;\n</code></pre>\n\n<p>Can someone explain what am I missing? And how can I achieve the following:</p>\n\n<ul>\n<li>create a \"immutable\" <code>vector2 struct</code></li>\n<li>create a <code>polygon struct</code> whose <code>points</code> or <code>count</code> member can't be changed, but the things pointed by <code>points</code> can be 'swaped'.</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1462388452, "post_id": 37035826, "comment_id": 61622085, "body": "<code>file = fp;</code> what is this?"}, {"owner": {"reputation": 2497, "user_id": 2399799, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/gThQZ.jpg?s=128&g=1", "display_name": "dan-man", "link": "https://stackoverflow.com/users/2399799/dan-man"}, "edited": false, "score": 1, "creation_date": 1462388472, "post_id": 37035826, "comment_id": 61622103, "body": "I think you need a pointer-pointer"}, {"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 2, "creation_date": 1462388557, "post_id": 37035826, "comment_id": 61622156, "body": "&quot;This code return&quot;.. not sure how, there are many errors: <a href=\"http://ideone.com/KpTFfw\" rel=\"nofollow noreferrer\">ideone.com/KpTFfw</a>"}, {"owner": {"reputation": 932, "user_id": 2426559, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07c882b7b629b021477a2427cbfa8458?s=128&d=identicon&r=PG", "display_name": "Phiber", "link": "https://stackoverflow.com/users/2426559/phiber"}, "edited": false, "score": 0, "creation_date": 1462388761, "post_id": 37035826, "comment_id": 61622283, "body": "there was a typo error, sorry. f=fp instaed of file=fp"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1462388875, "post_id": 37035826, "comment_id": 61622348, "body": "There&#39;s still a typo in the <code>printf</code>. You should always check your code before posting it. See <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>, especially the <b>verifiable</b> part."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462389517, "post_id": 37035826, "comment_id": 61622719, "body": "Please, please compile and test your actual MCVE and post what you have tested.  Anything else wastes everyone&#39;s time:("}, {"owner": {"reputation": 932, "user_id": 2426559, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07c882b7b629b021477a2427cbfa8458?s=128&d=identicon&r=PG", "display_name": "Phiber", "link": "https://stackoverflow.com/users/2426559/phiber"}, "edited": false, "score": 0, "creation_date": 1462389892, "post_id": 37035826, "comment_id": 61622902, "body": "The code is OK now, and there is solution in duplicated question ;)."}], "owner": {"reputation": 932, "user_id": 2426559, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07c882b7b629b021477a2427cbfa8458?s=128&d=identicon&r=PG", "display_name": "Phiber", "link": "https://stackoverflow.com/users/2426559/phiber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1462388605, "answer_count": 0, "score": 0, "last_activity_date": 1462389250, "creation_date": 1462388240, "last_edit_date": 1462389250, "question_id": 37035826, "link": "https://stackoverflow.com/questions/37035826/file-pointer-as-argument-by-reference-c", "closed_reason": "Duplicate", "title": "FILE * pointer as argument by reference C", "body": "<p>I want to pass <code>FILE*</code> as an argument to a function to modify it for reuse later.<br>\nExample:  </p>\n\n<pre><code>void main () {\n   FILE *file = NULL;\n   int getFile(file);\n   printf(\"file from main is :%x\", file);\n   // here i want to use fread ...etc\n}\nint getFile(FILE *f) {\n  FILE *fp = fopen(\"myfile.dat\", \"rb\");\n  if (fp == NULL) {\n    printf(\"failed to open file\\n\");\n    return 1;\n  }\n  f = fp;\n  printf(\"fp is :%x\", fp);\n  printf(\"file from getFile  is :%x\", f);\n  return 0;\n}\n</code></pre>\n\n<p>This code outputs:</p>\n\n<pre><code> fp is: e40009b0\n file from getFile is: e40009b0\n file from main is : 0\n</code></pre>\n\n<p>as you can see, the address of file is not changed (<code>NULL</code>). How I can change it in function the <code>getFile()</code> ?.<br>\nThank you</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1462388990, "post_id": 37035819, "comment_id": 61622408, "body": "nia[0].NIA  or you mean nia-&gt;NIA[0]?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462389024, "post_id": 37035819, "comment_id": 61622425, "body": "This works on my system. Having an explicit <code>\\0</code> in the string is unusual [and <i>not</i> recommended] but is <i>not</i> <code>UB</code>. The <code>strcpy</code> will stop at <i>it</i> even though the source string looks like: <code>&quot;11111\\0\\0&quot;</code>, so only 5 chars + EOS will be copied"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1462389216, "post_id": 37035819, "comment_id": 61622534, "body": "Runs clean here as well, and no complaints from <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1462389266, "post_id": 37035819, "comment_id": 61622560, "body": "I see nothing wrong with the code you presented, but although it is sufficiently minimal, it is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> because it is not <i>complete</i> (we will leave aside <i>verifiable</i> for a moment, because you cannot rely on verifying UB, which most certainly is occurring here).  Completeness requires presenting one or more complete translation units."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 3, "creation_date": 1462389307, "post_id": 37035819, "comment_id": 61622579, "body": "You&#39;re not showing your <code>#include</code> statements. I had to add some. You may have warnings that you&#39;re ignoring. Without a prototype, <code>malloc</code> might be interpreted as an <code>int</code> return and that would be bad on a 64 bit machine.  Be sure to <code>#include &lt;stdio.h&gt;</code> and <code>#include &lt;stdlib.h&gt;</code> and do <code>cc -Wall</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462389341, "post_id": 37035819, "comment_id": 61622602, "body": "My best guess is that the two functions presented see incompatible declarations of <code>struct Nia</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462389378, "post_id": 37035819, "comment_id": 61622626, "body": "It&#39;s possible that <code>malloc</code> is failing, since its return value is not checked."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462389495, "post_id": 37035819, "comment_id": 61622700, "body": "My bet is with @CraigEstey. The problem is the missing <code>#include &lt;stdlib.h&gt;</code>"}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462389758, "post_id": 37035819, "comment_id": 61622826, "body": "yes it is quite curious because i have tested it on codechef.com/ide and it works like a charm"}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462389833, "post_id": 37035819, "comment_id": 61622867, "body": "By the way i am using netbeans and yes i have all the includes required, it is very strange"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462389918, "post_id": 37035819, "comment_id": 61622911, "body": "On what system is it failing with what configuration? (i.e.) What OS, compiler, options, etc? Also, put it all in a single file and post that here. I&#39;ve code reviewed it [and tested] and it seems fine."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462390253, "post_id": 37035819, "comment_id": 61623075, "body": "Netbeans [as in Java]? Dude. Time to &quot;man up&quot; and go fully to C :-). Obviously, suspicious. More seriously, can you build with optimization off (e.g. <code>-O0</code> and <code>-g</code>) and run under a debugger (e.g. <code>gdb</code>)? You can step the program and examine values and <code>gdb</code> will catch the line number of the segfault. Or, run under <code>valgrind</code>"}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462390259, "post_id": 37035819, "comment_id": 61623082, "body": "@CraigEstey For completeness sake, on what environment did you test it without trouble?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 0, "creation_date": 1462390507, "post_id": 37035819, "comment_id": 61623184, "body": "@Mast Linux, fedora 22, gcc 5.3.1, an x86 64 bit desktop with 4 cores [with hyperthreading]. Using <i>no</i> optimization [or with <code>-O2</code> makes no difference]. <code>cc -o nia nia.c ; .&#47;nia</code> and my <code>nia.c</code> looks like ocket8888&#39;s"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1462390768, "post_id": 37035819, "comment_id": 61623336, "body": "Please add <code>if(nia  == NULL) {fprintf(stderr, &quot;out of memory\\n&quot;); exit(1); }</code> inside <code>prueba</code> function."}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462392215, "post_id": 37035819, "comment_id": 61624137, "body": "I am using netbeans in a mac os and here is the run of the program:"}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462392224, "post_id": 37035819, "comment_id": 61624143, "body": "cd &#39;/Users/mariomoliner/Desktop/Programaci&#243;n/P2/CppApplication_&zwnj;&#8203;1&#39; /usr/bin/make -f Makefile CONF=Debug &quot;/Library/Developer/CommandLineTools/usr/bin/make&quot; -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .build-conf &quot;/Library/Developer/CommandLineTools/usr/bin/make&quot;  -f nbproject/Makefile-Debug.mk dist/Debug/GNU-MacOSX/cppapplication_1 make[2]: `dist/Debug/GNU-MacOSX/cppapplication_1&#39; is up to date.  BUILD SUCCESSFUL (total time: 108ms)"}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462392281, "post_id": 37035819, "comment_id": 61624170, "body": "the output:   RUN FINISHED; exit value 0; real time: 10ms; user: 0ms; system: 0ms"}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "edited": false, "score": 0, "creation_date": 1462392327, "post_id": 37035819, "comment_id": 61624195, "body": "as you can see it doesn&#39;t print the expected 11111 and now there is not segmentation fault by the way"}, {"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1462392739, "post_id": 37035819, "comment_id": 61624424, "body": "@M.Moliner I hope you&#39;re not expecting anyone to read that. If it&#39;s important, put it in the question and format it properly. That said, I noticed a &quot;cppapplication&quot; bit in there. Compile my code as C, not C++, you&#39;ll notice it works. <b>C and C++ are <i>not</i> the same language</b>, so you should update your tags if you want help with C++, not C."}, {"owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "reply_to_user": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1462393494, "post_id": 37035819, "comment_id": 61624865, "body": "@ocket8888 no thats the name of the project but it is actually in c, i guess i must be a netbeans error because it works for everybody except me"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1462439047, "post_id": 37035819, "comment_id": 61641031, "body": "@M.Moliner Why are you complicating things with <code>nia[0].NIA</code> ? There is also <code>(*nia).NIA</code> which is the same, but more simple will be <code>nia-&gt;NIA</code>  =&gt;&gt; <a href=\"http://ideone.com/wAN1Eh\" rel=\"nofollow noreferrer\">DEMO</a>"}, {"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1462470257, "post_id": 37035819, "comment_id": 61660796, "body": "@M.Moliner I just ran it on netbeans and it went fine, I think there might be a problem with your nb install"}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1462390670, "post_id": 37036518, "comment_id": 61623281, "body": "For completeness, add <code>#include &lt;stdio.h&gt;</code> and there should be <i>no</i> warnings."}, {"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462390759, "post_id": 37036518, "comment_id": 61623332, "body": "Yeah, and actually <code>strcpy</code> is from <code>string.h</code>, not <code>stdlib.h</code> :P"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462390827, "post_id": 37036518, "comment_id": 61623373, "body": "It&#39;s in mine, too. I forgot when I wrote the comment"}], "tags": [], "owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "is_accepted": false, "score": 1, "last_activity_date": 1462394721, "last_edit_date": 1462394721, "creation_date": 1462390538, "answer_id": 37036518, "question_id": 37035819, "link": "https://stackoverflow.com/questions/37035819/c-function-returning-a-pointer-to-a-struct/37036518#37036518", "title": "c function returning a pointer to a struct", "body": "<p>I compiled and ran the following test.c file on Linux Mint 64 bit using <code>gcc -o test test.c -Wall</code></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct Nia{\n    char NIA[6];\n};\n\nstruct Nia * prueba(){\n   struct Nia *nia = malloc(sizeof(struct Nia)*2);\n   strcpy(nia[0].NIA,\"11111\\0\");\n   strcpy(nia[1].NIA,\"11112\\0\");\n   return nia;\n }\n\n int main(int argc, char** argv) {\n\n   struct Nia *nia = prueba();\n\n   printf(\"%s\\n\",nia[0].NIA);\n\nreturn (EXIT_SUCCESS);\n\n}\n</code></pre>\n\n<p>it outputs <code>11111</code>, and compiles without complaint. Honestly, even if I omit the <code>include</code>d headers, it'll run, albiet with warnings, but your system may be different, so just include them and you should be fine. </p>\n\n<p>Of course, having thought about this some more, this can be problematic if you're using <strong>C++</strong> not <strong>C</strong>, which <strong>are not the same language</strong>. You see,  <code>g++</code> will have a problem with you assigning the <code>void*</code> value that <code>malloc()</code> returns to a symbol of type <code>Nia*</code>, whereas <code>gcc</code> is happy to make the conversion for you. A different C++ compiler, which you might be using, may allow you to compile it, but a <code>void</code> has no members, so the <code>NIA</code> member may not have been initialized, which results in a segfault when you try to print it.\nTo be absolutely sure, use a debugger and find where the memory access violation occurs.</p>\n\n<p>UPDATE: just ran this in Netbeans on the same system, went fine.</p>\n"}], "owner": {"reputation": 27, "user_id": 6292311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0fe6e7d691441749d12de8b10fbbe8?s=128&d=identicon&r=PG&f=1", "display_name": "herbert8", "link": "https://stackoverflow.com/users/6292311/herbert8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1462394721, "creation_date": 1462388225, "last_edit_date": 1462388275, "question_id": 37035819, "link": "https://stackoverflow.com/questions/37035819/c-function-returning-a-pointer-to-a-struct", "title": "c function returning a pointer to a struct", "body": "<p>i'm trying to create a function that returns a pointer to a struct here is the code:</p>\n\n<p>the struct:</p>\n\n<pre><code>struct Nia{\n    char NIA[6];\n};\n</code></pre>\n\n<p>the function:</p>\n\n<pre><code>struct Nia * prueba(){\n   struct Nia *nia = malloc(sizeof(struct Nia)*2);\n   strcpy(nia[0].NIA,\"11111\\0\");\n   strcpy(nia[1].NIA,\"11112\\0\");\n   return nia;\n }\n</code></pre>\n\n<p>main function: (it doesn't print anything but it should print 11111)</p>\n\n<pre><code>int main(int argc, char** argv) {\n\n   struct Nia *nia = prueba();\n\n   printf(\"%s\\n\",nia[0].NIA);\n\nreturn (EXIT_SUCCESS);\n\n}\n</code></pre>\n\n<p>where is the problem? i think i'm implemententing the pointers to the structs properly, isn't it?</p>\n\n<p>it returns a segmentation fault actually.</p>\n\n<p>thanks in advance!</p>\n"}, {"tags": ["c", "linux-kernel", "kernel", "linux-device-driver", "build-automation"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 6136683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1259c238f1eb1ead53567d5ad6bb8d76?s=128&d=identicon&r=PG&f=1", "display_name": "Ram Gupta", "link": "https://stackoverflow.com/users/6136683/ram-gupta"}, "is_accepted": true, "score": 3, "last_activity_date": 1462413961, "last_edit_date": 1462413961, "creation_date": 1462391593, "answer_id": 37036828, "question_id": 37035770, "link": "https://stackoverflow.com/questions/37035770/where-does-the-module-parameter-stored-while-loading-a-driver-module-with-module/37036828#37036828", "title": "Where does the module parameter stored while loading a driver module with module parameter", "body": "<p>Options are provided in the configuration file for the module to be installed in the /etc/modprobe.d/ directory. So in your case if you create a file net_dev.conf in /etc/modprobe.d directory with the following line </p>\n\n<p>options net_dev hw_enable=1 </p>\n\n<p>and you call modprobe net_dev, it should execute modprobe net_dev hw_enable=1</p>\n"}], "owner": {"reputation": 50, "user_id": 4118614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3jOfF6S-93A/AAAAAAAAAAI/AAAAAAAAAA8/lltgD_y8D8U/photo.jpg?sz=128", "display_name": "Rahul Verma", "link": "https://stackoverflow.com/users/4118614/rahul-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 37036828, "answer_count": 1, "score": 0, "last_activity_date": 1462413961, "creation_date": 1462388090, "question_id": 37035770, "link": "https://stackoverflow.com/questions/37035770/where-does-the-module-parameter-stored-while-loading-a-driver-module-with-module", "title": "Where does the module parameter stored while loading a driver module with module parameter", "body": "<p>Where does the module parameter stored while loading a driver module with module parameter.I need to automate such that if i load a module it will load with that parameter enabled. eg\nif I need to load a module net_dev.ko with a module parameter hw_enable=1\nSo I need to do-</p>\n\n<pre><code>modprobe net_dev hw_enable=1 \n</code></pre>\n\n<p>to load it with that option\nBut I want when I do-</p>\n\n<pre><code>modprobe net_dev\n</code></pre>\n\n<p>It will automatically take hw_enable=1\nSo for that where should i kept this module parameter in the kernel?</p>\n"}, {"tags": ["c", "ruby", "garbage-collection", "internal", "internals"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462388577, "post_id": 37035739, "comment_id": 61622164, "body": "&quot;I&#39;d like to create String objects which reuse memory allocated by another binary.&quot; This sounds like a recipe for disaster. I&#39;d strongly encourage you to make a string work-alike that uses your custom allocator. Ruby will want to take ownership of any memory it&#39;s given and if this is allocated outside of the Ruby VM you may encounter seriously unpredictable behaviour. Duck typing is your friend here. Your string alternative might be transparently compatible if you do it right."}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462388998, "post_id": 37035739, "comment_id": 61622412, "body": "the problem with duck typing is that it is a lot of work to rewrite the entire String API, it&#39;s huge! Can you elaborate why it is problematic to allocate (and fill) the memory outside of the ruby VM?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462389256, "post_id": 37035739, "comment_id": 61622555, "body": "What if your string gets modified using <code>&lt;&lt;</code> which requires a buffer allocation? What about other forms of concatenation? What if a future version of Ruby rewrites how all of this is done for performance reasons or otherwise? There&#39;s a ton of things that can go wrong here. Writing your own work-alike that&#39;s 100% feature complete might not be easy, but covering the functions you&#39;re actually going to use wouldn&#39;t take long, and the rest can be handled by calling <code>custom_string.to_s</code> which emits a regular Ruby string."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462389295, "post_id": 37035739, "comment_id": 61622573, "body": "Your class could behave pretty closely to a frozen String object as you probably don&#39;t want people editing it. Depends on what restrictions that memory has if it&#39;s shared."}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462390194, "post_id": 37035739, "comment_id": 61623041, "body": "I see. The memory is not shared, as nothing but the ruby process would touch it after the String object is created. I think any implementation of String will have a pointer to the actual data, future ruby versions won&#39;t change that I guess. I want to use all the goodies a (frozen) Ruby String has to offer, like Regex matching etc, but strictly without copying the memory (unless a user modifies it of course). Is this not possible?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462392822, "post_id": 37035739, "comment_id": 61624469, "body": "I&#39;m just expressing caution here. The only way to find out for sure is to try."}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1462395793, "post_id": 37035739, "comment_id": 61626018, "body": "maybe you&#39;re right...I initially thought it would be good to combine Ruby with a far more lowlevel language like Rust for example, but the way Ruby handles data is fundamentally inefficient rearding ffi, especially strings. I&#39;m not sure it&#39;s worth the trouble...but I still want to know how this aspect of MRI works, out of curiosity!"}], "owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1462387991, "creation_date": 1462387991, "question_id": 37035739, "link": "https://stackoverflow.com/questions/37035739/how-does-mri-ruby-store-the-contents-of-a-string", "title": "How does MRI Ruby store the contents of a String?", "body": "<p><em>Primer</em>: This question is quite long, because I want to give an overview of my current understanding of the inner mechanisms of MRI and how I came to my conclusions. I want to understand the code better, so please correct me if any assumption I'm making is wrong.</p>\n\n<p>I'm trying to find out where MRI Ruby stores the data part (aka the contents) of a String, because I'd like to create String objects which reuse memory allocated by another binary (same allocator of course).</p>\n\n<p>Here's what I know so far:</p>\n\n<p>RString: internal representation of a String.</p>\n\n<pre><code>struct RString {\n    struct RBasic basic;\n    union {\n        struct {\n            long len;\n            char *ptr;\n            union {\n                long capa;\n                VALUE shared;\n            } aux;\n        } heap;\n        char ary[RSTRING_EMBED_LEN_MAX + 1];\n    } as;\n};\n</code></pre>\n\n<p><a href=\"https://github.com/ruby/ruby/blob/973ba3e8e24f4497aebcbd3819fc9c0f38a7909f/include/ruby/ruby.h#L980\" rel=\"nofollow\">reference</a></p>\n\n<p>From the above snippet I conclude that there are 2 ways the data can be stored:</p>\n\n<ol>\n<li>on the heap via the <code>heap</code> struct (<code>ptr</code> points to data)</li>\n<li>in the <code>ary</code> char array directly (probably some optimization)</li>\n</ol>\n\n<p>I'm only interested in the heap case.</p>\n\n<p><code>str_new0()</code> seems to be the most common way to create a String from a pointer to some string data and a length.</p>\n\n<pre><code>static VALUE\nstr_new0(VALUE klass, const char *ptr, long len, int termlen)\n{\n    VALUE str;\n\n    if (len &lt; 0) {\n        rb_raise(rb_eArgError, \"negative string size (or size too big)\");\n    }\n\n    RUBY_DTRACE_CREATE_HOOK(STRING, len);\n\n    str = str_alloc(klass);\n    if (len &gt; RSTRING_EMBED_LEN_MAX) {\n        RSTRING(str)-&gt;as.heap.aux.capa = len;\n        RSTRING(str)-&gt;as.heap.ptr = ALLOC_N(char, len + termlen);\n        STR_SET_NOEMBED(str);\n    }\n    else if (len == 0) {\n        ENC_CODERANGE_SET(str, ENC_CODERANGE_7BIT);\n    }\n    if (ptr) {\n        memcpy(RSTRING_PTR(str), ptr, len);\n    }\n    STR_SET_LEN(str, len);\n    TERM_FILL(RSTRING_PTR(str) + len, termlen);\n    return str;\n}\n</code></pre>\n\n<p><a href=\"https://github.com/ruby/ruby/blob/32674b167bddc0d737c38f84722986b0f228b44b/string.c#L659\" rel=\"nofollow\">reference</a></p>\n\n<p>Memory is allocated with the macro <code>ALLOC_N</code> which is <a href=\"https://github.com/ruby/ruby/blob/973ba3e8e24f4497aebcbd3819fc9c0f38a7909f/include/ruby/ruby.h#L1609\" rel=\"nofollow\">an alias</a> for RB_ALLOC_N which <a href=\"https://github.com/ruby/ruby/blob/973ba3e8e24f4497aebcbd3819fc9c0f38a7909f/include/ruby/ruby.h#L1603\" rel=\"nofollow\">expands</a> to <code>ruby_xmalloc2()</code> which <a href=\"https://github.com/ruby/ruby/blob/trunk/gc.c#L7885\" rel=\"nofollow\">calls</a> <code>objspace_xmalloc2()</code> which <a href=\"https://github.com/ruby/ruby/blob/trunk/gc.c#L7808\" rel=\"nofollow\">calls</a> <code>objspace_xmalloc0()</code>.</p>\n\n<p><em>Phew</em></p>\n\n<pre><code>static void *\nobjspace_xmalloc0(rb_objspace_t *objspace, size_t size)\n{\n    void *mem;\n\n    size = objspace_malloc_prepare(objspace, size);\n    TRY_WITH_GC(mem = malloc(size));\n    size = objspace_malloc_size(objspace, mem, size);\n    objspace_malloc_increase(objspace, mem, size, 0, MEMOP_TYPE_MALLOC);\n    return objspace_malloc_fixup(objspace, mem, size);\n}\n</code></pre>\n\n<p><a href=\"https://github.com/ruby/ruby/blob/trunk/gc.c#L7786\" rel=\"nofollow\">reference</a></p>\n\n<p>So here we are. <code>TRY_WITH_GC</code> seems to check if the allocation <code>mem = malloc(size)</code> succeeds and if not it tries again after a GC run I think.</p>\n\n<pre><code>#define TRY_WITH_GC(alloc) do { \\\n        objspace_malloc_gc_stress(objspace); \\\n        if (!(alloc) &amp;&amp; \\\n        (!garbage_collect_with_gvl(objspace, TRUE, TRUE, TRUE, GPR_FLAG_MALLOC) || /* full/immediate mark &amp;&amp; immediate sweep */ \\\n         !(alloc))) { \\\n            ruby_memerror(); \\\n        } \\\n    } while (0)\n</code></pre>\n\n<p><a href=\"https://github.com/ruby/ruby/blob/trunk/gc.c#L7762\" rel=\"nofollow\">reference</a></p>\n\n<p>Here's the first thing I'm unsure about: It seems to malloc just some memory (important: not in objspace). Is this the case? I don't know if they overwrote malloc somewhere to allocate GC friendly or whatever.</p>\n\n<p>OK after that they mutate objspace with <a href=\"https://github.com/ruby/ruby/blob/trunk/gc.c#L7667\" rel=\"nofollow\"><code>objspace_malloc_increase()</code></a> and friends. I don't understand what these functions do. They do not seem to store the pointer <code>mem</code> in <code>objspace</code>, but maybe I overlooked it. I need clarification here.</p>\n\n<p>As noted in the beginning I want to write code that creates a Ruby String, which uses memory allocated by some other binary, eg. C via FFI, of course with the system allocator. Do I have to register my \"foreign\" memory via the objspace_* functions? If yes, how does that exactly work? And are there subtleties when it comes to freeing the memory again? (I guess the GC does that, but what conditions must be true for this to work?)</p>\n\n<p>I hope my question is not too vague, I can ask more precisely if necessary!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1462387641, "post_id": 37035483, "comment_id": 61621600, "body": "What is <code>myException</code>? An <code>int</code>?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462387714, "post_id": 37035483, "comment_id": 61621643, "body": "It&#39;s like this.  You will spend, liike, 1% of your time writing code and 90% time debugging and testing.  Imagine stepping through this code and needing to check values.  Which is easiest?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1462388035, "post_id": 37035483, "comment_id": 61621832, "body": "With MSVC 2015 it doesn&#39;t even generate any instructions for either function. It just optimizes them away completely."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1462388087, "post_id": 37035483, "comment_id": 61621863, "body": "@flatmouse, shouldn&#39;t and can&#39;t. It is an externally visible function with return value depending on input, it can&#39;t optimize it away."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1462388371, "post_id": 37035483, "comment_id": 61622037, "body": "Unless you&#39;ve travelled here from the distant past, a local primitive variable  has no cost whatsoever. Division is the more expensive operation by far, and that in turn will often be dwarfed by the branch. (A beginner&#39;s intuition about performance is usually approximately 100% wrong.)"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1462388463, "post_id": 37035483, "comment_id": 61622096, "body": "@SergeyA It can, and it has. I&#39;ve posted the surprising result as an additional answer."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1462388878, "post_id": 37035483, "comment_id": 61622354, "body": "@molbdnilo, it doesn&#39;t even have to be a branch!"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1462390059, "post_id": 37035483, "comment_id": 61622973, "body": "@molbdnilo:  When you say &quot;a beginner&#39;s intuition&quot; - I have managed to intuit where the performance hotspot was in my code twice so far.  That <i>is</i> twice in 35 years!"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1462387200, "creation_date": 1462387200, "answer_id": 37035515, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice/37035515#37035515", "title": "Allocating a temporary variable or compute the expression twice", "body": "<p>Use the later.</p>\n\n<ol>\n<li>You're not computing the same value twice.</li>\n<li>The code is more clear.</li>\n<li>Creating local variables on the stack doesn't take any significant amount of time.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 14, "last_activity_date": 1462387914, "last_edit_date": 1462387914, "creation_date": 1462387367, "answer_id": 37035572, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice/37035572#37035572", "title": "Allocating a temporary variable or compute the expression twice", "body": "<p>Don't worry about it, write concise code and leave micro-optimizations to the compiler. </p>\n\n<p>In your example writing the same calculation twice is error prone - so do not do this. In your specific example, compiler is more than likely to avoid creating a temporary on the stack at all!</p>\n\n<p>Your example can (does on my compiler) produce following assembly (i have replaced <code>myConst</code> with <code>constexpr</code> 42 and <code>myException</code> with 0):</p>\n\n<pre><code>foo(int, int, int):\n        leal    (%rdi,%rsi), %eax       # this adds a and b, puts result to eax\n        movl    %edx, %ecx      # loads c\n        cltd\n        idivl   %ecx  # performs division, puts result into edx\n        movl    $0, %eax        #, prepares to return exception value\n        cmpl    $42, %edx       #, compares result of division with magic const\n        cmovne  %edx, %eax  # overwrites pessimized exception if all is cool\n        ret\n</code></pre>\n\n<p>As you see, there is no temporary anywhere in sight!</p>\n"}, {"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 5, "last_activity_date": 1462387446, "creation_date": 1462387446, "answer_id": 37035596, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice/37035596#37035596", "title": "Allocating a temporary variable or compute the expression twice", "body": "<p>Check the assembler code this generates for both versions. You most likely want the highest optimization settings for your compiler.</p>\n\n<p>You may very well find out the compiler itself can figure out the intermediate value is used twice, but only inside the function, so safe to store in a register.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1462388133, "post_id": 37035717, "comment_id": 61621892, "body": "I like the &#39;less posts on SO&#39; as a valid reason to go with a better code!"}], "tags": [], "owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "is_accepted": false, "score": 4, "last_activity_date": 1462387919, "creation_date": 1462387919, "answer_id": 37035717, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice/37035717#37035717", "title": "Allocating a temporary variable or compute the expression twice", "body": "<p>To add to what has already been posted, ease of debugging is at least as important as code efficiency, (if there is any effect on code efficiency which, as others have posted, is unlikely with optimization on).</p>\n\n<p>Go with the easiest to follow, test and debug.</p>\n\n<p>Use a temp var.</p>\n\n<p>If more developers used simpler, non-compound expressions and more temp vars, there would be far fewer 'Help - I cannot debug my code!' posts to SO.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1462388603, "post_id": 37035861, "comment_id": 61622186, "body": "Never put <code>main()</code> (or compile into executable) when you want to test function-specific optimizations. It is going to inline aggressively, and shortcut all evaluations. If you must use <code>main()</code>, make sure to pass arguments of main to your check function, but better yet just not have it and compile into .o"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1462389051, "post_id": 37035861, "comment_id": 61622434, "body": "@SergeyA Even if I pass the arguments it still optimizes the functions away. I understand to call from another compilation unit it will be forced to do without the full optimization. Either way I think this supports the argument that it is not worth a programmer&#39;s time to worry about this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462389271, "post_id": 37035861, "comment_id": 61622565, "body": "Where does OP say he calls the function with hard-coded values? If that were so, why would you need a function to do it, or the compiler to optimise the function away? Did you mean that the compiler effectively converts the function to <code>inline</code>?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462389747, "post_id": 37035861, "comment_id": 61622823, "body": "@WeatherVane With hardcoded values it is not even inlined. It&#39;s optimized away completely."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462389985, "post_id": 37035861, "comment_id": 61622943, "body": "What was the point of that then? OP says nothing about hardcoded values, possibly except for <code>myConst</code>. Are you answering a question that was not asked? Please input the values from a keyboard at runtime, not in the source code that a smart compiler can detect."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462391034, "post_id": 37035861, "comment_id": 61623478, "body": "@WeatherVane True, this doesn&#39;t show the general case."}], "tags": [], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "is_accepted": false, "score": 0, "last_activity_date": 1462391163, "last_edit_date": 1462391163, "creation_date": 1462388379, "answer_id": 37035861, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice/37035861#37035861", "title": "Allocating a temporary variable or compute the expression twice", "body": "<h2>Hard coded values</h2>\n\n<p>The following only applies to hard coded values (even if they aren't <code>const</code> or <code>constexpr</code>)</p>\n\n<p>In the following example on MSVC 2015 they were optimized away completely and replaced only with <code>mov edx, result</code> (=1 in this example):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;exception&gt;\n\nint myConst{4};\nint myException{2};\n\nint foo1(int a,int b,int c)\n{\n    return (((a + b) % c) != myConst) ? (a + b) % c : myException;\n}\n\nint foo2(int a,int b,int c)\n{\n    int tmp = (a + b) % c;\n    return (tmp != myConst) ? tmp : myException;\n}\n\nint main()\n{\n00007FF71F0E1000 48 83 EC 28          sub         rsp,28h  \n    auto test1{foo1(5,2,3)};\n    auto test2{foo2(5,2,3)};\n\n    std::cout &lt;&lt; test1 &lt;&lt;'\\n';\n00007FF71F0E1004 48 8B 0D 75 20 00 00 mov         rcx,qword ptr [__imp_std::cout (07FF71F0E3080h)]  \n00007FF71F0E100B BA 01 00 00 00       mov         edx,1  \n00007FF71F0E1010 FF 15 72 20 00 00    call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF71F0E3088h)]  \n00007FF71F0E1016 48 8B C8             mov         rcx,rax  \n00007FF71F0E1019 E8 B2 00 00 00       call        std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt; &gt; (07FF71F0E10D0h)  \n    std::cout &lt;&lt; test2 &lt;&lt;'\\n';\n00007FF71F0E101E 48 8B 0D 5B 20 00 00 mov         rcx,qword ptr [__imp_std::cout (07FF71F0E3080h)]  \n00007FF71F0E1025 BA 01 00 00 00       mov         edx,1  \n00007FF71F0E102A FF 15 58 20 00 00    call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF71F0E3088h)]  \n00007FF71F0E1030 48 8B C8             mov         rcx,rax  \n00007FF71F0E1033 E8 98 00 00 00       call        std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt; &gt; (07FF71F0E10D0h)  \n\n\n    return 0;\n00007FF71F0E1038 33 C0                xor         eax,eax  \n}\n00007FF71F0E103A 48 83 C4 28          add         rsp,28h  \n00007FF71F0E103E C3                   ret  \n</code></pre>\n\n<p>At this point other have pointed out that the optimization will not happen if the values were passed, or if we had separate files, but it seems even if the code is in separate compilation units the optimization is still done and we don't get any instructions for these functions:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;exception&gt;\n\n\n#include \"Header.h\"\n\nint main()\n{\n00007FF667BF1000 48 83 EC 28          sub         rsp,28h  \n    int var1{5},var2{2},var3{3};\n    auto test1{foo1(var1,var2,var3)};\n    auto test2{foo2(var1,var2,var3)};\n\n    std::cout &lt;&lt; test1 &lt;&lt;'\\n';\n00007FF667BF1004 48 8B 0D 75 20 00 00 mov         rcx,qword ptr [__imp_std::cout (07FF667BF3080h)]  \n00007FF667BF100B BA 01 00 00 00       mov         edx,1  \n00007FF667BF1010 FF 15 72 20 00 00    call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF667BF3088h)]  \n00007FF667BF1016 48 8B C8             mov         rcx,rax  \n00007FF667BF1019 E8 B2 00 00 00       call        std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt; &gt; (07FF667BF10D0h)  \n    std::cout &lt;&lt; test2 &lt;&lt;'\\n';\n00007FF667BF101E 48 8B 0D 5B 20 00 00 mov         rcx,qword ptr [__imp_std::cout (07FF667BF3080h)]  \n00007FF667BF1025 BA 01 00 00 00       mov         edx,1  \n00007FF667BF102A FF 15 58 20 00 00    call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF667BF3088h)]  \n00007FF667BF1030 48 8B C8             mov         rcx,rax  \n00007FF667BF1033 E8 98 00 00 00       call        std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt; &gt; (07FF667BF10D0h)  \n\n\n    return 0;\n00007FF667BF1038 33 C0                xor         eax,eax  \n}\n00007FF667BF103A 48 83 C4 28          add         rsp,28h  \n00007FF667BF103E C3                   ret  \n</code></pre>\n"}], "owner": {"reputation": 684, "user_id": 3281352, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4174ed63dead565d6beaef12fc2ad03a?s=128&d=identicon&r=PG&f=1", "display_name": "Tandura", "link": "https://stackoverflow.com/users/3281352/tandura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "closed_date": 1605968794, "accepted_answer_id": 37035572, "answer_count": 5, "score": 5, "last_activity_date": 1488817683, "creation_date": 1462387110, "last_edit_date": 1488817683, "question_id": 37035483, "link": "https://stackoverflow.com/questions/37035483/allocating-a-temporary-variable-or-compute-the-expression-twice", "closed_reason": "Duplicate", "title": "Allocating a temporary variable or compute the expression twice", "body": "<p>I am trying to write a code as efficient as possible and I encountered the following situation:  </p>\n\n<pre><code>int foo(int a, int b, int c) \n{\n    return (a + b) % c; \n}\n</code></pre>\n\n<p>All good! But what if I want to check if the result of the expression to be different of a constant lets say <code>myConst</code>. Lets say I can afford a temporary variable. </p>\n\n<p>What method is the fastest of the following:</p>\n\n<pre><code>int foo(int a, int b, int c) \n{\n    return (((a + b) % c) != myConst) ? (a + b) % c : myException; \n} \n</code></pre>\n\n<p>or</p>\n\n<pre><code>int foo(int a, int b, int c) \n{\n    int tmp = (a + b) % c\n    return (tmp != myConst) ? tmp : myException; \n}\n</code></pre>\n\n<p>I can't decide. Where is the 'line' where recalculation is more expensive than allocating and deallocating a temporary variable or the other way around.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 0, "creation_date": 1462387161, "post_id": 37035382, "comment_id": 61621294, "body": "What you mean when you say consistent on both? What happen if from the side of sender the enum fits in a byte, but not on receiver?"}, {"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "reply_to_user": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 0, "creation_date": 1462387292, "post_id": 37035382, "comment_id": 61621382, "body": "@Rama : are you sending data between machines that have different definitions of what a &quot;byte&quot; is?"}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "edited": false, "score": 0, "creation_date": 1462387419, "post_id": 37035382, "comment_id": 61621456, "body": "Well, heh, once upon a time the <i>byte</i> definition was a bit vague, but with the half-century-ago death of the all-caps-fortran-program on a CDC x600 all bytes have been at least 8 bits. You can count on that.  (Anyway, network <i>octets</i> are defined as 8 bits, and at least one standard now defines <i>byte</i> that way.)"}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1462387604, "post_id": 37035382, "comment_id": 61621574, "body": "@DanielKamilKozar Just different platforms, is a generic question, maybe if I don&#39;t care, for this example work well, but I&#39;m trying to do the right thing here according to the standards."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462389824, "post_id": 37035382, "comment_id": 61622859, "body": "I don&#39;t see a consistency issue here, because the parameter types and return types of the <code>hton*()</code> and <code>ntoh*()</code> functions are exact-width unsigned integers, variously <code>uint16_t</code> and <code>uint32_t</code>.  This is purposeful, of course, precisely to avoid any possibility of inconsistency with respect to types."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 0, "creation_date": 1462394048, "post_id": 37035382, "comment_id": 61625124, "body": "Edited for 2 conflicting enums."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4832129"}, "reply_to_user": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 0, "creation_date": 1462396334, "post_id": 37035382, "comment_id": 61626271, "body": "@Rama, By consistent he meant that if you use <code>htons</code> for example on the sender side then you have to use <code>ntohs</code> on the receiver. As said, the value matters. For your <code>n_test_large_enum</code> you have to use htonl/ntohl pair. The differences between sizes of types will vanish on the call when appropriate conversions will be made if needed."}], "tags": [], "owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "is_accepted": true, "score": 3, "last_activity_date": 1462386761, "creation_date": 1462386761, "answer_id": 37035382, "question_id": 37035341, "link": "https://stackoverflow.com/questions/37035341/htons-htonl-ntohs-ntohl-for-enums/37035382#37035382", "title": "htons(), htonl(), ntohs(), ntohl() for enums", "body": "<p>Only the value matters, as long as both sides agree on the encoding.</p>\n\n<p>So, as long as your value will fit in a short, then <code>htons()</code> or <code>htonl()</code> will work, if consistent on both sides.</p>\n\n<p>And if it really fits in a byte, just send that, making the whole byte-order issue vanish.</p>\n"}], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 37035382, "answer_count": 1, "score": 1, "last_activity_date": 1462393510, "creation_date": 1462386593, "last_edit_date": 1462393510, "question_id": 37035341, "link": "https://stackoverflow.com/questions/37035341/htons-htonl-ntohs-ntohl-for-enums", "title": "htons(), htonl(), ntohs(), ntohl() for enums", "body": "<p>I need to send a a buffer of enums between a server and a client that could be in different platform.</p>\n\n<p>But the size of enums is platform dependent, which function should I call? (<code>htons() or htonl()</code>), for example for the following enum :</p>\n\n<pre><code>typedef enum f_test_enum{\nF0 = 0,\nF1 = 1,\nF2 = 2,\nF3 = 3\n} f_test_type;\n</code></pre>\n\n<p>Remember C Standard (C99): <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf\" rel=\"nofollow\">http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf</a></p>\n\n<p>6.7.2.2 Enumeration specifiers</p>\n\n<p>[...] </p>\n\n<blockquote>\n  <p>Constraints The expression that defines the value of an enumeration\n  constant shall be an integer constant expression that has a value\n  representable as an int.</p>\n</blockquote>\n\n<p>[...] </p>\n\n<blockquote>\n  <p>Each enumerated type shall be compatible with char, a signed integer\n  type, or an unsigned integer type. The choice of type is\n  implementation-defined, but shall be capable of representing the\n  values of all the members of the enumeration.</p>\n</blockquote>\n\n<p>[EDITED]\nWhat if my enum is:</p>\n\n<pre><code>typedef enum n_test_large_enum{\nN1 = 0,\nN2 = 1,\nN2 = 2,\nN120000 = 120000\n} n_test_large_type;\n</code></pre>\n\n<p>or maybe:</p>\n\n<pre><code>typedef enum n_test_short_enum{\nN0 = 0,\nN1 = 1,\nN2 = 2,\nN60000 = 60000\n} n_test_short_type;\n</code></pre>\n\n<p>When I use hton*() or ntoh*() should I take care about posible values for enums? Can I take the same behavior for all enums?</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1462385325, "post_id": 37034939, "comment_id": 61620131, "body": "You do know that there are other format specifiers for <code>printf()</code> other than <code>%s</code>?"}, {"owner": {"reputation": 63, "user_id": 6292211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBs9E.jpg?s=128&g=1", "display_name": "Francisco Catarrinho", "link": "https://stackoverflow.com/users/6292211/francisco-catarrinho"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1462385636, "post_id": 37034939, "comment_id": 61620357, "body": "You&#39;re right, stupidity of me... i&#39;ve only been recently leaning C and i forgot that i coul use %c and *token. Thank you"}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "edited": false, "score": 1, "creation_date": 1462395097, "post_id": 37034939, "comment_id": 61625648, "body": "you should accept the answer from @Carey Gregory as it is correct"}], "answers": [{"tags": [], "owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "is_accepted": true, "score": 11, "last_activity_date": 1462385362, "creation_date": 1462385362, "answer_id": 37035000, "question_id": 37034939, "link": "https://stackoverflow.com/questions/37034939/c-printing-first-letter-of-a-string-using-pointers/37035000#37035000", "title": "C - Printing first letter of a string using pointers", "body": "<p>Very simply:</p>\n\n<pre><code>printf(\"%c\\n\", *token);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>printf(\"%c\\n\", token[0]);\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6292211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBs9E.jpg?s=128&g=1", "display_name": "Francisco Catarrinho", "link": "https://stackoverflow.com/users/6292211/francisco-catarrinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1303, "favorite_count": 0, "accepted_answer_id": 37035000, "answer_count": 1, "score": 1, "last_activity_date": 1583054288, "creation_date": 1462385174, "last_edit_date": 1583054288, "question_id": 37034939, "link": "https://stackoverflow.com/questions/37034939/c-printing-first-letter-of-a-string-using-pointers", "title": "C - Printing first letter of a string using pointers", "body": "<p>Im currently working on a project for college and i have the following function, which receives a line (string) and divides it into words:</p>\n\n<pre><code>static const char separators[] = {' ','\\t',',',';','.','?','!','\"','\\n',':','\\0'}; \n\nvoid split(char *line){\n    char *token = strtok(line, separators);\n    while(token!=NULL) {\n        strtolower(token);\n        printf(\"%s \\n\", token);\n        /* rest of code belongs here */\n        token = strtok(NULL, separators);\n    }\n}\n</code></pre>\n\n<p>For testing purposes, I wanted to print the first letter of the string <code>token</code>, however it prints the whole string and whenever i use other methods <code>(*token, token[0])</code> it creates an error stating that <code>%s</code> expects type <code>*char</code> and not <code>int</code>. </p>\n\n<p>How can i print only the first letter of the string, for future implementation in my code?</p>\n"}, {"tags": ["c", "eglibc"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 6, "creation_date": 1462385557, "post_id": 37034869, "comment_id": 61620298, "body": "Looks like loop unrolling: <a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Loop_unrolling</a>"}, {"owner": {"reputation": 597, "user_id": 4304746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100005754678803/picture?type=large", "display_name": "Baroudi Safwen", "link": "https://stackoverflow.com/users/4304746/baroudi-safwen"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462386402, "post_id": 37034869, "comment_id": 61620817, "body": "@SteveSummit thank you so much for the information."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462398541, "post_id": 37034869, "comment_id": 61627322, "body": "One more step and you&#39;d have Duff&#39;s device ..."}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 6, "last_activity_date": 1462399291, "last_edit_date": 1462399291, "creation_date": 1462398240, "answer_id": 37038592, "question_id": 37034869, "link": "https://stackoverflow.com/questions/37034869/the-implementation-of-strncmp/37038592#37038592", "title": "The implementation of strncmp", "body": "<p>It's an <a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\" rel=\"nofollow\">unrolled loop</a>. At the cost of making the binary a little larger, it speeds up string comparisons by eliminating 3 decrements, 3 branches and 3 conditionals for each 4 bytes to compare.</p>\n\n<p>The optimizing could even have been taken a step further by using the same technique as <a href=\"https://en.wikipedia.org/wiki/Duff%27s_device\" rel=\"nofollow\">Duff's device</a>, though it's not clear this would actually be faster. From the linked page,</p>\n\n<blockquote>\n  <p>This automatic handling of the remainder may not be the best solution on all systems and compilers \u2013 in some cases two loops may actually be faster (one loop, unrolled, to do the main copy, and a second loop to handle the remainder). The problem appears to come down to the ability of the compiler to correctly optimize the device; it may also interfere with pipelining and branch prediction on some architectures. When numerous instances of Duff's device were removed from the XFree86 Server in version 4.0, there was an improvement in performance and a noticeable reduction in size of the executable. Therefore, when considering using this code, it may be worth running a few benchmarks to verify that it actually is the fastest code on the target architecture, at the target optimization level, with the target compiler.</p>\n</blockquote>\n"}], "owner": {"reputation": 597, "user_id": 4304746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100005754678803/picture?type=large", "display_name": "Baroudi Safwen", "link": "https://stackoverflow.com/users/4304746/baroudi-safwen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "accepted_answer_id": 37038592, "answer_count": 1, "score": 3, "last_activity_date": 1462399291, "creation_date": 1462384936, "question_id": 37034869, "link": "https://stackoverflow.com/questions/37034869/the-implementation-of-strncmp", "title": "The implementation of strncmp", "body": "<p>To hone my C skills, I download the eglibc source code and I came across strncpy. I don't see why he distinguished the case where n&lt;=4 and made 4 tests. </p>\n\n<pre><code>int\nSTRNCMP (const char *s1, const char *s2, size_t n)\n{\n  unsigned char c1 = '\\0';\n  unsigned char c2 = '\\0';\n\n  if (n &gt;= 4)\n    {\n      size_t n4 = n &gt;&gt; 2;\n      do\n    {\n      c1 = (unsigned char) *s1++;\n      c2 = (unsigned char) *s2++;\n      if (c1 == '\\0' || c1 != c2)\n        return c1 - c2;\n      c1 = (unsigned char) *s1++;\n      c2 = (unsigned char) *s2++;\n      if (c1 == '\\0' || c1 != c2)\n        return c1 - c2;\n      c1 = (unsigned char) *s1++;\n      c2 = (unsigned char) *s2++;\n      if (c1 == '\\0' || c1 != c2)\n        return c1 - c2;\n      c1 = (unsigned char) *s1++;\n      c2 = (unsigned char) *s2++;\n      if (c1 == '\\0' || c1 != c2)\n        return c1 - c2;\n    } while (--n4 &gt; 0);\n      n &amp;= 3;\n    }\n\n  while (n &gt; 0)\n    {\n      c1 = (unsigned char) *s1++;\n      c2 = (unsigned char) *s2++;\n      if (c1 == '\\0' || c1 != c2)\n    return c1 - c2;\n      n--;\n    }\n\n  return c1 - c2;\n}\n</code></pre>\n\n<p>May be it has something to do with the memory layout i don't know, please enlighten me.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462384763, "post_id": 37034714, "comment_id": 61619783, "body": "An assertion encoded into the <code>malloc()</code> function failed.  Supposing that that function uses assertions as intended, that means that a supposed invariant on which that function relies (and given in the text of the error message) was found at runtime to not be satisfied.  This very likely results from your code overrunning the bounds of dynamically allocated storage, using a pointer after the block to which it once pointed was freed, or double-freeing a pointer."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1462384946, "post_id": 37034714, "comment_id": 61619908, "body": "<code>item=malloc(sizeof(item));</code> --&gt;&gt; <code>item=malloc(sizeof *item);</code> for a start. (and a good reason not to name your objects the same as your types. Or even better: don&#39;t use typedefs at all)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1462385001, "post_id": 37034714, "comment_id": 61619938, "body": "One thing I noticed: you have <code>void create_item(item* fitem)</code>.  It looks like it constructs a new item.  But it doesn&#39;t actually return that item; it loses it.  If you were hoping top use the <code>fitem</code> parameter to pass back the new item, this is not the way to do it, it doesn&#39;t work."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1462385171, "post_id": 37034714, "comment_id": 61620044, "body": "Yes, using the same identifier for a type name <code>foo</code> and a variable name <code>foo</code> is asking for trouble when you do <code>sizeof(foo)</code>. It will use whichever one is in the innermost scope."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1462385282, "post_id": 37034714, "comment_id": 61620110, "body": "I suggest renaming your types from <code>foo</code> to <code>foo_t</code> to avoid confusion, or just get rid of the typedefs and use <code>struct foo</code> instead."}, {"owner": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462385387, "post_id": 37034714, "comment_id": 61620183, "body": "wildplasser: i created the function <code>create_item</code>  the same way i made  <code>create_queue </code> as you can see.Before <code>create_queue</code> worked fine.why i must change <code>item=malloc(sizeof(item));</code> to this? <code>item=malloc(sizeof *item);</code>  can you explain it to me? thanks"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1462385400, "post_id": 37034714, "comment_id": 61620190, "body": "<code>client=malloc(sizeof(client));</code>. What value will <code>sizeof(client)</code> return? <code>sizeof(struct client)</code> or <code>sizeof(struct client *)</code>?"}, {"owner": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462385529, "post_id": 37034714, "comment_id": 61620275, "body": "Steve Summit: I use <code>fitem</code> as a head node input."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1462386035, "post_id": 37034714, "comment_id": 61620590, "body": "@IanAbbott, beware.  POSIX reserves the type suffix <code>_t</code> for itself and implementations."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462387987, "post_id": 37034714, "comment_id": 61621802, "body": "@JohnBollinger That&#39;s true, but I&#39;ve been using <code>_t</code> for [at least] two decades and have never had a conflict [it&#39;s also a common practice]. The probability is <i>low</i>. It requires that one add a <code>#include</code> for a <i>new</i> posix <code>.h</code> in the same file with a conflict, so if you only include in other files, you&#39;re fine. Also, if you have to resolve the conflict, it&#39;s an easy global edit to change (e.g. <code>client_t</code> into <code>myclient_t</code>). (i.e.) A one time event to fix. Also, IMO, it&#39;s hubris for posix to prereserve all <code>_t</code>. I&#39;d be fine with a prefix: (like <code>posix_madvise</code>) or <code>posix_caddr_t</code>"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462386249, "post_id": 37035130, "comment_id": 61620710, "body": "In your opinion should i just change the name of the variables or stop using <code>typedef</code> at all?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462386419, "post_id": 37035130, "comment_id": 61620830, "body": "The suggestions in my answer are cumulative.  I recommend all of them together, as demonstrated in my example.  However, any one of them would be sufficient by itself to solve the actual problem.  But beware: your code has additional problems beyond the one you asked about, as described in some of the comments on the question itself."}, {"owner": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462386706, "post_id": 37035130, "comment_id": 61621019, "body": "Thanks for you answer it was very helpful.You said that my code has additional problems.Can you point them?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "edited": false, "score": 0, "creation_date": 1462386903, "post_id": 37035130, "comment_id": 61621149, "body": "@JohnVn Follow [other] John&#39;s advice. But, I&#39;d change the variable names. (e.g.) In <code>create_queue</code>, you have <code>client *client,*cur</code>. Using <code>cur</code> is fine--it is <i>descriptive</i> of its function. But, <code>client</code> is vague as to role [yes, it&#39;s a <code>client</code> type, but <i>which</i> one for <i>which</i> purpose?]. I&#39;d rename it to <code>new</code> [not valid in <code>c++</code>] or <code>newclient</code> so that it&#39;s more descriptive and avoids the conflict."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1462386215, "last_edit_date": 1462386215, "creation_date": 1462385883, "answer_id": 37035130, "question_id": 37034714, "link": "https://stackoverflow.com/questions/37034714/linked-list-inside-linked-lists/37035130#37035130", "title": "linked list inside linked lists", "body": "<p>As I wrote in my comment, the error message probably means you are misusing dynamically allocated memory in some way.  Looking at your code, that indeed appears to be the case.  You have multiple instances of this pattern:</p>\n\n<pre><code>typedef struct foo foo;\n\nstruct foo {\n    // elements ...\n};\n\nvoid f() {\n    foo *foo;\n    foo = malloc(sizeof(foo));\n    // ... populate foo ..\n}\n</code></pre>\n\n<p>You have therein confused yourself, or the compiler, or both by trying to be too clever.  Both <code>foo</code>s in the statement containing the <code>malloc()</code> call are the same thing: the <em>variable</em> <code>foo</code>, which is a pointer of type <code>struct foo *</code>.  Unless the size of <code>struct foo</code> happens to be identical to that of a pointer on your system, that is the wrong thing to do.  If the struct is larger than a pointer, then writing to some of its members will indeed overrun the allocated bounds.</p>\n\n<p>There are several ways you could address this.  I would certainly recommend that you be a little more distinctive in naming.  I would suggest that you do away with the typedefs, too -- your types are not so complex that you gain much by them, and it costs you code clarity.  Additionally, I recommend this form for <em>all</em> your <code>malloc()</code> calls:</p>\n\n<pre><code>bar = malloc(n * sizeof(*bar));\n</code></pre>\n\n<p>Observe that that is clear in allocating a number of bytes that is a multiple of the size of the type of object to which the target pointer points, yet it does not depend directly on what the type of <code>bar</code> actually is.  Overall, then:</p>\n\n<pre><code>struct bar {\n    // elements ...\n};\n\nvoid f() {\n    struct bar *temp_bar;\n    temp_bar = malloc(sizeof(*temp_bar));\n    // ... populate temp_bar ..\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5673172, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c37df3ea15b13ef595c52f324916ac3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Vn", "link": "https://stackoverflow.com/users/5673172/john-vn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462386850, "creation_date": 1462384268, "last_edit_date": 1462386850, "question_id": 37034714, "link": "https://stackoverflow.com/questions/37034714/linked-list-inside-linked-lists", "title": "linked list inside linked lists", "body": "<p>i want to implement a program that used linked list inside linked lists(it simulates a supermarket traffic for your information) doing add,remove,delete etc operations.Here is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\ntypedef struct cash_queue cash;\ntypedef struct client client;\ntypedef struct item item;\nint k,c;//k== cash registers,c == customers\nstruct item{\n  int value;\n  struct item* next;\n};\n\nstruct cash_queue{\n   int cash_num;\n   struct client *first;\n   struct cash_que* next;\n};  \n\nstruct client{\n  int client_num;\n  int items;\n  struct item *fitem;\n  struct client* next;\n};\nvoid create_item(item* fitem){ \n  item *item,*cur;\n  cur=fitem;\n  item=malloc(sizeof(item));\n  printf(\"give product value\\n\");\n  int v;\n  scanf(\" %d\",&amp;v);\n  item-&gt;value=v;\n  printf(\"value: %d\\n\",item-&gt;value);\n  item-&gt;next=NULL;\n  while (cur-&gt;next)\n   cur=cur-&gt;next;\n  cur-&gt;next=item;\n} \n\nvoid create_queue(client* first){\n  client *client,*cur;\n  cur=first;    \n  client=malloc(sizeof(client));\n  printf(\"how many items this client has?\\n\");\n  int x,i;\n  scanf(\"%d\",&amp;x);\n  client-&gt;items=x;\n  client-&gt;next=NULL;\n  client-&gt;fitem=malloc(sizeof(item));\n  for (i=1;i&lt;=x;++i)\n    create_item(client-&gt;fitem);\n  while (cur-&gt;next){\n    cur=cur-&gt;next;\n  }\n  cur-&gt;next=client;\n}\nint main(){\n   cash* ncash;\n  ncash=malloc(sizeof(cash));\n  ncash-&gt;cash_num=1;\n  ncash-&gt;next=NULL;\n  ncash-&gt;first=malloc(sizeof(client));\n      printf(\"give the number of starting customers\\n\");\n  scanf(\"%d\",&amp;c);\n  int i;\n  for(i=1;i&lt;=c;++i)\n    create_queue(ncash-&gt;first);\n  }\n</code></pre>\n\n<p>When i try to execute this code my program get aborted.here is the exact output:</p>\n\n<pre><code> give the number of starting customers\n 3\n how many items this client has?\n 1\n give product value\n  2\n value: 2\n aa: malloc.c:2372: sysmalloc: Assertion `(old_top == (((mbinptr) (((char              *) &amp;((av)-&gt;bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd)))) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) &gt;= (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 *(sizeof(size_t))) - 1)) &amp; ~((2 *(sizeof(size_t))) - 1))) &amp;&amp; ((old_top)-&gt;size        &amp; 0x1) &amp;&amp; ((unsigned long) old_end &amp; pagemask) == 0)' failed.\n  Aborted\n</code></pre>\n\n<p>Can you tell me why is this happening and how can i fix it? Thanks.Are there any other problems i should correct in my code? </p>\n"}, {"tags": ["c", "arrays", "debugging"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1462384135, "post_id": 37034622, "comment_id": 61619393, "body": "You go to 6th element in <code>i</code> loop when there are only indexes 0-5 available in either of your arrays."}, {"owner": {"reputation": 5614, "user_id": 4923889, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d19da124fb19e7dba8c5db752a17ec06?s=128&d=identicon&r=PG", "display_name": "Uma Kanth", "link": "https://stackoverflow.com/users/4923889/uma-kanth"}, "edited": false, "score": 2, "creation_date": 1462384177, "post_id": 37034622, "comment_id": 61619418, "body": "The control always goes to the else block. I cannot be 2 and 1 at the same time."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462384190, "post_id": 37034622, "comment_id": 61619428, "body": "@MichaelDorgan: you mean the 7th and 0-4?"}, {"owner": {"reputation": 403, "user_id": 5470001, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c158995cbbdf55b81dad75cc86d43990?s=128&d=identicon&r=PG&f=1", "display_name": "bkennedy", "link": "https://stackoverflow.com/users/5470001/bkennedy"}, "edited": false, "score": 1, "creation_date": 1462384192, "post_id": 37034622, "comment_id": 61619430, "body": "can you explain what you are attempting to do with this program besides just say I have 2 arrays, what are you actually trying to make happen? I can already tell that <code>32776</code> being printed out is a mistake in the for loop somewhere and it is just printing a garbage value. also you are checking i against 1 and 2 and using &amp;&amp; which isnt possible"}, {"owner": {"reputation": 88, "user_id": 5012465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fb9e2997ed788b840cc98609ffa847d?s=128&d=identicon&r=PG&f=1", "display_name": "Blaargon", "link": "https://stackoverflow.com/users/5012465/blaargon"}, "edited": false, "score": 1, "creation_date": 1462384228, "post_id": 37034622, "comment_id": 61619451, "body": "You might want to check <code>if (1==i &amp;&amp; 2==i)</code>"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1462384240, "post_id": 37034622, "comment_id": 61619456, "body": "@KarolyHorvath, that as well."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462384316, "post_id": 37034622, "comment_id": 61619509, "body": "Seriously though, just print out your indexes to the console every loop and you&#39;ll see where you&#39;ve gone out of bounds."}, {"owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "edited": false, "score": 0, "creation_date": 1462384319, "post_id": 37034622, "comment_id": 61619511, "body": "&#39;if ( 1 == i &amp;&amp; 2 == i)&#39; this will be always false"}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462384468, "post_id": 37034723, "comment_id": 61619606, "body": "This fixes one issue, but still reads off the end of the arrays."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462384891, "post_id": 37034723, "comment_id": 61619865, "body": "Again, not quite.  User wants 2,3,13,14,15,16 - gotta take one off the index as above."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1462384990, "post_id": 37034723, "comment_id": 61619933, "body": "Yours is the &quot;answer&quot; now, so time to fix it :)"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462385398, "post_id": 37034723, "comment_id": 61620187, "body": "Updated my answer."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 6, "last_activity_date": 1462385536, "last_edit_date": 1462385536, "creation_date": 1462384314, "answer_id": 37034723, "question_id": 37034622, "link": "https://stackoverflow.com/questions/37034622/copying-values-from-one-array-to-another/37034723#37034723", "title": "Copying values from one array to another", "body": "<h2>Problem 1</h2>\n\n<p>Array indexes are 0-based, meaning <code>v[0]</code> and <code>g[0]</code> are the first element of the arrays. All your <code>i</code> and <code>k</code> are off by one 1.</p>\n\n<h2>Problem 2</h2>\n\n<p><code>1 == i &amp;&amp; 2 == i</code> is never true. If <code>1 == i</code>, then <code>2 != i</code>. If <code>2 == i</code>, then <code>1 != i</code>.</p>\n\n<pre><code>1 == i &amp;&amp; 2 == i\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>1 == i || 2 == i\n</code></pre>\n\n<h2>Problem 3</h2>\n\n<p>Your loop has 5 passes, but it requires 6!</p>\n\n<pre><code>1) g[0] = v[0];\n2) g[1] = v[1];\n3) g[2] = v[1]+10;\n4) g[3] = v[2]+10;\n5) g[4] = v[3]+10;\n6) g[5] = v[4]+10;\n</code></pre>\n\n<h2>Solution</h2>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    int v[5] = {2,3,4,5,6};\n    int g[6];\n\n    for( int i = 0; i &lt; sizeof(g)/sizeof(*g); ++i ) {\n        if ( 0 == i || 1 == i )\n           g[i] = v[i];\n        else\n           g[i] = v[i-1]+10;\n\n        printf(\"%d\\n\", g[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>if ( 0 == i || 1 == i )\n</code></pre>\n\n<p>can be simplified to</p>\n\n<pre><code>if ( 2 &lt; i )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1462384885, "post_id": 37034775, "comment_id": 61619861, "body": "You should mention them again. Answers are supposed to stand on their own, comments are considered ephemeral."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1462385058, "post_id": 37034775, "comment_id": 61619975, "body": "BTW, congrats on getting the correct answer first.  190k karma is beating you up at the moment is all."}, {"owner": {"reputation": 7248, "user_id": 1925388, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/jgnbc.jpg?s=128&g=1", "display_name": "Anmol Singh Jaggi", "link": "https://stackoverflow.com/users/1925388/anmol-singh-jaggi"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1462385680, "post_id": 37034775, "comment_id": 61620388, "body": "@MichaelDorgan Haha! That&#39;s okay! I&#39;m glad that the OP got his question&#39;s answer, one way or the other. As a consolation, I got a lot of upvotes, so yay!"}], "tags": [], "owner": {"reputation": 7248, "user_id": 1925388, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/jgnbc.jpg?s=128&g=1", "display_name": "Anmol Singh Jaggi", "link": "https://stackoverflow.com/users/1925388/anmol-singh-jaggi"}, "is_accepted": false, "score": 5, "last_activity_date": 1462385382, "last_edit_date": 1462385382, "creation_date": 1462384550, "answer_id": 37034775, "question_id": 37034622, "link": "https://stackoverflow.com/questions/37034622/copying-values-from-one-array-to-another/37034775#37034775", "title": "Copying values from one array to another", "body": "<p>Your code has a few problems:  </p>\n\n<ul>\n<li><code>if ( 1 == i &amp;&amp; 2 == i)</code> will always return <code>false</code> as a variable cannot be both 1 and 2 at the same time.</li>\n<li>Your loop iterator takes values larger than they should; when <code>i</code> becomes <code>5</code> and <code>6</code>, <code>v[i]</code> and <code>g[i]</code> triggers reads to memory locations beyond the respective arrays' memory ranges, which explains the random values in your output.</li>\n</ul>\n\n<p>I think this is what you want:  </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i = 0;\n    int v[5] = {2, 3, 4, 5, 6};\n    int g[6];\n\n    for ( i = 0; i &lt; 6; i++ )\n    {\n        if ( i &lt; 2 )\n        {\n            g[i] = v[i];\n        }\n\n        else\n        {\n            g[i] = ( v[i - 1] + 10 );\n        }\n\n        printf ( \"%d\\n\", g[i] );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:  </p>\n\n<pre><code>2 3 13 14 15 16\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7965, "user_id": 6242613, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/X5cUu.jpg?s=128&g=1", "display_name": "V. Sambor", "link": "https://stackoverflow.com/users/6242613/v-sambor"}, "is_accepted": false, "score": 1, "last_activity_date": 1462384647, "creation_date": 1462384647, "answer_id": 37034790, "question_id": 37034622, "link": "https://stackoverflow.com/questions/37034622/copying-values-from-one-array-to-another/37034790#37034790", "title": "Copying values from one array to another", "body": "<p>It never enter in the <strong>if</strong> conditional block because i cannot be 1 and 2 at the same time.. <br>\nSo your code will enter just in else...<br>\nand it wil start from index 1;\n<br> so in this expresion from else : <code>g[k]=(v[i]+10);</code> --- <code>v[i]=&gt; 3</code> and when you arrive at index 5 or 6 it is outside of your v array....</p>\n\n<pre><code>for( i = 1; i &lt;= 6; i++ ){\n        k= i + 1;\n        if ( 1 == i &amp;&amp; 2 == i) //never enter here...\n        {\n            g[k]=v[i];\n        }\n        else\n        {\n            g[k]=(v[i]+10); //index get outside the vector length\n        }\n\n        printf(\"%d\\n\",g[k]);\n    }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1071529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f488df327676f062a2a85e5a778a1e38?s=128&d=identicon&r=PG", "display_name": "milenko", "link": "https://stackoverflow.com/users/1071529/milenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37034723, "answer_count": 3, "score": -2, "last_activity_date": 1463615026, "creation_date": 1462383986, "last_edit_date": 1463615026, "question_id": 37034622, "link": "https://stackoverflow.com/questions/37034622/copying-values-from-one-array-to-another", "title": "Copying values from one array to another", "body": "<p>It should be simple,two arrays,one with 5 other with 6 elements.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i=0;\n    int k=0;\n    int v[5] = {2,3,4,5,6};\n    int g[6];\n\n    for( i = 1; i &lt;= 6; i++ ){\n        k= i + 1;\n        if ( 1 == i &amp;&amp; 2 == i)\n        {\n            g[k]=v[i];\n        }\n        else\n        {\n            g[k]=(v[i]+10);\n        }\n\n        printf(\"%d\\n\",g[k]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I got this</p>\n\n<pre><code>13\n14\n15\n16\n32776\n10\n</code></pre>\n\n<p>I really wanted </p>\n\n<pre><code>2 3 13 14 15 16\n</code></pre>\n\n<p>Where is my mistake?Should I create function or what?</p>\n"}, {"tags": ["c", "shell", "unix"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1462384655, "post_id": 37034475, "comment_id": 61619724, "body": "Have you tried anything for this yet?"}, {"owner": {"reputation": 11, "user_id": 5003876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6403901b8da9b990f067b5babff9721d?s=128&d=identicon&r=PG&f=1", "display_name": "Eric1728", "link": "https://stackoverflow.com/users/5003876/eric1728"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1462385544, "post_id": 37034475, "comment_id": 61620291, "body": "@EtanReisner No, I&#39;m not  really sure how to get started on this part."}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1462386150, "post_id": 37034475, "comment_id": 61620659, "body": "Do you understand <i>conceptually</i> what that means for your processing loop?"}, {"owner": {"reputation": 11, "user_id": 5003876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6403901b8da9b990f067b5babff9721d?s=128&d=identicon&r=PG&f=1", "display_name": "Eric1728", "link": "https://stackoverflow.com/users/5003876/eric1728"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1462386711, "post_id": 37034475, "comment_id": 61621026, "body": "@EtanReisner I&#39;m thinking I need to add a similar If statement to the switch case for &#39;R&#39;?"}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1462391037, "post_id": 37034475, "comment_id": 61623481, "body": "Having <code>R</code> do both reverse text and read commands to execute would be slightly odd but yes, that&#39;s the first step. What does reading commands from a file mean for how you process input/commands though?"}, {"owner": {"reputation": 16325, "user_id": 3220113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1c0b015f14adfdf581d04c065e903d?s=128&d=identicon&r=PG&f=1", "display_name": "Walter A", "link": "https://stackoverflow.com/users/3220113/walter-a"}, "edited": false, "score": 0, "creation_date": 1462396010, "post_id": 37034475, "comment_id": 61626131, "body": "Use more functions, so that you need to call <code>switch((char)(*cptr[0]))</code> only once. Using an array with function pointers for each letter is another, perhaps too fancy, approach."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1465818508, "post_id": 37034475, "comment_id": 63043939, "body": "How can <b>R &gt; instr.txt</b> read in commands from an input file &#39;instr.txt&#39;? <b>R</b> already has the meaning <code>Reverse text</code>, and <b>&gt;</b> already has the meaning <code>Redirect output</code>. And do you really want to <i>read in commands</i>, not read input for a command?"}], "owner": {"reputation": 11, "user_id": 5003876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6403901b8da9b990f067b5babff9721d?s=128&d=identicon&r=PG&f=1", "display_name": "Eric1728", "link": "https://stackoverflow.com/users/5003876/eric1728"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462384523, "creation_date": 1462383460, "last_edit_date": 1462384523, "question_id": 37034475, "link": "https://stackoverflow.com/questions/37034475/add-input-file-functionality-to-unix-shell", "title": "Add Input File Functionality to Unix Shell", "body": "<p>I have created a file called myShell.c in which I am implementing a Unix shell. I haved added functionality to redirect output to a file using the command <em>mysh></em> <strong>L > dir.txt</strong>. I was wanting to add a similar functionality in which the shell could read in commands from an input file such as 'instr.txt' by using a command such as <em>mysh></em> <strong>R > instr.txt</strong> but needed help going about this. I already created the variable which will be used below in the code (<strong>redirectInputArg</strong>). Any suggestions on how to go about this? Below is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n#include \"clock.h\"\n\n#define MAXLINE 100\nint timeout;\ndouble currentCycles;\ndouble MHZ;\n\n//\n// Signal handler\n//\nvoid sighandler(int signo)\n{\n  switch(signo)\n  {\n    case SIGINT:\n      printf(\"\\n\\n*** Caught SIGINT signal ***\\n\\n\");\n      currentCycles = get_counter(); // get current counter value\n      printf(\"Elapsed Time: %f seconds.\\n\", currentCycles/MHZ/1.0E6);\n      start_counter(); // reset the counter\n      printf(\"mysh&gt;\");\n      fflush(stdout);\n      break;\n    case SIGALRM:\n      printf(\"\\n\\n*** Alarm caught ***\\n\\n\");\n      printf(\"mysh&gt;\");\n      fflush(stdout);\n      break;\n    case SIGTERM:\n      printf(\"\\n\\n*** So you think you can kill me, try again ***\\n\\n\");\n      printf(\"mysh&gt;\");\n      fflush(stdout);\n      break;\n    default:\n      printf(\"\\n\\n*** Caught unexpected signal number %d ***\\n\\n\", signo);\n      printf(\"mysh&gt;\");\n      fflush(stdout);\n      break;\n  }\n  return;\n}\n\n//\n// Display options\n//\nvoid options()\n{\n  printf(\"\\n  OPTIONS:\\n\");\n  printf(\"------------------------------------------\\n\");\n  printf(\"  A &lt;sec&gt; = Alarm &lt;sec&gt; seconds\\n\");\n  printf(\"  P = Process Status Tree (ps --forest)\\n\");\n  printf(\"  W = Who is logged in and count (who -q)\\n\");\n  printf(\"  F = Fortune cookie (fortune)\\n\");\n  printf(\"  L [dir] = Directory listing (ls -l [ dir ])\\n\");\n  printf(\"  M [fname] = Display file or stdin by page (more [fname])\\n\");\n  printf(\"  S = Start or restart timer \\n\");\n  printf(\"  E = Elapsed time \\n\");\n  printf(\"  I &lt;num&gt; = Ignore signal number &lt;num&gt;\\n\");\n  printf(\"  C &lt;num&gt; = Catch signal number &lt;num&gt;\\n\");\n  printf(\"  D &lt;num&gt; = Default action for signal &lt;num&gt;\\n\");\n  printf(\"  R = Reverse text\\n\");\n  printf(\"  H = Help\\n\");\n  printf(\"  Q = Quit\\n\");\n  printf(\"------------------------------------------\\n\");\n  fflush(stdout);\n  return;\n}\n\n//\n// Main fetch and evaluate routine\n//\nint main()\n{\n  int retval;\n  int status;\n  char cmd[MAXLINE+1] = \" \";\n  char fname[MAXLINE];\n  char *cptr[10];\n  int count=0;\n  const char delim[4] = \" \\n\\t\";\n  int seconds;\n  int signum;\n  int redirectOutputArg = 0;\n  int redirectInputArg = 0;\n  int i, fd_out;\n  mode_t mode = 0644; // S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH;\n\n  // invoke signal hander, sighandler, when some signals are received\n  signal(SIGINT, sighandler);\n  signal(SIGALRM, sighandler);\n  signal(SIGTERM, sighandler);\n\n  // determine system clock rate\n  MHZ = mhz(0);\n\n  while((strncmp(cmd,\"Q\",1)!=0)&amp;&amp;(strncmp(cmd,\"q\",1)!=0))\n  {\n    redirectOutputArg = 0;\n    redirectInputArg = 0;\n    printf(\"\\nmysh&gt;\");\n    fflush(stdout);\n    memset(cmd,0,MAXLINE+1);\n    if ((fgets(cmd, MAXLINE, stdin) == NULL) &amp;&amp; ferror(stdin))\n    {\n      perror(\"fgets error\");\n      exit(1);\n    }\n    // Grab tokens from command entered\n    cptr[0] = strtok(cmd, delim);\n    count=1;\n    while((count&lt;10)&amp;&amp;((cptr[count]=strtok(NULL,delim))!=NULL))\n      count++;\n    for (i=0; i&lt;count; i++)\n        printf(\"Argument %d: %s\\n\", i, cptr[i]);\n\n    for (i=2; i&lt;count; i++)\n    {\n      if (strncmp(cptr[i-1],\"&gt;\",1)==0)\n        redirectOutputArg = i;\n    }\n    if (redirectOutputArg &gt; 0)\n        printf(\"Redirect output arg: %d = %s\\n\",\n        redirectOutputArg, cptr[redirectOutputArg]);\n    fflush(stdout);\n\n    if (feof(stdin)) // Ctrl-D -- end-of-input\n    {\n  exit(0);\n}\n\nswitch((char)(*cptr[0]))\n{\n  case 'P': case 'W': case 'F': case 'L': case 'R': case 'M':\n  case 'p': case 'w': case 'f': case 'l': case 'r': case 'm':\n    retval = fork(); // fork off a child to do the work.\n    if (retval==0)\n    {\n      if (redirectInputArg &gt; 0)\n      {\n\n      }\n      if (redirectOutputArg &gt; 0)\n      {\n        sprintf(fname,\"%s\", cptr[redirectOutputArg]);\n        fname[strlen(fname)]='\\0';\n        // redirect output to file\n        fd_out = open(fname, O_RDWR | O_CREAT, mode);\n        close(1);     // could also use dup2(fd_out,1);\n        if (dup(fd_out)&lt;0)\n        {\n            perror(\"Unable to dup stdout\");\n            exit(8);\n        }\n      }\n\n      switch((char)(*cptr[0]))\n      {\n        case 'P': case 'p':\n                  execl(\"/bin/ps\",\"ps\",\"--forest\",(char *) NULL);\n                  exit(1); // just in case it didn't work :-)\n                  break;\n        case 'W': case 'w':\n                  execl(\"/usr/bin/who\",\"who\",\"-q\",(char *) NULL);\n                  exit(2);\n                  break;\n        case 'F': case 'f':\n                  execl(\"/usr/bin/fortune\",\"fortune\",(char *) NULL);\n                  exit(3);\n        case 'L': case 'l':\n                  if ((cptr[1]!=NULL)&amp;&amp;(strncmp(cptr[1],\"&gt;\",1)!=0))\n                  {\n                    execl(\"/bin/ls\",\"ls\", \"-l\",(char *)cptr[1],(char *) NULL);\n                  }\n                  else\n                    execl(\"/bin/ls\",\"ls\",\"-l\",(char *) NULL);\n                  exit(4);\n                  break;\n        case 'R': case 'r':\n                  execl(\"/usr/bin/rev\", \"rev\",(char *) NULL);\n                  exit(5);\n        case 'M': case 'm':\n                  exit(6);\n                  break;\n        default:  printf(\"Invalid user input, try again.\\n\");\n                  exit(7);\n                  break;\n      }\n      return 0; // child should always exit...\n    }\n    else\n    {\n      retval = wait(&amp;status); // parent shell waits for child to exit\n    }\n    break;\n\n  case 'A': case 'a': seconds = atoi(cptr[1]);\n            alarm(seconds);\n            break;\n  case 'S': case 's': start_counter(); // reset the counter\n            break;\n  case 'E': case 'e': currentCycles = get_counter();\n            printf(\"Elapsed Time: %f seconds.\\n\", currentCycles/MHZ/1.0E6);\n            break;\n  case 'I': case 'i': signum = atoi(cptr[1]);\n            signal(signum,SIG_IGN);\n            break;\n  case 'C': case 'c': signum = atoi(cptr[1]);\n            signal(signum,sighandler);\n            break;\n  case 'D': case 'd': signum = atoi(cptr[1]);\n            signal(signum,SIG_DFL);\n            break;\n  case 'H': case 'h': options();\n            break;\n  case 'Q': case 'q': // do nothing\n            break;\n  default:  printf(\"Invalid user input, try again.\\n\");\n            break;\n    }\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "delphi", "utf-8"], "comments": [{"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1462383847, "post_id": 37034466, "comment_id": 61619202, "body": "Surely this question has been asked 100&#39;s of times already..... have you tried googling? Every time you call a Windows function that uses text you&#39;re doing this very thing."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1462383972, "post_id": 37034466, "comment_id": 61619296, "body": "PAnsiChar on the Delphi side. const char* on the C++ side. You need to encode as a null terminated utf8 strong before calling the function through. The RTL has functions for that. Try searching."}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1462384116, "post_id": 37034466, "comment_id": 61619379, "body": "Compulsory reading: <a href=\"http://rvelthuis.de/articles/articles-pchars.html\" rel=\"nofollow noreferrer\">rvelthuis.de/articles/articles-pchars.html</a>"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1462384185, "post_id": 37034466, "comment_id": 61619424, "body": "<a href=\"http://docwiki.embarcadero.com/RADStudio/Seattle/en/UTF-8_Conversion_Routines\" rel=\"nofollow noreferrer\">docwiki.embarcadero.com/RADStudio/Seattle/en/&hellip;</a> you are looking for Utf8Encode <a href=\"http://docwiki.embarcadero.com/Libraries/Seattle/en/System.UTF8Encode\" rel=\"nofollow noreferrer\">docwiki.embarcadero.com/Libraries/Seattle/en/System.UTF8Enco&zwnj;&#8203;de</a>"}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1462384484, "post_id": 37034466, "comment_id": 61619617, "body": "Oh and make sure to get the calling convention correct. It needs to be either <code>cdecl</code> or <code>stdcall</code> (probably the former)."}, {"owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "edited": false, "score": 0, "creation_date": 1462385235, "post_id": 37034466, "comment_id": 61620084, "body": "I&#39;ve spent the last hour and a half investigating this, stackoverflow is my last resort, I never use stackoverflow without doing due diligence, including searching stackoverflow itself. Obviously one can miss things when researching."}], "answers": [{"comments": [{"owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "edited": false, "score": 0, "creation_date": 1462386211, "post_id": 37034772, "comment_id": 61620690, "body": "That worked. I thank you for the answer. Knowing the answer I can now see there are similar responses eg <a href=\"http://stackoverflow.com/questions/21867113/how-to-use-unicode-from-delphi-in-c-dll\" title=\"how to use unicode from delphi in c dll\">stackoverflow.com/questions/21867113/&hellip;</a> which for some reason didn&#39;t show up in my search. I apologize for using up the responder&#39;s time unnecessarily. Please delete the question is it deemed superfluous."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1462388947, "post_id": 37034772, "comment_id": 61622382, "body": "In Delphi 2009+, <code>UTF8Encode()</code> is deprecated, use <code>UTF8String</code> instead: <code>PAnsiChar(UTF8String(str))</code>, or just declare <code>str</code> as <code>UTF8String</code> to begin with, then type-cast it as-is: <code>PAnsiChar(str)</code>."}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1462396078, "post_id": 37034772, "comment_id": 61626159, "body": "@RemyLebeau UTF8String was prohibited in &quot;nex gen&quot; Delphi for LLVM"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 1, "creation_date": 1462396181, "post_id": 37034772, "comment_id": 61626209, "body": "@Arioch&#39;The: <a href=\"http://docwiki.embarcadero.com/RADStudio/Berlin/en/What%27s_New#Other_RTL_Changes\" rel=\"nofollow noreferrer\"><code>UTF8String</code> and <code>RawByteString()</code> have been re-enabled for mobile platforms in Delphi 10.1 Berlin</a>.  If you don&#39;t want to rely on <code>UTF8String</code>, then you can use <code>TEncoding.UTF8.GetBytes()</code> instead."}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1462396235, "post_id": 37034772, "comment_id": 61626241, "body": "@RemyLebeau so they finally decided to stop pi.. spitting against the wind? I am surprised :-)"}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 6, "last_activity_date": 1462396068, "last_edit_date": 1462396068, "creation_date": 1462384538, "answer_id": 37034772, "question_id": 37034466, "link": "https://stackoverflow.com/questions/37034466/how-to-pass-utf-8-string-from-delphi-to-a-dll-c-extern-function/37034772#37034772", "title": "How to pass UTF-8 string from Delphi to a DLL C extern function?", "body": "<p>On the Delphi side the parameter is <code>PAnsiChar</code> which you pass like this: <code>PAnsiChar(Utf8String(str))</code>. </p>\n\n<p>On the C++ side you receive the parameter as <code>const char*</code>. </p>\n\n<p>Obviously you need to ensure that the calling convention matches. </p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1462396471, "post_id": 37038103, "comment_id": 61626328, "body": "You need an explicit type-cast to avoid a &quot;<i>W1057 Implicit string cast from &#39;string&#39; to &#39;UTF8String&#39;</i>&quot; warning: <code>u8 := UTF8String(mystr);</code>"}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1462397542, "post_id": 37038103, "comment_id": 61626862, "body": "Personally I&#39;d better disable that specific warning. In the case of explicit typecast though there would be no need with temporary variable."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1462398511, "post_id": 37038103, "comment_id": 61627308, "body": "I would not disable the warning. <i>Implicit</i> string casts <i>may</i> modify data, which is why a warning even exists at all. An <i>explicit</i> cast tells the compiler that you understand and accept the risk. The warning happens on every implicit assignment of one string type to a different string type. If the target string type is an Ansi string, you get a slightly different warning: <code>W1058 Implicit string cast with potential data loss from &#39;string&#39; to &#39;AnsiString&#39;</code>."}], "tags": [], "owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "is_accepted": false, "score": 1, "last_activity_date": 1462396621, "last_edit_date": 1462396621, "creation_date": 1462396303, "answer_id": 37038103, "question_id": 37034466, "link": "https://stackoverflow.com/questions/37034466/how-to-pass-utf-8-string-from-delphi-to-a-dll-c-extern-function/37038103#37038103", "title": "How to pass UTF-8 string from Delphi to a DLL C extern function?", "body": "<p>Another option would be to use the <code>UTF8String</code> type:</p>\n\n<pre><code>mystr : string;\nu8: UTF8String;\n\nu8 := UTF8String(mystr);\ncallCExternMethod(PAnsiChar(u8));\n</code></pre>\n\n<p>Note: the <code>UTF8String</code> type is not available for use on mobile platforms in Delphi XE5 through 10.0 Seattle, unless you use a patch to enable it:</p>\n\n<p><a href=\"http://andy.jgknet.de/blog/2013/10/the-return-of-the-byte-strings/\" rel=\"nofollow\">http://andy.jgknet.de/blog/2013/10/the-return-of-the-byte-strings/</a></p>\n\n<p><code>UTF8String</code> has been re-enabled for use in mobile starting in Delphi 10.1 Berlin.</p>\n"}], "owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 0, "accepted_answer_id": 37034772, "answer_count": 2, "score": 2, "last_activity_date": 1462396621, "creation_date": 1462383431, "last_edit_date": 1462388204, "question_id": 37034466, "link": "https://stackoverflow.com/questions/37034466/how-to-pass-utf-8-string-from-delphi-to-a-dll-c-extern-function", "title": "How to pass UTF-8 string from Delphi to a DLL C extern function?", "body": "<p>I am calling from Delphi a C extern function in a Visual Studio compiled DLL.  The DLL method in turn calls a C++ method that takes as argument a C++ string type. The string at the Delphi end is UTF-8 encoded (without the BOM). I need to make sure the C++ method that takes the string type gets the UTF-8 encoded string. </p>\n\n<p>I can modify the DLL source code. My question:</p>\n\n<p>My UTF-8 string on the Delphi side is of type string. What type should the C extern method take? PChar, PWideChar? and how do I convert that to a C++ string type?</p>\n\n<p>Note: I can't convert the UTF-8 string into an AnsiString first because the encoding stores some Greek letters that must be preserved. The C++ end will make a copy of the Delphi string and handle the disposal of any allocated memory.</p>\n\n<p>Delphi end (Using XE6):</p>\n\n<pre><code>mystr : string;\n\ncallCExternMethod (mystr) // cast to what?\n</code></pre>\n\n<p>C++ End (Using VS 2013):</p>\n\n<pre><code>void callCExternMethod (????? mystr) {\n\n  // convert mystr to C++ string type\n\n  callCPlusPlusMethod (takes C++ string type)\n}\n</code></pre>\n"}, {"tags": ["c", "string", "pointers", "scanf"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1462383298, "post_id": 37034418, "comment_id": 61618859, "body": "Formatting/indentation:("}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462383355, "post_id": 37034418, "comment_id": 61618898, "body": "&#39;scanf(&quot;%s&quot;,tmp);&#39; tmp is uninitialized."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462383359, "post_id": 37034418, "comment_id": 61618900, "body": "In <code>scanf(&quot;%s&quot;,tmp);</code> the variable <code>tmp</code> has no memory allocated. it is an unitialised pointer, leading to <i>undefined behaviour</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462383425, "post_id": 37034418, "comment_id": 61618945, "body": "... and neither have the elements of <code>char *inp[t];</code> so <code>strcpy(inp[i],tmp);</code> will cause an explosion in the population of frogs. Croak."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462383638, "post_id": 37034418, "comment_id": 61619071, "body": "The strcpy() and printf() don&#39;t make much sense.  Did you mean to use a 2D array or an array of pointers to char arrays?"}, {"owner": {"reputation": 1, "user_id": 6292056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98448ac76fabe06b27428170cbe0da16?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan021", "link": "https://stackoverflow.com/users/6292056/srijan021"}, "edited": false, "score": 0, "creation_date": 1462521142, "post_id": 37034418, "comment_id": 61679662, "body": "I just wants to know the error in program(asked in examination), there is no specific purpose of the program. I am weak in c so i cant point out error. Thanks all for the answer."}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462384062, "post_id": 37034535, "comment_id": 61619350, "body": "LOL! ................."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462384107, "post_id": 37034535, "comment_id": 61619371, "body": "@MartinJames anyway now everything is correct"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1462384211, "post_id": 37034535, "comment_id": 61619446, "body": "@ikegami he probably wants the user to type a number (t), then he wants the user to type t strings and the pointers to eachof the strings should be stored in the <code>inp</code>array."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462384383, "post_id": 37034535, "comment_id": 61619543, "body": "Not sure why this got downvoted."}, {"owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "edited": false, "score": 0, "creation_date": 1462384527, "post_id": 37034535, "comment_id": 61619643, "body": "t :D P.S. Missed free() after using malloc() : )"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "edited": false, "score": 0, "creation_date": 1462384559, "post_id": 37034535, "comment_id": 61619659, "body": "@SunDro OK, but for this kind of toy programs it&#39;s not really important."}, {"owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "edited": false, "score": 1, "creation_date": 1462384648, "post_id": 37034535, "comment_id": 61619721, "body": "@MichaelWalz I know but it turned into the habit :/"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462384972, "post_id": 37034535, "comment_id": 61619923, "body": "Please stop editing the code.  If you keep that up, &#39;n&#39; wil be back.  I&#39;ve  upvoted it already.."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1462386947, "post_id": 37034535, "comment_id": 61621174, "body": "Tip: <code>inp[i] = malloc(strlen(tmp) + 1); strcpy(inp[i],tmp);</code> can be reduced to <code>inp[i] = strdup(tmp);</code>"}, {"owner": {"reputation": 1, "user_id": 6292056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98448ac76fabe06b27428170cbe0da16?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan021", "link": "https://stackoverflow.com/users/6292056/srijan021"}, "edited": false, "score": 0, "creation_date": 1462520996, "post_id": 37034535, "comment_id": 61679593, "body": "I just wants to know the error in program(asked in examination), there is no specific purpose of the program. I am weak in c so i cant point out error. Thanks all for the answer."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 4, "last_activity_date": 1462386963, "last_edit_date": 1462386963, "creation_date": 1462383657, "answer_id": 37034535, "question_id": 37034418, "link": "https://stackoverflow.com/questions/37034418/whats-wrong-with-this-program-in-c-it-terminates-i-am-having-difficulty-in-und/37034535#37034535", "title": "Whats wrong with this program in C? It terminates. I am having difficulty in understanding read input string in pointer of pointers", "body": "<p><code>scanf(\"%s\",tmp)</code> writes to the memory pointed by <code>tmp</code>, but you never initialized <code>tmp</code> to point to writable memory.</p>\n\n<p>Similarly, <code>strcpy(inp[i],tmp)</code> writes to the memory pointed by <code>inp[i]</code>, but you never initialized <code>inp[i]</code> to point to writable memory.</p>\n\n<p>You probably want this:</p>\n\n<pre><code>int main() {\n  int t,i;\n  scanf(\"%d\",&amp;t);\n  char *inp[t];                         // array of t pointers to char\n  char tmp[100];                        // array of 100 chars\n\n  for(i=0;i&lt;t;i++)\n  {\n    scanf(\"%s\",tmp);\n    inp[i] = malloc(strlen(tmp) + 1);   // allocate space for new string\n                                        // (+1 for the NUL terminator)\n    strcpy(inp[i],tmp);                 // copy the string in tmp to\n                                        // the newly allocated space\n  }\n\n  // print all strings\n  for(i=0;i&lt;t;i++)\n  {\n    printf(\"%s\\n\",inp[i]);\n  }\n\n  for(i=0;i&lt;t;i++)\n  {\n    free(inp[i]));   // free previously allocated memory\n                     // (not really necessary here, just to be perfect)\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6292056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98448ac76fabe06b27428170cbe0da16?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan021", "link": "https://stackoverflow.com/users/6292056/srijan021"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1463173954, "answer_count": 1, "score": -9, "last_activity_date": 1462386963, "creation_date": 1462383264, "last_edit_date": 1462385766, "question_id": 37034418, "link": "https://stackoverflow.com/questions/37034418/whats-wrong-with-this-program-in-c-it-terminates-i-am-having-difficulty-in-und", "closed_reason": "Needs details or clarity", "title": "Whats wrong with this program in C? It terminates. I am having difficulty in understanding read input string in pointer of pointers", "body": "<p>When I gave input as 1 any string it terminates. Please help me understand the working.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n  int t,j,i;\n  scanf(\"%d\",&amp;t);\n  char *inp[t];\n  char *tmp;\n  for(i=0;i&lt;t;i++)\n  {\n    scanf(\"%s\",tmp);\n    printf(\"0\");\n    strcpy(inp[i],tmp);\n    printf(\"%s\",inp[i]);\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ruby"], "comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1462383546, "post_id": 37034010, "comment_id": 61619017, "body": "It was originally <code>#define RSTRING_EMBED_LEN_MAX ((int)((sizeof(VALUE)*3)&#47;sizeof(char)-1))</code>. See the commit where it was changed: <a href=\"https://github.com/ruby/ruby/commit/fd89a968372ca748910477dec8c5865e65a18565\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/commit/&hellip;</a> I guess the macro was left for compatibility concerns?"}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1462383680, "post_id": 37034010, "comment_id": 61619094, "body": "oh I see..but wouldn&#39;t it make more sense to set it to 0? I&#39;m not a C guru, so I don&#39;t know the best practices."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1462384501, "post_id": 37034010, "comment_id": 61619624, "body": "@matt It&#39;s still set to <code>(int)((sizeof(VALUE)*3)&#47;sizeof(char)-1)</code>. But it&#39;s not a macro anymore, but an <code>enum</code>. I assume it was converted into an <code>enum</code>, to prevent common pitfalls with the evaluation of macros."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462383014, "post_id": 37034113, "comment_id": 61618715, "body": "So <code>#define RSTRING_EMBED_LEN_MAX RSTRING_EMBED_LEN_MAX</code> it&#39;s rather poinless I suppose."}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "edited": false, "score": 0, "creation_date": 1462383415, "post_id": 37034113, "comment_id": 61618938, "body": "but where is RSTRING_EMBED_LEN_MAX given a meaningful value (a number I suppose)?"}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "edited": false, "score": 0, "creation_date": 1462383431, "post_id": 37034113, "comment_id": 61618946, "body": "and why do they write that #define, if it has no meaning?"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "edited": false, "score": 0, "creation_date": 1462384382, "post_id": 37034113, "comment_id": 61619541, "body": "@le_me It&#39;s given a meaningful name literally 4 lines down in the source code. They define an <code>enum</code> with the name."}, {"owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "edited": false, "score": 0, "creation_date": 1462386440, "post_id": 37034113, "comment_id": 61620848, "body": "oh enum variants are in the global namespace in C, I forgot that! Thank you, it makes sense now!"}], "tags": [], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "is_accepted": true, "score": 4, "last_activity_date": 1462384583, "last_edit_date": 1495541772, "creation_date": 1462382091, "answer_id": 37034113, "question_id": 37034010, "link": "https://stackoverflow.com/questions/37034010/what-does-a-macro-definition-with-the-same-token-twice-in-c-mean/37034113#37034113", "title": "What does a macro definition with the same token twice in C mean?", "body": "<p>This define will expand into the literal token <code>RSTRING_EMBED_LEN_MAX</code>, just as you would expect.</p>\n\n<p>By looking at the source, you'll see, that the macro is used to define an <code>enum</code> value with the same name, set to <code>(int)((sizeof(VALUE)*3)/sizeof(char)-1)</code>. </p>\n\n<p>The commit, linked by <a href=\"https://stackoverflow.com/users/214790/matt\">matt</a>, explains they converted all macros into enums, to improve debugging. And the macro was left for compatibility reasons.</p>\n"}], "owner": {"reputation": 2189, "user_id": 1477992, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/22e212e1defd6cf572fe11aa79f1dace?s=128&d=identicon&r=PG", "display_name": "le_me", "link": "https://stackoverflow.com/users/1477992/le-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 37034113, "answer_count": 1, "score": 1, "last_activity_date": 1462384583, "creation_date": 1462381749, "question_id": 37034010, "link": "https://stackoverflow.com/questions/37034010/what-does-a-macro-definition-with-the-same-token-twice-in-c-mean", "title": "What does a macro definition with the same token twice in C mean?", "body": "<p>I was reading the <a href=\"https://github.com/ruby/ruby\" rel=\"nofollow\">Ruby source code</a> when I stumbled upon the following:</p>\n\n<pre><code>#define RSTRING_EMBED_LEN_MAX RSTRING_EMBED_LEN_MAX\n</code></pre>\n\n<p><a href=\"https://github.com/ruby/ruby/blob/973ba3e8e24f4497aebcbd3819fc9c0f38a7909f/include/ruby/ruby.h#L968\" rel=\"nofollow\">context</a></p>\n\n<p>As far as I can tell <code>RSTRING_EMBED_LEN_MAX</code> is not defined before. (I grepped the Ruby source recursively).</p>\n\n<p>What does that line do exactly?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "char"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1462381219, "post_id": 37033837, "comment_id": 61617725, "body": "<code>void fre(char *asd)</code> --&gt; <code>void fre(char *asd[])</code> or <code>void fre(char **asd)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462381356, "post_id": 37033837, "comment_id": 61617798, "body": "... and you could pass the number of names too, then <code>fre</code> will look rather like <code>main(int argc, char *argv[])</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462381505, "post_id": 37033837, "comment_id": 61617871, "body": "In <code>main</code> you have <code>char *names[7]</code>, an array of pointers to char.  You attempt to pass this array to function <code>fre()</code>.  But <code>fre</code> is declared as accepting a single pointer to char.  So it doesn&#39;t work."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462382732, "post_id": 37033837, "comment_id": 61618563, "body": "Why do you have a blank line after <i>every</i> line ?"}], "answers": [{"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1462381907, "last_edit_date": 1462381907, "creation_date": 1462381444, "answer_id": 37033931, "question_id": 37033837, "link": "https://stackoverflow.com/questions/37033837/passing-char-array-into-a-function-in-c/37033931#37033931", "title": "Passing Char Array into a function in C", "body": "<p>With </p>\n\n<pre><code>char *names[7]={\"Jayan Tennakoon\",\"John Long\",\"Robert Lang\"};\n</code></pre>\n\n<p>You have an array of pointers to <code>char</code>. So</p>\n\n<pre><code>void fre(char *asd)\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>void fre( char *asd[], int n) \n/* it is good to pass the total(here 3) \n * since you have initialized the first three elements\n */\n{\n.\n.\nfor(i=0;i&lt;n;i++)\n.\n.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462517369, "post_id": 37033964, "comment_id": 61677751, "body": "Hi Harry. Thanks it worked perfectly. I have one question, why is it *char[] and not just char[] when i attempt to store the names ?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462517571, "post_id": 37033964, "comment_id": 61677852, "body": "What do you mean store the names. Do you mean this <code>char *names[7]={&quot;Jayan Tennakoon&quot;,&quot;John Long&quot;,&quot;Robert Lang&quot;};</code>"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462518139, "post_id": 37033964, "comment_id": 61678086, "body": "Have a look at the names2 declaration and compare it with how names is declared etc."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462518337, "post_id": 37033964, "comment_id": 61678174, "body": "Look at names2 that I added to the original answer. Note the difference between it and names. <code>names</code> is a pointer to a pointer, in this case we&#39;re allocating space for it by using <code>[7]</code>."}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462518435, "post_id": 37033964, "comment_id": 61678232, "body": "why can&#39;t I just use char[]={&quot;Arvind Asd&quot;,&quot; John Lang&quot;, &quot;Mike asdert&quot;} ?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462518924, "post_id": 37033964, "comment_id": 61678484, "body": "<code>name[]</code> would be to an array of chars, not an array of char pointers. You could use this <code>char *name[] = {...}</code>. I added another declaration to the answer that might help."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462519388, "post_id": 37033964, "comment_id": 61678750, "body": "Can you accept my answer if it answered your question?"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462708257, "post_id": 37033964, "comment_id": 61741429, "body": "yeah i can. it works perfectly. sorry i just saw this msg."}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462708376, "post_id": 37033964, "comment_id": 61741464, "body": "Hey can i ask u another question."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462728457, "post_id": 37033964, "comment_id": 61747487, "body": "If it&#39;s related to this one sure. If it&#39;s completely unrelated it might be better as another question on SO."}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462735413, "post_id": 37033964, "comment_id": 61749813, "body": "yes it is a totally different problem, can i tag u in that question ?"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462735425, "post_id": 37033964, "comment_id": 61749820, "body": "and how do i tag ?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462770280, "post_id": 37033964, "comment_id": 61758099, "body": "If it does not have a good answer then bung the link in here and if I can help I will."}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462993941, "post_id": 37033964, "comment_id": 61877489, "body": "<a href=\"http://stackoverflow.com/questions/37171421/i-can-not-input-the-names-into-the-char-array-using-scanf\" title=\"i can not input the names into the char array using scanf\">stackoverflow.com/questions/37171421/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1462993958, "post_id": 37033964, "comment_id": 61877495, "body": "this is the link. hope you could help me"}], "tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": false, "score": 1, "last_activity_date": 1462518838, "last_edit_date": 1462518838, "creation_date": 1462381561, "answer_id": 37033964, "question_id": 37033837, "link": "https://stackoverflow.com/questions/37033837/passing-char-array-into-a-function-in-c/37033964#37033964", "title": "Passing Char Array into a function in C", "body": "<p>You've declared an array of 7 pointers to char. You initialized it with 3 of them. You need to pass an array of pointers, not a pointer to an array of chars. Based on the comments I'll add a few more ways to declare the arrays that might make it clear what the different ways actually mean.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid fre(char *asd[]);\n\nint main(void) {\n  char * name  [ ] = {\"Jayan Tennakoon\",\"John Long\",\"Robert Lang\"};\n  char * names [7] = {\"Jayan Tennakoon\",\"John Long\",\"Robert Lang\"};\n  char   names2[7] = {'H', 'e', 'l','l','o','\\0'};\n  char **names3   = names;\n\n  printf(\"names2 = %s\\n\",names2);\n  printf(\"names3[0] = %s\\n\",names3[0]);\n  int i;\n  for(i = 0; i &lt; 3; i++) {\n    printf(\"%s\\n\",names[i]);\n  }\n  fre(names);\n  return 0;\n\n}\n\nvoid fre(char *asd[]) {\n  int i;\n  for(i = 0; i &lt; 3; i++) {\n    printf(\"%s\\n\",asd[i]);\n  }\n}\n</code></pre>\n\n<p>I also had to reduce the loop from <code>7</code> to <code>3</code> or you would experience Undefined Behavior, if lucky this would be a segmentation fault, if unlucky it would likely have printed garbage but exited with a return statue of 0. </p>\n"}], "owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10215, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1462518838, "creation_date": 1462381084, "question_id": 37033837, "link": "https://stackoverflow.com/questions/37033837/passing-char-array-into-a-function-in-c", "title": "Passing Char Array into a function in C", "body": "<p>I can not access the array from main in the function. How do i correct this ? Whenever I compile it say the argument 1 is of type **char and the argument 1 passed to fre in incompatible. Do i need to change any syntaxes ?</p>\n\n<pre><code>void fre(char *asd);\n\nint main()\n\n {\n   char *names[7]={\"Jayan Tennakoon\",\"John Long\",\"Robert Lang\"};\n\n   int i;\n\n   for(i=0;i&lt;7;i++)\n     {\n\n        printf(\"%s\\n\",names[i]);\n\n     }\n\n     fre(names);\n\n     return 0;\n\n }\n\n void fre(char *asd)\n   {\n     int i;\n\n     for(i=0;i&lt;7;i++)\n       {\n\n          printf(\"%s\\n\",asd[i]);\n\n       }\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm", "malloc", "set-intersection"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1462380567, "post_id": 37033609, "comment_id": 61617371, "body": "Evaluate the three conditions on each sample as you progress through the source array, writing only the results to the target array.  You are doing many more scans of the arrays with your approach, which can lead to lower performance."}, {"owner": {"reputation": 694, "user_id": 5510713, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/66561dd2d76babfc2ecd7d5e4a653644?s=128&d=identicon&r=PG&f=1", "display_name": "DhiwaTdG", "link": "https://stackoverflow.com/users/5510713/dhiwatdg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462380734, "post_id": 37033609, "comment_id": 61617478, "body": "@JonathanLeffler The conditions can be more than 3 frequently. What do I do in that case?"}, {"owner": {"reputation": 4590, "user_id": 2879325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503121b7e7487cd870c8afe40f0cf21?s=128&d=identicon&r=PG", "display_name": "Ext3h", "link": "https://stackoverflow.com/users/2879325/ext3h"}, "edited": false, "score": 0, "creation_date": 1462381076, "post_id": 37033609, "comment_id": 61617665, "body": "You don&#39;t need an <code>arr_temp</code>, just evaluate all predicates in single batch on each entry (and use two different implementations for OR and AND) and you are good to go in a single pass. No merge / intersect pass and only a single iteration over the data set for higher data locality."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462381111, "post_id": 37033609, "comment_id": 61617682, "body": "Regardless of the number of conditions, evaluate all the conditions on each row as you process it. Knowing the costs of the predicates is an important part of establishing an optimal query plan in a DBMS. Unless there is some phenomenal cost to evaluating the conditions that can be mitigated by not interleaving the queries (for example, if the <code>y==3</code> query is efficient only if you never interleave evaluations of that predicate with the evaluation of <code>x!=2</code> and vice versa \u2014 which is pretty unlikely), filtering all conditions at once will be quicker than multiple passes over the data."}], "owner": {"reputation": 694, "user_id": 5510713, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/66561dd2d76babfc2ecd7d5e4a653644?s=128&d=identicon&r=PG&f=1", "display_name": "DhiwaTdG", "link": "https://stackoverflow.com/users/5510713/dhiwatdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462380359, "creation_date": 1462380359, "question_id": 37033609, "link": "https://stackoverflow.com/questions/37033609/optimal-way-to-do-array-intersection-in-c", "title": "Optimal way to do array intersection in C", "body": "<p>I have a list of sample ID's with each sample possessing certain information in the format <code>[x]=2, [y]=3, [z]= 4</code>. I want to write a function which returns the list of sample ID's satisfying certain criteria. </p>\n\n<p>The structure of my query is <code>[cond1,cond2,...,condn, operator=AND/OR]</code>. For example if my query is: <code>[x&lt;5,y==3,x!=2,operator=AND]</code>, then following is my algorithm to process it,</p>\n\n<pre><code>Step 1: Allocate (malloc) 2 array pointers namely arr_final, arr_temp. \nStep 2: Find all the samples with `x&lt;5` store them in array `arr_final`, \nStep 3: Find all the samples with `y==3`, store them in array `arr_temp`. \nStep 4: Find the intersection of arr_final, arr_temp and store the result in `arr_final`.\nStep 5: Find all the samples with `x!=2` store them in array `arr_temp`.\nStep 6: Repeat step 4\nStep 7: Return arr_final\n</code></pre>\n\n<p>If the operator is <code>OR</code> then I keep only one array which is <code>arr_final</code>, store the sample id's if they are not present in array already and return <code>arr_final</code> at the end. </p>\n\n<p>Will be above algorithm work optimally or is there a better one?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462381566, "post_id": 37033487, "comment_id": 61617908, "body": "Presumably, you left out the allocation of memory for the &#39;threads&#39; array to reduce posted code size?"}], "answers": [{"comments": [{"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 1, "creation_date": 1462385367, "post_id": 37033973, "comment_id": 61620165, "body": "While this may work in practice, <code>pthread_t</code> is an opaque type, not necessarily arithmetic, and not necessarily an <code>int</code> even if it happens to be arithmetic."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1462385512, "post_id": 37033973, "comment_id": 61620265, "body": "@pilcrow, <code>printf</code> is just an example. printf format specifier lacks the type to print <code>thread_t</code>, so this is a best I could do."}, {"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 1, "creation_date": 1462385771, "post_id": 37033973, "comment_id": 61620447, "body": "But <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_equal.html#tag_16_426_08\" rel=\"nofollow noreferrer\"><code>pthread_t</code> might be a structure</a>, meaning that <code>printf</code> couldn&#39;t be used meaningfully and portably."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1462385947, "post_id": 37033973, "comment_id": 61620540, "body": "@pilcrow, and I am totally aware of that. I would tell you more - printing it is meaningless, unless it has some special meaning to you - for example, it matches LWP id you are observing somewhere else - and in this case it is already non-portable and system-specific. My whole point was to show that opaque value <b>is</b> the thread id OP is looking for."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1462381603, "creation_date": 1462381603, "answer_id": 37033973, "question_id": 37033487, "link": "https://stackoverflow.com/questions/37033487/efficent-way-for-a-parent-to-get-its-childs-id-after-pthread-create/37033973#37033973", "title": "efficent way for a parent to get its child&#39;s id after pthread_create?", "body": "<p>As per man page, thread id is the same thing as <code>pthread_t</code> returned by <code>pthread_create</code>. So you can just print that:</p>\n\n<pre><code>printf(\"%d\", threads[i]);\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 37033973, "answer_count": 1, "score": 0, "last_activity_date": 1462381603, "creation_date": 1462379986, "question_id": 37033487, "link": "https://stackoverflow.com/questions/37033487/efficent-way-for-a-parent-to-get-its-childs-id-after-pthread-create", "title": "efficent way for a parent to get its child&#39;s id after pthread_create?", "body": "<p>Consider the next piece of code - </p>\n\n<pre><code>pthread_t* threads;\n\nvoid createWorkers(WorkerType type)\n{\n    // Create mapper threads and their Container\n    for (int i = 0; i &lt; poolSize; ++i)\n    {\n        // Add new Thread\n        ret = pthread_create(&amp;threads[i], nullptr, function, nullptr);\n\n        // HERE THE MAIN THREAD PRINTS THE JUST CREATED THREAD ID (*)\n    }\n}\n\nint main()\n{\n    createWorkers();\n\n    // JOINING THE THREADS\n\n    return 0;\n}\n</code></pre>\n\n<p>Is there a way for the parent (the main thread) to get its child id? For example right after creating a child in line (*)?</p>\n"}, {"tags": ["python", "c", "memory-leaks", "ctypes", "loadlibrary"], "comments": [{"owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "edited": false, "score": 0, "creation_date": 1462381903, "post_id": 37033470, "comment_id": 61618087, "body": "I suppose a more elegant solution to my above workaround would be to exit and relaunch the worker process on a regular interval. This would allow the memory leaked by the vendor&#39;s library to free, but wouldn&#39;t crash the interpreter."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1462385589, "post_id": 37033470, "comment_id": 61620315, "body": "If freeing the library works, then it&#39;s not really a memory leak. The library must be tracking these allocations to free them on <code>DLL_PROCESS_DETACH</code>. As to unloading <code>vendor_dll</code>, you should first remove all references to the current instance and ensure nothing executes its code again, including outstanding asynchronous callbacks. Then you can unload and reload the DLL. Shared libraries are reference counted, so to ensure it&#39;s actually unloaded, call <code>FreeLibrary</code> until it raises an <code>OSError</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "is_accepted": true, "score": 1, "last_activity_date": 1462479335, "last_edit_date": 1462479335, "creation_date": 1462477511, "answer_id": 37059025, "question_id": 37033470, "link": "https://stackoverflow.com/questions/37033470/how-to-workaround-a-memory-leak-in-a-vendors-dll-being-used-in-python/37059025#37059025", "title": "How to workaround a memory leak in a vendor&#39;s DLL being used in Python?", "body": "<p>In the end, I fixed the issue by loading the vendor's library in a separate process, and accessing it through Pyro4, like so:</p>\n\n<pre><code>class LibraryWorker(multiprocessing.Process):\n    def __init__(self):\n        super().__init__()\n\n    def run(self):\n        self.library = ctypes.windll.LoadLibrary(\n            'vendor_library.dll')\n\n        Pyro4.serveSimple(\n            {self, 'library'},\n            ns=False)\n\n    def lib_func(self):\n        res = self.library.func()\n        return res\n</code></pre>\n\n<p>It was a bit of extra work to massage the old code to not pass ctypes pointers between the two processes, but it works.</p>\n\n<p>With the library loaded in a separate process, I can keep track of the memory usage. When it gets too high, I can terminate and recreate the process to free the memory.</p>\n"}], "owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 37059025, "answer_count": 1, "score": 4, "last_activity_date": 1462479335, "creation_date": 1462379925, "last_edit_date": 1462380887, "question_id": 37033470, "link": "https://stackoverflow.com/questions/37033470/how-to-workaround-a-memory-leak-in-a-vendors-dll-being-used-in-python", "title": "How to workaround a memory leak in a vendor&#39;s DLL being used in Python?", "body": "<p>I'm using a vendor's C API for a piece of business software by loading their library using Python's ctypes module.</p>\n\n<p>After deploying the software I wrote, I found that the vendor's library leaks memory on a consistent and predictable basis, according to the number of calls of a certain function that's part of their API.</p>\n\n<p>I even duplicated the leak in a C program that uses no heap allocations.</p>\n\n<p>I contacted the vendor about the issue, and they said they're working on it, but I probably can't realistically expect a fix until the next version of the software.</p>\n\n<p>I had the idea of reloading the vendor's dll after a certain threshold of calls to the leaking function, but this did not release the leaked memory.</p>\n\n<p>I found that I could force the library to unload like so:</p>\n\n<pre><code>_ctypes.FreeLibrary(vendor_dll._handle)\n</code></pre>\n\n<p>This frees the memory, but causes the interpreter to crash seemingly randomly after a number of minutes of using the vendor's API.</p>\n\n<p>I found this issue in the Python bug tracker that describes my situation:\n<a href=\"https://bugs.python.org/issue14597\" rel=\"nofollow\">https://bugs.python.org/issue14597</a></p>\n\n<p>It seems that if there's still an open reference to the library, forcing it to unload will inevitably crash the Python interpreter.</p>\n\n<p>Worst case scenario, I'm thinking I could load the vendor's library in a separate process, proxy requests using a multiprocessing Queue, and setup a watchdog to recreate the process if the interpreter dies.</p>\n\n<p>Is there a better way to work around this? </p>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 515, "user_id": 6183448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1806456301/picture?type=large", "display_name": "Adrian Roman", "link": "https://stackoverflow.com/users/6183448/adrian-roman"}, "edited": false, "score": 0, "creation_date": 1462380103, "post_id": 37033443, "comment_id": 61617068, "body": "After a quick look, I think you might want to send the ending zero at the back of the string, too, that is <code>write(clientSocket,buffer,strlen(buffer)+1);</code>"}, {"owner": {"reputation": 5, "user_id": 2354587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20129bd1bf6c5893949a1f89ed780bb9?s=128&d=identicon&r=PG", "display_name": "Gold Flake", "link": "https://stackoverflow.com/users/2354587/gold-flake"}, "reply_to_user": {"reputation": 515, "user_id": 6183448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1806456301/picture?type=large", "display_name": "Adrian Roman", "link": "https://stackoverflow.com/users/6183448/adrian-roman"}, "edited": false, "score": 0, "creation_date": 1462381011, "post_id": 37033443, "comment_id": 61617631, "body": "i did that but now I am getting a segmentation fault(core dumped)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1462381145, "post_id": 37033443, "comment_id": 61617701, "body": "<code>n = read(welcomeSocket,buffer,255);</code> --&gt;&gt; <code>n = read(newSocket,buffer,255);</code> , same for <code>n = write(welcomeSocket,&quot;I got your message&quot;,18);</code>  [plus: many others ...]"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1462384123, "post_id": 37033443, "comment_id": 61619384, "body": "Use a debugger or print intermediate data to find the issue or focus your question. Questions of the type &quot;what am I doing wrong&quot; aren&#39;t favored by the community. Better to ask &quot;why don&#39;t the buffer string length and content match the data received?&quot; is a focused question that shows you&#39;re not just dumping code for us to debug."}, {"owner": {"reputation": 5, "user_id": 2354587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20129bd1bf6c5893949a1f89ed780bb9?s=128&d=identicon&r=PG", "display_name": "Gold Flake", "link": "https://stackoverflow.com/users/2354587/gold-flake"}, "edited": false, "score": 0, "creation_date": 1462384506, "post_id": 37033443, "comment_id": 61619627, "body": "yeah sorry for that. Gonna rectify that"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2354587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20129bd1bf6c5893949a1f89ed780bb9?s=128&d=identicon&r=PG", "display_name": "Gold Flake", "link": "https://stackoverflow.com/users/2354587/gold-flake"}, "edited": false, "score": 0, "creation_date": 1462383282, "post_id": 37034052, "comment_id": 61618848, "body": "@T Johnson Thanks for the help. But I am getting segmentation fault(core dumped) while running the client program. Can you please help me with that?"}], "tags": [], "owner": {"reputation": 819, "user_id": 6086833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060138486ddeff3186d29262a5852c76?s=128&d=identicon&r=PG&f=1", "display_name": "T Johnson", "link": "https://stackoverflow.com/users/6086833/t-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1462381862, "creation_date": 1462381862, "answer_id": 37034052, "question_id": 37033443, "link": "https://stackoverflow.com/questions/37033443/server-client-program-in-c-using-sockets-and-tcp/37034052#37034052", "title": "Server Client program in C using sockets and tcp", "body": "<p>In your server code the <code>read()</code> should use the socket descriptor returned from the <code>accept()</code> not from the call to <code>socket()</code>. So try reading using <code>newSocket</code> rather than <code>welcomeSocket</code>.</p>\n\n<pre><code>n = read(newSocket,buffer,255);\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2354587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20129bd1bf6c5893949a1f89ed780bb9?s=128&d=identicon&r=PG", "display_name": "Gold Flake", "link": "https://stackoverflow.com/users/2354587/gold-flake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1284, "favorite_count": 0, "accepted_answer_id": 37034052, "answer_count": 1, "score": -4, "last_activity_date": 1462384556, "creation_date": 1462379830, "last_edit_date": 1462384556, "question_id": 37033443, "link": "https://stackoverflow.com/questions/37033443/server-client-program-in-c-using-sockets-and-tcp", "title": "Server Client program in C using sockets and tcp", "body": "<p>I have written a program for simple text chatting between server and client using socket programming. The server side runs okay since it's listening but when I run the client side program it runs but shows no output, meaning nothing shows up on server side if I type in Client side. Why am I not getting any response from Client side?</p>\n\n<pre><code>    /****************** CLIENT CODE ****************/\n\n        #include &lt;stdio.h&gt;\n        #include &lt;sys/socket.h&gt;\n        #include &lt;netinet/in.h&gt;\n        #include &lt;string.h&gt;\n\n        int main(){\n  int clientSocket,n;\n  char buffer[256];\n  struct sockaddr_in serverAddr;\n  socklen_t addr_size;\n\n  /*---- Create the socket. The three arguments are: ----*/\n  /* 1) Internet domain 2) Stream socket 3) Default protocol (TCP in this case) */\n  clientSocket = socket(PF_INET, SOCK_STREAM, 0);\n\n  /*---- Configure settings of the server address struct ----*/\n  /* Address family = Internet */\n  serverAddr.sin_family = AF_INET;\n  /* Set port number, using htons function to use proper byte order */\n  serverAddr.sin_port = htons(7891);\n  /* Set IP address to localhost */\n  serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n  /* Set all bits of the padding field to 0 */\n  memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);  \n\n  /*---- Connect the socket to the server using the address struct ----*/\n  addr_size = sizeof serverAddr;\n  connect(clientSocket, (struct sockaddr *) &amp;serverAddr, addr_size);\n\n  if (connect(clientSocket,(struct sockaddr *) &amp;serverAddr,sizeof(serverAddr)) &lt; 0) \n        error(\"ERROR connecting\");\n    printf(\"Please enter the message: \");\n    bzero(buffer,256);\n    fgets(buffer,255,stdin);\n    n = write(clientSocket,buffer,strlen(buffer));\n    if (n &lt; 0) \n         error(\"ERROR writing to socket\");\n    bzero(buffer,256);\n    n = read(clientSocket,buffer,255);\n    if (n &lt; 0) \n         error(\"ERROR reading from socket\");\n    printf(\"%s\\n\",buffer);\n    close(clientSocket);\n  /*---- Read the message from the server into the buffer ----*/\n  //recv(clientSocket, buffer, 1024, 0);\n\n  /*---- Print the received message ----*/\n  //printf(\"Data received: %s\",buffer);   \n\n  return 0;\n}\n\n\n/****************** SERVER CODE ****************/\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n  int welcomeSocket, newSocket;\n  char buffer[256];\n  int n;\n  struct sockaddr_in serverAddr;\n  struct sockaddr_storage serverStorage;\n  socklen_t addr_size;\n\n  /*---- Create the socket. The three arguments are: ----*/\n  /* 1) Internet domain 2) Stream socket 3) Default protocol (TCP in this case) */\n  welcomeSocket = socket(PF_INET, SOCK_STREAM, 0);\n\n  /*---- Configure settings of the server address struct ----*/\n  /* Address family = Internet */\n  serverAddr.sin_family = AF_INET;\n  /* Set port number, using htons function to use proper byte order */\n  serverAddr.sin_port = htons(7891);\n  /* Set IP address to localhost */\n  serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n  /* Set all bits of the padding field to 0 */\n  memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);  \n\n  /*---- Bind the address struct to the socket ----*/\n  bind(welcomeSocket, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr));\n\n  /*---- Listen on the socket, with 5 max connection requests queued ----*/\n  if(listen(welcomeSocket,5)==0)\n    printf(\"Listening\\n\");\n  else\n    printf(\"Error\\n\");\n\n  /*---- Accept call creates a new socket for the incoming connection ----*/\n  addr_size = sizeof serverStorage;\n  newSocket = accept(welcomeSocket, (struct sockaddr *) &amp;serverStorage, &amp;addr_size);\n\n  /*---- Send message to the socket of the incoming connection ----*/\n  bzero(buffer,256);\n     n = read(welcomeSocket,buffer,255);\n     if (n &lt; 0) error(\"ERROR reading from socket\");\n     printf(\"Here is the message: %s\\n\",buffer);\n     n = write(welcomeSocket,\"I got your message\",18);\nif (n &lt; 0) error(\"ERROR reading from socket\");\n     printf(\"Here is the message: %s\\n\",buffer);\n     n = write(welcomeSocket,\"I got your message\",18);\n     if (n &lt; 0) error(\"ERROR writing to socket\");\n     close(newSocket);\n     close(welcomeSocket);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1462379765, "post_id": 37033236, "comment_id": 61616847, "body": "Your function <code>void print_rmchr (char str[], char ch)</code> does not take a file pointer argument, but it uses one. However it is defined in <code>main</code> so it is out of the scope of <code>print_rmchr</code>. Either pass the file pointer as an arguemnt, or move it to be a global variable (not good practice)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1462379825, "post_id": 37033236, "comment_id": 61616883, "body": "Also : you write <code>print_rmchr(filePtr, str1, chr1);</code>, but it takes only 2 arguments."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1462379851, "post_id": 37033236, "comment_id": 61616906, "body": "<code>void print_rmchr (char str[], char ch);</code> --&gt; <code>void print_rmchr (FILE *filePtr, char str[], char ch);</code>, <code>void print_rmchr (char str[], char ch){</code> --&gt; <code>void print_rmchr (FILE *filePtr ,char str[], char ch){</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462380183, "post_id": 37033236, "comment_id": 61617119, "body": "the posted code does not compile.  The compiler outputs 34 messages.  When compiling, always enable all the warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu99</code> )   I&#39;m running on ubuntu linux 14.04.4 with gcc version: 4.8.4.  Strongly suggest fixing all those warnings."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1462380509, "post_id": 37033236, "comment_id": 61617319, "body": "While it <i>is</i> legal to have embedded function prototypes inside a function (e.g. the <code>rmchr</code> inside <code>print_rmchr</code>, which is unnecessary since <code>rmchr</code> appears above <code>print_rmchr</code>), for this simple program it&#39;s much easier to put them at the top of the file as &quot;forward&quot; declarations [the &quot;nested&quot; declaration is <i>less</i> usual and <i>more</i> prone to error]. Or, just reorder the functions in the file as: <code>rmchr, print_rmchr, main</code>. Currently, you&#39;ve got conflicting definitions."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462380629, "post_id": 37033236, "comment_id": 61617418, "body": "1) place function prototypes outside/before the first function.  2) Best to write a prototype for every function in the file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462380909, "post_id": 37033236, "comment_id": 61617579, "body": "all the system functions, like <code>fopen()</code> return some success/fail status. and set the hidden variable <code>errno</code>.   Statements about an error condition should be displayed on <code>stderr</code>.  When a system function returns an error indication, you have choice between using <code>fprintf()</code> or using <code>perror()</code>.   The perror() function is much easier to use but not as flexible.   After displaying an error message, it is normal to &#39;cleanup&#39; (close files, free memory, etc) then call <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381078, "post_id": 37033236, "comment_id": 61617666, "body": "the function <code>strlen()</code> returns a <code>size_t</code> not an <code>int</code>, so the declaration of <code>size</code> should be: <code>size_t size;</code>  Note: this may require a bit of tweaking of certain other spots in the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381169, "post_id": 37033236, "comment_id": 61617713, "body": "for ease of readability and understanding by us humans: 1) consistently indent the code.  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381405, "post_id": 37033236, "comment_id": 61617825, "body": "comments after the code, indicate to use <code>gets()</code>,  However, <code>gets() has been depreciated for years and completely removed in the C11 standard.  Suggest using </code>fgets()`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381476, "post_id": 37033236, "comment_id": 61617858, "body": "comments after the code indicate using <code>scanf()</code>.   When ever using any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter value) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381771, "post_id": 37033236, "comment_id": 61618019, "body": "this statement: <code>if (fprintf(filePtr, &quot;The string &#39;%s&#39; will be removed from &#39;%c&#39; characters. \\n\\n&quot;, str, ch) &lt; 0)</code> is not correct.  Suggest: <code>if (fprintf(filePtr, &quot;All instances of character %c will be removed from string &#39;%s. \\n\\n&quot;, ch, str) &lt; 0)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462381826, "post_id": 37033236, "comment_id": 61618046, "body": "@user3629249, the code I put in the comments are obsolete, agree. They were taken from really old book that our teacher is using for our class."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462381992, "post_id": 37033236, "comment_id": 61618134, "body": "in the <code>rmchr()</code> function: the <code>size</code> variable can be eliminated, then this line: <code>for (i = 0; i &lt; size; i++)</code> would be: <code>for (i = 0; str[i]; i++)</code>.   Then the loop would still exit correctly when it encounters the &#39;\\0&#39; character at the end of the string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462382169, "post_id": 37033236, "comment_id": 61618216, "body": "@CraigEstey my teacher wants to do all function prototypes mostly in the main function (+ sometimes in other functions). Global function protorypes get -1 point for each. That looks very obsolete, but I have to adjust to teacher&#39;s rules. :-)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462382197, "post_id": 37033236, "comment_id": 61618243, "body": "in the <code>rmchr()</code> function, &#39;j&#39; will never get ahead of &#39;i&#39;, so the string could be modified &#39;inplace&#39; rather than placed in a &#39;automatic&#39; char array.   Also, when happens when the original string is more than 19 characters?  Then the &#39;automatic&#39; char array could be overrun, resulting in undefined behaviour and can lead to a seg fault event."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382347, "post_id": 37033236, "comment_id": 61618331, "body": "@user3629249 teacher doesn&#39;t like global function prototypes :-("}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1462382451, "post_id": 37033236, "comment_id": 61618389, "body": "the posted code contains some &#39;magic&#39; numbers.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, maintain.  Suggest using an <code>enum</code> statement or <code>#define</code> statement to give the &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382602, "post_id": 37033236, "comment_id": 61618477, "body": "@user3629249 I appreciate your work here, but I am so complete noob! I will save in the comments of what I will have to fix later. One day I will return when I will understand C better."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382712, "post_id": 37033236, "comment_id": 61618548, "body": "@user3629249 what do you mean by magic numbers? If you are talking about str(i) and chr(i) then I guess you are correct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382728, "post_id": 37033236, "comment_id": 61618559, "body": "global function prototypes???  all functions have file global scope.   Embedding the prototype for  function-2 inside function-1 means the compiler will use the embedded prototype within function-1  but will use what ever function-2 signature is when actually compiling function-2  I.E. those signatures can be different.   When the prototype is before any functions, then every call to function-2 and the function-2 signature are forced to be the same.  Otherwise the compiler will output a warning message."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382737, "post_id": 37033236, "comment_id": 61618567, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/111035/discussion-between-mikhail-and-user3629249\">continue this discussion in chat</a>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462382801, "post_id": 37033236, "comment_id": 61618601, "body": "&#39;magic&#39; numbers are numbers that have no basis.   In the posted code, the &#39;magic&#39; numbers are/is: <code>20</code>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462385242, "post_id": 37033236, "comment_id": 61620087, "body": "Your teacher doesn&#39;t like global function prototypes? I&#39;ve got 35+ years of C programming experience and that&#39;s just plain silly [one of the silliest things I&#39;ve ever heard a teacher say]. Your teacher is a <b>lousy</b> C programmer. It is quite common to autogenerate the prototypes with a script. Also, it is <i>necessary</i> for global prototypes functions in <code>libc</code> like <code>fprintf</code>, <code>fopen</code>, etc. that are defined in <code>stdio.h</code>. Without global prototypes, you&#39;d have to manually create scoped ones in all functions that use a given function. Your teacher would get fired from any commercial programming job"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462585616, "post_id": 37033236, "comment_id": 61711844, "body": "@CraigEstey, many younger teachers that I have met use global function prototypes. My teacher is like 70+ years old, don&#39;t blame her. :-) The book that we use in class doesn&#39;t come with a CD disk. It comes with <i>diskette</i> instead. I guess the issue comes from a book.  It&#39;s literally older than me. :-)"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462587853, "post_id": 37033236, "comment_id": 61712204, "body": "I&#39;m 61 and started C in 1981, there were no ANSI protos then, but I started using them ASAP because they were better [25+ years ago]. From your teacher: No globals. So no printf proto in stdio.h? Can&#39;t do your own at top of your .c? So, <i>every</i> fnc you write has to have a fnc scoped proto? Seriously, think about it. She&#39;s teaching you out of date stuff (e.g. <code>+=</code> was originally <code>=+</code> but nobody&#39;s used that since 1980). As an academician, it is part of your teacher&#39;s job to continue her own education, to be able to teach the language as it is commonly used now"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462589165, "post_id": 37033236, "comment_id": 61712405, "body": "When I started in 1972, I was using Fortran IV--nothing like Fortran of today. I also started with keypunch cards, but not after 1977. At each stage, when new tech came along, (e.g. mainframe, mini, supermini, micro, workstation) or new languages (or improvements), it has been part of my job to learn and adapt. I&#39;ll [still] fault your teacher for not figuring out the logic/sensibility/rationale of the global protos and changing her view [<i>and</i> the book :-)] over a <b>25</b> year period. She could at least use a mimeograph handout to explain the global protos. In the end, she&#39;s only hurting <i>you</i>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "edited": false, "score": 0, "creation_date": 1462381120, "post_id": 37033426, "comment_id": 61617687, "body": "It works! Yeah, I supposed to do that. Next time will be more careful. One more question: for <b>filePtr = fopen(&quot;rmchr.txt&quot;, &quot;w&quot;);</b>. When I run the program, and the file doesn&#39;t exist, it just created one. Isn&#39;t the &#39;w&#39; supposed to yell when the file is not found instead of creating one?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1462383384, "post_id": 37033426, "comment_id": 61618920, "body": "No. The <code>&quot;w&quot;</code> will create a new file when it doesn&#39;t exist and it will overwrite an existing file if a file with the given name already exists."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 1, "last_activity_date": 1462379775, "creation_date": 1462379775, "answer_id": 37033426, "question_id": 37033236, "link": "https://stackoverflow.com/questions/37033236/passing-argument-from-incompatible-pointer-type-c/37033426#37033426", "title": "Passing argument from incompatible pointer type (C)", "body": "<p>When you want to pass more or other arguments to a function, you must modify both the calls and the function definition, so that they are compatible with each other. Change it from</p>\n\n<pre><code>void print_rmchr (char str[], char ch);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>void print_rmchr (FILE *filePtr, char str[], char ch);\n</code></pre>\n\n<p>As is, the symbol <code>filePtr</code> is local to <code>main</code> and not known in <code>print_rmchr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1462383480, "creation_date": 1462383480, "answer_id": 37034483, "question_id": 37033236, "link": "https://stackoverflow.com/questions/37033236/passing-argument-from-incompatible-pointer-type-c/37034483#37034483", "title": "Passing argument from incompatible pointer type (C)", "body": "<p>after applying all the comments, the <code>rmchr()</code> function becomes:</p>\n\n<pre><code>//remove certain characters from array\nvoid rmchr(char str[], char ch)\n{\n   size_t i;\n   int    j = 0;    //loop variable\n\n   for (i = 0; str[i]; i++)\n   {\n      if (str[i] != ch)\n      {\n         new_str[j] = str[i];\n         j++;\n      }\n   }\n\n   str[j] = '\\0';\n}\n</code></pre>\n\n<p>When opening a file, this pattern will give you problems, mostly due to the extranious indenting of any following code:</p>\n\n<pre><code>FILE *filePtr;\n\nfilePtr = fopen(\"rmchr.out\", \"w\");\n\nif( filePtr == NULL)\n  printf(\"Unable to open the data file.\\n\");\n\nelse\n\n\nsuggest using the following pattern:\n\nFILE *filePtr = NULL; // best to always initialize stack variables\n\nif( NULL == (filePtr = fopen(\"rmchr.out\", \"w\") ) )\n{\n    // output your message, plus the system error message\n    perror( \"fopen rmchr.out for write failed\" );\n\n    // exit() and EXIT_FAILURE in 'stdlib.h'\n    exit( EXIT_FAILURE );  \n}\n\n// implied else, fopen successful\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5737301"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 37033426, "answer_count": 2, "score": 0, "last_activity_date": 1462584723, "creation_date": 1462379202, "last_edit_date": 1462584723, "question_id": 37033236, "link": "https://stackoverflow.com/questions/37033236/passing-argument-from-incompatible-pointer-type-c", "title": "Passing argument from incompatible pointer type (C)", "body": "<p>I need to create a program that lists the hard-coded input into a different file. I have encountered issue in the fprintf section.</p>\n\n<blockquote>\n  <p>The full program is listed in the back. </p>\n</blockquote>\n\n<p>I have talked to my teacher and she marked </p>\n\n<pre><code>   else\n    {\n        print_rmchr(str1, chr1);\n        print_rmchr(str2, chr2);\n        print_rmchr(str3, chr3);\n        print_rmchr(str4, chr4);\n        print_rmchr(str5, chr5);\n\n        if (fclose(filePtr) != 0)\n            printf(\"Unable to close the data file.\\n\");\n    }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>if (fprintf(\"The string '%s' will be removed from '%c' characters. \\n\\n\", str, ch) &lt; 0)\n    printf(\"Unable to print non-modified string with a modifying character. \\n\");\n\nrmchr(str, ch);\n\nif (fprintf(\"New modified string is: '%s'. \\n\\n\", str) &lt; 0)\n    printf(\"Unable to print new modified string. \\n\");\n</code></pre>\n\n<p>as wrong part of the code in my assignment. </p>\n\n<p>I looked at similar questions on starkoverflow and found that I have to put filepointer before fprintf.\nMy second chunk of the bad code now looks like this: </p>\n\n<pre><code>if (fprintf(filePtr, \"The string '%s' will be removed from '%c' characters. \\n\\n\", str, ch) &lt; 0)\n    printf(\"Unable to print non-modified string with a modifying character. \\n\");\n\nrmchr(str, ch);\n\nif (fprintf(filePtr, \"New modified string is: '%s'. \\n\\n\", str) &lt; 0)\n    printf(\"Unable to print new modified string. \\n\");\n</code></pre>\n\n<p>And then compiler yelled at me for not knowing why there was file pointer, so I also fixed it as </p>\n\n<pre><code>print_rmchr(filePtr, str, chr);\n</code></pre>\n\n<p>But then it began to yell at me as if \"passing argument from incompatible pointer type\". It looks right for me, but something is missing(?) I guess.</p>\n\n<p>My full program:</p>\n\n<pre><code>/*\n* A simple program to remove certain characters from the given strings                              \n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main () {\n\n    // print array before and after editing array\n    void print_rmchr (char str[], char ch); \n\n    char str1[20] = \"abracadabra\";      //string #1\n    char str2[20] = \"abracadabra\";      //string #2\n    char str3[20] = \"abracadabra\";      //string #3\n    char str4[20] = \"aaaa\";             //string #4\n    char str5[20] = \"aaaa\";             //string #5\n\n    char chr1 = 'a';                    //character #1\n    char chr2 = 'b';                    //character #2\n    char chr3 = 'n';                    //character #3\n    char chr4 = 'a';                    //character #4\n    char chr5 = 'n';                    //character #5\n\n    FILE *filePtr;\n\n    filePtr = fopen(\"rmchr.out\", \"w\");\n\n    if( filePtr == NULL)\n      printf(\"Unable to open the data file.\\n\");\n\n   else\n    {\n        print_rmchr(filePtr, str1, chr1);\n        print_rmchr(filePtr, str2, chr2);\n        print_rmchr(filePtr, str3, chr3);\n        print_rmchr(filePtr, str4, chr4);\n        print_rmchr(filePtr, str5, chr5);\n\n        if (fclose(filePtr) != 0)\n            printf(\"Unable to close the data file.\\n\");\n    }\n    return 0;\n}\n\n//remove certain characters from array\nvoid rmchr(char str[], char ch) {\n   int i, j = 0;    //loop variable\n   int size;        //lengh \n   char new_str[20];    //new array\n\n   size = strlen(str);\n\n   for (i = 0; i &lt; size; i++) {\n      if (str[i] != ch) {\n         new_str[j] = str[i];\n         j++;\n      }\n   }\n   new_str[j] = '\\0';\n\n   strcpy(str, new_str);\n}\n\n// print array before and after editing array\nvoid print_rmchr (char str[], char ch){\n\n    //remove certain characters from array\n    void rmchr(char str[], char ch);\n\n    if (fprintf(filePtr, \"The string '%s' will be removed from '%c' characters. \\n\\n\", str, ch) &lt; 0)\n        printf(\"Unable to print non-modified string with a modifying character. \\n\");\n\n    rmchr(str, ch);\n\n    if (fprintf(filePtr, \"New modified string is: '%s'. \\n\\n\", str) &lt; 0)\n        printf(\"Unable to print new modified string. \\n\");\n}\n\n    /* In case you will need user input:\n    //USER INPUT\n    printf(\"Enter the string : \\n\");\n    gets(str);\n\n    printf(\"Enter character which you want to delete : \\n\");\n    scanf(\"%ch\", &amp;ch);\n\n    print_rmchr(str, ch);\n    */\n</code></pre>\n\n<p>FINAL, corrected version:</p>\n\n<pre><code>/*\n* A simple program to remove certain characters from the given strings                              \n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 20\n\nint main () {\n\n    // print array before and after editing array\n    void print_rmchr (FILE *filePtr, char str[], char ch);\n\n    char str1[MAX] = \"abracadabra\";      //string #1\n    char str2[MAX] = \"abracadabra\";      //string #2\n    char str3[MAX] = \"abracadabra\";      //string #3\n    char str4[MAX] = \"aaaa\";             //string #4\n    char str5[MAX] = \"aaaa\";             //string #5\n\n    char chr1 = 'a';                    //character #1\n    char chr2 = 'b';                    //character #2\n    char chr3 = 'n';                    //character #3\n    char chr4 = 'a';                    //character #4\n    char chr5 = 'n';                    //character #5\n\nFILE *filePtr = NULL; // best to always initialize stack variables\n\nif( NULL == (filePtr = fopen(\"rmchr.txt\", \"w\") ) )\n{\n    // output your message, plus the system error message\n    perror(\"fopen rmchr.out for write failed\");\n\n    // exit() and EXIT_FAILURE in 'stdlib.h'\n    exit(EXIT_FAILURE);  \n}\n// implied else, fopen successful\n\n    print_rmchr(filePtr, str1, chr1);\n    print_rmchr(filePtr, str2, chr2);\n    print_rmchr(filePtr, str3, chr3);\n    print_rmchr(filePtr, str4, chr4);\n    print_rmchr(filePtr, str5, chr5);\n\n    if (fclose(filePtr) != 0)\n        printf(\"Unable to close the data file.\\n\");\n\n    return 0;\n}\n\n//remove certain characters from array\nvoid rmchr(char str[], char ch)\n{\n    size_t i;       //loop variable\n    int j = 0;      //loop variable\n    char new_str[MAX];    //new array\n\n    for (i = 0; str[i]; i++) {\n      if (str[i] != ch) {\n         new_str[j] = str[i];\n         j++;\n      }\n    }\n    new_str[j] = '\\0';\n\n    strcpy(str, new_str);  \n}\n\n// print array before and after editing array\nprint_rmchr (FILE *filePtr, char str[], char ch){\n\n    //remove certain characters from array\n    void rmchr(char str[], char ch);\n\n    if (fprintf(filePtr, \"All instances of character %c will be removed from string '%s. \\n\\n\", ch, str) &lt; 0)\n        printf(\"Unable to print non-modified string with a modifying character. \\n\");\n\n    rmchr(str, ch);\n\n    if (fprintf(filePtr, \"New modified string is: '%s'. \\n\\n\", str) &lt; 0)\n        printf(\"Unable to print new modified string. \\n\");\n}\n\n    /* In case you will need user input:\n    //USER INPUT\n    printf(\"Enter the string : \\n\");\n    fgets(str);\n\n    printf(\"Enter character which you want to delete : \\n\");\n    scanf(\"%ch\", &amp;ch);\n    //need to check the returned value of scanf\n\n    print_rmchr(str, ch);\n    */\n</code></pre>\n"}, {"tags": ["c", "x86", "sse", "simd", "sse2"], "comments": [{"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 1, "creation_date": 1462377644, "post_id": 37032625, "comment_id": 61615558, "body": "What is your SSE level? There are several instruction sets indictated by CPUID: 1, 2, 3, 4, 4.1, 4.2, AVX, AVX2, FMA3, FMA4, BMI, BMI2, ... I ask that, because calculating complex numbers with FMAx is a piece of cake..."}, {"owner": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 1, "creation_date": 1462377722, "post_id": 37032625, "comment_id": 61615608, "body": "use <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=_mm_store\" rel=\"nofollow noreferrer\">_mm_store*</a>, either _mm_storeu_pd or _mm_store_pd"}, {"owner": {"reputation": 263, "user_id": 5232742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/37cea52f3e654edd6e7ba6e1b741983e?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/5232742/nils"}, "edited": false, "score": 0, "creation_date": 1462377818, "post_id": 37032625, "comment_id": 61615674, "body": "It has to be compatible with SSE2"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1462378235, "post_id": 37032625, "comment_id": 61615920, "body": "Anything that looks like <code>set(var, var)</code> will generate really annoying code. The only safe set is with constant arguments."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1462384397, "post_id": 37032876, "comment_id": 61619556, "body": "Yup, <a href=\"https://godbolt.org/g/WISDUa\" rel=\"nofollow noreferrer\">gcc5 auto-vectorizes this just fine with SSE2</a>, even without <code>-ffast-math</code>.  Even gcc 4.9.2 doesn&#39;t seem to manage it, though.  Clang as usual unrolls it a reasonable amount.  (Only clang 3.6 and newer auto-vectorize.)"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1462386341, "post_id": 37032876, "comment_id": 61620775, "body": "gcc 4.9.2 seems to need <code>-ffast-math</code> before it will vectorize this (it&#39;s not clear why that should be the case though)."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1462389357, "post_id": 37032876, "comment_id": 61622610, "body": "Perhaps it just gets scared because there are floats and float optimizations are scary"}, {"owner": {"reputation": 263, "user_id": 5232742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/37cea52f3e654edd6e7ba6e1b741983e?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/5232742/nils"}, "edited": false, "score": 0, "creation_date": 1462716529, "post_id": 37032876, "comment_id": 61743675, "body": "How would I unroll by a factor of 2?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 263, "user_id": 5232742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/37cea52f3e654edd6e7ba6e1b741983e?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/5232742/nils"}, "edited": false, "score": 0, "creation_date": 1462721659, "post_id": 37032876, "comment_id": 61745205, "body": "@Nils: just do two loads, two mutiplies and two stores for each loop iteration (using two separate temporary variables, e.g. v1, v2), and increment i by 2 instead of 1."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1462744626, "last_edit_date": 1462744626, "creation_date": 1462377990, "answer_id": 37032876, "question_id": 37032625, "link": "https://stackoverflow.com/questions/37032625/scaling-of-a-complex-vector-using-sse/37032876#37032876", "title": "Scaling of a complex vector using SSE", "body": "<p>You probably want something like this:</p>\n\n<pre><code>complex double * complexScalingSSE(complex double *input, double c, int length)\n{\n    const __m128d vc = _mm_set1_pd(c);\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        __m128d v = _mm_loadu_pd((double *)&amp;input[i]);  // load one complex double\n        v = _mm_mul_pd(v, vc);                          // scale it\n        _mm_storeu_pd((double *)&amp;input[i], v);          // store it\n    }\n    return input;\n}\n</code></pre>\n\n<p>You might want to try loop unrolling by a factor of 2 (but note that for large vectors this routine may well be I/O bound):</p>\n\n<pre><code>complex double * complexScalingSSE(complex double *input, double c, int length)\n{\n    const __m128d vc = _mm_set1_pd(c);\n    int i;\n\n    for (i = 0; i &lt;= length - 2; i += 2)\n    {\n        __m128d v1 = _mm_loadu_pd((double *)&amp;input[i]); // load two complex doubles\n        __m128d v2 = _mm_loadu_pd((double *)&amp;input[i + 1]);\n        v1 = _mm_mul_pd(v1, vc);                        // scale them\n        v2 = _mm_mul_pd(v2, vc);\n        _mm_storeu_pd((double *)&amp;input[i], v1);         // store them\n        _mm_storeu_pd((double *)&amp;input[i + 1], v2); \n    }\n    if (i &lt; length)                                     // handle odd element at end\n    {\n        __m128d v = _mm_loadu_pd((double *)&amp;input[i]);  // load one complex double\n        v = _mm_mul_pd(v, vc);                          // scale it\n        _mm_storeu_pd((double *)&amp;input[i], v);          // store it\n    }\n    return input;\n}\n</code></pre>\n\n<p>Note also that a decent compiler should auto-vectorize your original routine, in which case you won't see any benefit from hand-coded SSE.</p>\n"}], "owner": {"reputation": 263, "user_id": 5232742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/37cea52f3e654edd6e7ba6e1b741983e?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/5232742/nils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 37032876, "answer_count": 1, "score": 0, "last_activity_date": 1462744626, "creation_date": 1462377218, "last_edit_date": 1462378292, "question_id": 37032625, "link": "https://stackoverflow.com/questions/37032625/scaling-of-a-complex-vector-using-sse", "title": "Scaling of a complex vector using SSE", "body": "<p>I want to apply SSE instructions to a vector containing complex numbers. Without SSE instructions, I can do it with the following code. However, when I apply SSE instructions, I don't know how to get the calculated real and imaginary part back to the array. How can I solve this?</p>\n\n<pre><code>complex double * complexScaling(complex double *input, double c, int length) \n{\n  for(int i=0; i&lt;length; i++) {\n    input[i] = c*input[i];\n  }\n  return input;\n}\n\ncomplex double * complexScalingSSE(complex double *input, double c, int length) \n{\n  __m128d multiplier,real,imag;\n  multiplier = _mm_set1_pd(c);\n  for(int i=0; i&lt;length; i+=2) {\n    real = _mm_set_pd(creal(input[i]),creal(input[i+1]));\n    real = _mm_mul_pd(real, multiplier);\n    imag = _mm_set_pd(cimag(input[i]),cimag(input[i+1]));\n    imag = _mm_mul_pd(imag, multiplier);\n  }\n  return input;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "binaryfiles"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462376570, "post_id": 37032360, "comment_id": 61614728, "body": "Problem?  What problem, (apart from code formatting)?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462376678, "post_id": 37032360, "comment_id": 61614802, "body": "I fixed your code block and removed the spurious backtick at the end."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462376753, "post_id": 37032360, "comment_id": 61614875, "body": "Why do you <code>fwrite(..., sizeof(char*), ...)</code> of all things?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462376803, "post_id": 37032360, "comment_id": 61614915, "body": "@EOF &#39;cos that&#39;s what OP read... :)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462376884, "post_id": 37032360, "comment_id": 61614978, "body": "^^ what EOF says - can you not read and write bytes like normal people?  :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462378508, "post_id": 37032360, "comment_id": 61616101, "body": "DON&#39;T YELL at us! Our eyes are not deaf! (or get your caps-lock repaired)"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462377784, "post_id": 37032520, "comment_id": 61615650, "body": "Its 160bytes, Ur code works but it missing the last Line of the CSV file"}, {"owner": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462379069, "post_id": 37032520, "comment_id": 61616423, "body": "Ur code did not compile so i tried to fix it, IT still dont work. Here is ur updated code(that i tried to fix): i will edit ur comment"}, {"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "reply_to_user": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462379899, "post_id": 37032520, "comment_id": 61616937, "body": "@OriVAgmon, fixed the bug dude..  fwrite( buffer, sizeof( char ), numBlocksRead, csvDest );  --&gt; i was writing numBlocksRead*PER_READ which was wrong"}], "tags": [], "owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1462379803, "last_edit_date": 1462379803, "creation_date": 1462376924, "answer_id": 37032520, "question_id": 37032360, "link": "https://stackoverflow.com/questions/37032360/copying-binary-files-using-fread-and-fwrite/37032520#37032520", "title": "Copying binary files using fread and fwrite", "body": "<pre><code>    #include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#define PER_READ 30\nint main( void )\n{\n    char buffer[500] = { 0 };\n    FILE* CSV = fopen( \"CSV.csv\", \"rb\" );\n    FILE* csvDest = fopen( \"CSVDest.csv\", \"wb\" );\n    unsigned int finished = 0;\n    unsigned int counter = 0;\n    unsigned int numBlocksRead = 0;\n    do\n    {\n        numBlocksRead = fread( buffer, sizeof( char ), PER_READ, CSV );\n        finished += numBlocksRead*sizeof( char );\n        counter++;\n        fwrite( buffer, sizeof( char ), numBlocksRead, csvDest );\n\n    } while (finished == PER_READ * counter);\n\n    fclose( CSV );\n    fclose( csvDest );\n    system( \"PAUSE\" );\n    return (0);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1462377142, "creation_date": 1462377142, "answer_id": 37032600, "question_id": 37032360, "link": "https://stackoverflow.com/questions/37032360/copying-binary-files-using-fread-and-fwrite/37032600#37032600", "title": "Copying binary files using fread and fwrite", "body": "<p>You do:</p>\n\n<pre><code>finished = fread( buffer, sizeof(char), PER_READ, CSV );\nfinished += PER_READ * counter;\n</code></pre>\n\n<p>and then you compare:</p>\n\n<p><code>while (finished == PER_READ * counter);</code></p>\n\n<p>how do expect this to turn out?</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462379482, "post_id": 37032916, "comment_id": 61616684, "body": "Thanks! Can i use unsigned int instead of size_t?"}, {"owner": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462379675, "post_id": 37032916, "comment_id": 61616797, "body": "Please ignore my last question. Ur code worked perfectly, but can U please help me figure out my mistakes in My code?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "edited": false, "score": 0, "creation_date": 1462380115, "post_id": 37032916, "comment_id": 61617073, "body": "The most obvious mistake is to use <code>sizeof(char*)</code> when you meant <code>sizeof(char)</code>. Another <i>might</i> be that the file size may not be a multiple of 30 bytes. Next, you try to read the whole file into a buffer before writing any of it. But rather than struggle with your convoluted attempt, this shows how to keep it simple. Note the <code>size_t</code> is the type returned by <code>fread</code> and is the required type for two of the arguments for <code>fwrite</code>."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1462378128, "creation_date": 1462378128, "answer_id": 37032916, "question_id": 37032360, "link": "https://stackoverflow.com/questions/37032360/copying-binary-files-using-fread-and-fwrite/37032916#37032916", "title": "Copying binary files using fread and fwrite", "body": "<p>Your implementation could be a simple loop like this, which repeats until there were no bytes read. Note that <code>sizeof(char*)</code> is wrong - the size of a pointer, and that <code>sizeof(char)</code> is <code>1</code> by definition.</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                              // include proper header\n\n#define BUFFSIZE    512                                         // power of 2 is kind to system\n\nint main(void)\n{\n    char buffer[BUFFSIZE];\n    size_t bytes;\n    FILE *fin, *fou;\n    fin = fopen(\"CSV.csv\", \"rb\");\n    fou = fopen(\"CSVDest.csv\", \"wb\");\n    if(fin == NULL || fou == NULL)\n        return 1;                                               // or other action\n    while ((bytes = fread(buffer, 1, BUFFSIZE, fin)) != 0) {\n        if(fwrite(buffer, 1, bytes, fou) != bytes) {\n            return 1;                                           // or other action\n        }\n    }\n    fclose(fou);\n    fclose(fin);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5548444, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/560379997449437/picture?type=large", "display_name": "Ori V Agmon", "link": "https://stackoverflow.com/users/5548444/ori-v-agmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2523, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1462383937, "creation_date": 1462376490, "last_edit_date": 1462383937, "question_id": 37032360, "link": "https://stackoverflow.com/questions/37032360/copying-binary-files-using-fread-and-fwrite", "title": "Copying binary files using fread and fwrite", "body": "<p>I have a problem when copying binary files using <code>fread</code> and <code>fwrite</code>:\nthe loop runs only two times (40 bytes), but the file length is 160 bytes:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#define PER_READ 30\nint main(void)\n{\n\n    char buffer[500] = { 0 };\n    FILE* CSV = fopen( \"CSV.csv\", \"rb\" );\n    FILE* csvDest = fopen( \"CSVDest.csv\", \"wb\" );\n    unsigned int finished = 0;\n    unsigned int counter = 0;\n    do\n    {\n        finished = fread( buffer, sizeof( char*), PER_READ, CSV );//Read all from CSV to a string name buffer\n        finished += PER_READ * counter;\n        counter++;\n    } while (finished == PER_READ * counter);\n    fwrite( buffer, sizeof( char* ), finished, csvDest );// write all to a the file CSVDest\n\n    system( \"PAUSE\" );\n    return (0);\n};\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462377270, "post_id": 37032357, "comment_id": 61615292, "body": "Debugger................."}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1462378834, "post_id": 37032357, "comment_id": 61616285, "body": "What if you sort the array and take the M maximum?"}], "answers": [{"comments": [{"owner": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462379621, "post_id": 37033281, "comment_id": 61616762, "body": "*(max_arr+i)=tmp because i&#39;m taking the position of maximum number not it&#39;s self.and i tried to change my code as you shown but it still doesn&#39;t work.Also thanks for write suggestion."}, {"owner": {"reputation": 629, "user_id": 5327962, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e5b32f413b4d390ecd3e260189c40be2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5327962/abhishek-kumar"}, "reply_to_user": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462379727, "post_id": 37033281, "comment_id": 61616826, "body": "Then  change this comparison       if( *(max_arr+k)==tresh_arr[j] )    // tresh_arr[j] by j"}, {"owner": {"reputation": 629, "user_id": 5327962, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e5b32f413b4d390ecd3e260189c40be2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5327962/abhishek-kumar"}, "reply_to_user": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462379939, "post_id": 37033281, "comment_id": 61616961, "body": "<a href=\"https://gist.github.com/coderabhishek/42bb47c5b4cbb29afd7d62f0dc78e89e\" rel=\"nofollow noreferrer\">gist.github.com/coderabhishek/42bb47c5b4cbb29afd7d62f0dc78e8&zwnj;&#8203;9e</a>  See here , your code working"}, {"owner": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462381254, "post_id": 37033281, "comment_id": 61617748, "body": "im trying to take their positions to max_arr for your example max_arr=[8,7,6,5,4] should be result because max 5 number is 9,8,7,6,5  and 8,7,6,5,4 are their positions in array"}, {"owner": {"reputation": 629, "user_id": 5327962, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e5b32f413b4d390ecd3e260189c40be2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5327962/abhishek-kumar"}, "reply_to_user": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462381632, "post_id": 37033281, "comment_id": 61617944, "body": "I wrote for actual element but you can change that simply, otherwise its working fine(prints elements 9,8,7,6,5)  just see the changes I have made to flow of code"}, {"owner": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1462383934, "post_id": 37033281, "comment_id": 61619277, "body": "okay it is working now thank you so much i appreciate it."}], "tags": [], "owner": {"reputation": 629, "user_id": 5327962, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e5b32f413b4d390ecd3e260189c40be2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5327962/abhishek-kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1462379340, "creation_date": 1462379340, "answer_id": 37033281, "question_id": 37032357, "link": "https://stackoverflow.com/questions/37032357/finding-maximum-numbers-in-array-with-pointers-and-taking-their-positions-to-ano/37033281#37033281", "title": "Finding maximum numbers in array with pointers and taking their positions to another array", "body": "<p>Following are mistakes in your program:</p>\n\n<p>1) In second last line you should do \n             *(max_arr+i)=max;  // not tmp</p>\n\n<p>2)Inside each forloop over i set max to least number</p>\n\n<pre><code>for(i=0;i&lt;M;i++)  //I will find maximum M numbers\n</code></pre>\n\n<p>{</p>\n\n<pre><code> max =-1;    //**********YOU MISSED THIS*****************\n\nfor(j=0;j&lt;N;j++) //There is a N numbers in my array\n{\n</code></pre>\n\n<p>3) Above break you should set flag to 1 and no need to set it to 0 again and in if you should check for flag==0 which basically means element was not found</p>\n\n<pre><code>            for(k=0;k&lt;i;k++) \n            {\n                if( *(max_arr+k)==tresh_arr[j] )\n                {  \n                   flag=1;\n                   break;\n                }\n            }\n\n            if(flag==0)\n            {\n                max = *(tresh_arr+j);\n                tmp=j;\n            }  \n</code></pre>\n\n<p>Also its good to write *(A+j) as A[j] in C, they both are exactly same, earlier one is sort of too verbose</p>\n"}], "owner": {"reputation": 852, "user_id": 4779042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PL77x.jpg?s=128&g=1", "display_name": "Alperen Kantarc\u0131", "link": "https://stackoverflow.com/users/4779042/alperen-kantarc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1462542841, "accepted_answer_id": 37033281, "answer_count": 1, "score": -3, "last_activity_date": 1462379340, "creation_date": 1462376482, "last_edit_date": 1462376952, "question_id": 37032357, "link": "https://stackoverflow.com/questions/37032357/finding-maximum-numbers-in-array-with-pointers-and-taking-their-positions-to-ano", "closed_reason": "Not suitable for this site", "title": "Finding maximum numbers in array with pointers and taking their positions to another array", "body": "<p>I'm doing a project now with C language and i have a problem in one part on project.Basically im trying to find maximum M numbers in my main array and i'm taking their ID numbers to another array.The ID numbers of the these max numbers are their position in array.</p>\n\n<p>My main array is tresh_arr and  have N numbers,the numbers are double.</p>\n\n<p>My code block which doesn't work is :</p>\n\n<pre><code>    double max=0;\n    int *max_arr;\n    int k,tmp,flag=0;\n    max_arr=calloc(M,sizeof(int));\n\n\n\nfor(i=0;i&lt;M;i++)  //I will find maximum M numbers\n{\n    for(j=0;j&lt;N;j++) //There is a N numbers in my array\n    {\n        if( *(tresh_arr+j) &gt; max   ) //I'm trying to take the Id numbers to the tresh_arr\n            {\n                flag=0;\n                for(k=0;k&lt;i+1;k++) \n                {\n                    if( *(max_arr+k)==j )\n                    {   \n                       flag=0;\n                       break;\n                    }\n                    else \n                        flag=1; \n                }\n\n                if(flag==1)\n                {\n                    max = *(tresh_arr+j);\n                    tmp=j;\n                }                               \n            }\n    }\n    *(max_arr+i)=tmp;\n}` \n</code></pre>\n\n<p>But my code doesn't work and just finding maximum number and writing M times the  Id of this maximum number.What should i do? Thank you and sorry for my faults if have.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 3, "creation_date": 1462386886, "post_id": 37032292, "comment_id": 61621137, "body": "The device you&#39;re accessing is a disk volume, not a USB device. That the volume resides on a USB drive is irrelevant. Had you opened the USB device proper, you&#39;d get the information you seek. You need to figure out what disk the <code>E:</code> volume resides on, then get information about that disk, and from there get information about the USB device the disk is on."}], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 4854929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wiFm.jpg?s=128&g=1", "display_name": "Darko Djuric", "link": "https://stackoverflow.com/users/4854929/darko-djuric"}, "is_accepted": false, "score": 0, "last_activity_date": 1462379498, "creation_date": 1462379498, "answer_id": 37033334, "question_id": 37032292, "link": "https://stackoverflow.com/questions/37032292/how-to-achieve-programmatic-serial-number-and-other-details-of-a-specific-usb-de/37033334#37033334", "title": "How to achieve programmatic serial number and other details of a specific USB device?", "body": "<p>You could use <a href=\"https://support.microsoft.com/en-us/kb/259695\" rel=\"nofollow\">SetupDi</a> functions. Take look on <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff550956(v=vs.85).aspx\" rel=\"nofollow\">SetupDiGetClassDevs</a> function which will return all attached devices. For USB devices use \"USB\" enumerator.</p>\n"}], "owner": {"reputation": 9, "user_id": 6192783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376aa7e72de5c78c06ab8497b20e2270?s=128&d=identicon&r=PG&f=1", "display_name": "JECK IRON", "link": "https://stackoverflow.com/users/6192783/jeck-iron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462381368, "creation_date": 1462376246, "last_edit_date": 1462381368, "question_id": 37032292, "link": "https://stackoverflow.com/questions/37032292/how-to-achieve-programmatic-serial-number-and-other-details-of-a-specific-usb-de", "title": "How to achieve programmatic serial number and other details of a specific USB device?", "body": "<p>How can I get information about specific USB?\nInformation such as serial number, manufacturer number, product number, etc.</p>\n\n<p>I can get the handle to USB by this func</p>\n\n<pre><code>CreateFile(L\"\\\\\\\\.\\\\E:\", GENERIC_WRITE, FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);\n</code></pre>\n\n<p>But from now on I'm pretty stuck,<strong>HidD_GetHidGuid</strong>, returns only Details of the hard disk,and <strong>GetRawInputDeviceList</strong> and <strong>GetRawInputDeviceInfo</strong> not allow me to get information about USB (by name, as in the example with the function <strong>CreateFile</strong>)</p>\n\n<p>When I try the following code:</p>\n\n<pre><code>DeviceIoControl(HandelUsb, IOCTL_DISK_GET_DRIVE_GEOMETRY, NULL, 0, &amp;dg, sizeof(DISK_GEOMETRY),&amp;dwReturned, NULL);\nMEDIA_SERIAL_NUMBER_DATA msnd = { 0 };\nDeviceIoControl(HandelUsb, IOCTL_STORAGE_GET_MEDIA_SERIAL_NUMBER, NULL, 0, &amp;msnd,sizeof(MEDIA_SERIAL_NUMBER_DATA), &amp;dwReturned, NULL);\n</code></pre>\n\n<p>I always get a serial number 0 ...\n(I tried on different USB devices)</p>\n"}, {"tags": ["c", "memory", "curses"], "comments": [{"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1462376562, "post_id": 37032219, "comment_id": 61614722, "body": "It appears that this code just does some sanity checks to understand whether the environment behaves in an expected way. In particular, it checks whether allocating 1 byte of heap memory, freeing it and allocating another byte will yield reuse the byte in memory (<code>m1 == m2</code>), and similarly, whether opening a file, closing it again and opening another one will reuse the file handle (<code>h1 == h2</code>)."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1462376665, "post_id": 37032219, "comment_id": 61614795, "body": "Ah, didn&#39;t notice the <code>func1</code> call in the middle. I think LPs is half-right - I think it&#39;s not about hacking (because hackers could just free their memory and close their files), but to check whether <code>func1</code> is leaking any heap memory and/or any file handles. <code>func1</code> is supposed to clean up its stuff and not leave anything dangling, I guess. <b>EDIT</b>: I&#39;ll transform this into an answer."}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462377280, "post_id": 37032506, "comment_id": 61615302, "body": "Good answer. It clarify all things."}], "tags": [], "owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "is_accepted": true, "score": 4, "last_activity_date": 1462376882, "creation_date": 1462376882, "answer_id": 37032506, "question_id": 37032219, "link": "https://stackoverflow.com/questions/37032219/cant-understand-thesefree-immediately-after-mallocclose-file-immediately-afte/37032506#37032506", "title": "Can&#39;t understand these:free immediately after malloc;close file immediately after open", "body": "<p>As stated in my comment, it appears to me that this is a check to see whether <code>func1</code> is leaking memory or file handles.</p>\n\n<p>Essentially, the code checks whether allocating memory before and after the call will give back the same memory address, as well as opening a file before and after the call will give back the same file handle.</p>\n\n<p>If <code>func1</code> calls <code>malloc</code> but forgets to <code>free</code> the memory again, or it opens a file and doesn't close it again, the values of <code>m1</code> and <code>m2</code> or <code>h1</code> and <code>h2</code>, respecitively, will be different.</p>\n\n<p>However, this is not a portable approach. It might work on one specific platform, but there is no guarantee that the heap and the file handles will be reused like that on other platforms - they may return different values before and after <code>func1</code> even if nothing was leaked.</p>\n"}], "owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 37032506, "answer_count": 1, "score": 3, "last_activity_date": 1462376929, "creation_date": 1462376050, "question_id": 37032219, "link": "https://stackoverflow.com/questions/37032219/cant-understand-thesefree-immediately-after-mallocclose-file-immediately-afte", "title": "Can&#39;t understand these:free immediately after malloc;close file immediately after open", "body": "<p>I am reading some source code about an old management tool for bank teller written by c using curses,here are some codes I can't understand:</p>\n\n<pre><code>main(int argc, char *argv[])\n{\n    int h1, h2;\n    char *m1, *m2;\n    char fname[100];\n\n    sprintf(fname, \"%s/welcome.txt\", getenv(\"xxDIR\"));\n\n    m1 = malloc(1);\n    free(m1);\n\n    h1 = open(fname, 0);\n    if (h1&gt;0) \n        close(h1);\n    else \n        fprintf(stderr,\"Open first  file : %s \\n\", strerror(errno));\n\n    func1(argc, argv);\n\n    h2 = open(fname, 0);\n    if (h2&gt;0) \n        close(h1);\n    else \n        fprintf(stderr,\"Open second file : %s \\n\", strerror(errno));\n\n    if (h1!=h2) \n    {\n        fprintf(stderr,\"File Open/Close Check: h1=%d, h2=%d\\n\", h1, h2);\n    }\n\n    m2 = malloc(1);\n    free(m2);\n\n    if (m1!=m2) \n    {\n        printf(\"Mem  Alloc/Free Check: %ld\\n\", (long)(m2-m1));\n    }       \n\n    exit(0);\n}\n</code></pre>\n\n<p>Like I asked why it free immediately after malloc and close file immediately after open? And func1 is here:</p>\n\n<pre><code>func1(int argc, char *argv[])\n{\n    char trad_code[5];\n    int xx1();\n    int xx2();\n    int xx3();\n    int xx4();\n    int xx5();\n    int prt_translate(char *fmt, char *data);\n\n    signal( SIGINT, SIG_IGN );\n\n    scr_open();\n    clear();\n    refresh();\n\n    while ( scr_kbhit() ) scr_getch();\n\n    screen_set_function ( screen_FUNCID_CONFIRM, xx1 );\n    screen_set_function ( screen_FUNCID_SETDATA, xx2 );\n    screen_set_function ( screen_FUNCID_GETDATA, xx3 );\n    screen_set_function ( screen_FUNCID_FLDIN,   xx4 );\n    screen_set_function ( screen_FUNCID_FLDOUT,  xx5 );\n    prt_set_transfunction ( prt_translate );\n\n    if (sysinit()!=0)   \n        goto sysexit;\n\n    Show_Title();\n    refresh();\n\n    if (Show_Welcome())\n        goto sysexit;\n\n    strcpy(trad_code, \"0000\");\n    do_menu( \"0000\", trad_code, xxx );\n\n    syskill();\n\nsysexit:\n\n    clear();\n    refresh();\n    while ( scr_kbhit() ) scr_getch();\n    endwin();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "dll", "static"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462375881, "post_id": 37031967, "comment_id": 61614228, "body": "Learn about header files. Don&#39;t include implementation files."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1462376181, "post_id": 37031967, "comment_id": 61614445, "body": "You appear to be running <code>ar</code> against the C source files rather than the object files."}], "answers": [{"comments": [{"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1462375959, "post_id": 37032136, "comment_id": 61614274, "body": "oh I see a . after the -L    mybe that caused the issue..."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1462376072, "post_id": 37032136, "comment_id": 61614363, "body": "Yes you need a period(<code>.</code>) to point the linker to current directory."}, {"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1462376142, "post_id": 37032136, "comment_id": 61614420, "body": "thanks did not know  that"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1462376208, "post_id": 37032136, "comment_id": 61614464, "body": "@xetra11 : Also, you need to pack the object files with the archive(<code>ar</code>) command <b>not</b> the source files."}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": true, "score": 4, "last_activity_date": 1462376310, "last_edit_date": 1462376310, "creation_date": 1462375823, "answer_id": 37032136, "question_id": 37031967, "link": "https://stackoverflow.com/questions/37031967/building-a-static-library-in-c/37032136#37032136", "title": "Building a static library in C", "body": "<p>Compile - without linking - the source files</p>\n\n<pre><code>gcc -c renderay_core.c -o renderay_core.o\ngcc -c renderay_shapes.c -o renderay_shapes.o\n</code></pre>\n\n<p>Then pack it</p>\n\n<pre><code>ar -rcs librenderay.a renderay_core.o renderay_shapes.o\n</code></pre>\n\n<p>And link to it using</p>\n\n<pre><code>gcc test.c -o main.exe -static -L. -lrenderay\n</code></pre>\n\n<p>You need the <code>L</code> to specify the nonstandard location - current directory here.</p>\n"}, {"comments": [{"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1462376087, "post_id": 37032206, "comment_id": 61614378, "body": "ahhhh ok meh kind of a typo. thanks dude"}], "tags": [], "owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "is_accepted": false, "score": 1, "last_activity_date": 1462376020, "creation_date": 1462376020, "answer_id": 37032206, "question_id": 37031967, "link": "https://stackoverflow.com/questions/37031967/building-a-static-library-in-c/37032206#37032206", "title": "Building a static library in C", "body": "<p>The problem is that you are linking source files but not object files</p>\n\n<pre><code>ar rcs librenderay.a renderay_core.c renderay_shapes.c\n</code></pre>\n\n<p>It must be something like that</p>\n\n<pre><code>ar rcs librenderay.a renderay_core.o renderay_shapes.o\n</code></pre>\n\n<p>P.S. You can do this with Makefile</p>\n\n<pre><code>CFLAGS = -O2 -Wall -fPIC\nOBJS = renderay_core.o renderay_shapes.o\n\n.c.o:\n    $(CC) $(CFLAGS) -c $&lt;\n\nlibrenderay.a: $(OBJS)\n    $(AR) rcs librenderay.a $(OBJS)\n\n.PHONY: clean\nclean:\n    $(RM) librenderay.a $(OBJS)\n</code></pre>\n"}], "owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "closed_date": 1462831409, "accepted_answer_id": 37032136, "answer_count": 2, "score": -1, "last_activity_date": 1520201933, "creation_date": 1462375380, "last_edit_date": 1520201933, "question_id": 37031967, "link": "https://stackoverflow.com/questions/37031967/building-a-static-library-in-c", "closed_reason": "Not suitable for this site", "title": "Building a static library in C", "body": "<p>I have two sources I'd like to combine into one C static library.</p>\n\n<pre><code>renderay_core.c\nrenderay_shapes.c\n</code></pre>\n\n<p>and its corresponding header files. I compiled this as standalone (non library) first to avoid errors here.</p>\n\n<p><strong>test.c</strong>  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"renderay_core.c\"\n#include \"renderay_shapes.c\"\n\nint main(void){ \n  Canvas* canvas = new_Canvas(5,5);\n  printf(\"Test\");\n}\n</code></pre>\n\n<p>compiled it with:</p>\n\n<pre><code>gcc test.c renderay_core.c renderay_shapes.c -o main.exe\n</code></pre>\n\n<p>and it worked fine.</p>\n\n<p>Now I'm up to pack this into a static lib. Doing as followed:</p>\n\n<pre><code>gcc -c renderay_core.c renderay_shapes.c\n</code></pre>\n\n<p>Now I have the objects ready to be linked as a library.</p>\n\n<pre><code>ar rcs librenderay.a renderay_core.c renderay_shapes.c\n</code></pre>\n\n<p>Is the command I use for this. Then I try to compile my test.c with the library instead of the plain source files.</p>\n\n<pre><code>gcc test.c -o main.exe -static -L -lrenderay\n</code></pre>\n\n<p>Now when I try to compile this I get a error warning:</p>\n\n<blockquote>\n  <p>undefined reference to \"new_Canvas\"</p>\n</blockquote>\n\n<p>Telling me that the linking to the library failed. What am I doing wrong here? What did I missed out?</p>\n"}, {"tags": ["c", "function", "syntax", "call", "function-call"], "comments": [{"owner": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 0, "creation_date": 1462375643, "post_id": 37031818, "comment_id": 61614050, "body": "in you first code paragraph, in &#39;else&#39; clause, it should be <code>f2</code>"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1462375663, "post_id": 37031818, "comment_id": 61614064, "body": "what do you mean by calling same function <code>f1</code> if <code>condition</code> is both true and false? If this is a typo please correct it."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "edited": false, "score": 0, "creation_date": 1462375920, "post_id": 37031818, "comment_id": 61614251, "body": "yes of course it should be f2, thanks"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1462376384, "post_id": 37031818, "comment_id": 61614586, "body": "I have to wonder if you tried the code that you put into your question before asking. It actually works as written, obviating the complicated answer that you posted."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1462376447, "post_id": 37031818, "comment_id": 61614630, "body": "@DavidHoelzer actually I did but using a much more complicated function, now I&#39;ll try again"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462376473, "post_id": 37031818, "comment_id": 61614652, "body": "Why didn&#39;t you try it?  Wouldn&#39;t that be quicker than asking here?  It works, as long as <code>f1</code> and <code>f2</code> have been declared before you try to use them (but you wouldn&#39;t be trying to compile code that doesn&#39;t declare or define functions before you use them, would you \u2014 that is so much a thing of the last millennium!)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462377298, "post_id": 37031818, "comment_id": 61615316, "body": "Actually, there is no <code>? ...:</code> in Python, thus it is not clear what you mean with &quot;pythonic syntax&quot;. And the semantics are very different in both languages."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "edited": false, "score": 0, "creation_date": 1462392129, "post_id": 37031818, "comment_id": 61624095, "body": "Thank you all for your suggestions, I improved the question leaving only the details that make the question useful."}], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 14802, "user_id": 800123, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/bZMq5.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/800123/jack"}, "edited": false, "score": 1, "creation_date": 1462375232, "post_id": 37031819, "comment_id": 61613780, "body": "@Jack, you should reread the help section about asking questions. We are encouraged to answer our own question if we can. This is not just about help, this is about increasing the knowledge base at SO."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 2, "creation_date": 1462375306, "post_id": 37031819, "comment_id": 61613842, "body": "@enrico.bacis but as far as I know, your &quot;pythonic&quot; syntax should also work fine, provided the functions have the same types/signatures! See also <a href=\"http://stackoverflow.com/questions/75538/hidden-features-of-c#comment4498219_302563\" title=\"hidden features of c%23comment4498219_302563\">stackoverflow.com/questions/75538/&hellip;</a>"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1462375731, "post_id": 37031819, "comment_id": 61614116, "body": "Why did you introduce a temporary variable? <code>result = (condition ? f1 : f2)(a, b, c, \u2026)</code> would work as well."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "reply_to_user": {"reputation": 14802, "user_id": 800123, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/bZMq5.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/800123/jack"}, "edited": false, "score": 0, "creation_date": 1462376027, "post_id": 37031819, "comment_id": 61614321, "body": "@Jack: <a href=\"http://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">blog.stackoverflow.com/2011/07/&hellip;</a> The idea is: &quot;I know this way, do you know a better one?&quot;"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1462376320, "post_id": 37031819, "comment_id": 61614541, "body": "I can&#39;t up vote this since it unnecessarily complicates the issue and defeats the request for a Pythonic approach.  @unwind&#39;s answer is much superior."}, {"owner": {"reputation": 14802, "user_id": 800123, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/bZMq5.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/800123/jack"}, "edited": false, "score": 0, "creation_date": 1462377119, "post_id": 37031819, "comment_id": 61615163, "body": "I know you can answer your own question, I&#39;ve did it. I mean the way he wrote it &#39;you could&#39;..."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "reply_to_user": {"reputation": 14802, "user_id": 800123, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/bZMq5.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/800123/jack"}, "edited": false, "score": 0, "creation_date": 1462392084, "post_id": 37031819, "comment_id": 61624065, "body": "@Jack You are right, fixed it. It was actually creepy, thanks! ;)"}], "tags": [], "owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "is_accepted": false, "score": 2, "last_activity_date": 1462392053, "last_edit_date": 1462392053, "creation_date": 1462374958, "answer_id": 37031819, "question_id": 37031818, "link": "https://stackoverflow.com/questions/37031818/c-function-call-selection-using-ternary-operator/37031819#37031819", "title": "C function call selection using ternary operator", "body": "<p>It is possible to use a function pointer like this:</p>\n\n<pre><code>int (*f)(int, int, int, ...);\nf = condition ? f1 : f2;\nresult = (*f)(a, b, c, ...);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462377195, "post_id": 37032241, "comment_id": 61615218, "body": "The structure is similar, but neither the syntax (Python does not have <code>? .. :</code>, but <code>if .. else</code> operators) nor the mechanisms are the same. Unlike C++ for instance, Python is full-grown OOP and functions are first-class objects, too - as are classes."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 8, "last_activity_date": 1462376997, "last_edit_date": 1462376997, "creation_date": 1462376113, "answer_id": 37032241, "question_id": 37031818, "link": "https://stackoverflow.com/questions/37031818/c-function-call-selection-using-ternary-operator/37032241#37032241", "title": "C function call selection using ternary operator", "body": "<p>Yes, it works fine just like you suggested.</p>\n\n<p>The function call operator <code>()</code> just needs a left-hand-side that evaluates to a function pointer, which names of functions do.</p>\n\n<p>There's no need to derefence function pointers when calling, the <code>()</code> operator does that.</p>\n\n<p>This sample program demonstrates:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic int foo(int x) {\n    return x + 1;\n}\n\nstatic int bar(int x) {\n    return x - 1;\n}\n\nint main(void) {\n    for (int i = 0; i &lt; 10; ++i)\n        printf(\"%d -&gt; %d\\n\", i, (i &amp; 1 ? foo : bar)(i));\n    return 0;\n}\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>0 -&gt; -1\n1 -&gt; 2\n2 -&gt; 1\n3 -&gt; 4\n4 -&gt; 3\n5 -&gt; 6\n6 -&gt; 5\n7 -&gt; 8\n8 -&gt; 7\n9 -&gt; 10\n</code></pre>\n\n<p>There is nothing strange here.</p>\n\n<p>And since C predates Python by a fair bit, perhaps it's Python's semantics that are C-ish here. Or just plain sane, of course. :)</p>\n"}], "owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3734, "favorite_count": 4, "accepted_answer_id": 37032241, "answer_count": 2, "score": 7, "last_activity_date": 1462437551, "creation_date": 1462374958, "last_edit_date": 1462437551, "question_id": 37031818, "link": "https://stackoverflow.com/questions/37031818/c-function-call-selection-using-ternary-operator", "title": "C function call selection using ternary operator", "body": "<p>I have two C functions <code>f1</code> and <code>f2</code> that take the same arguments. Based on a condition, I need to invoke one or the other one with the same arguments:</p>\n\n<pre><code>if (condition) {\n    result = f1(a, b, c);\n} else {\n    result = f2(a, b, c);\n}\n</code></pre>\n\n<p>I understand it is possible to use the syntax:</p>\n\n<pre><code>result = condition ? f1(a, b, c) : f2(a, b, c)\n</code></pre>\n\n<p>Is it be possible to have a <em>DRY</em> syntax that requires to write arguments a single time?</p>\n"}, {"tags": ["c", "unit-testing", "embedded"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462375293, "post_id": 37031697, "comment_id": 61613829, "body": "Is the <code>SendMessage</code> an inline or a macro? Are those header file included into other <code>c</code> files?"}, {"owner": {"reputation": 3688, "user_id": 1111557, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2b40cacf02c8fa3f91429ef441912ac?s=128&d=identicon&r=PG", "display_name": "inetknght", "link": "https://stackoverflow.com/users/1111557/inetknght"}, "edited": false, "score": 0, "creation_date": 1462375295, "post_id": 37031697, "comment_id": 61613832, "body": "Remove the <i>definition</i> in <code>FakeMessageController.h</code> and instead only <i>declare</i> it there. Then when you link against <code>MessageController.o</code>, the real object is used."}, {"owner": {"reputation": 1, "user_id": 1505312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55bd84f5233e17c7011bb72b1d77220?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1505312/mike-s"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462375561, "post_id": 37031697, "comment_id": 61613990, "body": "@LPs : SendMessage is a function that is normally defined in the MessageController.c file. However, I want to use the SendMessage function defined in FakeMessageController.c when I am unit testing"}, {"owner": {"reputation": 1, "user_id": 1505312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55bd84f5233e17c7011bb72b1d77220?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1505312/mike-s"}, "reply_to_user": {"reputation": 3688, "user_id": 1111557, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2b40cacf02c8fa3f91429ef441912ac?s=128&d=identicon&r=PG", "display_name": "inetknght", "link": "https://stackoverflow.com/users/1111557/inetknght"}, "edited": false, "score": 0, "creation_date": 1462375704, "post_id": 37031697, "comment_id": 61614100, "body": "@inetknght : how does removing the definition in FakeMessageController.h make sure that I link with the function in FakeMessageController.c?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462375744, "post_id": 37031697, "comment_id": 61614128, "body": "Ok. What is included into your IAR project? If there are both files remove the one or put its code under undef as done for header."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462376168, "post_id": 37031697, "comment_id": 61614438, "body": "What I meant is that change the name of the header does not change the compiler command or linker to compile and link a file with the same name. Compiler will compile all sources added to project. If into those files there are two function with the same name, linker does not know which one to choose."}, {"owner": {"reputation": 1300, "user_id": 1198066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a0a68dd4c4916fc2fd33708e595bf5?s=128&d=identicon&r=PG", "display_name": "Ross", "link": "https://stackoverflow.com/users/1198066/ross"}, "edited": false, "score": 0, "creation_date": 1462452504, "post_id": 37031697, "comment_id": 61649283, "body": "Have a different compilation/link target when unit testing, and have the fake .c file for the unit test target, and the real one for the real target."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 1505312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55bd84f5233e17c7011bb72b1d77220?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1505312/mike-s"}, "is_accepted": false, "score": -1, "last_activity_date": 1462377157, "creation_date": 1462377157, "answer_id": 37032605, "question_id": 37031697, "link": "https://stackoverflow.com/questions/37031697/how-to-avoid-multiple-definitions-when-defining-test-doubles/37032605#37032605", "title": "How to avoid multiple definitions when defining test doubles", "body": "<p>Thanks for the help. I found my own solution.</p>\n\n<p>I wrapped all my code in MessageController.c with a #ifndef</p>\n\n<pre><code>#ifndef UNIT_TEST\n// All the code in the MessageController.c\n#endif\n</code></pre>\n\n<p>Inside MessageController.h, I used this trick:</p>\n\n<pre><code>#ifdef UNIT_TEST\n#include \"FakeMessageController.h\"\n#else\n\n// original header content\n\n#endif\n</code></pre>\n\n<p>It's not the cleanest in my opinion, but it works for me.</p>\n"}], "owner": {"reputation": 1, "user_id": 1505312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55bd84f5233e17c7011bb72b1d77220?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1505312/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462377157, "creation_date": 1462374655, "question_id": 37031697, "link": "https://stackoverflow.com/questions/37031697/how-to-avoid-multiple-definitions-when-defining-test-doubles", "title": "How to avoid multiple definitions when defining test doubles", "body": "<p>I am new to unit testing and I am trying to define a test double for a function that I am trying to define. It probably doesn't make much difference, but I am using IAR for a Cortex ARM M3 with the included compiler.</p>\n\n<p>In the function that I'm trying to test, I make a call to a function that sends a message over a serial interface.\nHere is some pseudocode to illustrate what I am trying to accomplish :</p>\n\n<pre><code>#ifdef UNIT_TEST\n#include \"MessageController.h\"\n#else\n#include \"FakeMessageController.h\"\n#endif\n\nuint8 FunctionToTest(....)\n{\n  uint8 data[100];\n  uint8 error;\n\n  //Prepare data to send here\n  SendMessage(data);\n\n  if (error)  return 1;\n  else return 0;\n}\n</code></pre>\n\n<p>I have created a copy of the original file that contained the SendMessage function and made mofications to it in another file. I thought that I could change the function that is called through the #ifdef statements, however, that is ot the case.</p>\n\n<p>I get the following error for multiple definitions</p>\n\n<pre><code>Error[Li006]: duplicate definitions for .... ; in \"......\\Tests\\Debug\\Obj\\MessageController.o\", and \"....\\dvlp\\Debug\\Tests\\Debug\\Obj\\FakeMessageController.o\"\n</code></pre>\n\n<p>I fully understand the reason why the linker is giving my this error, but is there a workaround to this problem? Or some way of tricking the linker into using the correct function?\nI can't modify the test function since it is a link to the original file in my project.</p>\n"}, {"tags": ["c", "linux", "assembly", "x86", "long-double"], "comments": [{"owner": {"reputation": 559, "user_id": 5084792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f393ccd206d09760ccc7acd09d1c3a6?s=128&d=identicon&r=PG", "display_name": "bowl", "link": "https://stackoverflow.com/users/5084792/bowl"}, "edited": false, "score": 0, "creation_date": 1462374652, "post_id": 37031504, "comment_id": 61613361, "body": "I&#39;d love to compare precision and execution time of my code for single, double and double-extended precision mode. While I can run code in double-extended and count clocks, I would also like to print (via &#39;printf(&quot;%Ld,integral);&#39; and validate result."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 3, "creation_date": 1462374885, "post_id": 37031504, "comment_id": 61613542, "body": "Which calling convention applies here? The rules for long double differ. For x64 linux, you return them in ST(0)"}, {"owner": {"reputation": 559, "user_id": 5084792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f393ccd206d09760ccc7acd09d1c3a6?s=128&d=identicon&r=PG", "display_name": "bowl", "link": "https://stackoverflow.com/users/5084792/bowl"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1462375718, "post_id": 37031504, "comment_id": 61614108, "body": "Thx, harold. Answer me, so I can mark your answer."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 2, "creation_date": 1462375736, "post_id": 37031504, "comment_id": 61614120, "body": "You can&#39;t move an 80-bit floating point number to XMM0. The XMM registers only support 32-bit and 64-bit floating numbers. As harlod said you need to follow the calling convention for your operating system which should provide some other mechanism."}, {"owner": {"reputation": 559, "user_id": 5084792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f393ccd206d09760ccc7acd09d1c3a6?s=128&d=identicon&r=PG", "display_name": "bowl", "link": "https://stackoverflow.com/users/5084792/bowl"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1462376304, "post_id": 37031504, "comment_id": 61614531, "body": "Thank you. Please, answer question, @harold, so i can mark your answer."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1462376802, "post_id": 37031504, "comment_id": 61614912, "body": "I don&#39;t really have anything useful to cite for a proper answer, also are you actually using x64 linux? (that was just a total guess on my part)"}, {"owner": {"reputation": 559, "user_id": 5084792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f393ccd206d09760ccc7acd09d1c3a6?s=128&d=identicon&r=PG", "display_name": "bowl", "link": "https://stackoverflow.com/users/5084792/bowl"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1462377488, "post_id": 37031504, "comment_id": 61615461, "body": "Yes, @harold, I am using x64 Linux. Sorry, I did not specify it."}], "answers": [{"tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 4, "last_activity_date": 1462377708, "creation_date": 1462377708, "answer_id": 37032794, "question_id": 37031504, "link": "https://stackoverflow.com/questions/37031504/how-can-i-move-an-80-bit-floating-point-number-with-double-precision-from-memory/37032794#37032794", "title": "How can I move an 80-bit floating point number with double precision from memory to XMM0 in AT&amp;T assembly", "body": "<p>Your premise is wrong:</p>\n\n<blockquote>\n  <p>how can I complete following code, so that C can read long double from\n  the %XMM0 register.</p>\n</blockquote>\n\n<p>The sysv abi does not return <code>long double</code> in <code>xmm0</code> register, but <code>st0</code>.\nThe relevant part of the <a href=\"http://www.x86-64.org/documentation_folder/abi.pdf\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>The 64-bit mantissa of arguments of type long double belongs to class\n  X87, the 16-bit exponent plus 6 bytes of padding belongs to class\n  X87UP.</p>\n  \n  <p>If the class is X87UP, the value is returned together with the\n  previous X87 value in %st0.</p>\n</blockquote>\n\n<p>Apparently you already have the value in <code>st0</code> so you don't have to do anything just leave it there, meaning delete the <code>fstpt</code> in your example.</p>\n"}], "owner": {"reputation": 559, "user_id": 5084792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f393ccd206d09760ccc7acd09d1c3a6?s=128&d=identicon&r=PG", "display_name": "bowl", "link": "https://stackoverflow.com/users/5084792/bowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 37032794, "answer_count": 1, "score": 2, "last_activity_date": 1462377708, "creation_date": 1462374145, "last_edit_date": 1462377548, "question_id": 37031504, "link": "https://stackoverflow.com/questions/37031504/how-can-i-move-an-80-bit-floating-point-number-with-double-precision-from-memory", "title": "How can I move an 80-bit floating point number with double precision from memory to XMM0 in AT&amp;T assembly", "body": "<p>I've written an AT&amp;T assembly function to calculate an integral. I need to pass it as a return value as it's called by code written in C. I've successfully managed to return it as a single precision <code>float</code> and a double precision <code>double</code>. But I know I can calculate it in 80-bit double extended precision and I'd love to pass it to C.  </p>\n\n<p>Let's assume the value I want to pass is pointed to in an FPU register pointed by TOP. Here's how I call functions. </p>\n\n<p>For float:  </p>\n\n<pre><code>//C\ndouble  integ_fo=integ_asm_fpu_fl();\n\n#asm\n...  \nfstps   max        # Fpu STore and Pop Short &lt;- short for 32-bit\nmovss   max, %xmm0 # MOVe Scalar Single precision   \n</code></pre>\n\n<p>For double:  </p>\n\n<pre><code>//C\ndouble  integ_do=integ_asm_fpu_do();\n\n#asm\n...  \nfstpl   max        # Fpu STore and Pop Long &lt;- long for 64-bit\nmovsd   max, %xmm0 # MOVe Scalar Dingle precision \n</code></pre>\n\n<p>My question is now: how can I complete following code, so that C can read <code>long double</code> from the <code>%XMM0</code> register.  </p>\n\n<p>For long double:  </p>\n\n<pre><code>//C\nlong double  integ_lo=integ_asm_fpu_lo();\n\n#asm\n...  \nfstpt   max        # FPU Store and Pop exTended &lt;- extended for 80-bit\n</code></pre>\n\n<p>What should I do after that? How would I move 80 bits from <code>max</code> to <code>%XMM0</code>?</p>\n"}, {"tags": ["c", "arrays", "memory-management", "struct"], "comments": [{"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "edited": false, "score": 0, "creation_date": 1462373703, "post_id": 37031088, "comment_id": 61612669, "body": "Well, since you are trying to read the size of the <code>nodes</code> variable (in bytes) the function <code>sizeof()</code> will always return address size of your machine which in your case is <code>8</code>. It would help if you can state what you were expecting."}, {"owner": {"reputation": 1383, "user_id": 5235611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0f4ddfeee92468c63de38f874715e7?s=128&d=identicon&r=PG&f=1", "display_name": "KunMing Xie", "link": "https://stackoverflow.com/users/5235611/kunming-xie"}, "edited": false, "score": 1, "creation_date": 1462373881, "post_id": 37031088, "comment_id": 61612788, "body": "nodes is a pointer. pointer takes 8 bytes in 64 bit system."}, {"owner": {"reputation": 245, "user_id": 3507873, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/k1H3t.png?s=128&g=1", "display_name": "Scy", "link": "https://stackoverflow.com/users/3507873/scy"}, "reply_to_user": {"reputation": 1383, "user_id": 5235611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0f4ddfeee92468c63de38f874715e7?s=128&d=identicon&r=PG&f=1", "display_name": "KunMing Xie", "link": "https://stackoverflow.com/users/5235611/kunming-xie"}, "edited": false, "score": 0, "creation_date": 1462374170, "post_id": 37031088, "comment_id": 61612986, "body": "@KunMingXie but it&#39;s a pointer to an array of pointers, I would have expected it to be at least 8*base_nodes in that case, although I guess I can imagine the behavior involved"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1462374262, "post_id": 37031088, "comment_id": 61613064, "body": "You say you want to allocate a dynamic array of <code>struct node</code>, and you seem to size your allocation appropriately for that, but you assign the result to a pointer type that is not consistent with that (<code>struct node **</code>).  If <code>nodes</code> is to point to the first element of an array of <code>struct node</code> then it should be declared with type <code>struct node *</code>.  Before VLAs, that was the only way.  If <code>nodes</code> should point to a (whole) variable-length array of <code>struct node</code> then it should be declared with type <code>struct node (*)[base_nodes]</code>."}, {"owner": {"reputation": 441, "user_id": 5325067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0de99c01c9c50323415b1498fb0e2ae?s=128&d=identicon&r=PG&f=1", "display_name": "ad3angel1s", "link": "https://stackoverflow.com/users/5325067/ad3angel1s"}, "edited": false, "score": 0, "creation_date": 1462374775, "post_id": 37031088, "comment_id": 61613469, "body": "@Scy the size of a pointer is always the same, it&#39;s not the size of the allocated memory."}], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 5325067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0de99c01c9c50323415b1498fb0e2ae?s=128&d=identicon&r=PG&f=1", "display_name": "ad3angel1s", "link": "https://stackoverflow.com/users/5325067/ad3angel1s"}, "is_accepted": false, "score": 0, "last_activity_date": 1462374566, "creation_date": 1462374566, "answer_id": 37031667, "question_id": 37031088, "link": "https://stackoverflow.com/questions/37031088/dynamically-allocating-memory-to-an-array-of-struct-nodes/37031667#37031667", "title": "Dynamically Allocating Memory to an array of Struct Nodes", "body": "<p>You're trying to obtain the number of elements of type <code>struct node</code>, allocated dynamically, using the operator <code>sizeof()</code> on the pointer itself, which will just return the size of a pointer on your machine, which is 8 bytes as it seems to be a 64 bit machine.\nI think you're confused by the fact that when you allocate some memory statically in an array you can use sizeof() operator to return the number of elements allocated, i.e.</p>\n\n<pre><code>myType a[N];\n\nnumber_of_elements = sizeof(a)/sizeof(myType)\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 3507873, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/k1H3t.png?s=128&g=1", "display_name": "Scy", "link": "https://stackoverflow.com/users/3507873/scy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462374566, "creation_date": 1462373065, "question_id": 37031088, "link": "https://stackoverflow.com/questions/37031088/dynamically-allocating-memory-to-an-array-of-struct-nodes", "title": "Dynamically Allocating Memory to an array of Struct Nodes", "body": "<p>I am trying to create an array of structs, with dynamically allocated memory, </p>\n\n<p>Here's the struct definition I'm using:  </p>\n\n<pre><code>struct node {\n    int key;\n    double probability;\n\n    struct node *parent;\n    struct node *children[255];\n};  \n</code></pre>\n\n<p>Here is the declaration and initialization:  </p>\n\n<pre><code>int base_nodes = sizeof(X)/sizeof(*X);\nwhile ((base_nodes - 1)%(D-1) != 0){\n    printf(\"Incrementing base\\n\");\n    base_nodes++;\n}\n\nprintf(\"base_nodes:\\t%d\\n\", base_nodes);\nstruct node **nodes = malloc(base_nodes * sizeof(struct node));\n\nif (nodes) {   \n    printf(\"Size of nodes:\\t%llu\\n\", sizeof(nodes));\n} else { printf(\"Failed to allocate memory\\n\"); return 1;}  \n</code></pre>\n\n<p>Where X is another dynamically allocated Array of numbers defined before I call it here.<br>\nAFAIK, base_nodes is being calculated correctly, however the Size of nodes: is reporting 8, rather than 10. I have tried base_nodes less than 8 and it also returns 8.  </p>\n\n<p>Could someone explain why this happens? And how to do it properly?  </p>\n\n<p>The program I'm making is a D-ary Huffman code generator given a PMF. </p>\n\n<p>I also attempted to realloc later on in the program and it seems to have had no effect:  </p>\n\n<pre><code>nodes = realloc(nodes, ((sizeof(nodes) + 1) * sizeof(struct node)));\nif (nodes) {\n     printf(\"New size:\\t%llu\\n\", sizeof(nodes));\n} else { printf(\"Not enough memory\\n\"); }\n</code></pre>\n"}, {"tags": ["c", "ssl", "curl", "https", "libcurl"], "comments": [{"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "reply_to_user": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462377788, "post_id": 37029831, "comment_id": 61615654, "body": "No, I think that certificate file is server certificate. And libcurl will check server certificate of server&#39;s hello packet exist in the certificate file or not."}, {"owner": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462379375, "post_id": 37029831, "comment_id": 61616617, "body": "So it&#39;s the list of trusted CA :)"}, {"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "reply_to_user": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462379927, "post_id": 37029831, "comment_id": 61616954, "body": "Yes, the file is the list of trusted CA."}, {"owner": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462380397, "post_id": 37029831, "comment_id": 61617253, "body": "When you say the device don&#39;t have a file system, it still can create ramdisk? (I guess programs are one a read-only chip?)"}, {"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "reply_to_user": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462381225, "post_id": 37029831, "comment_id": 61617732, "body": "I don&#39;t understand the meaning of &quot;create ramdisk&quot;. The OS is on a flash memory."}, {"owner": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 0, "creation_date": 1462381333, "post_id": 37029831, "comment_id": 61617785, "body": "Create a small temporary filesystem in the ram to put the list of CA, but if you can put it on the flash memory it&#39;s better."}, {"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "reply_to_user": {"reputation": 4150, "user_id": 2195875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/284c7d641e3c7f89e18ff01f31de4c24?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/2195875/tom"}, "edited": false, "score": 1, "creation_date": 1462383510, "post_id": 37029831, "comment_id": 61618986, "body": "It seems too hard for me to create a filesystem... Is it possible to write CA file as hardcode into libcurl?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1462510589, "post_id": 37029831, "comment_id": 61675142, "body": "@DanielStenberg Write that up as an answer, it should get upvotes even if the OP has not built curl using openssl, it&#39;s valuable information."}, {"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1462788081, "post_id": 37029831, "comment_id": 61766982, "body": "@DanielStenberg Thank you for your information. I built libcurl with OpenSSL, and I need some time to try this example."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "edited": false, "score": 0, "creation_date": 1462954602, "post_id": 37093600, "comment_id": 61850006, "body": "I built libcurl with OpenSSL, and I had tried this example before. It works for me! Thanks for your answer!"}], "tags": [], "owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1462654423, "creation_date": 1462654423, "answer_id": 37093600, "question_id": 37029831, "link": "https://stackoverflow.com/questions/37029831/how-to-add-certificate-file-to-setting-up-libcurl-https-connection-on-the-os-whi/37093600#37093600", "title": "How to add certificate file to setting up libcurl HTTPS connection on the os which doesn&#39;t have file system?", "body": "<p><a href=\"https://curl.haxx.se/libcurl/c/cacertinmem.html\" rel=\"nofollow\">cacertinmemory.c</a> is an example by the curl project, showing how to do it if libcurl was built with OpenSSL.</p>\n"}], "owner": {"reputation": 11, "user_id": 6291064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa2afec33aed295cc8744a5a9a644ba?s=128&d=identicon&r=PG&f=1", "display_name": "ZhongWei", "link": "https://stackoverflow.com/users/6291064/zhongwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462654423, "creation_date": 1462369934, "last_edit_date": 1462372267, "question_id": 37029831, "link": "https://stackoverflow.com/questions/37029831/how-to-add-certificate-file-to-setting-up-libcurl-https-connection-on-the-os-whi", "title": "How to add certificate file to setting up libcurl HTTPS connection on the os which doesn&#39;t have file system?", "body": "<p>I am trying to port libcurl to a device.</p>\n\n<p>I program in C on Windows and I want to use the device to communicate with web server using HTTPS.</p>\n\n<p>But I have a problem that I don't know how to add my Certificate file when setting options.</p>\n\n<p>I have a .pem file, there are many certificates in it. \nAnd I found two <code>curl_easy_setopt()</code> options: <code>CURLOPT_CAINFO</code> and <code>CURLOPT_CAPATH</code> can set Certificate file path or directory path to <code>libcurl</code> connection.</p>\n\n<p>But there is a problem: the os of the device doesn't have file system.</p>\n\n<p>Are there any way to set the certificates for the HTTPS connection on the device? </p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1462369733, "post_id": 37029701, "comment_id": 61609346, "body": "As you don&#39;t have have std library with assembler, then the code will be OS-dependent."}, {"owner": {"reputation": 73, "user_id": 1376572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/153eefcb33d3b6209e4525f0e7ec976e?s=128&d=identicon&r=PG", "display_name": "polyx", "link": "https://stackoverflow.com/users/1376572/polyx"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1462369856, "post_id": 37029701, "comment_id": 61609456, "body": "I am using ubuntu 16.04"}, {"owner": {"reputation": 2082, "user_id": 5849470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b9a87f8f1cba83d545b6e601337ea?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jordan", "link": "https://stackoverflow.com/users/5849470/matt-jordan"}, "edited": false, "score": 5, "creation_date": 1462370031, "post_id": 37029701, "comment_id": 61609644, "body": "The first parameter in calling fwrite is an address that points to the byte, not the byte itself; assuming that you have linked the program correctly, you are most likely getting a seg fault because fwrite is trying to use your byte as an address, and access memory at addresses that aren&#39;t mapped in your virtual address space."}, {"owner": {"reputation": 73, "user_id": 1376572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/153eefcb33d3b6209e4525f0e7ec976e?s=128&d=identicon&r=PG", "display_name": "polyx", "link": "https://stackoverflow.com/users/1376572/polyx"}, "reply_to_user": {"reputation": 2082, "user_id": 5849470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b9a87f8f1cba83d545b6e601337ea?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jordan", "link": "https://stackoverflow.com/users/5849470/matt-jordan"}, "edited": false, "score": 0, "creation_date": 1462370160, "post_id": 37029701, "comment_id": 61609755, "body": "@MattJordan hmm might be that. How do I send an adress instead of a value?"}, {"owner": {"reputation": 9208, "user_id": 3298930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000448921471/picture?type=large", "display_name": "Jose Manuel Abarca Rodr&#237;guez", "link": "https://stackoverflow.com/users/3298930/jose-manuel-abarca-rodr%c3%adguez"}, "edited": false, "score": 1, "creation_date": 1462370573, "post_id": 37029701, "comment_id": 61610100, "body": "<a href=\"http://stackoverflow.com/questions/29545056/writing-to-a-file-in-assembler/29545526#29545526\" title=\"writing to a file in assembler\">stackoverflow.com/questions/29545056/&hellip;</a>"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1462370653, "post_id": 37029701, "comment_id": 61610172, "body": "Also you don&#39;t clean up the stack."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 1376572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/153eefcb33d3b6209e4525f0e7ec976e?s=128&d=identicon&r=PG", "display_name": "polyx", "link": "https://stackoverflow.com/users/1376572/polyx"}, "edited": false, "score": 0, "creation_date": 1462376196, "post_id": 37032142, "comment_id": 61614452, "body": "why do you use underscore in call and function name?"}, {"owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "reply_to_user": {"reputation": 73, "user_id": 1376572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/153eefcb33d3b6209e4525f0e7ec976e?s=128&d=identicon&r=PG", "display_name": "polyx", "link": "https://stackoverflow.com/users/1376572/polyx"}, "edited": false, "score": 1, "creation_date": 1462376846, "post_id": 37032142, "comment_id": 61614949, "body": "Because I used Windows to compile this example and GCC on Windows requires the symbol names to begin with underscore, and actually prepends underscores to all the C functions. You can see that if you disassemble a compiled object files. But anyway, on Linux the underscores shoudn&#39;t be required, so I&#39;ll edit the post to remove them."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1462501485, "post_id": 37032142, "comment_id": 61672927, "body": "Why do you <code>pusha</code>/<code>popa</code>?  You even comment the line with the fact that it&#39;s our callers problem if they&#39;re clobbered.  That would let you use <code>leave</code> for the epilogue instead of <code>add $16, %esp</code> / <code>pop %ebp</code>.  (And of course, the compiler wouldn&#39;t even bother making a stack frame, but <a href=\"https://godbolt.org/g/1QJSgc\" rel=\"nofollow noreferrer\">gcc is dumb and copies the char into a local</a>, rather than passing the address of its location on the stack.  Also, gcc keeps the stack 16B-aligned for <code>fwrite()</code>.  This tends not to matter, since stdio functions don&#39;t spill SSE vectors to the stack.)"}, {"owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "edited": false, "score": 1, "creation_date": 1462520954, "post_id": 37032142, "comment_id": 61679570, "body": "You are right, the <code>pusha</code>/<code>popa</code> are not neccessary at all. Perhaps I wasn&#39;t paying attention when I was writing this. I&#39;ll edit the post to remove them. And it&#39;s interesting to see how GCC behaves."}], "tags": [], "owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "is_accepted": true, "score": 3, "last_activity_date": 1462521036, "last_edit_date": 1462521036, "creation_date": 1462375831, "answer_id": 37032142, "question_id": 37029701, "link": "https://stackoverflow.com/questions/37029701/write-byte-to-file-with-x86-assembler/37032142#37032142", "title": "Write byte to file with x86 assembler", "body": "<p>According to <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#cdecl\" rel=\"nofollow\">cdecl</a> convention, you should push the arguments in reverse order. So <code>f</code> should go first and <code>b</code> should go last. Also the stack should be cleaned up by the caller after calling <code>fwrite()</code>.</p>\n\n<p>As noted in the comments, <code>b</code> will be received as value, but we need to pass it to <code>fwrite()</code> as pointer. The pointer will be equal to the value of <code>ebp</code> + <code>12</code>.</p>\n\n<p>This seems to work for me:</p>\n\n<pre><code>    .global writebyte\nwritebyte:\n    //create new stack frame\n    pushl   %ebp\n    movl    %esp, %ebp\n\n    //push the four arguments to stack (in reverse order)\n    pushl   8(%ebp)\n    pushl   $1\n    pushl   $1\n\n    //get pointer of \"b\" argument (%ebp+12) and move it to %eax\n    leal    12(%ebp), %eax\n    pushl   %eax\n\n    //call fwrite()\n    call    fwrite\n\n    //remove arguments from stack and pop %ebp\n    leave\n\n    ret\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 1376572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/153eefcb33d3b6209e4525f0e7ec976e?s=128&d=identicon&r=PG", "display_name": "polyx", "link": "https://stackoverflow.com/users/1376572/polyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1328, "favorite_count": 0, "accepted_answer_id": 37032142, "answer_count": 1, "score": 2, "last_activity_date": 1462521036, "creation_date": 1462369570, "last_edit_date": 1462370534, "question_id": 37029701, "link": "https://stackoverflow.com/questions/37029701/write-byte-to-file-with-x86-assembler", "title": "Write byte to file with x86 assembler", "body": "<p>I want to make a function in assembler to be called from c that will write a byte(char) to the file. Here is how function should look in c:</p>\n\n<pre><code>void writebyte (FILE *f, char b)\n{\n    fwrite(&amp;b, 1, 1, f);\n}\n</code></pre>\n\n<p>And here is the code that will call it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern void writebyte(FILE *, char);\n\nint main(void) {\n    FILE *f  = fopen(\"test.txt\", \"w\");    \n    writebyte(f, 1);\n    fclose(f);\n    return 0;\n}\n</code></pre>\n\n<p>So far I came up with following assembler code:</p>\n\n<pre><code>    .global     writebyte  \nwritebyte:\n    pushl   %ebp\n    movl    %esp, %ebp  #standard params\n    pushl   12(%ebp)    # pushing byte to the stack\n    pushl   $1\n    pushl   $1\n    pushl   8(%ebp)     #file to write\n    call    fwrite\n    popl    %ebp\n    ret\n</code></pre>\n\n<p>I keep getting from gdb:</p>\n\n<pre><code>Program terminated with signal SIGSEGV, Segmentation fault.\n#0  0xffa9702c in ?? ()\n</code></pre>\n\n<p>How do I write such a function in assembly?</p>\n\n<p>EDIT: I am using Ubuntu 16.04</p>\n"}, {"tags": ["c", "constants", "typedef"], "comments": [{"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1462370446, "post_id": 37029484, "comment_id": 61609998, "body": "See also: <a href=\"http://stackoverflow.com/questions/28062095/pass-a-two-dimensional-array-to-a-function-of-constant-parameter\" title=\"pass a two dimensional array to a function of constant parameter\">stackoverflow.com/questions/28062095/&hellip;</a>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462370487, "post_id": 37029484, "comment_id": 61610035, "body": "As mentioned in my dupe link, this is probably a flaw in C type system. I think this highlights why hiding pointers or arrays behind <code>typedef</code> is not a good idea."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462372240, "post_id": 37029484, "comment_id": 61611517, "body": "It is not an exact duplicate, because the linked question was regarding array pointers. In this case there are 2D arrays. The answer will be pretty much the same though."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462372598, "post_id": 37029484, "comment_id": 61611820, "body": "Anyway, I would strongly recommend to not hide arrays behind typedefs. If you need a distinct type, put the array inside a struct. Then make an array of such structs. Coincidentally, that would have solved this problem too."}, {"owner": {"reputation": 645, "user_id": 4809031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89362ff1bcef4e3e95d1263b98e40e26?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/4809031/robert"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462372772, "post_id": 37029484, "comment_id": 61611965, "body": "@user694733: Ok, but actually this issue does not arise from the typedef. Type out the float[3] and you get the same compiler warning."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1462370876, "post_id": 37030062, "comment_id": 61610350, "body": "Reaching for a cast is not a good idea.  The compiler complains for a reason.  Unless you know more than your compiler, simply casting is likely to lead to trouble, sooner or later."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462372474, "post_id": 37030062, "comment_id": 61611711, "body": "Implementing a safe &quot;const cast&quot; through C11 <code>_Generic</code> was one possible solution discussed in the linked duplicate, see for example the answer by chux. If it is a good idea or not, I&#39;m not sure. But it would be 100% safe, unlike the raw cast here."}], "tags": [], "owner": {"reputation": 169, "user_id": 864230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ML0AP.jpg?s=128&g=1", "display_name": "Brian Zammit", "link": "https://stackoverflow.com/users/864230/brian-zammit"}, "is_accepted": false, "score": 0, "last_activity_date": 1462370492, "creation_date": 1462370492, "answer_id": 37030062, "question_id": 37029484, "link": "https://stackoverflow.com/questions/37029484/problems-with-const-in-c-when-having-typedef-and-array/37030062#37030062", "title": "Problems with const in c when having typedef and array", "body": "<p>Why not cast the parameter to const? </p>\n\n<pre><code>typedef float vec3_t[3];\n\nvoid f(const vec3_t v[2]){\n    // do stuff\n}\n\nint main(int argc, char * argv[]){\n    vec3_t v[2];\n    v[2][1] = 1;\n    f((const vec3_t*)v);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 4809031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89362ff1bcef4e3e95d1263b98e40e26?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/4809031/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1462370323, "answer_count": 1, "score": 5, "last_activity_date": 1462370492, "creation_date": 1462368983, "question_id": 37029484, "link": "https://stackoverflow.com/questions/37029484/problems-with-const-in-c-when-having-typedef-and-array", "closed_reason": "Duplicate", "title": "Problems with const in c when having typedef and array", "body": "<p>I have the following code:</p>\n\n<pre><code>typedef float vec3_t[3];\n\nvoid f(const vec3_t v[2]){\n    // do stuff\n}\n\nint main(int argc, char * argv[]){\n    vec3_t v[2];\n    v[2][1] = 1;\n    f(v);\n    return 0;\n}\n</code></pre>\n\n<p>which will not compile using</p>\n\n<pre><code>gcc main.c -std=gnu99 -O0 -o main\n</code></pre>\n\n<p>but give the error</p>\n\n<pre><code>main.c: In function \u2018main\u2019:'\nmain.c:293:5: warning: passing argument 1 of \u2018f\u2019 from incompatible pointer type [enabled by default]\n     f(v);\n     ^\nmain.c:286:6: note: expected \u2018const float (*)[3]\u2019 but argument is of type \u2018float (*)[3]\u2019\n void f(const vec3_t v[2]){\n      ^\n</code></pre>\n\n<p>If I on the other hand remove the const requirement in the function f. It all works well. I can not figure out what is wrong??</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 11, "creation_date": 1462368678, "post_id": 37029305, "comment_id": 61608531, "body": "Simply because your buffer get&#39;s flushed when the program quits. Step through your code with a debugger, and you probably will see no output until the program quits. This is higly implementation dependent, on some systems there is no output buffering."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 7, "creation_date": 1462368737, "post_id": 37029305, "comment_id": 61608582, "body": "Put a <code>while(1);</code> at the end of function, before <code>return 0;</code> and see what happen."}, {"owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462370496, "post_id": 37029305, "comment_id": 61610047, "body": "@LPs Tried that,and the cursor just blinks after &#39;y&#39;.Care to explain why?"}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 1, "creation_date": 1462370752, "post_id": 37029305, "comment_id": 61610254, "body": "@avistein See Michael Walz&#39;s comment."}, {"owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462371629, "post_id": 37029305, "comment_id": 61611005, "body": "@MichaelWalz If it&#39;s flushed when the program quits,then what is the use of <code>fflush(stdout)</code>,since everything will be flushed at the end?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1462371630, "post_id": 37029305, "comment_id": 61611007, "body": "You have a good answer and a good comment by @MichaelWalz to understand why <code>stdout</code> is not flushed. BTW another little trick for your code with my previous modification: change <code>&quot;boy&quot;</code> into <code>&quot;boy\\n&quot;</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1462373650, "post_id": 37029305, "comment_id": 61612630, "body": "Keep in mind that most programs are longer than 10 lines. There are several instances (embedded applications, servers, etc) where there is no &quot;end&quot; or &quot;quit&quot; to the program"}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 0, "creation_date": 1462370413, "post_id": 37029514, "comment_id": 61609963, "body": "So when do I have to use the <code>fflush(stdout)</code> if the buffer is automatically cleared at program&#39;s end?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 2, "creation_date": 1462371761, "post_id": 37029514, "comment_id": 61611116, "body": "@avistein: There might be the need to see some data, before the program ends?"}, {"owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 0, "creation_date": 1462371820, "post_id": 37029514, "comment_id": 61611164, "body": "can you give an example?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 2, "creation_date": 1462371907, "post_id": 37029514, "comment_id": 61611245, "body": "@avistein: If  none comes to your mind, you probably need none ... :-/"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 2, "creation_date": 1462372085, "post_id": 37029514, "comment_id": 61611391, "body": "@avistein use case: you printf &quot;Please wait this may take up to 1 minute to compute&quot;, then you do some lenghty calculation. Do I need to write more?"}, {"owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462372528, "post_id": 37029514, "comment_id": 61611761, "body": "@MichaelWalz alright,that means when we do need the answer to be printed immediately,then I gotta use <code>fflush</code> ,right?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "edited": false, "score": 0, "creation_date": 1462372617, "post_id": 37029514, "comment_id": 61611839, "body": "@avistein yes, <code>fflush(stdout)</code> flushes the output buffer when called."}], "tags": [], "owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "is_accepted": true, "score": 4, "last_activity_date": 1462369388, "last_edit_date": 1462369388, "creation_date": 1462369086, "answer_id": 37029514, "question_id": 37029305, "link": "https://stackoverflow.com/questions/37029305/why-i-dont-have-to-flush-the-output-buffer-while-using-printf-everytime/37029514#37029514", "title": "Why I don&#39;t have to flush the output buffer while using printf everytime?", "body": "<p>Note that the <code>stdout</code> stream is buffered, so as Michael commented you will see the output(<em>mostly</em>) when the program quits. If you want to immediatel print the output the you can use <code>fprintf</code> like</p>\n\n<pre><code>fprintf(stderr, \"my Text\");\n</code></pre>\n\n<p>See the ISO C99 section 7.19.3/3:</p>\n\n<blockquote>\n  <p>When a stream is unbuffered, characters are intended to appear from\n  the source or at the destination as soon as possible. Otherwise\n  characters may be accumulated and transmitted to or from the host\n  environment as a block.</p>\n  \n  <p>When a stream is fully buffered, characters are intended to be\n  transmitted to or from the host environment as a block when a buffer\n  is filled.</p>\n  \n  <p>When a stream is line buffered, characters are intended to be\n  transmitted to or from the host environment as a block when a new-line\n  character is encountered.</p>\n  \n  <p>Furthermore, characters are intended to be transmitted as a block to\n  the host environment when a buffer is filled, when input is requested\n  on an unbuffered stream, or when input is requested on a line buffered\n  stream that requires the transmission of characters from the host\n  environment.</p>\n  \n  <p>Support for these characteristics is implementation-defined, and may\n  be affected via the setbuf and setvbuf functions.</p>\n</blockquote>\n"}], "owner": {"reputation": 90, "user_id": 1943882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3490623f9bae6378412b6e1d00dab346?s=128&d=identicon&r=PG", "display_name": "avistein", "link": "https://stackoverflow.com/users/1943882/avistein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 37029514, "answer_count": 1, "score": 2, "last_activity_date": 1462369388, "creation_date": 1462368604, "question_id": 37029305, "link": "https://stackoverflow.com/questions/37029305/why-i-dont-have-to-flush-the-output-buffer-while-using-printf-everytime", "title": "Why I don&#39;t have to flush the output buffer while using printf everytime?", "body": "<p>In this code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    printf(\"I\");\n    printf(\"am\");\n    printf(\"a\");\n    printf(\"good\");\n    printf(\"boy\");\n    return 0;\n}\n</code></pre>\n\n<p>Why I don't have to use <code>fflush(stdout)</code> every time? I mean how the strings are getting printed in the console if there is no new line(since new line flushes the output buffer).Or is it the buffer is getting full so I don't to do it explicitly?If so how?</p>\n"}, {"tags": ["c", "bison", "flex-lexer", "yacc", "lex"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462371062, "post_id": 37029051, "comment_id": 61610506, "body": "Do you happen to be trying to parse data directly from an open network connection?  EOF is not the same thing as &quot;no more input is available right now&quot;.  You will not see EOF on a network connection until the connection is closed."}, {"owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462375603, "post_id": 37029051, "comment_id": 61614020, "body": "Yes how should I determine when to stop parsing data?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1462376407, "post_id": 37029051, "comment_id": 61614602, "body": "Do you actually use yyless in your lexer code?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1462377005, "post_id": 37029051, "comment_id": 61615084, "body": "Also, i think you need to provide more information. Have you verified if <code>sso_read</code> returns -1 at the end of the request?"}, {"owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1462382367, "post_id": 37029051, "comment_id": 61618342, "body": "@rici Yes the yyless is being used. The sso_read function is never called."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1462384908, "post_id": 37029051, "comment_id": 61619879, "body": "You define <code>YY_INPUT</code> to call sso_read. If that&#39;s not enabled, what are you reading from? Also: does your scanner have <code>&lt;&lt;EOF&gt;&gt;</code> rules? Please include them, if so."}, {"owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1462543731, "post_id": 37029051, "comment_id": 61693606, "body": "@rici thank you! You were right! I miss read the function name and sso_read was called and was returning 0 instead of -1. =)"}], "answers": [{"tags": [], "owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "is_accepted": true, "score": 0, "last_activity_date": 1462569318, "last_edit_date": 1495540780, "creation_date": 1462548386, "answer_id": 37076117, "question_id": 37029051, "link": "https://stackoverflow.com/questions/37029051/lex-yacc-parser-stuck-at-eof/37076117#37076117", "title": "Lex Yacc parser stuck at EOF", "body": "<p>As <a href=\"https://stackoverflow.com/questions/37029051/lex-yacc-parser-stuck-at-eof#comment61615084_37029051\">rici</a> mentioned the <code>sso_read</code> function was not returning -1 but instead it returned 0. Also the EOF was never reached because the tcp socket was still open as it should be. Thank's to rici and Jon Bollinger for helping to solve this!</p>\n"}], "owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 37076117, "answer_count": 1, "score": 1, "last_activity_date": 1462569318, "creation_date": 1462368018, "last_edit_date": 1495535287, "question_id": 37029051, "link": "https://stackoverflow.com/questions/37029051/lex-yacc-parser-stuck-at-eof", "title": "Lex Yacc parser stuck at EOF", "body": "<p>I have been stuck with this problem for a couple of days now and so is this parser. Point of this parser is to parse http request and that it does ok but when the end of request is reached parser enters into infinite loop. I have located the point in the <strong>C</strong> file that is generated from lex file but have no idea how to solve this problem.</p>\n\n<p>I have tried the following approaches suggested in other similar questions without success.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1756275/bison-end-of-file\">bison-end-of-file</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/6614834/lex-flex-scanning-for-the-eof-character\">lex-flex-scanning-for-the-eof-character</a></p>\n\n<p>This is my lex file:</p>\n\n<pre><code>#undef YYLMAX\n#define YYLMAX  4096\n\n#include \"ssoyacc.h\"\n\n#define yylval  ssolval\nextern YYSTYPE  yylval;\n\n#ifdef FLEX_SCANNER\n#define YY_INPUT(buf, result, max_size) { int cc = sso_read(); result = (cc == -1) ? YY_NULL : (buf[0] = cc, 1);}\n#else /* NO FLEX */\n#undef input\n#define input()         sso_read()\n#define unput(cc)         sso_unput(cc)\n#define yyless(cc)         sso_yyless(cc)\n#endif /* FLEX */\n\n%}\n\n%p 30000\n%n 4000\n%e 2000\n%a 30000\n%k 2500\n%o 50000\n\nnondigit                [_a-zA-Z]\nalfanum                 [_a-zA-Z0-9]\ndigit                   [0-9]\nnonzero_digit           [1-9]\noctal_digit             [0-7]\nhexadecimal_digit       [0-9a-fA-F]\n\n%start HTTP QUERY ARG XML TAG CDAT FORM_PARAM FORM_VALUE\n\n%%\n\n&lt;INITIAL,HTTP&gt;[ ]   {\n            return SP;\n        }\n&lt;INITIAL,HTTP&gt;\\r\\n      {\n            return CRLF;\n        }\n&lt;HTTP&gt;HTTP\\/{digit}\\.{digit}    {\n            return HTTP_VERSION;\n        }\n&lt;HTTP&gt;OPTIONS       {\n            return OPTIONS;\n        }\n&lt;HTTP&gt;GET   {\n            return GET;\n        }\n.\n.\n.\nother tags\n.\n.\n.\n&lt;FORM_PARAM&gt;\\=  {\n            BEGIN(FORM_VALUE);\n            return IS;\n        }\n&lt;FORM_VALUE&gt;\\&amp;  {\n            BEGIN(FORM_PARAM);\n            return AMPERSAND;\n        }\n&lt;FORM_VALUE&gt;[0-9a-zA-Z\\%\\+\\.\\/]*    {\n            if (yyleng &lt; MAX_ARG_LEN)\n            {\n                char cc[3];\n                int ii;\n                int jj = 0;\n                for (ii=0;ii&lt;yyleng;ii++)\n                {\n                    if (yytext[ii] != '%')\n                    {\n                        if (yytext[ii] == '+')\n                        {\n                            yylval.sval[jj++] = ' ';\n                        }\n                        else\n                        {\n                            yylval.sval[jj++] = yytext[ii];\n                        }\n                    }\n                    else\n                    {\n                        strncpy(cc, yytext+ii+1, 2);\n                        cc[2] = 0;\n                        yylval.sval[jj++] = strtol(cc, NULL, 16);\n                        ii+=2;\n                    }\n                }\n                yylval.sval[jj] = 0;\n                return STRING;\n            }\n            else\n            {\n                return ERROR;\n            }\n        }\n%%\nint ssowrap(void)\n{\n        return 1;\n}\n\nvoid start_http()\n{\n    init_content(); /* initialize content count */\n    BEGIN(HTTP);\n}\n\nvoid start_urlencoded()\n{\n    BEGIN(FORM_PARAM);\n}\n\nvoid start_xml()\n{\n    BEGIN(XML);\n}\n\n\nint sso_yyless(int count)\n{\n    int i;\n    if (count&gt;yyleng)\n    {\n        return 0;\n    }\n    for (i=0;i&lt;yyleng-count;i++)\n    {\n        unput(yytext[yyleng-1-i]);\n        yytext[yyleng-1-i] = '\\0';\n    }\n    return 0;\n}\n\nvoid allprint(wchar_t cc)\n{\n    if (isprint(cc))\n    {\n        fprintf(stdout, \"'%c' 0x%x\", cc, cc);\n    }\n    else\n    {\n        fprintf(stdout, \"%x\", cc);\n    }\n}\n\nvoid sprint(wchar_t *pc)\n{\n    fprintf(stdout, \"%s\", pc);\n}\n</code></pre>\n\n<p>The execution gets stuck to loop <code>while ( /*CONSTCOND*/1 )</code> and keeps entering twice in <code>case YY_END_OF_BUFFER:</code> and then once in <code>case 126:</code> in ssolex.c file. The line that is stated in <code>case 126</code> is the line <code>%%</code> in lex file.</p>\n\n<pre><code>/** The main scanner function which does all the work.\n */\nYY_DECL\n{\n    yy_state_type yy_current_state;\n    char *yy_cp, *yy_bp;\n    int yy_act;\n\n    if ( !(yy_init) )\n        {\n        (yy_init) = 1;\n\n#ifdef YY_USER_INIT\n        YY_USER_INIT;\n#endif\n\n        if ( ! (yy_start) )\n            (yy_start) = 1; /* first start state */\n\n        if ( ! ssoin )\n            ssoin = stdin;\n\n        if ( ! ssoout )\n            ssoout = stdout;\n\n        if ( ! YY_CURRENT_BUFFER ) {\n            ssoensure_buffer_stack ();\n            YY_CURRENT_BUFFER_LVALUE =\n                sso_create_buffer(ssoin,YY_BUF_SIZE );\n        }\n\n        sso_load_buffer_state( );\n        }\n\n    {\n#line 44 \"ssolex.l\"\n\n\n#line 1265 \"&lt;stdout&gt;\"\n\n    while ( /*CONSTCOND*/1 )        /* loops until end-of-file is reached */\n        {\n        yy_cp = (yy_c_buf_p);\n\n        /* Support of ssotext. */\n        *yy_cp = (yy_hold_char);\n\n        /* yy_bp points to the position in yy_ch_buf of the start of\n         * the current run.\n         */\n        yy_bp = yy_cp;\n\n        yy_current_state = (yy_start);\n        yy_current_state += YY_AT_BOL();\nyy_match:\n        do\n            {\n            YY_CHAR yy_c = yy_ec[YY_SC_TO_UI(*yy_cp)] ;\n            if ( yy_accept[yy_current_state] )\n                {\n                (yy_last_accepting_state) = yy_current_state;\n                (yy_last_accepting_cpos) = yy_cp;\n                }\n            while ( yy_chk[yy_base[yy_current_state] + yy_c] != yy_current_state )\n                {\n                yy_current_state = (int) yy_def[yy_current_state];\n                if ( yy_current_state &gt;= 802 )\n                    yy_c = yy_meta[(unsigned int) yy_c];\n                }\n            yy_current_state = yy_nxt[yy_base[yy_current_state] + (unsigned int) yy_c];\n            ++yy_cp;\n            }\n        while ( yy_base[yy_current_state] != 1067 );\n\nyy_find_action:\n        yy_act = yy_accept[yy_current_state];\n        if ( yy_act == 0 )\n            { /* have to back up */\n            yy_cp = (yy_last_accepting_cpos);\n            yy_current_state = (yy_last_accepting_state);\n            yy_act = yy_accept[yy_current_state];\n            }\n\n        YY_DO_BEFORE_ACTION;\n\ndo_action:  /* This label is used only to access EOF actions. */\n</code></pre>\n\n<p>Last thing that is printed is Reading a token: which is in yacc <strong>C</strong> file so I think that the problem must be EOF handling in lex.</p>\n\n<pre><code>/* YYCHAR is either YYEMPTY or YYEOF or a valid lookahead symbol.  */\nif (yychar == YYEMPTY)\n{\n  YYDPRINTF ((stderr, \"Reading a token: \"));\n  yychar = yylex ();\n  printf(\"TOKEN %c, %d\\n\", yychar, yychar);\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "stm32", "dma", "hal"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462369078, "post_id": 37028884, "comment_id": 61608838, "body": "Is the reason you are using DMA that the program was too slow to respond without it, or is it just to free up the CPU? In case of the latter, ignore this comment. In case of the former, a solution with 1000 samples followed by an interrupt means that the interrupt will still have to be handled. And the DMA interrupt is likely more intricate than a simple ADC interrupt would have been. So if your program already couldn&#39;t handle the ADC interrupt, it will not be able to handle the DMA interrupt either."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462369292, "post_id": 37028884, "comment_id": 61608988, "body": "It&#39;s the second case."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462369475, "post_id": 37028884, "comment_id": 61609157, "body": "By the way the first case for this code is even in theory not possible :)."}, {"owner": {"reputation": 43081, "user_id": 371793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d3b0db3618140ff1fcf57cefc23a1?s=128&d=identicon&r=PG", "display_name": "mvds", "link": "https://stackoverflow.com/users/371793/mvds"}, "edited": false, "score": 0, "creation_date": 1499302678, "post_id": 37028884, "comment_id": 76852646, "body": "Are you sure about <code>DMA_InitStructure.DMA_Memory0BaseAddr = (uint32_t)&amp;uhADCxConvertedValue;</code>? It seems odd to pass a pointer to the address of the measured values. I would expect this to invoke a lot of undefined behavior."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "reply_to_user": {"reputation": 43081, "user_id": 371793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d3b0db3618140ff1fcf57cefc23a1?s=128&d=identicon&r=PG", "display_name": "mvds", "link": "https://stackoverflow.com/users/371793/mvds"}, "edited": false, "score": 0, "creation_date": 1499846462, "post_id": 37028884, "comment_id": 77076990, "body": "@mvds I don&#39;t understand your question. DMA_Memory0BaseAddr is expecting an address pointing the location where the DMA is going to refere. What do you suggest to pass?"}, {"owner": {"reputation": 43081, "user_id": 371793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d3b0db3618140ff1fcf57cefc23a1?s=128&d=identicon&r=PG", "display_name": "mvds", "link": "https://stackoverflow.com/users/371793/mvds"}, "edited": false, "score": 0, "creation_date": 1499848021, "post_id": 37028884, "comment_id": 77078085, "body": "I would pass <code>uhADCxConvertedValue</code>, without <code>&amp;</code>, that is the address of the first value of the array. (Or <code>&amp;uhADCxConvertedValue[0]</code>, which is the same)"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "reply_to_user": {"reputation": 43081, "user_id": 371793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d3b0db3618140ff1fcf57cefc23a1?s=128&d=identicon&r=PG", "display_name": "mvds", "link": "https://stackoverflow.com/users/371793/mvds"}, "edited": false, "score": 0, "creation_date": 1499853064, "post_id": 37028884, "comment_id": 77081762, "body": "@mvds ok got your point. You are right about that. It&#39;s already a known thing. Thanks."}, {"owner": {"reputation": 43081, "user_id": 371793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d3b0db3618140ff1fcf57cefc23a1?s=128&d=identicon&r=PG", "display_name": "mvds", "link": "https://stackoverflow.com/users/371793/mvds"}, "edited": false, "score": 0, "creation_date": 1499865657, "post_id": 37028884, "comment_id": 77091124, "body": "Ok, but should we fix it here, for anybody coming by, looking for example code (like me)?"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1500294075, "post_id": 37028884, "comment_id": 77256936, "body": "We could fix it here."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462368952, "post_id": 37029395, "comment_id": 61608731, "body": "This was a typo. Sorry about that."}], "tags": [], "owner": {"reputation": 421, "user_id": 3642304, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f79bdbc49e15165aba9b94addcab951e?s=128&d=identicon&r=PG&f=1", "display_name": "mban", "link": "https://stackoverflow.com/users/3642304/mban"}, "is_accepted": false, "score": 0, "last_activity_date": 1462368775, "creation_date": 1462368775, "answer_id": 37029395, "question_id": 37028884, "link": "https://stackoverflow.com/questions/37028884/execution-never-jumps-to-dma-irqhandler-in-stm32f4105x/37029395#37029395", "title": "Execution never jumps to DMA IRQHandler in stm32f4105x", "body": "<p>You aren't configuring the DMA interrupt correctly. You need to send the IT config function <code>DMA2_Stream0</code>. Change the line <code>DMA_ITConfig(DMA_CHANNELx, DMA_IT_TC, ENABLE);</code> to <code>DMA_ITConfig(DMA2_Stream0, DMA_IT_TC, ENABLE);</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462369351, "post_id": 37029457, "comment_id": 61609045, "body": "This is so. The DMA2_Stream0_IRQHandler is called once, but no more."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462369840, "post_id": 37029457, "comment_id": 61609442, "body": "Are you handling the DMA Half transfer interrupt? clearing HTIF0"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462369893, "post_id": 37029457, "comment_id": 61609495, "body": "Now yes. But it&#39;s not helping. I&#39;ll update the code."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462370507, "post_id": 37029457, "comment_id": 61610061, "body": "I see the ADC is in continuous conversion mode, there&#39;s another field in that ADC_InitStructure called DMAContinuousRequests.  Look in stm32fxx_hal_adc.c at ADC_Init"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462370772, "post_id": 37029457, "comment_id": 61610271, "body": "I don&#39;t see such field in the ADC_InitTypeDef declaration. Are you referring the stm32f4xx_adc.h file?"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462370904, "post_id": 37029457, "comment_id": 61610372, "body": "Look in the ADC control reg 2.  Bit 1 CONT: Continuous conversion  This bit is set and cleared by software. If it is set, conversion takes place continuously until it is cleared.  0: Single conversion mode  1: Continuous conversion mode"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371202, "post_id": 37029457, "comment_id": 61610618, "body": "Yes I see it&#39;s definition in stm32f4xx_had_adc.h as well, however the target I&#39;m looking at is the 401RE Nucleo board and the 401 Discovery boards.  Look into the .c file to see if that bit is set in the CR2 register."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371379, "post_id": 37029457, "comment_id": 61610768, "body": "How about a breakpoint at HAL_DMA_IRQHandler to see what the hdma structure contains, or if there&#39;s an error callback?"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371422, "post_id": 37029457, "comment_id": 61610814, "body": "It should be set by the ADC_Init. But why that will make a difference?"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371548, "post_id": 37029457, "comment_id": 61610921, "body": "HAL_DMA_IRQHandler is not defined in the startup_stm32f40xx.s."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371553, "post_id": 37029457, "comment_id": 61610928, "body": "There could be transfer error, fifo error, or dma error interrupts being set."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371673, "post_id": 37029457, "comment_id": 61611046, "body": "I think we are going away from the problem. I see OVR flag set in the ADC_SR register. I think the adc or the dma should be reenabled but how?"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462371875, "post_id": 37029457, "comment_id": 61611215, "body": "In my project DMA2_Stream0_IRQHandler(...) calls the HAL_ADC_IRQHandler(..) function.  I&#39;ve defined it in my project and over-ridden the <code>weak</code> reference in the code."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462372185, "post_id": 37029457, "comment_id": 61611465, "body": "Could be. But I don&#39;t find such function anywhere in the library."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462372380, "post_id": 37029457, "comment_id": 61611633, "body": "Do you have stm32fxx_hal_dma.c in your project?  It should be defined there."}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462372550, "post_id": 37029457, "comment_id": 61611775, "body": "Negative. No stm32fxx_hal_dma.c."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462373299, "post_id": 37029457, "comment_id": 61612366, "body": "Maybe get an updated Cube from STM. I have both  STM32Cube_FW_F4_V1.3.0\\Drivers\\STM32F4xx_HAL_Driver\\Inc\\stm3&zwnj;&#8203;2f4xx_hal_dma.h and STM32Cube_FW_F4_V1.3.0\\Drivers\\STM32F4xx_HAL_Driver\\Src\\stm3&zwnj;&#8203;2f4xx_hal_dma.c"}, {"owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "edited": false, "score": 0, "creation_date": 1462373569, "post_id": 37029457, "comment_id": 61612548, "body": "I&#39;m not using Cube. I&#39;m working the the library only, and avoid any high-level stuffs any time whenever rational. Btw. I&#39;ve just solved the issue. I&#39;m going to post the answer later. Thanks for the contribution."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1462368928, "creation_date": 1462368928, "answer_id": 37029457, "question_id": 37028884, "link": "https://stackoverflow.com/questions/37028884/execution-never-jumps-to-dma-irqhandler-in-stm32f4105x/37029457#37029457", "title": "Execution never jumps to DMA IRQHandler in stm32f4105x", "body": "<p>Make sure it's defined in the startup_stmf4xx.S file and declared at the correct vector spot.</p>\n\n<pre><code>    .long    DMA2_Stream0_IRQHandler           // DMA2 Stream 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "is_accepted": true, "score": 0, "last_activity_date": 1462373750, "creation_date": 1462373750, "answer_id": 37031361, "question_id": 37028884, "link": "https://stackoverflow.com/questions/37028884/execution-never-jumps-to-dma-irqhandler-in-stm32f4105x/37031361#37031361", "title": "Execution never jumps to DMA IRQHandler in stm32f4105x", "body": "<p>Just for those facing similar problem. When the DMA_IT_TCIF0 was triggered simultaneously there was an overrun interrupt in the ADC. Therefore the program needs to recover from that according to the sequence described in the RM0090 page 403, 13.8.1 Using the DMA. Here is the updated IRQHandler:</p>\n\n<pre><code>void DMA2_Stream0_IRQHandler(void) {\n    if(DMA_GetITStatus(DMA_STREAMx,DMA_IT_TCIF0)!=RESET) {\n        //clear the ADC-&gt;CR2 DDS and DMA flag to disable further DMA requests\n        ADCx-&gt;CR2 &amp;= ~(ADC_CR2_DDS|ADC_CR2_DMA);\n        //do processing\n        DMA_ClearITPendingBit(DMA_STREAMx,DMA_IT_TCIF0|DMA_IT_HTIF0);\n        //abjust the DMA NDTR counter\n        DMA_STREAMx-&gt;NDTR = (uint32_t)DMA_BUFFER_SIZE;\n        DMA_STREAMx-&gt;CR |= (uint32_t)DMA_SxCR_EN;\n        //set the DMA bit\n        ADCx-&gt;CR2 |= (ADC_CR2_DMA|ADC_CR2_DDS);\n        //clear the overload\n        ADCx-&gt;SR &amp;= ~(ADC_SR_OVR|ADC_SR_STRT);\n        //start the ADC\n        ADCx-&gt;CR2 |= (uint32_t)ADC_CR2_SWSTART;\n    }\n    ;\n}\n</code></pre>\n\n<p>Apart from that everything else is the same.</p>\n"}], "owner": {"reputation": 355, "user_id": 3664985, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2f0d3ccc5add04a2db3a02fd2c6accd0?s=128&d=identicon&r=PG&f=1", "display_name": "judoka_acl", "link": "https://stackoverflow.com/users/3664985/judoka-acl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 0, "accepted_answer_id": 37031361, "answer_count": 3, "score": 0, "last_activity_date": 1500293925, "creation_date": 1462367604, "last_edit_date": 1500293925, "question_id": 37028884, "link": "https://stackoverflow.com/questions/37028884/execution-never-jumps-to-dma-irqhandler-in-stm32f4105x", "title": "Execution never jumps to DMA IRQHandler in stm32f4105x", "body": "<p>I'm trying to get a sequence of 1000 samples from ADC1 of STM32f4105VC of STM32f401c-disco, using the DMA transactions. I want the DMA to generate an interrupt when the transfer is complete and to stop there so that no data is overwritten. Here is the code:</p>\n\n<pre><code>/* Private macro -------------------------------------------------------------*/\n#define M 5\n#define F_S 42000000\n#define LOG_SIZE 1000\n#define MEAS_PERIODS 1\n#define DMA_BUFFER_SIZE 1000\n/* Private variables ---------------------------------------------------------*/\n__IO uint16_t uhADCxConvertedValue[DMA_BUFFER_SIZE] = {0};\n__IO uint32_t uwADCxConvertedVoltage = 0;\ndouble voltage=0;\ndouble S=0, rms=0, F=0; // S quadratic sums, rms - the rms value, F the frequency\nuint32_t N; //number of samplings\ndouble unscaled_voltage=0;\nuint32_t max_N=0, steady_N = 0;\n\ntypedef char MyString[50];\nMyString Log[LOG_SIZE];\n\n\n\n/* Private function prototypes -----------------------------------------------*/\n/* Private functions ---------------------------------------------------------*/\nstatic void ADC_Config(void);\n\n\nvoid DMA2_Stream0_IRQHandler(void) {\n    if(DMA_GetITStatus(DMA_STREAMx,DMA_IT_TCIF0)!=RESET) {\n   DMA_ClearITPendingBit(DMA_STREAMx,DMA_STREAMx,DMA_IT_TCIF0|DMA_IT_HTIF0);\n    }\n}\n\n\n/**\n  * @brief  Main program\n  * @param  None\n  * @retval None\n  */\nint main(void)\n{\n  /*!&lt; At this stage the microcontroller clock setting is already configured, \n       this is done through SystemInit() function which is called from startup\n       files (startup_stm32f40_41xxx.s/startup_stm32f427_437xx.s/startup_stm32f429_439xx.s)\n       before to branch to application main. \n       To reconfigure the default setting of SystemInit() function, refer to\n       system_stm32f4xx.c file\n     */\n\n\n\n    double R = 3.0/0xfff; //conversion ratio\n    double dc_offset = 1.5;\n    double ac_scaling = 0.0022;\n    double mv_filter[M]={0};//moving average filter\n  uint8_t wave_pos=0; //0 upper half wave, 1 lower half wave\n    uint32_t i=0;\n    uint8_t i_period = 1;\n  /* ADC configuration */\n  ADC_Config();\n\n  /* Start ADC Software Conversion */ \n//   ADC_SoftwareStartConv(ADCx);\n    ADC_SoftwareStartConv(ADCx);\n  while (1) {}\n}\n\nstatic void ADC_Config(void)\n{\n  ADC_InitTypeDef       ADC_InitStructure;\n  ADC_CommonInitTypeDef ADC_CommonInitStructure;\n  DMA_InitTypeDef       DMA_InitStructure;\n  GPIO_InitTypeDef      GPIO_InitStructure;\n    NVIC_InitTypeDef            NVIC_InitStructure;\n\n  /* Enable ADCx, DMA and GPIO clocks ****************************************/ \n  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_DMA2, ENABLE);\n  RCC_AHB1PeriphClockCmd(ADCx_CHANNEL_GPIO_CLK, ENABLE);  \n  RCC_APB2PeriphClockCmd(ADCx_CLK, ENABLE);\n\n    /* Enable the DMA2 Stream0 Global Interrupt (to handle the Transfer Complete Interrupt TCIF) */\n    NVIC_InitStructure.NVIC_IRQChannel = DMA2_Stream0_IRQn;\n  NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;\n  NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;\n  NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\n  NVIC_Init(&amp;NVIC_InitStructure);\n\n  /* DMA2 Stream0 channel15 configuration **************************************/\n  DMA_InitStructure.DMA_Channel = DMA_CHANNELx;  \n  DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)ADCx_DR_ADDRESS;\n  DMA_InitStructure.DMA_Memory0BaseAddr = (uint32_t)&amp;uhADCxConvertedValue[0];\n  DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralToMemory;\n  DMA_InitStructure.DMA_BufferSize = DMA_BUFFER_SIZE;\n  DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;\n  DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;\n  DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_HalfWord;\n  DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord;\n  DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;\n  DMA_InitStructure.DMA_Priority = DMA_Priority_High;\n  DMA_InitStructure.DMA_FIFOMode = DMA_FIFOMode_Disable;         \n  DMA_InitStructure.DMA_FIFOThreshold = DMA_FIFOThreshold_HalfFull;\n  DMA_InitStructure.DMA_MemoryBurst = DMA_MemoryBurst_Single;\n  DMA_InitStructure.DMA_PeripheralBurst = DMA_PeripheralBurst_Single;\n  DMA_Init(DMA_STREAMx, &amp;DMA_InitStructure);\n  DMA_Cmd(DMA_STREAMx, ENABLE);\n\n  /* Configure ADC1 Channel15 pin as analog input ******************************/\n  GPIO_InitStructure.GPIO_Pin = GPIO_PIN;\n  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AN;\n  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;\n  GPIO_Init(GPIO_PORT, &amp;GPIO_InitStructure);\n\n  /* ADC Common Init **********************************************************/\n  ADC_CommonInitStructure.ADC_Mode = ADC_Mode_Independent;\n  ADC_CommonInitStructure.ADC_Prescaler = ADC_Prescaler_Div2;\n  ADC_CommonInitStructure.ADC_DMAAccessMode = ADC_DMAAccessMode_1;\n  ADC_CommonInitStructure.ADC_TwoSamplingDelay = ADC_TwoSamplingDelay_5Cycles;\n  ADC_CommonInit(&amp;ADC_CommonInitStructure);\n\n  /* ADC1 Init ****************************************************************/\n  ADC_InitStructure.ADC_Resolution = ADC_Resolution_12b;\n  ADC_InitStructure.ADC_ScanConvMode = DISABLE;\n  ADC_InitStructure.ADC_ContinuousConvMode = ENABLE;\n  ADC_InitStructure.ADC_ExternalTrigConvEdge = ADC_ExternalTrigConvEdge_None;\n  ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_T1_CC1;\n  ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right;\n  ADC_InitStructure.ADC_NbrOfConversion = 1;\n  ADC_Init(ADCx, &amp;ADC_InitStructure);\n\n  /* ADC1 regular channel15 configuration **************************************/\n  ADC_RegularChannelConfig(ADCx, ADC_CHANNEL, 1, ADC_SampleTime_3Cycles);\n\n//  /* Enable DMA request after last transfer (Single-ADC mode) */\n  ADC_DMARequestAfterLastTransferCmd(ADCx, ENABLE);\n\n//   /* Enable ADC1 DMA */\n  ADC_DMACmd(ADCx, ENABLE);\n\n  /* Enable ADC1 */\n  ADC_Cmd(ADCx, ENABLE);\n\n    DMA_ITConfig(DMA_STREAMx,DMA_IT_TC,ENABLE);\n}\n</code></pre>\n\n<p>When I debug the program after some time the DMA stops and the flags <code>TCIF0</code> and <code>HTIF0</code> are set in the the register <code>DMA_LISR</code>, though a breakpoint in the <code>DMA2_Stream0_IRQHandler</code> function is only once activated. Why?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1462367386, "post_id": 37028712, "comment_id": 61607502, "body": "Indentation doesn&#39;t match with the block scopes. Please <a href=\"https://stackoverflow.com/posts/37028712/edit\">edit</a> and fix it."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462368266, "post_id": 37028712, "comment_id": 61608196, "body": "<code>avfsd-&gt;data</code> seems to be pointer to array of <code>struct AVMotionVector</code>s. If so, then <code>mv[idx]</code> is valid way to access those structures. However, in that case  <code>mv[idx]-&gt;source</code> should probably be replaced with <code>mv[idx].source</code>, because you want only one redirection."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1462368345, "post_id": 37028712, "comment_id": 61608259, "body": "I noticed that there is not a single comment in your code - for your own sanity, fix that bad habit."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462369476, "post_id": 37028712, "comment_id": 61609158, "body": "@user694733 does it look better now? :)"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1462368253, "creation_date": 1462368253, "answer_id": 37029156, "question_id": 37028712, "link": "https://stackoverflow.com/questions/37028712/casting-struct-pointers-in-c/37029156#37029156", "title": "Casting struct pointers in C", "body": "<p>Change </p>\n\n<pre><code>if(mv[idx]-&gt;source &lt; 0)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if(mv[idx].source &lt; 0)\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<ul>\n<li><p><code>mv</code> is a <em>pointer</em> to <code>struct AVMotionVector</code></p></li>\n<li><p><code>mv[idx]</code> is a <code>struct AVMotionVector</code> and therefore you need <code>.</code>\ninstead of <code>-&gt;</code>.</p></li>\n</ul>\n"}], "owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37029156, "answer_count": 1, "score": 2, "last_activity_date": 1462369422, "creation_date": 1462367143, "last_edit_date": 1462369422, "question_id": 37028712, "link": "https://stackoverflow.com/questions/37028712/casting-struct-pointers-in-c", "title": "Casting struct pointers in C", "body": "<p>when I compiled the following code:</p>\n\n<pre><code>AVFrameSideData* avfsd=NULL;\navfsd = av_frame_get_side_data(frame, AV_FRAME_DATA_MOTION_VECTORS);\nif(avfsd != NULL) {\n    int n_mvs = 0;\n    if(avfsd-&gt;size &gt; 0)\n        n_mvs = avfsd-&gt;size / sizeof(struct AVMotionVector);\n    struct AVMotionVector *mv = (struct AVMotionVector *) (avfsd-&gt;data);\n    printf(\"motion vectors of this frame:\\n\");\n    int idx;\n    for(idx=0; idx&lt;n_mvs; idx++) {\n        printf(\"mv[%d]:\\n\", idx);\n        if(mv[idx]-&gt;source &lt; 0)\n            printf(\"the current macroblock comes from the past\\n\");\n    }\n}\n</code></pre>\n\n<p>my compiler complained:</p>\n\n<pre><code>video_analysis.c:46:13: error: invalid type argument of \u2018-&gt;\u2019 (have \u2018struct AVMotionVector\u2019)\n   if(mv[idx]-&gt;source &lt; 0)\n</code></pre>\n\n<p>Frankly, there's something wrong here:</p>\n\n<pre><code>struct AVMotionVector *mv = (struct AVMotionVector *) (avfsd-&gt;data);\n</code></pre>\n\n<p>mv is a struct pointer, thereof it's not allowed to access through a two dimensional array manner like *mv[]. However, when I ran it in GDB, I was able to print out things like the following:</p>\n\n<pre><code>(gdb) print mv[0]\n$2 = {source = -1, w = 16 '\\020', h = 16 '\\020', src_x = 6, src_y = 10, dst_x = 8, dst_y = 8, flags = 0, motion_x = -5, motion_y = 4, \n  motion_scale = 2}\n</code></pre>\n\n<p>which is exactly what I want to print out...As you can see, mv[0], which can't be accessed from my original code spinet above can now be accessed in GDB mode. How does GDB make this magic happen? If I want to access mv[0] in my program just like in GDB, how should I cast those struct pointers?\nThanks in advance :-)</p>\n"}, {"tags": ["c", "syntax", "embedded"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 3, "creation_date": 1462366051, "post_id": 37028065, "comment_id": 61606352, "body": "No, there should not be any difference. Your question is quite vague, where are you hearing these things from?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1462366795, "post_id": 37028065, "comment_id": 61606977, "body": "This is not really related to embedded systems, they work the same as any C platform in this case."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4229473, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4338321f84587ec3759ea1457d2ac721?s=128&d=identicon&r=PG&f=1", "display_name": "elti", "link": "https://stackoverflow.com/users/4229473/elti"}, "edited": false, "score": 0, "creation_date": 1462367633, "post_id": 37028373, "comment_id": 61607706, "body": "Great. Thanks a lot Steve."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 7, "last_activity_date": 1462367904, "last_edit_date": 1462367904, "creation_date": 1462366243, "answer_id": 37028373, "question_id": 37028065, "link": "https://stackoverflow.com/questions/37028065/using-memcmp-vs-in-c-embedded-and-unexpected-errors/37028373#37028373", "title": "Using memcmp Vs. == in c (embedded) and unexpected errors", "body": "<p>You've blurred together two separate ideas.</p>\n\n<p>There's nothing wrong with</p>\n\n<pre><code>if (Text[0] == 'A')\n</code></pre>\n\n<p>It'll do just what you want.</p>\n\n<p>What you probably heard, and what you can't do, is</p>\n\n<pre><code>if (Text == \"A\")\n</code></pre>\n\n<p>That will virtually always come out false, even if <code>Text</code> contains \"A\".</p>\n\n<p>If you want to compare strings, you generally use <code>strcmp</code>:</p>\n\n<pre><code>if(strcmp(Text, \"A\") == 0)\n</code></pre>\n\n<p>Of course this only works on properly-formed, null-terminated strings.</p>\n\n<p>Finally, while you can certainly do</p>\n\n<pre><code>if (!memcmp(Text, \"A\", 1))\n</code></pre>\n\n<p>if you really want to, it's a strange and potentially inefficient usage, which doesn't buy you anything.</p>\n"}], "owner": {"reputation": 103, "user_id": 4229473, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4338321f84587ec3759ea1457d2ac721?s=128&d=identicon&r=PG&f=1", "display_name": "elti", "link": "https://stackoverflow.com/users/4229473/elti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "closed_date": 1462378732, "accepted_answer_id": 37028373, "answer_count": 1, "score": 0, "last_activity_date": 1462367904, "creation_date": 1462365401, "last_edit_date": 1462367104, "question_id": 37028065, "link": "https://stackoverflow.com/questions/37028065/using-memcmp-vs-in-c-embedded-and-unexpected-errors", "closed_reason": "Needs more focus", "title": "Using memcmp Vs. == in c (embedded) and unexpected errors", "body": "<p>I keep hearing that using <code>==</code> operator to compare chars can cause some problems. </p>\n\n<p>My question is - what kind of problems?</p>\n\n<p>For example, is there any difference between using:</p>\n\n<pre><code>if (Text[0] == 'A') { ; }\n</code></pre>\n\n<p>and </p>\n\n<pre><code>if (!memcmp(Text, \"A\", 1)) { ; }\n</code></pre>\n"}, {"tags": ["c", "serial-port"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462364440, "post_id": 37027594, "comment_id": 61605135, "body": "You might want to read <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">the <code>select</code> manual page</a>, pay close attention to the first argument."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462364687, "post_id": 37027594, "comment_id": 61605297, "body": "And what does a zero return from select() mean? And what does FD_ISSET() say?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462364810, "post_id": 37027594, "comment_id": 61605383, "body": "And what would a 1 return from select() mean?"}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1462364946, "post_id": 37027594, "comment_id": 61605477, "body": "that there is one filedescryptor ready to read from"}], "answers": [{"comments": [{"owner": {"reputation": 1571, "user_id": 2034218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/607f22adeb07d267b740a5441eb36d6d?s=128&d=identicon&r=PG", "display_name": "Tezirg", "link": "https://stackoverflow.com/users/2034218/tezirg"}, "edited": false, "score": 0, "creation_date": 1462364963, "post_id": 37027856, "comment_id": 61605494, "body": "does this solve your problem ? If so accept your answer. If not edit your question and remove this answer"}, {"owner": {"reputation": 1571, "user_id": 2034218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/607f22adeb07d267b740a5441eb36d6d?s=128&d=identicon&r=PG", "display_name": "Tezirg", "link": "https://stackoverflow.com/users/2034218/tezirg"}, "edited": false, "score": 0, "creation_date": 1462365071, "post_id": 37027856, "comment_id": 61605586, "body": "Sorry, I forgot about that."}], "tags": [], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "is_accepted": true, "score": 4, "last_activity_date": 1462365361, "last_edit_date": 1462365361, "creation_date": 1462364892, "answer_id": 37027856, "question_id": 37027594, "link": "https://stackoverflow.com/questions/37027594/select-blocks-when-there-are-some-data-to-read/37027856#37027856", "title": "select() blocks when there are some data to read", "body": "<p>I should use the select like that:</p>\n\n<pre><code>int ret = select(input_fd +1,&amp;set,NULL,NULL,&amp;wait_time_struct); \n</code></pre>\n\n<p>The argument name nfds kind of confused me, it just looks like an amount of file descriptors in the set. From manual </p>\n\n<p><code>nfds is the highest-numbered file descriptor in any of the three sets, plus 1.</code></p>\n"}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 37027856, "answer_count": 1, "score": 0, "last_activity_date": 1462365361, "creation_date": 1462364276, "last_edit_date": 1462365078, "question_id": 37027594, "link": "https://stackoverflow.com/questions/37027594/select-blocks-when-there-are-some-data-to-read", "title": "select() blocks when there are some data to read", "body": "<p>I am trying to implement a blocking read on a serial port. I have the following code</p>\n\n<pre><code>int blocking_read(int input_fd,int wait_time){\n    if(wait_time &lt;= 0) return 0;\n    fd_set set;\n    FD_ZERO(&amp;set);\n    FD_SET(input_fd,&amp;set);\n    struct timeval wait_time_struct;\n    wait_time_struct.tv_sec = wait_time / 1000000;\n    wait_time_struct.tv_usec = wait_time % 1000000;\n    int ret = select(1,&amp;set,NULL,NULL,&amp;wait_time_struct); \n    char a;\n    int check=read(input_fd,&amp;a,1);\n    printf (\"ret %d, check %d %02x\\n\",ret,check,a&amp;0xFF);\n    return ret;\n}\n</code></pre>\n\n<p>the last 4 lines are just for a debug...\nWhen I run this when I expect a message on serial port in a loop, the output is:</p>\n\n<pre><code>ret 0, check 1 ff\nret 0, check 1 ff\nret 0, check 1 c4\nret 0, check 1 d7\nret 0, check 1 00\nret 0, check 1 01\n...\n</code></pre>\n\n<p>and the message I expect is <code>FF FF C4 D7 00 01....</code> so obviously, the <code>select()</code> block even though there is something to read... Can you please help me?</p>\n"}, {"tags": ["c", "parameters", "pass-by-name"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1462360494, "post_id": 37026187, "comment_id": 61602317, "body": "Please explain what do you mean by pass by name, and how is that different from pass by value, and pass by reference"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1462360521, "post_id": 37026187, "comment_id": 61602337, "body": "@RishikeshRaje Well, rather not. search here."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462360531, "post_id": 37026187, "comment_id": 61602345, "body": "Never heard of it myself, but LMGTFY gave me: <a href=\"http://stackoverflow.com/questions/838079/what-is-pass-by-name-and-how-does-it-work-exactly\" title=\"what is pass by name and how does it work exactly\">stackoverflow.com/questions/838079/&hellip;</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462360555, "post_id": 37026187, "comment_id": 61602365, "body": "@pheonix  Please let us knopw why pass-by-value thr&#39; a pointer does no suffice your needs. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462360660, "post_id": 37026187, "comment_id": 61602442, "body": "Also, in your case, is <i>implement</i> == <i>emulate</i>?"}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462360732, "post_id": 37026187, "comment_id": 61602499, "body": "@SouravGhosh Yes, exactly emulating, sorry."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462360754, "post_id": 37026187, "comment_id": 61602520, "body": "You use the right tool for the job. Which is, if you need pass by name, something other than C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462360759, "post_id": 37026187, "comment_id": 61602525, "body": "C does not support pass by reference. Your prerequisite is wrong."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462360820, "post_id": 37026187, "comment_id": 61602562, "body": "C is turing complete, so &quot;how to implement it?&quot; - By writing code."}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1462360864, "post_id": 37026187, "comment_id": 61602599, "body": "@Olaf , what I mean is emulating."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462360954, "post_id": 37026187, "comment_id": 61602657, "body": "Emulating writing code? Anyway, don&#39;t get too fancy. If you want such features, use a language which is suited for this, e.g. Python."}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462361213, "post_id": 37026187, "comment_id": 61602859, "body": "@Olaf Of course I can do this with Python, but I want to learn to do this in C. I am studying computer science, I do not expect you to do my assignments, but help me learning the process."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462361463, "post_id": 37026187, "comment_id": 61603043, "body": "The standard term is &quot;call by name&quot;.  It is best known from Algol 60, and classically implemented using objects known as &quot;thunks&quot;.  Basically, arguments are evaluated when the called function accesses them, as many times as they are accessed, in the context of the caller.  Probably the closest you can get in C would be to pass functions which are called by the function each time the argument is needed."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1462362527, "post_id": 37026187, "comment_id": 61603760, "body": "It might be possible to implement this using the gcc extension which supports nested functions, which could then be passed as arguments.  The caller would then call the functions when it needs the arguments.  But this is not portable and is not true C, so it would only work with gcc with the extension enabled.  I suppose you could instead use structures that contain both data pointers and function pointers.  It&#39;s ugly no matter how you do it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462362816, "post_id": 37026187, "comment_id": 61603977, "body": "Call by name example:  You call a function <code>foo(i, a[i])</code>.  Function <code>foo</code> is declared <code>void foo(int x, int y)</code>.  With call by name, if <code>foo</code> assigns 5 to <code>x</code>, then accesses <code>y</code>, it will end up getting <code>a[5]</code>, since <code>i</code> is now 5 in the caller."}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462363350, "post_id": 37026187, "comment_id": 61604359, "body": "@TomKarzes I&#39;ve got the point, thank you very much."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462367067, "post_id": 37026187, "comment_id": 61607224, "body": "I believe that the C preprocessor uses something pretty close to pass by name.  For example, if we say <code>#define foo(x, y) (x=5, printf(&quot;%d\\n&quot;, y))</code>, then invoke <code>foo(i, a[i])</code>, it&#39;ll do just what @TomKarzes described."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462367266, "post_id": 37026187, "comment_id": 61607394, "body": "See <a href=\"http://c-faq.com/ptrs/passbyref.html\" rel=\"nofollow noreferrer\">c-faq.com/ptrs/passbyref.html</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462360618, "post_id": 37026241, "comment_id": 61602409, "body": "<i>You can&#39;t implement pass-by-reference</i>, sorry, but isn&#39;t it too negative?"}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "edited": false, "score": 0, "creation_date": 1462360686, "post_id": 37026241, "comment_id": 61602462, "body": "I am pretty sure that you can emulate pass-by-reference by using pointers."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1462360709, "post_id": 37026241, "comment_id": 61602478, "body": "#offtopic: <code>C is only pass-by-value</code>..I was unaware... I thought C is a language.. :P"}, {"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1462360722, "post_id": 37026241, "comment_id": 61602493, "body": "thanks both, no idea why I wrote &quot;you can&#39;t implement&quot;. The implement is not necessary and might even be misleading."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1462360770, "post_id": 37026241, "comment_id": 61602533, "body": "Of course you can implement pass-by reference. The question is what it applies to. Given <code>void func (int* x)</code>, the pointer address is passed by value, but the pointed-at data is passed by reference. Otherwise if you want to be picky, computers can only pass addresses to functions by putting values on the stack or in index registers. No pass by reference exists anywhere inside a computer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1462360908, "post_id": 37026241, "comment_id": 61602629, "body": "Note OP changed the question, which renders part of your answer useless."}, {"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "edited": false, "score": 0, "creation_date": 1462361005, "post_id": 37026241, "comment_id": 61602707, "body": "I have corrected the misleading part of the question. What I need is an example of pass-by-name emulation using C (I think macros may be useful, but I have no idea..)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "edited": false, "score": 0, "creation_date": 1462361868, "post_id": 37026241, "comment_id": 61603317, "body": "@phoeNix: <i>Tom Karzes</i> explained the concept here: <a href=\"http://stackoverflow.com/questions/37026187/pass-by-name-implementation-in-c#comment61603043_37026187\" title=\"pass by name implementation in c%23comment61603043_37026187\">stackoverflow.com/questions/37026187/&hellip;</a>. Now it&#39;s up to <i>you</i> to implement it. If running into <i>specific</i> issues while doing so, feel free come back here asking another question on it."}], "tags": [], "owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "is_accepted": false, "score": 3, "last_activity_date": 1462360832, "last_edit_date": 1462360832, "creation_date": 1462360571, "answer_id": 37026241, "question_id": 37026187, "link": "https://stackoverflow.com/questions/37026187/pass-by-name-implementation-in-c/37026241#37026241", "title": "Pass-by-name implementation in C", "body": "<p>C is only pass-by-value. You can't pass by reference or name. With the pre-processor you can do various hacks but not in the C language.</p>\n\n<p>Sometimes, people call passing a pointer \"pass-by-reference\" but this is not the case. The pointer is passed by value like anything else. C++ is a different story but you asked about C.</p>\n\n<p>You might also be interested in <a href=\"http://denniskubes.com/2012/08/20/is-c-pass-by-value-or-reference/\" rel=\"nofollow\">this article discussion this at length</a></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "edited": false, "score": 0, "creation_date": 1462476252, "post_id": 37028810, "comment_id": 61664290, "body": "Do you have any example demonstrating that? For example, subtracting two variables? I have tried thunking but I could not work it out.."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1462367428, "creation_date": 1462367428, "answer_id": 37028810, "question_id": 37026187, "link": "https://stackoverflow.com/questions/37026187/pass-by-name-implementation-in-c/37028810#37028810", "title": "Pass-by-name implementation in C", "body": "<p>The parameter substitution used by function-like preprocessor macros is sometimes described as being \"pass by name\".</p>\n"}], "owner": {"reputation": 63, "user_id": 4244490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd2034f8eeeba43662fadbbb1550de0a?s=128&d=identicon&r=PG&f=1", "display_name": "phoeNix", "link": "https://stackoverflow.com/users/4244490/phoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462367428, "creation_date": 1462360423, "last_edit_date": 1462360808, "question_id": 37026187, "link": "https://stackoverflow.com/questions/37026187/pass-by-name-implementation-in-c", "title": "Pass-by-name implementation in C", "body": "<p>I know that C uses pass-by-value and we can emulate pass-by-reference with the help of pointers. But, for example, in order to calculate a simple mathematical expression, how do I implement pass-by-name (which is kind of lazy evaluation but not exactly) in C? </p>\n"}, {"tags": ["c", "time", "timeval"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1462360273, "post_id": 37026091, "comment_id": 61602167, "body": "There is not statement between your start and stop. Only a declaration."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462360380, "post_id": 37026091, "comment_id": 61602246, "body": "He means there is nothing to compute between <code>start</code> and <code>stop</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462360427, "post_id": 37026091, "comment_id": 61602280, "body": "But maybe that was the intention."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1462360582, "post_id": 37026091, "comment_id": 61602378, "body": "You are not checking return values of functions. It looks like you don&#39;t care whether your calls sucseed or fail."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462360961, "post_id": 37026091, "comment_id": 61602668, "body": "@n.m.: But in the true spirit of C programming, the code gets to the end as quickly as possible!"}], "answers": [{"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 7, "last_activity_date": 1462360357, "creation_date": 1462360357, "answer_id": 37026164, "question_id": 37026091, "link": "https://stackoverflow.com/questions/37026091/measuring-time-in-c-gives-wrong-result/37026164#37026164", "title": "Measuring time in C gives wrong result", "body": "<p>You are calling <code>settimeofday()</code> when you should be calling <code>gettimeofday()</code>!</p>\n"}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1463075700, "accepted_answer_id": 37026164, "answer_count": 1, "score": 0, "last_activity_date": 1462360617, "creation_date": 1462360163, "last_edit_date": 1462360617, "question_id": 37026091, "link": "https://stackoverflow.com/questions/37026091/measuring-time-in-c-gives-wrong-result", "closed_reason": "Not suitable for this site", "title": "Measuring time in C gives wrong result", "body": "<p>I am trying to measure time in C in microseconds. I tried this code, but the value <code>time_passed</code> is a huge number, instead of 0 (or 1).</p>\n\n<pre><code>   struct timeval start;\n   settimeofday(&amp;start,NULL);\n   struct timeval stop;\n   settimeofday(&amp;stop,NULL);\n   unsigned long long int time_passed = \n       (stop.tv_sec-start.tv_sec)*1000000 + (stop.tv_usec - start.tv_usec);\n   printf(\"time passed: %llu us\\n\",time_passed);\n</code></pre>\n"}, {"tags": ["c", "if-statement", "language-lawyer", "semantics"], "comments": [{"owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 4, "creation_date": 1462357632, "post_id": 37024948, "comment_id": 61600222, "body": "No, <code>else if</code> is just another <code>if</code> following <code>else</code>. I think there&#39;s a duplicate of this question."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1462357949, "post_id": 37024948, "comment_id": 61600466, "body": "@MichaelWalz: What you mean by exclusive. I&#39;m not getting why it shouldn&#39;t be. But I&#39;d love to get enlighted."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1462358145, "post_id": 37024948, "comment_id": 61600611, "body": "No, but there is #elif"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 7, "creation_date": 1462358229, "post_id": 37024948, "comment_id": 61600681, "body": "@technosaurus: This is s nonsense and missleading comment. You confuse core language and preprocessor."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462358990, "post_id": 37024948, "comment_id": 61601212, "body": "I would not use a <i>code formatting tool</i> that inserts <code>{</code> between <code>else</code> and <code>if()</code>. Never."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1462359561, "post_id": 37024948, "comment_id": 61601636, "body": "@wildplasser: ofc one should do it never. But I made multiple times clear that this was a bug of my tool, which made me realize this. It never was intended to do so."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462359919, "post_id": 37024948, "comment_id": 61601912, "body": "@Olaf It is misleading, I&#39;ve seen new programmers see it in an #ifdef and make the assumption that its semantics can be carried over by removing the # as in #if and #else... usually its the ones with good deductive reasoning skills that make this leap.  And BTW the preprocessor <i>is</i> part of the core language &quot;6.10 Preprocessing directives&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1462360155, "post_id": 37024948, "comment_id": 61602078, "body": "@technosaurus: The standard does not use the term &quot;core language&quot;. It is commonly the part processed after the preprocessing stages, i.e. after phase 4."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462360196, "post_id": 37024948, "comment_id": 61602113, "body": "@Zaibis <i>not exclusive</i> : forget this comment, it&#39;s stupid, I removed it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1462360224, "post_id": 37024948, "comment_id": 61602133, "body": "@technosaurus I&#39;m afraid people with good reasoning skills who are expecting a rationally-designed, consistent programming language are in for quite a bit of disappointment when it comes to C..."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1462362913, "post_id": 37024948, "comment_id": 61604043, "body": "The distinction between the preprocessor language (with the <code>#elif</code> keyword) and the &quot;core&quot; C language (without a dedicated <code>else if</code> keyword) is actually very interesting to make. I see it as a result of C language having exactly 1 statement inside its <code>if</code> and <code>else</code> clauses, and the preprocessor having several lines inside <code>#if</code>, <code>#elif</code> and <code>#else</code> parts. I guess all languages take one of these two approaches, with Python going one way, Pascal going the other, and C going both ways :) A language-design rule of thumb: if you have some sort of <code>endif</code>, you should have some sort of <code>elseif</code>."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1462364525, "post_id": 37024948, "comment_id": 61605193, "body": "@anatolyg: interesting note. thanks for sharing it."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1462410607, "post_id": 37024948, "comment_id": 61630977, "body": "note that some languages do have an elseif - PHP for example"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1462412897, "post_id": 37024948, "comment_id": 61631474, "body": "@pm100: Generally languages that use an <code>end</code>, <code>endif</code>, <code>end if</code>, or <code>fi</code> marker to terminate an <code>if</code> statement need a separate <code>elsif</code> or <code>elseif</code> keyword to avoid deep nesting. (But PHP doesn&#39;t, and <code>elseif</code> seems to be equivalent to <code>else if</code>.)"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1462432089, "post_id": 37024948, "comment_id": 61637507, "body": "@pm100: note that im actually explicit asking about c"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 18, "last_activity_date": 1462421020, "last_edit_date": 1462421020, "creation_date": 1462357848, "answer_id": 37025148, "question_id": 37024948, "link": "https://stackoverflow.com/questions/37024948/does-an-else-if-statement-exist/37025148#37025148", "title": "Does an else if statement exist?", "body": "<p>As per the <code>C11</code>, chapter \u00a76.8.4, <em>selection statements</em>, the available statement blocks are</p>\n\n<pre><code>if ( expression ) statement\nif ( expression ) statement else statement\nswitch ( expression ) statement\n</code></pre>\n\n<p>and, regarding the <code>else</code> part,</p>\n\n<blockquote>\n  <p>An <code>else</code> is associated with the lexically nearest preceding <code>if</code> that is allowed by the\n  syntax.</p>\n</blockquote>\n\n<p>So, there is no <code>else if</code> construct, exists as per standard <code>C</code>. </p>\n\n<p>Obviously, an <code>if</code> (or <code>if...else</code>) block can exist as the <em>statement</em> in <code>else</code> block (nested <code>if...else</code>, we may say).</p>\n\n<p>The choice of indentation , is left to the user.</p>\n\n<hr>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p><em>Just to add, there is no reason for a separate <code>else if</code> construct to exist, the functionality can be achieved by nesting. See <a href=\"https://en.wikipedia.org/wiki/Conditional_(computer_programming)#Choice_system_cross_reference\" rel=\"nofollow\">this wiki article</a>. Relevant quote</em></p>\n\n<blockquote>\n  <p><em>The often-encountered <code>else if</code> in the <code>C</code> family of languages, and in COBOL and Haskell, is not a language feature but a set of nested and independent <strong>\"if then else\"</strong> statements combined with a particular source code layout. However, this also means that a distinct <code>else-if</code> construct is not really needed in these languages.</em></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 9825, "user_id": 646723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f8e9d841078b823918ade5723fee47?s=128&d=identicon&r=PG", "display_name": "Bruce Martin", "link": "https://stackoverflow.com/users/646723/bruce-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1462414262, "last_edit_date": 1462414262, "creation_date": 1462406707, "answer_id": 37040153, "question_id": 37024948, "link": "https://stackoverflow.com/questions/37024948/does-an-else-if-statement-exist/37040153#37040153", "title": "Does an else if statement exist?", "body": "<p>As every one is aware, there is several different styles of programming languages. The presence of a <strong>elseif</strong> is based on the style of language.\nIn a C/Pascal style the <strong>if</strong> statement is</p>\n\n<pre><code>if (...)\n   statment; \nelse\n   statement;\n</code></pre>\n\n<p>and you have a compound statement:\n    {\n       statment;\n       statment;\n    } </p>\n\n<p>while in a Modula2 / VB / (python ?) style language you have</p>\n\n<pre><code>if (...)\n   statement;\n   ...\n   statement;\nelse\n   statement;\n   ...\n   statement;\nend-if\n</code></pre>\n\n<p>in the Modula2 / VB you <strong>need</strong> a <strong>elseif</strong> statement because if you tried using <em>else if</em> you get</p>\n\n<pre><code>if (..)\nelse if (..)\nelse if (..)\nend-if; end-if; end-if;\n</code></pre>\n\n<p>The <strong>end-if's</strong> at the end are rather ugly. </p>\n\n<p>As @anatolyg noted this is why you have a #elif in C macro language.</p>\n\n<hr>\n\n<p>Cobol-85 has a different take on the elseif statement. It provides an extended <em>Select</em>/<em>case</em> statement. In Cobol you have an evaluate:</p>\n\n<pre><code>evaluate option\n   when 1\n      ...\n   when 2\n      ...\n</code></pre>\n\n<p>but you can also do</p>\n\n<pre><code>evaluate true\n   when age &gt; 21 and gender = 'male'\n      ...\n   when age &gt; 21 and gender = 'female'\n</code></pre>\n\n<p>In Cobol you can also mix the case and if structure</p>\n\n<pre><code>evaluate option also true\n   when 1 also age &gt; 21 and gender = 'male'\n      .... \n   when 1 also age &gt; 21 and gender = 'female'\n      .... \n   when 2 also any\n      ....\n</code></pre>\n\n<hr>\n\n<p>One final point in java and C you sometimes see</p>\n\n<pre><code>if () {\n\n} else if () {\n\n} else if () {\n\n}\n</code></pre>\n\n<p>To all intents and purposes, this is VB / Modula-2 written in Java/C. </p>\n"}], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2716, "favorite_count": 2, "accepted_answer_id": 37025148, "answer_count": 2, "score": 13, "last_activity_date": 1462421020, "creation_date": 1462357371, "last_edit_date": 1462361501, "question_id": 37024948, "link": "https://stackoverflow.com/questions/37024948/does-an-else-if-statement-exist", "title": "Does an else if statement exist?", "body": "<p>Some time ago after not standing anymore lines like this:</p>\n\n<pre><code>if (arg)\n    invk(test);\nelse if (test)\n{\n    alot();\n    stuff();\n}\n</code></pre>\n\n<p>I decided for my self its better for readability in our 1920x1200 times, to not omit the <code>{}</code>.</p>\n\n<p>So I wrote a tool that reformats my existing code.</p>\n\n<p>later I noticed a bug in that tool resulting in</p>\n\n<pre><code>if (x)\n{\n ...\n}\nelse if(y)\n{\n ...\n}\nelse if(z)\n{\n ...\n}\n</code></pre>\n\n<p>had been changed (wihtout obvisiously changing the behavior) into:</p>\n\n<pre><code>if (x)\n{\n ...\n}\nelse \n{\n    if(y)\n    {\n     ...\n    }\n    else\n    {\n        if(z)\n        {\n         ...\n        }\n    }\n}\n</code></pre>\n\n<p>This made me realize (unintended) that this is actually what a <code>else if</code> does by syntax and semantical rules of C.</p>\n\n<p>So is there even an statement like <code>else if()</code> existing or is it just an abuse of semantic that results in this usefull but (lets call it so for this purpose) obfuscation originated wording that breaks any formating rules and just serves as human readable?</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462358667, "post_id": 37024555, "comment_id": 61600995, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1462358933, "post_id": 37024555, "comment_id": 61601180, "body": "Rolled back. Do **not change vital parts the question once you got answers! Instead add corrections to the end."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462359022, "post_id": 37024555, "comment_id": 61601236, "body": "Would you please stop editing! Your edit makes the answers loose context."}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462359504, "post_id": 37024555, "comment_id": 61601597, "body": "Sorry ! First time asking question.  In my code I did not use keyword struct for the name, of course."}], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462357866, "post_id": 37024826, "comment_id": 61600396, "body": "Ok, of course I did not write it exactly like here using keyword struct for name of structure. And reagarding your answer, I thought that this may happend but I still do not know why. Can you give more detailed answer? I even tried to change macro to be exactly like you wrote but I got different error."}, {"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "reply_to_user": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462358059, "post_id": 37024826, "comment_id": 61600540, "body": "well, the macro definition still suffers from the 2nd error I pointed out. You are passing a numeric value to the macro and you&#39;re trying to use that as the identifier for a variable inside the struct"}, {"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "reply_to_user": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462358139, "post_id": 37024826, "comment_id": 61600602, "body": "can you write what code you want generated by the macro? I gave an example of what your macro generates, lets compare it with what we want."}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462359315, "post_id": 37024826, "comment_id": 61601452, "body": "No this totally not what I want to do.  It goes more like this:  <code>typedef struct {     int param1; }some_struct_t;  #define some_macro(param1)       \\ static some_struct_t my_struct = \\ {                                \\     .param1 = param1             \\ }</code>"}, {"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "reply_to_user": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462359584, "post_id": 37024826, "comment_id": 61601657, "body": "haha, then I will suggest this: <code>#define some_macro(value) struct some_struct_t myStruct = { .param1 = value }</code> . I don&#39;t think we have to keep <code>param1</code> as our macro parameter, do we?"}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462361430, "post_id": 37024826, "comment_id": 61603018, "body": "In fact using the same name helps to understand part of bigger code but of course I can change it to something simillar. But my question why it crashes and not how to fix it, knowing now that problem is not with <i>struct</i> . Can you expand answer why would it behave like <code>struct some_struct_t myStruct = { .50 = 50 };</code>"}, {"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "reply_to_user": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462361715, "post_id": 37024826, "comment_id": 61603219, "body": "Look at the bit here: <code>= { .param1 = param1 }</code>. Simply replace every occurence of <code>param1</code> with <code>50</code>. What do you get?"}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462365283, "post_id": 37024826, "comment_id": 61605756, "body": "I know but is the preprocessor that stupid? Does it not see operand &quot; . &quot; ? Is really answer that simple ? :)"}], "tags": [], "owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "is_accepted": false, "score": 2, "last_activity_date": 1462359618, "last_edit_date": 1462359618, "creation_date": 1462357062, "answer_id": 37024826, "question_id": 37024555, "link": "https://stackoverflow.com/questions/37024555/parameter-of-macro-mixed-with-field-of-structure/37024826#37024826", "title": "Parameter of macro mixed with field of structure", "body": "<p>There are a few issues with it.</p>\n\n<p><code>some_struct_t struct</code> is wrong. if some_struct_t is a <em>typedef</em> for a struct or a <em>define</em> for one, you need to do <code>some_struct_t myStruct</code> else <code>struct some_struct_t myStruct</code></p>\n\n<hr>\n\n<p>Another issue is, in the code your macro generates, you'll have something like the following (assuming the problem above is fixed):</p>\n\n<pre><code>struct some_struct_t myStruct = { .50 = 50 };\n</code></pre>\n\n<p>I believe you didn't intend to use <code>50</code> as an identifier :)</p>\n\n<p>This may be more like what you want:</p>\n\n<pre><code>#define some_macro(key, value) \\\nstruct some_struct_t myStruct = {\\\n    .key = value\\\n}\n</code></pre>\n\n<p>Or if you already know which variable you want to set:</p>\n\n<pre><code>#define some_macro(value) \\\nstruct some_struct_t myStruct = {\\\n    .param1 = value\\\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "edited": false, "score": 1, "creation_date": 1462360597, "post_id": 37024835, "comment_id": 61602395, "body": "+1 for the trick. I&#39;d strongly advice against anyone using it though. It&#39;s a lot cleaner to just pass the key and values to the macro"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1462360873, "post_id": 37024835, "comment_id": 61602606, "body": "@quentin, @aec: we can also use <a href=\"https://en.wikipedia.org/wiki/Digraphs_and_trigraphs\" rel=\"nofollow noreferrer\">digraphs</a>: <code>.param%:%:1 = param1</code>"}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462361570, "post_id": 37024835, "comment_id": 61603114, "body": "Actually I was not asking for solution but explanation why that happens. You got any idea on this, knowing I did not use_struct_ for name of structure?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462361882, "post_id": 37024835, "comment_id": 61603331, "body": "@Michal, of course but it is explained in the answer, the preprocessor replaces all occurrences of <code>param1</code> with <code>50</code> and you receive <code>.50 = 50</code>. Conclusion: you have chosen a bad name for your macro parameter, name it <code>p1</code> or something else than your member name."}, {"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1462365418, "post_id": 37024835, "comment_id": 61605862, "body": "Yes but again : is  the preprocessor that stupid? Does it not see operand &quot; . &quot; ?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462365966, "post_id": 37024835, "comment_id": 61606297, "body": "<a href=\"http://www.jlekstrand.net/math/teaching/programming-course/unit-2/preprocessor/\" rel=\"nofollow noreferrer\">Take a look</a>: Because expanding macros is simply a search-and-replace operation, a macro can technically contain anything. However, because it is just search-and-replace, the preprocessor knows nothing about the variables etc. so the macro may expand to something that makes no sense in the context."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 5, "last_activity_date": 1462357582, "last_edit_date": 1462357582, "creation_date": 1462357086, "answer_id": 37024835, "question_id": 37024555, "link": "https://stackoverflow.com/questions/37024555/parameter-of-macro-mixed-with-field-of-structure/37024835#37024835", "title": "Parameter of macro mixed with field of structure", "body": "<p><code>struct</code> is a reserved word, you can not use it as a variable name</p>\n\n<p>Change to something like:</p>\n\n<pre><code>#define some_macro(p1)                \\\nstatic some_struct_t valid_var_name = \\\n{                                     \\\n    .param1 = p1                      \\\n}\n</code></pre>\n\n<p>If you want to use the same name of the member (<code>param1</code>) as the name of your macro parameter you need to stop the expansion (using <code>##</code>) or you get <code>.50 = 50</code></p>\n\n<pre><code>#define some_macro(param1)     \\\nstatic some_struct_t varname = \\\n{                              \\\n    .param##1 = param1         \\\n}\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 37024835, "answer_count": 2, "score": 1, "last_activity_date": 1462359618, "creation_date": 1462356321, "last_edit_date": 1462358951, "question_id": 37024555, "link": "https://stackoverflow.com/questions/37024555/parameter-of-macro-mixed-with-field-of-structure", "title": "Parameter of macro mixed with field of structure", "body": "<p>So I have macro like this:</p>\n\n<pre><code>#define some_macro(param1)    \\\nstatic some_struct_t struct = \\\n{                             \\\n    .param1 = param1          \\\n}\n</code></pre>\n\n<p>When I call this macro from main with direct value:</p>\n\n<pre><code>some_macro(50);\n</code></pre>\n\n<p>I got an error : </p>\n\n<pre><code>..\\..\\main.c(185): error:  #29: expected an expression\n</code></pre>\n\n<p>I found 2 ways to solve it, first was to declare const value within main and pass to macro and second to change name of parameter not be the same as in macro.</p>\n\n<p>So it works but I do not what caused error. Any ideas?</p>\n"}, {"tags": ["c", "linux", "sockets", "raw-sockets"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6135829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f5c1162f4047c76bb0726533d5d433?s=128&d=identicon&r=PG&f=1", "display_name": "M. Artem", "link": "https://stackoverflow.com/users/6135829/m-artem"}, "edited": false, "score": 0, "creation_date": 1462358399, "post_id": 37025186, "comment_id": 61600811, "body": "my mistake :( Thank you!"}], "tags": [], "owner": {"reputation": 1571, "user_id": 2034218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/607f22adeb07d267b740a5441eb36d6d?s=128&d=identicon&r=PG", "display_name": "Tezirg", "link": "https://stackoverflow.com/users/2034218/tezirg"}, "is_accepted": true, "score": 0, "last_activity_date": 1462357934, "creation_date": 1462357934, "answer_id": 37025186, "question_id": 37023810, "link": "https://stackoverflow.com/questions/37023810/resend-packets-via-raw-sockets-in-linux/37025186#37025186", "title": "resend packets via RAW sockets in linux", "body": "<p>Your sock_raw_inner is still listening on every interface because the bind on eth0 you are trying to perform is not supported. So the packet sent to another interface is indeed then received by your sock_raw_inner</p>\n\n<p>Extract from man (7) socket (see bold text) </p>\n\n<blockquote>\n  <p>SO_BINDTODEVICE\n                Bind this socket to a particular device like \"eth0\",  as  speci-\n                fied  in  the  passed  interface  name.  If the name is an empty\n                string or the option length is zero, the socket  device  binding\n                is  removed.  The passed option is a variable-length null termi-\n                nated interface name string with the maximum size  of  IFNAMSIZ.\n                If a socket is bound to an interface, only packets received from\n                that particular interface are processed by the socket. Note that\n                this  only  works  for  some  socket types, particularly AF_INET\n                sockets. <strong>It is not supported  for  packet  sockets</strong>  (use  normal\n                bind(8) there).</p>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 6135829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f5c1162f4047c76bb0726533d5d433?s=128&d=identicon&r=PG&f=1", "display_name": "M. Artem", "link": "https://stackoverflow.com/users/6135829/m-artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 37025186, "answer_count": 1, "score": 0, "last_activity_date": 1462357934, "creation_date": 1462354407, "question_id": 37023810, "link": "https://stackoverflow.com/questions/37023810/resend-packets-via-raw-sockets-in-linux", "title": "resend packets via RAW sockets in linux", "body": "<p>It's needed to read raw data from one interface and send it via another.</p>\n\n<p>open&amp;&amp;config(the same for sock_raw_outer):</p>\n\n<pre><code>sock_raw_inner = socket(PF_PACKET, SOCK_RAW, htons(ETH_P_ALL));\nsetsockopt(sock_raw_inner, SOL_SOCKET, SO_BINDTODEVICE, \"eth0\", 4);\nstruct ifreq if_idx1;\nmemset(&amp;if_idx1, 0, sizeof(struct ifreq));\nstrncpy(if_idx1.ifr_name, opt, strlen(opt));\nioctl(sock_raw_inner, SIOCGIFINDEX, &amp;if_idx1);\n</code></pre>\n\n<p>then in cycle:</p>\n\n<pre><code>data_size = recvfrom(sock_raw_inner, buffer, 65536, MSG_DONTWAIT, NULL, NULL);\n    if (data_size &gt; 0) {\n        struct sockaddr_ll socket_address;\n        socket_address.sll_ifindex = if_idx2.ifr_ifindex;\n        socket_address.sll_halen = ETH_ALEN;\n        //copy dest\n        socket_address.sll_addr[0] = buffer[0];\n        socket_address.sll_addr[1] = buffer[1];\n        socket_address.sll_addr[2] = buffer[2];\n        socket_address.sll_addr[3] = buffer[3];\n        socket_address.sll_addr[4] = buffer[4];\n        socket_address.sll_addr[5] = buffer[5];\n        sendto(sock_raw_outer, buffer, size, 0, (struct sockaddr*)&amp;socket_address, sizeof(struct sockaddr_ll))\n    }\n</code></pre>\n\n<p>then, if I catch on sock_raw_inner any packet(arp request, for example), it sended on sock_raw_inner again and again by sendto. What's wrong? Thanks.</p>\n"}, {"tags": ["c", "makefile", "rule"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462355545, "post_id": 37023772, "comment_id": 61598762, "body": "Does <code>Name.c</code> exist, in the top-level directory?"}, {"owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462359145, "post_id": 37023772, "comment_id": 61601325, "body": "yes, otherwise the makefile would not require the .o to be build"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462359154, "post_id": 37023772, "comment_id": 61601337, "body": "Is there name.c in your <code>sources.list</code> file?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 1, "creation_date": 1462359469, "post_id": 37023772, "comment_id": 61601567, "body": "Not solving the problem at all but yet, <code>-lm</code> should be in variable <code>LD_FLAGS</code> instead of <code>CFLAGS</code>."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462359677, "post_id": 37023772, "comment_id": 61601730, "body": "Also with the way this makefile is written you will always do linking because you will never create a <code>all</code> file."}, {"owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "edited": false, "score": 0, "creation_date": 1462359761, "post_id": 37023772, "comment_id": 61601795, "body": "i dont want to create an all file, can you explain this?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 3, "creation_date": 1462360134, "post_id": 37023772, "comment_id": 61602061, "body": "Replace <code>all</code> by <code>$(BUILDDIR)&#47;$(EXEC)</code> in your current <code>all</code> rule. Add a <code>all</code> rule bfore with no command: <code>all:$(BUILDDIR)&#47;$(EXEC)</code>, and add a <code>.PHONY</code> directive: <code>.PHONY:all clean</code>. <code>.PHONY</code> sets the list of targets who are not actual files."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462360595, "post_id": 37023772, "comment_id": 61602391, "body": "I get the same message error than you when trying to build a <code>obj&#47;toto.o</code> file while <code>toto.c</code> is not present."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462360660, "post_id": 37023772, "comment_id": 61602443, "body": "Your comment answering to Tom Karzes is all wrong."}, {"owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "edited": false, "score": 0, "creation_date": 1462360701, "post_id": 37023772, "comment_id": 61602475, "body": "but the file is present and included in my sources list. Thanks for the other comment, i adapted my script accordingly"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462360745, "post_id": 37023772, "comment_id": 61602509, "body": "No error with the case? You seem to be running on linux, so file names are case sensitive."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462360894, "post_id": 37023772, "comment_id": 61602619, "body": "You can set <code>SOUCES=$(wildcard *.c)</code> or <code>SOUCES=$(wildcard *.c *&#47;*.c)</code> to avoid such errors."}, {"owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "edited": false, "score": 0, "creation_date": 1462361390, "post_id": 37023772, "comment_id": 61602997, "body": "I am using the file lists for the sources, because the folder contains .c files, which i do not want to compile. The .o files the makefile complains about are available in the main Folder as .c files. I checked the cases"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462361640, "post_id": 37023772, "comment_id": 61603159, "body": "Did you post your whole makefile? There is no <code>vpath</code> directive sooner that you would not have shown us?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462363062, "post_id": 37023772, "comment_id": 61604146, "body": "I tried your makefile on Windows with <code>type</code> instead of <code>cat</code>, I got no problem, there must be something important you are not telling us."}, {"owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "edited": false, "score": 0, "creation_date": 1462366155, "post_id": 37023772, "comment_id": 61606449, "body": "added the working Version to my Initial question, but how can i get the makefile to create the files inside the obj folder"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1462432220, "post_id": 37023772, "comment_id": 61637579, "body": "Do you have sources with the same file name in your <code>src</code> directory (but in different sub-directories of course)?"}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "is_accepted": false, "score": 1, "last_activity_date": 1462363099, "creation_date": 1462363099, "answer_id": 37027140, "question_id": 37023772, "link": "https://stackoverflow.com/questions/37023772/makefile-does-not-find-rule-for-object/37027140#37027140", "title": "Makefile does not find rule for object", "body": "<p>Are all the files in headers.list present at the right place ?</p>\n\n<p>By the way, this is not a good way to handle dependencies on headers. You should take a look at <code>-MP</code> and <code>-MDD</code> and other options of your preprocessor to generate dependencies.</p>\n"}, {"tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": false, "score": 0, "last_activity_date": 1462439739, "last_edit_date": 1462439739, "creation_date": 1462437053, "answer_id": 37045934, "question_id": 37023772, "link": "https://stackoverflow.com/questions/37023772/makefile-does-not-find-rule-for-object/37045934#37045934", "title": "Makefile does not find rule for object", "body": "<p>A classical makefile which should do what you need:</p>\n\n<pre><code>SHELL=/bin/bash\nCC=gcc\nCFLAGS=-std=c99 -g -o0\nLDFLAGS=-lm\nEXEC=test\nBUILDDIR=build/\nOBJDIR=obj/\nSOURCES=$(shell cat sources.list)\nOBJECTS=$(patsubst %.c,$(OBJDIR)%.o,$(notdir $(SOURCES)))\n\nvpath %.c $(sort $(dir $(SOURCES)))\n\n.PHONY:all mrproper clean depends\n\nall:$(BUILDDIR)$(EXEC)\n\n$(BUILDDIR)$(EXEC):$(OBJECTS)|$(BUILDDIR)\n    $(CC) $(CFLAGS) $^ -o $@ $(LDFLAGS)\n\n$(OBJDIR)%.o:%.c|$(OBJDIR)\n    $(CC) -c $&lt; -o $@\n\n$(BUILDDIR) $(OBJDIR):\n    mkdir $@\n\nmrproper:clean\n    rm -f $(BUILDDIR)$(EXEC)\n\nclean:\n    rm -f $(OBJECTS)\n\ndepends:\n    @rm -f dependencies.mk\n    @for i in $(SOURCES); do $(CC) -MM $$i -MT $(OBJDIR)`basename $$i | sed s:.c$$:.o:` &gt;&gt; dependencies.mk; done\n\ninclude $(wildcard dependencies.mk)\n</code></pre>\n\n<p>If something is not clear, let me know.</p>\n\n<p>Usage:</p>\n\n<pre><code>make depends\nmake\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 1246311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e73f9dff822ef50018ac3211679d3cc5?s=128&d=identicon&r=PG", "display_name": "Thorsten", "link": "https://stackoverflow.com/users/1246311/thorsten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462439739, "creation_date": 1462354302, "last_edit_date": 1462366097, "question_id": 37023772, "link": "https://stackoverflow.com/questions/37023772/makefile-does-not-find-rule-for-object", "title": "Makefile does not find rule for object", "body": "<p>I have a beginner's question about a Makefile. I have a very simple makefile containing:</p>\n\n<pre><code>SHELL = /bin/sh\nCC = gcc\nCFLAGS = -lm -std=c99 -g -o0\nEXEC = test\nBUILDDIR = build\nOBJDIR = obj\nSOURCES = $(shell cat sources.list)\nDEPS = $(shell cat headers.list)\nOBJ = $(SOURCES:.c=.o)\nOBJECTS = $(patsubst %,$(OBJDIR)/%,$(OBJ))\n\nall: $(OBJECTS)\n    $(CC) $(CFLAGS) $(OBJECTS) -o $(BUILDDIR)/$(EXEC)\n\n$(OBJDIR)/%.o: %.c $(DEPS)\n    $(CC) -c $&lt; -o $@\n\nclean:\n    rm -f $(BUILDDIR)/$(EXEC) $(OBJDIR)/*.o\n</code></pre>\n\n<p>My Problem is, if I try to use this Makefile to compile, it returns the error message:</p>\n\n<pre><code>there is no rule for the target obj/Name.o\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>After the first few comments and further research I got to this working Version, but it does not create the object files in the obj folder, so it is not what I aim for</p>\n\n<pre><code>SHELL = /bin/sh\nCC = gcc\nCFLAGS = -lm -std=c99 -g -o0\nEXEC = test\nBUILDDIR = build\nOBJDIR = obj\nSOURCES = $(shell cat sources.list)\nDEPS = $(shell cat headers.list)\nOBJ = $(SOURCES:.c=.o)\nOBJECTS = $(patsubst %,$(OBJDIR)/%,$(OBJ))\n\nall: $(BUILDDIR)/$(EXEC)\n\n$(BUILDDIR)/$(EXEC): $(OBJ)\n$(CC) $(CFLAGS) $(OBJ) -o  $(BUILDDIR)/$(EXEC)\n\n%.o: %.c $(DEPS)\n$(CC) -c $&lt; -o $@\n\n\nclean:\nrm -f $(BUILDDIR)/$(EXEC) $(OBJDIR)/*.o\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "char", "system"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462354184, "post_id": 37023515, "comment_id": 61597807, "body": "Independetly of you problem: you know that you&#39;ll run into problems if your file has more then 16 lines."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1462354484, "post_id": 37023515, "comment_id": 61598028, "body": "Independently of your problem, you should check if file is there and close the file pointer upon content being read..."}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462354337, "post_id": 37023673, "comment_id": 61597922, "body": "@MichaelWalz, thanks for the edit, my english is very poor :)"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 3, "last_activity_date": 1462356665, "last_edit_date": 1462356665, "creation_date": 1462354062, "answer_id": 37023673, "question_id": 37023515, "link": "https://stackoverflow.com/questions/37023515/storing-line-by-line-from-text-file-into-char-array-using-char-pointer/37023673#37023673", "title": "Storing line by line from text file into char array using char pointer", "body": "<pre><code>int n_lines=0;        \nchar in[100],*args[16];        \nint size=sizeof(in);\n\nwhile(fgets(in, size, fp)!=NULL){        \n    args[n_lines] = in;                \n    printf(\"Args[0] is %s\\n\",args[0]);            \n    n_lines++;\n}\n</code></pre>\n\n<p>The value of <code>in</code> is overwritten on each iteration, you need to reserve space (using <code>malloc-&gt;strcpy</code> or <code>strdup</code> if available):</p>\n\n<pre><code>char in[100], *args[16];\n\nwhile (fgets(in, sizeof in, fp) != NULL) {\n    args[n_lines] = strdup(in);\n    ...\n    n_lines++;\n}\n</code></pre>\n\n<p>Or use a 2D array (an adjust of <code>sizeof</code> is required in <code>fgets</code>):</p>\n\n<pre><code>char in[16][100];\n\nwhile (fgets(in[n_lines], sizeof in[0], fp) != NULL) {\n    ...\n    n_lines++;\n}\n</code></pre>\n\n<p>And as pointed out by @MichaelWalz in comments: you'll run into problems if your file has more then 16 lines.</p>\n\n<p>Change to</p>\n\n<pre><code>while (fgets(in[n_lines], sizeof in[0], fp) != NULL) {\n    ...\n    if (++n_lines == (sizeof in / sizeof in[0])) break;\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 6289685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82b85f303ba3c56a7748d1244636b37b?s=128&d=identicon&r=PG&f=1", "display_name": "zach chen", "link": "https://stackoverflow.com/users/6289685/zach-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1950, "favorite_count": 1, "accepted_answer_id": 37023673, "answer_count": 1, "score": 3, "last_activity_date": 1462356665, "creation_date": 1462353688, "last_edit_date": 1462354297, "question_id": 37023515, "link": "https://stackoverflow.com/questions/37023515/storing-line-by-line-from-text-file-into-char-array-using-char-pointer", "title": "Storing line by line from text file into char array using char pointer", "body": "<p>Hello  I writing a program to execute commands from the text file. The code below is used to store line by line into char array first.</p>\n\n<p>So I expect it to do something like </p>\n\n<pre><code>args[0]= The first line of text file  \nargs[1]= The second line of text file\n... and so on\n</code></pre>\n\n<p>In my code, all of the arrays would be covered by the last array. And I can't figure out why.  </p>\n\n<p>Can anyone help me fix this and tell me why my code does that. Also I need to keep char *args[]. cos I would use it with execvp() later.</p>\n\n<pre><code>int main(int argc, const char * av[]) {    \n    FILE *fp;    \n    fp = fopen(av[1],\"r\");\n\n    int n_lines=0;        \n    char in[100],*args[16];        \n    int size=sizeof(in);\n\n     while(fgets(in, size, fp)!=NULL){        \n        args[n_lines] = in;                \n        printf(\"Args[0] is %s\\n\",args[0]);            \n        n_lines++;\n    }\n\n     printf(\"Now Args[0] is %s\\n\",args[0]);\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>zacks-MacBook-Pro:prac2 zack$ ./a.out test    \nArgs[0] is ./addone    \nArgs[0] is ./add    \nNow Args[0] is ./add\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462353711, "post_id": 37023431, "comment_id": 61597451, "body": "<code>static</code> means &quot;this variable is not <i>directly</i> accessible outside the unit/file&quot;, but I don&#39;t understand why you are receiving such error"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462353770, "post_id": 37023431, "comment_id": 61597494, "body": "If you get an error that a variable was declared but never references, odds are you declared it but never referenced it. (Perhaps you referenced a different variable with the same name.)"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462353827, "post_id": 37023431, "comment_id": 61597540, "body": "@DavidSchwartz Yeah I am wondering what is wrong. I am using it the same array in my code."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1462353833, "post_id": 37023431, "comment_id": 61597543, "body": "I have compiled the code with <code>static uint32_t a[20] = {0};</code> using either gcc or llvm, got neither errors nor warnings."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462353889, "post_id": 37023431, "comment_id": 61597587, "body": "@Gopi It told you what is wrong, you are declaring a variable but not referencing it. As I said, you might be referencing a different variable with the same name. Try removing all the declarations that it tells you are not referenced -- if your code still compiles and links, it was  right."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354010, "post_id": 37023431, "comment_id": 61597682, "body": "&quot;When I make the variable static and use it I get an error&quot;  How and where did you try to use the variable?"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354054, "post_id": 37023431, "comment_id": 61597711, "body": "@Lundin In the same <code>.c</code> file . In one of the functions."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462354110, "post_id": 37023431, "comment_id": 61597751, "body": "So you tried to use a static variable in the same .c file in which it was declared and you got an error? Can you post a minimal, complete, compilable piece of code that reproduces the error or warning so we can see it for ourselves?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354116, "post_id": 37023431, "comment_id": 61597753, "body": "Then there is some other error in your code not related to the use of <code>static</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462354226, "post_id": 37023431, "comment_id": 61597839, "body": "<i>things work fine.</i> it&#39;s apparent. For internal linkage, compiler can issue the diagnostic..."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354454, "post_id": 37023431, "comment_id": 61598010, "body": "@Lundin Has it got anything to do with the compiler ? I mean is there any obvious bug. I am sure that I am using the variable in my function"}, {"owner": {"reputation": 494, "user_id": 3974475, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/wtCtx.jpg?s=128&g=1", "display_name": "K.H.A.J.A.S", "link": "https://stackoverflow.com/users/3974475/k-h-a-j-a-s"}, "edited": false, "score": 0, "creation_date": 1462354510, "post_id": 37023431, "comment_id": 61598050, "body": "Are you using this declaration inside an header file?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462354531, "post_id": 37023431, "comment_id": 61598063, "body": "@Gopi There&#39;s no way we can know if we can&#39;t see the code. Sometimes the error message can be misleading. As an extremely silly example, imagine if somewhere in your code you had something like  <code>#define static static X</code>, you&#39;d get very strange error messages when you declared something <code>static</code>. Give us enough code to reproduce the error and we&#39;ll tell you what the problem is."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354655, "post_id": 37023431, "comment_id": 61598144, "body": "@Gopi It has almost certainly something to do with a bug in the code which you have not shown us."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462355211, "post_id": 37023431, "comment_id": 61598535, "body": "@Lundin Uff!!!! I found out what was the error. The code which was using this was under some macro which the declaration was not... Thanks all."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1462355220, "post_id": 37023431, "comment_id": 61598541, "body": "@DavidSchwartz  Uff!!!! I found out what was the error. The code which was using this was under some macro which the declaration was not... Thanks all."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462355429, "post_id": 37023431, "comment_id": 61598682, "body": "Ok I&#39;ll vote to close as &quot;cannot be reproduced&quot; then. It would perhaps be interesting for future readers if you could post the problematic code that caused the issue."}], "answers": [{"comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1462353670, "post_id": 37023498, "comment_id": 61597425, "body": "Can you please elaborate?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 2, "creation_date": 1462353716, "post_id": 37023498, "comment_id": 61597455, "body": "@Gopi Can you explain what was unclear or what you need elaboration on?"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1462354092, "post_id": 37023498, "comment_id": 61597737, "body": "Here is a post about <a href=\"http://stackoverflow.com/questions/3698043/static-variables-in-c\">static variable in C++</a> - is it the same in C?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1462354197, "post_id": 37023498, "comment_id": 61597823, "body": "@user3078414 It is the same except C++ has one additional meaning: when you make a private member <code>static</code>, you only get one such member across all instances of that class."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462354281, "post_id": 37023498, "comment_id": 61597874, "body": "Thanks @Lundin, great explanation!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1462354180, "last_edit_date": 1462354180, "creation_date": 1462353623, "answer_id": 37023498, "question_id": 37023431, "link": "https://stackoverflow.com/questions/37023431/what-is-the-difference-between-static-and-non-static-global/37023498#37023498", "title": "What is the difference between static and non static global", "body": "<p>The major difference is, when defined as <code>static</code>, the scope of the array is limited to the translation unit, while , without static, the scope in not limited to the translation unit.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.2.2</p>\n\n<blockquote>\n  <p>If the declaration of a file scope identifier for an object or a function contains the storage class\n  specifier <code>static</code>, the identifier has internal linkage.</p>\n</blockquote>\n\n<p>So, in case of a <code>static</code> global, you cannot <em>use</em> that variable outside of the translation unit.</p>\n"}, {"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1462355485, "last_edit_date": 1462355485, "creation_date": 1462354688, "answer_id": 37023922, "question_id": 37023431, "link": "https://stackoverflow.com/questions/37023431/what-is-the-difference-between-static-and-non-static-global/37023922#37023922", "title": "What is the difference between static and non static global", "body": "<p>The keyword <code>static</code></p>\n\n<p><strong>Case 1 :</strong> When used in <code>file scope</code></p>\n\n<p>Example :</p>\n\n<pre><code>static int x=0; // declared outside main() and all functions\n</code></pre>\n\n<p>means the the variable can be used only within the translation unit, ie the file which contains it.</p>\n\n<p>So  you cannot do </p>\n\n<pre><code>extern int x; // from another file\n</code></pre>\n\n<p><strong>Case 2 :</strong> When used in <code>block scope</code></p>\n\n<p>Example </p>\n\n<pre><code>somefunction()\n{\nstatic int x=0;\nx++; // x acting as a counter here\n}\n</code></pre>\n\n<p>The variable <code>x</code> stays put(or it is not reinitialized) during different invocations of the function. You can use it as a function variable, for example, as a counter to find how many times a function is called. The scope is limited to the function block.</p>\n\n<hr>\n\n<p>Regarding the warning :</p>\n\n<blockquote>\n  <p>variable \"a\" was declared but never referenced</p>\n</blockquote>\n\n<p>The memory allocated for an automatic variable is freed when it goes out of context. But this is not the case with static variables. They stay put till the end of the execution. If you don't use a static variable, the compiler may warn you regarding this - I guess - so that you could avoid such a declaration.</p>\n"}], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1462358257, "creation_date": 1462353437, "last_edit_date": 1462358257, "question_id": 37023431, "link": "https://stackoverflow.com/questions/37023431/what-is-the-difference-between-static-and-non-static-global", "title": "What is the difference between static and non static global", "body": "<pre><code>static uint32_t a[20] = {0};\n</code></pre>\n\n<p>and </p>\n\n<pre><code>uint32_t a[20] = {0};\n</code></pre>\n\n<p>I use both of them in the code</p>\n\n<pre><code>a[0] = 1;\n</code></pre>\n\n<p>and so on....</p>\n\n<p>When I make the variable <code>static</code> and use it I get an error</p>\n\n<pre><code>variable \"a\" was declared but never referenced\n</code></pre>\n\n<p>but when I remove <code>static</code> things work fine. </p>\n\n<p>In both the cases the array <code>a</code> is a global one.</p>\n\n<p>The error is with the MACROS . </p>\n\n<p>Array declaration is done and it is used by some platform and I don't see an error on that. Same code provides an error because this declaration/array is not used on other platform. </p>\n\n<p>My bad !!!!</p>\n\n<pre><code>static uint32_t a[20] = {0};\nvoid func()\n{\n ...............\n   #ifdef ABC\n\n   a[0] = 1;\n\n   #endif\n ................\n}\n</code></pre>\n\n<p>Now compile on platform ABC no error compile on some non ABC platform there is an error.</p>\n\n<p>Solution: Wrap global also under the respective macro</p>\n\n<pre><code>#ifdef ABC\nstatic uint32_t a[20] = {0};\n#endif\n</code></pre>\n"}, {"tags": ["java", "c++", "c", "linux", "gcc"], "answers": [{"comments": [{"owner": {"reputation": 13885, "user_id": 1509695, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/04a3ca8cd41bf8e170b901072fcc667f?s=128&d=identicon&r=PG", "display_name": "matanster", "link": "https://stackoverflow.com/users/1509695/matanster"}, "edited": false, "score": 0, "creation_date": 1528878261, "post_id": 37029528, "comment_id": 88668882, "body": "Depending on your preference, sometimes it&#39;s nicer to <a href=\"https://stackoverflow.com/a/558819/1509695\">add the include directories globally</a> after finding them, like if you&#39;re building someone else&#39;s project without wanting to fiddle their make files."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 22, "last_activity_date": 1462369112, "creation_date": 1462369112, "answer_id": 37029528, "question_id": 37023234, "link": "https://stackoverflow.com/questions/37023234/fatal-error-jni-md-h-no-such-file-or-directory-include-jni-md-h/37029528#37029528", "title": "fatal error: jni_md.h: No such file or directory #include &quot;jni_md.h&quot;", "body": "<p>I think that you do not added include directory that includes <code>jni_md.h</code> which is <a href=\"http://mail.openjdk.java.net/pipermail/discuss/2011-June/001918.html\" rel=\"noreferrer\">platform dependent</a>.</p>\n\n<p>Try</p>\n\n<pre><code>$gcc -I/usr/lib/jvm/java-8-openjdk-amd64/include -I/usr/lib/jvm/java-8-openjdk-amd64/include/linux -c MainImpl1.c -o MainImpl1.o\n</code></pre>\n\n<p>or </p>\n\n<pre><code>$gcc -I/usr/lib/jvm/java-8-oracle/include -I/usr/lib/jvm/java-8-oracle/include/linux -c MainImpl1.c -o MainImpl1.o\n</code></pre>\n\n<p>If you don't know where jni_md.h is, use <code>find</code>:</p>\n\n<pre><code>find / -name jni_md.h 2&gt; /dev/null\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6289799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829875a7adb3e43982c420cacef9515a?s=128&d=identicon&r=PG&f=1", "display_name": "Manjunath", "link": "https://stackoverflow.com/users/6289799/manjunath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14550, "favorite_count": 1, "accepted_answer_id": 37029528, "answer_count": 1, "score": 11, "last_activity_date": 1616309884, "creation_date": 1462352977, "last_edit_date": 1462371492, "question_id": 37023234, "link": "https://stackoverflow.com/questions/37023234/fatal-error-jni-md-h-no-such-file-or-directory-include-jni-md-h", "title": "fatal error: jni_md.h: No such file or directory #include &quot;jni_md.h&quot;", "body": "<p>While executing <code>gcc</code> command on ubuntu for generating .a or .so file for JNI, getting below error for both openjdk 8 / oraclejdk8.</p>\n\n<pre><code>$gcc -I/usr/lib/jvm/java-8-openjdk-amd64/include -c MainImpl1.c -o MainImpl1.o\n\nIn file included from MainImpl1.c:1:0:\n/usr/lib/jvm/java-8-openjdk-amd64/include/jni.h:45:20: fatal error: jni_md.h: No such file or directory\n #include \"jni_md.h\"\n                ^\ncompilation terminated.\n\n$gcc -I/usr/lib/jvm/java-8-oracle/include -c MainImpl1.c -o MainImpl1.o\n\nIn file included from MainImpl1.c:1:0:\n/usr/lib/jvm/java-8-oracle/include/jni.h:45:20: fatal error: jni_md.h: No such file or directory\n #include \"jni_md.h\"\n                ^\ncompilation terminated.\n</code></pre>\n\n<p>I have given example for generating .a file, but same issue observed for .so file generation also.</p>\n\n<p>But same <code>gcc</code> command works for openjdk7/oraclejdk7.</p>\n\n<p>What is the issue here?</p>\n"}, {"tags": ["c", "shell", "unix", "command", "system"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462353075, "post_id": 37023021, "comment_id": 61596965, "body": "What happens if you type <code>(time lance REF_CLIENT_FOUR002542_C FE-ERPCP-REF_CLIENT_FOUR.zip F &gt; result.txt) 2&gt; time.txt</code> from the command line ?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1462353288, "post_id": 37023021, "comment_id": 61597128, "body": "Implementing your use-case in C seems a little bit like taking a sledgehammer to crack a nut. You want to have a look at some basic shell scripting."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1462353384, "post_id": 37023021, "comment_id": 61597207, "body": "Have you tried running your command the way that <code>system()</code> does?  I.e. <code>&#47;bin&#47;sh -c &quot;(time lance ...)&quot;</code> - that may expose some assumptions you&#39;ve made about <code>$SHELL</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1462353449, "post_id": 37023021, "comment_id": 61597265, "body": "If you&#39;re using <code>system()</code>, you don&#39;t need <code>fork().</code> The <code>system()</code> function essentially does a <code>fork</code> for you."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1462353471, "post_id": 37023021, "comment_id": 61597276, "body": "&quot;<i>but I want to run this like a command not a program so time lance ...</i>&quot; please excuse but I somewhat do under understand what you want to express."}, {"owner": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1462354321, "post_id": 37023021, "comment_id": 61597909, "body": "@alk The purpose of my program is to run my shell script (lance) many time to record the execution&#39;s time to optimize the script (lance). Sorry for my english i want to say that I think the error could be that system try to execute a program &quot;./lance&quot; but it&#39;s a shell script so just &quot;lance&quot; is enough. I&#39;m not sure about that just a guess."}, {"owner": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462354336, "post_id": 37023021, "comment_id": 61597921, "body": "@MichaelWalz, If I type the command from the command line it&#39;s working"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1462356801, "post_id": 37023021, "comment_id": 61599643, "body": "<code>.&#47;lance</code> refers to the file <code>lance</code> in the current directory. The current directory can always be referred from out of itself via <code>.</code>"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1462353661, "post_id": 37023470, "comment_id": 61597421, "body": "Without forking the program behaves differently, as the calls to <code>system()</code> would run in sequence, not in parallel."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "edited": false, "score": 0, "creation_date": 1462355950, "post_id": 37023470, "comment_id": 61599012, "body": "@ArthurDessez: &quot;<i>I removed fork()</i>&quot; So you also want to remove the wait()` as it most likely does not do what you expect. Please RTFM here: <a href=\"http://man7.org/linux/man-pages/man2/wait.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/wait.2.html</a>"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1462353559, "creation_date": 1462353559, "answer_id": 37023470, "question_id": 37023021, "link": "https://stackoverflow.com/questions/37023021/system-parameters-c/37023470#37023470", "title": "System() parameters C", "body": "<p>You don't need to <code>fork()</code> when using <code>system()</code>! The latter is a much more high-level call, it will fork a shell and ask that to run the command.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "edited": false, "score": 0, "creation_date": 1462365496, "post_id": 37024619, "comment_id": 61605922, "body": "I&#39;ve updated my code. The thing that I don&#39;t understand is when I run the script directly on the line command it&#39;s working but not with my program. I&#39;ve use your tips to debug and every ./lance not found is during if at the beginning (I add this part of code in the first post)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "edited": false, "score": 0, "creation_date": 1462365690, "post_id": 37024619, "comment_id": 61606077, "body": "@ArthurDessez: The error <code>.&#47;lance: [[: introuvable</code> does not mean &quot;<i>lance not found</i>&quot;, but in file <code>.&#47;lance</code> some <code>[[</code> was &quot;<i>not found</i>&quot;."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "edited": false, "score": 0, "creation_date": 1462365951, "post_id": 37024619, "comment_id": 61606282, "body": "@ArthurDessez: Make sure your script defines which shell it needs to run in.  If you want the script to run using bash, put this <code>#!&#47;bin&#47;bash</code> as 1st line in the script. <code>system()</code> uses <code>&#47;bin&#47;sh</code>, the login you might run your test from perhaps uses a different one. Also you want to check if <code>&#47;bin&#47;sh</code> is a link, and to what."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 0, "last_activity_date": 1462356490, "creation_date": 1462356490, "answer_id": 37024619, "question_id": 37023021, "link": "https://stackoverflow.com/questions/37023021/system-parameters-c/37024619#37024619", "title": "System() parameters C", "body": "<blockquote>\n  <p>./lance: syntax error at line 34 : '(' unexpected</p>\n</blockquote>\n\n<p>In script <code>lance</code> on line 34 there is an unexpected <code>(</code> character.</p>\n\n<p>To debug the script put this</p>\n\n<pre><code>set -x\n</code></pre>\n\n<p>as first statement into the script.</p>\n"}], "owner": {"reputation": 13, "user_id": 6289702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b268c47e1e4da40b7b5001121f5ace?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dessez", "link": "https://stackoverflow.com/users/6289702/arthur-dessez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 37024619, "answer_count": 2, "score": 1, "last_activity_date": 1462367860, "creation_date": 1462352384, "last_edit_date": 1462367860, "question_id": 37023021, "link": "https://stackoverflow.com/questions/37023021/system-parameters-c", "title": "System() parameters C", "body": "<p>I've a problem with the <code>system()</code> function.</p>\n\n<p>I want to create a little program which run a command <em>x</em> times.</p>\n\n<p>The following code is to launch a command :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[])\n{\n    char command[100];\n    strcpy(command, \"(time lance REF_CLIENT_FOUR002542_C FE-ERPCP-REF_CLIENT_FOUR.zip F &gt; result.txt) 2&gt; time.txt\");\n    system(command);\n    return 0;\n}\n</code></pre>\n\n<p>My command is working when I write it directly in my shell, but when I use this program I get this error: </p>\n\n<blockquote>\n<pre><code>./lance: [[: introuvable\n./lance: [[: introuvable\n./lance: [[: introuvable\n./lance: [[: introuvable\n./lance: erreur de syntaxe ligne 34: `(' inattendue\n</code></pre>\n</blockquote>\n\n<p>This error means: </p>\n\n<blockquote>\n  <p>./lance: <code>[[</code>: not found<br>\n  ./lance: syntax error at line 34 : '<code>(</code>' unexpected</p>\n</blockquote>\n\n<p>I guess that system try to execute my command like <code>time ./lance ...</code>, but I want to run this like a command not a program so time lance ...</p>\n\n<p>I've already tried to run this program without the loop, still the same.</p>\n\n<p>I've also tried a simpler command like <code>ls -l</code>; that's working.</p>\n\n<p>If anyone can help me, I'll be very thankful!</p>\n\n<p>Edit : My purpose is to run a script many time to have data about execution's time, that's why I wrote this program.</p>\n\n<p>Edit2: This is a part of my script \"lance\" :</p>\n\n<pre><code>if [[ $# -ne 3 ]] # 1st not found\n then\n   echo \"bla\"\n   exit 1\nfi\n\nif [[ ! -f ${1} ]] # 2nd not found\nthen\n   echo \"bla\"\n   exit 1\nfi\n\nif [[ ! -f ${2} ]] # 3rd not found\nthen\n  echo \"bla\"\n  exit 1\nfi\n\nif [[ \"${3}\" != \"F\" &amp;&amp;  \"${3}\" != \"Z\" ]] #4th not found\nthen\n   echo \"bla\"\n   exit 1\nfi\n\nif [[ -d TRAVAIL ]] # This is the line 34\nthen\n  mv TRAVAIL TRAVAIL_$(date +%d%m%y%H%M%S)\nfi\n</code></pre>\n\n<p>Edit3 : Thanks for alk who help me to find what was wrong is my code, I've added #!/bin/bash in the 1st line of my script and now it's working.</p>\n"}, {"tags": ["c", "memory-management", "valgrind"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 3, "creation_date": 1462351988, "post_id": 37022796, "comment_id": 61596266, "body": "<i>Please</i> consider writing this without using heap-allocated memory. I would never expect such a function to require heap allocations. Just use <code>strtoul()</code> to convert a number from each string and compare. Then skip the dots, and loop."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1462352052, "post_id": 37022796, "comment_id": 61596295, "body": "Also note that the pattern <code>p = realloc(p, ...)</code> is a bug.  You have to check the return value first.  But @unwind is right: this function should not allocate dynamic memory at all."}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1462352388, "post_id": 37022796, "comment_id": 61596507, "body": "@unwind: that is a valid point actually. I wasn&#39;t aware of <code>strtoul()</code>. I will try to use it afterwards then but can we discuss the example I have given here?"}], "answers": [{"comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "reply_to_user": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "edited": false, "score": 0, "creation_date": 1465824437, "post_id": 37786808, "comment_id": 63048147, "body": "Thanks for spotting and correcting the error in my answer!"}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1465822701, "last_edit_date": 1465822701, "creation_date": 1465812011, "answer_id": 37786808, "question_id": 37022796, "link": "https://stackoverflow.com/questions/37022796/why-would-valgrind-complain-about-invalid-read-and-writes-of-size-1-on-reusing-a/37786808#37786808", "title": "Why would valgrind complain about invalid read and writes of size 1 on reusing allocated memory?", "body": "<p>Valgrind says it all - I'll just look at the initial error:</p>\n\n<pre>\n==24039== Invalid write of size 1\n==24039==    at 0x4A07E83: strncat (mc_replace_strmem.c:304)\n==24039==    by 0x400828: compare_versions (main.c:46)\n==24039==    by 0x400986: main (main.c:94)\n==24039==  Address 0x4c330e9 is 0 bytes after a block of size 9 alloc'd\n==24039==    at 0x4A06C20: realloc (vg_replace_malloc.c:662)\n==24039==    by 0x4007F1: compare_versions (main.c:43)\n==24039==    by 0x400986: main (main.c:94)\n</pre>\n\n<p>The line <code>compare_versions (main.c:46)</code> is:</p>\n\n<pre><code>    strncat(first_c, first + first_last_dot1, first_last_dot2);\n</code></pre>\n\n<p>The line <code>compare_versions (main.c:43)</code> is:</p>\n\n<pre><code>      first_c = (char*)realloc(first_c, first_last_dot2 + 1);\n</code></pre>\n\n<p>The error occurs in the third loop cycle. <code>first_last_dot2</code> has been set in the second loop cycle in the line</p>\n\n<pre><code>    first_last_dot2 = strcspn(first + first_last_dot1, \".\");\n</code></pre>\n\n<p>to the value <em>1</em> (the length of the version string's last part, which is <code>2</code>); previously <code>first_last_dot2</code> had been set in the second loop cycle to the value <em>8</em> (the length of the version string's middle part, which is <code>12345678</code>), and so the <code>realloc</code> allocated size <em>8 + 1 = 9</em>. Since now the <code>if</code> condition <code>(first_last_dot2 &gt; first_max)</code> is not true, the <code>realloc</code> as well as the</p>\n\n<pre><code>      memset(first_c, 0, first_last_dot2);\n</code></pre>\n\n<p>are skipped; because of not executing the latter, <code>first_c</code> still contains <code>12345678</code> and the <code>strncat</code> appends <code>2</code> to it, writing the terminating null byte to <code>first_c</code>[9], which <em>is 0 bytes after a block of size 9 alloc'd</em>.<br>\nIf you move the two <code>memset</code>s (also the one for <code>second_c</code>) after the <code>if</code> blocks, there's no error.</p>\n"}], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 37786808, "answer_count": 1, "score": 1, "last_activity_date": 1465822701, "creation_date": 1462351863, "question_id": 37022796, "link": "https://stackoverflow.com/questions/37022796/why-would-valgrind-complain-about-invalid-read-and-writes-of-size-1-on-reusing-a", "title": "Why would valgrind complain about invalid read and writes of size 1 on reusing allocated memory?", "body": "<p>I have written a function to compare version c strings like <code>\"1.2.3\"</code>, <code>\"1.123.9\"</code> etc.</p>\n\n<pre><code>int compare_versions(char* first, char* second)\n{\n  size_t first_last_dot1 = 0;\n  size_t first_last_dot2 = strcspn(first, \".\");\n  size_t second_last_dot1 = 0;\n  size_t second_last_dot2 = strcspn(second, \".\");\n\n  while(first_last_dot2 || second_last_dot2)\n  {\n    if(first_last_dot2 &amp;&amp; !second_last_dot2) return 1;\n    if(!first_last_dot2 &amp;&amp; second_last_dot2) return -1;\n\n    char* first_c = (char*)calloc(first_last_dot2 + 1, sizeof(char));\n    strncat(first_c, first + first_last_dot1, first_last_dot2);\n    int first_n = atoi(first_c);\n    first_last_dot1 += first_last_dot2 + 1;\n    first_last_dot2 = strcspn(first + first_last_dot1, \".\");\n    free(first_c);\n\n    char* second_c = (char*)calloc(second_last_dot2 + 1, sizeof(char));\n    strncat(second_c, second + second_last_dot1, second_last_dot2);\n    int second_n = atoi(second_c);\n    second_last_dot1 += second_last_dot2 + 1;\n    second_last_dot2 = strcspn(second + second_last_dot1, \".\");\n    free(second_c);\n\n    if (first_n != second_n)\n    {\n      if(first_n &lt; second_n) return -1;\n      return 1;\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>and valgrind wouldn't complain at all for my 'tests':</p>\n\n<pre><code>assert(0 == compare_versions(\"1.12345678.2\", \"1.12345678.2\"));\n</code></pre>\n\n<p>valgrind output:</p>\n\n<pre><code>==24002== Memcheck, a memory error detector\n==24002== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.\n==24002== Using Valgrind-3.8.1 and LibVEX; rerun with -h for copyright info\n==24002== Command: ./a.out\n==24002== \n==24002== \n==24002== HEAP SUMMARY:\n==24002==     in use at exit: 0 bytes in 0 blocks\n==24002==   total heap usage: 10 allocs, 10 frees, 48 bytes allocated\n==24002== \n==24002== All heap blocks were freed -- no leaks are possible\n==24002== \n==24002== For counts of detected and suppressed errors, rerun with: -v\n==24002== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 6)\n</code></pre>\n\n<p>Now I wanted to reuse the allocated memory, namely: when I allocate a memory block of size 4 I can reuse it for all c strings of size up to 4 ( including the terminating null character). </p>\n\n<p>So I wrote this version of the very same function:</p>\n\n<pre><code>int compare_versions(char* first, char* second)\n{\n  size_t first_last_dot1 = 0;\n  size_t first_last_dot2 = strcspn(first, \".\");\n  size_t second_last_dot1 = 0;\n  size_t second_last_dot2 = strcspn(second, \".\");\n\n  char* first_c = (char*)calloc(first_last_dot2 + 1, sizeof(char));\n  char* second_c = (char*)calloc(second_last_dot2 + 1, sizeof(char));\n  int first_max = first_last_dot2;\n  int second_max = second_last_dot2;\n\n  while(first_last_dot2 || second_last_dot2)\n  {\n    // first longer than second ( different only by last segment )\n    if(first_last_dot2 &amp;&amp; !second_last_dot2) {\n      free(first_c);\n      free(second_c);\n      return 1;\n    }\n    // second longer than first ( different only by last segment )\n    if(!first_last_dot2 &amp;&amp; second_last_dot2) {\n      free(first_c);\n      free(second_c);\n      return -1;\n    }\n\n    if(first_last_dot2 &gt; first_max) {\n      first_max = first_last_dot2;\n      first_c = (char*)realloc(first_c, first_last_dot2 + 1);\n      memset(first_c, 0, first_last_dot2);\n    }\n    strncat(first_c, first + first_last_dot1, first_last_dot2);\n    int first_n = atoi(first_c);\n    first_last_dot1 += first_last_dot2 + 1;\n    first_last_dot2 = strcspn(first + first_last_dot1, \".\");\n\n    if(second_last_dot2 &gt; second_max) {\n      second_max = second_last_dot2;\n      second_c = (char*)realloc(second_c, second_last_dot2 + 1);\n      memset(second_c, 0, second_last_dot2);\n    }\n    strncat(second_c, second + second_last_dot1, second_last_dot2);\n    int second_n = atoi(second_c);\n    second_last_dot1 += second_last_dot2 + 1;\n    second_last_dot2 = strcspn(second + second_last_dot1, \".\");\n\n    if (first_n != second_n)\n    {\n      free(first_c);\n      free(second_c);\n      if(first_n &lt; second_n) return -1;\n      return 1;\n    }\n  }\n\n  free(first_c);\n  free(second_c);\n  return 0;                                                                                                                                                                                                                                                                       \n}\n</code></pre>\n\n<p>but then I will get the following output from valgrind:</p>\n\n<pre><code>==24039== Memcheck, a memory error detector\n==24039== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.\n==24039== Using Valgrind-3.8.1 and LibVEX; rerun with -h for copyright info\n==24039== Command: ./a.out\n==24039== \n==24039== Invalid write of size 1\n==24039==    at 0x4A07E83: strncat (mc_replace_strmem.c:304)\n==24039==    by 0x400828: compare_versions (main.c:46)\n==24039==    by 0x400986: main (main.c:94)\n==24039==  Address 0x4c330e9 is 0 bytes after a block of size 9 alloc'd\n==24039==    at 0x4A06C20: realloc (vg_replace_malloc.c:662)\n==24039==    by 0x4007F1: compare_versions (main.c:43)\n==24039==    by 0x400986: main (main.c:94)\n==24039== \n==24039== Invalid read of size 1\n==24039==    at 0x39AA436FF3: ____strtol_l_internal (strtol_l.c:438)\n==24039==    by 0x39AA433C5F: atoi (atoi.c:28)\n==24039==    by 0x400834: compare_versions (main.c:47)\n==24039==    by 0x400986: main (main.c:94)\n==24039==  Address 0x4c330e9 is 0 bytes after a block of size 9 alloc'd\n==24039==    at 0x4A06C20: realloc (vg_replace_malloc.c:662)\n==24039==    by 0x4007F1: compare_versions (main.c:43)\n==24039==    by 0x400986: main (main.c:94)\n==24039== \n...\n==24039== \n==24039== HEAP SUMMARY:\n==24039==     in use at exit: 0 bytes in 0 blocks\n==24039==   total heap usage: 4 allocs, 4 frees, 22 bytes allocated\n==24039== \n==24039== All heap blocks were freed -- no leaks are possible\n==24039== \n==24039== For counts of detected and suppressed errors, rerun with: -v\n==24039== ERROR SUMMARY: 34 errors from 8 contexts (suppressed: 6 from 6)\n</code></pre>\n\n<p>What is the problem here?</p>\n"}, {"tags": ["c", "newline", "carriage-return"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462352926, "post_id": 37022778, "comment_id": 61596868, "body": "C is not guaranteed to use ASCII."}, {"owner": {"reputation": 3642, "user_id": 3371101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeb77c0b3ce0a8041fa92a4fcd5af850?s=128&d=identicon&r=PG&f=1", "display_name": "codingEnthusiast", "link": "https://stackoverflow.com/users/3371101/codingenthusiast"}, "edited": false, "score": 0, "creation_date": 1462352951, "post_id": 37022778, "comment_id": 61596885, "body": "Short answer is: Use <code>\\n</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1462353535, "post_id": 37022778, "comment_id": 61597324, "body": "The value of the line feed character is 10, rather. So your question doesn&#39;t make much sense."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "edited": false, "score": 0, "creation_date": 1462352073, "post_id": 37022823, "comment_id": 61596307, "body": "by external reference , do you mean the ascii table ?"}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1462351920, "creation_date": 1462351920, "answer_id": 37022823, "question_id": 37022778, "link": "https://stackoverflow.com/questions/37022778/difference-between-n-and-cr/37022823#37022823", "title": "Difference between \\n and CR", "body": "<p>You can use either one, but you definitely should use <code>\\n</code> because people can read it without an external reference.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 5875199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IJQD6ihKMiM/AAAAAAAAAAI/AAAAAAAAAEQ/U86gKzH_bIM/photo.jpg?sz=128", "display_name": "Cristinadeveloper", "link": "https://stackoverflow.com/users/5875199/cristinadeveloper"}, "is_accepted": false, "score": 0, "last_activity_date": 1462352447, "creation_date": 1462352447, "answer_id": 37023045, "question_id": 37022778, "link": "https://stackoverflow.com/questions/37022778/difference-between-n-and-cr/37023045#37023045", "title": "Difference between \\n and CR", "body": "<p>I think both values are the same, but for making a more readable code you should use \"\\n\", or use comments in the other case to explain what are you expecting by keyboard.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 4, "last_activity_date": 1462365175, "last_edit_date": 1462365175, "creation_date": 1462352840, "answer_id": 37023184, "question_id": 37022778, "link": "https://stackoverflow.com/questions/37022778/difference-between-n-and-cr/37023184#37023184", "title": "Difference between \\n and CR", "body": "<p>Short answer: you should always use <code>'\\n'</code>.</p>\n\n<p>Longer answer: Yes, Carriage Return is ASCII 13 is <code>'\\r'</code> in C.\nNewline is ASCII 10 (not 13) and is <code>'\\n'</code> in C.</p>\n\n<p>But the key you press is <em>not</em> necessarily the same as the character you'll receive in a C program, for two reasons:</p>\n\n<ol>\n<li>The operating system may map things.  For example, under Unix and Linux, in the normal (\"cooked\") mode of the terminal driver, the Return key maps to (sends) a Linefeed.</li>\n<li>In C, the preferred character for \"the new line\" is always <code>'\\n'</code>.  Even if the underlying operating system has different conventions, under normal circumstances your program is supposed to receive a <code>'\\n'</code> for a new line.  (Similarly, when you print a <code>'\\n'</code>, it gets translated to carriage return, linefeed, or a carriage return / linefeed pair, depending on your OS's conventions.)</li>\n</ol>\n\n<p>Finally, whatever you do, even if you do need to handle Carriage Returns explicitly, please use <code>'\\r'</code> and <code>'\\n'</code> in C programs.  Don't make your readers know what the magic numbers 10 and 13 (or 0x0a and 0x0d) are.</p>\n"}], "owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1846, "favorite_count": 2, "accepted_answer_id": 37023184, "answer_count": 3, "score": -1, "last_activity_date": 1462365175, "creation_date": 1462351821, "last_edit_date": 1462352613, "question_id": 37022778, "link": "https://stackoverflow.com/questions/37022778/difference-between-n-and-cr", "title": "Difference between \\n and CR", "body": "<p>According to the ASCII table, value of the new line character(\\n) is 13 whereas value of Carriage Return (CR) is 13 . When trying to write a program that detects if enter key is pressed. \u0131s it safe to use the either value  ?</p>\n\n<pre><code> if( ( kr=getchar() ) == 13 )\n\n     puts(\"Enter Key Pressed \") ;\n</code></pre>\n\n<p>or</p>\n\n<pre><code> if( ( kr=getchar() ) == '\\n' )\n\n     puts(\"Enter Key Pressed \") ;\n</code></pre>\n"}, {"tags": ["c", "global", "pi"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1462351772, "post_id": 37022707, "comment_id": 61596125, "body": "Global variables are initialized to zero by default."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3576734"}, "is_accepted": true, "score": 0, "last_activity_date": 1462351882, "last_edit_date": 1495541982, "creation_date": 1462351882, "answer_id": 37022807, "question_id": 37022707, "link": "https://stackoverflow.com/questions/37022707/how-can-we-be-sure-that-value-of-b-is-0-at-beginning-in-this-code/37022807#37022807", "title": "How can we be sure that value of &#39;b&#39; is 0 at beginning in this code", "body": "<p>As pointed out in <a href=\"https://stackoverflow.com/questions/3553559/how-are-local-and-global-variables-initialized-by-default\">this</a> question, global variables are initialized to <code>0</code> by default.  </p>\n\n<p>In your code, <code>b</code> is declared as a global variable.</p>\n"}], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1462351865, "accepted_answer_id": 37022807, "answer_count": 1, "score": 0, "last_activity_date": 1462352137, "creation_date": 1462351594, "last_edit_date": 1462352137, "question_id": 37022707, "link": "https://stackoverflow.com/questions/37022707/how-can-we-be-sure-that-value-of-b-is-0-at-beginning-in-this-code", "closed_reason": "Duplicate", "title": "How can we be sure that value of &#39;b&#39; is 0 at beginning in this code", "body": "<p>This is a program which I came across on the net that calculates the value of <code>\ud835\udf45</code>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nlong a=10000,b,c=2800,d,e,f[2801],g;//--------HERE the value of b---------//\n\nint main()\n{\n    printf(\"\\nValue of b: %ld\", b);\n    getch();\n    for(;b-c;)\n        f[b++]=a/5;\n    for(;d=0,g=c*2;c-=14,printf(\"%.4d\",e+d/a),e=d%a)\n        for(b=c;d+=f[b]*a,f[b]=d%--g,d/=g--,--b;d*=b);\n}\n</code></pre>\n\n<p>The calculated value is correct. But how could the programmer be sure that the initial value of <code>b</code> would be <code>0</code>?</p>\n\n<p>It does not seem to be initialized at all!</p>\n\n<p>Is there some specialty about initial value of global variables?</p>\n"}, {"tags": ["c", "struct", "pipe", "fork", "exec"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462351204, "post_id": 37022510, "comment_id": 61595787, "body": "Why are you <i>writing</i> to standard <i>input</i>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462351314, "post_id": 37022510, "comment_id": 61595843, "body": "Also, you really should check for errors from all system calls."}, {"owner": {"reputation": 814, "user_id": 5941260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NBrFP.jpg?s=128&g=1", "display_name": "micharaze", "link": "https://stackoverflow.com/users/5941260/micharaze"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462351337, "post_id": 37022510, "comment_id": 61595866, "body": "Cause of the pipe. My professor tells me to do it like this."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462351421, "post_id": 37022510, "comment_id": 61595914, "body": "In the child process the write-end of the pipe is connected to standard <i>output</i> (<code>STDOUT_FILENO</code>). You should never write to an input file descriptor, or read from an output descriptor. If your professor told you to write to <code>STDIN_FILENO</code> then the professor was wrong."}, {"owner": {"reputation": 814, "user_id": 5941260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NBrFP.jpg?s=128&g=1", "display_name": "micharaze", "link": "https://stackoverflow.com/users/5941260/micharaze"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1462351549, "post_id": 37022510, "comment_id": 61595991, "body": "Thanks. It works now."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 0, "last_activity_date": 1465815091, "last_edit_date": 1495541305, "creation_date": 1465815091, "answer_id": 37787861, "question_id": 37022510, "link": "https://stackoverflow.com/questions/37022510/pipe-send-struct-from-child-to-parent-hieroglyph-in-read/37787861#37787861", "title": "pipe() send struct from child to parent. Hieroglyph in read();", "body": "<p>I was writen in child (sohn.c) to the <em>standard input</em>, but it mus wirte to the output. Thanks to <a href=\"https://stackoverflow.com/users/440558/joachim-pileborg\">Joachim Pileborg</a></p>\n\n<p>\u2013 Raze</p>\n"}], "owner": {"reputation": 814, "user_id": 5941260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NBrFP.jpg?s=128&g=1", "display_name": "micharaze", "link": "https://stackoverflow.com/users/5941260/micharaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37787861, "answer_count": 1, "score": 0, "last_activity_date": 1465815091, "creation_date": 1462351039, "last_edit_date": 1495542780, "question_id": 37022510, "link": "https://stackoverflow.com/questions/37022510/pipe-send-struct-from-child-to-parent-hieroglyph-in-read", "title": "pipe() send struct from child to parent. Hieroglyph in read();", "body": "<p>I want to send measured data via a struct from the child process to the Parent. The parent process have to print the average of 10 measured data's.</p>\n\n<p><strong>The struct data in funcs.h:</strong></p>\n\n<pre><code>struct data{\nint nr;\nfloat temp;\nfloat bst;\nfloat abst;\n};\n</code></pre>\n\n<p><strong>uebung2_1.c (main):</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include \"funcs.h\"\n\n#define READ_END 0\n#define WRITE_END 1\n#define CHILD \"./sohn\"\n\nint main(){\n    int w_status, pid_fork, i, k;\n    double midT, midB, midA;\n    int pfd[2];\n    struct data buf;\n\n    if(pipe(pfd) == -1){\n        perror(\"ERROR creating a pipe\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    pid_fork = fork();\n    switch(pid_fork){\n        case(-1):\n            perror(\"fork()\");\n            return EXIT_FAILURE;\n        case(0):\n            dup2(pfd[WRITE_END], STDOUT_FILENO);\n            close(pfd[READ_END]);\n            execlp(CHILD,CHILD,NULL);\n            perror(\"exec is failed\");\n            break;\n        default:\n            close(pfd[WRITE_END]);\n            printf(\"Sohn gestartet mit PID %d\\n\", pid_fork);\n            midT = midB = midA = 0;\n            i = k = 0;\n            while(1){\n                read(pfd[READ_END],&amp;buf,sizeof(struct data));\n                midT += buf.temp;\n                midB += buf.bst;\n                midA += buf.abst;\n                i++;\n                if(i == 10){\n                    midT /=10;\n                    midB /=10;\n                    midA /=10;\n                    printf(\"Messung. %4i: Temp.: %4.1lf, Beleucht.: %4lf, Abstand: %3.1lf\\n\",k++, midT, midB, midA);\n                    midT = midB = midA = 0;\n                    i = 0;\n                }\n            }\n            while(i != -1){\n                i = wait(&amp;w_status);\n                if(i != -1)\n                    printf(\"\\nSohn beendet. Exit Status: %x Nummer des Sohn-Prozesses %d\",\n                        (w_status&gt;&gt;8) &amp; 0xff, i);\n                    else\n                        printf(\"\\nLetzter Sohn beendet!\\n\");\n            }\n        }\n    return 0;\n}\n</code></pre>\n\n<p>The child sohn process send measured data every 500ns via an linux interrupt. I tested it first with a char array and it was successful.</p>\n\n<p><strong>sohn.c:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n#include \"funcs.h\"\n\n#define INTERVAL 500000\n\nint howmany = 0;\n\nvoid alarm_wakeup (int i)\n{\n    struct itimerval tout_val;\n    howmany += INTERVAL;\n    tout_val.it_interval.tv_sec = 0;\n    tout_val.it_interval.tv_usec = 0;\n    tout_val.it_value.tv_sec = 0;\n    tout_val.it_value.tv_usec = INTERVAL;\n    setitimer(ITIMER_REAL, &amp;tout_val,0);\n}\n\nvoid exit_func (int i)\n{\n    signal(SIGINT,exit_func);\n    exit(0);\n}\n\n\n\nint main(){\n\n    struct data mess;\n    struct itimerval tout_val;\n    tout_val.it_interval.tv_sec = 0;\n    tout_val.it_interval.tv_usec = 0;\n    tout_val.it_value.tv_sec = 0;\n    tout_val.it_value.tv_usec = INTERVAL;\n    setitimer(ITIMER_REAL, &amp;tout_val,0);\n    signal(SIGALRM,alarm_wakeup);\n    signal(SIGINT,exit_func);\n\n    srand(time(0));\n    mess.nr = 0;\n    while (1) {\n        mess.nr++;\n        mess.temp = (rand()%1001)/10 - 20;\n        mess.bst = rand()%1000 + 1;\n        mess.abst = rand()%26 + 4;\n        write(STDIN_FILENO,&amp;mess, sizeof(struct data));\n        sleep(10);\n    }\n\n    exit(0);\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Sohn gestartet mit PID 3488\n\ufffdBhB\ufffdA@\ufffd\ufffd@\ufffdA\ufffdB\ufffd!DA@ATCpA\ufffdB@D A4B\ufffdC\ufffdA0A@#D0dB\ufffdsDA        4B\ufffd\ufffdCpA\n\ufffd\ufffd\\D\ufffdA^C\n</code></pre>\n\n<p><strong>Output with strace:</strong></p>\n\n<pre><code>strace ./uebung2_1 \nexecve(\"./uebung2_1\", [\"./uebung2_1\"], [/* 78 vars */]) = 0\nbrk(0)                                  = 0x8320000\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nmmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7791000\naccess(\"/etc/ld.so.preload\", R_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3\nfstat64(3, {st_mode=S_IFREG|0644, st_size=109872, ...}) = 0\nmmap2(NULL, 109872, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb7776000\nclose(3)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/i386-linux-gnu/libc.so.6\", O_RDONLY|O_CLOEXEC) = 3\nread(3, \"\\177ELF\\1\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0\\3\\0\\1\\0\\0\\0\\340\\233\\1\\0004\\0\\0\\0\"..., 512) = 512\nfstat64(3, {st_mode=S_IFREG|0755, st_size=1754876, ...}) = 0\nmmap2(NULL, 1759868, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb75c8000\nmmap2(0xb7770000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1a8000) = 0xb7770000\nmmap2(0xb7773000, 10876, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7773000\nclose(3)                                = 0\nmmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb75c7000\nset_thread_area({entry_number:-1 -&gt; 6, base_addr:0xb75c7940, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0\nmprotect(0xb7770000, 8192, PROT_READ)   = 0\nmprotect(0x8049000, 4096, PROT_READ)    = 0\nmprotect(0xb77b7000, 4096, PROT_READ)   = 0\nmunmap(0xb7776000, 109872)              = 0\npipe([3, 4])                            = 0\nclone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb75c79a8) = 3436\nclose(4)                                = 0\nfstat64(1, {st_mode=S_IFCHR|0600, st_rdev=makedev(136, 8), ...}) = 0\nmmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7790000\nwrite(1, \"Sohn gestartet mit PID 3436\\n\", 28Sohn gestartet mit PID 3436\n) = 28\nread(3, \ufffdB\ufffdC\ufffdA@A4D\ufffd@\n                    B\ufffdD@AHB\ufffdnD\ufffdA\ufffdA\ufffdC\ufffdB\ufffdC`ApB\ufffd\u2592D\ufffd\ufffdA'C@A  ,B\ufffd\ufffdC\ufffdA\n\ufffd\ufffd\ufffdC\ufffdA\n      \ufffdB$D\ufffdA\nPA\ufffdC\ufffdAB\ufffdLD\ufffdA&lt;B\ufffd\ufffdCA\ufffd\ufffd@D ApA@gD\ufffdA\ufffdAD@A^CProcess 3435 detached\n &lt;detached ...&gt;\n</code></pre>\n\n<p>I killed the process with ctrl+c. Why the hieroglyph? </p>\n\n<p><strong>---------------------------------------------------------------------------</strong></p>\n\n<p><strong>Update:</strong>\nI was writen in child (sohn.c) to the <em>standard input</em>, but it mus wirte to the output. Thanks to <a href=\"https://stackoverflow.com/users/440558/joachim-pileborg\">Joachim Pileborg</a></p>\n"}, {"tags": ["c", "linux", "directory", "copy"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462350806, "post_id": 37022401, "comment_id": 61595539, "body": "Have you considered using a debugger ? Or doing even basic printf debugging ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462350887, "post_id": 37022401, "comment_id": 61595588, "body": "and what about checking the return value of <code>mkdir</code> ? What would happen if the directory could not be created for some reason ?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462350997, "post_id": 37022401, "comment_id": 61595664, "body": "What is the point of opening <code>av[2]</code> and <code>newdir&#47;av[2]</code>? What does your program prints on terminal?"}, {"owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "edited": false, "score": 0, "creation_date": 1462359978, "post_id": 37022401, "comment_id": 61601957, "body": "I am trying to make a directory with the copied file in that directory. the terminal prints out: &quot;Press any key to exit...&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "edited": false, "score": 0, "creation_date": 1462360668, "post_id": 37022608, "comment_id": 61602451, "body": "thank you for telling me the problem. I fixed it now."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 3, "last_activity_date": 1462351337, "creation_date": 1462351337, "answer_id": 37022608, "question_id": 37022401, "link": "https://stackoverflow.com/questions/37022401/making-a-new-directory-for-my-copied-file-in-c/37022608#37022608", "title": "making a new directory for my copied file in C", "body": "<blockquote>\n  <p>I can successfully make a new directory for my copied file. [...] but not successful in copying the file into a new directory or different</p>\n</blockquote>\n\n<p>The problem may come from the directory creation:</p>\n\n<p>If you call you program with: <code>./a.out foo bar</code></p>\n\n<pre><code>snprintf(serv_name, sizeof(serv_name), \"newdir/%s\", av[2]);\nFILE* f = fopen(serv_name, \"w\");\n</code></pre>\n\n<p>Your program will try to open <code>newdir/bar</code>: OK </p>\n\n<p>If you call you program with: <code>./a.out foo /path/to/bar</code></p>\n\n<pre><code>snprintf(serv_name, sizeof(serv_name), \"newdir/%s\", av[2]);\nFILE* f = fopen(serv_name, \"w\");\n</code></pre>\n\n<p>Your program will try to open <code>newdir//path/to/bar</code>: That will certainly fail.</p>\n\n<p>So your problem comes from: </p>\n\n<pre><code>snprintf(serv_name, sizeof(serv_name), \"newdir/%s\", av[2]);\nFILE* f = fopen(serv_name, \"w\");\nif (f &lt; 0) {\n    perror(\"CLIENT:\\n\");\n    exit(1);\n} \n</code></pre>\n\n<p>You cannot open <code>f</code> if the tree directory is not correct.</p>\n"}], "owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462361959, "creation_date": 1462350679, "last_edit_date": 1462361959, "question_id": 37022401, "link": "https://stackoverflow.com/questions/37022401/making-a-new-directory-for-my-copied-file-in-c", "title": "making a new directory for my copied file in C", "body": "<p>I want to have a successful copy file program, where I can have the result: ./a.out 1.c examples3/16.c to be successful, where I can successfully make a new directory for my copied file. How can you do this, because I get errors trying to do it. I can copy the 1.c file successfully in one place, and I can copy the file into an existing directory but not successful in copying the file into a newly made directory. How can you do this and fix this problem? </p>\n\n<p>code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define BUFFERSIZE      4096\n#define COPYMODE        0644\nint file_exist (char *filename)\n{\n struct stat   buffer;   \n return (stat (filename, &amp;buffer) == 0);\n}\n\nint main(int ac, char *av[])\n{\nint ch;  //ch - character no.                               \nstruct stat sb;\nchar directory[120];\nFILE *source, *target;\n/* from http://stackoverflow.com/questions/30215462/how-to-get-the-source-files-the-file-which-i-want-to-copy-and-the-copied-file/30217023#30217023 */\nif (ac &lt;= 2) {\n    printf(\"Enter source and destination file names\\n\");\n    exit(EXIT_FAILURE);\n}\n\nif ( strcmp(av[1], av[2]) ==0 )\n{\n    printf(\"the files are the same\\n\");\n    exit(1);\n}\n\nif (file_exist (av[2]))\n {\n  printf (\"the destination file exists\\n\");\n  exit(1);\n }\n //printf(\"which directory do you want to send your destination file?\");\n //scanf(\"%s\", directory);\n\n char serv_name[1000];\n mkdir(\"newdir/\", S_IRWXU | S_IRWXG | S_IRWXO);\n snprintf(serv_name, sizeof(serv_name), \"newdir/%s\", av[2]);\n FILE* f = fopen(serv_name, \"w\");\n if (f &lt; 0) {\n    perror(\"CLIENT:\\n\");\n    exit(1);\n }  \n\n source = fopen(av[1], \"r\");//getting and opening source file\n if( source == NULL ) {\n    printf(\"Press any key to exit...\\n\");\n    exit(EXIT_FAILURE);\n }\n\n target = fopen(av[2], \"w\");//getting and opening destination file\n\n if( target == NULL ) {\n    fclose(source);\n    printf(\"Press any key to exit...\\n\");\n    exit(EXIT_FAILURE);\n }\n\n while( ( ch = fgetc(source) ) != EOF )\n    fputc(ch, target);\n\n fclose(source);\n fclose(target);\n printf(\"File copied successfully.\\n\");\n /* from http://stackoverflow.com/questions/30215462/how-to-get-the-source-files-the-file-which-i-want-to-copy-and-the-copied-file/30217023#30217023 */\n if (stat(av[1], &amp;sb) == -1) {\n    perror(\"stat\");\n    exit(1); //exit(EXIT_SUCCESS);\n  }\n  else\n  if (chmod(av[2], sb.st_mode &amp; 07777))//http://stackoverflow.com/questions/18032574/how-can-i-copy-permissions-from-a-file-that-already-exists\n  {\n    perror(\"chmod\");\n  }\n\n  printf(\"Source File: %s, Inode number: %d, Mode: 0x%04X\\n\", av[1],  (unsigned)sb.st_ino, (unsigned)sb.st_mode);\n\n  if (stat(av[2], &amp;sb) == -1) {\n    perror(\"stat\");\n    exit(1);\n  }\n\n  char *str;\n  str = (char *) malloc(15);\n  strcpy(str, av[2]);\n\n  if (stat(av[2], &amp;sb) == -1)    {//http://stackoverflow.com/questions/7430248/creating-a-new-directory-in-c\n    mkdir(av[2], 0700);\n   }\n  printf(\"Destination File: %s, inode number: %d, Address = %u, Mode: 0x%04X\\n\", av[2], (unsigned)sb.st_ino, str, (unsigned)sb.st_mode);\n\n   free(str);\n   return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "pointers", "lua", "ffi"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1462350557, "post_id": 37022341, "comment_id": 61595372, "body": "<code>void (*db_test)(void);</code> wrong prototype, should be <code>void (*db_test)(struct db *);</code>"}, {"owner": {"reputation": 8498, "user_id": 1045850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/350cc803b2250b2680f457717d7af525?s=128&d=identicon&r=PG", "display_name": "nogard", "link": "https://stackoverflow.com/users/1045850/nogard"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462350685, "post_id": 37022341, "comment_id": 61595457, "body": "no, it&#39;s not wrong. db_test is different function pointer, it does not have any args. It&#39;s not relevant to the question anyway"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462350912, "post_id": 37022341, "comment_id": 61595605, "body": "Ah, then why are you showing this one?"}, {"owner": {"reputation": 8498, "user_id": 1045850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/350cc803b2250b2680f457717d7af525?s=128&d=identicon&r=PG", "display_name": "nogard", "link": "https://stackoverflow.com/users/1045850/nogard"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462351007, "post_id": 37022341, "comment_id": 61595672, "body": "Just to show that I can easily call <i>free</i> function pointers, but not the nested one (that belongs to struct)"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462351216, "post_id": 37022341, "comment_id": 61595794, "body": "Are you assigning some function to <code>test</code> before calling it? <code>db.test = somefunction</code>"}, {"owner": {"reputation": 8498, "user_id": 1045850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/350cc803b2250b2680f457717d7af525?s=128&d=identicon&r=PG", "display_name": "nogard", "link": "https://stackoverflow.com/users/1045850/nogard"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1462351358, "post_id": 37022341, "comment_id": 61595881, "body": "It&#39;s C code that assigns some function to the function pointer, in the get_db() function. I&#39;ll update my post to clarify this"}, {"owner": {"reputation": 3618, "user_id": 282536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881c58b5fb48ce1b9889bbd5687ae96b?s=128&d=identicon&r=PG", "display_name": "daurnimator", "link": "https://stackoverflow.com/users/282536/daurnimator"}, "edited": false, "score": 0, "creation_date": 1462768043, "post_id": 37022341, "comment_id": 61757492, "body": "Sounds like a luajit ffi bug. please report at <a href=\"https://github.com/LuaJIT/LuaJIT/issues\" rel=\"nofollow noreferrer\">github.com/LuaJIT/LuaJIT/issues</a>"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 2037823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0528510ecbeacf22ab7597ac1c653b5e?s=128&d=identicon&r=PG", "display_name": "Trop_Wizz", "link": "https://stackoverflow.com/users/2037823/trop-wizz"}, "is_accepted": true, "score": 2, "last_activity_date": 1462895921, "last_edit_date": 1462895921, "creation_date": 1462893995, "answer_id": 37142865, "question_id": 37022341, "link": "https://stackoverflow.com/questions/37022341/calling-c-nested-function-pointer-from-lua/37142865#37142865", "title": "Calling C nested function pointer from Lua", "body": "<p>A solution seems to be pointed out in :\n<a href=\"http://lua-users.org/lists/lua-l/2015-07/msg00172.html\" rel=\"nofollow\">http://lua-users.org/lists/lua-l/2015-07/msg00172.html</a></p>\n\n<pre><code>ffi.cdef[[\n    typedef void (*test)(struct db *);\n]]\n\nlocal db = get_db()\nlocal call = ffi.cast(\"test\", db.test)\ncall(db)\n</code></pre>\n"}], "owner": {"reputation": 8498, "user_id": 1045850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/350cc803b2250b2680f457717d7af525?s=128&d=identicon&r=PG", "display_name": "nogard", "link": "https://stackoverflow.com/users/1045850/nogard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 37142865, "answer_count": 1, "score": 1, "last_activity_date": 1462895921, "creation_date": 1462350488, "last_edit_date": 1462726651, "question_id": 37022341, "link": "https://stackoverflow.com/questions/37022341/calling-c-nested-function-pointer-from-lua", "title": "Calling C nested function pointer from Lua", "body": "<p>I have the following C struct, that contains function pointer:</p>\n\n<pre><code>struct db {\n    struct db_impl *impl;\n    void (*test)(struct db *self); // How to invoke it from Lua??\n};\nvoid (*db_test)(void); // this I can invoke from Lua\n\nstruct db * get_db() {\n    // create and init db\n    struct db * db = init ...\n    db-&gt;test = &amp;db_real_impl; // db_real_impl is some C function\n    return db;\n}\n</code></pre>\n\n<p>So the test function pointer after initialization points to some function.\nNow I need to call that function from Lua using FFI library, but it fails with error: <code>'void' is not callable</code>.</p>\n\n<pre><code>local db = ffi.C.get_db()\ndb.test(db)  -- fails to invoke\n-- Error message: 'void' is not callable\n\nffi.C.db_test()  -- this works fine\n</code></pre>\n\n<p>In C the code would be:</p>\n\n<pre><code>struct db *db = get_db();\ndb-&gt;test(db);\n</code></pre>\n\n<p>In Lua I'm able to invoke free function pointers easily, but can't invoke function pointer from struct. How to invoke it from Lua?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462348839, "post_id": 37021783, "comment_id": 61594255, "body": "<code>(double*)out++;</code> should not work, anyway..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1462348885, "post_id": 37021783, "comment_id": 61594280, "body": "<i>the compilter doesn&#39;t like it</i>..please elaborate..."}, {"owner": {"reputation": 199, "user_id": 3087271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9213434e8605578867e9319976823448?s=128&d=identicon&r=PG&f=1", "display_name": "DayAndNight", "link": "https://stackoverflow.com/users/3087271/dayandnight"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1462349205, "post_id": 37021783, "comment_id": 61594486, "body": "((double*)out)++ gives &quot;lvalue required as increment operand&quot;"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1462349593, "post_id": 37021783, "comment_id": 61594728, "body": "The <i>compiler</i> doesn&#39;t like it? Heck, <i>I</i> don&#39;t like it! What would such code achieve?"}, {"owner": {"reputation": 199, "user_id": 3087271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9213434e8605578867e9319976823448?s=128&d=identicon&r=PG&f=1", "display_name": "DayAndNight", "link": "https://stackoverflow.com/users/3087271/dayandnight"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1462349929, "post_id": 37021783, "comment_id": 61594940, "body": "@KerrekSB : I&#39;m reading arrays of different types from a text file, thus I need to cast it and then move the pointer. E.g.            <i>(double</i>)out = atof((char*) charpointerfromfile); out = ((double*)out)+1;"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1462350364, "post_id": 37021783, "comment_id": 61595246, "body": "@DayAndNight: Yes, sure, but your proposed code doesn&#39;t achieve (or express) that. So the compiler is right to reject it, if for no other reason that to alert you to the fact that you have misstated your intention. Casts don&#39;t <i>change</i> an existing value; rather, they compute a <i>new</i> value (of a different type) that is the result of the cast expression."}, {"owner": {"reputation": 199, "user_id": 3087271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9213434e8605578867e9319976823448?s=128&d=identicon&r=PG&f=1", "display_name": "DayAndNight", "link": "https://stackoverflow.com/users/3087271/dayandnight"}, "edited": false, "score": 0, "creation_date": 1462350674, "post_id": 37021783, "comment_id": 61595452, "body": "Yes, thats why I posted the code that does exaclty what I want and asked how this could be done better. The accepted answer does exactly that. Thanks for the clarification though. (btw, the statement in my comment above should have some more stars in it, but I dont know what the escape character in this comment function is)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462350968, "post_id": 37021783, "comment_id": 61595641, "body": "Solution: don&#39;t write code as obscure as possible, but as readable as possible. Your original code was already far superior to <code>((double*)out)++;</code>. Merging everything into one single line will not give you better performance. It often creates subtle bugs though."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1462349054, "last_edit_date": 1495535331, "creation_date": 1462349054, "answer_id": 37021886, "question_id": 37021783, "link": "https://stackoverflow.com/questions/37021783/increment-casted-void-pointer-in-c/37021886#37021886", "title": "Increment casted void pointer in C", "body": "<p>The expression</p>\n\n<pre><code>((double*)out)++;\n</code></pre>\n\n<p>is problematic because it tries to increment the result of a cast, which is not an <a href=\"https://stackoverflow.com/a/3601661/335858\">lvalue</a>. However, it is perfectly fine to add <code>1</code> to the result of a cast, and assign it back to <code>out</code>:</p>\n\n<pre><code>out = ((double*)out)+1;\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 3087271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9213434e8605578867e9319976823448?s=128&d=identicon&r=PG&f=1", "display_name": "DayAndNight", "link": "https://stackoverflow.com/users/3087271/dayandnight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 1, "accepted_answer_id": 37021886, "answer_count": 1, "score": 3, "last_activity_date": 1462349054, "creation_date": 1462348734, "question_id": 37021783, "link": "https://stackoverflow.com/questions/37021783/increment-casted-void-pointer-in-c", "title": "Increment casted void pointer in C", "body": "<p>I have a function that takes a void pointer as argument. I would like to cast that pointer to a specific type (e.g. double) and then increment it. The code below does exactly what I want</p>\n\n<pre><code>function(void *out){\n  double *temp = (double*) out;\n  temp++;\n  out = temp;\n\n  /* do something with out here */\n}\n</code></pre>\n\n<p>However if I put everything in one expression like</p>\n\n<pre><code>(double*)out++;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>((double*)out)++;\n</code></pre>\n\n<p>the compilter doesn't like it. Is there a more elegant way to do this?</p>\n"}, {"tags": ["c", "struct", "void-pointers"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1462348749, "post_id": 37021707, "comment_id": 61594200, "body": "How is <code>HANDLE</code> defined?"}, {"owner": {"reputation": 1080, "user_id": 2703418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74877cfa0bb308d11f165a771a773ef0?s=128&d=identicon&r=PG&f=1", "display_name": "bzeaman", "link": "https://stackoverflow.com/users/2703418/bzeaman"}, "edited": false, "score": 0, "creation_date": 1462349088, "post_id": 37021707, "comment_id": 61594414, "body": "I&#39;d suggest creating specific functions for all the shapes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1788956"}, "edited": false, "score": 0, "creation_date": 1462350183, "post_id": 37021707, "comment_id": 61595126, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10319080/c-struct-to-void-pointer\">C struct to void* pointer</a>"}, {"owner": {"reputation": 348, "user_id": 4947646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/320cd2cf0199f26e85d79fd7705fb0c0?s=128&d=identicon&r=PG&f=1", "display_name": "fedi ", "link": "https://stackoverflow.com/users/4947646/fedi"}, "reply_to_user": {"reputation": 1080, "user_id": 2703418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74877cfa0bb308d11f165a771a773ef0?s=128&d=identicon&r=PG&f=1", "display_name": "bzeaman", "link": "https://stackoverflow.com/users/2703418/bzeaman"}, "edited": false, "score": 0, "creation_date": 1462353531, "post_id": 37021707, "comment_id": 61597321, "body": "@bzeaman  yes, indeed, in the initialization of a variable of type tCircle or tRectangle the attribute calcul wil point on different functions"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 4947646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/320cd2cf0199f26e85d79fd7705fb0c0?s=128&d=identicon&r=PG&f=1", "display_name": "fedi ", "link": "https://stackoverflow.com/users/4947646/fedi"}, "edited": false, "score": 0, "creation_date": 1462353783, "post_id": 37021994, "comment_id": 61597501, "body": "Good remark i updated the declaration of the structs."}], "tags": [], "owner": {"reputation": 94, "user_id": 6289397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LV1Bv.png?s=128&g=1", "display_name": "klyone", "link": "https://stackoverflow.com/users/6289397/klyone"}, "is_accepted": false, "score": 1, "last_activity_date": 1462357408, "last_edit_date": 1462357408, "creation_date": 1462349376, "answer_id": 37021994, "question_id": 37021707, "link": "https://stackoverflow.com/questions/37021707/declaring-struct-attribute-with-different-type/37021994#37021994", "title": "Declaring struct attribute with different type", "body": "<p>I do not understand well why you need the tCircle and tRectangle structures because they have the same fields. I suggest you use only one definition and initialize the function pointer to a different and specific method.</p>\n\n<pre><code>struct shape {\n    int size;\n    int x;\n    int y;\n\n    void (*calcul) (struct shape * shape);\n};\n</code></pre>\n\n<p>And then the specific functions:</p>\n\n<pre><code>void circle_calcul(struct shape * shape)\n{\n    ...\n}\n\nvoid rectangle_calcul(struct shape * shape)\n{\n    ...\n}\n</code></pre>\n\n<p>And finally:</p>\n\n<pre><code>struct shape circle;\nstruct shape rectangle;\n\ncircle.calcul = circle_calcul;\nrectangle.calcul = rectangle_calcul;\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 4947646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/320cd2cf0199f26e85d79fd7705fb0c0?s=128&d=identicon&r=PG&f=1", "display_name": "fedi ", "link": "https://stackoverflow.com/users/4947646/fedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1462357408, "creation_date": 1462348516, "last_edit_date": 1462353653, "question_id": 37021707, "link": "https://stackoverflow.com/questions/37021707/declaring-struct-attribute-with-different-type", "title": "Declaring struct attribute with different type", "body": "<p>I have a struct that contain an attribute that can take many types,\nI want ask about the most appropriate way to declare this attribute.</p>\n\n<p>Example:</p>\n\n<pre><code>struct \n{\nvoid* pShape; //poiter to the shape that will be casted on *tCircle or *tRectangle\nint type;//type of the shape\nint h;\nint l;\n}tImage;\n\nstruct{\nint size;\nint r;\nHANDLE calcul;\n}tCircle\n\nstruct{\nint size;\nint x;\nint y;\nHANDLE calcul;\n}tRectangle;\n</code></pre>\n\n<p>As you see here i'am using void* to declare a pointer to the shape and use type attribute to guess the type of the shape.</p>\n\n<p>this is my function for the calcuation of the size of the shape in an image </p>\n\n<pre><code>int Image_Get_ShapeSize(tImage Im)\n{\n switch (Im.type)\n {\n case CIRCLE:\n ((tCircle*)(Im.shape))-&gt;calcul();\n break;\n\n case RECTANGLE:\n ((tRectangle*)(Im.shape))-&gt;calcul();\n break;\n\n default:\n break;\n}\n}\n</code></pre>\n\n<p>what do you think about this is it a good method ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1462348692, "post_id": 37021677, "comment_id": 61594165, "body": "It doesn&#39;t look like you <i>initialised</i> a vector - you just <i>allocated</i> it. Its contents are undefined until you store something there. Trying to read these values prior to initialising them is UB."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1462348803, "post_id": 37021677, "comment_id": 61594234, "body": "Also, please take note of comments and suggestions on your previous questions - especially the advice that you typically need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you want people to help you."}, {"owner": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1462349019, "post_id": 37021677, "comment_id": 61594373, "body": "@PaulR - thanks. I found it very hard to provide a minimal example here since any part of the code could have been causing this behavior. I understand that I haven&#39;t initialized the vector now, but still curious as to why testFn is able to influence the default values."}], "answers": [{"comments": [{"owner": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "edited": false, "score": 1, "creation_date": 1462349203, "post_id": 37021897, "comment_id": 61594483, "body": "Okay, good to know this is expected behavior. I&#39;m used to C# and Java where these kinds of things never happen."}, {"owner": {"reputation": 46, "user_id": 6198961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3679930bab682a3b03d2f94ea5235b7?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Schlosser", "link": "https://stackoverflow.com/users/6198961/maximilian-schlosser"}, "reply_to_user": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "edited": false, "score": 1, "creation_date": 1462349680, "post_id": 37021897, "comment_id": 61594777, "body": "You could also use <code>calloc()</code>instead, i recommend reading the man pages for malloc and calloc first though."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1462349809, "post_id": 37021897, "comment_id": 61594856, "body": "<code>calloc()</code> just zeros out the memory which might work for integers or but not necessarily for floating point variables."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "reply_to_user": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "edited": false, "score": 0, "creation_date": 1462349868, "post_id": 37021897, "comment_id": 61594904, "body": "@RohitPandey: Then, welcome to C! In C, many things can happen (or not) that would never happen in C# and Java. That was actually one of the main motivations for creating these languages. You should really read up on &quot;undefined behaviour&quot; in C."}, {"owner": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "reply_to_user": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "edited": false, "score": 0, "creation_date": 1462350001, "post_id": 37021897, "comment_id": 61595005, "body": "@sleske: Thanks, will do. If you have any particular article in mind regarding the subject, let me know."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1462350126, "post_id": 37021897, "comment_id": 61595087, "body": "@alk: It may work for floating point, but it is not guaranteed by the C standard. I think it will (happen to) work on most common platforms, though."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "reply_to_user": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "edited": false, "score": 0, "creation_date": 1462350276, "post_id": 37021897, "comment_id": 61595190, "body": "@RohitPandey: There&#39;s a good blog article (three actually) on the LLVM blog: <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior</a>. The <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Wikipedia article</a> is also a good start."}, {"owner": {"reputation": 46, "user_id": 6198961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3679930bab682a3b03d2f94ea5235b7?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Schlosser", "link": "https://stackoverflow.com/users/6198961/maximilian-schlosser"}, "edited": false, "score": 0, "creation_date": 1462350614, "post_id": 37021897, "comment_id": 61595405, "body": "To clarify: The man page states <code>calloc()</code> will write zeros to the allocated <i>bits</i>. This means it will work for any type that defines zero to actually be zero (which <a href=\"https://en.wikipedia.org/wiki/IEEE_754-1985#Examples\" rel=\"nofollow noreferrer\">float</a> and int both do) - and that it&#39;s necessary to know what a byte full of zeros means for your data type."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "edited": false, "score": 1, "creation_date": 1462351060, "post_id": 37021897, "comment_id": 61595708, "body": "@MaximilianSchlosser: <i>nitpick mode on</i> According to the C standard, all bits zero is indeed 0 for <code>int</code> and <code>unsigned int</code>. There is no such guarantee for <code>float</code>. IEEE 754 does give that guarantee; however, the C standard does not say a <code>float</code> must be in IEEE 754 format (though many compilers use it)."}], "tags": [], "owner": {"reputation": 46, "user_id": 6198961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3679930bab682a3b03d2f94ea5235b7?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Schlosser", "link": "https://stackoverflow.com/users/6198961/maximilian-schlosser"}, "is_accepted": true, "score": 3, "last_activity_date": 1462350650, "last_edit_date": 1495542232, "creation_date": 1462349086, "answer_id": 37021897, "question_id": 37021677, "link": "https://stackoverflow.com/questions/37021677/c-unrelated-function-seems-to-affect-simple-array-initialization/37021897#37021897", "title": "C unrelated function seems to affect simple array initialization", "body": "<p><code>malloc()</code> will <strong>not initialize</strong> the contents of the array. This means in this block could be anything - floats, ints or complete garbage, in your case it's some numerical value thats left from a previous operation. This will also happen when declaring an array inside of a function. </p>\n\n<p>You usually don't want to waste compute time on clearing every single allocated block, because you'll be overwriting them anyway when using them. To get the desired behavior use a loop to initialize the array after allocating it.</p>\n\n<p>Finally, note that your program may invoke undefined behaviour by reading uninitialized memory as <code>float</code>. See question <a href=\"https://stackoverflow.com/questions/9219971/read-before-write-is-undefined-with-malloced-memory\">read before write is undefined with malloced memory?</a> for a detailed explanation.</p>\n"}], "owner": {"reputation": 2197, "user_id": 1826912, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/obLrk.png?s=128&g=1", "display_name": "Rohit Pandey", "link": "https://stackoverflow.com/users/1826912/rohit-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37021897, "answer_count": 1, "score": 0, "last_activity_date": 1462350650, "creation_date": 1462348418, "question_id": 37021677, "link": "https://stackoverflow.com/questions/37021677/c-unrelated-function-seems-to-affect-simple-array-initialization", "title": "C unrelated function seems to affect simple array initialization", "body": "<p>I am seeing some really weird behavior in my C project - <a href=\"https://github.com/ryu577/base/blob/master/numerical/c/NumericalRecipiesCode/src/ch05/tst5.c\" rel=\"nofollow\">https://github.com/ryu577/base/blob/master/numerical/c/NumericalRecipiesCode/src/ch05/tst5.c</a></p>\n\n<p>On line 77, I run one of the routines on \"testFn\" which is on line 13 and I have also included below. I do this by passing a pointer to the function.</p>\n\n<pre><code>float testFn(float x)\n{\n    return x*x;\n}\n</code></pre>\n\n<p>Next, on line 87, I simply attempt to initialize a 1d array of floats based on a boilerplate routine from Numerical recipes in C:</p>\n\n<pre><code>float *c1; c1 = vector(0, n1);\n</code></pre>\n\n<p>The \"vector\" function is quite simple and included here:</p>\n\n<pre><code>float *vector(long nl, long nh)\n/* allocate a float vector with subscript range v[nl..nh] */\n{\n    float *v;\n    v=(float *)malloc((size_t) ((nh-nl+1+NR_END)*sizeof(float)));\n    if (!v) nrerror(\"allocation failure in vector()\");\n    return v-nl+NR_END;\n}\n</code></pre>\n\n<p>Now, when I print the entries in my \"vector\" (float array - c1), this is what I get - </p>\n\n<pre><code>12.00   12.00   12.00   0.00    0.00\n</code></pre>\n\n<p>Somehow, it decides to put 12s in the first 3 positions. But what is really interesting is that these numbers depend on how I define testFn. For example, if I define it as:</p>\n\n<pre><code>float testFn(float x)\n{\n    return x*x*x;\n}\n</code></pre>\n\n<p>I then get the entries of c1:</p>\n\n<pre><code>112.00  110.04  109.04  108.53  0.00\n</code></pre>\n\n<p>But the thing is that the creation and initialization of the vector had nothing to do with testFn at all. So, how is it able to influence its values in this way? Is it related to some block of memory that isn't being freed up and the values are spilling over into the new array?</p>\n"}, {"tags": ["c", "random"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1462348357, "post_id": 37021646, "comment_id": 61593945, "body": "Please check in <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462348545, "post_id": 37021646, "comment_id": 61594069, "body": "<a href=\"http://stackoverflow.com/q/36952047/971127\">stackoverflow.com/q/36952047/971127</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 4153464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D55Mz.jpg?s=128&g=1", "display_name": "Work of Artiz", "link": "https://stackoverflow.com/users/4153464/work-of-artiz"}, "is_accepted": false, "score": 2, "last_activity_date": 1462348823, "creation_date": 1462348823, "answer_id": 37021818, "question_id": 37021646, "link": "https://stackoverflow.com/questions/37021646/optimise-a-code-of-random-number-with-no-repetition-in-c/37021818#37021818", "title": "Optimise a code of random number with no repetition in C", "body": "<p>So if i get what you're trying to do here it is:</p>\n\n<p>generate an array of numbers between 1 and 10, in a random order  (given <code>rand() % 10 + 1</code>)</p>\n\n<p>instead of trial and error I'd suggest the following algorithm:</p>\n\n<ul>\n<li>fill <code>arr</code> with 1...10</li>\n<li>shuffle <code>arr</code></li>\n</ul>\n\n<p>this will run a lot faster</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462403725, "post_id": 37022929, "comment_id": 61629111, "body": "Can I have a code, in order to understand more the process ?"}, {"owner": {"reputation": 169, "user_id": 864230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ML0AP.jpg?s=128&g=1", "display_name": "Brian Zammit", "link": "https://stackoverflow.com/users/864230/brian-zammit"}, "reply_to_user": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "edited": false, "score": 0, "creation_date": 1462530772, "post_id": 37022929, "comment_id": 61685398, "body": "I will work on it now. I did not have time before today. Will edtit and add it in the answer"}], "tags": [], "owner": {"reputation": 169, "user_id": 864230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ML0AP.jpg?s=128&g=1", "display_name": "Brian Zammit", "link": "https://stackoverflow.com/users/864230/brian-zammit"}, "is_accepted": false, "score": 1, "last_activity_date": 1462532334, "last_edit_date": 1462532334, "creation_date": 1462352154, "answer_id": 37022929, "question_id": 37021646, "link": "https://stackoverflow.com/questions/37021646/optimise-a-code-of-random-number-with-no-repetition-in-c/37022929#37022929", "title": "Optimise a code of random number with no repetition in C", "body": "<p>While I agree with the solution provided by Work of Artiz, this will result in the hard question to answer of <em>when to stop shuffling</em>.</p>\n\n<p>To solve this you can use the following solution (which will use more memory, but less clock time):</p>\n\n<p><strong>1</strong> Create an array <code>temp</code> having values 1..10 (ordered, not random)</p>\n\n<p><strong>2</strong> Keep track of the length <code>length</code> of the array (10)</p>\n\n<p><strong>3</strong> Generate a random index <code>rand_i</code> between 0 and <code>length - 1</code></p>\n\n<p><strong>4</strong> Copy <code>temp[rand_i]</code> to next position in your final array</p>\n\n<p><strong>5</strong> Overwrite <code>temp[rand_i]</code> by <code>temp[length-1]</code></p>\n\n<p><strong>6</strong> Decrement <code>length</code></p>\n\n<p><strong>7</strong> Iterate Steps 3 - 6 until your array is filled (10 times)</p>\n\n<p>This will both eliminate your excessive looping, and the problem of when to stop shuffling your array </p>\n\n<p><strong>EDIT</strong>: including code</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(){\nint nbr = 0; srand(time(NULL));\nint arr[10], i, j, flag;\nint temp[10] = {1,2,3,4,5,6,7,8,9,10};\nint length = 10;\n\n\nfor (i = 0; i &lt; 10; i++)\n{\n\n        nbr = rand() % length;  // Generate random index between 0 and length - 1\n\n       arr[i] = temp[nbr];      // Copy value from random index in temp to next index in arr\n\n       // Now since temp[nbr] is already taken (copied to arr) we should replace it by last available value in temp (temp[lenght])\n       // and in the next iteration we will create a value between 0 and length -1. This will keep values not yet taken from temp in \n       // contiguous order\n\n        temp[nbr] = temp[length-1];\n        length--;\n}\n\nfor (i = 0; i &lt; 10; i++)\n{\n    printf(\"%5d\", arr[i]);\n}\n\n\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5716658, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-r4kzhaPR_YE/AAAAAAAAAAI/AAAAAAAAAKM/6flcjt3QZ5o/photo.jpg?sz=128", "display_name": "Rony Cohen", "link": "https://stackoverflow.com/users/5716658/rony-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1462532334, "creation_date": 1462348314, "question_id": 37021646, "link": "https://stackoverflow.com/questions/37021646/optimise-a-code-of-random-number-with-no-repetition-in-c", "title": "Optimise a code of random number with no repetition in C", "body": "<p>I do a code that will display to the screen 10 random numbers with no repetitions. I want to know if we can optimize the code or if you have a better and simple way in order to do this request.\nThanks !!</p>\n\n<pre><code>int main(){\nint nbr = 0; srand(time(NULL));\nint arr[10], i, j, flag;\n\nfor (i = 0; i &lt; 10; i++)\n{\n    do\n    {\n        nbr = rand() % 10 + 1;\n        flag = 1;\n        for (j = 0; j  &lt; i; j ++)\n        {\n            if (nbr == arr[j])\n            {\n                flag = 0;\n                break;\n            }\n        }\n\n    } while (!flag);\n    arr[i] = nbr;\n}\n\nfor (i = 0; i &lt; 10; i++)\n{\n    printf(\"%5d\", arr[i]);\n}\n\n\n\nsystem(\"PAUSE\");\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "pulseaudio"], "answers": [{"comments": [{"owner": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "edited": false, "score": 0, "creation_date": 1462361639, "post_id": 37026605, "comment_id": 61603158, "body": "Alternate approach: <a href=\"http://askubuntu.com/questions/60837/record-a-programs-output-with-pulseaudio\">Record a programs output with PulseAudio</a>"}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1462367193, "post_id": 37026605, "comment_id": 61607330, "body": "I found this page myself. But I want to record all sound on the system, not just a single program. But thx!"}], "tags": [], "owner": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "is_accepted": false, "score": 1, "last_activity_date": 1462361579, "creation_date": 1462361579, "answer_id": 37026605, "question_id": 37021633, "link": "https://stackoverflow.com/questions/37021633/record-computer-sounds-with-pulseaudio-and-c-c/37026605#37026605", "title": "Record computer sounds with PulseAudio and C/C++", "body": "<p>I researched this exact problem yesterday, so I have some steps you can try. I was using Ubuntu 15.04.</p>\n\n<ul>\n<li>Install <code>pavucontrol</code>, and run it.</li>\n<li>Go to the \"Recording\" tab.</li>\n<li>Run a command like this in a shell, <code>arecord -f cd | hexdump  -Cv | grep '0000 '</code>, and you should see a new entry appear in the pavucontrol recording tab. You might see non-zero data if your microphone is enabled.</li>\n<li>Run YouTube or something in the background to generate sound.</li>\n<li>Click the drop-down item next to \"ALSA Capture <em>from</em>\" and switch 'Built-in Audio Analog Stereo' to 'Monitor of Built-in Audio Analog Stereo'. You should see non-zero data in the <code>arecord</code> session.</li>\n</ul>\n\n<p>From there, its a matter of writing code to record audio using the ALSA api. You can use <code>arecord</code> as a reference.</p>\n\n<p>The system (mine anyway) somehow remembers the \"<em>from</em>\" setting between invocations of <code>arecord</code>, even though the item in the Recording tab comes and goes.</p>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 1, "closed_date": 1463069167, "answer_count": 1, "score": 0, "last_activity_date": 1462361579, "creation_date": 1462348260, "question_id": 37021633, "link": "https://stackoverflow.com/questions/37021633/record-computer-sounds-with-pulseaudio-and-c-c", "closed_reason": "Not suitable for this site", "title": "Record computer sounds with PulseAudio and C/C++", "body": "<p>Is there a way to record all the sound that is played on a Linux Machine using PulseAudio? E.g. like Stereomix in Windows.</p>\n\n<p>I dont want a complete Program, I just need some entry point to start my researches. Somehow I do not find very much regarding this topic.</p>\n\n<p>So if anyone has informations on this topic (of course this can be tips, hints or maybe open source programs that do this), please let me know!</p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1462347517, "post_id": 37021341, "comment_id": 61593404, "body": "if the code really contains <code>gets()</code>, time to get a better book..really..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462347544, "post_id": 37021341, "comment_id": 61593421, "body": "Please indent your code."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "edited": false, "score": 1, "creation_date": 1462347559, "post_id": 37021341, "comment_id": 61593435, "body": "hahaha the book &quot;is&quot; old though ;)"}, {"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 2, "creation_date": 1462347692, "post_id": 37021341, "comment_id": 61593534, "body": "Time to start reading. And by the way, <code>0</code> there means the first member."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462347778, "post_id": 37021341, "comment_id": 61593580, "body": "@MGB eh...well... no, it is <b>not</b> idented. Look how the code in your C textbokk looks like, then look at <i>your</i> code. See the difference ?"}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "edited": false, "score": 0, "creation_date": 1462347854, "post_id": 37021341, "comment_id": 61593626, "body": "Yeah 0 means the first member. The code is fine i&#39;ve tested it. The only thing I would like to know is why is there a [20] in the declaration of array list if it is not be used in the loop :/"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462348040, "post_id": 37021341, "comment_id": 61593735, "body": "@MGB now it is (poorly) idented.."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "edited": false, "score": 0, "creation_date": 1462348139, "post_id": 37021341, "comment_id": 61593791, "body": "You would understand the code anyways :) :p"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1462348156, "post_id": 37021341, "comment_id": 61593802, "body": "That sorting algorithm is pretty bad. It looks like a variation on a <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">bubble sort</a>. It&#39;s O(n^2) meaning if the size of the list doubles it will take quadruple the time to sort. You might be better off with something more up to date like <a href=\"http://c.learncodethehardway.org/book/\" rel=\"nofollow noreferrer\">Learn C The Hard Way</a>."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "edited": false, "score": 0, "creation_date": 1462348344, "post_id": 37021341, "comment_id": 61593928, "body": "Infact it is written in the book that the algorithm is bad for sorting but here it serves as a good example for arrays and string :)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1462348510, "post_id": 37021341, "comment_id": 61594043, "body": "I allowed myself to improve indentation - have a look at the source to see how to do better, it might help you in future questions."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1462348564, "post_id": 37021341, "comment_id": 61594077, "body": "@Aconcagua So is it the size of the names that we want to sort?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1462348759, "post_id": 37021341, "comment_id": 61594206, "body": "No - it is the content of the strings within the array of strings. Imagine you would have used C++ - then you would have had <code>::std::string list[10];</code>, or Java: <code>String[] list = new String[10];</code>. You do not need to know about these string classes in those two languages - only need to know that they represent textual data (= strings). In C you have no other way as to represent a string as a char* or char[], so if you have an array of strings, you have char*[] or char[][]."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "edited": false, "score": 0, "creation_date": 1462349059, "post_id": 37021341, "comment_id": 61594397, "body": "Oh, so it&#39;s because C treats strings as an array of characters?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1462349786, "post_id": 37021341, "comment_id": 61594840, "body": "@MGB Exactly. Actually, any other language does so, too, but in general, this is hidden away from you."}, {"owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1462349981, "post_id": 37021341, "comment_id": 61594983, "body": "@Aconcagua Thanks for your kind help. Now I got an idea about it :D"}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 2, "last_activity_date": 1462347981, "creation_date": 1462347981, "answer_id": 37021543, "question_id": 37021341, "link": "https://stackoverflow.com/questions/37021341/sorting-names-alphabetically-in-c/37021543#37021543", "title": "Sorting Names Alphabetically In C", "body": "<p>\"list\" is intended to be used as an array of c strings, but each such string itself is an array of char again, so you get a two-dimentional array, where the \"outer\" dimenstion represents the strings and the \"inner\" dimenstion an array to store the string at (with maximal length of 20 characters).</p>\n\n<p>As gets shall fill in such a string, it uses already the entire \"inner\" dimension, so you have only to loop through the \"outer\" dimension.</p>\n"}], "owner": {"reputation": 61, "user_id": 6289416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8J_7LoymRAI/AAAAAAAAAAI/AAAAAAAAAE8/QnUEfda_EUg/photo.jpg?sz=128", "display_name": "MGB", "link": "https://stackoverflow.com/users/6289416/mgb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462348253, "creation_date": 1462347451, "last_edit_date": 1462348253, "question_id": 37021341, "link": "https://stackoverflow.com/questions/37021341/sorting-names-alphabetically-in-c", "title": "Sorting Names Alphabetically In C", "body": "<p>I have this code in my computer book:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt; \n#include&lt;string.h&gt;\nvoid main(void)\n{\n    clrscr();\n    char list[10][20],name[20];\n    int i,j;\n    for(i=0;i&lt;10;i++)\n    {\n        printf(\"\\nEnter the Name of Student %d\",i+1);\n        gets(&amp;list[i][0]);\n    }\n    for(i=0;i&lt;10-1;i++)\n        for(j=0;j&lt;10-1;j++)\n            if(strcmp(&amp;list[j][0],&amp;list[j+1][0])&gt;0)\n            {\n                strcpy(name,&amp;list[j][0]);\n                strcpy(&amp;list[j][0],&amp;list[j+1][0]);\n                strcpy(&amp;list[j+1][0],name);\n            }\n    printf(\"\\nThe Sorted Name List is :\");\n    for(i=0;i&lt;10;i++)\n        printf(\"\\n%s\",&amp;list[i][0]);\n    getche();\n}\n</code></pre>\n\n<p>I would like to know why the array \"list\" is declared as list[10][20] but when it is used to store the names it uses only 1 loop i.e only i and the 2nd index or subscript is always kept zero while it is 20 in the declaration?!</p>\n"}, {"tags": ["c", "macros", "arm", "atmelstudio"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462347203, "post_id": 37021088, "comment_id": 61593221, "body": "<code>write_register</code> accepts a <i>pointer</i> as second argument., but <code>RESET_CMD</code> is not a pointer. You need a 1 byte buffer filled with <code>RESET_CMD</code>."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1462347883, "last_edit_date": 1462347883, "creation_date": 1462347317, "answer_id": 37021301, "question_id": 37021088, "link": "https://stackoverflow.com/questions/37021088/pass-macro-definition-to-function-taking-reference-as-an-argument/37021301#37021301", "title": "pass macro definition to function taking reference as an argument", "body": "<p>You can't. <code>write_register</code> accepts a <em>pointer</em> as second argument, period.</p>\n\n<p>You probably want this:</p>\n\n<pre><code>#define RST_REQ_REG 0x04\n#define RESET_CMD   0x01\n\nuint8_t cmdbuffer[1] = {command};\n\nwrite_register(RST_REQ_REG, cmdbuffer, 1);\n</code></pre>\n\n<p>Maybe you want to wrap this into another function:</p>\n\n<pre><code>void write_command(uint8_t regAddr, uint8_t command)\n{\n   uint8_t cmdbuffer[1] = {command};\n   write_register(regAddr, cmdbuffer, 1);\n}\n\n...\nwrite_command(RST_REQ_REG, RESET_CMD);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 2755395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f80595b032a26df4f0e0727341d5d24?s=128&d=identicon&r=PG&f=1", "display_name": "mrUnfused", "link": "https://stackoverflow.com/users/2755395/mrunfused"}, "edited": false, "score": 0, "creation_date": 1462352832, "post_id": 37021400, "comment_id": 61596813, "body": "Yes, I generally pass an array, so I created the function accordingly and for just sending a byte I did exactly same that you have suggested at first. Reminded that the pointer needs memory. Many many thanks :)"}], "tags": [], "owner": {"reputation": 905, "user_id": 2012498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0mY6.jpg?s=128&g=1", "display_name": "ThomasH", "link": "https://stackoverflow.com/users/2012498/thomash"}, "is_accepted": false, "score": 1, "last_activity_date": 1462347988, "last_edit_date": 1462347988, "creation_date": 1462347617, "answer_id": 37021400, "question_id": 37021088, "link": "https://stackoverflow.com/questions/37021088/pass-macro-definition-to-function-taking-reference-as-an-argument/37021400#37021400", "title": "pass macro definition to function taking reference as an argument", "body": "<p>Since you have to pass a pointer to the write_register function, you have to assign it to a variable first so it gets allocated storage. It cannot be passed as a literal. Why write_register takes a pointer is probably if you want to write more than one byte, so you can pass an array (an array in C is just a pointer to the first element of the array), but if you always want to write 1 byte it can get annoying.</p>\n\n<p>So you need to do something like this:</p>\n\n<pre><code>uint8_t byteToWrite = RESET_CMD;\nwrite_register(RST_REQ_REG, &amp;byteToWrite, 1);\n</code></pre>\n\n<p>If this happens a lot and annoys you, you can write a wrapper function:</p>\n\n<pre><code>static void my_write_register(uint8_t regAddr, uint8_t writeByte)\n{\n  write_register(regAddr, &amp;writeByte, 1);\n}\n</code></pre>\n\n<p>Then you can call it like this:</p>\n\n<pre><code>my_write_register(RST_REQ_REG, RESET_CMD);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 2755395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f80595b032a26df4f0e0727341d5d24?s=128&d=identicon&r=PG&f=1", "display_name": "mrUnfused", "link": "https://stackoverflow.com/users/2755395/mrunfused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "accepted_answer_id": 37021301, "answer_count": 2, "score": 0, "last_activity_date": 1462347988, "creation_date": 1462346708, "question_id": 37021088, "link": "https://stackoverflow.com/questions/37021088/pass-macro-definition-to-function-taking-reference-as-an-argument", "title": "pass macro definition to function taking reference as an argument", "body": "<p>How can we pass a #defined macro to the function as an argument where the function accepts reference. </p>\n\n<p>This is what I am trying the wrong way:</p>\n\n<pre><code>#define RST_REQ_REG 0x04\n#define RESET_CMD   0x01\n\nwrite_register(RST_REQ_REG, RESET_CMD, 1);\n\n\n// Decleration of write_reg is\nvoid write_register(uint8_t regAddr, uint8_t *writeByte, uint8_t writeByteLen);\n</code></pre>\n\n<p>Thanks !</p>\n"}, {"tags": ["c", "arrays", "initialization", "undefined-behavior", "strlen"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1462346366, "post_id": 37020836, "comment_id": 61592765, "body": "Replace <code>strlen</code> with <code>sizeof</code> and your code will do what you expect. <code>strlen</code> assumes that the array contains a zero-terminated string, which it does not."}, {"owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1462346521, "post_id": 37020836, "comment_id": 61592847, "body": "Ah, that was my issue. Thanks, I expected initialization to handle null-termination."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462346593, "post_id": 37020836, "comment_id": 61592882, "body": "@DaveL the problem is that the <code>arr</code> array is not initialized, it contains indeterminate values, therefore <code>l</code> will eventually contain an indeterminate value."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462346952, "post_id": 37020836, "comment_id": 61593069, "body": "Initialization with a constant string will include the terminating null character (if it fits).  But there was no initialization, so the contents of <code>arr</code> are completely undefined."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462347250, "post_id": 37020836, "comment_id": 61593245, "body": "@TomKarzes: Are you sure one could apply an initialiser to a VLA? I doubt it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1462348190, "post_id": 37020836, "comment_id": 61593836, "body": "@alk Yes, the size would have to be constant to have an initializer.  For a VLA, initialization has to be done manually, following the declaration."}], "answers": [{"comments": [{"owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1462346247, "post_id": 37020858, "comment_id": 61592705, "body": "So in C, &quot;char arr[ret_1()];&quot; is also undefined? Or are you saying if I defined it as a single character array, I should no longer have undefined behavior?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1462346382, "post_id": 37020858, "comment_id": 61592776, "body": "@DaveL: Probably a language issue, but what do want to express by &quot;<i>pass ... into an array</i>&quot;?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1462346478, "post_id": 37020858, "comment_id": 61592826, "body": "@DaveL no, that&#39;s not what causing UB there, the problem is with the use of <code>strlen()</code>  which is reading content of uninitiazed memory."}, {"owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1462346597, "post_id": 37020858, "comment_id": 61592888, "body": "I see, thanks for the quick response. The null-termination was exactly my issue."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1462346673, "post_id": 37020858, "comment_id": 61592922, "body": "@DaveL it&#39;s not only null-termination, altogether you&#39;re reading an unit-ed memory, wich itself is UB."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1462346624, "last_edit_date": 1462346624, "creation_date": 1462346078, "answer_id": 37020858, "question_id": 37020836, "link": "https://stackoverflow.com/questions/37020836/static-char-array-initialization-with-simple-function-says-length-is-6-but-shou/37020858#37020858", "title": "Static char array initialization with simple function says length is 6, but shouldn&#39;t it be 1?", "body": "<p><strong><em>TL;DR</em></strong> Yes, your code invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>In your code, <code>arr</code> being an automatic local array, and left uninitialized, the content of the array is indeterminate.</p>\n\n<p>Applying <code>strlen()</code> on the <em>array</em> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>, as you're trying to read indeterminate value.</p>\n\n<p><strong>Solution:</strong> As already mentioned in comment, you can use <code>sizeof</code> operator with the array, which deals with the <em>type</em> of the variable and does not attempt to <em>use</em> the value of the variables, thus saving you from UB.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 3, "last_activity_date": 1462346943, "last_edit_date": 1462346943, "creation_date": 1462346599, "answer_id": 37021042, "question_id": 37020836, "link": "https://stackoverflow.com/questions/37020836/static-char-array-initialization-with-simple-function-says-length-is-6-but-shou/37021042#37021042", "title": "Static char array initialization with simple function says length is 6, but shouldn&#39;t it be 1?", "body": "<blockquote>\n  <p>Static char array initialization with simple function </p>\n</blockquote>\n\n<p>This statement</p>\n\n<pre><code>char arr[ret_1()]; \n</code></pre>\n\n<p><em>defines</em> an array of as much elements as given by <code>ret_1()</code>, but leaves it <em>uninitialised</em>.</p>\n\n<p>Then this call</p>\n\n<pre><code>int l = strlen(arr); \n</code></pre>\n\n<p>reads the (uninitialised) array's content/elements and with this invokes undefined behaviour. Anything can happen from this moment on.</p>\n\n<p>To fix this do:</p>\n\n<pre><code>char arr[ret_1()]; \nmemset(arr, 0, sizeof arr); /* Initialise array by (all) zero(s). */\n</code></pre>\n\n<p>After applying the fix, <code>strlen(arr)</code> returns <code>0</code>, meaning that <code>0</code> elements in <code>arr</code> are used to represent a \"string\". It stores the equivalent to <code>\"\"</code>, the empty string.</p>\n\n<h2>Note:</h2>\n\n<p>This expression <code>sizeof arr</code> actually returns the number of bytes allocate for <code>arr</code>, which in your example would be <code>1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462351351, "post_id": 37021416, "comment_id": 61595876, "body": "Probably because you didn&#39;t answer the question. But also note that modern GCC uses C11 and not C90. If you are using an old version of GCC, compile correctly: <code>gcc -std=c11 -pedantic-errors</code>, or if you have a really old version, <code>gcc -std=c99 -pedantic-errors</code>. If you didn&#39;t do this, the <code>%zu</code> format specifier wouldn&#39;t be available either."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462352048, "post_id": 37021416, "comment_id": 61596291, "body": "@Lundin : Thanks for that. I usually go with <code>-std=c99 --pedantic-errors</code> whenever I want  to reuse the code in MSVC aiming for minimal rewrite.  Regarding the answer I already mentioned it is just a supplement to other answers but I really wish the downvoter leave a comment. But nevermind !"}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": -1, "last_activity_date": 1462349370, "last_edit_date": 1462349370, "creation_date": 1462347669, "answer_id": 37021416, "question_id": 37020836, "link": "https://stackoverflow.com/questions/37020836/static-char-array-initialization-with-simple-function-says-length-is-6-but-shou/37021416#37021416", "title": "Static char array initialization with simple function says length is 6, but shouldn&#39;t it be 1?", "body": "<p>Apart from the basic issue - <strong>Initialization</strong> - there are few other issues with your code.</p>\n\n<p>The return type for <code>strlen()</code>  is <code>size_t</code> so you may wish to do the below stuff:</p>\n\n<pre><code>/* Do the initialization of the array */\n\nsize_t l = strlen(arr);\nprintf(\"The size is: %zu\\n\", l); \n/* zu is the specifier for size_t as specified in ANSI C99 */\n</code></pre>\n\n<p>Also note the Variable Length Array(VLA) is an extension that may not work in all compilers. For example, doing </p>\n\n<pre><code>gcc -pedantic your_code.c -o your_code\n</code></pre>\n\n<p>should give you</p>\n\n<pre><code> warning: ISO C90 forbids variable length array 'arr' [-Wvla ]\n</code></pre>\n\n<p>Here the flag <code>-pedantic</code> warns about the gnu C extensions used &amp;\n<code>-pedantic-errors</code> flag converts such diagnostic warnings into errors.</p>\n"}, {"tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": false, "score": 0, "last_activity_date": 1462347781, "creation_date": 1462347781, "answer_id": 37021472, "question_id": 37020836, "link": "https://stackoverflow.com/questions/37020836/static-char-array-initialization-with-simple-function-says-length-is-6-but-shou/37021472#37021472", "title": "Static char array initialization with simple function says length is 6, but shouldn&#39;t it be 1?", "body": "<p>In cases such as your question <code>printf()</code> can be a powerful debug tool. For the sake of debugging you can expand your code, add this initialization and watch the difference:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint ret_1() { return 1; }\nint main( int argc, const char* argv[] ) \n{   \n    int r = ret_1();\n    printf(\"%d\\n\", r);\n    char arr[r + 1];     //define the char array\n    int i = 0;\n    for ( ; i &lt; r; i++ ) //initialize char the array\n        arr[i] = '0';   \n    arr[r] = '\\0';       //terminate it\n\n    size_t l = strlen(arr); \n\n    printf(\"The size is: %zu\\n\", l);     \n    return 0; \n}\n</code></pre>\n"}], "owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 37021042, "answer_count": 4, "score": 2, "last_activity_date": 1462349370, "creation_date": 1462345958, "last_edit_date": 1462346446, "question_id": 37020836, "link": "https://stackoverflow.com/questions/37020836/static-char-array-initialization-with-simple-function-says-length-is-6-but-shou", "title": "Static char array initialization with simple function says length is 6, but shouldn&#39;t it be 1?", "body": "<p>I've discovered that this program continues returning 6 until I start returning 16 or greater instead of 1, at which point the program prints 0. Why? My intention was to use pass the result of a function directly into the static array initialization.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint ret_1() { return 1; }\nint main( int argc, const char* argv[] ) \n{   \n    char arr[ret_1()];  \n    int l = strlen(arr); \n\n    printf(\"The size is: %d\\n\", l);     \n    return 0; \n}\n</code></pre>\n\n<blockquote>\n  <p>The size is: 6</p>\n</blockquote>\n\n<p>I wonder if this is undefined behavior generating an arbitrary value, or if there's an underlying issue I'm missing.</p>\n"}, {"tags": ["c", "windows", "winapi", "assembly", "reverse-engineering"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1462345092, "post_id": 37020278, "comment_id": 61592074, "body": "Maybe you want to show us the relevant assembly code you are talking about."}, {"owner": {"reputation": 63, "user_id": 3984437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85827d93785bb74fc93d77bc89f728d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3984437/dan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462345741, "post_id": 37020278, "comment_id": 61592442, "body": "There really isn&#39;t anything to show, the program calls GetCurrentProcess in one line and the next line is lea eax, something. Those two lines alome are the only thing I cannot understand the rest is really irrelevant"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462346023, "post_id": 37020278, "comment_id": 61592591, "body": "Well, not sure if it&#39;s irrelevant. But anyway did you consider the fact that the call to <code>GetCurrentProcess()</code> may be just there to confuse the reverse engineer? If you have <code>...; GetCurrentProcess(); ...</code> in your C code, you roughly get what you describe: the function is called and the return value is ignored/discarded."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1462348486, "post_id": 37020278, "comment_id": 61594024, "body": "If you won&#39;t show us the code that you want help with there&#39;s no point asking. You should remove the entire question if you aren&#39;t prepared to share your code."}], "answers": [{"tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1462347406, "creation_date": 1462347406, "answer_id": 37021333, "question_id": 37020278, "link": "https://stackoverflow.com/questions/37020278/calling-getcurrentprocess-disregarding-the-returned-value/37021333#37021333", "title": "Calling GetCurrentProcess disregarding the returned value", "body": "<p>Under windows operating system you can always access current process through a <strong>pseudo handle</strong> which value is <code>(HANDLE)-1</code>. This value is surely what you find loaded directly in <code>eax</code> on the second line, but this is also the value that <code>GetCurrentProcess()</code> returns.<br>\nIf I well understood you are reverse engineering a piece of software, in my opinion the original programmer decided to pass from one system to the other, from the constant <code>(HANDLE)-1</code> to <code>GetCurrentProcess()</code>, or the reverse and forgot to comment out the former choice.<br>\nNo side effect should be present for any choice you make.<br>\nFor more info see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683179(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms683179(v=vs.85).aspx</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 3984437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85827d93785bb74fc93d77bc89f728d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3984437/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "closed_date": 1462507071, "accepted_answer_id": 37021333, "answer_count": 1, "score": -1, "last_activity_date": 1462349488, "creation_date": 1462344043, "last_edit_date": 1462349488, "question_id": 37020278, "link": "https://stackoverflow.com/questions/37020278/calling-getcurrentprocess-disregarding-the-returned-value", "closed_reason": "Not suitable for this site", "title": "Calling GetCurrentProcess disregarding the returned value", "body": "<p>I'm working on REing a program for school and there are two lines that I can't really seem to figure out.</p>\n\n<ul>\n<li><p>First is the program calls <code>GetCurrentProcess</code>, and then the next line is:\n<code>LEA eax, -something-</code></p>\n\n<p>Why would we do something like that? reading up on <code>GetCurrentProcess</code> I figured out that it returns a handle to the current process, putting the value of that handle in <code>eax</code>.</p></li>\n<li><p>Now why would the program delete the value that was returned in <code>eax</code> with <code>lea</code>? and why would it even call this function if it's not using the returned value at all?</p></li>\n</ul>\n\n<p>Is there anything else that <code>GetCurrentProcess</code> does that would justify it?</p>\n"}, {"tags": ["c", "windows-10", "mingw-w64"], "comments": [{"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 1, "creation_date": 1462343059, "post_id": 37019889, "comment_id": 61590965, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/k089yyh0.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/k089yyh0.aspx</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1462344099, "post_id": 37019889, "comment_id": 61591502, "body": "Yes, that&#39;s the way it&#39;s supposed to be. Why shouldn&#39;t it be that way?"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1462344292, "post_id": 37020110, "comment_id": 61591611, "body": "Note that the reason this suppresses the &#39;default message&#39; is that the program no longer exits as a result of a signal \u2014 because you use <code>exit()</code> or <code>_exit()</code> or something similar.  You can demonstrate the difference with a signal handler like this: <code>void handle_abort(int sig) {    fprintf(stderr, &quot;Abort signal (%d) caught by %s()\\n&quot;, sig, __func__);    signal(sig, SIG_DFL);    raise(sig);    &#47;*exit(128+sig);*&#47; }</code> (or you can use <code>exit()</code> instead of <code>signal()</code> plus <code>raise()</code>).  The &#39;default message&#39; actually comes from the shell."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462344600, "post_id": 37020110, "comment_id": 61591782, "body": "@JonathanLeffler You&#39;re right, corrected that part."}], "tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 3, "last_activity_date": 1462344536, "last_edit_date": 1462344536, "creation_date": 1462343446, "answer_id": 37020110, "question_id": 37019889, "link": "https://stackoverflow.com/questions/37019889/strange-behavior-of-c-abort-function-on-mingw-w64/37020110#37020110", "title": "Strange behavior of C abort function on mingw-w64", "body": "<p><code>abort</code> is the same as <code>raise(SIGABRT)</code>.</p>\n\n<p>If you don't catch the <code>SIGABRT</code> signal, the default OS handler is invoked, on Linux this is dumping core, causing the shell to write <code>Aborted</code> on standard error.</p>\n\n<p>On Windows, it terminates and the message you saw is displayed, on standard error if console subsystem is used or in a standard message box if gui. This can be suppressed by the non-standard <code>_set_abort_behavior</code>.</p>\n\n<p>If you want a uniform action across systems, you need to register a <code>SIGABRT</code> handler and do something yourself:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid handle_abort(int sig)\n{\n   // do something (e.g write to log)\n   // don't let this handler return if you want to suppress defaut handler\n}\n\nint main(void)\n{    \n    signal(SIGABRT, handle_abort);\n\n    abort();\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6289088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6b509643cf59275d861e0bc93a4f75?s=128&d=identicon&r=PG&f=1", "display_name": "bostjanv", "link": "https://stackoverflow.com/users/6289088/bostjanv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462344536, "creation_date": 1462342613, "last_edit_date": 1495542232, "question_id": 37019889, "link": "https://stackoverflow.com/questions/37019889/strange-behavior-of-c-abort-function-on-mingw-w64", "title": "Strange behavior of C abort function on mingw-w64", "body": "<p>I'm new to mingw-w64 and I'm running into the following problem:</p>\n\n<p>I recently installed MSYS on my Windows 10 computer according to the\ninstructions provided in</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30069830/how-to-install-mingw-w64-and-msys2\">How to install MinGW-w64 and MSYS2?</a></p>\n\n<p>and I am currently trying to build some Win32 C programs. I first tried some\nsimple programs and they seem to work; however, I ran into problems with\nthe C abort function.</p>\n\n<p>If I build the following program on Linux</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n  printf(\"bla bla bla\\n\");\n  abort();\n}\n</code></pre>\n\n<p>and later run it, I simply get the output</p>\n\n<pre><code>bla bla bla\nAborted\n</code></pre>\n\n<p>However, on Windows the output is</p>\n\n<pre><code>bla bla bla\n\nThis application has requested the Runtime to terminate it in an unusual\nway. Please contact the application's support team for more information.\n</code></pre>\n\n<p>A message window also appears with the message</p>\n\n<blockquote>\n  <p>a.exe has stopped working --\n  A problem caused the program to stop working correctly. Windows will close\n  the program and notify you if a solution is available.</p>\n</blockquote>\n\n<p>Is this the way it is supposed to be? Anyway, I much prefer the Linux version.</p>\n"}, {"tags": ["c", "openssl", "hex", "base64"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462342217, "post_id": 37019587, "comment_id": 61590568, "body": "You are aware that <code>p</code> is not a buffer, right? It&#39;s just a pointer, and requires extra memory allocation to act as a buffer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462342518, "post_id": 37019587, "comment_id": 61590703, "body": "Google &quot;B64 buffer to HEX&quot;"}], "owner": {"reputation": 11, "user_id": 4566187, "user_type": "registered", "profile_image": "https://graph.facebook.com/749409511839630/picture?type=large", "display_name": "M Aoun", "link": "https://stackoverflow.com/users/4566187/m-aoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462346496, "creation_date": 1462341461, "last_edit_date": 1462346496, "question_id": 37019587, "link": "https://stackoverflow.com/questions/37019587/convert-b64-buffer-to-hex", "title": "Convert B64 buffer to HEX", "body": "<p>I have a buffer defined as:</p>\n\n<pre><code>        char *p;\n</code></pre>\n\n<p>That is being filled by a function</p>\n\n<pre><code>        p = base64( (unsigned char *)digest, SHA256_DIGEST_LENGTH );\n</code></pre>\n\n<p>And is printable in cleartext using:</p>\n\n<pre><code>    printf( \"RESULT IN B64: %x\\n\", p);\n</code></pre>\n\n<p>I am using the OPENSSL libraries (hmac.h, etc..)</p>\n\n<p>Any thoughts or hints as to how to convert this string from B64 to HEX? (not simple ASCII to hex of course)</p>\n"}, {"tags": ["c", "struct", "c-strings"], "comments": [{"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 1, "creation_date": 1462341579, "post_id": 37019527, "comment_id": 61590301, "body": "<code>status</code> is expected to be a single char. So define it as <code>char status = &#39;Y&#39;</code>. you have defined it as <code>char status[1] = &quot;Y&quot;</code>, which is incorrect since you have not taken into consideration the <code>&#39;\\0&#39;</code> character."}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "reply_to_user": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1462342654, "post_id": 37019527, "comment_id": 61590747, "body": "@CinCout, I had that as a single char, but my compiler didn&#39;t like it for some reasons! It works with status[1] = &quot;Y&quot; now!"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462342863, "post_id": 37019747, "comment_id": 61590850, "body": "I&#39;m passing a double to &quot;print_number&quot; function. <code>triad[i++] = num % 1000;</code> will generate an error"}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462348899, "post_id": 37019747, "comment_id": 61594289, "body": "Split your double into two parts (integer and fraction) and print them as integers. It&#39;ll still be simpler."}], "tags": [], "owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1462342106, "creation_date": 1462342106, "answer_id": 37019747, "question_id": 37019527, "link": "https://stackoverflow.com/questions/37019527/calculating-the-resistor-value-with-its-color-bands-as-input/37019747#37019747", "title": "Calculating the resistor value with its color bands as input", "body": "<p>I think your code for number printing is too complex. Look at following code:</p>\n\n<pre><code>int num = 2345666;\nprintf(\"%d\\n\", num);\n\nint triad[10];\nint i = 0;\ndo\n{\n    triad[i++] = num % 1000;\n    num /= 1000;\n}while(num);\n\nfor(i--; i &gt;= 0; i--)\n    printf(\"%d \", triad[i]);\nprintf(\"\\n\");\n</code></pre>\n\n<p>It's quick and dirty. Polish it.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462425270, "post_id": 37042622, "comment_id": 61634550, "body": "Thanks for helping out here.  The program should follow the exact formatting (which is not hard to do now) Band 1 =&gt; [green] Band 2 =&gt; [black] Band 3 =&gt; [yellow] resistance value: 500 000 -ohms Do you want to decode another resistor (Y/N)? [Y]"}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462425413, "post_id": 37042622, "comment_id": 61634597, "body": "The way you&#39;re dealing with user input is exactly what I was looking for!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462425772, "post_id": 37042622, "comment_id": 61634716, "body": "Yes, you just need to wrap the body in a loop that asks for color input. Hopefully this will get you started. If you run into problems finishing it up, let me know and I&#39;m glad to help, but I did want to leave some of the challenge for you to enjoy <code>:)</code>"}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462427257, "post_id": 37042622, "comment_id": 61635308, "body": "I&#39;ve modified the print_number function last night and it almost works with every combination input."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462427736, "post_id": 37042622, "comment_id": 61635482, "body": "Give me a second, I&#39;ve got another idea."}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462431909, "post_id": 37042622, "comment_id": 61637409, "body": "Thanks @David. I&#39;ll post my code once I finish modifying. :)"}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462445763, "post_id": 37042622, "comment_id": 61645071, "body": "mate, just a question. How <code>int argc</code>, counts the characters in  <code>char **argv</code>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462468559, "post_id": 37042622, "comment_id": 61659823, "body": "<code>argc</code> is the argument <i>count</i>. <code>argv</code> is the argument <i>vector</i>. <code>argc</code> gives the total number of arguments to <code>main</code> (index <code>0</code> - <code>argv[0]</code> is the name of the program being run). The actual user supplied command line arguments are <code>argv[1], ... argv[argc-1]</code>. So <code>argc</code> isn&#39;t a count of the characters in <code>argv</code>, it is the count of the <i>character strings</i> supplied as arguments. In my code I simply used <code>argv</code> to hold the color codes. (as opposed to reading them from <code>stdin</code> or a file). If looping, I would use <code>fgets</code> to read a line of colors and <code>strtok</code> to separate them."}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462494067, "post_id": 37042622, "comment_id": 61671429, "body": "I have tried to follow your logic with my clients specifications. So I ended up with rev 2 of the code. It works perfectly fine for the first loop."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462510964, "post_id": 37042622, "comment_id": 61675253, "body": "OK, I&#39;ll take a look. Breaking it down into the function we have, it should be simple to loop over it all. I&#39;ll bet something is not getting reinitialized. I&#39;ll try and get it tonight (late here)."}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462595234, "post_id": 37042622, "comment_id": 61713491, "body": "check out the final rev. I&#39;ve posted."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1462595869, "post_id": 37042622, "comment_id": 61713629, "body": "Looks like you got it! It is fine. The only comments would be try and avoid &quot;magic&quot; number (e.g. <code>char answer[3][10];</code>) and use defined constants instead. You already have <code>MINC</code> as <code>3</code>, your can simply add another for answer length to the <code>enum</code> (e.g. <code>ANSL = 10</code>) and then <code>char answer[MINC][ANSL];</code> Last note would be to avoid <i>global</i> variables unless absolutely necessary. Get it the habit of passing parameters as needed. That will come with time. Good job and good effort. There is a lot going on in this bit of code. Save it and revisit it in a year and see what you would tweak."}, {"owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1482843864, "post_id": 37042622, "comment_id": 69893288, "body": "I&#39;ve made some changes to this. Please take a look at the <a href=\"https://github.com/Prince-of-Persia/ResistorCalculator\" rel=\"nofollow noreferrer\">GitHub repo</a>. I&#39;ve rewritten the program in <code>C++</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "edited": false, "score": 0, "creation_date": 1482890189, "post_id": 37042622, "comment_id": 69910650, "body": "Sure. I&#39;ll let you know if I find anything I think will help. Thanks for the follow up."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1462513817, "last_edit_date": 1462513817, "creation_date": 1462423962, "answer_id": 37042622, "question_id": 37019527, "link": "https://stackoverflow.com/questions/37019527/calculating-the-resistor-value-with-its-color-bands-as-input/37042622#37042622", "title": "Calculating the resistor value with its color bands as input", "body": "<p>Your code for determining the significant figures in your resistor value is quite a bit more complex than needed. Since you declare the global array of struct <code>item_list</code>, all you need to do to form the significant figure is to use <code>item_list</code> as a lookup-table to find the index for the band-color entered. For each subsequent color (2nd [and 3rd for 5-band]), you simply multiply the current resistor value by <code>10</code> before adding the index. </p>\n\n<p>For example with the <code>item_list</code> index variable <code>r</code> and the resistor value <code>rval</code> (including your check for an invalid color), your code could be reduced to:</p>\n\n<pre><code>int multiplier[] = { 1, 10, 100, 1000, 10000, 100000, 1000000, 10000000 };\n...\n    int err = 0, i, mult, r;\n    long rval = 0;\n\n    printf (\"\\ncolor bands determining significant figures:\\n\\n\");\n    for (i = 1; i &lt; argc - 1; i++) { /* convert colors to index */\n        if ((r = srchitems (argv[i])) != -1) {\n            rval = rval * 10 + r;    /* form significant figure */\n            prnitem (r);\n        }\n        else {\n            fprintf (stderr, \"error: invalid color '%s'\\n\", argv[i]);\n            err = 1;\n        }\n    }\n    if (err) return 1;\n    mult = srchitems (argv[i]);     /* get multiplier index  */\n    rval *= multiplier[mult];       /* calculare final value */\n    printf (\"\\nmultiplier:\\n\\n\");\n    prnitem (mult);\n    printf (\"\\nresistor value : %ld -ohms\\n\\n\", rval);\n\n    return 0;\n</code></pre>\n\n<p>Above your <code>srchitems</code> function simply returns the index in <code>item_list</code> given a color (entered as arguments to the program, e.g. <code>argv[1]</code>, <code>argv[2]</code>, ...) You can write a simple <code>srchitems</code> that converts all input to lowercase before preforming the lookup as:</p>\n\n<pre><code>/** search item_list for color code 'ccode', return index\n *  returns array index on success, -1 otherwise.\n */\nint srchitems (char *ccode)\n{\n    int i;\n    char lccode[MAXCC] = \"\";       /* array to hold lowercase color */\n\n    strcpy2lower (lccode, ccode);  /* convert string to lowercase */\n\n    for (i = 0; i &lt; (int)nitems; i++)    /* lookup index */\n        if (*lccode == *(item_list[i].name))\n            if (!scmp (item_list[i].name, lccode))\n                return i;\n\n    return -1;   /* return -1 on error */\n}\n</code></pre>\n\n<p>If you put the remaining pieces of the puzzle together, you could do something similar to the following. I leave it to you to format the output as needed. You can replace the simple string comparison function <code>scmp</code> with <code>strcmp</code> (and include <code>string.h</code>) Let me know if you have any questions.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* resister bands */\nenum resistor_band_items { BLACK, BROWN, RED, ORANGE, YELLOW, GREEN, \n                        BLUE, VIOLET, GRAY, WHITE, UNKNOWN };\n/* constants for min/max color arguments and max color chars */\nenum { MINC = 3, MAXC = 4, MAXCC = 8 };\n\nstruct items    /* could be simple array of strings */\n{\n    char *name;\n    enum resistor_band_items id;\n} item_list[] = {\n    {\"black\", BLACK},\n    {\"brown\", BROWN},\n    {\"red\", RED},\n    {\"orange\", ORANGE},\n    {\"yellow\", YELLOW},\n    {\"green\", GREEN},\n    {\"blue\", BLUE},\n    {\"violet\", VIOLET},\n    {\"gray\", GRAY},\n    {\"white\", WHITE}\n};\n/* resistor multiplier values */\nint multiplier[] = { 1, 10, 100, 1000, 10000, 100000, 1000000, 10000000 };\n\n#define nitems (sizeof item_list/sizeof *item_list)\n\nint srchitems (char *ccode);\nchar *strcpy2lower (char *dest, char *src);\nint scmp (char *a, char *b);\nvoid prnitem (int i);\n\nint main (int argc, char **argv) {\n\n    if (argc &lt; MAXC || MAXC + 1 &lt; argc) { /* check 3 or 4 arguments */\n        fprintf (stderr, \"error: invalid input, usage: %s c1 c2 c3 [c4]\\n\"\n                         \"usage: enter color codes for 4 or 5-band resistor\\n\"\n                         \"       (tolerance ignored, enter 4 colors max)\\n\",\n                        argv[0]);\n        return 1;\n    }\n\n    int err = 0, i, mult, r;\n    long rval = 0;\n\n    printf (\"\\ncolor bands determining significant figures:\\n\\n\");\n    for (i = 1; i &lt; argc - 1; i++) { /* convert colors to index */\n        if ((r = srchitems (argv[i])) != -1) {\n            rval = rval * 10 + r;    /* form significant figure */\n            prnitem (r);\n        }\n        else {\n            fprintf (stderr, \"error: invalid color '%s'\\n\", argv[i]);\n            err = 1;\n        }\n    }\n    if (err) return 1;\n    mult = srchitems (argv[i]);     /* get multiplier index  */\n    rval *= multiplier[mult];       /* calculare final value */\n    printf (\"\\nmultiplier:\\n\\n\");\n    prnitem (mult);\n    printf (\"\\nresistor value : %ld -ohms\\n\\n\", rval);\n\n    return 0;\n}\n\n/** search item_list for color code 'ccode', return index\n *  returns array index on success, -1 otherwise.\n */\nint srchitems (char *ccode)\n{\n    int i;\n    char lccode[MAXCC] = \"\";\n\n    strcpy2lower (lccode, ccode);\n\n    for (i = 0; i &lt; (int)nitems; i++)\n        if (*lccode == *(item_list[i].name))\n            if (!scmp (item_list[i].name, lccode))\n                return i;\n\n    return -1;\n}\n\n/** copy and convert string to lowercase.\n *  returns copy of string with all chars converted to lowercase.\n *  ('dest' must be of sufficient size of hold 'src')\n */\nchar *strcpy2lower (char *dest, char *src)\n{\n    if (!src || !dest) return NULL;\n\n    char *d = dest;\n\n    for (; *src; src++, d++)\n        if ('A' &lt;= *src &amp;&amp; *src &lt;= 'Z')\n            *d = *src | (1 &lt;&lt; 5);\n        else\n            *d = *src;\n\n    *d = 0;\n\n    return dest;\n}\n\n/** simple string comparison (like strcmp) */\nint scmp (char *a, char *b)\n{\n    if (!a &amp;&amp; !b) return 0;\n    if ( a &amp;&amp; !b) return 1;\n    if (!a &amp;&amp;  b) return -1;\n\n    for (; *a &amp;&amp; *b &amp;&amp; *a == *b; a++, b++) {}\n\n    return *a - *b;\n}\n\nvoid prnitem (int i)\n{\n    printf (\" item_list[%d]  name: %-6s  id: %d\\n\", \n            i, item_list[i].name, item_list[i].id);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Valid resistor colors (uppercase or lowercase characters are fine)</p>\n\n<pre><code>$ ./bin/resistor green blue yellow\n\ncolor bands determining significant figures:\n\n item_list[5]  name: green   id: 5\n item_list[6]  name: blue    id: 6\n\nmultiplier:\n\n item_list[4]  name: yellow  id: 4\n\nresistor value : 560000 -ohms\n\n\n$ ./bin/resistor Red Orange Violet Black\n\ncolor bands determining significant figures:\n\n item_list[2]  name: red     id: 2\n item_list[3]  name: orange  id: 3\n item_list[7]  name: violet  id: 7\n\nmultiplier:\n\n item_list[0]  name: black   id: 0\n\nresistor value : 237 -ohms\n</code></pre>\n\n<p>Invalid colors generate individual errors:</p>\n\n<pre><code>$ ./bin/resistor pink silver green\n\ncolor bands determining significant figures:\n\nerror: invalid color 'pink'\nerror: invalid color 'silver'\n</code></pre>\n\n<p><strong>Splitting Number Every 3rd char</strong></p>\n\n<p>Rather than a fairly complicated approach where you are relying on numeric calculations to test/separate your number, why not just convert your <code>number</code> to a string (without decimal places) and then simply work backwards from the end copying characters to a new string and add a <code>space</code> every 3rd character? It makes things a whole lot easier. (even though you are using a <code>double</code> for some unheard-of-reason -- assuming you will ultimately incorporate tolerance) It really makes no difference with this approach. Give the following a try:</p>\n\n<pre><code>void print_number (double number)\n{\n    char numstr[3 * MAXCC] = \"\", sepstr[3 * MAXCC] = \"\";\n    char *p = NULL;\n    size_t idx = 0, len = 0;\n\n    sprintf (numstr, \"%.0lf\", number);  /* write double to string */\n    len = strlen (numstr);              /* get length */\n    p = sepstr + 3 * MAXCC - 2;         /* set p at last char in sepstr */\n\n    while (len--) {         /* for each char in numstr */\n        if (idx++ == 3) {   /* if 3 characters copied  */\n            idx = 1;        /* reset index */\n            *p-- = ' ';     /* write a space in sepstr */\n        }\n        *p = numstr[len];   /* write char in sepstr    */\n        if (len) p--;       /* decrement p if not at 0 */\n    }\n\n    printf (\"p : '%s'\\n\", p);  /* print the separate value */\n}\n</code></pre>\n\n<p><strong>note</strong>, you can simply pass a character array to <code>print_number</code> and copy <code>p</code> to the array if you want to make the array available back in <code>main</code> for formatting reasons (you can even change <code>print_number</code> to return <code>char *</code> in that case.) Let me know if it works. If you can't do it that way, then I'll work through your numeric logic, but that will take aspirin and will probably be in the morning <code>:)</code></p>\n\n<p><strong>Example <code>print_number</code> Output</strong></p>\n\n<pre><code>           5 =&gt; '5'\n          55 =&gt; '55'\n         555 =&gt; '555'\n        5555 =&gt; '5 555'\n       55555 =&gt; '55 555'\n      555555 =&gt; '555 555'\n     5555555 =&gt; '5 555 555'\n    55555555 =&gt; '55 555 555'\n   555555555 =&gt; '555 555 555'\n</code></pre>\n\n<p><strong>Example of Actual Implementation</strong></p>\n\n<p>Here is the way I implemented it into my code. Essentially, you just move <code>sepstr</code> declaration/initialization into <code>main</code> and then pass it as an array to your <code>print_number</code> (my <code>sepnumber</code> below).</p>\n\n<pre><code>char *sepnumber (char *s, long val);\n...\n    long rval = 0;\n    char rstr[3 * MAXCC] = \"\";\n    ...\n    printf (\"\\nresistor value : %s -ohms\\n\\n\", sepnumber (rstr, rval));\n\n    return 0;\n}\n...\n/** separate long value every 3rd char into 's' */\nchar *sepnumber (char *s, long val)\n{\n    char numstr[3 * MAXCC] = \"\";\n    char *p = numstr;\n    size_t idx = 0, len = 0;\n\n    sprintf (numstr, \"%ld\", val);\n    for (; *p; p++) {}\n    len = p - numstr;\n    p = s + 3 * MAXCC - 2;\n\n    while (len--) {\n        if (idx++ == 3) {\n            idx = 1;\n            *p-- = ' ';\n        }\n        *p = numstr[len];\n        if (len) p--;\n    }\n    for (idx = 0; *p; p++, idx++) s[idx] = *p; /* copy to s */\n    s[idx] = *p;    /* nul-terminate */\n\n    return s;\n}\n</code></pre>\n\n<p><strong>Example/Output</strong></p>\n\n<pre><code>$ ./bin/resistor green blue yellow\n\ncolor bands determining significant figures:\n\n item_list[5]  name: green   id: 5\n item_list[6]  name: blue    id: 6\n\nmultiplier:\n\n item_list[4]  name: yellow  id: 4\n\nresistor value : 560 000 -ohms\n\n\n$ ./bin/resistor Red Orange Violet Brown\n\ncolor bands determining significant figures:\n\n item_list[2]  name: red     id: 2\n item_list[3]  name: orange  id: 3\n item_list[7]  name: violet  id: 7\n\nmultiplier:\n\n item_list[1]  name: brown   id: 1\n\nresistor value : 2 370 -ohms\n</code></pre>\n\n<p><strong>Reinitialize Values When Looping for Input</strong></p>\n\n<p>Given your description of the problem, I strongly suspect the issue you are having is due to not resetting/reinitializing <code>rval = 0;</code> (your <code>resistor_value</code>) at the end of each loop (or some similar value). Always check which values may be additive, etc. and remember to reset those values at the beginning of each loop. Another way to handle this in most cases is to declare the variables within the scope of the loop so that they are automatically reinitialized each iteration.</p>\n\n<p>Using block scope for the loop, your <code>main</code> should be similar to the following:</p>\n\n<pre><code>int main (void) {\n\n    for (;;) {                      /* loop for input */\n        int err = 0, i, mult, r;    /* variables have block scope only */\n        long rval = 0;\n        char ccode[MAXCC] = \"\", rstr[3 * MAXCC] = \"\";\n\n        printf (\"\\nEnter the colours of the resistor's three bands,\\n\"\n                \"beginning with the band nearest to the end.\\n\");\n        for (i = 0; i &lt; MINC; i++) { /* convert colors to index */\n            printf (\"Band %d =&gt; \", i + 1);\n            if (scanf (\" %7s\", ccode) != 1) {\n                fprintf (stderr, \"error: invalid input or EOF.\\n\");\n                return 1;\n            }\n            if ((r = srchitems (ccode)) != -1) {\n                if (i &lt; 2) {\n                    rval = rval * 10 + r;    /* form significant figure */\n                }\n                else {\n                    mult = srchitems (ccode);  /* get multiplier index  */\n                    rval *= multiplier[mult];  /* calculare final value */\n                }\n            }\n            else {\n                fprintf (stderr, \"error: invalid color '%s'\\n\", ccode);\n                err = 1;\n            }\n        }\n        if (err) return 1;\n        printf (\"Resistor value : %s -ohms\\n\", sepnumber (rstr, rval));\n        printf (\"\\nDo you want to decode another resistor (y/n)? \");\n        if (scanf (\" %7s\", ccode) != 1) {\n            fprintf (stderr, \"error: invalid input or EOF.\\n\");\n            return 1;\n        }\n        if (*ccode != 'y' &amp;&amp; *ccode != 'Y') break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/resistor2\n\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nBand 1 =&gt; green\nBand 2 =&gt; blue\nBand 3 =&gt; yellow\nResistor value : 560 000 -ohms\n\nDo you want to decode another resistor (y/n)? y\n\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nBand 1 =&gt; red\nBand 2 =&gt; orange\nBand 3 =&gt; orange\nResistor value : 23 000 -ohms\n\nDo you want to decode another resistor (y/n)? n\n</code></pre>\n\n<p>I suspect you can find your error with this hint.</p>\n"}], "owner": {"reputation": 101, "user_id": 6154024, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/594162740746583/picture?type=large", "display_name": "Amir", "link": "https://stackoverflow.com/users/6154024/amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7248, "favorite_count": 0, "accepted_answer_id": 37042622, "answer_count": 2, "score": 1, "last_activity_date": 1473517603, "creation_date": 1462341210, "last_edit_date": 1495535625, "question_id": 37019527, "link": "https://stackoverflow.com/questions/37019527/calculating-the-resistor-value-with-its-color-bands-as-input", "title": "Calculating the resistor value with its color bands as input", "body": "<p>I'm trying to develop a C program that calculates the resistor values by inputting the colour bands marked on the resistor.</p>\n\n<p>Ignoring the resistor tolerance.</p>\n\n<p>e.g. </p>\n\n<pre><code>Enter the colours of the resistor\u2019s three bands, beginning\nwith the band nearest the end. Type the colours in lowercase\nletters only, NO CAPS\nBand 1 =&gt; green\nBand 2 =&gt; black\nBand 3 =&gt; yellow\nResistance value: 500 000 -ohms\nDo you want to decode another resistor (Y/N)?\n=&gt; Y \n</code></pre>\n\n<blockquote>\n  <ol>\n  <li>Displaying the required format of the resistor value. For example, if the resistor value is \"500000 -ohms\", the format is required to be\n  \"500 000 -ohms\". A space has to be put between every 3 digits.</li>\n  <li>Displaying a single invalid colour. For example, if 'brown', 'vilet', and 'red' are inputted as the resistor colours, the program\n  generates the following message:  <code>Invalid colour: vilet</code> Here only\n  'vilet' is the only invalid colour.</li>\n  <li>Displaying more than one invalid colour. For example, if 'pink', 'silver', and 'red' are inputted as the resistor colours, the program\n  should generate the following message in a single line: \n  <code>Invalid colours: pink, silver</code> Here are two invalid colours 'pink' and\n  'silver'. Note the 'colours'.</li>\n  </ol>\n</blockquote>\n\n<p>Now I'm having a difficult time with getting the formatting for the total resistance (#1). And for #2 &amp; #3 if and only if the first input (band 1) is invalid the program will run. If the second band or third band are invalid without the first band being invalid, the program will stop execution.</p>\n\n<p>Here is the code that I've been working on:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n// resister bands\nenum resistor_band_items {BLACK, BROWN, RED, ORANGE, YELLOW, GREEN, BLUE, VIOLET, GRAY, WHITE, UNKNOWN};\n\nstruct items\n {\n    char *name;\n    enum resistor_band_items id;\n } item_list[] = {\n    {\"black\", BLACK},\n    {\"brown\", BROWN},\n    {\"red\", RED},\n    {\"orange\", ORANGE},\n    {\"yellow\", YELLOW},\n    {\"green\", GREEN},\n    {\"blue\", BLUE},\n    {\"violet\", VIOLET},\n    {\"gray\", GRAY},\n    {\"white\", WHITE}\n};\n\nchar answer[10], status[1] = \"Y\"; //answer =&gt; user input\nchar bands[3][10];      //string for resistor bands\n//variables to hold the band values\nint colour[3];\n//function prototype\nint inputVal (int *a, char b[3][10]);\ndouble calResistance (int a, int b, int c);\nvoid print_number (double number);\n\nint main(void)\n{\n    int i, invalid; //counter\n    double resistor_value; //total resistance value\n    enum resistor_band_items mid;\n    struct items *choice = NULL;\n\n    while (strcmp(status, \"Y\") == 0)\n    {\n        //print the question to the user\n        printf(\"Enter the colours of the resistor's three bands,\\nbeginning with the band nearest to the end.\\nType the coloues in lowercase letters only, NO CAPS.\\n\");    \n        for (int j = 0; j&lt;3; j++)\n        {   \n            printf(\"Band %d =&gt; \", j + 1);\n            gets(answer);\n            for (i = 0, choice = NULL; i &lt; sizeof item_list/sizeof(struct items); ++i)\n            {\n                if (strcmp(answer, item_list[i].name) == 0)\n                {\n                    choice = item_list + i;\n                    break;\n                }\n            }\n            mid = choice ? choice -&gt;id : UNKNOWN;\n            colour[j] =  mid;\n            strcpy(bands[j], answer);\n        }\n        invalid = inputVal (colour, bands);\n        if (invalid == 0)\n        {\n            //calculate resistor value\n            resistor_value = calResistance(colour[0], colour[1],colour[2]);\n            // print resistor value to user\n            printf(\"%.0f\\n\", resistor_value);\n            print_number(resistor_value);\n        }\n        printf(\"Do you want to decode another resistor (Y/N)?\\n\");\n        gets(status);\n        if (strcmp(status, \"Y\") == 0);\n        else break;\n    }   \n    return 0;\n}\nint inputVal (int *a, char b[3][10])\n{\n    int counter = 0, index[3];\n    for (int i = 0; i &lt; 3; ++i)\n    {\n        if (a[i] == 10)\n        {\n            index[i] = i;\n            //printf(\"%s%s\", b[i], \" \");\n            counter++;\n        }\n    }\n    if (counter == 0)\n    {\n        return 0;\n    }\n    else if (counter == 1)\n    {\n        printf(\"Invalid colour: %s\\n\", b[index[0]]);\n    }\n    else if (counter == 2)\n    {\n        printf(\"Invalid colours:\");\n        printf(\" %s\", b[index[0]]);\n        printf(\",\");\n        printf(\" %s\\n\", b[index[1]]);\n    }\n    else\n    {\n        printf(\"Invalid colours:\");\n        printf(\" %s\", b[index[0]]);\n        printf(\",\");\n        printf(\" %s\", b[index[1]]); \n        printf(\",\");\n        printf(\" %s\\n\", b[index[2]]);   \n    }\n    return 1;\n}\n\ndouble calResistance (int a, int b, int c)\n{\n    double results;\n    unsigned power = 10;\n    while (b &gt;= power)\n    {\n        power *= 10;\n    }\n    results = a * power + b;\n    results = results * pow(10, c);\n    return results;\n}\n\nvoid print_number (double number)\n{\n    double n = number,  *x;\n    int c = 0;\n    int j = 1;\n    while   (n != 0 &amp;&amp; n &gt; 1)\n    {\n\n        n /= 10.0;\n\n        c += 1;\n    }\n    x = malloc (c * sizeof(double));\n    printf(\"%d\\n\", c);\n\n    for (int i = 0; i &lt;= c; i++)\n     {\n        double digit = fmod (number, 10.0);\n        x[i] = digit;\n        number /= 10.0;\n     }\n\n     printf(\"Resistance value: \\n\\n\"); \n\n     for (int i = c - 1; i &gt;= 0; i--)\n     {\n        printf(\"#%d = %.0f\\n\",i, x[i]);\n     }\n    printf(\"\\n\\n\\n\");\n\n    for (int i = c - 1; i &gt;= 0; i--)\n    {\n\n        if (j == 3 || j == 7 || j == 11 || j == 15)\n        {\n            printf(\" \");\n        }\n        else\n        {\n            printf(\"%.0f\", x[i]);\n        }\n        j++;\n    }\n    printf(\" -ohms\\n\");\n    //free(x);\n}\n</code></pre>\n\n<p>I've edited the print_number function so it prints a space every 3rd digit. (It works with most combinations)</p>\n\n<pre><code>void print_number (double number)\n{\n    double n = number,  *x;\n    int c = 0;\n    int j = 1;\n    while   (n != 0 &amp;&amp; n &gt; 1)\n    {\n\n        n /= 10.0;\n\n        c += 1;\n    }\n    x = malloc (c * sizeof(double));\n    printf(\"c = %d\\n\", c);\n    for (int i = 0; i &lt; c; i++)\n     {\n        double digit = fmod (number, 10.0);\n        x[i] = digit;\n        number /= 10.0;\n     }\n\n     printf(\"Resistance value: \\n\"); \n\n     for (int i = c; i &gt;= 0; i--)\n     {\n        printf(\"#%d = %.0f\\n\",i, x[i]);\n     }\n     printf(\"\\n\\n\");\n     printf(\"remainder of c = %d\\n\\n\",c%3);\n    if (c % 3 == 2)\n    {\n        for (int i = c; i &gt;= 0; i--)\n        {\n            if (j == 4 || j == 7 || j == 11 || j == 15)\n                {\n                    printf(\" \");\n                    i++;\n                }\n                else\n                {\n                    printf(\"%.0f\", x[i]);\n                }\n            j++;\n        }\n        printf(\" -ohms\\n\"); \n    }\n    else\n    {\n        for (int i = c - 1 ; i &gt;= 0; i--)\n        {\n            //printf(\"%.0f\", x[i]);\n\n            if (c % 3 == 0)\n            {\n                if (j == 4 || j == 8 || j == 12 || j == 16)\n                {\n                    printf(\" \");\n                    i++;\n                }\n                else\n                {\n                    printf(\"%.0f\", x[i]);\n                }\n            }\n            else if (c % 3 == 1)\n            {\n                if (j == 2 || j == 6 || j == 10 || j == 14)\n                {\n                    printf(\" \");\n                    i++;\n                }\n                else\n                {\n                    printf(\"%.0f\", x[i]);\n                }\n            }   \n            j++;\n        }\n        printf(\" -ohms\\n\");\n        //free(x);      \n    }\n}\n</code></pre>\n\n<h1>Rev 2</h1>\n\n<p>Here the modified code from the answers.\nThe reason I'm not using <code>argc</code>and <code>argv</code>is that the client has a restricted formatting that needs to be followd (Which drives me mad!)</p>\n\n<p>here is the code:</p>\n\n<pre><code>    //importing required header files\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n// resister bands\nenum resistor_band_items {BLACK, BROWN, RED, ORANGE, YELLOW, GREEN,\n                                 BLUE, VIOLET, GRAY, WHITE, UNKNOWN};\n\n//constants for min/max colour arguments and max colour char\nenum {MINC = 3, MAXC = 4, MAXCC = 8};\nstruct items\n {\n    char *name;\n    enum resistor_band_items id;\n } item_list[] = {\n    {\"black\", BLACK},\n    {\"brown\", BROWN},\n    {\"red\", RED},\n    {\"orange\", ORANGE},\n    {\"yellow\", YELLOW},\n    {\"green\", GREEN},\n    {\"blue\", BLUE},\n    {\"violet\", VIOLET},\n    {\"gray\", GRAY},\n    {\"white\", WHITE}\n};\n//resistor multiplier values\nint multiplier[] = {1, 10, 100, 1000, 10000, 100000, 1000000, 10000000};\nchar answer[3][10]; // User input\nint colour_val[3]; //stores the band value\n\n#define nItems (sizeof item_list/sizeof *item_list)\n//function prototyps\nint srchItems (char *ccode); //a search for index values\nchar *strcpy2lower (char *dest, char *src); //converts to lower case\nint scmp (char *a, char *b); //simple string comarison\nchar *sepnumber (char *s, long val);\nint invalid (char answer[3][10]);\n//main function\nint main(int argc, char const *argv[])\n{\n    int i; // counter \n    char status = 'Y';// Keeps the program running when user inputs 'Y'\n    long resistor_value = 0; //Total resistance\n    int r, err, mult; //holds the significant figure, Error, Multiplier\n    char resistor_value_string[20] = \"\";//formatted output\n    while (status == 'Y') //The program runs under this\n    {\n        //print the question to the user\n        printf(\"Enter the colours of the resistor's three bands,\\nbeginning with the band nearest to the end.\\nType the coloues in lowercase letters only, NO CAPS.\\n\");\n        for (i = 0; i &lt; MINC; ++i)\n        {\n            printf(\"Band %d =&gt; \", i + 1); // print headers for each band\n            scanf(\" %s\", &amp;answer[i]);  // get the user input\n        }\n        for (i = 0; i &lt; MINC - 1; ++i) //converts colours into index\n        {\n            if ((r = srchItems (answer[i])) &gt; -1)\n            {\n                // from significant figure\n                resistor_value = (resistor_value * 10) + r;\n            }\n            else\n            {\n                invalid(answer);\n                err = 2; \n\n            }\n        }\n        if (err &gt; 1)\n        {\n            printf(\"Do you want to decode anothe resistor (Y/N)?\\n\");\n            scanf (\" %c\", &amp;status);\n            if (status == 'Y');\n            else break; \n        }\n        else\n        {\n            mult = srchItems (answer[i]);       // get multiplier index\n            resistor_value *= multiplier[mult]; // Calculate final value\n\n            sepnumber (resistor_value_string, resistor_value);\n            printf(\"Resistor value: \");\n            /*for (int i = 0; i &lt; (strlen(resistor_value_string) ); ++i)\n            {\n                printf(\"%c\", resistor_value_string[i]);\n            }\n            */\n            puts (resistor_value_string);   \n            //printf(\" -ohm\\n\");\n            //memset (resistor_value_string, 0, 50);\n            printf(\"Do you want to decode anothe resistor (Y/N)?\\n\");\n            scanf (\" %c\", &amp;status);\n            if (status == 'Y');\n            else break;\n            /*Debug \n            for (int i = 0; i &lt; MINC; ++i)\n            {\n                printf(\"item_list[%d] = %s\\n\", i, answer[i]);\n            }\n            printf(\"Total resistance = %ld\\n\", resistor_value);\n            //end of debug */\n        }\n    }\n    return 0;\n}\n\nint srchItems (char *ccode)\n{\n    int i;\n    char lccode [MAXCC] = \"\";\n    strcpy2lower (lccode, ccode); // converts everything to lower case\n    for (int i = 0; i &lt; (int)nItems; ++i) \n        if (*lccode == *(item_list[i].name))\n            if (!scmp(item_list[i].name, lccode))\n                return i;\n    return -1;\n}\n\nchar *strcpy2lower (char *dest, char *src)\n{\n    if (!src || !dest) return NULL;\n    char *d = dest;\n    for (; *src; src++, d++)\n        if ('A' &lt;= *src &amp;&amp; *src &lt;= 'Z')\n            *d = *src | (1 &lt;&lt; 5);\n        else\n            *d = *src;\n    *d = 0;\n    return dest;\n}\n\nint scmp (char *a, char *b)\n{\n    if (!a &amp;&amp; !b) return 0;\n    if ( a &amp;&amp; !b) return 1;\n    if (!a &amp;&amp;  b) return -1;\n\n    for (; *a &amp;&amp; *b &amp;&amp; *a == *b; a++, b++) {}\n\n    return *a - *b;\n}\n\n\n/** separate long value every 3rd char into 's' */\nchar *sepnumber (char *s, long val)\n{\n    char numstr[3 * MAXCC] = \"\";\n    char *p = numstr;\n    size_t idx = 0, len = 0;\n\n    sprintf (numstr, \"%ld\", val);\n    for (; *p; p++) {}\n    len = p - numstr;\n    p = s + 3 * MAXCC - 2;\n\n    while (len--) {\n        if (idx++ == 3) {\n            idx = 1;\n            *p-- = ' ';\n        }\n        *p = numstr[len];\n        if (len) p--;\n    }\n    for (idx = 0; *p; p++, idx++) s[idx] = *p; /* copy to s */\n    s[idx] = *p;    /* nul-terminate */\n    return s;\n}\n\nint invalid (char answer[3][10])\n{\n    int r, counter = 0, incorrect[3], i;\n\n    for (i = 0; i &lt; MINC; ++i)\n    {\n        if ((r = srchItems (answer[i])) == -1)\n        {\n            incorrect[i] = r;\n            counter++;\n        }\n    }\n    if (counter == 1)\n    {\n        printf(\"%s\",\"Invalid colour: \" );\n        printf(\"%s \", answer[i]);\n        printf(\"\\n\");\n    }\n    i = 0;\n}\n</code></pre>\n\n<p>This rev works well for the first loop, but it calculates the wrong resistor value on the second loop onwards. \nIt will print the invalid entries with a little difficulty!\nAfter an invalid colour is inputted the program will not calculate any resistor values.</p>\n\n<h2>out put examples:</h2>\n\n<pre><code>$ ./RQ1.exe\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the coloues in lowercase letters only, NO CAPS.\nBand 1 =&gt; red\nBand 2 =&gt; orange\nBand 3 =&gt; green\nResistor value: 2 300 000\nDo you want to decode anothe resistor (Y/N)?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the coloues in lowercase letters only, NO CAPS.\nBand 1 =&gt; green\nBand 2 =&gt; black\nBand 3 =&gt; yellow\nResistor value: -2 101 970 656\nDo you want to decode anothe resistor (Y/N)?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the coloues in lowercase letters only, NO CAPS.\nBand 1 =&gt; read\nBand 2 =&gt; gren\nBand 3 =&gt; blu\nDo you want to decode anothe resistor (Y/N)?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the coloues in lowercase letters only, NO CAPS.\nBand 1 =&gt; red\nBand 2 =&gt; orange\nBand 3 =&gt; green\nDo you want to decode anothe resistor (Y/N)?\nN\n</code></pre>\n\n<h1>Final Rev,</h1>\n\n<p>I think this is it:) beside the fact that it still has problem displaying the invalid inputs.</p>\n\n<p>A really big tanks to  <a href=\"https://stackoverflow.com/users/3422102/david-c-rankin\">David C. Rankin</a> for helping out so much. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define nItems (sizeof item_list/sizeof *item_list)\n\nchar status = 'Y'; \n//\nenum {MINC = 3, MAXCC = 10};\n// resister bands\nenum resistor_band_items {BLACK, BROWN, RED, ORANGE, YELLOW, GREEN,\n                                 BLUE, VIOLET, GRAY, WHITE, UNKNOWN};\nstruct items\n {\n    char *name;\n    enum resistor_band_items id;\n } item_list[] = {\n    {\"black\", BLACK},\n    {\"brown\", BROWN},\n    {\"red\", RED},\n    {\"orange\", ORANGE},\n    {\"yellow\", YELLOW},\n    {\"green\", GREEN},\n    {\"blue\", BLUE},\n    {\"violet\", VIOLET},\n    {\"gray\", GRAY},\n    {\"white\", WHITE}\n};\nunsigned int multiplier[] = {1, 10, 100, 1000, 10000, 100000, 1000000,\n     10000000, 100000000, 1000000000};\n\nint srchItems (char *ccode); //a search for index values\nchar *strcpy2lower (char *dest, char *src); //converts to lower case\nint scmp (char *a, char *b); //simple string comarison\nchar *sepnumber (char *s, long val); //puts space every 3rd digit\n\nint main(void)\n{\n    int i, error = 0, mult;\n    char input[MINC][MAXCC]; //user input\n    char invalid[MINC][MAXCC]; // invalid enteries\n    int colour_val[MINC]; //stores the band value\n    long total_resistance = 0; \n    char resistor_value_string[20] = \"\";//formatted output\n    do\n    {\n    //prompt user \n    printf(\"%s\\n%s\\n%s\\n\",\n        \"Enter the colours of the resistor's three bands,\",\n        \"beginning with the band nearest to the end.\",\n        \"Type the colours in lowercase letters only, NO CAPS.\");\n\n    for (i = 0; i &lt; MINC; ++i)\n    {\n        printf(\"Band %d =&gt; \", i + 1); // print headers for each band\n        scanf(\" %s\", &amp;input[i]);  // get the user input\n        // converts user input to index of colours\n        colour_val[i] = srchItems(input[i]); \n    }       \n    for (i = 0; i &lt; MINC; ++i)\n    {\n        if (colour_val[i] == -1)\n        {\n            strcpy(invalid[i], input[i]);\n            error++;\n        }\n    }\n    if (error &gt; 0)\n    {\n        if (error == 1)\n        {\n            printf(\"Invalid colour: %s\\n\", invalid[0]);\n        }\n        else if (error == 2)\n        {\n            printf(\"Invalid colours: %s, %s\\n\", invalid[0], invalid[1]);\n        }\n        else \n        {\n            printf(\"Invalid colours: %s, %s, %s\\n\",\n             invalid[0], invalid[1], invalid[2]);\n        }\n    }\n    else\n    {\n        //\n        for (i = 0; i &lt; MINC - 1; ++i)\n        {\n            total_resistance = (total_resistance * 10) + colour_val[i];\n        }\n        mult = colour_val[2];\n        total_resistance *= multiplier[mult];\n        sepnumber (resistor_value_string, total_resistance);\n\n        printf(\"Resistance value: %s -Ohms\\n\", resistor_value_string);\n//debug\n        for (i = 0; i &lt; MINC; ++i)\n        {\n            //printf(\"Input ==&gt; %s\\t\", input[i]);\n            //printf(\"index ==&gt; %d\\n\", colour_val[i]);\n        }\n//end debug\n    }\n    error = 0;\n    total_resistance = 0;\n    for (i = 0; i &lt; MINC; ++i)\n    {\n        colour_val[i] = 0;\n    }\n    //ask user if they want to continue\n    printf(\"Do you want to decode another resistor?\\n\");\n    scanf(\" %c\", &amp;status);\n\n\n    if (status == 'Y');\n    else break;\n\n    } while (status == 'Y');\n\n\n\n    return 0;\n}\n\nint srchItems (char *ccode)\n{\n    int i;\n    char lccode [MAXCC] = \"\";\n    strcpy2lower (lccode, ccode); // converts everything to lower case\n    for (int i = 0; i &lt; (int)nItems; ++i) \n        if (*lccode == *(item_list[i].name))\n            if (!scmp(item_list[i].name, lccode))\n                return i;\n    return -1;\n}\n\nchar *strcpy2lower (char *dest, char *src)\n{\n    if (!src || !dest) return NULL;\n    char *d = dest;\n    for (; *src; src++, d++)\n        if ('A' &lt;= *src &amp;&amp; *src &lt;= 'Z')\n            *d = *src | (1 &lt;&lt; 5);\n        else\n            *d = *src;\n    *d = 0;\n    return dest;\n}\n\nint scmp (char *a, char *b)\n{\n    if (!a &amp;&amp; !b) return 0;\n    if ( a &amp;&amp; !b) return 1;\n    if (!a &amp;&amp;  b) return -1;\n\n    for (; *a &amp;&amp; *b &amp;&amp; *a == *b; a++, b++) {}\n\n    return *a - *b;\n}\n\n/** separate long value every 3rd char into 's' */\nchar *sepnumber (char *s, long val)\n{\n    char numstr[3 * MAXCC] = \"\";\n    char *p = numstr;\n    size_t idx = 0, len = 0;\n\n    sprintf (numstr, \"%ld\", val);\n    for (; *p; p++) {}\n    len = p - numstr;\n//printf(\"%d\\n\", len);\n    p = s + 3 * MAXCC - 2;\n\n    while (len--) {\n        if (idx++ == 3) {\n            idx = 1;\n            *p-- = ' ';\n        }\n        *p = numstr[len];\n        if (len) p--;\n    }\n    for (idx = 0; *p; p++, idx++) s[idx] = *p; /* copy to s */\n    s[idx] = *p;    /* nul-terminate */\n    return s;\n}\n</code></pre>\n\n<h2> Output example </h2>\n\n<pre><code>$ ./Q1_token.exe\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the colours in lowercase letters only, NO CAPS.\nBand 1 =&gt; green\nBand 2 =&gt; black\nBand 3 =&gt; yellow\nResistance value: 500 000 -Ohms\nDo you want to decode another resistor?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the colours in lowercase letters only, NO CAPS.\nBand 1 =&gt; red\nBand 2 =&gt; orange\nBand 3 =&gt; green\nResistance value: 2 300 000 -Ohms\nDo you want to decode another resistor?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the coloues in lowercase letters only, NO CAPS.\nBand 1 =&gt; pink\nBand 2 =&gt; silver\nBand 3 =&gt; red\nInvalid colours: pink, silver\nDo you want to decode another resistor?\nY\nEnter the colours of the resistor's three bands,\nbeginning with the band nearest to the end.\nType the colours in lowercase letters only, NO CAPS.\nBand 1 =&gt; vilot\nBand 2 =&gt; brown\nBand 3 =&gt; read\nInvalid colours: vilot, silver\nDo you want to decode another resistor?\nN\n</code></pre>\n"}, {"tags": ["c", "multithreading", "file", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1462338527, "post_id": 37018893, "comment_id": 61589120, "body": "The <code>volatile</code> part is not related to the not-accessing-simultaneously."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1462344711, "post_id": 37018893, "comment_id": 61591840, "body": "As already debated endlessly on SO, volatile does not make reads/writes atomic and cannot be used for re-entrancy purposes. However, it is good practice to declare all variables shared with a callback as volatile, to prevent incorrect code optimization by bad compilers that don&#39;t realize that code inside a callback can be executed at any time. In some cases volatile can also act as a memory barrier."}], "answers": [{"comments": [{"owner": {"reputation": 2163, "user_id": 1781548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cae6c8f9ef172f395b2b183320804fe5?s=128&d=identicon&r=PG", "display_name": "Pippi", "link": "https://stackoverflow.com/users/1781548/pippi"}, "edited": false, "score": 0, "creation_date": 1462339604, "post_id": 37019010, "comment_id": 61589521, "body": "Thank you! I read more online resources, and it seems that multithreading does not work with disk IO."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 2163, "user_id": 1781548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cae6c8f9ef172f395b2b183320804fe5?s=128&d=identicon&r=PG", "display_name": "Pippi", "link": "https://stackoverflow.com/users/1781548/pippi"}, "edited": false, "score": 0, "creation_date": 1462339704, "post_id": 37019010, "comment_id": 61589553, "body": "@Pippi You need to consider the fact that files are resources that can be seen by everyone on the system, not only your process. So it will work under the assumption that your processes is the only users of that file."}, {"owner": {"reputation": 2163, "user_id": 1781548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cae6c8f9ef172f395b2b183320804fe5?s=128&d=identicon&r=PG", "display_name": "Pippi", "link": "https://stackoverflow.com/users/1781548/pippi"}, "edited": false, "score": 0, "creation_date": 1462339853, "post_id": 37019010, "comment_id": 61589608, "body": "I agree. Thank you for this suggestion!"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 4, "last_activity_date": 1462338963, "creation_date": 1462338963, "answer_id": 37019010, "question_id": 37018893, "link": "https://stackoverflow.com/questions/37018893/how-to-use-pthread-in-c-to-prevent-simultaneous-read-and-write-to-a-file-on-disk/37019010#37019010", "title": "How to use pthread in C to prevent simultaneous read and write to a file on disk?", "body": "<p>According to the description, your problem is about protecting the files on the disk, not the stream descriptors(<code>FILE*</code>) that represents the files. You can try to use pthread's rwlock to synchronize concurrent access between multiple threads:</p>\n\n<pre><code>FILE *fp = fopen(...);\npthread_rwlock_t rwlock = PTHREAD_RWLOCK_INITIALIZER;\n\n// read thread:\nchar buf[BUFLEN];\npthread_rwlock_rdlock(&amp;rwlock);\nfread(buf, sizeof buf, 1, fp);\npthread_rwlock_unlock(&amp;rwlock);\n\n// write thread:\npthread_rwlock_wrlock(&amp;rwlock);\nfwrite(buf, sizeof buf, 1, fp);\npthread_rwlock_unlock(&amp;rwlock);\n</code></pre>\n\n<p>Note that this protect the file from accessed by multiple threads in the same process, this does not protect it from accessing by multiple processes on the system.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462376058, "post_id": 37019513, "comment_id": 61614351, "body": "Could you post the specification where <code>read()</code> and <code>write()</code> are guaranteed to be atomic?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462382424, "post_id": 37019513, "comment_id": 61618372, "body": "@EOF <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_09_07\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 2, "last_activity_date": 1462341168, "creation_date": 1462341168, "answer_id": 37019513, "question_id": 37018893, "link": "https://stackoverflow.com/questions/37018893/how-to-use-pthread-in-c-to-prevent-simultaneous-read-and-write-to-a-file-on-disk/37019513#37019513", "title": "How to use pthread in C to prevent simultaneous read and write to a file on disk?", "body": "<p>It depends on what you mean by \"will not access the files on disk simultaneously\". Since you talk about pthreads, it means you're on a POSIX system. POSIX already has certain guarantees about file access by multiple processes and threads.</p>\n\n<p>If you use the raw system calls <code>read</code> and <code>write</code> you're for example guaranteed that writes will be atomic. This means that if a <code>read</code> and <code>write</code> happen simultaneously (meaning: you don't know which starts first), the read will either see the entire change to the file that the write did or none of it (there might be some exceptions here on errors). Of course there are problems with reading and writing the same file descriptor by multiple threads since read/write updates the offset where the next read/write will happen. So doing an <code>lseek</code> and then <code>write</code> is unsafe if some other thread can touch the file descriptor between the seek and the write. But for that you have the system calls <code>pread</code> and <code>pwrite</code> that guarantee that the seek+read/write will be atomic.</p>\n\n<p>So by just going on this part of your problem description:</p>\n\n<blockquote>\n  <p>one write thread, and a few read threads, that write/read to a file on disk. I wish that no write / read will happen at the same time.</p>\n</blockquote>\n\n<p>this is already guaranteed by the operating system. The problem I think is that \"at the same time\" is a very vague requirement because almost nothing that accesses a shared resource (like a file or even memory) happens at the same time. When thinking about threads or just about any concurrency you need to frame the problem in terms of what needs to happen before/after some other thing.</p>\n"}], "owner": {"reputation": 2163, "user_id": 1781548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cae6c8f9ef172f395b2b183320804fe5?s=128&d=identicon&r=PG", "display_name": "Pippi", "link": "https://stackoverflow.com/users/1781548/pippi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2528, "favorite_count": 0, "accepted_answer_id": 37019010, "answer_count": 2, "score": 0, "last_activity_date": 1462341168, "creation_date": 1462338321, "last_edit_date": 1495541279, "question_id": 37018893, "link": "https://stackoverflow.com/questions/37018893/how-to-use-pthread-in-c-to-prevent-simultaneous-read-and-write-to-a-file-on-disk", "title": "How to use pthread in C to prevent simultaneous read and write to a file on disk?", "body": "<p>I am writing a program, which has one write thread, and a few read threads, that write/read to a file on disk. I wish that no write / read will happen at the same time. I found many examples which uses pthread mutex lock to protect memory array during write / read, such as declaring the protected memory array volatile.  </p>\n\n<pre><code>volatile int array[NUMBER];\npthread_mutex_t locks[NUMBER];\n\npthread_mutex_lock(&amp;locks[index]);\narray[acct] -= SOME_NUMBER;\npthread_mutex_unlock(&amp;locks[index]);\n</code></pre>\n\n<p>But I cannot find examples with using pthreads to protect files on disk. </p>\n\n<pre><code>volatile FILE* array[NUMBER]; ??\n</code></pre>\n\n<p>Can someone point me to the right direction? I wish write / read threads will not access the files on disk simultaneously.</p>\n\n<p>Edit: I read more, and according to this <a href=\"https://stackoverflow.com/questions/902425/does-multithreading-make-sense-for-io-bound-operations\">post</a>, it seems that multithreading does not work with disk IO. </p>\n"}, {"tags": ["c", "opencl", "gpu"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462339034, "post_id": 37018863, "comment_id": 61589291, "body": "Are you using C or C++?"}, {"owner": {"reputation": 600, "user_id": 3922042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38183fec5e90908b2f492df8f4343c57?s=128&d=identicon&r=PG", "display_name": "segevara", "link": "https://stackoverflow.com/users/3922042/segevara"}, "edited": false, "score": 0, "creation_date": 1462339874, "post_id": 37018863, "comment_id": 61589614, "body": "don&#39;t you think that it could be a race condition in this lines <code>_call[0] += _weight*_futures[k].put;                                                                                         _call_weight[0] += _weight;</code> ?"}, {"owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "reply_to_user": {"reputation": 600, "user_id": 3922042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38183fec5e90908b2f492df8f4343c57?s=128&d=identicon&r=PG", "display_name": "segevara", "link": "https://stackoverflow.com/users/3922042/segevara"}, "edited": false, "score": 0, "creation_date": 1462339961, "post_id": 37018863, "comment_id": 61589641, "body": "@segevara how can I call them sequentially?"}, {"owner": {"reputation": 600, "user_id": 3922042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38183fec5e90908b2f492df8f4343c57?s=128&d=identicon&r=PG", "display_name": "segevara", "link": "https://stackoverflow.com/users/3922042/segevara"}, "edited": false, "score": 0, "creation_date": 1462340151, "post_id": 37018863, "comment_id": 61589714, "body": "I mean that many threads is trying to add value in the same cell of array simultaneously"}, {"owner": {"reputation": 600, "user_id": 3922042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38183fec5e90908b2f492df8f4343c57?s=128&d=identicon&r=PG", "display_name": "segevara", "link": "https://stackoverflow.com/users/3922042/segevara"}, "edited": false, "score": 0, "creation_date": 1462340305, "post_id": 37018863, "comment_id": 61589767, "body": "you can use <a href=\"https://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/atomicFunctions.html\" rel=\"nofollow noreferrer\">atomic operation</a> of opencl or <a href=\"http://stackoverflow.com/questions/6890302/barriers-in-opencl\">barriers</a>"}, {"owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462340371, "post_id": 37018863, "comment_id": 61589790, "body": "@fluter On the host I am using mql5, just provided a translation to show what I want to replicate in the kernel"}, {"owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "reply_to_user": {"reputation": 600, "user_id": 3922042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38183fec5e90908b2f492df8f4343c57?s=128&d=identicon&r=PG", "display_name": "segevara", "link": "https://stackoverflow.com/users/3922042/segevara"}, "edited": false, "score": 0, "creation_date": 1462341707, "post_id": 37018863, "comment_id": 61590353, "body": "@segevara tried local and global barriers but the result is the same 0.0f"}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1462350303, "post_id": 37018863, "comment_id": 61595213, "body": "Structure of pointers, reduction using just += ..... Just delete all the code and start over. You need first to understand CL and how it works, before attempting to do one of the most difficult operations that can be done in CL."}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 1, "creation_date": 1462351052, "post_id": 37018863, "comment_id": 61595703, "body": "Ah, and you are very lucky it returns 0, and it does not crash your PC, after all those out of bounds memory accesses. Probably cl calls are returning error codes and not actually updating the output buffer value."}], "owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462347745, "creation_date": 1462338175, "last_edit_date": 1462347745, "question_id": 37018863, "link": "https://stackoverflow.com/questions/37018863/opencl-code-returns-zero", "title": "OpenCL code returns zero", "body": "<p>This open CL code compiles okay but on execution keeps returning 0.0f as the value of 'call[0]'</p>\n\n<pre><code>typedef struct tag_sinterest {\n    __global float *h_phi;\n    __global float *l_phi;\n} sinterest;\n\ntypedef struct tag_sfutures {\n    int time;\n    __global float put;\n    __global sinterest *call;\n} sfutures;\n\nfloat square(float _number) {\n    return(_number*_number);\n}\n\n__kernel void Futures(__global sfutures *_futures,\n    int _futures_index, __global float *_call, __global float *_call_weight) {\n    int i = get_global_id(0);\n    int j = get_global_id(1);\n    int k = get_global_id(2);\n\n    float _weight = 0.0f;\n\n    _weight += (float)square(_futures[_futures_index-1].call[j].h_phi[k]-_futures[i].call[j].h_phi[k]);\n    _weight += (float)square(_futures[_futures_index-1].call[j].l_phi[k]-_futures[i].call[j].l_phi[k]);\n\n    _call[0] += _weight*_futures[k].put;\n    _call_weight[0] += _weight;\n}\n</code></pre>\n\n<p>It is meant to replicate these for loops which work fine on the host (C#):</p>\n\n<pre><code>void Futures(Sfutures[] Futures,int FuturesIndex,ref float Call,ref float CallWeight) {\n    for(int f=0;f&lt;_FUTURES;f++) {\n        for(int I=0;I&lt;_INTEREST;I++) {\n            float _weight = 0.0f;\n\n            _weight += (float)pow(Futures[FuturesIndex-1].call[f].h_phi[I]-Futures[i].call[f].h_phi[I],2.0f);\n            _weight += (float)pow(Futures[FuturesIndex-1].call[f].l_phi[I]-Futures[i].call[f].l_phi[I],2.0f);\n\n            Call += _weight*Futures[i].put;\n            CallWeight += _weight;\n        }\n    }\n}\n</code></pre>\n\n<p>Why is this? I have an intel HD 4000, OpenCL 1.2 on windows 10 64-bit</p>\n"}, {"tags": ["c", "mips", "compiler-optimization"], "comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1462338770, "post_id": 37018833, "comment_id": 61589195, "body": "Depends, are a, b and c signed or unsigned? If a and b are unsigned, it can be simplified to  <code>do ... while();</code> because c would always start off greater than 5.  Also, (I think) with some math you can pull the +6 down into the conditional."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1462338971, "post_id": 37018833, "comment_id": 61589263, "body": "Based on the fact that the allowed instructions were for signed integers, I&#39;d make an educated guess that a, b, and c are signed. And you can&#39;t assume c is greater than 5 in either case anyway because of the possibility of integer overflow. Keep in mind though that everything I&#39;ve said is the only information that was given to me on the exam."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339161, "post_id": 37018833, "comment_id": 61589333, "body": "The reason you couldn&#39;t do it is because you&#39;re using a loop.  Pretty sure you can solve this in constant time."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339216, "post_id": 37018833, "comment_id": 61589358, "body": "@xaxxon please elaborate, I&#39;m not sure I understand what you mean."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339251, "post_id": 37018833, "comment_id": 61589372, "body": "b + 6 - (X*a) &gt; 5 -- solve for X so  b = b + X  and  C = C - X*a  --- there may be some off by one errors in there.   and I don&#39;t actually know if you can do that in less than 7 MIPS instructions"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462339424, "post_id": 37018833, "comment_id": 61589448, "body": "X * a &lt; b + 1 -- what&#39;s your point?"}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339505, "post_id": 37018833, "comment_id": 61589480, "body": "once you solve for X, you can simply assign values for <code>b</code> and <code>c</code> directly without a loop."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339563, "post_id": 37018833, "comment_id": 61589497, "body": "@xaxxon not when you&#39;re not allowed to use multiplication or division instructions, so that&#39;s rather moot."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462339604, "post_id": 37018833, "comment_id": 61589520, "body": "oh, oops.  I missed that part."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462339661, "post_id": 37018833, "comment_id": 61589541, "body": "If it&#39;s any consolation I suspect my professor never actually attempted the problem himself and just assumed it was possible in 7 instructions or less."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1462342781, "post_id": 37018833, "comment_id": 61590803, "body": "FWIW, it&#39;s a silly question for an exam IMHO. I don&#39;t know what the class was exactly but it reads more of a &quot;brain teaser&quot; than exam-worthy material."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1462343945, "post_id": 37018833, "comment_id": 61591413, "body": "@JeffMercado I agree with your assessment of the question, which is part of my frustration in the first place. To protect the privacy of my professor, I&#39;m not going to disclose the class this was for."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462995972, "post_id": 37018833, "comment_id": 61878583, "body": "go ask another professsor..."}], "answers": [{"comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462340989, "post_id": 37019298, "comment_id": 61590033, "body": "ok, but what does b &gt; 0 have to do with looping again?  Shouldn&#39;t that just be a &quot;while true&quot; type statement?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1462341064, "post_id": 37019298, "comment_id": 61590067, "body": "Can&#39;t use <code>b</code> instruction or <code>j</code>, so kinda clutching at feathers for that one. Not even sure it is the best condition to use"}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462341094, "post_id": 37019298, "comment_id": 61590078, "body": "you know the value of t2, right?  why not use that in the last line?"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462341133, "post_id": 37019298, "comment_id": 61590095, "body": "I see what you&#39;re trying to do. I like the idea but since I&#39;m including the possibility of integer overflow and/or of b being signed, I can&#39;t assume that its post increment value is greater than 0. That&#39;s a very good attempt though."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462341222, "post_id": 37019298, "comment_id": 61590138, "body": "@xaxxon, yea the value of t2 is 0 at that point, but I have to use <code>bne</code>. Does bne allow the use of immediate values? Can I do <code>bne $t2, 1, loop</code>?"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462341412, "post_id": 37019298, "comment_id": 61590228, "body": "<code>bne</code> only works with registers, it doesn&#39;t take immediate values unfortunately."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462341887, "post_id": 37019298, "comment_id": 61590436, "body": "remove line 2.  old line 3 now gets compared against 0 instead of 6.  old line 7 now BNE&#39;s on t2 and s0 (if s0 is 0 we&#39;re done anyhow).new last line adds 6 to c."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1462342133, "post_id": 37019298, "comment_id": 61590527, "body": "I just found it can be used with immediate values as well. It is apparently an I-type instruction"}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1462342199, "post_id": 37019298, "comment_id": 61590561, "body": "Huh.  That&#39;s not what I&#39;m seeing here, but I have no assumptions this is authoritative.. <a href=\"http://www.mrc.uidaho.edu/mrc/people/jff/digital/MIPSir.html\" rel=\"nofollow noreferrer\">mrc.uidaho.edu/mrc/people/jff/digital/MIPSir.html</a>  I think my answer works regardless, though."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462342300, "post_id": 37019298, "comment_id": 61590611, "body": "@Smac89 <a href=\"http://www-inst.eecs.berkeley.edu/~cs61c/resources/MIPS_Green_Sheet.pdf\" rel=\"nofollow noreferrer\">MIPS green sheet</a> does confirm it is immediate type but notice it ignores the immediate value specified. Its inputs are restricted to <code>rt</code> and <code>rd</code> registers."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462343630, "post_id": 37019298, "comment_id": 61591251, "body": "Just being a stickler here but can you provide documentation that supports $ra not being equal to 0 in all cases? I&#39;m not entirely certain we were allowed to assume that on our exam"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462344210, "post_id": 37019298, "comment_id": 61591569, "body": "@PatrickRoberts, you are right. That register is only updated by the <code>jal</code> instruction which basically copies the pc value to $ra. I have used something else as the loop"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462345483, "post_id": 37019298, "comment_id": 61592294, "body": "Now that is pretty solid. Even though the exit label is on the 8th line I might make this the accepted answer; you&#39;ve put in a lot of effort."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1462345782, "post_id": 37019298, "comment_id": 61592470, "body": "Never again dude. This was like optimisation level 7. I wonder what a compiler would have come up with if we use the highest optimisation level on it. I think GCC can produce MIPS. Will try this tomorrow"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462985923, "post_id": 37019298, "comment_id": 61872841, "body": "I figured it out. Turns out it is possible. I&#39;ll post my answer in a few hours as part of the question."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462990286, "post_id": 37019298, "comment_id": 61875501, "body": "Well I thought I had it but when thinking it out in my head I forgot I would need to invert the flag..."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462992840, "post_id": 37019298, "comment_id": 61876873, "body": "@PatrickRoberts still cracking away at this I see. I admire your tenacity :)"}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 3, "last_activity_date": 1462345102, "last_edit_date": 1462345102, "creation_date": 1462340183, "answer_id": 37019298, "question_id": 37018833, "link": "https://stackoverflow.com/questions/37018833/compile-c-to-mips-assembly-in-7-instructions/37019298#37019298", "title": "Compile C to MIPS Assembly in 7 instructions?", "body": "<p>What about this?</p>\n\n<pre><code>      addi $s1, $t0, 6     # d = a + 6\n      add $s0, $s1, $t1    # c = d + b\nloop: slti $t2, $s0, 6     # while (is c less than 6? i.e. c is not greater than 5) \n      bne $t2, $zero, exit # (c &lt;= 5)? exit\n      sub $s0, $s0, $t0    # c = c - a;\n      addi $t1, $t1, 1     # b = b + 1;\n      bne $s1, $t0, loop   # (True condition to loop: d != a)\nexit:\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462342588, "post_id": 37019710, "comment_id": 61590726, "body": "I&#39;m trying to think of edge cases that might invalidate this, but it seems to work as far as I can tell.."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462342628, "post_id": 37019710, "comment_id": 61590743, "body": "I guess you don&#39;t even need the t2 in line 6.. just use $0"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462342841, "post_id": 37019710, "comment_id": 61590837, "body": "Just two minor corrections, you need to change the <code>add</code> in line 7 to <code>addi</code> since it takes an immediate value. You can also change <code>slti</code> to <code>slt</code> and use $0 instead if you want, but that&#39;s just personal taste. I&#39;ll think about this tomorrow morning when I&#39;m more awake and if I still like it I&#39;ll accept. Here&#39;s an upvote."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462342940, "post_id": 37019710, "comment_id": 61590895, "body": "Thanks.   Yeah as you pointed out, I don&#39;t know mips asm -- I was just trying to understand the concepts not the syntax :)   reading the docs again, now I see.  fixed the add/addi."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462343221, "post_id": 37019710, "comment_id": 61591052, "body": "Ooh.. I just realized, the <code>bne</code> on line 6 is incorrect. Common edge case: when c is exactly 0, you&#39;ll increment it back to 6 which is greater than 5, in which case it should have looped again. Nice try though."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1462348105, "post_id": 37019710, "comment_id": 61593777, "body": "It&#39;s funny.. if greater than were allowed I&#39;d have some interesting solutions.  These numbers feel very carefully selected.   When you get your results back, PLEASE post the answer."}], "tags": [], "owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "is_accepted": false, "score": 4, "last_activity_date": 1462343033, "last_edit_date": 1462343033, "creation_date": 1462341961, "answer_id": 37019710, "question_id": 37018833, "link": "https://stackoverflow.com/questions/37018833/compile-c-to-mips-assembly-in-7-instructions/37019710#37019710", "title": "Compile C to MIPS Assembly in 7 instructions?", "body": "<p>Building off Smac89's answer, this guarantees that C isn't 0 unless the loop is done, so the value of C can be used to branch on.</p>\n\n<pre><code>      add  $s0, $t0, $t1    # c = a + b\nloop: slti $t2, $s0, 0      # while (is c less than 0? \n      bne  $t2, $zero, exit # (c &gt; 5)\n      sub  $s0, $s0, $t0    # c = c - a;\n      addi $t1, $t1, 1      # b = b + 1;\n      bne  $t2, $s0, loop   # Loop again unless s0 is 0 -- then we're done\nexit: addi $s0, $s0, 6      # add the missing 6 \n</code></pre>\n"}], "owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 37019298, "answer_count": 2, "score": 3, "last_activity_date": 1462990529, "creation_date": 1462338022, "last_edit_date": 1462990529, "question_id": 37018833, "link": "https://stackoverflow.com/questions/37018833/compile-c-to-mips-assembly-in-7-instructions", "title": "Compile C to MIPS Assembly in 7 instructions?", "body": "<p>I just took a final exam and there was a question that seemed impossible given the restrictions. I'd be happy to be proven wrong but as far as I checked around, at least all my classmates agreed with my conclusion. Here's the question and the answer(s) I provided:</p>\n\n<p>A C program snippet is provided as follows:</p>\n\n<pre><code>c = a + b + 6;\nwhile (c &gt; 5) {\n  c = c - a;\n  b = b + 1;\n}\n</code></pre>\n\n<p>Write the equivalent in MIPS assembly using at most 7 instructions, using only the following instruction set:</p>\n\n<pre><code>add, addi, sub, subi, slt, slti, bne\n</code></pre>\n\n<p>a, b and c are accessible through the registers $t0, $t1 and $s0 respectively. You may use other registers as necessary but you may not assume any initial value.</p>\n\n<p>Here's the answer I gave in as few lines as I could:</p>\n\n<pre><code>      add $s0, $t0, $t1\n      addi $s0, $s0, 6\nloop: slti $t2, $s0, 6\n      bne $t2, $0, skip\n      sub $s0, $s0, $t0\n      addi $t1, $t1, 1\nskip: subi $t2, $t2, 1\n      bne $t2, $0, loop\n</code></pre>\n\n<p>I thought about it for a good 30 minutes during the 3 hour exam and I came up with two possibilities that the professor could have mistaken on the question. The more likely to me is that he was expecting us to program a <code>do-while</code> loop. The other less likely is that we were allowed to use <code>beq</code> in addition to the other instructions. Here are my answers for those:</p>\n\n<p>do-while:</p>\n\n<pre><code>      add $s0, $t0, $t1\n      addi $s0, $s0, 6\nloop: sub $s0, $s0, $t0\n      addi $t1, $t1, 1\n      slti $t2, $s0, 6\n      subi $t2, $t2, 1\n      bne $t2, $0, loop\n</code></pre>\n\n<p><code>beq</code> allowed:</p>\n\n<pre><code>      add $s0, $t0, $t1\n      addi $s0, $s0, 6\nloop: slti $t2, $s0, 6\n      bne $t2, $0, skip\n      sub $s0, $s0, $t0\n      addi $t1, $t1, 1\nskip: beq $t2, $0, loop\n</code></pre>\n\n<p>I challenge anyone to find a shorter answer or to conclusively demonstrate that a shorter answer isn't possible, this has been bugging me a lot.</p>\n\n<h1>Update</h1>\n\n<p>I reviewed my final grade with my professor, and while he refused to provide an answer, he claimed that half the class got it correct. I found it unfair that my professor failed to provide proof of an existing answer while using that as the basis to deduct points from my exam, but there's not much I can do to argue my point, and would be unwise to pursue considering that with the curve for the low average on the final, I earned a 4.0 for the class.</p>\n\n<p>I was still skeptical though, because I had found that he misgraded one of my Verilog code snippets that I had gotten full credit for after reviewing my final with him, so I found someone who got full credit for the MIPS assembly problem. He told me his strategy but couldn't remember his exact answer so I helped him recreate it, basing off of @Smac89's answer:</p>\n\n<pre><code>      addi $t2, $t0, 6   # d = a + 6\n      add $s0, $t2, $t1  # c = d + b\n      bne $t2, $t0, comp # (d != a) ? comp\nloop: sub $s0, $s0, $t0  # c = c - a;\n      addi $t1, $t1, 1   # b = b + 1;\ncomp: slti $t2, $s0, 6   # d = (c &lt; 6)\n      subi $t2, $t2, 1   # invert the flag\n      bne $t2, $0, loop  # !(c &lt; 6) ? loop\n</code></pre>\n\n<p>So, this doesn't work either. The specific strategy he employed was that he had a guaranteed branch at the top of the loop and that he checked the condition at the bottom in two lines. However I can't think of a way to use <code>slt</code> or <code>slti</code> to create a valid flag to check with <code>bne</code>. It's possible that the professor may have misgraded whatever he attempted in 7 lines.</p>\n\n<p>In conclusion, I still don't have an answer.</p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1462337186, "post_id": 37018634, "comment_id": 61588710, "body": "If you say double is faster than single and then wonder why no speedup when using single, I don&#39;t really get the question. Also don&#39;t tag c code as c++"}, {"owner": {"reputation": 31, "user_id": 6288785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b628440bfcad0c37a94b9ce5df0748?s=128&d=identicon&r=PG&f=1", "display_name": "stg", "link": "https://stackoverflow.com/users/6288785/stg"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1462338734, "post_id": 37018634, "comment_id": 61589180, "body": "Oh..I mistaked.. double &lt;-&gt; single.  Correctly, &quot;Fermi generation GPU&#39;s single precision calculation should be 2 times faster than double precision.&quot;  I&#39;m very sorry."}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 2, "creation_date": 1462342174, "post_id": 37018634, "comment_id": 61590550, "body": "You count the memcpy (massive overhead), and your array is too small (10), meaning execution time must be hidden behind kernel spawn time"}, {"owner": {"reputation": 31, "user_id": 6288785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b628440bfcad0c37a94b9ce5df0748?s=128&d=identicon&r=PG&f=1", "display_name": "stg", "link": "https://stackoverflow.com/users/6288785/stg"}, "edited": false, "score": 0, "creation_date": 1462343157, "post_id": 37018634, "comment_id": 61591020, "body": "Thank you for your suggestion. But if cudaMemcpy was replaced out of the loop, it will be no difference between double and float. I think this problem is not rooted memcpy&#39;s overhead. and, array size is more large in original cord (over 100000).."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1462345374, "post_id": 37018634, "comment_id": 61592227, "body": "@stg: 100000 floating point multiplies is a trivial amount of work for any GPU. Your example is just measuring latency, not floating point performance, because there is far too little work in the kernels you are using."}, {"owner": {"reputation": 2526, "user_id": 6218300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e998956e67bb176a9e00b8bb20bf4b58?s=128&d=identicon&r=PG&f=1", "display_name": "Florent DUGUET", "link": "https://stackoverflow.com/users/6218300/florent-duguet"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1462349794, "post_id": 37018634, "comment_id": 61594846, "body": "@talonmies, should this example not be simplified-out by the optimizer, it would be a memory-bound problem. Hence, nothing related to &quot;floating point multiplies&quot;. Traversing 100000 floats read-write would take about 5 microseconds (if done well), way below kernel launch and mem copy."}], "answers": [{"comments": [{"owner": {"reputation": 2526, "user_id": 6218300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e998956e67bb176a9e00b8bb20bf4b58?s=128&d=identicon&r=PG&f=1", "display_name": "Florent DUGUET", "link": "https://stackoverflow.com/users/6218300/florent-duguet"}, "edited": false, "score": 1, "creation_date": 1462349536, "post_id": 37020935, "comment_id": 61594688, "body": "This code is memory-bound. In double precision, you have 64 DP units on your GTX 980, 1 FMA per cycle @ 1.216 GHZ =&gt; 156 GFLOPS. The bandwidth reads 224 GB/s. This leads to 5.57 FLOPS per memory operation (with theoretical peak). Expressing anything on DP-flops for this card requires at least 6 FLOPS (well, 3 multiplies should do as FLOPS account for FMA) per memory operation, you have 1 here. You are measuring bandwidth. (Moreover, getting peak bandwidth is hard, hence you might need even more FLOPS)."}, {"owner": {"reputation": 738, "user_id": 6172231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl3br.jpg?s=128&g=1", "display_name": "Taro", "link": "https://stackoverflow.com/users/6172231/taro"}, "edited": false, "score": 0, "creation_date": 1462349738, "post_id": 37020935, "comment_id": 61594807, "body": "But the first part of the answer points out what really goes wrong : the optimization during compilation that removes the useless computation. :)"}, {"owner": {"reputation": 31, "user_id": 6288785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b628440bfcad0c37a94b9ce5df0748?s=128&d=identicon&r=PG&f=1", "display_name": "stg", "link": "https://stackoverflow.com/users/6288785/stg"}, "edited": false, "score": 0, "creation_date": 1462353881, "post_id": 37020935, "comment_id": 61597582, "body": "Thanks all, now I understood about optimization. @Regis code float is 2x faster than double indeed, what is the meaning of this loop? If I rewrite kernel without loop (while <code>int i = blockIdx.x * blockDim.x + threadIdx.x ;</code> is left) with changing ITER 100000, there is no difference double and float. Memory-bound problem..? Umm..I&#39;m new in CUDA, I have to study more..thanks."}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 0, "creation_date": 1462356376, "post_id": 37020935, "comment_id": 61599337, "body": "you don&#39;t loop, you won&#39;t iterate through all elements. The meaning of the loop is to iterate through all elements in a <a href=\"http://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#coalesced-access-to-global-memory\" rel=\"nofollow noreferrer\">coalesced way</a>."}], "tags": [], "owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "is_accepted": true, "score": 6, "last_activity_date": 1462346262, "creation_date": 1462346262, "answer_id": 37020935, "question_id": 37018634, "link": "https://stackoverflow.com/questions/37018634/why-my-cuda-c-code-does-not-become-faster-with-single-precision/37020935#37020935", "title": "Why my cuda C code does not become faster with single precision?", "body": "<p>Well, after some investigation, that's because you just perform a multiplication by the constant 1, which gets optimized to \"do nothing\" in the binary: </p>\n\n<p><a href=\"https://i.stack.imgur.com/krrOz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/krrOz.png\" alt=\"enter image description here\"></a></p>\n\n<p>If instead you square the array (to prevent this trivial optimization), you get the following assembly: </p>\n\n<p><a href=\"https://i.stack.imgur.com/rhROz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rhROz.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the performance gains are restored on the below(simplified) piece of code, in which i changed a few things: </p>\n\n<ul>\n<li>way larger array (100M)</li>\n<li>using blockDim.x instead of an argument parameter</li>\n<li>use better kernel configuration for my machine (GTX 980)</li>\n<li>allocate input array on heap instead of stack (to allow more than 1M)  </li>\n</ul>\n\n<p>here is the code: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n#include&lt;time.h&gt;\n#include&lt;conio.h&gt;\n\n#include&lt;cuda_runtime.h&gt;\n#include&lt;cuda_profiler_api.h&gt; \n#include&lt;device_functions.h&gt;\n#include&lt;device_launch_parameters.h&gt;\n\n#define DOUBLE float\n\n#define ITER 10\n#define MAXI 100000000\n\n__global__ void kernel(DOUBLE*a)\n{\n    for(int i = blockIdx.x * blockDim.x + threadIdx.x ; i &lt; MAXI; i += blockDim.x * gridDim.x) \n    {\n        a[i] *= a[i];\n    }\n}\n\nint main()\n{\n    DOUBLE* a = (DOUBLE*) malloc(MAXI*sizeof(DOUBLE));\n    for(int i=0;i&lt;MAXI;++i)\n    {\n        a[i]=(DOUBLE)1.0;\n    }\n    DOUBLE* d_a;\n    cudaMalloc((void**)&amp;d_a, sizeof(DOUBLE)*(MAXI));\n    cudaMemcpy(d_a, a, sizeof(DOUBLE)*(MAXI), cudaMemcpyHostToDevice);\n\n    clock_t start_clock, end_clock;\n    double sec_clock;\n\n    printf(\"[%d] start\\n\", __LINE__);\n    start_clock = clock();\n\n    for (int i = 1; i &lt;= ITER; ++i){\n        kernel &lt;&lt;&lt; 32, 256&gt;&gt;&gt; (d_a);\n    }\n    cudaDeviceSynchronize();\n\n    end_clock = clock();\n    cudaMemcpy(a, d_a, sizeof(DOUBLE)*(MAXI), cudaMemcpyDeviceToHost);\n    sec_clock = (end_clock - start_clock) / (double)CLOCKS_PER_SEC;\n    printf(\"[%d] %f/%d[s]\\n\", __LINE__, sec_clock, CLOCKS_PER_SEC);\n    printf(\"[%d] end\\n\", __LINE__);\n\n    return 0;\n} \n</code></pre>\n\n<p>(You'll notice I allocate a array of length 100M to get measurable performance.) </p>\n"}], "owner": {"reputation": 31, "user_id": 6288785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b628440bfcad0c37a94b9ce5df0748?s=128&d=identicon&r=PG&f=1", "display_name": "stg", "link": "https://stackoverflow.com/users/6288785/stg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 37020935, "answer_count": 1, "score": 1, "last_activity_date": 1462690296, "creation_date": 1462336908, "last_edit_date": 1462690296, "question_id": 37018634, "link": "https://stackoverflow.com/questions/37018634/why-my-cuda-c-code-does-not-become-faster-with-single-precision", "title": "Why my cuda C code does not become faster with single precision?", "body": "<p>Fermi generation GPU's single precision calculation should be 2 times faster than double precision.\nHowever, although I rewrite all declaration 'double' to 'float', I got no speed up.\nIs there any mistake ex. compile option etc..?</p>\n\n<p>GPU:Tesla C2075\nOS:win7 pro\nCompiler:VS2013(nvcc)\nCUDA:v.7.5\nCommand line:nvcc test.cu</p>\n\n<p>I wrote test code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n#include&lt;time.h&gt;\n#include&lt;conio.h&gt;\n\n#include&lt;cuda_runtime.h&gt;\n#include&lt;cuda_profiler_api.h&gt; \n#include&lt;device_functions.h&gt;\n#include&lt;device_launch_parameters.h&gt;\n\n#define DOUBLE 1\n\n#define MAXI 10\n\n__global__ void Kernel_double(double*a,int nthreadx)\n{\n    double b=1.e0;\n    int i;\n    i = blockIdx.x * nthreadx + threadIdx.x + 0;\n    a[i] *= b;\n}\n__global__ void Kernel_float(float*a,int nthreadx)\n{\n    float b=1.0F;\n    int i;\n    i = blockIdx.x * nthreadx + threadIdx.x + 0;\n    a[i] *= b;\n}\n\nint main()\n{\n#if DOUBLE\n    double a[10];\n    for(int i=0;i&lt;MAXI;++i){\n        a[i]=1.e0;\n    }\n    double*d_a;\n    cudaMalloc((void**)&amp;d_a, sizeof(double)*(MAXI));\n    cudaMemcpy(d_a, a, sizeof(double)*(MAXI), cudaMemcpyHostToDevice);\n#else\n    float a[10];\n    for(int i=0;i&lt;MAXI;++i){\n        a[i]=1.0F;\n    }\n    float*d_a;\n    cudaMalloc((void**)&amp;d_a, sizeof(float)*(MAXI));\n    cudaMemcpy(d_a, a, sizeof(float)*(MAXI), cudaMemcpyHostToDevice);\n#endif\n\n    dim3 grid(2, 2, 1);\n    dim3 block(2, 2, 1);\n\n    clock_t start_clock, end_clock;\n    double sec_clock;\n\n    printf(\"[%d] start\\n\", __LINE__);\n    start_clock = clock();\n\n    for (int i = 1; i &lt;= 100000; ++i){\n#if DOUBLE\n        Kernel_double &lt;&lt; &lt; grid, block &gt;&gt; &gt; (d_a, 2);\n        cudaMemcpy(a, d_a, sizeof(double)*(MAXI), cudaMemcpyDeviceToHost);\n#else\n        Kernel_float &lt;&lt; &lt; grid, block &gt;&gt; &gt; (d_a, 2);\n        cudaMemcpy(a, d_a, sizeof(float)*(MAXI), cudaMemcpyDeviceToHost);\n#endif\n    }\n\n    end_clock = clock();\n    sec_clock = (end_clock - start_clock) / (double)CLOCKS_PER_SEC;\n    printf(\"[%d] %f[s]\\n\", __LINE__, sec_clock);\n    printf(\"[%d] end\\n\", __LINE__);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "math", "gcc", "long-integer", "unsigned"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1462336201, "post_id": 37018469, "comment_id": 61588353, "body": "Why loop 64 times? Why not just set <code>i</code> equal to 64?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1462336307, "post_id": 37018469, "comment_id": 61588393, "body": "To start with you&#39;re using the wrong format to print an <code>unsigned long</code> value. You should be using <code>&quot;%lu&quot;</code>. See e.g. <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">this <code>printf</code> (and family) reference</a>."}, {"owner": {"reputation": 10198, "user_id": 1229490, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4bca06377adfdc168d5a1f70ee1e55f5?s=128&d=identicon&r=PG", "display_name": "OneZero", "link": "https://stackoverflow.com/users/1229490/onezero"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1462336311, "post_id": 37018469, "comment_id": 61588395, "body": "@JonnyHenly If I just do <code>int i = 64</code> and do the shift and print, it gives 0. Isn&#39;t it magical?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1462336328, "post_id": 37018469, "comment_id": 61588400, "body": "Undefined behaviour can do anything it likes and it is correct!  In this case, it is likely that the shift size is reduced modulo 64 to be equivalent to <code>1UL &lt;&lt; 0</code> which is 1.  You could look at the assembler to see whether that&#39;s correct for your compiler \u2014 but the behaviour varies between machines and compilers, and is (I emphasize) undefined behaviour so any result is correct.  The difference is likely the result of compile-time vs run-time evaluation of the expression."}, {"owner": {"reputation": 10198, "user_id": 1229490, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4bca06377adfdc168d5a1f70ee1e55f5?s=128&d=identicon&r=PG", "display_name": "OneZero", "link": "https://stackoverflow.com/users/1229490/onezero"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462336395, "post_id": 37018469, "comment_id": 61588418, "body": "@JoachimPileborg I don&#39;t think the format is an issue here. Since it doesn&#39;t matter what format we put, the bit shifting produces either 000...000 or 000...001, so even with the wrong print format, only leftmost zeros will be truncated. The value, 0 or 1, would not be affected."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1462336561, "post_id": 37018469, "comment_id": 61588480, "body": "I think there are two issues here:  (1) The format is incorrect, so it could easily be printing garbage (just fix the bug instead of speculating about it), and (2) I believe the shift result is undefined (assuming <code>unsigned long</code> is 64 bits or less).  I believe shifts amounts must be in the range 0 through one less than the number of bits."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462336593, "post_id": 37018469, "comment_id": 61588492, "body": "No not in this case, but otherwise on systems where <code>sizeof(long) != sizeof(int)</code> you could get wrong results."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1462336703, "post_id": 37018469, "comment_id": 61588532, "body": "@OneZero undefined behaviour is not reliable"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 7, "last_activity_date": 1462336722, "last_edit_date": 1495540444, "creation_date": 1462336283, "answer_id": 37018518, "question_id": 37018469, "link": "https://stackoverflow.com/questions/37018469/why-does-1ul-64-return-1-instead-of-0/37018518#37018518", "title": "Why does 1ul &lt;&lt; 64 return 1 instead of 0?", "body": "<p>Shifting by the width of a type or more causes <a href=\"https://stackoverflow.com/a/4105123/1505939\">undefined behaviour</a> according to \u00a76.5.7/3:</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>The integer promotions are performed on each of the operands. The type\n  of the result is that of the promoted left operand. If the value of\n  <strong>the right operand</strong> is negative or <strong>is greater than or equal to the width</strong>\n  <strong>of the promoted left operand, the behavior is undefined</strong>.</li>\n  </ol>\n</blockquote>\n\n<p>The rationale for this is that various CPUs implement different behaviour for over-sized shifts and it would have been too restrictive to define behaviour for this case -- many shifts would need extra assembly generated. (Although perhaps it should have been implementation-defined rather than undefined).</p>\n\n<p>Your observation could be explained by using Intel family CPU which in hardware does \"mod 64\" on the shift width for a 64-bit type, so at runtime <code>1ul &lt;&lt; 64</code> did the same as <code>1ul &lt;&lt; 0</code> would; but at compile-time in the other case the compiler computed <code>1ul &lt;&lt; 64</code> using arithmetic rules. </p>\n"}], "owner": {"reputation": 10198, "user_id": 1229490, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4bca06377adfdc168d5a1f70ee1e55f5?s=128&d=identicon&r=PG", "display_name": "OneZero", "link": "https://stackoverflow.com/users/1229490/onezero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2504, "favorite_count": 0, "closed_date": 1462336584, "accepted_answer_id": 37018518, "answer_count": 1, "score": -2, "last_activity_date": 1462336722, "creation_date": 1462336021, "question_id": 37018469, "link": "https://stackoverflow.com/questions/37018469/why-does-1ul-64-return-1-instead-of-0", "closed_reason": "Duplicate", "title": "Why does 1ul &lt;&lt; 64 return 1 instead of 0?", "body": "<p>Consider the following piece of code:</p>\n\n<pre><code>// Simply loop over until 64 is hit. \nunsigned long x = 0;\nfor (int i = 0; i &lt;= 64; i++) {\n  if (i == 64) {\n    x = 1ul &lt;&lt; i;\n    printf(\"x: %d\\n\", x);\n  }\n}\n</code></pre>\n\n<p>We know that unsigned long is 64-bit wide, and left shifting 1 by 64 positions would become 1000...000 (64 zeros behind one), and would have been truncated to 0. However, the actual printout gives:</p>\n\n<pre><code>x: 1\n</code></pre>\n\n<p>The strange thing is, if we just do </p>\n\n<pre><code>printf(\"x: %d\\n\", (1ul &lt;&lt; 64));\n</code></pre>\n\n<p>It would print 0. </p>\n\n<p>Can anyone explain why this is happening? Why in the first case, the program mistakenly produces 1 instead of 0, but in the second case it's correct? </p>\n"}, {"tags": ["android", "c"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462340762, "post_id": 37018276, "comment_id": 61589942, "body": "do you work at x86 android device?"}, {"owner": {"reputation": 1, "user_id": 6288771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d01f5f9630a1a88bec3bab785c490c4?s=128&d=identicon&r=PG&f=1", "display_name": "vijay", "link": "https://stackoverflow.com/users/6288771/vijay"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462349862, "post_id": 37018276, "comment_id": 61594899, "body": "yes it 32 bit x86."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462350761, "post_id": 37018276, "comment_id": 61595500, "body": "what Target-abi do you use?"}, {"owner": {"reputation": 1, "user_id": 6288771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d01f5f9630a1a88bec3bab785c490c4?s=128&d=identicon&r=PG&f=1", "display_name": "vijay", "link": "https://stackoverflow.com/users/6288771/vijay"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462352093, "post_id": 37018276, "comment_id": 61596327, "body": "I am not specifying anything in option TARGET_ABI"}, {"owner": {"reputation": 1, "user_id": 6288771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d01f5f9630a1a88bec3bab785c490c4?s=128&d=identicon&r=PG&f=1", "display_name": "vijay", "link": "https://stackoverflow.com/users/6288771/vijay"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462357165, "post_id": 37018276, "comment_id": 61599899, "body": "processor\t: 1 model name\t: ARMv7 Processor rev 5 (v7l) BogoMIPS\t: 38.40 Features\t: swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm  CPU implementer\t: 0x41 CPU architecture: 7 CPU variant\t: 0x0 CPU part\t: 0xc07 CPU revision\t: 5  Hardware\t: Qualcomm Technologies, Inc MSM8909 Revision\t: 0000 Serial\t\t: 0000000000000000 Processor\t: ARMv7 Processor rev 5 (v7l)"}, {"owner": {"reputation": 1, "user_id": 6288771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d01f5f9630a1a88bec3bab785c490c4?s=128&d=identicon&r=PG&f=1", "display_name": "vijay", "link": "https://stackoverflow.com/users/6288771/vijay"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462357489, "post_id": 37018276, "comment_id": 61600121, "body": "Below is binary information: file pjsip-apps/bin/pjsua-arm-unknown-linux-androideabi  pjsip-apps/bin/pjsua-arm-unknown-linux-androideabi: ELF 32-bit LSB  shared object, ARM, EABI5 version 1 (SYSV), dynamically linked (uses shared libs), not stripped"}], "owner": {"reputation": 1, "user_id": 6288771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d01f5f9630a1a88bec3bab785c490c4?s=128&d=identicon&r=PG&f=1", "display_name": "vijay", "link": "https://stackoverflow.com/users/6288771/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462336293, "creation_date": 1462334974, "last_edit_date": 1462336293, "question_id": 37018276, "link": "https://stackoverflow.com/questions/37018276/does-pjsua-supports-android-marshmallow-error-data-simpleua-illegal-instruct", "title": "Does PJSUA supports Android Marshmallow ? Error ./data/simpleua Illegal instruction", "body": "<p>Does PJSUA supports Android  Marshmallow ?</p>\n\n<p>I am able to cross-compile PJSUA but not able to run on android device.</p>\n\n<p><strong>I am getting the following error:</strong></p>\n\n<pre><code>root@msm8909:/ # ./data/simpleua                                              \nIllegal instruction\n</code></pre>\n\n<p>Please help me to find out correct combination of followings -</p>\n\n<pre><code>1: Android version\n2: Android-Platform\n3: Target-abi\n4: Toolchain name\n5: Name of library which needs to be copy on android device after cross-compilation, If we need to copy libraries at\n    specific path then also please let me know the path.\n</code></pre>\n\n<p>I am following the steps suggested at below link:\n<a href=\"https://trac.pjsip.org/repos/wiki/Getting-Started/Android\" rel=\"nofollow\">https://trac.pjsip.org/repos/wiki/Getting-Started/Android</a> \nThanks a lot.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1074, "user_id": 2506290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/EH4QK.jpg?s=128&g=1", "display_name": "Chanom First", "link": "https://stackoverflow.com/users/2506290/chanom-first"}, "edited": false, "score": 0, "creation_date": 1462334742, "post_id": 37018209, "comment_id": 61587949, "body": "I never use c for long time but if I remember array must defined length"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1462335118, "post_id": 37018209, "comment_id": 61588053, "body": "you write <code>c[2] = &#39;x&#39;;</code> and not <code>[2]c = &#39;x&#39;;</code>, so you write <code>char c[3];</code> and not <code>char[3] c;</code> ."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462335724, "post_id": 37018209, "comment_id": 61588211, "body": "<code>char c1[]</code> - so how many characters do you expect c1 to hold? In C, this makes c1 an array, <i>not</i> a reference to an array like it does in Java."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1462342923, "post_id": 37018209, "comment_id": 61590885, "body": "Just forget about Java and study a beginner-level book in C."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462586210, "post_id": 37018209, "comment_id": 61711933, "body": "regarding this kind of expression: <code>char c1[]</code>,  An array in C, must be either declared with a specific length or initialized with a char string.  I.E. either: <code>char c1[20];</code>   or <code>char c1[] = &quot;hello &quot;;</code>.   Strings can only be copied char by char or using a function like: <code>strcpy()</code>   Only at variable initialization can a char array be set using <code>=</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462586475, "post_id": 37018209, "comment_id": 61711978, "body": "For ease of readability and understanding by us humans: 1) use meaningful variable names.  A variable name should indicate content or usage (or both).  2) suggest inserting appropriate white space, for readability."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462586558, "post_id": 37018209, "comment_id": 61711989, "body": "this is assignment: <code>char c1[20]; ....  strcpy( c1, &quot;hello&quot; );</code>   This is initialization: `char c1[] = &quot;hello&quot;;"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "edited": false, "score": 0, "creation_date": 1462338014, "post_id": 37018225, "comment_id": 61588971, "body": "But why is it in the case that char c1[] = &quot;hello&quot;; it is able to figure it out on its own whilst if you have more than one character array it suddenly needs the direct length? What if I wanted to input a giant string of text that I didnt know the length for?"}, {"owner": {"reputation": 14691, "user_id": 1808494, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3d837ea752592568bd712261baa61a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/1808494/aron"}, "edited": false, "score": 0, "creation_date": 1462338181, "post_id": 37018225, "comment_id": 61589018, "body": "Specifically, it says &quot;make me an array of unknown length on the stack&quot;. Which makes no sense. In Java it means &quot;make me a pointer to an array on the stack&quot;, this is because of Java&#39;s concept of &#39;value type&#39; and &#39;reference type&#39;."}, {"owner": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "edited": false, "score": 0, "creation_date": 1462339303, "post_id": 37018225, "comment_id": 61589395, "body": "I dont understand... in the code above if I removed c2 altogether the code works fine... yet I didnt declare the size of the array. Why does this work?"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1462339858, "post_id": 37018225, "comment_id": 61589610, "body": "Technically OP&#39;s array would gain an implicit size in the first assignment. Hypothetically the compiler could attempt to find a first assignment, so I think a little bit more needs to be explained. &quot;hello&quot; is known at compile time after all."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 6, "last_activity_date": 1462334714, "creation_date": 1462334714, "answer_id": 37018225, "question_id": 37018209, "link": "https://stackoverflow.com/questions/37018209/c-variable-declarations/37018225#37018225", "title": "C variable declarations", "body": "<p>This:</p>\n\n<pre><code>char c1[]\n</code></pre>\n\n<p>Means \"An array of characters with unknown length.\"  You can't create arrays of unknown length, though you can take them as parameters to a function, as in:</p>\n\n<pre><code>void foo(char c1[])\n</code></pre>\n\n<p>You can also create them if the length is known implicitly, as in:</p>\n\n<pre><code>char c1[] = \"hello\"; // size is 6, including null terminator\n</code></pre>\n\n<p>And as for this:</p>\n\n<blockquote>\n  <p>Is there also any reason why char is declared as char variable[] instead of char[] variable?</p>\n</blockquote>\n\n<p>It has always been like this.  I'm sure C programmers feel the Java way doesn't make sense too.  Decisions made in language syntax 40 years ago are not usefully debated today.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "edited": false, "score": 0, "creation_date": 1462338154, "post_id": 37018265, "comment_id": 61589013, "body": "So let us say id want to declare a string array that contains well over 1000 characters, how would I know what to input?"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "edited": false, "score": 1, "creation_date": 1462338266, "post_id": 37018265, "comment_id": 61589048, "body": "@Wjk just do <code>char c[1000];</code>?"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "edited": false, "score": 1, "creation_date": 1462339190, "post_id": 37018265, "comment_id": 61589345, "body": "@Wjk If the size is not known at developing time and it is calculated in runtime, you need to use dynamic allocation: <code>size_t n = get_size(); char *c1 = malloc(n);</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462343030, "post_id": 37018265, "comment_id": 61590952, "body": "Or you could simply do <code>char c1[n]</code>."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462343172, "post_id": 37018265, "comment_id": 61591025, "body": "@Lundin Yes, that will also do."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462343209, "post_id": 37018265, "comment_id": 61591047, "body": "@Lundin It&#39;s a size he doesn&#39;t know."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1462343495, "post_id": 37018265, "comment_id": 61591186, "body": "@MillieSmith So...? If he doesn&#39;t know it, he will obviously have to find out about it before declaring the array. Prompt the user for it etc."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462347856, "post_id": 37018265, "comment_id": 61593629, "body": "@Lundin Ok, then he can&#39;t use the <code>char c1[n]</code> syntax."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1462348169, "post_id": 37018265, "comment_id": 61593813, "body": "@MillieSmith Of course he can, it is a VLA. I would guess that your C knowledge is more than 17 years outdated."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462348818, "post_id": 37018265, "comment_id": 61594244, "body": "@Lundin Ok well it became optional in C11, and Visual Studio apparently doesn&#39;t support it. A little different than &quot;this can be done&quot;, but thanks nonetheless. I did not know about VLAs."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1462349315, "post_id": 37018265, "comment_id": 61594551, "body": "@MillieSmith Visual Studio is not a conforming C compiler. If you are lucky, it might conform to some C++ standard, but I very much doubt it"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462349359, "post_id": 37018265, "comment_id": 61594577, "body": "@Lundin I know, but it can&#39;t be thrown out of the equation. It&#39;s used a lot. You might be in a gcc world of conformity, but not everyone is."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462350155, "post_id": 37018265, "comment_id": 61595107, "body": "@Lundin Also, it does conform to quite a bit of the C++11 and C++14 standards iirc."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 1, "last_activity_date": 1462339449, "last_edit_date": 1462339449, "creation_date": 1462334942, "answer_id": 37018265, "question_id": 37018209, "link": "https://stackoverflow.com/questions/37018209/c-variable-declarations/37018265#37018265", "title": "C variable declarations", "body": "<p>That code precisely speaking is not declarations, it's definitions. And in C, you cannot define arrays leaving the length empty, you can either specify it explicitly:</p>\n\n<pre><code>char c1[6] = \"hello\";\n</code></pre>\n\n<p>or you can do it implicitly:</p>\n\n<pre><code>char c1[] = \"hello\";\n</code></pre>\n\n<p>If the length of the array is only known in running time, use allocated arrays:</p>\n\n<pre><code>size_t n = &lt;calculate the size needed&gt;;\nchar *c1 = malloc(n);\n</code></pre>\n\n<p>But for declarations, you can do external declarations like this:</p>\n\n<pre><code>extern char c1[];\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6270835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2e0c5f47fc5236d14c65965babc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Wjk", "link": "https://stackoverflow.com/users/6270835/wjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462339449, "creation_date": 1462334558, "last_edit_date": 1462334976, "question_id": 37018209, "link": "https://stackoverflow.com/questions/37018209/c-variable-declarations", "title": "C variable declarations", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main(void){\n    char c1[], c2[];\n    c1 = \"hello\";\n    c2 = \"world\";\n    printf(\"%s %s\", c1, c2);\n    return 0;\n}\n</code></pre>\n\n<p>What exactly makes it that I cannot use 'char c1[], c2[]'? I have some knowledge in Java and I find C syntax to be rather familiar with it but clearly somethings do not work. </p>\n\n<p>Is there also any reason why char is declared as char variable[] instead of char[] variable? It seems to make more sense like this (Java notation)</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1462334385, "post_id": 37018131, "comment_id": 61587852, "body": "Please turn your compiler&#39;s warnings to the maximum. You should get a warning about this code."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1462334544, "post_id": 37018131, "comment_id": 61587891, "body": "<code>sizeof</code> gives the size of the object, in bytes.  That is not the same as the number of elements in an array (unless the size of an element is 1 byte).  To get the number of elements, you must divide the value by the size of a single array element.  Also, you can&#39;t pass an <code>int</code> to <code>puts</code>, which expects a string, i.e. a <code>char *</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462343189, "post_id": 37018131, "comment_id": 61591035, "body": "This isn&#39;t even valid C. If this compiled, it means your compiler is misconfigured. In case of GCC for example, make sure to use it as a C compiler: <code>gcc -std=c11 -pedantic-errors</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9459, "user_id": 958051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KHi3g.png?s=128&g=1", "display_name": "Serdalis", "link": "https://stackoverflow.com/users/958051/serdalis"}, "edited": false, "score": 0, "creation_date": 1462336040, "post_id": 37018158, "comment_id": 61588297, "body": "Good answer, but minor nitpicks, You forgot to <code>return 0</code>, and its always a good idea to put brackets around operations on either side of a comparison since <a href=\"http://stackoverflow.com/questions/36784470/bit-operation-and/36784515#36784515\">Strange Things</a> have been known to happen when they&#39;re forgotten. +1 Though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 9459, "user_id": 958051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KHi3g.png?s=128&g=1", "display_name": "Serdalis", "link": "https://stackoverflow.com/users/958051/serdalis"}, "edited": false, "score": 3, "creation_date": 1462337241, "post_id": 37018158, "comment_id": 61588734, "body": "@Serdalis: In C99 and C11, if execution falls off the end of <code>main()</code>, it is equivalent to <code>return 0;</code>.  I don&#39;t like this \u2014 but it agrees with what C++98 decided (and I don&#39;t like that decision either), so that isn&#39;t wholly fair.  I don&#39;t see any relevant problems with missing parentheses, either \u2014 it is not unreasonable to expect people to be vaguely familiar with the table of operator precedences, and there are no bitwise operations here to confuse things."}, {"owner": {"reputation": 9459, "user_id": 958051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KHi3g.png?s=128&g=1", "display_name": "Serdalis", "link": "https://stackoverflow.com/users/958051/serdalis"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462337610, "post_id": 37018158, "comment_id": 61588853, "body": "@JonathanLeffler You&#39;re right, I didn&#39;t realise the <code>return 0</code> bit though, its probably just because I&#39;ve been forced to use C89 all my life, all this new flim-flammery is quite odd!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1462343349, "post_id": 37018158, "comment_id": 61591111, "body": "The empty parenthesis of a function taking no parameters is allowed by the current standard, but is marked as an obsolete feature. If you write such code, it might not work in the future."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 8, "last_activity_date": 1462334324, "creation_date": 1462334324, "answer_id": 37018158, "question_id": 37018131, "link": "https://stackoverflow.com/questions/37018131/segmentation-fault-returned-whenever-i-run-my-c-code/37018158#37018158", "title": "Segmentation Fault returned whenever I run my C code", "body": "<p>First, <code>puts</code> takes an null terminated strings, not an integer. Second, to determine the number of elements in the array, use <code>sizeof(array)/sizeof(array[0])</code>, because <code>sizeof(array)</code> is the total number of bytes of the array. Third, use <code>int main(void)</code> for standard C. Try this:</p>\n\n<pre><code>int main(void)\n{\n    int array[5] = {1, 2, 3, 4, 5};\n    int i = 0;\n    for (i = 0; i &lt; sizeof(array) / sizeof(array[0]); i++)\n    {\n            printf(\"%d\\n\", array[i]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 5893195, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UJz0X.jpg?s=128&g=1", "display_name": "Michael Lilley", "link": "https://stackoverflow.com/users/5893195/michael-lilley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 37018158, "answer_count": 1, "score": 2, "last_activity_date": 1462334324, "creation_date": 1462334122, "question_id": 37018131, "link": "https://stackoverflow.com/questions/37018131/segmentation-fault-returned-whenever-i-run-my-c-code", "title": "Segmentation Fault returned whenever I run my C code", "body": "<p>I'm new to C, coming from Java.</p>\n\n<p>I made the following trivial program that compiles fine, but nano throws me a Segmentation Fault whenever I run it. The point of it is to traverse through the array and have it print out each element on a separate line. </p>\n\n<pre><code>int main()\n{\n    int array[5] = {1, 2, 3, 4, 5};\n    int i = 0;\n    for (i = 0; i &lt; sizeof(array); i++)\n    {\n            puts(array[i]);\n    }\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "macos", "sockets", "network-programming", "udp"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 2, "creation_date": 1462333889, "post_id": 37018068, "comment_id": 61587724, "body": "I suggest using packet capture software on both sides to try to narrow down which side is introducing the delay.  Also try making the Windows machine send to itself, and to another Windows machine.  Also try using <code>ping</code> to make sure you don&#39;t see the same problem there."}, {"owner": {"reputation": 1, "user_id": 6288701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293d56eefe8485f35ce209ab430a9b52?s=128&d=identicon&r=PG", "display_name": "JCA", "link": "https://stackoverflow.com/users/6288701/jca"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1462337345, "post_id": 37018068, "comment_id": 61588765, "body": "Thanks for the suggestions! I&#39;ll try it out and post the results here!"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462351461, "post_id": 37018068, "comment_id": 61595934, "body": "&#39;delay about 50ms&#39; - on a typical network and OS stack, that&#39;s just noise level."}, {"owner": {"reputation": 1, "user_id": 6288701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293d56eefe8485f35ce209ab430a9b52?s=128&d=identicon&r=PG", "display_name": "JCA", "link": "https://stackoverflow.com/users/6288701/jca"}, "edited": false, "score": 0, "creation_date": 1462384210, "post_id": 37018068, "comment_id": 61619443, "body": "I have a realtime software on the same network that is transmitting smoothly without delays. I&#39;m not sure what kind of protocol they&#39;re using though."}, {"owner": {"reputation": 1, "user_id": 6288701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293d56eefe8485f35ce209ab430a9b52?s=128&d=identicon&r=PG", "display_name": "JCA", "link": "https://stackoverflow.com/users/6288701/jca"}, "edited": false, "score": 0, "creation_date": 1462388876, "post_id": 37018068, "comment_id": 61622350, "body": "UPDATE: I used a sniffer on the Mac side and it seems the packets are being received on time. So something&#39;s wrong with the GCDAsyncUdpSocket probably."}], "owner": {"reputation": 1, "user_id": 6288701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293d56eefe8485f35ce209ab430a9b52?s=128&d=identicon&r=PG", "display_name": "JCA", "link": "https://stackoverflow.com/users/6288701/jca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462333693, "creation_date": 1462333693, "question_id": 37018068, "link": "https://stackoverflow.com/questions/37018068/udp-communication-delay-every-second-or-so-windows-sdk-mac", "title": "UDP communication delay every second or so (Windows SDK &amp; Mac)", "body": "<p>I'm sending packets using UDP protocol from Windows to Mac computer (Windows 10, Mac OS X 10.10). I'm using Windows API on Windows (C++) and GCDAsyncUdpSocket on a Mac (Objective C and C). The frequency that I send is around 100Hz. I'm expecting latency of 10ms, and it really is 10ms on the sending computer. But the receiving part gets delayed every 1 second. So it receives around 100 packets and then there's a delay about 50ms.</p>\n\n<p>I tried dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0) on the Mac side but it didn't help. I tried Wi-Fi, Ethernet, different computers and networks, it didn't help either! Firewalls, Windows Defender are off everywhere. There's always a delay every ~100 packets on the receiving (Mac) side.</p>\n\n<p>I can post the code, but it's really basic.</p>\n\n<p>What can be the problem here? It looks like I'm missing some setting that I'm not aware of!</p>\n"}, {"tags": ["html", "c", "parsing", "xml-parsing", "libxml2"], "answers": [{"comments": [{"owner": {"reputation": 10249, "user_id": 946509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/edd6283a42fb90b12f2adafccafa9015?s=128&d=identicon&r=PG", "display_name": "BSalunke", "link": "https://stackoverflow.com/users/946509/bsalunke"}, "edited": false, "score": 0, "creation_date": 1462849787, "post_id": 37077456, "comment_id": 61797474, "body": "Thanks for answer, but with you solution also we have iterate over all the nodes check attribute of each node with our regex.  I&#39;m looking for a way in which, I will get all nodes has attribute matching with specific regex. i.e. regex : &quot;on*&quot; . Can we do that?"}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "reply_to_user": {"reputation": 10249, "user_id": 946509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/edd6283a42fb90b12f2adafccafa9015?s=128&d=identicon&r=PG", "display_name": "BSalunke", "link": "https://stackoverflow.com/users/946509/bsalunke"}, "edited": false, "score": 0, "creation_date": 1462871169, "post_id": 37077456, "comment_id": 61806904, "body": "@BSalunke You can easily adjust my code to achieve what you want. If you run into problems, you can always aks a new question."}, {"owner": {"reputation": 421, "user_id": 5092005, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10206147533318859/picture?type=large", "display_name": "Austen Stone", "link": "https://stackoverflow.com/users/5092005/austen-stone"}, "edited": false, "score": 0, "creation_date": 1604957095, "post_id": 37077456, "comment_id": 114501106, "body": "How can this be done progressively using <code>xmlRegNewExecCtxt</code> and a callback? I have been scouring the internet trying to find an example. I want the matches from the regex."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": false, "score": 0, "last_activity_date": 1462552813, "creation_date": 1462552813, "answer_id": 37077456, "question_id": 37018058, "link": "https://stackoverflow.com/questions/37018058/can-we-use-regex-to-find-all-nodes-with-specific-attribute-value-using-libxml2/37077456#37077456", "title": "Can we use regex to find all nodes with specific attribute value using libxml2?", "body": "<p>One solution would be to use XPath, but libxml2 supports neither XPath 2.0 nor the EXSLT regex extension. libxml2 comes with its <a href=\"http://www.xmlsoft.org/html/libxml-xmlregexp.html\" rel=\"nofollow\">own XML Schemas compatible regex module</a>, though. Something like the following should work:</p>\n\n<pre><code>int xmlHasMatchingProp(const xmlNode *node,\n                       const xmlChar *attrNameRegex) {\n    xmlRegexpPtr regex;\n    xmlAttrPtr attr;\n\n    if (node == NULL || node-&gt;type != XML_ELEMENT_NODE)\n        return 0;\n\n    regex = xmlRegexpCompile(attrNameRegex);\n    if (regex == NULL)\n        return 0;\n\n    for (attr = node-&gt;properties; attr != NULL; attr = attr-&gt;next) {\n        if (xmlRegexpExec(regex, attr-&gt;name) == 1)\n            break;\n    }\n\n    xmlRegFreeRegexp(regex);\n    return attr ? 1 : 0;\n}\n</code></pre>\n\n<p>But if you only want to check whether an attribute name starts with \"on\", you can simplify the code above, using <a href=\"http://www.xmlsoft.org/html/libxml-xmlstring.html#xmlStrncasecmp\" rel=\"nofollow\">xmlStrncasecmp</a> for example:</p>\n\n<pre><code>for (attr = node-&gt;properties; attr != NULL; attr = attr-&gt;next) {\n    if (xmlStrncasecmp(attr-&gt;name, \"on\", 2) == 0)\n        break;\n}\n</code></pre>\n"}], "owner": {"reputation": 10249, "user_id": 946509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/edd6283a42fb90b12f2adafccafa9015?s=128&d=identicon&r=PG", "display_name": "BSalunke", "link": "https://stackoverflow.com/users/946509/bsalunke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462552876, "creation_date": 1462333643, "last_edit_date": 1462552876, "question_id": 37018058, "link": "https://stackoverflow.com/questions/37018058/can-we-use-regex-to-find-all-nodes-with-specific-attribute-value-using-libxml2", "title": "Can we use regex to find all nodes with specific attribute value using libxml2?", "body": "<p>Hello I'm using libxml2 to parse the HTML. I want to check the given node has specific attribute or not.</p>\n\n<p>But in my case I want to check for nodes with specific attribute(<strong>Can I provide regex matching with multiple attribute instead of attribute name?</strong>) </p>\n\n<p>libxml2 API used to check whether the give node has that attribute or not?</p>\n\n<pre><code>xmlAttrPtr xmlHasProp(const xmlNode * node, \n                      const xmlChar * name)\n</code></pre>\n\n<p>I'm looking for the way like below:</p>\n\n<pre><code>xmlAttrPtr xmlHasProp(const xmlNode * node, \n                      const char * attributeNameRegex)\n</code></pre>\n\n<p>So that I can check for nodes with multiple attribute.\ne.g. I want to check for node has \"onClick\" or \"onmouseover\" or \"onmouseclick\" kind of attribute or not?</p>\n"}, {"tags": ["c", "memory-leaks"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6194584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de7c301366f103d09099914d6abf0828?s=128&d=identicon&r=PG&f=1", "display_name": "N. George", "link": "https://stackoverflow.com/users/6194584/n-george"}, "edited": false, "score": 0, "creation_date": 1462335372, "post_id": 37018140, "comment_id": 61588098, "body": "Thanks! The <code>json_object_set_new</code> is specifically meant for this."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 2, "last_activity_date": 1462334197, "creation_date": 1462334197, "answer_id": 37018140, "question_id": 37018004, "link": "https://stackoverflow.com/questions/37018004/json-decref-not-freeing-memory/37018140#37018140", "title": "json_decref not freeing memory?", "body": "<p>It was because the json integer created by <code>json_integer(42)</code> was not freed, you need to free that object too:</p>\n\n<pre><code>int main(void) {\n    json_t *obj, *t;\n    long int i;\n\n    while(1) {\n        // Create a new json_object\n        obj = json_object();\n\n        // Add one key-value pair\n        t = json_integer(42);\n        json_object_set(obj, \"Key\", t);\n\n        // Reduce reference count and because there is only one reference so\n        // far, this should free the memory.\n        json_decref(t);\n        json_decref(obj);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Also note <code>main</code> should be <code>int main(void)</code> by the standard.</p>\n"}], "owner": {"reputation": 105, "user_id": 6194584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de7c301366f103d09099914d6abf0828?s=128&d=identicon&r=PG&f=1", "display_name": "N. George", "link": "https://stackoverflow.com/users/6194584/n-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2795, "favorite_count": 0, "accepted_answer_id": 37018140, "answer_count": 1, "score": 3, "last_activity_date": 1462334197, "creation_date": 1462333255, "last_edit_date": 1462334120, "question_id": 37018004, "link": "https://stackoverflow.com/questions/37018004/json-decref-not-freeing-memory", "title": "json_decref not freeing memory?", "body": "<p>This question relates to the libjansson JSON API for C. The <code>json_decref</code> function is to be used to keep track of the number of references to a <code>json_t</code> object and when the number of references reaches <code>0</code>, should free the memory that was allocated. Then why does this program cause a memory leak? What am I missing? Is it just that there is no garbage collection?</p>\n\n<pre><code>int main() {\n    json_t *obj;\n    long int i;\n\n    while(1) {\n        // Create a new json_object\n        obj = json_object();\n\n        // Add one key-value pair\n        json_object_set(obj, \"Key\", json_integer(42));\n\n        // Reduce reference count and because there is only one reference so\n        // far, this should free the memory.\n        json_decref(obj);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "android", "c"], "owner": {"reputation": 85, "user_id": 6288630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d212e704fcbbcde80538a2a505c2502c?s=128&d=identicon&r=PG&f=1", "display_name": "MikakoTabe", "link": "https://stackoverflow.com/users/6288630/mikakotabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462333400, "creation_date": 1462332105, "last_edit_date": 1462333400, "question_id": 37017813, "link": "https://stackoverflow.com/questions/37017813/loading-native-c-library-on-android-studio", "title": "Loading native C library on Android Studio", "body": "<p>I'm trying to load native C library in Android Studio 1.5.1, but get an error. It says,</p>\n\n<blockquote>\n  <p>java.lang.UnsatisfiedLinkError: No implementation found for java.lang.String com.example.sampleApp.MainActivity.stringFromJNI() (tried Java_com_example_sampleApp_MainActivity_stringFromJNI and Java_com_example_sampleApp_MainActivity_stringFromJNI__)</p>\n</blockquote>\n\n<p>MainActivity.java is like;</p>\n\n<pre><code>static {\n    System.loadLibrary(\"hello\");\n}\n\npublic native String stringFromJNI();\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n\n    TextView  tv = new TextView(this);\n    tv.setText(stringFromJNI());\n    setContentView(tv);\n}\n</code></pre>\n\n<p>Android.mk is like;</p>\n\n<pre><code>LOCAL_PATH := $(call my-dir)\n\ninclude $(CLEAR_VARS)\n\nLOCAL_MODULE    := hello\nLOCAL_SRC_FILES := hello-jni.c\n\ninclude $(BUILD_SHARED_LIBRARY)\n</code></pre>\n\n<p>Also, hello-jni.c is like;</p>\n\n<pre><code>jstring\nJava_com_example_sampleApp_MainActivity_stringFromJNI( JNIEnv* env,\n                                              jobject thiz )\n{\n#if defined(__arm__)\n  #if defined(__ARM_ARCH_7A__)\n    #if defined(__ARM_NEON__)\n      #if defined(__ARM_PCS_VFP)\n        #define ABI \"armeabi-v7a/NEON (hard-float)\"\n      #else\n        #define ABI \"armeabi-v7a/NEON\"\n      #endif\n    #else\n      #if defined(__ARM_PCS_VFP)\n        #define ABI \"armeabi-v7a (hard-float)\"\n      #else\n        #define ABI \"armeabi-v7a\"\n      #endif\n    #endif\n  #else\n   #define ABI \"armeabi\"\n  #endif\n#elif defined(__i386__)\n   #define ABI \"x86\"\n#elif defined(__x86_64__)\n   #define ABI \"x86_64\"\n#elif defined(__mips64)  /* mips64el-* toolchain defines __mips__ too */\n   #define ABI \"mips64\"\n#elif defined(__mips__)\n   #define ABI \"mips\"\n#elif defined(__aarch64__)\n   #define ABI \"arm64-v8a\"\n#else\n   #define ABI \"unknown\"\n#endif\n\n    return (*env)-&gt;NewStringUTF(env, \"Hello from JNI !  Compiled with ABI \" ABI \".\");\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "perl", "cgi", "wrapper"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1462334459, "post_id": 37017706, "comment_id": 61587869, "body": "This sort of thing is usually because the CGI program is dying, and the <i>&quot;Premature end of headers&quot;</i> just means it&#39;s not printing anything. Have you checked that both the C executable and the Perl script are executable by the system? I&#39;m unsure why you&#39;re running a C program for your CGI. Won&#39;t your server handle Perl code directly? I suggest you modify your C program to just print <code>&quot;Content-type: text&#47;plain\\n\\nTest succeeded\\n&quot;;</code> instead of trying to run your Perl program. That will eliminate the C code if it is successful"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462334482, "post_id": 37017706, "comment_id": 61587879, "body": "Check out the solution here <a href=\"http://stackoverflow.com/questions/17583341/error-500-premature-end-of-script-headers\" title=\"error 500 premature end of script headers\">stackoverflow.com/questions/17583341/&hellip;</a>, e.g. was the permission bits of the cgi program right?"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1462337180, "post_id": 37017706, "comment_id": 61588707, "body": "What makes you think you need that wrapper?"}, {"owner": {"reputation": 97, "user_id": 4010164, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6e047ccfef3f6e0119f254d858bb2c12?s=128&d=identicon&r=PG&f=1", "display_name": "Rory Perry", "link": "https://stackoverflow.com/users/4010164/rory-perry"}, "edited": false, "score": 0, "creation_date": 1462342161, "post_id": 37017706, "comment_id": 61590540, "body": "Definitely not a permissions issue. C Wrapper is required to make the CGI executable as the owner of the file when served from the web server rather than as the &#39;nobody&#39; default user."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1462359349, "post_id": 37017706, "comment_id": 61601468, "body": "I&#39;d guess it&#39;s a path problem, i.e. the C program doesn&#39;t <i>find</i> the Perl program. Try <code>#define REAL_PATH &quot;&#47;full&#47;path&#47;to&#47;ids.pl&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 4010164, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6e047ccfef3f6e0119f254d858bb2c12?s=128&d=identicon&r=PG&f=1", "display_name": "Rory Perry", "link": "https://stackoverflow.com/users/4010164/rory-perry"}, "is_accepted": true, "score": 0, "last_activity_date": 1462493194, "creation_date": 1462493194, "answer_id": 37062199, "question_id": 37017706, "link": "https://stackoverflow.com/questions/37017706/perl-cgi-with-c-wrapper/37062199#37062199", "title": "Perl CGI with C Wrapper", "body": "<p>I wasn't compiling the C Wrapper on the actual server therefore getting different machine codes which weren't compatible. Unfortunately, the server denied to compile it originally and I forgot when it did that it had to be compiled on that machine. Doh me!</p>\n"}, {"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1462494353, "last_edit_date": 1495535316, "creation_date": 1462493833, "answer_id": 37062287, "question_id": 37017706, "link": "https://stackoverflow.com/questions/37017706/perl-cgi-with-c-wrapper/37062287#37062287", "title": "Perl CGI with C Wrapper", "body": "<p>Like any system call, you should always be checking for an error from <code>execl()</code>. Normally you'd look at the return value, but it's not necessary because success will terminate the program.</p>\n\n<pre><code>execl( REAL_PATH, REAL_PATH, 0 );\nperror(\"exec of '\"REAL_PATH\"' failed\");\n</code></pre>\n\n<p>This uses <a href=\"http://www.tutorialspoint.com/ansi_c/c_perror.htm\" rel=\"nofollow noreferrer\"><code>perror</code></a> to handle turning <code>errno</code> into a human readable error string and printing it to stderr.</p>\n\n<p>I'd also avoid using <code>#define</code> for string constants, they're awkward to work with. Instead use <code>static const char REAL_PATH[] = \"ids.pl\"</code> as suggested in <a href=\"https://stackoverflow.com/a/1431607/14660\">this answer</a>.</p>\n\n<p>And I don't understand why you need a C wrapper. Some sort of weird restriction on your web server running interpreted code?</p>\n"}], "owner": {"reputation": 97, "user_id": 4010164, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6e047ccfef3f6e0119f254d858bb2c12?s=128&d=identicon&r=PG&f=1", "display_name": "Rory Perry", "link": "https://stackoverflow.com/users/4010164/rory-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 37062199, "answer_count": 2, "score": 0, "last_activity_date": 1462494353, "creation_date": 1462331262, "question_id": 37017706, "link": "https://stackoverflow.com/questions/37017706/perl-cgi-with-c-wrapper", "title": "Perl CGI with C Wrapper", "body": "<p>Basis of the problem. I have a university assignment requiring me to write a Perl/CGI based website for a phonebook. This part is fine and I'm happy with it, however, I have issues with wrapping the cgi files. I've done it once before no issues but been unable to replicate that success this time doing the same thing.</p>\n\n<p>Basic Perl file to show user ID's:</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse English;\n\nprint \"Content-type: text/html\";\n\nprint \"\\n\";\nprint \"\\n\";\nprint \"\\n\";\n\nprint \"&lt;html&gt;\\n\";\nprint \"&lt;head&gt;&lt;title&gt;IDS.CGI&lt;/title&gt;&lt;/head&gt;\\n\";\nprint \"&lt;body&gt;\\n\"; \nprint \"&lt;p&gt;\\nMy User ID is $UID\\n&lt;/p&gt;\";\nprint \"&lt;p&gt;\\nMy effective User ID is $EUID\\n&lt;/p&gt;\";\nprint \"&lt;p&gt;\\nMy Group ID is $GID\\n&lt;/p&gt;\";\nprint \"&lt;p&gt;\\nMy effective Group ID is $EGID\\n&lt;/p&gt;\";\nprint \"\\n&lt;/body&gt;\\n\";\nprint \"&lt;/html&gt;\\n\";\n</code></pre>\n\n<p>Wrapper.C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n#define REAL_PATH \"ids.pl\"\n\nint\nmain()\n{\n    execl( REAL_PATH, REAL_PATH, 0 );\n    printf( \"You should never see this message!\\n\" );\n}\n</code></pre>\n\n<p>This is throwing an internal server error 500. I've tried my best to debug it including spacing for the headers etc. It runs fine in terminal but not in the web browsers. The servers httpd error log shows that the error of \"Premature end of headers\". I cannot see how there is a premature end however.</p>\n\n<p>Any help anyone can offer would be greatly appreciated.</p>\n"}, {"tags": ["c", "arrays", "pointers", "cuda", "pycuda"], "comments": [{"owner": {"reputation": 151, "user_id": 1601260, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4acfc183c3d7d5cde8f2588b41ca1e64?s=128&d=identicon&r=PG", "display_name": "Alex Hall", "link": "https://stackoverflow.com/users/1601260/alex-hall"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1462331783, "post_id": 37017562, "comment_id": 61587238, "body": "@JonnyHenly Added the rest of my code... might be too much detail. Let me know."}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1462331943, "post_id": 37017562, "comment_id": 61587269, "body": "Thank you so much for doing that! You wouldn&#39;t believe how many people I&#39;ve asked to update their question, so I can try to help them, and it never happens. That is a lot of code though, I can see why you didn&#39;t post it in full : )"}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1462333309, "post_id": 37017562, "comment_id": 61587608, "body": "Have you checked that the arrays used in <code>kernel_chebyshev</code>, which are the output of a different kernel, are correct?"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1462345218, "post_id": 37017562, "comment_id": 61592142, "body": "You have posted over 200 LOC, and yet the example still isn&#39;t really useable because of all the external dependencies and image file requirements. <a href=\"https://stackoverflow.com\">Stack Overflow</a> isn&#39;t a free debugging and mistake spotting service, please don&#39;t treat it like one. If you can create a proper <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> and describe exactly what is the problem you are having, someone might be able to help you. But not with the code you have posted."}, {"owner": {"reputation": 151, "user_id": 1601260, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4acfc183c3d7d5cde8f2588b41ca1e64?s=128&d=identicon&r=PG", "display_name": "Alex Hall", "link": "https://stackoverflow.com/users/1601260/alex-hall"}, "edited": false, "score": 0, "creation_date": 1462586698, "post_id": 37017562, "comment_id": 61712008, "body": "Sorry about the confusion. I didn&#39;t want to upload all of the code, because I don&#39;t intend to use Stack Overflow as a debugging service. Thank you for the link MCVE link, that is quite helpful both for my future Stack Overflow questions and also for my personal coding &amp; debugging practices.  When I created an MCVE, I confirmed that my kernel was working fine; my problem was an error elsewhere in my code that was messing up the bin counts."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 1601260, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4acfc183c3d7d5cde8f2588b41ca1e64?s=128&d=identicon&r=PG", "display_name": "Alex Hall", "link": "https://stackoverflow.com/users/1601260/alex-hall"}, "is_accepted": true, "score": 0, "last_activity_date": 1462587225, "creation_date": 1462587225, "answer_id": 37083807, "question_id": 37017562, "link": "https://stackoverflow.com/questions/37017562/pycuda-dereferencing-array-element-via-pointer-in-cuda-kernel/37083807#37083807", "title": "PyCuda: Dereferencing Array Element Via Pointer in Cuda Kernel", "body": "<p>This was a bad question, as the error was elsewhere in my code. Sorry for the confusion. </p>\n"}], "owner": {"reputation": 151, "user_id": 1601260, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4acfc183c3d7d5cde8f2588b41ca1e64?s=128&d=identicon&r=PG", "display_name": "Alex Hall", "link": "https://stackoverflow.com/users/1601260/alex-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 37083807, "answer_count": 1, "score": 0, "last_activity_date": 1462587225, "creation_date": 1462330117, "last_edit_date": 1462332052, "question_id": 37017562, "link": "https://stackoverflow.com/questions/37017562/pycuda-dereferencing-array-element-via-pointer-in-cuda-kernel", "title": "PyCuda: Dereferencing Array Element Via Pointer in Cuda Kernel", "body": "<p>I am using PyCuda to pass pairs of arrays to a cuda kernel via a pointer. The arrays are the output of a different kernel, so the data is already on the GPU. </p>\n\n<p>Within the kernel, I'm trying to access elements in each of the arrays to do a vector subtraction. The values that I'm getting for the elements in the array are not correct (h &amp; p are wrong in the code below).</p>\n\n<p>Can anyone help me see what am I doing wrong?</p>\n\n<p>My code:</p>\n\n<pre><code>import pycuda.driver as cuda\nimport pycuda.autoinit\nfrom pycuda.compiler import SourceModule\nimport numpy as np\nimport time\nimport cv2\nfrom pycuda.tools import DeviceMemoryPool as DMP\nfrom scipy.spatial import distance\nimport os\nimport glob\n\ndef get_cuda_hist_kernel():\n        #Make the kernel\n    histogram_kernel = \"\"\"\n    __global__ void kernel_getHist(unsigned int* array,unsigned int size, unsigned int* histo, float bucket_size, unsigned int num_bins, unsigned int* out_max)\n    {\n        unsigned int x = threadIdx.x + blockDim.x * blockIdx.x;\n        if(x&lt;size){\n            unsigned int value = array[x];\n\n            unsigned int bin = floor(float(value) * bucket_size) - 1;\n\n\n            //Faster Modulo 3 for channel assignment\n            unsigned int offset = x;\n            offset = (offset &gt;&gt; 16) + (offset &amp; 0xFFFF); \n            offset = (offset &gt;&gt;  8) + (offset &amp; 0xFF);   \n            offset = (offset &gt;&gt;  4) + (offset &amp; 0xF);    \n            offset = (offset &gt;&gt;  2) + (offset &amp; 0x3);    \n            offset = (offset &gt;&gt;  2) + (offset &amp; 0x3);    \n            offset = (offset &gt;&gt;  2) + (offset &amp; 0x3);    \n            if (offset &gt; 2) offset = offset - 3;\n            offset = offset * num_bins;\n\n            bin += offset;\n\n            atomicAdd(&amp;histo[bin + offset],1);\n        }\n    }\n\n\n    __global__ void kernel_chebyshev(unsigned int* histo, unsigned int* prev_histo, unsigned int number, int* output)\n    {\n\n        const unsigned int size = 12;\n        //Get all of the differences\n        __shared__ int temp_diffs[size];\n        unsigned int i = threadIdx.x + blockDim.x * blockIdx.x;\n\n        if (i &lt; size){\n            unsigned int diff = 0;\n            unsigned int h = histo[i];\n            unsigned int p = prev_histo[i];\n\n            if (h &gt; p)\n            {\n                diff = h - p;\n            }\n            else\n            {\n                diff = p - h;\n            }\n            temp_diffs[i] = (int)diff;\n        }\n\n        __syncthreads();\n\n        output[number] = 0;\n        atomicMax(&amp;output[number], temp_diffs[i]);\n    }\n    \"\"\"\n\n    mod = SourceModule(histogram_kernel)\n    return mod\n\n\ndef cuda_histogram(ims, block_size, kernel):\n\n    start = time.time()\n    max_val = 4\n    num_bins = np.uint32(4)\n    num_channels = np.uint32(3)\n    bin_size = np.float32(1 / np.uint32(max_val / num_bins))\n\n    #Memory Pool\n    pool = DMP()\n    print 'Pool Held Blocks: ', pool.held_blocks\n\n    #Compute block &amp; Grid dimensions\n\n    bdim = (block_size, 1, 1)\n    cols = ims[0].size\n    rows = 1\n    channels = 1\n\n    dx, mx = divmod(cols, bdim[0])\n    dy, my = divmod(rows, bdim[1])\n    dz, mz = divmod(channels, bdim[2])\n    g_x = (dx + (mx&gt;0)) * bdim[0]\n    g_y = (dy + (my&gt;0)) * bdim[1]\n    g_z = (dz + (mz&gt;0)) * bdim[2]\n    gdim = (g_x, g_y, g_z)\n\n    #get the function\n    func = kernel.get_function('kernel_getHist')\n    func2 = kernel.get_function('kernel_chebyshev')\n\n    #build list of histograms\n    #send the histogram to the gpu\n    hists = []\n    device_hists = []\n    for im in range(len(ims)):\n        hists.append(np.zeros([num_channels * num_bins]).astype(np.uint32))\n\n    end = time.time()\n    dur = end - start\n    print(' '.join(['Prep Time: ', str(dur)]))\n\n    start = time.time()\n\n\n    #Copy all of the image data to GPU\n    device_images = []\n    for im in range(len(ims)):\n        #print('Allocating data for image :', im)\n        #convert the image to 1D array of uint32s\n        a = ims[im].astype(np.uint32)\n        a = a.flatten('C')\n        a_size = np.uint32(a.size)\n\n        #allocate &amp; send im data to gpu\n        device_images.append(pool.allocate(a.nbytes))\n        cuda.memcpy_htod(device_images[im], a)\n\n        d_hist = pool.allocate(hists[im].nbytes)\n        device_hists.append(d_hist)\n        cuda.memcpy_htod(d_hist, hists[im])\n\n\n    differences = np.zeros(len(ims)).astype(np.uint32)\n    device_diffs = pool.allocate(differences.nbytes)\n    cuda.memcpy_htod(device_diffs, differences)\n\n\n    for im in range(len(ims)):\n        #run histogram function\n        func(device_images[im], a_size, device_hists[im], bin_size, num_bins, block=(block_size,1,1), grid=gdim)\n\n    cuda.Context.synchronize()\n    device_hist_size = np.uint32(len(device_hists[im]))\n    for im in range(1, len(ims)):\n        number = np.uint32(im - 1)\n        func2(device_hists[im], device_hists[im - 1], number, device_diffs, block=(32,1,1))\n\n    cuda.memcpy_dtoh(differences, device_diffs)\n    print(differences)\n\n    for im in range(len(ims)):\n        #get histogram back\n        cuda.memcpy_dtoh(hists[im], device_hists[im])\n        device_hists[im] = 0\n\n\n    end = time.time()\n    dur = end - start\n    print(' '.join(['Load, Compute, &amp; Gather Time: ', str(dur)]))\n    pool.free_held()\n    return differences\n\ndef get_all_files(directory):\n    pattern = os.path.join(directory, '*.jpg')\n    files = [f for f in glob.glob(pattern)]\n    return files\nif __name__ == \"__main__\":\n    RESOURCES_PATH = \"../data/ims/\"\n    MAX_IMS = 1000\n    direc = os.path.join(RESOURCES_PATH, '21JumpStreet', 'source_video_frames')\n    files = get_all_files(direc)\n    a = cv2.imread('t.png')\n    ims = [cv2.imread(f) for f in files]\n    print 'Shape of my image: ', ims[0].shape\n    print 'Number of images to histogram: ', len(ims)\n    block_size = 128\n    kernel = get_cuda_hist_kernel()\n    start = time.time()\n\n    num_diffs = len(ims) // MAX_IMS + 1\n    cuda_diffs = []\n\n    for i in range(num_diffs):\n\n        first = i * MAX_IMS\n        last = (i + 1) * MAX_IMS\n        print(first)\n        small_set = ims[first:last]\n        print 'Small set size: ', str(len(small_set))\n        cuda_diffs.extend(cuda_histogram(small_set, block_size, kernel))\n\n    end = time.time()\n    dur = end - start\n    print(' '.join(['CUDA version took:', str(dur)]))\n\n    start = time.time()\n    cv_hists = []\n    for i in range(len(ims)):\n        im = ims[i % len(ims)]\n        h = []\n        for j in range(3):\n            hist = cv2.calcHist([im], [j], None, [4], [0, 100])\n            h.extend(hist)\n        cv_hists.append(h)\n\n    #run Chebyshev on CPU:\n    color_hist_diffs = np.array([distance.chebyshev(cv_hists[i-1], cv_hists[i]) \\\n                                 for i in range(len(cv_hists)) if i != 0])\n    print(color_hist_diffs)\n    end = time.time()\n    dur = end - start\n    print(' '.join(['CPU &amp; cv2 version took:', str(dur)]))\n</code></pre>\n"}, {"tags": ["c", "debugging", "segmentation-fault", "gdb", "clion"], "answers": [{"comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 1, "creation_date": 1462339299, "post_id": 37017802, "comment_id": 61589390, "body": "@Montao that allocation is wrong, <code>strlen(strdup(argv[j]))</code> is the length of the string <code>argv[j]</code>, it&#39;s not the number of strings in the array. Why not post the code that calls the function?"}, {"owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 0, "creation_date": 1462342760, "post_id": 37017802, "comment_id": 61590792, "body": "<code>string= write_argument2(argc,  argv);</code> is the code that calls the function."}, {"owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 0, "creation_date": 1462344082, "post_id": 37017802, "comment_id": 61591489, "body": "Yes it works. But I need also to update the variable. Do I have to use realloc? I can ask a new question about a new function. It looks strange but I think I might have to do something like <code>char *** write_command2(int w, int argc, const char *argv[], const char **string[])</code> to update something in a matrix and use the variable <code>char ** string[]</code> as a dynamic matrix that can grow."}, {"owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 0, "creation_date": 1462344513, "post_id": 37017802, "comment_id": 61591733, "body": "I posted another question how to update with realloc. <a href=\"http://stackoverflow.com/questions/37020409/how-can-i-resolve-a-segmentation-fault\" title=\"how can i resolve a segmentation fault\">stackoverflow.com/questions/37020409/&hellip;</a>"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 1, "creation_date": 1462347556, "post_id": 37017802, "comment_id": 61593432, "body": "@Montao What kind of update are you making? like appending another string?"}, {"owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "edited": false, "score": 0, "creation_date": 1462360302, "post_id": 37017802, "comment_id": 61602194, "body": "I have to use a matrix. Now I have a memory leak because of this update: `  string[w]= malloc(argc * sizeof(char*));` And <code>***</code> three star pointers. <code>char *** write_command2(int w, int argc, const char *argv[], char **string[]) {</code> with return type ` string[w]= malloc(argc * sizeof(char*));` and how to <code>free()</code>"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 2, "last_activity_date": 1462343498, "last_edit_date": 1462343498, "creation_date": 1462332035, "answer_id": 37017802, "question_id": 37017487, "link": "https://stackoverflow.com/questions/37017487/cannot-collect-variable/37017802#37017802", "title": "&quot;cannot collect variable&quot;?", "body": "<p>The <code>argv</code> is an array of strings(<code>char *argv[]</code>), it's not a char array. If your string is defined as <code>char string[100][100];</code>, that is, its storage is defined to be arrays, you can do the following:</p>\n\n<pre><code>void write_argument2(int argc, char *argv[], char string[][100]) {\n    int j = 0;\n    for (j = 0; j &lt;  argc; j++) {\n        if (argv[j])\n             strcpy(string[j], argv[j]);\n    }\n}\n</code></pre>\n\n<p>But this is subject to crash if <code>argv</code> has more strings than the number of <code>string</code>, that is 100, or anyone element of the <code>argv</code> is longer than 99. so you could also do dynamic allocation:</p>\n\n<pre><code>char **write_argument2(int argc, char *argv[]) {\n    char **string = malloc(argc * sizeof(char*));\n    int j = 0;\n    for (j = 0; j &lt;  argc; j++) {\n        if (argv[j])\n             string[j] = strdup(argv[j]);\n    }\n    return string;\n}\n</code></pre>\n\n<p>EDIT: add a test program to demonstrate for OP:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar **write_argument2(int argc, char *argv[]) {\n    char **string = malloc(argc * sizeof(char*));\n    int j = 0;\n    for (j = 0; j &lt;  argc; j++) {\n        if (argv[j])\n             string[j] = strdup(argv[j]);\n    }\n    return string;\n}\n\n\nint main(int argc, char *argv[])\n{\n    int i;\n    char **string = write_argument2(argc, argv);\n    for (i = 0; i &lt; argc; i++) {\n        printf(\"%d: %s\\n\", i, string[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Calling this problem:</p>\n\n<pre><code>$ ./a.out a bb ccc dddd\n0: ./a.out\n1: a\n2: bb\n3: ccc\n4: dddd\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 37017802, "answer_count": 1, "score": 2, "last_activity_date": 1462343498, "creation_date": 1462329473, "last_edit_date": 1462330813, "question_id": 37017487, "link": "https://stackoverflow.com/questions/37017487/cannot-collect-variable", "title": "&quot;cannot collect variable&quot;?", "body": "<p>What does it mean: \"Cannot collect variables\" ? How can I fix it ? It makes the debugger won't report values. </p>\n\n<p><a href=\"https://i.stack.imgur.com/YMzCc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YMzCc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to call my function </p>\n\n<p><code>write_argument2(argc,  * argv, * string[0]);</code></p>\n\n<p>I'm going to change and rearrange <code>argv</code>. My variable <code>string</code> is <code>char **string[100][100];</code> and maybe that is not ideal. The string variable is going to update <code>argv</code> with new arguments:</p>\n\n<pre><code>void write_argument2(int argc, char argv[], char *string[]) {\n    int j = 0;\n    for (j = 0; j &lt;  argc; j++) {\n        if (argv[j])\n             string[j] = strdup(&amp;argv[j]);\n    }\n}\n</code></pre>\n\n<p>But I've done something wrong and it crashes. The error says \"cannot collect variable\" and a segmentaion fault for <code>strdup</code>. </p>\n\n<p>I also tried the following which compiles but also becomes a segmentation fault: <code>* string[j] = * strdup( &amp; argv[j]);</code></p>\n\n<p>Gdb says:</p>\n\n<pre><code>GNU gdb (Ubuntu 7.11-0ubuntu1) 7.11\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from ./shell...done.\n(gdb) run\nStarting program: /home/dac/ClionProjects/shell2/openshell/shell \n'PATH' is set to /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin.\n$ ls\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000403b1a in write_argument2 (string=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, \n    argc=&lt;optimized out&gt;) at main.c:147\n147              string[j] = strdup( &amp;argv[j]);\n(gdb) \n</code></pre>\n\n<p>Should I use <code>strcpy</code> instead or change some declarations?</p>\n"}, {"tags": ["c", "file-io", "output"], "comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1462328843, "post_id": 37017404, "comment_id": 61586558, "body": "You can&#39;t print and scan to the same file at the same time."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 1, "creation_date": 1462328850, "post_id": 37017404, "comment_id": 61586561, "body": "Tip: posting &quot;deadlines&quot; in StackOverflow is always a bad idea.  Two whole days to debug your homework is plenty of time."}, {"owner": {"reputation": 7673, "user_id": 3004881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lFgVw.jpg?s=128&g=1", "display_name": "Dan Getz", "link": "https://stackoverflow.com/users/3004881/dan-getz"}, "edited": false, "score": 1, "creation_date": 1462328932, "post_id": 37017404, "comment_id": 61586584, "body": "What were you trying to do with this line: <code>FILE * fopen(char * eceroster, char * r);</code>? Open the file <code>&quot;eceroster&quot;</code> with mode <code>&quot;r&quot;</code>? If so, that won&#39;t do that."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1462329024, "post_id": 37017404, "comment_id": 61586606, "body": "<code>fp</code> is a null pointer, and you never set it to anything else. You never call <code>fopen</code>. (You do uselessly <i>declare</i> <code>fopen</code>. Don&#39;t do that; you already declared it by including <code>&lt;stdio.h&gt;</code>.)"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1462329979, "post_id": 37017404, "comment_id": 61586840, "body": "You are using <code>fp</code> for two <i>different</i> streams: one for <i>input</i> and one for <i>output</i>. That doesn&#39;t work [even if it doesn&#39;t segfault, like what you&#39;re getting now ;-)]. You need <i>two</i>: (e.g. <code>fpi</code> for input and <code>fpo</code> for output). Then, change all <code>fprintf</code> to use <code>fpo</code> and all <code>fscanf_s</code> to use <code>fpi</code>. Probably, you&#39;ll also want <code>fpi = stdin;</code> and <code>fpo = stdout;</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462331245, "post_id": 37017404, "comment_id": 61587112, "body": "Please learn to indent your code; it makes it hard to read if you don&#39;t."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462338241, "post_id": 37017404, "comment_id": 61589038, "body": "BTW <code>%s</code> of <a href=\"https://msdn.microsoft.com/en-us/library/6ybhk9kc.aspx\" rel=\"nofollow noreferrer\">fscanf_s</a> need buffer size."}, {"owner": {"reputation": 7673, "user_id": 3004881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lFgVw.jpg?s=128&g=1", "display_name": "Dan Getz", "link": "https://stackoverflow.com/users/3004881/dan-getz"}, "edited": false, "score": 0, "creation_date": 1462456951, "post_id": 37017404, "comment_id": 61652501, "body": "Could you give the full error information? &quot;Debug Assertion Failed!&quot; sounds like just its title."}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 731351, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9ff7437b8556f211b9669ef8ca93e538?s=128&d=identicon&r=PG", "display_name": "darked89", "link": "https://stackoverflow.com/users/731351/darked89"}, "edited": false, "score": 0, "creation_date": 1462332230, "post_id": 37017614, "comment_id": 61587334, "body": "Thanks, I can put my new powers to a good use. While you assignment is in C, you may use i.e. Python for a prototyping/creating data files. If you know that datafiile_1.tsv van be parsed by your Python script easily, you will save a lot of time trying to duplicate the functionality in C. Otherwise instead of learning C you will waste time to find some extra space, missing coma, etc. in the throwaway data files. Best"}], "tags": [], "owner": {"reputation": 166, "user_id": 731351, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9ff7437b8556f211b9669ef8ca93e538?s=128&d=identicon&r=PG", "display_name": "darked89", "link": "https://stackoverflow.com/users/731351/darked89"}, "is_accepted": false, "score": 1, "last_activity_date": 1462330555, "creation_date": 1462330555, "answer_id": 37017614, "question_id": 37017404, "link": "https://stackoverflow.com/questions/37017404/input-and-output-from-a-file-in-c/37017614#37017614", "title": "Input and Output from a File in C", "body": "<p>I am missing points to post a comment, so using answer. You have to:</p>\n\n<blockquote>\n  <p>The program should take all input (e.g., roster size, number of\n  programming assignments, number of test, and the information for each\n  of the student) from a file.</p>\n</blockquote>\n\n<p>Which means: there is no point of asking on a command line for number of students, tests. You start with creating some easy to parse text data files containing info about the students, assert that num_of_students &lt; 51, names of students or at least their IDs are unique, etc. \nApart from good input files you should also create few screwed ones. So you can show how your program handles bad inputs. </p>\n\n<p>And then think about few essential use cases for that data:</p>\n\n<ol>\n<li>a student wants to know his courses / grades </li>\n<li>prof Smith needs to know all the students participating in his\ncourse</li>\n<li>summaries: how many: students, courses, students per course</li>\n</ol>\n\n<p>Nobody is going to check this program is going to put i.e. 51 names, IDs, plus say 100 grades by hand on the command line, and as it is stated in the quoted part of the assignment, it is neither needed nor expected.</p>\n\n<p>Hope it helps </p>\n"}], "owner": {"reputation": 1, "user_id": 6287306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01f1bc5add7e2f73523690eadcb67b0?s=128&d=identicon&r=PG&f=1", "display_name": "msunshine", "link": "https://stackoverflow.com/users/6287306/msunshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "closed_date": 1462831419, "answer_count": 1, "score": -2, "last_activity_date": 1462395390, "creation_date": 1462328737, "last_edit_date": 1462395390, "question_id": 37017404, "link": "https://stackoverflow.com/questions/37017404/input-and-output-from-a-file-in-c", "closed_reason": "Not suitable for this site", "title": "Input and Output from a File in C", "body": "<p>This homework assignment is:</p>\n\n<ul>\n<li><p>Implement a program that mimics the ECE 173 class roster. The roster has a maximum of 50 students.  </p></li>\n<li><p>Each student has a last name, first name, student ID, possible scores for programming assignments (1\u20135), and possible scores for tests (1 and 2). Use structures and functions to develop the program.</p></li>\n<li><p>The program should take all input (e.g., roster size, number of programming assignments, number of test, and the information for each of the student) from a file. When all of the information is entered, the user should be able to display the entered information and also have the screen output written to a file.</p></li>\n<li><p>Note: Your submission must include five different input files that you had used to test your program.</p></li>\n</ul>\n\n<p>I have done the first part relating to the ECE 173 class roster. However I'm really struggling with the input/output part of this assignment. This is what I have right now; it builds successfully but when running the program, it stops. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct test{double testgrade;\n};\nstruct hw{double hwgrade;\n};\nstruct student{\nchar first[30];\nchar last[30];\nint stuID;\nstruct hw hwamount[5];\nstruct test testamount[2];\n};\n\nint main() {\n\nint rostersize;\nint testnumber;\nint hwnumber;\n\nFILE *fp;\nFILE * fop;\nfp = stdin;\nfop = stdout;\n\nfp = fopen(\"eceroster_in.txt\", \"r\");\nfop = fopen(\"eceroster_out.txt\", \"w\");\n\n//fprintf(fp, \"How many students are there?\\n\");\nfscanf_s(fp, \"%d\", &amp;rostersize);\n    while (rostersize &gt;50){\n        //printf(\"Roster cannot exceed 50 students!\\n\");\n        fscanf_s(fp, \"%d\", &amp;rostersize);\n}\n    struct student roster[50];\n\n//fprintf(fp, \"How many tests are there?\\n\");\nfscanf_s(fp, \"%d\", &amp;testnumber);\n    while (testnumber &gt;2){\n        //printf(\"Cannot exceed 2 tests!\\n\");\n        fscanf_s(fp, \"%d\", &amp;testnumber);\n}\n//fprintf(fp,\"How many assignments are there?\\n\");\nfscanf_s(fp, \"%d\", &amp;hwnumber);\n    while (hwnumber &gt;5){\n    //fprintf (fp, \"Cannot exceed 5 assignments!\\n\");\n    fscanf_s(fp,\"%d\", &amp;hwnumber);\n}\nfor (int i = 0; i &lt; rostersize; i++){\n\n//fprintf(fp, \"Enter student's last name:\\n\");\nfscanf_s(fp, \"%s\", &amp;(roster[i].last));\n\n//fprintf(fp, \"Enter student's first name:\\n\");\nfscanf_s(fp, \"%s\", &amp;(roster[i].first));\n\n//fprintf(fp, \"Enter the student's ID:\\n\");\nfscanf_s(fp, \"%i\", &amp;(roster[i].stuID));\n\nfor (int j = 0; j &lt; testnumber; j++){\n\n//fprintf(fp, \"Enter the student grade for test %d\\n\", j+1);\nfscanf_s(fp, \"%lf\", &amp;(roster[i].testamount[j].testgrade));\n}\n\nfor (int k = 0; k &lt; hwnumber; k++){\n\n//fprintf(fp, \"Enter the student grade for assignment %d\\n\", k+1);\nfscanf_s(fp, \"%lf\", &amp;(roster[i].hwamount[k].hwgrade));\n    }\n}\n//fprintf(fp, \"How many times would you like your roster to print?\\n\");\n    int rosterAmount;\n    fscanf_s(fp, \"%d\", &amp;rosterAmount);\n\nfor (int j = 0; j &lt; rosterAmount; j++){\n for (int k = 0; k &lt; rostersize; k++){\n\n    fprintf(fop, \"Name: %s %s \\n\", &amp;(roster[k].first, roster[k].last));\n    fprintf(fop, \"Student ID: %d\\n\", &amp;(roster[k].stuID));\n\nfor (int mm = 0; mm &lt; testnumber; mm++){\n    fprintf(fop, \"Test %d: %.1f\\n\", &amp;\n(mm+1,roster[k].testamount[mm].testgrade));\n        }\n\nfor (int m = 0; m &lt; hwnumber; m++){\n    fprintf(fop, \"Assignment %d: %.1f\\n\", &amp;   (m+1,roster[k].hwamount[m].hwgrade));\n        }\n\n  fprintf(fop, \"_______________________________\\n\");\n    }\n}\nfclose (fp);\nfclose (fop);\n\nreturn 0;\n}\n</code></pre>\n\n<p>It builds successfully, but it has an error \"Debug Assertion Failed! when trying to debug</p>\n"}]