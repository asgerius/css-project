[{"tags": ["c", "struct", "casting"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1533772657, "post_id": 51757117, "comment_id": 90473711, "body": "struct A is just an int in memory.  struct B is just 2 ints (and any padding for more complex structs).  You could <code>printf(&quot;%d&quot;, (int*) b) </code> and see 5 too."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1533774284, "post_id": 51757117, "comment_id": 90474022, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3995940/casting-one-c-structure-into-another\">Casting one C structure into another</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1533794117, "post_id": 51758304, "comment_id": 90478488, "body": "C 2011 6.7.2.1 15 says that a pointer to a structure that is suitably converted (<i>e.g.</i>, to the type of a pointer to the type of its first member) yields a pointer to its first member."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1533815857, "post_id": 51758304, "comment_id": 90491308, "body": "Thanks, @EricPostpischil.  I have updated the answer to reflect your observation, which indeed leads to a much stronger position."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 6, "last_activity_date": 1533815752, "last_edit_date": 1533815752, "creation_date": 1533784532, "answer_id": 51758304, "question_id": 51757117, "link": "https://stackoverflow.com/questions/51757117/cast-struct-pointer-to-another-struct/51758304#51758304", "title": "Cast struct pointer to another struct", "body": "<blockquote>\n  <p>When I create <code>b</code>, a pointer to it would point to the data <code>{ {5}, 10 }</code>.</p>\n</blockquote>\n\n<p>Yes, in the sense of that being the text of a type-appropriate and value-correct C initializer.  That text itself should not be taken <em>literally</em> as the value of the structure.</p>\n\n<blockquote>\n  <p>When I cast <code>&amp;b</code> to <code>struct A*</code>, I'm assuring the compiler that this\n  <code>struct A*</code> points to a struct of a single data element of data type\n  int.</p>\n</blockquote>\n\n<p>No, not exactly.  You are <em>converting</em> the value of the expression <code>&amp;b</code> to type <code>struct A *</code>.  Whether the resulting pointer actually points to a <code>struct A</code> is a separate question.</p>\n\n<blockquote>\n  <p>Instead, I'm providing it a pointer to a struct of two data\n  elements of data types <code>struct A</code>, <code>int</code>.</p>\n</blockquote>\n\n<p>No, not \"instead\".  Given that <code>struct B</code>'s first member is a <code>struct A</code>, and that C forbids padding before the first member of a structure, a pointer to a <code>struct B</code> <em>also</em> points to a <code>struct A</code> -- the B's first member -- in a general sense.  As @EricPostpischi observed in comments, the C standard explicitly specifies the outcome in your particular case: given <code>struct B b</code>, converting a pointer to <code>b</code> to type <code>struct A *</code> yields a pointer to <code>b</code>'s first member., a <code>struct A</code>. </p>\n\n<blockquote>\n  <p>Even if the second variable is ignored (since <code>struct A</code> has only one\n  data member) I am still providing it a struct whose member is of data\n  type <code>struct A</code>, not <code>int</code>.</p>\n</blockquote>\n\n<p>The first <code>sizeof(struct A)</code> bytes of the representation of a <code>struct B</code> form the representation of its first member, a <code>struct A</code>.  That the latter is a member of the former has no physical manifestation other than their overlap in memory.</p>\n\n<p>Even if the language did not explicitly specify it, given your declaration of variable <code>b</code> as a <code>struct B</code>, there would be no practical reason to expect that the expression <code>(struct A*)&amp;b == &amp;b.a</code> would evaluate to false, and there can be no question that the right-hand pointer can be used to access a <code>struct A</code>.</p>\n\n<blockquote>\n  <p>Thus, when I pass in a to <code>printA</code>, the line <code>a-&gt;x</code> is performed,\n  essentially asking to access the first data element of <code>a</code>.</p>\n</blockquote>\n\n<p>Yes, and this is where an assertion enters that <code>a</code> really does point to a <code>struct A</code>.  Which it does in your case, as already discussed.</p>\n\n<blockquote>\n  <p>The first\n  data element of <code>a</code> is of data type <code>struct A</code>,</p>\n</blockquote>\n\n<p>No.  <code>*a</code> is by definition a <code>struct A</code>.  Specifically, it is the <code>struct A</code> whose representation overlaps the beginning of the representation of <code>b</code>.  If there were not such a <code>struct A</code> then the behavior would be undefined, but that's not an issue here.  Like every <code>struct A</code>, it has a member, designated by <code>x</code>, that is an <code>int</code>.</p>\n\n<blockquote>\n  <p>which is a type mismatch\n  due to the <code>%d</code> expecting a digit, not a <code>struct A</code>.</p>\n</blockquote>\n\n<p>You mean expecting an <code>int</code>.  And that's what it gets.  That's what the expression <code>a-&gt;x</code> reads, supposing the behavior is defined at all, because that is the type of that expression.  Under different circumstances the behavior might indeed not be defined, but under no circumstance does that expression ever provide a <code>struct A</code>.</p>\n\n<blockquote>\n  <p>What exactly is happening here?</p>\n</blockquote>\n\n<p>What seems to be happening is that you are imagining different, higher-level semantics than C actually provides.  In particular, you seem to have a mental model of structures as lists of distinguishable member objects, and that's leading you to form incorrect expectations.</p>\n\n<p>Perhaps you are more familiar with a weakly typed language such as Perl, or a dynamically typed language such as Python, but C works differently.  You cannot look at a C object and usefully ask \"what is your type\"?  Instead, you look at each and every object through the lens of the static type of the expression used to access it.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1533794229, "creation_date": 1533794229, "answer_id": 51759740, "question_id": 51757117, "link": "https://stackoverflow.com/questions/51757117/cast-struct-pointer-to-another-struct/51759740#51759740", "title": "Cast struct pointer to another struct", "body": "<p>There is a special rule in the C standard for this case. C 2011 6.7.2.1 15 says:</p>\n\n<blockquote>\n  <p>A pointer to a structure object, suitably converted, points to its initial member (or if that member is a bit-field, then to the unit in which it resides), and vice versa.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1533805066, "creation_date": 1533805066, "answer_id": 51762793, "question_id": 51757117, "link": "https://stackoverflow.com/questions/51757117/cast-struct-pointer-to-another-struct/51762793#51762793", "title": "Cast struct pointer to another struct", "body": "<p>The language-lawyer explanation of why the code is fine:</p>\n\n<ul>\n<li>Any pointer in C may be converted to any other pointer type. (C17 6.3.2 \u00a77). </li>\n<li>If it is safe to dereference the pointed-at object after conversion depends on: 1) if the types are compatible and thereby correctly aligned, and 2) if the respective pointer types used are allowed to alias.</li>\n<li><p>As a special case, a pointer to a struct type is equivalent to a pointer to its first member. The relevant part of C17 6.7.2 \u00a715 says:</p>\n\n<blockquote>\n  <p>A pointer to a structure object,\n  suitably converted, points to its initial member (or if that member is a bit-field, then to the unit in\n  which it resides), and vice versa.</p>\n</blockquote></li>\n<li><p>This means that <code>(struct A*)&amp;b</code> is fine. <code>&amp;b</code> is suitably converted to the correct type.</p></li>\n<li><p>There is no violation of \"strict aliasing\", since we fulfil C17 6.5 \u00a77:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue expression that has one of the following types:</p>\n  \n  <ul>\n  <li>a type compatible with the effective type of the object,\n  ...  </li>\n  <li>an aggregate or union type that includes one of the aforementioned types among its members</li>\n  </ul>\n</blockquote>\n\n<p>The effective type of the initial member being <code>struct A</code>. The lvalue access that happens inside the print function is fine. <code>struct B</code> is also an aggregate type that includes <code>struct A</code> among its members, so strict aliasing violations are impossible, regardless of the initial member rule cited at the top.</p></li>\n</ul>\n"}], "owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2083, "favorite_count": 0, "accepted_answer_id": 51758304, "answer_count": 3, "score": 2, "last_activity_date": 1533815752, "creation_date": 1533772253, "last_edit_date": 1533773037, "question_id": 51757117, "link": "https://stackoverflow.com/questions/51757117/cast-struct-pointer-to-another-struct", "title": "Cast struct pointer to another struct", "body": "<p>This code snippet prints the value <code>5</code>. I don't understand why.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct A\n{\n    int x;\n};\n\nstruct B\n{\n    struct A a;\n    int y;\n};\n\nvoid printA(struct A *a)\n{\n    printf(\"A obj: %d\\n\", a-&gt;x);\n}\n\nint main()\n{\n    struct B b = {\n        {\n            5\n        },\n        10\n    };\n\n    struct A *a = (struct A*)&amp;b;\n    printA(a);\n\n    printf(\"Done.\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>When I create <code>b</code>, a pointer to it would point to the data <code>{ {5}, 10 }</code>.</p>\n\n<p>When I cast <code>&amp;b</code> to <code>struct A*</code>, I'm assuring the compiler that this <code>struct A*</code> points to a struct of a single data element of data type <code>int</code>. Instead, I'm providing it a pointer to a struct of two data elements of data types <code>struct A</code>, <code>int</code>.</p>\n\n<p>Even if the second variable is ignored (since <code>struct A</code> has only one data member) I am still providing it a struct whose member is of data type <code>struct A</code>, not <code>int</code>.</p>\n\n<p>Thus, when I pass in <code>a</code> to <code>printA</code>, the line <code>a-&gt;x</code> is performed, essentially asking to access the first data element of <code>a</code>. The first data element of <code>a</code> is of data type <code>struct A</code>, which is a type mismatch due to the <code>%d</code> expecting a digit, not  a <code>struct A</code>.</p>\n\n<p>What exactly is happening here? </p>\n"}, {"tags": ["c++", "c", "sockets", "epoll"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1533772639, "post_id": 51757113, "comment_id": 90473705, "body": "Sure, it is not a <i>requirement</i>, but if the data can&#39;t be sent right away, the <code>write()</code> will either block the calling thread (blocking socket) or fail with <code>EAGAIN</code>/<code>EWOULDBLOCK</code> (non-blocking socket). In the latter case, you could just call <code>write()</code> again periodically, or you could use <code>EPOLLOUT</code> to know when the socket is ready to send data before calling <code>write()</code> again."}, {"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533773021, "post_id": 51757113, "comment_id": 90473769, "body": "Can I do <code>if (EWOULDBLOCK || EINTR ||  EAGAIN) then I retry to write</code> ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1533773305, "post_id": 51757113, "comment_id": 90473819, "body": "You can. But in such case, if the socket is blocked for awhile (network lag, unresponsive peer, etc), you would end up in a busy loop calling <code>write()</code> over and over, wasting CPU cycles.  Better to put the calling thread to sleep waiting for <code>EPOLLOUT</code> (or have the thread go do something else for awhile and come back later) before calling <code>write()</code> again."}], "answers": [{"comments": [{"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974128, "post_id": 51757553, "comment_id": 90552327, "body": "what if i do EPOLLIN for listenfd only, once accepted, bring along accepted fd and spawn new thread to do recv and send and close? It won&#39;t blocked the epoll, it also work alone in the thread."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974493, "post_id": 51757553, "comment_id": 90552402, "body": "You never want to write to the accepting socket, so EPOLLIN only is fine for that socket. Generally speaking, pre-emptive thread per connection servers don&#39;t scale very well, but if the load is expected to be light, it works well and the code can be easier to understand."}, {"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974764, "post_id": 51757553, "comment_id": 90552455, "body": "I mean in psuedo coding fd = accept(...); new thread(fd) { recv(fd...); heavyProcess(); send(fd...); close(fd); }  So I can handle multi threaded request concurrently?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1534352844, "post_id": 51757553, "comment_id": 90678697, "body": "@Oktaheta My comment is the same. It doesn&#39;t scale, but if that doesn&#39;t matter, it works."}, {"owner": {"reputation": 766, "user_id": 9158613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdc7af72ee7dd5897b002474701d285?s=128&d=identicon&r=PG&f=1", "display_name": "asinix", "link": "https://stackoverflow.com/users/9158613/asinix"}, "edited": false, "score": 0, "creation_date": 1567678594, "post_id": 51757553, "comment_id": 102038237, "body": "@jxh  &quot;Enable edge triggered notifications, and leave EPOLLOUT enabled all the time&quot; should it not be &quot;Enable edge triggered notifications, and start with EPOLLOUT disabled. When you get EWOULDBLOCK or EAGAIN on write enable EPOLLOUT&quot;"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 766, "user_id": 9158613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdc7af72ee7dd5897b002474701d285?s=128&d=identicon&r=PG&f=1", "display_name": "asinix", "link": "https://stackoverflow.com/users/9158613/asinix"}, "edited": false, "score": 1, "creation_date": 1567701337, "post_id": 51757553, "comment_id": 102050922, "body": "@asinix: No. With edge triggered and EPOLLOUT always enabled, the application always attempts to write. When write blocks, it only waits for notification, since EPOLLOUT is already enabled."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 3, "last_activity_date": 1533777013, "creation_date": 1533777013, "answer_id": 51757553, "question_id": 51757113, "link": "https://stackoverflow.com/questions/51757113/what-happened-if-i-dont-set-epollout-event-and-direct-call-write-function/51757553#51757553", "title": "What happened if I don&#39;t set EPOLLOUT event and direct call write() function?", "body": "<p>When using <code>epoll</code> with level triggered notifications, you will get constant <code>EPOLLOUT</code> notifications on a socket except for those brief periods of time that the output buffer for the socket is actually full. The impact of this is that your event loop will wake up even if you have nothing to send, and there was no data to receive either.</p>\n\n<p>To deal with that, you have two practical choices:</p>\n\n<ol>\n<li><p>Disable <code>EPOLLOUT</code> until those times you actually get <code>EWOULDBLOCK</code> / <code>EAGAIN</code>. At that point, you enable <code>EPOLLOUT</code>, and disable it again once your send is complete.</p></li>\n<li><p>Enable edge triggered notifications, and leave <code>EPOLLOUT</code> enabled all the time. Now, you will only get <code>EPOLLOUT</code> notifications when the system changes from a output buffer full state to non-full state. However, <code>EPOLLIN</code> is now also also edge triggered, which means you only get one <code>EPOLLIN</code> notification until you drain the input buffer.</p></li>\n</ol>\n\n<p>In comments, a third option was presented to you to implement your own polling loop to deal with the sockets with full output buffers. This can be made to work, but should not be necessary, since <code>epoll</code> can tell you when it is okay to write.</p>\n"}], "owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533777013, "creation_date": 1533772220, "question_id": 51757113, "link": "https://stackoverflow.com/questions/51757113/what-happened-if-i-dont-set-epollout-event-and-direct-call-write-function", "title": "What happened if I don&#39;t set EPOLLOUT event and direct call write() function?", "body": "<p>I have EPOLLIN event for read data only. Is it ok to direct write the data without setting EPOLLOUT event? </p>\n"}, {"tags": ["python", "c", "tensorflow", "machine-learning"], "comments": [{"owner": {"reputation": 49730, "user_id": 349130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4efeebbf6994bb904738c4fb8922bf?s=128&d=identicon&r=PG", "display_name": "Dr. Snoopy", "link": "https://stackoverflow.com/users/349130/dr-snoopy"}, "edited": false, "score": 0, "creation_date": 1533791891, "post_id": 51757055, "comment_id": 90477743, "body": "Without code this is too broad, you need to include code of what you have tried, and then we can start trying to help you. Getting the weights is not hard in many frameworks."}], "answers": [{"tags": [], "owner": {"reputation": 401, "user_id": 9510611, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kevin Glasson", "link": "https://stackoverflow.com/users/9510611/kevin-glasson"}, "is_accepted": false, "score": 1, "last_activity_date": 1533775256, "creation_date": 1533775256, "answer_id": 51757379, "question_id": 51757055, "link": "https://stackoverflow.com/questions/51757055/writing-a-tensorflow-model-for-c/51757379#51757379", "title": "Writing a Tensorflow Model for C", "body": "<p>I don't know how to do it in Tensorflow directly, however I do have some suggestions.</p>\n\n<p>Use <a href=\"https://keras.io/getting-started/faq/\" rel=\"nofollow noreferrer\">Keras</a> with the Tensorflow backend and then you can export the weights directly like this.</p>\n\n<pre><code>model.save_weights('my_model_weights.h5')\n</code></pre>\n\n<p>Using these weights and applying the layers via manual convolutions etc. is still quite hard..</p>\n\n<p>if you are not doing it just for the sake of learning there are some libraries where you can use the model created in Keras in C++ without all of the overhead of having to install Python, Keras, Tensorflow etc.</p>\n\n<p>You might want to do this if you're trying to implement your model on a small device?</p>\n\n<p>Anyway some of the C++ libraries to look into are:</p>\n\n<p><a href=\"https://github.com/Dobiasd/frugally-deep\" rel=\"nofollow noreferrer\">frugally-deep</a></p>\n\n<p><a href=\"https://github.com/moof2k/kerasify\" rel=\"nofollow noreferrer\">Kerasify</a></p>\n\n<p><a href=\"https://github.com/pplonski/keras2cpp\" rel=\"nofollow noreferrer\">keras2cpp</a></p>\n\n<p>I know you said C specifically, but I'm guess maybe if you have C compiler you could sort out a C++ compiler?</p>\n"}], "owner": {"reputation": 21, "user_id": 10194582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435d65625482656f6ff62129c29ba9c8?s=128&d=identicon&r=PG&f=1", "display_name": "Drummerboy2543", "link": "https://stackoverflow.com/users/10194582/drummerboy2543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1533791728, "answer_count": 1, "score": -2, "last_activity_date": 1533775256, "creation_date": 1533771641, "last_edit_date": 1533773896, "question_id": 51757055, "link": "https://stackoverflow.com/questions/51757055/writing-a-tensorflow-model-for-c", "closed_reason": "Needs more focus", "title": "Writing a Tensorflow Model for C", "body": "<p>This is my first time implementing machine learning period. So if I am missing some critical information, please let me know. </p>\n\n<p>My goal here is to make a machine learning model to emulate a lookup table. The idea is that the amount of storage is critical, so having a model that can calculate the value will have a smaller memory footprint than a look-up table. The reason is that any machine learning model is just a glorified equation. </p>\n\n<p>EX: :Linear regression is y=mx1+mx2 ... +b, </p>\n\n<p>Neural Net: Is a bunch weights going to a node to be summed, and then do a function like a sigmoid function. </p>\n\n<p>Since I am trying to have a very small footprint I naturally thought about doing linear regression. Unfortunately, the accuracy is not up to par that is necessary. So now I am deciding on using tensorflow to see if I can make a model with better accuracy. I created a simple model and the performance is better, however, this requires to get the weights and the tensor model itself so I can port the equation into C. \nThe process of finding the raw weights and the config of the model seems to be harder to do than first thought (It seems like they abstract it quite a bit).</p>\n\n<p>I have also tried a variety of other ideas not discussed above (Microsoft Machine Learning Studio, AWS Machine Learning etc.) And the one thing I noticed from all of these solutions is that you can't get a direct view of the weights and models you created with your training set. It makes sense for a web app, but I need to execute the model on an embedded system so I need to see everything.</p>\n\n<p>This is where my question comes in, I am wondering if I am barking up the wrong tree on solving this problem. Machine learning goal is to give accurate results to brand new inputs it has not seen. However, given my situation, I am trying to over-fit as much as possible so I can have an extremely accurate model (equation) of our lookup table. </p>\n\n<p>Is there a more elegant way to solve this problem that I am missing? If not, how do I extract the weights and model information from tensorflow so I can port the equation into C?</p>\n\n<p>Thank you so much and I hope you guys have a great day!</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533771787, "post_id": 51757034, "comment_id": 90473545, "body": "1. Portability. Some function need flags that are different on different architectures and/or compilers and/or those flags changed with kernel versions. So people doesn&#39;t have to change the function declaration each time some guy changes kernel section naming, those are wrapped in macros. 2. Search google for <code>do while C macro</code>, it is a common, standard practice to warp multiline macro statements in <code>do{}while(0)</code>. Thers even MISRA-C:2004 rule 19.4"}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1533803678, "post_id": 51757067, "comment_id": 90483507, "body": "It <i>might</i> need to be a macro: one possibility is that is has to support <code>state_value</code> being a function call instead of a variable."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": true, "score": 1, "last_activity_date": 1533771740, "creation_date": 1533771740, "answer_id": 51757067, "question_id": 51757034, "link": "https://stackoverflow.com/questions/51757034/linux-kernel-defines-everywhere/51757067#51757067", "title": "Linux Kernel defines everywhere", "body": "<p>This isn't a \"function\", it's a preprocessor macro.</p>\n\n<ol>\n<li><p>Sometimes one must use macros to do things that the C language itself doesn't support  (usually generating code). This doesn't look like one of those cases though, and should probably be a <code>static inline</code> function. Pergaps the Git history would explain why it is the way it is.</p></li>\n<li><p><code>do { ... } while (0)</code> is a common method for swallowing the semicolon which follows a call to a C-function-looking macro like this one.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1533771924, "creation_date": 1533771924, "answer_id": 51757083, "question_id": 51757034, "link": "https://stackoverflow.com/questions/51757034/linux-kernel-defines-everywhere/51757083#51757083", "title": "Linux Kernel defines everywhere", "body": "<p>Functions are usually preferrable because they provide type checking and aren't error prone to things like double evaluation, but macros are more powerful, since they allow you to work at the text/token level.</p>\n\n<p><code>do{}while(0)</code> is to make an invoked macro grammatically behave like a void-returning function call.</p>\n\n<p>You might think a plain pair of curlies would do that but that doesn't work\nwith if-else</p>\n\n<pre><code>#define macro_with_curlies() { }\nif(x) macro_with_curlies(); else { }\n//expands to: if(x) { }; /*else is illegal after the semicolon*/ else { }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3183671"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 51757067, "answer_count": 2, "score": -2, "last_activity_date": 1533771924, "creation_date": 1533771416, "question_id": 51757034, "link": "https://stackoverflow.com/questions/51757034/linux-kernel-defines-everywhere", "title": "Linux Kernel defines everywhere", "body": "<p>On linux's kernel we can find this piece of code in <code>linux/sched.h</code>, when I saw it some doubts came to my mind:</p>\n\n<ol>\n<li>Why using define to create functions? Why not using the normal <code>return-type function-name(par1, par2) {}</code> style?</li>\n<li><p>What is the point with the <code>do {} while(0)</code>?</p>\n\n<pre><code>#define set_special_state(state_value)  \n    do {  \n        unsigned long flags;  \n        raw_spin_lock_irqsave(&amp;current-&gt;pi_lock, flags);  \n        current-&gt;state = (state_value);  \n        raw_spin_unlock_irqrestore(&amp;current-&gt;pi_lock, flags);  \n    } while (0)  \n#endif  \n</code></pre></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1533759302, "post_id": 51754913, "comment_id": 90469476, "body": "Because text is composed of readable / printable symbols which are a <b>proper subset</b> of <i>all</i> of the available symbols. As for the programs/scripts you better research a bit about the difference between scripting/interpreted and compiled languages."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1533759484, "post_id": 51754913, "comment_id": 90469564, "body": "There is a tremendous difference between &quot;binary&quot; and &quot;executable&quot;.  There are executable files that afford interpretation as text (i.e. would not normally be considered binary), and files that do not support interpretation as text that nevertheless are not executable.  The two concepts are pretty much orthogonal."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 5, "creation_date": 1533759794, "post_id": 51754913, "comment_id": 90469732, "body": "In any case, text <i>vs.</i> binary is not a fundamental file characteristic on modern operating systems, but rather a differentiation between how files are <i>interpreted</i>."}], "answers": [{"comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1533761263, "post_id": 51755286, "comment_id": 90470471, "body": "Perhaps the best example of this is the EICAR test virus which is the following string: <code>X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FI&zwnj;&#8203;LE!$H+H*</code>  which is composed entirely of printable ASCII characters.  However, under 16 bit MSDOS, if that were saved as a file that was given a .COM extension, it would run as a program that announced itself."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 7, "last_activity_date": 1533761496, "last_edit_date": 1533761496, "creation_date": 1533760687, "answer_id": 51755286, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51755286#51755286", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>@JohnBollinger summarized it best in a comment.</p>\n\n<blockquote>\n  <p>text vs. binary is not a fundamental file characteristic on modern operating systems, but rather a differentiation between how files are <em>interpreted</em>.</p>\n</blockquote>\n\n<p>Let's say a file contains four bytes with the following hex values of the bytes:</p>\n\n<pre><code>0x41 0x42 0x43 0x44\n</code></pre>\n\n<p>If you interpret those bytes as characters in a system that uses ASCII encoding, you will get the characters <code>ABCD</code>.</p>\n\n<p>If you treat those bytes as a 4-byte integer, you will get the value <code>0x41424344</code> (1094861636 in decimal) in a big endian system and <code>0x44434241</code> (1145258561 in decimal) in a little endian system.</p>\n\n<p>As far as the computer is concerned, it's all binary. As to what they mean, it's all a matter of intepretation.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1533760698, "creation_date": 1533760698, "answer_id": 51755290, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51755290#51755290", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>I think one has to distinguish \"text\", \"binary\", and \"executable\":</p>\n\n<p>\"Text\" usually means a file containing only human readable characters (alpha + numeric + tabs and cr/lf), i.e. something that you can open with a text editor without seeing weird stuff. </p>\n\n<p>The meaning of \"binary\" often depends on the context. If the context is, for example, the open mode used in file processing, then \"binary\" means that each byte is read in as is, whereas \"text\" means that platform specific conversions like automatically converting a <code>\"\\r\\n\"</code> into a single <code>\"\\n\"</code> apply (cf., for example, <code>FILE *fp=fopen(\"c:\\\\test.txt\", \"rb\")</code> versus <code>FILE *fp=fopen(\"c:\\\\test.txt\", \"rt\")</code>).  If the context is the distribution format of programs, then \"binary\" often means \"precompiled for a particular platform\". This is in contrast to source code distributions, where the files are typically \"text files\".</p>\n\n<p>The meaning of \"executable\" is that the file content is interpreted by the operating system as an executable program. This often means a file containing machine code instructions, which contain non-readable characters as well, such that they are usually not \"text files\", and they are usually not interpreted as text. In a broader sense, also shell scripts are \"executables\", as they contain instructions interpreted by the respective shell. These instructions are written as text and can be opened in a text editor.</p>\n\n<p>From these perspectives, I think that \"text\" and \"binary\" are opposite terms, whereas \"executable\" is orthogonal to both.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": -1, "last_activity_date": 1533761452, "last_edit_date": 1533761452, "creation_date": 1533760901, "answer_id": 51755330, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51755330#51755330", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>In general, a file is just a sequence of bytes.</p>\n\n<p>For any machine you're likely to use, bytes are 8 bits.  So each byte has 256 possible values.</p>\n\n<p>Confining our attention for the moment to old-fashioned ASCII. something like 95 of those bytes are ordinary, printing characters: letters, digits, punctuation.  There are a few more characters which may also appear in text files: let's say tab, carriage return, linefeed, and form feed (<code>'\\t'</code>, <code>'\\r'</code>, <code>'\\n'</code>, and <code>'\\f'</code>).</p>\n\n<p>If every one of the bytes in a file is one of those printing characters, the file is a text file.</p>\n\n<p>If any of the bytes in a file is other than one of those printing characters, the file is not a text file.</p>\n\n<p>If the file is intended for human consumption, its creator will have used only the ordinary printing characters, and it will be a text file.</p>\n\n<p>If the file contains arbitrary data, each byte might have any of its 256 possible values, and the file will be a binary file.  It's very likely that at least one of the bytes in such a file will be something other than an ordinary printing character.  (Even if all the arbitrary bytes just happen to be in the set of ordinary printable characters, they probably won't mean much, and we might still think of it as a binary file.)</p>\n\n<p>Anyway, that's why every text file is theoretically a binary file, but not every binary file is a text file.</p>\n\n<p>As a practical example, try this program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    short int x = 906;\n    FILE *fp1 = fopen(\"textfile.txt\", \"w\");\n    FILE *fp2 = fopen(\"binaryfile.bin\", \"wb\");\n    if(fp1 == NULL || fp2 == NULL) exit(1);\n    fprintf(fp1, \"%d\\n\", x);\n    fwrite(&amp;x, sizeof(x), 1, fp2);\n    fclose(fp1);\n    fclose(fp2);\n}\n</code></pre>\n\n<p>If you compile and run this program, you should find that it creates a text file <code>textfile.txt</code> containing the string <code>12345</code>.  But if you inspect the file <code>binaryfile.bin</code>, you should find that it contains just two bytes, with the hexadecimal values <code>03</code> and <code>8A</code>.  Neither of those is an ordinary printing character, so it's a binary file.</p>\n\n<p>Now, try changing the program slightly, setting</p>\n\n<pre><code>short int x = 12345;\n</code></pre>\n\n<p>If you run it again, <code>textfile.txt</code> will now contain the string <code>12345</code>, as expected.  <code>binaryfile.bin</code> will again contain two bytes, this time with hex values <code>30</code> and <code>39</code>.  But if you try printing <code>binaryfile.bin</code>, you'll probably see the characters <code>0</code> and <code>9</code>, because <code>0x30</code> and <code>0x39</code> are the ASCII codes for the characters <code>0</code> and <code>9</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "edited": false, "score": 0, "creation_date": 1534484048, "post_id": 51755667, "comment_id": 90728868, "body": "Keeping all (encoding, locale, machine, creator, user, etc) fixed i.e using only ASCII encoding, etc, so are you saying we cannot define text file based on what bytes it contain"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "edited": false, "score": 0, "creation_date": 1534500582, "post_id": 51755667, "comment_id": 90736891, "body": "What I am saying is you can use contents to determine what format a file appears to have, but how the file contents are interpreted by a given program may be more subtle. Changing the line termination scheme may seem innocuous for an ASCII text file, but some programs will fail to display it properly (for example Notepad does not handle text files with unix style line endings correctly)."}, {"owner": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "edited": false, "score": 0, "creation_date": 1534509966, "post_id": 51755667, "comment_id": 90742086, "body": "Will you agree with me on this - Fixed encoding ASCII, locale, machine, etc if I save single character &#39;a&#39; in it - it can be called text file (remember all text files are binary files)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "edited": false, "score": 0, "creation_date": 1534533442, "post_id": 51755667, "comment_id": 90754406, "body": "@SudhakarMNSR: such a file with a single byte <code>a</code> looks like a malformed text file because it does not have a newline sequence. Its contents is textual but it could also be a binary file with the number 97 encoded on a single byte. If the file contained 2 bytes <code>0x61 0x0a</code> or 3 bytes <code>0x61 0x0d 0x0a</code>, the textual nature of the file would be reinforced."}, {"owner": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "edited": false, "score": 0, "creation_date": 1534658978, "post_id": 51755667, "comment_id": 90779880, "body": "@chqrlie &quot;Its contents is textual but it could also be a binary file&quot; please clarify whether you are disagreeing with my statement &quot;all files are binary files&quot;. If you disagree can you give me an example to say when/which file is not binary (Fixed encoding, locale, machine, OS, etc)"}, {"owner": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "edited": false, "score": 0, "creation_date": 1534659307, "post_id": 51755667, "comment_id": 90779953, "body": "@chqrlie if you say character &#39;a&#39; followed by newline is text file (as of today). But what if someone develop new editor where charater &#39;a&#39; is some formatting command and in this editor &quot;a\\n&quot; displays something else.. so now is &quot;a/n&quot; still text file?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "edited": false, "score": 0, "creation_date": 1534669345, "post_id": 51755667, "comment_id": 90782050, "body": "@SudhakarMNSR: I did not say it <i>was</i> a text file, I wrote its contents is textual, which is a fact. Yet this contents may very well be interpreted in a different way by the program that reads it and altering it as text may have adverse effects."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1534001800, "last_edit_date": 1534001800, "creation_date": 1533762466, "answer_id": 51755667, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51755667#51755667", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>On modern operating systems, there is no distinction at the file system level between text files and binary files. On legacy systems, the C library implements a series of tricks to translate newlines between OS specific representations (such as <code>0x0D</code> <code>0x0A</code>) and the single byte representation '<code>\\n'</code> for the C program reading the file in <em>text mode</em>. This compatibility layer must not be used when dealing with actual binary contents, for which the <code>b</code> option must be used in <code>fopen()</code>.</p>\n\n<p>Older operating systems used to have different representations for text and binary files, but most of these are obsolete nowadays.</p>\n\n<p>Conversely, many file systems keep track of executable files with some specific information such as mode bits on Unix FS. These executable files can be binary, containing one form or another of executable code, while others are text files containing scripts.</p>\n\n<p>In your example, whether the file should be seen as <em>binary</em> or <em>text</em> is a matter of intent. If the <em>creator</em> of the file intended for is to be read as binary, naming it <code>binary.txt</code> is confusing as the filename extension <code>.txt</code> is routinely used to indicate generic text files. <code>sample.bin</code> would be much more obvious.</p>\n\n<p>How to interpret the contents of a file is important for programmers and casual users: on legacy systems, loading and save a file as text may change its contents, unless you use tools that are terminally anal about preserving contents.</p>\n\n<p>For example <strong>qemacs</strong>, a programmer's editor inspired by emacs, makes extensive efforts upon loading a file to determine the best mode for displaying and editing the contents:</p>\n\n<ul>\n<li>binary vs: text mode (defaulting to hex display for binary)</li>\n<li>line termination convention</li>\n<li>character encoding</li>\n<li>programming language or other specific content sensitive display options...</li>\n</ul>\n\n<p>If the file is written back without modifications, the contents are preserved so binary files that happen to have textual contents are unmodified. Otherwise, the above tests determine the correct conventions for encoding new contents.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1533808649, "post_id": 51756128, "comment_id": 90486703, "body": "I&#39;m afraid your answer is incorrect and does not address the OP&#39;s question. The combined range of signed and unsigned byte values is adding the the confusion on a subject that is already too subtle: <code>char</code> can be signed or unsigned by default. Text files need not be ASCII files, and they usually contain non printable bytes: LF (and CR). By your definition &quot;Hello world\\n&quot; is not a string. Various encodings use byte values with a much wider range than ASCII, yet text encoded in these still constitute text files."}, {"owner": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1533809126, "post_id": 51756128, "comment_id": 90487015, "body": "For simplicity I made a note above that Iam not considering multi-byte charsets and limiting to ASCII text files. If I bring them in the definition is really complicated. I agree that the ranges I mentioned are not accurate and I will correct them."}, {"owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1533882670, "post_id": 51756128, "comment_id": 90518176, "body": "The above answered my question and to be frank this is exactly what iam looking for. The range of numbers in each set as @chqrlie pointed out may not be accurate, however files are categorized by value in each byte not how interpreters understand the text in your file, is the message i liked."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1533904645, "post_id": 51756128, "comment_id": 90530464, "body": "<i>&quot;If in a file all bytes are in the range of &lt;something&gt; it should be called a text file&quot;</i> This is VERY wrong."}, {"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 1, "creation_date": 1533928152, "post_id": 51756128, "comment_id": 90542924, "body": "Apparently you have never used UTF-8, or windows-1252 or iso-8859-1 (etc) encoded text files, your explanation makes no sense."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533928431, "post_id": 51756128, "comment_id": 90543026, "body": "For what it&#39;s worth, the range of values of <code>signed char</code> is [-128, +127], not [-127, +127]."}, {"owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1533967708, "post_id": 51756128, "comment_id": 90550929, "body": "@klutt &quot;If in a file all bytes are in the range of &lt;something&gt; it should be called a text file&quot; is the ONLY definition for <b>Text</b> file. Anything else is wrong."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "reply_to_user": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "edited": false, "score": 0, "creation_date": 1533976624, "post_id": 51756128, "comment_id": 90552807, "body": "@Prathibha So if I make a text file containing <i>all</i> the characters in a certain character set, encoded with a certain character encoding, it is not a text file? (I think your points address guessing if a file is a text file or guessing the encoding of a text file. In other words, coping with inadequate data management practices that have lost metadata. If that is part of your question, please <a href=\"https://stackoverflow.com/posts/51756128/edit\">edit</a> it.)"}, {"owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "reply_to_user": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1533993793, "post_id": 51756128, "comment_id": 90556559, "body": "@Tom Exactly thats the point, If Encoding is different then the range is different(map the code units with ASCII text range and form set X). But the fundemental point is same if all bytes fall in this set X then it is <b>text</b> file. If you see the NOTE above, it is clearly mentioned that he is restricting to ascii only. To explain this basic point we need not consider multi-byte character sets, other encodings. To complicate further if you see ASCII text file with different encoding it may be binary."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "reply_to_user": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "edited": false, "score": 1, "creation_date": 1534000476, "post_id": 51756128, "comment_id": 90558424, "body": "@Prathibha No, not all character encodings emit/allow arbitrary sequences of the byte values they use so a range test is inadequate for validity. And, no, just because a file is can be successfully decoded as a text file with a particular character encoding doesn&#39;t make it a text file. In fact, every file can be successfully decoded as a text file with many character encodings. (There are probably ASCII files somewhere in my system but I would be hard-pressed to identify one. Text files are rarely designed, written and read as ASCII. MSDOS didn&#39;t have an ASCII code page. Windows got one late.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1534004320, "post_id": 51756128, "comment_id": 90559462, "body": "By this answer, the string <code>&quot;\\001\\002\\003\\004\\005&quot;</code> is ASCII text, and a file containing those bytes would be a text file.  Most people would say otherwise, however."}], "tags": [], "owner": {"reputation": 408, "user_id": 8769067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2m8iD.jpg?s=128&g=1", "display_name": "Sudhakar MNSR", "link": "https://stackoverflow.com/users/8769067/sudhakar-mnsr"}, "is_accepted": true, "score": -6, "last_activity_date": 1534075132, "last_edit_date": 1534075132, "creation_date": 1533764962, "answer_id": 51756128, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51756128#51756128", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p><strong>NOTE:</strong> Limiting our discussion to ASCII (multi-byte charsets, other Encodings are set aside to avoid unnecessary confusion)</p>\n\n<hr>\n\n<p>Let us understand the difference between string and array of characters</p>\n\n<p>In a byte of <code>8 bits</code>, we can store <code>0 to 255</code> if <em>unsigned</em>, <code>-128 to +127</code> if <em>signed</em></p>\n\n<p>As a whole, if we see a byte (<code>8 bits</code>) the value that can be fit into it is <code>-128 to 255</code> (range). The range of ASCII characters (<code>0 to 127</code>).</p>\n\n<p>Given character array <code>a[10]</code> if any of the bytes <code>a[0] to a[9]</code> has value out of the range of ASCII character range then it is not a <strong>string</strong>, its just array of characters. If all of the bytes fall within the ASCII range (<code>0 to 127</code>) then it is <strong>string</strong>.</p>\n\n<p>In summary for the array of characters, the range can be any of (<code>-128 to 255</code>).</p>\n\n<p>Important conclusion here is since ASCII range (<code>0 to 127</code>) is a proper subset of <code>-128 to 255</code> All <strong>strings</strong> can be called the array of characters.</p>\n\n<p>Now let us apply the above definition to <strong><em>binary</strong> file vs <strong>text</strong> file</em>.</p>\n\n<p>If in a file all bytes are in the range of ASCII (<code>0 to 127</code>) it should be called a <strong>text</strong> file.</p>\n\n<p>If any of them falls out of this range i.e any of <code>(-128 to -1</code>) or (<code>128 to 255</code>) then it is a <strong>binary</strong> file.</p>\n\n<p>In summary, since ASCII range <code>0 to 127</code> is a proper subset of (<code>-128 to 255</code>) <strong>all text files are binary files</strong>.</p>\n\n<p>If a file has atleast one byte from (<code>-128 to -1</code>) or (<code>128 to 255</code>) <strong>it cannot be text file only binary file</strong>.</p>\n\n<p>I have not verified standards if any of ASCII range character(s) has special treatment. But in summary I think I made the distinction behind <strong>text file</strong> vs <strong>binary file</strong> clear.</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "is_accepted": false, "score": 3, "last_activity_date": 1534082798, "last_edit_date": 1534082798, "creation_date": 1533772122, "answer_id": 51757100, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51757100#51757100", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>This question has changed substantially since it was first posed. In particular, the term \"executable\" has been removed from the discussion.</p>\n\n<p>Current question:</p>\n\n<blockquote>\n  <p>Only creator knows that it is created in binary mode and this should be called binary file.</p>\n</blockquote>\n\n<p>The creator has not only created the file but also made it available. If the purpose and format was not communicated then that is a failure somewhere.</p>\n\n<blockquote>\n  <p>Anyone who opens the file \"binary.txt\" think it's text file.</p>\n</blockquote>\n\n<p>People would probably <em>think</em> so, but they still can't properly process it as a text file without knowing the character encoding. Again, a communications failure. A guessed-at character encoding that works today might not work for the contents of the file tomorrow.</p>\n\n<hr>\n\n<p>Answer to original question:</p>\n\n<p>Yes, it's all a matter of interpretation. Interpretation requires context and metadata. </p>\n\n<p>In addition to what others have said,</p>\n\n<ul>\n<li><p>A file cannot be <strong>text</strong> unless you know which character encoding was used to write it (and must be used to read it). Common file systems do not store this knowledge. People dealing in text files must pass this essential metadata on to programs and other people.</p></li>\n<li><p>A file cannot be <strong>executable</strong> unless you know which interpreter program or program loader to load it with. Systems have schemes for this:</p>\n\n<ul>\n<li>Unix-like: Set the eXecutable flag on the file in the file system. Then if it is a \"script\" and an interpreter program is required for it, the script can have a shebang <code>#!</code> line stating the program to run it in.</li>\n<li>Windows: Use a particular file extension listed in the PATHEXT environment variable. Example: <code>PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC</code> The extension would be registered with an Open verb indicating how to \"open\" or start it.</li>\n<li>Finally, the program could have a \"file signature\" that indicates which program loader to run it with.</li>\n</ul></li>\n<li><p>A file can be called <strong>binary</strong> whether or not you have metadata to call it text or executable or both.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "is_accepted": false, "score": 1, "last_activity_date": 1534429174, "last_edit_date": 1534429174, "creation_date": 1534370050, "answer_id": 51866979, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files/51866979#51866979", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>I think you are asking two different questions.</p>\n\n<p><strong>File contents</strong></p>\n\n<p>If the file contains textual data, i.e., lines of characters delimited by newlines, then it is a <em>text</em> file.</p>\n\n<p>Otherwise it is presumed to contain data in some form other than strictly character data, such as binary integers, floating-point numbers, image pixels, music samples, structured binary data, etc., which means that it is a <em>binary</em> file, i.e., a <em>non-text</em> file.</p>\n\n<p>There are many other text file formats, such as <code>.xml</code>, <code>.html</code>, <code>.csv</code>, as well as programming language source code files. These are strictly character text files, but generally have some kind of internal structure based on the syntax of their contents.</p>\n\n<p>That being said, all text files are inherently binary files, in the sense that the characters, newlines, and so forth comprising the textual data in the file are nothing more that a stream of bytes at the lowest level.</p>\n\n<p><strong>File name</strong></p>\n\n<p>Specifically, the filename <em>extension</em> or <em>suffix</em>. By convention, files with a <code>.txt</code> extension are presumed to contain text data, i.e., lines of character data delimited by some kind of newline sequences.</p>\n\n<p>A different filename extension like <code>.bin</code> or <code>.exe</code> (or a hundred others) indicate some kind of binary data file, usually structured in some way. By convention, <code>.bin</code> indicates binary data with no specific format, i.e., just a stream of bytes.</p>\n\n<p>In addition, there are files having an extension like <code>.doc</code> or <code>.pdf</code> (or dozens of others), indicating a <em>word processing document</em> file. These files also contain character text data, but it is typically stored in some kind of strictly binary format that is specific to the word processing software used to create it.</p>\n"}], "owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2593, "favorite_count": 4, "accepted_answer_id": 51756128, "answer_count": 7, "score": 4, "last_activity_date": 1534429174, "creation_date": 1533759225, "last_edit_date": 1533894663, "question_id": 51754913, "link": "https://stackoverflow.com/questions/51754913/why-binary-file-is-not-a-text-file-and-all-text-files-are-binary-files", "title": "Why Binary file is not a Text file and all Text files are Binary files?", "body": "<p>What is the deciding factor for classifying a file into Binary or Text file?</p>\n\n<p>E.g: \nConsider the below C program </p>\n\n<ol>\n<li>Create file in <strong>binary</strong> mode</li>\n<li>Write two integers into file \"binary.txt\".</li>\n</ol>\n\n<p>NOTE: Before running the program make sure binary.txt doesnt exist.</p>\n\n<p>Observation:</p>\n\n<p>File created \"binary.txt\" with contents TEXTFILE</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   int arr[2] = {1415071060,1162627398};\n   FILE *fp = fopen(\"binary.txt\", \"wb\");\n\n   if(fp == NULL)\n   {\n       printf(\"Error opening file\\n\");\n       exit(1);\n   }\n   fwrite(arr, sizeof(arr), 1, fp);\n   fclose(fp);\n   return 0;\n}\n</code></pre>\n\n<p>However only creator knows that it is created in binary mode and this should be called binary file.</p>\n\n<p>Anyone who opens the file \"binary.txt\" think its <strong>text</strong> file.</p>\n\n<p>What a general user should call this file - <strong>Binary</strong> or <strong>Text</strong> file?</p>\n"}, {"tags": ["sql", "c", "linux", "malloc", "freetds"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533757724, "post_id": 51754139, "comment_id": 90468736, "body": "char *alokasi=&quot;&quot;; should be    char *alokasi=NULL; and ch = &quot;&quot;; should be ch = &#39; &#39;;"}, {"owner": {"reputation": 1, "user_id": 10091559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fj_XQIdlOrM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pJE8sHTxMyedbcW5JNL6jga3Apkw/mo/photo.jpg?sz=128", "display_name": "Dwicahyo Yulianto", "link": "https://stackoverflow.com/users/10091559/dwicahyo-yulianto"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533783387, "post_id": 51754139, "comment_id": 90475709, "body": "dear, error still happen when i input 50-60 times."}], "owner": {"reputation": 1, "user_id": 10091559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fj_XQIdlOrM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pJE8sHTxMyedbcW5JNL6jga3Apkw/mo/photo.jpg?sz=128", "display_name": "Dwicahyo Yulianto", "link": "https://stackoverflow.com/users/10091559/dwicahyo-yulianto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533755904, "creation_date": 1533755904, "question_id": 51754139, "link": "https://stackoverflow.com/questions/51754139/error-in-text-buffer-corrupted-double-linked-list-0x089cbd98", "title": "*** Error in `./text_buffer&#39;: corrupted double-linked list: 0x089cbd98 **", "body": "<p>I'm trying to make the app using FreeTDS. Following are my code</p>\n\n<pre><code>/* \n * Purpose: Test to see if row buffering and blobs works correctly.\n * Functions: dbbind dbnextrow dbopen dbresults dbsqlexec dbgetrow\n */\n\n#include \"common.h\"\n#include \"stdio.h\"\n#include&lt;stdlib.h&gt;\n#include \"readline/readline.h\"\n#include \"readline/history.h\"\n#include \"string.h\"\n\nint\nmain(int argc, char **argv)\n{\n\n  char failed;\n  int hasil;\n  char ch;\n\n  char* r = malloc(30);\n\n\n  LOGINREC *login;\n  DBPROCESS *dbproc;\n  int i;\n  int p = 0;\n  char teststr[1024];\n  DBINT testint;\n    read_login_info(argc, argv);\n    fprintf(stdout, \"Starting %s\\n\", argv[0]);\n\n\n/* Fortify_EnterScope(); */\n\n      while(1)\n      {\n    char qrcode[50];\n    char perintahsql[100] = \"select * from REF_COBA where id=\";\n    char *alokasi=\"\";\n\n    while(ch != '\\n')    // terminates if user hit enter\n    {\n      ch = getchar();\n      qrcode[p] = ch;\n      p++;\n}\nqrcode[p]='\\0';\nstrcpy(r,qrcode);\n\nalokasi = strsep(&amp;r, \",\");\nstrcpy(r,\"\");\np=0;\nch = \"\";\ndbinit();\ndberrhandle(syb_err_handler);\ndbmsghandle(syb_msg_handler);\nfprintf(stdout, \"About to logon\\n\");\nlogin = dblogin();\nDBSETLPWD(login, PASSWORD);\nDBSETLUSER(login, USER);\nDBSETLAPP(login, \"text_buffer\");\n//DBSETLHOST(login, \"ntbox.dntis.ro\");\nDBSETLHOST(login, \"192.168.1.9\");\n\nfprintf(stdout, \"About to open\\n\");\ndbproc = dbopen(login, SERVER);\nif (strlen(DATABASE))\n  dbuse(dbproc, DATABASE);\ndbloginfree(login);\n\n#ifdef MICROSOFT_DBLIB\n  dbsetopt(dbproc, DBBUFFER, \"100\");\n#else\n  dbsetopt(dbproc, DBBUFFER, \"100\", 0);\n#endif\n\ndbcmd(dbproc, strcat(perintahsql,alokasi));\ndbsqlexec(dbproc);\n\nif (dbresults(dbproc) != SUCCEED)\n{\n  failed = 1;\n  fprintf(stdout, \"Was expecting a result set.\");\n  exit(1);\n}\nfprintf(stdout, \"select\\n\");\nfor (i = 1; i &lt;= dbnumcols(dbproc); i++)\n  printf(\"col %d is %s\\n\", i, dbcolname(dbproc, i));\nfprintf(stdout, \"setelah for\\n\");\ndbbind(dbproc, 1, INTBIND, 0, (BYTE *) &amp; testint);\ndbbind(dbproc, 2, CHARBIND, 0, (BYTE *) teststr);\n\nfor (i = 1; i &lt; 2; i++)\n{\n  char expected[1024];\n  sprintf(expected, \"row %03d\", i);\n  if (i % 100 == 0) \n  {\ndbclrbuf(dbproc, 100);\n  }\n  if (REG_ROW != dbnextrow(dbproc))\n  {\nfailed = 1;\nfprintf(stderr, \"Failed.  Expected a row\\n\");\n//exit(1);\n  }\n  else\n  {\nfprintf(stdout, \"jalanin usb\\n\");\nprintf(\"Read a row of data -&gt; %d %s\\n\", (int) testint, teststr);\nhasil = system(\"/opt/usb1rc_linux USB1REL-172 R\");\nsleep(2);\nhasil = system(\"/opt/usb1rc_linux USB1REL-172 r\");\n  }\n\n}\ndbfreebuf(dbproc);\ndbexit();\n\n  }\n  return 0;\n }\n</code></pre>\n\n<p>I modified the source from FreeTDS, after compilation there are some warning</p>\n\n<p><code>bash-4.2# make text_buffer \nCC       text_buffer.o\ntext_buffer.c: In function 'main':\ntext_buffer.c:54:8: warning: assignment makes integer from pointer without a cast [enabled by default]\n     ch = \"\";\n        ^\ntext_buffer.c:18:7: warning: variable 'hasil' set but not used [-Wunused-but-set-variable]\n   int hasil;\n       ^\ntext_buffer.c:17:8: warning: variable 'failed' set but not used [-Wunused-but-set-variable]\n   char failed;\n        ^\n  CC       common.o\n  CCLD     text_buffer\n</code></p>\n\n<p>I execute the program without error. This program will check input from user then run the sql command. The format of input shall be , e.g 123456,john doe then press enter. After 50-60 times of input, the double-linked list error will happen.\ncould anybody help why the error happen?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1533754286, "post_id": 51753563, "comment_id": 90467282, "body": "Unless you use <code>fflush()</code>, what you describe is basically correct.  One other case where the data is printed is when the buffer fills.  You can find the default buffer size from <code>BUFSIZ</code> in <code>&lt;stdio.h&gt;</code>.  It is the standard I/O code that decides when to call on the kernel to write the data in the buffer, but it is then the kernel (in conjunction with the window management system) that ensures the data is written to the right places."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1533754829, "post_id": 51753563, "comment_id": 90467509, "body": "Minor quibble: any input function (e.g. getchar, scanf, fgets) will flush the buffer."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1533754491, "post_id": 51753810, "comment_id": 90467373, "body": "How does this answer the question? It was about <i>when</i> output is sent to the device."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533754772, "post_id": 51753810, "comment_id": 90467486, "body": "@WeatherVane Quoted from the wrong post. Fixed."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533755017, "post_id": 51753810, "comment_id": 90467601, "body": "Please quote from the C standard, not another post. C does not mention &quot;screen&quot; or say what an OS is supposed to do."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1533755085, "post_id": 51753810, "comment_id": 90467632, "body": "Note <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.3p7\" rel=\"nofollow noreferrer\">C11 &#167;7.21.3 Files &#182;7</a> says: <i>At program startup, three text streams are predefined and need not be opened explicitly -- standard input (for reading conventional input), standard output (for writing conventional output), and standard error (for writing diagnostic output). As initially opened, the standard error stream is not fully buffered; the standard input and standard output streams are fully buffered if and only if the stream can be determined not to refer to an interactive device.</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533755346, "post_id": 51753810, "comment_id": 90467726, "body": "Although many systems do synchronize between standard output and standard input when there&#39;s an input operation, the standard doesn&#39;t actually make that a requirement."}], "tags": [], "owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1533757848, "last_edit_date": 1533757848, "creation_date": 1533754462, "answer_id": 51753810, "question_id": 51753563, "link": "https://stackoverflow.com/questions/51753563/examples-on-why-when-printf-rather-than-printing-to-screen-does-buffering/51753810#51753810", "title": "examples on why/when printf rather than printing to screen does buffering?", "body": "<p>You're correct. The function <code>printf()</code> sends formatted output to stdout.</p>\n\n<pre><code>int printf(const char *format, ...);\n</code></pre>\n\n<p>To quote from <a href=\"https://stackoverflow.com/questions/45385807/what-is-it-with-printf-sending-output-to-buffer\">another post</a>:</p>\n\n<blockquote>\n  <p><code>printf()</code> statements sends output to an intermediate storage called\n  buffer. Every now and then, the material in the buffer is sent to the\n  screen. The standard C rules for when output is sent from the buffer\n  to the screen are clear:</p>\n  \n  <ol>\n  <li>It is sent when the buffer gets full.</li>\n  <li>When a newline character is encountered.</li>\n  <li>When there is impending input.</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1533755048, "last_edit_date": 1592644375, "creation_date": 1533755048, "answer_id": 51753943, "question_id": 51753563, "link": "https://stackoverflow.com/questions/51753563/examples-on-why-when-printf-rather-than-printing-to-screen-does-buffering/51753943#51753943", "title": "examples on why/when printf rather than printing to screen does buffering?", "body": "<blockquote>\n<strong>7.21.3 Files</strong><br>...<br>\n3 When a stream is <em>unbuffered</em>, characters are intended to appear from the source or at the\ndestination as soon as possible. Otherwise characters may be accumulated and\ntransmitted to or from the host environment as a block. When a stream is <em>fully buffered</em>,\ncharacters are intended to be transmitted to or from the host environment as a block when\na buffer is filled. <strong>When a stream is <em>line buffered</em>, characters are intended to be\ntransmitted to or from the host environment as a block when a new-line character is\nencountered.</strong> Furthermore, characters are intended to be transmitted as a block to the host\nenvironment when a buffer is filled, when input is requested on an unbuffered stream, or\nwhen input is requested on a line buffered stream that requires the transmission of\ncharacters from the host environment. Support for these characteristics is\nimplementation-defined, and may be affected via the <strong><code>setbuf</code></strong> and <strong><code>setvbuf</code></strong> functions.<br>\n...<br>\n7 At program startup, three text streams are predefined and need not be opened explicitly\n\u2014 <em>standard input</em> (for reading conventional input), <em>standard output</em> (for writing\nconventional output), and <em>standard error</em> (for writing diagnostic output). As initially\nopened, the standard error stream is not fully buffered; the standard input and standard\noutput streams are fully buffered if and only if the stream can be determined not to refer\nto an interactive device.\n</blockquote>\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 online draft</a></em></sup></p>\n<p>On most interactive environments, standard input and standard output are <em>line-buffered</em>.  So yeah, output will be buffered until a newline is seen, or the output operation is immediately followed by an input operation (or <code>fflush</code> call).</p>\n"}], "owner": {"reputation": 69, "user_id": 10199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce36c1fe3b40d1a30f493601d93ee311?s=128&d=identicon&r=PG&f=1", "display_name": "Prathibha", "link": "https://stackoverflow.com/users/10199434/prathibha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1533755133, "answer_count": 2, "score": 0, "last_activity_date": 1533757848, "creation_date": 1533753496, "last_edit_date": 1533756034, "question_id": 51753563, "link": "https://stackoverflow.com/questions/51753563/examples-on-why-when-printf-rather-than-printing-to-screen-does-buffering", "closed_reason": "Duplicate", "title": "examples on why/when printf rather than printing to screen does buffering?", "body": "<p>I have noticed <code>printf</code> only printing to the screen...</p>\n\n<ul>\n<li>when there is newline</li>\n<li>when there is scanf</li>\n</ul>\n\n<p>Help me understand this behavior. I am thinking that <code>printf</code> writes to <code>stdout</code> and the kernel is flushing to screen or display drivers. Is my understanding correct?</p>\n"}, {"tags": ["c", "linux", "windows", "mingw"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1533754333, "post_id": 51753253, "comment_id": 90467302, "body": "When the program doesn&#39;t run because a dll is missing, it should say which one it is. You can then find it (they should come with mingw-w64, at least on windows they do), and distribute with your application."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1533759304, "post_id": 51753253, "comment_id": 90469478, "body": "MinGW does not provide its own C library.  Instead, it adapts Microsoft&#39;s, which is likely to be available on any Windows system.  But it <i>does</i> provide other libraries, and if you use one of these in a dynamically-linked executable then you definitely do need it to be present at runtime.  That doesn&#39;t necessarily need to come from a full MinGW install, but it does need to be there."}], "answers": [{"comments": [{"owner": {"reputation": 1602, "user_id": 6023771, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/67e7bfd227dd05ce79a8e4a4f18f37c2?s=128&d=identicon&r=PG&f=1", "display_name": "zee", "link": "https://stackoverflow.com/users/6023771/zee"}, "edited": false, "score": 0, "creation_date": 1533756536, "post_id": 51753614, "comment_id": 90468211, "body": "I should clarify, because from what I understand your comment says that I can run a program compiled by mingw because mingw is installed on my windows machine. What im telling you is that when a program is compiled with mingw on my windows machine without static linking it can run on any of my other windows machines that DONT have mingw on them, while compiling with mingw on linux requires me to statically link all my libraries to achieve the same effect"}, {"owner": {"reputation": 883, "user_id": 10096436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hKBUJ.png?s=128&g=1", "display_name": "Micromuncher", "link": "https://stackoverflow.com/users/10096436/micromuncher"}, "reply_to_user": {"reputation": 1602, "user_id": 6023771, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/67e7bfd227dd05ce79a8e4a4f18f37c2?s=128&d=identicon&r=PG&f=1", "display_name": "zee", "link": "https://stackoverflow.com/users/6023771/zee"}, "edited": false, "score": 1, "creation_date": 1533762276, "post_id": 51753614, "comment_id": 90470888, "body": "Ah, so John answered that in a comment.  For linux, you need to go through a similar process.  Check out <a href=\"http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\" rel=\"nofollow noreferrer\">tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html</a> and use ldd as mentioned here <a href=\"https://stackoverflow.com/questions/50159/how-to-show-all-shared-libraries-used-by-executables-in-linux\" title=\"how to show all shared libraries used by executables in linux\">stackoverflow.com/questions/50159/&hellip;</a>"}], "tags": [], "owner": {"reputation": 883, "user_id": 10096436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hKBUJ.png?s=128&g=1", "display_name": "Micromuncher", "link": "https://stackoverflow.com/users/10096436/micromuncher"}, "is_accepted": false, "score": 1, "last_activity_date": 1533754070, "last_edit_date": 1533754070, "creation_date": 1533753680, "answer_id": 51753614, "question_id": 51753253, "link": "https://stackoverflow.com/questions/51753253/why-does-mingw-on-windows-not-need-to-link-statically/51753614#51753614", "title": "Why does MinGW on Windows not need to link statically?", "body": "<p>Linux and Windows shared libraries / dynamically linked libraries are similar in how they get discovered. Your mingw program works in windows that has mingw installed because the installation likely added DLLs to your search path.  Check out <a href=\"https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-search-order\" rel=\"nofollow noreferrer\">this article</a> on DLL search order.</p>\n\n<p>When you statically link, all that library code gets included in your executable.</p>\n\n<p>If you want to share your mingw program with friends, then you need to also install all the shared libraries it uses in their search path.  You can use <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/listdlls\" rel=\"nofollow noreferrer\">sysinternals listdlls</a> (or other tools) to find your dependencies, and include them in the same directory as your exe or install them to a library path (see the search order article).</p>\n\n<p>You can also check out this article; <a href=\"https://stackoverflow.com/questions/475148/how-do-i-find-out-which-dlls-an-executable-will-load\">How do I find out which dlls an executable will load?</a> as it has lots of other options.</p>\n"}], "owner": {"reputation": 1602, "user_id": 6023771, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/67e7bfd227dd05ce79a8e4a4f18f37c2?s=128&d=identicon&r=PG&f=1", "display_name": "zee", "link": "https://stackoverflow.com/users/6023771/zee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533806844, "creation_date": 1533752264, "last_edit_date": 1533806844, "question_id": 51753253, "link": "https://stackoverflow.com/questions/51753253/why-does-mingw-on-windows-not-need-to-link-statically", "title": "Why does MinGW on Windows not need to link statically?", "body": "<p>I've installed MinGW on my Linux machine and installed the MinGW package, however, I noticed that I can't run my program on Windows machines that don't have MinGW, I looked it up and soon found that the solution to this is to link statically. This worked, but it's still annoying to have to statically link everything and doesn't make much sense. I noticed that on my Windows machine where MinGW was installed I could compile a program without statically linking anything and the program would run successfully on any Windows machine regardless of whether it had MinGW installed or not.</p>\n\n<p>My Linux box is running <em>Arch Linux</em> and Installed the <code>mingw-w64-gcc AUR</code> packages if that info helps at all.</p>\n"}, {"tags": ["c", "crc"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1533751052, "post_id": 51752284, "comment_id": 90465612, "body": "<a href=\"https://barrgroup.com/Embedded-Systems/How-To/CRC-Calculation-C-Code\" rel=\"nofollow noreferrer\">barrgroup.com/Embedded-Systems/How-To/CRC-Calculation-C-Code</a> - note that you don&#39;t need to have an <i>array of bits</i>, you can use a single <code>uint8_t</code> for the state"}, {"owner": {"reputation": 175, "user_id": 10199095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qe0oWx_goc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRlRLI4IzhqUqKgmwZIivi1T8FIQ/mo/photo.jpg?sz=128", "display_name": "arnab dasgupta", "link": "https://stackoverflow.com/users/10199095/arnab-dasgupta"}, "edited": false, "score": 0, "creation_date": 1533822391, "post_id": 51752284, "comment_id": 90496105, "body": "I get that, however I want to know how to add the other parameters in the code. such as polynomial, initialization and XOR."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 10199095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qe0oWx_goc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRlRLI4IzhqUqKgmwZIivi1T8FIQ/mo/photo.jpg?sz=128", "display_name": "arnab dasgupta", "link": "https://stackoverflow.com/users/10199095/arnab-dasgupta"}, "edited": false, "score": 0, "creation_date": 1533832743, "post_id": 51769568, "comment_id": 90502891, "body": "thanks a lot, but for 0x00 it should be 0xAC, its reporting 0x81 after the changes, but thanks a lot for the help."}, {"owner": {"reputation": 175, "user_id": 10199095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qe0oWx_goc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRlRLI4IzhqUqKgmwZIivi1T8FIQ/mo/photo.jpg?sz=128", "display_name": "arnab dasgupta", "link": "https://stackoverflow.com/users/10199095/arnab-dasgupta"}, "edited": false, "score": 0, "creation_date": 1533833043, "post_id": 51769568, "comment_id": 90503056, "body": "I think it has gotto do with the polynomial, whiich is x8+x5+x4+1, dont know how to use this.."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 175, "user_id": 10199095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qe0oWx_goc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRlRLI4IzhqUqKgmwZIivi1T8FIQ/mo/photo.jpg?sz=128", "display_name": "arnab dasgupta", "link": "https://stackoverflow.com/users/10199095/arnab-dasgupta"}, "edited": false, "score": 0, "creation_date": 1533880649, "post_id": 51769568, "comment_id": 90517398, "body": "@arnabdasgupta your polynominal is correct. You mistake your input for 8 bit on the website, you have to enter 0000 for the correct calculation. For different length you would have to add a length parameter other wise your input is always 2bytes"}], "tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1533825355, "last_edit_date": 1533825355, "creation_date": 1533824766, "answer_id": 51769568, "question_id": 51752284, "link": "https://stackoverflow.com/questions/51752284/how-to-calculate-crc8-in-c/51769568#51769568", "title": "How to calculate crc8 in C?", "body": "<p>To implement the initial value for the CRC you just have to set <code>crc</code> in the beginning to what you want to have. So either</p>\n\n<pre><code>uint8_t crc[8] = {1,1,1,1, 1,1,1,1};\n</code></pre>\n\n<p>or</p>\n\n<pre><code>memset(crc,1,8);\n</code></pre>\n\n<p>But you have a flaw in your logic and that is the reason why you do not get the right values (even without the init value). It is quite a small error, you read the input in the wrong direction:</p>\n\n<pre><code>inv = ((((input &gt;&gt; i) &amp; 1) ^ crc[7]) &amp; 1);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>inv = ((((input &gt;&gt; 15-i) &amp; 1) ^ crc[7]) &amp; 1);\n</code></pre>\n\n<p>after this your algorithm should work fine and you can set the init value like written above.</p>\n\n<p>If you are looking for an implementation in C there is a big tutorial on the website you linked, also with code. It think it is written in C++ or maybe Java, but there are not many changes necessary to make this valid C code.</p>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 6, "last_activity_date": 1533860393, "last_edit_date": 1533860393, "creation_date": 1533840082, "answer_id": 51773839, "question_id": 51752284, "link": "https://stackoverflow.com/questions/51752284/how-to-calculate-crc8-in-c/51773839#51773839", "title": "How to calculate crc8 in C?", "body": "<p>Assuming your running on a PC or other little endian processor, temp2 is stored in memory as {0xEF, 0xBE}. Unoptimized example code (doesn't use a table). For a faster version, the inner loop using j could be replaced with a 256 byte table lookup: crc = table[crc ^ data[i]];</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef unsigned char uint8_t;\n\nuint8_t gencrc(uint8_t *data, size_t len)\n{\n    uint8_t crc = 0xff;\n    size_t i, j;\n    for (i = 0; i &lt; len; i++) {\n        crc ^= data[i];\n        for (j = 0; j &lt; 8; j++) {\n            if ((crc &amp; 0x80) != 0)\n                crc = (uint8_t)((crc &lt;&lt; 1) ^ 0x31);\n            else\n                crc &lt;&lt;= 1;\n        }\n    }\n    return crc;\n}\n\nint main()\n{\nuint8_t data[8] = {0xBE,0xEF,0,0,0,0,0,0};\nuint8_t crc;\n    crc = gencrc(data, 2);   /* returns 0x92 */\n    printf(\"%1x\\n\", crc);\n    crc = gencrc(data+2, 1); /* returns 0xac */\n    printf(\"%1x\\n\", crc);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": false, "score": 4, "last_activity_date": 1533876251, "last_edit_date": 1533876251, "creation_date": 1533864707, "answer_id": 51777726, "question_id": 51752284, "link": "https://stackoverflow.com/questions/51752284/how-to-calculate-crc8-in-c/51777726#51777726", "title": "How to calculate crc8 in C?", "body": "<p>You call these with <code>mem</code> equal to <code>NULL</code> to get the initial CRC value. Then call with chunks of your data, updating the CRC value by feeding it the previous value.</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n\nunsigned crc8x_simple(unsigned crc, void const *mem, size_t len) {\n    unsigned char const *data = mem;\n    if (data == NULL)\n        return 0xff;\n    while (len--) {\n        crc ^= *data++;\n        for (unsigned k = 0; k &lt; 8; k++)\n            crc = crc &amp; 0x80 ? (crc &lt;&lt; 1) ^ 0x31 : crc &lt;&lt; 1;\n    }\n    crc &amp;= 0xff;\n    return crc;\n}\n\nstatic unsigned char const crc8x_table[] = {\n    0x00, 0x31, 0x62, 0x53, 0xc4, 0xf5, 0xa6, 0x97, 0xb9, 0x88, 0xdb, 0xea, 0x7d,\n    0x4c, 0x1f, 0x2e, 0x43, 0x72, 0x21, 0x10, 0x87, 0xb6, 0xe5, 0xd4, 0xfa, 0xcb,\n    0x98, 0xa9, 0x3e, 0x0f, 0x5c, 0x6d, 0x86, 0xb7, 0xe4, 0xd5, 0x42, 0x73, 0x20,\n    0x11, 0x3f, 0x0e, 0x5d, 0x6c, 0xfb, 0xca, 0x99, 0xa8, 0xc5, 0xf4, 0xa7, 0x96,\n    0x01, 0x30, 0x63, 0x52, 0x7c, 0x4d, 0x1e, 0x2f, 0xb8, 0x89, 0xda, 0xeb, 0x3d,\n    0x0c, 0x5f, 0x6e, 0xf9, 0xc8, 0x9b, 0xaa, 0x84, 0xb5, 0xe6, 0xd7, 0x40, 0x71,\n    0x22, 0x13, 0x7e, 0x4f, 0x1c, 0x2d, 0xba, 0x8b, 0xd8, 0xe9, 0xc7, 0xf6, 0xa5,\n    0x94, 0x03, 0x32, 0x61, 0x50, 0xbb, 0x8a, 0xd9, 0xe8, 0x7f, 0x4e, 0x1d, 0x2c,\n    0x02, 0x33, 0x60, 0x51, 0xc6, 0xf7, 0xa4, 0x95, 0xf8, 0xc9, 0x9a, 0xab, 0x3c,\n    0x0d, 0x5e, 0x6f, 0x41, 0x70, 0x23, 0x12, 0x85, 0xb4, 0xe7, 0xd6, 0x7a, 0x4b,\n    0x18, 0x29, 0xbe, 0x8f, 0xdc, 0xed, 0xc3, 0xf2, 0xa1, 0x90, 0x07, 0x36, 0x65,\n    0x54, 0x39, 0x08, 0x5b, 0x6a, 0xfd, 0xcc, 0x9f, 0xae, 0x80, 0xb1, 0xe2, 0xd3,\n    0x44, 0x75, 0x26, 0x17, 0xfc, 0xcd, 0x9e, 0xaf, 0x38, 0x09, 0x5a, 0x6b, 0x45,\n    0x74, 0x27, 0x16, 0x81, 0xb0, 0xe3, 0xd2, 0xbf, 0x8e, 0xdd, 0xec, 0x7b, 0x4a,\n    0x19, 0x28, 0x06, 0x37, 0x64, 0x55, 0xc2, 0xf3, 0xa0, 0x91, 0x47, 0x76, 0x25,\n    0x14, 0x83, 0xb2, 0xe1, 0xd0, 0xfe, 0xcf, 0x9c, 0xad, 0x3a, 0x0b, 0x58, 0x69,\n    0x04, 0x35, 0x66, 0x57, 0xc0, 0xf1, 0xa2, 0x93, 0xbd, 0x8c, 0xdf, 0xee, 0x79,\n    0x48, 0x1b, 0x2a, 0xc1, 0xf0, 0xa3, 0x92, 0x05, 0x34, 0x67, 0x56, 0x78, 0x49,\n    0x1a, 0x2b, 0xbc, 0x8d, 0xde, 0xef, 0x82, 0xb3, 0xe0, 0xd1, 0x46, 0x77, 0x24,\n    0x15, 0x3b, 0x0a, 0x59, 0x68, 0xff, 0xce, 0x9d, 0xac};\n\nunsigned crc8x_fast(unsigned crc, void const *mem, size_t len) {\n    unsigned char const *data = mem;\n    if (data == NULL)\n        return 0xff;\n    crc &amp;= 0xff;\n    while (len--)\n        crc = crc8x_table[crc ^ *data++];\n    return crc;\n}\n</code></pre>\n\n<p>Either version gives your check values for <code>0x00</code> and <code>0xbe 0xef</code>.</p>\n"}], "owner": {"reputation": 175, "user_id": 10199095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qe0oWx_goc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRlRLI4IzhqUqKgmwZIivi1T8FIQ/mo/photo.jpg?sz=128", "display_name": "arnab dasgupta", "link": "https://stackoverflow.com/users/10199095/arnab-dasgupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25521, "favorite_count": 3, "accepted_answer_id": 51773839, "answer_count": 3, "score": 3, "last_activity_date": 1607248702, "creation_date": 1533748755, "last_edit_date": 1533832598, "question_id": 51752284, "link": "https://stackoverflow.com/questions/51752284/how-to-calculate-crc8-in-c", "title": "How to calculate crc8 in C?", "body": "<p>I have seen multiple implementation of crc8 implementation in C, but I am unable to figure out for polynomial(x8,x5,x4,1) i.e. <code>0x31</code> and initialization <code>0xFF</code>. </p>\n\n<p>Also reflect input = False, reflect output = False and final XOR = <code>0x00</code>. </p>\n\n<p>I tried several of them, and I expect such that <code>CRC(0x00)=0xAC</code> and <code>CRC(0xBEEF)=0x92</code>.</p>\n\n<p>I have seen similar implementations, but nothing really worked out. I saw the exact functionality in here <a href=\"http://www.sunshine2k.de/coding/javascript/crc/crc_js.html\" rel=\"noreferrer\">http://www.sunshine2k.de/coding/javascript/crc/crc_js.html</a> where I could give initialization, reflect input, reflect output, and final XOR. But can somebody point to me implementation in C. I do understand that initially we need to give crc as 0xFF, but nothing worked out for me so far.</p>\n\n<p>Please find the sample code that I tried attached:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint8_t crc8(uint16_t input);\n\nint main()\n{\n    uint8_t temp1;\n    uint16_t temp2 = 0xBEEF;\n\n    printf(\"CRC input is 0x%X\\n\", temp2);\n\n    temp1 = crc8(temp2);\n\n    printf(\"CRC output is 0x%X\\n\", temp1);\n\n    return 0;\n}\n\nuint8_t crc8(uint16_t input)\n{\n    uint8_t crc[8] = { };\n    uint8_t i;\n    uint8_t inv;\n    uint8_t output = 0;\n\n    for(i = 0; i &lt; 16; i++)\n    {\n        inv = ((((input &gt;&gt; i) &amp; 1) ^ crc[7]) &amp; 1);\n\n        crc[7] = (crc[6] &amp; 1);\n        crc[6] = (crc[5] &amp; 1);\n        crc[5] = (crc[4] ^ inv &amp; 1);\n        crc[4] = (crc[3] ^ inv &amp; 1);\n        crc[3] = (crc[2] &amp; 1);\n        crc[2] = (crc[1] &amp; 1);\n        crc[1] = (crc[0] &amp; 1);\n        crc[0] = (inv &amp; 1);\n    }\n\n    for(i = 0; i &lt; 8; i++){\n        output |= ((crc[i] &lt;&lt; i) &amp; (1 &lt;&lt; i));\n    }\n\n\n    return output;\n}\n</code></pre>\n\n<p>I am seeing </p>\n\n<pre><code>CRC input is 0xBEEF\nCRC output is 0x2 //instead of 0x92\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 2, "creation_date": 1533748053, "post_id": 51752017, "comment_id": 90464031, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is array decaying?</a>"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1533748268, "post_id": 51752017, "comment_id": 90464137, "body": "@JGroven Array decaying means that, when an array is passed as a parameter to a function, it&#39;s treated identically to (&quot;decays to&quot;) a pointer. However, there is no any passing case ??"}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1533748798, "post_id": 51752017, "comment_id": 90464407, "body": "@snr I was under the impression that array decaying is the implicit conversion from array to pointer, and that using an array as a parameter is merely a demonstration of decay."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1533748946, "post_id": 51752017, "comment_id": 90464487, "body": "@JGroven ((: just was kidding, Thank you for explanation freshman"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1533749018, "post_id": 51752017, "comment_id": 90464537, "body": "Arrays decay to pointers in nearly every case. The two exceptions are the <code>sizeof</code> and the <code>&amp;</code> operator."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2522986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nz1.jpg?s=128&g=1", "display_name": "metasj", "link": "https://stackoverflow.com/users/2522986/metasj"}, "edited": false, "score": 0, "creation_date": 1533748304, "post_id": 51752122, "comment_id": 90464155, "body": "if I have an array int a[5], a is an integer pointer containing &amp;a[0],but what is the address of a?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 55, "user_id": 2522986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nz1.jpg?s=128&g=1", "display_name": "metasj", "link": "https://stackoverflow.com/users/2522986/metasj"}, "edited": false, "score": 0, "creation_date": 1533748513, "post_id": 51752122, "comment_id": 90464251, "body": "@metasj <code>&amp;a</code> and <code>&amp;a[0]</code> have a different type. <code>a</code> is of type <code>int[5]</code>. <code>&amp;a[0]</code> is of type <code>int *</code>. <code>&amp;a</code> is of type <code>int (*)[10]</code>. Arrays are not pointers."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 55, "user_id": 2522986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nz1.jpg?s=128&g=1", "display_name": "metasj", "link": "https://stackoverflow.com/users/2522986/metasj"}, "edited": false, "score": 0, "creation_date": 1533749777, "post_id": 51752122, "comment_id": 90464969, "body": "@metasj <code>a</code> is not an integer pointer but it will evaluate as an integer pointer in most kinds of expressions."}], "tags": [], "owner": {"reputation": 47447, "user_id": 1172428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/240fe123035f1c6e184f59da2f1465d9?s=128&d=identicon&r=PG", "display_name": "FatalError", "link": "https://stackoverflow.com/users/1172428/fatalerror"}, "is_accepted": false, "score": 1, "last_activity_date": 1533804191, "last_edit_date": 1533804191, "creation_date": 1533748073, "answer_id": 51752122, "question_id": 51752017, "link": "https://stackoverflow.com/questions/51752017/pointer-to-an-integer-array/51752122#51752122", "title": "Pointer to an integer array", "body": "<p>Quite simply, the address of an array is the same as its first element's. In this context, <code>*mat</code> is of type <code>int[5]</code> which decays to <code>int *</code>, i.e. a pointer to the first element of the array.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 2, "last_activity_date": 1533755913, "creation_date": 1533755913, "answer_id": 51754141, "question_id": 51752017, "link": "https://stackoverflow.com/questions/51752017/pointer-to-an-integer-array/51754141#51754141", "title": "Pointer to an integer array", "body": "<p>A picture may help:</p>\n\n<pre><code>     +---+            +---+\nmat: |   | ------&gt; a: | 5 | a[0]\n     +---+            +---+\n                      | 4 | a[1]\n                      +---+\n                       ...\n                      +---+\n                      | 1 | a[4]\n                      +---+\n</code></pre>\n\n<p>So, first thing we notice - the address of the <em>array</em> <code>a</code> is the same as the address of the <em>array element</em> <code>a[0]</code>.  The <em>expression</em> <code>a</code> has type \"5-element array of <code>int</code>\"; unless that expression is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, it is converted (\"decays\") to an expression of type \"pointer to <code>int</code>\", and the value of the expression is the address of the first element of the array.  Thus, the <em>expressions</em> <code>&amp;a</code>, <code>a</code>, and <code>&amp;a[0]</code> will all yield the same <em>value</em> (address of the first element of <code>a</code>), even though they're not all the same <em>type</em> (<code>int (*)[5]</code>, <code>int *</code>, <code>int *</code>).  </p>\n\n<p>So, given the above, all of the following are true:</p>\n\n<pre><code>  mat == &amp;a \n *mat ==  a\n**mat ==  a[0] \n</code></pre>\n\n<p>Since <code>&amp;a</code> and <code>a</code> evaluate to the same address, <code>mat</code> and <code>*mat</code> evaluate to the same value.  </p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1533779614, "creation_date": 1533779614, "answer_id": 51757799, "question_id": 51752017, "link": "https://stackoverflow.com/questions/51752017/pointer-to-an-integer-array/51757799#51757799", "title": "Pointer to an integer array", "body": "<p><code>mat</code> is a <a href=\"https://cdecl.org/?q=int+%28*mat%29%5B5%5D%3B\" rel=\"nofollow noreferrer\">pointer to array 5 of int</a>.</p>\n\n<p><code>*mat</code> is an <em>array 5 of int</em>.</p>\n\n<p>Arrays such as <code>*mat</code>, when pass to functions are converted in \"... to an expression with type <em>pointer to type</em> that points to the initial element of\nthe array object...\". C11 \u00a76.3.2.1 3</p>\n\n<p><code>*mat</code> in <code>printf(\"%p\\n\",*mat);</code> is a <em>pointer to an <code>int</code></em>.</p>\n\n<hr>\n\n<blockquote>\n  <p>\"Why does <code>mat</code> and <code>*mat</code> give the same answer?\"</p>\n</blockquote>\n\n<p>These both point to the same memory location. <code>mat</code> points to the array.  In <code>printf()</code>, <code>*mat</code> points to the first array element, an <code>int</code>.</p>\n\n<p>As pointers, <code>mat</code> and <code>*mat</code> point to very different types.  They <em>could</em> have employed different presentation (even size) and yielded different <em>text</em> output, yet their <em>values</em> are equivalent.  This difference is uncommon.</p>\n\n<hr>\n\n<p>Further, <code>\"%p\"</code> expects a <code>void*</code>.  Use a <code>void*</code> cast for portable code.</p>\n\n<pre><code>printf(\"%p\\n%p\\n\",mat,*mat);  // undefined behavior\nprintf(\"%p\\n%p\\n\",(void*) mat,(void*) *mat);\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2522986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nz1.jpg?s=128&g=1", "display_name": "metasj", "link": "https://stackoverflow.com/users/2522986/metasj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51754141, "answer_count": 3, "score": 0, "last_activity_date": 1533804191, "creation_date": 1533747713, "last_edit_date": 1533802768, "question_id": 51752017, "link": "https://stackoverflow.com/questions/51752017/pointer-to-an-integer-array", "title": "Pointer to an integer array", "body": "<p>Suppose <code>mat</code> is a pointer to an array of size <code>5</code> where each element is an integer</p>\n\n<pre><code>int (*mat)[5];\n</code></pre>\n\n<p>and I have initialized it as</p>\n\n<pre><code>int a[5] = {5, 4, 3, 2, 1};\nmat = &amp;a;\n</code></pre>\n\n<p>I've written the code as</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int (*mat)[5];\n    int a[5] = {5, 4, 3, 2, 1};\n    mat = &amp;a;\n    printf(\"%p\\n%p\\n%d\\n\", mat, *mat, **mat);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>43800  \n43800  \n5\n</code></pre>\n\n<p>Why does <code>mat</code> and <code>*mat</code> give the same answer?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1533747353, "post_id": 51751878, "comment_id": 90463678, "body": "choice == 0 wrong statement"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1533747653, "post_id": 51751878, "comment_id": 90463843, "body": "&quot;the condition in printf evaluates to false&quot; - which condition?? Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533747712, "post_id": 51751878, "comment_id": 90463881, "body": "You don&#39;t test whether the <code>sscanf()</code> call succeeds; you should.  The <code>break</code> after the <code>return</code> is unreachable code.  The <code>choice == 0;</code> statement achieves nothing; did you mean <code>choice = 0;</code>?"}, {"owner": {"reputation": 95, "user_id": 10199013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GxHYHg02Gw/AAAAAAAAAAI/AAAAAAAAAOU/NEpuZ5YTywM/photo.jpg?sz=128", "display_name": "dylif", "link": "https://stackoverflow.com/users/10199013/dylif"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533747986, "post_id": 51751878, "comment_id": 90463992, "body": "@kiranBiradar that was it. I feel so stupid, sorry for wasting your time."}, {"owner": {"reputation": 95, "user_id": 10199013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GxHYHg02Gw/AAAAAAAAAAI/AAAAAAAAAOU/NEpuZ5YTywM/photo.jpg?sz=128", "display_name": "dylif", "link": "https://stackoverflow.com/users/10199013/dylif"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533748047, "post_id": 51751878, "comment_id": 90464027, "body": "@JonathanLeffler I will make sure to test for the success of sscanf and remove that break.  thank you for also pointing out my stupid mistake."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533753959, "post_id": 51751878, "comment_id": 90467147, "body": "I should have also pointed out that you should (a) check the result of <code>getline()</code> too; it returns <code>-1</code> rather than <code>EOF</code> when it encounters EOF (though on most systems, <code>EOF</code> maps to <code>-1</code>, that isn&#39;t formally guaranteed), and (b) given that you are using <code>getline()</code>, you should free <code>input</code> sometime when you&#39;ve finished the loop \u2014 before returning from the function.  I&#39;m just nitpicking (but constructively nitpicking, I trust)."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 10199013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GxHYHg02Gw/AAAAAAAAAAI/AAAAAAAAAOU/NEpuZ5YTywM/photo.jpg?sz=128", "display_name": "dylif", "link": "https://stackoverflow.com/users/10199013/dylif"}, "is_accepted": true, "score": 0, "last_activity_date": 1533754028, "last_edit_date": 1533754028, "creation_date": 1533748117, "answer_id": 51752133, "question_id": 51751878, "link": "https://stackoverflow.com/questions/51751878/one-condition-of-and-expression-fails-but-code-executes/51752133#51752133", "title": "One condition of and expression fails but code executes", "body": "<p>As kiran Biradar and Jonathan Leffler suggested, the statement <code>choice == 0;</code> was wrong and needed correcting to <code>choice = 0;</code>. The problem is now solved.</p>\n"}], "owner": {"reputation": 95, "user_id": 10199013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GxHYHg02Gw/AAAAAAAAAAI/AAAAAAAAAOU/NEpuZ5YTywM/photo.jpg?sz=128", "display_name": "dylif", "link": "https://stackoverflow.com/users/10199013/dylif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1533748681, "accepted_answer_id": 51752133, "answer_count": 1, "score": 0, "last_activity_date": 1533754028, "creation_date": 1533747203, "question_id": 51751878, "link": "https://stackoverflow.com/questions/51751878/one-condition-of-and-expression-fails-but-code-executes", "closed_reason": "Not suitable for this site", "title": "One condition of and expression fails but code executes", "body": "<p>While writing C code, I have the need to check whether a user's choice in a menu is valid:</p>\n\n<pre><code>while (choice == 0) {\n    // Answer has not been determined\n    printf(\"Please select an option: \");\n    getline(&amp;input, &amp;isize, stdin); \n    sscanf(input, \"%d\", &amp;choice);\n    //printf(\"%d\\t%d\\n\", choice, choice &lt;= len); //debug\n    if (choice &gt; 0 &amp;&amp; choice &lt;= len) {\n        return choice;\n        break;\n    }\n    choice == 0;\n}\n</code></pre>\n\n<p>This appears to me that it should work - the condition in printf evaluates to false - yet an invalid choice still gets returned.  Am I doing something wrong?</p>\n"}, {"tags": ["c", "bit-manipulation", "terminology", "masking", "bitmask"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533744869, "post_id": 51751227, "comment_id": 90462329, "body": "Code like <code>unsigned a; ... a |= 1;</code> is not necessarily conceptually accessing an <i>array</i> of bits.  That code simply insures <code>a</code> is odd."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1533745223, "post_id": 51751227, "comment_id": 90462522, "body": "What do you mean by &quot;accessing an array&quot; of bits? Please give a code example. Currently this question is unclear"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1533745484, "post_id": 51751227, "comment_id": 90462653, "body": "in some situations I think the operands can be considered just series of bits"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1533745509, "post_id": 51751227, "comment_id": 90462664, "body": "There are other ways to view some specific masking operations, such as rounding down to a multiple of a power of two or remainder by a power of two. Of course you can always view it as bit-array manipulation too."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1533791032, "last_edit_date": 1533791032, "creation_date": 1533746794, "answer_id": 51751773, "question_id": 51751227, "link": "https://stackoverflow.com/questions/51751227/is-bit-masking-comparable-to-accessing-an-array-in-bits/51751773#51751773", "title": "Is bit masking comparable to &quot;accessing an array&quot; in bits?", "body": "<blockquote>\n  <p>Is the purpose of updating all the bits you want to keep and all the bits you want to clear to \"access an array\" in bits? </p>\n</blockquote>\n\n<p>I will say the answer is <strong>no</strong>.</p>\n\n<p>When you access an array of <code>int</code> you'll do:</p>\n\n<pre><code>int_array[index] = 42;  // Write access\nint x = int_array[42];  // Read access\n</code></pre>\n\n<p>If you want to write similar functions to read/write a specific bit in e.g. an <code>unsigned int</code> in a \"array like fashion\" it could look like:</p>\n\n<pre><code>unsigned a = 0;\nset_bit(a, 4);   // Set bit number 4\nunsigned x = get_bit(a, 4); // Get bit number 4\n</code></pre>\n\n<p>The implementation of <code>set_bit</code> and <code>get_bit</code> will require (among other things) some bitwise mask operation. </p>\n\n<p>So <strong>yes</strong> - to access bits in an \"array like fashion\" you'll need masking <strong>but...</strong></p>\n\n<p>There are many other uses of bit level masking.</p>\n\n<p>Example:</p>\n\n<pre><code>int buffer[64];\nunsigned index = 0;\n\nvoid add_to_cyclic_buffer(int n)\n{\n    buffer[index] = n;\n    ++index;\n    index &amp;= 0x3f;  // Masking by 0x3f ensures index is always in the range 0..63\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>unsigned a = some_func();\n\na |= 1;  // Make sure a is odd\na &amp;= ~1; // Make sure a is even\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>unsigned a = some_func();\n\na &amp;= ~0xf;  // Make sure a is a multiple of 16\n</code></pre>\n\n<p>This is just a few examples of using \"masking\" that has nothing to do with accessing bits as an array. Many other examples can be made.</p>\n\n<p>So to conclude:</p>\n\n<p>Masking can be used to write functions that access bits in an array like fashion but masking is used for many other things as well.</p>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1533750465, "creation_date": 1533750465, "answer_id": 51752745, "question_id": 51751227, "link": "https://stackoverflow.com/questions/51751227/is-bit-masking-comparable-to-accessing-an-array-in-bits/51752745#51752745", "title": "Is bit masking comparable to &quot;accessing an array&quot; in bits?", "body": "<p>So there are 3 (or 4) main uses.</p>\n\n<p>One, as you say, is where you use the word as a set of true/false flags, where each flag is just indexed in a symmetric manner. I use 'word' here to be the piece of discrete memory that you are accessing in a single operation. So a byte holds 8 bit values, and a 'long long' holds 64 bits. With a bit more effort an array of words can be used as an array of more packed flags.</p>\n\n<p>A second is where you are doing some manipulation of the value, but still consider the word to hold one value. There are many tricks like setting or clearing bottom bits to ensure alignment, or clearing top bits to get a modulus, shifting to divide or multiply by powers of 2.</p>\n\n<p>A third use is where you want to pack lots of smaller-ranged values into a word. Each of the values is a particular meaning in context. This may either be because you need to communicate with a device that has defined this as the protocol, or because you need to create so many objects that the saving in space in each object outweighs the increase in code size and code speed cost (though that might be contrasted with the increased cache misses causing slowdown if the object were bigger). </p>\n\n<p>As a distinction the fourth case is where these fields are distinct 1-bit flags that have specific meanings in the context of the code. Data objects tend to collect a number of such flags, and it is simply more convenient sometimes to store them as bits in a single location, than to use separate bytes for each flag. Generally testing a particular fixed indexed bit, or a fixed masked bit is no more expensive in code size or speed than testing the whole byte, though writing can be more complex. The storage savings are clear, so often programmers will declare an enumeration of bit masks by default when faced with creating a number of flags in a structure, or when writing a function.</p>\n"}], "owner": {"reputation": 45, "user_id": 7120923, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2b63436fa0df6fd191c4f6fb7e453f3?s=128&d=identicon&r=PG&f=1", "display_name": "user7120923", "link": "https://stackoverflow.com/users/7120923/user7120923"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 51751773, "answer_count": 2, "score": -3, "last_activity_date": 1533791032, "creation_date": 1533744602, "question_id": 51751227, "link": "https://stackoverflow.com/questions/51751227/is-bit-masking-comparable-to-accessing-an-array-in-bits", "title": "Is bit masking comparable to &quot;accessing an array&quot; in bits?", "body": "<p>For all the definitions I've seen of bit masking, they all just dive right into how to bit mask, use bitwise, etc. without explaining a use case for any of it. Is the purpose of updating all the bits you want to keep and all the bits you want to clear to \"access an array\" in bits? </p>\n"}, {"tags": ["c", "error-handling", "scanf"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1533743279, "post_id": 51750699, "comment_id": 90461444, "body": "Write your own parser. Read a file char by char, check all conditions, use strtoll to convert string to numbers,"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1533743343, "post_id": 51750699, "comment_id": 90461474, "body": "<code>fscanf(input_file, &quot;%d %d&quot;, &amp;a[i])</code> is undefined behavior - you have two format specifiers but only one argument."}, {"owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533743748, "post_id": 51750699, "comment_id": 90461724, "body": "@AndrewHenle edited, my mistake"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533744071, "post_id": 51750699, "comment_id": 90461885, "body": "Thanks.  I&#39;ll echo @KamilCuk&#39;s comment here: you really can&#39;t use any of the <code>scanf()</code> family for reliably parsing possibly-wrong data.  The f in scan<b>f</b> itself comes from &quot;formatted&quot; - as in &quot;scan formatted data&quot;.  The functions presume input data already matches a very tight format, and they really do fail badly and in potentially unpredictable ways on unexpected data types."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533744091, "post_id": 51750699, "comment_id": 90461899, "body": "&quot;but if there is some chars in my file it will stop the loop.&quot; --&gt; Clearly state what you want code to do when this happens.  Just ignore the characters?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533744267, "post_id": 51750699, "comment_id": 90462003, "body": "What should code do if the integer value read does not fit in an <code>int</code>?  Ignore <i>all</i> those digits?  <code>&quot;123456789012345678901234567890 +123&quot;</code> does what?"}, {"owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533744346, "post_id": 51750699, "comment_id": 90462047, "body": "@AndrewHenle Okay, i&#39;ll do it in another way then. Thanks both of you for the answers."}, {"owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533744468, "post_id": 51750699, "comment_id": 90462109, "body": "@chux I would like to log an error like &quot;wrong input type&quot; but continue the reading"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533754701, "post_id": 51750699, "comment_id": 90467457, "body": "Somebody took already care of it, all I wanted. @chux"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "edited": false, "score": 0, "creation_date": 1533823782, "post_id": 51751818, "comment_id": 90497060, "body": "Im not sure to understand how consuming the erroneous character with <code>scanf(&quot;*c&quot;);</code>. Can you explain a little more ?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "edited": false, "score": 0, "creation_date": 1533831906, "post_id": 51751818, "comment_id": 90502474, "body": "@djadjik: it&#39;s<code>&quot;%*c&quot;</code> (thanks to Jonathan Leffler for the edit). That matches exactly one character (<code>%c</code>) and discards it (<code>*</code>). See <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\"><code>man scanf</code></a>."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1533825107, "last_edit_date": 1533825107, "creation_date": 1533747009, "answer_id": 51751818, "question_id": 51750699, "link": "https://stackoverflow.com/questions/51750699/how-to-check-matching-failures-with-fscanf-in-c/51751818#51751818", "title": "How to check matching failures with fscanf in C", "body": "<p>If scanf cannot convert the input with the format item, it returns without consuming the character which caused the error. The return value is either the number of successful conversions or <code>EOF</code> if end of file (or a read error) was encountered with no successful conversions.</p>\n\n<p>If your format has only one conversion item, there are only three possible return values:</p>\n\n<pre><code>EOF  End of input (or read error)\n0    Invalid character\n1    Succesful conversion\n</code></pre>\n\n<p>In the second case, if you want to continue parsing, you need to consume the erroneous character, which you could do with <code>scanf(\"%*c\");</code>.</p>\n\n<p><code>scanf</code> is not a very precise tool for parsing input. For example, it will not distinguish between</p>\n\n<pre><code>223abc\n</code></pre>\n\n<p>and</p>\n\n<pre><code>223 abc\n</code></pre>\n\n<p>Both will be treated as a succesful <code>%d</code> conversion followed by no success; there is no way of telling whether there was whitespace.</p>\n\n<p>If you're OK with the various limitations, go ahead and use it, but if you want to do real input validation, you will eventually hit a brick wall for which the only solution is \"use a different tool\".</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "edited": false, "score": 0, "creation_date": 1533802539, "post_id": 51751987, "comment_id": 90482883, "body": "I also thought of a structure like yours but we got into an infinite loop when a read error occurs... I&#39;ll try your second option."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1533747589, "creation_date": 1533747589, "answer_id": 51751987, "question_id": 51750699, "link": "https://stackoverflow.com/questions/51750699/how-to-check-matching-failures-with-fscanf-in-c/51751987#51751987", "title": "How to check matching failures with fscanf in C", "body": "<p>If you want to process errors, you can look at a structure like this:</p>\n\n<pre><code>    int i = 0;\n    int rc;\n    while ((rc = fscanf(input_file, \"%d\", &amp;a[i])) != EOF)\n    {\n        if (rc == 1)\n        {\n            \u2026success\u2026\n            i++;\n        }\n        else\n        {\n            \u2026deal with error\u2026\n        }\n    }\n</code></pre>\n\n<p>Normally, I encourage the use of <code>fscanf(\u2026) != 1</code> in the loop condition; it stops the loop if there's a problem.  However, if you want to handle the error and continue the loop, this condition is more suitable.  How you deal with the error is up to you.  You might skip and ignore (or report) the characters up to the next white space, or up to the next newline.  Or you might look for a command or other information in the text that didn't match the number.</p>\n\n<p>One option you should consider is using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> or POSIX \n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> to read a line of data, and then use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a> to parse the line.  There are at least two principle advantages to this approach:</p>\n\n<ul>\n<li>You can report the whole line that's giving the error, not just the wreckage that's left when <code>fscanf()</code> has partially consumed it.</li>\n<li>You can parse the same data multiple different ways, which can be advantageous.</li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 9521480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73dbfe3a4957918f8855de25712c0209?s=128&d=identicon&r=PG&f=1", "display_name": "Djadjik", "link": "https://stackoverflow.com/users/9521480/djadjik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1162, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1533825107, "creation_date": 1533742946, "last_edit_date": 1533743609, "question_id": 51750699, "link": "https://stackoverflow.com/questions/51750699/how-to-check-matching-failures-with-fscanf-in-c", "title": "How to check matching failures with fscanf in C", "body": "<p>I would like to be able to figure out if the file I am reading doesn't contain the wrong type of data without stoping the reading.</p>\n\n<p>For instance : here I want to store some integers from a file, but if there is some chars in my file it will stop the loop. I dont know how I can avoid this and how I can return an error of matching type.</p>\n\n<pre><code>int main (void) {\n    FILE* input_file = fopen(\"toto.txt\", \"r\");\n\n    int a [10];\n\n    if (input_file != NULL) {\n        int i =0;\n        while (fscanf(input_file, \"%d\", &amp;a[i]) == 1) {\n            //do something\n        }\n        fclose(input_file);\n    }\n    else {\n        printf (\"open failed.\");\n        }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "text"], "comments": [{"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1533742603, "post_id": 51750538, "comment_id": 90461016, "body": "Is there a particular reason for such a rapid and lapidary downvote? Any suggestion would be appreciated, in order to produce better questions hopefully more useful for the community."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1533742825, "post_id": 51750538, "comment_id": 90461152, "body": "use &quot;getline&quot; in order to read the file line by line, use strtok in order to get the &quot;word&quot;, then simply print until you reach your threshold. Only downside is that if your line have multiple space, it will merge them into one."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1533743678, "post_id": 51750538, "comment_id": 90461673, "body": "That code does not generate that output from the given input. Please fix the question to show the actual output."}], "answers": [{"comments": [{"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1533742823, "post_id": 51750633, "comment_id": 90461150, "body": "Does not I, when it reach the cutpoint? Or should I reset it in a different moment?"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1533742905, "post_id": 51750633, "comment_id": 90461214, "body": "You need to reset your word_counter to 0 when you encounter a &#39;\\n&#39;. You need to print your word only if &quot;word_counter &lt; 3&quot;"}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1533742968, "post_id": 51750633, "comment_id": 90461258, "body": "Yeah I posted the wrong version of the code, thank you!"}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": true, "score": 1, "last_activity_date": 1533745283, "last_edit_date": 1533745283, "creation_date": 1533742741, "answer_id": 51750633, "question_id": 51750538, "link": "https://stackoverflow.com/questions/51750538/split-long-sentences-reading-from-text-file/51750633#51750633", "title": "Split long sentences reading from text file", "body": "<p>You need to reset <code>word_counter</code> to zero after reading a newline.</p>\n\n<p>Also, you are printing each <code>c</code> twice if <code>word_counter</code> != 3:</p>\n\n<pre><code>printf(\"%c\", c);  // ** here\n\nif(isspace(c))\n        ++word_counter;\n/* Cutter */\nif(word_counter == 3){\n        printf(\"\\n\");\n        word_counter = 0;\n}\nelse\n        printf(\"%c\", c);  // ** and here\n</code></pre>\n\n<p>Maybe try this instead (not tested):</p>\n\n<pre><code>while((c = fgetc(inp)) != EOF){\n\n    if (isspace(c) &amp;&amp; ++word_counter == 3 ) {\n            printf(\"\\n\");\n            word_counter = 0;  /* counter to zero */\n            continue;\n    } \n    if (c == '\\n') {\n        word_counter = 0;\n    }\n    printf(\"%c\", c);\n}\n</code></pre>\n\n<p>Even shorter:</p>\n\n<pre><code>while((c = fgetc(inp)) != EOF){\n\n    if ( (isspace(c) &amp;&amp; ++word_counter == 3) || (c == '\\n') ) {\n            printf(\"\\n\");\n            word_counter = 0;  /* counter to zero */\n            continue;\n    } \n    printf(\"%c\", c);\n}\n</code></pre>\n\n<p>Also keep in mind that <a href=\"http://www.cplusplus.com/reference/cctype/isspace/\" rel=\"nofollow noreferrer\">isspace(c)</a> will return <code>true</code> if <code>c == '\\n'</code>, so a more robuust version which also handles <code>\\r\\n</code> would be:</p>\n\n<pre><code>while((c = fgetc(inp)) != EOF){\n\n    if ( (c == ' ' || c == '\\t') &amp;&amp; (++word_counter == 3) ) {\n        word_counter = 0;\n        printf(\"\\n\");\n        continue;\n    }\n    if ( c == '\\r' || c == '\\n' ) {\n        word_counter = 0;\n    }\n    printf(\"%c\", c);\n}\n</code></pre>\n"}], "owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51750633, "answer_count": 1, "score": -1, "last_activity_date": 1533745283, "creation_date": 1533742409, "last_edit_date": 1533742940, "question_id": 51750538, "link": "https://stackoverflow.com/questions/51750538/split-long-sentences-reading-from-text-file", "title": "Split long sentences reading from text file", "body": "<p>I would like to split long sentences in a text into smaller ones, according to an arbitrary cut point. My approach considers whitespaces to count words. Given the input file <code>input.txt</code> with content:</p>\n\n<pre><code>ciao\nciao ciao\nciao ciao ciao ciao ciao ciao\nciao ciao ciao ciao\nciao ciao ciao\n</code></pre>\n\n<p>I expect: </p>\n\n<pre><code>ciao\nciao ciao\nciao ciao ciao \nciao ciao ciao\nciao ciao ciao \nciao\nciao ciao ciao\n</code></pre>\n\n<p>for cutpoint <code>3</code>.</p>\n\n<p>I approached the problem with the following code:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;ctype.h&gt;                                      \n\n/* MAIN */\n\nint main(int argc, char *argv[]){\n\n        FILE *inp = fopen(argv[1], \"r\");\n        char c;\n        int word_counter = 0;\n\n        while((c = fgetc(inp)) != EOF){\n\n                printf(\"%c\", c);\n\n                if(isspace(c))\n                        ++word_counter;\n                /* Cutter */\n                if(word_counter == 3){\n                        printf(\"\\n\");\n                        word_counter = 0;  /* counter to zero */\n                } \n        }\n\n        return 0;\n}\n</code></pre>\n\n<p>That returns, as output:</p>\n\n<pre><code>ciao\n\nciao  ciao\n\nciao  ciao  ciao\n</code></pre>\n\n<p>I cannot get the reason of such behaviour. Should the code simply print an extra newline when the condition is met? Why is it skipping an entire sentence?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1533742082, "post_id": 51750403, "comment_id": 90460668, "body": "You scan at the beginning of the loop. It won&#39;t exit before it checks the value of gallons at the beginning of the next loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533742153, "post_id": 51750403, "comment_id": 90460708, "body": "It is <i>undefined behaviour</i> since <code>gallons</code> is uninitialiased."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533742169, "post_id": 51750403, "comment_id": 90460720, "body": "If you want to exit your loop after entering a value, maybe you should do that rather than continuing with the rest of the loop body. And pay close attention to what @WeatherVane said. Also, once you fix your problem and leave early consider how to address the potential code path of division-by-zero if the <i>first</i> data entered was <code>-1</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533742328, "post_id": 51750403, "comment_id": 90460840, "body": "Using <code>while(gallons != -1)</code> does not attach some kind of <b>usage monitor</b> to that variable. It is tested there and then, by that code statement, and at no other place. That&#39;s why the next <code>printf</code> statement is executed."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1533746076, "post_id": 51750403, "comment_id": 90462978, "body": "Learn <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1533746344, "post_id": 51750403, "comment_id": 90463110, "body": "It&#39;s not uncommon among beginners to expect a loop to exit as soon as the condition becomes false (and I think it&#39;s a natural expectation), but that &#39;s not how it works \u2013 the condition is only checked at the beginning of each loop iteration."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533748991, "post_id": 51751560, "comment_id": 90464520, "body": "A true average is the sum of the miles divided by the sum of the gallons. Not the sum of the averages divided by the number of trips."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 1, "last_activity_date": 1533745887, "creation_date": 1533745887, "answer_id": 51751560, "question_id": 51750403, "link": "https://stackoverflow.com/questions/51750403/the-program-doesnt-stop-when-i-enter-1-it-goes-to-the-following-printf-w/51751560#51751560", "title": "The program doesn&#39;t stop when I enter &quot;-1&quot;, it goes to the following &quot;printf&quot;. Why?", "body": "<p>Maybe you looking for something like below.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\n    int main()\n    {\n\n        float gallons =0, miles= 0, tot=0, cont=0, average=0, division;\n\n      printf(\"Enter the gallons used (-1 to end): \");\n            scanf(\"%f\", &amp;gallons);\n\n        while(gallons != -1){\n\n            printf(\"Enter the miles driven: \");\n            scanf(\"%f\", &amp;miles);\n            division = miles/gallons;\n            printf(\"The miles / gallon for this tank was %.2f\\n\", division);\n            cont++;\n            tot+=division;\n\n    printf(\"Enter the gallons used (-1 to end): \");\n            scanf(\"%f\", &amp;gallons);\n        }\n\n        average=tot/cont;\n\n        printf(\"The overall average miles / gallons was %.2f\\n\", average);\n\n        return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 10198594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1a32b51f990643596ed6ce670c1895?s=128&d=identicon&r=PG&f=1", "display_name": "user10198594", "link": "https://stackoverflow.com/users/10198594/user10198594"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51751560, "answer_count": 1, "score": -1, "last_activity_date": 1533745887, "creation_date": 1533741994, "last_edit_date": 1533742039, "question_id": 51750403, "link": "https://stackoverflow.com/questions/51750403/the-program-doesnt-stop-when-i-enter-1-it-goes-to-the-following-printf-w", "title": "The program doesn&#39;t stop when I enter &quot;-1&quot;, it goes to the following &quot;printf&quot;. Why?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    float gallons, miles, tot=0, cont=0, average=0, division;\n\n    while(gallons != -1){\n        printf(\"Enter the gallons used (-1 to end): \");\n        scanf(\"%f\", &amp;gallons);\n        printf(\"Enter the miles driven: \");\n        scanf(\"%f\", &amp;miles);\n        division = miles/gallons;\n        printf(\"The miles / gallon for this tank was %.2f\\n\", division);\n        cont++;\n        tot+=division;\n    }\n\n    average=tot/cont;\n\n    printf(\"The overall average miles / gallons was %.2f\\n\", average);\n\n    return 0;\n}\n</code></pre>\n\n<p>The program doesn't stop when I enter \"-1\", it goes to the following \"printf\". Why?</p>\n"}, {"tags": ["c", "linker"], "comments": [{"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533741504, "post_id": 51749969, "comment_id": 90460236, "body": "You want to have both your symbol_foo function and other functions from the libfoo.a librairy ?"}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533741637, "post_id": 51749969, "comment_id": 90460343, "body": "These might help: <a href=\"https://stackoverflow.com/questions/617554/override-a-function-call-in-c\" title=\"override a function call in c\">stackoverflow.com/questions/617554/&hellip;</a>"}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "reply_to_user": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533741727, "post_id": 51749969, "comment_id": 90460404, "body": "@PierrePodevin No I want to override their symbol, making all the referenes in my binary point to MINE"}], "answers": [{"comments": [{"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1533745926, "post_id": 51750635, "comment_id": 90462893, "body": "Yes I actually examined the elf using <code>objdump --assemble-all</code>. I find it weird that relinking should be undoable, as it doesn&#39;t look force-inlined or anything like that. I mean theoretically I could even <code>dd</code>-hotpatch the final binary (padding with NOPs). Feels weird that there should not exist a cleaner way though.."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 5, "last_activity_date": 1533742743, "creation_date": 1533742743, "answer_id": 51750635, "question_id": 51749969, "link": "https://stackoverflow.com/questions/51749969/can-i-replace-a-symbol-in-a-static-library-with-my-own-version/51750635#51750635", "title": "Can I replace a symbol in a static library with my own version?", "body": "<p>It depends on the design of the library.  In your case, the answer is \"No\", because the function isn't isolated in the library.  For a good exposition on library construction, see P J Plauger\n<a href=\"https://smile.amazon.com/dp/0131315099\" rel=\"noreferrer\">The Standard C Library</a> 1992.  Yes, it is fairly old, so the version of Standard C is C90, but the ideas it espouses are still valid.</p>\n\n<p>When the linker is building a program, it is processing a series of object files and libraries, looking for unsatisfied references (symbol names) and tracking definitions.  In most circumstances, it is started with the symbol <code>main</code> as undefined.</p>\n\n<ul>\n<li>As it processes an object file, it notes which symbols are defined that satisfy an undefined symbol and remembers all the names that are defined by that file (and it complains if one of the symbols it finds clashes with one it already knows about).</li>\n<li>As it processes a static library, it looks for symbols that are defined that it does not already have a definition for.  When it finds such a symbol, it links the object file from the library, noting which symbols are defined and which are still undefined.</li>\n</ul>\n\n<p>Now, if the object file containing <code>symbol_foo</code> only defines <code>symbol_foo</code>, then if you've linked your <code>symbol_foo</code> before it reads the library, the linker will ignore the <code>symbol_foo</code> from the library; it already has a definition and doesn't need another.  However, it is probable that the object file containing <code>symbol_foo</code> in the <code>libfoo.a</code> library also defines some other symbols, and those other symbols are needed by the linker, so it has to link the object file containing <code>symbol_foo</code>, and complains because that symbol is doubly-defined, even though others in the same file are not.</p>\n\n<p>Plauger advocates that each object file in a (static) library should define a single external symbol.  This allows the maximum substitutability for the functions in the library.  I believe it is fair to assume that the designer of <code>libfoo.a</code> didn't make that decision, at least w.r.t <code>symbol_foo</code>.</p>\n\n<p>You can extract the object files from <code>libfoo.a</code> (use a temporary directory) and examine their contents with <code>nm</code>; you may be able to do that directly on the library itself.  Used with the proper options, that will show you which files define and reference which other symbols.</p>\n\n<p>Note that the rules for linking with shared libraries are somewhat different.  There are also 'weak' symbols which can alter the behaviour.  You can also often create 'relocatable' or 'relinkable' object files from multiple object files (<code>ld -r</code> usually); that gives you a single bigger object file and alters the equation.  Finally, for now, linker scripts can control which symbols are visible outside the library.  So, this is no more than a gloss over the subject.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1533747063, "creation_date": 1533747063, "answer_id": 51751841, "question_id": 51749969, "link": "https://stackoverflow.com/questions/51749969/can-i-replace-a-symbol-in-a-static-library-with-my-own-version/51751841#51751841", "title": "Can I replace a symbol in a static library with my own version?", "body": "<p>As a general rule, if you want to override (replace) a non-weak, global symbol in a static library and still use the rest of the library, you're also going to need to replace all the other non-weak, global symbols in the same compilation unit in the static libary.</p>\n\n<p>You can find all the symbols in the library with <code>nm</code> -- running <br/><code>nm libfoo.a | grep ' [BDGRST] \\|:'</code> will list each object (compilation unit) in the library, followed by all the non-weak global symbols in that object.</p>\n"}], "owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "accepted_answer_id": 51750635, "answer_count": 2, "score": 3, "last_activity_date": 1533747063, "creation_date": 1533740685, "question_id": 51749969, "link": "https://stackoverflow.com/questions/51749969/can-i-replace-a-symbol-in-a-static-library-with-my-own-version", "title": "Can I replace a symbol in a static library with my own version?", "body": "<p>Using gcc/ld, I want to use <code>libfoo.a</code>, which contains a symbol <code>symbol_foo</code> (which is a function - an ISR if that matters). Other functions in <code>libfoo</code> uses this function obviously. What I want to do is compile my own binary, using <code>libfoo.a</code>, but linking in my own version of <code>symbol_foo</code> instead.</p>\n\n<p>Is this possible? Currently I get an ld error due to multiple definitions of the symbol. I.e. it's not declared \"soft-linked\" or anything like that in the original static library.</p>\n\n<p>Ideally I'd like there to exist something like <code>__attribute__((ld_override))</code> or whatever, but I'm guessing there does not. Any ideas?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "edited": false, "score": 4, "creation_date": 1533739395, "post_id": 51749489, "comment_id": 90458809, "body": "When <code>i == 0</code> the if statement evaluates to <code>false</code> and the program hops down the recursion stack and terminates"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533739597, "post_id": 51749489, "comment_id": 90458971, "body": "Also, the <code>i</code> you pass to <code>main</code> as an argument is ignored. <code>int main()</code> has no arguments defined, so you can&#39;t access any. The <code>static int i</code> retains its value between calls and is available in all recursions (although recursing <code>main</code> is frowned on)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1533739799, "post_id": 51749489, "comment_id": 90459107, "body": "Did you write this code, or did someone give it to you as a puzzle?  If you wrote this code, please don&#39;t write code like this ever again: it&#39;s so unnecessarily confusing it might as well be meaningless."}, {"owner": {"reputation": 3, "user_id": 10198234, "user_type": "registered", "profile_image": "https://graph.facebook.com/148855172669297/picture?type=large", "display_name": "Thirumurugan R", "link": "https://stackoverflow.com/users/10198234/thirumurugan-r"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533817367, "post_id": 51749489, "comment_id": 90492386, "body": "@SteveSummit Well this was a output question given in geeks for geeks website. I didn&#39;t write the code.Thank you very much sir."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533827663, "post_id": 51749489, "comment_id": 90499776, "body": "@ThirumuruganR This may be unfair, but based on what I&#39;ve seen there (which isn&#39;t much), that site might as well be named IdiotsForIdiots.  Evidently anyone can post anything there, and most of the posters don&#39;t really know what they&#39;re doing, so the useful, accurate content is scattershot at best."}], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1533776920, "post_id": 51749560, "comment_id": 90474499, "body": "and in <code>main(i)</code> the <code>i</code> is not used"}], "tags": [], "owner": {"reputation": 1984, "user_id": 2116001, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/joLB7.png?s=128&g=1", "display_name": "gogaz", "link": "https://stackoverflow.com/users/2116001/gogaz"}, "is_accepted": true, "score": 4, "last_activity_date": 1533739502, "creation_date": 1533739502, "answer_id": 51749560, "question_id": 51749489, "link": "https://stackoverflow.com/questions/51749489/regarding-the-output-of-a-query-given-below/51749560#51749560", "title": "regarding the output of a query given below", "body": "<p>You actually have a condition:</p>\n\n<p><code>if (--i)</code> is equivalent to <code>if(--i != 0)</code></p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 1150202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d508b09bfaee6b958d35098a74d70a?s=128&d=identicon&r=PG", "display_name": "Shibir Basak", "link": "https://stackoverflow.com/users/1150202/shibir-basak"}, "is_accepted": false, "score": 1, "last_activity_date": 1533745791, "creation_date": 1533745791, "answer_id": 51751539, "question_id": 51749489, "link": "https://stackoverflow.com/questions/51749489/regarding-the-output-of-a-query-given-below/51751539#51751539", "title": "regarding the output of a query given below", "body": "<p><strong>Equivalent code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    static int i = 5;\n    i = i - 1;\n    if (i != 0){\n        printf(\"%d \", i);\n        main(i);\n    }\n}\n</code></pre>\n\n<p><strong>Stack trace</strong> </p>\n\n<pre><code>i=5, print 4, call main(4) \n    i=4, print 3, call main(3)\n        i=3, print 2, call main(2)\n            i=2, print 1, call main(1)\n                i=1, if(i--) is false, returns\n            returns\n        returns\n     returns\nreturns\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10198234, "user_type": "registered", "profile_image": "https://graph.facebook.com/148855172669297/picture?type=large", "display_name": "Thirumurugan R", "link": "https://stackoverflow.com/users/10198234/thirumurugan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51749560, "answer_count": 2, "score": 0, "last_activity_date": 1533745791, "creation_date": 1533739288, "last_edit_date": 1533743527, "question_id": 51749489, "link": "https://stackoverflow.com/questions/51749489/regarding-the-output-of-a-query-given-below", "title": "regarding the output of a query given below", "body": "<p>This program gives output as 4 3 2 1.\nWhy does it stop at 1 when no condition is given for i?\nDo main(10) and main(i) differ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    static int i = 5;\n    if (--i){\n        printf(\"%d \", i);\n        main(i);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "argv", "argc"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1533739316, "post_id": 51749413, "comment_id": 90458760, "body": "You are not allocating any memory for the pointers in <code>myargv[]</code> or copying any strings - you&#39;re just assigning pointers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1533739440, "post_id": 51749413, "comment_id": 90458848, "body": "Each element of <code>myargv[]</code> points to <code>string[]</code> whose content keeps changing. So they all point to the same thing, the last string processed."}, {"owner": {"reputation": 15, "user_id": 9896694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aa2f62be7a4c9417f0093f667d0b7e?s=128&d=identicon&r=PG&f=1", "display_name": "jsrookie", "link": "https://stackoverflow.com/users/9896694/jsrookie"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1533740159, "post_id": 51749413, "comment_id": 90459338, "body": "@PaulR is it correct that I assign the buff[i] == &#39; &#39; into buff[i] = &#39;\\0&#39; and then I perform the string copy after?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1533742809, "post_id": 51749413, "comment_id": 90461144, "body": "It sounds like you may need to learn how to use a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9896694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aa2f62be7a4c9417f0093f667d0b7e?s=128&d=identicon&r=PG&f=1", "display_name": "jsrookie", "link": "https://stackoverflow.com/users/9896694/jsrookie"}, "edited": false, "score": 0, "creation_date": 1533821509, "post_id": 51760603, "comment_id": 90495471, "body": "Thanks for the help. I wanted to ask what&#39;s the difference between char **myargv and char *myargv[256]. I tried to search on it but I can&#39;t find a more detailed explanation about their difference."}, {"owner": {"reputation": 28, "user_id": 10140957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3643dcaf905663bbcefaa571be5e0e0?s=128&d=identicon&r=PG&f=1", "display_name": "Marlon23", "link": "https://stackoverflow.com/users/10140957/marlon23"}, "reply_to_user": {"reputation": 15, "user_id": 9896694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aa2f62be7a4c9417f0093f667d0b7e?s=128&d=identicon&r=PG&f=1", "display_name": "jsrookie", "link": "https://stackoverflow.com/users/9896694/jsrookie"}, "edited": false, "score": 0, "creation_date": 1533845003, "post_id": 51760603, "comment_id": 90508538, "body": "Check this website: <a href=\"https://cdecl.org\" rel=\"nofollow noreferrer\">cdecl.org</a>. So according to your declaration, you declared myargv as an array of 256 pointers to char. In your situation when you don&#39;t know how many words you&#39;ll  get, I think dynamic allocation is good solution for saving memory. At first, you allocate as many pointers to char as you have words. The second step is forloop and for every pointer to char you need to allocate some memory to store the strings. That&#39;s why there are two stars in declaration."}, {"owner": {"reputation": 28, "user_id": 10140957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3643dcaf905663bbcefaa571be5e0e0?s=128&d=identicon&r=PG&f=1", "display_name": "Marlon23", "link": "https://stackoverflow.com/users/10140957/marlon23"}, "reply_to_user": {"reputation": 15, "user_id": 9896694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aa2f62be7a4c9417f0093f667d0b7e?s=128&d=identicon&r=PG&f=1", "display_name": "jsrookie", "link": "https://stackoverflow.com/users/9896694/jsrookie"}, "edited": false, "score": 0, "creation_date": 1533845705, "post_id": 51760603, "comment_id": 90508830, "body": "I think that the problem wasn&#39;t in your declaration of myargv, but in splitting the original string. In your highlighted forloop, you just erased spaces, second condition had never executed, because if the first part of condition is true, the second part can&#39;t be true. And in the last forloop, your joined string was assigned to each pointer from array, so the output was still the same."}], "tags": [], "owner": {"reputation": 28, "user_id": 10140957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3643dcaf905663bbcefaa571be5e0e0?s=128&d=identicon&r=PG&f=1", "display_name": "Marlon23", "link": "https://stackoverflow.com/users/10140957/marlon23"}, "is_accepted": true, "score": 0, "last_activity_date": 1533797766, "creation_date": 1533797766, "answer_id": 51760603, "question_id": 51749413, "link": "https://stackoverflow.com/questions/51749413/how-to-split-a-string-into-words/51760603#51760603", "title": "How to split a string into words?", "body": "<p>So here is my solution, not sure if it is optimal, but works also with more spaces between words. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main()\n{\n    int i;\n    int myargc = 1;\n    char **myargv;\n    char buff[100];\n    int len = 0;\n    char string[256];\n    int j = 0, k =0;\n\n    printf(\"Enter text: \");\n    gets(buff);\n\n    for(i = 0; buff[i] != '\\0'; i++){\n        len++;\n    }\n\n    for(i = 0; i &lt; len; i++)\n    {\n        if(buff[i]!=' ' &amp;&amp; buff[i+1]==' ')\n        {\n            myargc++;\n        }\n    }\n    printf(\"myargc %d\\n\",myargc);\n\n    //allocating 256 bytes * number of words    \n    myargv = (char**)malloc(myargc*sizeof(char*));\n    for(i = 0; i &lt; myargc; i++){\n        myargv[i] = (char*)malloc(256*sizeof(char));\n    }\n\n    //iterating until the ending character\n    for(i = 0; i &lt;= len; i++){\n        //building word\n        if(buff[i] != ' ' &amp;&amp; buff[i] != 0)\n        {   \n            string[j++] = buff[i];\n        }\n\n        //copying word to corresponding array\n        else if((buff[i] == ' ' &amp;&amp; buff[i+1] != ' ') || (buff[i] == 0))\n        {\n            for(int z = 0; z &lt; j; z++){\n                myargv[k][z] = string[z];\n            }\n\n            myargv[k++][j] = '\\0';\n            j = 0;\n        }\n\n        //skipping more spaces in a row\n        else continue;\n    }\n\n\n    for(i = 0; i &lt; myargc; i++){\n        printf(\"argv[%d]\\t%s\\n\", i, myargv[i]);\n    }\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9896694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aa2f62be7a4c9417f0093f667d0b7e?s=128&d=identicon&r=PG&f=1", "display_name": "jsrookie", "link": "https://stackoverflow.com/users/9896694/jsrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 897, "favorite_count": 0, "accepted_answer_id": 51760603, "answer_count": 1, "score": -2, "last_activity_date": 1533797766, "creation_date": 1533739112, "last_edit_date": 1533742639, "question_id": 51749413, "link": "https://stackoverflow.com/questions/51749413/how-to-split-a-string-into-words", "title": "How to split a string into words?", "body": "<p>I am trying to split strings into words. Can anyone help me on how to implement it without using <code>strtok</code> and another function other than <code>main</code>?</p>\n\n<pre><code>void main()\n{\n    int i;\n    int myargc = 1;\n    char *myargv[256];\n    char buff[100];\n    int len = 0;\n    char string[256];\n    int j = 0;\n\n    printf(\"Enter text: \");\n    gets(buff);\n\n    for(i = 0; buff[i] != '\\0'; i++){\n        len++;\n    }\n\n    for(i = 0; i &lt; len; i++)\n    {\n        if(buff[i]!=' ' &amp;&amp; buff[i+1]==' ')\n        {\n            myargc++;\n        }\n    }\n    printf(\"myargc %d\\n\",myargc);\n\n    **for(i = 0; i &lt; len; i++){\n        if(buff[i] != ' '){\n            string[j++] = buff[i];\n        }\n        if(buff[i] != ' ' &amp;&amp; buff[i] == ' '){\n            string[j++] = '\\0';\n            j = 0;\n        }\n        if(buff[i] == '\\0'){\n            break;\n        }\n    }**\n    for(i = 0; i &lt; myargc - 1; i++){\n        myargv[i] = string;\n        printf(\"argv[%d]\\t%s\\n\", i, myargv[i]);\n    }\n}\n</code></pre>\n\n<p>When I entered \"a b c\" for example, my output looked like this:</p>\n\n<pre><code>myargc 3\nargv[0] abc\nargv[1] abc\nargv[2] abc\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 2, "creation_date": 1533738553, "post_id": 51749186, "comment_id": 90458206, "body": "<code>(p[i] + k) % 26</code> should be <code>&#39;A&#39; + ((p[i]-&#39;A&#39; + k) % 26)</code>"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1533738593, "post_id": 51749186, "comment_id": 90458246, "body": "...or is it just printing non-printable characters?"}, {"owner": {"reputation": 1, "user_id": 10198249, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RMzJQqKs_Lo/AAAAAAAAAAI/AAAAAAAAADA/tnE96D8mq9M/photo.jpg?sz=128", "display_name": "Omid Ghafori", "link": "https://stackoverflow.com/users/10198249/omid-ghafori"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1533738883, "post_id": 51749186, "comment_id": 90458455, "body": "@IlyaBursov That works, thanks! If it&#39;s not too much effort, would you kindly explain what that did?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533738904, "post_id": 51749186, "comment_id": 90458469, "body": "<i>Is</i> there an <code>argv[1]</code>? You should always check <code>argc &gt;= 2</code> first, if only to protect you from yourself."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1533738961, "post_id": 51749186, "comment_id": 90458509, "body": "it converts letters from ascii code to number and back"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1533738982, "post_id": 51749186, "comment_id": 90458524, "body": "<code>string</code>.  No.  Just no.  Do not use CS50&#39;s benighted <code>string</code> type.  Ever.  It is extremely confusing."}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1533739198, "post_id": 51749186, "comment_id": 90458683, "body": "@OmidGhafori, taking a value modulo 26 (<code>% 26</code>) gives you a number between 0 to 25, but &#39;A&#39; to &#39;Z&#39; ranges from 65 to 90 in ASCII, so you end up printing completely different characters after the modulo. Ilya&#39;s solution takes the modulo of the offset from &#39;A&#39; (instead of the actual value of the letter), then adds that modulo&#39;d value back to &#39;A&#39;."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1533739777, "post_id": 51749186, "comment_id": 90459095, "body": "Using <code>string</code> is reprehensible. Assuming ASCII encoding saddens me."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6070464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fz59LtYRRq0/AAAAAAAAAAI/AAAAAAAAArI/y2xOfIW7WYI/photo.jpg?sz=128", "display_name": "bbyalcinkaya", "link": "https://stackoverflow.com/users/6070464/bbyalcinkaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1533766253, "creation_date": 1533766253, "answer_id": 51756359, "question_id": 51749186, "link": "https://stackoverflow.com/questions/51749186/printf-not-printing-variables/51756359#51756359", "title": "printf not printing variables", "body": "<p>It prints some invisible characters among first 26 characters of ASCII table. You need to print <code>'A' + (alphabet_index(i)+k)%26</code> where <code>alphabet_index(i) = i - 'A'</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10198249, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RMzJQqKs_Lo/AAAAAAAAAAI/AAAAAAAAADA/tnE96D8mq9M/photo.jpg?sz=128", "display_name": "Omid Ghafori", "link": "https://stackoverflow.com/users/10198249/omid-ghafori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533766253, "creation_date": 1533738432, "question_id": 51749186, "link": "https://stackoverflow.com/questions/51749186/printf-not-printing-variables", "title": "printf not printing variables", "body": "<p>I'm doing CS50's Caesar problem, which requires me to move the letters of a string one forward (A -> B). It worked with a simple <code>letter++</code> but when I try to move the letter a specific amount, nothing's working. Any help?</p>\n\n<pre><code>string p = get_string(\"plaintext: \");\nint k = strtol(argv[1], NULL, 10);\nprintf(\"ciphertext: \");\nfor (int i = 0; i &lt; strlen(p); i++)\n{\n    printf(\"%c\", (p[i] + k) % 26);\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "cmake"], "comments": [{"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 1, "creation_date": 1533737511, "post_id": 51748782, "comment_id": 90457435, "body": "Does the Release dir exits? I guess you&#39;re using uninitialized macro for some root dir..."}, {"owner": {"reputation": 1620, "user_id": 788711, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b9b79d3c67b19e5490f4f2861472ab53?s=128&d=identicon&r=PG", "display_name": "Apoorva sahay", "link": "https://stackoverflow.com/users/788711/apoorva-sahay"}, "edited": false, "score": 0, "creation_date": 1533737525, "post_id": 51748782, "comment_id": 90457451, "body": "what is the location of /Release/libpmjni.so in your system."}, {"owner": {"reputation": 65, "user_id": 9232819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTd9B0CIfLY/AAAAAAAAAAI/AAAAAAAAALw/eVA--xA0Pag/photo.jpg?sz=128", "display_name": "Di W.", "link": "https://stackoverflow.com/users/9232819/di-w"}, "edited": false, "score": 0, "creation_date": 1533738180, "post_id": 51748782, "comment_id": 90457901, "body": "There isn\u2019t a Release/libpmjni.so in my system. There\u2019s only the pmjni.c code as far as I can tell."}, {"owner": {"reputation": 65, "user_id": 9232819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTd9B0CIfLY/AAAAAAAAAAI/AAAAAAAAALw/eVA--xA0Pag/photo.jpg?sz=128", "display_name": "Di W.", "link": "https://stackoverflow.com/users/9232819/di-w"}, "edited": false, "score": 0, "creation_date": 1533738323, "post_id": 51748782, "comment_id": 90458016, "body": "Well. I didn\u2019t write this code. Dunno what\u2019s happening honestly, much less find an uninitialised macro. I am also never given the cmakelists.txt file for cmake in the installation package. I should just go over the source... though I\u2019m not that familiar with c..."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 9232819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTd9B0CIfLY/AAAAAAAAAAI/AAAAAAAAALw/eVA--xA0Pag/photo.jpg?sz=128", "display_name": "Di W.", "link": "https://stackoverflow.com/users/9232819/di-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1533787456, "creation_date": 1533787456, "answer_id": 51758655, "question_id": 51748782, "link": "https://stackoverflow.com/questions/51748782/what-does-this-linking-error-mean-when-installing-portmidi/51758655#51758655", "title": "What does this linking error mean when installing portmidi?", "body": "<p>Apparently, there was some configuring to do in the directories that CMake points to in ccmake configuration. I just redownloaded the files and unzipped it into a newly made portmedia directory. Also, to make sure that you don't get any hiccups in making pm_defaults, refer to <a href=\"https://stackoverflow.com/questions/14127821/install-portmidi-library\" title=\"Nate&#39;s Answer for pmdefaults problem\">Nate's answer</a>. To quote:</p>\n\n<blockquote>\n  <p>Apparently, one of the <code>Makefile</code>s generated by <code>ccmake</code> is broken. I was able to fix the issue by running</p>\n\n<pre><code>sed -i 's/pm_java\\/pm_java/pm_java/' build.make\n</code></pre>\n  \n  <p>in the <code>pm_java/CMakeFiles/pmdefaults_target.dir/</code> subdirectory of the\n  project <em>after</em> running <code>ccmake .</code> (on Ubuntu, though). (The <code>sed</code>\n  command replaces all occurrences of <code>pm_java/pm_java</code> by <code>pm_java</code>.)</p>\n  \n  <p>Everything compiles, and I can even run <code>pmdefaults</code> from the\n  <code>Release</code> directory using</p>\n\n<pre><code>java -Djava.library.path=. -jar pmdefaults.jar\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 65, "user_id": 9232819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTd9B0CIfLY/AAAAAAAAAAI/AAAAAAAAALw/eVA--xA0Pag/photo.jpg?sz=128", "display_name": "Di W.", "link": "https://stackoverflow.com/users/9232819/di-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 51758655, "answer_count": 1, "score": 1, "last_activity_date": 1533787456, "creation_date": 1533737363, "last_edit_date": 1533737490, "question_id": 51748782, "link": "https://stackoverflow.com/questions/51748782/what-does-this-linking-error-mean-when-installing-portmidi", "title": "What does this linking error mean when installing portmidi?", "body": "<p>After I configured the cmake file for portmidi, and proceeded to use make to make the necessary files, I encountered this error during compilation:</p>\n\n<pre><code>- Build files have been written to: /home/mycomputername\n\n/Desktop/portmedia/portmidi\n[  2%] Linking C shared library /Release/libpmjni.so\n/usr/bin/x86_64-linux-gnu-ld: cannot open output file /Release/libpmjni.so: No such file or directory\ncollect2: error: ld returned 1 exit status\npm_common/CMakeFiles/pmjni.dir/build.make:251: recipe for target '/Release/libpmjni.so' failed\nmake[2]: *** [/Release/libpmjni.so] Error 1\nCMakeFiles/Makefile2:87: recipe for target 'pm_common/CMakeFiles/pmjni.dir/all' failed\nmake[1]: *** [pm_common/CMakeFiles/pmjni.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I'm quite confused. I've tried to insert the flags -fpic in the cxx-flags section of ccmake and change the default java install paths to no avail. Quite frankly, I think it has to do with the messing up of execution order, but I don't know where.</p>\n\n<p>Any help will be greatly appreciated.</p>\n"}, {"tags": ["c", "assembly", "system-calls", "strace", "ptrace"], "comments": [{"owner": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "edited": false, "score": 0, "creation_date": 1533736669, "post_id": 51748466, "comment_id": 90456861, "body": "Did you start your program as root ? Ptrace requires elevated privileges to attach to other processes."}, {"owner": {"reputation": 57, "user_id": 8237956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g8mWwyAPtBg/AAAAAAAAAAI/AAAAAAAAm1k/5PTw0EtKoZs/photo.jpg?sz=128", "display_name": "Benedict Schl&#252;ter", "link": "https://stackoverflow.com/users/8237956/benedict-schl%c3%bcter"}, "reply_to_user": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "edited": false, "score": 0, "creation_date": 1533737173, "post_id": 51748466, "comment_id": 90457211, "body": "Sure I compiled and run it as root but the same error appears"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1533738449, "post_id": 51748466, "comment_id": 90458126, "body": "Seems like quite a reasonable restriction.  What happens if you <code>fork()</code> a child process in which you <code>PTRACE_TRACEME</code> and exec <code>sleep</code>?  Can you attach to that from the parent?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1533743433, "post_id": 51748466, "comment_id": 90461530, "body": "The kernel won&#39;t  let a task attach to any task in its thread group, presumably to prevent deadlock."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "edited": false, "score": 0, "creation_date": 1533761401, "post_id": 51748466, "comment_id": 90470529, "body": "@Ra&#39;Jiska: It&#39;s trying to attach to itself."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533770463, "post_id": 51748466, "comment_id": 90473249, "body": "@Benedict: your inline asm has a bug: you forgot to clobber <code>rcx</code> and <code>r11</code> (which are destroyed by <code>syscall</code> itself), and you should use <code>&quot;=a&quot;(ret)</code> as part of the same asm statement that makes the syscall.  It&#39;s not safe to assume that <code>rax</code> will stay unmodified between asm statements.  As far as the compiler is concerned, they&#39;re totally separate statements."}, {"owner": {"reputation": 57, "user_id": 8237956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g8mWwyAPtBg/AAAAAAAAAAI/AAAAAAAAm1k/5PTw0EtKoZs/photo.jpg?sz=128", "display_name": "Benedict Schl&#252;ter", "link": "https://stackoverflow.com/users/8237956/benedict-schl%c3%bcter"}, "edited": false, "score": 0, "creation_date": 1533986583, "post_id": 51748466, "comment_id": 90554817, "body": "I am just a beginner at Linux Binaries. At the moment i am reading this book and i saw the code on page 90 (<a href=\"http://index-of.es/Miscellanous/Learning%20Linux%20Binary%20Analysis.pdf\" rel=\"nofollow noreferrer\">index-of.es/Miscellanous/&hellip;</a>) and trying to do it myself. Maybe then you understand me better :D"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533761530, "post_id": 51751705, "comment_id": 90470588, "body": "I find <code>kernel.yama.ptrace_scope = 0</code> is a convenient sysctl setting for a development desktop.  It allows tracing non-child processes, so you can attach to things with GDB instead of having to start them from within GDB."}], "tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 0, "last_activity_date": 1533746508, "creation_date": 1533746508, "answer_id": 51751705, "question_id": 51748466, "link": "https://stackoverflow.com/questions/51748466/inline-assembler-syscall-ptraceoperation-not-permitted/51751705#51751705", "title": "Inline Assembler Syscall PTRACE(Operation not permitted)", "body": "<p>There are different reasons why this does not work.</p>\n\n<p>One may be the behavior described in the manpage you have linked:</p>\n\n<blockquote>\n  <p><a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/ptrace.2.html</a></p>\n</blockquote>\n\n<p>Search for \"Ptrace access mode checking\" in this manpage.</p>\n\n<p>The section following that words describes different security modules which can be configured in a way that regular users are not allowed to do ptrace on their own processes.</p>\n\n<p>It can even be configured to disable \"ptrace\" completely (even if started by root).</p>\n\n<p>Note that it will not be possible to access processes started by a different user (unless you are root).</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 8237956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g8mWwyAPtBg/AAAAAAAAAAI/AAAAAAAAm1k/5PTw0EtKoZs/photo.jpg?sz=128", "display_name": "Benedict Schl&#252;ter", "link": "https://stackoverflow.com/users/8237956/benedict-schl%c3%bcter"}, "is_accepted": false, "score": 0, "last_activity_date": 1533990611, "creation_date": 1533990611, "answer_id": 51799698, "question_id": 51748466, "link": "https://stackoverflow.com/questions/51748466/inline-assembler-syscall-ptraceoperation-not-permitted/51799698#51799698", "title": "Inline Assembler Syscall PTRACE(Operation not permitted)", "body": "<p>A Process is not able to attach itself but a Parent can attach his child. Forking was the solution. Thank you for your answers. Now </p>\n\n<pre><code>strace -p $PID(of the child) \n</code></pre>\n\n<p>returns an error </p>\n\n<p>If you are using </p>\n\n<pre><code>strace -f ./Programm\n</code></pre>\n\n<p>strace will attach to the child before the parent is able to do it and the syscall will fail.</p>\n\n<p>Here I traced the parent </p>\n\n<pre><code>     [....]\n     rk(0x562f67a93000)                     = 0x562f67a93000\n     write(1, \"My process ID : 1801\\n\", 21My process ID : 1801\n     )  = 21\n     clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f28dc5547d0) = 1802\n     ptrace(PTRACE_ATTACH, 1802)             = 0\n     --- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_TRAPPED, si_pid=1802, si_uid=1000, si_status=SIGSTOP, si_utime=0, si_stime=0} ---\n     nanosleep({tv_sec=50, tv_nsec=0}, 0x7ffc95baaf30) = 0\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8237956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g8mWwyAPtBg/AAAAAAAAAAI/AAAAAAAAm1k/5PTw0EtKoZs/photo.jpg?sz=128", "display_name": "Benedict Schl&#252;ter", "link": "https://stackoverflow.com/users/8237956/benedict-schl%c3%bcter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1533990611, "creation_date": 1533736332, "question_id": 51748466, "link": "https://stackoverflow.com/questions/51748466/inline-assembler-syscall-ptraceoperation-not-permitted", "title": "Inline Assembler Syscall PTRACE(Operation not permitted)", "body": "<p>Hello I\u00b4ve got a Problem</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#define SYS_PTRACE 101\nlong my_ptrace(long pid)\n{\nlong ret;\n__asm__ volatile(\n\"mov $0x10, %%rdi\\n\"\n\"mov %0, %%rsi\\n\"\n\"xor %%rdx,%%rdx\\n\"\n\"xor %%r10, %%r10\\n\"\n\"mov $0x65, %%rax\\n\"\n\"syscall\" : :\"g\"(pid)); \n__asm__ volatile(\"mov %%rax, %0\" : \"=r\"(ret));\nreturn ret;\n}\n\nint main()\n{  \nlong a = getpid();\nmy_ptrace(a);\nprintf(\"Hello World\\n %d\", a);\n\nreturn 0;\n}\n</code></pre>\n\n<p>first I move 0x10 or 16 into rdi which is the number for PTRACE_ATTACH according to <a href=\"https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.7-4.6/+/jb-dev/sysroot/usr/include/sys/ptrace.h\" rel=\"nofollow noreferrer\">https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.7-4.6/+/jb-dev/sysroot/usr/include/sys/ptrace.h</a> </p>\n\n<p>followed by moving the PID into rsi (<a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/ptrace.2.html</a>) the other values are not used by this call.</p>\n\n<p>But if I compile and execute the Programm strace outputs</p>\n\n<pre><code>[...]\narch_prctl(ARCH_SET_FS, 0x7f4eac1fa500) = 0\nmprotect(0x7f4eac1ef000, 16384, PROT_READ) = 0\nmprotect(0x55fb014bd000, 4096, PROT_READ) = 0\nmprotect(0x7f4eac240000, 4096, PROT_READ) = 0\nmunmap(0x7f4eac1fb000, 113090)          = 0\ngetpid()                                = 4328\nptrace(PTRACE_ATTACH, 4328)             = -1 EPERM (Die Operation ist     nicht erlaubt)\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0\nbrk(NULL)                               = 0x55fb02077000\nbrk(0x55fb02098000)                     = 0x55fb02098000\nwrite(1, \"Hello World\\n\", 12Hello World\n)           = 12\nwrite(1, \" 4328\", 5 4328)                    = 5\nexit_group(0)                           = ?\n+++ exited with 0 ++\n</code></pre>\n\n<p>Did I something wrong or is it not possible that a process traces itself?</p>\n\n<p>Thank you for you help.</p>\n"}, {"tags": ["c", "c11", "c17"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 6, "creation_date": 1533735958, "post_id": 51748324, "comment_id": 90456383, "body": "(As a meta sidenote, the c18 tag is already taken on SO, by a certain infamous compiler. We may have to change the SO tags.)"}, {"owner": {"reputation": 270, "user_id": 9518258, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "0xdd", "link": "https://stackoverflow.com/users/9518258/0xdd"}, "edited": false, "score": 1, "creation_date": 1533736110, "post_id": 51748324, "comment_id": 90456478, "body": "I&#39;m flagging this question to be closed as primarily opinion-based. StackOverflow doesn&#39;t have the authority to declare what the next C standard version will be called, and even if someone here has the authority to do so, this isn&#39;t the right forum."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533736658, "post_id": 51748324, "comment_id": 90456851, "body": "My gcc 8.1.1 has both -std=c17 and -std=c18 and both iso9899:2017 and iso9899:2018."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1533737102, "post_id": 51748324, "comment_id": 90457155, "body": "Let&#39;s suppose that the name is based on the revision (which starts/ends somewhen between Jan-2017 and Dec-2017) instead of the publication date: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html</a>"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 8, "creation_date": 1533737953, "post_id": 51748324, "comment_id": 90457736, "body": "The C standard committee calls it C17 because it was approved by them in 2017. The date stamp is <code>201710L</code>. That the whole ISO process then needed another 6 month to lead to the publication is another story."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1533738157, "post_id": 51748324, "comment_id": 90457883, "body": "Also I have a summary of the changes at <a href=\"https://gustedt.wordpress.com/2018/04/17/c17/\" rel=\"nofollow noreferrer\">gustedt.wordpress.com/2018/04/17/c17</a> with the plan to provide explanations for most of the changes over the next months."}, {"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 6, "creation_date": 1533739811, "post_id": 51748324, "comment_id": 90459115, "body": "I&#39;m voting to close this question as off-topic because it is not about programing it is about triminology"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1533748219, "post_id": 51748324, "comment_id": 90464115, "body": "Note that the 9899:1990 standard is often called <code>C89</code>, not <code>C90</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1533797760, "post_id": 51748324, "comment_id": 90480240, "body": "@JensGustedt Ah, the <code>__STDC_VERSION__</code> might indeed be what we should look at above everything else. Also, it would be awesome if you could cross-post those changes from your blog into an answer at <a href=\"https://stackoverflow.com/questions/47529854/what-is-c17-and-what-changes-have-been-made-to-the-language/47530004#47530004\">What is C17 and what changes have been made to the language?</a> :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1534113406, "post_id": 51748324, "comment_id": 90581597, "body": "@ChrisDodd: The C89 standard was ANSI X3.159-1989 (per Wikipedia <a href=\"https://en.wikipedia.org/wiki/ANSI_C\" rel=\"nofollow noreferrer\">ANSI C</a>), which was published in 1989, and then superseded in 1990 by ISO 9899:1990.  The main difference between the two was the section numbers and end matter \u2014 the technical content was supposed to be the same between them.  It predated the use of an encoded date in a version number (that arrived with AMD1 in 1994/5), so there wasn&#39;t a problem with the year of publication, even."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1534117280, "post_id": 51748324, "comment_id": 90582166, "body": "Should this go to meta ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1534118366, "post_id": 51748324, "comment_id": 90582340, "body": "@Stargateur: YES \u2014 see <a href=\"https://meta.stackoverflow.com/questions/372474/how-to-migrate-a-mso-question-from-so-to-mso\">How to migrate a specific MSO question from SO to MSO</a>"}, {"owner": {"reputation": 13692, "user_id": 92546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d3e56edbab2b69598e2cdbcbb74edd?s=128&d=identicon&r=PG", "display_name": "HABO", "link": "https://stackoverflow.com/users/92546/habo"}, "edited": false, "score": 0, "creation_date": 1534120579, "post_id": 51748324, "comment_id": 90582654, "body": "Votes to close because this question is about <a href=\"https://www.goodreads.com/book/show/20482731-triminology-101\" rel=\"nofollow noreferrer\">triminology</a>?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1534373947, "post_id": 51748324, "comment_id": 90686926, "body": "The name of the standard is ISO/IEC 9899:2018, so it seems natural to me to call it c18.  (I agree with Mike Stump from gcc <a href=\"https://www.mail-archive.com/gcc-patches@gcc.gnu.org/msg178386.html\" rel=\"nofollow noreferrer\">here</a>)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564942546, "post_id": 51748324, "comment_id": 101186008, "body": "C17.  Spec uses <code>__STDC_VERSION__ == 201710</code> and not <code>2018xx</code>."}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 4, "creation_date": 1534117976, "post_id": 51813460, "comment_id": 90582276, "body": "<a href=\"https://www.youtube.com/watch?v=GVXCr6upWUo\" rel=\"nofollow noreferrer\">that cost is not reasonable for an individual.</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1534141794, "post_id": 51813460, "comment_id": 90586843, "body": "I wasn&#39;t really asking how to deal with this on SO, that should be posted on meta indeed. Rather I was asking for what canonical sources there would be. <code>__STDC_VERSION__</code> mentioned in comments pretty much answered the question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534141829, "post_id": 51813460, "comment_id": 90586854, "body": "That being said, I have now fixed the C, C11 and C17 tag wikis so they are up to date with 9899:2018."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 7, "creation_date": 1534160880, "post_id": 51813460, "comment_id": 90597092, "body": "The question is asking about what we should call the language, not about how we should go about tagging related questions on Stack Overflow."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 6, "last_activity_date": 1534113927, "creation_date": 1534113927, "answer_id": 51813460, "question_id": 51748324, "link": "https://stackoverflow.com/questions/51748324/should-we-call-it-c17-or-c18/51813460#51813460", "title": "Should we call it C17 or C18?", "body": "<p>Given that the <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> tag is already in use on SO to identify a specific C compiler implementation, it is pragmatic to accept <a href=\"/questions/tagged/c17\" class=\"post-tag\" title=\"show questions tagged &#39;c17&#39;\" rel=\"tag\">c17</a> for the C standard finalized in 2017 but published by ISO in 2018.</p>\n\n<p>The alternative is to create a suitable tag for the compiler currently tagged <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> (with a name such as <a href=\"/questions/tagged/mplab-c18\" class=\"post-tag\" title=\"show questions tagged &#39;mplab-c18&#39;\" rel=\"tag\">mplab-c18</a>), then recreate (copy) the tag wiki information, retag the 44 questions currently tagged <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> with the new <a href=\"/questions/tagged/mplab-c18\" class=\"post-tag\" title=\"show questions tagged &#39;mplab-c18&#39;\" rel=\"tag\">mplab-c18</a> tag, then retag the 4 questions currently tagged <a href=\"/questions/tagged/c17\" class=\"post-tag\" title=\"show questions tagged &#39;c17&#39;\" rel=\"tag\">c17</a> with the new <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> tag, and make <a href=\"/questions/tagged/c17\" class=\"post-tag\" title=\"show questions tagged &#39;c17&#39;\" rel=\"tag\">c17</a> a synonym of <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> (rather than vice versa).  The tag wiki would need to redirect users of the existing <a href=\"/questions/tagged/c18\" class=\"post-tag\" title=\"show questions tagged &#39;c18&#39;\" rel=\"tag\">c18</a> to <a href=\"/questions/tagged/mplab-c18\" class=\"post-tag\" title=\"show questions tagged &#39;mplab-c18&#39;\" rel=\"tag\">mplab-c18</a>.</p>\n\n<p>And all of this probably should be discussed on MSO rather than on SO.</p>\n\n<p><em>Aside:</em> It is disappointing that the ANSI web store charges full price ($232 for non-members; $185.60 for members) for the PDF of the ISO/IEC 9899:2018 standard, rather than offering a reduced rate on the PDF as it once did for C11.  It is hard for me to justify that much for the PDF, despite the frequency with which I refer to the C11 standard.  I'd like to support them if their cost was reasonable; that cost is not reasonable for an individual.</p>\n"}], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 1, "closed_date": 1534122121, "answer_count": 1, "score": 2, "last_activity_date": 1534113927, "creation_date": 1533735900, "question_id": 51748324, "link": "https://stackoverflow.com/questions/51748324/should-we-call-it-c17-or-c18", "closed_reason": "Opinion-based", "title": "Should we call it C17 or C18?", "body": "<p>ISO 9899:2018 has been available for some time now from <a href=\"https://www.iso.org/standard/74528.html\" rel=\"nofollow noreferrer\">ISO</a>. List of changes: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/47529854/what-is-c17-and-what-changes-have-been-made-to-the-language/47530004#47530004\">What is C17 and what changes have been made to the language?</a></p>\n\n<p>Informally this version of the standard has been called C17 for some time, though the ISO document will be 9899:2018. So I wonder if we should call it C17 or C18. </p>\n\n<p>In order to not stir up opinion-based answers, my question is: what canonical sources are there labelling this standard as \"C17\" or \"C18\"? </p>\n\n<p>The most canonical source is of course the ISO standard itself. Given that, the standard should be called C18 for the sake of consistency:</p>\n\n<ul>\n<li>C90 = 9899:1990</li>\n<li>C99 = 9899:1999</li>\n<li>C11 = 9899:2011</li>\n<li>C1x = 9899:2018</li>\n</ul>\n\n<p>It was released in 2018, not 2017. So I would think we should call it C18?</p>\n\n<p>Though as another example, I know that gcc has created a compiler switch <code>-std=c17</code>, according to <a href=\"https://gcc.gnu.org/ml/gcc-patches/2017-10/msg02121.html\" rel=\"nofollow noreferrer\">this</a>. The gcc manual is somewhat canonical. Do they intend to keep that name? What about others like clang and icc?</p>\n\n<p>Is there some consensus? Input from the committee?</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1533735609, "creation_date": 1533735609, "answer_id": 51748210, "question_id": 51748170, "link": "https://stackoverflow.com/questions/51748170/pointer-to-an-array-of-integers/51748210#51748210", "title": "pointer to an array of Integers", "body": "<ul>\n<li><p><code>int *a [10]</code> - is declaring an array named <code>a</code> of 10 <code>int *</code>s.</p></li>\n<li><p><code>int (*a)[10]</code> - is declaring a pointer named <code>a</code> to an array of 10 <code>int</code>s.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1533736118, "last_edit_date": 1533736118, "creation_date": 1533735692, "answer_id": 51748239, "question_id": 51748170, "link": "https://stackoverflow.com/questions/51748170/pointer-to-an-array-of-integers/51748239#51748239", "title": "pointer to an array of Integers", "body": "<p><code>int *a[10]</code> declare <code>a</code> as an array of 10 pointers to <code>int</code>.<br>\n<code>int (*a)[10]</code> declare <code>a</code> as a pointer to an array of 10 <code>int</code>s.  </p>\n\n<p>Remember these two rules to decipher pointer declarations:</p>\n\n<ul>\n<li><p><strong>Always read declarations from inside out</strong>: Start from innermost, if any, parenthesis. Locate the identifier that's being declared, and start deciphering the declaration from there.</p></li>\n<li><p><strong>When there is a choice, always favour [] and () over <code>*</code></strong>: If <code>*</code> precedes the identifier and <code>[]</code> follows it, the identifier represents an array, not a pointer. Likewise, if <code>*</code> precedes the identifier and <code>()</code> follows it, the identifier represents a function, not a pointer. (Parentheses can always be used to override the normal priority of <code>[]</code> and <code>()</code> over <code>*</code>).</p></li>\n</ul>\n\n<p>For example:</p>\n\n<pre><code>int *a[10];      \"a is\"  \n     ^  \n\nint *a[10];      \"a is an array of 10\"  \n      ^^^^ \n\nint *a[10];      \"a is an array of 10 pointers\"\n    ^\n\nint *a[10];      \"a is an array of 10 pointers to `int`\".  \n^^^      \n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2522986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nz1.jpg?s=128&g=1", "display_name": "metasj", "link": "https://stackoverflow.com/users/2522986/metasj"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1533735692, "answer_count": 2, "score": -1, "last_activity_date": 1533737195, "creation_date": 1533735513, "last_edit_date": 1533737195, "question_id": 51748170, "link": "https://stackoverflow.com/questions/51748170/pointer-to-an-array-of-integers", "closed_reason": "Duplicate", "title": "pointer to an array of Integers", "body": "<p>What is the difference between <code>int *a[10]</code> and <code>int (*a)[10]</code>?</p>\n\n<p>I suspect that since <code>[]</code> operator has higher precedence than <code>*</code> operator,\nthe first case will be an array consisting on 10 pointer variables storing the address of integer.<br>\nThe 2<sup>nd</sup> case is the one which I am unsure what it does and why?</p>\n"}, {"tags": ["c", "fork", "sleep"], "comments": [{"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1533734796, "post_id": 51747766, "comment_id": 90455561, "body": "Try calling <code>fflush(log)</code> after your prints... what happens then?"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1533734962, "post_id": 51747766, "comment_id": 90455679, "body": "It worked. Thank you."}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 2, "creation_date": 1533735027, "post_id": 51747766, "comment_id": 90455727, "body": "for(j=0;j&lt;5000000;j++){}  doesn&#39;t simulate sleep. Depending on your compiler optimization setting, it might not generate any code. If it does generate code, it will tie up the CPU for a little while. Impact on other tasks is determined by the OSs scheduling algorithm. In Linux it will usually share CPU equally with other tasks with equal priority."}], "answers": [{"tags": [], "owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "is_accepted": false, "score": 0, "last_activity_date": 1533737753, "last_edit_date": 1533737753, "creation_date": 1533737400, "answer_id": 51748794, "question_id": 51747766, "link": "https://stackoverflow.com/questions/51747766/c-unexpected-results-with-fork-and-sleep-functions/51748794#51748794", "title": "C - Unexpected results with fork and sleep functions", "body": "<p>You are probably having issues with buffering.</p>\n\n<p>Try calling <a href=\"https://linux.die.net/man/3/fflush\" rel=\"nofollow noreferrer\"><code>fflush()</code></a> after a call to <code>fprintf()</code></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>fprintf(log, \"i=%d, Child Terminal here\\n\", i); // print to child terminal\nfflush(log)\n</code></pre>\n\n<p>Alternatively you could look into line buffering or disabling buffering entirely by using <a href=\"https://linux.die.net/man/3/setbuf\" rel=\"nofollow noreferrer\"><code>setbuf()</code> / <code>setvbuf()</code></a></p>\n\n<hr>\n\n<p>Note also that <code>for(j=0;j&lt;5000000;j++){}</code> is <em>not</em> a good idea - ever. This is referred to as a \"<em>busy loop</em>\", and will hog processor time - increasing power usage, temperatures, and starving other processes of resources.</p>\n\n<p>This is a bad idea even if you are working on a microcontroller and should be avoided wherever possible.</p>\n\n<p>Additionally, depending on compiler optimisation settings, this may produce no instructions at all, silently making <code>alternative-3</code> equivalent to <code>alternative-1</code>.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1533737753, "creation_date": 1533734272, "last_edit_date": 1533734572, "question_id": 51747766, "link": "https://stackoverflow.com/questions/51747766/c-unexpected-results-with-fork-and-sleep-functions", "title": "C - Unexpected results with fork and sleep functions", "body": "<p>I found this <a href=\"https://cboard.cprogramming.com/cplusplus-programming/114976-redirect-ouput-another-instance-terminal-window.html\" rel=\"nofollow noreferrer\" title=\"foo\">Redirect ouput to another instance terminal window</a> post and tried to play with similar code alternatives, but got unexpected results when using the sleep function, or similar, in conjunction with the fork function. </p>\n\n<p>I run the code below from a (\"parent\") terminal window. The program is supposed to open another (child) terminal window and print some text to both the parent and child terminals in an infinite loop.</p>\n\n<p>The issue is that the frequency of the printing in each window is not the same, in fact it can be very different.</p>\n\n<p>I tried 4 alternative loops (one need to comment out only 1 of the 4 alternatives at the same time). The alternative-1 is too fast to see much and the printing frequencies <em>look</em> similar in both windows.</p>\n\n<p>The issues arise when I try to slow down the loop, either with the sleep function or a long secondary loop (*), in the alternatives-2, -3 and -4. There, one can see that the timing of text outputs becomes out of sync between the 2 terminals and, while the messages (seem to) print with the desired periodicity in the parent window, e.g. with 1 second delay with sleep(1), the periodicity in the child window seems random and lagging (eg on my machine it takes ~200 seconds before the first output in the child window). Alternative-4  is similar to alternative-2, but with fwrite instead of fprintf. </p>\n\n<p>My questions : why such a lag between the two windows? Is this lag \"deterministic\" or random? What would be the way to make both terminals print at the same, regular, frequency?</p>\n\n<p>I'm on Linux. <code>gcc logwindow.c -o logwindow</code> should be enough to compile the code.</p>\n\n<p>(*) I am aware that using a long loop (in alternative-3) instead of the sleep function is bad practice. I just tried to see if it would  give different results from the sleep function.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;                 // system\n#include &lt;stdio.h&gt;                  // tempnam, sprintf\n#include &lt;unistd.h&gt;                 // sleep\n#include &lt;sys/types.h&gt;          // pid_t\n\nFILE *logwindow(){\n  char *fp = tmpnam(NULL); //generate a random filepath/name\n  char cmd[256];\n  pid_t pid;\n\n  mkfifo(fp, 0777);\n  pid = fork();\n\n  if (pid==0) {\n      sprintf(cmd, \"xterm -e \\\"cat %s\\\"\", fp);\n      system(cmd);\n      return(NULL);\n    }\n  return fopen(fp, \"w\");\n}\n\n\nint main(){\n    FILE *log = logwindow();\n\n    if (log == NULL) {\n        printf(\"child process, exiting\\n\"); \n        exit(0);\n    }\n\n    else {\n        printf(\"parent process, keep going\\n\"); \n        int i=0;\n\n\n        /* comment out only 1 alternative out of the 4 */\n\n        // alternative-1 \n\n        for(;;){\n            fprintf(log, \"i=%d, Child Terminal here\\n\", i); // print to child terminal\n            printf(\"i=%d,  Parent Terminal here\\n\", i);     // print to parent terminal\n            i++;\n        }\n\n\n        // alternative-2\n        /*\n        for(;;){\n            fprintf(log, \"i=%d, Child Terminal here\\n\", i); // print to child terminal\n            printf(\"i=%d,  Parent Terminal here\\n\", i);     // print to parent terminal\n            sleep(1);\n            i++;\n        }\n        */\n\n        // alternative-3\n        /*\n        int j=0;\n        for(i=0;i&lt;100000;i++){\n            fprintf(log, \"i=%d, Child Terminal here\\n\", i); // print to child terminal\n            printf(\"i=%d,  Parent Terminal here\\n\", i);     // print to parent terminal\n            for(j=0;j&lt;5000000;j++){}                        // simulate the sleep function\n        }\n        */      \n\n        // alternative-4\n        /*\n        char alt4text[] = \"Child Terminal here\\n\";          \n        for(;;){\n            fwrite(alt4text, 1, sizeof(alt4text),log);          // print to child terminal\n            printf(\"i=%d,  Parent Terminal here\\n\", i);     // print to parent terminal\n            sleep(1);\n            i++;\n        }\n        */\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533734512, "post_id": 51747582, "comment_id": 90455380, "body": "are <code>wininet.dll</code> is loaded already ? what is <code>GetLastError();</code> after <code>FormatMessage</code> fail ? can assume that <code>GetModuleHandle(&quot;wininet.dll&quot;)</code> fail"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1533734732, "post_id": 51747582, "comment_id": 90455522, "body": "FormatMessage works correctly. It&#39;s your code that doesn&#39;t work. It&#39;s worth being clear about this in question titles."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1533735127, "post_id": 51747582, "comment_id": 90455805, "body": "Your code works, if <code>GetModuleHandle(&quot;wininet.dll&quot;);</code> doesn&#39;t return NULL. If I link against the lib and call InternetOpen it works for me."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533735146, "post_id": 51747582, "comment_id": 90455819, "body": "^^ what @RbMm says.  When faced with a problem like this, your first thought should be to simplify the code by taking out the GetModuleHandle() call and loading into a temp var. on a separate line so that you can easily check its result.   Using multiple system API calls in one statement might look cool, but is actually just difficult to follow and debug:("}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533735296, "post_id": 51747582, "comment_id": 90455926, "body": "anyway - if <code>FormatMessage</code> fail - look and post here <code>GetLastError()</code> after this. for not guess."}, {"owner": {"reputation": 139, "user_id": 3259383, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/00cae708183070bec44569ba5aa7d4d1?s=128&d=identicon&r=PG&f=1", "display_name": "user3259383", "link": "https://stackoverflow.com/users/3259383/user3259383"}, "edited": false, "score": 0, "creation_date": 1533736091, "post_id": 51747582, "comment_id": 90456463, "body": "Yes, I see the problem is that GetModuleHandle(&quot;wininet.dll&quot;) returns NULL, but I have no idea why"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533737145, "post_id": 51747582, "comment_id": 90457189, "body": "if this not typo in name <i>wininet</i> - this mean that this dll yet not loaded. if you replace <code>GetModuleHandle</code> to <code>LoadLibrary</code> will be ok ? you say that call <code>InternetOpen</code> - are you not use delay load for wininet.dll ?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1533737372, "post_id": 51747582, "comment_id": 90457344, "body": "<code>LoadLibrary(&quot;wininet.dll&quot;);</code> works to get the module handle as well."}, {"owner": {"reputation": 139, "user_id": 3259383, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/00cae708183070bec44569ba5aa7d4d1?s=128&d=identicon&r=PG&f=1", "display_name": "user3259383", "link": "https://stackoverflow.com/users/3259383/user3259383"}, "edited": false, "score": 0, "creation_date": 1533739160, "post_id": 51747582, "comment_id": 90458651, "body": "Ok. thanks for the answers. I will try LoadLibrary instead"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533747970, "post_id": 51747582, "comment_id": 90463988, "body": "@RbMm if the error code comes from WinInet to begin with, then obviously the WinInet DLL is loaded. Even the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinInet/appendix-c-handling-errors\" rel=\"nofollow noreferrer\">WinInet documentation</a> says to use <code>GetModuleHandle()</code> when calling <code>FormatMessage()</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533748158, "post_id": 51747582, "comment_id": 90464089, "body": "Related: <a href=\"https://stackoverflow.com/questions/2159458/\">Why is FormatMessage() failing to find a message for WinINet errors?</a>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533748385, "post_id": 51747582, "comment_id": 90464193, "body": "@RemyLebeau - in this case unclear how <i>I see the problem is that <code>GetModuleHandle(&quot;wininet.dll&quot;)</code> returns NULL</i>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533753549, "post_id": 51747582, "comment_id": 90466952, "body": "@RbMm maybe the OP is using WinHTTP instead of WinInet? We don&#39;t know, the OP didn&#39;t say one way or the other. That would be the only logical reason I can think of for why <code>GetModuleHandle(&quot;wininet.dll&quot;)</code> would fail."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1533748928, "creation_date": 1533748928, "answer_id": 51752333, "question_id": 51747582, "link": "https://stackoverflow.com/questions/51747582/formatmessage-doesnt-work/51752333#51752333", "title": "FormatMessage doesn&#39;t work", "body": "<p>Per WinInet's documentation:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinInet/appendix-c-handling-errors\" rel=\"nofollow noreferrer\">Handling Errors</a></p>\n\n<blockquote>\n  <p>To get the error text for an error, call the\u00a0<code>FormatMessage</code>\u00a0function, passing it an\u00a0<code>HMODULE</code>\u00a0handle to <code>Wininet.dll</code>, which can be obtained using the\u00a0<code>GetModuleHandle</code> function.</p>\n</blockquote>\n\n<p>Which is in contrast to Microsoft's system documentation:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/debug/system-error-codes--12000-15999-\" rel=\"nofollow noreferrer\">System Error Codes (12000-15999)</a> </p>\n\n<blockquote>\n  <p>The following list describes\u00a0system error codes\u00a0(<strong>errors 12000 to 15999</strong>). They are returned by the\u00a0<code>GetLastError</code> function when many functions fail. <strong>To retrieve the description text for the error in your application, use the\u00a0<code>FormatMessage</code>\u00a0function with the\u00a0<code>FORMAT_MESSAGE_FROM_SYSTEM</code>\u00a0flag</strong>.</p>\n</blockquote>\n\n<p>That would logically include WinInet error codes in the 12000-12175 range, but in reality it only works for a few select WinInet errors.</p>\n\n<p>Note also that WinInet and WinHTTP share the same 12xxx range of error codes. Error code 12002 is a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winhttp/error-messages\" rel=\"nofollow noreferrer\">WinHTTP error code</a>:</p>\n\n<blockquote>\n  <p>ERROR_WINHTTP_TIMEOUT</p>\n  \n  <p>12002</p>\n  \n  <p>This error can be returned as a result of TCP/IP time-out behavior, regardless of time-out values set in Windows HTTP Services.</p>\n</blockquote>\n\n<p>As well as a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/wininet/wininet-errors\" rel=\"nofollow noreferrer\">WinInet error code</a>:</p>\n\n<blockquote>\n  <p>ERROR_INTERNET_TIMEOUT</p>\n  \n  <p>12002</p>\n  \n  <p>The request has timed out.</p>\n</blockquote>\n\n<p>You did not indicate which library you are using. Make sure you are using the correct module when calling <code>FormatMessage()</code>. If you get an error from a WinInet function, use <code>wininet.dll</code>. If you get an error from a WinHTTP function, use <code>winhttp.dll</code>.</p>\n"}], "owner": {"reputation": 139, "user_id": 3259383, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/00cae708183070bec44569ba5aa7d4d1?s=128&d=identicon&r=PG&f=1", "display_name": "user3259383", "link": "https://stackoverflow.com/users/3259383/user3259383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533748928, "creation_date": 1533733665, "last_edit_date": 1533747245, "question_id": 51747582, "link": "https://stackoverflow.com/questions/51747582/formatmessage-doesnt-work", "title": "FormatMessage doesn&#39;t work", "body": "<p><code>FormatMessage()</code> doesn't work for me no matter what I do. When I have error 12002, <code>lpBuffer</code> returns as NULL all the time. This is my code:</p>\n\n<pre><code>LPTSTR lpBuffer = NULL;\nDWORD dwError = GetLastError();\nint nResult = 0;\nif (dwError &gt;= 12000 &amp;&amp; dwError &lt;= 12174)\n{\n    nResult = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_HMODULE, \n        GetModuleHandle(\"wininet.dll\"), dwError, 0, (LPTSTR)&amp;lpBuffer, 0, NULL);\n}\nelse\n{\n    nResult = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS, \n        NULL, dwError, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&amp;lpBuffer, 0, NULL);\n}\n</code></pre>\n\n<p>Does anyone have any ideas?</p>\n"}, {"tags": ["c", "linux", "x11", "multiscreen"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1533761609, "post_id": 51747548, "comment_id": 90470630, "body": "@jww Looks on topic to me."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1533762457, "post_id": 51747548, "comment_id": 90470942, "body": "@melpomene - I believe you are right. Sorry about that."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1533855213, "post_id": 51747548, "comment_id": 90511936, "body": "If by <i>&quot;configuration tool&quot;</i> you mean Xrandr, then <a href=\"https://cgit.freedesktop.org/xorg/app/xrandr/tree/xrandr.c\" rel=\"nofollow noreferrer\">it</a> just numbers them in the order they occur in the list returned by <code>XRRGetMonitors()</code>. Otherwise, have you checked if <code>xrandr --listmonitors</code> command lists your monitors in the same order your <i>&quot;configuration tool&quot;</i> numbers them? (Personally, I&#39;d use the monitor names available in the <code>name</code> Atom in the <code>XRRMonitorInfo</code> structures, to identify the displays.)"}, {"owner": {"reputation": 15836, "user_id": 1675492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HsMph.jpg?s=128&g=1", "display_name": "Ingo B&#252;rk", "link": "https://stackoverflow.com/users/1675492/ingo-b%c3%bcrk"}, "edited": false, "score": 0, "creation_date": 1533887520, "post_id": 51747548, "comment_id": 90520748, "body": "This sounds like an XY problem. Why do you need this number for your application?"}, {"owner": {"reputation": 31, "user_id": 1384721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5505d8e27be20eaf86b40c80b1c4d27b?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1384721/david"}, "edited": false, "score": 0, "creation_date": 1533893424, "post_id": 51747548, "comment_id": 90523864, "body": "I mean the GUI configuration tool in the computer settings.  My application works in conjunction with external tools and so there needs to be correlation between the screen layouts internally and externally, names of the screens are no good plus as all screens are the same model that doesn&#39;t help.   I have checked the order that the screens are listed and it is not related to the internal number in the GUI - that is the problem!!"}], "owner": {"reputation": 31, "user_id": 1384721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5505d8e27be20eaf86b40c80b1c4d27b?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1384721/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533762527, "creation_date": 1533733559, "last_edit_date": 1533762527, "question_id": 51747548, "link": "https://stackoverflow.com/questions/51747548/how-to-get-monitor-number-in-multi-display-configuration", "title": "How to get monitor number in multi display configuration", "body": "<p>When you configure a multi display setup in Linux you can place the monitors as you wish and a single desktop canvas is created.  In a very simple example I could place two monitors, each 1920x1200, side by side to create a 3840x1200 desktop.  </p>\n\n<p>The problem I have is that I could have placed:</p>\n\n<pre><code>  Monitor 1   Monitor 2\n</code></pre>\n\n<p>or </p>\n\n<pre><code>  Monitor 2   Monitor 1\n</code></pre>\n\n<p>I know the desktop size and I can use <code>XRRGetMonitors()</code> to get the position of each monitor but not the number that is used in the configuration tool and I need the id number for my application.  I am sure it is simple but I haven't found a way thus far.</p>\n\n<p>Can someone enlighten me please?</p>\n"}, {"tags": ["c++", "c", "sockets", "reverse-proxy", "epoll"], "answers": [{"tags": [], "owner": {"reputation": 777, "user_id": 2512648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c04945ef108aab5b093293dfe26584d?s=128&d=identicon&r=PG", "display_name": "Alexandre Pereira Nunes", "link": "https://stackoverflow.com/users/2512648/alexandre-pereira-nunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1533733866, "creation_date": 1533733866, "answer_id": 51747642, "question_id": 51747311, "link": "https://stackoverflow.com/questions/51747311/epoll-reverse-proxy-stuck-while-writing-client/51747642#51747642", "title": "Epoll reverse proxy stuck while writing client", "body": "<p>Assuming your headerParse() method doesn't change buffer in a size-extending way (you'd need to update readsize, at least, not to mention the buffer full scenario), it seems like your write() path is broken.</p>\n\n<p>if the socket you're writing to is also in nonblocking mode, it's perfectly legal for write() to return -1 (and set errno to EGAIN or EWOULDBLOCK or whatever your platform has) before you wrote all data. \nIn that case, you must store the remaining data (the remainder of buffer minus what was written if one or more calls to write() succeeded), program epoll to notify the clientHandler->getFd() descriptor for writeability, if not already, and when you get subsequent \"write ready\" event, you write the data you stored. On this case, the write() can again be unable to flush all your data, so you must cycle until all data is sent.</p>\n"}], "owner": {"reputation": 1, "user_id": 10196413, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ok3EBN8YfAY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rxJGgwSsol3od9fy5DZzQmpfyx0g/mo/photo.jpg?sz=128", "display_name": "Mustafa &#199;al\u0131\u015f", "link": "https://stackoverflow.com/users/10196413/mustafa-%c3%87al%c4%b1%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533733982, "creation_date": 1533732874, "last_edit_date": 1533733982, "question_id": 51747311, "link": "https://stackoverflow.com/questions/51747311/epoll-reverse-proxy-stuck-while-writing-client", "title": "Epoll reverse proxy stuck while writing client", "body": "<p>I am trying to write reverse proxy with nonblocking socket and epoll. That seems ok at first, but when I tried to open a big jpg file, I got stuck. \nWhen I try to write into client sometimes It may not writable and how can I handle proper way.</p>\n\n<p>Additional Notes:</p>\n\n<pre><code>this-&gt;getFd() = ProxyFd\nthis-&gt;clientHandler-&gt;getFd = clientFd\n</code></pre>\n\n<p>I am using <code>EPOLLET</code> flag both proxy and client</p>\n\n<pre><code>   if( (flag &amp; EPOLLIN) ){\n        char buffer[1025] = {'\\0'};\n        int readSize;\n        while( (readSize = read(this-&gt;getFd(),buffer,1024)) &gt; 0){\n            this-&gt;headerParse(buffer);\n            this-&gt;readSize += readSize;\n            int check = 0;\n            do{\n                check = write(this-&gt;clientHandler-&gt;getFd(),buffer,readSize);\n            }while(check &lt; 0);\n\n        }\n        if(this-&gt;headerEnd == 1 &amp;&amp; this-&gt;readSize &gt;= this-&gt;headerLenght  ){\n            close(this-&gt;clientHandler-&gt;getFd());\n            close(this-&gt;getFd());\n            delete this-&gt;clientHandler;\n            delete this;\n        } \n    }\n</code></pre>\n\n<p>Thanks for taking time to read.</p>\n"}, {"tags": ["c", "gcc", "c11", "noreturn"], "comments": [{"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533733323, "post_id": 51746897, "comment_id": 90454581, "body": "In this specific case the function really never returns to the caller so there should be no UB. Thank you for the link, it does give me some extra info. Maybe another option (not preferable) would be to remove all <code>_Noreturn</code> keywords but then C shouldn&#39;t have added it in the first place, right?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 2, "creation_date": 1533733460, "post_id": 51746897, "comment_id": 90454683, "body": "@Clonk That question is about an attribute, not the standard function specifier. Actually a non-<code>void</code> <code>_Noreturn</code> function does not make sense."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533733594, "post_id": 51746897, "comment_id": 90454751, "body": "A workaround is to use a typedef as in: <code>typedef _Noreturn void (*somenoreturnfunctype)(bool); struct s {      somenoreturnfunctype somenoreturnfunc; } svar;</code>"}, {"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533734094, "post_id": 51746897, "comment_id": 90455097, "body": "@Frankie_C it does indeed compile but leaves a warning <code>typedef &#39;..&#39; declared &#39;_Noreturn&#39;</code>, does this mean that _Noreturn is discarded  from the typedef or is it just a heads up to the developer meaning &#39;Hey maybe you don&#39;t mean this&#39;?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533734676, "post_id": 51746897, "comment_id": 90455483, "body": "@Frankie_C <code>typedef _Noreturn void (*somenoreturnfunctype)(bool);</code> is incorrect in ISO C"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533734983, "post_id": 51746897, "comment_id": 90455693, "body": "Typedefs, opposed to the function pointer specification, accept function specifiers, even if they have no effect. That&#39;s not an error, but the specifier is ignored (you should get this warning &#39;specifier ignored&#39;). The real point is that the _Noreturn qualification makes no sense when creating a pointer to a function."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533735020, "post_id": 51746897, "comment_id": 90455723, "body": "@Frankie_C You are wrong,  it is clearly specified in section 6.7.4/2  of the Standard that they do not (as explained in the answers below)"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533735679, "post_id": 51746897, "comment_id": 90456185, "body": "@M.M The standard says in the section about function specifiers that the <b>shall be used only in declaration of identifiers of functions</b>. But no direct prohibition is made in typedef constraints. So almost all compilers, maybe precautionally,  don&#39;t flag an error, but warns about, and the specifier is ignored. I haven&#39;t met yet a compiler that behaves differently."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1533735764, "post_id": 51746897, "comment_id": 90456245, "body": "@Frankie_C &quot;shall be used only in X&quot; means that it is prohibited in any cases other than X"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533737667, "post_id": 51746897, "comment_id": 90457540, "body": "@M.M I agree with you, the standard is clear in function declaration semantic. What I point out is that anyway compilers tolerate it."}], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "edited": false, "score": 0, "creation_date": 1533734225, "post_id": 51747718, "comment_id": 90455196, "body": "Ah didn&#39;t know that it couldn&#39;t be used like that!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1533735943, "post_id": 51747718, "comment_id": 90456373, "body": "That would add just another indirection without any benefit/&quot;type&quot;safety. I don&#39;t doubt what you wrote (now), but the initial idea of <code>_Noreturn</code> was to allow the caller to optimise its code (e.g. saving registers before/cleanup after, etc.) around the call. Not allowing the specifier for pointers makes this much less useful. Seems like the C standard needs a major overhaul not only structural, but also wrt. grouping type &quot;modifiers&quot;."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533736458, "post_id": 51747718, "comment_id": 90456718, "body": "@toohonestforthissite the main idea of <code>_Noreturn</code> is to allow the compiler to optimize; which it can do if my function is used.  I agree that they could look into making it a part of the function&#39;s type (and therefore, usable in a function pointer etc.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533736685, "post_id": 51747718, "comment_id": 90456867, "body": "@M.M: I think the main problem is they tgry to fit all newer features into the old, legacy cathegories. It didn&#39;t work well for <code>typedef</code> already and becomes more and more problematic. It would have been good they had taken the time without adding new features to resolve all these &quot;flaws&quot;, but if I understand it right, nothing much has changed."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533801333, "post_id": 51747718, "comment_id": 90482125, "body": "@toohonestforthissite, no the problem here is backwards compatibility, I think. If you want to be able to add annotations like this to existing interfaces, eg <code>exit</code>, you don&#39;t want them to conflict with other declarations that user code may already have laying around. API changes in C library interfaces are quite difficult to handle."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1533812544, "post_id": 51747718, "comment_id": 90489087, "body": "@JensGustedt: How could a new keyword change existing APIs which can&#39;t have used it apparently? And now, allowing it for function pointers also does not change them, because they also could not have used it for them. No, C has an increasing problem with inconsistencies by the inflexible semanitc of type/identifier &quot;modifiers&quot;. which don&#39;t really fit into the &quot;specifier&quot;/&quot;qualifier&quot;/\u2026 scheme. It&#39;s a problem of the complexity. Finally: breaking the compatibility with legacy code is a high time in some places. There are precedences: VLAs/FAMs, <code>x % y</code>, etc."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533835959, "post_id": 51747718, "comment_id": 90504523, "body": "@toohonestforthissite: A major problem the C Standards have always had is that they favor simplicity of description over usefulness of semantics.  None of the compilers I&#39;ve used that predated C89 had any trouble parsing <code>0x1E-1</code> as equivalent to <code>0x1E -1</code> (with a white space between the <code>E</code> and the <code>1</code> ), but C89 demands that compilers treat 0x1E-1 as one pp-number token, and thus disallow its use within expressions, because that makes the description of pp-number slightly easier.  If a construct would have useful meaning and can be easily supported it, forbidding merely to simplify..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1533836342, "post_id": 51747718, "comment_id": 90504694, "body": "...a description of the language puts the cart before the horse.  Another issue is that the Standard fails to recognize that certain <i>concepts</i> are useful in many implementations, even if the details vary.  For example, while many systems use have a uniform address space and a single calling convention, but many others could benefit from a syntax to indicate that an object, function, or pointer target should be placed in an address space designated by an target-platform-dependent string, or that a function should be called in a way likewise designated.  If three vendors each produce..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1533836505, "post_id": 51747718, "comment_id": 90504796, "body": "...an implementation for a particular target platform that documents various named address spaces or conventions, having the Standard specify a syntax for supplying the strings, but letting the implementation specify the meaning (typically adopting the same meaning as the platform) would avoid the need for programmers to manually accommodate every vendor/platform combination."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 5, "last_activity_date": 1533735406, "last_edit_date": 1533735406, "creation_date": 1533734096, "answer_id": 51747718, "question_id": 51746897, "link": "https://stackoverflow.com/questions/51746897/noreturn-in-a-struct-in-c-error-expected-specifier-qualifier-list-before-no/51747718#51747718", "title": "_Noreturn in a struct in c: error: expected specifier-qualifier-list before &#39;_Noreturn&#39;", "body": "<p>In ISO C, <code>_Noreturn</code> cannot be used on the declaration of a function pointer.  It can only be used on the declaration of a function. (Ref: C11 6.7.4/2).</p>\n\n<p>You will have to abandon this idea.  The function specifiers (<code>inline</code> and <code>_Noreturn</code>) are not part of a function's type.</p>\n\n<p>There is another problem in your code: you define <code>svar</code> in the header, this will cause an ODR violation if the header is included in two or more translation units. It should only have a declaration in the header, and a definition in one unit.</p>\n\n<hr>\n\n<p>To call through the function pointer and retain <code>_Noreturn</code> semantics , perhaps you could make a shim, e.g.:</p>\n\n<pre><code>inline _Noreturn void call_somefunc( struct s *ps, bool b )\n{\n    ps-&gt;somenoreturnfunc(b);\n}\n</code></pre>\n\n<p>but there is no way to have the compiler enforce that when you assign to the function pointer, it is actually a <code>_Noreturn</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533734686, "post_id": 51747726, "comment_id": 90455486, "body": "C17 is still not standard (and the question explicitly mentions it&#39;s using C11). Standard is C11, so we have to look this up. C11 does not state anything against the usage of this specifier. I agree, for <code>inline</code> it does not make sense to declare a pointer, simply because it&#39;s contrary to what <code>inline</code> implies. But for <code>_Noreturn</code> it can make sense for the calle to optimise the code (that&#39;s what it was added for, e.g. omitting the jump over an <code>else</code> branch)  Strange behaviour."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1533734843, "post_id": 51747726, "comment_id": 90455603, "body": "@toohonestforthissite C17 is standard, <a href=\"https://www.iso.org/standard/74528.html\" rel=\"nofollow noreferrer\">you can buy it from ISO</a>. Also, this is difficult to figure out, but C11 6.7.4 is the C11 equivalent of C17 6.7.4. (And the text is the same in both)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533735516, "post_id": 51747726, "comment_id": 90456081, "body": "@M.M: Thanks, I wasn&#39;t aware it exiss. Ok, from what I now read, it does not include new/different features, but only corections/fixes to C11. That makes me wonder even more why they didn&#39;t change this in C17 for <code>_Noreturn</code>. From my view it&#39;s exactly to tell the caller it can do optimisations around the call and that&#39;s valid for direct calls as well as via pointers (i.e. pointer declarations). To me it seem <code>_Noreturn</code> still has to make it&#39;s way properly into the language;  right now it&#39;s more of hack to treat it the same as <code>inline</code>. \u2026"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533735532, "post_id": 51747726, "comment_id": 90456090, "body": "@M.M \u2026 Or they just forgot about function pointers (not the first obvious and long-term defect, see <code>volatile</code>). Looks like the &quot;calssic&quot; cathegories <code>specifier</code>, etc. are not sufficient anymore; <code>typedef</code> is another example."}], "tags": [], "owner": {"reputation": 1476, "user_id": 538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ab054203c7f091fb770b8fdc75b953?s=128&d=identicon&r=PG", "display_name": "dpi", "link": "https://stackoverflow.com/users/538994/dpi"}, "is_accepted": false, "score": 2, "last_activity_date": 1533734128, "creation_date": 1533734128, "answer_id": 51747726, "question_id": 51746897, "link": "https://stackoverflow.com/questions/51746897/noreturn-in-a-struct-in-c-error-expected-specifier-qualifier-list-before-no/51747726#51747726", "title": "_Noreturn in a struct in c: error: expected specifier-qualifier-list before &#39;_Noreturn&#39;", "body": "<p>The function specifiers <code>_Noreturn</code> and <code>inline</code> are not part of the type of a function, they are part of the declaration. And the C17 standard states in 6.7.4 that function specifiers \"shall be used only in the declaration of an identifier for a function.\" This means they cannot be used in the in the declaration of a <em>pointer</em> to a function.</p>\n\n<p>So unfortunately this is not possible; a typedef won't help either.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533812909, "post_id": 51749311, "comment_id": 90489324, "body": "1) It&#39;s not a requirement (that would be &quot;shall&quot;, not &quot;should&quot;. Likely because an implementation can&#39;t always detect if a function returns or not (halting problem). 2) <code>_Noreturn</code> has the purpose to allow the caller do optimisations around the call. 3) Yes, that&#39;s a defect in that standard steming from the legacy cathegories wnd not having well thought about this particular keyword. It&#39;s because <code>_Noreturn</code> as well as <code>inline</code> don&#39;t apply to the function (type), but the identifier, i.e. name. 4) No, a compiler cannot see it as part of the type, because that would make it non-compliant."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1533738813, "creation_date": 1533738813, "answer_id": 51749311, "question_id": 51746897, "link": "https://stackoverflow.com/questions/51746897/noreturn-in-a-struct-in-c-error-expected-specifier-qualifier-list-before-no/51749311#51749311", "title": "_Noreturn in a struct in c: error: expected specifier-qualifier-list before &#39;_Noreturn&#39;", "body": "<p>Many good answers already, but for clarity I would like to ad the following:</p>\n\n<p>From C11, 6.7.4.9:</p>\n\n<blockquote>\n  <p>The implementation should produce a diagnostic message for a function declared with a _Noreturn function specifier that appears to be capable of returning to its caller.</p>\n</blockquote>\n\n<p>So _Noreturn has the purpose of informing the compiler to check there is no control path in the function declared as _Noreturn where it actually returns.</p>\n\n<p>Knowing this, it is now clear why you cannot declare a function pointer to be _Noreturn because the compiler cannot check the return semantics of the function assigned.</p>\n\n<p>(Of course, a compiler could see _Noreturn as part of the type and then check that only _Noreturn functions are assigned to the function pointer. The current definition in the standard seems a bit useless to me.)</p>\n"}], "owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 51747718, "answer_count": 3, "score": 4, "last_activity_date": 1533826185, "creation_date": 1533731659, "last_edit_date": 1533734373, "question_id": 51746897, "link": "https://stackoverflow.com/questions/51746897/noreturn-in-a-struct-in-c-error-expected-specifier-qualifier-list-before-no", "title": "_Noreturn in a struct in c: error: expected specifier-qualifier-list before &#39;_Noreturn&#39;", "body": "<p>I am trying to compile a piece of code that contains _Noreturn:</p>\n\n<pre><code>#ifndef SOMEHEADER_H\n#define SOMEHEADER_H\n\n#include &lt;stdalign.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n\nextern struct s {\n\n    _Noreturn void (*somenoreturnfunc)(bool);\n} svar;\n\n#endif\n</code></pre>\n\n<p>Which gives me:</p>\n\n<p><code>error: expected specifier-qualifier-list before '_Noreturn'</code> on:\n<code>_Noreturn void (*somenoreturnfunc)(bool);</code></p>\n\n<p>So I tried the suggestion from <a href=\"https://stackoverflow.com/questions/28552467/is-there-a-way-to-use-gcc-attribute-noreturn-and-stdnoreturn-h-sanely-i\">here</a>:</p>\n\n<pre><code>#ifndef SOMEHEADER_H\n#define SOMEHEADER_H\n\n#include &lt;stdalign.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n\n#include \"noreturn.h\"\n\nextern struct s {\n\n    noreturn void (*somenoreturnfunc)(bool);\n} svar;\n\n#endif\n</code></pre>\n\n<p>noreturn.h:</p>\n\n<pre><code>#ifndef NO_RETURN_H\n#define NO_RETURN_H\n#if defined(__STDC_VERSION__) &amp;&amp; __STDC_VERSION__ &gt;= 201112L\n#define noreturn _Noreturn\n#elif defined(__GNUC__)\n#define noreturn __attribute__((noreturn))\n#else\n#define noreturn\n#endif\n#endif\n</code></pre>\n\n<p>But the error still happens:</p>\n\n<pre><code>In file included from ../include/someinclude.h:8:0,\n                 from src/main.c:17:\n../include/noreturn.h:4:18: error: expected specifier-qualifier-list before '_Noreturn'\n #define noreturn _Noreturn\n                  ^\n../include/someinclude.h:19:5: note: in expansion of macro 'noreturn'\n     noreturn void (*somenoreturnfunc)(bool);\n     ^\n</code></pre>\n\n<p>I am baffled because it is compiled with c11 so it should work:</p>\n\n<pre><code>make V=1\ncc src/main.c\narm-none-eabi-gcc -mcpu=cortex-m3 -mthumb -std=c11 -Wall -pedantic -ffreestanding -static -I../libopencm3/include -I../include -DSTM32F1 -g -DDEBUG -DBUILD_STYLE=\\\"DEBUG\\\" -O0 -Iinclude -I../librt/include  -MMD -MT build/main.o -MF build/main.d -o build/main.o -c src/main.c\nIn file included...\n</code></pre>\n\n<p>GCC version is 5.4.1:</p>\n\n<pre><code>arm-none-eabi-gcc --version\narm-none-eabi-gcc (15:5.4.1+svn241155-1) 5.4.1 20160919\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>which should support all C11 features (_Noreturn is supported <a href=\"https://gcc.gnu.org/wiki/C11Status\" rel=\"nofollow noreferrer\">since 4.7</a>).</p>\n\n<p>What am I doing wrong and how could I resolve this error?</p>\n\n<p>--<br>\nEdit: Maybe a self contained example can help:</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdalign.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n\nstruct s {\n\n    _Noreturn void (*somenoreturnfunc)(bool);\n} svar;\n\nint main()\n{\n        svar.somenoreturnfunc = 0;\n        return 0;\n}\n</code></pre>\n\n<p>Compiling this:</p>\n\n<pre><code>arm-none-eabi-gcc -mcpu=cortex-m3 -mthumb -std=c11 -Wall -pedantic -ffreestanding -static -DSTM32F1 -g -DDEBUG -DBUILD_STYLE=\\\"DEBUG\\\" -O0 -MMD -MT main.o -MF main.d -o main.o -c main.c\nmain.c:7:5: error: expected specifier-qualifier-list before '_Noreturn'\n     _Noreturn void (*somenoreturnfunc)(bool);\n     ^\nmain.c:5:8: warning: struct has no members [-Wpedantic]\n struct s {\n        ^\nmain.c: In function 'main':\nmain.c:12:6: error: 'struct s' has no member named 'somenoreturnfunc'\n  svar.somenoreturnfunc = 0;\n      ^\n</code></pre>\n\n<p>Yet when compiling with the same command line and removing <code>_Noreturn</code> the compilation succeeds.</p>\n\n<p>This also happens when compiling with\n<code>gcc -std=c11 -o main main.c</code>:</p>\n\n<pre><code>$ gcc -std=c11 -o main main.c\nmain.c:7:5: error: expected specifier-qualifier-list before \u2018_Noreturn\u2019\n     _Noreturn void (*somenoreturnfunc)(bool);\n     ^~~~~~~~~\nmain.c: In function \u2018main\u2019:\nmain.c:12:6: error: \u2018struct s\u2019 has no member named \u2018somenoreturnfunc\u2019\n  svar.somenoreturnfunc = 0;\n      ^\n$ gcc --version\ngcc (Debian 6.3.0-18+deb9u1) 6.3.0 20170516\nCopyright (C) 2016 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n"}, {"tags": ["c", "double", "real-number"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1533732050, "post_id": 51746892, "comment_id": 90453687, "body": "In the loop: <code>ergebnis = file_buf[inhalt + i];</code> just assigns over and over again to <code>ergebnis</code>. It does not convert the byte array to a double."}, {"owner": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "edited": false, "score": 0, "creation_date": 1533732069, "post_id": 51746892, "comment_id": 90453708, "body": "You might want to use English names for identifiers. That would make understanding your code easier for non-German speakers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533732200, "post_id": 51746892, "comment_id": 90453806, "body": "FAQ: <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">What is the strict aliasing rule?</a>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533734709, "post_id": 51746892, "comment_id": 90455503, "body": "Try this one: <code>resdouble = (double)*&amp;file_buf[content];</code> =&gt; <code>resdouble = *(double*)&amp;file_buf[content];</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10197522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58f7d4957e44db6d06e9c280c57a04c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumsum", "link": "https://stackoverflow.com/users/10197522/sumsum"}, "edited": false, "score": 0, "creation_date": 1533734107, "post_id": 51747124, "comment_id": 90455102, "body": "Thankyou for your answer.  Yes, your solution is the better way for the control output for the HEX value. But this is not my problem, My problem is the wrong real value in the resdouble."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1533732542, "last_edit_date": 1533732542, "creation_date": 1533732354, "answer_id": 51747124, "question_id": 51746892, "link": "https://stackoverflow.com/questions/51746892/read-from-byte-array-and-convert-to-double/51747124#51747124", "title": "Read from Byte Array and convert to Double", "body": "<p>You must cast <code>ergebnis</code> to a byte aray and then fill each byte. Once done, you have your uint64. For example:</p>\n\n<pre><code>union {\n    unsigned char b[8];\n    uint64_t d;\n} ergebnis;\n\nfor (int i = 0; i &lt; 8; i++){\n    ergebnis.b[i] = file_buf[inhalt + i];\n}\nwsprintf(Ausgabebuf + i*2, L\"%02X\", ergebnis.d);\n</code></pre>\n\n<p>Also note the \"endianness\" of your system, or you may have to invert the loop</p>\n"}], "owner": {"reputation": 3, "user_id": 10197522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58f7d4957e44db6d06e9c280c57a04c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumsum", "link": "https://stackoverflow.com/users/10197522/sumsum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533736206, "creation_date": 1533731649, "last_edit_date": 1533736206, "question_id": 51746892, "link": "https://stackoverflow.com/questions/51746892/read-from-byte-array-and-convert-to-double", "title": "Read from Byte Array and convert to Double", "body": "<p>I'm just trying to get an 8 BYTE REAL floating-point number from a BYTE array, which I've previously generated from the contents of a file, as a floating-point number.</p>\n\n<p>At the moment I know that an 8 BYTE Real is the same as a double. Therefore, it would have to be logically possible to read out the 8 bytes and assign them directly to the variable.\nUnfortunately it does not work as I imagine.</p>\n\n<p>As an illustration:</p>\n\n<p>My Byte Array Array for control output of the HEX value stored in the file.</p>\n\n<pre><code>uint64_t result = 0;\nfor (int i = 0; i &lt; 8; i++){\nresult = file_buf[content + i];\nwsprintf(Outbuf + i*2, L\"%02X\", result);\nOutputMessage(Outbuf, 0);\n}\n</code></pre>\n\n<p>Returns the correct Hex value from the file in the output</p>\n\n<pre><code>C1D6D420937EE766\n</code></pre>\n\n<p>wsprintf has to use it because I use an API work and rely on a whitecharbuffer.</p>\n\n<p>So far I have tried the following:</p>\n\n<pre><code>resdouble =  (double)*&amp;file_buf[content];\nswprintf(Outbuf, 200, L\" Typ: REAL (8-byte): %Lf\\n\", resdouble);\nOutputMessage(Outbuf, 0);\n</code></pre>\n\n<p>Outpout:</p>\n\n<pre><code>Typ: REAL (8-byte): 193,000000\n</code></pre>\n\n<p>An other try:</p>\n\n<pre><code>result = file_buf[content]&lt;&lt;24;\nresult = result + (file_buf[content + 1] &lt;&lt; 16);\nresult = result + (file_buf[content + 2] &lt;&lt; 8);\nresult = result + ((file_buf[content + 3]));\nresult = result &lt;&lt; 32;\nresult = result + (file_buf[content + 4] &lt;&lt; 24);\nresult = result + (file_buf[content + 5] &lt;&lt; 16);\nresult = result + (file_buf[content + 6] &lt;&lt; 8);\nresult = result + (file_buf[content + 7]);\n\nmemcpy(&amp;resdouble, &amp;result, 8);\nwsprintf(Outbuf, L\"HEX Result 8 Byte %16X\", resdouble);\nOutputMessage(Outbuf, 0);\nswprintf(Outbuf, 200, L\" Typ: REAL (8-byte): %Lf\\n\", resdouble);\nOutputMessage(Outbuf, 0);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>HEX Result 8 Byte         937EE766\nTyp: REAL (8-byte): -1532001869,982873\n</code></pre>\n\n<p>Right result from page: \n<a href=\"http://www.binaryconvert.com/result_double.html?hexadecimal=C1D6D420937EE766\" rel=\"nofollow noreferrer\">http://www.binaryconvert.com/result_double.html?hexadecimal=C1D6D420937EE766</a></p>\n\n<p>but would have to come out -1,532002893982.\nThe comma is calculated incorrectly.</p>\n\n<p>Why do I get out the wrong double number and what do I have to do to get the result -1,532001 and not -1532001869,982873 ?</p>\n\n<p>EDIT:\nI try this from @ Gerhardh</p>\n\n<pre><code>(double)(*&amp;file_buf[content]);\nresdouble = *(double*)&amp;file_buf[content];\nswprintf(Outbuf, 200, L\"Typ: REAL:\\t%f\\n\", resdouble);\nOutputMessage(Outbuf, 0);\nswprintf(Outbuf, 200, L\" Typ: HEX (8-byte): %X\\n\", resdouble);\nOutputMessage(Outbuf, 0);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Typ: REAL:  5111310630843501598.......... \nDatentyp: HEX (8-byte): 20D4D6C1\n</code></pre>\n\n<p>with byteswap in the first line</p>\n\n<pre><code>_byteswap_uint64(file_buf[content]);\n</code></pre>\n\n<p>i have the same result.</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533731771, "post_id": 51746479, "comment_id": 90453485, "body": "You have the wrong function signature. <code>void* func1()</code> should be <code>void* func1(void*)</code>. And in pthread_create you call the function instead of passing the address to the function."}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1533736395, "post_id": 51746882, "comment_id": 90456670, "body": "Unlike C++, C (up to C11, at least) requires parameters to have names.  So just give them names: <code>void* func1(void *unused)</code>, etc.  That will reduce the error to a mere warning."}], "tags": [], "owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "is_accepted": true, "score": 2, "last_activity_date": 1533731580, "creation_date": 1533731580, "answer_id": 51746882, "question_id": 51746479, "link": "https://stackoverflow.com/questions/51746479/create-multiple-threads-in-two-infinite-loops-simultaneously/51746882#51746882", "title": "create multiple threads in two infinite loops simultaneously", "body": "<p>First of, your program does not compile on my machine unless I fix some of the issues. Most notably, you need to pass the function not call the function, so you must remove the parenthesis after <code>func1</code> and <code>func2</code> in the <code>pthread_create</code> calls. A working version of the code that doesn't produce any errors/warnings (just some types that are irrelevant in this case, but in general pthreads seem to want everything to be <code>void*</code>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid* func1(void*) {\n  while (1) {\n    printf(\"%s\\n\", \"func1\");\n    sleep(2);\n  }\n}\n\nvoid* func2(void*) {\n  while (1) {\n    printf(\"%s\\n\", \"func2\");\n    sleep(2);\n  }\n}\n\nint main()\n{\n  pthread_t thread_id;\n  pthread_t thread_id2;\n  pthread_create(&amp;thread_id, NULL, func1, NULL);\n  pthread_create(&amp;thread_id2, NULL, func2, NULL);\n  //sleep(60);\n  return 0;\n}\n</code></pre>\n\n<p>And now for your issue, as stated in the documentation (<a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/pthread_create.3.html</a>) all threads will exit if the main thread of the program exits - as it does in your case. </p>\n\n<p>So, your program (once we help it compile) <strong>does</strong> try to create a second thread, but there is some overhead associated with that and it never actually manages to print before <code>return 0;</code> is reached in <code>main</code>. This causes the program to exit and you never see the output of the second thread. A simple fix is to add another <code>sleep</code> command after you create the threads, this gives them enough time to print. </p>\n"}, {"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1533732694, "creation_date": 1533732694, "answer_id": 51747258, "question_id": 51746479, "link": "https://stackoverflow.com/questions/51746479/create-multiple-threads-in-two-infinite-loops-simultaneously/51747258#51747258", "title": "create multiple threads in two infinite loops simultaneously", "body": "<p>Also you need to init the thread attributes using pthread_attr_init also you tell main to wait until child thread finishes using pthread_join.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include&lt;errno.h&gt;\nvoid *func1(void *p) {\n  while (1) {\n    printf(\"%s\\n\", \"func1\");\n    sleep(2);\n  }\n}\n\nvoid *func2(void *p) {\n  while (1) {\n    printf(\"%s\\n\", \"func2\");\n    sleep(2);\n  }\n}\n\nint main()\n{\n  pthread_attr_t attr;\n  pthread_t thread_id;\n  pthread_t thread_id2;\n  pthread_attr_init(&amp;attr);\n\n  pthread_create(&amp;thread_id, &amp;attr, &amp;func1, NULL);\n  pthread_create(&amp;thread_id2, &amp;attr, &amp;func2, NULL);\n  pthread_join(thread_id,NULL);\n  pthread_join(thread_id2,NULL);\n\n\n  //sleep(60);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8709549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d0b3d5ea8e6c18bf906cc804e04c04?s=128&d=identicon&r=PG&f=1", "display_name": "Marc C", "link": "https://stackoverflow.com/users/8709549/marc-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "accepted_answer_id": 51746882, "answer_count": 2, "score": -2, "last_activity_date": 1533732694, "creation_date": 1533730422, "question_id": 51746479, "link": "https://stackoverflow.com/questions/51746479/create-multiple-threads-in-two-infinite-loops-simultaneously", "title": "create multiple threads in two infinite loops simultaneously", "body": "<p>I'm learning C and pthread library but I have a problem starting two threads in functions with an infinite loop.</p>\n\n<p>The second pthread_create is never called.\nHow to create both threads?</p>\n\n<p>My code looks like</p>\n\n<pre><code>void* func1() {\n  while (1) {\n    printf(\"%s\\n\", \"func1\");\n    sleep(2);\n  }\n}\nvoid* func2() {\n  while (1) {\n    printf(\"%s\\n\", \"func2\");\n    sleep(2);\n  }\n}\n\nint main()\n{\n  pthread_t thread_id;\n  pthread_t thread_id2;\n  pthread_create(&amp;thread_id, NULL, func1(), NULL);\n  pthread_create(&amp;thread_id2, NULL, func2(), NULL);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1533732870, "post_id": 51746137, "comment_id": 90454234, "body": "Out of curiosity, where is <code>sint32</code> defined on your system?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1533821671, "post_id": 51746137, "comment_id": 90495579, "body": "Thank you for the additional information, it helps to see what you are attempting.  I did run your code, and for each static run (i.e. with only one definition of <code>LookupTable</code> uncommented, it works.  As written, <code>LookupTable</code> is being treated as a static 2D array.  It is fully defined at compile time.  If attempting to define it at runtime, it will be treated as a variable length array, so it cannot be defined using <code>static</code> storage duration, nor can it be initialized...."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1533822277, "post_id": 51746137, "comment_id": 90496027, "body": "... for this reason, using a macro with an argument, which is useful in many cases, is not going to help here, i.e. to be used as a <i>variable</i> value in the first index of <code>LookupTable[ROW_SIZE(i)][COL_SIZE]</code>.  How flexible are you toward looking at alternative methods?"}, {"owner": {"reputation": 87, "user_id": 9756838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i82D5.png?s=128&g=1", "display_name": "scoobydoo", "link": "https://stackoverflow.com/users/9756838/scoobydoo"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1533888678, "post_id": 51746137, "comment_id": 90521378, "body": "@ryyker any alternate method will do as I couldn&#39;t find anything useful till now."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1533908574, "post_id": 51746137, "comment_id": 90532970, "body": "See <b><i>Edit</i></b> <i>to address request in comments:</i> in my post below."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1533732573, "post_id": 51746233, "comment_id": 90454029, "body": "Down voter, if is there something I can do to address the problem please point it out."}, {"owner": {"reputation": 87, "user_id": 9756838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i82D5.png?s=128&g=1", "display_name": "scoobydoo", "link": "https://stackoverflow.com/users/9756838/scoobydoo"}, "edited": false, "score": 0, "creation_date": 1533738215, "post_id": 51746233, "comment_id": 90457933, "body": "x value in my program is coming from another source file and if I try to implement this, I&#39;m getting an error message <b>&#39;storage size of LookupTable isn&#39;t constant&#39;</b>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 87, "user_id": 9756838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i82D5.png?s=128&g=1", "display_name": "scoobydoo", "link": "https://stackoverflow.com/users/9756838/scoobydoo"}, "edited": false, "score": 0, "creation_date": 1533741310, "post_id": 51746233, "comment_id": 90460105, "body": "@Shannon - Can you please edit your post to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, showing examples of the relevant sections of your code, and include the exact wording of any error messages, and where they occur in the code examples.  I am being pulled away from my desk frequently this morning, but will respond as I am able to."}, {"owner": {"reputation": 87, "user_id": 9756838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i82D5.png?s=128&g=1", "display_name": "scoobydoo", "link": "https://stackoverflow.com/users/9756838/scoobydoo"}, "edited": false, "score": 0, "creation_date": 1533810458, "post_id": 51746233, "comment_id": 90487821, "body": "I have edited the question as requested and added a working example code."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 2, "last_activity_date": 1534162398, "last_edit_date": 1534162398, "creation_date": 1533729731, "answer_id": 51746233, "question_id": 51746137, "link": "https://stackoverflow.com/questions/51746137/auto-select-lookup-tables-based-on-input-parameter/51746233#51746233", "title": "Auto select lookup tables based on input parameter", "body": "<p>As is, both of your macros are only definable before run-time.  i.e. at compile-time, the value that defines your macro is locked in.  </p>\n\n<p>For your macro to produce a <em>variable</em> value, change:</p>\n\n<pre><code>#define ROW_SIZE    250     //&lt;! 25 x parameter (where parameter = {10,15,20,25,...,100})\n</code></pre>\n\n<p>To: </p>\n\n<pre><code>#define ROW_SIZE(x)    25*(x)     //&lt;! 25 x parameter (where parameter = {10,15,20,25,...,100})\n</code></pre>\n\n<p>Then in the calling code, <code>x</code> should be defined in scope of where the macro is called.  In this example, <code>x</code> is created as an <code>int [4]</code> array with automatic scope. It could be a global, or passed as a function argument, as long as it is defined:</p>\n\n<pre><code>int i, x[4]={10,15,20,25};\nfor(i=0;i&lt;4;i++)\n{\n    //select and use lookup\n    LookupTable[ROW_SIZE(x[i])][COL_SIZE];// Each iteration is expanded to\n                                          // LookupTable[25*x[i]][COL_SIZE];\n\n    ...\n</code></pre>\n\n<p>For more information, here is a <em><a href=\"https://gcc.gnu.org/onlinedocs/cpp/Macros.html\" rel=\"nofollow noreferrer\">C macros tutorial</a></em>.</p>\n\n<p><strong><em>Edit</em></strong> to address request in comments:</p>\n\n<blockquote>\n  <p>A lookup table is simply an initialized array that contains\n  precalculated information. They are typically used to avoid performing\n  complex (and hence time consuming) calculations.<br>\n  ...and more on tables <em><a href=\"https://embeddedgurus.com/stack-overflow/2010/01/a-tutorial-on-lookup-tables-in-c/\" rel=\"nofollow noreferrer\">From A tutorial on lookup tables in C</a></em>.</p>\n</blockquote>\n\n<p>With that in mind, there is too much I do not know about how <em>you</em> intend to use your lookup tables, but given the description of your needs, which includes tables of differing sizes, and the need to access them dynamically, the following illustrates one method where instead of #defines, the collection of tables is created using arrays of <code>static const int</code>, (varying sizes) and a pointer to an array: <code>int *[]</code>, where size == <em>count of tables in collection</em>, can be accessed simply by by normal array indexing.</p>\n\n<p>The following is implemented as described above, and demonstrates a method that can be used to <em>Auto select lookup tables based on input parameter.</em>  </p>\n\n<pre><code>// define in header file \n\n//replaces your #define tables\nstatic const int table1[1][2] = {1,2};\nstatic const int table2[2][2] = {{1,2},{3,4}};\nstatic const int table3[3][2] = {{1,2},{11,22},{3,4}};\nstatic const int table4[4][2] = {{1,2},{11,22},{21,31},{3,4}};\nstatic const int table5[5][2] = {{1,2},{10,20},{30,40},{50,60},{3,4}};\n\n#define MAX_TABLES 5\n\n//array of pointers to allow lookup table selection via array indexing.\n//( static scope necessary if table is used in more than one .c file )\nstatic int *table[MAX_TABLES] = {(int *)table1, (int *)table2, (int *)table3, (int *)table4, (int *)table5};\n\n\n// end - define in header file\n\nvoid access_table(int table);\n\nint main(void)\n{\n\n    int i;\n    for(i=0;i&lt;MAX_TABLES;i++)\n    {\n        access_table(i);//select lookup tables based on input parameter ( i )   \n    }\n    getchar();\n    return 0;\n\n}\n\nvoid access_table(int index) // view contents of the selected table\n{\n    //by definition all tables have rows  equal to table number and columns always == 2\n    int loops = 2*index+2;\n    int j;\n    for(j=0;j&lt;loops;j++)\n    {\n        printf(\"%d \", table[index][j]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Produces the following output:<br>\n<a href=\"https://i.stack.imgur.com/hoxdd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hoxdd.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 87, "user_id": 9756838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i82D5.png?s=128&g=1", "display_name": "scoobydoo", "link": "https://stackoverflow.com/users/9756838/scoobydoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 51746233, "answer_count": 1, "score": 0, "last_activity_date": 1534162398, "creation_date": 1533729452, "last_edit_date": 1533888383, "question_id": 51746137, "link": "https://stackoverflow.com/questions/51746137/auto-select-lookup-tables-based-on-input-parameter", "title": "Auto select lookup tables based on input parameter", "body": "<p>I am a C newbie, I have stored few look up Tables in the header file that need to be used in my C program.\nFor example, I'm using</p>\n\n<pre><code>static int LookupTable[ROW_SIZE][COL_SIZE] = FIRST_TABLE;\nstatic int LookupTable[ROW_SIZE][COL_SIZE] = SECOND_TABLE;\nstatic int LookupTable[ROW_SIZE][COL_SIZE] = THIRD_TABLE;\nstatic int LookupTable[ROW_SIZE][COL_SIZE] = FOURTH_TABLE;\n</code></pre>\n\n<p>I have defined macros for ROW_SIZE and COL_SIZE where the COL_SIZE is fixed and ROW_SIZE is variable.</p>\n\n<pre><code>#define COL_SIZE    2     \n#define ROW_SIZE    2       //&lt;! 1 x input (where input = {2,3,4,5})\n</code></pre>\n\n<p>I need to use the lookup tables based on the input value. That is, use:  </p>\n\n<ul>\n<li>FIRST_TABLE when input is 2 (so ROW_SIZE = 1 x 2 )</li>\n<li>SECOND_TABLE when input is 3 (so ROW_SIZE = 1 x 3)</li>\n<li>THIRD_TABLE when input is 4 (so ROW_SIZE = 1 x 4)</li>\n<li>FOURTH_TABLE when input is 5 (so ROW_SIZE = 1 x 5)</li>\n</ul>\n\n<p>Currently, I'm manually updating the ROW_SIZE everytime based on the input value and using the respective lookuptable as shown below.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define FIRST_TABLE \\\n{ \\\n{1,2},\\\n{3,4}\\\n}\n\n#define SECOND_TABLE \\\n{ \\\n{1,2},\\\n{11,22},\\\n{3,4}\\\n}\n\n#define THIRD_TABLE \\\n{ \\\n{1,2},\\\n{11,22},\\\n{21,31},\\\n{3,4}\\\n}\n\n#define FOURTH_TABLE \\\n{ \\\n{1,2},\\\n{10,20},\\\n{30,40},\\\n{50,60},\\\n{3,4}\\\n}\n\n\n#define ROW_SIZE    2       // 2-&gt;FIRST_TABLE, 3-&gt;SECOND_TABLE, 4-&gt; THIRD_TABLE, 5-&gt;FOURTH_TABLE\n#define COL_SIZE    2\nint main()\n{\n\n    static int LookupTable[ROW_SIZE][COL_SIZE] = FIRST_TABLE;\n    //static int LookupTable[ROW_SIZE][COL_SIZE] = SECOND_TABLE;\n    //static int LookupTable[ROW_SIZE][COL_SIZE] = THIRD_TABLE;\n    //static int LookupTable[ROW_SIZE][COL_SIZE] = FOURTH_TABLE;\n\n    int i,j;\n\n    for(i=0;i&lt;ROW_SIZE;i++)\n    {\n        for(j=0;j&lt;COL_SIZE;j++)\n        {\n            printf(\"%d\\t\",LookupTable[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Could someone please advise me on how I could define the ROW_SIZE and select the lookuptable automatically when the input value is known. For example, if input = 2, it should automatically choose ROW_SIZE = 2 and select FIRST_TABLE.\n<em>Please note that 'input' value is an external parameter coming from different source file.</em></p>\n"}, {"tags": ["c", "string-literals", "strcat"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 5, "creation_date": 1533729428, "post_id": 51746106, "comment_id": 90451885, "body": "Change <code>char a[] = &quot;Solaris&quot;;</code> to e.g. <code>char a[50] = &quot;Solaris&quot;;</code>, otherwise there won&#39;t be room for the appended string and you will get UB."}, {"owner": {"reputation": 904, "user_id": 2711402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f60d62777fda717173de19b2de003018?s=128&d=identicon&r=PG&f=1", "display_name": "Rndp13", "link": "https://stackoverflow.com/users/2711402/rndp13"}, "edited": false, "score": 0, "creation_date": 1533729530, "post_id": 51746106, "comment_id": 90451948, "body": "Thanks for your comments, basically aware of how to make the prog work, but was just looking for why is it behaving this way."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1533730833, "post_id": 51746106, "comment_id": 90452828, "body": "It&#39;s undefined behaviour, so it isn&#39;t behaving in a specific way. This time it trashed the value of <code>ptr</code> with &quot;inux&quot;. Next time it might cause your pets to explode. It&#39;s best to avoid writing code that doesn&#39;t work and focus on writing code that does work."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533733572, "post_id": 51746106, "comment_id": 90454743, "body": "Please only ask one question per post. Why a program behaves in a certain way is a totally different question than why does GDB show some output."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 2, "last_activity_date": 1533741074, "last_edit_date": 1533741074, "creation_date": 1533734462, "answer_id": 51747811, "question_id": 51746106, "link": "https://stackoverflow.com/questions/51746106/strcat-with-char-pointer-to-a-string-literal/51747811#51747811", "title": "strcat with char pointer to a string literal", "body": "<p>If I understand your question correct you are aware that the program has undefined behavior due to <code>a</code> not being able to hold the string \"Solaris\" concatenated with \"Linux\". </p>\n\n<p>So the answer your looking for is not \"This is undefined behavior\" but rather:</p>\n\n<blockquote>\n  <p>why is it behaving this way</p>\n</blockquote>\n\n<p>When dealing with Undefined behavior we can't give a general explanation of what's going on. It may do different things on different systems or different things for different compilers (or compiler versions) and so on.</p>\n\n<p>Therefore it's often said that it makes no sense to try to explain what is going on in a program with undefined behavior. And well - that's correct.</p>\n\n<p>However - sometimes you can find an explanation for your specific system - just remember that it is specific for your system and in no way universal.</p>\n\n<p>So I changed your code to add some debug print:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n    char *ptr = \"Linux\";\n    char a[] = \"Solaris\";\n    printf(\"   a = %p\\n\", (void*)a);\n    printf(\"&amp;ptr = %p\\n\", (void*)&amp;ptr);\n    printf(\" ptr = %p\\n\", (void*)ptr);\n\n    // Print the data that ptr holds\n    unsigned char* p = (unsigned char*)&amp;ptr;\n\n    printf(\"\\nBefore strcat\\n\");\n    printf(\"  a:\\n\");\n    for (int i = 0; i &lt; 8; ++i) printf(\"%02x \", *(a+i));\n    printf(\"\\n\");\n\n    printf(\"  ptr:\\n\");\n    for (int i = 0; i &lt; 8; ++i) printf(\"%02x \", *(p+i));\n    printf(\"\\n\");\n\n    strcat(a,ptr);\n\n    printf(\"\\nAfter strcat\\n\");\n    printf(\"  a:\\n\");\n    for (int i = 0; i &lt; 8; ++i) printf(\"%02x \", *(a+i));\n    printf(\"\\n\");\n\n    printf(\"  ptr:\\n\");\n    for (int i = 0; i &lt; 8; ++i) printf(\"%02x \", *(p+i));\n    printf(\"\\n\\n\");\n\n    printf(\"%s\\n\", a);\n\n    printf(\"%s\\n\", ptr);\n\n    return 0;\n}\n</code></pre>\n\n<p>On my system this generates:</p>\n\n<pre><code>   a = 0x7ffff3ce5050\n&amp;ptr = 0x7ffff3ce5058\n ptr = 0x400820\n\nBefore strcat\n  a:\n53 6f 6c 61 72 69 73 00\n  ptr:\n20 08 40 00 00 00 00 00\n\nAfter strcat\n  a:\n53 6f 6c 61 72 69 73 4c\n  ptr:\n69 6e 75 78 00 00 00 00\n\nSolarisLinux\nSegmentation fault\n</code></pre>\n\n<p>Here the output is with some comments added:</p>\n\n<pre><code>   a = 0x7ffff3ce5050   // The address where the array a istored\n&amp;ptr = 0x7ffff3ce5058   // The address where ptr is stored. Notice 8 higher than a\n ptr = 0x400820         // The value of ptr\n\nBefore strcat\n  a:\n53 6f 6c 61 72 69 73 00 // Hex dump of a gives Solaris\\0\n  ptr:\n20 08 40 00 00 00 00 00 // Hex dump of ptr is the value 0x0000000000400820 (little endian system)\n\n// Here strcat is executed\n\nAfter strcat\n  a:\n53 6f 6c 61 72 69 73 4c // Hex dump of a gives SolarisL\n  ptr:\n69 6e 75 78 00 00 00 00 // Ups.. ptr has changed! It's not a valid pointer value anymore\n                        // As a string it is inux\\0\n\nSolarisLinux            // print a\nSegmentation fault      // print ptr crashes because ptr doesn't hold a valid pointer value\n</code></pre>\n\n<p>So on my system the explanation is:</p>\n\n<p><code>a</code> is located in memory just before <code>ptr</code> so when <code>strcat</code> write out of bounds of <code>a</code> it actually overwrites the value of <code>ptr</code>. Consequently the program crashes when trying to use <code>ptr</code> as a valid pointer.</p>\n\n<p>So for your specific questions:</p>\n\n<blockquote>\n  <p>1)Does strcat removes the string literal from the original location, as accessing ptr gives a segmentation fault.</p>\n</blockquote>\n\n<p>No. It's the value of <code>ptr</code> that has been overwritten. The sring literal are most likely untouched</p>\n\n<blockquote>\n  <p>2)Why does p a in gdb doesn't give the proper o/p where as p a+0 shows \"SolarisLinux\".</p>\n</blockquote>\n\n<p>This is a guess - nothing more. My guess is that gdb knows that <code>a</code> is 8 bytes so printing <code>a</code> directly only prints 8 bytes. When printing <code>a + 0</code> mys guess is that gdb sees <code>a + 0</code> like a pointer (and therefore can't know the object size) so gdb keeps printing until it sees a zero-termination.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1533735250, "post_id": 51747960, "comment_id": 90455886, "body": "<i>Actually, <code>char *ptr</code> and <code>char a[]</code> are the exact same thing</i>  No, they are most definitely <b>not</b> &quot;the exact same thing&quot;.  <code>char *ptr = &quot;Linux&quot;;</code> creates a pointer-to-char variable named <code>ptr</code> and initializes it with the address of the string literal <code>&quot;Linux&quot;</code>.  Attempts to modify the memory <i>pointed to by <code>ptr</code></i> can fail.  But <code>char a[] = &quot;Solaris&quot;;</code> creates an actual array of <code>char</code> initialized with the characters <code>&quot;Solaris\\0&quot;</code>.  This string can be safely modified, such as by <code>a[0]=&#39;s&#39;;</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533735255, "post_id": 51747960, "comment_id": 90455893, "body": "See <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\">Why do I get a segmentation fault when writing to a string initialized with \u201cchar *s\u201d but not \u201cchar s&#91;&#93;\u201d?</a>"}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533735566, "post_id": 51747960, "comment_id": 90456113, "body": "You are right, I edit my post, these were not the correct words."}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533735773, "post_id": 51747960, "comment_id": 90456252, "body": "Everything deserve a downvote when you like to downvote ;-) I edited my post since, I did make a mistake when rereading myself. This post is the result of several edits (as every post should be), I made a mistake at one of them ^^"}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533737699, "post_id": 51747960, "comment_id": 90457554, "body": "I removed this not so useful part of my post. You a right on the fact that this does not help beginners. Maybe you can help answer me on this : is it possible to change the address of a (to make it point to an other array or smth like that) ?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1533739075, "post_id": 51747960, "comment_id": 90458587, "body": "@PierrePodevin No, it is not possible to change the address of <code>a</code> to make it point to another array.  If you want to be able to change where something points, that&#39;s why you use a pointer instad of an array.  In any case, <code>a</code> is not a pointer, and it&#39;s either incorrect or badly misleading to say that it &quot;points&quot; anywhere.  These are all basic points; if you do a search you&#39;ll find that the question has been asked (and answered) hundreds of times on Stackoverflow already."}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533740299, "post_id": 51747960, "comment_id": 90459436, "body": "I rarely use array in C. I only use them declaring the form type var_name[number_of_cases]. Never with no size value. I find it misleading. At the end of the day, it&#39;s all pointer anyway. So to me, either you use a buffer of fix size <code>char buff[SIZE];</code> or you have dynamic memory <code>char *str = malloc(sizeof(char) * nm_element)</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1533744947, "post_id": 51747960, "comment_id": 90462372, "body": "@PierrePodevin: It is <b>not</b> <i>all pointer anyway</i>: <code>char a[] = &quot;Solaris&quot;;</code> is exactly equivalent to <code>char\u00a0a[8]\u00a0=\u00a0&quot;Solaris&quot;;</code>, a fixed size array. As a matter of fact, in C, all arrays have fixed sizes. The size may be determined at run time as in <code>int size = 8; char array[size];</code>, but once defined, the array size is fixed."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533749859, "post_id": 51747960, "comment_id": 90465005, "body": "@PierrePodevin I&#39;m sorry if this sounds harsh, but if you rarely use arrays and don&#39;t understand them well, please don&#39;t try to give advice about them to others: you&#39;re too likely to mislead."}, {"owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "edited": false, "score": 0, "creation_date": 1533801864, "post_id": 51747960, "comment_id": 90482463, "body": "Nah, you didn&#39;t understand me well on that point. I do use arrays, like all the time. It&#39;s just that I don&#39;t use them in this exact syntax that to me is confusing. Either I use a fixed size buffer, a static string or a dynamically memory area (used as array). Then it&#39;s only a matter of how you see things. I do know C in a really fundamental way. So I really know my way around these kind of problems. I can even guess in what kind of memory is a string depending on its address (namely the address of the first char). An array is always of fixed size because of how and where it is created."}], "tags": [], "owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1533737518, "last_edit_date": 1533737518, "creation_date": 1533734892, "answer_id": 51747960, "question_id": 51746106, "link": "https://stackoverflow.com/questions/51746106/strcat-with-char-pointer-to-a-string-literal/51747960#51747960", "title": "strcat with char pointer to a string literal", "body": "<p>Well, here we've got a pointer mistake.</p>\n\n<p>I'll try to be understandable :</p>\n\n<p>Constant strings (like <code>\"Linux\"</code> and <code>\"Solaris\"</code>) are stored in a specific memory area of the program. For your program, among other strings (like error message for instance), there should be an area with : <code>\"Linux\\0Solaris\\0%s\\n\\0%s\\n\\0\"</code>.</p>\n\n<p>When you do :</p>\n\n<pre><code>char *ptr = \"Linux\";\nchar a[] = \"Solaris\";\n</code></pre>\n\n<p>you assign ptr to the address of the <code>'L'</code> char and you are given 8 * sizeof(char) memory on the stack where <code>\"Solaris\\0\"</code> is then copied.</p>\n\n<p>When you concat those two strings, since you never created a new memory space (doing <code>malloc</code> or <code>char str[50]</code> for instance), ask <code>strcat</code> to write after the end of the stack memory reserved for your function usage. This is the kind of programming mistake that causes stack<strong>overflow</strong>.</p>\n\n<p>Here gdb tries it's best to display the strings. </p>\n\n<pre><code>(gdb) p ptr\n$15 = 0x400624 \"Linux\"\n</code></pre>\n\n<p>Pointer to static string area, display correctly</p>\n\n<pre><code>(gdb) p a+1\n$20 = 0x7fffffffe7f1 \"olarisLinux\"\n</code></pre>\n\n<p>Pointer to stack displayed as you would expect</p>\n\n<pre><code>(gdb) p a\n$21 = \"SolarisL\"\n</code></pre>\n\n<p>Pointer to a 8 char len area, gdb knows the size, displays you the 8 first char.</p>\n\n<pre><code>(gdb) p a+0\n$22 = 0x7fffffffe7f0 \"SolarisLinux\"\n</code></pre>\n\n<p>Pointer to stack (gdb doesn't know the size since you do pointer arithmetic)</p>\n\n<pre><code>(gdb) p ptr\n$24 = 0x78756e69 &lt;error: Cannot access memory at address 0x78756e69&gt;\n</code></pre>\n\n<p>This one is tricky. See here, ptr does not have the same address as the first time you printed it. There is a possibility that you wrote over ptr value at some point (as you wrote somewhere on the stack that you shouldn't have).</p>\n\n<blockquote>\n  <p>1)Does strcat removes the string literal from the original location, as accessing ptr gives a segmentation fault.</p>\n</blockquote>\n\n<p>Nope, the original location can't be overwritten.</p>\n\n<blockquote>\n  <p>2)Why does p a in gdb doesn't give the proper o/p where as p a+0 shows \"SolarisLinux\".</p>\n</blockquote>\n\n<p>It's a debugger, it is written to avoid some type of error, so when it can, he reads only what should be red.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1533740548, "post_id": 51749188, "comment_id": 90459590, "body": "The original value of <code>ptr</code> is <code>0x400624</code>, not <code>0x12345678</code> as shown in the layout"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1533739490, "last_edit_date": 1533739490, "creation_date": 1533738437, "answer_id": 51749188, "question_id": 51746106, "link": "https://stackoverflow.com/questions/51746106/strcat-with-char-pointer-to-a-string-literal/51749188#51749188", "title": "strcat with char pointer to a string literal", "body": "<p>If the question is \"I know it's wrong, but why did it do <em>that</em>?\", there are sort of two ways of answering it.</p>\n\n<p>(1) Undefined behavior means <em>anything</em> can happen.  Taking an array of size 8 and writing 13 characters to it is a really wrong thing to do.  You're overwriting five bytes of memory that were presumably in use for something else, so overwriting them means... anything can happen.  (But now I'm repeating myself.)</p>\n\n<p>I know you asked the question in all sincerity, but I have to say, to me these questions always sound like: \"I ran through a busy intersection when the sign said Don't Walk.  A blue car ran over me, and I broke my left leg.  I don't understand why.  Why wasn't I hit by a red truck?  Why didn't I break my right arm?\"</p>\n\n<p>(2) Let's look at a likely layout of the memory allocated for this program:</p>\n\n<pre><code>            +----+----+----+----+----+----+----+----+\n         a: | S  | o  | l  | a  | r  | i  | s  | \\0 |\n            +----+----+----+----+----+----+----+----+\n\n            +----+----+----+----+\n       ptr: | 78 | 56 | 34 | 12 |\n            +----+----+----+----+\n\n            +----+----+----+----+----+----+\n0x12345678: | L  | i  | n  | u  | x  | \\0 |\n            +----+----+----+----+----+----+\n</code></pre>\n\n<p>Here I'm imagining that the string <code>\"Linux\"</code> is stored at address <code>0x12345678</code>, so <code>ptr</code> holds that value.  I'm imagining that your machine uses 32-bit pointers.  (These days, though, it might well use 64.)  I'm imagining that your machine uses \"little endian\" byte order, meaning that the bytes making up the pointer <code>p</code> are stored in the opposite order in memory than you might expect.</p>\n\n<p>You said that after calling <code>strcat</code>, <code>a</code> printed out the concatenated string you expected, but the program crashed when you tried to print <code>ptr</code>.  Let's change the printout of <code>ptr</code> to</p>\n\n<pre><code>printf(\"%p: %s\\n\", ptr, ptr);\n</code></pre>\n\n<p>Before the call to <code>strcat</code>, this will print something like</p>\n\n<pre><code>0x12345678: Linux\n</code></pre>\n\n<p>But here's what the call to <code>strcat</code> actually does:</p>\n\n<pre><code>            +----+----+----+----+----+----+----+----+\n         a: | S  | o  | l  | a  | r  | i  | s  | L  |\n            +----+----+----+----+----+----+----+----+\n\n            +----+----+----+----+\n       ptr: | i  | n  | u  | x  | \\0\n            +----+----+----+----+\n</code></pre>\n\n<p>Now, the printout of <code>ptr</code> is going to be something like</p>\n\n<pre><code>0x78756e69: Segmentation violation (core dumped)\n</code></pre>\n\n<p>You overwrote the pointer <code>ptr</code>, so it no longer points to address <code>0x12345678</code> where the string <code>\"Linux\"</code> is stored, it now points to location <code>0x78756e69</code>, where those hex digits come from the characters <code>i n u x</code>.  If you don't have permission to access address <code>0x78756e69</code>, you'll get a crash.  If you do have permission to access location <code>0x78756e69</code>, you'll get some garbage string printed.</p>\n\n<p>Now, with all of that said, it's important to note that this is not <em>necessarily</em> what will happen.  I've assumed that the compiler stored the pointer <code>ptr</code> right after the array <code>a</code> in memory.  That's one possibility, but obviously not the only possibility.  If the compiler happened to store <code>ptr</code> somewhere else, then something else would get overwritten by <code>inux</code>, and something else might go wrong.  Or nothing might go wrong.  (In other words, you might get hit by the blue car, or you might get hit by the red truck, or you might get lucky and make it across the street without being hit at all.)</p>\n\n<hr>\n\n<p>Addendum: I've just looked at your post more carefully, and I see that gdb told you that <code>ptr</code> had changed to <code>0x78756e69</code>, and that it couldn't access the memory there.  But now we know where that strange value <code>0x78756e69</code> probably came from. :-)</p>\n"}], "owner": {"reputation": 904, "user_id": 2711402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f60d62777fda717173de19b2de003018?s=128&d=identicon&r=PG&f=1", "display_name": "Rndp13", "link": "https://stackoverflow.com/users/2711402/rndp13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 51747811, "answer_count": 3, "score": 1, "last_activity_date": 1533741074, "creation_date": 1533729356, "last_edit_date": 1533735617, "question_id": 51746106, "link": "https://stackoverflow.com/questions/51746106/strcat-with-char-pointer-to-a-string-literal", "title": "strcat with char pointer to a string literal", "body": "<p>Was just trying to understand the below code asked in a recent interview.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char *ptr = \"Linux\";\n    char a[] = \"Solaris\";\n    strcat(a, ptr);\n    printf(\"%s\\n\", ptr);\n    printf(\"%s\\n\", a);\n    return 0;\n}\n</code></pre>\n\n<p>Execution trace:</p>\n\n<pre><code>gcc -Wall -g prog.c\ngdb a.out\n\n(gdb) p ptr\n$15 = 0x400624 \"Linux\"\n(gdb) p a+1\n$20 = 0x7fffffffe7f1 \"olarisLinux\"\n**(gdb) p a\n$21 = \"SolarisL\"**\n**(gdb) p a+0\n$22 = 0x7fffffffe7f0 \"SolarisLinux\"**\n(gdb)\n$23 = 0x7fffffffe7f0 \"SolarisLinux\"\n**(gdb) p ptr\n$24 = 0x78756e69 &lt;error: Cannot access memory at address 0x78756e69&gt;\n(gdb)**\n</code></pre>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li><p>Does <code>strcat</code> remove the string literal from the original location, as accessing <code>ptr</code> gives a segmentation fault?</p></li>\n<li><p>Why does <code>p a</code> in gdb doesn't give the proper output where as <code>p a+0</code> shows <code>\"SolarisLinux\"</code>?</p></li>\n</ol>\n"}, {"tags": ["c", "assembly", "x86", "memory-barriers"], "comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1533728813, "post_id": 51745856, "comment_id": 90451474, "body": "Why do you think <code>a</code> and <code>b</code> will be stored in <b>memory</b>? There&#39;s no such requirement in C++ language, in corner case the compiler may generate code which will keep those two in registers only (for example)."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1533728845, "post_id": 51745856, "comment_id": 90451492, "body": "@Ped7g Yes, I asked the wrong question... Sorry"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1533728927, "post_id": 51745856, "comment_id": 90451547, "body": "No problem, searching the correct question is part of the process, and sometimes that process requires steps like this one. :) But the topic may be quite tricky, so you will have to be more precise to get some meaningful answer.."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533729062, "post_id": 51745856, "comment_id": 90451630, "body": "you need prevent here compiler reordering. say by insert <code>a = 1; _ReadWriteBarrier(); b = 1;</code> on x86/x64 this will be enough"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1533733504, "post_id": 51745856, "comment_id": 90454709, "body": "Is this actually C or C++, or are you actually asking about assembly that does those operations in that order?  Because obviously this is UB in C, and the C memory model applies for compile-time reordering and load hoisting, not the x86 memory model.  IIRC, you did this in a previous question and wasted everyone&#39;s time sorting out C vs. x86 memory models, so <b>please specify in the question that you actually mean if the asm looks like this.</b>  Obviously <code>while(b == 0){}</code> will become an infinite loop with any normal C compiler if it enters the loop at all."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533735710, "post_id": 51745856, "comment_id": 90456210, "body": "@PeterCordes The question was not about C compiler and static compiler reordering. I meant that <code>foo</code> and <code>bar</code> are executed by different threads. The line of <code>b</code> may be in exclusive state of the core the thread executing <code>foo</code> is running on and the line of <code>a</code> is in shared state on both cores. So the write to <code>a</code> is placed in a store buffer and read-invalidate is sent to the core 2 which may be discorvered later then <code>assert(a == 1)</code> is executed."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533735888, "post_id": 51745856, "comment_id": 90456338, "body": "@St.Antario: Then don&#39;t tag it <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> and post syntactically-valid C without any explanation that the code is <i>not</i> actually C.  <i>Or</i> fix your C to use release stores and acquire loads (which map directly to x86 instructions), or at least <code>volatile</code>.  You already wasted Bathsheba&#39;s time writing an answer about the UB.  (And BTW, just removing the <code>[c]</code> tag is only barely sufficient.  Everyone knows what C looks like, and that non-atomic variables can be optimized into non-shared registers, so that&#39;s a big distraction.)"}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533735966, "post_id": 51745856, "comment_id": 90456389, "body": "@PeterCordes So in fact because of store buffer and cache coherence things the other thread observed writes made by <code>foo</code> in a different order. Yet in the manual I quoted is clearly said that writes to memory cannot be reordered with another writes."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736150, "post_id": 51745856, "comment_id": 90456503, "body": "If you <i>actually</i> did what you mean in x86 asm, seeing <code>b!=0</code> would guarantee that you also see <code>a==1</code>, because <code>mov [b], 1</code> is a release-store (like all x86 stores other than NT), because x86 requires stores to commit from the store buffer to L1d in program order.  (So reordering is <i>not</i> allowed.  Only compile-time reordering can break this example on x86).  But if you compiled this invalid C, then that&#39;s not the case.  Are you claiming that you actually reproduced the reordering you&#39;re talking about?  If so, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736309, "post_id": 51745856, "comment_id": 90456618, "body": "@PeterCordes <i>If you actually did what you mean in x86 asm, seeing b!=0 would guarantee that you also see a==1</i> So how about the case I described above? If <code>a</code> is still in a shared state and invalidated after it was read?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736396, "post_id": 51745856, "comment_id": 90456671, "body": "Only compile-time reordering can break this example on x86.  <code>a</code> can&#39;t <i>still</i> be in shared state after <code>b=1</code> is visible; that would mean the thread running <code>foo</code> let its stores reorder."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736401, "post_id": 51745856, "comment_id": 90456675, "body": "@PeterCordes No I am not claiming that. I tried to reproduce and could not. That&#39;s why I&#39;m asking."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736724, "post_id": 51745856, "comment_id": 90456896, "body": "@PeterCordes <code>a can&#39;t still be in shared state after b=1 is visible</code>. Can you provide a relevant quote from the intel doc?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533736814, "post_id": 51745856, "comment_id": 90456956, "body": "@St.Antario: you already did: <i>Writes to memory are not reordered with other writes</i>."}], "answers": [{"comments": [{"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533729833, "post_id": 51745919, "comment_id": 90452140, "body": "@RbMm If the are aligned correspondingly... But it&#39;s UB anyway."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1533729985, "post_id": 51745919, "comment_id": 90452230, "body": "yes, agree with alignment. but i not view any pragma in code which overwrite default alignment in this case. so assume natural alignment for int. and in this case not view any ub. of course need force compiler not reorder <code>a=1,b=1</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1533728887, "last_edit_date": 1533728887, "creation_date": 1533728753, "answer_id": 51745919, "question_id": 51745856, "link": "https://stackoverflow.com/questions/51745856/instruction-reordering-on-intel/51745919#51745919", "title": "Instruction reordering on intel", "body": "<p>If one thread was running <code>foo</code> and another was running <code>bar</code> then the behaviour of your program would be <em>undefined</em>.</p>\n\n<p>You are not allowed to make simultaneous read and writes on a non-atomic variable such as <code>int</code>.</p>\n\n<p>So instruction reording is permissible in this instance.</p>\n"}, {"comments": [{"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1533736857, "post_id": 51748593, "comment_id": 90456976, "body": "Like I already said I was mistakenly provided an example in <code>C</code> while meaning the x86 assembly."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1533736970, "post_id": 51748593, "comment_id": 90457050, "body": "@St.Antario: I re-added the C tag, because that&#39;s the only reason I can imagine for your claim that &quot;<i>It&#39;s known that in this example the assertion may fail</i>&quot;.   See <a href=\"http://preshing.com/20120930/weak-vs-strong-memory-models/\" rel=\"nofollow noreferrer\">preshing.com/20120930/weak-vs-strong-memory-models</a>, and <a href=\"http://preshing.com/20120625/memory-ordering-at-compile-time/\" rel=\"nofollow noreferrer\">preshing.com/20120625/memory-ordering-at-compile-time</a>."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1533736723, "creation_date": 1533736723, "answer_id": 51748593, "question_id": 51745856, "link": "https://stackoverflow.com/questions/51745856/instruction-reordering-on-intel/51748593#51748593", "title": "Instruction reordering on intel", "body": "<p>Your premise is wrong.  Only compile-time reordering can break this example on x86<sup>1</sup>.</p>\n\n<p>x86 asm stores are release-stores.  They can only commit from the store buffer to L1d cache in program order.</p>\n\n<p><code>a</code> can't <em>still</em> be in shared state after <code>b=1</code> is visible; that would mean the thread running <code>foo</code> let its stores commit out of order.  This is what <em>Writes to memory are not reordered with other writes</em> means, for stores to cacheable memory.</p>\n\n<p>If it's in shared state <em>again</em> after being invalidated by the RFO from the thread running <code>foo</code>, then it will have the updated value of <code>a</code>.</p>\n\n<hr>\n\n<p>Footnote 1.  Of course the spin-loop will optimize into <code>if (b==0) infinite_loop</code>, because data-race UB lets the compiler hoist the load.  See <a href=\"https://electronics.stackexchange.com/questions/387181/mcu-programming-c-o2-optimization-breaks-while-loop\">MCU programming - C++ O2 optimization breaks while loop</a>.</p>\n\n<p>You seem to be asking about C rules while assuming that the code will be translated naively / directly to x86 asm.  You could get that with relaxed atomics, but not <code>volatile</code> because <code>volatile</code> accesses can't be reordered (at compile time) with other <code>volatile</code> accesses.</p>\n"}], "owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 51748593, "answer_count": 2, "score": 3, "last_activity_date": 1533736774, "creation_date": 1533728530, "last_edit_date": 1533736774, "question_id": 51745856, "link": "https://stackoverflow.com/questions/51745856/instruction-reordering-on-intel", "title": "Instruction reordering on intel", "body": "<p>I'm trying to understand the instruction reordering by the following simple example:</p>\n\n<pre><code>int a;\nint b;\n\nvoid foo(){\n   a = 1;\n   b = 1;\n}\n\nvoid bar(){\n   while(b == 0) continue;\n   assert(a == 1);\n}\n</code></pre>\n\n<p>It's known that in this example the assertion may fail if one thread executes <code>foo</code>, and another one executes <code>bar</code>. But I don't understand why. I consulted the <a href=\"https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.pdf\" rel=\"nofollow noreferrer\">Intel manual Vol. 3A, 8.2.2</a> and found the following:</p>\n\n<blockquote>\n  <p>Writes to memory are not reordered with other writes, with the\n  following exceptions: </p>\n  \n  <p>\u2014 streaming stores (writes) executed with the\n  non-temporal move instructions (MOVNTI, MOVNTQ, MOVNTDQ, MOVNTPS, and\n  MOVNTPD); and</p>\n  \n  <p>\u2014 string operations (see Section 8.2.4.1).</p>\n</blockquote>\n\n<p>There are no string operations here as well as I did not notice <code>NT</code> move instructions. So... Why is the reordering of writes possible? </p>\n\n<p>Or does the memory matters in </p>\n\n<blockquote>\n  <p>Writes to <strong><em>memory</em></strong> are not reordered</p>\n</blockquote>\n\n<p>? So when we have <code>a</code> and <code>b</code> cached and writes occur not to main memory, but to cache they can be.</p>\n"}, {"tags": ["c", "char", "int", "logic", "atoi"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1533727247, "post_id": 51745386, "comment_id": 90450406, "body": "C does not have a native <code>string</code> type. So what is string?"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1533727433, "post_id": 51745386, "comment_id": 90450544, "body": "<code>&#39;5&#39;</code> is <i>not</i> a &quot;string&quot;. <code>&quot;5&quot;</code> is a &quot;string&quot;."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533727436, "post_id": 51745386, "comment_id": 90450546, "body": "So that magic <code>&amp;</code> thing isn&#39;t just some random symbol, it&#39;s the C address-of operator, which gives you a pointer to something.  And strings in C are very often manipulated using pointers to characters.  So to understand what&#39;s going on here, you&#39;re going to have to learn more about strings and pointers in C.  Also you need to think about the distinction between characters and strings: a character is one single character, while a string is an array of zero or more characters."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1533727505, "post_id": 51745386, "comment_id": 90450599, "body": "Specifically, <code>note</code> and <code>note + strlen(note) - 1</code> could be said to be a &quot;string&quot; (in a certain way of speaking); <code>note[strlen(note) - 1]</code> is a single <code>char</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "is_accepted": true, "score": 0, "last_activity_date": 1533727530, "creation_date": 1533727530, "answer_id": 51745518, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c/51745518#51745518", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p>The function <code>atoi</code> takes a pointer to a character array as the input parameter (<code>const char*</code>). When you call <code>note[strlen(note) - 1]</code> this is a single character (<code>char</code>), in order to make <code>atoi</code> work you need to provide the pointer. You do that by adding <code>&amp;</code> as you've done. This then works, because right after that single digit there is a null character <code>\\0</code> that terminates the string - because your original string was null-terminated. </p>\n\n<p>Note however that doing something like this would not be a good idea:</p>\n\n<pre><code>char a = '7';\nint b = atoi(&amp;a);\n</code></pre>\n\n<p>as there is no way to be sure what the next byte in memory is (following the byte that belongs to <code>a</code>), but the function will try to read it anyway, which can lead to undefined behaviour. </p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "is_accepted": false, "score": 0, "last_activity_date": 1533727559, "creation_date": 1533727559, "answer_id": 51745528, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c/51745528#51745528", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p>The last character is... well a character! not a string. So by adding the <code>&amp;</code> sign, you made it a pointer to character (<code>char*</code>)!</p>\n\n<p>You can also try this code:</p>\n\n<pre><code>char a = '5';\nint b = a - '0';\n</code></pre>\n\n<p>Gives you ASCII code of <code>5</code> minus ASCII code of <code>0</code></p>\n"}, {"tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 3, "last_activity_date": 1533727597, "creation_date": 1533727597, "answer_id": 51745545, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c/51745545#51745545", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p>C does not have a native string type. Strings are usually represented as char array or a pointer to char.</p>\n\n<p>Assuming that <code>string</code> is just a typedef to <code>char *</code>.</p>\n\n<p>if <code>note</code> is an array of chars, <code>note[strlen(note)-1]</code> is just the last character. Since <code>atoi</code> expects a pointer to char (which has to be null-terminated) you have to pass the address of the char and not the value.</p>\n\n<p>The task to convert one char digit to int could also be solved easier:</p>\n\n<pre><code>int octave = note[strlen(note) - 1] - '0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 0, "last_activity_date": 1533728039, "last_edit_date": 1533728039, "creation_date": 1533727655, "answer_id": 51745557, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c/51745557#51745557", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p>From the <a href=\"https://www.freebsd.org/cgi/man.cgi?query=atoi&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports&amp;arch=default&amp;format=html\" rel=\"nofollow noreferrer\">manual pages</a>, the signature of <code>atoi</code> is: <code>int atoi(const char *nptr);</code>. So, you need to pass the address of a <code>char</code>. </p>\n\n<p>When you do this: <code>atoi(note[strlen(note) - 1])</code> you pass the <code>char</code> itself. Thus, invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>.</p>\n\n<p>When you use the <code>&amp;</code>, you are passing what the function expects - the address. Hence, that works.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1533728683, "creation_date": 1533728683, "answer_id": 51745891, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c/51745891#51745891", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p><code>atoi</code> excepts a string (a pointer to character), not a single character.</p>\n\n<p>However, you should never use <code>atoi</code> since that function has bad error handling. The function <a href=\"https://linux.die.net/man/3/strtol\" rel=\"nofollow noreferrer\"><code>strtol</code></a> is 100% equivalent but safer.</p>\n\n<p>You need to do this in two steps:</p>\n\n<ol>\n<li>Find the first digit in the string.  </li>\n<li>From there, convert it to integer by calling <code>strtol</code>.</li>\n</ol>\n\n<p>1) can is solved by looping through the string, checking if every item is a digit by calling <code>isdigit</code> from ctype.h. Simultaneously, check for the end of the string, the null terminator <code>\\0</code>. When you find the first digit, save a pointer to that address.</p>\n\n<p>2) is solved by passing the saved pointer to <code>strtol</code>, such as <code>result = strtol(pointer, NULL, 10);</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10197124, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-816661vQguc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rOT2bYuG9-4b5PZHMRZa6T4uGYag/mo/photo.jpg?sz=128", "display_name": "Vitaly Trufanov", "link": "https://stackoverflow.com/users/10197124/vitaly-trufanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 51745518, "answer_count": 5, "score": -1, "last_activity_date": 1533728683, "creation_date": 1533727137, "question_id": 51745386, "link": "https://stackoverflow.com/questions/51745386/logic-of-converting-a-char-into-an-int-in-c", "title": "LOGIC of Converting a &quot;char&quot; into an &quot;int&quot; in C", "body": "<p>everyone!</p>\n\n<p>please help me understand the following problem...\nSo i will have a STRING-type input of a note, looks like \"A5\" or \"G#2\" or \"Cb4\" etc. And i need to extract an octave index, which is the last digit \"5\" or \"2\" or \"4\"... And after exctraction i need it as an int-type.</p>\n\n<p>So I did this: </p>\n\n<pre><code>string note = get_string(\"Input: \");\nint octave = atoi(note[strlen(note) - 1]);\nprintf(\"your octave is %i \\n\", octave);\n</code></pre>\n\n<p>But it gave me an error <strong>\"error: incompatible integer to pointer conversion passing 'char' to parameter of type 'const char *'; take the address with &amp; [-Werror,-Wint-conversion]\"</strong></p>\n\n<p>Then I tryied to throug away the math from the function, and did this:</p>\n\n<pre><code>int extnum = strlen(note) - 1;\nint octave = atoi(note[extnum]);\n</code></pre>\n\n<p>It didn't work as well. So i did my reserch on atoi function and i don't get it...</p>\n\n<ol>\n<li>ATOI expects a string (CHECK)</li>\n<li>Converts it to an interger, not the ASCII meanning (CHECK)</li>\n<li>Library for atoi function (CHECK)</li>\n</ol>\n\n<p>What I am doing in basically asking \"take n-th character of that string and make it an int\".</p>\n\n<p>After googling for some time a found an other code example where a guy uses atoi with this symbol '&amp;'. <strong>So i did this</strong>:</p>\n\n<pre><code>int octave = atoi(&amp;note[strlen(note) - 1]);\n</code></pre>\n\n<p>And IT WORKED! But I can't understand WHY it worked with the &amp; symbol and didnt work without it....Cause it always worked without it! There was a million times i was giving a single-character string like '5' or so ond just used atoi and it worked perfectly...</p>\n\n<p><strong>Plesase help me, why in this case it acts so weird?</strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533726079, "post_id": 51744878, "comment_id": 90449688, "body": "Post your full code."}], "answers": [{"comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 1, "creation_date": 1533727407, "post_id": 51745279, "comment_id": 90450529, "body": "I agree with the change, although it might be clearer if you allocated the memory into a new binTree_t* and saved the value in the output argument at the end, rather than working with <code>*tree</code> throughout. (Or you could just return the binTree_t* instead.)"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1533727490, "post_id": 51745279, "comment_id": 90450581, "body": "buildBintree(&amp;maple);"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1533727481, "last_edit_date": 1533727481, "creation_date": 1533726818, "answer_id": 51745279, "question_id": 51744878, "link": "https://stackoverflow.com/questions/51744878/problems-debugging-my-own-binarytree-adt-in-c/51745279#51745279", "title": "Problems debugging my own binarytree adt in c", "body": "<p>buildBintree should receive double pointer. Using single pointer, tree will  not point to maple, which is actually pointing to object which maple is pointing.</p>\n\n<pre><code>   int buildBintree(binTree_t **tree)\n        {\n           *tree = (binTree_t*) malloc(sizeof(binTree_t));\n           if (*tree == NULL)\n            return -1;\n\n           (*tree)-&gt;root = NULL;\n           (*tree)-&gt;current = NULL;\n           return 0;\n        }\n</code></pre>\n\n<p>and in main you need to call like below.</p>\n\n<pre><code>           int main()\n            {\n               binTree_t *maple;\n                int number;\n\n                buildBintree(&amp;maple);\n\n                buildLeaf(maple,&amp;number);\n               return 0;\n            }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1533727589, "creation_date": 1533727589, "answer_id": 51745544, "question_id": 51744878, "link": "https://stackoverflow.com/questions/51744878/problems-debugging-my-own-binarytree-adt-in-c/51745544#51745544", "title": "Problems debugging my own binarytree adt in c", "body": "<p>There is nothing special about pointers.</p>\n\n<p>Regardless of its type, assigning a new value to a parameter has no effect on any variable whose value you passed in.<br>\n(What do you expect to happen if you <code>buildBinTree(NULL);</code>?)</p>\n\n<p>If you want a function to modify something, you need to pass it the address of the thing that's going to change.<br>\nSo if you want the function to modify a pointer, you need to pass it the address of a pointer.</p>\n\n<pre><code>int x = 0;\nvoid fail(int* p) { p = &amp;x; }\nvoid succeed(int** p) { *p = &amp;x; }\n\nint main()\n{\n    int *p = NULL;\n    fail(p);\n    /* p is still null */\n    succeed(&amp;p);\n    /* p is not null any more */\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10196733, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AYnAGRfMjfU/AAAAAAAAAAI/AAAAAAAAInA/Sg_46-uH5uM/photo.jpg?sz=128", "display_name": "Nico Baldelli", "link": "https://stackoverflow.com/users/10196733/nico-baldelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 51745279, "answer_count": 2, "score": 2, "last_activity_date": 1533727589, "creation_date": 1533725578, "last_edit_date": 1533726790, "question_id": 51744878, "link": "https://stackoverflow.com/questions/51744878/problems-debugging-my-own-binarytree-adt-in-c", "title": "Problems debugging my own binarytree adt in c", "body": "<pre><code>       typedef struct btNode {\n            struct btNode *right;\n            struct btNode *left;\n            void  *data;\n        } btNode_t;\n\n       typedef struct binTree\n        {\n            btNode_t *root;\n            btNode_t *current;\n\n        } binTree_t;\n\n        int buildBintree(binTree_t *tree)\n            {\n               tree = (binTree_t*) malloc(sizeof(binTree_t));\n               if (tree == NULL)\n                return ERROR;\n               tree-&gt;root = NULL;\n               tree-&gt;current = NULL;\n               return SUCCESS;\n            }\n</code></pre>\n\n<p>I need to insert the first leaf in my binary tree, but i dont know why my program crushes when i try to to make an <strong>if</strong> to ask if the tree->current is pointed to null in the leaf creating function.</p>\n\n<pre><code>int buildLeaf(binTree_t *tree, void *info)\n            {\n                if ((tree-&gt;current) != NULL)\n                    return ERROR;\n\n                btNode_t *btnode;\n\n                btnode = (btNode_t*) malloc(sizeof(btNode_t));\n\n                if (btnode == NULL)\n                        return ERROR;\n\n                if (isEmptyBintree(tree))\n                    tree-&gt;root = btnode;\n\n                tree-&gt;current = btnode;\n\n                tree-&gt;current-&gt;data = info;\n                tree-&gt;current-&gt;left = NULL;\n                tree-&gt;current-&gt;right = NULL;\n\n                return SUCCESS;\n            }\n</code></pre>\n\n<p>I have my tree empty and i only want to add the first leaf if the current has not a filled node</p>\n\n<pre><code>        int main()\n            {\n               binTree_t *maple;\n                int number;\n\n                buildBintree(maple);\n                buildLeaf(maple,&amp;number);\n\n               return 0;\n\n\n            }\n</code></pre>\n"}, {"tags": ["c", "codeblocks"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533725463, "post_id": 51744774, "comment_id": 90449316, "body": "On the internet, please do not write sentences with purely capital letters, it is considered rude (screaming)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1533725513, "post_id": 51744774, "comment_id": 90449350, "body": "And, caps aside - please <i>link</i> the question and answers that <i>didn&#39;t</i> solve your problem."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1533725647, "post_id": 51744774, "comment_id": 90449435, "body": "I don&#39;t know codeblocks, but the issue with your program is that you don&#39;t want the <code>&amp;</code> before <code>&amp;b[0]</code>. For the string that you&#39;re assembling character by character (<code>char a[] = &quot;abc&quot;;</code> would be simpler) you do want a pointer to the string for %s, so you do want <code>&amp;a[1]</code>, but for the %d you want the actual value which is <code>b[0]</code> not <code>&amp;b[0]</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1533725648, "post_id": 51744774, "comment_id": 90449437, "body": "I think the screenshot <i>is</i> relevant. I don&#39;t think the <b>GDB path</b> should go into that <i>Debugger initialization commands</i>, those are instead the commands that Code::Blocks should send to the <i>debugger interface</i>. I am not sure though if something <i>else</i> should go there"}, {"owner": {"reputation": 1022, "user_id": 154911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jYIPt.gif?s=128&g=1", "display_name": "ollydbg23", "link": "https://stackoverflow.com/users/154911/ollydbg23"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1533826206, "post_id": 51744774, "comment_id": 90498736, "body": "As @AnttiHaapala said, the GDB path should not be put in the initialization command field."}], "owner": {"reputation": 1, "user_id": 10196446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1881254272176872/picture?type=large", "display_name": "Khanh Dinh", "link": "https://stackoverflow.com/users/10196446/khanh-dinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1555, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554459536, "creation_date": 1533725266, "last_edit_date": 1554459536, "question_id": 51744774, "link": "https://stackoverflow.com/questions/51744774/codeblocks-debug-doesnt-run-and-shows-error", "title": "Code::Blocks debug doesn&#39;t run and shows error", "body": "<p>i have seen an answer to my similar question.but with that answer, my problem is not resolved.\nI run debugger for program C written on Code::Blocks, but debug doesn't run and shows error.</p>\n\n<pre><code>Default Building to ensure sources are up-to-date Selecting target: \n Debug ERROR: You need to specify a debugger program in the debuggers's settings. \n(For MinGW compilers, it's 'gdb.exe' (without the quotes)) \n(For MSVC compilers, it's 'cdb.exe' (without the quotes))\n</code></pre>\n\n<p>\"this is the answer i have seen before\"\n<a href=\"https://stackoverflow.com/questions/35592177/code-blocks-debugging-issue\">Code blocks debugging issue</a></p>\n\n<pre><code>Find out where gdb.exe is located in whatever GCC toolchain you are using with Code::Blocks, e.g:-\n\nFor MinGW: C:\\MingGW\\bin\\gdb.exe,\nFor mingw-w64: C:\\mingw-w64\\x86_64-5.2.0-posix-seh-rt_v4-rev0\\mingw64\\bin\\gdb.exe\nFor TDM-GCC: C:\\TDM-GCC-64\\bin\\gdb.exe\nIf you can't find it then the root of the problem is that the debugger is (no longer) installed.\n\nIf you find it, then enter its full pathname in Settings -&gt; Debugger settings -&gt; GDB/CDB debugger -&gt; Default -&gt; Executable path. Code::Blocks will check the pathname you enter and if it can't find it then the edit-field will turn red. Otherwise, OK out and the debugger will then work.\n\nIf the directory containing gdb.exe is in your PATH then you can simply enter gdb.exe in the field.\n</code></pre>\n\n<p>I have followed it. but in my case it only found gdb32.exe instead of gdb.exe. And I have followed with gdb323.exe but my problem is not resolved.</p>\n\n<p><a href=\"https://i.stack.imgur.com/v8LZO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v8LZO.png\" alt=\"gdb32.exe\"></a></p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1533727060, "post_id": 51744684, "comment_id": 90450285, "body": "It is illegal because someone decided that this is illegal."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "edited": false, "score": 0, "creation_date": 1533725342, "post_id": 51744734, "comment_id": 90449239, "body": "Hi Thank you, But my confusion is, arr will give the  base address, which is the address of the first element, if I do arr++, it should point to next element address in the array right?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "edited": false, "score": 1, "creation_date": 1533725382, "post_id": 51744734, "comment_id": 90449265, "body": "You can&#39;t modify an array. I made it clear in the answer."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1533725136, "creation_date": 1533725136, "answer_id": 51744734, "question_id": 51744684, "link": "https://stackoverflow.com/questions/51744684/what-is-the-wrong-with-array-address-with-post-increment-operator/51744734#51744734", "title": "what is the wrong with array address with post increment operator?", "body": "<p>You are trying to modify an array which is not permissible. You can't modify an array but its value. As you can see that error message itself speaks that arrays are not an lvalue so you can't modify it.<br>\nDo not confuse an array with a pointer.   </p>\n\n<pre><code>char arr[] = \"Pickpocketing my peace of mind\"; \nchar *ptr = arr;\nptr++;            // OK. ptr is an lvalue. It can be modified.\narr++;            // ERROR. arr in not an lvalue. Can't be modified.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "edited": false, "score": 0, "creation_date": 1533725865, "post_id": 51744916, "comment_id": 90449556, "body": "Thank you so much, Rizwan..."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 1, "creation_date": 1533725967, "post_id": 51744916, "comment_id": 90449617, "body": "It&#39;d seem like you&#39;re indicating that arrays are pointers, but they are not. They are just converted to a pointer to their first element in most contexts."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1533726156, "post_id": 51744916, "comment_id": 90449733, "body": "May be I was not very clear in expressing, but indeed you are right Arrays are not pointers. I explained it in this way just to give some insight."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1533726305, "post_id": 51744916, "comment_id": 90449833, "body": "Also <code>arr[5]</code> is not equivalent to what you describe, but <code>*(arr + 5)</code>."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1533726368, "post_id": 51744916, "comment_id": 90449868, "body": "I think you mean  *(arr + 5 * sizeof(char)) in this case."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1533727464, "post_id": 51744916, "comment_id": 90450564, "body": "No, the addition on pointers is defined to take the size into account. Just <code>arr + 5</code> produces the correct value."}], "tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": false, "score": 0, "last_activity_date": 1533726469, "last_edit_date": 1533726469, "creation_date": 1533725693, "answer_id": 51744916, "question_id": 51744684, "link": "https://stackoverflow.com/questions/51744684/what-is-the-wrong-with-array-address-with-post-increment-operator/51744916#51744916", "title": "what is the wrong with array address with post increment operator?", "body": "<p>Moving an array pointer is not permitted. If you want to move to next elements using ++ on array pointers just copy the array pointer in to some other pointer variable. Like</p>\n\n<pre><code>char arr[] = \"Pickpocketing my peace of mind\";\nchar *movablePtr = arr;\n</code></pre>\n\n<p>Now you can move <code>movablePtr</code> by <code>movablePtr++ / movablePtr--</code>.</p>\n\n<p>Also I to add when you say <code>arr[5]</code> actually it means <code>*(arr + 5 * sizeof(char))</code> when array is of <code>char</code> type.</p>\n"}], "owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1533725836, "answer_count": 2, "score": -3, "last_activity_date": 1533726469, "creation_date": 1533725001, "last_edit_date": 1533725173, "question_id": 51744684, "link": "https://stackoverflow.com/questions/51744684/what-is-the-wrong-with-array-address-with-post-increment-operator", "closed_reason": "Duplicate", "title": "what is the wrong with array address with post increment operator?", "body": "<pre><code>#include&lt;stdio.h&gt;\n int main(){\n    char arr[] = \"Pickpocketing my peace of mind\";\n    int i;\n    printf(\"%c\",*arr);\n    arr++;\n    printf(\"%c\",*arr);\n\n   return 0;\n }\n</code></pre>\n\n<p>I am getting \n error: lvalue required as increment operand.\nMy question is , if we increment a variable like  int i=10; i++ will not give any error. but y this?</p>\n"}, {"tags": ["c", "constants"], "comments": [{"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 1, "creation_date": 1533724017, "post_id": 51744299, "comment_id": 90448470, "body": "Well... Pointers passed as arguments can be modified in the function. So if they are defined as <code>const</code>, then they will always point to the same address... Another reference:  <a href=\"https://stackoverflow.com/questions/12291607/passing-arguments-to-functions-with-const-parameters-is-it-faster\" title=\"passing arguments to functions with const parameters is it faster\">stackoverflow.com/questions/12291607/&hellip;</a>"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1533724176, "post_id": 51744299, "comment_id": 90448555, "body": "To indicate that it won&#39;t be modified, have a look here: <a href=\"https://stackoverflow.com/questions/9419051/declaring-a-pointer-to-const-or-a-const-pointer-to-const-as-a-formal-parameter\" title=\"declaring a pointer to const or a const pointer to const as a formal parameter\">stackoverflow.com/questions/9419051/&hellip;</a>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 1, "creation_date": 1533724183, "post_id": 51744299, "comment_id": 90448561, "body": "@PhoenixBlue of course it is wrong."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533724404, "post_id": 51744299, "comment_id": 90448695, "body": "I would prefer <code>void f1(const char const * arg)</code> if <code>f1()</code> is guaranteed not to change the input <code>arg</code> or its contents"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1533724438, "post_id": 51744299, "comment_id": 90448711, "body": "@PhoenixBlue Please look at the position of <code>const</code>. It does not affect the pointer."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533724460, "post_id": 51744299, "comment_id": 90448726, "body": "@Mawg I think you meant <code>void f1(const char * const arg)</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533724471, "post_id": 51744299, "comment_id": 90448734, "body": "@Mawg you probably mean <code>void f1(const char * const arg)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 929, "user_id": 7233022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77dyV.jpg?s=128&g=1", "display_name": "Fakher Mokadem", "link": "https://stackoverflow.com/users/7233022/fakher-mokadem"}, "edited": false, "score": 0, "creation_date": 1533725302, "post_id": 51744421, "comment_id": 90449215, "body": "thx, so, does char * const arg, means I can change the data and not the address the pointer has?"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "reply_to_user": {"reputation": 929, "user_id": 7233022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77dyV.jpg?s=128&g=1", "display_name": "Fakher Mokadem", "link": "https://stackoverflow.com/users/7233022/fakher-mokadem"}, "edited": false, "score": 0, "creation_date": 1533725729, "post_id": 51744421, "comment_id": 90449482, "body": "@FakherMokadem Have updated my answer to include <code>char * const arg</code>."}], "tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": true, "score": 2, "last_activity_date": 1533725691, "last_edit_date": 1533725691, "creation_date": 1533724186, "answer_id": 51744421, "question_id": 51744299, "link": "https://stackoverflow.com/questions/51744299/declaring-function-arguments-as-const-in-c/51744421#51744421", "title": "Declaring function arguments as const in C", "body": "<p><code>const char* arg</code> means that <code>arg</code> is a pointer to a constant <code>char</code>. If you try to change the data that <code>arg</code> points to, you will get an error saying something like: <code>error: assignment of read-only location \u2018*arg\u2019</code>. However, you can change the address contained in <code>arg</code>.</p>\n\n<p>Whereas, by dropping the <code>const</code> keyword, you state that the data which <code>arg</code> points to <em>can</em> be changed.</p>\n\n<p>Your preference should be based on your needs. Have a look at <a href=\"https://stackoverflow.com/questions/21476869/constant-pointer-vs-pointer-to-constant\">this</a> for more information.</p>\n\n<p>In response to your comment: <code>char * const arg</code> means means that <code>arg</code> is a constant (pause a second) pointer to a <code>char</code>. So, you can't change the address contained in <code>arg</code> and you <em>can</em> change the data residing at that address.</p>\n"}, {"comments": [{"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533724421, "post_id": 51744430, "comment_id": 90448704, "body": "I would prefer <code>void f1(const char const * arg)</code> if <code>f1()</code> is guaranteed not to change the input <code>arg</code> or its contents"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533724635, "post_id": 51744430, "comment_id": 90448839, "body": "@Mawg: no, your prototype is redundant, you mean <code>void f1(const char * const arg)</code> to specify that <code>f1</code> will not change the value of the argument itself. Such <code>const</code> qualification is useless and obscures the code."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1533756406, "last_edit_date": 1533756406, "creation_date": 1533724210, "answer_id": 51744430, "question_id": 51744299, "link": "https://stackoverflow.com/questions/51744299/declaring-function-arguments-as-const-in-c/51744430#51744430", "title": "Declaring function arguments as const in C", "body": "<p>You prefer </p>\n\n<pre><code>void f1(const char* arg) \n</code></pre>\n\n<p>If you don't want to modify the object pointed by arg through arg.\nBut you can modify the arg itself.</p>\n\n<p>You prefer </p>\n\n<pre><code>void f2(char* arg) \n</code></pre>\n\n<p>If you want to modify the object pointed by arg through arg.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1533725319, "post_id": 51744578, "comment_id": 90449225, "body": "I would not overstate possible performance improvements, which are limited. Const correctness is more about improving code quality and reducing programmer errors."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1533725449, "post_id": 51744578, "comment_id": 90449305, "body": "@user694733 And what did I write in my answer? Do you see any downsides of the correct use of <code>const</code>?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1533725513, "post_id": 51744578, "comment_id": 90449349, "body": "No downsides. I just think that <i>&quot;significant impact on the performance of the generated code.&quot;</i> is a bit much."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1533725783, "post_id": 51744578, "comment_id": 90449510, "body": "@user694733 if you consider the trivial examples yes. Not trivial ones - yes it may have."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1533725908, "post_id": 51744578, "comment_id": 90449585, "body": "@user if you quote me do it properly and do not change the sense of the sentence:  <code>and may have a significant impact</code>  is not the same as &#39;have a significant impact&#39;"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1533725001, "last_edit_date": 1533725001, "creation_date": 1533724659, "answer_id": 51744578, "question_id": 51744299, "link": "https://stackoverflow.com/questions/51744299/declaring-function-arguments-as-const-in-c/51744578#51744578", "title": "Declaring function arguments as const in C", "body": "<pre><code>void foo(const char *arg)\n</code></pre>\n\n<p>declares the pointer to the const char. You cant change the referenced object, but you can change the pointer</p>\n\n<pre><code>void foo(char * const arg)\n</code></pre>\n\n<p>declares the const pointer to the char. You cant change the the pointer, but you can change the referenced object</p>\n\n<pre><code>void foo(const char * const arg)\n</code></pre>\n\n<p>declares the const pointer to the const char. You cant change the the pointer and the referenced object</p>\n\n<p>declaring parameters allows many compile time optimizations and may have a significant impact on the performance of the generated code.</p>\n\n<p>It is considered a very good practice to use <code>const</code> for the parameters and variables which should not change. Is is called the <em>\"const correctness\"</em></p>\n\n<p>Futher reading: <code>restrict</code> keyword.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1533725076, "creation_date": 1533725076, "answer_id": 51744715, "question_id": 51744299, "link": "https://stackoverflow.com/questions/51744299/declaring-function-arguments-as-const-in-c/51744715#51744715", "title": "Declaring function arguments as const in C", "body": "<p>in <code>void f1(const char *arg)</code> the argument <code>arg</code> itself is not <code>const</code> qualified, it is defined as a pointer to an array of <code>char</code> that the function should not modify. This is very useful for the reader to understand at first glance that the function <code>f1</code> does not modify the string it receives.</p>\n\n<p>For example <code>strcpy</code> is declared in <code>&lt;string.h&gt;</code> as:</p>\n\n<pre><code>char *strcpy(char *dest, const char *src);\n</code></pre>\n\n<p>The array pointed to by the first argument is modified, it is the destination array, the second argument points to the source array, which is not modified.</p>\n\n<p>This type of <code>const</code> qualification is viral: once you define an argument as pointing to a <code>const</code> object, you can only pass it to functions that have similarly <code>const</code> qualified arguments.</p>\n\n<p>Regarding the impact on performance, there is no downside. Some compilers might even benefit from this qualifications and generate better code.</p>\n\n<p>So in your example, if <code>f1</code> does not modify the array pointed to by <code>arg</code>, unless you need to store <code>f1</code> in a function pointer of type <code>void (*)(char*)</code> and cannot change this type, I strongly advise to use:</p>\n\n<pre><code>void f1(const char *arg);\n</code></pre>\n"}], "owner": {"reputation": 929, "user_id": 7233022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77dyV.jpg?s=128&g=1", "display_name": "Fakher Mokadem", "link": "https://stackoverflow.com/users/7233022/fakher-mokadem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 51744421, "answer_count": 4, "score": 1, "last_activity_date": 1533756406, "creation_date": 1533723764, "question_id": 51744299, "link": "https://stackoverflow.com/questions/51744299/declaring-function-arguments-as-const-in-c", "title": "Declaring function arguments as const in C", "body": "<p>What is the use of declaring arguments of a function in C as const? Does it have an impact on performance? </p>\n\n<p>e.g. why would you prefer f1 to f2? Or f2 to f1?</p>\n\n<pre><code>void f1(const char* arg) {\n/* some code */\n}\n\nvoid f2(char* arg) {\n/* some code */\n}\n</code></pre>\n"}, {"tags": ["c", "apache-zookeeper", "solaris"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1534159106, "post_id": 51744237, "comment_id": 90595926, "body": "Try running your process under <a href=\"https://docs.oracle.com/cd/E88353_01/html/E37839/truss-1.html\" rel=\"nofollow noreferrer\">the <code>truss</code> utility</a> to see what calls it&#39;s actually making.  If you can get the arguments actually passed to <code>connect()</code> you may be able to find what&#39;s going wrong.  Something like <code>truss -f -a -vall -o &#47;path&#47;to&#47;output&#47;file .&#47;cli_mt</code> will trace all calls your program makes into the kernel, including the <code>connect</code> call."}], "owner": {"reputation": 41, "user_id": 9957475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f29622ca1f9392d1ca925e2f24c0db?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwini J", "link": "https://stackoverflow.com/users/9957475/ashwini-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533916234, "creation_date": 1533723587, "last_edit_date": 1533916234, "question_id": 51744237, "link": "https://stackoverflow.com/questions/51744237/zookeeper-3-4-12-c-client-fails-to-connect-to-zookeeper-server-on-solaris11-mach", "title": "ZooKeeper 3.4.12 C client fails to connect to ZooKeeper server on Solaris11 machine", "body": "<p>I compiled the ZooKeeper 3.4.12 C client on Solaris 11 machine and trying to test it through cli.sh. Here is the sample code that I changed in cli.c. Whenever I run the ./cli_mt file it always throws below error</p>\n\n<blockquote>\n  <p>2018-08-08 09:49:44,437:18000(0x2):ZOO_ERROR@handle_socket_error_msg@1670: Socket [10.272.80.184:4831] zk retcode=-4, errno=0(Error 0): connect() call failed. </p>\n</blockquote>\n\n<p>Anybody facing same issue?.</p>\n\n<hr>\n\n<h2>cli.c file</h2>\n\n<pre><code>int main(int argc, char **argv) \n{\n#ifndef THREADED\n    fd_set rfds, wfds, efds;\n    int processed = 0;\n#endif\n    char p[2048];\n#ifdef YCA  \n    char *cert = 0;\n    char appId[64];\n#endif\n    char buffer[4096];\n    int bufoff;\n    struct Stat stat;\n    int buflen = sizeof(buffer);\n    int rc;\n    verbose = 0;\n\n    zoo_set_debug_level(ZOO_LOG_LEVEL_WARN);\n    zoo_deterministic_conn_order(1); // enable deterministic order\n    hostPort = argv[1];\n    printf(\"\\n%s\\n\", \"Lets connect\");\n    zh = zookeeper_init(\"sld06hzt:4831\", watcher, 30000, &amp;myid, 0, 0);\n    if (!zh) {\n        printf(\"\\n%d\\n\", errno);\n        return errno;\n    }\n    strcpy(p,\"sadmin:ldap\");\n    zoo_add_auth(zh, \"digest\", p,strlen(p), 0, 0);\n    rc = zoo_get(zh, \"/test\", 0, buffer, &amp;buflen, &amp;stat);\n    if (rc) {\n        printf(\"\\n%s\\n\", buffer);\n    }\n    zookeeper_close(zh);\n    return 2;\n}\n</code></pre>\n\n<p>Regards,\nAshwini.</p>\n"}, {"tags": ["c", "arrays", "pivot"], "comments": [{"owner": {"reputation": 359, "user_id": 8501464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFpwl.jpg?s=128&g=1", "display_name": "Yi\u011fit Aras Tunal\u0131", "link": "https://stackoverflow.com/users/8501464/yi%c4%9fit-aras-tunal%c4%b1"}, "edited": false, "score": 1, "creation_date": 1533723396, "post_id": 51744120, "comment_id": 90448109, "body": "Are you trying to find the middle point of the sorted array?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533723616, "post_id": 51744120, "comment_id": 90448232, "body": "for (int i=1;i&lt;numsSize;i++) Start i from 0 or make i&lt;=numsSize."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533724141, "post_id": 51744120, "comment_id": 90448537, "body": "What is the expected result if the left sum and the right sum are not exactly identical? What is the input you feed into that function?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1533724219, "post_id": 51744120, "comment_id": 90448582, "body": "Your right sum runs beyond the array: <code>for(int i=index+1;i&lt;=numsSize;i++)</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533724272, "post_id": 51744120, "comment_id": 90448617, "body": "@kiranBiradar Your second suggested option is likely to cause out of bounds access"}, {"owner": {"reputation": 266, "user_id": 6861839, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-pxwb2SViXXk/AAAAAAAAAAI/AAAAAAAAALE/FT31pIQbQJU/photo.jpg?sz=128", "display_name": "AJA", "link": "https://stackoverflow.com/users/6861839/aja"}, "edited": false, "score": 0, "creation_date": 1533725075, "post_id": 51744120, "comment_id": 90449074, "body": "Can yout post the array you are running the function on? Also what do you mean by <code>numsSize</code>? Is it the size of the array or the biggest index in the array?"}, {"owner": {"reputation": 1, "user_id": 7975712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/371au.jpg?s=128&g=1", "display_name": "3syF", "link": "https://stackoverflow.com/users/7975712/3syf"}, "edited": false, "score": 0, "creation_date": 1533728193, "post_id": 51744120, "comment_id": 90451054, "body": "Given an array of integers nums, write a method that returns the &quot;pivot&quot; index of this array.  We define the pivot index as the index where the sum of the numbers to the left of the index is equal to the sum of the numbers to the right of the index.  If no such index exists, we should return -1. If there are multiple pivot indexes, you should return the left-most pivot index."}, {"owner": {"reputation": 1, "user_id": 7975712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/371au.jpg?s=128&g=1", "display_name": "3syF", "link": "https://stackoverflow.com/users/7975712/3syf"}, "edited": false, "score": 0, "creation_date": 1533728285, "post_id": 51744120, "comment_id": 90451111, "body": "numSize is the size of the array."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "is_accepted": false, "score": 2, "last_activity_date": 1533723528, "creation_date": 1533723528, "answer_id": 51744223, "question_id": 51744120, "link": "https://stackoverflow.com/questions/51744120/finding-the-pivot-of-an-array-c-program/51744223#51744223", "title": "Finding the pivot of an Array- C Program", "body": "<p>This was a good chance for starting to learn debugging.</p>\n\n<blockquote>\n<pre><code>int rightsum(int *nums, int index,int numsSize) {\n    int rsum=0;\n\n    for(int i=index+1;i&lt;=numsSize;i++)\n        rsum += nums[i];\n    return rsum; }\n</code></pre>\n</blockquote>\n\n<p>Here condition in for loop should be <code>i&lt;numsSize</code> and not <code>i&lt;=numsSize</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7975712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/371au.jpg?s=128&g=1", "display_name": "3syF", "link": "https://stackoverflow.com/users/7975712/3syf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533723528, "creation_date": 1533723221, "question_id": 51744120, "link": "https://stackoverflow.com/questions/51744120/finding-the-pivot-of-an-array-c-program", "title": "Finding the pivot of an Array- C Program", "body": "<p>I have to find the pivot of a given array. Please tell me what is wrong with this implementation. It always returns -1. </p>\n\n<pre><code>int leftsum(int *nums, int index)\n{\n    int lsum=0;\n\n        for(int i=0;i&lt;index;i++)\n            lsum += nums[i];\n    return lsum;\n}\nint rightsum(int *nums, int index,int numsSize)\n{\n    int rsum=0;\n\n    for(int i=index+1;i&lt;=numsSize;i++)\n        rsum += nums[i];\n    return rsum;\n}\n\nint pivotIndex(int* nums, int numsSize) \n{ \n   for (int i=1;i&lt;numsSize;i++)\n   {\n      if(leftsum(nums,i) == rightsum(nums,i,numsSize))  \n         return i;\n   }\n\n\n   return -1;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1533723381, "post_id": 51744050, "comment_id": 90448102, "body": "Don&#39;t pass the address of <code>ptq</code> in the <code>printf</code> call. See other answers that you must calculate the result <i>after</i> reading the input."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1533723533, "post_id": 51744050, "comment_id": 90448181, "body": "Read carefully <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">documentation of <code>scanf</code></a>. You should use its return count. See also <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "is_accepted": true, "score": 1, "last_activity_date": 1533723284, "creation_date": 1533723284, "answer_id": 51744143, "question_id": 51744050, "link": "https://stackoverflow.com/questions/51744050/my-input-from-scanf-isnt-stored/51744143#51744143", "title": "My Input from scanf() isn&#39;t stored", "body": "<p>C is a procedural language, so the lines execute one after the other. You have to use the values after you read them in</p>\n\n<pre><code>int main ()\n{\n  int pq1, pq2;\n  float ptq;\n\n  ptq = pq1 + pq2; // this is undefined as you have not set a value for pq1, pq2\n\n  printf (\"\\t-Prelims-\\n\");\n  printf (\"Grade from Quiz #1?\\n\");\n  printf (\"Grade from Quiz #2?\\n\");\n\n  gotoxy (36, 4);\n  scanf (\"%d\", &amp;pq1);\n  gotoxy (36, 5);\n  scanf (\"%d\", &amp;pq2);\n\n  // now you have values for pq1 and pq2, so this is where you should be using them\n\n  printf (\"Your grades from prelims is %.2f\", &amp;ptq); // here you should be using the value of ptq not its address, as we are outputting it not asking the function to fill it in.\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1984, "user_id": 4337151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0ri.jpg?s=128&g=1", "display_name": "dehasi", "link": "https://stackoverflow.com/users/4337151/dehasi"}, "is_accepted": false, "score": 4, "last_activity_date": 1533723432, "last_edit_date": 1533723432, "creation_date": 1533723303, "answer_id": 51744148, "question_id": 51744050, "link": "https://stackoverflow.com/questions/51744050/my-input-from-scanf-isnt-stored/51744148#51744148", "title": "My Input from scanf() isn&#39;t stored", "body": "<p>Firstly you declare variables;</p>\n\n<p><code>int pq1, pq2;</code></p>\n\n<p>then you try to count the sum</p>\n\n<p><code>ptq = pq1 + pq2;</code></p>\n\n<p>And then you read user input. It is a little bit out of order.</p>\n\n<p>Try to sum after scanning</p>\n\n<pre><code>ptq = pq1 + pq2;\nprintf (\"Your grades from prelims is %.2f\", ptq);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1533723314, "creation_date": 1533723314, "answer_id": 51744150, "question_id": 51744050, "link": "https://stackoverflow.com/questions/51744050/my-input-from-scanf-isnt-stored/51744150#51744150", "title": "My Input from scanf() isn&#39;t stored", "body": "<p>You are adding the numbers before even getting it from user.</p>\n\n<pre><code>  ptq = pq1 + pq2;\n</code></pre>\n\n<p>Move the above line after scanf.</p>\n\n<pre><code>  gotoxy (36, 4);\n  scanf (\"%d\", &amp;pq1);\n  gotoxy (36, 5);\n  scanf (\"%d\", &amp;pq2);\n\n      ptq = pq1 + pq2;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 9022303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f859bade263d222643ef6cfc2de9836d?s=128&d=identicon&r=PG&f=1", "display_name": "Elgirhath", "link": "https://stackoverflow.com/users/9022303/elgirhath"}, "is_accepted": false, "score": 1, "last_activity_date": 1533723497, "last_edit_date": 1533723497, "creation_date": 1533723444, "answer_id": 51744204, "question_id": 51744050, "link": "https://stackoverflow.com/questions/51744050/my-input-from-scanf-isnt-stored/51744204#51744204", "title": "My Input from scanf() isn&#39;t stored", "body": "<p>You declare <code>pq1</code> and <code>pq2</code> without specifying their value. Then you define <code>ptq = pq1 + pq2</code> so <code>ptq</code> doesn't really store any wanted value. After using <code>scanf()</code> your <code>pq1</code> and <code>pq2</code> change but <code>ptq</code> doesn't.</p>\n\n<p>You need to calculate your <code>ptq</code> after <code>scanf()</code>:</p>\n\n<pre><code>ptq = pq1 + pq2;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10196840, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pES3tLpkz0c/AAAAAAAAAAI/AAAAAAAAABU/sVOR-fMzr_0/photo.jpg?sz=128", "display_name": "November Orlando", "link": "https://stackoverflow.com/users/10196840/november-orlando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1533735141, "accepted_answer_id": 51744143, "answer_count": 4, "score": -1, "last_activity_date": 1533723497, "creation_date": 1533723041, "question_id": 51744050, "link": "https://stackoverflow.com/questions/51744050/my-input-from-scanf-isnt-stored", "closed_reason": "Not suitable for this site", "title": "My Input from scanf() isn&#39;t stored", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main ()\n{\n  int pq1, pq2;\n  float ptq;\n\n  ptq = pq1 + pq2;\n\n  printf (\"\\t-Prelims-\\n\");\n  printf (\"Grade from Quiz #1?\\n\");\n  printf (\"Grade from Quiz #2?\\n\");\n\n  gotoxy (36, 4);\n  scanf (\"%d\", &amp;pq1);\n  gotoxy (36, 5);\n  scanf (\"%d\", &amp;pq2);\n\n  printf (\"Your grades from prelims is %.2f\", &amp;ptq);\n\n  return 0;\n}\n</code></pre>\n\n<p>My input in scanf doesn't save and the grades in prelims always display 0.00 and didn't compute.</p>\n\n<p>pls help. I'm a beginner at this.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1533722468, "post_id": 51743694, "comment_id": 90447560, "body": "Post the number it returns. Converted to hexadecimal representation, it will likely be an error code. Which means <code>return 0;</code> isn&#39;t actually reached but instead there&#39;s a segmentation fault for instance because of a bug in your code, and the program was aborted."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1533722555, "post_id": 51743694, "comment_id": 90447612, "body": "Unrelated, every time a pointer type is hidden in a <code>typedef</code> alias, a kitten dies. Don&#39;t kill kittens. There are two exceptions to that, and neither are at play here. To your question, change <code>lista l;</code> to <code>lista l = NULL;</code>, (and yes, that really hurt to write). Your initial list head pointer, <code>l</code>, is used to set the first-inserted node&#39;s <code>next</code> pointer. Being an indeterminate value, your program invokes undefined behavior when you eventually try to dereference that pointer (such as when you print)."}, {"owner": {"reputation": 17, "user_id": 9210970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d2d81a00d6fdef1dd6a9c8e46ba6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_mb_98", "link": "https://stackoverflow.com/users/9210970/sam-mb-98"}, "edited": false, "score": 0, "creation_date": 1533722734, "post_id": 51743694, "comment_id": 90447741, "body": "process returned -1073741819 (0xC0000005)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1533722797, "post_id": 51743694, "comment_id": 90447779, "body": "@Sam_mb_98 they say it is rude to ask people to google but next time please google the hex code first: <a href=\"https://answers.microsoft.com/en-us/windows/forum/windows_10-performance-winpc/application-error-0xc0000005/6224ae45-a251-4f21-b076-74524618d00a\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/windows/forum/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 9210970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d2d81a00d6fdef1dd6a9c8e46ba6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_mb_98", "link": "https://stackoverflow.com/users/9210970/sam-mb-98"}, "edited": false, "score": 0, "creation_date": 1533723012, "post_id": 51743694, "comment_id": 90447887, "body": "thank you very much WhozCraig you gave me very helpful tips. Now it returns 0."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533723143, "post_id": 51743694, "comment_id": 90447965, "body": "In case you&#39;re wondering, that &quot;big number&quot; was an access violation followed by program termination. Running to the end of the list, then dereferencing a garbage indeterminate pointer because it isn&#39;t a determine NULL will do that."}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 3, "last_activity_date": 1533723027, "creation_date": 1533723027, "answer_id": 51744047, "question_id": 51743694, "link": "https://stackoverflow.com/questions/51743694/program-doesnt-return-0-it-works-but-returns-a-very-big-negative-number/51744047#51744047", "title": "program doesn&#39;t return 0. It works but returns a very big negative number", "body": "<p>The code in your insertion function does this:</p>\n\n<pre><code>p-&gt;el = el;\np-&gt;next = *l;\n</code></pre>\n\n<p>where <code>l</code> contains the address of the list head you passed in. On the initial node insertion, that pointer must be NULL (properly so to indicate an empty list). But yours....</p>\n\n<pre><code>lista l;\n</code></pre>\n\n<p>There is no determinate value assigned to <code>l</code>. If you want that to be initially NULL, you have to say so:</p>\n\n<pre><code>lista l = NULL;\n</code></pre>\n\n<p>Doing this, your program completes without runtime errors.</p>\n"}], "owner": {"reputation": 17, "user_id": 9210970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d2d81a00d6fdef1dd6a9c8e46ba6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_mb_98", "link": "https://stackoverflow.com/users/9210970/sam-mb-98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51744047, "answer_count": 1, "score": 1, "last_activity_date": 1533723027, "creation_date": 1533721962, "last_edit_date": 1533722462, "question_id": 51743694, "link": "https://stackoverflow.com/questions/51743694/program-doesnt-return-0-it-works-but-returns-a-very-big-negative-number", "title": "program doesn&#39;t return 0. It works but returns a very big negative number", "body": "<p>This code inserts nodes at a beginning of a list. I compiled it and it works perfectly the only problem is that the process does not return 0 but a very big negative number. How can i solve this problem?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef int data;\n\nstruct nodo\n{\n    data el;\n    struct nodo *next;\n};\n\ntypedef struct nodo *lista;\n\n\nvoid inserisci_in_testa (lista *l, data el);\n\nvoid print (lista temp1);\n\n\n\nint main ()\n{\n    lista l;\n    lista *s;\n    s=&amp;l;\n    inserisci_in_testa(s,10);\n    inserisci_in_testa(s,1);\n    inserisci_in_testa(s,7);\n    print(l);\n    return 0;\n\n\n}\n\nvoid inserisci_in_testa (lista *l, data el)\n{\n    lista p = malloc(sizeof(struct nodo));\n    p-&gt;el = el;\n    p-&gt;next = *l;\n    *l = p;\n}\n\nvoid print (lista temp1)\n{\n    while (temp1!= NULL)\n    {\n        printf(\"%d \", temp1-&gt;el);\n        temp1 = temp1-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "unsigned-integer"], "comments": [{"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533722351, "post_id": 51743602, "comment_id": 90447492, "body": "Give me a code example of the use of the function <code>getBits</code>. I&#39;ll think to call it as: <code>getBits(&quot;-1&quot;,&quot;+10&quot;,&quot;1.2349&quot;)</code> to represent the number -1.2349E+10, it&#39;s correct?"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533722415, "post_id": 51743602, "comment_id": 90447539, "body": "You used (unsigned int *) where you have to use (unsigned int). But if I understood your idea the code is not correctly implemented."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533722782, "post_id": 51743602, "comment_id": 90447772, "body": "How is <code>Union32</code> defined!? You cannot store separete value into a <code>union</code>, you have to use a <code>struct</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533722819, "post_id": 51743602, "comment_id": 90447792, "body": "@SirJoBlack I do not think that &quot;1.2349&quot; represents the integer value. Your example is bad. Give a more sane one."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533722887, "post_id": 51743602, "comment_id": 90447825, "body": "@SirJoBlack probably it union of the bitfield struct and another 32 bits data. As you see there are two dots which implies a nested struct or union"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533723064, "post_id": 51743602, "comment_id": 90447913, "body": "My question is the use of the function! How do you use the function? Give me a real example of a call to this function."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1533723155, "post_id": 51743602, "comment_id": 90447972, "body": "We need the definition of the type <code>Union32</code> to understand the open points."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1533722063, "creation_date": 1533722063, "answer_id": 51743732, "question_id": 51743602, "link": "https://stackoverflow.com/questions/51743602/how-to-store-string-of-numbers-into-unsigned-integer-in-c/51743732#51743732", "title": "how to store string of numbers into unsigned integer in C", "body": "<p>assuming the correct typedefs in your code:</p>\n\n<pre><code>   new.bits.sign = (unsigned int)atoi(sign);\n   new.bits.exp = (unsigned int)atoi(exp);\n   new.bits.frac = (unsigned int)atoi(frac);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9858797, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Fangyi Guo", "link": "https://stackoverflow.com/users/9858797/fangyi-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533791906, "creation_date": 1533721750, "last_edit_date": 1533791906, "question_id": 51743602, "link": "https://stackoverflow.com/questions/51743602/how-to-store-string-of-numbers-into-unsigned-integer-in-c", "title": "how to store string of numbers into unsigned integer in C", "body": "<p>Actually, I have to convert from command arguments which are three strings to bit field(three unsigned integers inside). This program is going to convert from bits into float. I firstly thought about using array to store the three arguments,but I don't really know how to convert from array to unsigned int. Should I just use atoi to change arg into int and then directly into unsigned int?  It doesn't word on my computer. Got no idea.</p>\n\n<pre><code>Union32 getBits(char *sign, char *exp, char *frac)\n{\n    Union32 new;\n\n   // this line is just to keep gcc happy\n   // delete it when you have implemented the function\n   //new.bits.sign = new.bits.exp = new.bits.frac = 0;\n\n   new.bits.sign = *(unsigned int *)atoi(sign);\n   new.bits.exp = *(unsigned int *)atoi(exp);\n   new.bits.frac = *(unsigned int *)atoi(frac);\n   //int i ;\n   //int balah[8] = {};\n   //for(i = 0; i &lt; 8; i++){\n   //balah[i] = sign[i];\n   //}\n\n   //int j ;\n   //int bili[23] = {};\n   //for(j = 0; j &lt; 23; j++){\n      //bili[j] = sign[j];\n   //}\n\n   //convert array into unsigned integer?\n   printf(\"%u %u %u\\n\", new.bits.sign, new.bits.exp, new.bits.frac);\n\n\n   // convert char *sign into a single bit in new.bits\n\n   // convert char *exp into an 8-bit value in new.bits\n\n   // convert char *frac into a 23-bit value in new.bits\nenter code here\n   return new;\n}\n</code></pre>\n\n<p>The following are the details about the typedef and unions that needed in this program, also the four functions in this program.</p>\n\n<pre><code>typedef uint32_t Word;\n\nstruct _float {\n   // define bit_fields for sign, exp and frac\n   // obviously they need to be larger than 1-bit each\n   // and may need to be defined in a different order\n   unsigned int sign:1, exp:8, frac:23;\n};\ntypedef struct _float Float32;\n\nunion _bits32 {\n   float   fval;  // interpret the bits as a float\n   Word    xval;  // interpret as a single 32-bit word\n   Float32 bits;  // manipulate individual bits\n};\ntypedef union _bits32 Union32;\n\nvoid    checkArgs(int, char **);\nUnion32 getBits(char *, char *, char *);\nchar   *showBits(Word, char *);\nint     justBits(char *, int);\n</code></pre>\n\n<p>getBits asks us to convert bits into float,\nand showBits asks us to convert float into bits.</p>\n"}, {"tags": ["c", "vulkan"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533722572, "post_id": 51743500, "comment_id": 90447627, "body": "I think that their idea was to make it sure for C &amp; C++ are 64 bits and to not realy of the built in typed. But their idea is IMO quite weird"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1533723001, "post_id": 51743500, "comment_id": 90447884, "body": "The hack with the struct and the ## token pasting operator makes handles type safe.  You get different struct types with different handle types, mixing them up in code now produces a compile error.  This was probably discovered to be useful long after they committed to a plain integer type in earlier 32-bit only releases, hard to make such a change since it can produce build errors on buggy code that somehow chugged along anyway.  I would guess that somebody was inspired by the way handles are declared another widely used api."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1533724478, "post_id": 51743500, "comment_id": 90448742, "body": "It is just a cludge. Under the hood they are usually pointers. I guess they are 64 bit to support 64 bit platforms. It is probably desirable they are the same size on 32 bit platforms. So 64 bits, even if only 32 are used. Therefore they cannot be defined as pointers on the 32 bit platform. Using 64 bit integers on a 64 bit platform when they are actually 64 bit pointers may have some subtle disadvantage. The whole point of &quot;handles&quot; is encapsulation so, in theory, you do not care what the type is."}, {"owner": {"reputation": 9788, "user_id": 507043, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/kPUHE.png?s=128&g=1", "display_name": "Michael IV", "link": "https://stackoverflow.com/users/507043/michael-iv"}, "reply_to_user": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1576580913, "post_id": 51743500, "comment_id": 104938514, "body": "@WilliamJBagshaw I doubt they use pointers under the hood. If at the bottom they allocate from an array,then the pointers may become invalidated once the array is resized. Those probably indices converted to pointer values."}], "answers": [{"tags": [], "owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "is_accepted": true, "score": 5, "last_activity_date": 1533813258, "last_edit_date": 1533813258, "creation_date": 1533724118, "answer_id": 51744397, "question_id": 51743500, "link": "https://stackoverflow.com/questions/51743500/why-do-non-dispatchable-handles-use-a-ptr-on-64bit-platofrms/51744397#51744397", "title": "Why do non dispatchable handles use a ptr on 64bit platofrms?", "body": "<p>It isn't necessary that they use pointers, only that they are 64 bit.</p>\n\n<p>The reason pointers are used when possible is because C and C++ don't have strong typedefs so using pointers give a little bit of extra type safety because you cannot assign a <code>VkImageView_T*</code> to a <code>VkImage_T*</code>.</p>\n"}], "owner": {"reputation": 13772, "user_id": 944430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d2b181af01c96927ac05eb864d6b7b6?s=128&d=identicon&r=PG", "display_name": "Maik Klein", "link": "https://stackoverflow.com/users/944430/maik-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 51744397, "answer_count": 1, "score": 3, "last_activity_date": 1533813258, "creation_date": 1533721416, "question_id": 51743500, "link": "https://stackoverflow.com/questions/51743500/why-do-non-dispatchable-handles-use-a-ptr-on-64bit-platofrms", "title": "Why do non dispatchable handles use a ptr on 64bit platofrms?", "body": "<p>Why are non dispatchable handles not always a <code>uint64_t</code>? Why is it neccessary that they are represented as a <code>ptr</code> on 64bit platforms?</p>\n\n<pre><code>#if !defined(VK_DEFINE_NON_DISPATCHABLE_HANDLE)\n#if defined(__LP64__) || defined(_WIN64) || (defined(__x86_64__) &amp;&amp; !defined(__ILP32__) ) || defined(_M_X64) || defined(__ia64) || defined (_M_IA64) || defined(__aarch64__) || defined(__powerpc64__)\n        #define VK_DEFINE_NON_DISPATCHABLE_HANDLE(object) typedef struct object##_T *object;\n#else\n        #define VK_DEFINE_NON_DISPATCHABLE_HANDLE(object) typedef uint64_t object;\n#endif\n#endif\n</code></pre>\n\n<p>The spec says</p>\n\n<blockquote>\n  <p>Non-dispatchable handle types are a 64-bit integer type whose meaning is implementation-dependent, and may encode object information directly in the handle rather than acting as a reference to an underlying object. Objects of a non-dispatchable type may not have unique handle values within a type or across types. If handle values are not unique, then destroying one such handle must not cause identical handles of other types to become invalid, and must not cause identical handles of the same type to become invalid if that handle value has been created more times than it has been destroyed.</p>\n</blockquote>\n"}, {"tags": ["c", "stm32"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1533720396, "post_id": 51742789, "comment_id": 90446185, "body": "Why don&#39;t you use just STM32 hal libraries? Or just STM32CubeMX? Have you enabled timer peripheral clock, smth like <code>__HAL_RCC_TIM6_CLK_ENABLE()</code> ? By creating your own hal libraries you are reinventing the wheel."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1533720845, "post_id": 51742789, "comment_id": 90446499, "body": "@KamilCuk those low level <code>__HAL..</code>  are ok but the HAL itself is rubbish"}, {"owner": {"reputation": 1, "user_id": 10196158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c6ed1b9bf106d4e6f59fdf814fa91?s=128&d=identicon&r=PG&f=1", "display_name": "OGI-Jess", "link": "https://stackoverflow.com/users/10196158/ogi-jess"}, "edited": false, "score": 0, "creation_date": 1533720971, "post_id": 51742789, "comment_id": 90446589, "body": "I am not using HAL till now and for so short modification I don&#39;t want to implement new libs :) // It cannot be done on normal TIMers?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1533721147, "post_id": 51742789, "comment_id": 90446693, "body": "Do not be offended, but (IMO) your algorithm is extremely bad and actually I do not see any way to improve it except writing a new better code."}, {"owner": {"reputation": 1, "user_id": 10196158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c6ed1b9bf106d4e6f59fdf814fa91?s=128&d=identicon&r=PG&f=1", "display_name": "OGI-Jess", "link": "https://stackoverflow.com/users/10196158/ogi-jess"}, "edited": false, "score": 0, "creation_date": 1533721818, "post_id": 51742789, "comment_id": 90447115, "body": "I am not, I&#39;ve been considering it my self. How would you try to interrupt switch after 100ms if the program hangs on receiving frame? I&#39;ve been thinking about interruptions it selves but If I am not gonna find a better solution than the one I am working on I will just check if the bit is a starting marker and by that start reading frame over."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10196158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c6ed1b9bf106d4e6f59fdf814fa91?s=128&d=identicon&r=PG&f=1", "display_name": "OGI-Jess", "link": "https://stackoverflow.com/users/10196158/ogi-jess"}, "edited": false, "score": 0, "creation_date": 1533724122, "post_id": 51743996, "comment_id": 90448530, "body": "Right, thank you for your time. That helped me a little with understanding how the TIMers works. There is a copy/paste mistake in the time comment. This clock counts in milliseconds. The delay itself you saying is built wrong but It does hold the program for the designed time, is it a bad habit to do it like that?"}], "tags": [], "owner": {"reputation": 59, "user_id": 8035876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377f144eac47be15bf90e420bade993d?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek Wo\u017aniak", "link": "https://stackoverflow.com/users/8035876/bartek-wo%c5%baniak"}, "is_accepted": false, "score": 0, "last_activity_date": 1533722836, "creation_date": 1533722836, "answer_id": 51743996, "question_id": 51742789, "link": "https://stackoverflow.com/questions/51742789/stm32-using-timer-to-break-loop/51743996#51743996", "title": "STM32 Using TIMer to break loop", "body": "<blockquote>\n  <p>Is the counter set right?</p>\n</blockquote>\n\n<p>Not really. There are a lot of problems in your timer configuration, lets try to spot some of them:</p>\n\n<pre><code>#define SYSCLK_FREQ 131072\nTIM6-&gt;PSC = (SYSCLK_FREQ/1000)-1; //100us\n</code></pre>\n\n<ol>\n<li>Timer is connected to some APB bus (1 or 2), which can be also\ndivided. If You set new APB divider value, your timer will no longer\nwork as you would expect. </li>\n<li><p>Clock frequency = 131072 ? Independent of unit, you will not achieve 100us period by dividing it by 1000.</p>\n\n<p><code>void delay(uint16_t n_ms)\n{\n    //upcounting timer - 16bit\n    TIM6-&gt;CNT = 65535-n_ms;\n    TIM6-&gt;CR1 = TIM_CR1_CEN | TIM_CR1_OPM; //one-pulse mode\n    while(!(TIM6-&gt;SR &amp; TIM_SR_UIF)); //wait\n    TIM6-&gt;SR = 0;\n}</code></p></li>\n</ol>\n\n<p>This is not the way you use timer. If you want to measure some time, just set ARR to right value and start the counter.</p>\n\n<p>Your <code>timer_tick(uint16_t n_ms)</code> is totaly wrong. Counter is upcounting from 0 to ARR value, then stops (if one pulse mode is set).  Firstly, set all the timer configuration registers, then start the counter. If you start the counter, then modify ARR, CCRX or other registers, you can be 100% sure, that timer will fall.</p>\n"}], "owner": {"reputation": 1, "user_id": 10196158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c6ed1b9bf106d4e6f59fdf814fa91?s=128&d=identicon&r=PG&f=1", "display_name": "OGI-Jess", "link": "https://stackoverflow.com/users/10196158/ogi-jess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 978, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533722836, "creation_date": 1533719432, "question_id": 51742789, "link": "https://stackoverflow.com/questions/51742789/stm32-using-timer-to-break-loop", "title": "STM32 Using TIMer to break loop", "body": "<h2>So I've initialized a timer which I want to count for 100</h2>\n\n<p>main section where stm32 works.</p>\n\n<pre><code>#include \"stm32l0xx.h\"\n\n#define SYSCLK_FREQ 131072\n\nvoid timer_tick(uint16_t n_ms);\n\nint main(void)\n{\n    TIM6-&gt;PSC = (SYSCLK_FREQ/1000)-1; //100us   \n    TIM6-&gt;CR1 = TIM_CR1_CEN | TIM_CR1_OPM; //one-pulse mode\n    TIM6-&gt;EGR = TIM_EGR_UG; //generate update\n    TIM6-&gt;SR=0; //clear update - after few instructions\n...\n}\n</code></pre>\n\n<hr>\n\n<p>first time I am using the timer there, its declared right after main</p>\n\n<pre><code>void delay(uint16_t n_ms)\n{\n    //upcounting timer - 16bit\n    TIM6-&gt;CNT = 65535-n_ms;\n    TIM6-&gt;CR1 = TIM_CR1_CEN | TIM_CR1_OPM; //one-pulse mode\n    while(!(TIM6-&gt;SR &amp; TIM_SR_UIF)); //wait\n    TIM6-&gt;SR = 0;   \n}\n</code></pre>\n\n<hr>\n\n<p>than Iam using the same timer (becouse I have only TIM3 which I cannot interupt and TIM6 used only for delay function)</p>\n\n<pre><code>void timer_tick(uint16_t n_ms)\n{\n    //upcounting timer - 16bit\n    TIM6-&gt;CNT = 65535-n_ms;\n    TIM6-&gt;CR1 = TIM_CR1_CEN | TIM_CR1_OPM; //one-pulse mode\n    TIM6-&gt;ARR = n_ms-1; // Auto reload value \n    TIM6-&gt;CCR1 = n_ms; // Start PWM duty for channel 3 \n    //TIM6-&gt;CCR2 = n_ms; // Start PWM duty for channel 4 \n    TIM6-&gt;CCMR1 = TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1 | TIM_CCMR1_OC2M_2 | TIM_CCMR1_OC2M_1;  // PWM mode on channel 1 &amp; 2 \n    TIM6-&gt;CCER = TIM_CCER_CC1E | TIM_CCER_CC2E; // Enable compare on channel 1 &amp; 2 \n    TIM6-&gt;DIER = TIM_DIER_UIE; // Enable TIM6 interrupt\n    TIM6-&gt;SR = 0;   \n}\n</code></pre>\n\n<hr>\n\n<p>And here working on interupt. Iam calling the function to start the clock counting to 100 (Iam assuiming its right) than interuption realising switch that can work only 100 ms - after its gotta stop working on it and break the loop.</p>\n\n<pre><code>void USART1_IRQHandler(void)\n{\n    static enum {00, 01, 02, 03, CRC} next_frame = 00; // frame construction\n\n    if(!sending_flag) //half-duplex\n    {\n        if(USART1-&gt;ISR&amp;USART_ISR_FE) //frame error check&amp;clear\n            USART1-&gt;ICR = USART_ICR_FECF;\n        else\n        timer_tick(100);\n        do {\n            switch(next_frame)\n            {\n                case 00:{ DOSTUFF; next_frame=01; break; } //starting marker\n                case 01:{ DOSTUFF; next_frame=02; break; } \n                case 02:{ DOSTUFF; next_frame=03; break; } \n                case 03:{ DOSTUFF; next_frame=CRC; break; } \n                case CRC:{ TIM6-&gt;SR = ~TIM_SR_CC2IF; break; } // clear flag\n                default: break; \n            }   \n        } while (!(TIM6-&gt;SR&amp;TIM_SR_CC2IF)); //TIM_SR_UIF\n    }\n\n    if(USART1-&gt;ISR &amp; USART_ISR_TC)\n    {\n        USART1-&gt;ICR = USART_ICR_TCCF;\n        GPIOA-&gt;BSRR = GPIO_BSRR_BR_11 | GPIO_BSRR_BR_12;\n        sending_flag=0;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>I dont realy understend <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/63/3c/c0/51/1c/fb/44/d4/DM00108281.pdf/files/DM00108281.pdf/jcr:content/translations/en.DM00108281.pdf\" rel=\"nofollow noreferrer\">documentation</a> of my STM about the timers. \nHaving this line set like that <code>TIM6-&gt;CCR1 = n_ms; // Start PWM duty for channel 3</code> Iam assuming there should be a flag at <code>TIM6-&gt;SR&amp;TIM_SR_CC2IF</code> after timer reach <code>TIM6-&gt;ARR = n_ms-1; // Auto reload value</code>\nAfter adding this <code>do while</code> loop my STM stopped responding and Iam not able to debug it.</p>\n\n<hr>\n\n<ul>\n<li>Is the counter set right?</li>\n<li>Can I use declared timer twice and call it like I do?</li>\n</ul>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 1, "creation_date": 1533718821, "post_id": 51742562, "comment_id": 90445139, "body": "vsprintf is what you are looking for."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1533718845, "post_id": 51742562, "comment_id": 90445149, "body": "Possible strict aliasing issues."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 4, "creation_date": 1533718912, "post_id": 51742562, "comment_id": 90445198, "body": "Worth noting that this isn&#39;t going to make you any faster. The time is in processing the format, not copying a couple of floats. I wouldn&#39;t be at all surprised if it was slower."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1533719041, "post_id": 51742562, "comment_id": 90445288, "body": "what is <code>binary_data</code>? and how the offset <code>4</code> comes?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1533719043, "post_id": 51742562, "comment_id": 90445292, "body": "<code>va_list</code> is often just a pointer, with <code>va_arg</code> incrementing the pointer, so you could write some code to access all the arguments from there. (Not portably, of course, but you say you don&#39;t need that.) But it would still involve parsing the format string to know how many bytes to read."}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1533719118, "post_id": 51742562, "comment_id": 90445347, "body": "@Klaus, I added those tags because I&#39;m open to using c++, boost or fastformat. If that&#39;s not a good use of tags I&#39;ll remove them."}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1533719357, "post_id": 51742562, "comment_id": 90445533, "body": "@Klaus, thanks for your feedback. I removed those tags."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1533719431, "post_id": 51742562, "comment_id": 90445574, "body": "forget about this level microoptimization. Comparing to the printf itself the time you copy the parameters is negligible"}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1533719582, "post_id": 51742562, "comment_id": 90445656, "body": "@appleapple, I added a line showing what binary_data is. I hope it clarifies it. In practice, the offsets come from the post-processing tool actually iterating over the format string, and generating a call to an appropriate template function for each format specifier it encounters, which prints the text up to and including a single format specifier, and then increments the pointer it receives."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1533719926, "post_id": 51742562, "comment_id": 90445868, "body": "@Eli_B if <i>that</i> tool have parsed the format, you can simply print within that tool. I don&#39;t see a need for a separated function."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533719936, "post_id": 51742562, "comment_id": 90445873, "body": "@P__J__ : I don&#39;t think it is intended to be an optimisation, but rather a way of encoding an arbitrary structure of the binary blob in the format string to avoid separately unpacking it then passing to printf."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533720667, "post_id": 51742562, "comment_id": 90446390, "body": "If emitting data via <code>printf()</code> is your performance bottleneck, <b>don&#39;t use <code>printf()</code></b>.  You <b>have</b> profiled your entire application and actually <i>measured</i> performance and located your performance bottlenecks that way?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533721174, "post_id": 51742562, "comment_id": 90446706, "body": "@AndrewHenle : It is true that it will have negligible performance impact.  However it has a significant convenience/maintenance impact - to encode the structure of the binary data in the format string alone."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1533725894, "post_id": 51742562, "comment_id": 90449578, "body": "@Clifford I think you&#39;re underestimating the maintenance impact of reimplementing <code>printf()</code>-style format string parsing."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533736482, "post_id": 51742562, "comment_id": 90456736, "body": "@AndrewHenle : No reimplementation necessary - as described in my answer.  You just need to parse the part of the specifier that describes the width (although strings are problematic perhaps), ignoring the output formatting modifiers. Use that to extract the data, then pass the data and the complete format specifier to <code>printf()</code>.  It is still non-trivial however that is true, which is why in my answer I suggest it is only worth it if you need to do a lot of this on a lot of very different structures."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1533724095, "post_id": 51742911, "comment_id": 90448510, "body": "Note that  <code>...</code> is not a var-arg list. It is just an indication to the compiler that a variable number of arguments may follow in the function call. The macros just work by taking the adress of the first non-<code>...</code> argument, incrementing that with its type-size yielding the first (next) argument. As such, it is viabe to pass the address of this first non-<code>...</code> argument and passing that to a funtion expecting a variable argument list as you have now passed the stack position of the first argument. the va-macros in the called function now work on this argument that it dereferences."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1533724277, "post_id": 51742911, "comment_id": 90448620, "body": "The variables don`t even need to be on the stack. I think a function that he seeks is possible (I just don&#39;t go into the depth of writing it now)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1533724559, "post_id": 51742911, "comment_id": 90448792, "body": "I withdraw my previous comment: alignment is the issue, unless he would write the data in an aligned manner, e.g. write a char as an int. Alignment is implementation dependent and so is not portable."}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533725530, "post_id": 51742911, "comment_id": 90449359, "body": "Thanks for your answer, @Clifford. My current implementation is really almost identical to your suggested approach. I was just wondering whether I could forego iterating over the format string and printing data items one at a time. Hopefully, one day this logging system would be open-sourced and I&#39;ll be able to show you :)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533725793, "post_id": 51742911, "comment_id": 90449516, "body": "@Eli_B The <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c\" rel=\"nofollow noreferrer\">glibc code that parses format strings</a> is well over 2,000 lines, and is extremely complex, involving large, complex macros and fully seven different jump tables. A bug-free reimplementation of that is somewhere between impossible and completely extraneous. What happens in the future when someone else adds a format specifier to the format string that isn&#39;t covered by the necessarily-limited parsing that does get reimplemented?"}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533726628, "post_id": 51742911, "comment_id": 90450044, "body": "@AndrewHenle, hopefully nobody has to reimplement that thing. My implementation only parses the format string to segment it into substrings that contain a single format specifier. I pass those substrings to printf, which fully parses them. I have the benefit of assuming the format string itself is sane, because my_binary_printf is decorated with <b>attribute</b> ((format (printf, 1, 2))), so bad formats won&#39;t hopefully fail to compile."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1533736162, "post_id": 51742911, "comment_id": 90456512, "body": "@PaulOgilvie : regarding <code>...</code> I appreciate the semantics, I was merely using it as a short-hand to indicate the <code>va_start</code> necessarily relies on <code>...</code>; if you were to have a function <code>fn( const char* fmt, int x, int y )</code> and in it use <code>va_start( vl, fmt)</code> <code>vl</code> may not refer to <code>x</code> and <code>y</code> since they may have been passed in registers. <code>...</code> ensures they are referrable by a <code>va_list</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533736709, "post_id": 51742911, "comment_id": 90456886, "body": "@AndrewHenle : You have possibly misunderstood my proposal.  I am not suggesting writing a format string parser, only parsing the information necessary to determine data size - the output formatting remains the responsibility of <code>printf()</code>.  If I get time later I&#39;ll add an implementation (possibly partial) that will make it clearer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533736943, "post_id": 51742911, "comment_id": 90457030, "body": "@Eli_B : I don&#39;t think it matters iterating the format string - you write it once, hide it in a library and forget about the internals - how do you think printf does it for example!?  This is not where you need to optimise."}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533815107, "post_id": 51742911, "comment_id": 90490735, "body": "Thanks again @Clifford, I&#39;ve accepted your answer. I think my question is well-stated, and it did generate interest. I wonder why it was down-voted."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533825018, "post_id": 51742911, "comment_id": 90497898, "body": "@Eli_B In the title at least, you appear to be asking whether printf specifically can do that; to which the answer is clearly &quot;no&quot;.  The answer to the question in the title is to use vprintf, the question in the body differs significantly.  These are possible reasons for a downvote.  However in my experience if you ask a &quot;Can I ...?&quot; question to which the answer is either no, or obvious from documentation, you will attract downvotes.  Better to ask &quot;How can I...?&quot;, avoid making suggestions of your own, and never to ask whether it can be done using a single well documented standard function."}, {"owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "edited": false, "score": 0, "creation_date": 1533829465, "post_id": 51742911, "comment_id": 90501050, "body": "Thanks again @Clifford! I&#39;ll keep it in mind. I did know vprintf wasn&#39;t what I&#39;m looking for, but I was hoping for creative ideas, if not for printf uses than maybe of the form &quot;No, but you can instead ...&quot;. Should I change the title now to something like &quot;How can I pass the parameters to a string formatting operation as a pointer to contiguous memory?&quot; to better serve people in the future?"}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 4, "last_activity_date": 1533721574, "last_edit_date": 1533721574, "creation_date": 1533719794, "answer_id": 51742911, "question_id": 51742562, "link": "https://stackoverflow.com/questions/51742562/printf-can-i-pass-all-the-variadic-arguments-as-a-pointer-instead-of-one-by-on/51742911#51742911", "title": "printf - Can I pass all the variadic arguments as a pointer instead of one-by-one on the stack?", "body": "<p>A solution will involve writing your own format string parser that interprets the format specifiers with data width to extract from the binary blob, such that each format specifier caused the data index to be incremented, and the correct type to be extracted and printed.</p>\n\n<p>Superficially the function <a href=\"http://www.cplusplus.com/reference/cstdio/vprintf/\" rel=\"nofollow noreferrer\">vprintf</a> appears close to what you need, but is not viable.  It takes a single <code>va_list</code> argument which normally you create from a <code>...</code> var-arg list using using <code>va_start</code>, but in your case the input is not a var-arg list, so it is unlikely to work directly on the binary data without first unpacking your binary data - other than by dumb luck, and even then certainly not portable.</p>\n\n<p>The (or at least one) problem with <code>vprintf</code> is a var-arg list is unlikely to be aligned in the same manner as your binary blob; stacked arguments are likely to have fixed alignment and not be contiguous.</p>\n\n<p>The approach I'd suggest here is to parse the format string, print each non-format specifier character directly, extract format specifiers completely (with all modifiers), determine the width/type from the specifier, extract that much data into an appropriate data type, print that single data item using the <em>whole</em> format specifier, and increment the data index by the width.  Continue like that for the entire format string.  It is a lot of work - you'd have to be doing a lot of this to justify the effort - but you only write it once, and it would be generic so may make maintenance simpler.</p>\n\n<p>Note:</p>\n\n<blockquote>\n  <p>My motivation for wanting such a solution is faster post-processing thanks to less copying of the data.</p>\n</blockquote>\n\n<p>That is a poor reason; it will have negligible performance impact.  It is better justified by the simplicity and convenience of encoding arbitrary data structure of the binary blob in the format string.  This may have a significant development, readability and maintenance impact if you have a lot of code like this with many varying data structures to encode.</p>\n"}], "owner": {"reputation": 133, "user_id": 531158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5D94.png?s=128&g=1", "display_name": "Eli_B", "link": "https://stackoverflow.com/users/531158/eli-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 51742911, "answer_count": 1, "score": -2, "last_activity_date": 1533721574, "creation_date": 1533718658, "last_edit_date": 1533719979, "question_id": 51742562, "link": "https://stackoverflow.com/questions/51742562/printf-can-i-pass-all-the-variadic-arguments-as-a-pointer-instead-of-one-by-on", "title": "printf - Can I pass all the variadic arguments as a pointer instead of one-by-one on the stack?", "body": "<p>I have a binary logs system that efficiently writes just the variadic printf arguments to a file at runtime, which is later post-processed to produce the text logs.</p>\n\n<p>My post-processing tool that produces the text logs needs to read each printf argument into a variable, just so it can be passed on the stack to printf.</p>\n\n<p>For example, to produce the text for the call to:</p>\n\n<pre><code>my_binary_printf(\"here's an int: %d, here's a float %f, here's a char: %c\", i, f, c);\n</code></pre>\n\n<p>from the binary file where the int, the float, and the char from runtime are kept,\nI need to do something like:</p>\n\n<pre><code>char *binary_data;  // mmap-ed from the binary file produced at runtime\nint param0 = *((int*) &amp;(binary_data[0]));\nfloat param1 = *((float*) &amp;(binary_data[4]));\nchar param2 = *((char*) &amp;(binary_data[8]));\nprintf(the_format_string, param0, param1, param2);\n</code></pre>\n\n<p>Is there a way to pass all the printf parameters as a pointer to the data? Like:</p>\n\n<pre><code>cool_printf(the_format_string, binary_data);\n</code></pre>\n\n<p>My motivation for wanting such a solution is faster post-processing thanks to less copying of the data.</p>\n\n<p>I don't need to support machines with different endianness at the moment.</p>\n\n<p>I'm very open to using an alternative printing library (like fastformat, or Boost's facilities) if it has the feature I'm looking for.</p>\n"}, {"tags": ["c", "networking"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1533720256, "post_id": 51742537, "comment_id": 90446099, "body": "&#39;sizeof(buffer)&#39; is not what you think it is."}, {"owner": {"reputation": 21, "user_id": 6232103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986c121fb58298386c2fa70049e5e1de?s=128&d=identicon&r=PG&f=1", "display_name": "Crutz", "link": "https://stackoverflow.com/users/6232103/crutz"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1533728530, "post_id": 51742537, "comment_id": 90451291, "body": "Oh my god, i spent so much time on this, and now it was such a little bug. Thank you so much!! :)"}], "owner": {"reputation": 21, "user_id": 6232103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986c121fb58298386c2fa70049e5e1de?s=128&d=identicon&r=PG&f=1", "display_name": "Crutz", "link": "https://stackoverflow.com/users/6232103/crutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1533718651, "creation_date": 1533718572, "last_edit_date": 1533718651, "question_id": 51742537, "link": "https://stackoverflow.com/questions/51742537/tuntap-device-receiving-ping", "title": "TunTap Device receiving ping", "body": "<p>I am trying to get familiar with tuntap devices. I have read the following article:</p>\n\n<p><a href=\"https://backreference.org/2010/03/26/tuntap-interface-tutorial/\" rel=\"nofollow noreferrer\">https://backreference.org/2010/03/26/tuntap-interface-tutorial/</a></p>\n\n<p>but somehow the code from the article doesn't work.</p>\n\n<p>I have this code:</p>\n\n<pre><code>  #include &lt;sys/socket.h&gt; //well get our socket\n  #include &lt;sys/ioctl.h&gt; //thats our input output control\n  #include &lt;sys/time.h&gt;\n  #include &lt;fcntl.h&gt;\n\n\n  #include &lt;asm/types.h&gt; //these are data types liked signed unsingend\n\n  #include &lt;math.h&gt;\n  #include &lt;string.h&gt;\n  #include &lt;stdio.h&gt;\n  #include &lt;stdlib.h&gt;\n  #include &lt;unistd.h&gt; //read write close and stuff\n  #include &lt;signal.h&gt; //different signals\n\n  #include &lt;linux/if_packet.h&gt; //interface for packets\n  #include &lt;linux/if_ether.h&gt; //interface or ethernet frames\n  #include &lt;linux/if_arp.h&gt; //interface for arp\n\n  #include &lt;linux/if.h&gt;\n  #include &lt;linux/if_tun.h&gt;\n\n  #include &lt;arpa/inet.h&gt;\n\n  int tun_alloc(char *dev, int flags) {\n    struct ifreq ifr;\n    int fd, err;\n    char *clonedev = \"/dev/net/tun\";\n\n    /* Arguments taken by the function:\n     *\n     * char *dev: the name of an interface (or '\\0'). MUST have enough\n     *   space to hold the interface name if '\\0' is passed\n     * int flags: interface flags (eg, IFF_TUN etc.)\n     */\n\n     /* open the clone device */\n     if( (fd = open(clonedev, O_RDWR)) &lt; 0 ) {\n       return fd;\n     }\n\n     /* preparation of the struct ifr, of type \"struct ifreq\" */\n     memset(&amp;ifr, 0, sizeof(ifr));\n\n     ifr.ifr_flags = flags;   /* IFF_TUN or IFF_TAP, plus maybe IFF_NO_PI */\n\n     if (*dev) {\n       /* if a device name was specified, put it in the structure; otherwise,\n        * the kernel will try to allocate the \"next\" device of the\n        * specified type */\n       strncpy(ifr.ifr_name, dev, IFNAMSIZ);\n     }\n\n     /* try to create the device */\n     if( (err = ioctl(fd, TUNSETIFF, (void *) &amp;ifr)) &lt; 0 ) {\n       close(fd);\n       return err;\n     }\n\n    /* if the operation was successful, write back the name of the\n     * interface to the variable \"dev\", so the caller can know\n     * it. Note that the caller MUST reserve space in *dev (see calling\n     * code below) */\n    strcpy(dev, ifr.ifr_name);\n\n    /* this is the special file descriptor that the caller will use to talk\n     * with the virtual interface */\n    return fd;\n  }\n\n  int main(void){\n    unsigned int seconds = 1;\n    char tap_name[IFNAMSIZ];\n    strcpy(tap_name, \"tun0\");\n    printf(\"%s\\n\", tap_name);\n    int tap_fd = tun_alloc(tap_name, IFF_TUN);\n    void *buffer = (void *)(malloc(3000));\n    printf(\"%s\\n\", tap_name);\n\n    if(tap_fd &lt; 0){\n      perror(\"Allocating interface\");\n      exit(1);\n    }\n\n    int nread;\n\n    while(1){\n      nread = read(tap_fd, buffer, sizeof(buffer));\n      if (nread &lt; 0){\n        perror(\"Nread: \");\n        close(tap_fd);\n        free(buffer);\n        exit(1);\n      }\n\n      printf(\"Read %d Bytes from devies %s \\n\", nread, tap_name);\n      sleep(seconds);\n    }\n\n\n  }\n</code></pre>\n\n<p>I executed this program on one terminal and pinged the interface from another terminal.</p>\n\n<p>But when I ping the interface from the command line (<code>ping 192.168.0.24</code>, I have assigned that IP to the interface), on the terminal of the program there's always written \"read 8 Bytes from interface\", although the number of bytes should vary when I ping the interface. Does anyone see the mistake?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533717086, "post_id": 51742079, "comment_id": 90444014, "body": "<code>abs</code> gives you the absolute value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10147176"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533717168, "post_id": 51742079, "comment_id": 90444068, "body": "how it helps the code here?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533719148, "post_id": 51742079, "comment_id": 90445367, "body": "Is this a puzzle, or a practical programming problem?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1533719356, "post_id": 51742079, "comment_id": 90445531, "body": "Please explain the reason for not using <code>if</code>. This is relevant for example in case the reason is a homework assignment (this kind of restrictions are typcically found in them). For that the answer needs to be tailored to the things you have already learned in the course, ideally the answer is tailored to the mechanism the teacher has in mind. A different angle: Be careful to really understand the solution and to be able to explain it based on previous textbook chapters."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10147176"}, "edited": false, "score": 0, "creation_date": 1533726067, "post_id": 51742079, "comment_id": 90449679, "body": "I have just started learning programming and we still haven&#39;t reached the if.. Else statement.. That&#39;s the only reason I asked :)"}, {"owner": {"reputation": 897, "user_id": 6191970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fecdd0e2681f2f4d65f9dea79742af9?s=128&d=identicon&r=PG&f=1", "display_name": "Ace.C", "link": "https://stackoverflow.com/users/6191970/ace-c"}, "edited": false, "score": 0, "creation_date": 1580678696, "post_id": 51742079, "comment_id": 106166490, "body": "Not sure why this has so many downvotes, max of three is a common code snippet that I think we all get tired of rewriting."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1533718755, "post_id": 51742211, "comment_id": 90445098, "body": "What happens if there are unsigned numbers?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1533719581, "post_id": 51742211, "comment_id": 90445655, "body": "@Michi For <code>unsigned int</code> and <code>b&gt;a</code>, <code>a-b</code> is calculated modulo <code>UINT_MAX+1</code>. So you may get a number which can not be represented by <code>int</code>. <code>abs</code> takes as argument an <code>int</code> so the argument is implicitly casted. The cast of <code>unsigned int</code> to <code>int</code> however is implementation defined for value that can not be represented by <code>int</code>."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 4, "last_activity_date": 1533717873, "last_edit_date": 1533717873, "creation_date": 1533717531, "answer_id": 51742211, "question_id": 51742079, "link": "https://stackoverflow.com/questions/51742079/finding-max-value-without-the-use-of-if-else-statement-in-c-language/51742211#51742211", "title": "Finding Max Value without the use of if..else statement in C language", "body": "<p><code>(a+b+abs(a-b))/2</code></p>\n\n<p>If <code>a&gt;b</code> then this expression becomes <code>(a+b+(a-b))/2</code> which is <code>a</code>.<br>\nIf <code>b&gt;a</code> then this expression becomes <code>(a+b-(a-b))/2</code> which is <code>b</code>.</p>\n\n<p>So this expression just gives you the maximum of two values.</p>\n\n<p>In order to get the maximum of three values you just take the maximum of the maximum of the first two and the third value. <code>max(a,b,c) = max(max(a,b),c)</code></p>\n"}, {"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1533719668, "creation_date": 1533719668, "answer_id": 51742866, "question_id": 51742079, "link": "https://stackoverflow.com/questions/51742079/finding-max-value-without-the-use-of-if-else-statement-in-c-language/51742866#51742866", "title": "Finding Max Value without the use of if..else statement in C language", "body": "<p>The man page for <a href=\"https://linux.die.net/man/3/abs\" rel=\"nofollow noreferrer\"><code>abs()</code></a> states,</p>\n\n<blockquote>\n  <p>The abs() function computes the absolute value of the integer argument.</p>\n</blockquote>\n\n<p>Also,</p>\n\n<blockquote>\n  <p>Returns the absolute value of the integer argument, of the appropriate integer type for the function.</p>\n</blockquote>\n\n<p>So, if you know basic math then you'd understand that this function returns the absolute value of the expression.</p>\n\n<p>Additionally, over a longer term stop following such strange (and stupid) exercises. These are only helpful for building up the logic, later, these are all useless.</p>\n\n<p>As a pun, following the problem <em>literally</em>, I would have done it this way:</p>\n\n<pre><code>// So, `if..else` statements are banned, right! Take that!\nresult = (a &gt; b) ? a : b;\nmax = (result &gt; c) ? result : c;\n</code></pre>\n\n<p>Remember, reading man pages for a function always helps.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1533722602, "creation_date": 1533722602, "answer_id": 51743908, "question_id": 51742079, "link": "https://stackoverflow.com/questions/51742079/finding-max-value-without-the-use-of-if-else-statement-in-c-language/51743908#51743908", "title": "Finding Max Value without the use of if..else statement in C language", "body": "<p>Simply use the <code>if</code> statement. Writing C code without <code>if</code> statements is harmful and silly practice. If you try to minimize branches in the code, then that's another story, but that's not really a task for a beginner. </p>\n\n<hr>\n\n<p>That being said, a solution to the problem is to implement a <em>truth table</em> and use boolean algebra with the <code>&gt;</code> operator. Learning how to implement such a table is useful practice (as opposed to avoiding if statements), since boolean algebra has many uses in programming. </p>\n\n<p>In this case, the truth table is (assuming no values are equal):</p>\n\n<pre><code>           x&gt;y  x&gt;z  y&gt;z\nx largest   1    1    -\ny largest   0    -    1\nz largest   -    0    0\n</code></pre>\n\n<p>Where <code>-</code> means \"don't care\".</p>\n\n<p>This can be implemented as a 3D array in C, where each index is the result of the corresponding <code>&gt;</code> comparison. That is:</p>\n\n<pre><code>array [2]  [2]  [2] \n//    x&gt;y  x&gt;z  y&gt;z\n</code></pre>\n\n<p>This will however contain some cases that never can be true and the assumption is that no values are equal. You can implement it like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  const char* const largest [2]  [2]  [2] =\n  //                        x&gt;y  x&gt;z  y&gt;z\n  {\n    { // x&lt;y\n      { // x&lt;z\n        \"z\", // y&lt;z\n        \"y\"  // y&gt;z\n      },\n      { // x&gt;z\n        \"-\", // y&lt;z, not possible\n        \"y\", // y&gt;z\n      }\n    },\n    { // x&gt;y\n      { //x&lt;z\n        \"z\", //y&lt;z\n        \"-\"  //y&gt;z, not possible\n      },\n      { //x&gt;z\n        \"x\", // y&lt;z\n        \"x\", // y&gt;z\n      },\n    },\n  };\n\n  const int use_cases [6][3] = \n  {\n    {1,2,3},\n    {1,3,2},\n    {2,1,3},\n    {2,3,1},\n    {3,1,2},\n    {3,2,1}\n  };\n\n  for(int i=0; i&lt;6; i++)\n  {\n    int x = use_cases[i][0];\n    int y = use_cases[i][1];\n    int z = use_cases[i][2];\n\n    printf(\"x:%d, y:%d, z:%d, largest: %s\\n\", x, y, z, largest[x&gt;y][x&gt;z][y&gt;z]);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x:1, y:2, z:3, largest: z\nx:1, y:3, z:2, largest: y\nx:2, y:1, z:3, largest: z\nx:2, y:3, z:1, largest: y\nx:3, y:1, z:2, largest: x\nx:3, y:2, z:1, largest: x\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10147176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1533722602, "creation_date": 1533717025, "last_edit_date": 1533717808, "question_id": 51742079, "link": "https://stackoverflow.com/questions/51742079/finding-max-value-without-the-use-of-if-else-statement-in-c-language", "title": "Finding Max Value without the use of if..else statement in C language", "body": "<p>I'm trying to find max value of three integers without the use of if...else statement, when I was doing some search, I came across this lines of code.. Besides the abs function, all the other lines \nI could understand.Can anyone explain how the abs function in the code works?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int x, y, z, result, max;\n\n    printf(\"\\nInput the first integer: \"); \n    scanf(\"%d\", &amp;x);\n\n    printf(\"\\nInput the second integer: \");\n    scanf(\"%d\", &amp;y);\n\n    printf(\"\\nInput the third integer: \");\n    scanf(\"%d\", &amp;z);\n\n    result=(x+y+abs(x-y))/2;\n    max=(result+z+abs(result-z))/2;\n\n    printf(\"\\nMaximum value of three integers: %d\\n\", max);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "winapi", "win32-process"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9865808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emJzy.jpg?s=128&g=1", "display_name": "alimovlex", "link": "https://stackoverflow.com/users/9865808/alimovlex"}, "edited": false, "score": 0, "creation_date": 1533738615, "post_id": 51744191, "comment_id": 90458263, "body": "Unfortunately, I can&#39;t add std in C language. If you know how to do it, please provide me this information.   if (memcmp(buffer + i, &quot;asd&quot;, min((dwCounter - i), 4) == 0)) wprintf(L&quot;The data is found&quot;);  It shows that this data exists despite of its wrong value"}, {"owner": {"reputation": 362, "user_id": 3958489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c4352cc798d4bf0226f3ebce1fe7ea?s=128&d=identicon&r=PG&f=1", "display_name": "T2PS", "link": "https://stackoverflow.com/users/3958489/t2ps"}, "reply_to_user": {"reputation": 21, "user_id": 9865808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emJzy.jpg?s=128&g=1", "display_name": "alimovlex", "link": "https://stackoverflow.com/users/9865808/alimovlex"}, "edited": false, "score": 0, "creation_date": 1533780019, "post_id": 51744191, "comment_id": 90475075, "body": "Sorry, that was a C++-ism seeping in."}], "tags": [], "owner": {"reputation": 362, "user_id": 3958489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c4352cc798d4bf0226f3ebce1fe7ea?s=128&d=identicon&r=PG&f=1", "display_name": "T2PS", "link": "https://stackoverflow.com/users/3958489/t2ps"}, "is_accepted": false, "score": 2, "last_activity_date": 1533723416, "creation_date": 1533723416, "answer_id": 51744191, "question_id": 51742043, "link": "https://stackoverflow.com/questions/51742043/how-to-find-the-sequence-in-the-binary-file-using-winapi-win32/51744191#51744191", "title": "How to find the sequence in the binary file using WinAPI/Win32?", "body": "<p><em>(Answering only as I don't have the rep to comment yet.)</em></p>\n\n<p>Your <code>memcmp</code> usage in the comment above doesn't quite look right to me, nor the usage of <code>wcscmp</code> in the original question; you're incrementing <code>i</code> after each test, but using the same buffer pointer unmodified each time -- by my reading, in both cases you're testing exactly the same bytes on each pass (the very start of <code>buffer</code>) rather than progressing through the data you loaded. Additionally, for the <code>memcmp</code> case, you're using a <code>wchar_t</code> string literal (<code>L\"0001\"</code>); this will be 8 bytes long in memory rather than the 4 in your comment's call, so the comparison would be for the first two zeroes only.</p>\n\n<p>The correct approach here is going to depend on the nature of the data you're dealing with. Are you trying to find the character sequence <code>0001</code> in an ASCII-encoded file, or <code>0001</code> (as seen by a user) in a Unicode file, or a hex byte <code>0x1</code>, or some other meaning of that representation? If it's the character sequence in the ASCII file, you might be looking for something like <code>if (memcmp(buffer + i, \"0001\", std::min((dwCounter - i), 4) == 0)</code> to check byte-by-byte for the character sequence, traversing through the buffer and comparing no more bytes than remain in the buffer each iteration.</p>\n\n<p>However, I would advise against using such a line if there's a reasonable, viable alternative. It sounds like what you're trying to do could also be covered by the question <a href=\"https://stackoverflow.com/questions/7319391/how-to-search-in-a-byte-array-for-a-pattern\">How to search in a BYTE array for a pattern?</a> I suspect the answers to that question could also perform better than such a byte-by-byte approach. Alternatively, you could consider using a regular expression implementation, if available and you're working with character/text data where the target value is reasonable to express via a regular expression.</p>\n"}, {"tags": [], "owner": {"reputation": 1964, "user_id": 8666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e412c92534ae5c8ae3b0e9cb7b7360?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel S\u0119k", "link": "https://stackoverflow.com/users/8666197/daniel-s%c4%99k"}, "is_accepted": true, "score": 0, "last_activity_date": 1534259190, "last_edit_date": 1534259190, "creation_date": 1533821976, "answer_id": 51768608, "question_id": 51742043, "link": "https://stackoverflow.com/questions/51742043/how-to-find-the-sequence-in-the-binary-file-using-winapi-win32/51768608#51768608", "title": "How to find the sequence in the binary file using WinAPI/Win32?", "body": "<p>From <a href=\"https://pp.userapi.com/c849236/v849236424/46ac8/yy8w6ak1Ddc.jpg\" rel=\"nofollow noreferrer\">https://pp.userapi.com/c849236/v849236424/46ac8/yy8w6ak1Ddc.jpg</a> I assume that you want to find given sequence of bytes.</p>\n\n<p>So it looks that standard function <code>strstr</code> wouldn't work because it couldn't handle NUL bytes (equal 0).</p>\n\n<p>Start with matching function (you can inline it in next function, I give it separately for clarity):</p>\n\n<pre><code>bool MatchBytes( const BYTE* a, const BYTE* b, int num_bytes )\n{\n    return memcmp( a, b, num_bytes ) == 0;\n}\n</code></pre>\n\n<p>Write function to find sequence:</p>\n\n<pre><code>int FindBytesIndex(\n       const BYTE* find_in,\n       int num_bytes_in_find_in,\n       const BYTE* to_find,\n       int num_bytes_to_find )\n{\n    int pos;\n    for ( pos = 0 ; pos &lt;= num_bytes_in_find_in - num_bytes_to_find ; ++pos )\n        if ( MatchBytes( find_in + pos, to_find, num_bytes_to_find ) )\n            return pos;\n    return -1;\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>const BYTE* FindBytesPtr(\n       const BYTE* find_in,\n       int num_bytes_in_find_in,\n       const BYTE* to_find,\n       int num_bytes_to_find )\n{\n    const BYTE* end = find_in + num_bytes_in_find_in - num_bytes_to_find;\n    for ( ; find_in &lt; end ; ++find_in )\n        if ( MatchBytes( find_in, to_find, num_bytes_to_find ) )\n            return find_in;\n    return NULL;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>BYTE bytes[] = { 0, 0, 0, 1 };\nint num_bytes = 4;\nint index = FindBytesIndex( buffer, dwCounter, bytes, num_bytes );\nif ( index &gt;= 0 )\n    printf( \"Found at index %d\\n\", index );\nelse\n    printf( \"Not found\\n\" );\n</code></pre>\n\n<p>If you want all occurrences:</p>\n\n<pre><code>BYTE bytes[] = { 0, 0, 0, 1 };\nint num_bytes = 4;\nint index = 0;\nint count = 0;\n/* There is assigment in loop condition. Found index is assigned to \"index\" variable */\n/* then it is checked if &gt;= 0 */\nwhile ( ( index = FindBytesIndex(buffer + index, dwCounter - index, bytes, num_bytes) ) &gt;= 0 )\n{\n    printf( \"Found at index %d\\n\", index );\n    ++count;\n}\n\nif ( count &gt; 0 )\n    printf( \"Found %d occurrences\\n\", count );\nelse\n    printf( \"Not found\\n\" );\n</code></pre>\n\n<p>Algorithm used by you and shown above is known as \"naive pattern searching\". If it is too slow, you can google faster algorithms \"Boyer-Moore\", \"Rabin-Karp\", \"KMP\" (\"Knuth-Morris-Pratt\").</p>\n"}], "owner": {"reputation": 21, "user_id": 9865808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emJzy.jpg?s=128&g=1", "display_name": "alimovlex", "link": "https://stackoverflow.com/users/9865808/alimovlex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 51768608, "answer_count": 2, "score": 0, "last_activity_date": 1534259190, "creation_date": 1533716920, "last_edit_date": 1533720220, "question_id": 51742043, "link": "https://stackoverflow.com/questions/51742043/how-to-find-the-sequence-in-the-binary-file-using-winapi-win32", "title": "How to find the sequence in the binary file using WinAPI/Win32?", "body": "<p>I want to identify the specified sequence in the binary file like 0001. The file opens and reads. \nFurthermore, the size of file shows well. Unfortunately, I can't make the algorythm of detecting the stated sequence. I got stuck in this trouble. Does anyone have any ideas?\nThe parameters such as the file name and the process name are provided by the command prompt. \nThe code is listed below.  </p>\n\n<pre><code> int blockchain(wchar_t *box)\n {\n     int i=0;\n     DWORD dwCounter=0;\n     BYTE buffer[BUFFERSIZE]={0};\n     HANDLE hFile = CreateFile(box, GENERIC_READ, FILE_SHARE_READ, NULL,\n         OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n     if(INVALID_HANDLE_VALUE == hFile) {\n         wprintf(L\"Error! Wrong file name!\\n\");\n         return -5;\n     }\n\n     if(FALSE==ReadFile(hFile, &amp;buffer, BUFFERSIZE, &amp;dwCounter, NULL)) {\n         wprintf(L\"Terminal failure: Unable to read from file.\\n\");\n         CloseHandle(hFile);\n         return -5;\n     } else {\n         for(i;i&lt;dwCounter;i++) {\n             if(wcscmp(buffer,L\"0001\") == 0)\n                 wprintf(L\"The data is found\");\n         }\n         wprintf(L\"\\nData read from %s (%d bytes): \\n\", box, dwCounter);    \n     }\n     CloseHandle(hFile);\n     return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "c11"], "comments": [{"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1533715580, "post_id": 51741412, "comment_id": 90443092, "body": "The answer you&#39;re referencing refers to C++11, not C11. That may or may not lead to confusion."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533725896, "post_id": 51741714, "comment_id": 90449580, "body": "I think the key to understanding this is that all operators in C are linked together in one long chain, to specify their precedence. The assignment operators is the group with lowest precedence of all (except the comma operator)."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 2, "last_activity_date": 1533715976, "creation_date": 1533715976, "answer_id": 51741714, "question_id": 51741412, "link": "https://stackoverflow.com/questions/51741412/c11-how-does-fixed-length-array-declaration-fit-in-the-c11-standards-specifica/51741714#51741714", "title": "C11: how does fixed-length array declaration fit in the C11 standard&#39;s specification?", "body": "<p><code>5</code> is <em>assignment-expression</em>.</p>\n\n<p>If you look at the definition of <em>assignment-expression</em>, one of it is <em>conditional-expression</em>. And one definition for that is <em>logical-OR-expression</em>. By tracking down this definition chain, you'll eventually reach <em>primary-expression</em>, for which on one definition is <em>constant</em>.</p>\n"}], "owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 51741714, "answer_count": 1, "score": 1, "last_activity_date": 1533715976, "creation_date": 1533714992, "question_id": 51741412, "link": "https://stackoverflow.com/questions/51741412/c11-how-does-fixed-length-array-declaration-fit-in-the-c11-standards-specifica", "title": "C11: how does fixed-length array declaration fit in the C11 standard&#39;s specification?", "body": "<p>The C11 standard (N1548) section 6.7.6 set forth the specifications of a declarator.</p>\n\n<p>In my understanding (see this <a href=\"https://stackoverflow.com/a/13808933/8385554\">answer</a> about dissecting a C declaration), an array declaration <code>int * arr[5];</code> has two parts: (a) declaration specifiers <code>int</code>, and (b) declarator <code>* arr[5]</code>. My problem is how to interpret the declarator part according to the C11 standard.</p>\n\n<p>The standard says:\n<a href=\"https://i.stack.imgur.com/ihjaX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ihjaX.png\" alt=\"enter image description here\"></a>\nOk, so <code>*</code> clearly corresponds to the \"pointer\" part. Therefore, <code>arr[5]</code> must correspond to the \"direct-declarator\" part. However, in the expansion of \"direct-declarator\" in this standard, it seems there is not an entry that matches <code>arr[5]</code> -- because it seems the constant expression <code>5</code> in the bracket does not match with \"type-qualifier-list\" or \"assignment-expression\".</p>\n\n<p>So how does this declaration fit in the C11 standard's specification?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533713657, "post_id": 51740959, "comment_id": 90441988, "body": "Without knowing what <code>A[2]</code> points at, none can answer that question."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1533713671, "post_id": 51740959, "comment_id": 90441996, "body": "<code>A[2][3]</code> is not a declaration."}, {"owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "edited": false, "score": 0, "creation_date": 1533713752, "post_id": 51740959, "comment_id": 90442045, "body": "i am asking whether A[2][3] can store an interger or address of integer ? if yes then how?"}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 1, "creation_date": 1533713753, "post_id": 51740959, "comment_id": 90442046, "body": "A[2][3] can store an integer"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533713785, "post_id": 51740959, "comment_id": 90442066, "body": "... assuming you actually make those pointers point to something determinate and proper, which right now, they do not."}, {"owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "edited": false, "score": 0, "creation_date": 1533713866, "post_id": 51740959, "comment_id": 90442107, "body": "A[2][3] is LHS of assignment statement"}, {"owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1533713889, "post_id": 51740959, "comment_id": 90442126, "body": "@VidorVistrom how?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533713975, "post_id": 51740959, "comment_id": 90442175, "body": "<code>int *A[10];</code> So <code>A</code> is an array of pointers to integers. <code>A[2]</code> becomes then a pointer to an integer. <code>A[2][3]</code> is then an integer. <code>A[2][3]</code> is the same as <code>*(A[2]+3)</code>."}, {"owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533714216, "post_id": 51740959, "comment_id": 90442311, "body": "@Osiris  will *(A[2]+3) be the 7th element?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1533714265, "post_id": 51740959, "comment_id": 90442348, "body": "what your doing is Undefined behaviour, accessing A[2][3]."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533714431, "post_id": 51740959, "comment_id": 90442458, "body": "@ParthPatel No. You have an array of pointers to integers. With <code>A[2]</code> you take the third pointer of the array (index starts with 0). <code>A[2][3]</code> takes that pointer, adds an offset of 3 and then dereferences it."}, {"owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533714565, "post_id": 51740959, "comment_id": 90442533, "body": "@Osiris Thank you:)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1533719302, "post_id": 51740959, "comment_id": 90445490, "body": "You might gain some insight from <a href=\"https://stackoverflow.com/questions/51737894/c-multidimensional-arrays-array-whose-elements-are-one-dimensional-arrays\">this recent question</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1533714139, "creation_date": 1533714139, "answer_id": 51741142, "question_id": 51740959, "link": "https://stackoverflow.com/questions/51740959/array-of-pointers-and-its-significance/51741142#51741142", "title": "Array of pointers and its significance", "body": "<p>I think you miss the concepts of array.</p>\n\n<p>When we say <code>int A[10]</code>,</p>\n\n<p>We mean an array of 10 integers.</p>\n\n<p>When we say <code>int *A[10]</code> this means an array of 10 integer pointers.\nSo Each of A[0], A[1], A[2]... points to a memory location that could hold integer. \nBut we need to decide the and declare the size for each of them, using say, malloc.</p>\n\n<p>Say,</p>\n\n<pre><code>A[2]= malloc(sizeof(int)*4)\n</code></pre>\n\n<p>now A[2] points to an array of 4 integers.</p>\n\n<p>So A[2][3] is now a valid integer</p>\n\n<p>If didn't use malloc or some other memory allocation function, A[2][3] may not be defined and accessing such a location is <strong>UNDEFINED BEHAVIOUR</strong> </p>\n"}], "owner": {"reputation": 1, "user_id": 7976435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_-zwmauJsg/AAAAAAAAAAI/AAAAAAAABU4/vz3O4OK3m0E/photo.jpg?sz=128", "display_name": "Parth Patel", "link": "https://stackoverflow.com/users/7976435/parth-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533714139, "creation_date": 1533713562, "last_edit_date": 1533713644, "question_id": 51740959, "link": "https://stackoverflow.com/questions/51740959/array-of-pointers-and-its-significance", "title": "Array of pointers and its significance", "body": "<pre><code>int *A[10];\n</code></pre>\n\n<p>If i have the above array of pointers, can anyone explain me the significance of the declaration <strong>A[2][3]</strong>? and what kind of value can <strong>A[2][3]</strong> can store?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1533714726, "post_id": 51740319, "comment_id": 90442644, "body": "In most cases (except <code>sizeof</code> and <code>&amp;</code>) arrays decay to pointers. <code>ptr = a</code> here <code>a</code> decays to type <code>int *</code>. But it is the pointer to the first element, not the pointer to the array. <code>ptr = &amp;a</code> here <code>&amp;a</code> is of type <code>int (*)[10]</code> and is the pointer to the array. Also note that the physical address of the first element and the array is the same, the only difference is the type."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1534783929, "post_id": 51740319, "comment_id": 90820620, "body": "What&#39;s unclear about the error message? (many compilers also state the types invloved, which should make it crystal clear even)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1534783989, "post_id": 51741476, "comment_id": 90820651, "body": "You forgot <code>alignof</code> Sidenote: there is no guarantee the value of two pointers of different type have are identical. E.g. for a type-aware instruction set, the type could be encoded in the value."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 2, "last_activity_date": 1534784998, "last_edit_date": 1534784998, "creation_date": 1533715188, "answer_id": 51741476, "question_id": 51740319, "link": "https://stackoverflow.com/questions/51740319/why-pointer-of-type-int-ptr10-requires-address-of-the-array-and-not-just-ar/51741476#51741476", "title": "Why pointer of type int (*ptr)[10] requires address of the array and not just array itself", "body": "<blockquote>\n  <p>Except when it is the operand of the sizeof operator or the unary &amp; operator, or is a string literal used to initialize an array, an expression that has type \u2018\u2018array of type\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type\u2019\u2019 that points to the initial element of the array object and is not an lvalue.</p>\n</blockquote>\n\n<p>Except for the <code>sizeof</code>, <code>&amp;</code> and <code>alignof</code> operator, arrays decay to pointers.</p>\n\n<pre><code>int a[10] = {1,2,3};//Filled three elements\nint (*ptr)[10];//pointer to an array of 10 ints\nptr = a;\n</code></pre>\n\n<p>In the assignment <code>ptr = a</code>, <code>a</code> decays to a pointer to int (<code>int *</code>), which points to the first element.</p>\n\n<pre><code>int a[10] = {1,2,3};//Filled three elements\nint (*ptr)[10];//pointer to an array of 10 ints\nptr = &amp;a;\n</code></pre>\n\n<p>Here <code>&amp;a</code> is of type <code>int (*)[10]</code>, which is a pointer to an array of 10 ints and has the same type as <code>ptr</code>. It is the proper way to assign a pointer to an array.</p>\n\n<p>Also note that the value itself is the same for <code>a</code> and <code>&amp;a</code>, the only difference is the type.</p>\n"}], "owner": {"reputation": 63, "user_id": 10195433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f59b52247e1684fb91454f96f4e331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/10195433/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534784998, "creation_date": 1533711378, "last_edit_date": 1533714250, "question_id": 51740319, "link": "https://stackoverflow.com/questions/51740319/why-pointer-of-type-int-ptr10-requires-address-of-the-array-and-not-just-ar", "title": "Why pointer of type int (*ptr)[10] requires address of the array and not just array itself", "body": "<p>Array returns pointer to the first element. I have simple code as below:</p>\n\n<pre><code>int a[10] = {1,2,3};//Filled three elements\nint (*ptr)[10];//pointer to an array of 10 ints\nptr = a;\n</code></pre>\n\n<p>I am getting below warning.</p>\n\n<pre><code>warning: assignment from incompatible pointer type\n</code></pre>\n\n<p>If i modify the pointer definition as shown below then there is no warning</p>\n\n<pre><code>ptr = &amp;a;\n</code></pre>\n\n<p>Why does the first assignment results in warning? Does &amp;a returns integer pointer to array of 10 elements? Pls help to understand. Thanks</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 1, "creation_date": 1533711390, "post_id": 51740193, "comment_id": 90440657, "body": "This seems OK, can you post more code ?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1533711461, "post_id": 51740193, "comment_id": 90440701, "body": "Those two lines won&#39;t cause a segfault (unless there&#39;s something strange going on with <code>ROWS_COUNT</code> or <code>PATH_MAX</code>). Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533711768, "post_id": 51740193, "comment_id": 90440861, "body": "It&#39;s all; there are no more related lines to the subject. I&#39;ve used ROW_COUNT here for simplicity. Actually, I&#39;m using a variable named <code>lines</code> instead; which is containing the value of <code>3</code>. <code>PATH_MAX</code> (which I think is system dependent) is a constant which defines the MAX path length on Linux systems."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1533713183, "post_id": 51740193, "comment_id": 90441699, "body": "If <code>malloc</code> triggers a seg-fault, you&#39;ve possibly corrupted your heap with some other code in the &quot;hundreds of lines&quot; prior to this allocation (quoting <i>you</i>  from your comment in one of the answers below). With only what you&#39;ve shown here, the best you can hope for are wags (wild-ass-guesses). This site isn&#39;t about guesses; it&#39;s about <i>answers</i>. Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>  or this question will likely be short-lived."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533713380, "post_id": 51740193, "comment_id": 90441833, "body": "And btw, <code>char (*arr)[PATH_MAX+1] = calloc(ROW_COUNT, sizeof *arr);</code> would seem much simple if you really are just looking to get <code>ROW_COUNT</code> number of fixed <code>char</code> buffer space. Unless you need independent string pointers for later replacement and freeing, I&#39;d opt for that alternative; single-alloc; single-free."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1533714770, "post_id": 51740193, "comment_id": 90442671, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>. Learn about <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array member</a>s"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533711856, "post_id": 51740372, "comment_id": 90440913, "body": "BTW, On the first loop (let&#39;s say i = 0), the same statement must be executed. (which leads to an error)"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712339, "post_id": 51740372, "comment_id": 90441166, "body": "@noteworthy - I am on a MAC with xcode, Just tested the code that I have added in the answer to preserve formatting. This code works fine. Also I noticed that PATH_MAX is defined as 1024 in syslimits.h."}, {"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712349, "post_id": 51740372, "comment_id": 90441173, "body": "If i = 0; Then: *(arr + i) = *(arr + 0) = *arr. So it issues runtime error in the first loop."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712414, "post_id": 51740372, "comment_id": 90441216, "body": "But not in my case even when its *arr or  *(arr + 0). What is the valude of ROWS_COUNT. may you try putting 1000/100 instead of ROWS_COUNT ?"}, {"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712492, "post_id": 51740372, "comment_id": 90441264, "body": "@ Rizwan - Yeah, I&#39;m confused. It may be related to hundred of lines before this allocation. Also, <code>PATH_MAX</code> is system dependent."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712618, "post_id": 51740372, "comment_id": 90441361, "body": "Most probably you are right that its &quot;hundred of lines before this allocation&quot;. Please let us know the reason when you find it."}, {"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712619, "post_id": 51740372, "comment_id": 90441362, "body": "<code>ROWS_COUNT</code> = <code>3</code>."}, {"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533712654, "post_id": 51740372, "comment_id": 90441383, "body": "Ok, I will share the solution. Thanks."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1533713113, "post_id": 51740372, "comment_id": 90441658, "body": "<code>i</code> goes from <code>1</code> to <code>1001</code> in the loop body of your example, which is an off by 2 error and does not initialize the first element."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533713366, "post_id": 51740372, "comment_id": 90441820, "body": "You should use a for loop instead of that icky while loop. <code>for(size_t i=0; i&lt;1000; i++) { arr[i]  = malloc(...); }</code> That way you also remove the off-by-one bugs you have written in the current code: <code>*(arr + 1000) = </code> writes out of bounds of the array."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1533713766, "post_id": 51740372, "comment_id": 90442058, "body": "Actually that was just a quick testing code. Corrected it however. For is good but while was used bcz it needs less keystrokes."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533716568, "post_id": 51740372, "comment_id": 90443689, "body": "@Rizwan It is still out of bounds. Only difference you are not off by 2 only by 1."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533722879, "post_id": 51740372, "comment_id": 90447818, "body": "&quot;Less keystrokes&quot; is a horrible rationale for writing an algorithm in a certain way. Programming is all about hitting a whole lot of keys on the keyboard. If that&#39;s not your thing, then programming isn&#39;t for you."}], "tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": false, "score": -1, "last_activity_date": 1533720306, "last_edit_date": 1533720306, "creation_date": 1533711575, "answer_id": 51740372, "question_id": 51740193, "link": "https://stackoverflow.com/questions/51740193/segmentation-fault-when-allocating-memory-to-a-pointer-to-pointer-variable-c/51740372#51740372", "title": "Segmentation Fault when allocating memory to a pointer to pointer variable [C]", "body": "<pre><code>// #define PATH_MAX 4096\n*arr = malloc (sizeof (char) * (PATH_MAX + 1));\n</code></pre>\n\n<p>I think this line needs to be within a loop of <code>ROWS_COUNT</code> times. So that memory can be allocated for all the rows to be stored.</p>\n\n<p>Tested on MAC with Xcode (Version 9.3 (9E145)), working fine:</p>\n\n<pre><code>char** arr = (char**) malloc (sizeof (char*) * 1000);\nint i = -1;\nwhile(++i &lt; 1000)\n{\n    *(arr + i) = (char*) malloc (sizeof (char) * (PATH_MAX + 1));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "edited": false, "score": 0, "creation_date": 1533714388, "post_id": 51741049, "comment_id": 90442436, "body": "Sorry, I&#39;ve forgotten to notice I&#39;m using <code>ROWS_COUNT</code> for simplicity here. In the original code, I use a variable named <code>lines</code>. (note added to the main post) BTW, it seems a good solution if someone using a constant name as the row counter."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533714885, "post_id": 51741049, "comment_id": 90442728, "body": "Note this will require sweeping changes to the remainder of the code that uses <code>arr</code> everywhere following this (<code>arr</code> will have to be <code>(*arr)</code>. The OP, at <i>most</i>, needs an array of arrays. Ex: <code>char (*arr)[PATH_MAX+1] = calloc(ROW_COUNT, sizeof *arr);</code>"}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533714889, "post_id": 51741049, "comment_id": 90442732, "body": "@WhozCraig Sorry I missed  <code>*</code> operator .  I have changed to  <code>sizeof(*arr)</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533714922, "post_id": 51741049, "comment_id": 90442746, "body": "@anoopknr It&#39;s still not necessary to have both dimensions  subscripted to get a single allocation."}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 1, "last_activity_date": 1533714600, "last_edit_date": 1533714600, "creation_date": 1533713856, "answer_id": 51741049, "question_id": 51740193, "link": "https://stackoverflow.com/questions/51740193/segmentation-fault-when-allocating-memory-to-a-pointer-to-pointer-variable-c/51741049#51741049", "title": "Segmentation Fault when allocating memory to a pointer to pointer variable [C]", "body": "<p>You could dynamically allocate memory in <em>single</em> <code>malloc()</code> , Try this code :-</p>\n\n<pre><code>char (*arr)[ROWS_COUNT][PATH_MAX + 1] = malloc (sizeof(*arr));\n</code></pre>\n\n<p>and you could access <strong>strings</strong> using :-</p>\n\n<pre><code>(*arr)[ index ] \n</code></pre>\n\n<p>and <strong>characters</strong> using :-</p>\n\n<pre><code>(*arr)[ row ] [ column ]\n</code></pre>\n\n<p>Example :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define PATH_MAX 4096\n#define  ROWS_COUNT 500\nint main()\n{\n    char (*arr)[ROWS_COUNT][PATH_MAX + 1] = malloc (sizeof(*arr));\n    strcpy((*arr)[400],\"Hello World\");\n    printf(\"\\n String    : %s\",(*arr)[400]);\n    printf(\"\\n Character : %c\",(*arr)[400][2]);\n}\n</code></pre>\n\n<p>Output :-</p>\n\n<pre><code> String    : Hello World\n Character : l\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10195744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13837fc2cfeaba6d3ece0239d263c26c?s=128&d=identicon&r=PG&f=1", "display_name": "noteworthy", "link": "https://stackoverflow.com/users/10195744/noteworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "closed_date": 1533714840, "answer_count": 2, "score": -1, "last_activity_date": 1533720306, "creation_date": 1533710898, "last_edit_date": 1533714871, "question_id": 51740193, "link": "https://stackoverflow.com/questions/51740193/segmentation-fault-when-allocating-memory-to-a-pointer-to-pointer-variable-c", "closed_reason": "Not suitable for this site", "title": "Segmentation Fault when allocating memory to a pointer to pointer variable [C]", "body": "<p>I'm trying to represent an array of strings by using a pointer to pointer. So I've defined <code>char** arr</code> as below:</p>\n\n<pre><code>uint8_t lines = getLines();\nchar** arr = malloc (sizeof (char*) * lines);\n// char** arr = malloc (sizeof (char*) * ROWS_COUNT);\n</code></pre>\n\n<p>In the debug process, the line above will be executed successfully and allocates memory to <code>arr</code>. The problem (and so, the error) issues when trying to allocating enough memory to hold a string within <code>*(arr + 0)</code> as below:</p>\n\n<pre><code>// #define PATH_MAX 4096\n*arr = malloc (sizeof (char) * (PATH_MAX + 1));\n</code></pre>\n\n<p>Runtime Error:</p>\n\n<pre><code>Signal: SIGSEGV (Segmentation fault)\n</code></pre>\n\n<p>Note: I've used casting operators (the first assignment by <code>char**</code> and the second one by <code>char*</code>). It doesn't work too.</p>\n\n<p><strong>Note:</strong> I've used <code>ROW_COUNTS</code> here for the sake of simplicity. In the original code, there is a <code>lines</code> variable which I use instead of <code>ROWS_COUNT</code>. <code>lines</code> contains an <code>uint8_t</code> value. (in my case, <code>3</code>)</p>\n"}, {"tags": ["c", "linux", "input", "posix", "errno"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1533711282, "post_id": 51740161, "comment_id": 90440589, "body": "When it starts at that time it doesn\u2019t have any data to read so read is waiting for the data to read,  read is blocking that\u2019s why your getting EAGAIN."}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1533711961, "post_id": 51740161, "comment_id": 90440972, "body": "If the write is said to be atomic, then why should it be waiting at all ? All the 525 bytes for the above error message should have been available, right ?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1533713595, "post_id": 51740161, "comment_id": 90441949, "body": "In which kind of file system the file you read is stored in?"}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1533741503, "post_id": 51740911, "comment_id": 90460235, "body": "Yes, definitely; nice!"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 6, "last_activity_date": 1552145975, "last_edit_date": 1552145975, "creation_date": 1533713410, "answer_id": 51740911, "question_id": 51740161, "link": "https://stackoverflow.com/questions/51740161/eagain-on-a-blocking-read-system-call-on-regular-file/51740911#51740911", "title": "EAGAIN on a blocking read system call on regular file", "body": "<blockquote>\n  <p>Why are we getting EAGAIN on blocking file read ?</p>\n</blockquote>\n\n<p>You aren't (see below).</p>\n\n<blockquote>\n  <p>Why is the return value not -1 ?</p>\n</blockquote>\n\n<p>Because the operation did not fail.</p>\n\n<p>The value of <code>errno</code> <strong>only</strong> carries a sane value if the call to <code>read()</code> failed. A call to <code>read()</code> failed if and only if <code>-1</code> is returned.</p>\n\n<p>From the <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">Linux man-page for <code>read()</code></a>:</p>\n\n<blockquote>\n  <p><strong>RETURN VALUE</strong> </p>\n  \n  <p>On success, the number of bytes read is returned (zero indicates end\n         of file), and the file position is advanced by this number.  It is\n         not an error if this number is smaller than the number of bytes\n         requested;</p>\n  \n  <p>[...]</p>\n  \n  <p>On error, -1 is returned, and <code>errno</code> is set appropriately. </p>\n</blockquote>\n\n<p>A common pattern to <code>read()</code> would be</p>\n\n<pre><code>char buffer[BUFFER_MAX];\nchar * p = buffer;\nsize_t to_read = ... /* not larger then BUFFER_MAX! */\n\nwhile (to_read &gt; 0)\n{\n  ssize_t result = read(..., p, to_read);\n  if (-1 == result)\n  {\n    if (EAGAIN == errno || EWOULDBLOCK == errno)\n    {\n      continue;\n    }\n\n    if (EINTR == errno)\n    {\n      continue; /* or break depending on application design. */\n    }\n\n    perror(\"read() failed\");\n\n    exit(EXIT_FAILURE);\n  }\n  else if (0 &lt; result)\n  {\n    to_read -= (size_t) result;\n    p += (size_t) result;\n  }\n  else if (0 == result) /* end of file  /  connection shut down for reading */\n  {\n    break;\n  }\n  else\n  {\n    fprintf(stderr, \"read() returned the unexpected value of %zd. You probably hit a (kernel) bug ... :-/\\n\", result);\n\n    exit(EXIT_FAILURE);\n  }\n}\n\nIf (0 &lt; to_read)\n{\n  fprintf(stderr, \"Encountered early end of stream. %zu bytes not read.\\n\", to_read);\n}\n</code></pre>\n"}], "owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 51740911, "answer_count": 1, "score": 1, "last_activity_date": 1552145975, "creation_date": 1533710764, "last_edit_date": 1552145579, "question_id": 51740161, "link": "https://stackoverflow.com/questions/51740161/eagain-on-a-blocking-read-system-call-on-regular-file", "title": "EAGAIN on a blocking read system call on regular file", "body": "<p>So, this is a weird case that I am seeing sometimes and not able to figure out a reason.</p>\n\n<p>We have a C program that reads from a regular file. And there are other processes which write into the same file. The application is based on the fact that the writes are atomic in Linux for write size up to 4096 bytes.</p>\n\n<p>The file is NOT opened with non blocking flag, so my assumption is that reads would be blocking.</p>\n\n<p>But sometimes during the startup, we see \"<em>Resource temporarily unavailable</em>\" error set in <code>errno</code>. And the size returned by read != -1 but some partially read size.</p>\n\n<p>An error message would look something like:</p>\n\n<pre>\n 2018-08-07T06:40:52.991141Z, Invalid message size, log_s.bin, fd 670, Resource temporarily unavailable, read size 285, expected size 525\n</pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Why are we getting <code>EAGAIN</code> on blocking file read?</p></li>\n<li><p>Why is the return value not -1?</p></li>\n<li><p>This happens only during the initial time when it is started. It works fine thereafter. What are some edge cases that can get us in such situation?</p></li>\n</ol>\n"}, {"tags": ["c", "string", "malloc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1533710836, "post_id": 51740149, "comment_id": 90440355, "body": "Note that if a <code>malloc()</code> in the loop fails, you leak memory.  That is not, however, part of your current problem."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533710923, "post_id": 51740149, "comment_id": 90440392, "body": "This loop is dubious: <code>while (k &lt; ft_len_word(str + i))             tab[j][k++] = str[i++];</code> \u2014 you&#39;re incrementing <code>i</code> as you go, but you don&#39;t want to be doing that, I think.  Probably capture the length once outside the loop; then you might be OK.  But as it stands, I think you have problems."}, {"owner": {"reputation": 19, "user_id": 7710077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca15079f4664d7f0a27760f3d1e32f3?s=128&d=identicon&r=PG", "display_name": "Abilbel", "link": "https://stackoverflow.com/users/7710077/abilbel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533711168, "post_id": 51740149, "comment_id": 90440527, "body": "Ok that was this, thank you very much"}, {"owner": {"reputation": 19, "user_id": 7710077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca15079f4664d7f0a27760f3d1e32f3?s=128&d=identicon&r=PG", "display_name": "Abilbel", "link": "https://stackoverflow.com/users/7710077/abilbel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533711717, "post_id": 51740149, "comment_id": 90440835, "body": "And how could i solve the memory leaking problem ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533711813, "post_id": 51740149, "comment_id": 90440891, "body": "You\u2019d need a loop to free already allocated strings plus another call to free the vector of pointers before you execute the error return.  Strictly, you should error check the first allocation too."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533713348, "post_id": 51740149, "comment_id": 90441808, "body": "Is <code>malloc</code> allowed or does it violate the &quot;no library&quot; constraint?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533713678, "post_id": 51740149, "comment_id": 90442000, "body": "is <code>char *str</code> really writeable? because if so, all you need to manage is a sequence of pointers, and dropping terminators in the appropriate places of the original string."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1533714143, "creation_date": 1533714143, "answer_id": 51741143, "question_id": 51740149, "link": "https://stackoverflow.com/questions/51740149/split-whitespaces-in-a-string-and-store-them-in-table-in-c-without-libraries/51741143#51741143", "title": "Split whitespaces in a string and store them in table in C without libraries", "body": "<p>This can be easily handled if you take one pointer to point the last occurrence of specific character('' '\\n' \\t). </p>\n\n<pre><code>   char    **ft_split_whitespaces(char *str)\n    {\n    int     i;\n    int     j;\n    int     k;\n    char    **tab;\n    char *prevToken=str;\n\n    i = 0;\n    j = 0;\n    k = 0;\n    tab = (char**)malloc(sizeof(*tab) * (ft_nb_words(str) + 1));\n    while (str[i] != '\\0')\n    {\n\n        if(str[i] == ' ' || str[i] == '\\t' || str[i] == '\\n')\n        {\n            i++;\n            if ((tab[j] = (char*)malloc(sizeof(char) * (ft_len_word(prevToken) + 1))) == NULL)\n                return (NULL);\n\n            while (k &lt; ft_len_word(prevToken) &amp;&amp;\n                (prevToken[k] !=' ' &amp;&amp;  prevToken[k] != '\\t' &amp;&amp;  prevToken[k] != '\\n'))\n                tab[j][k] = prevToken[k++];\n\n            printf(\"tab=%s\\n\", tab[j]);\n            k = 0;\n            j++;\n            prevToken=(str+i);\n        }\n        else{\n           i++;\n         }\n    }\n\n      /* to handle the last word */\n            if ((tab[j] = (char*)malloc(sizeof(char) * (ft_len_word(prevToken) + 1))) == NULL)\n                return (NULL);\n\n            while (k &lt; ft_len_word(prevToken) &amp;&amp;\n                (prevToken[k] !=' ' &amp;&amp;  prevToken[k] != '\\t' &amp;&amp;  prevToken[k] != '\\n'))\n                tab[j][k] = prevToken[k++];\n            printf(\"tab=%s\\n\", tab[j]);\n\n\n    tab[j] = NULL;\n    return (tab);\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1533888762, "last_edit_date": 1533888762, "creation_date": 1533716573, "answer_id": 51741915, "question_id": 51740149, "link": "https://stackoverflow.com/questions/51740149/split-whitespaces-in-a-string-and-store-them-in-table-in-c-without-libraries/51741915#51741915", "title": "Split whitespaces in a string and store them in table in C without libraries", "body": "<p>The following code contains an implementation of some useful C functions. </p>\n\n<p>The function you search is <code>strtok()</code>. In the code are implemented also the functions <code>strspn()</code> and <code>strpbrk()</code> because <code>strtok()</code> uses them.</p>\n\n<p>The best way to solve this kind of problems is to study the implementation of C standard functions.</p>\n\n<p>The code stores the copies of max 100 token (the extracted words). </p>\n\n<p>You have to remember that the function <code>strtok()</code> modifies the content of the source string inserting '\\0' to terminate the strings found.</p>\n\n<p>The functions here implemented are:</p>\n\n<ul>\n<li>mystrtok()</li>\n<li>mystrspn()</li>\n<li>mystrpbrk()</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt; /* for the use of strcpy fn */\n#include &lt;malloc.h&gt;\n\nchar * mystrtok (char * s, char * delim);\nsize_t mystrspn (const char *s, const char *accept);\nchar * mystrpbrk (const char *s, const char *accept);\n\nchar * mystrpbrk (const char *s, const char *accept)\n{\n    while (*s != '\\0')\n    {\n        const char *a = accept;\n        while (*a != '\\0')\n            if (*a++ == *s)\n                return (char *) s;\n        ++s;\n    }\n\n    return NULL;\n}\n\nsize_t mystrspn (const char *s, const char *accept)\n{\n    const char *p;\n    const char *a;\n    size_t count = 0;\n\n    for (p = s; *p != '\\0'; ++p)\n    {\n        for (a = accept; *a != '\\0'; ++a)\n            if (*p == *a)\n                break;\n        if (*a == '\\0')\n            return count;\n        else\n            ++count;\n    }\n\n    return count;\n}\n\nchar * mystrtok (char *s, char *delim)\n{\n    char *token;\n    static char *olds;\n\n    if (s == NULL) {\n        s = olds;\n    }\n\n    /* Scan leading delimiters.  */\n    s += mystrspn (s, delim);\n    if (*s == '\\0')\n    {\n        olds = s;\n        return NULL;\n    }\n\n    /* Find the end of the token.  */\n    token = s;\n    s = mystrpbrk (token, delim);\n    if (s == NULL)\n    {\n        /* This token finishes the string.  */\n        while(*olds)\n            olds++;\n    }\n    else\n    {\n        /* Terminate the token and make OLDS point past it.  */\n        *s = '\\0';\n        olds = s + 1;\n    }\n    return token;\n}\n\nint main(void)\n{\n    char str[] = \"I have an orange\\tYou have some bananas\\nShe has three pineapples\\n\";\n    char * x = NULL;\n\n    int cnt=0,i;\n\n\n    char **store;\n\n    /* Stores a max of 100 strings */\n    store = malloc(sizeof(char *)*100);\n\n    /* The total space for the tokens is\n       max the entire string + '\\0' */\n    store[0] = malloc(strlen(str)+1);\n\n    /* Extract the first token */\n    x=mystrtok(str,\" \\n\");\n    while(x) {\n        printf(\"Storing %s\\n\",x);\n\n        /* Store a copy of the token */\n        strcpy(store[cnt],x);\n        store[cnt+1]=store[cnt]+strlen(x)+1;\n        cnt++;\n\n        /* extract the next token */\n        x=mystrtok(NULL,\" \\n\\t\");\n    }\n\n    for(i=0;i&lt;cnt;i++)\n        printf(\"Stored %s\\n\",store[i]);\n\n    free(store[0]);\n    free(store);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1533856436, "last_edit_date": 1533856436, "creation_date": 1533718521, "answer_id": 51742522, "question_id": 51740149, "link": "https://stackoverflow.com/questions/51740149/split-whitespaces-in-a-string-and-store-them-in-table-in-c-without-libraries/51742522#51742522", "title": "Split whitespaces in a string and store them in table in C without libraries", "body": "<p>Your code is inefficient as you call <code>ft_len_word</code> far too many times, but it does not seem broken apart from the undefined behavior on <code>malloc</code> failures.</p>\n\n<p>The problem might lie in your versions of <code>ft_len_word</code> or <code>ft_nb_words</code>. You should post a full program exhibiting the problem for a proper investigation.</p>\n\n<p>Here is a modified version that does not use these functions:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint ft_is_space(char c) {\n    return (c == ' ' || c == '\\t' || c == '\\n');\n}\n\nchar **ft_split_whitespaces(const char *str) {\n    int i, j, k, len, in_space, nb_words;\n    char **tab;\n\n    nb_words = 0;\n    in_space = 1;\n    for (i = 0; str[i]; i++) {\n        if (ft_is_space(str[i]) {\n            in_space = 1;\n        } else {\n            nb_words += in_space;\n            in_space = 0;\n        }\n    }\n    tab = malloc(sizeof(*tab) * (nb_words + 1));\n    if (tab != NULL) {\n        i = 0;\n        j = 0;\n        while (str[i]) {\n            while (ft_is_space(str[i]))\n                i++;\n            if (str[i]) {\n                for (len = 1; str[i + len] &amp;&amp; !ft_is_space(str[i + len]); len++)\n                     continue;\n                if ((tab[j] = malloc(sizeof(*tab[j]) * (len + 1))) == NULL) {\n                     while (j &gt; 0)\n                         free(tab[--j]);\n                     free(tab);\n                     return NULL;\n                }\n                for (k = 0; k &lt; len; k++)\n                    tab[j][k] = str[i + k];\n                tab[j++][len] = '\\0';\n                i += len;\n            }\n        }\n        tab[j] = NULL;\n    }\n    return tab;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534191095, "creation_date": 1534191095, "answer_id": 51829899, "question_id": 51740149, "link": "https://stackoverflow.com/questions/51740149/split-whitespaces-in-a-string-and-store-them-in-table-in-c-without-libraries/51829899#51829899", "title": "Split whitespaces in a string and store them in table in C without libraries", "body": "<p>You need to implement your version of <code>strtok()</code> if you do not want to use the library function or need a different functionality than the one provided by <code>strtok()</code>.</p>\n\n<p>Below is a simple string tokenizer, which, unlike the standard library's <code>strtok()</code>, still returns a value in case of consecutive delimiters. I used this function to parse CSV files, which sometimes include empty cells, hence consecutive <code>,</code> characters. Standard library's <code>strtok()</code> did not work for me, so I had to implement my own function.</p>\n\n<p>I used other helper functions, which are now part of <a href=\"https://github.com/fnoyanisi/zString\" rel=\"nofollow noreferrer\">a simple string library I maintain on GitHub, called zString</a>.</p>\n\n<p>Below is how it behaves</p>\n\n<pre><code>Example Usage\n      char str[] = \"A,B,,,C\";\n      printf(\"1 %s\\n\",zstring_strtok(s,\",\"));\n      printf(\"2 %s\\n\",zstring_strtok(NULL,\",\"));\n      printf(\"3 %s\\n\",zstring_strtok(NULL,\",\"));\n      printf(\"4 %s\\n\",zstring_strtok(NULL,\",\"));\n      printf(\"5 %s\\n\",zstring_strtok(NULL,\",\"));\n      printf(\"6 %s\\n\",zstring_strtok(NULL,\",\"));\n\n  Example Output\n      1 A\n      2 B\n      3 ,\n      4 ,\n      5 C\n      6 (null)\n</code></pre>\n\n<p>and the code</p>\n\n<pre><code>char *zstring_strtok(char *str, const char *delim) {\n    static char *static_str=0;      /* var to store last address */\n    int index=0, strlength=0;       /* integers for indexes */\n    int found = 0;                  /* check if delim is found */\n\n    /* delimiter cannot be NULL\n    * if no more char left, return NULL as well\n    */\n    if (delim==0 || (str == 0 &amp;&amp; static_str == 0))\n        return 0;\n\n    if (str == 0)\n        str = static_str;\n\n    /* get length of string */\n    while(str[strlength])\n        strlength++;\n\n    /* find the first occurrence of delim */\n    for (index=0;index&lt;strlength;index++)\n        if (str[index]==delim[0]) {\n            found=1;\n            break;\n        }\n\n    /* if delim is not contained in str, return str */\n    if (!found) {\n        static_str = 0;\n        return str;\n    }\n\n    /* check for consecutive delimiters\n    *if first char is delim, return delim\n    */\n    if (str[0]==delim[0]) {\n        static_str = (str + 1);\n        return (char *)delim;\n    }\n\n    /* terminate the string\n    * this assignment requires char[], so str has to\n    * be char[] rather than *char\n    */\n    str[index] = '\\0';\n\n    /* save the rest of the string */\n    if ((str + index + 1)!=0)\n        static_str = (str + index + 1);\n    else\n        static_str = 0;\n\n        return str;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7710077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca15079f4664d7f0a27760f3d1e32f3?s=128&d=identicon&r=PG", "display_name": "Abilbel", "link": "https://stackoverflow.com/users/7710077/abilbel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1534191095, "creation_date": 1533710723, "last_edit_date": 1533718291, "question_id": 51740149, "link": "https://stackoverflow.com/questions/51740149/split-whitespaces-in-a-string-and-store-them-in-table-in-c-without-libraries", "title": "Split whitespaces in a string and store them in table in C without libraries", "body": "<p>I had a assignment for my class last week where I had to split a string with the spaces, tabs et <code>\\n</code> as separators and store every \"word\" in an array. I think I'm very close but my output is very weird so if someone could tell what did I forget, it would be nice. Only thing is I can only use <code>malloc</code>.</p>\n\n<pre><code>char    **ft_split_whitespaces(char *str)\n{\n    int     i;\n    int     j;\n    int     k;\n    char    **tab;\n\n    i = 0;\n    j = 0;\n    k = 0;\n    tab = (char**)malloc(sizeof(*tab) * (ft_nb_words(str) + 1));\n    while (str[i])\n    {\n        while (str[i] == ' ' || str[i] == '\\t' || str[i] == '\\n')\n            i++;\n        if (str[i])\n        {\n            if ((tab[j] = (char*)malloc(sizeof(char) * (ft_len_word(str + i) + 1))) == NULL)\n                return (NULL);\n            while (k &lt; ft_len_word(str + i))\n                tab[j][k++] = str[i++];\n            tab[j++][k] = '\\0';\n            k = 0;\n        }\n    }\n    tab[j] = NULL;\n    return (tab);\n}\n</code></pre>\n\n<p>The functions returning the length of a word and the number of words work fine so I think the problem comes from the main function.</p>\n"}, {"tags": ["c", ".net", "mongodb"], "comments": [{"owner": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533708784, "post_id": 51739646, "comment_id": 90439410, "body": "Paging? Get only a portion at a time. With 5GB of data you would expect it to be little slow."}, {"owner": {"reputation": 37, "user_id": 9945537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21d87814ee823fa59983562274b2dd2?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/9945537/liam"}, "reply_to_user": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533709040, "post_id": 51739646, "comment_id": 90439512, "body": "Slow, sure, but the operation doesn&#39;t seem to finish at all. The same query in the mongo shell takes a few seconds."}, {"owner": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533709141, "post_id": 51739646, "comment_id": 90439546, "body": "Query in the shell only returns fixed number of results. It is actually paging. Also note that <code>ToList()</code> call actually tries to get <code>all</code> data ... the entire filter result."}, {"owner": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533709236, "post_id": 51739646, "comment_id": 90439597, "body": "What is the count of the filter? How many records?"}, {"owner": {"reputation": 37, "user_id": 9945537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21d87814ee823fa59983562274b2dd2?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/9945537/liam"}, "reply_to_user": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533709648, "post_id": 51739646, "comment_id": 90439807, "body": "The count is 26 397. I need to get all of the data, because I need to extract a list of objects from each entry for a subsequent operation."}, {"owner": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533709793, "post_id": 51739646, "comment_id": 90439882, "body": "Why can&#39;t you page through the data until you get it all and then do the next operation? Get 1K at a time ... 27 pages and you are golden."}, {"owner": {"reputation": 37, "user_id": 9945537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21d87814ee823fa59983562274b2dd2?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/9945537/liam"}, "reply_to_user": {"reputation": 15562, "user_id": 155819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yXygz.jpg?s=128&g=1", "display_name": "Akrion", "link": "https://stackoverflow.com/users/155819/akrion"}, "edited": false, "score": 0, "creation_date": 1533714996, "post_id": 51739646, "comment_id": 90442782, "body": "It does look promising, though I&#39;m not entirely sure how to implement it. I&#39;ll give it a go."}], "owner": {"reputation": 37, "user_id": 9945537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21d87814ee823fa59983562274b2dd2?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/9945537/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533708566, "creation_date": 1533708566, "question_id": 51739646, "link": "https://stackoverflow.com/questions/51739646/mongodb-net-find-tolist-operation-slow-for-large-result", "title": "MongoDB .NET Find().ToList() operation slow for large result", "body": "<p>I have a collection that is about 5 GB, consisting of roughly 26000 entries. These entries have a field \"System\", and for this test, all entries have the same value for this. </p>\n\n<p>If I run the following code:</p>\n\n<pre><code>var filter = Builders&lt;BsonDocument&gt;.Filter.Eq(\"System\",sys);\nvar result = collection.Find(filter).ToList();\n</code></pre>\n\n<p>The code runs seemingly forever, and consumes ridiculous amounts of memory, up towards 20 gigs when I've let it run for a while before aborting.</p>\n\n<p>Is there a more efficient way of collecting these documents, or do I need to solve this some other way?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1533707661, "post_id": 51739429, "comment_id": 90438988, "body": "Are you aware of the concept of &quot;state machines&quot;? <a href=\"https://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Finite-state_machine</a>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1533707669, "post_id": 51739429, "comment_id": 90438992, "body": "1. wrap the function in custom functions where you set flags with timestamp. 2. when setting myVariable compare timestamps and function returns. 3. This  is C. There is no other way then to implement this yourself."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1533711499, "post_id": 51739429, "comment_id": 90440721, "body": "Generally, you may want to look at something like <a href=\"https://www.gnu.org/software/cflow/\" rel=\"nofollow noreferrer\">GNU Cflow</a> to chart the control flow within your source file(s) as your programs grown in size."}], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1533711818, "post_id": 51739890, "comment_id": 90440894, "body": "Thanks for you info. But debuggers are great when debugging. I need to check the condition during the run time of the system. Trying to be more precise:My requirement is that I can change to an specific state within my system only if first myFunction1() than myFunction2() and than myFunction3() is called."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1533709615, "creation_date": 1533709615, "answer_id": 51739890, "question_id": 51739429, "link": "https://stackoverflow.com/questions/51739429/how-do-i-check-the-call-order-of-different-functions-in-c/51739890#51739890", "title": "How do I check the call order of different functions in C", "body": "<p>There is no direct and portable way. That being said, debuggers are great at breaking execution flow when a function is reached, so you could either use a debugger, or use debugging functions to be warned when the functions are called (unfortunately nothing portable here).</p>\n\n<p>Alternatively, some linkers allow to hide some identifiers and replace them so with custom (and advanced) link options you could replace all call to those functions with calls to custom wrappers. But here again it would only makes sense for a specific implementation so it is not a C way either.</p>\n\n<p>Anyway, this is such an uncommon requirement that I cannot imagine the actual reasonning behind. Maybe you could give more context about your real problem...</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1533711786, "creation_date": 1533711786, "answer_id": 51740436, "question_id": 51739429, "link": "https://stackoverflow.com/questions/51739429/how-do-i-check-the-call-order-of-different-functions-in-c/51740436#51740436", "title": "How do I check the call order of different functions in C", "body": "<p>This is almost certainly an \"XY problem\". That is, you think saving the call order is the solution to your actual problem, but your actual problem might be to ensure that the functions can't be called in the wrong order in the first place. </p>\n\n<p>So the most correct way to fix this is to remake the program design. Someone mentioned state machines as one solution. Another solution might be something like an array of function pointers (which is a common implementation of state machines).</p>\n\n<hr>\n\n<p>That being said, you <em>can</em> do something artificial to track the call order, though I wouldn't really recommend it. Example:</p>\n\n<pre><code>#define CALL_ORDER_N 3\n\nconst char* call_order [CALL_ORDER_N] = {NULL};\nsize_t call_order_i = 0;\n\n\nstatic void save_call (const char* func)\n{\n  call_order[call_order_i] = func;\n  call_order_i++;\n  if(call_order_i == CALL_ORDER_N)\n  {\n    call_order_i = 0;\n  } \n}\n</code></pre>\n\n<p>Where <code>call_order</code> saves the 3 last function calls as pointers to string literals. The function <code>save_call</code> updates this array, by passing the <code>__func__</code> constant to it from each function. <code>__func__</code> is guaranteed to work like a <code>static const char[]</code> so this is safe. You'd do something like this:</p>\n\n<pre><code>void myFunction1 (void)\n{\n  save_call(__func__);\n  ...\n}\n\nvoid myFunction2 (void)\n{\n  save_call(__func__);\n  ...\n}\n\nvoid myFunction3 (void)\n{\n  save_call(__func__);\n  ...\n}\n</code></pre>\n\n<p>And then go through the calls to see if they were in the correct order:</p>\n\n<pre><code>static bool is_call_order_ok (void)\n{\n  const char* expected_order [CALL_ORDER_N] = \n  {\n    \"myFunction1\",\n    \"myFunction2\",\n    \"myFunction3\"\n  };\n\n  size_t co_i = call_order_i;\n\n  for(size_t i=0; i&lt;CALL_ORDER_N; i++)\n  {\n    if(strcmp(call_order[co_i], expected_order[i])==0)\n    {\n      co_i++;\n      if(co_i == CALL_ORDER_N)\n      {\n        co_i = 0;\n      } \n    }\n    else\n    {\n      return false;\n    }\n  }\n\n  return true;\n}\n</code></pre>\n\n<p>Full example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\n#define CALL_ORDER_N 3\n\nconst char* call_order [CALL_ORDER_N] = {NULL};\nsize_t call_order_i = 0;\n\n\nstatic void save_call (const char* func)\n{\n  call_order[call_order_i] = func;\n  call_order_i++;\n  if(call_order_i == CALL_ORDER_N)\n  {\n    call_order_i = 0;\n  } \n}\n\nstatic bool is_call_order_ok (void)\n{\n  const char* expected_order [CALL_ORDER_N] = \n  {\n    \"myFunction1\",\n    \"myFunction2\",\n    \"myFunction3\"\n  };\n\n  size_t co_i = call_order_i;\n\n  for(size_t i=0; i&lt;CALL_ORDER_N; i++)\n  {\n    if(strcmp(call_order[co_i], expected_order[i])==0)\n    {\n      co_i++;\n      if(co_i == CALL_ORDER_N)\n      {\n        co_i = 0;\n      } \n    }\n    else\n    {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n\nvoid myFunction1 (void)\n{\n  save_call(__func__);\n}\n\n\nvoid myFunction2 (void)\n{\n  save_call(__func__);\n}\n\n\nvoid myFunction3 (void)\n{\n  save_call(__func__);\n}\n\n\n\nint main (void)\n{\n  printf(\"Call 1,2,3: \");\n  myFunction1();\n  myFunction2();\n  myFunction3();\n  printf(is_call_order_ok() ? \"Ok\\n\" : \"Failed\\n\");\n\n  printf(\"Call 3,2,1: \");\n  myFunction3();\n  myFunction2();\n  myFunction1();\n  printf(is_call_order_ok() ? \"Ok\\n\" : \"Failed\\n\");\n\n  printf(\"Call 1,1,1: \");\n  myFunction1();\n  myFunction1();\n  myFunction1();\n  printf(is_call_order_ok() ? \"Ok\\n\" : \"Failed\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>The advanced, more professional version of the above, would be to cook together a mini-API with a single function, in order to give private encapsulation to every single variable. The function <code>save_call</code> would then be a multi-purpose function, that can be used to register expected call order, save function calls, as well as verify if the current registered order is ok.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\n#define CALL_ORDER_N 3\n\nstatic bool save_call (const char* func, bool verify)\n{\n  bool result;\n\n  static const char* call_order [CALL_ORDER_N] = {NULL};\n  static size_t call_order_i = 0;\n  static const char* expected_order [CALL_ORDER_N] = {NULL};\n\n  size_t i = call_order_i;\n\n  if(verify)                           // special case, verify the order\n  {\n    for(size_t expected=0; expected&lt;CALL_ORDER_N; expected++)\n    {\n      if(call_order[i] == expected_order[expected])\n      {\n        i++;\n        if(i == CALL_ORDER_N)\n        {\n          i = 0;\n        } \n      }\n      else\n      {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  if(expected_order[i] == NULL)        // register order of calls\n  {\n    expected_order[i] = func;\n    result = true;\n  }\n  else                                 // save calls\n  {\n    call_order[i] = func;\n    result = false;\n  }\n\n  call_order_i++;\n  if(call_order_i == CALL_ORDER_N)\n  {\n    call_order_i = 0;\n  } \n\n  return result;\n}\n\n\nvoid myFunction1 (void)\n{\n  if(save_call(__func__, false))\n    return ;\n  printf(\"Execute stuff in %s.\\n\", __func__);\n}\n\n\nvoid myFunction2 (void)\n{\n  if(save_call(__func__, false))\n    return ;\n  printf(\"Execute stuff in %s.\\n\", __func__);\n}\n\n\nvoid myFunction3 (void)\n{\n  if(save_call(__func__, false))\n    return ;\n  printf(\"Execute stuff in %s.\\n\", __func__);\n}\n\n\n\nint main (void)\n{\n  /* register call order: */\n  myFunction1();\n  myFunction2();\n  myFunction3();\n\n\n  printf(\"Call 1,2,3:\\n\");\n  myFunction1();\n  myFunction2();\n  myFunction3();\n  printf(save_call(NULL, true) ? \"Ok\\n\\n\" : \"Failed\\n\\n\");\n\n  printf(\"Call 3,2,1:\\n\");\n  myFunction3();\n  myFunction2();\n  myFunction1();\n  printf(save_call(NULL, true) ? \"Ok\\n\\n\" : \"Failed\\n\\n\");\n\n  printf(\"Call 1,1,1:\\n\");\n  myFunction1();\n  myFunction1();\n  myFunction1();\n  printf(save_call(NULL, true) ? \"Ok\\n\\n\" : \"Failed\\n\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p><code>save_call</code> should of course be properly placed in a .h/.c file pair of its own.</p>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 51740436, "answer_count": 2, "score": 0, "last_activity_date": 1533711786, "creation_date": 1533707427, "question_id": 51739429, "link": "https://stackoverflow.com/questions/51739429/how-do-i-check-the-call-order-of-different-functions-in-c", "title": "How do I check the call order of different functions in C", "body": "<p>in order to set a certain variable (MyVariable) to \"TRUE\" I have to check that a specific function call order was respected within a system.\nFor example, I have different functions within the system:</p>\n\n<pre><code>uint8 myFunction1()\n{\n    if (...)\n    {\n    return NOT_OK\n    }\n    else     \n    {\n    return OK\n    }\n}\n\nuint8 myFunction2()\n{\n    if (...)\n    {\n    return NOT_OK\n    }\n    else     \n    {\n    return OK\n    }\n}\n\n\nuint8 myFunction3()\n{\n    if (...)\n    {\n    return NOT_OK\n    }\n    else     \n    {\n    return OK\n    }\n}\n</code></pre>\n\n<p>MyVariable = TRUE only if: </p>\n\n<ol>\n<li><p>OK == myFunction1</p></li>\n<li><p>OK == myFunction2</p></li>\n<li><p>OK == myFunction3</p></li>\n</ol>\n\n<p>exactly this call order was respected.\nHow to check the call order in C but without touching the body of the functions (like setting some flags\u00b4etc.)?</p>\n\n<p>I'm still beginner and experimenting with C :)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 491, "user_id": 5772210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXwRX.jpg?s=128&g=1", "display_name": "Spoonless", "link": "https://stackoverflow.com/users/5772210/spoonless"}, "edited": false, "score": 0, "creation_date": 1533713401, "post_id": 51739118, "comment_id": 90441847, "body": "I assume this is I2C communications?"}, {"owner": {"reputation": 1, "user_id": 10195237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35270d7a26fa2f60cdb1c6f95a319577?s=128&d=identicon&r=PG&f=1", "display_name": "HAN LIN", "link": "https://stackoverflow.com/users/10195237/han-lin"}, "reply_to_user": {"reputation": 491, "user_id": 5772210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXwRX.jpg?s=128&g=1", "display_name": "Spoonless", "link": "https://stackoverflow.com/users/5772210/spoonless"}, "edited": false, "score": 0, "creation_date": 1533718172, "post_id": 51739118, "comment_id": 90444726, "body": "Yes,it is. And it also SMBus in C8051FXXX"}], "owner": {"reputation": 1, "user_id": 10195237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35270d7a26fa2f60cdb1c6f95a319577?s=128&d=identicon&r=PG&f=1", "display_name": "HAN LIN", "link": "https://stackoverflow.com/users/10195237/han-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533710188, "creation_date": 1533705786, "last_edit_date": 1533710188, "question_id": 51739118, "link": "https://stackoverflow.com/questions/51739118/how-to-continuos-transmit-data", "title": "How to continuos transmit data?", "body": "<p>Chip\uff1aC8051F321 &amp; PCF85176(LCD Driver)</p>\n\n<p>I am trying to communicate from C8051F321(MASTER) to PCF85176(SLAVE), and the original code is only transmit for one byte like this:</p>\n\n<blockquote>\n  <p>START \u2192 SLAVE ADDR \u2192 DATA \u2192 ACK \u2192 STOP</p>\n</blockquote>\n\n<p>But I tried to make it like</p>\n\n<blockquote>\n  <p>START \u2192 SLAVE ADDR \u2192 Command \u2192 ACK  \u2192 DATA \u2192 ACK...\u2192 ACK ..\u2192 ACK .. \u2192\n  STOP</p>\n</blockquote>\n\n<p>And it always no effect like my code</p>\n\n<p>How can I correct my code?</p>\n\n<p>Thanks for helping~</p>\n\n<pre><code>void SMBus_ISR (void) interrupt 7\n{\n    bit FAIL = 0;                       // Used by the ISR to flag failed\n                                        // transfers\n    static bit ADDR_SEND = 0;           // Used by the ISR to flag failed    \n    unsigned char a;                    // transmissions as slave addresses\n\n    if(ARBLOST == 0)\n    {\n        switch (SMB0CN &amp; 0xF0)          // Status vector\n        {\n        // Master Transmitter/Receiver: START condition transmitted.\n        case SMB_MTSTA:\n            SMB0DAT = TARGET;           // Load address of the target slave\n            SMB0DAT &amp;= 0xFE;            // Clear the LSB of the address for the\n                                        // R/W bit\n            SMB0DAT |= SMB_RW;          // Load R/W bit\n            STA = 0;                    // Manually clear START bit\n            ADDR_SEND = 1;                        \n            break;\n\n        // Master Transmitter: Data byte \n        case SMB_MTDB:\n            if (ACK)                    // Slave Address or Data Byte\n            {                           // Acknowledged?\n                if (ADDR_SEND)\n                {                                      \n                    ADDR_SEND = 0;      // Next byte is not a slave address              \n                    if(SMB_DATA_OUT==0xF0)\n                    {                                       \n                        SMB0DAT = SMB_DATA_OUT;\n                        ADDR_SEND = 0;\n                    }\n                    else\n                    {                                   \n                        SMB0DAT = SMB_Command_OUT;\n                        ADDR_SEND = 1;                                    \n                    }                                           \n                }\n                else                    // If previous byte was not a slave address,\n                {                               \n                    STO =1;             // Set STO to terminate transfer\n                    SMB_BUSY =0;        // And free SMBus interface\n                }\n            }\n            else\n            {\n                STO = 1;                // Set STO to terminate transfer\n                STA = 1;                // By a START\n                NUM_ERRORS++;           // Indicate error\n            }                   \n        break;\n\n        //Master Receiver:byte received\n        case SMB_MRDB:\n            SMB_DATA_IN =SMB0DAT;       // Store received byte\n            SMB_BUSY = 0;               // Free SMBus interface\n            ACK = 0;                    // Send NACK to indicate last byte\n                                        // of this transfer\n            STO = 1;                    // Send STOP to terminate transfer\n            break;\n\n        default:\n            FAIL = 1;                   // Indicate failed transfer\n                                        // and handle at end of ISR \n            break;\n        }//end switch\n    }\n    else\n    {\n         //ARBLOST = 1,error occurred...abort transmission\n         FAIL = 1;\n    } //end ARBLOST if\n\n    if(FAIL)                            // If the transfer failed,\n    {\n         SMB0CF &amp;= ~0x80;               // Reset communication\n         SMB0CF |= 0x80;\n         STA = 0;\n         STO = 0;\n         ACK = 0;\n         SMB_BUSY = 0;                  // Free SMBus               \n         FAIL = 0;\n         NUM_ERRORS++;                  // Indicate an error occurred\n    }\n    SI = 0;                             //Clear interrupt flag\n}\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1533705183, "post_id": 51739013, "comment_id": 90438166, "body": "Please format code correctly in your question. Code lines should have four spaces at least in front of them. Use the <code>edit</code> link (and also motivate your question). Provide some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. BTW, the current C standard is C11 (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>). ANSI C is obsolete"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1533705521, "post_id": 51739013, "comment_id": 90438258, "body": "Your assumption seems plausible (I am using it, too.) Your question is about a quote from standard to put it on a firm foundation?"}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1533708036, "creation_date": 1533708036, "answer_id": 51739544, "question_id": 51739013, "link": "https://stackoverflow.com/questions/51739013/c-translation-phase-4/51739544#51739544", "title": "C translation phase 4", "body": "<p>I'll not hash out what you already know. What you apparently did <em>not</em> know:</p>\n\n<blockquote>\n  <p><strong>6.10.3.4</strong> <strong>Rescanning and further replacement</strong></p>\n  \n  <ol>\n  <li>After all parameters in the replacement list have been substituted and # and ## processing has taken place, all placemarker preprocessing\n  tokens are removed. Then, the resulting preprocessing token sequence\n  is rescanned, along with all subsequent preprocessing tokens of the\n  source file, for more macro names to replace.</li>\n  <li>If the name of the macro being replaced is found during this scan of the replacement list (not including the rest of the source file\u2019s\n  preprocessing tokens), it is not replaced. Furthermore, if any nested\n  replacements encounter the name of the macro being replaced, it is not\n  replaced. These nonreplaced macro name preprocessing tokens are no\n  longer available for further replacement even if they are later\n  (re)examined in contexts in which that macro name preprocessing token\n  would otherwise have been replaced.</li>\n  <li>The resulting completely macro-replaced preprocessing token sequence is not processed as a preprocessing directive even if it\n  resembles one, but all pragma unary operator expressions within it are\n  then processed as specified in 6.10.9 below.</li>\n  </ol>\n</blockquote>\n\n<p>In short, once a macro has been expanded and all the string-izer and concatenations have been performed, the resulting \"thing\" is scanned once again for more stuff to replace. If the same name is found, it is <em>not</em> replaced.</p>\n\n<p>So what you're seeing is standard-defined.</p>\n"}], "owner": {"reputation": 13, "user_id": 8486938, "user_type": "registered", "profile_image": "https://graph.facebook.com/1479789122102142/picture?type=large", "display_name": "raducrv", "link": "https://stackoverflow.com/users/8486938/raducrv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51739544, "answer_count": 1, "score": -1, "last_activity_date": 1533713226, "creation_date": 1533705086, "last_edit_date": 1533713226, "question_id": 51739013, "link": "https://stackoverflow.com/questions/51739013/c-translation-phase-4", "title": "C translation phase 4", "body": "<p>Recently I encountered the following issue. My implementation was looking like this:</p>\n\n<pre><code>#define MY_CODE_VERSION PROJ_VERSION\n#include \"project.h\"\nif (3 != MY_CODE_VERSION)\n</code></pre>\n\n<p>PROJ_VERSION was defined in project.h. Why didn't I get a compilaton warning/error? Because I was trying to define something on a macro that was not known by the time the compiler was reaching the line <code>#define MY_CODE_VERSION PROJ_VERSION</code>.<br>\nI took a look over these phases from ANSI C but I can't figure it out the reason (the actual behaviour of the compiler, at which phase MY_CODE_VERSION takes the value of PROJ_VERSION).  </p>\n\n<p>My assuption is that this replacement takes place only at line \"#if (3 != MY_CODE_VERSION)\" and by this time PROJ_VERSION is already known by the compiler from the inclusion of project.h above.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["c", "oop"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1533701241, "post_id": 51738453, "comment_id": 90437195, "body": "You didn&#39;t call the function. You just assigned the pointer value to the <code>int</code> variable. To emulate OOP, it&#39;s standard practice to pass the object pointer as the first argument to all of the class methods. That way you have access to the member variables <code>basic_salary</code> and <code>experience</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1533701361, "post_id": 51738453, "comment_id": 90437214, "body": "What do you mean by &quot;OOP&quot;? For me it means object oriented programming, but C is not famed for its object orientation. So I would like to make sure that we are thinking of the same &quot;OOP&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8680478"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1533701814, "post_id": 51738453, "comment_id": 90437306, "body": "@Yunnosch : There&#39;s a book named <a href=\"https://www.cs.rit.edu/~ats/books/ooc.pdf\" rel=\"nofollow noreferrer\">Object-Oriented Programming With ANSI-C</a>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1533701976, "post_id": 51738453, "comment_id": 90437335, "body": "@EmilyE. I do not get your point. I know OOP is possible with C, but I think that is only true if you know both already. But learning OOP using C seems a very tough path to walk. So I kind of hope that OP means something different by &quot;OOP&quot;, which might mean OPs life is not going to turn very unpleasant very soon."}, {"owner": {"reputation": 1, "user_id": 9442479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TreeCity", "link": "https://stackoverflow.com/users/9442479/treecity"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1533702714, "post_id": 51738453, "comment_id": 90437521, "body": "@Yunnosch There are many applications of OOP in C. For example, C library function fopen()"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1533702783, "post_id": 51738453, "comment_id": 90437536, "body": "@TreeCity same comment as above to Emily. I know it is possible."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533703587, "post_id": 51738453, "comment_id": 90437758, "body": "Learn OOP in a OO language.  It will be easier on everyone, especially you."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1533704629, "post_id": 51738453, "comment_id": 90437995, "body": "Somebody should have told those poor fellas over a Gtk+ that a long time ago.... (but I do quite like what they came up with in Version 2)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1533705608, "post_id": 51738453, "comment_id": 90438274, "body": "It would also make more sense to declare <code>int (*calculate_salary)(struct employee*);</code> so you could pass a pointer your struct instance as a the parameter making the <code>inst-&gt;salary</code> and <code>inst-&gt;experience</code> available within <code>cal_salary_oop</code>. Then you could return the total salary, e.g. <code>return e-&gt;salary + e-&gt;basic_salary;</code> from your function. You would be interested in chapters 2 and 3 of the &quot;OOP with ANSI C&quot; -- link above. Pay attention to why the sizeof the struct is the first member and what problems that solves."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 2831379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZmXu.jpg?s=128&g=1", "display_name": "P Kumarasamy", "link": "https://stackoverflow.com/users/2831379/p-kumarasamy"}, "is_accepted": true, "score": 3, "last_activity_date": 1533702128, "last_edit_date": 1533702128, "creation_date": 1533701988, "answer_id": 51738548, "question_id": 51738453, "link": "https://stackoverflow.com/questions/51738453/learning-oop-in-c/51738548#51738548", "title": "learning OOP in C", "body": "<p>In above small error in line no 44  </p>\n\n<pre><code>int emp_cal_salary = emp-&gt;calculate_salary;\n</code></pre>\n\n<p><code>emp-&gt;calculate_salary</code> has address of <code>cal_salary_oop</code>. </p>\n\n<p>i.e obj->calculate_salary =  &amp;cal_salary_oop; </p>\n\n<p>now you tried to do the same here instead pointer to function you are trying to use int </p>\n\n<pre><code>int emp_cal_salary = emp-&gt;calculate_salary;\n</code></pre>\n\n<p>you are trying to assign the pointer address to emp_cal_salary  instead of call the function .</p>\n\n<p>try this below line it work </p>\n\n<pre><code>int emp_cal_salary = emp-&gt;calculate_salary(exp); // i.e exp  =14 \n</code></pre>\n\n<p>you cannot assign the memory location to integer variable. </p>\n"}], "owner": {"reputation": 1, "user_id": 9442479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TreeCity", "link": "https://stackoverflow.com/users/9442479/treecity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 1, "accepted_answer_id": 51738548, "answer_count": 1, "score": -1, "last_activity_date": 1533709567, "creation_date": 1533701046, "last_edit_date": 1533709567, "question_id": 51738453, "link": "https://stackoverflow.com/questions/51738453/learning-oop-in-c", "title": "learning OOP in C", "body": "<p>I am learning OOP using C. I am getting a </p>\n\n<blockquote>\n  <p>\"warning: initialization makes integer from pointer without a cast\n  [-Wint-conversion]\" for line 44 (see code comment)</p>\n</blockquote>\n\n<p>I am using <code>gcc</code>. Please explain why I am getting this warning.</p>\n\n<p>Also please recommend a good learning resource for OOP in C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct employee {\n    int experience;\n    double basic_salary;\n    double salary;\n    char name[20];\n    int (*calculate_salary)(int a);\n};\n\ntypedef struct employee emp;\ntypedef emp *Employee;\n\nint cal_salary_oop (int exp) {\n    int salary = 0;\n    if (exp&gt;15)\n        salary += 25000;\n    else if (exp &gt; 10)\n        salary += 15000;\n    else if (exp &gt; 5)\n        salary += 5000;\n    return salary;\n}\n\nEmployee new_Employee (int experience, int basic_salary) {\n    Employee obj = (Employee) malloc (sizeof(emp));\n    obj-&gt;basic_salary = basic_salary;\n    obj-&gt;experience = experience;\n    obj-&gt;calculate_salary =  &amp;cal_salary_oop;\n    return obj;\n}\n\nvoid destroy_Employee(Employee e) {\n    free(e);\n}\n\nint main(void) {\n\n    Employee emp = new_Employee(14,2000);\n\n    int emp_cal_salary = emp-&gt;calculate_salary;   // line 44\n    printf(\"emp1 calculated salary like oop way %d\\n\",emp_cal_salary);\n\n    destroy_Employee(emp);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 1214, "user_id": 4309985, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d9a46a23b2bc57d11cf9c3adda670dea?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Fan", "link": "https://stackoverflow.com/users/4309985/andrew-fan"}, "edited": false, "score": 1, "creation_date": 1533697431, "post_id": 51737998, "comment_id": 90436462, "body": "What&#39;s the error? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533697654, "post_id": 51737998, "comment_id": 90436497, "body": "Note that <code>&lt;stdlib.h&gt;</code> declares <code>malloc()</code> et al, so there&#39;s no need for the non-standard <code>&lt;malloc.h&gt;</code> unless you&#39;re using some of its extra functionality, which you aren&#39;t.  You&#39;ve not outlined what values you input \u2014 or the error output you get.  That&#39;s an important part of an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  We should not have to guess.  When debugging, you could usefully call your <code>read_list()</code> function after each operation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533698081, "post_id": 51737998, "comment_id": 90436577, "body": "Your global variable <code>temp</code> is worrying; I&#39;m not clear how it is meant to be used. It seems to be important to you since you carefully set it in the delete code, but why? Similarly, the global variable <code>next</code> probably shouldn&#39;t be global.  Using the global variable <code>head</code> is permissible \u2014 it&#39;s often not the best choice, but it is OK.  It means you can only manage one list at a time with this code, but that&#39;s OK when you&#39;re starting out.  Using <code>void main()</code> is not valid on Unix-like systems; the correct return type is <code>int</code>.  Windows documents <code>void main()</code> so it isn&#39;t automatically wrong."}, {"owner": {"reputation": 3364, "user_id": 4195981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9NJwu.jpg?s=128&g=1", "display_name": "F.Igor", "link": "https://stackoverflow.com/users/4195981/f-igor"}, "edited": false, "score": 0, "creation_date": 1533698200, "post_id": 51737998, "comment_id": 90436596, "body": "Why are you using <code>delete_list(&amp;head,2);</code> with a fixed 2? What is the expected behavior of <code>delete_list</code>? it&#39;s only to delete the last node?"}, {"owner": {"reputation": 31, "user_id": 8866422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175bd9be45981cca8db20ecac9c48939?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Mahmoud", "link": "https://stackoverflow.com/users/8866422/ahmed-mahmoud"}, "reply_to_user": {"reputation": 3364, "user_id": 4195981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9NJwu.jpg?s=128&g=1", "display_name": "F.Igor", "link": "https://stackoverflow.com/users/4195981/f-igor"}, "edited": false, "score": 0, "creation_date": 1533698412, "post_id": 51737998, "comment_id": 90436636, "body": "@F.Igor i am setting it as an example so if i entered 5 nodes as an example and deleted the 2nd it would shift them back 1 step , and would print 4 nodes again without the 2nd"}, {"owner": {"reputation": 31, "user_id": 8866422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175bd9be45981cca8db20ecac9c48939?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Mahmoud", "link": "https://stackoverflow.com/users/8866422/ahmed-mahmoud"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533698515, "post_id": 51737998, "comment_id": 90436647, "body": "@JonathanLeffler I am using the temporary variable globally just to make sure it can be seen between the functions and the main, other than that i make sure i reclear it again by setting it back to zero"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533698702, "post_id": 51737998, "comment_id": 90436687, "body": "Suggestion: don&#39;t!  Also, in your delete code, you have consecutive assignments <code>temp-&gt;next=0; temp-&gt;next = next;</code> \u2014 you don&#39;t need the first given the second, and I&#39;m not convinced that either is a good idea.  I note that no memory is freed; you&#39;re leaking when you delete (assuming you get the delete working to the extent that the node is detached from the list)."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533702031, "post_id": 51737998, "comment_id": 90437354, "body": "Regarding your delete, positional delete in a single-linked list should look <a href=\"https://pastebin.com/k9udK7gQ\" rel=\"nofollow noreferrer\">something like this</a>"}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1533702397, "post_id": 51737998, "comment_id": 90437438, "body": "What are you doing here: <code>temp-&gt;next = head; temp = head;</code> in <code>create_list()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 7856708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eeaad188a92bda9dd5bdd2309439752?s=128&d=identicon&r=PG&f=1", "display_name": "Cholax", "link": "https://stackoverflow.com/users/7856708/cholax"}, "is_accepted": true, "score": 1, "last_activity_date": 1533792292, "last_edit_date": 1533792292, "creation_date": 1533701996, "answer_id": 51738549, "question_id": 51737998, "link": "https://stackoverflow.com/questions/51737998/c-programming-error-in-code/51738549#51738549", "title": "C programming error in code", "body": "<p><strong>If any more questions don't doubt to contact me. Good luck.</strong></p>\n\n<p><strong>About createlist()</strong></p>\n\n<p><em>Head should point to the first element of the list, but you are using head to instantiate the newest element added to the list. First and head conceptually are the same. I think you think head should be the last element of the list but it should't. Read more about linked lists. Also you are pointing to head from temp? But wait, what is temp? Can you tell me what is temp at that point in your program? You should't rely on temp, that's why it is called temp. It should be a temporal variable. Not a global variable.</em></p>\n\n<p><strong>About read_list()</strong></p>\n\n<p><em>Why temp-> next = 0? You could be breaking your chain here because we don't know what temp is. Let's continue. So you point to the first element in the list (which should be the same as head). OH MY GOD! You point first to null. Of course you can't read the list twice nor thrice. Once you point first to null you lose your only reference to the first element of the list. It doesn't matter what you do with your other functions. You won't be able to call this function twice in a row and your code will break.</em></p>\n\n<p><em>I mean. First time you pass you do temp = first. Then first = NULL</em></p>\n\n<p><em>Second time. temp = first. Buut... first = null? Rings a bell? You won't be able to print anything else.</em></p>\n\n<p><em>The while loop is ok.</em></p>\n\n<p><strong>About delete_list()</strong></p>\n\n<p><em>Ok you lost me here. You are using head now. But i can tell you, head is absolutely not pointing to the first element in the list. If anything it is the last element on the list and (head->next = random stuff) and if lucky (head->next = null). I am not sure, but if head would point to the first element on the list (but it is not) this function may be ok or close to ok. But don't take my word on this one, i am really tired right now.</em></p>\n\n<p><strong>Summary:</strong></p>\n\n<p><em>Your functions are wrong. There is not one function breaking your code but many. Your main problem is that you are messing up things with the pointers. If i were you i would:</em></p>\n\n<ul>\n<li>Remove first and temp as global variables.</li>\n<li>Review linked lists <a href=\"https://www.cs.cmu.edu/~adamchik/15-121/lectures/Linked%20Lists/linked%20lists.html\" rel=\"nofollow noreferrer\">Linked Lists</a></li>\n<li>Use temp as a local variable in your functions.</li>\n<li>Freed allocated memory and if possible check for errors when allocating.</li>\n<li>Head should always point to the first element in the list. You should't update head, unless you add the first element to the list or remove the last one.</li>\n<li>The only case where you should update head is when adding an element to the beginning of the list but i encourage you to try making the program without this feature first.</li>\n</ul>\n\n<p>If you allocate memory (for ex, calloc or malloc) you should always freed that memory and point the pointers to NULL (It is good practice). The way you programmed you are leaking memory.</p>\n\n<p>Also you should't have temp as a global variable. It can produce problems you wouldn't have if you weren't using it. Also having three global variables makes things harder to review or debug. When the only global variable you should have is head.</p>\n\n<p><strong>I wrote an alternative for your code if you want to check it.</strong></p>\n\n<p><strong>Explanation of the code:</strong></p>\n\n<p><em>I don't check for user input but it can be easily added in the main function. \nThere are 5 functions: addLastElement, addFirstElement, deleteList, deleteElement and readList.</em></p>\n\n<ul>\n<li><p>readList: Prints the list.</p></li>\n<li><p>addLastElement: IF there is no element it will add the head. If there\nare elements, it will add a new element at the end of the list. It\ndoesn't update the head unless head is null.</p></li>\n<li><p>addFirstElement: Adds an element at the beginning of the list. This\nfunction always updates the head.</p></li>\n<li><p>deleteElement: Deletes element in the position passed as an argument.\nAnd it frees the memory.</p></li>\n<li><p>deleteList: Will delete all elements from the list and free the\nmemory.</p></li>\n</ul>\n\n<p>All the functions except for readList will update the variable \"size\" of the struct list accordingly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student\n{\n    int id;\n    int age;\n    struct student *next;\n};\n\nstruct list\n{\n    struct student *head;\n    int size;\n};\n\nvoid addFirstElement(struct list *list, int id, int age)\n{\n    struct student *temp;\n    temp = (struct student *)malloc(sizeof(struct student));\n    if (temp == NULL)\n    {\n        printf(\"Error: Couldn't allocate memory\\n\");\n    }\n    temp -&gt; id = id;\n    temp -&gt; age = age;\n    temp-&gt;next = list -&gt; head;\n    list-&gt;head = temp;\n    list-&gt;size++;\n}\n\nvoid addLastElement(struct list *list, int id, int age)\n{\n    struct student *new;\n    struct student *temp;\n    new = (struct student *)malloc(sizeof(struct student));\n    if (new == NULL)\n    {\n        printf(\"Error: Couldn't allocate memory\\n\");\n    }\n    new-&gt;id = id;\n    new-&gt;age = age;\n    new-&gt;next = NULL;\n    if (list-&gt;head == NULL)\n    {\n        list-&gt;head = new;\n    }\n    else\n    {\n        temp = list -&gt; head;\n        while (temp-&gt;next != NULL)\n        {\n            temp = temp-&gt;next;\n        }\n        temp-&gt;next = new;\n    }\n    list-&gt;size++;\n}\n\nvoid readList(struct list *list)\n{\n    struct student *temp = list-&gt;head;\n\n    while (temp != NULL)\n    {\n        printf(\"ID: %d - Age: %d\\n\", temp-&gt;id, temp-&gt;age);\n        temp = temp-&gt;next;\n    }\n}\n\nvoid deleteList(struct list *list)\n{\n    struct student *temp;\n    struct student *previous;\n\n    temp = list-&gt;head;\n    while (temp != NULL)\n    {\n        previous = temp;\n        temp = temp-&gt;next;\n        free(previous);\n    }\n    previous = NULL;\n    list-&gt;size = 0;\n    list-&gt;head = NULL;\n}\n\nvoid deleteElement(struct list *list, int position)\n{\n    if (list-&gt;head == NULL)\n        return;\n\n    if (position &lt; 0 || position &gt; ((list-&gt;size) - 1))\n    {\n        printf(\"The list is not that big\\n\");\n        return;\n    }\n\n    struct student *temp = list-&gt;head;\n    struct student *previous = NULL;\n    int i = 0;\n\n    temp = list-&gt;head;\n    while (i != position)\n    {\n        previous = temp;\n        temp = temp-&gt;next;\n        i++;\n    }\n\n    if (previous == NULL)\n    {\n        list-&gt;head = list-&gt;head-&gt;next;\n    }\n    else\n    {\n        previous-&gt;next = temp-&gt;next;\n    }\n    list-&gt;size--;\n    free(temp);\n    temp = NULL;\n    return;\n}\nint main()\n{\n    struct list list;\n    int i;\n    list.size = 0;\n    list.head = NULL;\n\n    for (i = 0; i &lt; 10; i++)\n    {\n        addLastElement(&amp;list, i, (i+1)*10);\n    }\n\n    deleteElement(&amp;list, 5);\n\n    addFirstElement(&amp;list, 100, 50);\n\n    readList(&amp;list);\n\n    deleteList(&amp;list);\n\n    return 1;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ID: 100 - Age: 50\nID: 0 - Age: 10\nID: 1 - Age: 20\nID: 2 - Age: 30\nID: 3 - Age: 40\nID: 4 - Age: 50\nID: 6 - Age: 70\nID: 7 - Age: 80\nID: 8 - Age: 90\nID: 9 - Age: 100\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1533703464, "last_edit_date": 1533703464, "creation_date": 1533703057, "answer_id": 51738706, "question_id": 51737998, "link": "https://stackoverflow.com/questions/51737998/c-programming-error-in-code/51738706#51738706", "title": "C programming error in code", "body": "<p>Your code in <code>create_list()</code> does not check that the memory allocation succeeded.  It also doesn't set the <code>next</code> element reliably.  This means that if you add 5 nodes and print them, you get to see only the most recently added node in the list.  Because the list is not constructed correctly, your delete code doesn't stand much chance of working (it crashes for me, and I'm too lazy to work out exactly why; it's probably because of dereferencing a null pointer).  One key problem is confusion over the role of <code>head</code> and <code>first</code> \u2014 <code>first</code> does point to the first element of the list, but is never updated, and <code>head</code> doesn't point to the first element in the list, contrary to normal conventions.  As already noted in comments, <code>temp</code> is mostly confusing \u2014 it should not exist as a global variable.  It is a major factor in your problems.</p>\n\n<p>Here's an alternative implementation.  It doesn't prompt for input; it is hardwired to add 5 students and then delete them all.  It uses <code>head</code> as a single global variable pointing to the first structure in the list.  It adds new elements at the start of the list.  It prints the list after each student is added or deleted, which allows for complete checking.  When printing, it uses one line for each student.  It frees the memory when a student is deleted.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student\n{\n    int ID;\n    int age;\n    struct student *next;\n};\n\nstruct student *head = 0;\n\nstatic void create_list(int ID, int age)\n{\n    struct student *node = (struct student *)malloc(sizeof(struct student));\n    if (node == 0)\n    {\n        fprintf(stderr, \"Failed to allocate %zu bytes\\n\", sizeof(*node));\n        exit(EXIT_FAILURE);\n    }\n    node-&gt;ID = ID;\n    node-&gt;age = age;\n    node-&gt;next = 0;\n    if (head != 0)\n        node-&gt;next = head;\n    head = node;\n}\n\nstatic void print_list(void)\n{\n    int counter = 0;\n    for (struct student *node = head; node != 0; node = node-&gt;next)\n    {\n        printf(\"-- Node %2d: ID = %.5d, age = %d\\n\", ++counter, node-&gt;ID, node-&gt;age);\n    }\n    printf(\"-- No. of nodes in the list = %d\\n\\n\", counter);\n}\n\nstatic void delete_list(int position)\n{\n    int counter = 0;\n    struct student *node = head;\n    struct student *prev = 0;\n    while (node != 0 &amp;&amp; ++counter != position)\n    {\n        prev = node;\n        node = node-&gt;next;\n    }\n\n    if (node == NULL)\n        return;\n    if (prev == NULL)\n    {\n        assert(node == head);\n        struct student *old = head;\n        head = head-&gt;next;\n        free(old);\n    }\n    else\n    {\n        assert(node != head);\n        prev-&gt;next = node-&gt;next;\n        free(node);\n    }\n}\n\nint main(void)\n{\n    create_list(10102, 19);\n    print_list();\n    create_list(23147, 20);\n    print_list();\n    create_list(30001, 21);\n    print_list();\n    create_list(47721, 18);\n    print_list();\n    create_list(59286, 20);\n    print_list();\n    delete_list(2);\n    print_list();\n    delete_list(3);\n    print_list();\n    delete_list(2);\n    print_list();\n    delete_list(1);\n    print_list();\n    delete_list(1);\n    print_list();\n    return 0;\n}\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>-- Node  1: ID = 10102, age = 19\n-- No. of nodes in the list = 1\n\n-- Node  1: ID = 23147, age = 20\n-- Node  2: ID = 10102, age = 19\n-- No. of nodes in the list = 2\n\n-- Node  1: ID = 30001, age = 21\n-- Node  2: ID = 23147, age = 20\n-- Node  3: ID = 10102, age = 19\n-- No. of nodes in the list = 3\n\n-- Node  1: ID = 47721, age = 18\n-- Node  2: ID = 30001, age = 21\n-- Node  3: ID = 23147, age = 20\n-- Node  4: ID = 10102, age = 19\n-- No. of nodes in the list = 4\n\n-- Node  1: ID = 59286, age = 20\n-- Node  2: ID = 47721, age = 18\n-- Node  3: ID = 30001, age = 21\n-- Node  4: ID = 23147, age = 20\n-- Node  5: ID = 10102, age = 19\n-- No. of nodes in the list = 5\n\n-- Node  1: ID = 59286, age = 20\n-- Node  2: ID = 30001, age = 21\n-- Node  3: ID = 23147, age = 20\n-- Node  4: ID = 10102, age = 19\n-- No. of nodes in the list = 4\n\n-- Node  1: ID = 59286, age = 20\n-- Node  2: ID = 30001, age = 21\n-- Node  3: ID = 10102, age = 19\n-- No. of nodes in the list = 3\n\n-- Node  1: ID = 59286, age = 20\n-- Node  2: ID = 10102, age = 19\n-- No. of nodes in the list = 2\n\n-- Node  1: ID = 10102, age = 19\n-- No. of nodes in the list = 1\n\n-- No. of nodes in the list = 0\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8866422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175bd9be45981cca8db20ecac9c48939?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Mahmoud", "link": "https://stackoverflow.com/users/8866422/ahmed-mahmoud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1533704880, "accepted_answer_id": 51738549, "answer_count": 2, "score": -4, "last_activity_date": 1539292255, "creation_date": 1533696929, "last_edit_date": 1539292255, "question_id": 51737998, "link": "https://stackoverflow.com/questions/51737998/c-programming-error-in-code", "closed_reason": "Not suitable for this site", "title": "C programming error in code", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student\n{\n    int ID;\n    int age;\n    struct student *next;\n};\n\nstruct student *head = 0;\nstruct student *first = 0;\nstruct student *temp = 0;\n\nvoid create_list()\n{\n    static int counter = 1;\n    head = (struct student *)malloc(sizeof(struct student));\n    printf(\"Enter the student no. %d ID\\n\",counter);\n    scanf_s(\"%d\", &amp;head-&gt;ID);\n    printf(\"Enter the student no. %d age\\n\", counter);\n    scanf_s(\"%d\", &amp;head-&gt;age);\n    if (first != 0)\n    {\n        temp-&gt;next = head;\n        temp = head;\n    }\n    else\n    {\n        first = temp = head;\n    }\n\n    counter++;\n}\n\nvoid read_list()\n{\n    temp-&gt;next = 0;\n\n    temp = first;\n    int counter = 1;\n    first = 0;\n    while (temp != 0)\n    {\n        printf(\"------------------Node number : %d---------------\\n\", counter);\n        printf(\"The Student id is : %d\\n\", temp-&gt;ID);\n        printf(\"The Student age is : %d\\n\", temp-&gt;age);\n        counter++;\n        temp = temp-&gt;next;\n    }\n    printf(\"NULL\\n\");\n    printf(\"-------------No. of nodes in the list = %d\\n------------------\", counter);\n}\n\nvoid delete_list(struct student **head, int position)\n{\n\n    if (*head == NULL)\n        return;\n\n    struct student* temp = *head;\n\n    if (position == 0)\n    {\n        *head = temp-&gt;next;   \n        temp = 0;               \n        return;\n    }\n\n    for (int i = 0; temp != NULL &amp;&amp; i&lt;position - 1; i++)\n        temp = temp-&gt;next;\n\n    if (temp == NULL || temp-&gt;next == NULL)\n        return;\n\n    struct student *next = temp-&gt;next-&gt;next;\n\n    temp-&gt;next=0;  \n    temp-&gt;next = next;  \n}\n\nvoid main()\n{\n\n    int choice = 0;\n    while (choice != 99)\n    {\n        printf(\"Please enter a choice from the list:\\n\");\n        printf(\"1- Create Node\\n\");\n        printf(\"2- Read List\\n\");\n        printf(\"3- Delete Node\\n\");\n        printf(\"99- Exit\\n\");\n        scanf_s(\"%d\", &amp;choice);\n        switch (choice)\n        {\n        case 1:\n            create_list();\n            break;\n        case 2:\n            read_list();\n            break;\n        case 3:\n            delete_list(&amp;head,2);\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>I've been encountering a lot of problems with my delete function. I am creating a linked node list. I created the read and create function but whenever I try to delete a node and shift back all the nodes it gives me back an error. Can I get some help about what is wrong?</p>\n\n<p>The error is that whenever I come again and print the list, it stops and doesn't print anything.</p>\n"}, {"tags": ["c", "pointers", "struct", "language-lawyer", "c11"], "comments": [{"owner": {"reputation": 3728, "user_id": 1324631, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/22ea15aa505ee3fdcc5cb40b00a31f63?s=128&d=identicon&r=PG", "display_name": "AJMansfield", "link": "https://stackoverflow.com/users/1324631/ajmansfield"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533699098, "post_id": 51737910, "comment_id": 90436755, "body": "@M.M The reason for the second part is the idea that the supposed validity of the union code seems to imply that the first sample should be valid as well. I guess it might make sense to split off another question asking just about the validity of the union code though."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533699304, "post_id": 51737910, "comment_id": 90436794, "body": "@AJMansfield There&#39;s no such implication in the standard; unions have special rules"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533703144, "post_id": 51737910, "comment_id": 90437630, "body": "<code>foo.arr[1] = 1;</code> is UB,  No spec that the next member is <code>foo.arr[1]</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533706465, "post_id": 51737910, "comment_id": 90438544, "body": "@chux that objection can be fixed with an <code>assert</code>; or by noting that it&#39;s legal to write to padding bytes"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533707818, "post_id": 51737910, "comment_id": 90439043, "body": "@M.M Legal to write to padding.  Hmmm.  I doubt writing any bit pattern to padding is OK.  Some times that is where check bits are hidden.  Perhaps a good question."}], "answers": [{"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1533711125, "post_id": 51738580, "comment_id": 90440499, "body": "Good answer, I&#39;d just like to add that the C committee has recently created a &quot;memory model working group&quot; to discuss this kind of questions and to come up with a more conclusive model for C2x."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1533711923, "post_id": 51738580, "comment_id": 90440949, "body": "@JensGustedt Cool, looking forward to seeing what they do come up with :)"}, {"owner": {"reputation": 3728, "user_id": 1324631, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/22ea15aa505ee3fdcc5cb40b00a31f63?s=128&d=identicon&r=PG", "display_name": "AJMansfield", "link": "https://stackoverflow.com/users/1324631/ajmansfield"}, "edited": false, "score": 0, "creation_date": 1533746877, "post_id": 51738580, "comment_id": 90463398, "body": "The reasoning for thinking the first examples are correct is that since <code>foo.arr</code> is guaranteed to be the same as <code>&amp;foo.a</code>, and <code>foo.arr + 1</code> points to the same location as <code>&amp;foo.b</code>, then replacing <code>foo.arr</code> with <code>&amp;foo.a</code>, as in <code>&amp;foo.a + 1</code>, should also be guaranteed to point to the same location as <code>&amp;foo.b</code>; and that since taking the union of the inner struct with the array shouldn&#39;t change the memory layout of the struct, this expression should also be legal without it. I&#39;ll edit my question to make the chain of reasoning more explicit."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1533762854, "post_id": 51738580, "comment_id": 90471085, "body": "Until C99, it was pretty much universally recognized that compilers intended for various purposes would need to support type usage patterns that went beyond those the Standard mandated for all compilers, and support for such patterns was recognized as a Quality of Implementation issue. Limitations that would be appropriate in a compiler intended or configured solely for high-end number crunching would make a compiler useless for processing low-level memory management code.  Absent a willingness to recognize different kinds of implementations, any attempt to settle on a single set of rules..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1533763201, "post_id": 51738580, "comment_id": 90471193, "body": "...for everything would be pretty much guaranteed to break a lot of code while needlessly impairing many optimizations.  The fact that one part of the Standard <i>allows</i> a compiler to treat in arbitrary fashion an action whose behavior would otherwise be defined elsewhere does not imply any judgment that quality compilers intended for any particular purpose <i>should</i> do so."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 10, "last_activity_date": 1533702197, "creation_date": 1533702197, "answer_id": 51738580, "question_id": 51737910, "link": "https://stackoverflow.com/questions/51737910/is-it-legal-to-access-struct-members-via-offset-pointers-from-other-struct-membe/51738580#51738580", "title": "Is it legal to access struct members via offset pointers from other struct members?", "body": "<p><strong>Introduction:</strong> The standard is inadequate in this area, and there is decades of history of argument on this topic and strict aliasing with no convincing resolution or proposal to fix.</p>\n\n<p>This answer reflects my view rather than any imposition of the Standard.</p>\n\n<hr>\n\n<p>Firstly: it's generally agreed that the code in your first code sample is undefined behaviour due to accessing outside the bounds of an array via direct pointer arithmetic.  </p>\n\n<p>The rule is C11 6.5.6/8 . It says that indexing from a pointer must remain within \"the array object\" (or one past the end). It doesn't say <em>which</em> array object but it is generally agreed that in the case <code>int *p = &amp;foo.a;</code> then \"the array object\" is <code>foo.a</code>, and not any larger object of which <code>foo.a</code> is a subobject.</p>\n\n<p>Relevant links:\n<a href=\"https://stackoverflow.com/questions/47224138/is-it-ok-to-access-past-the-size-of-a-structure-via-member-address-with-enough/47224596#47224596\">one</a>, <a href=\"https://stackoverflow.com/questions/48147422/is-it-legal-to-alias-a-struct-and-an-array\">two</a>.</p>\n\n<hr>\n\n<p>Secondly: it's generally agreed that both of your <code>union</code> examples are correct. The standard explicitly says that any member of a union may be read; and whatever the contents of the relevant memory location are are interpreted as the type of the union member being read.</p>\n\n<hr>\n\n<p>You suggest that the <code>union</code> being correct implies that the first code should be correct too, but it does not.  The issue is not with specifying the memory location read; the issue is with how we arrived at the expression specifying that memory location. </p>\n\n<p>Even though we know that <code>&amp;foo.a + 1</code> and <code>&amp;foo.b</code> are the same memory address, it's valid to access an <code>int</code> through the second and not valid to access an <code>int</code> through the first. </p>\n\n<p>It's generally agreed that you can access the int by computing its address in other ways that don't break the 6.5.6/8 rule, e.g.:</p>\n\n<pre><code>((int *)((char *)&amp;foo + offsetof(foo, b))[0]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>((int *)((uintptr_t)&amp;foo.a + sizeof(int)))[0]\n</code></pre>\n\n<p>Relevant links: <a href=\"https://stackoverflow.com/questions/5524552/\">one</a>, <a href=\"https://stackoverflow.com/questions/37412887/\">two</a></p>\n\n<hr>\n\n<p>It's <em>not</em> generally agreed on whether <code>((int *)&amp;foo)[1]</code> is valid. Some say it's basically the same as your first code, since the standard says \"a pointer to an object, suitably converted, points to the element's first object\".  Others say it's basically the same as my <code>(char *)</code> example above because it follows from the specification of pointer casting. A few even claim it's a strict aliasing violation because it aliases a struct as an array.</p>\n\n<p>Maybe relevant is <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2090.htm\" rel=\"noreferrer\">N2090 - Pointer provenance proposal</a>.  This does not directly address the issue, and doesn't propose a repeal of 6.5.6/8. </p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 3, "last_activity_date": 1552675615, "last_edit_date": 1552675615, "creation_date": 1552673904, "answer_id": 55188621, "question_id": 51737910, "link": "https://stackoverflow.com/questions/51737910/is-it-legal-to-access-struct-members-via-offset-pointers-from-other-struct-membe/55188621#55188621", "title": "Is it legal to access struct members via offset pointers from other struct members?", "body": "<p>According to C11 draft N1570 6.5p7, an attempt to access the stored value of a struct or union object using anything other than an lvalue of character type, the struct or union type, or a <em>containing</em> struct or union type, invokes UB even if behavior would otherwise be fully described by other parts of the Standard.  This section contains no provision that would allow an lvalue of a non-character member type (or any non-character numeric type, for that matter) to be used to access the stored value of a struct or union.</p>\n\n<p>According to the published Rationale document, however, the authors of the Standard recognized that different implementations offered different behavioral guarantees in cases where the Standard imposed no requirements, and regarded such \"popular extensions\" as a good and useful thing.  They judged that questions of when and how such extensions should be supported would be better answered by the marketplace than by the Committee.  While it may seem weird that the Standard would allow an obtuse compiler to ignore the possibility that <code>someStruct.array[i]</code> might affect the stored value of <code>someStruct</code>, the authors of the Standard recognized that any compiler whose authors aren't deliberately obtuse will support such a construct whether the Standard mandates or not, and that any attempt to mandate any kind of useful behavior from obtusely-designed compilers would be futile.</p>\n\n<p>Thus, a compiler's level of support for essentially <em>anything</em> having to do with structures or unions is a quality-of-implementation issue.  Compiler writers who are focused on being compatible with a wide range of programs will support a wide range of constructs.  Those which are focused on maximizing the performance of code that needs only those constructs without which the language would be totally useless, will support a much narrower set.  The Standard, however, is devoid of guidance on such issues.</p>\n\n<p>PS--Compilers that are configured to be compatible with MSVC-style <code>volatile</code> semantics will interpret that qualifier as a indicating that an access to the pointer may have side-effects that interact with objects whose address has been taken and that aren't guarded by <code>restrict</code>, whether or not there is any other reason to expect such a possibility.  Use of such a qualifier when accessing storage in \"unusual\" ways may make it more obvious to human readers that the code is doing something \"weird\" at the same time as it will thus ensure compatibility with any compiler that uses such semantics, even if such compiler would not otherwise recognize that access pattern.  Unfortunately, some compiler writers refuse to support such semantics at anything other than optimization level 0 except with programs that demand it using non-standard syntax.</p>\n"}], "owner": {"reputation": 3728, "user_id": 1324631, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/22ea15aa505ee3fdcc5cb40b00a31f63?s=128&d=identicon&r=PG", "display_name": "AJMansfield", "link": "https://stackoverflow.com/users/1324631/ajmansfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 1, "accepted_answer_id": 51738580, "answer_count": 2, "score": 6, "last_activity_date": 1552675615, "creation_date": 1533696251, "last_edit_date": 1552485056, "question_id": 51737910, "link": "https://stackoverflow.com/questions/51737910/is-it-legal-to-access-struct-members-via-offset-pointers-from-other-struct-membe", "title": "Is it legal to access struct members via offset pointers from other struct members?", "body": "<p>In these two examples, does accessing members of the struct by offsetting pointers from other members result in Undefined / Unspecified / Implementation Defined Behavior?</p>\n\n<pre><code>struct {\n  int a;\n  int b;\n} foo1 = {0, 0};\n\n(&amp;foo1.a)[1] = 1;\nprintf(\"%d\", foo1.b);\n\n\nstruct {\n  int arr[1];\n  int b;\n} foo2 = {{0}, 0};\n\nfoo2.arr[1] = 1;\nprintf(\"%d\", foo2.b);\n</code></pre>\n\n<p>Paragraph 14 of C11 \u00a7 6.7.2.1 seems to indicate that this should be implementation-defined:</p>\n\n<blockquote>\n  <p>Each non-bit-field member of a structure or union object is aligned in an implementation-defined manner appropriate to its type.</p>\n</blockquote>\n\n<p>and later goes on to say:</p>\n\n<blockquote>\n  <p>There may be unnamed padding within a structure object, but not at its beginning.</p>\n</blockquote>\n\n<p>However, code like the following appears to be fairly common:</p>\n\n<pre><code>union {\n  int arr[2];\n  struct {\n    int a;\n    int b;\n  };\n} foo3 = {{0, 0}};\n\nfoo3.arr[1] = 1;\nprintf(\"%d\", foo3.b);\n\n(&amp;foo3.a)[1] = 2; // appears to be illegal despite foo3.arr == &amp;foo3.a\nprintf(\"%d\", foo3.b);\n</code></pre>\n\n<p>The standard appears to guarantee that <code>foo3.arr</code> is the same as <code>&amp;foo3.a</code>, and it doesn't make sense that referring to it one way is legal and the other not, but equally it doesn't make sense that adding the outer union with the array should suddenly make <code>(&amp;foo3.a)[1]</code> legal.</p>\n\n<p>My reasoning for thinking the first examples must also therefore be legal:</p>\n\n<ol>\n<li><code>foo3.arr</code> is guaranteed to be the same as <code>&amp;foo.a</code></li>\n<li><code>foo3.arr + 1</code> and <code>&amp;foo3.b</code> point to the same memory location</li>\n<li><code>&amp;foo3.a + 1</code> and <code>&amp;foo3.b</code> must therefore point to the same memory location (from 1 and 2)</li>\n<li>struct layouts are required to be consistent, so <code>&amp;foo1.a</code> and <code>&amp;foo1.b</code> should be laid out exactly the same as <code>&amp;foo3.a</code> and <code>&amp;foo3.b</code></li>\n<li><code>&amp;foo1.a + 1</code> and <code>&amp;foo1.b</code> must therefore point to the same memory location (from 3 and 4)</li>\n</ol>\n\n<p>I've come across some outside sources that suggest that both the <code>foo3.arr[1]</code> and <code>(&amp;foo3.a)[1]</code> examples are illegal, however I haven't been able to find a concrete statement in the standard that would make it so.\nEven if they were both illegal though, it's also possible to construct the same scenario with flexible array pointers which, as far as I can tell, <em>does</em> have standard-defined behavior.</p>\n\n<pre><code>union {\n  struct {\n    int x;\n    int arr[];\n  };\n  struct {\n    int y;\n    int a;\n    int b;\n  };\n} foo4;\n</code></pre>\n\n<p>The original application is considering whether or not a buffer overflow from one struct field into another is strictly speaking defined by the standard:</p>\n\n<pre><code>struct {\n  char buffer[8];\n  char overflow[8];\n} buf;\nstrcpy(buf.buffer, \"Hello world!\");\nprintln(buf.overflow);\n</code></pre>\n\n<p>I would expect this to output <code>\"rld!\"</code> on nearly any real-world compiler, but <strong>is this behavior guaranteed by the standard, or is it an undefined or implementation-defined behavior?</strong></p>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1533699584, "post_id": 51737894, "comment_id": 90436841, "body": "To understand that quote, you need a thorough understanding of the declaration <code>int (*ptr)[7];</code> which creates a pointer to an array-of-7-int. Not to be confused with <code>int *ptr[7];</code> which creates an array of 7 pointer-to-int. That distinction should have been discussed at length earlier in the book."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 7, "last_activity_date": 1533726439, "last_edit_date": 1533726439, "creation_date": 1533697477, "answer_id": 51738065, "question_id": 51737894, "link": "https://stackoverflow.com/questions/51737894/c-multidimensional-arrays-array-whose-elements-are-one-dimensional-arrays/51738065#51738065", "title": "C, Multidimensional arrays: array whose elements are one-dimensional arrays?", "body": "<p>Yes, it makes sense, and no, it's not even talking about \"ragged\" or \"jagged\" arrays.  It's simply that when we say</p>\n\n<pre><code>int a[NUM_ROWS][NUM_COLS];\n</code></pre>\n\n<p>what we're creating is an array <code>a</code>, and what it's an array of is... other arrays.  You could think of it like this:</p>\n\n<pre><code>        +---------------------------------------+\n        | +--------+--------+--------+--------+ |\na: [0]: | |        |        |        |        | |\n        | +--------+--------+--------+--------+ |\n        +                                       +\n        | +--------+--------+--------+--------+ |\n   [1]: | |        |        |        |        | |\n        | +--------+--------+--------+--------+ |\n        +                                       +\n        | +--------+--------+--------+--------+ |\n   [2]: | |        |        |        |        | |\n        | +--------+--------+--------+--------+ |\n        +---------------------------------------+\n</code></pre>\n\n<p>(Here <code>NUM_COLS</code> is evidently 4, and <code>NUM_ROWS</code> is 3.)</p>\n\n<p>A two- (or more) dimensional array is 100% analogous to a simple, single-dimensional array -- you just have to be careful thinking about the analogies.  If <code>a</code> is an array, then any mention of <code>a</code> in an expression where its value is needed results in a pointer to the array's first element, <code>&amp;a[0]</code>.  So given the two-dimensional array <code>a</code> we're talking about, <code>a</code>'s value is <code>&amp;a[0]</code> and is <em>a pointer to an array of <code>NUM_COLS</code> integers</em>.</p>\n\n<p>It has to work this way, if multidimensional array subscripts are to work correctly.  If we write <code>a[i][j]</code>, that's interpreted as <code>(a[i])[j]</code>.  <code>a</code> turns into a pointer to the array's first element, as usual, but <code>a[i]</code> is equivalent to <code>*(a + i)</code>, where the pointer arithmetic ends up being scaled by the size of the pointed-to element -- that is, under the hood, it's more like <code>*(a+ i * sizeof(*a))</code>.  So <code>sizeof(*a)</code> has to be <code>sizeof(int [NUM_COLS])</code>, or <code>NUM_COLS * sizeof(int)</code>.  That way <code>a[i]</code> gets you the <code>i</code>'th subarray, and then <code>j</code> can select one of the cells -- the <code>int</code>-sized cells -- of the subarray.</p>\n\n<p>One final note: I've talked colloquially about \"multi-dimensional arrays\", but strictly speaking, and as many of the regulars here are fond of pointing out, C has no multidimensional arrays; it has only single-dimensional arrays, and what we think of as a two-dimensional array is actually, as we've seen here, a single-dimensional array whose elements happen to be other single-dimensional arrays.  (If C had true multi-dimensional arrays, the subscripts would probably look like <code>a[i,j]</code> instead of <code>a[i][j]</code>.)</p>\n\n<hr>\n\n<p>Addendum: Despite your mention of pointer arithmetic, and my mention of pointer arithmetic, it's important to realize that <em>there are no pointers involved in <code>a</code>'s definition</em>.  Pointers arise only when we try to \"take the value of\" <code>a</code>, or explain how <code>a[i]</code> is equivalent to <code>*(a + i)</code>.</p>\n\n<p>For a data structure that does involve pointers, we could contrast the situation described by the code</p>\n\n<pre><code>int *a2[NUM_ROWS];\nfor(i = 0; i &lt; NUM_ROWS; i++)\n    a2[i] = malloc(NUM_COLS * sizeof(int));\n</code></pre>\n\n<p>This gives us a very different memory layout:</p>\n\n<pre><code>    +-----+\na2: |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n    |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n    |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n</code></pre>\n\n<p>And this is what's usually called a \"ragged\" or \"jagged\" array, since it's obviously not necessary that all the rows in this case be the same length.  Nevertheless, almost magically, the cells in the \"ragged\" array can also be accessed using the <code>a2[i][j]</code> notation.  And for full dynamism, we could use</p>\n\n<pre><code>int **a3 = malloc(NUM_ROWS * sizeof(int *));\nfor(i = 0; i &lt; NUM_ROWS; i++)\n    a3[i] = malloc(NUM_COLS * sizeof(int));\n</code></pre>\n\n<p>resulting in this memory layout:</p>\n\n<pre><code>    +-----+\na3: |     |\n    |  *  |\n    |  |  |\n    +--|--+\n       |\n       |\n       V\n    +-----+\n    |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n    |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n    |     |     +--------+--------+--------+--------+\n    |  *-------&gt;|        |        |        |        |\n    |     |     +--------+--------+--------+--------+\n    +-----+\n</code></pre>\n\n<p>And <code>a3[i][j]</code> works here, too.</p>\n\n<p>(Of course, in real code constructing \"dynamic arrays\" like <code>a2</code> and <code>a3</code>, we'd have to check to make sure that <code>malloc</code> didn't return <code>NULL</code>.)</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1533706383, "post_id": 51739005, "comment_id": 90438510, "body": "We could go for the full-blow headache and pass a pointer to <code>arr</code> as (<code>int (**)[M]</code>). Good explanation."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1533705037, "creation_date": 1533705037, "answer_id": 51739005, "question_id": 51737894, "link": "https://stackoverflow.com/questions/51737894/c-multidimensional-arrays-array-whose-elements-are-one-dimensional-arrays/51739005#51739005", "title": "C, Multidimensional arrays: array whose elements are one-dimensional arrays?", "body": "<p>Another way to look at it...</p>\n\n<p>For any type <code>T</code>, we create an array as</p>\n\n<pre><code>T arr[N];\n</code></pre>\n\n<p>where <code>T</code> can be <code>int</code>, <code>char</code>, <code>double</code>, <code>struct foo</code>, whatever, and reads as \u201cN-element array of <code>T</code>\u201d.  It can also be <em>another array type</em>. So, instead of just <code>int</code>, suppose <code>T</code> is an <em>M-element array</em> of <code>int</code>, which we\u2019d write as</p>\n\n<pre><code>int arr[N][M];\n</code></pre>\n\n<p>This reads as \u201c<code>arr</code> is an N-element array of M-element arrays of <code>int</code>\u201d.  This isn\u2019t a jagged array - all the \u201crows\u201d are the same size.  But it\u2019s not exactly a 2-dimensional array, either - it is an array of arrays.  The expression <code>arr[i]</code> has an array type (<code>int [M]</code>).</p>\n\n<p>This view helps us figure out pointer to array types as well.  Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operator, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \u201cN-element array of <code>T</code>\u201d (<code>T [N]</code>) will be converted (\u201cdecay\u201d) to an expression of type \u201cpointer to <code>T</code>\u201d (<code>T *</code>).  Again, if you replace <code>T</code> with an array type <code>int [M]</code>, then you have an expression of type \u201cN-element array of M-element arrays of <code>int</code>\u201d (<code>int [N][M]</code>), which \u201cdecays\u201d to type \u201cpointer to M-element array of <code>int</code>\u201d (<code>int (*)[M]</code>).</p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1533726439, "creation_date": 1533696152, "last_edit_date": 1592644375, "question_id": 51737894, "link": "https://stackoverflow.com/questions/51737894/c-multidimensional-arrays-array-whose-elements-are-one-dimensional-arrays", "title": "C, Multidimensional arrays: array whose elements are one-dimensional arrays?", "body": "<p>Does this statement make sense, from the book <a href=\"http://knking.com/books/c/\" rel=\"nofollow noreferrer\"><em>C Programming: A Modern Approach, 2nd Edition</em></a> on page 269</p>\n<blockquote>\n<p>Just as the name of a one-dimensional array can be used as a pointer, so can the name of <em>any</em> array, regardless of how many dimensions it has. Some care is required, though. Consider the following array:</p>\n<pre><code>int a[NUM_ROWS][NUM_COLS];\n</code></pre>\n<p><code>a</code> is <em>not</em> a pointer to <code>a[0][0];</code> instead, it's a pointer to <code>a[0]</code>. <strong>This makes more sense if we look at it from the standpoint of C, which regards <code>a</code> not as a two-dimensional array but as a one-dimensional array whose elements are one-dimensional arrays.</strong> When used as a pointer, <code>a</code> has type <code>int (*) [NUM_COLS]</code> (pointer to an integer array of length <code>NUM_COLS</code>).</p>\n</blockquote>\n<p>I'm confused because when I think <em>&quot;array whose elements are one-dimensional arrays&quot;</em> I think a <a href=\"https://en.wikipedia.org/wiki/Jagged_array\" rel=\"nofollow noreferrer\">jagged-array</a>, but that's not what's going on here.. This is more like a macro with pointer arithmetic?</p>\n<p>Is this in reference to the type system and how it treats multidimensional arrays? Could any one explain this?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "edited": false, "score": 3, "creation_date": 1533691112, "post_id": 51737345, "comment_id": 90435289, "body": "The <code>-c</code> option tells <code>gcc</code> to compile to an object file without linking. So you have an object file. Leave out that option and it will work."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1533700639, "post_id": 51737345, "comment_id": 90437069, "body": "Running <code>file volatandconstvolatile &#47;bin&#47;sh</code> would show a big difference between the file types."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1533728208, "post_id": 51737345, "comment_id": 90451068, "body": "@JerryJeremiah No, <code>-o</code> just changes the output filename. The absence of a <code>.o</code> in the name doesn&#39;t make the file magically executable. See my answer. They needs to leave off the <code>-c</code>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1533736848, "post_id": 51737345, "comment_id": 90456972, "body": "Easier still, just ask Make to compile and link for you: <code>make volatandconstvolatile</code>."}, {"owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1533801677, "post_id": 51737345, "comment_id": 90482356, "body": "@TobySpeight <code>make</code> isn\u2019t a cure-all. You still need to know the correct compiler commands to put in the Makefile."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "edited": false, "score": 0, "creation_date": 1533802438, "post_id": 51737345, "comment_id": 90482822, "body": "@Tom - no need for a Makefile, for something this simple (that&#39;s why I suggested Make: start from its built-in rules, perhaps modify them by setting <code>CC</code>, <code>CFLAGS</code>, <code>LIBS</code> etc, before you either write a Makefile or your own command line)."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1533864878, "post_id": 51737345, "comment_id": 90513668, "body": "@JonathonReinhart I meant to say leave out the <code>-c</code> but I have a typing impediment...."}], "answers": [{"tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 3, "last_activity_date": 1533728317, "last_edit_date": 1533728317, "creation_date": 1533691121, "answer_id": 51737364, "question_id": 51737345, "link": "https://stackoverflow.com/questions/51737345/getting-exec-format-error-while-executing-binary-file/51737364#51737364", "title": "Getting &quot;exec format error&quot; while executing binary file", "body": "<pre><code>gcc -c -o volatandconstvolatile volatandconstvolatile.c\n</code></pre>\n\n<p>This compilation command line makes no sense.</p>\n\n<p><code>-c</code> means \"compile only\" and don't link. But you're leaving the <code>.o</code> suffix off, which implies that you're building a complete executable, which is wrong. </p>\n\n<p>You can build your full application in one invocation of GCC like this, by leaving off the <code>-c</code>:</p>\n\n<pre><code>gcc -o volatandconstvolatile volatandconstvolatile.c\n</code></pre>\n\n<p>Note that LD sets the output binary's executable bit automatically. The fact that you had to <code>chmod</code> the file manually should have been a clue that something wasn't right.</p>\n"}], "owner": {"reputation": 53, "user_id": 6234260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e235678715cf67babb1e23ca94a167a2?s=128&d=identicon&r=PG&f=1", "display_name": "naveen kumar", "link": "https://stackoverflow.com/users/6234260/naveen-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1874, "favorite_count": 0, "closed_date": 1533947820, "answer_count": 1, "score": -3, "last_activity_date": 1533728317, "creation_date": 1533690876, "last_edit_date": 1533714228, "question_id": 51737345, "link": "https://stackoverflow.com/questions/51737345/getting-exec-format-error-while-executing-binary-file", "closed_reason": "Duplicate", "title": "Getting &quot;exec format error&quot; while executing binary file", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    volatile int x;\n\n    printf(\"without assignment %d\", x);\n    x = 100;\n    printf(\"%d\", x);\n}\n</code></pre>\n\n<hr>\n\n<pre><code>gcc -c -o volatandconstvolatile volatandconstvolatile.c\n</code></pre>\n\n<p>I got the <code>volatandconstvolatile</code> file but </p>\n\n<pre><code>-rw-rw-r--  1 naveenkumar naveenkumar      1600 Aug  8 05:12 volatandconstvolatile\n</code></pre>\n\n<p>then I changed the permissions <code>chmod 777 volatandconstvolatile</code></p>\n\n<p>then <code>./volatandconstvolatile</code></p>\n\n<pre><code>./volatandconstvolatile: cannot execute binary file: Exec format error\nobjdump volatandconstvolatile | grep \"archit\"\narchitecture: i386:x86-64, flags 0x00000011:\n\nreadelf -a -W  volatandconstvolatile\n</code></pre>\n\n<p>I know that <code>volatile</code> is used to get the values from external means.</p>\n\n<p>Why do I get this error?</p>\n"}, {"tags": ["c", "linux", "huge-pages"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1533690176, "post_id": 51737273, "comment_id": 90435135, "body": "I don&#39;t see how this is a <i>programming</i> question, especially since an explicit objective is to avoid even recompiling."}, {"owner": {"reputation": 410, "user_id": 4241727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/976ad3d15dc36e461d3696f51cec4bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Vahid Noormofidi", "link": "https://stackoverflow.com/users/4241727/vahid-noormofidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1533697416, "post_id": 51737273, "comment_id": 90436460, "body": "I don&#39;t mind recompiling if you know the solution!"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1533737227, "post_id": 51737273, "comment_id": 90457249, "body": "They wouldn&#39;t be <i>transparent</i> if you needed to rebuild your applications."}, {"owner": {"reputation": 410, "user_id": 4241727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/976ad3d15dc36e461d3696f51cec4bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Vahid Noormofidi", "link": "https://stackoverflow.com/users/4241727/vahid-noormofidi"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1533766985, "post_id": 51737273, "comment_id": 90472436, "body": "@TobySpeight I know that I can change the allocate method to use it in my code. Also, without recompiling the code, I know that it&#39;s possible to use 2MB TH, but I don&#39;t know any way to use 1GB TH without rebuilding my code."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1533798604, "post_id": 51737273, "comment_id": 90480618, "body": "So the question is, &quot;<i>Can I use 1GB pages transparently?</i>&quot;, then?  Anyway, that&#39;s not a programming question - I recommend you ask instead at <a href=\"https://unix.stackexchange.com\">Unix & Linux</a> or perhaps <a href=\"https://serverfault.com\">Server Fault</a>."}], "owner": {"reputation": 410, "user_id": 4241727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/976ad3d15dc36e461d3696f51cec4bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Vahid Noormofidi", "link": "https://stackoverflow.com/users/4241727/vahid-noormofidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533860242, "creation_date": 1533690032, "last_edit_date": 1533860242, "question_id": 51737273, "link": "https://stackoverflow.com/questions/51737273/using-1gb-transparent-hugepages-in-linux", "title": "Using 1GB transparent hugepages in Linux", "body": "<p>I was wondering if there's any way to use the 1GB transparent hugepages in Linux without the need to recompile applications? \nI know that for using 2MB transparent hugepages, one only needs to do the following (I use SLES 12.3):</p>\n\n<pre><code>echo always &gt; /sys/kernel/mm/transparent_hugepage/enabled\n</code></pre>\n"}, {"tags": ["objective-c", "c", "cocoa", "grand-central-dispatch"], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 5548305, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e93b750e3c2713746447a1780d1c821?s=128&d=identicon&r=PG&f=1", "display_name": "JLegendre", "link": "https://stackoverflow.com/users/5548305/jlegendre"}, "is_accepted": true, "score": 0, "last_activity_date": 1533701975, "creation_date": 1533701975, "answer_id": 51738545, "question_id": 51737260, "link": "https://stackoverflow.com/questions/51737260/adding-blocks-to-inactive-dispatch-queue/51738545#51738545", "title": "Adding Blocks to Inactive Dispatch Queue", "body": "<p>I figured it out.  Using <code>dispatch_async</code> fixed the problem.</p>\n\n<p>Working solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#import &lt;dispatch/dispatch.h&gt;\n\nint main(int argc, const char * argv[]) {\n    dispatch_queue_t my_queue = dispatch_queue_create(\"my_queue\", DISPATCH_QUEUE_SERIAL_INACTIVE);\n\n    void (^b)(int) = ^void(int c) {\n        printf(\"%i\\n\", c);\n    };\n\n    for(int i = 1; i &lt;= 1000; i++) {\n        dispatch_async(my_queue, ^{ b(i); });\n    }\n\n    dispatch_activate(my_queue);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 5548305, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e93b750e3c2713746447a1780d1c821?s=128&d=identicon&r=PG&f=1", "display_name": "JLegendre", "link": "https://stackoverflow.com/users/5548305/jlegendre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 51738545, "answer_count": 1, "score": 0, "last_activity_date": 1533701975, "creation_date": 1533689939, "question_id": 51737260, "link": "https://stackoverflow.com/questions/51737260/adding-blocks-to-inactive-dispatch-queue", "title": "Adding Blocks to Inactive Dispatch Queue", "body": "<p>I have a situation where it would be helpful to be able to add blocks to an inactive queue which is then activated after another event happens. However, the entire thread from which I call <code>dispatch_sync</code> gets locked if the dispatch queue is suspended/inactive. </p>\n\n<p>Is something like this possible? If not what other options do I have?</p>\n\n<p>An example (not my actual use case):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#import &lt;dispatch/dispatch.h&gt;\n\nint main(int argc, const char * argv[]) {\n    dispatch_queue_t my_queue = dispatch_queue_create(\"my_queue\", DISPATCH_QUEUE_SERIAL_INACTIVE);\n\n    void (^b)(int) = ^void(int c) {\n        printf(\"%i\\n\", c);\n    };\n\n    for(int i = 1; i &lt;= 1000; i++) {\n        dispatch_sync(my_queue, ^{ b(i); });\n    }\n\n    dispatch_activate(my_queue);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linker", "compiler-construction", "operating-system"], "comments": [{"owner": {"reputation": 5746, "user_id": 583570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17472ad659a41e48c4574e01d2312807?s=128&d=identicon&r=PG", "display_name": "markgz", "link": "https://stackoverflow.com/users/583570/markgz"}, "edited": false, "score": 0, "creation_date": 1533688920, "post_id": 51737002, "comment_id": 90434932, "body": "The linker does not handle variables with internal or no linkage. The compiler can generate code to access those types of variables without any help from the linker. (Linkage and linker are not closely related concepts.)"}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 3, "last_activity_date": 1533689161, "creation_date": 1533689161, "answer_id": 51737185, "question_id": 51737002, "link": "https://stackoverflow.com/questions/51737002/how-does-linker-handle-variables-with-different-linkages/51737185#51737185", "title": "How does linker handle variables with different linkages?", "body": "<p>As far as C++ itself goes, this does not matter: the only thing that matters is the behavior of the system as a whole.  Variables with no linkage should not be linked; variables with internal linkage should not be linked across translation units; and variables with external linkage should be linked across translation units.  (Of course, as the person writing the C++ code, you must obey all of <em>your</em> constraints as well.)</p>\n\n<p>Inside a compiler and linker suite of programs, however, we certainly <em>do</em> have to care about this.  The method by which we achieve the desired result is up to us.  One traditional method is pretty simple:</p>\n\n<ul>\n<li><p>Identifiers with no linkage are never even passed through to the linker.</p></li>\n<li><p>Identifiers with internal linkage are not passed through to the linker either, or <em>are</em> passed through to the linker but marked \"for use within this one translation unit only\".  That is, there is no <code>.global</code> declaration for them, or there is a <code>.local</code> declaration for them, or similar.</p></li>\n<li><p>Identifiers with external linkage are passed through to the linker, and if internal linkage identifiers are seen by the linker, these external linkage symbols are marked differently, e.g., have a <code>.global</code> declaration or no <code>.local</code> declaration.</p></li>\n</ul>\n\n<p>If you have a Linux or Unix like system, run <code>nm</code> on object (<code>.o</code>) files produced by the compiler.  Note that some symbols are annotated with uppercase letters like <code>T</code> and <code>D</code> for text and data: these are global.  Other symbols are annotated with lowercase letters like <code>t</code> and <code>d</code>: these are local.  So these systems are using the \"pass internal linkage to the linker, but mark them differently from external linkage\" method.</p>\n"}, {"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 1, "last_activity_date": 1533689497, "creation_date": 1533689497, "answer_id": 51737215, "question_id": 51737002, "link": "https://stackoverflow.com/questions/51737002/how-does-linker-handle-variables-with-different-linkages/51737215#51737215", "title": "How does linker handle variables with different linkages?", "body": "<p>The linker isn't normally involved in either internal linkage or no linkage--they're resolved entirely by the compiler, before the linker gets into the act at all.</p>\n\n<p>Internal linkage means two declarations at different scopes in the same translation unit can refer to the same thing.</p>\n\n<h3>No Linkage</h3>\n\n<p>No linkage means two declarations at different scopes in the same translation unit can't refer to the same thing.</p>\n\n<p>So, if I have something like:</p>\n\n<pre><code>int f() { \n    static int x; // no linkage\n}\n</code></pre>\n\n<p>...no other declaration of <code>x</code> in any other scope can refer to this <code>x</code>. The linker is involved only to the degree that it typically has to produce a field in the executable telling it the size of static space needed by the executable, and that will include space for this variable. Since it can never be referred to by any other declaration, there's no need for the linker to get involved beyond that though (in particular, the linker has nothing to do with resolving the name).</p>\n\n<h3>Internal linkage</h3>\n\n<p>Internal linkage means declarations at different scopes in the same translation unit can refer to the same object. For example:</p>\n\n<pre><code>static int x;  // a namespace scope, so `x` has internal linkage\n\nint f() { \n    extern int x; // declaration in one scope\n}\n\nint g() { \n    extern int x; // declaration in another scope\n}\n</code></pre>\n\n<p>Assuming we put these all in one file (i.e., they end up as a single translation unit), the declarations in both <code>f()</code> and <code>g()</code> refer to the same thing--the <code>x</code> that's defined as <code>static</code> at namespace scope.</p>\n\n<p>For example, consider code like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstatic int x; // a namespace scope, so `x` has internal linkage\n\nint f()\n{\n    extern int x;\n    ++x;\n}\n\nint g()\n{\n    extern int x;\n    std::cout &lt;&lt; x &lt;&lt; '\\n';\n}\n\nint main() {\n    g();\n    f();\n    g();\n}\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>0\n1\n</code></pre>\n\n<p>...because the <code>x</code> being incremented in <code>f()</code> is the same <code>x</code> that's being printed in <code>g()</code>.</p>\n\n<p>The linker's involvement here can be (and usually is) pretty much the same as in the no linkage case--the variable <code>x</code> needs some space, and the linker specifies that space when it creates the executable. It does <em>not</em>, however, need to get involved in determining that when <code>f()</code> and <code>g()</code> both declare <code>x</code>, they're referring to the same <code>x</code>--the compiler can determine that.</p>\n\n<p>We can see this in the generated code. For example, if we compile the code above with gcc, the relevant bits for <code>f()</code> and <code>g()</code> are these.</p>\n\n<p>f:</p>\n\n<pre><code>    movl    _ZL1x(%rip), %eax\n    addl    $1, %eax\n    movl    %eax, _ZL1x(%rip)\n</code></pre>\n\n<p>That's the increment of <code>x</code> (it uses the name <code>_ZL1x</code> for it).</p>\n\n<p>g:</p>\n\n<pre><code>    movl    _ZL1x(%rip), %eax\n    [...]\n    call    _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_c@PLT\n</code></pre>\n\n<p>So that's basically loading up <code>x</code>, then sending it to <code>std::cout</code> (I've left out code for other parameters we don't care about here).</p>\n\n<p>The important part is that the code refers to <code>_ZL1x</code>--the same name as <code>f</code> used, so both of them refer to the same object.</p>\n\n<p>The linker isn't really involved, because all it sees is that this file has requested space for one statically allocated variable. It makes space for that, but doesn't have to do anything to make <code>f</code> and <code>g</code> refer to the same thing--that's already handled by the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1533689906, "creation_date": 1533689906, "answer_id": 51737254, "question_id": 51737002, "link": "https://stackoverflow.com/questions/51737002/how-does-linker-handle-variables-with-different-linkages/51737254#51737254", "title": "How does linker handle variables with different linkages?", "body": "<blockquote>\n  <p>My question is probably related to why these are called \"linkage\" (How is that related to the linker).</p>\n</blockquote>\n\n<p>According to the C standard,</p>\n\n<blockquote>\n  <p>An identifier declared in different scopes or in the same scope more\n  than once can be made to refer to the same object or function by a\n  process called linkage.</p>\n</blockquote>\n\n<p>The term \"linkage\" seems reasonably well fitting -- different declarations of the same identifier are <em>linked</em> together so that they refer to the same object or function.  That being the chosen terminology, it's pretty natural that a program that actually makes linkage happen is conventionally called a \"linker\".</p>\n\n<blockquote>\n  <p>But how does the linker handle variables (1) with no linkage and (2) with internal linkage? What are the differences in these two cases?</p>\n</blockquote>\n\n<p>The linker does not have to do anything with identifiers that have no linkage.  Every such declaration of an object identifier declares a distinct object (and function declarations always have internal or external linkage).</p>\n\n<p>The linker does not necessarily do anything with identifiers having internal linkage, either, as the compiler can generally do everything that needs to be done with these.  Nevertheless, identifiers with internal linkage can be declared multiple times in the same translation unit, with those identifiers all referring to the same object or function.  The most common case is a <code>static</code> function with a forward declaration:</p>\n\n<pre><code>static void internal(void);\n\n// ...\n\nstatic void internal(void) {\n    // do something\n}\n</code></pre>\n\n<p>File-scope variables can also have internal linkage and multiple declarations that are all linked to refer to the same object, but the multiple declaration part is not as useful for variables.</p>\n"}], "owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 51737215, "answer_count": 3, "score": 2, "last_activity_date": 1533689906, "creation_date": 1533687145, "question_id": 51737002, "link": "https://stackoverflow.com/questions/51737002/how-does-linker-handle-variables-with-different-linkages", "title": "How does linker handle variables with different linkages?", "body": "<p>In C and C++ we can manipulate a variable's linkage. There are three kinds of linkage: no linkage, internal linkage, and external linkage. My question is probably related to why these are called \"linkage\" (How is that related to the linker).</p>\n\n<p>I understand a linker is able to handle variables with external linkage, because references to this variable is not confined within a single translation unit, therefore not confined within a single object file. How that actually works under the hood is typically discussed in courses on operating systems.</p>\n\n<p>But how does the linker handle variables (1) with no linkage and (2) with internal linkage? What are the differences in these two cases?</p>\n"}, {"tags": ["c", "gcc", "constructor", "attributes", "initialization"], "comments": [{"owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533693949, "post_id": 51736547, "comment_id": 90435821, "body": "After more testing I found that priority 65535 kind of works but is the same as no priority."}], "answers": [{"comments": [{"owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533693729, "post_id": 51737293, "comment_id": 90435778, "body": "Well, in my use case the nested functions are used to initialize static variables that are only accesible from the parent function, so they are not meaningless."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533695734, "post_id": 51737293, "comment_id": 90436134, "body": "@gatopeich: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html\" rel=\"nofollow noreferrer\">GCC&#39;s documentation</a> is very sloppy about this: &quot;If you try to call the nested function through its address after the containing function exits, all hell breaks loose. If you try to call it after a containing scope level exits, and if it refers to some of the variables that are no longer in scope, you may be lucky, but it\u2019s not wise to take the risk. If, however, the nested function does not refer to anything that has gone out of scope, you should be safe.&quot; The &quot;should be safe&quot; condition is almost surely obsolete..."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533695799, "post_id": 51737293, "comment_id": 90436147, "body": "...in that there&#39;s nothing to guarantee the compiler does not make transformations that cause access to the stack frame of the enclosing block."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 2, "creation_date": 1533695954, "post_id": 51737293, "comment_id": 90436171, "body": "@gatopeich: There are a couple &quot;right solutions&quot; to your problem: either just making the static variables file-scope and using normal non-nested functions for ctors, or using <code>call_once</code>/<code>pthread_once</code> to initialize safely on first use. Being that nested functions are essentially a deprecated feature (most uses require executable stack, which is unsafe, and LLVM explicitly does not and won&#39;t support them) you should forget you ever heard of them and find a clean solution."}, {"owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533803563, "post_id": 51737293, "comment_id": 90483452, "body": "I had considered those options too, but for my use case I really want to be able to initialize the local static variable from the same macro instantiation that generates it. Otherwise it is not user friendly."}, {"owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533803819, "post_id": 51737293, "comment_id": 90483575, "body": "I am using this trick to create a register of such instances and the user should be able to list them without executing them."}, {"owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533803996, "post_id": 51737293, "comment_id": 90483691, "body": "IMO it is a bug in GCC in that a change in priority should not break the functionality, however fixing the bug would not solve my issue because I want this code to work on <i>existing</i> versions of GCC."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "edited": false, "score": 0, "creation_date": 1533825129, "post_id": 51737293, "comment_id": 90497969, "body": "@gatopeich: The bug in GCC is simply that it syntactically allows something that is not meaningful."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1533690226, "creation_date": 1533690226, "answer_id": 51737293, "question_id": 51736547, "link": "https://stackoverflow.com/questions/51736547/how-to-specify-priority-in-attribute-constructor-for-nested-functions/51737293#51737293", "title": "How to specify priority in __attribute__((constructor)) for nested functions?", "body": "<p>Nested functions cannot be validly called outside the lifetime of a particular instance of the block they're nested within. What would you expect to happen if these nested functions accessed <code>argv</code>?</p>\n\n<p>This is a bug in GCC, namely that it lets you attach the <code>constructor</code> attribute to nested functions for which it is meaningless. If you want to report it, it should be reported as such. There is no expected behavior since the construct has no meaning.</p>\n"}], "owner": {"reputation": 2139, "user_id": 501336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/de40a0efd9acecf74dbba0d6080fb6e1?s=128&d=identicon&r=PG", "display_name": "gatopeich", "link": "https://stackoverflow.com/users/501336/gatopeich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533690226, "creation_date": 1533682827, "question_id": 51736547, "link": "https://stackoverflow.com/questions/51736547/how-to-specify-priority-in-attribute-constructor-for-nested-functions", "title": "How to specify priority in __attribute__((constructor)) for nested functions?", "body": "<p>As part of some utility macro I am writing, I am defining a nested function with <code>__attribute__((constructor))</code></p>\n\n<p>However, I need those constructors to happen before other constructor defined at global space.</p>\n\n<p>Unluckily though, when I specify a priority for the nested constructors they stop working altogether, and when I don't specify it they are the last to be invoked...</p>\n\n<p>Here is the proof:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n__attribute__((constructor(102))) void global_constructor_prio102(void) { printf(\"%s\\n\", __func__); }\n__attribute__((constructor())) void global_constructor(void) { printf(\"%s\\n\", __func__); }\n__attribute__((constructor(101))) void global_constructor_prio101(void) { printf(\"%s\\n\", __func__); }\n\nint main(int argc, char **argv)\n{\n    printf(\"%s - gcc %s\\n\", __func__, __VERSION__);\n\n    __attribute__((constructor(102))) void nested_constructor_prio102(void) { printf(\"%s\\n\", __func__); }\n    __attribute__((constructor())) void nested_constructor(void) { printf(\"%s\\n\", __func__); }\n    __attribute__((constructor(101))) void nested_constructor_prio101(void) { printf(\"%s\\n\", __func__); }\n\n    return 0;\n}\n</code></pre>\n\n<p>And its output:</p>\n\n<pre><code>global_constructor_prio101\nglobal_constructor_prio102\nglobal_constructor\nnested_constructor\nmain - gcc 8.1.0\n</code></pre>\n\n<p>Am I hitting a bug in GCC, or some obscure behaviour?\nIs there a way to make the nested constructor run before a global one?</p>\n\n<p>(repl link: <a href=\"https://repl.it/@agustinf_/Nested-constructors-fail-with-priority\" rel=\"nofollow noreferrer\">https://repl.it/@agustinf_/Nested-constructors-fail-with-priority</a>)</p>\n"}, {"tags": ["c", "terminal", "vt100"], "comments": [{"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1533682582, "post_id": 51736445, "comment_id": 90433633, "body": "is the therminal subject to being resized?"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1533685168, "post_id": 51736445, "comment_id": 90434215, "body": "That&#39;s why they wrote the <a href=\"https://en.wikipedia.org/wiki/Curses_(programming_library)\" rel=\"nofollow noreferrer\"><code>curses</code></a> library a long time ago."}], "answers": [{"tags": [], "owner": {"reputation": 106867, "user_id": 13663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92f0c7fe372960ea92560487665a8720?s=128&d=identicon&r=PG", "display_name": "Will Hartung", "link": "https://stackoverflow.com/users/13663/will-hartung"}, "is_accepted": false, "score": 2, "last_activity_date": 1533682791, "creation_date": 1533682791, "answer_id": 51736541, "question_id": 51736445, "link": "https://stackoverflow.com/questions/51736445/rewind-past-a-block-of-text-in-vt100-terminal-commands/51736541#51736541", "title": "Rewind past a block of text in VT100 terminal commands", "body": "<p>The problem is that the VT100 doesn't allow text windows, or fixed scrolling windows (perhaps a better term).</p>\n\n<p>So, that leaves it to you to manage.</p>\n\n<p>Curses would be easiest because you could, in your code, just open two separate windows, one for the \"text\", one for the footer, and then let curses update the screen as it sees fit.</p>\n\n<p>With just raw VT100, you would have to track when to scroll. When you do scroll, you could delete the top line, then insert a blank line just before your footer, and then write on the new blank line.</p>\n\n<p>Curses would handle all of that for you, of course.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 2601195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13a350e9121c1d618bd40a40ac9b680a?s=128&d=identicon&r=PG", "display_name": "user2601195", "link": "https://stackoverflow.com/users/2601195/user2601195"}, "edited": false, "score": 0, "creation_date": 1533746894, "post_id": 51737448, "comment_id": 90463403, "body": "The scrolling region <code>&lt;ESC&gt;[{start};{end}r</code> looks like it will do the trick. I just have to make a maximum number of rows for the footer."}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 1, "last_activity_date": 1533691951, "creation_date": 1533691951, "answer_id": 51737448, "question_id": 51736445, "link": "https://stackoverflow.com/questions/51736445/rewind-past-a-block-of-text-in-vt100-terminal-commands/51737448#51737448", "title": "Rewind past a block of text in VT100 terminal commands", "body": "<p>You could do this using a scrolling region.  Something like this (keeping in mind that while you could hard-code escape sequences, this is more readable):</p>\n\n<pre><code>#!/bin/sh\nrows=$(tput lines)\nfoot=$((rows - 4))\ntput csr 1 $((foot - 1))\ncount=0\nwhile true\ndo\n        date\n        count=$((count + 1))\n        tput sc\n        tput cup $foot 1\n        printf \"Total cycles %d\", $count\n        tput rc\n        sleep 1\ndone\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 2601195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13a350e9121c1d618bd40a40ac9b680a?s=128&d=identicon&r=PG", "display_name": "user2601195", "link": "https://stackoverflow.com/users/2601195/user2601195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 51737448, "answer_count": 2, "score": 0, "last_activity_date": 1533691951, "creation_date": 1533682167, "question_id": 51736445, "link": "https://stackoverflow.com/questions/51736445/rewind-past-a-block-of-text-in-vt100-terminal-commands", "title": "Rewind past a block of text in VT100 terminal commands", "body": "<p>I basically want to manipulate the output of some program connected to a terminal so that the bottom section of text is always some arbitrary block of text (let's call it the footer), while the normal output of the program is displayed above that. If this footer was confined to a single terminal line, this would be very easy to do by simply clearing the current line, moving the cursor to the beginning of the line before each <code>write</code> call, and then rewriting the footer. However, if my desired footer spans multiple terminal lines, either by including newline characters or by lines wrapping around the edge of the screen, things are complicated. I thought I might be able to work around that with the \"save cursor\" and \"restore cursor\" VT100 control codes, which would be emitted as such for every write:</p>\n\n<ol>\n<li>restore cursor</li>\n<li>desired <code>write</code> call</li>\n<li>save cursor</li>\n<li>output footer</li>\n</ol>\n\n<p>However these don't work when the output text reaches the bottom of the terminal because the saved cursor will always be at the bottom row.</p>\n\n<p>Is there any way achieve this arbitrary terminal footer? Something with just VT100 codes would be ideal, but if the only way is to use curses then I suppose that's possible, too.</p>\n"}, {"tags": ["c", "arrays", "pointers", "argv"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 6, "creation_date": 1533680858, "post_id": 51736276, "comment_id": 90433188, "body": "Because <code>argv[1]</code> is a pointer and not an array."}, {"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 1, "creation_date": 1533681049, "post_id": 51736276, "comment_id": 90433252, "body": "Because that&#39;s not what <code>sizeof</code> does."}, {"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 1, "creation_date": 1533681110, "post_id": 51736276, "comment_id": 90433267, "body": "<code>sizeof</code> is determined at compile time. The number of characters in <code>argv[1]</code> is determined at runtime. Therefore you will never be able to know the value of <code>size</code> at compile time -- you have to actually inspect the string in <code>argv[1]</code>, either by looking at every character or by using a library function that does so."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533681414, "post_id": 51736276, "comment_id": 90433342, "body": "<code>while (x &lt; size) {</code> is not needed anyways.  Suggest <code>while (argv[1][x]) {</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533681450, "post_id": 51736276, "comment_id": 90433355, "body": "Please see <a href=\"https://stackoverflow.com/questions/17590226/c-finding-length-of-array-inside-a-function\">c, finding length of array inside a function</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1533681478, "post_id": 51736276, "comment_id": 90433368, "body": "thats what argc is for"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1533682064, "post_id": 51736276, "comment_id": 90433524, "body": "You may want to try passing each number separately with spaces between them instead of commas.  Then you don\u2019t have to manually separate them."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 1, "creation_date": 1533683892, "post_id": 51736276, "comment_id": 90433937, "body": "@DanielPryden In case you have a variable length array <code>sizeof</code> is not determined at compile time."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1533686507, "post_id": 51736276, "comment_id": 90434486, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5493281/c-sizeof-a-passed-array\">C sizeof a passed array</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1533695799, "post_id": 51736276, "comment_id": 90436146, "body": "regarding: <code>sizeof(argv[1]) &#47; sizeof(argv[1][0] </code>  this is saying the size of a pointer (argv[1]) divided by the size of a character.  It seems a pointer is 4 bytes on your architecture) so 4 / 1 = 4  To get the length of the <code>argv[1]</code>, use: <code>size_t length = strlen( argv[1] );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533681353, "post_id": 51736316, "comment_id": 90433329, "body": "Perhaps better as <code>int size = strlen(argv[1]) + 1;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533681730, "post_id": 51736316, "comment_id": 90433438, "body": "@WeatherVane <code>int size = strlen(argv[1]) + 1;</code> is good to go with the idea of <i>size</i>, yet then <code>next = argv[1][x];</code> will lastly do <code>next = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533681753, "post_id": 51736316, "comment_id": 90433446, "body": "@chux oops, i&#39;d expect 1 arg so argc=2.  looks like op is walking the characters in the first arg with x.  (my silly suggestion deleted)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533690564, "post_id": 51736316, "comment_id": 90435190, "body": "Minor: By starting with <code>int biggest=INT_MIN;</code>, code can properly report on &quot;a variable number of integers&quot; with input like <code>&quot;findMax -4,-5,-6&quot;</code>."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533714175, "post_id": 51736316, "comment_id": 90442285, "body": "@chux I thought of that too, but wanted to stick to OPs approach. Anyway it is for sure better if someone wants to handle negative values. I will change my answer, thanks."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533732723, "post_id": 51736316, "comment_id": 90454133, "body": "Note that <code>agv[1]</code> is modifiable and so a copy is not required.  Still a copy, IMO, is more robust than taking advantage of this C &quot;feature&quot; of a modifiable <code>argv[]</code>."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533736600, "post_id": 51736316, "comment_id": 90456806, "body": "@chux Yes it is probably worth to mention. The reason why i copied <code>argv[1]</code> is because after finding the max value there is no chance that you can access the elements again."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 4, "last_activity_date": 1533714189, "last_edit_date": 1533714189, "creation_date": 1533681112, "answer_id": 51736316, "question_id": 51736276, "link": "https://stackoverflow.com/questions/51736276/why-is-sizeof-not-returning-the-correct-number-of-elements-in-array/51736316#51736316", "title": "Why is sizeof not returning the correct number of elements in array?", "body": "<p><code>argv[1]</code> is of type <code>char *</code>, a pointer to a character. The <code>sizeof</code> operator gives you only the size of a pointer on your system. <code>argv[1][0]</code> is of type <code>char</code> and therefore its size is <code>1</code>.</p>\n\n<p>It works for two numbers because \"2,3\" has four chars (including null-terminator), which is coincidently the same as the size of a pointer on your platform.</p>\n\n<p>What you need to do is to determinate the length of <code>argv[1]</code> at runtime with the <code>strlen</code> function.</p>\n\n<pre><code>int size = strlen(argv[1]);\n</code></pre>\n\n<p>But there are other things that may cause problems:</p>\n\n<p>If you don't pass any arguments to your function the behavior is undefined since <code>argv[1]</code> does not exist. You should check <code>argc</code> how much arguments were passed.</p>\n\n<p>The <code>int</code> typecast you made does not read in an integer till the next <code>,</code> as your example usage may suggest.</p>\n\n<p>Here is a program that should work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int next, biggest=INT_MIN;\n    char *token;\n\n    if(argc != 2)\n    {\n        printf(\"Wrong arguments.\\n\");\n        return -1;\n    }\n\n    char input[strlen(argv[1])+1];\n    strcpy(input, argv[1]);\n\n    printf (\"Finding largest value from input: %s\\n\\n\",argv[1]);\n\n    token = strtok(input, \",\");\n\n    while(token)\n    {\n        next = atoi(token);\n        if(next&gt;biggest)\n        {\n            biggest = next;\n        }\n        token = strtok(NULL, \",\");   \n    }\n\n    printf(\"Biggest # is: %d\\n\",biggest);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1533683161, "post_id": 51736517, "comment_id": 90433771, "body": "@snr Isn&#39;t it? What is it then?"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1533683406, "post_id": 51736517, "comment_id": 90433831, "body": "It&#39;s my fault. Here is too night. Sorry everybody. Have nice night! That&#39;s all from me!"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1533683600, "post_id": 51736517, "comment_id": 90433881, "body": "@sidyll More precisely spoken, arrays decay to pointers when they are passed as function arguments."}], "tags": [], "owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "is_accepted": false, "score": 2, "last_activity_date": 1533682613, "creation_date": 1533682613, "answer_id": 51736517, "question_id": 51736276, "link": "https://stackoverflow.com/questions/51736276/why-is-sizeof-not-returning-the-correct-number-of-elements-in-array/51736517#51736517", "title": "Why is sizeof not returning the correct number of elements in array?", "body": "<p>In fact <code>argv[1]</code> is a pointer to a <code>char</code>, not an array of <code>char</code>. And considering a pointer is 4 in size in your platform and a <code>char</code> is surely 1 byte, then 4 is the logical answer to this:</p>\n\n<pre><code>sizeof(argv[1]) / sizeof(argv[1][0])\n     4          /        1\n</code></pre>\n\n<p>One main problem with your code is that you're not parsing the integers. You are comparing characters. In <code>10,2</code>, the biggest will be <code>2</code>.</p>\n\n<p>Note that there is no need to find the size of a string at all if the intention is to iterate char by char up to it's end. You can just do it until a null is found. This strategy however might not be the easiest though, if you do want to parse the characters.</p>\n\n<p>A completely different approach involving no array or size checking could use <code>strtok</code> and <code>strtol</code> to parse the string into tokens and integers. Here follows a very simple implementation with no error checking at all:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint\nmain(int argc, char **argv)\n{\n    int curr, max = 0;\n    char *token;\n\n    token = strtok(argv[1], \",\");\n\n    while (token != NULL) {\n        curr = (int)strtol(token, (char **)NULL, 10);\n        if (curr &gt; max) max = curr;\n        token = strtok(NULL, \",\");\n    }\n    printf(\"The biggest integer was: %d\\n\", max);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7191972, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-00rFMgp7P14/AAAAAAAAAAI/AAAAAAAAAkM/ufEsZFLAViw/photo.jpg?sz=128", "display_name": "scytheblade69", "link": "https://stackoverflow.com/users/7191972/scytheblade69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533715372, "creation_date": 1533680823, "last_edit_date": 1533715372, "question_id": 51736276, "link": "https://stackoverflow.com/questions/51736276/why-is-sizeof-not-returning-the-correct-number-of-elements-in-array", "title": "Why is sizeof not returning the correct number of elements in array?", "body": "<p>So for practice, I wrote a little code that takes a variable number of integers in an array and then determines the largest value.</p>\n\n<p>I wanted to make the program runnable from the command line (i.e. <code>findMax 4, 5, 6, 20, 1, 3</code> in that exact format).</p>\n\n<p>So considering that <code>argv[1]</code> is a pointer to a <code>char</code> array, I figure I can loop from <code>argv[1][0]</code> to <code>argv[1][n]</code>.</p>\n\n<p>I think the pointers are the reason I am not able to get my code to work.<br>\nIn the first code, I wrote, using</p>\n\n<pre><code>sizeof(arr) / sizeof(arr[0]) = # of elements in array 'arr'\n</code></pre>\n\n<p>correctly gave me the number of elements.<br>\nHowever, when I run</p>\n\n<pre><code>sizeof(argv[1]) / sizeof(argv[1][0]) = always return (integer) 4\n</code></pre>\n\n<p>Am I correct in thinking that I am using a pointer here, which is why the size is always the same? I tried to dereference both of them (separately and together) but it created even more confusing results.</p>\n\n<p>Here is the full code which is not working. <strong>Except</strong> for some odd reason, it only works when I enter exactly <strong>two</strong> numbers (i.e. findMax.exe 2, 3 will correctly determine that '3' is the largest number).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n\n    printf (\"Finding largest value from input: %s\", argv[1]);\n\n    int size = (int)sizeof(argv[1]) / (int)sizeof(argv[1][0]);\n    int x = 0;\n    int next;\n    int biggest = 0;\n\n    while (x &lt; size) {\n        if (argv[1][x] != ',') {\n            next = argv[1][x];\n            printf(\"\\n%c\", (int)next);\n            if ((int)next &gt; biggest) {\n                biggest = next;\n            }   \n        }\n        x++;\n    }\n    printf(\"\\nBiggest # is: %c\", biggest);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "c", "ssh", "jsch", "libssh"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1533679951, "post_id": 51736073, "comment_id": 90432944, "body": "Sounds more like it&#39;s the <code>ssh_channel_send_eof(channel); ssh_channel_close(channel); ssh_channel_free(channel);</code> lines that need to be implemented. You have to flush your streams for the data to be actually transmitted. <code>out.flush();</code> might be sufficient."}], "answers": [{"tags": [], "owner": {"reputation": 24739, "user_id": 1790644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f1a2a40ddbc52508d5b53e9879961251?s=128&d=identicon&r=PG", "display_name": "Matt Clark", "link": "https://stackoverflow.com/users/1790644/matt-clark"}, "is_accepted": true, "score": 1, "last_activity_date": 1533681327, "creation_date": 1533681327, "answer_id": 51736342, "question_id": 51736073, "link": "https://stackoverflow.com/questions/51736073/ssh-client-in-c-libssh-rewrite-in-java-jsch/51736342#51736342", "title": "SSH client in C libssh rewrite in Java jsch", "body": "<p>It is highly likely that the data is being added to the buffer, but is never being flushed out to the client.</p>\n\n<p>Try using a PrintWriter, or simple flush your streams.</p>\n\n<pre><code>out.write(\"abc\");\nout.flush();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>PrintWriter writer = new PrintWriter(channel.getOutputStream(), true);\nwriter.println(\"abc\");\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7012428, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WoNEnXilvO8/AAAAAAAAAAI/AAAAAAAAAEk/8G_n_pVOOBc/photo.jpg?sz=128", "display_name": "Jan \u0160vanda", "link": "https://stackoverflow.com/users/7012428/jan-%c5%a0vanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "accepted_answer_id": 51736342, "answer_count": 1, "score": 0, "last_activity_date": 1533681327, "creation_date": 1533679543, "last_edit_date": 1533679938, "question_id": 51736073, "link": "https://stackoverflow.com/questions/51736073/ssh-client-in-c-libssh-rewrite-in-java-jsch", "title": "SSH client in C libssh rewrite in Java jsch", "body": "<p>I have a simple SSH client which is written in C (libssh) and I need to rewrite the client in Java (jsch). Here is the C code:</p>\n\n<pre><code>#include &lt;libssh/libssh.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt; \n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nchar TEST[] = \"HELLO WORLD!\";\n\nint main(){\n  ssh_session my_ssh_session;\n  int rc;\n  int port = 22;\n  int verbosity = SSH_LOG_NOLOG;\n  char *password, *user;\n  ssh_channel channel;\n\n  my_ssh_session = ssh_new();\n  if(my_ssh_session == NULL)\n  exit(-1);\n\n ssh_options_set(my_ssh_session, SSH_OPTIONS_HOST, \"192.168.1.1\");\n ssh_options_set(my_ssh_session, SSH_OPTIONS_PORT, &amp;port);\n ssh_options_set(my_ssh_session, SSH_OPTIONS_LOG_VERBOSITY, &amp;verbosity);   \n\n rc = ssh_connect(my_ssh_session);\n if(rc != SSH_OK){\n fprintf(stderr, \"Error: %s\\n\", ssh_get_error(my_ssh_session));  \n ssh_free(my_ssh_session);\n exit(-1);\n }\n\nuser = \"user\";\npassword = \"pass\";  \n\n rc = ssh_userauth_password(my_ssh_session, user, password);\n if(rc != SSH_AUTH_SUCCESS){\n  fprintf(stderr, \"Error authenticating with password: %s\\n\",\n  ssh_get_error(my_ssh_session));\n  ssh_disconnect(my_ssh_session);\n  ssh_free(my_ssh_session);\n  exit(-1);\n }\n\nchannel = ssh_channel_new(my_ssh_session);\nif(channel == NULL)\nreturn SSH_ERROR;\n\nrc = ssh_channel_open_session(channel);\nif(rc != SSH_OK){\n ssh_channel_free(channel);\n return rc;\n }\n\nssh_channel_write(channel, TEST, sizeof(TEST)); // This line need to be      implemeneted in Java using JSCH librarary.\n\nssh_channel_send_eof(channel);\nssh_channel_close(channel);\nssh_channel_free(channel);\n\nssh_disconnect(my_ssh_session);\nssh_free(my_ssh_session);\n}\n</code></pre>\n\n<p>I have figured out the client authentification in Java. The client can create Session and Channel but I am not able to write data in to the SSH channel like in C. I have tried to getOutputStream() on channel and write data in to the stream but the server don't receive any data. I've tried also different settings (sheel,direct-tcpi, etc... ) of openChannel(String type ) method.\n Here is Java code:</p>\n\n<pre><code>  JSch jsch=new JSch();\n  Session session=jsch.getSession(user, host, port);\n  session.setPassword(password);\n  localUserInfo lui=new localUserInfo();\n  session.setUserInfo(lui);\n  session.connect();\n\n  Channel channel = (Channel)session.openChannel(\"session\" );\n\n  channel.connect();\n\n  OutputStream out = channel.getOutputStream();\n  out.write(buffer);\n</code></pre>\n\n<p>Do you have any idea how to write in Java using jsch a similar functionality which offers \n<code>ssh_channel_write(channel, TEST, sizeof(TEST))</code> from libssh?</p>\n\n<p>thanks</p>\n"}, {"tags": ["c", "algorithm", "floating-point", "trigonometry"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533692235, "post_id": 51735576, "comment_id": 90435485, "body": "When re-writing standard functions to take advantage of speed, often there is a loss of accuracy or loss of range or portability.  Yet the importance of speed, range, portability  vs. accuracy are not the same dimension and so we are left with comparing unlike qualities.  IOWs, <i>how is fast and accurate rated together?</i> <code>double my_sin(double x) { return x; } </code> is fast, portability &amp; high precision over maybe 25% of all <code>double</code>  (the small ones) yet lousy with large values."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1533680204, "post_id": 51735577, "comment_id": 90433018, "body": "You should also examine how far <code>sin(base)*sin(base) + cos(base)*cos(base)</code> drifts from unity, to see if/when renormalization might become necessary."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533691464, "post_id": 51735577, "comment_id": 90435345, "body": "FMA is sometimes not that helpful, precision wise: <a href=\"https://stackoverflow.com/a/42172145/2410359\">Is my fma() broken?</a>"}], "tags": [], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "is_accepted": false, "score": 4, "last_activity_date": 1533676713, "creation_date": 1533676713, "answer_id": 51735577, "question_id": 51735576, "link": "https://stackoverflow.com/questions/51735576/fast-and-accurate-iterative-generation-of-sine-and-cosine-for-equally-spaced-ang/51735577#51735577", "title": "Fast and accurate iterative generation of sine and cosine for equally-spaced angles", "body": "<p>The application of the <a href=\"http://mathworld.wolfram.com/Half-AngleFormulas.html\" rel=\"nofollow noreferrer\">half-angle formula</a> for the sine allows to address both of the accuracy-impacting issues mentioned in the question:</p>\n\n<blockquote>\n  <p><em>sin(incr/2) = \u221a((1-cos(incr))/2) \u21d2</em><br>\n  <em>sin\u00b2(incr/2) = (1-cos(incr))/2 \u21d4</em><br>\n  <em>2\u00b7sin\u00b2(incr/2) = 1-cos(incr) \u21d4</em><br>\n  <em>1-2\u00b7sin\u00b2(incr/2) = cos(incr)</em></p>\n</blockquote>\n\n<p>Substituting this into the original formula results in this intermediate representation:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = (1 - 2\u00b7sin\u00b2(incr/2)) \u00b7 sin(base) + sin(incr) \u00b7 cos(base)</em><br>\n  <em>cos(base+incr) = (1 - 2\u00b7sin\u00b2(incr/2)) \u00b7 cos(base) - sin(incr) \u00b7 sin(base)</em></p>\n</blockquote>\n\n<p>By a simple reordering of the terms one arrives at the desired form of the formula:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = sin(base) + (sin(incr) \u00b7 cos(base) - 2\u00b7sin\u00b2(incr/2) \u00b7 sin(base))</em><br>\n  <em>cos(base+incr) = cos(base) - (2\u00b7sin\u00b2(incr/2) \u00b7 cos(base) + sin(incr) \u00b7 sin(base))</em>  </p>\n</blockquote>\n\n<p>As in the original formula, this only requires the one-time precomputation of two scale factors, namely <em>2\u00b7sin\u00b2(incr/2)</em> and <em>sin(incr)</em>. For small increments, both of them are small: full accuracy is retained.</p>\n\n<p>There are two choices on how to apply FMA to this computation. One can either minimize the number of operations by abolishing the approach of using a single adjustment, and instead use two, hoping that the reduced rounding error of the FMA operation (one rounding for two operations) will compensate the loss in accuracy:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = fma (-2\u00b7sin\u00b2(incr/2), sin(base), fma ( sin(incr), cos(base), sin(base)))</em><br>\n  <em>cos(base+incr) = fma (-2\u00b7sin\u00b2(incr/2), cos(base), fma (-sin(incr), sin(base), cos(base)))</em></p>\n</blockquote>\n\n<p>The other alternative is to apply a single FMA to the improved formula, although it is not immediately clear which of the two multiplies should be mapped to the unrounded multiplication inside the FMA:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = sin(base) + fma (sin(incr), cos(base), -2\u00b7sin\u00b2(incr/2) \u00b7 sin(base))</em><br>\n  <em>cos(base+incr) = cos(base) - fma (sin(incr), sin(base),  2\u00b7sin\u00b2(incr/2) \u00b7 cos(base))</em></p>\n</blockquote>\n\n<p>The scaffolding below evaluates each of the computational alternative discussed above by generating many (<em>base</em>, <em>incr</em>) pairs, then iterates for each of them for a set number of steps while collecting errors of all sine and cosine values generated. From this it computes a <a href=\"https://en.wikipedia.org/wiki/Root-mean-square_deviation\" rel=\"nofollow noreferrer\">root-mean square error</a> for each test case, separately for sines, cosines. The largest RMS error observed across all generated test cases is reported at the end. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#define NAIVE    (1)\n#define ROBUST   (2)\n#define FAST     (3)\n#define ACCURATE (4)\n#define MODE (ACCURATE)\n\n// Fixes via: Greg Rose, KISS: A Bit Too Simple. http://eprint.iacr.org/2011/007\nstatic unsigned int z=362436069,w=521288629,jsr=362436069,jcong=123456789;\n#define znew (z=36969*(z&amp;0xffff)+(z&gt;&gt;16))\n#define wnew (w=18000*(w&amp;0xffff)+(w&gt;&gt;16))\n#define MWC  ((znew&lt;&lt;16)+wnew)\n#define SHR3 (jsr^=(jsr&lt;&lt;13),jsr^=(jsr&gt;&gt;17),jsr^=(jsr&lt;&lt;5)) /* 2^32-1 */\n#define CONG (jcong=69069*jcong+13579)                     /* 2^32 */\n#define KISS ((MWC^CONG)+SHR3)\n\nint main (void)\n{\n    double sumerrsqS, sumerrsqC, rmsS, rmsC, maxrmsS = 0, maxrmsC = 0;\n    double refS, refC, errS, errC;\n    float base, incr, s0, c0, s1, c1, tt;\n    int count, i;\n\n    const int N = 100;  // # rotation steps per test case\n    count = 2000000;    // # test cases (a pair of base and increment values)\n\n#if MODE == NAIVE\n    printf (\"testing: NAIVE (without FMA)\\n\");\n#elif MODE == FAST\n    printf (\"testing: FAST (without FMA)\\n\");\n#elif MODE == ACCURATE\n    printf (\"testing: ACCURATE (with FMA)\\n\");\n#elif MODE == ROBUST\n    printf (\"testing: ROBUST (with FMA)\\n\");\n#else\n#error unsupported MODE\n#endif // MODE\n\n    do {\n        /* generate test case */\n        base = (float)(KISS * 1.21e-10);      // starting angle, &lt; 30 degrees\n        incr = (float)(KISS * 2.43e-10 / N);  // increment, &lt; 60/n degrees\n\n        /* set up rotation parameters */\n        s1 = sinf (incr);\n#if MODE == NAIVE\n        c1 = cosf (incr);\n#else\n        tt = sinf (incr * 0.5f);\n        c1 = 2.0f * tt * tt;\n#endif // MODE\n        sumerrsqS = 0;\n        sumerrsqC = 0;\n\n        s0 = sinf (base); // initial sine\n        c0 = cosf (base); // initial cosine\n\n        /* run test case through N rotation steps */\n        i = 0;\n        do {         \n\n            tt = s0; // old sine\n#if MODE == NAIVE\n            /* least accurate, 6 FP ops */\n            s0 = c1 * tt + s1 * c0; // new sine\n            c0 = c1 * c0 - s1 * tt; // new cosine\n#elif MODE == ROBUST\n            /* very accurate, 8 FP ops */\n            s0 = ( s1 * c0 - c1 * tt) + tt; // new sine\n            c0 = (-s1 * tt - c1 * c0) + c0; // new cosine\n#elif MODE == FAST\n            /* accurate and fast, 4 FP ops */\n            s0 = fmaf (-c1, tt, fmaf ( s1, c0, tt)); // new sine\n            c0 = fmaf (-c1, c0, fmaf (-s1, tt, c0)); // new cosine\n#elif MODE == ACCURATE\n            /* most accurate, 6 FP ops */\n            s0 = tt + fmaf (s1, c0, -c1 * tt); // new sine\n            c0 = c0 - fmaf (s1, tt,  c1 * c0); // new cosine\n#endif // MODE\n            i++;\n\n            refS = sin (fma ((double)i, (double)incr, (double)base));\n            refC = cos (fma ((double)i, (double)incr, (double)base));\n            errS = ((double)s0 - refS) / refS;\n            errC = ((double)c0 - refC) / refC;\n            sumerrsqS = fma (errS, errS, sumerrsqS);\n            sumerrsqC = fma (errC, errC, sumerrsqC);\n        } while (i &lt; N);\n\n        rmsS = sqrt (sumerrsqS / N);\n        rmsC = sqrt (sumerrsqC / N);\n        if (rmsS &gt; maxrmsS) maxrmsS = rmsS;\n        if (rmsC &gt; maxrmsC) maxrmsC = rmsC;\n\n    } while (--count);\n\n    printf (\"max rms error sin = % 16.9e\\n\", maxrmsS);\n    printf (\"max rms error cos = % 16.9e\\n\", maxrmsC);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The output of the test scaffold shows that the fastest FMA-based alternative is superior to the naive method from the question, while the more accurate FMA-based alternative is the most accurate out of the alternatives considered:</p>\n\n<pre><code>testing: NAIVE (without FMA)\nmax rms error sin =  4.837386842e-006\nmax rms error cos =  6.884047862e-006\n\ntesting: ROBUST (without FMA)\nmax rms error sin =  3.330292645e-006\nmax rms error cos =  4.297631502e-006\n\ntesting: FAST (with FMA)\nmax rms error sin =  3.532624939e-006\nmax rms error cos =  4.763623188e-006\n\ntesting: ACCURATE (with FMA)\nmax rms error sin =  3.330292645e-006\nmax rms error cos =  4.104813533e-006\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 1, "last_activity_date": 1533699336, "last_edit_date": 1533699336, "creation_date": 1533683072, "answer_id": 51736577, "question_id": 51735576, "link": "https://stackoverflow.com/questions/51735576/fast-and-accurate-iterative-generation-of-sine-and-cosine-for-equally-spaced-ang/51736577#51736577", "title": "Fast and accurate iterative generation of sine and cosine for equally-spaced angles", "body": "<p>If you want to maximize accuracy over long iteration counts, you could incrementally compute an exact value with no accumulated error while you generate incremental results from the previous exact value.</p>\n\n<p>For example, if you precompute <strong>sin(incr*2^x)</strong> and <strong>cos(incr*2^x)</strong> for <strong>x=6 ... 31</strong>, say, then you can use the angle-sum formulas to calculate the result for each <strong>incr=64*n</strong> one bit at a time while you output the previous 64 values.</p>\n\n<p>Every 64 values you discard the incrementally generated result in favor of the exact one, so no error can accumulate over long periods.</p>\n\n<p>Also, since you're only going to need 64 incremental results from any exact base, you can precompute the 64 sines and cosines required to calculate those results directly from the base instead of the previous result.</p>\n"}, {"tags": [], "owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "is_accepted": false, "score": 0, "last_activity_date": 1538053644, "creation_date": 1538053644, "answer_id": 52537743, "question_id": 51735576, "link": "https://stackoverflow.com/questions/51735576/fast-and-accurate-iterative-generation-of-sine-and-cosine-for-equally-spaced-ang/52537743#52537743", "title": "Fast and accurate iterative generation of sine and cosine for equally-spaced angles", "body": "<p>It is possible to rearrange the equations for sin(base+incr) and cos(base+incr) in the following way:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = cos(incr) \u00b7 sin(base) + sin(incr) \u00b7 cos(base)</em><br>\n   <em>sin(base+incr) = sin(base) + (1 - cos(incr)) \u00b7 -sin(base) +  sin(incr) \u00b7 cos(base)</em><br>\n   <em>sin(base+incr) = sin(base) + sin(incr) \u00b7 (-1 / sin(incr) \u00b7 (1 - cos(incr)) \u00b7 sin(base) + cos(base))</em><br>\n   <em>sin(base+incr) = sin(base) + sin(incr) \u00b7 (-tan(incr/2) \u00b7 sin(base) + cos(base))</em></p>\n  \n  <p><em>cos(base+incr) = cos(incr) \u00b7 cos(base) - sin(incr) \u00b7 sin(base)</em><br>\n   <em>cos(base+incr) = cos(base) - sin(incr) \u00b7 (tan(incr/2) \u00b7 cos(base) + sin(base))</em></p>\n</blockquote>\n\n<p>Here we use the formula <em>(1-cos(x)/sin(x) = tan(x/2)</em>, \nsee <a href=\"https://math.stackexchange.com/a/440467\">here</a>, for example.\nIt is not immediately obvious that this should lead to more accurate results than the other approaches,\nbut in practice it works quite well, as we will see later.</p>\n\n<p>Again, this requires the one-time precomputation of two scale factors <em>sin(incr)</em> and <em>tan(incr/2)</em>.\nIn C we can write the formulas with 4 fma-s:</p>\n\n<pre><code>        s0 = fmaf ( s1, fmaf (-tt, c1, c0), tt); // new sine\n        c0 = fmaf (-s1, fmaf ( c0, c1, tt), c0); // new cosine\n</code></pre>\n\n<p>The full updated test code is at the end of this answer.\nWith <code>gcc -O3 -Wall -m64 -march=skylake fastsincos.c -lm</code> (GCC version 7.3), the results are:</p>\n\n<pre><code>testing: FAST (with FMA)\nmax rms error sin =  3.532624939e-06\nmax rms error cos =  4.763623188e-06\n\ntesting: ACCURATE (with FMA)\nmax rms error sin =  3.330292645e-06\nmax rms error cos =  4.104813533e-06\n\ntesting: FAST_ACC (with FMA)\nmax rms error sin =  3.330292645e-06\nmax rms error cos =  3.775300478e-06\n</code></pre>\n\n<p>The new solution <code>FAST_ACC</code> is indeed a bit more accurate than the others in this test.</p>\n\n<hr/>\n\n<p>Modified test code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#define NAIVE    (1)\n#define ROBUST   (2)\n#define FAST     (3)\n#define ACCURATE (4)\n#define FAST_ACC (5)\n#define MODE (FAST_ACC)\n\n// Fixes via: Greg Rose, KISS: A Bit Too Simple. http://eprint.iacr.org/2011/007\nstatic unsigned int z=362436069,w=521288629,jsr=362436069,jcong=123456789;\n#define znew (z=36969*(z&amp;0xffff)+(z&gt;&gt;16))\n#define wnew (w=18000*(w&amp;0xffff)+(w&gt;&gt;16))\n#define MWC  ((znew&lt;&lt;16)+wnew)\n#define SHR3 (jsr^=(jsr&lt;&lt;13),jsr^=(jsr&gt;&gt;17),jsr^=(jsr&lt;&lt;5)) /* 2^32-1 */\n#define CONG (jcong=69069*jcong+13579)                     /* 2^32 */\n#define KISS ((MWC^CONG)+SHR3)\n\nint main (void)\n{\n    double sumerrsqS, sumerrsqC, rmsS, rmsC, maxrmsS = 0, maxrmsC = 0;\n    double refS, refC, errS, errC;\n    float base, incr, s0, c0, s1, c1, tt;\n    int count, i;\n\n    const int N = 100;  // # rotation steps per test case\n    count = 2000000;    // # test cases (a pair of base and increment values)\n\n#if MODE == NAIVE\n    printf (\"testing: NAIVE (without FMA)\\n\");\n#elif MODE == FAST\n    printf (\"testing: FAST (without FMA)\\n\");\n#elif MODE == ACCURATE\n    printf (\"testing: ACCURATE (with FMA)\\n\");\n#elif MODE == ROBUST\n    printf (\"testing: ROBUST (with FMA)\\n\");\n#elif MODE == FAST_ACC\n    printf (\"testing: FAST_ACC (with FMA)\\n\");\n#else\n#error unsupported MODE\n#endif // MODE\n\n    do {\n        /* generate test case */\n        base = (float)(KISS * 1.21e-10);      // starting angle, &lt; 30 degrees\n        incr = (float)(KISS * 2.43e-10 / N);  // increment, &lt; 60/n degrees\n\n        /* set up rotation parameters */\n        s1 = sinf (incr);\n#if MODE == NAIVE\n        c1 = cosf (incr);\n#elif MODE == FAST_ACC\n        c1 = tanf (incr * 0.5f);\n#else\n        tt = sinf (incr * 0.5f);\n        c1 = 2.0f * tt * tt;\n#endif // MODE\n        sumerrsqS = 0;\n        sumerrsqC = 0;\n\n        s0 = sinf (base); // initial sine\n        c0 = cosf (base); // initial cosine\n\n        /* run test case through N rotation steps */\n        i = 0;\n        do {         \n\n            tt = s0; // old sine\n#if MODE == NAIVE\n            /* least accurate, 6 FP ops */\n            s0 = c1 * tt + s1 * c0; // new sine\n            c0 = c1 * c0 - s1 * tt; // new cosine\n#elif MODE == ROBUST\n            /* very accurate, 8 FP ops */\n            s0 = ( s1 * c0 - c1 * tt) + tt; // new sine\n            c0 = (-s1 * tt - c1 * c0) + c0; // new cosine\n#elif MODE == FAST\n            /* accurate and fast, 4 FP ops */\n            s0 = fmaf (-c1, tt, fmaf ( s1, c0, tt)); // new sine\n            c0 = fmaf (-c1, c0, fmaf (-s1, tt, c0)); // new cosine\n#elif MODE == ACCURATE\n            /* most accurate, 6 FP ops */\n            s0 = tt + fmaf (s1, c0, -c1 * tt); // new sine\n            c0 = c0 - fmaf (s1, tt,  c1 * c0); // new cosine\n#elif MODE == FAST_ACC\n            /* fast and accurate, 4 FP ops */\n            s0 = fmaf ( s1, fmaf (-tt, c1, c0), tt); // new sine\n            c0 = fmaf (-s1, fmaf ( c0, c1, tt), c0); // new cosine\n#endif // MODE\n            i++;\n\n            refS = sin (fma ((double)i, (double)incr, (double)base));\n            refC = cos (fma ((double)i, (double)incr, (double)base));\n            errS = ((double)s0 - refS) / refS;\n            errC = ((double)c0 - refC) / refC;\n            sumerrsqS = fma (errS, errS, sumerrsqS);\n            sumerrsqC = fma (errC, errC, sumerrsqC);\n        } while (i &lt; N);\n\n        rmsS = sqrt (sumerrsqS / N);\n        rmsC = sqrt (sumerrsqC / N);\n        if (rmsS &gt; maxrmsS) maxrmsS = rmsS;\n        if (rmsC &gt; maxrmsC) maxrmsC = rmsC;\n\n    } while (--count);\n\n    printf (\"max rms error sin = % 16.9e\\n\", maxrmsS);\n    printf (\"max rms error cos = % 16.9e\\n\", maxrmsC);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1538053644, "creation_date": 1533676713, "question_id": 51735576, "link": "https://stackoverflow.com/questions/51735576/fast-and-accurate-iterative-generation-of-sine-and-cosine-for-equally-spaced-ang", "title": "Fast and accurate iterative generation of sine and cosine for equally-spaced angles", "body": "<p>In some applications, sine and cosine of multiple angles are needed, where the angles are derived by repeated addition of equal-sized increments <em>incr</em> to a starting value <em>base</em>. For performance reasons, instead of invoking the <code>sin()</code>, <code>cos()</code> standard math library functions (or possibly the non-standard <code>sincos()</code> function) for each generated angle, it can be very advantageous to compute <em>sin(base)</em> and <em>cos(base)</em> only once, then derive all other sines and cosines by application of <a href=\"http://mathworld.wolfram.com/TrigonometricAdditionFormulas.html\" rel=\"nofollow noreferrer\">angle-sum formulas</a>:</p>\n\n<blockquote>\n  <p><em>sin(base+incr) = cos(incr) \u00b7 sin(base) + sin(incr) \u00b7 cos(base)</em><br>\n  <em>cos(base+incr) = cos(incr) \u00b7 cos(base) - sin(incr) \u00b7 sin(base)</em></p>\n</blockquote>\n\n<p>This only requires the one-time precomputation of the scale factors <em>sin(incr)</em> and <em>cos(incr)</em>, regardless of how many iterations are performed.</p>\n\n<p>There are a couple of issues with this approach. If the increment is small, <em>cos(incr)</em> will be a number near unity, causing a loss of accuracy through implicit subtractive cancellation when computing in a finite precision floating-point format. Also, more rounding error than necessary is incurred because the computation is <strong>not</strong> arranged in the numerical advantageous form <em>sin(base+incr) = sin(base) + adjust</em> , where the computed quantity <em>adjust</em> is significantly smaller in magnitude than <em>sin(base)</em> (analogous for the cosine). </p>\n\n<p>Since one usually applies tens to hundreds of iteration steps, these errors will accumulate. How can one structure the iterative computation in a manner most advantageous to maintaining high accuracy? What changes to the algorithm should be made if the <a href=\"https://en.wikipedia.org/wiki/Multiply%E2%80%93accumulate_operation#Fused_multiply%E2%80%93add\" rel=\"nofollow noreferrer\">fused multiply-add</a> operation (FMA) is available, which is exposed via the standard math functions <code>fma()</code> and <code>fmaf()</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1533674527, "post_id": 51734982, "comment_id": 90430997, "body": "You could make the data portion of your stack_node a <code>void *</code> and malloc it as you please."}, {"owner": {"reputation": 3817, "user_id": 2082884, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8c1a7c51faf6f8622ecdbb8b638d3550?s=128&d=identicon&r=PG", "display_name": "hetepeperfan", "link": "https://stackoverflow.com/users/2082884/hetepeperfan"}, "edited": false, "score": 0, "creation_date": 1533674602, "post_id": 51734982, "comment_id": 90431031, "body": "Well could declare a new <code>struct</code> with <code>char*</code> for name and <code>int value</code>. Than change stack_node to use your new struct instead of an int. Which was basically what you already mentioned, That should be possible, to keep it simple don&#39;t make it a pointer but use a plain struct."}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533690976, "post_id": 51734982, "comment_id": 90435264, "body": "I tried both ways....but I&#39;m either not storing it properly in the stack or displaying it."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533691062, "post_id": 51735394, "comment_id": 90435279, "body": "I made some changes to the program and it&#39;s working without any compilation errors, but I still can&#39;t display the char name :/"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533692265, "post_id": 51735394, "comment_id": 90435492, "body": "The way you&#39;re trying to save name in <code>push_stack()</code> isn&#39;t correct.  If you call <code>malloc()</code> like that, the first thing you need to do is add 1 to allow space for the &#39;NUL&#39; byte that ends the string.  Then you need to point <code>n-&gt;name </code> at the space immediately after the node addressed by <code>n</code>, so it&#39;s looking into the &quot;extra&quot; memory you grabbed during the <code>malloc()</code> call.  Finally, you need to copy the string to that location with <code>strncpy()</code>. ..."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533692279, "post_id": 51735394, "comment_id": 90435496, "body": "...  As a general rule of thumb, it&#39;s always a good habit to be in to use <code>strncpy()</code> rather than <code>strcpy()</code> since doing so will dramatically reduce your risk of a buffer overrun if you get handed bad data."}], "tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 0, "last_activity_date": 1533675805, "creation_date": 1533675805, "answer_id": 51735394, "question_id": 51734982, "link": "https://stackoverflow.com/questions/51734982/stacks-with-strings-and-integers-c/51735394#51735394", "title": "stacks with strings and integers - C", "body": "<p>Is there any reason not to alter your <code>stack_node</code> struct to directly include the name.</p>\n\n<pre><code>struct stack_node{\n    int value;\n    struct stack_node * next;\n    char name[1];\n};\n</code></pre>\n\n<p>This particular form has the advantage that if you call <code>malloc</code> as follows:</p>\n\n<pre><code>struct stack_node * new_node = malloc(sizeof *new_node + strlen(name));\n</code></pre>\n\n<p>you get exactly the correct amount of memory, including space for the trailing <code>NUL</code> byte on the string.</p>\n\n<p>Ob warning.  Skip the last paragraph if you are humor impaired.</p>\n\n<p>Still here?  Good.  Failing all this, you could always try a <a href=\"https://en.wikipedia.org/wiki/SOAP\" rel=\"nofollow noreferrer\">Soap</a> interface.  But then perhaps we should never talk about that. ;)</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1533699361, "post_id": 51738167, "comment_id": 90436806, "body": "He with also need to alloc <code>(strlen(name) + 1);</code>  (note: the <b>+1</b>) But he cannot allocate for both the struct and <code>name</code> at the same time. He also cannot assign <code>n-&gt;name = name;</code>, but instead will need to alloc <code>name</code> separately and <code>strcpy</code> after allocation."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1533699169, "last_edit_date": 1533699169, "creation_date": 1533698368, "answer_id": 51738167, "question_id": 51734982, "link": "https://stackoverflow.com/questions/51734982/stacks-with-strings-and-integers-c/51738167#51738167", "title": "stacks with strings and integers - C", "body": "<p>Few of problems in your code:</p>\n\n<p>Problem 1:<br>\nLook at these statement of function <code>push_stack()</code>:</p>\n\n<pre><code>    n-&gt;next = s-&gt;top;\n    s-&gt;top = n;\n</code></pre>\n\n<p>The <code>next</code> of stack node <code>n</code> is pointing to <code>top</code> of <code>stack</code> and <code>top</code> of stack is pointing back to node <code>n</code>. The <code>next</code> of the node created should be <code>NULL</code> as it will be top node of stack. You don't need this statement <code>n-&gt;next = s-&gt;top;</code>. It should be:</p>\n\n<pre><code>    n-&gt;next = NULL;\n    s-&gt;top = n;\n</code></pre>\n\n<p>Problem 2:</p>\n\n<p>In <code>main()</code>, you are doing:</p>\n\n<pre><code>    printf(\"STACK: %d \\n\",pop_stack_value(s));\n    printf(\"STACK: %s \\n\", pop_stack_name(s));\n</code></pre>\n\n<p>and in function <code>pop_stack_value()</code>, you are doing:</p>\n\n<pre><code>    stack_node * sn = s-&gt;top;\n    s-&gt;top = s-&gt;top-&gt;next;\n    free(sn);\n</code></pre>\n\n<p><code>s-&gt;top</code> is pointing to the <code>top</code> of stack and the <code>top</code> of stack is pointing back to node (as you did in <code>push_stack()</code>). The <code>free(sn)</code> will free the top of stack. Now in function <code>pop_stack_name()</code>, you are doing</p>\n\n<pre><code>    char * name = s-&gt;top-&gt;name;\n    stack_node * sn = s-&gt;top;\n    s-&gt;top = s-&gt;top-&gt;next;\n    s-&gt;size--;\n    free(sn);\n</code></pre>\n\n<p><code>s-&gt;top</code> is pointing to memory which has been already freed in <code>pop_stack_value()</code> and you are trying to access memory which your program doesn't own. This is undefined behavior.</p>\n\n<p>The way you are doing pop operation is completely wrong. In the pop operation of stack, you should pop the whole node instead of popping individual value of node. Once the node is popped, set the <code>top</code> of stack to point to the previous node. For that you need to traverse the whole list because you are using singly linked list. As an alternative, you can have doubly linked list in which every node is having its previous node address. With this resetting top of stack would not be an expensive operation.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533738060, "post_id": 51738777, "comment_id": 90457816, "body": "Thank you so much, David! You just blew my mind with all this info, it was exactly what I was looking for. I do have a few questions:  - how would I make the value input independent of the name input? - and how could I change the main function to get the name/value input from the user while the program is running instead of declaring name and/or value in my code?   ////  INPUT: value[0]: 34 name[0]: John // value[1]:21 name[1]:Jack // value[2]:99 name[2]: Jill ///// OUTPUT: value[0]:99 name[0]:Jill // value[1]:21 name[1]:Jack // value[3]: 34 name[3]: John"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533738960, "post_id": 51738777, "comment_id": 90458508, "body": "The program will ask for value[0], and only then ask for name[0]...repeating this process with value[1], name[1].. and so on, until the user enters the value zero, which ends the program. And all the input gets stored in the stack."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533774808, "post_id": 51738777, "comment_id": 90474123, "body": "@tylerdurden - to make the value independent of the name input, you would just use a temporary instance of your <code>struct_node</code>. After you create it, you are free to fill either <code>value</code> or <code>name</code> at your leisure. Either as part of <code>push</code> or in a separate function, just check that you have both <code>value</code> and <code>name</code> before pushing it onto the stack. You are also free to push with only a <code>value</code> or <code>name</code>, then on <code>pop</code> (or before use), you can check to see which value you have available -- completely up to you."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533775217, "post_id": 51738777, "comment_id": 90474193, "body": "@tylerdurden User input can be with either <code>fgets&#47;sscanf</code> (recommended) or simply with <code>scanf</code> (which has pitfalls for the new programmer). If your max input could be <code>128</code> chars, declare a buffer with <code>256</code> chars (don&#39;t skimp) and read a line of input from the user with <code>fgets</code> (e.g. <code>int v = 0; char buf[256] = &quot;&quot;, name[64] = &quot;&quot;;</code> ... <code>if (fgets (buf, sizeof buf, stdin)) { int rtn = sscanf (buf, &quot;%d %63[^\\n]&quot;, &amp;v, name); if (rtn == 2) { &#47;* fill both value&#47;name *&#47; } else if (rtn == 1) { &#47;* fill value * } else { &#47;* error: get next line *&#47; }</code> There are many variations."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533775513, "post_id": 51738777, "comment_id": 90474243, "body": "@tylerdurden - try and work that out. If you run into problems, I can add an input routine. If you think about it, you can just use your <code>else if</code> case to check if <code>v == 0</code> to end -- or add a beginning case to the <code>if</code> to check <code>if (rtn == EOF)</code> to end as well (you can also just check if <code>*buf</code> (e.g. <code>buf[0]</code>) is equal to <code>&#39;\\n&#39;</code> indicating the user just hit return on an empty line to end as well (many ways to skin that cat....)"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533780804, "post_id": 51738777, "comment_id": 90475263, "body": "I just edited my question. Right bellow the code you can see the way I&#39;m trying to store data. is it okay to use char name[64] = &quot;&quot; to push_stack(s,vs,name); like that since char name isn&#39;t a pointer? Also, what happens to the memory buf[256] and name[64] if I don&#39;t use it all?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533780952, "post_id": 51738777, "comment_id": 90475293, "body": "Sure, that&#39;s fine -- why? -- because an array is converted to a pointer to the first element on access (with a couple of exceptions not relevant here). So you are passing a pointer <code>:)</code>"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533780957, "post_id": 51738777, "comment_id": 90475295, "body": "I coded in such a way that it&#39;s only possible to push data to the stack once you have both value and name. Anyways, after the first name input and value input the program stops."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533781047, "post_id": 51738777, "comment_id": 90475318, "body": "Yes, that is the correct way to do it -- but you should be SHOT for not <b>validating the return</b> of <code>scanf</code> <code>:)</code>. I&#39;ll add an example for you to compare with."}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533781789, "post_id": 51738777, "comment_id": 90475443, "body": "I just fixed it. Now I get the error message saying my  scanf for the int value didn&#39;t work lol. I just don&#39;t get why.."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533781821, "post_id": 51738777, "comment_id": 90475448, "body": "Give me a second and I&#39;ll look at why. Duh... <code>char *str;</code> declares an <i>Uninitialized Pointer</i> that points to some indeterminate memory address where you do not have the ability to write to. <code>fgets(str,20,stdin);</code> invokes <i>Undefined Behavior</i> -- your dead!. Look at the constants I declare <code>MAXC, MAXNM</code> and how I use them to make sure I have valid storage to hold the input I take <code>:)</code>"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533783340, "post_id": 51738777, "comment_id": 90475700, "body": "I totally agree with you: user pressing Enter on an empty line rather than looking for a value == 0 is a much better way to end the program. I just didn&#39;t thought about that possibility...I&#39;ll internalize all the info above and then I&#39;ll try to change that."}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533783787, "post_id": 51738777, "comment_id": 90475768, "body": "I only have one last question: you said not to save on space when using MAXC and MAXNM, but what happens with the idle space that doesn&#39;t get used during/after the program runs? Does the free_node() and free_stack() solve that? I know my pc isn&#39;t gonna feel the difference, but I&#39;m always thinking on the possibility of this code running on a microcontroller, for exemple, that doesn&#39;t have a lot of spare memory."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533784856, "post_id": 51738777, "comment_id": 90475966, "body": "Recall, when <code>fgets</code> fills a buffer it <i>nul-terminates</i> the buffer making it a valid string (e.g. it places ASCII <code>&#39;\\0&#39;</code> (numeric <code>0</code>) as the final character). That is how string functions know when to stop reading (e.g. <code>strcpy</code>, etc...), they read until they encounter the <i>nul-terminating</i> character. To exit with <code>[Enter]</code> on an empty line, just test if the 1st character in the buffer filled by <code>fgets</code> is <code>&#39;\\n&#39;</code> (e.g. <code>fgets (buf, MAXC, stdin); if (*buf == &#39;\\n&#39;) { &#47;* empty-line, exit *&#47; }</code>. (<code>*buf</code> is the same as <code>*(buf + 0)</code> is the same as <code>buf[0]</code>)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533785097, "post_id": 51738777, "comment_id": 90476009, "body": "As far as the &quot;extra space&quot; in <code>buf</code>, etc.. -- it never enters the picture. Recall, in <code>push_stack</code> we size the memory for name with <code>malloc (strlen (name) + 1);</code>. It doesn&#39;t matter if the buffer you pass in as <code>name</code> has 1 million characters reserved or <code>len+1</code> chars reserved, the <code>strlen()</code> of the string in the buffer is the same (so don&#39;t skimp on input buffers <code>:)</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533785561, "post_id": 51738777, "comment_id": 90476102, "body": "Also note the basic &quot;stack space&quot; provided for your program (and each function) is between 1-4 Megabytes (generally). (<code>malloc&#39;ed</code> memory doesn&#39;t count against it), so if you use <code>1024</code> chars for <code>buf</code>, its 1% or less. Your PC doesn&#39;t care at all. The only time your computer would care is if your automatic storage variable exceeds the stack space (then you have StackOverflow). You will generally only get there declaring large 2D arrays on the stack (e.g. <code>int arr[1024][1024];</code> would do it with a 1M stack)"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1533786201, "post_id": 51738777, "comment_id": 90476215, "body": "Got it !! Thanks!"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1533781587, "last_edit_date": 1533781587, "creation_date": 1533703509, "answer_id": 51738777, "question_id": 51734982, "link": "https://stackoverflow.com/questions/51734982/stacks-with-strings-and-integers-c/51738777#51738777", "title": "stacks with strings and integers - C", "body": "<p>Well.. It's obvious you have put effort into your code, but it is also obvious you are still struggling to wrap your head around storing a struct as a node within the stack (and with basic string handling issues).</p>\n\n<p>First, there is no need to cast the return of malloc, see See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a>. Next, always size your allocation for an object based on the <em>derefernced pointer</em> to the object. For example <code>stack *s</code> declares <code>s</code> as a pointer to type <code>stack</code>. If <code>s</code> is a <em>pointer to</em> <code>stack</code>, then <code>*s</code> is type <code>stack</code>. Sizing your allocations with the actual pointer itself with eliminate any chance of an incorrect size. Further, it is your responsibility to <strong>validate</strong> every allocation by checking the return is not <code>NULL</code>. With that, your <code>create_stack()</code> could be: </p>\n\n<pre><code>stack *create_stack()\n{\n    stack *s = malloc (sizeof *s);  /* size from dereferenced pointer */\n    if (!s) {                       /* validate every allocation */\n        perror (\"malloc-s\");\n        return NULL;\n    }\n\n    s-&gt;size = 0;\n    s-&gt;top = NULL;\n\n    return s;\n}\n</code></pre>\n\n<p>Your <code>empty_stack</code> is unused, but otherwise OK.</p>\n\n<p>Your <code>push_stack</code> function is where a number of problems lie. First you cannot allocate for the node and the string at the same time! (even if you could, you would be one-byte too small as you have forgotten space for the <em>nul-terminating</em> character at the end of the string). You declare:</p>\n\n<pre><code>struct stack_node{\n    int value;\n    char *name;\n    struct stack_node * next;\n};\n</code></pre>\n\n<p>You must allocate first for your node, <em>then</em> allocate storage for your pointer <code>name</code> -- remembering to <strong>validate</strong> the allocation as done in <code>create_stack()</code>, e.g.</p>\n\n<pre><code>    stack_node *n = malloc (sizeof *n); /* allocate node only */\n    if (!n) {                           /* validate every allocation */\n        perror (\"malloc-n\");\n        return NULL;\n    }\n\n    n-&gt;value = value;\n    n-&gt;name = malloc (strlen (name) + 1);   /* allocate strlen + 1 chars */\n    if (!n-&gt;name) {                         /* validate! */\n        perror (\"malloc-name\");\n        return NULL;\n    }\n</code></pre>\n\n<p>Next, you <em>cannot</em> assign strings in C (aside from initialization of a pointer to point to a <em>string-literal</em>, e.g. <code>char *name = \"foo\";</code>) In C, you must copy your string to the valid storage your create for <code>n-&gt;name</code>. For example:</p>\n\n<pre><code>    strcpy (n-&gt;name, name);     /* you cannot assign strings, use strcpy */\n</code></pre>\n\n<p>Further, how are you going to indicate to the caller, whether your allocations succeeded or failed if you declare <code>push_stack</code> as type <code>void</code>??</p>\n\n<p>Always select a return type that can indicate success/failure where required. With that in mind, you can simply return a pointer to the new node (which is convenient for immediate use anyway), or return <code>NULL</code> on failure, e.g.</p>\n\n<pre><code>/* choose return type that can indicate success/failure */\nstack_node *push_stack (stack *s, int value, const char *name)\n{\n    stack_node *n = malloc (sizeof *n); /* allocate node only */\n    if (!n) {                           /* validate every allocation */\n        perror (\"malloc-n\");\n        return NULL;\n    }\n\n    n-&gt;value = value;\n    n-&gt;name = malloc (strlen (name) + 1);   /* allocate strlen + 1 chars */\n    if (!n-&gt;name) {                         /* validate! */\n        perror (\"malloc-name\");\n        return NULL;\n    }\n    strcpy (n-&gt;name, name);     /* you cannot assign strings, use strcpy */\n    n-&gt;next = s-&gt;top;\n    s-&gt;top = n;\n    s-&gt;size++;\n\n    return n;\n}\n</code></pre>\n\n<p>You do not want two-separate <code>pop</code> function. Instead of <code>pop_stack_value</code> and <code>pop_stack_name</code>, you simply want a <code>pop_stack</code> that returns a pointer to the top node. You can then access either the value or name (e.g. <code>node-&gt;value</code> or <code>node-&gt;name</code>) as required.</p>\n\n<p>It also makes sense to declare a couple of simple helper functions to free the memory allocated when it is no longer needed. You are dealing with nodes and the stack, so a <code>free_node</code> helper and a <code>free_stack</code> helper make sense. (and remember, you may want to free the stack before it is empty, so code the <code>free_stack</code> accordingly), e.g.</p>\n\n<pre><code>void free_node (stack_node *n)  /* free node helper function */\n{\n    if (n-&gt;name)\n        free (n-&gt;name);\n\n    free (n);\n}\n\nvoid free_stack (stack *s)      /* free stack helper (need not be empty) */\n{\n    while (s-&gt;size &gt; 0) {\n        stack_node *victim = s-&gt;top;\n        s-&gt;top = s-&gt;top-&gt;next;\n        free_node (victim);\n        s-&gt;size--;\n    }\n\n    free (s);\n}\n</code></pre>\n\n<p>Putting all the pieces together in a short example, you could do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct stack_node{\n    int value;\n    char *name;\n    struct stack_node * next;\n};\ntypedef struct stack_node stack_node;\n\nstruct stack{\n    stack_node *top;\n    int size;\n};\ntypedef struct stack stack;\n\nstack *create_stack()\n{\n    stack *s = malloc (sizeof *s);  /* size from dereferenced pointer */\n    if (!s) {                       /* validate every allocation */\n        perror (\"malloc-s\");\n        return NULL;\n    }\n\n    s-&gt;size = 0;\n    s-&gt;top = NULL;\n\n    return s;\n}\n\nint empty_stack (stack * s) {       /* s-&gt;size is type 'int' */\n    return s-&gt;size == 0;\n}\n\n/* choose return type that can indicate success/failure */\nstack_node *push_stack (stack *s, int value, const char *name)\n{\n    stack_node *n = malloc (sizeof *n); /* allocate node only */\n    if (!n) {                           /* validate every allocation */\n        perror (\"malloc-n\");\n        return NULL;\n    }\n\n    n-&gt;value = value;\n    n-&gt;name = malloc (strlen (name) + 1);   /* allocate strlen + 1 chars */\n    if (!n-&gt;name) {                         /* validate! */\n        perror (\"malloc-name\");\n        return NULL;\n    }\n    strcpy (n-&gt;name, name);     /* you cannot assign strings, use strcpy */\n    n-&gt;next = s-&gt;top;\n    s-&gt;top = n;\n    s-&gt;size++;\n\n    return n;\n}\n\nstack_node *pop_stack (stack *s)    /* return the node on pop */\n{\n    if (s-&gt;size &gt; 0) {\n        stack_node *node = s-&gt;top;\n        s-&gt;top = s-&gt;top-&gt;next;\n        s-&gt;size--;\n        return node;    /* caller is responsible for freeing node */\n    }\n\n    return NULL;\n}\n\nvoid free_node (stack_node *n)  /* free node helper function */\n{\n    if (n-&gt;name)\n        free (n-&gt;name);\n\n    free (n);\n}\n\nvoid free_stack (stack *s)      /* free stack helper (need not be empty) */\n{\n    while (s-&gt;size &gt; 0) {\n        stack_node *victim = s-&gt;top;\n        s-&gt;top = s-&gt;top-&gt;next;\n        free_node (victim);\n        s-&gt;size--;\n    }\n\n    free (s);\n}\n\nint main (void) {\n\n    const char *str[] = { \"john\", \"jack\", \"jill\", \"sally\", \"sue\" };\n    int n = sizeof str/sizeof *str;\n    stack *s = create_stack();\n    stack_node *node = NULL;\n\n    if (!s)         /* validate !!! */\n        return 1;\n\n    for (int i = 0; i &lt; n; i++)\n        if (push_stack (s, i+1, str[i]) == NULL) {\n            fprintf (stderr, \"error: push node failed '%d'.\\n\", i);\n            return 1;\n        }\n\n    while ((node = pop_stack(s)) != NULL) {\n        printf (\"value:  %2d    name: %s\\n\", node-&gt;value, node-&gt;name);\n        free_node (node);   /* free node */\n    }\n    free_stack (s);     /* free stack */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/stack_struct\nvalue:   5    name: sue\nvalue:   4    name: sally\nvalue:   3    name: jill\nvalue:   2    name: jack\nvalue:   1    name: john\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/stack_struct\n==4204== Memcheck, a memory error detector\n==4204== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==4204== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==4204== Command: ./bin/stack_struct\n==4204==\nvalue:   5    name: sue\nvalue:   4    name: sally\nvalue:   3    name: jill\nvalue:   2    name: jack\nvalue:   1    name: john\n==4204==\n==4204== HEAP SUMMARY:\n==4204==     in use at exit: 0 bytes in 0 blocks\n==4204==   total heap usage: 11 allocs, 11 frees, 161 bytes allocated\n==4204==\n==4204== All heap blocks were freed -- no leaks are possible\n==4204==\n==4204== For counts of detected and suppressed errors, rerun with: -v\n==4204== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Finally, to avoid most of these problems to begin with, always compile with <em>warnings enabled</em>, and <strong>do not</strong> accept code until it <em>compiles cleanly without warning</em>. To enable warnings add <code>-Wall -Wextra</code> to your <code>gcc</code> or <code>clang</code> compile string. (add <code>-pedantic</code> for several additional warnings). For <code>clang</code>, instead you can use <code>-Weverything</code>. For <strong>VS</strong> (<code>cl.exe</code> on windoze), add <code>/W3</code> (or use <code>/Wall</code> but you will get quite a few extraneous windows non-code related warnings). Read and understand each warning. They will identify any problems, and the exact line on which they occur. </p>\n\n<p>You can learn as much about coding by simply listening to what your compiler is telling you as you can from most tutorials.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n\n<hr>\n\n<p><strong>Taking <code>value</code> Input, then <code>name</code></strong></p>\n\n<p>When you take user input, consider using <code>fgets</code> for reading both the name and value (and then use <code>sscanf</code> (or <code>strtol</code>) to convert to <code>int</code>). You avoid many pitfalls with <code>scanf</code> and failure to empty <code>stdin</code> after a <em>matching failure</em> (which will generally lead to an infinite loop as well as <em>Undefined Behavior</em>)</p>\n\n<p>You purposely want to loop continually until you validate your have the input you ask for -- and that it meets your requirements (range, etc...). You also must protect against the user canceling input by generating a manual <code>EOF</code> (e.g. <kbd>Ctrl+d</kbd> on Linux or <kbd>Ctrl+z</kbd> on windoze, but see: <a href=\"http://proc-x.com/2017/06/ctrlz-does-not-generate-eof-in-windows-10/\" rel=\"nofollow noreferrer\">CTRL+Z does not generate EOF in Windows 10</a>)</p>\n\n<pre><code>/* if you need constants, #define one (or more), or use a global enum */\n#define MAXC    1024    /* max chars for input buffer (don't skimp) */\n#define MAXNM     64    /* max length for name buffer (ditto) */\n...\nint main (void) {\n\n    stack *s = create_stack();\n    stack_node *node = NULL;\n\n    if (!s)         /* validate !!! */\n        return 1;\n\n    for (;;) {      /* loop continually taking input until exit conditon */\n        char buf[MAXC]  = \"\",   /* line buffer for fgets */\n            name[MAXNM] = \"\";   /* buffer for parsing name from line */\n        int value = 0;          /* int to parse from line */\n\n        for (;;) {  /* loop continually until you get valid int */\n            fputs (\"\\nenter value: \", stdout);  /* prompt for value */\n            if (fgets (buf, MAXC, stdin)) {     /* validate line read */\n                if (sscanf (buf, \"%d\", &amp;value) == 1) { /* convert to int */\n                    if (value == 0) {   /* your exit condition */\n                        fputs (\"  value == 0 (input done)\\n\", stderr );\n                        goto inputdone; /* jump out of both loops */\n                    }\n                    break;\n                }\n                else    /* non-integer (non-numeric) input */\n                    fputs (\"  error: invalid integer input.\\n\", stderr);\n            }\n            else {  /* fgets returned EOF (user canceled) */\n                fputs (\"(user canceled input)\\n\", stderr);\n                goto inputdone; /* jump out of both loops */\n            }\n        }\n\n        for (;;) {      /* loop continually until name recieved */\n            fputs (\"enter name : \", stdout);        /* prompt name */\n            if (fgets (name, MAXNM, stdin)) {       /* read name */\n                size_t len = strlen (name);         /* get length */\n                if (len &amp;&amp; name[len-1] == '\\n') {   /* last char \\n ? */\n                    name[--len] = 0;                /* overwrite with \\0 */\n                    if (len)                    /* check 1 char remains */\n                        break;                  /* got good name, go push */\n                    else    /* user just pressed [Enter] */\n                        fputs (\"  error: empty-line.\\n\", stderr);\n                }\n                else if (len == MAXNM -1)   /* was input too long? */\n                    fputs (\"  warning: name truncated.\\n\", stderr);\n            }\n            else {  /* fgets returned EOF (user canceled) */\n                fputs (\"(user canceled input)\\n\", stderr);\n                goto inputdone; /* jump out of both loops */\n            }\n        }\n\n        push_stack (s, value, name);    /* push value and name on stack */\n    }\n    inputdone:;\n\n    puts (\"\\nvalues stored in stack\\n\");\n    while ((node = pop_stack(s)) != NULL) {\n        printf (\"value:  %2d    name: %s\\n\", node-&gt;value, node-&gt;name);\n        free_node (node);   /* free node */\n    }\n    free_stack (s);     /* free stack */\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> it would probably be better to end input when the user presses <kbd>Enter</kbd> on an empty line rather than looking for a <code>value == 0</code> (because an <code>int</code> can be zero))</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/stack_struct_input_simple\n\nenter value: 1\nenter name : Frank Zappa\n\nenter value: 2\nenter name :\nerror: empty-line.\nenter name : Jimmy Buffet\n\nenter value: 3\nenter name : Grahm Nash\n\nenter value: 4\nenter name : John Bonham\n\nenter value: 0\nvalue == 0 (input done)\n\nvalues stored in stack\n\nvalue:   4    name: John Bonham\nvalue:   3    name: Grahm Nash\nvalue:   2    name: Jimmy Buffet\nvalue:   1    name: Frank Zappa\n</code></pre>\n\n<p>See if you can go though the input routine above and understand why it is written the way it is. (I also have one that will accept both <code>value name</code> or <code>value</code> then <code>name</code>) You can be as flexible as you want with input as long as you follow the rules and <strong>validate</strong> everything, protect against a manual <code>EOF</code> and always know what remains in your input buffer (e.g. <code>stdin</code>).</p>\n"}], "owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 51738777, "answer_count": 3, "score": 1, "last_activity_date": 1533781587, "creation_date": 1533673975, "last_edit_date": 1533780385, "question_id": 51734982, "link": "https://stackoverflow.com/questions/51734982/stacks-with-strings-and-integers-c", "title": "stacks with strings and integers - C", "body": "<p>[3rd update]<br>\nI made some changes to David's code. I changed: <code>n-&gt;next = s-&gt;top;s-&gt;top = n;</code> to <code>n-&gt;next = NULL;s-&gt;top = n;</code> like H.S. suggested; and also added different features to the main function. I'm trying to get the char name and int value as input from the user while the program is running. The program should keep taking data from the user, storing it in the stack and allocating memory accordingly. The program only ends when the user types 'end' (char) or 0 (int). The code gets compiled, but that's it, after that, any input and the program stops. Also, am I wasting memory using <code>fgets(str,20,stdin)</code>? What if I don't use all that size. Any feedback is very much appreciated! </p>\n\n<pre><code>///PROGRAM STRUCTURE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct stack_node{\n    int value;\n    char *name;\n    struct stack_node * next;\n};\ntypedef struct stack_node stack_node;\n\nstruct stack{\n    stack_node *top;\n    int size;\n};\ntypedef struct stack stack;\n\nstack *create_stack()\n{\n    stack *s = malloc (sizeof *s);\n    if (!s) {\n        perror (\"malloc-s\");\n        return NULL;\n    }\n\n    s-&gt;size = 0;\n    s-&gt;top = NULL;\n\n    return s;\n}\n\nint empty_stack (stack * s) {\n    return s-&gt;size == 0;\n}\n\n\nstack_node *push_stack (stack *s, int value, char *name) /// ****\n{\n    stack_node *n = malloc (sizeof *n);\n    if (!n) {\n        perror (\"malloc-n\");\n        return NULL;\n    }\n\n    n-&gt;value = value;\n    n-&gt;name = malloc (strlen (name) + 1);\n    if (!n-&gt;name) {\n        perror (\"malloc-name\");\n        return NULL;\n    }\n    strcpy (n-&gt;name, name);\n    n-&gt;next = NULL; /// ****\n    s-&gt;top = n;\n    s-&gt;size++;\n\n    return n;\n}\n\nstack_node *pop_stack (stack *s)\n{\n    if (s-&gt;size &gt; 0) {\n        stack_node *node = s-&gt;top;\n        s-&gt;top = s-&gt;top-&gt;next;\n        s-&gt;size--;\n        return node;\n    }\n\n    return NULL;\n}\n\nvoid free_node (stack_node *n)\n{\n    if (n-&gt;name)\n        free (n-&gt;name);\n\n    free (n);\n}\n\nvoid free_stack (stack *s)\n{\n    while (s-&gt;size &gt; 0) {\n        stack_node *victim = s-&gt;top;\n        s-&gt;top = s-&gt;top-&gt;next;\n        free_node (victim);\n        s-&gt;size--;\n    }\n\n    free (s);\n}\n\nint main (void) {\n\n    stack *s = create_stack();\n    stack_node *node = NULL;\n\n    char *str; ///NAME\n    int vs; ///VALUE\n    int i=0;\n\n    if (!s)\n        return 1;\n\n    do{\n        printf(\"NAME{%d]: \",i);\n        fgets(str,20,stdin); ///***?\n        printf(\"VALUE[%d]: \",i);\n        scanf(\" %d\",&amp;vs);\n        if (push_stack (s, vs, str) == NULL) {\n            fprintf (stderr, \"error: push node failed '%d'.\\n\", i);\n            return 1;\n        }\n        i++;\n    }while(str != 'end' || vs != 0);\n   i=0;\n\n    while ((node = pop_stack(s)) != NULL) {\n        printf (\"value[%d]:  %d    name[%d]: %s\\n\", i,node-&gt;value, i,node-&gt;name);\n        i++;\n        free_node (node);\n    }\n    free_stack (s);\n\n    return 0;\n}\n\n///**********\n    do{\n        printf(\"NAME[%d]: \",i);\n\n        if(fgets(buf,sizeof buf,stdin)){\n        int rtn = sscanf (buf, \"%63[^\\n]\", name);\n        if(rtn == 1){\n            printf(\"VALUE[%d]: \",i);\n            scanf(\" %d\",&amp;vs);\n\n        }\n        }\n        push_stack(s,vs,name);\n        if (s == NULL) {\n            fprintf (stderr, \"error: push node failed '%d'.\\n\", i);\n            return 1;\n        }\n        i++;\n    }while(node-&gt;name != \"end\" || node-&gt;value != 0);\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 1, "creation_date": 1533673588, "post_id": 51734845, "comment_id": 90430550, "body": "If you want to be able to support this kind of operation I suggest using a linked list. It will give you <code>O(1)</code> insertion at the head. As far as I know what you want to do isn&#39;t possible, array sizes are mostly fixed in C. You would need to make a new array"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1533673590, "post_id": 51734845, "comment_id": 90430551, "body": "sounds like you might want the function <code>memmove</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1533673946, "post_id": 51734845, "comment_id": 90430731, "body": "...or implement a circular buffer. No simple magic here."}, {"owner": {"reputation": 91, "user_id": 6562257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EoBqI.jpg?s=128&g=1", "display_name": "harmony", "link": "https://stackoverflow.com/users/6562257/harmony"}, "edited": false, "score": 0, "creation_date": 1533675768, "post_id": 51734845, "comment_id": 90431493, "body": "Isn&#39;t memmove for strings? Does it work for numeric values as well?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1533677183, "post_id": 51734845, "comment_id": 90432063, "body": "<code>memmove</code> is not limited to strings. It works for numeric values. You just need to multiply the number of elements by the size of each element. With strings the size of each element is 1 by definition. But with an array of <code>int</code>, you would use <code>sizeof(int)</code> to get the size."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533719411, "post_id": 51734845, "comment_id": 90445568, "body": "Could you explain a bit more why &quot;obviously pr[i] = pr[i-1] won&#39;t work&quot;? This should work fine. It just depends on the direction of your loop. You array does not grow but only the content moves."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1533719564, "post_id": 51734845, "comment_id": 90445642, "body": "@Mitchel0022 the expected output is not larger than the input array. Now growing is requested."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533719634, "post_id": 51734845, "comment_id": 90445683, "body": "@harmony Functions for string handling start with <code>str...</code>. The <code>mem...</code> functions are explicitely not limited to string."}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533758680, "post_id": 51734845, "comment_id": 90469170, "body": "@Gerhardh you are right but if he used a linked list the operation would be <code>O(1)</code> rather than <code>O(N)</code>, especially if he had a circular list where he could just move the &quot;start&quot; pointer. For small arrays shifting would be fine"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1533760798, "post_id": 51734845, "comment_id": 90470268, "body": "@Mitchel0022 without knowing the R application and the interface to C it is rather hard to tell if a linked list makes thing better or worse or maybe is not possible at all."}], "answers": [{"comments": [{"owner": {"reputation": 689, "user_id": 4678048, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d4cab92f164433dabd22844a55590f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jouster500", "link": "https://stackoverflow.com/users/4678048/jouster500"}, "edited": false, "score": 3, "creation_date": 1533674204, "post_id": 51734978, "comment_id": 90430848, "body": "The person in the OP could also additionally redesign how they store the data, by reversing how they add to the list. In other words, instead of appending 1 to the front of the array, they could append it to the end so the data can read as <code>5, 4, 3, 2, 1, 1, 0, 0, 0, 0</code>, although whether that&#39;s feasible or worth their time is another matter."}, {"owner": {"reputation": 2379, "user_id": 3696798, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ab86feaa934235389b714b491e8ef441?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/3696798/simon"}, "reply_to_user": {"reputation": 689, "user_id": 4678048, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d4cab92f164433dabd22844a55590f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jouster500", "link": "https://stackoverflow.com/users/4678048/jouster500"}, "edited": false, "score": 0, "creation_date": 1533674426, "post_id": 51734978, "comment_id": 90430951, "body": "Smart, however there is little context so if OP has a &#39;bigger problem&#39; than this very specific one he should have asked a different question."}], "tags": [], "owner": {"reputation": 2379, "user_id": 3696798, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ab86feaa934235389b714b491e8ef441?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/3696798/simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1533674474, "last_edit_date": 1533674474, "creation_date": 1533673954, "answer_id": 51734978, "question_id": 51734845, "link": "https://stackoverflow.com/questions/51734845/c-pointer-to-array-how-to-copy-just-the-value-not-address-of-one-pointer-to/51734978#51734978", "title": "C - pointer to array: how to copy just the value (not address) of one pointer to another?", "body": "<p>You basically want to prepend a value, in your example <code>1</code>, and remove the last value from the array, in your example a <code>0</code>.</p>\n\n<p>If you take a look at what happens you will see the following:</p>\n\n<pre><code>position:    0  1  2  3  4  5  6\nstarting: { a0 a1 a2 a3 a4 a5 a6 }\n              \\  \\  \\  \\  \\  \\\nfinal:    { b0 a0 a1 a2 a3 a4 a5 }\n</code></pre>\n\n<p>So you want to do as you proposed shifting each value, but you have to start at the end (or you will overwrite everything with the same value).</p>\n\n<pre><code>for(i = 9; i &gt; 0; i--) {\n    pr[i]=pr[i-1];\n}\npr[0] = NEWVALUE;\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6562257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EoBqI.jpg?s=128&g=1", "display_name": "harmony", "link": "https://stackoverflow.com/users/6562257/harmony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533717639, "creation_date": 1533673433, "last_edit_date": 1533717639, "question_id": 51734845, "link": "https://stackoverflow.com/questions/51734845/c-pointer-to-array-how-to-copy-just-the-value-not-address-of-one-pointer-to", "title": "C - pointer to array: how to copy just the value (not address) of one pointer to another?", "body": "<p>If a pointer <code>pr</code> points to an array <code>aa = {1, 2, 3, 4, 5, 0, 0, 0, 0, 0}</code>, then we can access the array through the pointer <code>pr[0]</code>, <code>pr[1]</code>, <code>pr[2]</code>,....<br>\nHow can I shift the array (operated through the pointer) such that I can get<code>{1, 1, 2, 3, 4, 5, 0, 0, 0, 0}</code>? obviously <code>pr[i] = pr[i-1]</code> won't work. </p>\n\n<hr>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int aa[10] = {1, 2, 3, 4, 5, 0, 0, 0, 0, 0};\n    int i, m, *pr = aa;\n    printf(\"\\n pr[0] = %d, pr[1] = %d, pr[2] = %d, pr[3] = %d\", pr[0], pr[1], pr[2], pr[3]);\n\n    for(i = 0; i &lt; 9; i++) {\n        m = *(pr + i);\n        pr[i+1] = m;\n    }\n\n    printf(\"\\n \\n pr[0] = %d, pr[1] = %d, pr[2] = %d, pr[3] = %d \\n\", pr[0], pr[1], pr[2], pr[3]);\n    printf(\"\\n \\n aa[0] = %d, aa[1] = %d, aa[2] = %d, aa[3] = %d \\n\", aa[0], aa[1], aa[2], aa[3]);\n    return(1);\n}\n</code></pre>\n\n<p>I am writing a C function for R using <code>.Call</code>, all the arrays in the C function have to be accessed through this type of the pointers. And I am very confused by the grammar of pointers in C.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 3, "creation_date": 1533672590, "post_id": 51734664, "comment_id": 90430119, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1533672693, "post_id": 51734664, "comment_id": 90430163, "body": "If you want to read back what you wrote to file, you must use <code>rewind</code> or <code>fseek</code> before reading, and then, control the loop with the result of <code>fgets</code>, such as <code>while(fgets(...) != NULL) { ... }</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1533672859, "post_id": 51734664, "comment_id": 90430239, "body": "After you&#39;ve written, the file pointer is positioned at the EOF.  To read what you wrote, you must rewind the file \u2014 <code>rewind()</code> or <code>fseek()</code> or one of their relatives.  Some file positioning operation is required every time you switch between reading and writing or between writing and reading \u2014 even if it is a no-op <code>fseek(fp, 0, SEEK_CUR)</code>."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1533674672, "post_id": 51734664, "comment_id": 90431056, "body": "@cleblanc Why doesn&#39;t this terminate then?  Does EOF not get set (after the fact) for &#39;w+&#39; files?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 2, "creation_date": 1533677708, "post_id": 51734664, "comment_id": 90432248, "body": "@cleblanc that link is relevant but it is not a duplicate. (The main problem is reading after writing without a seek)"}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1533677402, "creation_date": 1533677402, "answer_id": 51735699, "question_id": 51734664, "link": "https://stackoverflow.com/questions/51734664/c-using-the-w-mode-when-creating-a-file/51735699#51735699", "title": "C - using the &quot;w+&quot; mode when creating a file", "body": "<p>You are violating <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.5.3p7\" rel=\"nofollow noreferrer\"><strong>7.21.5.3 The fopen function</strong>, paragraph 7</a> of the C standard:</p>\n\n<blockquote>\n  <p>When a file is opened with update mode ('+' as the second or third\n  character in the above list of mode argument values), both input and\n  output may be performed on the associated stream. However, output\n  shall not be directly followed by input without an intervening call to\n  the fflush function or to a file positioning function (fseek, fsetpos,\n  or rewind), and input shall not be directly followed by output without\n  an intervening call to a file positioning function, unless the input\n  operation encounters end- of-file.</p>\n</blockquote>\n\n<p>This likely explains why the <code>while (!feof(fPointer))</code> loop does not terminate.  As incorrect as your usage is there, it does normally terminate.  By ignoring the return value from <code>fgets()</code> (among all the other return values ignored) you are likely missing an error being returned.</p>\n\n<p>Since you have not provided any details regarding your implementation, it's impossible for an outside observer to know for sure.</p>\n"}], "owner": {"reputation": 1, "user_id": 10193926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30d7981e31d6ccb16ee14775c2f16b3?s=128&d=identicon&r=PG&f=1", "display_name": "1Disciple", "link": "https://stackoverflow.com/users/10193926/1disciple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533677402, "creation_date": 1533672548, "question_id": 51734664, "link": "https://stackoverflow.com/questions/51734664/c-using-the-w-mode-when-creating-a-file", "title": "C - using the &quot;w+&quot; mode when creating a file", "body": "<p>I'm trying to create a file, write in it, then read it and print out what was read. I'm trying to use the w+ mode but the output gives infinite lines of null. What am I doing wrong?</p>\n\n<pre><code> int main() {\n    FILE *fPointer;\n    char line[10];\n\n    fPointer = fopen(\"newFile.txt\",\"w+\");\n    fprintf(fPointer, \"Hello\\nWorld\\n!\");\n\n    while (!feof(fPointer)) {\n        fgets(line, 10, fPointer);\n        puts(line); \n    }\n\n    fclose(fPointer);\n\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "pointers", "types", "variable-assignment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1533672236, "post_id": 51734557, "comment_id": 90429933, "body": "<code>duration</code> is a function and cannot be assigned a value. Why would you even try to do that?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1533672430, "post_id": 51734557, "comment_id": 90430024, "body": "@EugeneSh. Is <code>duration</code> even a function?  It looks like it was given a prototype as if it were a function... inside main."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1533672485, "post_id": 51734557, "comment_id": 90430052, "body": "@ChristianGibbons A wannabe function :)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1533672565, "post_id": 51734557, "comment_id": 90430099, "body": "FYI, <code>&amp;fraction[0]</code> is the same as just <code>fraction</code>. And <code>&amp;fraction[-1]</code> is <code>fraction-1</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1533672665, "post_id": 51734557, "comment_id": 90430149, "body": "What is this program supposed to do? Your <code>x</code> and <code>y</code> assignments seem suspicious to me."}, {"owner": {"reputation": 63, "user_id": 9876053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHY1G.jpg?s=128&g=1", "display_name": "Ludlow_Luddite", "link": "https://stackoverflow.com/users/9876053/ludlow-luddite"}, "edited": false, "score": 0, "creation_date": 1533672686, "post_id": 51734557, "comment_id": 90430157, "body": "@ Eugene.  I would &quot;try to do that&quot; in order to solve a problem.  Furthermore, I am assigning a formula to duration not a value.  Unfortunately your comment is not very helpful."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1533672765, "post_id": 51734557, "comment_id": 90430195, "body": "You assign a formula to a function name by writing a function definition, not an assignment."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1533672816, "post_id": 51734557, "comment_id": 90430216, "body": "Like <code>function add(int x, int y) { return x + y; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9876053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHY1G.jpg?s=128&g=1", "display_name": "Ludlow_Luddite", "link": "https://stackoverflow.com/users/9876053/ludlow-luddite"}, "edited": false, "score": 0, "creation_date": 1533673027, "post_id": 51734667, "comment_id": 90430311, "body": "Actually, I do want duration to be a function.  I guess I just don&#39;t understand the appropriate syntax.  if I replaced &quot;duration,&quot; with &quot;return,&quot; ??                                                     return  x * (8 / y)"}, {"owner": {"reputation": 63, "user_id": 9876053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHY1G.jpg?s=128&g=1", "display_name": "Ludlow_Luddite", "link": "https://stackoverflow.com/users/9876053/ludlow-luddite"}, "edited": false, "score": 0, "creation_date": 1533675389, "post_id": 51734667, "comment_id": 90431353, "body": "Thanks John Bode!  I was able to work this out with your help.  Best L_L"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 2, "last_activity_date": 1533739224, "last_edit_date": 1533739224, "creation_date": 1533672569, "answer_id": 51734667, "question_id": 51734557, "link": "https://stackoverflow.com/questions/51734557/data-type-issue-renders-value-to-not-be-assignable-possible-pointer-issue/51734667#51734667", "title": "Data type issue renders value to not be &quot;assignable.&quot; Possible pointer issue?", "body": "<p>You've declared <code>duration</code> to be a <em>function</em> that takes a <code>string</code> (<code>char *</code>) argument and returns an <code>int</code>:</p>\n\n<pre><code>int duration(string fraction);\n</code></pre>\n\n<p>Function expressions are indeed not assignable - a function cannot be the target of the <code>=</code> operator, hence the error on </p>\n\n<pre><code>duration = x * (8 / y);\n</code></pre>\n\n<p>If you want <code>duration</code> to simply be an integer variable, declare it as</p>\n\n<pre><code>int duration;\n</code></pre>\n\n<p>&lt;gratuitous rant&gt;</p>\n\n<p>The <code>string</code> typedef in the <code>cs50.h</code> header is a <em>mistake</em>, and it <em>will</em> lead you astray when thinking about string operations in C.  It makes string operations in C look more high-level than they really are.  </p>\n\n<p>A <em>string</em> in C is a sequence of character values followed by a 0-valued terminator.  Strings are stored in arrays of <code>char</code>.  Under most circumstances, an expression of type \"array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", so when we're dealing with strings we're usually dealing with <em>expressions</em> of type <code>char *</code>, but a <code>char *</code> is <em>not a string</em>.  A <code>char *</code> <em>may</em> point to the first character in a string, or it may point to the first character in a sequence that isn't a string, or it may point to a single character that isn't part of a larger sequence.  </p>\n\n<p>C string operations are <em>extremely</em> low level.  The <code>string</code> typedef is obviously an attempt to abstract away some of that, but it's a weak, leaky abstraction at best, and an active hinderance to learning proper string processing techniques in C at worst.  Be <em>really</em> careful when using it.  </p>\n\n<p>&lt;/gratuitous rant&gt; </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Then it looks like what you want to do is something like this:</p>\n\n<pre><code>/**\n * Define the duration function to compute x * 8/y\n */\nint duration( char *frac )\n{\n  int x = atoi( frac );\n  int y = atoi( frac - 1 );\n\n  return x * (8 / y);\n}\n\nint main( int argc, char **argv )\n{\n  // yadda yadda yadda\n\n    char *fraction = note + strlen(note) - 3;\n    printf(\"(%.3s)\\n\", fraction);\n\n    printf(\"%i\\n\", duration( fraction ) ); // call duration with\n                                           // fraction as an argument\n  // yadda yadda yadda\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9876053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHY1G.jpg?s=128&g=1", "display_name": "Ludlow_Luddite", "link": "https://stackoverflow.com/users/9876053/ludlow-luddite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 51734667, "answer_count": 1, "score": -1, "last_activity_date": 1533739224, "creation_date": 1533672040, "last_edit_date": 1533672255, "question_id": 51734557, "link": "https://stackoverflow.com/questions/51734557/data-type-issue-renders-value-to-not-be-assignable-possible-pointer-issue", "title": "Data type issue renders value to not be &quot;assignable.&quot; Possible pointer issue?", "body": "<p>I can't waste another day on this confounded error.  Can you please help?  Here is the code.  Some details might be astray, however, I cant compile until this error is resolved.</p>\n\n<pre><code>int main(int argc, string argv[])\n{\n    string note = argv[1];\n\n    int frequency(string note);\n    int duration(string fraction);\n\n    if (argc == 2)\n    {\n       // create new string with last 3 chars in string note\n\n        string fraction = note + strlen(note) - 3;\n        printf(\"(%.3s)\\n\", fraction);\n\n        // transform char into integer.. poof!\n\n        int x = atoi(&amp;fraction[0]);\n        int y = atoi(&amp;fraction[-1]);\n\n       // calculate integer from x &amp; y values\n\n        duration = x * (8 / y);\n        printf(\"%i\\n\", duration);\n\n\n    }\n    else\n    {\n        printf(\"Two (2) arguments!\\n\");\n        return 1;\n    }\n\n\n}\n</code></pre>\n\n<p>AND THE ERROR MESSAGEs..</p>\n\n<pre><code>duration.c:61:18: error: non-object type 'int (string)' (aka 'int (char *)') is not assignable\n        duration = x * (8 / y);\n\n        ~~~~~~~~ ^\nduration.c:62:24: error: format specifies type 'int' but the argument has type 'int (*)(string)' (aka 'int (*)(char *)') [-Werror,-Wformat]\n        printf(\"%i\\n\", duration);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1533671135, "post_id": 51734361, "comment_id": 90429409, "body": "You need to move <code>scanf</code> inside a loop."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1533671847, "post_id": 51734361, "comment_id": 90429738, "body": "@FiddlingBits It&#39;s a start, but then <code>num</code> is used for comparison while uninitialized.  Gotta make it a <code>do-while-loop</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1533674046, "post_id": 51734361, "comment_id": 90430776, "body": "Also, <code>sum +=num</code> is a problem since <code>sum</code> is uninitialized."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10085515, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F_ZQXMGsEq0/AAAAAAAAAAI/AAAAAAAAAAo/5kyXdclnU6U/photo.jpg?sz=128", "display_name": "Tauqeer Abbas", "link": "https://stackoverflow.com/users/10085515/tauqeer-abbas"}, "edited": false, "score": 0, "creation_date": 1533672515, "post_id": 51734538, "comment_id": 90430071, "body": "it&#39;s not giving the sum of number."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533672583, "post_id": 51734538, "comment_id": 90430113, "body": "What it&#39;s giving?"}, {"owner": {"reputation": 37, "user_id": 10085515, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F_ZQXMGsEq0/AAAAAAAAAAI/AAAAAAAAAAo/5kyXdclnU6U/photo.jpg?sz=128", "display_name": "Tauqeer Abbas", "link": "https://stackoverflow.com/users/10085515/tauqeer-abbas"}, "edited": false, "score": 0, "creation_date": 1533672909, "post_id": 51734538, "comment_id": 90430260, "body": "nothing just 0 if i add sum+= in the loop and outside the loop it echo the number."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1533673141, "post_id": 51734538, "comment_id": 90430358, "body": "<code>scanf</code> can&#39;t be used for this. Try the input <code>11 abc 24</code> Use <code>fgets</code> and <code>sscanf</code>"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1533673573, "post_id": 51734538, "comment_id": 90430544, "body": "Do you want to add the number continuesly if the number is &gt;20 and &lt;25."}, {"owner": {"reputation": 37, "user_id": 10085515, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F_ZQXMGsEq0/AAAAAAAAAAI/AAAAAAAAAAo/5kyXdclnU6U/photo.jpg?sz=128", "display_name": "Tauqeer Abbas", "link": "https://stackoverflow.com/users/10085515/tauqeer-abbas"}, "edited": false, "score": 0, "creation_date": 1533674609, "post_id": 51734538, "comment_id": 90431033, "body": "I want the sum of the value between 20 to 25"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1533674878, "last_edit_date": 1533674878, "creation_date": 1533671936, "answer_id": 51734538, "question_id": 51734361, "link": "https://stackoverflow.com/questions/51734361/keep-prompting-the-the-user-until-valid-value-provided-while-loop-c-programming/51734538#51734538", "title": "Keep prompting the the user until valid value provided-while loop c programming", "body": "<p>You need scanf inside while loop to get the correct value from user by asking continuesly. Once you get correct value you don't need if condition to check correctness of value because while loop exits only after getting correct value.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int main(int argc, char const *argv[])\n    {\n    int num = 0;\n    int sum = 0;\n    bool flag = 0;\n\n    printf(\"Enter the value GREATER than 20 and LESS than 25: \");\n    scanf(\"%d\", &amp;num);\n\n    while ( num &lt; 20 || num &gt;25 )\n    {\n    printf(\"Invalid number,Enter the value GREATER than 20 and LESS than 25: \");\n    scanf(\"%d\", &amp;num);\n    }\n\nwhile (  num &lt;= 25 )\n     { \n         sum += num;\n          num++; \n    }\n\n\n        printf(\"sum of your number is : %d \\n\", sum);\n    return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10085515, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F_ZQXMGsEq0/AAAAAAAAAAI/AAAAAAAAAAo/5kyXdclnU6U/photo.jpg?sz=128", "display_name": "Tauqeer Abbas", "link": "https://stackoverflow.com/users/10085515/tauqeer-abbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 51734538, "answer_count": 1, "score": 0, "last_activity_date": 1533687140, "creation_date": 1533671069, "last_edit_date": 1533687140, "question_id": 51734361, "link": "https://stackoverflow.com/questions/51734361/keep-prompting-the-the-user-until-valid-value-provided-while-loop-c-programming", "title": "Keep prompting the the user until valid value provided-while loop c programming", "body": "<p>I am learning c programming beginner.At while loop stage i am trying validating user input using while loop program working just fine according to my expectation except one thing which is whenever user input invalid value loop terminate itself and i am trying to keep asking the user until the valid value taken from user.Here is the code i am working on it.Can anyone guide me through this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    int num;\n    int sum;\n    bool flag = 0;\n\n    printf(\"Enter the value GREATER than 20 and LESS than 25: \");\n    scanf(\"%d\", &amp;num);\n\n    while ( num &gt; 20 &amp;&amp; num &lt; 25 ) {\n        sum += num;\n        num++;\n    }\n    if ( num &lt; 20 || num &gt; 25){\n        flag = 0;\n        printf(\"Invalid\\n\");\n    }\n    else\n        printf(\"sum of your number is : %d \\n\", sum);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "loops", "optimization", "openmp"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1533667244, "post_id": 51733374, "comment_id": 90427511, "body": "Are you sure it is correct to use 1-based array indexing?"}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533667510, "post_id": 51733374, "comment_id": 90427632, "body": "@WeatherVane pardon me , i didn&#39;t get the question. which line are you refering to? I mean while operating serially I don&#39;t have any problems with these loops."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1533667677, "post_id": 51733374, "comment_id": 90427715, "body": "I mean the loops like <code>for (i=1; i&lt;=nx; i++) for (j=1; j&lt;=ny; j++) for (k=1; k&lt;=nz; k++)</code> followed by <code>dummy = COEFF[i][j][k][6] * p_sparse_s[i][j][k];</code> You don&#39;t show how <code>COEFF</code> or <code>p_sparse_s</code> are defined, meaning whether they have enough elements to index by <code>nx</code> etc."}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533667907, "post_id": 51733374, "comment_id": 90427839, "body": "@weathervane coeff matrices are set of 9 coefficients for a given i,j,k point in the matrix. those are just some constant numbers.<code>p_sparse_s</code> is also a 3d matrix defined for each point in the physical space."}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533668143, "post_id": 51733374, "comment_id": 90427945, "body": "@WeatherVane edited the question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533668205, "post_id": 51733374, "comment_id": 90427971, "body": "<code>COEFF[][][][0], COEFF[][][][1] .... COEFF[][][][9]</code> requires <b>10 such coefficients</b>, not 9."}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1533668259, "post_id": 51733374, "comment_id": 90427995, "body": "oops .. typo. they go till <code>COEFF[][][][8]</code>"}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533713209, "post_id": 51733374, "comment_id": 90441717, "body": "I&#39;m a little confused by loop 2 (and 3, it&#39;s the same thing really), since you have dependence on <code>[i-1,j-1,k-1]</code> and potentially  (seems you can turn that off, in which case this issue does not appear) periodic boundary conditions, this suggests that the equations here are implicit. Are you sure your approach makes sense in the periodic case?"}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533713404, "post_id": 51733374, "comment_id": 90441851, "body": "Speaking of loops 2 and 3, the periodic boundary condition also appears wrong, you check if say <code>i==nx</code> and then set it to <code>1</code> in the first loop, but the dependence is on <code>i-1</code>, so the issue should be with <code>i==1</code> which should loop around to <code>i=nx</code>. (And yes, this 1-based index thing you have here is a little odd for C. )"}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533714474, "post_id": 51733374, "comment_id": 90442482, "body": "@Qubit regarding 1 based index the matrices(all three D matrices) have dimensions of <code>nx+2</code>, <code>ny+2</code> and <code>nz+2</code> and then the 0 and the nx+1 (similarly for y and z direction as well are just <b>ghost cells</b> which are not solver for in the matrix solver but are there for enforcing certain boundary conditions. I will update the question with a small code that folks can give it a try."}], "owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533714669, "creation_date": 1533667024, "last_edit_date": 1533714669, "question_id": 51733374, "link": "https://stackoverflow.com/questions/51733374/loop-transformation-for-data-dependence-and-parallelization", "title": "Loop transformation for data dependence and parallelization", "body": "<p>I have a nested <code>for</code> loop for iterating over a three dimensional space (one for each dimension). The nested loop forms a part of a stencil based matrix solver which has a operation with data dependence. I have gone through lot of links/online material going into the details of <strong>loop transformations</strong> and it seems like loop skewing can help me. Though it is pretty straight forward for a 2d grid (consisting of two loop nests) i find it bit difficult to extend to 3d. The loop looks like this.</p>\n\n<pre><code># pragma omp parallel num_threads(NTt) default(none) private(i,j,k, mythread, dummy) shared(STA,res_sparse_s,COEFF,p_sparse_s, ap_sparse_s,h_sparse_s,RLL, pipi_sparse, normres_sparse, riri_sparse,riri_sparse2,noemer_sparse, nx, ny, nz, nv, PeriodicBoundaryX, PeriodicBoundaryY, PeriodicBoundaryZ)\n{\n\n    mythread  = omp_get_thread_num();//0\n\n    // loop 1\n    #pragma omp for reduction(+:pipi_sparse)\n    for (i=1; i&lt;=nx; i++) for (j=1; j&lt;=ny; j++) for (k=1; k&lt;=nz; k++)\n    {                    \n        dummy = COEFF[i][j][k][6] * p_sparse_s[i][j][k];\n\n        if (PeriodicBoundaryX &amp;&amp; i == 1)  dummy += COEFF[i][j][k][0] * p_sparse_s[nx ][j][k];\n        else                              dummy += COEFF[i][j][k][0] * p_sparse_s[i-1][j][k];\n\n        if (PeriodicBoundaryX &amp;&amp; i == nx) dummy += COEFF[i][j][k][1] * p_sparse_s[1  ][j][k];\n        else                              dummy += COEFF[i][j][k][1] * p_sparse_s[i+1][j][k];\n\n        if (PeriodicBoundaryY &amp;&amp; j == 1)  dummy += COEFF[i][j][k][2] * p_sparse_s[i][ny ][k];\n        else                              dummy += COEFF[i][j][k][2] * p_sparse_s[i][j-1][k];\n\n        if (PeriodicBoundaryY &amp;&amp; j == ny) dummy += COEFF[i][j][k][3] * p_sparse_s[i][  1][k];\n        else                              dummy += COEFF[i][j][k][3] * p_sparse_s[i][j+1][k];\n\n        if (PeriodicBoundaryZ &amp;&amp; k == 1)  dummy += COEFF[i][j][k][4] * p_sparse_s[i][j][nz ];\n        else                              dummy += COEFF[i][j][k][4] * p_sparse_s[i][j][k-1];\n\n\n        if (PeriodicBoundaryZ &amp;&amp; k == nz) dummy += COEFF[i][j][k][5] * p_sparse_s[i][j][  1];\n        else                              dummy += COEFF[i][j][k][5] * p_sparse_s[i][j][k+1];\n\n        ap_sparse_s[i][j][k] = dummy;\n        pipi_sparse += p_sparse_s[i][j][k] * ap_sparse_s[i][j][k];\n    }\n\n\n    // loop 2\n        // FORWARD\n        #pragma omp for schedule(static, nx/NTt)\n        for (i=1; i&lt;=nx; i++) for (j=1; j&lt;=ny; j++) for (k=1; k&lt;=nz; k++)\n        {\n\n\n            dummy = res_sparse_s[i][j][k];\n\n                                           dummy -= COEFF[i][j][k][7] * RLL[i-1][j][k];\n            if (PeriodicBoundaryX &amp;&amp; i==nx)dummy -= COEFF[i][j][k][8] * RLL[1  ][j][k];\n\n\n                                            dummy -= COEFF[i][j][k][2] * RLL[i][j-1][k];\n            if (PeriodicBoundaryY &amp;&amp; j==ny) dummy -= COEFF[i][j][k][3] * RLL[i][1  ][k];\n\n\n                                            dummy -= COEFF[i][j][k][4] * RLL[i][j][k-1];\n            if (PeriodicBoundaryZ &amp;&amp; k==nz) dummy -= COEFF[i][j][k][5] * RLL[i][j][1  ];\n\n\n            RLL[i][j][k] = dummy / h_sparse_s[i][j][k];\n        }\n\n    // loop 3\n        // BACKWARD\n        #pragma omp for schedule(static, nx/NTt)\n        for (i=nx; i&gt;=1;i--) for (j=ny; j&gt;=1;j--) for (k=nz; k&gt;=1;k--)\n        {\n            dummy = RLL[i][j][k]*h_sparse_s[i][j][k];\n\n            if (PeriodicBoundaryX &amp;&amp; i==1) dummy -= COEFF[i][j][k][7] * RLL[nx ][j][k];\n                                           dummy -= COEFF[i][j][k][8] * RLL[i+1][j][k];\n\n            if (PeriodicBoundaryY &amp;&amp; j==1) dummy -= COEFF[i][j][k][2] * RLL[i][ny ][k];\n                                           dummy -= COEFF[i][j][k][3] * RLL[i][j+1][k];\n\n            if (PeriodicBoundaryZ &amp;&amp; k==1) dummy -= COEFF[i][j][k][4] * RLL[i][j][nz ];\n                                           dummy -= COEFF[i][j][k][5] * RLL[i][j][k+1];\n\n\n            RLL[i][j][k] =  dummy  / h_sparse_s[i][j][k];\n        }\n\n}\n</code></pre>\n\n<ul>\n<li>Loop 1 -> Data dependence of <code>[i][j][k]</code> on <code>[i+1][i-1][j-1][j+1][k-1][k+1]</code> although the values of <code>p_sparse_s</code> are read-only</li>\n<li>Loop 2 -> Data dependence of <code>[i][j][k]</code> on <code>[i-1][j-1][k-1]</code></li>\n<li>Loop 3 -> Data dependence of <code>[i][j][k]</code> on <code>[i+1][j+1][k+1]</code></li>\n</ul>\n\n<h2>EDIT</h2>\n\n<p><code>COEFF[i][j][k][NUM]</code> are just generic coefficients (some constant numbers) defined for each point in the 3d space. Since there are 9 such coefficients corresponding to neighboring points hence <code>COEFF[][][][0], COEFF[][][][1] .... COEFF[][][][8]</code>and like that.</p>\n\n<h2>EDIT</h2>\n\n<p>find a small code below that has a data dependence. I have tried to skew the inner k loop with respect to the i and j loop so that the k loop can be vectorised. Problem is the code gives absolutely correct answers when running in serial and gives some weird answers if I enforce parallelism or if I enforce vectorisation of the inner loop.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;omp.h&gt;\n\ntypedef double lr;\n\n#define nx 4\n#define ny 4\n#define nz 4\n\nvoid\nprint3dmatrix(double a[nx+2][ny+2][nz+2])\n{\n    for(int i=1; i&lt;= nx; i++) {\n        for(int j=1; j&lt;= ny; j++) {\n            for(int k=1; k&lt;= nz; k++) {\n                printf(\"%f \", a[i][j][k]);\n            }\n            printf(\"\\n\");\n        }\n        printf(\"\\n\");\n    }\n}\n\nint \nmain()\n{\n\n    double a[nx+2][ny+2][nz+2];\n    double b[nx+2][ny+2][nz+2];\n\n    srand(3461833726);\n\n\n    // matrix filling \n    // b is just a copy of a\n    for(int i=0; i&lt; nx+2; i++) for(int j=0; j&lt; ny+2; j++) for(int k=0; k&lt; nz+2; k++)\n    {\n        a[i][j][k] = rand() % 5;\n        b[i][j][k] = a[i][j][k];\n    }\n\n    // loop 1\n    //#pragma omp parallel for num_threads(1)\n    for(int i=1; i&lt;= nx; i++) for(int j=1; j&lt;= ny; j++) for(int k=1; k&lt;= nz; k++)\n    {\n        a[i][j][k] = -1*a[i-1][j][k] - 1*a[i][j-1][k] -1 * a[i][j][k-1] + 4 * a[i][j][k];\n    }\n\n    print3dmatrix(a);\n    printf(\"******************************\\n\");\n\n    // loop 2\n    //#pragma omp parallel for num_threads(1)\n    for(int i=1; i&lt;= nx; i++) \n        for(int j=1; j&lt;= ny; j++)\n            // #pragma omp simd\n            for(int m=j+1; m&lt;= j+nz; m++)\n            {\n                b[i][j][m-j] = -1*b[i-1][j][m-j] - 1*b[i][j-1][m-j] -1 * b[i][j][m-j-1] + 4 * b[i][j][m-j];\n            }\n\n    print3dmatrix(b);\n    printf(\"=========================\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>see - <a href=\"https://stackoverflow.com/questions/51580852/vectorisation-of-for-loop-with-data-dependecy/51582405?noredirect=1#comment90428352_51582405\">loop skewing for vectorisation</a></p>\n"}, {"tags": ["c", "cygwin", "lcov", "cpputest"], "owner": {"reputation": 1133, "user_id": 2344440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A27lB.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/2344440/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 779, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533675130, "creation_date": 1533664209, "last_edit_date": 1533675130, "question_id": 51732674, "link": "https://stackoverflow.com/questions/51732674/removing-files-from-lcov-tracefile-using-relative-paths", "title": "Removing files from lcov tracefile using relative paths", "body": "<p>I am attempting to remove certain directories from my lcov tracefile, but am not having any success. I am attempting to use relative paths, and I am using cygwin. My test framework is cpputest.</p>\n\n<p>My directory structure looks like this</p>\n\n<pre><code>foo_library\n$ tree\n\u251c\u2500\u2500 bar\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.c\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.h\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.o\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 makefile\n\u251c\u2500\u2500 makefile\n\u251c\u2500\u2500 readme.md\n\u251c\u2500\u2500 foo.c\n\u251c\u2500\u2500 foo.h\n\u251c\u2500\u2500 foo.o\n\u251c\u2500\u2500 baz\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 baz.c\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 baz.h\n\u2514\u2500\u2500 test\n  \u00a0 \u251c\u2500\u2500 AllTests.cpp\n  \u00a0 \u251c\u2500\u2500 bar\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.d\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.gcda\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.gcno\n  \u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 bar.o\n  \u00a0 \u251c\u2500\u2500 lcov.info\n  \u00a0 \u251c\u2500\u2500 lcov-filtered.info\n  \u00a0 \u251c\u2500\u2500 Makefile\n  \u00a0 \u251c\u2500\u2500 foo.d\n  \u00a0 \u251c\u2500\u2500 foo.gcno\n  \u00a0 \u251c\u2500\u2500 foo.o\n  \u00a0 \u251c\u2500\u2500 baz\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 baz.d\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 baz.gcda\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 baz.gcno\n  \u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 baz.o\n  \u00a0 \u251c\u2500\u2500 test_foo.cpp\n  \u00a0 \u251c\u2500\u2500 test-lib\n  \u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 libfoo.a\n  \u00a0 \u251c\u2500\u2500 test-obj\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 AllTests.d\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 AllTests.gcda\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 AllTests.gcno\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 AllTests.o\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 test_foo.d\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 test_foo.gcda\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 test_foo.gcno\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 test_foo.o\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 wrap_foo.d\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 wrap_foo.gcda\n  \u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 wrap_foo.gcno\n  \u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 wrap_foo.o\n  \u00a0 \u251c\u2500\u2500 foo_tests.exe\n  \u00a0 \u251c\u2500\u2500 wrap_foo.c\n  \u00a0 \u2514\u2500\u2500 wrap_foo.h\n</code></pre>\n\n<p>Here is an example</p>\n\n<pre><code>nick test \n$ pwd\n/cygdrive/C/Work/git/foo_library/test\n\nnick test \n$ lcov --capture --directory './' --output-file lcov.info\nCapturing coverage data from ./\nFound gcov version: 7.3.0\nScanning ./ for .gcda files ...\nFound 5 data files in ./\nProcessing bar/bar.gcda\nProcessing baz/baz.gcda\nProcessing test-obj/AllTests.gcda\nProcessing test-obj/test_foo.gcda\ngeninfo: WARNING: cannot find an entry for c~#Work#cpputest#include#CppUTest#Utest.h.gcov in .gcno file, skipping file!\nProcessing test-obj/wrap_foo.gcda\nFinished .info-file creation\n\nnick test \n$ lcov --list lcov.info\nReading tracefile lcov.info\n                                     |Lines       |Functions  |Branches\nFilename                             |Rate     Num|Rate    Num|Rate     Num\n===========================================================================\n[/cygdrive/C/Work/git/foo_library/]\nbar/bar.c                            |83.3%     24|66.7%     3|    -      0\nfoo.c                                |94.0%    100| 100%     4|    -      0\nbaz/baz.c                            | 100%      5| 100%     1|    -      0\ntest/AllTests.cpp                    | 100%      3| 100%     1|    -      0\ntest/test_foo.cpp                    | 100%    131|74.6%   189|    -      0\n===========================================================================\n                               Total:|96.2%    263|75.3%   198|    -      0\n\nnick test \n$ lcov --remove lcov.info './bar/*' --output-file lcov-filtered.info\nReading tracefile lcov.info\nDeleted 0 files\nWriting data to lcov-filtered.info\nSummary coverage rate:\n  lines......: 96.2% (253 of 263 lines)\n  functions..: 75.3% (149 of 198 functions)\n  branches...: no data found\n</code></pre>\n\n<p>Ultimately I just want to produce coverage data of this foo.c file, and I would like to exclude or remove everything else.</p>\n\n<p>I have tried using absolute paths to these directories, like <code>'cygdrive/C/Work/git/foo_library/test/bar/*'</code>, I have also tried</p>\n\n<pre><code>'`pwd`/test/bar/*'\n</code></pre>\n\n<p>I am also not really sure which paths I should be specifying, the paths to the gcda files, or the path to the source files. I've tried both.</p>\n\n<p>I've also tried using -b ., and -b ../ in my capture and remove commands.</p>\n\n<p>Edit: \nI have to run this from the test subdirectory for the paths to work out. The following shows the full paths</p>\n\n<pre><code>nick test \n$ lcov -c -d . -b ../ -o lcov.info\nCapturing coverage data from .\nFound gcov version: 7.3.0\nScanning . for .gcda files ...\nFound 5 data files in .\nProcessing bar/bar.gcda\nProcessing baz/baz.gcda\nProcessing test-obj/AllTests.gcda\nProcessing test-obj/test_foo.gcda\ngeninfo: WARNING: cannot find an entry for c~#Work#cpputest#include#CppUTest#Utest.h.gcov in .gcno file, skipping file!\nProcessing test-obj/wrap_foo.gcda\nFinished .info-file creation\n\nnick test\n$ lcov --list lcov.info --list-full-path\nReading tracefile lcov.info\n                                                                                |Lines       |Functions  |Branches\nFilename                                                                        |Rate     Num|Rate    Num|Rate     Num\n======================================================================================================================\n/cygdrive/C/Work/git/foo_library/bar/bar.c                                      |83.3%     24|66.7%     3|    -      0\n/cygdrive/C/Work/git/foo_library/foo.c                                          |94.0%    100| 100%     4|    -      0\n/cygdrive/C/Work/git/foo_library/baz/baz.c                                      | 100%      5| 100%     1|    -      0\n/cygdrive/C/Work/git/foo_library/test/AllTests.cpp                              | 100%      3| 100%     1|    -      0\n/cygdrive/C/Work/git/foo_library/test/test_foo.cpp                              | 100%    131|74.6%   189|    -      0\n======================================================================================================================\n                                                                          Total:|96.2%    263|75.3%   198|    -      0\n</code></pre>\n\n<p>Edit:\nIf I do this: <code>$ lcov -r lcov.info '*bar*' '*baz*' '*cpp' -o lcov-filtered.info</code>\nit does what I want. However that seems a little heavy handed.</p>\n"}, {"tags": ["c", "signal-processing", "fft", "portaudio"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1533663697, "post_id": 51732119, "comment_id": 90425830, "body": "Write a unit test for your FFT routines so that you can debug them separately from your audio code."}, {"owner": {"reputation": 11, "user_id": 10082408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d1b165871de9824e420ad79d1a4860?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/10082408/cristian"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1533671026, "post_id": 51732119, "comment_id": 90429360, "body": "Thanks a lot for your advise. I did it with a sinusoidal numerical excursion as input, Y[i]=sin(2 * M_PI  * f  * i   / N) + 0  * I,  and i realized that separate() function does not work properly as it does with integer numbers. Apart from that the input is processed by fft() and then released inalterated by ifft()."}], "owner": {"reputation": 11, "user_id": 10082408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d1b165871de9824e420ad79d1a4860?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/10082408/cristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533663637, "creation_date": 1533661927, "last_edit_date": 1533663637, "question_id": 51732119, "link": "https://stackoverflow.com/questions/51732119/cooley-tukey-fft-algorithm-portaudio", "title": "Cooley-Tukey FFT algorithm &amp; Portaudio", "body": "<p>I implemented the aforementioned algorithm  (<a href=\"https://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm</a>).\nHere' s the full working code.\nI receive streaming input from microphone in a non interleaved stereo Callback. \nThen i fill a buffer with input samples and process this buffer into fft and ifft\nfunctions.\nFinally i use a pointer to send the processed buffer to output.\nI use Asio4all V2.\nI really can' t understand where is the problem because it does work properly but i can' t go beyound N=16 or the output sounds highly intermittent.</p>\n\n<p>Thanks a lot in advance.</p>\n\n<p>Callback + Main:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"portaudio.h\"\n#include \"FFT.h\"\n\n#define SAMPLE_RATE   (44100)\n#define FRAMES_PER_BUFFER  (64)\n#define NUM_SECONDS   (10)\n\ntypedef struct\n{\n}\npaTestData;\n\nstatic int patestCallback(  void *INbuffers[2], void *OUTbuffers[2],\n                            unsigned long framesPerBuffer,\n                            const PaStreamCallbackTimeInfo* timeInfo,\n                            PaStreamCallbackFlags statusFlags,\n                            void *userData )\n{\n    paTestData *data = (paTestData*)userData;\n\n    float *inL  = (float *) INbuffers [0];\n    float *inR  = (float *) INbuffers [1];\n    float *outL = (float *) OUTbuffers[0];\n    float *outR = (float *) OUTbuffers[1];\n\n    unsigned long i;\n\n    (void) timeInfo; \n    (void) statusFlags;\n\n    for( i=0; i&lt;framesPerBuffer; i++ )\n    {\n        for(int i=0; i&lt;N; i++)\n        {\n            Y[i] = *inL + 0*I;\n        }\n        *inL++;\n\n        fft(Y, N);\n        ifft(Y, N);\n\n        for(int i=0; i&lt;N; i++)\n        {\n            p_out=&amp;Y[i];\n        }\n\n        *outL++ = *p_out++;\n        *outR++ = *p_out++;\n    }\n\n    return paContinue;\n}\n\n\n\nint main()\n{\n    PaStreamParameters inputParameters;\n    PaStreamParameters outputParameters;\n    PaStream *stream;\n    paTestData data;\n\n    Pa_Initialize();\n\n    inputParameters.device = Pa_GetDefaultInputDevice();\n    inputParameters.channelCount = 2;\n    inputParameters.sampleFormat = paFloat32 | paNonInterleaved;\n    inputParameters.suggestedLatency = 0;\n    inputParameters.hostApiSpecificStreamInfo = NULL;\n\n    outputParameters.device = Pa_GetDefaultOutputDevice();\n    outputParameters.channelCount = 2;\n    outputParameters.sampleFormat = paFloat32 | paNonInterleaved;\n    outputParameters.suggestedLatency = 0;\n    outputParameters.hostApiSpecificStreamInfo = NULL;\n\n    Pa_OpenStream( &amp;stream,\n                   &amp;inputParameters,\n                   &amp;outputParameters,\n                   SAMPLE_RATE,\n                   FRAMES_PER_BUFFER,\n                   paClipOff,\n                   patestCallback,\n                   &amp;data );\n\n    Pa_StartStream( stream );\n\n    Pa_Sleep( NUM_SECONDS * 1000);\n\n    Pa_StopStream( stream );\n\n    Pa_CloseStream( stream );\n}\n</code></pre>\n\n<p>Header:</p>\n\n<pre><code>#ifndef FFT_H_INCLUDED\n#define FFT_H_INCLUDED\n\n\n\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;complex.h&gt;\n\n#define N (16)\n\ncomplex Y[N];\ncomplex *p_out;\n\n\n\nvoid separate (complex *a, int n)\n{\n    complex b[N/2];\n\n    for(int i=0; i&lt;n/2; i++) // copy all odd elements to b\n        b[i] = a[i*2+1];\n\n    for(int i=0; i&lt;n/2; i++) // copy all even elements to lower-half of a[]\n        a[i] = a[i*2];\n\n    for(int i=0; i&lt;n/2; i++) // copy all odd (from heap) to upper-half of a[]\n        a[i+n/2] = b[i];\n}\n\n\n\ncomplex fft(complex *X, int m)   // forward fft\n{\n    if(m &lt; 2) {\n        // bottom of recursion.\n        // Do nothing here, because already X[0] = x[0]\n    } else {\n\n    separate(X, m);        // all evens to lower half, all odds to upper half\n\n    fft(X, m/2);           // recurse even items\n    fft(X+m/2, m/2);       // recurse odd  items\n\n    for(int k=0; k&lt;m/2; k++)    // combine results of two half recursions\n    {\n        complex e = X[k    ];   // even\n        complex o = X[k+m/2];   // odd\n\n        complex w = cexp( 0 + (-2.*M_PI*k/m)*I ); // w is the twiddle-factor\n\n        X[k    ] = e + w * o;\n        X[k+m/2] = e - w * o;\n    }\n    }\n}\n\n\n\nfloat ifft(complex *X, int m)   // inverse fft\n{\n    for (int i=0; i&lt;m; i++)   \n    {\n        X[i]=conj(X[i]);        // conjugate the complex array  \n    }\n\n    fft(X, m);                  // forward fft                \n\n    for (int i=0; i&lt;m; i++)   \n    {\n        X[i]=conj(X[i]);        // conjugate the complex array again\n    }\n\n    for (int i=0; i&lt;m; i++)   \n    {\n        X[i] /= m;              // scale the numbers\n    }\n}\n\n\n\n#endif // FFT_H_INCLUDED\n</code></pre>\n"}, {"tags": ["c", "openssl", "rsa", "bouncycastle"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1533662409, "post_id": 51731802, "comment_id": 90425260, "body": "Um... <code>pszMessage256Hash</code> ? If that lives up to its name, It may already be wrong on <i>multiple</i> fronts. First, <code>RSA_sign</code> will digest the data, then produce the signature via encryption with the given key. If that name is accurate, you <i>already</i> have the digest. So you&#39;re digesting a digest, then signing that (and obviously that can&#39;t work). Second, if that is some <i>string</i> of the digest (and the <code>strlen</code> suggests that <i>may</i> be the case), then you&#39;re digesting a character hex-dump of a digest, then signing it (which is arguably just as inaccurate, but just obfuscating things more)."}, {"owner": {"reputation": 1, "user_id": 10193223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ch-XgpQvgjk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r8GP7HNN7hOR0GhvVw5Iy_dY4edw/mo/photo.jpg?sz=128", "display_name": "Vlad Alexandru", "link": "https://stackoverflow.com/users/10193223/vlad-alexandru"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533665245, "post_id": 51731802, "comment_id": 90426550, "body": "yes pszMessage256Hash contains a string with 64 lowercase hex characters which is the representation of the sha256 32 bytes( 256bit ) hash. Same as data[] in the java module."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533665403, "post_id": 51731802, "comment_id": 90426627, "body": "So you&#39;re <i>intentionally</i> digesting a hex-char-encoded digest (from... somewhere), then signing the result? Just want to be clear. And <code>data</code> in the java code is a <i>string</i> ? Or is it <code>byte[]</code>"}, {"owner": {"reputation": 1, "user_id": 10193223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ch-XgpQvgjk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r8GP7HNN7hOR0GhvVw5Iy_dY4edw/mo/photo.jpg?sz=128", "display_name": "Vlad Alexandru", "link": "https://stackoverflow.com/users/10193223/vlad-alexandru"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533665782, "post_id": 51731802, "comment_id": 90426788, "body": "That is correct. The java code is a byte[] containing 64 hex characters but could very well be a string. The content of both data[] and pszMessage256Hash is a hash of the actual message and was very straightforward to obtain and verify using online tools. The SHA256WithRSA signature for that content however only checks out if it is generated by the java code snippet - the one generated by the c code is rejected."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533665924, "post_id": 51731802, "comment_id": 90426868, "body": "OK. I hope you understand my asking. signatures are normally built from digests of the <i>data</i>, signed with the asymmetric private key. Your <i>data</i> is already a digest, making your ultimate end result a signature of a digest of a digest. Odd, but doable; data is, after all, data. What online checking tool are you using for this? Perhaps include that <a href=\"https://stackoverflow.com/posts/51731802/edit\">in your question</a>. Thanks."}, {"owner": {"reputation": 1, "user_id": 10193223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ch-XgpQvgjk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r8GP7HNN7hOR0GhvVw5Iy_dY4edw/mo/photo.jpg?sz=128", "display_name": "Vlad Alexandru", "link": "https://stackoverflow.com/users/10193223/vlad-alexandru"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533666423, "post_id": 51731802, "comment_id": 90427111, "body": "yeah it looks pretty weird to me too but that is what the specifications require, and what their java sample does. To check the sha256 i have googled for &quot;online sha256&quot; and used some of the links provided. However that is an input parameter that is not random so i was able to check that it is the same on both versions."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1533669587, "post_id": 51731802, "comment_id": 90428681, "body": "Since you are doing the signing you can also do the verification as another way of checking your code. Specifically, you can write a C language verifier to check the Java signature and a Java language verifier to check the C language signature. This can possibly narrow down your problem."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533670284, "post_id": 51731802, "comment_id": 90429013, "body": "An example using the EVP library in OpenSSL for generating and verifying signatures can be <a href=\"http://coliru.stacked-crooked.com/a/efde4dd40226204a\" rel=\"nofollow noreferrer\">seen <b>here</b></a>. Note there is literally no error checking, so use at your discretion, but I just wanted you to know how a signature is typically generated, and verified, using modern (post 1.0) OpenSSL&#39;s libcrypto."}, {"owner": {"reputation": 1, "user_id": 10193223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ch-XgpQvgjk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r8GP7HNN7hOR0GhvVw5Iy_dY4edw/mo/photo.jpg?sz=128", "display_name": "Vlad Alexandru", "link": "https://stackoverflow.com/users/10193223/vlad-alexandru"}, "edited": false, "score": 0, "creation_date": 1536812552, "post_id": 51731802, "comment_id": 91560395, "body": "That solved it. Thank you !"}], "owner": {"reputation": 1, "user_id": 10193223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ch-XgpQvgjk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r8GP7HNN7hOR0GhvVw5Iy_dY4edw/mo/photo.jpg?sz=128", "display_name": "Vlad Alexandru", "link": "https://stackoverflow.com/users/10193223/vlad-alexandru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533660622, "creation_date": 1533660622, "question_id": 51731802, "link": "https://stackoverflow.com/questions/51731802/looking-for-c-w-openssl-equivalent-of-java-bouncycastle-sha256withrsa-signing", "title": "looking for C w/openssl equivalent of java bouncycastle SHA256withRSA signing", "body": "<p>ok ive been banging my head on this for over two days now. I need to code in c, using openssl library, the equivalent for the following java code :</p>\n\n<pre><code>    byte[] result = null;\n    Signature st = Signature.getInstance(BC_PROV_ALGORITHM_SHA256RSA, \"BC\");\n    st.initSign(privateKey);\n    st.update(data);\n    result = st.sign();\n    return result;\n</code></pre>\n\n<p>The most obvious approach was this </p>\n\n<pre><code>RSA_sign( NID_sha256, ( const BYTE* ) pszMessage256Hash, \nstrlen( pszMessage256Hash), ( unsigned char *) pSignature, \n&amp;iSignLen, pPrivateMerchantKey )\n</code></pre>\n\n<p>Already checked that the key is the same and the content of the pszMessage256Hash is identical to the \"data\" variable from java. Due to padding the result is different every time however the server-side verification is rejecting the second signature.</p>\n\n<p>Any help would be appreciated, as i said, i have been wasting way too much time on this.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1533659969, "post_id": 51731456, "comment_id": 90424088, "body": "Can\u2019t you just redirect to /dev/null?"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1533661006, "post_id": 51731456, "comment_id": 90424612, "body": "How can I do that with a socket? Bearing in mind all I have is an int file descriptor."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533661866, "post_id": 51731456, "comment_id": 90425021, "body": "Maybe using <a href=\"http://man7.org/linux/man-pages/man2/splice.2.html\" rel=\"nofollow noreferrer\">splice</a> or tee(2) ? <code>int nullfd = open(&#47;dev&#47;null, O_W); while(splice(fd, NULL, nullfd, NULL, (S?)SIZE_MAX, SPLICE_F_NONBLOCK) &gt; 0);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533666810, "post_id": 51731456, "comment_id": 90427289, "body": "I recommend posting what code you have tried (and timed) and ask for speedily approaches to the higher level goal: <b>speed</b>. The question so far is &quot;Best way to discard data&quot; is only 1 way to do this.  Better to ask how to achieve the higher/true goal."}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 1, "creation_date": 1533660965, "post_id": 51731775, "comment_id": 90424588, "body": "I&#39;d like to avoid having to copy into the user buffer since I&#39;ll just ignore it.  We do a <i>lot</i> of high throughput streaming so we do actually run into memory bandwidth issues."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 1, "creation_date": 1533661050, "post_id": 51731775, "comment_id": 90424630, "body": "It&#39;s not clear if this is kernel code or not, and it&#39;s also not clear what kind of access patterns you&#39;re trying to implement. Just how much data are you handling that memory bandwidth starts to be a constraint? Usually it&#39;s hard to saturate that without running out of network bandwidth first."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533661190, "post_id": 51731775, "comment_id": 90424689, "body": "Remember in the kernel the memory access costs are far lower, so if you are really up against the wall you can implement part of your code as a loadable kernel module. The cost of IO there is significantly lower since there&#39;s no need to copy to userspace. You can manipulate network buffers directly."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1533661600, "post_id": 51731775, "comment_id": 90424896, "body": "If memory bandwidth is an issue, are you sure you should be using pipes?"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533662029, "post_id": 51731775, "comment_id": 90425094, "body": "@tadman This is not kernel code.  Part of the problem is that our working set sizes are frequently larger than L3 cache, so any pressure we put on the memory bus doing unnecessary copies really hurts latency."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 1, "creation_date": 1533662185, "post_id": 51731775, "comment_id": 90425164, "body": "@SeanMcAllister: Both pipes and sockets have relatively small capacities \u2014 64 KiB for pipes on Linux, probably less for a socket.  Reading into a 64 KiB buffer is unlikely to put much pressure on an L3 cache on modern workstation or server hardware."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 2, "creation_date": 1533662882, "post_id": 51731775, "comment_id": 90425461, "body": "@SeanMcAllister, it sounds like you are trying to forecast performance impact.  That can be an amusing exercise, but it is notoriously difficult to do accurately.  And in this case, it really doesn&#39;t matter, because for non-seekable files such as sockets and pipes, you have no alternative to reading the data in order to advance through the stream, and no userspace interface for reading the data without putting it somewhere."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1533664973, "post_id": 51731775, "comment_id": 90426423, "body": "@JohnBollinger At least with pipes, I can splice() to /dev/null and TCP sockets support MSG_TRUNC to discard data, but it does indeed look like there&#39;s no general purpose answer."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533668745, "post_id": 51731775, "comment_id": 90428265, "body": "There&#39;s probably a way to solve this that doesn&#39;t involve dark hackery, but without knowing more about your specific goals I can&#39;t really advise. If you want to ignore past a certain point, you have several options. If you need to skip ahead an arbitrary number of bytes that&#39;s a different problem. If this is network based I&#39;m not sure how you&#39;d be exhausting memory bandwidth when that should be around 40GB/s vs. ~0.250-1.25GB/s for your network connection. There should be considerable headroom here, even when accounting for user-mode costs."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1533669055, "post_id": 51731775, "comment_id": 90428426, "body": "If you need to burn through a lot of data, experiment with different buffer block sizes and see which one comes out on top performance-wise. If you had some example code that demonstrated what you were trying to do that would help considerably as we could benchmark too."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533688785, "post_id": 51731775, "comment_id": 90434915, "body": "Well OK, @SeanMcAllister, since you did ask specifically about Linux.  Both <code>splice()</code> and <code>MSG_TRUNC</code> are in fact Linux-specific."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 4, "last_activity_date": 1533660510, "creation_date": 1533660510, "answer_id": 51731775, "question_id": 51731456, "link": "https://stackoverflow.com/questions/51731456/best-way-to-discard-data-from-a-pipe-or-socket-in-linux/51731775#51731775", "title": "Best way to discard data from a pipe or socket in linux?", "body": "<p>You need to <code>read</code> the data. What you do with it is up to you, so you can skip over parts, or whatever.</p>\n\n<p>Without reading it the data stays stuck in the read buffer. The recommended way to get it out of the buffer is to read it.</p>\n\n<p>That being said, if you read something that indicates that all subsequent data will be of no use, you could just close the connection and be done with it.</p>\n\n<p>I'm not sure what you mean about \"efficient\" because reading from a buffer is probably not the performance bottleneck in your code.</p>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1533660510, "creation_date": 1533659212, "question_id": 51731456, "link": "https://stackoverflow.com/questions/51731456/best-way-to-discard-data-from-a-pipe-or-socket-in-linux", "title": "Best way to discard data from a pipe or socket in linux?", "body": "<p>I've got a situation where I might want to \"skip\" data in a pipe or socket for processing.  I could of course read() the data into a buffer and just discard it, but is there a more efficient way?  Perhaps something like sendfile that would work with a non-mmappable source?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 12, "creation_date": 1533656231, "post_id": 51730584, "comment_id": 90421900, "body": "called to RAM... what?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1533656296, "post_id": 51730584, "comment_id": 90421941, "body": "Functions are not called anywhere. They are called in place."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1533656334, "post_id": 51730584, "comment_id": 90421966, "body": "I think they mean &quot;How can one assign a function pointer if the actual position of a function in virtual memory will be determined at run-time?&quot;, but that&#39;s a shot in the dark. I guess that&#39;s OP&#39;s understanding and question. Is that right, OP?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1533656376, "post_id": 51730584, "comment_id": 90421995, "body": "All functions are (normally) <i>loaded</i> to memory when your program starts. Calling a function is not related to and happens after loading it to memory."}, {"owner": {"reputation": 37, "user_id": 9435097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20962cd877daf64d4b0288e95cb59746?s=128&d=identicon&r=PG&f=1", "display_name": "Mubashira khanum", "link": "https://stackoverflow.com/users/9435097/mubashira-khanum"}, "edited": false, "score": 0, "creation_date": 1533656763, "post_id": 51730584, "comment_id": 90422238, "body": "I got to know through a video that functions get loaded to memory only when main function calls it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1533656881, "post_id": 51730584, "comment_id": 90422306, "body": "Do not learn C with videos."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533657249, "post_id": 51730584, "comment_id": 90422574, "body": "&quot; functions get loaded to memory only when main function calls it&quot; --&gt;  That may be true with a select C implementation.  Yet that is an implementation detail.  <code>p=f1;</code> is fine. -based on the <i>virtual machine</i>.  A compliant implementation must support that code - somehow."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1533658717, "post_id": 51730584, "comment_id": 90423379, "body": "@Mubashirakhanum: Beware of learning C from random videos - a lot of people <i>think</i> they know the language better than they really do."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1533666417, "post_id": 51730584, "comment_id": 90427108, "body": "If your particular implementation is one that only loads a function into memory when needed, then the assignment of the pointer will make it needed, or else your compiler is out of spec."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1533658844, "last_edit_date": 1533658844, "creation_date": 1533656666, "answer_id": 51730731, "question_id": 51730584, "link": "https://stackoverflow.com/questions/51730584/is-it-possible-to-assign-a-function-pointer-before-calling-a-function/51730731#51730731", "title": "Is it possible to assign a function pointer before calling a function?", "body": "<p>Answering the question:</p>\n\n<p>First question:\nyou can assign the function pointer with the function address without prior call to this function.</p>\n\n<p>The second question:\nIt only assigns the function pointer <code>p</code> with the address (reference) of the function <code>f1</code>. It does not do anything else, especially it does not call any functions.</p>\n\n<p>The third question from the comment. The function will usually will not be linked into the executable file if the function is not used anywhere in your program. But the assignment of the function pointer is one of such a \"uses\" and it will be linked. </p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1533657606, "last_edit_date": 1533657606, "creation_date": 1533657196, "answer_id": 51730919, "question_id": 51730584, "link": "https://stackoverflow.com/questions/51730584/is-it-possible-to-assign-a-function-pointer-before-calling-a-function/51730919#51730919", "title": "Is it possible to assign a function pointer before calling a function?", "body": "<p>You can define <code>p</code> as a global variable and initialize it to <code>f1</code>, provided the declaration of <code>f1</code> is in scope and has a prototype compatible with the definition of <code>p</code>. Initializing a pointer does not call the function, nor does it access the memory where the function code is located. It just stores the value of its address to the location of the pointer variable.</p>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid say_hello(void) {\n    printf(\"Hello world\\n\");\n}\n\nvoid (*p)(void) = say_hello;\n\nint main(void) {\n    (*p)();\n    return 0;\n}\n</code></pre>\n\n<p>The way code is <em>called into RAM</em> is an operating system issue, you can completely disregard this concept when programming in C.</p>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1533657300, "creation_date": 1533657300, "answer_id": 51730955, "question_id": 51730584, "link": "https://stackoverflow.com/questions/51730584/is-it-possible-to-assign-a-function-pointer-before-calling-a-function/51730955#51730955", "title": "Is it possible to assign a function pointer before calling a function?", "body": "<p>I think you are missing the concept of virtual, or program address as opposed to physical address.   RAM uses physical addresses.  A program uses virtual addresses, which are selected by the linker (ld, in unixi).   When the Operating System loads a page of a program into RAM, it creates a translation between the virtual address and the physical address.   When an opcode references memory, the CPU uses this translation to retrieve the appropriate RAM location.</p>\n\n<p>summary:\nA program knows all of its static virtual addresses before it starts.\nThe stack and dynamically allocated addresses are calculated and managed in the program.\nThe Operating System / CPU dynamically and transparently translate these virtual addresses into physical ones.</p>\n"}], "owner": {"reputation": 37, "user_id": 9435097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20962cd877daf64d4b0288e95cb59746?s=128&d=identicon&r=PG&f=1", "display_name": "Mubashira khanum", "link": "https://stackoverflow.com/users/9435097/mubashira-khanum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "closed_date": 1533658675, "answer_count": 3, "score": 0, "last_activity_date": 1533658844, "creation_date": 1533656160, "last_edit_date": 1533657338, "question_id": 51730584, "link": "https://stackoverflow.com/questions/51730584/is-it-possible-to-assign-a-function-pointer-before-calling-a-function", "closed_reason": "Needs details or clarity", "title": "Is it possible to assign a function pointer before calling a function?", "body": "<p>Whenever any program is executed, the <code>main</code> function is executed first and then other functions are called to RAM. In most of the programs that use function pointers, I encountered the code below right after opening flower bracket of the <code>main</code> function:</p>\n\n<pre><code>p = f1;  //p is function pointer and f1 is function name\n</code></pre>\n\n<p>How is it possible to assign the address of a function to a function pointer, when the function has not been called to RAM yet?\nOr does the below code </p>\n\n<pre><code>p = f1;\n</code></pre>\n\n<p>mean calling a function also?</p>\n"}, {"tags": ["c", "hashtable", "glibc", "fgets"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1533654441, "post_id": 51729995, "comment_id": 90420738, "body": "One bug here: <code>li=malloc(strlen(e.key)*sizeof(char));</code> - should be: <code>li=malloc(strlen(e.key)+1);</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1533654466, "post_id": 51729995, "comment_id": 90420753, "body": "You have forgotten that <code>char</code> strings are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminator</i> need space too. Since you don&#39;t allocate enough memory you will have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> when <code>strcpy</code> writes out of bounds of your allocated memory."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1533654801, "post_id": 51729995, "comment_id": 90420982, "body": "You made a copy of the string with <code>malloc</code> and <code>strcpy</code>, but you forgot to update <code>e.key</code> to point to that string."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1533654950, "post_id": 51729995, "comment_id": 90421078, "body": "You should check the return value of <code>malloc</code>, although that is unlikely to be the cause of the problem in this case."}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "edited": false, "score": 0, "creation_date": 1533655363, "post_id": 51729995, "comment_id": 90421358, "body": "I changed my code to add space for the null character for the malloc call but my problem is still there. As soon as I break out of this while loop, hsearch(keys[0],FIND) is returning null when I have verified that in the while loop it wasn&#39;t null."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1533655655, "post_id": 51729995, "comment_id": 90421537, "body": "As pointed out by @user3386109, you should set <code>e.key=li;</code> before <code>ep=hsearch(e,ENTER);</code> because <code>hsearch</code> does not make a copy of the key string and you overwrite <code>line</code> for each entry."}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1533655936, "post_id": 51729995, "comment_id": 90421707, "body": "@user3386109 even though e.key is already set to equal to line at this point and I&#39;m literally copying that string via strcpy(li,line) updating the e.key to equal li for some reason fixed the problem. How is an assignment and strcpy different? Why would a second assignment of li be needed?"}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1533656015, "post_id": 51729995, "comment_id": 90421754, "body": "@IanAbbott but e.key=line is set beforehand. You&#39;re right that e.key=li fixes it but I don&#39;t understand why. e.key is reset to line on each entry in the while loop."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1533656153, "post_id": 51729995, "comment_id": 90421844, "body": "<code>e.key</code> is just a pointer. So if you <code>hsearch(e, ENTER)</code> when <code>e.key</code> points to <code>line</code>, then every entry in the hash table points to <code>line</code>, and every entry in the hash table is the last string read by <code>fgets</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1533656266, "post_id": 51729995, "comment_id": 90421919, "body": "You probably also want to <a href=\"https://stackoverflow.com/questions/2693776\">remove the newline that <code>fgets</code> puts in the buffer</a>. Right now, all of the hash table keys have a newline at the end."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1533657328, "post_id": 51729995, "comment_id": 90422626, "body": "<code>hsearch(e, ENTER)</code> copies <code>e</code> into the hash table, but it does not make a copy of the string pointed to by <code>e.key</code>. You have <code>e.key</code> set to <code>line</code>, so when you call <code>fgets(line, sizeof(line), f)</code> again, you are overwriting the buffer for the key that is already in the hash table. So the old key will no longer match its hash code and a subsequent <code>hsearch(e,FIND)</code> for that key will fail. Also, as pointed out by @user3386109, you may want to remove the newline characters from the key before calling <code>hsearch</code> unless you want the newline to be part of the key."}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1533657820, "post_id": 51729995, "comment_id": 90422916, "body": "@IanAbbott That makes a lot of sense. I agree with everything you said"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1533657965, "post_id": 51729995, "comment_id": 90422993, "body": "You haven&#39;t initialized <code>keySize</code> anywhere."}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1533658174, "post_id": 51729995, "comment_id": 90423100, "body": "@user3386109 you&#39;re right about everything. Thanks for the help."}, {"owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1533658223, "post_id": 51729995, "comment_id": 90423122, "body": "@lurker it&#39;s a global variable initialized to 0 and the casting is allowed."}], "owner": {"reputation": 3, "user_id": 9882498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac92ae047330bca382a7bfab1f826e6?s=128&d=identicon&r=PG&f=1", "display_name": "Berlios", "link": "https://stackoverflow.com/users/9882498/berlios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533655787, "creation_date": 1533654286, "last_edit_date": 1533655787, "question_id": 51729995, "link": "https://stackoverflow.com/questions/51729995/fgets-breaks-glibc-hash-table-in-c", "title": "fgets breaks glibc hash table in C", "body": "<pre><code>#include &lt;search.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define HASHT_SIZE 2000000\n#define N 1000000\nchar *keys[N];\nint keySize;\n\nint main() {\n    ENTRY e, *ep;\n    hcreate(HASHT_SIZE);\n    FILE *f;\n    f = fopen(\"./map.txt\", \"r\");\n    char line[500], *li;\n    double dub;\n    while (fgets(line, sizeof(line), f)) {\n        e.key = line;\n        if (hsearch(e, FIND) == NULL) {\n            e.data = (void *)keySize;\n            li = malloc(strlen(e.key) * sizeof(char));\n            strcpy(li, line);\n            ep = hsearch(e, ENTER);\n            keys[keySize++] = li;\n            if (ep == NULL) {\n                printf(\"failure\");\n                exit(1);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>My problem is that lookups via <code>hsearch(e,FIND)</code> are returning <code>NULL</code> as soon as the next <code>while(fgets(line,sizeof(line),f))</code> is run. Why is that? Why does <code>hsearch(keys[0],FIND)</code> fail as soon as this <code>fgets</code> is called? How is the hash table forgetting the entry when <code>fgets</code> is called?</p>\n"}, {"tags": ["c", "string", "function", "segmentation-fault", "strstr"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1533652626, "post_id": 51729382, "comment_id": 90419513, "body": "I am lazy to dig into this code, but I suspect you are trying to write a string literal. <code>str</code> is array of pointers to literals."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1533652821, "post_id": 51729382, "comment_id": 90419651, "body": "I will not even take a look on it. You did not even bother to format it properly."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1533652870, "post_id": 51729382, "comment_id": 90419695, "body": "in place of xstrstr use library function strstr to analyze my code,it will be very much easy for you to go through my code"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1533653014, "post_id": 51729382, "comment_id": 90419799, "body": "Take the time to consistently indent and format your code.  Failure to do so makes your code almost unreadable - even to you."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1533653018, "post_id": 51729382, "comment_id": 90419804, "body": "I suggest you read and follow <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533653048, "post_id": 51729382, "comment_id": 90419832, "body": "You didn&#39;t initialize <code>cpy</code> and that&#39;s that."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1533653305, "post_id": 51729382, "comment_id": 90420006, "body": "sorry to all for my bad code , i will properly indent it and update it so it becomes easy to read."}], "answers": [{"tags": [], "owner": {"reputation": 704, "user_id": 10066306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0qwkzfjPgio/AAAAAAAAAAI/AAAAAAAAACw/Vwji8zvJWSw/photo.jpg?sz=128", "display_name": "Andre Motta", "link": "https://stackoverflow.com/users/10066306/andre-motta"}, "is_accepted": false, "score": -1, "last_activity_date": 1533653123, "last_edit_date": 1533653123, "creation_date": 1533652911, "answer_id": 51729527, "question_id": 51729382, "link": "https://stackoverflow.com/questions/51729382/using-self-made-strstr-function-to-check-an-embedded-string-in-some-other-stri/51729527#51729527", "title": "Using self made strstr() function to check an embedded string in some other string and then replacing it by some other string (input by user)", "body": "<p>Namely you are using strcpy to copy strings but your destiny string is just a pointer with no size. You need to do a malloc first. That's why it is giving you a segmentation fault error. Beware of pointers without memory allocation and it should work. Please update your code after this and if there is any other error I will edit this answer</p>\n\n<pre><code>char *cpy;\n</code></pre>\n\n<p>These variable is never initialized. But still you strcpy to it bellow.</p>\n\n<p>EDIT: just go with </p>\n\n<pre><code>cpy = malloc(strlen(sourcestring)+1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1533653136, "creation_date": 1533653136, "answer_id": 51729597, "question_id": 51729382, "link": "https://stackoverflow.com/questions/51729382/using-self-made-strstr-function-to-check-an-embedded-string-in-some-other-stri/51729597#51729597", "title": "Using self made strstr() function to check an embedded string in some other string and then replacing it by some other string (input by user)", "body": "<p>Two main problems \ncpy is not initalised</p>\n\n<pre><code> strcpy(cpy,temp);   \n</code></pre>\n\n<p>p points to the read only string literal and you write to it.</p>\n\n<pre><code> strcpy(p,str2);\n</code></pre>\n"}], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "closed_date": 1533652953, "accepted_answer_id": 51729597, "answer_count": 2, "score": -2, "last_activity_date": 1533653136, "creation_date": 1533652483, "last_edit_date": 1533653092, "question_id": 51729382, "link": "https://stackoverflow.com/questions/51729382/using-self-made-strstr-function-to-check-an-embedded-string-in-some-other-stri", "closed_reason": "Duplicate", "title": "Using self made strstr() function to check an embedded string in some other string and then replacing it by some other string (input by user)", "body": "<p>I am writing a program that uses an array of pointers to strings str[].It receives two strings str1 and str2 and check if str1 is embedded in any of the strings in str[].If str1 is found, then replace it with str2. for example: if str1 contains \"mountain\" and str2 contains \"car\", then the second string in str should get changed to \"Move a car\" .When i try to execute this program , in gcc it is crashing,and when i tried to compile it online it is giving segmentation fault ,i am not able to understand where this program went wrong and what correction is needed in this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nchar* xstrstr(char* ,char* );\nint main()\n{\nchar *str[]={\n                \"We will teach you how to...\",\n                \"Move a mountain\",\n                \"Level a building\",\n                \"Erase the past\",\n                \"Make a million\",\n                \"...all through C!\"\n            };\nchar* p, *temp, *cpy;\nint len,i,j;\nchar str1[28];\nchar str2[10];\nprintf(\"Enter string1\\n\");\nscanf(\"%s\",str1);\nprintf(\"Enter string 2\\n\");\nscanf(\"%s\",str2);\nprintf(\"After modifying the saved strings\\n\\n\");\nfor(i=0;i&lt;6;i++)\n{\n    p=xstrstr(str[i],str1);\n    if(p)\n    {\n       /*Copy the remaining string*/\n       temp=p+strlen(str1);\n       strcpy(cpy,temp);\n       /*Replace the old string*/\n       strcpy(p,str2);\n      /*Finally append the remaining part*/\n       strcat(p,cpy);\n       break;\n    }\n}\nif(p==NULL)\n{\n    printf(\"No string match found\\n\");\n    return 1;\n}\nfor(i=0;i&lt;6;i++)\n{\n    printf(\"%s\\n\",str[i]);\n}\nreturn 0;\n}\nchar* xstrstr(char *string1,char* string2)\n{\n    while(*string1)\n    {\n        char* begin=string1;\n        char* find=string2;\n\n           while((*string1)&amp;&amp;(*find)&amp;&amp;(*string1==*find))\n           {\n               string1++;\n               find++;\n           }\n           if(!(*find))\n           {\n               return begin;\n           }\n           string1=begin+1;\n    }\nreturn NULL;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "function", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1533651829, "creation_date": 1533651829, "answer_id": 51729137, "question_id": 51729005, "link": "https://stackoverflow.com/questions/51729005/change-string-value-from-another-function-in-main-in-c-using-pointers/51729137#51729137", "title": "Change string value from another function in main in C using pointers", "body": "<p>Two problems:</p>\n\n<ol>\n<li><p>In your function you reassign the pointer <code>final</code> to point somewhere into <code>original</code>. Reassignment won't work as the pointer is passed <em>by value</em>, and the assignment only changes the local variable.</p></li>\n<li><p>By modifying contents of <code>final</code> you also modify the contents of <code>original</code>.</p></li>\n</ol>\n\n<p>Both these issues could be solved by <em>copying</em> to <code>final</code> instead of reassigning where it points.</p>\n\n<p>Both these issues should also be easily detectable using <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">standard debugging practices</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 10044525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fc6c4aac87681b9c3215ae85152be1?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis Pavlidis", "link": "https://stackoverflow.com/users/10044525/panagiotis-pavlidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51729137, "answer_count": 1, "score": 0, "last_activity_date": 1533651881, "creation_date": 1533651442, "last_edit_date": 1533651881, "question_id": 51729005, "link": "https://stackoverflow.com/questions/51729005/change-string-value-from-another-function-in-main-in-c-using-pointers", "title": "Change string value from another function in main in C using pointers", "body": "<p>I have this code, and I want from a string that is stored in value called <code>original</code> such as <code>home$family$fun</code>, using the delimiter value such as <code>$</code>, assign to another string named <code>final</code> the word between the two delimiters.  That means that <code>final</code> should contain <code>family</code> and print the result from <code>main</code>. But the operation must be done in another function using only pointer and pointer arithmetic. Also the prototype of the <code>getPart</code> function must not be changed.</p>\n\n<p>My problem is that, I get this result to my variable <code>final</code> when I am inside the <code>getPart</code> function but when I am returning to <code>main</code> the final function have only '\\0' as value and not the value I wanted it. I think, the problem is something with the addresses, meaning that if the value which string's address change, then the value of string will be changed. But I am a bit confused...Could someone help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 32\n\nint getPart(char original[], char delimiter[], char final[]) {\n    int i, j;\n    int counter = 0;\n    int counter1 = 0;\n\n    for(i = 0; *(original + i) != '\\0'; i++) {\n        if(*(original + i) == *delimiter) {\n            counter++;\n        }\n    }\n\n    if(counter &gt; 1) {\n        for(i = 0; *(original + i) != '\\0'; i++) {\n            if(*(original + i) == *delimiter) {\n                if(counter1 &lt; 1) {\n                    final = (original + i + 1);\n                    counter1++;\n                }\n                else {\n                    for(j = 0; *(final + j) != '\\0'; j++) {\n                        if(strcmp(final + j,original + i) == 0) {\n                            *(final + j) = '\\0';\n                            *(final + j + 1) = '\\0';\n                            //final + j = '\\0';\n                        }\n                    }\n                }\n            }\n        }\n        return(1);\n    }\n    else {\n        return(0);\n    }\n}\n\nint main(int argc, char *argv[]) {\n    char original[SIZE], delimiter[SIZE], final[SIZE];\n    char format_str_or[20], format_str_del[20];\n    int counter, i;\n\n    for(i = 0; i &lt; SIZE; i++) {\n        *(final + i) = '\\0';\n    }\n\n    sprintf(format_str_or,\" %%%ds\",SIZE - 1);\n    printf(\"Enter string: \");\n    scanf(format_str_or,original);\n\n    sprintf(format_str_del,\" %%%ds\", SIZE - 1);\n    printf(\"Enter delimiter: \");\n    scanf(format_str_del,delimiter);\n\n    counter = getPart(original,delimiter,final);\n    printf(\"%d\\n\",counter);\n\n    if(counter == 1) {\n        printf(\"%s\\n\",final);\n    }\n    else if(counter == 0) {\n        printf(\"%s does not appear twice in %s\\n\",delimiter,original);\n    }\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "mqtt", "paho", "siddhi"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1533650527, "post_id": 51728627, "comment_id": 90417973, "body": "When you connect to the broker, the broker will only issue you with notifications when new data for the topics you have subscribed to arrive, so if nothing is updating the broker will send you nothing."}, {"owner": {"reputation": 554, "user_id": 6365567, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6e009f2961790816c664624e0ab35f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Candy", "link": "https://stackoverflow.com/users/6365567/candy"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1533650815, "post_id": 51728627, "comment_id": 90418181, "body": "@SPlatten you mean to try to send different data each time right. I tried doing it. It didn&#39;t work out actually.Actually the data is being sent but not published at siddhi"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1533650956, "post_id": 51728627, "comment_id": 90418272, "body": "no I didn&#39;t, MQTT there are two parts to it, a Broker which has topics and subscribers.  You are a subscriber, when the broker receives an update to a topic, any subscribers to that topic are notified of the new data."}], "owner": {"reputation": 554, "user_id": 6365567, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6e009f2961790816c664624e0ab35f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Candy", "link": "https://stackoverflow.com/users/6365567/candy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533719349, "creation_date": 1533650425, "last_edit_date": 1533719349, "question_id": 51728627, "link": "https://stackoverflow.com/questions/51728627/mqtt-messages-are-not-publishing-to-siddhi-from-c", "title": "Mqtt messages are not publishing to Siddhi from C", "body": "<p>I am trying to publish mqtt messages to Siddhi Stream processor. I could send the message from my C program and rc is 0. There is no connection issue but the message is not published to Siddhi.</p>\n\n<p>My C Code to publish mqtt messages is:</p>\n\n<pre><code>#define ADDRESS     \"tcp://test.mosquitto.org:1883\"\n#define CLIENTID    \"mqttClient\"\n#define TOPIC       \"mqttTopic\"\n#define PAYLOAD     \"Hello World!\"\n#define QOS         0\n#define TIMEOUT     30000L\n\nint main(int argc, char* argv[])\n{\nMQTTClient client;\nMQTTClient_connectOptions conn_opts = MQTTClient_connectOptions_initializer;\nMQTTClient_message pubmsg = MQTTClient_message_initializer;\nMQTTClient_deliveryToken token;\nint rc;\nint success;\n\nMQTTClient_create(&amp;client, ADDRESS, CLIENTID,MQTTCLIENT_PERSISTENCE_NONE, NULL);\nconn_opts.keepAliveInterval = 60;\nconn_opts.cleansession = 1;\n\nrc = MQTTClient_connect(client, &amp;conn_opts);\n\nif (rc!= MQTTCLIENT_SUCCESS)\n{\n    printf(\"Failed to connect, return code %d\\n\", rc);\n    exit(EXIT_FAILURE);\n}\nif(rc == 0){\n    pubmsg.payload = PAYLOAD;\n    pubmsg.payloadlen = strlen(\"hello\");\n    pubmsg.qos = QOS;\n    pubmsg.retained = 0;\n    success=MQTTClient_publish(client,TOPIC,pubmsg.payloadlen,\"hello\",pubmsg.qos,pubmsg.retained,NULL);  \n    printf(\"%d\\n\", success); \n}\n//MQTTClient_publishMessage(client, TOPIC, &amp;pubmsg, &amp;token);\nrc = MQTTClient_waitForCompletion(client, token, TIMEOUT);\nif(rc==0){\n    printf(\"Message with delivery token %d delivered\\n\", token);\n}else{\n    printf(\"Message not delivered\");\n}\nMQTTClient_disconnect(client, 10000);\nMQTTClient_destroy(&amp;client);\nreturn rc;\n}\n</code></pre>\n\n<p>I don't understand what is the mistake iam making. Any suggestion would really help me.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1533650407, "post_id": 51728585, "comment_id": 90417885, "body": "<code>double *TE; TE = &amp;T[i][j+1];</code> But thats only for current <code>i</code> and <code>j</code> which you have not initialized and therefore is undefined behaviour."}, {"owner": {"reputation": 710, "user_id": 5404647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-jjmTKjxjCFI/AAAAAAAAAAI/AAAAAAAAALY/4e9KpLVF_MQ/photo.jpg?sz=128", "display_name": "Norhther", "link": "https://stackoverflow.com/users/5404647/norhther"}, "edited": false, "score": 2, "creation_date": 1533650451, "post_id": 51728585, "comment_id": 90417922, "body": "I don\u2019t get what are you asking for, but in your code you initialize  TE = T[i][j+1] without initializing i nor j"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1533650507, "post_id": 51728585, "comment_id": 90417962, "body": "It&#39;s not possible without macros. You can make <code>TE</code> point to a specific element, but if you update <code>i</code> or <code>j</code> then <code>TE</code> still points to the same element it pointed to before. <i>And</i> I think it&#39;s better to use <code>T[i][j+1]</code> explicitly as it really show what you want and are doing."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1533650568, "post_id": 51728585, "comment_id": 90418005, "body": "Whats the problem with just using <code>T[i][j+1]</code>?"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1533650607, "post_id": 51728585, "comment_id": 90418042, "body": "You can&#39;t use &#39;m&#39; as an array initialiser because it isn&#39;t a constance"}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1533650689, "post_id": 51728585, "comment_id": 90418088, "body": "What do you mean by <i>points or act like the structure &quot;T[i][j+I]&quot;</i>? <code>T[i][j+1]</code> is not a structure at all, it&#39;s just a <code>double</code>. Sometimes it&#39;s hard to know how to describe something when you&#39;re a little foggy on the details, but if you&#39;re not clear about what you want to do then we have little chance of helping you."}, {"owner": {"reputation": 1077, "user_id": 7545157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZqbEb.jpg?s=128&g=1", "display_name": "Sven Kr&#252;ger", "link": "https://stackoverflow.com/users/7545157/sven-kr%c3%bcger"}, "edited": false, "score": 1, "creation_date": 1533654086, "post_id": 51728585, "comment_id": 90420509, "body": "When <code>j=29</code>, <code>j+1=30</code>. <code>T[i][30]</code> is causing undefined behaviour, because it just left the index boundary... I am referring to the loop headline of the nested loop."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 4890543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwHi.jpg?s=128&g=1", "display_name": "Pierre Podevin", "link": "https://stackoverflow.com/users/4890543/pierre-podevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1533659492, "last_edit_date": 1533659492, "creation_date": 1533656915, "answer_id": 51730833, "question_id": 51728585, "link": "https://stackoverflow.com/questions/51728585/c-how-to-point-an-array-structure-to-a-variable/51730833#51730833", "title": "C - How to point an array structure to a variable?", "body": "<p>There are several errors in your example that would provide it from being compiled (I guess it's maid to give us an idea of what the structure would look like). I'll try to write here a working version that would do something similar.</p>\n\n<pre><code>#ifdef MALLOC_ME\n\nint i, j, m;\nm = inputed_matrix_size;\n\ndouble **T = malloc(sizeof(double) * m * m);\n\n#else\n\n# define MATRIX_SIZE 30\nint i, j, m = MATRIX_SIZE;\ndouble T[MATRIX_SIZE][MATRIX_SIZE];\n\n#endif // MALLOC_ME\n\n// I'll assume we put some defined value in the first line, first column\n// that will be used as source in later calculation.\nT[0][0] = value;\ndouble *TE = &amp;T[0][0];\ndouble aE = some_indice_value;\n\nfor (i = 0 ; i &lt; m ; i++)\n  for (j = 0 ; j &lt; m ; j++)\n  {\n    if (i == 0 &amp;&amp; j == 0)\n      continue; // lets not override our template value;\n\n    T[i][j] = aE * (*TE); \n    // *TE is the double value contained at the position of the array stored earlier\n  }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10192303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af0e4f56884c8896a5ec1046de3d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "user10192303", "link": "https://stackoverflow.com/users/10192303/user10192303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533721117, "creation_date": 1533650246, "last_edit_date": 1533721117, "question_id": 51728585, "link": "https://stackoverflow.com/questions/51728585/c-how-to-point-an-array-structure-to-a-variable", "title": "C - How to point an array structure to a variable?", "body": "<p>I need to make a variable which receives the array <strong>format</strong>, but not the exact value of the array position. How can I do that? The example below shows what I want to do (not that it is working anyway, just to show my intent).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n    int i, j, m = 30;\n    double T[m][m], aE = 3, TE;\n\n    TE = T[i][j+1];\n\n    for (i = 1; i &lt; 30; i++)\n        for (j = 1; j &lt; 30; j++)\n            T[i][j] = (aE * TE);\n\n    getch();\n    return (0);\n}\n</code></pre>\n\n<p>Ok, the array will have a lot of <code>double</code> values, and I want that the <code>TE</code> points or acts like the structure <code>T[i][j+i]</code> so that I can use <code>TE</code> every time I need that position of the <code>T</code> array.</p>\n\n<p>How is this possible?</p>\n"}, {"tags": ["c", "segmentation-fault", "ada"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533653211, "post_id": 51728517, "comment_id": 90419946, "body": "This isn&#39;t C but C++."}, {"owner": {"reputation": 878, "user_id": 2208472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5aadcce7af2b2a724181ad22ec17d1?s=128&d=identicon&r=PG", "display_name": "Maxim Reznik", "link": "https://stackoverflow.com/users/2208472/maxim-reznik"}, "edited": false, "score": 0, "creation_date": 1533656921, "post_id": 51728517, "comment_id": 90422337, "body": "Try to launch it under gdb and see backtrace and CPU registers. This could help in understanding what&#39;s going wrong."}], "answers": [{"tags": [], "owner": {"reputation": 3643, "user_id": 608963, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fbb0a6e7d0e30d4904a3a22a7398c969?s=128&d=identicon&r=PG&f=1", "display_name": "Shark8", "link": "https://stackoverflow.com/users/608963/shark8"}, "is_accepted": false, "score": 0, "last_activity_date": 1533779381, "creation_date": 1533779381, "answer_id": 51757776, "question_id": 51728517, "link": "https://stackoverflow.com/questions/51728517/ada-with-c-function-import-seg-faults/51757776#51757776", "title": "Ada with C function import Seg Faults", "body": "<ol>\n<li>Clean out everything; delete the objects you have laying around.</li>\n<li>Rebuild both; ensure that both C and Ada are built with the same architecture (32-bit vs 64-bit).</li>\n<li>If that doesn't work, try using <code>C_Plus_Plus</code> convention in Ada.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 430, "user_id": 8881097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W1Apu.jpg?s=128&g=1", "display_name": "Jacob Sparre - at CLDK", "link": "https://stackoverflow.com/users/8881097/jacob-sparre-at-cldk"}, "is_accepted": false, "score": 1, "last_activity_date": 1533819742, "creation_date": 1533819742, "answer_id": 51767790, "question_id": 51728517, "link": "https://stackoverflow.com/questions/51728517/ada-with-c-function-import-seg-faults/51767790#51767790", "title": "Ada with C function import Seg Faults", "body": "<p>You could regenerate the binding to the C++ function using the <code>-fdump-ada-spec</code> flag for GCC/G++.  That way you get a binding which the compiler developers believe will work correctly with that version of GCC.  (The official requirement is that you use the same version of GCC for compiling both Ada and C++, but in practice you may get something that works with a slightly wider variety of compiler versions.)</p>\n"}], "owner": {"reputation": 23, "user_id": 10139190, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--0aN21RL8IE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rAsjAawUn4XUcAulJzykHIoOgf5Q/mo/photo.jpg?sz=128", "display_name": "JDiGz", "link": "https://stackoverflow.com/users/10139190/jdigz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1533819742, "creation_date": 1533650040, "question_id": 51728517, "link": "https://stackoverflow.com/questions/51728517/ada-with-c-function-import-seg-faults", "title": "Ada with C function import Seg Faults", "body": "<p>I have a program that I am working on in Ada that was recently upgraded from 32bit to 64bit. I didn't write this code I'm just responsible for getting it to work on a 64bit version of RedHat.</p>\n\n<p>I am still working through bugs that were caused by this migration. This code is seg faulting and it wasn't before.</p>\n\n<p>This is the Ada function</p>\n\n<pre><code>function Read_Fields\n  (table         : DB_API_Types.DB_Table_Type;\n   key           : System.Address;\n   return_fields : System.Address;\n   function      : Process_DB_Access_Type;\n   client        : System.Address)\nreturn C_Types.Int;\npragma Interface(C, Read_Fields);\npragma Import_Function\n  (Internal =&gt; Read_Fields,\n   External =&gt; \"GetFields\",\n   Result_Type =&gt; C_Types.Int);\n</code></pre>\n\n<p>Here is the C function</p>\n\n<pre><code>int GetFields ( DB::table_code table_type, char *key,\n        char **return_fields, DB::GetFieldCB function,\n        void *client) {\n  return ( DB::System::Ptr()-&gt;get_fields(table_type, key, return_fields, func, client)); \n}\n</code></pre>\n\n<p>Here is an example call of this function within Ada</p>\n\n<pre><code>DB_Status :=\n   Read_Fields\n     (table         =&gt; table,\n      key           =&gt; c_types.null_terminated.to_address_or_null_pointer(field),\n      return_fields =&gt; table_Fields'address,\n      function      =&gt; Process_Data'access,\n      client        =&gt; read_Data_Return'address);\n</code></pre>\n\n<p>This has me a bit stumped, I have my suspicions but I'm not sure how memory addresses work across language interfaces. I assumed that they would all be in one process as machine language so it shouldn't matter at all but I may be missing something.</p>\n\n<p>Any help would be great!</p>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation", "dynamic-arrays", "realloc"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1533650030, "post_id": 51728480, "comment_id": 90417570, "body": "You cant print an address with <code>%i</code> use <code>%p</code>."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1533650101, "post_id": 51728480, "comment_id": 90417632, "body": "realloc doesn&#39;t allocate empty memory, it just reserves a block of memory for use, with whatever is already in that memory area.  If you want it to be cleared then you should memset the new area with 0 before use."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533650283, "post_id": 51728480, "comment_id": 90417785, "body": "Shouldn&#39;t you in <code>data beeing added</code> do <code>memcpy(&amp;arrayLst-&gt;data[arrayLst-&gt;length * arrayLst-&gt;dataSize], data, arrayLst-&gt;dataSize);</code>. You are assigning just one byte there, thought arrayLst-&gt;data represent an array each of arrayLst-&gt;dataSize size. You are just lucky that you are assinging int&#39;s and all the other bytes are zero."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533650768, "post_id": 51728480, "comment_id": 90418146, "body": "Instead of <code>arrayLst = memset(arrayLst,0, sizeof(arrayLst));</code>, I&#39;d expect <code>memset(arrayLst,0, sizeof *arrayLst);</code>.  (Notice size part)"}, {"owner": {"reputation": 36, "user_id": 9993847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9a9926c0ba5b13c4d170ff483771ff?s=128&d=identicon&r=PG&f=1", "display_name": "Your move creep", "link": "https://stackoverflow.com/users/9993847/your-move-creep"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1533657086, "post_id": 51728480, "comment_id": 90422436, "body": "@KamilCuk Thanks, that solved it. I always tend to make stupid mistakes :) Thank you for your time and advice everyone"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1533650150, "creation_date": 1533650150, "answer_id": 51728564, "question_id": 51728480, "link": "https://stackoverflow.com/questions/51728480/realloc-introduces-random-values-in-my-dynamic-array/51728564#51728564", "title": "Realloc() introduces random values in my dynamic array", "body": "<p>If you allocate memory through <code>malloc</code>, or increasing the amount through <code>realloc</code>, the contents of the (new) memory is <em>indeterminate</em> and seemingly random. Don't use it except to initialize it.</p>\n"}], "owner": {"reputation": 36, "user_id": 9993847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9a9926c0ba5b13c4d170ff483771ff?s=128&d=identicon&r=PG&f=1", "display_name": "Your move creep", "link": "https://stackoverflow.com/users/9993847/your-move-creep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "closed_date": 1533652256, "answer_count": 1, "score": -1, "last_activity_date": 1533656736, "creation_date": 1533649923, "last_edit_date": 1533656736, "question_id": 51728480, "link": "https://stackoverflow.com/questions/51728480/realloc-introduces-random-values-in-my-dynamic-array", "closed_reason": "Duplicate", "title": "Realloc() introduces random values in my dynamic array", "body": "<p>UPDATE: Not a duplicate. As Kamil Cuk pointed out in the comments I should have used memcpy() instead of assigning a pointer! Thanks for your time</p>\n\n<p>I am writing a dynamic array using <code>realloc()</code> to scale it. In my function <code>addToList()</code> I add correct values to correct pointers (check program output) but when I use <code>getFromList()</code> and print out all the values previously assigned, most of them are correct but some are wrong (check output), strangely the amount of wrong values is equal to how many times <code>realloc()</code> was used but these values are at completely random intervals! (<code>realloc()</code> exits successfully). I have no idea why these random values pop up, any help will be highly appreciated</p>\n\n<p>Calling these functions:</p>\n\n<pre><code>//TEST\narrayList list;\nif(initList(&amp;list,sizeof(int))!=0){\n    printf(\"List init failed\");\n    exit(1);\n}\nint tempNum = 38;\nint i = 0;\nwhile(1){\n    tempNum+=1;\n    if(addToList(&amp;list,&amp;tempNum)!=0){\n        printf(\"Failed to add to list\");\n        exit(1);\n    }\n    //sleep(1);\n\n    //Break after 31 values assigned\n    if(i&gt;=30){\n        break;\n    }\n    i++;\n}\n//Print the 31 values previously assigned\nfor(int i = 0;i&lt;=30;i++){\n    //Get data at index\n    int *num = NULL;\n    num = getFromList(&amp;list,i);\n    //Check errors\n    if(num==NULL){\n        //ERROR\n        exit(1);\n    }\n    //Print data\n    printf(\"Data: %i  \",*num);\n    printf(\"Location in memory: %i\\n\", num);\n}\n</code></pre>\n\n<p>Function definitions:</p>\n\n<pre><code>int initList(arrayList *arrayLst, size_t dataSize){\n    printf(\"Initializing a list\\n\");\n    //Allocate memory for list struct itself\n    arrayLst = memset(arrayLst,0, sizeof(arrayLst));\n\n    //Allocate memory for first block (depends on increments defined in .h file)\n    char *tempDataMallocPtr;\n    if((tempDataMallocPtr = malloc((arrayLst-&gt;dataSize)*listIncrement))==NULL){\n        return 1;\n    }\n    arrayLst-&gt;data = tempDataMallocPtr;\n\n    //Initialize values\n    arrayLst-&gt;length = 0;\n    arrayLst-&gt;dataSize = dataSize;\n    arrayLst-&gt;allocated = listIncrement;\n\n    return 0;\n\n}\n\nint addToList(arrayList *arrayLst, void *data){\n\n    //Check if enough space\n    if(arrayLst-&gt;allocated &gt; arrayLst-&gt;length){\n        //Enough memory\n        //printf(\"Enough memory\\n\");\n    }else{\n        //Reallocating memory\n        printf(\"Not enough memory reallocating\\n\");\n        printf(\"New memory size = %i\\n\", ((arrayLst-&gt;allocated)*(arrayLst-&gt;dataSize) + (arrayLst-&gt;dataSize)*listIncrement));\n        fflush(stdout);\n        int newSize = (arrayLst-&gt;allocated)*(arrayLst-&gt;dataSize) + (arrayLst-&gt;dataSize)*listIncrement;\n        char *tempReallocPtr;\n        //Realloc() error checking\n        if ((tempReallocPtr = realloc((arrayLst-&gt;data), newSize))==NULL){\n            printf(\"Realloc failed in arrayList\\n\");\n            return 1;\n        }\n        arrayLst-&gt;data = tempReallocPtr;\n        arrayLst-&gt;allocated = newSize/(arrayLst-&gt;dataSize);\n    }\n\n    //Get pointer for last data index and set it to data provided\n    printf(\"Adding data at pointer: Pointer address = %i    \", (arrayLst-&gt;data)+((arrayLst-&gt;length)*(arrayLst-&gt;dataSize)));\n    printf(\"data being added %i    \",*((char*)data));\n    *((arrayLst-&gt;data)+((arrayLst-&gt;length)*(arrayLst-&gt;dataSize))) = *((char*)data);\n    (arrayLst-&gt;length)+=1;\n\n    printf(\"Added to list\\n\");\n    //Success\n    return 0;\n\n}\n\nvoid* getFromList(arrayList *arrayLst, int index){\n    //Check if index correct\n    if(index&lt;(arrayLst-&gt;length) &amp;&amp; index&gt;=0){\n        //Correct\n        return (arrayLst-&gt;data+index*(arrayLst-&gt;dataSize));\n    }else{\n        //ERROR\n        fprintf(stderr, \"Wrong index in arrayList\\n\");\n        return NULL;\n    }\n}\n</code></pre>\n\n<p>arrayList typedef:</p>\n\n<pre><code>typedef struct _arrayList{\n    char *data;\n    size_t dataSize;\n    int allocated; //Memory allocated\n    int length;  //Numbers inside the list \n}arrayList;\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>gcc -o server.exe server.c arrayList.c\n./server.exe\nInitializing a list\nAdding data at pointer: Pointer address = -78895424    data being added 39    Added to list\nAdding data at pointer: Pointer address = -78895420    data being added 40    Added to list\nAdding data at pointer: Pointer address = -78895416    data being added 41    Added to list\nAdding data at pointer: Pointer address = -78895412    data being added 42    Added to list\nAdding data at pointer: Pointer address = -78895408    data being added 43    Added to list\nNot enough memory reallocating\nNew memory size = 40\nAdding data at pointer: Pointer address = -78895404    data being added 44    Added to list\nAdding data at pointer: Pointer address = -78895400    data being added 45    Added to list\nAdding data at pointer: Pointer address = -78895396    data being added 46    Added to list\nAdding data at pointer: Pointer address = -78895392    data being added 47    Added to list\nAdding data at pointer: Pointer address = -78895388    data being added 48    Added to list\nNot enough memory reallocating\nNew memory size = 60\nAdding data at pointer: Pointer address = -78895384    data being added 49    Added to list\nAdding data at pointer: Pointer address = -78895380    data being added 50    Added to list\nAdding data at pointer: Pointer address = -78895376    data being added 51    Added to list\nAdding data at pointer: Pointer address = -78895372    data being added 52    Added to list\nAdding data at pointer: Pointer address = -78895368    data being added 53    Added to list\nNot enough memory reallocating\nNew memory size = 80\nAdding data at pointer: Pointer address = -78895364    data being added 54    Added to list\nAdding data at pointer: Pointer address = -78895360    data being added 55    Added to list\nAdding data at pointer: Pointer address = -78895356    data being added 56    Added to list\nAdding data at pointer: Pointer address = -78895352    data being added 57    Added to list\nAdding data at pointer: Pointer address = -78895348    data being added 58    Added to list\nNot enough memory reallocating\nNew memory size = 100\nAdding data at pointer: Pointer address = -78895344    data being added 59    Added to list\nAdding data at pointer: Pointer address = -78895340    data being added 60    Added to list\nAdding data at pointer: Pointer address = -78895336    data being added 61    Added to list\nAdding data at pointer: Pointer address = -78895332    data being added 62    Added to list\nAdding data at pointer: Pointer address = -78895328    data being added 63    Added to list\nNot enough memory reallocating\nNew memory size = 120\nAdding data at pointer: Pointer address = -78895324    data being added 64    Added to list\nAdding data at pointer: Pointer address = -78895320    data being added 65    Added to list\nAdding data at pointer: Pointer address = -78895316    data being added 66    Added to list\nAdding data at pointer: Pointer address = -78895312    data being added 67    Added to list\nAdding data at pointer: Pointer address = -78895308    data being added 68    Added to list\nNot enough memory reallocating\nNew memory size = 140\nAdding data at pointer: Pointer address = -78895304    data being added 69    Added to list\nData: 39  Location in memory: -78895424\nData: 40  Location in memory: -78895420\nData: 41  Location in memory: -78895416\nData: 42  Location in memory: -78895412\nData: 43  Location in memory: -78895408\nData: 44  Location in memory: -78895404\nData: 133421  Location in memory: -78895400\nData: 46  Location in memory: -78895396\nData: 47  Location in memory: -78895392\nData: 48  Location in memory: -78895388\nData: 133425  Location in memory: -78895384\nData: 50  Location in memory: -78895380\nData: 51  Location in memory: -78895376\nData: 52  Location in memory: -78895372\nData: 53  Location in memory: -78895368\nData: 54  Location in memory: -78895364\nData: 55  Location in memory: -78895360\nData: 56  Location in memory: -78895356\nData: 133433  Location in memory: -78895352\nData: 58  Location in memory: -78895348\nData: 59  Location in memory: -78895344\nData: 60  Location in memory: -78895340\nData: 133181  Location in memory: -78895336\nData: 62  Location in memory: -78895332\nData: 63  Location in memory: -78895328\nData: 64  Location in memory: -78895324\nData: 133185  Location in memory: -78895320\nData: 66  Location in memory: -78895316\nData: 67  Location in memory: -78895312\nData: 68  Location in memory: -78895308\nData: 133189  Location in memory: -78895304\n</code></pre>\n"}, {"tags": ["c", "string", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1533650047, "post_id": 51728431, "comment_id": 90417588, "body": "<a href=\"https://stackoverflow.com/q/38325884/2173917\">regarding <code>fflush(stdin);</code></a>"}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1533650064, "post_id": 51728431, "comment_id": 90417599, "body": "<code>scanf(&quot;%c&quot;, &amp;initial);</code> in this statement add a space before <code>%</code> --&gt; &#39;scanf(&quot; %c&quot;, &amp;initial);`"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1533650297, "post_id": 51728431, "comment_id": 90417797, "body": "The clue is in the output...why is your age on a separate line to your surname?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10147208"}, "edited": false, "score": 0, "creation_date": 1533650891, "post_id": 51728431, "comment_id": 90418233, "body": "I replaced \\t with a \\n wherever required. I was suppose to be using that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10147208"}, "edited": false, "score": 0, "creation_date": 1533650999, "post_id": 51728431, "comment_id": 90418307, "body": "Thanks a lot. It worked."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533651237, "post_id": 51728431, "comment_id": 90418490, "body": "<code>scanf(&quot;%18[^\\n]s&quot;, yourname);</code> --&gt; <code>scanf(&quot;%19[^\\n]&quot;, yourname);</code>  (19 and no s).    <code>yourname[19] = &#39;\\0&#39;;</code> not that useful here - better to check return value of <code>scanf()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1533651354, "post_id": 51728431, "comment_id": 90418582, "body": "Curious, why a leading space in <code>scanf(&quot; %d&quot;,&amp;yourage);</code>, but not one in <code>scanf(&quot;%c&quot;, &amp;initial);</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10147208"}, "edited": false, "score": 0, "creation_date": 1533651722, "post_id": 51728431, "comment_id": 90418842, "body": "That leading space in scanf(&quot; %d&quot;,&amp;yourage);unnecessary however it is required in scanf(&quot;%c&quot;, &amp;initial);"}], "owner": {"user_type": "does_not_exist", "display_name": "user10147208"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1533649965, "answer_count": 0, "score": 0, "last_activity_date": 1533650814, "creation_date": 1533649779, "last_edit_date": 1533650814, "question_id": 51728431, "link": "https://stackoverflow.com/questions/51728431/how-do-i-accept-my-initial-as-input-and-print-along-with-my-name-in-c", "closed_reason": "Duplicate", "title": "How do I accept my initial as input and print along with my name in C?", "body": "<p>I have been struggling to print my full name in the C language from past several days. After several tries this is what I came up with.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char yourname[20];\n    int yourage;\n    char initial;\n\n    printf(\"Whats your name? \");\n    scanf(\"%18[^\\n]s\", yourname);\n\n    printf(\"And your initial is? \");\n    scanf(\"%c\", &amp;initial);\n\n    yourname[19] = '\\0';\n    fflush(stdin);\n\n    printf(\"How old are you? \");\n    scanf(\" %d\",&amp;yourage);\n\n    printf(\"Your name is %s %c and you are %i years old.\\n\", yourname, \n    initial, yourage);\n\n\n    return(0);\n}\n</code></pre>\n\n<p>When I compile and run the program, this is what I get. I am compiling with full warning turned on like so</p>\n\n<pre><code>make name\n\nclang -fsanitize=signed-integer-overflow -fsanitize=undefined -ggdb3 -O0 - \nstd=c11 -Wall -Werror -Wextra -Wno-sign-compare -Wshadow    name.c  -lcrypt - \n-lm -o name\n</code></pre>\n\n<p>Please help..</p>\n\n<pre><code>Whats your name?        Alokananda\nAnd your initial is? How old are you?   35\nYour name is Alokananda \nand you are 35 years old.\n</code></pre>\n"}, {"tags": ["c", "list", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533648236, "post_id": 51727909, "comment_id": 90416224, "body": "<code>fruits *newNode = malloc(sizeof(fruits));     strcpy(newNode-&gt;name, name);</code> allocates memory for the struct but the pointer in it is not pointing to valid memory."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10192070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cefe703797529bb25e1db7cba275ae?s=128&d=identicon&r=PG&f=1", "display_name": "ps1234", "link": "https://stackoverflow.com/users/10192070/ps1234"}, "edited": false, "score": 0, "creation_date": 1533649528, "post_id": 51727967, "comment_id": 90417218, "body": "Thanks for the quick reply"}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1533649316, "last_edit_date": 1533649316, "creation_date": 1533648427, "answer_id": 51727967, "question_id": 51727909, "link": "https://stackoverflow.com/questions/51727909/c-program-error-segmentation-fault-core-dumped/51727967#51727967", "title": "C program Error - Segmentation fault (core dumped)", "body": "<p>You are getting segmentation fault because you are accessing <code>newNode-&gt;name</code> pointer without allocating memory to it in <code>create_node()</code>:</p>\n\n<pre><code>    strcpy(newNode-&gt;name, name);\n</code></pre>\n\n<p>Allocate memory to <code>newNode-&gt;name</code> and then copy <code>name</code> to it:</p>\n\n<pre><code>newNode-&gt;name = malloc(MAX_NAME_LEN);\nif (newNode-&gt;name == NULL)\n    exit (EXIT_FAILURE);\n\nstrcpy(newNode-&gt;name, name);\n</code></pre>\n\n<p>With this, make sure to free the memory allocated to <code>name</code> pointer before freeing the node. </p>\n\n<p>As an alternative, you can have <code>name</code> as <code>char</code> array instead of pointer in structure <code>fruits</code>:</p>\n\n<pre><code>typedef struct fruits {\n    char name[MAX_NAME_LEN];\n    ....\n    .... \n</code></pre>\n\n<p>With this, you don't need separately allocate/deallocate memory to <code>name</code>. </p>\n\n<hr>\n\n<p>Additional:</p>\n\n<p>Follow good programming practice, always check the <code>malloc</code> return:</p>\n\n<pre><code>fruits *newNode = malloc(sizeof(fruits));\nif (newNode == NULL)\n    exit (EXIT_FAILURE);\n.....\n.....\n</code></pre>\n\n<p>Make sure to free the dynamically allocated memory once you are done with it. I do not see any where you are freeing the list nodes after printing them.</p>\n"}, {"tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 1, "last_activity_date": 1533648509, "creation_date": 1533648509, "answer_id": 51728001, "question_id": 51727909, "link": "https://stackoverflow.com/questions/51727909/c-program-error-segmentation-fault-core-dumped/51728001#51728001", "title": "C program Error - Segmentation fault (core dumped)", "body": "<pre><code>fruits *create_node(char name[MAX_NAME_LEN], int value)\n{\n    fruits *newNode = malloc(sizeof(fruits));\n    strcpy(newNode-&gt;name, name);\n    newNode-&gt;price = value;\n    newNode-&gt;next = NULL;\n\n    return newNode;\n}\n</code></pre>\n\n<p>Here you allocate memory for the struct but not for the name. You have to either allocate memory for the name or change the type from pointer to a fixed size array:</p>\n\n<pre><code>typedef struct fruits \n{\n    char name[MAX_NAME_LEN];\n    int price;\n    struct fruits *next;\n}fruits;\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10192070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cefe703797529bb25e1db7cba275ae?s=128&d=identicon&r=PG&f=1", "display_name": "ps1234", "link": "https://stackoverflow.com/users/10192070/ps1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1876, "favorite_count": 0, "accepted_answer_id": 51727967, "answer_count": 2, "score": 0, "last_activity_date": 1539292275, "creation_date": 1533648183, "last_edit_date": 1539292275, "question_id": 51727909, "link": "https://stackoverflow.com/questions/51727909/c-program-error-segmentation-fault-core-dumped", "title": "C program Error - Segmentation fault (core dumped)", "body": "<p>I wanted to practice linked lists and so created a small program that would create a linked list. The program compiles fine using gcc but when i run the program, it works fine till line 13 in main() (scanf(\"%d\", &amp;value1)) after which it prints the error message - \"segmentation fault (core dumped)\".\nI added a print statement in my own testing after line 13 and it doesn't get printed (hence my assumption that the problem arrises after scanf which I dont know why).</p>\n\n<p>So what am I doing wrong?</p>\n\n<pre><code>// Creates n numbers of nodes in a linked list where n is the argument \n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_NAME_LEN 25\n\ntypedef struct fruits {\n    char *name;\n    int price;\n    struct fruits *next;\n}fruits;\n\nint check_format(int argc, char **argv);\nfruits *create_node(char name[MAX_NAME_LEN], int value);\nvoid print_nodes(fruits *head);\n\nint check_format(int argc, char **argv) {\n\n    if (argc == 2) {\n        int argument = atoi(argv[1]);\n        if (argument &gt; 0) {\n            return 1;\n        } else {\n            return 0;\n        }\n    } else {\n        return 0;\n    }\n}\n\nfruits *create_node(char name[MAX_NAME_LEN], int value) {\n\n    fruits *newNode = malloc(sizeof(fruits));\n    strcpy(newNode-&gt;name, name);\n    newNode-&gt;price = value;\n    newNode-&gt;next = NULL;\n\n    return newNode;\n}\n\nvoid print_nodes(fruits *head) {\n\n    fruits * curr = head;\n    while (curr != NULL) {\n        printf(\"%s is %d\\n\", head-&gt;name, head-&gt;price);\n        curr = curr-&gt;next;\n    }\n}\n\nint main(int argc, char **argv) {\n\n    int valid_format = check_format(argc, argv);\n\n    fruits *curr = NULL;\n    fruits *head = curr;\n    if (valid_format) {\n        int number_of_nodes;\n        char fruitName[MAX_NAME_LEN] = {\"\"};\n        int value1 = 0;\n\n        number_of_nodes = atoi(argv[1]);\n        while (number_of_nodes) {\n\n            printf(\"Enter the fruit name: \");\n            scanf(\"%s\", fruitName);\n\n            printf(\"Enter the fruit price: \");\n            scanf(\"%d\", &amp;value1);\n\n            curr = create_node(fruitName, value1);\n            curr = curr-&gt;next;\n            number_of_nodes--;\n        }\n    } else {\n        fprintf(stderr, \"%s\", \"Usage: ./linked_lists [non-negative integer greater than 0]\\n\");\n    }\n    print_nodes(head);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "avr"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1533646923, "post_id": 51727387, "comment_id": 90415220, "body": "Is this C or C++?"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1533646929, "post_id": 51727387, "comment_id": 90415230, "body": "<code>c++</code> tag seems redundant here as this is pure <code>C</code>."}, {"owner": {"reputation": 597, "user_id": 642697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed83c3c0bba4ea6f2e52cdc52a15cf7f?s=128&d=identicon&r=PG", "display_name": "Andy P", "link": "https://stackoverflow.com/users/642697/andy-p"}, "edited": false, "score": 0, "creation_date": 1533647071, "post_id": 51727387, "comment_id": 90415330, "body": "if you are 100% sure the readString() function is not reading into the array, then the problem likely lies in the getByte() function.  Are you sure you are actually waiting for data to be received?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1533647454, "post_id": 51727387, "comment_id": 90415610, "body": "@Eljay: Did  you read which platform this is? Your recommendation is complete overkill and a no-go on such platforms. And whether <code>NUL</code> is a valid character depends on the definition of the line protocol. In text-based systems it&#39;s often not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1533647605, "post_id": 51727387, "comment_id": 90415716, "body": "Remove the tag of the unrelated language. C and C++ are different languages. Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1533651361, "post_id": 51727387, "comment_id": 90418588, "body": "Please do not edit your question all the time. This makes it a moving target and each hint is useless after a few minutes. That does not attract people to help."}, {"owner": {"reputation": 597, "user_id": 642697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed83c3c0bba4ea6f2e52cdc52a15cf7f?s=128&d=identicon&r=PG", "display_name": "Andy P", "link": "https://stackoverflow.com/users/642697/andy-p"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533651657, "post_id": 51727387, "comment_id": 90418796, "body": "@Gerhardh Spot on, its changed so many times it may as well be a living evolving creature at this point."}, {"owner": {"reputation": 11, "user_id": 9146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2becbba1b91b876d0b71bf03ffd7820c?s=128&d=identicon&r=PG&f=1", "display_name": "Rufusy", "link": "https://stackoverflow.com/users/9146544/rufusy"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533651783, "post_id": 51727387, "comment_id": 90418887, "body": "@Gerhardh Ok. I am not changing anything now"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533652715, "post_id": 51727387, "comment_id": 90419570, "body": "There are answers posted that point out the problem with the sizeof. Please do not radically edit the post, as that invalidates posted answers. Instead, if you have a follow-up question after fixing the bug, please post a new question. Link to this one if needed. I have made a rollback of the changes so that the posted answers make sense."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1533760295, "post_id": 51727387, "comment_id": 90470005, "body": "With <code>sizeof(string)</code> being 4 or 8 it would still send a few bytes. And it would not work for sending &quot;Hello&quot; either. There must be some other problem as well."}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 642697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed83c3c0bba4ea6f2e52cdc52a15cf7f?s=128&d=identicon&r=PG", "display_name": "Andy P", "link": "https://stackoverflow.com/users/642697/andy-p"}, "edited": false, "score": 0, "creation_date": 1533647210, "post_id": 51727497, "comment_id": 90415452, "body": "You are correct, but if the data isn&#39;t even stored in the array in the first place, he hasn&#39;t even got as far as encountering this problem."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "reply_to_user": {"reputation": 597, "user_id": 642697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed83c3c0bba4ea6f2e52cdc52a15cf7f?s=128&d=identicon&r=PG", "display_name": "Andy P", "link": "https://stackoverflow.com/users/642697/andy-p"}, "edited": false, "score": 1, "creation_date": 1533649252, "post_id": 51727497, "comment_id": 90416999, "body": "@AndyP I&#39;m not sure that the author is &quot;sure&quot; that it&#39;s not stored in the array. The example code tries to send the &quot;test&quot; string anyway."}, {"owner": {"reputation": 597, "user_id": 642697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed83c3c0bba4ea6f2e52cdc52a15cf7f?s=128&d=identicon&r=PG", "display_name": "Andy P", "link": "https://stackoverflow.com/users/642697/andy-p"}, "edited": false, "score": 0, "creation_date": 1533650189, "post_id": 51727497, "comment_id": 90417702, "body": "The example didn&#39;t send the test string when I commented - it&#39;s since been edited :("}], "tags": [], "owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1533646885, "creation_date": 1533646885, "answer_id": 51727497, "question_id": 51727387, "link": "https://stackoverflow.com/questions/51727387/store-a-series-of-characters-in-a-char-array-one-at-a-time/51727497#51727497", "title": "Store a series of characters in a char array one at a time", "body": "<p><code>uint8_t len = sizeof(string);</code> is not doing what you think it's doing. <code>len</code> here will hold the size of a <code>string</code> pointer (i.e. it's the same as <code>sizeof(uint8_t*)</code>), not the size of the passed array. You need to pass the length as an additional function parameter to get what you want.</p>\n"}], "owner": {"reputation": 11, "user_id": 9146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2becbba1b91b876d0b71bf03ffd7820c?s=128&d=identicon&r=PG&f=1", "display_name": "Rufusy", "link": "https://stackoverflow.com/users/9146544/rufusy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533652733, "creation_date": 1533646612, "last_edit_date": 1533652733, "question_id": 51727387, "link": "https://stackoverflow.com/questions/51727387/store-a-series-of-characters-in-a-char-array-one-at-a-time", "title": "Store a series of characters in a char array one at a time", "body": "<p>I am implementing USART communication in AVR.The following function is supposed to receive characters and store them in a char array defined in the main function.</p>\n\n<pre><code>    void readString(uint8_t string[], uint8_t maxLength)\n{\n    uint8_t idx = 0;\n    uint8_t data;\n    while(idx &lt; (maxLength-1))      // prevent overruns\n    {\n        data = getByte();   \n        transmitByte(data);         // echo the received characters \n        if(data == '\\n') break;     // check if enter key is pressed\n        else{\n            string[idx] = data;\n            idx++;\n        }   \n    }\n    string[idx] = 0;                // insert a null character\n}\n</code></pre>\n\n<p>Here is the main function:</p>\n\n<pre><code>int main(){\n\ninitUSART();        // initialize usart \n\n\nuint8_t* newString = \"Hello\";  // test string\n\nuint8_t mString[55];    // store the received characters\n\nreadString(mString, 55);    // read array of characters\n\nfor(;;){\n\n    transmitString(newString);\n    _delay_ms(DELAY);\n\n}\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>The function below is then supoosed to transmit the received char array back to the USART line</p>\n\n<pre><code>  void transmitString(uint8_t* string){\n    uint8_t i;\n    uint8_t len = sizeof(string);\n    for(i=0; i&lt;len; i++){\n        transmitByte(string[i]);\n    }\n}\n</code></pre>\n\n<p>The problem is that the <strong>trannsmitString function</strong> gets nothing to send. I know my <strong>readString function</strong> is not saving the characters into <strong>mString array</strong> declared in the main function. The <strong>getByte function</strong>  works properly. I am able to receive and send a single character but not a string. I can only echo back the received characters one by one. I am having problems inserting these characters into the array for further operations. Using the already declared string, test string,  the function transmits just fine.</p>\n\n<p>Kindly help me out with this problem. </p>\n"}, {"tags": ["c", "in-app-purchase", "microcontroller", "stm32", "ota"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1533644349, "post_id": 51726592, "comment_id": 90413455, "body": "Is programming via YMODEM the normal thing to do for this dev board?"}, {"owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1533644549, "post_id": 51726592, "comment_id": 90413584, "body": "the code provided in package i downloaded from ST website uses this protocol. It is only software implementation of YMODEM so HW shouldn&#39;t affect it. And YMODEM is sending 1kB packets of data that is automatically written to flash, because sending whole compiled firmware file may require external flash to store before wtiting on to STM32 internal flash"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533644639, "post_id": 51726592, "comment_id": 90413650, "body": "And you think that STM builtin bootloader does not have its own protocol? You receive some header with the informations for the bootloader. It does not work like this (1k packets and it saves). Read the APnotes carefully."}, {"owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "edited": false, "score": 0, "creation_date": 1533644760, "post_id": 51726592, "comment_id": 90413725, "body": "I&#39;m trying to use this approach for firmware update over bluetooth. My BT module uses USART to communicate witch microprocessor. But firstly I&#39;m testing just with PC connected to microprocessor using USART."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1533644904, "post_id": 51726592, "comment_id": 90413831, "body": "Read the documentation - try to understand how it works. Then try to do your own stuff. It is not as easy as you think. Voting to close."}, {"owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "edited": false, "score": 0, "creation_date": 1533645183, "post_id": 51726592, "comment_id": 90414029, "body": "Application notes are much comprehensive, I&#39;m trying to understand the code. My biggest problem now is that microprocessor is not receiving any of the data send by PC."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533645969, "post_id": 51726592, "comment_id": 90414558, "body": "So what you want to write - the custom bootloader? If yes - share your code."}, {"owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "edited": false, "score": 0, "creation_date": 1533646495, "post_id": 51726592, "comment_id": 90414923, "body": "No, no custom bootloader. Example provided by ST simply receives file and writes it to microprocessor flash and then jumps to address where it was written (executing uploaded firmware) I want to be able to upload new versions of firmware to my device using bluetooth (as I mentioned bluetooth module on my device is communicating with microprocessor using USART)."}, {"owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "edited": false, "score": 0, "creation_date": 1533646549, "post_id": 51726592, "comment_id": 90414958, "body": "<a href=\"https://www.st.com/en/embedded-software/x-cube-iap-usart.html\" rel=\"nofollow noreferrer\">st.com/en/embedded-software/x-cube-iap-usart.html</a> My code is basically only the example that you can download in this link. I did not modified it. Sorry if i was not clear."}], "owner": {"reputation": 51, "user_id": 5108014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJZvrDicW9M/AAAAAAAAAAI/AAAAAAAADYA/W-ZM_qxGgtQ/photo.jpg?sz=128", "display_name": "Pavol Dudak", "link": "https://stackoverflow.com/users/5108014/pavol-dudak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 974, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533644194, "creation_date": 1533644194, "question_id": 51726592, "link": "https://stackoverflow.com/questions/51726592/stm32-usart-iap", "title": "STM32: usart IAP", "body": "<p>I'm trying to use example code provided by X-CUBE-IAP-USART package to develop IAP FW for STM32L0xx device. I'm using STM32L073 Nucleo64 board for development.</p>\n\n<p>When I send compiled FW using TeraTerm's YMODEM protocol nothing happens.</p>\n\n<p>Only thing that is being send to target STM device is: \"ota_test.elf166988 13332031541 100644\u00b6\u00ca\" over and over again. When I debugged example code I was getting HAL_TIMEOUT on receive. (rework example code to work with interrupts?). I've triple checked my USART settings so that is not the problem. Cam anyone please help me or send some functioning example code please? Original example code was written for STM32L073 eval board, but I've ported it to work with NUCLEO board, maybe I've made mistake there but, I've configured all peripherals exactly as they were configured in example code.</p>\n\n<p>I appreciate any kind of help.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1533643258, "post_id": 51726255, "comment_id": 90412772, "body": "Probably the the tool is giving you the false positive result."}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 2, "creation_date": 1533643530, "post_id": 51726255, "comment_id": 90412934, "body": "Possibly due to <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">implicit promotion to int</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1533644175, "post_id": 51726408, "comment_id": 90413351, "body": "Thank you for your input. I tried what you suggested but still get the following error <b>Violates MISRA 2004 Required Rule 10.5, Operators &#39;~&#39; and &#39;&lt;&lt;&#39; require recasting to underlying type for sub-integers</b>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1533654203, "post_id": 51726408, "comment_id": 90420577, "body": "@AnkitShah Sounds like a false positive by the tool then. 10.5 only applies to operands that are &quot;small integer types&quot;, which isn&#39;t the case here."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 2, "last_activity_date": 1533643577, "creation_date": 1533643577, "answer_id": 51726408, "question_id": 51726255, "link": "https://stackoverflow.com/questions/51726255/misra-c2004-10-5-query/51726408#51726408", "title": "MISRA C:2004 10.5 Query", "body": "<p>Most likely reason is that shift operator forces implicit promotion of <code>(tm_uint16)1U</code> to <code>int</code> type.</p>\n\n<p>Remove the second cast to make sure that you shift unsigned type:</p>\n\n<pre><code>((tm_uint16)(1U&lt;&lt;((tm_uint16)x)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1533656687, "post_id": 51729906, "comment_id": 90422198, "body": "I would recommend parenthesizing <code>x</code> in the macro expansion, a much bigger problem than the MISRA-C supposed violation: `#define tmM_pow2_16bit(x)   ( (tm_uint16)(1U &lt;&lt; (x)) )"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1533708883, "post_id": 51729906, "comment_id": 90439440, "body": "@chqrlie Good point, I will fix. Oddly, that&#39;s actually not a MISRA requirement - MISRA only requires the outermost part of the expression in the macro to have parenthesis."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1533718143, "post_id": 51729906, "comment_id": 90444706, "body": "The problem with MISRA&#39;s approach is they edict too many rules, not simple recommendations. If they enforced systematic macro argument parenthesization, some useful macro constructions would be disallowed. Many embedded C programmers write MISRA-C code without a good understanding of the actual meaning and consequences of all these casts and small type definitions. From my own experience auditing such projects, it makes code hard to read and does not prevent many breeds of bugs that have much worse consequences and are well hidden in a slew of insipid stupid casts."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1533718440, "post_id": 51729906, "comment_id": 90444916, "body": "@chqrlie Yeah that&#39;s the main problem with MISRA-C, you can&#39;t really use it if there isn&#39;t at least one experienced C veteran on the team, who can assist the others. Leaving beginners or intermediate skilled C programmers alone with a (often partially broken) MISRA checker tool, tends to cause more harm than good."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1533797548, "post_id": 51729906, "comment_id": 90480120, "body": "Fair point @Lundin - but an unsupervised inexperienced programmer is a potential liability with or without MISRA..."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1533798007, "post_id": 51729906, "comment_id": 90480353, "body": "MISRA C:2012 Rule 20.7 should deal with the non-parenthesised parameters ;-)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1533708900, "last_edit_date": 1533708900, "creation_date": 1533654047, "answer_id": 51729906, "question_id": 51726255, "link": "https://stackoverflow.com/questions/51726255/misra-c2004-10-5-query/51729906#51729906", "title": "MISRA C:2004 10.5 Query", "body": "<p>The problem is probably that the tool can't quite figure out what the underlying type is. I suspect it thinks the underlying type is <code>unsigned int</code>, since that's the type of <code>1U</code>.</p>\n\n<p>The cast <code>(tm_uint16)1U</code> is superfluous - on systems where <code>int</code> is 32 bit or larger, this will only force a conversion to a small integer type, which will then immediately get implicitly converted to <code>int</code>. That would be a MISRA-C:2004 violation, as no such implicit conversions that change the signedness may occur. I recommend studying <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a>.</p>\n\n<p><code>(tm_uint16)x</code> is also superfluous, as the right operand of the shift operators take no part in determining the result of the operand.</p>\n\n<p>MISRA-C:2004 compatible code should simply be this:</p>\n\n<pre><code>#define tmM_pow2_16bit(x)   ( (tm_uint16)(1U &lt;&lt; (x)) )\n</code></pre>\n\n<p>Assuming <code>x</code> is valid for the <code>tm_uint16</code> type. </p>\n\n<p>(Please note that MISRA-C also discourages the use of function-like macros.)</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1533656461, "creation_date": 1533656461, "answer_id": 51730680, "question_id": 51726255, "link": "https://stackoverflow.com/questions/51726255/misra-c2004-10-5-query/51730680#51730680", "title": "MISRA C:2004 10.5 Query", "body": "<p>The tool used to check MISRA-C compliance seems broken, but in some sense, you are indeed left shifting a signed integer type <code>int</code>: on architectures where <code>int</code> is larger than 16 bits, <code>(tm_uint16)1U</code> is promoted to <code>int</code> before the shift takes place, but there is no problem since its value is positive anyway.</p>\n\n<p>Note however that there is a <strong>much worse</strong> problem in this macro: <code>x</code> is not parenthesized in the expansion, causing unexpected behavior for non trivial expressions such as <code>tmM_pow2_16bit(1|2)</code>.</p>\n\n<p>You can probably fix the warning by removing the unnecessary casts:</p>\n\n<pre><code>#define tmM_pow2_16bit(x)   ((tm_uint16)(1U &lt;&lt; (tm_uint16)(x)))\n</code></pre>\n\n<p>If the tools still complains about potential left shifting by a quantity larger than the bit-width of <code>int</code>, add a mask:</p>\n\n<pre><code>#define tmM_pow2_16bit(x)   ((tm_uint16)(1U &lt;&lt; ((x) &amp; 15U)))\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1533708900, "creation_date": 1533643129, "question_id": 51726255, "link": "https://stackoverflow.com/questions/51726255/misra-c2004-10-5-query", "title": "MISRA C:2004 10.5 Query", "body": "<p>I am somewhat stucked at a part of the code that gives MISRA C 2004 10.5 violation but am not able to figure out what exactly might be the cause. </p>\n\n<p>I have defined this MACRO to get the power of 2.</p>\n\n<p>The code which shows the violation is </p>\n\n<pre><code>#define tmM_pow2_16bit(x)   ((tm_uint16)((tm_uint16)1U&lt;&lt;((tm_uint16)x)))\n</code></pre>\n\n<p>The message that comes from the static analysis tool is </p>\n\n<blockquote>\n  <p>Shift left of signed quantity (int) [MISRA 2004 Rule 10.5, required]</p>\n</blockquote>\n\n<p>Thank you</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1533642144, "post_id": 51725926, "comment_id": 90412039, "body": "Not without any context. What type is <code>x</code>? What type is <code>ix</code>? What&#39;s the difference between <code>ix[1,i]</code> and <code>ix(1,i)</code>?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1533642594, "post_id": 51725926, "comment_id": 90412344, "body": "@klutt no it doesn&#39;t, if there is <code>ix(0, 1)</code> and <code>ix</code> is not a macro."}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 2, "creation_date": 1533643256, "post_id": 51725926, "comment_id": 90412771, "body": "It seems like the OP means <code>x[IX(0,i)] = b==1 ? -x[IX(1,i)] : x[IX(1,i)];</code> but they switched some symbols and ended up with nonsense."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1533644669, "post_id": 51725926, "comment_id": 90413667, "body": "It means the same thing as (with a suitable <code>IX</code> function) <code>x[IX(0  ,i)] = -x[IX(1,i)] if b == 1 else  x[IX(1,i)]</code> in Python. The significance is explained in the surrounding text in the paper."}], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "is_accepted": true, "score": 2, "last_activity_date": 1533721965, "creation_date": 1533721965, "answer_id": 51743695, "question_id": 51725926, "link": "https://stackoverflow.com/questions/51725926/cfd-boundary-conditions/51743695#51743695", "title": "CFD boundary conditions", "body": "<p>I won\u2019t attempt to wade through the whole paper, but I can explain the\nsyntax and make some educated guesses about what\u2019s going on.</p>\n\n<pre><code>#define IX(i,j) ((i)+(N+2)*(j))\n</code></pre>\n\n<p>This looks to me like they\u2019re transforming two-dimensional coordinates\n<code>i,j</code> into a one-dimensional array index. <code>j</code> is the row number and <code>i</code>\nis the column number, which jibes with your description, and the total\nnumber of columns is <code>N+2</code>.</p>\n\n<pre><code>      0       1       2  ...   (N+2)-1\n(N+2)+0 (N+2)+1 (N+2)+2  ...  2(N+2)-1\n...\n</code></pre>\n\n<p>Then we have this:</p>\n\n<pre><code>x[IX(0,i)] = b==1 ? -x[IX(1,i)] : x[IX(1,i)]\n</code></pre>\n\n<p>In C, <code>a ? b : c</code> means <strong>if a, b, else c</strong>. It\u2019s an expression whose\nvalue is either <code>b</code> or <code>c</code>, depending on whether <code>a</code> is true or not.\nIt\u2019s called the <strong>ternary operator</strong>, read more <a href=\"https://en.wikipedia.org/wiki/%3F:\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Python has its own ternary operator, with the operands in a different\norder:</p>\n\n<pre><code>b if a else c\n</code></pre>\n\n<p>So <code>x[IX(0,i)] = b==1 ? -x[IX(1,i)] : x[IX(1,i)]</code> is equivalent to\nsaying:</p>\n\n<pre><code>if (b == 1)\n    x[IX(0,i)] = -x[IX(1,i)]\nelse\n    x[IX(0,i)] = x[IX(1,i)]\n</code></pre>\n\n<p>So, in row <code>i</code>, the new value at column 0 is the value at column 1,\npossibly negated. Looking at page 10, this seems to have something to do\nwith the boundaries. This is at the left edge, so we\u2019re setting it to\nthe value at one cell inward, or the negation of that, depending on <code>b</code>.</p>\n\n<p>Hope this clears things up somewhat.</p>\n"}], "owner": {"reputation": 113, "user_id": 6744895, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ed9fcbd0571804aa9f0d9eb7803115b1?s=128&d=identicon&r=PG&f=1", "display_name": "Silvia", "link": "https://stackoverflow.com/users/6744895/silvia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 51743695, "answer_count": 1, "score": -11, "last_activity_date": 1549552756, "creation_date": 1533642019, "last_edit_date": 1549552756, "question_id": 51725926, "link": "https://stackoverflow.com/questions/51725926/cfd-boundary-conditions", "title": "CFD boundary conditions", "body": "<p>I am trying to understand a piece of code which comes from a <a href=\"http://www.dgp.toronto.edu/people/stam/reality/Research/pdf/GDC03.pdf\" rel=\"nofollow noreferrer\">paper concerning fluid simulations for games</a>.  I am looking at the  way in which the boundary conditions are solved. Since I have no knowledge of C++ I am having additional difficulties.</p>\n\n<p>From what I have understand:</p>\n\n<ul>\n<li><p><code>IX(i, j)</code> represents a 2d grid cell situated at <code>i</code> in the x-direction, <code>j</code> in the y-direction</p></li>\n<li><p><code>u[IX(i, j)]</code> is then the velocity in the (<code>i</code>, <code>j</code>) cell</p></li>\n</ul>\n\n<p>The following macro is used for <code>IX(i, j)</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define IX(i, j) ((i) + (N + 2) * (j))\n</code></pre>\n"}, {"tags": ["c", "linux", "semaphore"], "comments": [{"owner": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533642213, "post_id": 51725823, "comment_id": 90412080, "body": "HI P.P. can you give me the link if this question is already answered."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533642274, "post_id": 51725823, "comment_id": 90412124, "body": "It&#39;s linked in your question."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533642553, "post_id": 51725823, "comment_id": 90412312, "body": "@P.P. If you look closely, that&#39;s actually not a good duplicate. Sure, the title is nice and generic, but the top answers all say &quot;Don&#39;t re-call <code>fclose()</code>&quot;, which doesn&#39;t really help here."}, {"owner": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533642754, "post_id": 51725823, "comment_id": 90412454, "body": "Agree with Jonathan .It&#39;s doesn&#39;t help me much ."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1533642848, "post_id": 51725823, "comment_id": 90412521, "body": "@JonathonReinhart The linked question is for unit testing EINTR which is what OP asked here too. There are decent answers there. Sure, fclose was used as an example (and it&#39;s sem_post here). I am not sure we need a different question for every sytem call that could return EINTR and how to unit test it."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533643114, "post_id": 51725823, "comment_id": 90412688, "body": "@P.P. I agree that we don&#39;t need a different question for every system call, but <code>fclose()</code> is a library function with additional semantics (disassociating with the underlying file descriptor), so that question was really just a bad example IMO. I didn&#39;t see any answers that suggested getting the syscall in a blocked state (which is easy for semaphores) and sending a signal to the thread."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533642345, "post_id": 51725893, "comment_id": 90412170, "body": "Thanks @Jonathan Reinhart . Here the routine called in one of the thread. So how can i give SIGINT signal to thread?"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533642467, "post_id": 51725893, "comment_id": 90412246, "body": "Use <a href=\"http://man7.org/linux/man-pages/man3/pthread_kill.3.html\" rel=\"nofollow noreferrer\"><code>pthread_kill</code></a> to send a signal to a thread."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533642632, "post_id": 51725893, "comment_id": 90412366, "body": "Just to understand, <i>which</i> system call that OP should block here? And why SIGINT?"}, {"owner": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533643731, "post_id": 51725893, "comment_id": 90413070, "body": "@Jonathan I will try the pseudo code in my existing code and check."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533644508, "post_id": 51725893, "comment_id": 90413561, "body": "1. Using <code>signal</code> is not a good idea (sigaction should be preferred). 2. Besides <code>sleep</code> being a bad choice as a sync mechanism, <code>sleep</code> itself can be interrupted by a signal (I still don&#39;t understand how <code>sleep</code> in main ensures it&#39;s blocked in the thread)."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1533644515, "post_id": 51725893, "comment_id": 90413568, "body": "3. OP&#39;s question, as I understand it, is about <i>unit testing</i> the scenario where a system call returns EINTR. So I&#39;d expect a transparent mechanism (such as the one answers that mentioned using function pointers in the linked-dup). 4. I wouldn&#39;t use signal handlers, signal blocking/sleeping, etc just for &quot;unit testing&quot; i.e., &quot;unit testing&quot; is supposed to <i>test</i>, not influence/change/introduce additional behaviours, etc."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 0, "last_activity_date": 1533643187, "last_edit_date": 1533643187, "creation_date": 1533641923, "answer_id": 51725893, "question_id": 51725823, "link": "https://stackoverflow.com/questions/51725823/how-to-write-a-test-case-to-verify-eintr-returned-by-sem-wait-function-in-linux/51725893#51725893", "title": "How to write a test case to verify EINTR returned by sem_wait function in linux", "body": "<p>Just about any system call on Linux can return <code>EINTR</code> if the system call is interrupted.</p>\n\n<p>From the <a href=\"http://man7.org/linux/man-pages/man3/sem_wait.3.html\" rel=\"nofollow noreferrer\">man page</a> (emphasis mine):</p>\n\n<blockquote>\n  <p><code>sem_wait()</code> decrements (locks) the semaphore pointed to by <code>sem</code>.  If\n         the semaphore's value is greater than zero, then the decrement\n         proceeds, and the function returns, immediately.  If the semaphore\n         currently has the value zero, then the call blocks until either it\n         becomes possible to perform the decrement (i.e., the semaphore value\n         rises above zero), <strong>or a signal handler interrupts the call</strong>.</p>\n</blockquote>\n\n<p>To trigger this case, you should make sure that the <code>sem_wait</code> system call is blocked (waiting), and then send a signal (which has a handler) to the thread.</p>\n\n<p>Some psuedo-code:</p>\n\n<pre><code>sigint_handler:\n    return\n\nthread2:\n    &lt;Your while loop from the question&gt;\n\nmain:\n    signal(SIGINT, sigint_handler)  // Setup signal handler\n\n    sem_wait(&amp;w4compl)\n    t2 = start_thread(thread2)\n    sleep(5)                        // Hack to make sure thread2 is blocked\n\n    pthread_kill(t2, SIGINT)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "edited": false, "score": 0, "creation_date": 1533737484, "post_id": 51730094, "comment_id": 90457413, "body": "@NiravPatel: Do note that if you have multiple threads, the signal must be directed at the thread doing the <code>sem_wait()</code> call, and that it is the delivery of the signal to the userspace handler function, not the signal itself, that causes the interruption of the blocking call.  In some cases you may need a signal pair, with the primary signal blocked in all but one thread, so that its signal handler can &quot;forward&quot; the signal (using the secondary signal that is not blocked) to each existing other thread, to interrupt several threads.  Let me know if you need further details or an example."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1533654615, "creation_date": 1533654615, "answer_id": 51730094, "question_id": 51725823, "link": "https://stackoverflow.com/questions/51725823/how-to-write-a-test-case-to-verify-eintr-returned-by-sem-wait-function-in-linux/51730094#51730094", "title": "How to write a test case to verify EINTR returned by sem_wait function in linux", "body": "<p>Install a signal handler, and cause a signal to be delivered (using <code>alarm()</code>, <code>setitimer()</code>, or <code>timer_create()</code>+<code>timer_settime()</code>), so that the delivery of the signal will interrupt the <code>sem_wait()</code> call.</p>\n\n<hr>\n\n<p>Consider this example program:</p>\n\n<pre><code>#define  _POSIX_C_SOURCE  200809L\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nstatic void dummy_handler(int signum)\n{\n}\n\nstatic int install_dummy_handler(int signum)\n{\n    struct sigaction  act;\n    memset(&amp;act, 0, sizeof act);\n    sigemptyset(&amp;act.sa_mask);\n    act.sa_handler = dummy_handler;\n    act.sa_flags = 0;\n    return sigaction(signum, &amp;act, NULL);\n}\n\nstatic const char *errname(const int errnum)\n{\n    switch (errnum) {\n    case EINTR:  return \"EINTR\";\n    case EINVAL: return \"EINVAL\";\n    default:     return \"(other)\";\n    }\n}\n\nint main(void)\n{\n    sem_t  s;\n\n    if (install_dummy_handler(SIGALRM) == -1) {\n        fprintf(stderr, \"Cannot install ARLM signal handler: %s.\\n\", strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    sem_init(&amp;s, 0, 0);\n\n    alarm(1);\n\n    if (sem_wait(&amp;s) == -1) {\n        const int  errnum = errno;\n        printf(\"sem_wait() failed with errno == %s (%d; %s).\\n\",\n               errname(errnum), errnum, strerror(errnum));\n    } else\n        printf(\"sem_wait() succeeded.\\n\");\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>In <code>main()</code>, we install a signal handler for the SIGALRM signal.  It does not matter if the signal handler function does anything at all, because it is the <em>delivery of the signal</em> that causes \"slow\" syscalls to return with EINTR error.  (As long as the SA_RESTART flag was <em>not</em> used when that handler was installed. If you look at <code>act.sa_mask</code> in <code>install_dummy_handler()</code>, you'll see we used no flags at all. All the flags and <code>sigaction()</code> usage are described in the <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\"><code>man 2 sigaction</code></a> man page.) </p>\n\n<p>In <code>main()</code>, we first initialize our semaphore, then set an alarm for one second. When the real, wall-clock time has elapsed, the SIGALRM signal is raised.\nDo note that although SIGALRM is just fine for this example and similar purposes, you'll probably want to use <a href=\"http://man7.org/linux/man-pages/man2/timer_create.2.html\" rel=\"nofollow noreferrer\">POSIX per-process interval timers</a> instead.</p>\n\n<p>Next, we simply call <code>sem_wait()</code> on the semaphore, and examine the result. In practice, if you compile and run the above <strong>example.c</strong> using e.g.\n</p>\n\n<pre><code>gcc -Wall -O2 example.c -lpthread -o example\n./example\n</code></pre>\n\n<p>the program will output\n</p>\n\n<pre><code>sem_wait() failed with errno == EINTR (4; Interrupted system call).\n</code></pre>\n\n<p>after one second.</p>\n"}], "owner": {"reputation": 11, "user_id": 8906317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21017a8da280341c9ed65b909e28c826?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav Patel", "link": "https://stackoverflow.com/users/8906317/nirav-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533654615, "creation_date": 1533641744, "question_id": 51725823, "link": "https://stackoverflow.com/questions/51725823/how-to-write-a-test-case-to-verify-eintr-returned-by-sem-wait-function-in-linux", "title": "How to write a test case to verify EINTR returned by sem_wait function in linux", "body": "<p>I have just written the below routine to handle the EINTR error.\nThe routine is given below,</p>\n\n<pre><code>while((s = sem_wait(&amp;w4compl)) == -1)\n{\n        if (errno == EINTR)\n        {\n                perror(\"call interrupted by sig. handler\\n\");\n                continue;\n        }\n        else\n                printf(\"Other Error Generated\\n\");\n}\n</code></pre>\n\n<p>SO, here i am not able to see the print \"call interrupted by sig. handler\\n\" statement. How can test this so that it will print the same(How can i execute the part of if (errno == EINTR)).</p>\n"}, {"tags": ["c", "linux", "memcpy"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533641994, "post_id": 51725786, "comment_id": 90411947, "body": "what is TX_PTR?"}, {"owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1533642036, "post_id": 51725786, "comment_id": 90411974, "body": "It is a memory address defined as #define TX_PTR 0x40000008"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1533642093, "post_id": 51725786, "comment_id": 90412009, "body": "It is an integer which is casted to void pointer and I am 100% sure that it not point to the valid memory location"}, {"owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "edited": false, "score": 0, "creation_date": 1533642266, "post_id": 51725786, "comment_id": 90412119, "body": "The data is being written on that address by another c application. Its too complex and i cant mention that here. I have written the data myself and I can also read it correctly. But if I try to use memset, that isnt working."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1533642406, "post_id": 51725786, "comment_id": 90412207, "body": "How do you write from another application to that address? Because processes have separate memory spaces and to be able to share a specific address would require quite a bit of juggling. But <code>tx_arr</code> is a pointer and you take a pointer to the pointer, that doesn\u2019t look good."}, {"owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "edited": false, "score": 0, "creation_date": 1533642562, "post_id": 51725786, "comment_id": 90412326, "body": "I am running freertos and openamp on a zynq board. I can run multiple applications on by the use of the openamp framework."}, {"owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "edited": false, "score": 0, "creation_date": 1533642667, "post_id": 51725786, "comment_id": 90412387, "body": "Can you all please assume that data is definitely present in that location, I can access it by directly reading it from the address but I cant read it with memcpy."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1533643300, "post_id": 51725786, "comment_id": 90412793, "body": "@KulaDamian Wile I don&#39;t think it matters that much in this particular case, at least try by calling memcpy the proper way: <code>memcpy(tx_arr, (void*)TX_PTR, sizeof tx_arr);</code>  (or if you like this alternative better: <code>memcpy(&amp;tx_arr[0], TX_PTR, (void*)TX_PTR, sizeof(tx_arr));</code>"}, {"owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "edited": false, "score": 0, "creation_date": 1533643866, "post_id": 51725786, "comment_id": 90413154, "body": "I found my problem. The address was mmapped to a virtual memory. I needed to put the virtual memory address in the memcpy function."}], "answers": [{"tags": [], "owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "is_accepted": true, "score": 3, "last_activity_date": 1533644334, "creation_date": 1533644334, "answer_id": 51726638, "question_id": 51725786, "link": "https://stackoverflow.com/questions/51725786/segmentation-fault-on-memcpy-function/51726638#51726638", "title": "Segmentation fault on memcpy() function", "body": "<blockquote>\n  <p>I am running freertos and openamp on a zynq board.</p>\n</blockquote>\n\n<p>From this comment, I am led to believe that the \"<em>memory</em>\" is implemented in the FPGA's address space, or that FreeRTOS is running and has written to this memory.</p>\n\n<p>If this is the case, then to access data that is physically located at a point in memory, you need to use <code>mmap()</code>.</p>\n\n<p>Linux processes do not sit on phyisical addresses - the MMU will map virtual memory to physical memory.</p>\n\n<p>To get access to physical memory, you need to use <code>mmap()</code> - something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\n#define TX_ADDR 0x40000008\n#define TX_LEN  256\n\nvoid *my_memory;\nint memfd;\n\nmemfd = open(\"/dev/mem\", O_RDWR);\nif (memfd == -1) {\n    perror(\"open()\");\n    exit(1);\n}\n\nmy_memory = mmap(NULL, TX_LEN, PROT_READ | PROT_WRITE, MAP_PRIVATE, fd, TX_ADDR);\nif (my_memory == NULL) {\n    perror(\"mmap()\");\n    exit(1);\n}\n\n/* use my_memory to access the data */\nunsigned int tx_arr[64];\nint i;\n\nfor (i = 0; i &lt; 64; i++) {\n   tx_arr[i] = 0;\n}\n\nmemcpy(tx_arr, my_memory, sizeof(tx_arr));\n</code></pre>\n\n<p>After the call to <code>mmap()</code>, the memory will be available in your process' <em>virtual address space</em> at the address held in <code>my_memory</code> - don't use <code>TX_PTR</code>.</p>\n\n<p>Note also, that <code>tx_arr</code> is an array, and thus can be passed as a pointer without using <code>&amp;tx_arr</code>.</p>\n"}], "owner": {"reputation": 154, "user_id": 4194533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1717134784/picture?type=large", "display_name": "KulaDamian", "link": "https://stackoverflow.com/users/4194533/kuladamian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "closed_date": 1533650024, "accepted_answer_id": 51726638, "answer_count": 1, "score": 0, "last_activity_date": 1533644334, "creation_date": 1533641633, "question_id": 51725786, "link": "https://stackoverflow.com/questions/51725786/segmentation-fault-on-memcpy-function", "closed_reason": "Not suitable for this site", "title": "Segmentation fault on memcpy() function", "body": "<p>I have the following memory base address which contains some data of 256 bytes:</p>\n\n<pre><code>#define TX_PTR 0x40000008\n</code></pre>\n\n<p>Now I have the following array which will store the data from TX_PTR.</p>\n\n<pre><code>unsigned int tx_arr[64];\nint i = 0;\nfor (i=0; i&lt;64;i++)\n{\n   tx_arr[i]=0;\n}\n</code></pre>\n\n<p>When I try to memcpy the data from the memory base address to the array by:</p>\n\n<pre><code>memcpy(&amp;tx_arr, TX_PTR, 2*32*sizeof(int));\n</code></pre>\n\n<p>I get a segmentation fault.\nI am running this code in linux. What could be the problem here?</p>\n"}, {"tags": ["c++", "c", "cmake"], "comments": [{"owner": {"reputation": 13658, "user_id": 1182653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClTqS.png?s=128&g=1", "display_name": "Viktor Latypov", "link": "https://stackoverflow.com/users/1182653/viktor-latypov"}, "edited": false, "score": 1, "creation_date": 1533641542, "post_id": 51725564, "comment_id": 90411678, "body": "Try using &#39;target_link_libraries(prog funccpp_lib funcc_lib)&#39; instead of &#39;target_link_libraries(prog funcc_lib funccpp_lib)&#39; since your C++ lib depdends on C lib."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1533641553, "post_id": 51725564, "comment_id": 90411683, "body": "What happens if you switch the order of libraries to <code>target_link_libraries(prog funccpp_lib funcc_lib)</code>?"}, {"owner": {"reputation": 13658, "user_id": 1182653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClTqS.png?s=128&g=1", "display_name": "Viktor Latypov", "link": "https://stackoverflow.com/users/1182653/viktor-latypov"}, "edited": false, "score": 1, "creation_date": 1533641799, "post_id": 51725564, "comment_id": 90411820, "body": "Not sure about CMake and &#39;target_link_libraries&#39;, but for single-pass LD linker implementation it instructs the linker to search symbols for &#39;funccpp_lib&#39; in &#39;funcc_lib&#39;, not vice versa."}], "answers": [{"comments": [{"owner": {"reputation": 7239, "user_id": 941531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b3dab7ce6e710dbca170ef59e6c715?s=128&d=identicon&r=PG", "display_name": "Arty", "link": "https://stackoverflow.com/users/941531/arty"}, "edited": false, "score": 0, "creation_date": 1533642214, "post_id": 51725852, "comment_id": 90412082, "body": "Thanks! Issue fixed. But what to do with cases when there are two libraries A and B, where there is cyclic dependency - A needs some functions from B and vice versa?"}, {"owner": {"reputation": 1627, "user_id": 579698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f69501fa0ff653b5a6e9466b43773d3?s=128&d=identicon&r=PG", "display_name": "Stanley F.", "link": "https://stackoverflow.com/users/579698/stanley-f"}, "reply_to_user": {"reputation": 7239, "user_id": 941531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b3dab7ce6e710dbca170ef59e6c715?s=128&d=identicon&r=PG", "display_name": "Arty", "link": "https://stackoverflow.com/users/941531/arty"}, "edited": false, "score": 3, "creation_date": 1533642362, "post_id": 51725852, "comment_id": 90412181, "body": "@ArtyOneSoul Have a look at the link, I provided: Simply list the libs multiple times, i.e. <code>target_link_libraries(prog funccpp_lib funcc_lib funccpp_lib)</code>"}, {"owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 1, "creation_date": 1533646780, "post_id": 51725852, "comment_id": 90415105, "body": "Even better, tell CMake that <code>funccpp_lib</code> depends on <code>funcc_lib</code>: <code>target_link_libraries(funccpp_lib funcc_lib)</code>."}], "tags": [], "owner": {"reputation": 1627, "user_id": 579698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f69501fa0ff653b5a6e9466b43773d3?s=128&d=identicon&r=PG", "display_name": "Stanley F.", "link": "https://stackoverflow.com/users/579698/stanley-f"}, "is_accepted": true, "score": 8, "last_activity_date": 1533641818, "creation_date": 1533641818, "answer_id": 51725852, "question_id": 51725564, "link": "https://stackoverflow.com/questions/51725564/cmake-doesnt-link-c-and-c-static-libraries-undefined-reference-to-function/51725852#51725852", "title": "CMake doesn&#39;t link C and C++ static libraries (undefined reference to function)", "body": "<p>The problem here is, that the linker relies on the order of the libraries. With </p>\n\n<pre><code>target_link_libraries(prog funcc_lib funccpp_lib)\n</code></pre>\n\n<p>It first links <code>funcc_lib</code> and then <code>funccpp_lib</code>. But it never gets back to <code>funcc_lib</code>. Since <code>funccpp_lib</code> depends on <code>funcc_lib</code>, you have to change the order of the libraries:</p>\n\n<pre><code>target_link_libraries(prog funccpp_lib funcc_lib)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/409470/579698\">For additional information, see this discussion.</a></p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 8841322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tfP3b.jpg?s=128&g=1", "display_name": "Jagger Yu", "link": "https://stackoverflow.com/users/8841322/jagger-yu"}, "is_accepted": false, "score": 0, "last_activity_date": 1573563433, "creation_date": 1573563433, "answer_id": 58819260, "question_id": 51725564, "link": "https://stackoverflow.com/questions/51725564/cmake-doesnt-link-c-and-c-static-libraries-undefined-reference-to-function/58819260#58819260", "title": "CMake doesn&#39;t link C and C++ static libraries (undefined reference to function)", "body": "<p>Make cmake c link command as c++ commmand will solve the problem</p>\n\n<pre><code>SET(CMAKE_C_LINK_EXECUTABLE ${CMAKE_CXX_LINK_EXECUTABLE})\n</code></pre>\n"}], "owner": {"reputation": 7239, "user_id": 941531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b3dab7ce6e710dbca170ef59e6c715?s=128&d=identicon&r=PG", "display_name": "Arty", "link": "https://stackoverflow.com/users/941531/arty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7984, "favorite_count": 1, "accepted_answer_id": 51725852, "answer_count": 2, "score": 7, "last_activity_date": 1573563433, "creation_date": 1533640907, "question_id": 51725564, "link": "https://stackoverflow.com/questions/51725564/cmake-doesnt-link-c-and-c-static-libraries-undefined-reference-to-function", "title": "CMake doesn&#39;t link C and C++ static libraries (undefined reference to function)", "body": "<p>I tried to reproduce minimal problem. When I run CMake+Make on Ubuntu I get error </p>\n\n<p><code>funccpp.cpp:(.text+0x5): undefined reference to `FuncC'</code></p>\n\n<p>i.e. exported function in C library is not found when importing in C++ library. When I try to manually compile using <code>g++ main.cpp funcc.c funccpp.cpp</code> it successfully compiles final program. How to fix CMake issue?</p>\n\n<p>For reference, when I run <code>nm libfuncc_lib.a</code> I get line <code>T FuncC</code> (so symbol is external and defined in Text section), when I run <code>nm libfunccpp_lib.a</code> I get <code>U FuncC</code> (so symbol is Undefined and should be linked from outside).</p>\n\n<p><strong>CMakeLists.txt</strong></p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nproject(Test C CXX)\n\nset (SRC_CPP funccpp.cpp)\nset (SRC_C funcc.c)\nset (SRC_MAIN main.cpp)\n\nadd_library(funcc_lib STATIC ${SRC_C})\nadd_library(funccpp_lib STATIC ${SRC_CPP})\nadd_executable(prog ${SRC_MAIN})\ntarget_link_libraries(prog funcc_lib funccpp_lib)\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"funccpp.h\"\n\nint main() {\n    FuncCPP();\n    return 0;\n}\n</code></pre>\n\n<p><strong>funccpp.h</strong></p>\n\n<pre><code>#ifndef FUNCCPP_H\n#define FUNCCPP_H\n\nvoid FuncCPP();\n\n#endif\n</code></pre>\n\n<p><strong>funccpp.cpp</strong></p>\n\n<pre><code>#include \"funcc.h\"\n\nvoid FuncCPP() {\n    FuncC();\n}\n</code></pre>\n\n<p><strong>funcc.h</strong></p>\n\n<pre><code>#ifndef FUNCC_H\n#define FUNCC_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid FuncC();\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // FUNCC_H\n</code></pre>\n\n<p><strong>funcc.c</strong></p>\n\n<pre><code>#include \"funcc.h\"\n#include &lt;stdio.h&gt;\n\nvoid FuncC() {\n    printf(\"Hello, World!\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "cross-platform"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1533655312, "post_id": 51725131, "comment_id": 90421321, "body": "stdio.h is fully portable. glibc is an open source implementation of stdio.h (along other things) for certain systems. So are you asking if stdio.h is portable or if glibc is portable? Those are two different things."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1533655786, "post_id": 51725216, "comment_id": 90421618, "body": "For those interested in POSIX (also known as IEEE Std 1003.1\u2122), the 2018 version is <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">here</a>. For C programmers, the <i>Base Definitions</i> and <i>System Interfaces</i> contain the salient parts."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1533703740, "last_edit_date": 1533703740, "creation_date": 1533639813, "answer_id": 51725216, "question_id": 51725131, "link": "https://stackoverflow.com/questions/51725131/if-stdio-is-cross-platform-c-standard-library-abstraction-for-c/51725216#51725216", "title": "If stdio is cross-platform C / standard library abstraction for C", "body": "<p><code>stdio.h</code>  is part of the <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a> standard (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>; you really should download and read that). If you restrict yourself to use only functions described by that standard (in the way that standard specifies), and if you use standard conforming implementations (e.g. compilers and C standard library implementations), you should be safe.</p>\n\n<p>However, many features (e.g. directories, symbolic links, file truncation) are <em>outside</em> of the C11 standard. You might be interested by the POSIX standard.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Berkeley_sockets\" rel=\"nofollow noreferrer\">Sockets</a> are <em>not</em> part of the C11 standard (but mostly POSIX, see <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">this</a>).</p>\n\n<p>Some libraries (e.g. <a href=\"https://developer.gnome.org/glib/stable/\" rel=\"nofollow noreferrer\">Glib</a>) try to define common abstractions for several OSes. You might consider these if you want to easily write source code compilable on several common platforms. (With C++ you could also use <a href=\"http://pocoproject.org/\" rel=\"nofollow noreferrer\">POCO</a>, <a href=\"http://boost.org/\" rel=\"nofollow noreferrer\">Boost</a>, <a href=\"http://qt.io/\" rel=\"nofollow noreferrer\">Qt</a>, ....)</p>\n\n<p>BTW, Linux man pages (start with <a href=\"http://man7.org/linux/man-pages/man2/intro.2.html\" rel=\"nofollow noreferrer\">intro(2)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man3/intro.3.html\" rel=\"nofollow noreferrer\">intro(3)</a>...) often mention the standard followed by most functions. For example <a href=\"http://man7.org/linux/man-pages/man2/chown.2.html\" rel=\"nofollow noreferrer\">chown(2)</a> is defined in  POSIX.1-2008.</p>\n\n<p>Notice also that standards are specifications, which might not be entirely followed or respected (and they are bugs even in standards). For example C11 <a href=\"https://en.cppreference.com/w/c/thread\" rel=\"nofollow noreferrer\">threads</a> (e.g. <code>thrd_create</code>) might not be available in some (still used) versions of <a href=\"https://www.gnu.org/software/libc/\" rel=\"nofollow noreferrer\">glibc</a> (because it has <a href=\"http://man7.org/linux/man-pages/man7/pthreads.7.html\" rel=\"nofollow noreferrer\">pthreads(7)</a> which predated C11). Also, some libraries implement standard functions beyond what the standard requires (e.g. on Linux <a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow noreferrer\">fopen(3)</a> understands <code>m</code> in the mode string).</p>\n\n<p>Remember the maxim: there is no portable code, only code that has been ported (to some <em>specific</em> system[s]). See also <a href=\"https://stackoverflow.com/q/2664254/841108\">this</a>.</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 51725216, "answer_count": 1, "score": 0, "last_activity_date": 1533703740, "creation_date": 1533639527, "question_id": 51725131, "link": "https://stackoverflow.com/questions/51725131/if-stdio-is-cross-platform-c-standard-library-abstraction-for-c", "title": "If stdio is cross-platform C / standard library abstraction for C", "body": "<p>I am looking at compiling C for cross-platform, and have that figured out. Now I am wondering if you need libraries specific to windows/mac/linux, or if <code>stdio</code> (glibc) is a cross-platform library that abstracts away all the low-level syscalls into a nice standard API. Not sure if it's doing that. For example, file-system stuff, seems like that is cross-platform. But maybe net connection stuff isn't, not sure. Also, I see <a href=\"https://github.com/jwerle/fs.c/blob/95e508f71348d2dce43d45a86867775ff1591525/fs.c#L113\" rel=\"nofollow noreferrer\">here</a> a lot of <code>#ifdef _WIN32</code>, even though it is just a simple file-system wrapper over <code>stdio</code>, so not sure if stdio is not covering everything.</p>\n\n<p>Looking around a bit I see some \"cross-platform\" libraries like <a href=\"https://github.com/libuv/libuv/tree/27ba66281199bdcade823677af8dedc161152fb6/src\" rel=\"nofollow noreferrer\">libuv</a> have code specific to windows vs. unix, so not sure if there are cases where you need to hook into \"native\" (os-specific) functionality, and when/where you typically need to do that.</p>\n\n<p>Wondering first if glibc / stdio is a cross-platform abstraction around the syscalls and common other functions. Then wondering if one could explain/outline briefly when you need to write platform-specific functionality, and if there is not a standard library / abstraction on top of that.</p>\n"}]