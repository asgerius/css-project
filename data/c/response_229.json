[{"tags": ["c++", "c", "memory-barriers", "stdatomic", "itanium"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171245, "post_id": 56369559, "comment_id": 99341764, "body": "If you use acq/rel for everything (like x86) then barriers become no-ops except for seq_cst.  (Although I&#39;m not 100% sure about barriers being supposed to affect non-atomic operations as well, or if that&#39;s just an implementation detail in current compilers).  Seems like a weird choice, but maybe a good idea on that microarchitecture family for some reason."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171349, "post_id": 56369559, "comment_id": 99341784, "body": "So what about the <code>mf</code> in <code>cmpxchg.rel; mf</code>? It is redundant? What does it provide if <code>cmpxchg</code> has ack?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171650, "post_id": 56369559, "comment_id": 99341838, "body": "IDK, I haven&#39;t thought about that part yet."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574122519, "post_id": 56369559, "comment_id": 104111065, "body": "@PeterCordes &quot;<i>barriers being supposed to affect non-atomic operations as well</i>&quot; What in the (C or C++) std supports the idea that thread fences can order two non atomic ops?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574130302, "post_id": 56369559, "comment_id": 104112613, "body": "Back in May that was something I wondered about.  But now I think atomic_thread_fence doesn&#39;t help for non-atomic ops wrt. each other, but yes wrt. the fence in case there&#39;s an acq or rel operation on the other side of the fence somewhere in another function (e.g. the caller, or a library function).  In general compilers don&#39;t usually have a <i>complete</i> picture of the source they&#39;re compiling, and have to emit function definitions that work for an arbitrary caller.  Even with LTO there are some non-inline library functions.  So non-atomic ops do sometimes need to be ordered wrt. a fence."}], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1559170705, "creation_date": 1559170705, "question_id": 56369559, "link": "https://stackoverflow.com/questions/56369559/issue-with-c-c11-mappings-to-processors-in-proposed-nop-memory-barriers-for", "title": "Issue with &quot;C/C++11 mappings to processors&quot; in proposed NOP memory barriers for Itanium?", "body": "<p>Although I don't read Itanium assembly, and I don't claim to understand its memory model, I have noticed something very strange and apparently contradictory in one proposed mapping of C/C++ atomics to Itanium.</p>\n\n<p>In <a href=\"https://www.cl.cam.ac.uk/~pes20/cpp/cpp0xmappings.html\" rel=\"nofollow noreferrer\">C/C++11 mappings to processors</a> the proposed implementation of atomics on Itanium suggests no acquire or release fences:</p>\n\n<pre><code>Consume Fence:  &lt;ignore&gt;\nAcquire Fence:  &lt;ignore&gt;\nRelease Fence:  &lt;ignore&gt;\nAcq_Rel Fence:  &lt;ignore&gt;\n</code></pre>\n\n<p>(What is a consume fence anyway?)</p>\n\n<p>And indeed in that proposal the relaxed atomic loads and stores are never relaxed:</p>\n\n<pre><code>Load Relaxed:   ld.acq\nLoad Consume:   ld.acq\nLoad Acquire:   ld.acq\n...\n</code></pre>\n\n<p>We see that all relaxed simple (not RMW) operations are already Acq_Rel in these mappings. But looking at RMW operations with see that the relaxed and non-relaxed operations are different:</p>\n\n<pre><code>Cmpxchg Release:    cmpxchg.rel\nCmpxchg AcqRel:     cmpxchg.rel; mf\n</code></pre>\n\n<p>Unless the Cmpxchg AcqRel implementation has gratuitous <code>mf</code> (unlikely), it means the acquire behavior is not automatic in <code>cmpxchg.rel</code>.</p>\n\n<p>Shouldn't a relaxed, release-only RMW operation followed by an acquire fence provide at least the guarantees of acq_rel RMW? If so, doesn't that show the proposal is defective?</p>\n"}, {"tags": ["c", "enums"], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1559170686, "post_id": 56369535, "comment_id": 99341652, "body": "I usually call the dummy value something like <code>NUM_POWER_LEVELS</code>, since it would otherwise not be clear where someone should add a new power level."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 2, "last_activity_date": 1559170507, "creation_date": 1559170507, "answer_id": 56369535, "question_id": 56369464, "link": "https://stackoverflow.com/questions/56369464/check-if-value-is-in-undefined-enum/56369535#56369535", "title": "Check if value is in undefined enum?", "body": "<p>There is no cross-platform way to determine the maximum legal enumerated value for a particular <code>enum</code>. However, you can get around this by introducing a dummy enumerated value that comes after all the others:</p>\n\n<pre><code>typedef enum\n{\n    POWER_LEVEL_0\n    POWER_LEVEL_1,\n    POWER_LEVEL_2,\n    POWER_LEVEL_3,\n    POWER_LEVEL_4,\n    ILLEGAL_POWER_LEVEL // Not to be used directly; must be last\n} power_type;\n</code></pre>\n\n<p>Now, you can write your helper function as follows:</p>\n\n<pre><code>bool exists_in_power_type(power_type value) {\n    return 0 &lt;= value &amp;&amp; value &lt; ILLEGAL_POWER_LEVEL;\n}\n</code></pre>\n\n<p>As long as <code>ILLEGAL_POWER_LEVEL</code> is the last of the enumerated values, this approach will check whether you have something assigned to <code>value</code> that matches some enumeration.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 93, "user_id": 9947277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KhmjqzssY14/AAAAAAAAAAI/AAAAAAAAAAA/4WXPGa8fHTk/photo.jpg?sz=128", "display_name": "Jedediah", "link": "https://stackoverflow.com/users/9947277/jedediah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56369535, "answer_count": 1, "score": 0, "last_activity_date": 1559170507, "creation_date": 1559169943, "question_id": 56369464, "link": "https://stackoverflow.com/questions/56369464/check-if-value-is-in-undefined-enum", "title": "Check if value is in undefined enum?", "body": "<p>I am working on a file that runs on different processors, so the header files change based on the hardware. My program needs to receive an index and, if it is a valid index for a particular enum, use it, otherwise go to a default value. </p>\n\n<p>I need to check if it is a valid index for this enum. HOWEVER, the enum is slightly different processor to processor. I have a header file for each chip, so I don't know how many indices are defined. Here is what it approximately looks like:</p>\n\n<pre><code>typedef enum\n    {\n    POWER_LEVEL_0\n    POWER_LEVEL_1,\n    POWER_LEVEL_2,\n    POWER_LEVEL_3,\n    POWER_LEVEL_4\n    } power_type;\n</code></pre>\n\n<p>and I need to be able to test if a received index is defined, like so:</p>\n\n<pre><code>int input;\n...\nif( exists_in_power_type(input) )\n    //accept the value\nelse\n    //use default value\n</code></pre>\n\n<p>I know the number of indices will be in the range of about 4 to 7, and that may grow if I run this project on a new processor that may have 8 or more power options. In this case I want my program to be portable and only have to define an enum of the same name in a new header for that processor.</p>\n\n<p>This problem may be a little easier because the enum values just start at 0 and increment by 1. Is there a way to get the length/max value of an enum without knowing its definition? Is there a similar work around that I could use here?</p>\n"}, {"tags": ["c", "cassandra", "datastax"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1559167630, "post_id": 56369082, "comment_id": 99340873, "body": "By definition a C string ends with a NUL character. If you need &quot;strings&quot; that contain NUL characters, you need to handle this yourself by storing the length of the string somehow."}, {"owner": {"reputation": 47278, "user_id": 18627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b31b9d123bff80f00317a1df0dd00e2?s=128&d=identicon&r=PG", "display_name": "Alex Ott", "link": "https://stackoverflow.com/users/18627/alex-ott"}, "edited": false, "score": 0, "creation_date": 1559207137, "post_id": 56369082, "comment_id": 99351370, "body": "In general, keeping the big binary data in Cassandra isn&#39;t very good idea..."}], "answers": [{"comments": [{"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559168080, "post_id": 56369189, "comment_id": 99340989, "body": "is there any way in Cassandra to ignore null and store directly by the length(start and end position) ? like , do not think and store the data"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559168313, "post_id": 56369189, "comment_id": 99341056, "body": "@monk Well that&#39;s another question, and I&#39;m not a Cassandra expert, but from a quick search you can probably use <a href=\"https://docs.datastax.com/en/cql/3.3/cql/cql_reference/blob_r.html\" rel=\"nofollow noreferrer\">blob data type</a>"}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559168476, "post_id": 56369189, "comment_id": 99341092, "body": "from that post only I reached to use <code>TestAsBlob</code> function, which will stop at first null char."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559168808, "post_id": 56369189, "comment_id": 99341179, "body": "@monk <code>TestAsBlob()</code> is a conversion function. Why are you trying to convert it? Just define the table column as <code>blob</code> type and then insert this data. No conversion is needed."}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559169186, "post_id": 56369189, "comment_id": 99341277, "body": "but , If I do not then <code>select</code> will not work, it will give error <code>0x234123  is not a valid binary representation for type text</code>"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559169678, "post_id": 56369189, "comment_id": 99341393, "body": "Is the column for this data in your table defined as <code>blob</code>? It&#39;s a bit impossible to help without seeing how your table is defined and how your <code>SELECT</code> command looks like, but one thing is sure - if you don&#39;t store this data as blob you wouldn&#39;t be able to read it."}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559169968, "post_id": 56369189, "comment_id": 99341471, "body": "I have updated the question with <code>desc</code> of table and a <code>select *</code> for clarity."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559171160, "post_id": 56369189, "comment_id": 99341744, "body": "You should also add how you store the data in the table"}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559171563, "post_id": 56369189, "comment_id": 99341828, "body": "updated in the question. blob/binary data is received through socket and key is something I hardcode."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559172560, "post_id": 56369189, "comment_id": 99342046, "body": "Where&#39;s <code>value</code> defined?"}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559226610, "post_id": 56369189, "comment_id": 99360772, "body": "value is received through the socket into buffer"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559228917, "post_id": 56369189, "comment_id": 99362032, "body": "Where is it <b>defined</b>? Its C definition"}, {"owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "edited": false, "score": 0, "creation_date": 1559231679, "post_id": 56369189, "comment_id": 99363555, "body": "<code>const char * value</code>"}], "tags": [], "owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "is_accepted": false, "score": 0, "last_activity_date": 1559167795, "creation_date": 1559167795, "answer_id": 56369189, "question_id": 56369082, "link": "https://stackoverflow.com/questions/56369082/char-buffer-with-multiple-null-char/56369189#56369189", "title": "Char buffer with multiple null char", "body": "<p>You're saying that this data shouldn't be referred to as text, and then you're using <code>TextToBlob()</code> to store it. <code>TextToBlob()</code> would refer to your data as <strong>text</strong> (and would try to store it as binary data) but that's exactly what you wouldn't want. Because if it would have been referred to as text every 0 would mean string-termination.</p>\n\n<p>You'd want to store this data received by <code>recvfrom</code> in some pointer to some data structure or maybe just a <code>void *</code>. Because otherwise, every byte which is <code>null</code> (0) will be referred to as end-of-string.</p>\n\n<p>So, you should allocate some memory in the size you say you know, and then read all this data to this address not using any strings (char arrays) functions.</p>\n"}], "owner": {"reputation": 1340, "user_id": 5584716, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4bb2caba083c0b41cf0c4d267d4e0516?s=128&d=identicon&r=PG&f=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5584716/monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559171506, "creation_date": 1559167107, "last_edit_date": 1559171506, "question_id": 56369082, "link": "https://stackoverflow.com/questions/56369082/char-buffer-with-multiple-null-char", "title": "Char buffer with multiple null char", "body": "<p>I am working on a socket program(using <code>recvfrom</code>) which returns me a buffer of char. However the received data contains multiple <code>null</code> chars and it does not let me post process it easily. </p>\n\n<p>I would like to request if there is any way to escape the null chars if they are found in the middle of the buffer ? </p>\n\n<p>Goal is to store the binary data into cassandra DB. I tried to ignore the null chars and store it directly into the DB. However it will only store the partial string. On research I learnt that I could use <code>TextAsBlob()</code> function to convert the received data into blob. Although this did not changed anything , only partial data is stored in the DB.(till the first null is seen). </p>\n\n<p>So,  I need to know is there a way to escape them? I have the length of the received data available. </p>\n\n<p>For printing the data I am  printing the data using <code>%c</code> byte by byte. </p>\n\n<p>Structure of table:</p>\n\n<pre><code>cqlsh:network&gt; desc packet;\n\nCREATE TABLE network.packet (\n    key text PRIMARY KEY,\n    value blob\n) WITH bloom_filter_fp_chance = 0.01\n    AND caching = {'keys': 'ALL', 'rows_per_partition': 'NONE'}\n    AND comment = ''\n    AND compaction = {'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'}\n    AND compression = {'chunk_length_in_kb': '64', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'}\n    AND crc_check_chance = 1.0\n    AND dclocal_read_repair_chance = 0.1\n    AND default_time_to_live = 0\n    AND gc_grace_seconds = 864000\n    AND max_index_interval = 2048\n    AND memtable_flush_period_in_ms = 0\n    AND min_index_interval = 128\n    AND read_repair_chance = 0.0\n    AND speculative_retry = '99PERCENTILE';\n\ncqlsh:network&gt;\n\n\n\ncqlsh:network&gt; SELECT * from packet;\n\n key                                            | value\n------------------------------------------------+--------------------\n 1234                                           |     0x70e54c5bfd7f\n 1235        \n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>cqlsh:network&gt; SELECT blobAsText(value) FROM network.packet WHERE key = '1234' ;\nInvalidRequest: Error from server: code=2200 [Invalid query] message=\"In call to function system.blobastext, value 0x70e54c5bfd7f is not a valid binary representation for type text\"\n</code></pre>\n\n<p>Insert command:</p>\n\n<pre><code> char key[5] = 1234;\n// value is received from socket. \n\nINSERT INTO network.packet (key, value) VALUES (key, value);\n</code></pre>\n"}, {"tags": ["c", "binary"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1559166874, "post_id": 56368919, "comment_id": 99340657, "body": "You have to write the logic yourself. How did the bits end up backwards in the first place?"}, {"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 0, "creation_date": 1559166879, "post_id": 56368919, "comment_id": 99340660, "body": "So you want to swap endianness?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 0, "creation_date": 1559166893, "post_id": 56368919, "comment_id": 99340665, "body": "@BradyDean Endianness is usually about bytes, not bits."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1559181539, "post_id": 56368919, "comment_id": 99343791, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/746171/efficient-algorithm-for-bit-reversal-from-msb-lsb-to-lsb-msb-in-c\">Efficient Algorithm for Bit Reversal (from MSB-&gt;LSB to LSB-&gt;MSB) in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1559171509, "post_id": 56369201, "comment_id": 99341813, "body": "Thank you for the Arm reference."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 2, "last_activity_date": 1559167881, "creation_date": 1559167881, "answer_id": 56369201, "question_id": 56368919, "link": "https://stackoverflow.com/questions/56368919/how-to-read-reversed-number-from-a-binary-file/56369201#56369201", "title": "How to read reversed number from a binary file?", "body": "<p>you have many possible ways:</p>\n\n<p>Portable:</p>\n\n<p>(not my algorithm)</p>\n\n<pre><code>uint32_t rev(uint32_t x)\n{\n    x = (((x &amp; 0xaaaaaaaa) &gt;&gt; 1) | ((x &amp; 0x55555555) &lt;&lt; 1));\n    x = (((x &amp; 0xcccccccc) &gt;&gt; 2) | ((x &amp; 0x33333333) &lt;&lt; 2));\n    x = (((x &amp; 0xf0f0f0f0) &gt;&gt; 4) | ((x &amp; 0x0f0f0f0f) &lt;&lt; 4));\n    x = (((x &amp; 0xff00ff00) &gt;&gt; 8) | ((x &amp; 0x00ff00ff) &lt;&lt; 8));\n    return((x &gt;&gt; 16) | (x &lt;&lt; 16));\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>uint32_t bit_reverse_4bytes(uint32_t x)\n{\n    x = ((x &amp; 0xF0F0F0F0) &gt;&gt; 4) | ((x &amp; 0x0F0F0F0F) &lt;&lt; 4);\n    x = ((x &amp; 0xCCCCCCCC) &gt;&gt; 2) | ((x &amp; 0x33333333) &lt;&lt; 2);\n    return ((x &amp; 0xAAAAAAAA) &gt;&gt; 1) | ((x &amp; 0x55555555) &lt;&lt; 1);\n}\n</code></pre>\n\n<p>Naive </p>\n\n<pre><code>uint32_t naiverevese(uint32_t x)\n{\n    uint32_t result = 0;\n    for(int i = 0; i &lt; 32; i++)\n    {\n        result |= x &amp; 1;\n        result &lt;&lt;=1;\n        x &gt;&gt;= 1;\n    }\n    return result;\n}\n</code></pre>\n\n<p>or lookup table.</p>\n\n<p>Not portable but the most efficient:</p>\n\n<p>Many processors have a special instructions for it for example:</p>\n\n<p>ARM - <code>rbit</code> and the intrinsic <code>unsigned int __rbit(unsigned int val)</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11383582"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56369201, "answer_count": 1, "score": 1, "last_activity_date": 1559167881, "creation_date": 1559166139, "question_id": 56368919, "link": "https://stackoverflow.com/questions/56368919/how-to-read-reversed-number-from-a-binary-file", "title": "How to read reversed number from a binary file?", "body": "<p>i would like to read a 32-bits number from binary file in C. The problem is that the order of bits is reversed. For an example 3 digits number 110 would stand for 3, not for 6. At the beginning we have the least significant bit (2^0), then 2^1 and so on. Is there any simple way to do this in C, or do i have to write all the logic by myself (read the first bit, multiply it by 2^0, add to the sum, repeat to the end)?</p>\n"}, {"tags": ["c", "function", "pointers", "memory", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559184870, "post_id": 56368862, "comment_id": 99344376, "body": "@Ofer Bar Oz, What did you expect <code>Matrix[0][30]</code> to do?  Did you expect C to catch the coding mistake?"}, {"owner": {"reputation": 735, "user_id": 11579184, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206508738170662/picture?type=large", "display_name": "Gerardo Zinno", "link": "https://stackoverflow.com/users/11579184/gerardo-zinno"}, "edited": false, "score": 2, "creation_date": 1559269147, "post_id": 56368862, "comment_id": 99375493, "body": "there&#39;s no need to cast the result of a malloc since <code>void *</code>gets promoted automatically"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1559270513, "post_id": 56368862, "comment_id": 99375742, "body": "Suggest <code>Matrix[row] = calloc (width, sizeof *Matrix[row])</code> as allocation with <code>calloc</code> will zero all bytes in <code>Matrix[row]</code> initializing all elements <code>0</code> preventing <i>Undefined Behavior</i> on inadvertent access of an uninitialized element."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 11579184, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206508738170662/picture?type=large", "display_name": "Gerardo Zinno", "link": "https://stackoverflow.com/users/11579184/gerardo-zinno"}, "is_accepted": true, "score": 2, "last_activity_date": 1559269502, "creation_date": 1559269502, "answer_id": 56387920, "question_id": 56368862, "link": "https://stackoverflow.com/questions/56368862/how-to-make-sure-the-following-function-did-not-over-allocate/56387920#56387920", "title": "How to make sure the following function did not over-allocate?", "body": "<p>There are no problems with your allocation. In C if you go outside the boundaries and you're lucky you get a segmentation fault signal and the program terminates (if you haven't installed a particular signal handler for this signal), but if you land on some valid memory you get access to that memory and risk to corrupt something.</p>\n\n<p>As others said in the comments C won't catch coding mistakes but if you compile with the flags <code>-Wall -pedantic -g</code> the compiler will generate some warnings when something is off and some time it'll even give you an hint on how to fix the mistake. Learn also how to use <code>valgrind</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559272163, "creation_date": 1559272163, "answer_id": 56388181, "question_id": 56368862, "link": "https://stackoverflow.com/questions/56368862/how-to-make-sure-the-following-function-did-not-over-allocate/56388181#56388181", "title": "How to make sure the following function did not over-allocate?", "body": "<p>There is nothing wrong with your allocation scheme, but there are a number of improvements than can be made. If your debugger is reporting a 30-element row is reachable -- there is something wrong with how you are looking at the information.</p>\n\n<p>First, there is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a>.</p>\n\n<p>Avoid <code>exit</code> in allocation functions. The caller should have the option of gracefully handling the failure-to-allocate rather than your program exiting at that point. While <code>exit</code> is valid, it severely limits your options for handling the failure. Instead, return a valid pointer on success, or <code>NULL</code> otherwise, and let the caller handle the error. In the case of a failed allocation, it is up to you to <code>free()</code> all previous allocations before returning <code>NULL</code>.</p>\n\n<p>Consider using <code>calloc</code> to allocate storage for <code>matrix[row]</code>. <code>calloc</code> sets all bytes allocated to zero effectively initializing each element for each row to <code>0</code> preventing <em>Undefined Behavior</em> on the inadvertent access of an uninitialized element after return.</p>\n\n<p>Putting all the pieces together, you could do something similar to:</p>\n\n<pre><code>/* allocatematrix allocates storage for a width x height matrix of type int.\n * all elements are initialized zero. on success returns a pointer to pointer\n * to type, otherwise all allocations are freed and NULL is returned.\n */\nint **allocatematrix (int width, int height)\n{\n    int **matrix;\n    int row;    /* declare row in for loop declaration, unless c89 support needed */\n\n    matrix = malloc (height * sizeof *matrix);  /* allocate pointers */\n    if (!matrix) {                  /* validate */\n        perror (\"malloc-matrix\");   /* malloc failure set errno, use it */\n        return NULL;                /* evaluate return in caller */\n    }\n\n    for (row = 0; row &lt; height; row++) {    /* for each pointer */\n        matrix[row] = calloc (width, sizeof *matrix[row]);  /* alloc rows */\n        if (!Matrix[row]) {         /* validate */\n            perror (\"calloc-matrix[row]\");  /* ditto for calloc */\n            while (row--)           /* loop over previous rows */\n                free (matrix[row]); /* free previously allocated rows */\n            free (matrix);          /* free pointers */\n            return NULL;            /* evaluate return in caller */\n        }\n    }\n\n    return matrix;  /* return initial pointer address */\n}\n</code></pre>\n\n<p>(<strong>note:</strong> while not an error, C generally avoids the use of <code>camelCase</code> or <code>MixedCase</code> variable and function names in favor of all <em>lower-case</em> while reserving <em>upper-case</em> names for use with macros and constants. It is a matter of style -- so it is completely up to you)</p>\n\n<p>(<strong>also note:</strong> the use of <code>perror</code> instead of <code>printf</code> for error reporting. When a function sets <code>errno</code> on failure, <code>perror</code> should be used. Further it already provides output on <code>stderr</code>. If dealing with a failure where <code>errno</code> isn't set, the use <code>fprintf</code> (if a conversion is needed) or <code>fputs</code> otherwise and report the error on <code>stderr</code> instead of <code>stdout</code>)</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 55, "user_id": 10055485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f93f2e67821fe52389947924821bade?s=128&d=identicon&r=PG&f=1", "display_name": "oofar", "link": "https://stackoverflow.com/users/10055485/oofar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56387920, "answer_count": 2, "score": 2, "last_activity_date": 1559272163, "creation_date": 1559165791, "last_edit_date": 1559166353, "question_id": 56368862, "link": "https://stackoverflow.com/questions/56368862/how-to-make-sure-the-following-function-did-not-over-allocate", "title": "How to make sure the following function did not over-allocate?", "body": "<p>I'm trying to make a function that gets number of columns and rows (width and height), build a 2D matrix, and then return the address of Matrix[0][0] back to a pointer in the original caller-function.</p>\n\n<pre><code>int **allocateMatrix(int width, int height) // function that allocate \n//memory for 2D matrix and check that memory allocation was successful\n{\n    int **Matrix;\n    int row;\n    Matrix = (int**)malloc(sizeof(int*)*height); \n    if (!Matrix)\n    {\n        printf(\"failed to allocate memory. this program is over.\\n\");\n        exit(1);\n    }\n    for (row = 0; row &lt; height; row++)    \n    {   Matrix[row] = (int*)malloc(sizeof(int)*width);     \n      if (!Matrix[row])\n      { \n        printf(\"failed to allocate memory. this program is over.\\n\");\n        exit(1);\n      }\n    }\n    return Matrix;\n}\n</code></pre>\n\n<p>during the allocating i watched the whole thing through the debugger and it seems to create a way-too-big matrix then i intended, and an unexpected behavior in general.\nsuch as: height =5, width =5, \nthough Matrix[0][30] - exist and reachable.</p>\n\n<p>moreover, Im not sure about the address im returning.</p>\n"}, {"tags": ["c", "arrays", "memory-management", "dynamic", "struct"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1559165028, "post_id": 56368553, "comment_id": 99340145, "body": "C11 draft standard n1570: <i>4 An argument may be an expression of any complete object type. In preparing for the call to a function, the arguments are evaluated, and each parameter is assigned the value of the corresponding argument. 93) A function may change the values of its parameters, but these changes cannot affect the values of the arguments.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1559166031, "creation_date": 1559166031, "answer_id": 56368897, "question_id": 56368553, "link": "https://stackoverflow.com/questions/56368553/creating-an-array-of-structs-by-adding-dynamically-some-struct-elements/56368897#56368897", "title": "Creating an array of structs by adding dynamically some struct-elements", "body": "<p>You need to pass the address of a pointer variable to <code>load_flights</code>. Then <code>load_flights</code> needs to indirect through the variable to modify the caller's variable.</p>\n\n<p>To handle the dynamic size of the input, you need to use <code>realloc()</code> each time through the loop to grow the array.</p>\n\n<pre><code>int main(void) {\n\n    flights **flight_list = NULL;\n    int numFlights = 0;\n\n    if (!(numFlights = load_flights(&amp;flight_list)))      \n        return EXIT_FAILURE;\n\n    /* ... */\n}\n\nshort load_flights(flights ***flight_list) {\n\n    FILE *fp = NULL;\n    char file_buffer[256] = {};\n    int i = 0;\n\n    if (fp = fopen(\"flights.txt\", \"r\")) {\n\n        /* create array of structs */\n        flight_list **temp_flight_list = NULL;\n\n        /* read current line of flight from textfile */\n        while (fgets(file_buffer, sizeof(file_buffer), fp)) {\n            // Grow the flight list array\n            flights **new_flight_list = realloc(*flight_list, (i+1) * sizeof(flight_list *));\n            if (new_flight_list == NULL) { // allocation failed, throw everything away\n                for (int j = 0; j &lt; i-1; j++) {\n                    free(temp_flight_list[i]-&gt;flnum);\n                    free(temp_flight_list[i]-&gt;from);\n                    /* ... */\n                    free(temp_flight_list[i]);\n                }\n                free(temp_flight_list);\n                return 0;\n            }\n            temp_flight_list = new_flight_list;\n            /* create a new struct and add it to the array */\n            if ((temp_flight_list[i] = calloc(1, sizeof(flights))) != NULL) {\n                // Parse the buffer ...\n                /* create every variable of the struct */\n                temp_flight_list[i]-&gt;flnum = calloc(1, strlen(ptr)+1);\n\n                /* ... */\n\n            } else { // allocation failed, throw everything away\n                for (int j = 0; j &lt; i-1; j++) {\n                    free(temp_flight_list[i]-&gt;flnum);\n                    free(temp_flight_list[i]-&gt;from);\n                    /* ... */\n                    free(temp_flight_list[i]);\n                }\n                free(temp_flight_list);\n                return 0;\n            }\n            i++;\n        }\n        // Store new flight list in caller's variable\n        *flight_list = temp_flight_list;\n        return i;\n    }\n    else return 0;\n\n}\n</code></pre>\n\n<p>See also</p>\n\n<p><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a></p>\n\n<p>and </p>\n\n<p><a href=\"https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a></p>\n"}], "owner": {"reputation": 301, "user_id": 6053974, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3e65e6c830037c74e0fa29b3f5830e4d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gierer", "link": "https://stackoverflow.com/users/6053974/michael-gierer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559166031, "creation_date": 1559164208, "question_id": 56368553, "link": "https://stackoverflow.com/questions/56368553/creating-an-array-of-structs-by-adding-dynamically-some-struct-elements", "title": "Creating an array of structs by adding dynamically some struct-elements", "body": "<p>I've been struggling with C pointers for hours now. I'm trying to create a C program which manages flights. A flight contains the following:</p>\n\n<pre><code>flight-number, from, to, date, price\n\nOS772,Vienna,New York,15.12.2018,638.00\n</code></pre>\n\n<p>Therefore, I'm reading a textfile of this given structure. On every line read, I need to create another struct and add it to my array or \"list\" of structs.</p>\n\n<p>The struct looks like:</p>\n\n<pre><code>typedef struct flights {\n    char *flnum;\n    char *from;\n    char *to;\n    char *date;\n    float price;\n    struct person *fPerson;\n}flights;\n</code></pre>\n\n<p><strong>My problem: Inside the function, the array of structs is created properly. But back in the main-function, the pointer to the array called 'flights **flight_list' is still NULL.</strong></p>\n\n<p>Here is the code (only the necessary parts):</p>\n\n<pre><code>int main(void) {\n\n    flights **flight_list = NULL;\n    int numFlights = 0;\n\n    if (!(numFlights = load_flights(flight_list)))      \n        return EXIT_FAILURE;\n\n    /* value of flight_list = 0x0000 -&gt; unchanged! */\n    /* ... */\n</code></pre>\n\n<p>Function <code>short load_flights(flights **flight_list)</code>:</p>\n\n<pre><code>short load_flights(flights **flight_list) {\n\n    FILE *fp = NULL;\n    char file_buffer[256] = {};\n    int i = 0;\n\n    if (fp = fopen(\"flights.txt\", \"r\")) {\n\n        /* create array of structs */\n        flight_list = (flights **)calloc(1, sizeof(int));\n\n        while (!feof(fp)) {\n\n            /* read current line of flight from textfile */\n            fgets(file_buffer, sizeof(file_buffer), fp);\n\n            /* create a new struct and add it to the array */\n            if ((flight_list[i] = (flights *)calloc(1, sizeof(flights))) != NULL) {\n\n                /* create every variable of the struct */\n                flight_list[i]-&gt;flnum = (char *)calloc(1, strlen(ptr)+1);\n\n                /* ... */\n\n            }\n\n            i++;\n        }\n    }\n    else return 0;\n\n    /* values of the struct-array are properly set; look in attached picture */\n\n    return i;\n}\n</code></pre>\n\n<p>This image was taken while debugging the array-creation process before <code>return i;</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dVK0J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dVK0J.png\" alt=\"viewing array of struct\"></a></p>\n\n<p>And here outside the function; inside main:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cJ9vP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cJ9vP.png\" alt=\"viewing array of structs in main\"></a></p>\n\n<p><strong>So, why is my array of structs gone in the main-function?</strong></p>\n"}, {"tags": ["c", "floating-point", "printf"], "comments": [{"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 2, "creation_date": 1559162423, "post_id": 56368142, "comment_id": 99339285, "body": "Just a thought, if you&#39;re &quot;printing&quot; to <code>numbuf</code>, a 10-character array, a number which will involve more than 10 characters, wouldn&#39;t that be a natural source of &quot;my program gets aborted&quot;?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559163138, "post_id": 56368142, "comment_id": 99339543, "body": "To see the largest float value, try <code>printf(&quot;%f\\n&quot;, FLT_MAX);</code>. You&#39;ll need to <code>#include &lt;float.h&gt;</code>"}, {"owner": {"reputation": 91, "user_id": 9367095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JYfXu.jpg?s=128&g=1", "display_name": "Phridge", "link": "https://stackoverflow.com/users/9367095/phridge"}, "edited": false, "score": 0, "creation_date": 1559163140, "post_id": 56368142, "comment_id": 99339547, "body": "Thanks for your answer, apparently, i forgot to specify an upper bound to these numbers, which was actually my plan.  :)"}, {"owner": {"reputation": 91, "user_id": 9367095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JYfXu.jpg?s=128&g=1", "display_name": "Phridge", "link": "https://stackoverflow.com/users/9367095/phridge"}, "edited": false, "score": 0, "creation_date": 1559163175, "post_id": 56368142, "comment_id": 99339555, "body": "is there a way to &quot;truncate&quot; floats if they are too long?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559163315, "post_id": 56368142, "comment_id": 99339606, "body": "You can use <code>snprintf</code> instead of <code>sprintf</code>."}, {"owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "edited": false, "score": 0, "creation_date": 1559163557, "post_id": 56368142, "comment_id": 99339688, "body": "What exactly do you mean truncate it?  You can limit the number of digits by using scientific notation eg <code>printf(&quot;Float max: %.4g\\n&quot;, FLT_MAX);</code> -    From the man page, on %g &#39;Style e is used if the exponent from its conversion is less than -4 or greater than or equal to the precision.  Trailing zeros are removed from the fractional part of the result; a decimal point appears only if it is followed by at least one digit"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559163684, "post_id": 56368142, "comment_id": 99339732, "body": "You can use an <code>%e</code> or <code>%g</code> format to have control of the number of digits printed regardless of the magnitude of the number.  When printing a float <code>x</code> according to a <code>%f</code> format, however, you will always get at least log10(abs(x)) digits."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 2, "creation_date": 1559163720, "post_id": 56368142, "comment_id": 99339745, "body": "I deleted my incorrect answer, but wanted to point out that the <code>void*</code> pointer arithmetic in <code>(void *)mat + sizeof(struct matrix)</code> is undefined behavior. You probably want something more like <code>(float*)((char *)mat + sizeof(struct matrix))</code>."}, {"owner": {"reputation": 91, "user_id": 9367095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JYfXu.jpg?s=128&g=1", "display_name": "Phridge", "link": "https://stackoverflow.com/users/9367095/phridge"}, "edited": false, "score": 0, "creation_date": 1559163943, "post_id": 56368142, "comment_id": 99339818, "body": "so i fixed it by clamping the value between -4096 and 4096, it works enough for me. Thaks for all you answers!"}], "owner": {"reputation": 91, "user_id": 9367095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JYfXu.jpg?s=128&g=1", "display_name": "Phridge", "link": "https://stackoverflow.com/users/9367095/phridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559162515, "creation_date": 1559162122, "last_edit_date": 1559162515, "question_id": 56368142, "link": "https://stackoverflow.com/questions/56368142/printf-printing-suspiciously-large-float", "title": "Printf printing suspiciously large float", "body": "<p>So currently im trying to print a float array (float *) containing some uninitialised float values. Somehow, in my console it shows values like this (using \"%d: %f\\n\" as format):</p>\n\n<pre><code>-0.000000\n0.000000\n68509253839697691852885035134612406272.000000\n0.000000\n-0.000000\n0.000000\n</code></pre>\n\n<p>This makes no sense to me. How can a float be so long?\nAlso, in a quite similar situation where im using sprintf with format \"% 5.1f \" to \"toString\" a matrix, my program gets aborted (\"line 11:  1294 Abort trap: 6\"):</p>\n\n<pre><code>void mat_print(char * buf, matptr_t mat) {\n  char numbuf[10] = {0};\n  strcpy(buf, \"\");\n\n  for(uint32_t y = 0, ystop = mat-&gt;h; y &lt; ystop; y++) {\n    strcat(buf, y == 0? \"[ \" : \"\\n[ \");\n    for(uint32_t x = 0, xstop = mat-&gt;w; x &lt; xstop; x++) {\n      // on x = 2, i get an abort\n      sprintf(numbuf, \"% 5.1f \", mat_get(mat, y, x));\n      strcat(buf, numbuf);\n    }\n    strcat(buf, \"]\");\n  }\n}\n</code></pre>\n\n<p>here, im trying to get a value from a matrix object</p>\n\n<pre><code>struct matrix {\n  uint32_t h, w;\n  float * matrix;\n};\ntypedef struct matrix * matptr_t;\n</code></pre>\n\n<p>with a function called mat_get</p>\n\n<pre><code>inline float mat_get(matptr_t mat, uint32_t y, uint32_t x) {\n  return mat-&gt;matrix [y * mat-&gt;w + x];\n}\n</code></pre>\n\n<p>the matrix float pointer array is pointing on an allocated region next to the matrix itself, its all allocated in one go:</p>\n\n<pre><code>matptr_t matrix(uint32_t h, uint32_t w) {\n  // nn_allocator is a function pointer to malloc\n  matptr_t mat = (matptr_t) nn_allocator(sizeof(struct matrix) + h * w * sizeof(float));\n  mat-&gt;h = h;\n  mat-&gt;w = w;\n  mat-&gt;matrix = (void *)mat + sizeof(struct matrix);\n  return mat;\n}\n</code></pre>\n\n<p>the large floats are printed with:</p>\n\n<pre><code>// matptr is a pointer to a matrix object\nfloat * values = (matptr)-&gt;matrix;\nfor(uint32_t i = 0, stop = (matptr)-&gt;w * (matptr)-&gt;h; i &lt; stop; i++, values++) {\n  printf(\"%d: %f\\n\", i, *values);\n}\n</code></pre>\n\n<p>So the question is: <strong>How can this code be fixed so it doesnt abort my program anymore and why is this float so long?</strong></p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559161397, "post_id": 56367929, "comment_id": 99338911, "body": "Use the token pasting operator."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 10064643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TFxF-ngiQbg/AAAAAAAAAAI/AAAAAAAAAjk/W3sRzPL4fNE/photo.jpg?sz=128", "display_name": "Bonfra", "link": "https://stackoverflow.com/users/10064643/bonfra"}, "edited": false, "score": 0, "creation_date": 1559161687, "post_id": 56367982, "comment_id": 99339022, "body": "yes i forgot to put a pice in the post now is updated"}, {"owner": {"reputation": 167, "user_id": 10064643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TFxF-ngiQbg/AAAAAAAAAAI/AAAAAAAAAjk/W3sRzPL4fNE/photo.jpg?sz=128", "display_name": "Bonfra", "link": "https://stackoverflow.com/users/10064643/bonfra"}, "edited": false, "score": 0, "creation_date": 1559161751, "post_id": 56367982, "comment_id": 99339044, "body": "until now i&#39;ve used the switch but i wanted to avoid long portions of code"}, {"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "reply_to_user": {"reputation": 167, "user_id": 10064643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TFxF-ngiQbg/AAAAAAAAAAI/AAAAAAAAAjk/W3sRzPL4fNE/photo.jpg?sz=128", "display_name": "Bonfra", "link": "https://stackoverflow.com/users/10064643/bonfra"}, "edited": false, "score": 0, "creation_date": 1559161756, "post_id": 56367982, "comment_id": 99339046, "body": "I see, so in that case perhaps define a function <code>call</code> that implements a <code>switch</code> as above or <code>if&#47;else</code> to call the right underlying function based on the runtime value of the argument."}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559161406, "creation_date": 1559161406, "answer_id": 56367982, "question_id": 56367929, "link": "https://stackoverflow.com/questions/56367929/callins-specific-function-depending-on-macro-parameter-in-c/56367982#56367982", "title": "Callins specific function depending on macro parameter in C", "body": "<p>Perhaps use the concatenation operator (<code>##</code>)</p>\n\n<pre><code>#define call(N) call##N()\n</code></pre>\n\n<p>It's unclear why this would be necessary though - why not just type call1() instead of call(1). This won't help with dynamically selecting the right function to call based on a variable. For that you'd need conditional logic.</p>\n\n<pre><code>switch (n) {\n    case 1: call1(); break;\n    case 2: call2(); break;\n    default: ...; break;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 10064643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TFxF-ngiQbg/AAAAAAAAAAI/AAAAAAAAAjk/W3sRzPL4fNE/photo.jpg?sz=128", "display_name": "Bonfra", "link": "https://stackoverflow.com/users/10064643/bonfra"}, "edited": false, "score": 0, "creation_date": 1559162330, "post_id": 56368064, "comment_id": 99339255, "body": "good idea i&#39;m just working on it give me some time. now is night here i&#39;ll post result next day"}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": true, "score": 1, "last_activity_date": 1559161747, "creation_date": 1559161747, "answer_id": 56368064, "question_id": 56367929, "link": "https://stackoverflow.com/questions/56367929/callins-specific-function-depending-on-macro-parameter-in-c/56368064#56368064", "title": "Callins specific function depending on macro parameter in C", "body": "<p>If <code>N</code> is guaranteed to be a digit 1, 2, or 3, one could use</p>\n\n<pre><code>#define call(N) func##N()\n</code></pre>\n\n<p>but that could fail if <code>N</code> might have other forms.  If the only other possibility that needed to be accounted for would be that <code>N</code> could be a macro that would expand to a single digit, one could use:</p>\n\n<pre><code>#define do_call(N) func##N()\n#define call(N) do_call(N)\n</code></pre>\n\n<p>Alternatively, one could allow for <code>N</code> being computed in arbitrary fashion if the code were written as:</p>\n\n<pre><code>void (*const funcs[3])(void) = {func1, func2, func3};\n\nvoid call(int n)\n{\n    funcs[n-1]();\n}\n</code></pre>\n\n<p>If the functions return a value or take parameters, replace the leading <code>void</code> with the return type and/or replace <code>(void)</code> with a parameter list.  This approach would work even if the value <code>N</code> is a complex expression or may not be known until runtime.</p>\n"}], "owner": {"reputation": 167, "user_id": 10064643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TFxF-ngiQbg/AAAAAAAAAAI/AAAAAAAAAjk/W3sRzPL4fNE/photo.jpg?sz=128", "display_name": "Bonfra", "link": "https://stackoverflow.com/users/10064643/bonfra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56368064, "answer_count": 2, "score": 0, "last_activity_date": 1559161747, "creation_date": 1559161164, "last_edit_date": 1559161651, "question_id": 56367929, "link": "https://stackoverflow.com/questions/56367929/callins-specific-function-depending-on-macro-parameter-in-c", "title": "Callins specific function depending on macro parameter in C", "body": "<p>I have multiple functions with very similar identifiers (func1(), func2(), func3(), ...) and i need to create a macro to call them all in one.</p>\n\n<p>i already tried to use concatenation but i couldn't figure it out.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void func1() {}\nvoid func2() {}\nvoid func3() {}\n\n#define call(N) // here needs to go the code to call the N func like func#N()\n</code></pre>\n\n<p>so that later in the code i can do something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main()\n{\n    for(int i = 0; i &lt; 3; i++)\n        call(i);\n}\n</code></pre>\n\n<p>if there are other methods that i don't know or you can do it in another way show me your ideas. if possible i'd like to stick with macros</p>\n"}, {"tags": ["c", "gcc", "types", "type-conversion"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1559160638, "post_id": 56367763, "comment_id": 99338635, "body": "Unless <code>INT_MAX</code> is smaller than <code>USHORT_MAX</code>, the expression will be of type <code>int</code>. Hence, to have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, you need to post the relevant values from <code>limits.h</code>."}, {"owner": {"reputation": 147, "user_id": 4745420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fc9Yx.jpg?s=128&g=1", "display_name": "Noisy88", "link": "https://stackoverflow.com/users/4745420/noisy88"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1559160818, "post_id": 56367763, "comment_id": 99338700, "body": "Result of XOR can&#39;t be more than 0xFFFF. Thanks."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1559160872, "post_id": 56367763, "comment_id": 99338722, "body": "How do you figure that out?"}, {"owner": {"reputation": 147, "user_id": 4745420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fc9Yx.jpg?s=128&g=1", "display_name": "Noisy88", "link": "https://stackoverflow.com/users/4745420/noisy88"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1559161023, "post_id": 56367763, "comment_id": 99338782, "body": "Maximum value of unsigned short can be only 0xFFFF. If we have a equals 0xFFFF and b equals 0, then result of XOR will be 0xFFFF. 16 bit data type..."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1559161323, "post_id": 56367763, "comment_id": 99338884, "body": "The maximum value an <code>unsigned short</code> can hold is not <code>0xFFFF</code>, it&#39;s <code>USHRT_MAX</code>, which has an implementation defined value no smaller than <code>65535</code>. Consequently, the value can be larger. Moreover, the value of <code>INT_MAX</code> is also implementation defined and may be as low as <code>32767</code>."}, {"owner": {"reputation": 147, "user_id": 4745420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fc9Yx.jpg?s=128&g=1", "display_name": "Noisy88", "link": "https://stackoverflow.com/users/4745420/noisy88"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1559161662, "post_id": 56367763, "comment_id": 99339012, "body": "Consequently, the result depends on the compiler implementation, right?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559161815, "post_id": 56367763, "comment_id": 99339076, "body": "Which expression are you asking about, <code>a ^ b</code>, <code>(a ^ b)</code>, <code>(a ^ b) &gt; 0</code>, or something else?"}, {"owner": {"reputation": 147, "user_id": 4745420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fc9Yx.jpg?s=128&g=1", "display_name": "Noisy88", "link": "https://stackoverflow.com/users/4745420/noisy88"}, "edited": false, "score": 0, "creation_date": 1559162362, "post_id": 56367763, "comment_id": 99339266, "body": "(a^b). I wondered if it could happen that the result of this expression would be a negative number. in this case, the result of the expression ((a^b) &gt; 0) will be a false."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1559163615, "last_edit_date": 1559163615, "creation_date": 1559162412, "answer_id": 56368198, "question_id": 56367763, "link": "https://stackoverflow.com/questions/56367763/what-is-the-type-of-result-is-it-possible/56368198#56368198", "title": "What is the type of result? Is it possible?", "body": "<p>In <code>(a ^ b) &gt; 0</code>, where <code>a</code> and <code>b</code> are <code>unsigned short</code>:</p>\n\n<ul>\n<li>If <code>unsigned short</code> is narrower than <code>int</code>, <code>a</code> and <code>b</code> are each converted to <code>int</code> (per the <em>integer promotions</em>, C 2018 6.3.1.1 2, and because <code>unsigned short</code> being narrower than <code>int</code> necessarily means <code>int</code> can represent all values of <code>unsigned short</code>).</li>\n<li>Otherwise, <code>a</code> and <code>b</code> are converted to <code>unsigned int</code> (<em>ibid</em>).</li>\n<li>For <code>a ^ b</code>, the <em>usual arithmetic conversions</em> are performed (6.5.11). In this expression, the usual arithmetic conversions do not change the types (6.3.1.8 1). Also per the usual arithmetic conversions, the result has the same type as the operands after the conversions. Thus, the result is <code>int</code> or <code>unsigned int</code> as described above.</li>\n<li><code>(a ^ b)</code> has the same type as <code>a ^ b</code> (6.5.1 5).</li>\n<li>For <code>(a ^ b) &gt; 0</code>, the result has type <code>int</code> (6.5.8 6).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1559162996, "last_edit_date": 1559162996, "creation_date": 1559162428, "answer_id": 56368199, "question_id": 56367763, "link": "https://stackoverflow.com/questions/56367763/what-is-the-type-of-result-is-it-possible/56368199#56368199", "title": "What is the type of result? Is it possible?", "body": "<p>The expression <code>a ^ b</code> likely has type <code>int</code>, but will have type <code>unsigned int</code> in the event that there are any values that can be represented as <code>unsigned short</code>s but not as <code>int</code>s.  Its value will not exceed <code>USHRT_MAX</code> for general <code>a</code> and <code>b</code> of type <code>unsigned short</code>, and will be exactly 3 for the specific <code>a</code> and <code>b</code> in the example.</p>\n\n<p>(From comments:)</p>\n\n<blockquote>\n  <p>I wondered if it could happen that the result of [<code>(a^b)</code>] would be a negative number. in this case, the result of the expression ((a^b) > 0) will be a false</p>\n</blockquote>\n\n<p>It will never evaluate to a negative number because whether the usual arithmetic promotions result in the operands being converted to <code>int</code> or to <code>unsigned int</code>, the resulting values will be unchanged, and therefore non-negative.  Neither operand's sign bit, if any, will be set, so the result's sign bit, if any, will not be set either.</p>\n\n<p>The expression <code>(a ^ b) &gt; 0</code> has type <code>int</code>, and it evaluates to 1 for the given <code>a</code> and <code>b</code>.  More generally, it evaluates to the same result as <code>a != b</code> for <code>a</code> and <code>b</code> of integer type.  Of course, that <em>can</em> evaluate to 0.  On the other hand, the related expression <code>(a ^ b) &gt;= 0</code> will always evaluate to 1 for <code>a</code> and <code>b</code> of unsigned type.</p>\n"}], "owner": {"reputation": 147, "user_id": 4745420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fc9Yx.jpg?s=128&g=1", "display_name": "Noisy88", "link": "https://stackoverflow.com/users/4745420/noisy88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56368199, "answer_count": 2, "score": -4, "last_activity_date": 1559163615, "creation_date": 1559160343, "question_id": 56367763, "link": "https://stackoverflow.com/questions/56367763/what-is-the-type-of-result-is-it-possible", "title": "What is the type of result? Is it possible?", "body": "<p>I try to search an answer to my question...\nWhat is the type of this expression will be at C language?</p>\n\n<pre><code>unsigned short a, b;\na = 0x1;\nb = 0x2;\nif((a ^ b) &gt; 0) //This expression... \n...\n</code></pre>\n\n<p>I understand that this is not a completely correct code that can cause an error. I should use != instead >.</p>\n\n<p>I think that the type of the result of the expression will be unsigned int. I read about it in Stephen Pratt\u2019s book.</p>\n\n<p>If we have two types, then the result of an expression involving these types must be a superior type. (int or unsigned int)</p>\n\n<p>If these two variables have any other values, can it be that this expression will be less than zero? \n(If we set the most significant bit in the number, it will become negative, provided that it has signed data type)</p>\n\n<p>I think it is impossible, but I could be wrong.\nI made my guess, but I want to know the correct answer to my question.</p>\n"}, {"tags": ["c", "shared-libraries", "vips"], "comments": [{"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "reply_to_user": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "edited": false, "score": 0, "creation_date": 1559228048, "post_id": 56367730, "comment_id": 99361589, "body": "I see. I&#39;ll do just that!"}], "answers": [{"comments": [{"owner": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "edited": false, "score": 0, "creation_date": 1559242054, "post_id": 56383185, "comment_id": 99368073, "body": "I added a note to the docs for this. Thanks! <a href=\"https://github.com/libvips/libvips/commit/81861baee967380dd1e45fe863f57b1c960fcea8\" rel=\"nofollow noreferrer\">github.com/libvips/libvips/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1559238428, "creation_date": 1559238428, "answer_id": 56383185, "question_id": 56367730, "link": "https://stackoverflow.com/questions/56367730/where-to-invoke-vips-init-in-a-c-shared-library/56383185#56383185", "title": "Where to invoke VIPS_INIT in a C shared library", "body": "<p>libvips uses <code>argv[0]</code> to help discover message catalogues if its been relocated. If you don't need a relocatable package, you can just pass <code>\"\"</code> and it'll be fine.</p>\n\n<p>Other notes: be careful not to init from more than one thread at the same time, and make sure init finishes before you try any processing. </p>\n"}], "owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56383185, "answer_count": 1, "score": 0, "last_activity_date": 1559238428, "creation_date": 1559160173, "question_id": 56367730, "link": "https://stackoverflow.com/questions/56367730/where-to-invoke-vips-init-in-a-c-shared-library", "title": "Where to invoke VIPS_INIT in a C shared library", "body": "<p>I am working on a C shared library that would contain one function that receives a filename, and returns a pointer to the C-array representation of the image.</p>\n\n<p>I read <code>VIPS_INIT</code> needs to be set in the beginning of the program, with <code>argv[0]</code> as its argument. However, since this is a shared library, I'm not sure where exactly do I need to place this.</p>\n"}, {"tags": ["c", "bash", "shell", "raspberry-pi", "execl"], "comments": [{"owner": {"reputation": 21090, "user_id": 23388, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca187415943d751998228574c066c94f?s=128&d=identicon&r=PG", "display_name": "nimrodm", "link": "https://stackoverflow.com/users/23388/nimrodm"}, "edited": false, "score": 0, "creation_date": 1559160296, "post_id": 56367659, "comment_id": 99338498, "body": "Try redirecting stdout and stderr to a file and see if any error message is generated."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559160303, "post_id": 56367659, "comment_id": 99338503, "body": "Why is there a <code>strcpy</code> at all? You can use <code>char const* name = &quot;&#47;home&#47;pi&#47;SelfTest.sh&quot;;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 1, "creation_date": 1559171180, "post_id": 56367722, "comment_id": 99341751, "body": "Minor correction: <code>execl</code> can return if there&#39;s an error executing the file (as there is in the original version)."}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": false, "score": 1, "last_activity_date": 1559160146, "creation_date": 1559160146, "answer_id": 56367722, "question_id": 56367659, "link": "https://stackoverflow.com/questions/56367659/why-cant-i-use-execl-to-run-a-bash-script/56367722#56367722", "title": "Why can&#39;t I use execl() to run a bash script?", "body": "<p>Unless if you are running this from <code>/</code>, this line is missing a slash before <code>home</code>:</p>\n\n<pre><code>strcpy(name, \"home/pi/SelfTest.sh\");\n</code></pre>\n\n<p>Also, <code>execl</code> will never return. You may want to look up information on the <code>fork()</code> and <code>exec()</code> pattern.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 5348613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84a298224f6048a172f91a9b275f5a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Sunilkumar", "link": "https://stackoverflow.com/users/5348613/n-sunilkumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1559229589, "creation_date": 1559229589, "answer_id": 56381073, "question_id": 56367659, "link": "https://stackoverflow.com/questions/56367659/why-cant-i-use-execl-to-run-a-bash-script/56381073#56381073", "title": "Why can&#39;t I use execl() to run a bash script?", "body": "<p>Apparently I'm super clumsy and didn't realize that I didn't need bash. I changed 'char *command = \"/bin/bash\";' to 'char *command = \"/bin/sh\";' and the script ran as expected!</p>\n"}], "owner": {"reputation": 55, "user_id": 5348613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84a298224f6048a172f91a9b275f5a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Sunilkumar", "link": "https://stackoverflow.com/users/5348613/n-sunilkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56381073, "answer_count": 2, "score": 0, "last_activity_date": 1559229589, "creation_date": 1559159805, "question_id": 56367659, "link": "https://stackoverflow.com/questions/56367659/why-cant-i-use-execl-to-run-a-bash-script", "title": "Why can&#39;t I use execl() to run a bash script?", "body": "<p>I'm trying to run a bash script from a website button on a raspberry pi, where the script is located in home/pi/. The code snippet below shows my current solution. Whenever the website button is pressed, it calls this block of code in a c file. </p>\n\n<pre><code>else if(strcmp(argv[1],\"SelfTest\") == 0)\n    {\n        char *command = \"/bin/bash\";\n        char name[40];\n        strcpy(name, \"home/pi/SelfTest.sh\");\n        execl(command, command, name, NULL);\n        return 0;\n    }\n</code></pre>\n\n<p>I'm running this on a Raspberry Pi 3+, the script I'm running has 777 permissions and is owned by pi:www-data, if that helps.</p>\n\n<p>I tested to see if the IF block actually got called by just having it create an empty directory called 'TEST'. The bottom snippet of code shows how I approached that. This seems to work without issue (as soon as I press the button on the website, I 'ls' home/pi/ and a new folder called 'TEST' is there). Unfortunately, when I run the top snippet of code(to run SelfTest.sh), the script doesn't run (the script itself is supposed to record the output to a log file with a timestamp, and pressing the button does not update the timestamp. The timestamp only updates when I run the script from within the terminal)</p>\n\n<pre><code>else if(strcmp(argv[1],\"SelfTest\") == 0)\n    {\n        char *command = \"/bin/mkdir\";\n        char name[40];\n        strcpy(name, \"/home/pi/TEST\");\n        execl(command, command, name, NULL);\n        return 0;\n    }\n</code></pre>\n\n<p>What should be happening every time I press the website button is that it should run SelfTest.sh. I should be able to verify this by reading the logfile, but it never gets updated when I press the website button.</p>\n\n<p>Please let me know if you need any extra information!</p>\n"}, {"tags": ["c", "gcc", "shared-libraries"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1559159743, "post_id": 56367631, "comment_id": 99338288, "body": "Read the documentation of MacOSX linker (probably of the <code>ld</code> program)"}], "answers": [{"comments": [{"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "edited": false, "score": 0, "creation_date": 1559160270, "post_id": 56367668, "comment_id": 99338484, "body": "I&#39;ve tried various combinations and to no avail. What do I need to read about linkers in this case? Obviously the whole book is not an option; same with changing the OS."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "edited": false, "score": 0, "creation_date": 1559160307, "post_id": 56367668, "comment_id": 99338507, "body": "You need to read the documentation of  <code>gcc</code>  and of <code>ld</code>, because <code>gcc</code> is invoking <code>ld</code>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": -1, "last_activity_date": 1559176279, "last_edit_date": 1559176279, "creation_date": 1559159842, "answer_id": 56367668, "question_id": 56367631, "link": "https://stackoverflow.com/questions/56367631/cannot-link-library-when-compiling-with-gcc/56367668#56367668", "title": "Cannot link library when compiling with gcc", "body": "<blockquote>\n  <p>What am I doing wrong and why cannot the library be found?</p>\n</blockquote>\n\n<p>Read about <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html\" rel=\"nofollow noreferrer\">Invoking GCC</a>. <strong>You was wrong in not reading that</strong> (or any other documentation of <code>gcc</code>).</p>\n\n<p><strong>Order of program arguments to <code>gcc</code> matters a lot</strong> (and in practice several arguments are very useful, e.g. both <code>-Wall</code> and <code>-g</code> at least, and probably <code>-v</code> sometimes). You want something like</p>\n\n<pre><code>gcc -v -Wall -g my.c -lmylib-osx -o my\n</code></pre>\n\n<p>(also try variants of that), since <code>gcc</code> is running some <code>ld</code> or equivalent <a href=\"https://en.wikipedia.org/wiki/Linker_(computing)\" rel=\"nofollow noreferrer\">linker</a> command, and if you want to pass some <code>-L</code><em>lib-directory</em> use something like</p>\n\n<pre><code>gcc -v -Wall -g my.c  -L./bin -lmylib-osx -o my\n</code></pre>\n\n<p>and you also need to read the documentation of MacOSX <a href=\"https://en.wikipedia.org/wiki/Linker_(computing)\" rel=\"nofollow noreferrer\">linker</a> (probably named  <code>ld</code>). You could also read Levine's <a href=\"http://iecc.com/linkers/\" rel=\"nofollow noreferrer\"><em>Linkers and loaders</em></a> book.</p>\n\n<p>If you are not happy with <code>gcc</code> (but please use a recent version, so <a href=\"https://gcc.gnu.org/gcc-8/\" rel=\"nofollow noreferrer\">GCC 8</a> in 2019, not the crappy software sold by Apple named <code>gcc</code>) consider using <a href=\"https://clang.llvm.org/\" rel=\"nofollow noreferrer\">Clang</a> (a recent version too, e.g. Clang 8 in 2019). It has the same limitation regarding order of program arguments than <code>gcc</code> does (since order of program arguments even mattered for Unix or POSIX <a href=\"https://en.wikipedia.org/wiki/List_of_compilers#C_compilers\" rel=\"nofollow noreferrer\"><code>cc</code></a>).</p>\n\n<p>In general, <strong>read the documentation of a command before asking questions</strong> here about that command. A minima, <code>man gcc</code> on your Apple (or Linux) computer.</p>\n\n<p>PS. The last time I have used some MacOSX was in 2004. My biased recommendation is to install and use Linux (which I use since 1993; I tried MacOSX around 2004 during less than a year, and have been disappointed both by the <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">operating system</a>, including its <a href=\"https://en.wikipedia.org/wiki/Display_server\" rel=\"nofollow noreferrer\">display server</a> and GUI <a href=\"https://en.wikipedia.org/wiki/Desktop_environment\" rel=\"nofollow noreferrer\">desktop environment</a>, and by the Apple hardware).</p>\n"}], "owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559176279, "creation_date": 1559159670, "question_id": 56367631, "link": "https://stackoverflow.com/questions/56367631/cannot-link-library-when-compiling-with-gcc", "title": "Cannot link library when compiling with gcc", "body": "<p>My directory structure is:</p>\n\n<pre><code>\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 mylib-osx.so.1.72\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 mylib.so.1.72\n\u251c\u2500\u2500 my.c\n</code></pre>\n\n<p>I am trying to compile <code>my.c</code> and link <code>mylib-osx.so.1.72</code> (I'm on a macOS), but to no avail:</p>\n\n<pre><code>ld: library not found for -l:PhotoDNAx64.so.1.72\n</code></pre>\n\n<p>I tried:</p>\n\n<ul>\n<li><code>gcc -o my -lmylib-osx my.c</code></li>\n<li><code>gcc -o my -lmylib-osx.so.1.72 my.c</code></li>\n<li><code>gcc -o my -lmylib my.c</code></li>\n<li><code>gcc -o my -L./bin -lmylib-osx my.c</code></li>\n<li><code>gcc -o my -L./bin -l:\"mylib-osx.so.1.72\" my.c</code></li>\n</ul>\n\n<p>What am I doing wrong and why cannot the library be found?</p>\n"}, {"tags": ["c", "fread", "fifo"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 4, "creation_date": 1559159543, "post_id": 56367533, "comment_id": 99338212, "body": "1. There&#39;s no reason for your program to be growing in memory unless you have a memory leak somewhere else. 2. read() (and therefore fread()) will block if there&#39;s no data available unless the file is specifically opened in non-blocking mode."}, {"owner": {"reputation": 2244, "user_id": 163231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f3584528141b950ebb596087b9a59ef?s=128&d=identicon&r=PG", "display_name": "count0", "link": "https://stackoverflow.com/users/163231/count0"}, "edited": false, "score": 1, "creation_date": 1559159981, "post_id": 56367533, "comment_id": 99338375, "body": "To add to Lee Daniel: use <code>valgrind</code> to check for your memleaks. There are also UI tooks like kcachegrind. To answer your other question: there is a fflush() method in C flushing the stream, but as mentioned fread is a <i>blocking</i> call, so calling fflush will not do anything in this case as there is nothing to flush."}, {"owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 0, "creation_date": 1559160152, "post_id": 56367533, "comment_id": 99338442, "body": "You seem to be right. If I remove my code that I replaced here with <code>&#47;&#47; ...</code> it does indeed not grow. I thought I had figured that out, but it seems I was wrong."}, {"owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 1, "creation_date": 1559161294, "post_id": 56367533, "comment_id": 99338872, "body": "Oh yes, I found the function that was causing the memory leak because of a missing <code>free(str)</code>. Thanks for the fast and concise answer :)"}], "owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559159241, "creation_date": 1559159241, "question_id": 56367533, "link": "https://stackoverflow.com/questions/56367533/clearing-buffer-on-fread-from-fifo-in-c", "title": "Clearing buffer on fread() from fifo in C?", "body": "<p>I am reading continuous data (lines of text/strnigs) from a FIFO using C function <code>fread()</code>. Now I noticed that my process is growing bigger and bigger in ram. Can I somehow flush the buffer of the <code>fopen()</code>handle?\nI can circumvent my process from growing if I do <code>fclose()</code> and subsequent <code>fopen()</code> after every line read, but is this really the solution?</p>\n\n<pre><code>int main() {\n    unsigned char buffer[1];\n\n    instream=fopen(\"/path/to/fifo\", \"r\");\n    if (instream!=NULL) {\n        while (fread(&amp;buffer, 1, 1, instream)==1) {\n            // ...\n        }\n    }\n    else {\n        // error handling...\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This works, but seems ugly and error prone?</p>\n\n<pre><code>int main() {\n    unsigned char buffer[1];\n\n    instream=fopen(\"/path/to/fifo\", \"r\");\n    if (instream!=NULL) {\n        while (fread(&amp;buffer, 1, 1, instream)==1) {\n            // ...\n\n        if (buffer[0] == '\\n') {\n            fclose(instream);\n            instream=fopen(\"/path/to/fifo\", \"r\");\n        }\n    }\n    else {\n        // error handling...\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>One additional question: is there a risk that my program reads faster than the output of the other program that writes into the fifo, and so <code>fread(...)</code> will be <code>0</code> and the <code>while</code>-loop will end?</p>\n"}, {"tags": ["c", "macos", "xpc"], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 1531373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ba426f9d13c72b5bd78cd1b5bb4b4c?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1531373/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1559168993, "creation_date": 1559168993, "answer_id": 56369348, "question_id": 56367326, "link": "https://stackoverflow.com/questions/56367326/macos-keep-xpc-service-bundled-running-after-user-quits-main-app/56369348#56369348", "title": "macOS: Keep XPC Service (bundled) running after user quits main app", "body": "<p>You could install it as launch daemon (running in root context as long as computer is switched on) or as launch agent (running in user context as long as user is logged in).</p>\n"}, {"tags": [], "owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "is_accepted": false, "score": 0, "last_activity_date": 1559171147, "creation_date": 1559171147, "answer_id": 56369612, "question_id": 56367326, "link": "https://stackoverflow.com/questions/56367326/macos-keep-xpc-service-bundled-running-after-user-quits-main-app/56369612#56369612", "title": "macOS: Keep XPC Service (bundled) running after user quits main app", "body": "<p>It sounds like you should be using the <code>WatchPaths</code> or <code>QueueDirectories</code> feature of launchd.</p>\n\n<blockquote>\n  <p>WatchPaths starts the job whenever any of the paths being watched have changed</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>QueueDirectories  starts your job whenever the given directories are non-empty, and it keeps your job running as long as those directories are not empty</p>\n</blockquote>\n\n<p>Both of these are covered by <a href=\"https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html\" rel=\"nofollow noreferrer\">Apple's launchd documentation</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9276882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0119fab95c1fd09778b45c390a4f61?s=128&d=identicon&r=PG&f=1", "display_name": "SATHWIK MATSA", "link": "https://stackoverflow.com/users/9276882/sathwik-matsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559171147, "creation_date": 1559158219, "question_id": 56367326, "link": "https://stackoverflow.com/questions/56367326/macos-keep-xpc-service-bundled-running-after-user-quits-main-app", "title": "macOS: Keep XPC Service (bundled) running after user quits main app", "body": "<p>The bundled XPC Service in my macOS application need to do some post processing work with files dumped by the parent app, which most probably can't be completed within the usage time of the application. So, Is there a way to make the XPC service keep running even after the user quits the main app?</p>\n"}, {"tags": ["c++", "c", "windows", "sockets", "tcp"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559160128, "post_id": 56367207, "comment_id": 99338434, "body": "<code>WSASend()</code> generally does not complete until the entire buffer has been sent, but it doesn&#39;t hurt to account for the <i>possibility</i> of a partial send by simply calling <code>WSASend()</code> again if there is remaining unsent data. A read operation completes as soon as any data is available to return, unless you specify a flag to make it wait until the entire buffer is filled."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1559160511, "post_id": 56367207, "comment_id": 99338581, "body": "With <a href=\"http://www.serverframework.com/asynchronousevents/2011/10/windows-8-registered-io-networking-extensions.html\" rel=\"nofollow noreferrer\">RIO</a> you can specify the max number of outstanding requests."}, {"owner": {"reputation": 43, "user_id": 10648225, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Hansen", "link": "https://stackoverflow.com/users/10648225/jeremy-hansen"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169366, "post_id": 56367207, "comment_id": 99341315, "body": "@RemyLebeau &quot;simply calling WSASend() again if there is remaining unsent data.&quot; Did you mean it literally? Doesn&#39;t the program have to check how much data was sent from a previous call and if the buffer was sent partially, it would have to rearrange the arguments of next WSASend() as pointer to the start of its remaining buffer index and its remaining length?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169427, "post_id": 56367207, "comment_id": 99341329, "body": "@JeremyHansen obviously, you have to pass only the unsent bytes, if any, to the next call to <code>WSASend()</code>. However you want to do that is up to you, there are several ways to accomplish that."}], "owner": {"reputation": 43, "user_id": 10648225, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Hansen", "link": "https://stackoverflow.com/users/10648225/jeremy-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559158561, "creation_date": 1559157617, "last_edit_date": 1559158561, "question_id": 56367207, "link": "https://stackoverflow.com/questions/56367207/tcp-iocp-could-wsasend-post-notification-to-waiting-thread-after-partially-sen", "title": "TCP IOCP : Could WSASend post notification to waiting thread after partially sending it&#39;s buffer like WSARecv function?", "body": "<p>Instead of sending whole requested buffer, could WSASend/send type of operation return or post notification to waiting thread after partially sending requested buffer when there's too many IO Request to handle? (Similar to how WSARecv/recv function returning/posting notification to the thread after receiving buffer partially if that's what's available in the buffer.)</p>\n"}, {"tags": ["c", "linux", "malloc"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1559172114, "post_id": 56366983, "comment_id": 99341942, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/194138/discussion-on-question-by-david-cullen-how-to-avoid-calling-malloc-for-each-node\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1559166480, "post_id": 56366240, "comment_id": 99340548, "body": "That&#39;s called a &quot;cursor&quot; implementation."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1559315929, "post_id": 56366240, "comment_id": 99393991, "body": "Brendan, I&#39;ll ping you on this as I happened to mention you based on some research:  <a href=\"https://stackoverflow.com/questions/56384291/what-happens-to-a-startup-ipi-sent-to-an-active-ap-that-is-not-in-a-wait-for-sip\" title=\"what happens to a startup ipi sent to an active ap that is not in a wait for sip\">stackoverflow.com/questions/56384291/&hellip;</a>"}], "tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 6, "last_activity_date": 1559168940, "last_edit_date": 1559168940, "creation_date": 1559152985, "answer_id": 56366240, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list/56366240#56366240", "title": "How to avoid calling malloc for each node in a linked list", "body": "<blockquote>\n  <p>There are speed tests in which malloc is called by wrapped function which is written to take more time and allocate memory. So every time when I call malloc in my pogram it is called but it takes more time so the tests can detect very often usage of malloc. The problem is that I use linked lists so the memory is allocated separately for every node of the list. I don't know how to change this implementation because it is really comfortable to use linked lists in my structure.</p>\n</blockquote>\n\n<p>You might be able to use an array instead.</p>\n\n<p>For a simple example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct list_entry {\n    struct list_entry *next;\n    int foo;\n};\n\n#define MAX_THINGS 1234567\nstruct list_entry myArray[MAX_THINGS];\nint firstFreeEntry = 0;\n\nstruct list_entry *freeListHead = NULL;\n\nstruct list_entry *listHead = NULL;\n\nstruct list_entry *allocEntry(void) {\n    struct list_entry *temp;\n\n    if(freeListHead != NULL) {\n        // Recycle a previously freed entry\n        temp = freeListHead;\n        freeListHead = temp-&gt;next;\n        return temp;\n    }\n    // Try to take a new entry from the array\n    if(firstFreeEntry &lt; MAX_THINGS) {\n        return &amp;myArray[firstFreeEntry++];\n    }\n    // Give up (no free entries)\n    return NULL;\n}\n\nvoid freeEntry(struct list_entry *entry) {\n    int offset;\n\n    // Try to give it back to the array\n    offset = entry - myArray;\n    if(offset == firstFreeEntry - 1) {\n        firstFreeEntry--;\n        return;\n    }\n    // Put it on the list of freed things\n    entry-&gt;next = freeListHead;\n    freeListHead = entry;\n}\n\n// Allocate an entry, initialize/construct it, and put it on the linked list\n\nstruct list_entry *createEntry(int value) {\n    struct list_entry *newEntry;\n    newEntry = allocEntry();\n    if(newEntry != NULL) {\n        newEntry-&gt;foo = value;\n        newEntry-&gt;next = listHead;\n        listHead = newEntry;\n    }\n    return newEntry;\n}\n\nint main() {\n    const int node_count = 1000 * 1000;\n    struct list_entry *head = NULL;\n    for (int index = 0; index &lt; node_count; index++) {\n        head = createEntry(0xdeadbeef);\n        printf(\"address of head = %p\\n\", head);\n    }\n    while (head) {\n        struct list_entry *next = head-&gt;next;\n        printf(\"address of head = %p\\n\", head);\n        freeEntry(head);\n        head = next;\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>address of head = 0x101d32040\naddress of head = 0x101d32050\naddress of head = 0x101d32060\n...\naddress of head = 0x101d32040\n</code></pre>\n\n<p><strong>Verification</strong></p>\n\n<pre><code>$ ./test &gt; storage.txt\n$ split -l 1000000 storage.txt\n$ tac xab &gt; xac\n$ diff xaa xac\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1559158224, "post_id": 56367023, "comment_id": 99337663, "body": "@WeatherVane ever heard of self-answered questions?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559158842, "post_id": 56367023, "comment_id": 99337920, "body": "How do you handle removal of a single node from the linked list?"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559163957, "post_id": 56367023, "comment_id": 99339827, "body": "@AndrewHenle I modified the code to handle freeing a single node. However, this is really a toy example designed to help the author of the original question find a solution to the problem."}], "tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": false, "score": 2, "last_activity_date": 1559591132, "last_edit_date": 1559591132, "creation_date": 1559156872, "answer_id": 56367023, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list/56367023#56367023", "title": "How to avoid calling malloc for each node in a linked list", "body": "<p>This program allocates memory for nodes in a linked list in contiguous chunks. When the memory in a chunk is exhausted, a new chunk is allocated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// An imaginary node because the original question did not provide one\nstruct node {\n    struct node *next, *prev;\n    int numbers[1024];\n    char string[1024];\n};\n\nstruct node_storage {\n    int count;\n    int total;\n    struct node *node_list;\n    struct node_storage *next;\n};\n\nstruct node_storage *add_storage(int count) {\n    struct node_storage *pstorage = malloc(sizeof(struct node_storage));\n    // We could avoid a malloc here by making node_list an array\n    pstorage-&gt;node_list = malloc(sizeof(struct node) * count);\n    pstorage-&gt;count = count;\n    pstorage-&gt;total = count;\n    pstorage-&gt;next = NULL;\n    return pstorage;\n}\n\nvoid free_storage(struct node_storage *storage) {\n    while (storage) {\n        struct node_storage *next = storage-&gt;next;\n        free(storage-&gt;node_list);\n        free(storage);\n        storage = next;\n    }\n}\n\nstruct node *new_node(struct node **free_list, struct node_storage **storage) {\n    struct node *free_node = *free_list;\n    struct node_storage *pstorage = *storage;\n    struct node *result;\n    // If there is a free node\n    if (free_node) {\n        // Get the new node from the free list\n        result = free_node;\n        *free_list = free_node-&gt;next;\n    }\n    else {\n        // Get the new node from the pre-allocated storage\n        result = &amp;pstorage-&gt;node_list[pstorage-&gt;total - pstorage-&gt;count];\n        pstorage-&gt;count--;\n        // If that was the last pre-allocated node\n        if (0 == pstorage-&gt;count) {\n            // Allocate the next chunk of nodes\n            pstorage-&gt;next = add_storage(pstorage-&gt;total);\n            *storage = pstorage-&gt;next;\n        }\n    }\n    return result;\n}\n\nvoid free_node(struct node **free_list, struct node *node) {\n    struct node *pfree_list = *free_list;\n    if (pfree_list) {\n        node-&gt;next = pfree_list;\n    }\n    *free_list = node;\n}\n\nint main() {\n    const int node_count = 1000 * 1000;\n    struct node_storage *head;\n    struct node_storage *curr;\n    struct node *free_list = NULL;\n    struct node *node_list = NULL;\n    head = add_storage(100);\n    curr = head;\n    // Allocate a lot of nodes and put them in a list\n    for (int index = 0; index &lt; node_count; index++) {\n        struct node *new = new_node(&amp;free_list, &amp;curr);\n        printf(\"address of new = %p\\n\", new);\n        new-&gt;next = node_list;\n        node_list = new;\n    }\n    // Free all of the allocated nodes\n    while (node_list) {\n        struct node *pnode = node_list;\n        node_list = node_list-&gt;next;\n        free_node(&amp;free_list, pnode);\n    }\n    // Allocate a lot of nodes so that we can verify that they come from\n    // the free list\n    for (int index = 0; index &lt; node_count; index ++) {\n        struct node *new = new_node(&amp;free_list, &amp;curr);\n        printf(\"address of new = %p\\n\", new);\n    }\n    free_storage(head);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>address of new = 0x10f972000\naddress of new = 0x10f973410\n...\naddress of new = 0x243570230\n</code></pre>\n\n<p><strong>Warning</strong></p>\n\n<p>This code does no error checking and should not be used in a production environment.</p>\n\n<p><strong>Note</strong></p>\n\n<p>I modified the code so that a freed node is placed on a free list. That list is checked first when requesting a new node. I tested this by comparing the addresses of the nodes like this:</p>\n\n<pre><code>$ ./test &gt; storage.txt\n$ split -l 1000000 storage.txt\n$ diff xaa xab\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559161359, "post_id": 56367126, "comment_id": 99338897, "body": "As a not-too-big extension of this, when new memory needs to be allocated, several nodes could be allocated at once and put on the free node list, instead of allocating nodes one at a time."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1559157922, "last_edit_date": 1559157922, "creation_date": 1559157290, "answer_id": 56367126, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list/56367126#56367126", "title": "How to avoid calling malloc for each node in a linked list", "body": "<p>The simplest thing you can do is continue to call <code>malloc</code> for the individual nodes of the linked list, but when nodes are freed, put them on a list of free nodes.</p>\n\n<pre><code>node *free_list = 0;\n\nnode *node_alloc(void)\n{\n   /* get a node fast from the free list, if available */\n   if (free_list != 0) {\n      node *ret = free_list;\n      free_list = free_list-&gt;next;\n      return ret;\n   } else {\n      node *ret = malloc(sizeof *ret);\n      /* check for non-null, initialize */\n      return ret;\n   }\n}\n\nvoid node_free(node *node)\n{\n   node-&gt;next = free_list;\n   free_list = node;\n}\n</code></pre>\n\n<p>If your program has some objects that are only on one list at any given time, you can put the list nodes right inside those objects, so that they don't require separate allocation:</p>\n\n<pre><code>struct process {\n   node queue_node; /* list links for putting process into queues */\n   ...\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1559158674, "post_id": 56367165, "comment_id": 99337836, "body": "I don&#39;t see how it is connected to linked list memory to be honest"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1559158998, "post_id": 56367165, "comment_id": 99337984, "body": "Note that <code>mmap()</code> returns memory in page-sized chunks and only in page-sized chunks, usually 4KB on x86 systems.  And a single <code>mmap()</code> call is likely going to be a lot slower than a single <code>malloc()</code> call, especially for small sizes."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1559160498, "post_id": 56367165, "comment_id": 99338575, "body": "@Jean-Fran&#231;oisFabre : You are right, the answer appears to have been moved from the original question which stated <i>&quot;I have read something about mmap function but could&#39;t find any good example of it&#39;s usage instead of malloc.&quot;</i>.  This new question only describes the original problem, not the proposed solution he was having troubles with."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1559160694, "post_id": 56367165, "comment_id": 99338657, "body": "@AndrewHenle Yes, it is wasteful, but I assumed only required for the test environment. Although it is a bizarre test IMO, a wrapper could simply log timestamp and block size of each allocation to analyse dynamic memory usage."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1559162098, "post_id": 56367165, "comment_id": 99339171, "body": "@Clifford my fault: I merged and it has consequences like this (most moderators wouldn&#39;t want to try merge for this reason). Wanna try to adapt the answer?"}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559163734, "post_id": 56367165, "comment_id": 99339751, "body": "@Clifford how can I get an implementation of the realloc function in this style?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559164119, "post_id": 56367165, "comment_id": 99339870, "body": "@avan1235 : The naive way is to allocate a new block copy the data from the old block, delete the d block and return the new block.  That could be optimised through knowledge of the page size and the actual amount of mapped memory to avoid reallocation in many cases."}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559164292, "post_id": 56367165, "comment_id": 99339919, "body": "@Clifford I don&#39;t know these functions, can you give an example of some implementation?  How to do it in naive way?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559166467, "post_id": 56367165, "comment_id": 99340547, "body": "@avan1235 it is not really a matter of knowing these functions, rather simply one of understanding a functions behaviour and implementing it."}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559166527, "post_id": 56367165, "comment_id": 99340560, "body": "@Clifford so what about: void* reallocate_memory(void *old, size_t size, size_t oldSize) {     void *newMem = allocate_memory(size);     if (newMem == NULL)         return NULL;     newMem = memcpy(newMem, old, oldSize);     if (newMem != NULL)         free_memory(old);     return newMem;  }"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559167222, "post_id": 56367165, "comment_id": 99340769, "body": "@avan1235 Your suggestion has a different signature than realloc.  The allocation size is prepended to the memory returned to the caller, so there is no need to provide the old size."}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559167968, "post_id": 56367165, "comment_id": 99340960, "body": "@Clifford partially working, don;t know why get SIGSEGV error in some point when replaced malloc, free and realloc functions wit your implementations"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559168587, "post_id": 56367165, "comment_id": 99341118, "body": "@avan1235 SIGSEGV is generated on an attempt to write into a region mapped as read-only."}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559169012, "post_id": 56367165, "comment_id": 99341231, "body": "When I use the commented version of functions everything works well, but after switch to your modified version something wents wrong <code>void* allocate_memory(size_t size) {     void* mem = mmap( NULL, size + sizeof(size_t),                       PROT_READ | PROT_WRITE,                       MAP_PRIVATE | MAP_ANONYMOUS, -1, 0 );      return mem == MAP_FAILED ? NULL : mem + sizeof(size_t); &#47;&#47;    return malloc(size); }</code>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559169290, "post_id": 56367165, "comment_id": 99341295, "body": "@avan1235 : don&#39;t post code in comments - it is entirely unreadable.  realloc is not correct - working on it."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559169649, "post_id": 56367165, "comment_id": 99341379, "body": "@avan1235 Are calls to <code>mmap</code> wrapped?"}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559169736, "post_id": 56367165, "comment_id": 99341404, "body": "No, only malloc, calloc realloc, alloc_array"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 1, "creation_date": 1559169914, "post_id": 56367165, "comment_id": 99341459, "body": "@avan1235 fixed.  Forgot to write the allocation size in the mmap&#39;ed block in <code>alt_alloc()</code> causing <code>alt_free()</code> to do nothing and <code>alt_realloc()</code> to fail. See test code run at <a href=\"https://onlinegdb.com/B1Nm2K3pE\" rel=\"nofollow noreferrer\">onlinegdb.com/B1Nm2K3pE</a>"}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559194872, "post_id": 56367165, "comment_id": 99346404, "body": "@Clifford still gets some problems when freeing the NULL pointers"}, {"owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559195471, "post_id": 56367165, "comment_id": 99346564, "body": "When check <code>if (mem != NULL)         munmap(mem, *((size_t*) mem - 1));</code> everything works well :)"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "edited": false, "score": 0, "creation_date": 1559206411, "post_id": 56367165, "comment_id": 99351073, "body": "@avan1235 Good point if you need <code>alt_free()</code> to follow the exact semantics of <code>free()</code>, but if you are habitually trying to free null pointers, I&#39;d question the correctness of your code in any case."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1559206286, "last_edit_date": 1559206286, "creation_date": 1559157409, "answer_id": 56367165, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list/56367165#56367165", "title": "How to avoid calling malloc for each node in a linked list", "body": "<p>A simple solution is to implement alternative dynamic memory functions using <code>mmap()</code>.</p>\n\n<pre><code>void* alt_malloc( size_t size )\n{\n    void* mem = mmap( NULL, size + sizeof(size_t),\n                      PROT_READ | PROT_WRITE, \n                      MAP_PRIVATE | MAP_ANONYMOUS, -1, 0 ) ;\n\n    if( mem != MAP_FAILED )\n    {\n        *(size_t*)mem = size ;\n    }\n    else\n    {\n        mem = NULL ;\n    }\n\n    return mem + sizeof( size_t) ;\n}\n\nvoid* alt_calloc( size_t nitems, size_t size)\n{\n    return alt_malloc( nitems * size ) ;\n}\n\nvoid alt_free( void* mem )\n{\n    if( mem != NULL) munmap( mem, *((size_t*)mem - 1) ) ;\n} \n\nvoid* alt_realloc( void *old_mem, size_t new_size )\n{\n    void* new_mem = alt_malloc( new_size ) ;\n    if( new_mem != NULL )\n    {\n        size_t old_size = *((size_t*)old_mem - 1) ;\n        size_t copy_size = old_size &gt; new_size ? new_size : old_size ;\n        memcpy( new_mem, old_mem, copy_size ) ;\n        alt_free( old_mem ) ;\n    }   \n\n    return new_mem ;\n}\n</code></pre>\n\n<p>The following test:</p>\n\n<pre><code>#define ALLOC_SIZE 1024 * 1024\nint main()\n{\n    char* test = alt_malloc( ALLOC_SIZE ) ;\n    memset( test, 'X', ALLOC_SIZE ) ;\n    printf( \"%p : %c %c\\n\", test, test[0], test[ALLOC_SIZE-1] ) ;\n    test = alt_realloc( test, ALLOC_SIZE * 2 ) ;\n    printf( \"%p : %c %c\\n\", test, test[0], test[ALLOC_SIZE-1] ) ;\n    alt_free( test ) ;\n\n    return 0;\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>0x7f102957d008 : X X\n0x7f1028ea3008 : X X\n</code></pre>\n\n<p>Demonstrating that the <code>memset()</code> covered the extent of the initial block, and that the realloc created a new block and copied the data.</p>\n\n<p>A more efficient, though slightly more complex solution would be to use <code>mmap()</code> to allocate an alternative heap, and then implement a heap manager operating on that block as an alternative to the standard functions.  There is no shortage of heap management examples. </p>\n\n<p>You could for example take the Newlib C library allocator with modified names and implement the <code>sbrk()</code> syscall (again renamed to prevent clash) using <code>mmap()</code> to provide memory to the alternate heap.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1559171937, "post_id": 56367779, "comment_id": 99341901, "body": "@DavidCullen why the edit? Was there something wrong? Global variables do not need to be explicitly initialised to <code>0</code>."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1559172124, "post_id": 56367779, "comment_id": 99341947, "body": "I&#39;m just trying to convert each answer into an MCVE. If you dislike my changes, feel free to undo them."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1559172467, "post_id": 56367779, "comment_id": 99342019, "body": "@DavidCullen I usually like to post a fully working example but could not see how to easily make a dynamically random get/free node test. My answer was a similar idea to that of <a href=\"https://stackoverflow.com/a/56367126/4142924\">Kaz</a> too. I wondered from the last line of your verification if there is something wrong with my code. Note that your <code>new-&gt;next = head;</code> should be irrespective of the value of <code>head</code>: the first node should have its <code>next = head;</code> which is initially <code>NULL</code>."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1559173104, "last_edit_date": 1559173104, "creation_date": 1559160419, "answer_id": 56367779, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list/56367779#56367779", "title": "How to avoid calling malloc for each node in a linked list", "body": "<p>This is similar to the <a href=\"https://stackoverflow.com/a/56366240/4142924\">answer</a> from @Brendan but has no fixed limit to the number of nodes. It is derived from code I already wrote.</p>\n\n<p>When a node is released it is placed in a linked list pool. When a node is needed it is taken from the pool (if any) or from an array (if any) or the array is extended, not by just one node, but by a large number of them. This reduces the number of calls to <code>realloc</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define CHUNK 8192\n\ntypedef struct Node {\n    int data;\n    struct Node *next;\n} node;\n\nnode *array;\nnode *pool;\nint nodes_avail;\nint nodes_used;\n\nnode *getnode(void)\n{\n    node *newnode;\n    if(pool) {                              // any in the recycled pool?\n        newnode = pool;\n        pool = pool-&gt;next;\n    }\n    else if(nodes_used &lt; nodes_avail) {     // any in the array?\n        newnode = &amp;array[nodes_used];\n        nodes_used++;\n    }\n    else {                                  // extend the array?\n        nodes_avail += CHUNK;\n        node *temp = realloc(array, nodes_avail * sizeof *temp);\n        if(temp == NULL) {\n            exit(1);                        // or recovery\n        }\n        array = temp;\n        newnode = &amp;array[nodes_used];\n        nodes_used++;\n    }\n    return newnode;\n}\n\nvoid freenode(node *nptr)\n{\n    nptr-&gt;next = pool;                      // add to recycled pool\n    pool = nptr;\n}\n\nint main() {\n    const int node_count = 1000 * 1000;\n    node *head = NULL;\n    for (int index = 0; index &lt; node_count; index++) {\n        node *new = getnode();\n        new-&gt;next = head;\n        head = new;\n        printf(\"address of head = %p\\n\", head);\n    }\n    while (head) {\n        node *next = head-&gt;next;\n        freenode(head);\n        head = next;\n    }\n    for (int index = 0; index &lt; node_count; index++) {\n        node *new = getnode();\n        new-&gt;next = head;\n        head = new;\n        printf(\"address of head = %p\\n\", head);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>address of head = 0x100bc7000\naddress of head = 0x100bc7010\naddress of head = 0x100bc7020\n...\naddress of head = 0x101b2a3f0\n</code></pre>\n\n<p><strong>Verification</strong></p>\n\n<pre><code>$ ./test &gt; storage.txt\n$ split -l 1000000 storage.txt\n$ diff xaa xab\n</code></pre>\n"}], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1559591132, "creation_date": 1559156671, "last_edit_date": 1559156816, "question_id": 56366983, "link": "https://stackoverflow.com/questions/56366983/how-to-avoid-calling-malloc-for-each-node-in-a-linked-list", "title": "How to avoid calling malloc for each node in a linked list", "body": "<p>This question was inspired by</p>\n\n<p><a href=\"https://stackoverflow.com/q/56365330/3657941\">Prevent malloc function wrapping</a></p>\n\n<p>I have written a program that allocates memory for individual nodes in a linked list by calling <code>malloc</code>.</p>\n\n<p>There are speed tests in which <code>malloc</code> is wrapped by a function that causes <code>malloc</code> calls to take more time than normal. This allows the tests to detect frequent usage of malloc.</p>\n\n<p>How do I avoid calling <code>malloc</code> for each node?</p>\n"}, {"tags": ["c", "arrays", "missing-data"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1559155055, "creation_date": 1559155055, "answer_id": 56366670, "question_id": 56366596, "link": "https://stackoverflow.com/questions/56366596/missing-number-in-array-in-c-programming/56366670#56366670", "title": "Missing number in array in C programming", "body": "<p>You re-declared the variable <code>arra</code> inside the <code>for</code> loop. So when you assign to <code>arra[run]</code>, you're assigning to the inner array, not the one in the <code>main()</code> function. So you get garbage when you try to print the contents of the array at the end.</p>\n\n<p>You also declared the first array with only one element, rather than <code>T</code> elements.</p>\n\n<p>Get rid of the second declaration, and change the first one from</p>\n\n<pre><code>long arra[1];\n</code></pre>\n\n<p>to </p>\n\n<pre><code>long arra[T];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 11463240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_7kPR1Yp4Ws/AAAAAAAAAAI/AAAAAAAAABA/yq2CwnZn0o0/photo.jpg?sz=128", "display_name": "osama khan", "link": "https://stackoverflow.com/users/11463240/osama-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1559165667, "last_edit_date": 1592644375, "creation_date": 1559165667, "answer_id": 56368834, "question_id": 56366596, "link": "https://stackoverflow.com/questions/56366596/missing-number-in-array-in-c-programming/56368834#56368834", "title": "Missing number in array in C programming", "body": "<h1>correct code</h1>\n<p>declare the arra before the for loop else for every iteration the arra will be re declared deleting the previous values in it</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() \n{\n    //code\n    int T,run,i;\n    scanf(&quot;%d&quot;, &amp;T);\n    long N,res,C,en;\n    long arra[T];\n    for (run = 0;run &lt;T; run++ )\n    { \n        scanf(&quot;%ld&quot;, &amp;N);\n        res =0;\n        for (i = 0; i &lt;N-1; i++)\n        {\n            scanf(&quot;%ld&quot;,&amp;C);\n            res = res + C;\n        }\n        en = ((N*(N+1))/2)- res; // subtracting the overall sum of array elements from N integers \n        arra[run]=en; //saving it to array\n    }\n    for(run = 0; run &lt; T; run++)\n    {\n        printf(&quot;%ld &quot;,arra[run]);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11574514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mBda3n5-1QI/AAAAAAAAAAI/AAAAAAAAANw/bSF5FJllVdw/photo.jpg?sz=128", "display_name": "Venkateswara rao Kayitha", "link": "https://stackoverflow.com/users/11574514/venkateswara-rao-kayitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559165667, "creation_date": 1559154660, "last_edit_date": 1559154820, "question_id": 56366596, "link": "https://stackoverflow.com/questions/56366596/missing-number-in-array-in-c-programming", "title": "Missing number in array in C programming", "body": "<p>Given an array C of size N-1 and given that there are numbers from 1 to N with one element missing, the missing number is to be found.</p>\n\n<p>Input:\nThe first line of input contains an integer T denoting the number of test cases. For each test case first line contains N(size of array). The subsequent line contains N-1 array elements.</p>\n\n<p>Output:\nPrint the missing number in array.</p>\n\n<p>This problem is to find the missing number in a series of n integers. but, while using the below code I could not get the output as expected.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() \n{\n    //code\n    int T,run,i;\n    scanf(\"%d\", &amp;T);\n    long N,res,C,en;\n    long arra[1];\n    for (run = 0;run &lt;T; run++ )\n    { \n        long arra[T];\n        scanf(\"%ld\", &amp;N);\n        res =0;\n        for (i = 0; i &lt;N-1; i++)\n        {\n            scanf(\"%ld\",&amp;C);\n            res = res + C;\n        }\n        en = ((N*(N+1))/2)- res; // subtracting the overall sum of array elements from N integers \n        arra[run]=en; //saving it to array\n    }\n    for(run = 0; run &lt; T; run++)\n    {\n        printf(\"%ld \",arra[run]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I expected the below input and output:</p>\n\n<pre><code>Input:\n2\n5\n1 2 3 5\n10\n1 2 3 4 5 6 7 8 10\n\nOutput:\n4\n9\n</code></pre>\n\n<p>but actual output is </p>\n\n<pre><code>1 -8719623343620674816\n</code></pre>\n"}, {"tags": ["c", "validation"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559155083, "post_id": 56366336, "comment_id": 99336392, "body": "I&#39;m not sure what you&#39;re trying to say with your edit. What&#39;s unclear about the duplicate question?"}, {"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559155276, "post_id": 56366336, "comment_id": 99336466, "body": "the duplicate question speaks only to IF loops, I want to use a while loop.  also, the questioner wants the statement to be executed while the condition is true, I want my statements to execute while conditions are false."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559155406, "post_id": 56366336, "comment_id": 99336519, "body": "<code>if</code> is not a loop. But that&#39;s irrelevant; conditions work the same way, no matter whether they&#39;re part of <code>if</code> or <code>while</code>. The second part of your comment makes no sense. What exactly are you referring to when you say &quot;the condition&quot;?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559155563, "post_id": 56366336, "comment_id": 99336583, "body": "To be clear, <code>while (play != &#39;y&#39; || play != &#39;Y&#39; || play != &#39;n&#39; || play != &#39;N&#39;)</code> is always true. You need <code>&amp;&amp;</code> instead of <code>||</code>."}, {"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559157410, "post_id": 56366336, "comment_id": 99337372, "body": "@WeatherVane THANK YOU! This worked."}, {"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559157462, "post_id": 56366336, "comment_id": 99337385, "body": "@melpomene I had another read over conditions bit. It&#39;s making a bit more sense. Thank you"}], "owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1559153582, "answer_count": 0, "score": 0, "last_activity_date": 1559154704, "creation_date": 1559153439, "last_edit_date": 1559154704, "question_id": 56366336, "link": "https://stackoverflow.com/questions/56366336/beginner-character-validation-loop", "closed_reason": "Duplicate", "title": "BEGINNER - Character validation loop", "body": "<p>I want to ask the user if they want to play \"[y|n]\" but my input validation isn't working. I've been wracking my brain/lecture notes over this one but seem to be missing something fundamental. </p>\n\n<p>code is reading in values, but isn't passing through the boolean expression as I would expect. entering \"y\" will print \"please enter a 'y' or 'n' to continue:\"</p>\n\n<p>I want to use a WHILE loop for this control to allow for multiple incorrect user inputs, unlike the inferred duplicate question linked. </p>\n\n<p>NB; game loop controls work, only having issues with validating user [y|n] input. </p>\n\n<pre><code>\nprintf(\"Would you like to play dice poker? y/n: \");\n    scanf(\" %c\", &amp;play);\n    while (play == 'y'|| play== 'Y' || play == 'n' || play == 'N') {\n\n    while (play != 'y'|| play != 'Y' || play != 'n' || play != 'N') {\n        printf(\"input must be [y|n]\\n\");\n        printf(\"please enter a 'y' or 'n' to continue:\");\n        scanf(\" %c\", &amp;play);\n        }\n\n/*if/else loop to play or farewell and exit*/\n\n/*Game Code - Works just fine*/\n\n\nprintf(\"Would you like to play again? [y|n] : \"); \n       scanf(\" %c\", &amp;playAgain);  \n\n       while (playAgain != 'y' ||  playAgain != 'Y' || playAgain = 'n' || playAgain != 'N') {\n         printf(\"input must be [y|n]\\n\");\n         printf(\"please enter a 'y' or 'n' to continue:\");\n         scanf(\" %c\", &amp;playAgain);\n    }\n\n     play = 'x'; //kick out of \"play\" loop\n\n}\n\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559152657, "post_id": 56366127, "comment_id": 99335396, "body": "Where is that code again? Not in the question, certainly."}, {"owner": {"reputation": 9, "user_id": 9189864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a76b901895205fac3764daef387287ef?s=128&d=identicon&r=PG", "display_name": "Klein X", "link": "https://stackoverflow.com/users/9189864/klein-x"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559152920, "post_id": 56366127, "comment_id": 99335524, "body": "I&#39;m sorry. I edited the code, it&#39; available now."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1559153026, "post_id": 56366127, "comment_id": 99335577, "body": "Can you edit the post and add the actual output, and then the output you expected?"}, {"owner": {"reputation": 9, "user_id": 9189864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a76b901895205fac3764daef387287ef?s=128&d=identicon&r=PG", "display_name": "Klein X", "link": "https://stackoverflow.com/users/9189864/klein-x"}, "edited": false, "score": 0, "creation_date": 1559153326, "post_id": 56366127, "comment_id": 99335712, "body": "I add the actual output. And the actual output in my opinion."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8927631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681a46f10e8ea42bd77f8f03ad6fdab7?s=128&d=identicon&r=PG&f=1", "display_name": "teqwve", "link": "https://stackoverflow.com/users/8927631/teqwve"}, "is_accepted": true, "score": 1, "last_activity_date": 1559154583, "creation_date": 1559154583, "answer_id": 56366577, "question_id": 56366127, "link": "https://stackoverflow.com/questions/56366127/why-fork-return-double-zero-if-we-use-it-first-in-a-if-or-while/56366577#56366577", "title": "why fork() return double zero if we use it first in a if or while", "body": "<p>The problem lies in <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operators precedence</a>, <code>==</code> has higher precedence than <code>=</code> and thus <code>while (p1=fork()==-1)</code> is parsed as <code>while (p1=(fork()==-1))</code>. When You run this code <code>fork</code> succeeds and in both branches returns value different from -1. That's why in both, the child and the parent, <code>p1</code> is equal to 0 (false).</p>\n\n<p>You need to add extra parenthesis around assignment: <code>while ((p1=fork())==-1)</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 9189864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a76b901895205fac3764daef387287ef?s=128&d=identicon&r=PG", "display_name": "Klein X", "link": "https://stackoverflow.com/users/9189864/klein-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "accepted_answer_id": 56366577, "answer_count": 1, "score": -2, "last_activity_date": 1559154583, "creation_date": 1559152517, "last_edit_date": 1559153300, "question_id": 56366127, "link": "https://stackoverflow.com/questions/56366127/why-fork-return-double-zero-if-we-use-it-first-in-a-if-or-while", "title": "why fork() return double zero if we use it first in a if or while", "body": "<p>It's from my homework. In the code, there should be 2 processes, father and child. But in the code, there will be 2 zero, and will never get in the branch p1>0.\nHere is a code. I use fork() and get double zero, it's confusing. I want to know how the fork() works in this code.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"unistd.h\"\n#include \"signal.h\"\nint k1;\nvoid func1(int signo){\n    if (signo==SIGUSR2)\n    {\n        k1=0;\n    }\n\n}\n\nint main(int argc, char const *argv[])\n{\n    int k,p1;\n    while (p1=fork()==-1);//one time\n    if (p1&gt;0)\n    {\n        for (k = 1; k &lt; 4; k++)\n        {\n            printf(\"parent:pid=%d\\n\",getpid());\n            sleep(1);\n        }\n        kill(p1,12);\n        wait(0);\n        printf(\"OK!\\n\");\n        exit(0);\n    }\n    else\n    {\n        signal(12,func1);\n        k1=1;\n        while (k1==1)\n        {\n            printf(\"I'm child\\n\");\n            sleep(1);\n        }\n        printf(\"Child forced!\\n\");\n        exit(0);\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I want to know how fork() works in this code.</p>\n\n<p>The output of the code is loop output: \"I'm child\". Output two lines per second.</p>\n\n<p>However, in my opinion, there should output \"parent:pid=%d\", but the code won't get in the \"p1>0\" branch. it seems that fork() generates 2 processes but all of them have p1=0.</p>\n"}, {"tags": ["c", "matrix", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559153021, "post_id": 56365858, "comment_id": 99335575, "body": "The first idea coming to me is, you need concept of incomplete/partial cell state for border cells, and separate pass to combine them after bordering subgrids are complete. Several slightly different ways to implement this come to mind, too."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559157100, "post_id": 56365858, "comment_id": 99337239, "body": "First solution is the most flexible. Especially, as mentioned Hyde, for the processing of borders. IIRC, Conway model is synchronous and all cells are updated simultaneously. The best way to do that is to have two arrays: present and future, You compute future as a function of present and you exchange their role (or copy future to present). This largely limits the amount of synchronizations that you have to manage."}, {"owner": {"reputation": 88, "user_id": 11150396, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PmyG7SvFy2Q/AAAAAAAAAAI/AAAAAAAAAxw/HyeDk8CDQQM/photo.jpg?sz=128", "display_name": "Hector Of The Rose", "link": "https://stackoverflow.com/users/11150396/hector-of-the-rose"}, "edited": false, "score": 0, "creation_date": 1559159232, "post_id": 56365858, "comment_id": 99338093, "body": "Ok, I&#39;ll try the first one then, thank you!"}], "owner": {"reputation": 88, "user_id": 11150396, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PmyG7SvFy2Q/AAAAAAAAAAI/AAAAAAAAAxw/HyeDk8CDQQM/photo.jpg?sz=128", "display_name": "Hector Of The Rose", "link": "https://stackoverflow.com/users/11150396/hector-of-the-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559151329, "creation_date": 1559151329, "question_id": 56365858, "link": "https://stackoverflow.com/questions/56365858/q-how-to-use-domain-docomposition-on-a-matrix", "title": "Q: How to use domain docomposition on a Matrix?", "body": "<p>How would I go about separating a grid into 4 so that different threads can access it? Not so much a question on the code, just on the process.</p>\n\n<p>I need to parrallelize Conway's game of life for a homework project, to do this I learned that I have to separate the grid into 4 (number of threads) subgrids. In this sense it would have a upper-left, upper-right, lower-left and lower-right subgrid.</p>\n\n<p>Should I just restrain the use of certain cells with variables? like so</p>\n\n<pre><code>#pragma omp parallel shared(New_grid, Current_grid) private(i, j) num_threads(threads)\nint thread_num     = omp_get_thread_num();\nint thread_start_y = get_starting_point_y(thread_num);\nint thread_start_x = get_starting_point_x(thread_num);\nfor(i = thread_start_y; i &lt; tread_start_y + half_height; ++i){\n    for(j = thread_start_x; j &lt; thread_start_x + half_width; ++j){\n        New_grid[i][j] = calculate_new_state(Current_grid)\n    }\n}\n</code></pre>\n\n<p>or do I have to make copies of the sub grids and not join them until asked to? (very incomplete mini code since the subgrids would have to share memory)</p>\n\n<pre><code>int sub_grid[height/2][width/2]; //suppose even numbers\n#pragma omp parallel shared(Current_grid) private(i, j, New_sub_grid, thread_num) num_threads(threads)\n\nint thread_num     = omp_get_thread_num();\nsub_grid           = copy_subgrid(Current_grid, thread_num);\n\nfor(i = 0; i &lt; tread_start_y + half_height; ++i){\n    for(j = 0; j &lt; width/2; ++j){\n        New_sub_grid[i][j] = calculate_new_state(sub_grid)\n    }\n}\n</code></pre>\n\n<p>or are both wrong?</p>\n"}, {"tags": ["c", "function", "macros", "preprocessor"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1559157480, "post_id": 56365765, "comment_id": 99337393, "body": "should i manually write the function prototypes in the header or should i generate them too?"}, {"owner": {"reputation": 429, "user_id": 5672465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VCRqi.jpg?s=128&g=1", "display_name": "BearAqua", "link": "https://stackoverflow.com/users/5672465/bearaqua"}, "edited": false, "score": 1, "creation_date": 1559157639, "post_id": 56365765, "comment_id": 99337451, "body": "@localhost You could generate them too, but with a different macro, e.g. <code>GENERATE_FUNC_DECL</code>"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 4, "last_activity_date": 1559150920, "creation_date": 1559150920, "answer_id": 56365765, "question_id": 56365654, "link": "https://stackoverflow.com/questions/56365654/generate-multiple-similar-functions-with-c-preprocessor/56365765#56365765", "title": "Generate multiple similar functions with C preprocessor", "body": "<p>Totally possible. You just need to know about the preprocessor concatenation operator <code>##</code>. The following code will generate two functions <code>add_order_to_array</code> and <code>add_customer_to_array</code>.</p>\n\n<pre><code>#define GENERATE_FUNC(OBJECT) \\\n    void add_ ## OBJECT ## _to_array(void* item_ptr, int pos)\\\n    {                                                        \\\n        mtx_lock(&amp;OBJECT ## _array_mtx);                     \\\n        OBJECT ## _array[pos] = *(OBJECT ## _t*)item_ptr;    \\\n        mtx_unlock(&amp;OBJECT ## _array_mtx);                   \\\n        return;                                              \\\n    }                                                      \n\nGENERATE_FUNC(order)\nGENERATE_FUNC(customer)\n</code></pre>\n\n<p>The preprocessor output will be (unfortunately it does not respect formatting):</p>\n\n<pre><code>void add_order_to_array(void* item_ptr, int pos) { mtx_lock(&amp;order_array_mtx); order_array[pos] = *(order_t*)item_ptr; mtx_unlock(&amp;order_array_mtx); return; }\nvoid add_customer_to_array(void* item_ptr, int pos) { mtx_lock(&amp;customer_array_mtx); customer_array[pos] = *(customer_t*)item_ptr; mtx_unlock(&amp;customer_array_mtx); return; }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1559151328, "post_id": 56365814, "comment_id": 99334891, "body": "Identifiers starting with <code>__</code> are reserved, so I&#39;d choose a different name for the macro parameter."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559151476, "post_id": 56365814, "comment_id": 99334954, "body": "\u2014 All identifiers that begin with an underscore are always reserved for use as identifiers with file scope in both the ordinary and tag name spaces.  In this particular case __obj is scoped within the macro, and is the proper use of __"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559151808, "post_id": 56365814, "comment_id": 99335076, "body": "If it&#39;s scoped to the macro anyway, why not just name it <code>obj</code> instead of <code>__obj</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559152843, "post_id": 56365814, "comment_id": 99335477, "body": "@AhmedMasud Note that it is a double underscore, so the <i>first</i> bullet of that paragraph applies and not the one you have cited."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1559152906, "post_id": 56365814, "comment_id": 99335514, "body": "@AhmedMasud That&#39;s not entirely accurate.  Identifiers that begin with two underscores, or an underscore followed by a capital letter are reserved for <i>all</i> uses.  Identifiers that start with a single underscore followed by a lowercase letter are the ones reserved for filescope that you can overload (is that the correct term?) at local scope."}], "tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": false, "score": 1, "last_activity_date": 1559151137, "creation_date": 1559151137, "answer_id": 56365814, "question_id": 56365654, "link": "https://stackoverflow.com/questions/56365654/generate-multiple-similar-functions-with-c-preprocessor/56365814#56365814", "title": "Generate multiple similar functions with C preprocessor", "body": "<p>Yes it's possible:</p>\n\n<pre><code>#define DECLARE_ADD_FUNCTION(__obj)                         \\\n    void add_##__obj##_to_array(void* item_ptr, int pos)    \\\n    {                                                       \\\n        mtx_lock(&amp;__obj##_array_mtx);                       \\\n        __obj##_array[pos] = *(__obj##_t*)item_ptr;         \\\n        mtx_unlock(&amp;__obj##_array_mtx);                     \\\n        return;                                             \\\n    }\n\nDECLARE_ADD_FUNCTION(customer)\nDECLARE_ADD_FUNCTION(account)\n</code></pre>\n\n<p>When you look at the output of the preprocessor you get:</p>\n\n<p>gcc -E foo.c</p>\n\n<pre><code>void add_customer_to_array(void* item_ptr, int pos) { mtx_lock(&amp;customer_array_mtx); customer_array[pos] = *(customer_t*)item_ptr; mtx_unlock(&amp;customer_array_mtx); return; }\nvoid add_account_to_array(void* item_ptr, int pos) { mtx_lock(&amp;account_array_mtx); account_array[pos] = *(account_t*)item_ptr; mtx_unlock(&amp;account_array_mtx); return; }\n</code></pre>\n\n<p>You can even ensure that the pointer type is the correct type by changing the function prototype to <code>add_##__obj##_to_array(__obj##_t *, int pos)</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 56365765, "answer_count": 2, "score": 2, "last_activity_date": 1559151137, "creation_date": 1559150372, "question_id": 56365654, "link": "https://stackoverflow.com/questions/56365654/generate-multiple-similar-functions-with-c-preprocessor", "title": "Generate multiple similar functions with C preprocessor", "body": "<p>I want to generate multiple similar functions replacing just one word across the function.</p>\n\n<p>As an example, for each of the below:</p>\n\n<pre><code>OBJECT = customer\nOBJECT = account\n</code></pre>\n\n<p>use the function template:</p>\n\n<pre><code>void add_OBJECT_to_array(void* item_ptr, int pos)\n{\n    mtx_lock(&amp;OBJECT_array_mtx);\n    OBJECT_array[pos] = *(OBJECT_t*)item_ptr;\n    mtx_unlock(&amp;OBJECT_array_mtx);\n    return;\n}\n</code></pre>\n\n<p>So that I can call</p>\n\n<pre><code>add_order_to_array(ord, 1);\nadd_customer_to_array(cust, 1);\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["c", "static", "language-lawyer", "extern", "linkage"], "comments": [{"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1559159232, "post_id": 56365581, "comment_id": 99338091, "body": "You might want to take a look at the discussion here: <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=45977\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=45977</a>"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1559161886, "post_id": 56365581, "comment_id": 99339100, "body": "@StephanSchlecht Nice catch. The issue is about exactly the case I&#39;m considering. Probably replacing <code>extern</code> with <code>static</code> is a workaround"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1559162204, "post_id": 56365581, "comment_id": 99339204, "body": "@StephanSchlecht But ommiting storage class specifier entirely is UB. Is there a way to produce a warning in such a case? <code>-Wall -Wextra -pedantic</code> does not emit it."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1559193636, "post_id": 56365581, "comment_id": 99346079, "body": "1. The <a href=\"https://coliru.stacked-crooked.com/a/aa1464f186490bf5\" rel=\"nofollow noreferrer\">coliru DEMO</a> probably needs a <code>-x c</code> to tell the compiler that the source file is written in C. 2. It seems that ideone does not expose compiler warnings, but it does mean that no warning is produced by the compiler."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1559221452, "post_id": 56365581, "comment_id": 99357924, "body": "@cpplearner you are right."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1559236877, "post_id": 56365581, "comment_id": 99365941, "body": "@SomeName You may actually be able to use <i>static</i> instead of <i>external</i>. However, if you omit the <i>static</i> specifier, it should even be a compile time error then, not just a warning, or?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1559244932, "post_id": 56365581, "comment_id": 99369298, "body": "@StephanSchlecht Yes, <code>static</code> should be fine since there is no linkage disagreement. No storage class specified compiles with no warnings even though it is UB (linkage disagreement)"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1559248791, "post_id": 56365581, "comment_id": 99370751, "body": "I quickly tried it with gcc on Ubuntu, see answer below. For me it gives an error or did I misunderstand sth?"}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559267181, "post_id": 56385336, "comment_id": 99375084, "body": "Anyway the case with no storage-class specified is not a constraint violatio so no diagnostic message is required."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1559324594, "post_id": 56385336, "comment_id": 99397667, "body": "Yeah, you&#39;re right. The consumer of your framework should <i>not</i> omit the static, because then the behavior is undefined due to the standard, which genereally should be better avoided. Here &#167;6.2.2(7) applies: <i>If, within a translation unit, the same identifier appears with both internal and external linkage, the behavior is undefined.</i> There are also for sure C compilers which would compile this without error message. But wouldn&#39;t this be a problem on consumer side?"}], "tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": true, "score": 2, "last_activity_date": 1559249475, "last_edit_date": 1559249475, "creation_date": 1559248795, "answer_id": 56385336, "question_id": 56365581, "link": "https://stackoverflow.com/questions/56365581/allowing-overriding-zero-initialized-object-with-internal-linkage/56385336#56385336", "title": "Allowing &quot;overriding&quot; zero-initialized object with internal linkage", "body": "<p><strong>Use of static</strong></p>\n\n<p>You may actually be able to use static instead of external. \nMaking a quick test with gcc under Ubuntu:</p>\n\n<pre><code>#include \"test_suite.h\"\n\nstatic const char *const test_suite_name = \"huhu\";\n\nint main() {\n      run_all_tests();\n      return 0;\n}\n</code></pre>\n\n<p>If I compile with:</p>\n\n<pre><code>gcc -Wall -Wpedantic -Wextra mytest.c -o mytest\n</code></pre>\n\n<p>it gives as output:</p>\n\n<pre><code>Running huhu suite\n</code></pre>\n\n<p><strong>Omitting static</strong></p>\n\n<p>If you accidentally forget to specify static it should give a compile time error then. So if I change this line to: </p>\n\n<pre><code>const char *const test_suite_name = \"huhu\";\n</code></pre>\n\n<p>and try to compile it like this:</p>\n\n<pre><code>gcc -Wall -Wpedantic -Wextra mytest2.c -o mytest2\n</code></pre>\n\n<p>this error message will be displayed:</p>\n\n<pre><code>mytest2.c:3:19: error: non-static declaration of \u2018test_suite_name\u2019 follows static declaration\n const char *const test_suite_name = \"huhu\";\n                   ^~~~~~~~~~~~~~~\nIn file included from mytest2.c:1:\ntest_suite.h:3:26: note: previous declaration of \u2018test_suite_name\u2019 was here\n static const char *const test_suite_name;\n</code></pre>\n\n<p>Since it is an error it is also output if you compile with:</p>\n\n<pre><code>gcc mytest2.c -o mytest2\n</code></pre>\n\n<p><strong>Screenshot of Error Message</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0Qxvo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Qxvo.png\" alt=\"Screenshot with Error Message\"></a></p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56385336, "answer_count": 1, "score": 2, "last_activity_date": 1559249475, "creation_date": 1559150028, "question_id": 56365581, "link": "https://stackoverflow.com/questions/56365581/allowing-overriding-zero-initialized-object-with-internal-linkage", "title": "Allowing &quot;overriding&quot; zero-initialized object with internal linkage", "body": "<p>I'm designing a micro-framework for unit testing and want to be able to provide an ability for client to define a \"test suite name\". So I have the following header file called <code>test_suite.h</code>:</p>\n\n<pre><code>static const char *const test_suite_name;\n\nstatic inline void run_all_tests(void){\n    printf(\"Running \");\n    if(!test_suite_name){\n        printf(\"unnamed suite\");\n    } else {\n        printf(\"%s suite\", test_suite_name);\n    }\n    //run tests\n}\n</code></pre>\n\n<p>The intention of this is to allow clients to \"override\" the <code>test_suite_name</code> as follows:</p>\n\n<pre><code>#include \"test_suite.h\"\n\nextern const char *const test_suite_name = \"suite1\";\n</code></pre>\n\n<p>I think <strong><em>the behavior of such usage is well-defined</em></strong> since <code>static const char *const test_suite_name;</code> constitutes a tentative-definition and then <code>extern const char *const test_suite_name = \"suite1\";</code> constitutes an external definition. There is no linkage disagreement since <code>6.2.2(p4)</code>:</p>\n\n<blockquote>\n  <p>For an identifier declared with the storage-class specifier <code>extern</code> in a\n  scope in which a prior declaration of that identifier is visible,31) if\n  the prior declaration specifies internal or external  linkage,  the \n  linkage  of  the  identifier  at  the  later  declaration  is  the \n  same  as  the linkage specified at the prior declaration.</p>\n</blockquote>\n\n<p>I ran some experiments:</p>\n\n<ol>\n<li><a href=\"https://coliru.stacked-crooked.com\" rel=\"nofollow noreferrer\">https://coliru.stacked-crooked.com</a>:</li>\n</ol>\n\n<p>Prints the following error message:</p>\n\n<pre><code>error: redefinition of 'const char* const suite_name'\n extern const char *const suite_name = \"some suite\";\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/aa1464f186490bf5\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<ol start=\"2\">\n<li><a href=\"https://ideone.com/\" rel=\"nofollow noreferrer\">https://ideone.com/</a>: </li>\n</ol>\n\n<p>Works completely fine with no warnings produced</p>\n\n<p><a href=\"https://ideone.com/awC5KJ\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<ol start=\"3\">\n<li><code>gcc7.4.0</code> on my machine.</li>\n</ol>\n\n<p>Produces warning:</p>\n\n<pre><code>warning: \u2018test_suite_name\u2019 initialized and declared \u2018extern\u2019\n</code></pre>\n\n<p><strong><em>Question:</em></strong> Is the behavior of the code shown above well-defined?</p>\n\n<p>I'm pretty sure that the behavior would be undefined if write the following:</p>\n\n<pre><code>#include \"test_suite.h\"\n\nconst char *const test_suite_name = \"suite1\"; //without extern\n</code></pre>\n\n<p>because of <code>6.2.2(p5)</code>(emphasize  mine):</p>\n\n<blockquote>\n  <p>If the declaration of an identifier for a function has no\n  storage-class specifier, its linkage is  determined  exactly  as  if \n  it  were  declared  with  the  storage-class  specifier <code>extern</code>. <strong>If the\n  declaration of an identifier for an object has file scope and no\n  storage-class specifier, its linkage is external.</strong></p>\n</blockquote>\n\n<p>So we would have linkage disagreement between <code>static const char *const test_suite_name;</code> with internal linkage and <code>const char *const test_suite_name = \"suite1\";</code> with external linkage.</p>\n"}, {"tags": ["c", "linux", "memory", "memory-management", "malloc"], "owner": {"reputation": 141, "user_id": 9725909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1deec9354fca690a81eee270924e8499?s=128&d=identicon&r=PG&f=1", "display_name": "avan1235", "link": "https://stackoverflow.com/users/9725909/avan1235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": -3, "locked_date": 1559158306, "last_activity_date": 1559157409, "creation_date": 1559148915, "last_edit_date": 1559156651, "question_id": 56365330, "link": "https://stackoverflow.com/questions/56365330/prevent-malloc-function-wrapping", "title": "Prevent malloc function wrapping", "body": "<p>How can we prevent wrapping the <code>malloc</code> by the gcc by some function in C programs?</p>\n\n<p>I would like to use any other function to allocate memory (not <code>calloc</code>, <code>realloc</code>, etc.) to prevent wrapping malloc in tests of the program in which only these function are wrapped to take a lot of time.</p>\n\n<p>My expectation is to see some useful example of any good way of allocating memory in C programs without using the <code>malloc</code> and similiar functions.</p>\n\n<p>I have read something about <code>mmap</code> function but could't find any good example of it's usage instead of malloc.</p>\n\n<p>There are speed tests in which malloc is called by wrapped function which is written to take more time and allocate memory. So every time when I call malloc in my pogram it is called but it takes more time so the tests can detect very often usage of malloc. The problem is that I use linked lists so the memory is allocated separately for every node of the list. I don't know how to change this implementation because it is really comfortable to use linked lists in my structure. </p>\n"}, {"tags": ["c", "gdb", "icc"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1559152460, "post_id": 56365312, "comment_id": 99335312, "body": "<code>I have compiled everything with -g flags</code> - no you didn&#39;t. You didn&#39;t compile glibc, you used glibc provided by your system. And it is provided without debugging info."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 2, "creation_date": 1559155596, "post_id": 56365312, "comment_id": 99336597, "body": "That does not matter. Line numbers appear to be absent in user code in <code>direct.c</code> file."}, {"owner": {"reputation": 113, "user_id": 3243845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7be531b9d539a53e19daa476fdd661?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitar Slavchev", "link": "https://stackoverflow.com/users/3243845/dimitar-slavchev"}, "edited": false, "score": 1, "creation_date": 1559220822, "post_id": 56365312, "comment_id": 99357595, "body": "@ Kamil Cuk I am not interested in debuging glibc. My real issue is a segmentation fault, that I couldn&#39;t track because the debugger couldn&#39;t show me meaningful tracking information. printf debugging won the day for me."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11157208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb833d2532b6535bfdd408402f1e7e1?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre Ramoin", "link": "https://stackoverflow.com/users/11157208/pierre-ramoin"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162110, "creation_date": 1559162110, "answer_id": 56368139, "question_id": 56365312, "link": "https://stackoverflow.com/questions/56365312/why-i-cannot-see-line-numbers-in-gdb-backtrace/56368139#56368139", "title": "Why I cannot see line numbers in gdb backtrace?", "body": "<p>Try to add the flag</p>\n\n<p><code>-debug expr-source-pos</code></p>\n\n<p>It should add the line informations</p>\n\n<p><a href=\"https://software.intel.com/en-us/cpp-compiler-developer-guide-and-reference-debug-linux-and-macos\" rel=\"nofollow noreferrer\">https://software.intel.com/en-us/cpp-compiler-developer-guide-and-reference-debug-linux-and-macos</a></p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 3243845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7be531b9d539a53e19daa476fdd661?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitar Slavchev", "link": "https://stackoverflow.com/users/3243845/dimitar-slavchev"}, "edited": false, "score": 0, "creation_date": 1604400410, "post_id": 56371593, "comment_id": 114330267, "body": "To be honest I am not sure if this is the right answer but I suspect that the old gdb was the culprit. I eventually solved the problem with printf debugging."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 2, "last_activity_date": 1559190243, "creation_date": 1559190243, "answer_id": 56371593, "question_id": 56365312, "link": "https://stackoverflow.com/questions/56365312/why-i-cannot-see-line-numbers-in-gdb-backtrace/56371593#56371593", "title": "Why I cannot see line numbers in gdb backtrace?", "body": "<blockquote>\n  <p>May be the problem is</p>\n</blockquote>\n\n<p>No: the problem is not that (neither <code>main</code>, not <code>direct</code> are defined in <code>libc</code>).</p>\n\n<p>This appears to be a bug in GDB: before you execute <code>run</code>, it clearly knows that the address <code>0x40855d</code> corresponds to <code>direct.c, line 55</code>.</p>\n\n<p>But after <code>run</code>, it somehow forgets that it knew this.</p>\n\n<p>Your version of GDB is also 9 years old. As the first step, I suggest building a current version (<a href=\"https://www.gnu.org/software/gdb/\" rel=\"nofollow noreferrer\">8.3 as of today</a>).</p>\n"}], "owner": {"reputation": 113, "user_id": 3243845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7be531b9d539a53e19daa476fdd661?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitar Slavchev", "link": "https://stackoverflow.com/users/3243845/dimitar-slavchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 0, "accepted_answer_id": 56371593, "answer_count": 2, "score": 2, "last_activity_date": 1559190243, "creation_date": 1559148832, "last_edit_date": 1559149662, "question_id": 56365312, "link": "https://stackoverflow.com/questions/56365312/why-i-cannot-see-line-numbers-in-gdb-backtrace", "title": "Why I cannot see line numbers in gdb backtrace?", "body": "<p>I cannot see line numbers in gdb. I have compiled everything with -g flags with mpiicc.</p>\n\n<p>gdb is not showing line numbers even for breakpoints for me.</p>\n\n<p>May be the problem is in \"Missing separate debuginfos, use: debuginfo-install glibc-2.12-1.166.el6_7.7.x86_64 numactl-2.0.9-2.el6.x86_64\" but I am not a superuser so I cannot install these.</p>\n\n<pre><code> gdb  --args ./central -g 5 51\nGNU gdb (GDB) Red Hat Enterprise Linux (7.2-83.el6)\nCopyright (C) 2010 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-redhat-linux-gnu\".\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;...\nReading symbols from /home/dslavchev/NuclearTesting/MPI/project-a-test-mpi/central...done.\n(gdb) break direct.c:55\nBreakpoint 1 at 0x40855d: file direct.c, line 55.\n(gdb) l direct.c:55\n50  \n51  void direct(int* N, double **PA, Coord **points)\n52  {\n53      int     i ,j ,k ,l, ir, irr,\n54              md = suma(N , NUM_AIRFOILS) - NUM_AIRFOILS,\n55              m;\n56      double  *D, // **D,\n57              *A, *sv;\n58  \n59      int matrix_size_D = md*md;\n(gdb) r\nStarting program: /home/dslavchev/NuclearTesting/MPI/project-a-test-mpi/central -g 5 51\n[Thread debugging using libthread_db enabled]\n\nBreakpoint 1, 0x000000000040855d in direct ()\nMissing separate debuginfos, use: debuginfo-install glibc-2.12-1.166.el6_7.7.x86_64 numactl-2.0.9-2.el6.x86_64\n(gdb) bt\n#0  0x000000000040855d in direct ()\n#1  0x0000000000405ee9 in main ()\n(gdb) s\nSingle stepping until exit from function direct,\nwhich has no line number information.\nPMPI_Comm_size (comm=1140850688, size=0x7fffffffc240) at ../../src/mpi/comm/comm_size.c:57\n57  ../../src/mpi/comm/comm_size.c: No such file or directory.\n    in ../../src/mpi/comm/comm_size.c\n(gdb) s\n65  in ../../src/mpi/comm/comm_size.c\n(gdb) s\n57  in ../../src/mpi/comm/comm_size.c\n(gdb) \n58  in ../../src/mpi/comm/comm_size.c\n(gdb) \n59  in ../../src/mpi/comm/comm_size.c\n(gdb) \n65  in ../../src/mpi/comm/comm_size.c\n(gdb) \n</code></pre>\n\n<p>Here is the build commands as well:</p>\n\n<pre><code>mpiicc -g -c -o central.o central.c -qopenmp \nmpiicc -g -c -o contours.o contours.c -qopenmp \nmpiicc -g -c -o mymath.o mymath.c -qopenmp \nmpiicc -g -c -o vort.o vort.c -qopenmp \nmpiicc -g -qopenmp   -I/opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/include -c -o  direct.o direct.c \nmpiicc -g -c -o a_liftarg.o a_liftarg.c -qopenmp \nmpiicc -g -c -o psavel.o psavel.c -qopenmp \nmpiicc -g -c -o euler.o euler.c -qopenmp \nmpiicc -g -c -o streamline.o streamline.c -qopenmp \nmpiicc -g -c -o speedmap.o speedmap.c -qopenmp \nmpiicc -g -o central central.o contours.o mymath.o vort.o direct.o a_liftarg.o psavel.o euler.o streamline.o speedmap.o /opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/lib/intel64/libmkl_scalapack_lp64.a -Wl,--start-group /opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/lib/intel64/libmkl_intel_lp64.a /opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/lib/intel64/libmkl_intel_thread.a /opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/lib/intel64/libmkl_core.a /opt/intel/parallel_studio_xe_2017.2.050/compilers_and_libraries_2017/linux/mkl/lib/intel64/libmkl_blacs_intelmpi_lp64.a -Wl,--end-group -liomp5 -lpthread -lm -ldl -qopenmp\n</code></pre>\n"}, {"tags": ["c", "binary", "hex", "ascii", "data-conversion"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1559148039, "post_id": 56365004, "comment_id": 99333396, "body": "<code>strtol</code> converts a string to a long integer. The first character in the string that you&#39;re passing in is 0xFF, followed by a null terminator. You seem to need a function that does the opposite of <code>strtol</code>."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1559147873, "creation_date": 1559147873, "answer_id": 56365087, "question_id": 56365004, "link": "https://stackoverflow.com/questions/56365004/wrong-value-returned-when-converting-from-raw-character-to-hex-equivalent/56365087#56365087", "title": "Wrong value returned when converting from raw character to hex equivalent", "body": "<p>aval[2]={0xFF,0x00};</p>\n\n<p>This is not ascii. </p>\n\n<p>aval[]={'f', 'f',0x00};</p>\n\n<p>Or </p>\n\n<p>aval[]=\"ff\";</p>\n\n<p>And try again</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10275719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3896e294fd6d5f0b1b98300882e5abe6?s=128&d=identicon&r=PG&f=1", "display_name": "AlienScar", "link": "https://stackoverflow.com/users/10275719/alienscar"}, "is_accepted": false, "score": -1, "last_activity_date": 1559153834, "last_edit_date": 1559153834, "creation_date": 1559148984, "answer_id": 56365339, "question_id": 56365004, "link": "https://stackoverflow.com/questions/56365004/wrong-value-returned-when-converting-from-raw-character-to-hex-equivalent/56365339#56365339", "title": "Wrong value returned when converting from raw character to hex equivalent", "body": "<pre><code>char aval[] = {0x66, 0x66, 0x00};\n</code></pre>\n\n<p><code>0x66</code> is char <code>'f'</code> in ascii </p>\n"}], "owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559153834, "creation_date": 1559147566, "question_id": 56365004, "link": "https://stackoverflow.com/questions/56365004/wrong-value-returned-when-converting-from-raw-character-to-hex-equivalent", "title": "Wrong value returned when converting from raw character to hex equivalent", "body": "<p>I have an application where the input is a raw set of bytes and I want to see the two-digit hex code of each of those bytes. For now I'm trying to get the proper hex code for one byte. This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\nchar hexvc; //= ascii code for hex value\nchar aval[2]={0xFF,0x00}; //Our raw 1 byte data. can't print actual code here\nchar hexv[20]; //value for output\nmemset(hexv,0,19); //clear output\nhexvc=strtol(aval,NULL,16) &amp; 0xFF;\nif (hexvc != '\\0'){\n    sprintf(hexv,\"%02hx\",hexvc);\n}else{\n    //hexvc always equals 0. why not FFh?\n    strcpy(hexv,\"00\");\n}\nprintf(\"%s\\n\",hexv);\nreturn 0;\n}\n</code></pre>\n\n<p>I expected to see ff appear on the screen, but instead I see 00.\nHow do I fix this? </p>\n\n<p>And if I change <code>0xFF</code> after <code>aval[2]=</code> to <code>0x31</code> or <code>'1'</code> (since 1 is the actual value for ascii code 0x31) then I want to see <code>31</code> appear on the screen.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559147445, "post_id": 56364691, "comment_id": 99333129, "body": "oupps in the other answer the arrays are not memorized, I was wrong and the duplicate is wrong too, sorry"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559150034, "post_id": 56364691, "comment_id": 99334285, "body": "I do not if your question will be reopen but I edited my answer and undeleted it, you can specify the number of columns necessary to compute where a cell is, I put an example in my answer"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559146858, "post_id": 56364751, "comment_id": 99332819, "body": "<code>volatile</code> seems really out of place here."}, {"owner": {"reputation": 9, "user_id": 10878905, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EmDnxPYAIPw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNvcQjq9TxOLTai4qHbehd0quucw/mo/photo.jpg?sz=128", "display_name": "Giuliano Malatesta", "link": "https://stackoverflow.com/users/10878905/giuliano-malatesta"}, "edited": false, "score": 0, "creation_date": 1559146893, "post_id": 56364751, "comment_id": 99332840, "body": "I understand the problem but I don&#39;t know how to fix it"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559147102, "post_id": 56364751, "comment_id": 99332964, "body": "Note, since the question is tagged <code>C</code>, that one of <code>C99</code>&#39;s features is indeed variable length arrays where the above examples are completely valid."}], "tags": [], "owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "is_accepted": false, "score": 0, "last_activity_date": 1559146539, "creation_date": 1559146539, "answer_id": 56364751, "question_id": 56364691, "link": "https://stackoverflow.com/questions/56364691/reading-matrices-of-unkown-dimension/56364751#56364751", "title": "Reading matrices of unkown dimension", "body": "<p>The result of the get_dim function is determined at run-time, and the size static arrays like matA must be determined at compile time. As an example, take this code:</p>\n\n<pre><code>volatile size_t length = 5;\nint myArray[length];\n</code></pre>\n\n<p>Or another example:</p>\n\n<pre><code>size_t length;\n//take input from the user...\nint myArray[length]\n</code></pre>\n\n<p>These examples would not compile because length is only able to be determined at run-time.</p>\n\n<p>You would have to use dynamically allocated arrays to do what you want to do.</p>\n"}], "owner": {"reputation": 9, "user_id": 10878905, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EmDnxPYAIPw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNvcQjq9TxOLTai4qHbehd0quucw/mo/photo.jpg?sz=128", "display_name": "Giuliano Malatesta", "link": "https://stackoverflow.com/users/10878905/giuliano-malatesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1559146892, "answer_count": 1, "score": -2, "last_activity_date": 1561045226, "creation_date": 1559146258, "question_id": 56364691, "link": "https://stackoverflow.com/questions/56364691/reading-matrices-of-unkown-dimension", "closed_reason": "Duplicate", "title": "Reading matrices of unkown dimension", "body": "<p>I'm trying to read a matrix from a file formatted in this way</p>\n\n<pre>\n1 2 3 4\n4 5 6 7\n8 9 10 11\n*\n1 0 1\n0 1 1\n1 1 1]\n</pre>\n\n<p>but I don't know how to pass the multidimensional array with its dimension given by rows[] and cols[] arrays to the function read_matrix().</p>\n\n<p>I am able to get the correct dimension of the two matrices</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint get_dim(char *file, int *r, int *col);\n/*gets the dimension and type of operation*/\n\nvoid read_matrix(char *file, int (*matA)[], int(*matB)[], int *m, int *n);\n\nint main (int argc, char *argv[]){\n\n    int i,j;\n    int rows[2]= {0,1}; /* The last line of the file does not contain '\\n' */\n    int cols[2]= {0,0};\n    int operation; /*type of operation 1 for * and 2 for + */\n\n    operation = get_dim(argv[1], rows, cols);\n\n    int A[rows[0]][cols[0]];\n    int B[rows[1]][cols[1]];\n\n    printf(\"A is a matrix %d x %d\\n\",rows[0], cols[0]);\n\n    if(operation != 0)\n        printf(\"B is a matrix %d x %d\\n\", rows[1], cols[1]);\n\n    read_matrix(argv[1], A, B, rows, cols);\n\n    /*printing the matrices */\n\n    for(i = 0; i &lt; rows[0]; i++){\n        for(j=0; j &lt; cols[0]; j++){\n            printf(\"%d \", A[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    printf(\"*\\n\");\n\n     for(i = 0; i &lt; rows[1]; i++){\n        for(j=0; j&lt; cols[1]; j++){\n            printf(\"%2d \", B[i][j]);\n        }\n        printf(\"\\n\");\n    }    \n    return 0;\n}\n\nint get_dim(char *file, int *r, int *col){\n\n   FILE *fp; \n   int c;\n   int op=0;\n   int n =0; /*to check all coefficients in a row */\n\n   /* opening file for reading */\n   fp = fopen(file, \"r\");\n\n   if(fp == NULL) {\n      perror(\"Error opening file\");\n   }\n\n   while ( (c = getc(fp)) != ']')\n   {       \n       if(isdigit(c) &amp;&amp; n==0){\n           if(op == 0)\n               col[0]++;\n           else\n               col[1]++;\n       }        \n\n    //Count whenever new line is encountered\n    if (c == '\\n'){\n        n=1;\n        if(op == 0)\n            r[0]++;\n        else \n            r[1]++;\n    }     \n\n        if(c == '*'){\n            op=1;\n            n =0;\n            c = getc(fp);\n        }\n        else if(c == '+'){\n            op=2;\n            c = getc(fp);\n        }\n\n        //take next character from file.\n    }\n    fclose(fp);\n    return op;\n}\n\nvoid read_matrix(char *file, int (*matA)[], int(*matB)[], int *m, int *n){\n\n    int i,j;\n    FILE *fp;\n\n    if( (fp = fopen(file, \"r\")) != NULL ){\n\n        for(i=0; i &lt; m[0]; i++)\n            for(j=0; j &lt; n[0]; j++)\n                fscanf(fp, \"%d\", &amp;matA[i][j]);    \n\n        /*skip the line containing the character operator */\n        while ( fgetc(fp) != '\\n')\n            fgetc(fp);        \n\n        for(i=0; i &lt; m[1]; i++)\n            for(j=0; j &lt; n[1]; j++)\n                fscanf(fp, \"%d\", &amp;matB[i][j]);    \n    }\n\n    fclose(fp);\n}\n</code></pre>\n\n<p>I should define the pointers this way: int(*matA)[cols[0]] and int(*matB)[cols[1]].\nIn read_matrix() by declaring this pointer: int(*matB)[] I get the error : invalid use of array with unspecified bounds, that I understand. But the bound is determined by the get_dim() function.</p>\n"}, {"tags": ["c", "arrays", "file-io"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1559145873, "post_id": 56364452, "comment_id": 99332315, "body": "Please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559146006, "post_id": 56364452, "comment_id": 99332402, "body": "As for your problem, is what you show the <i>complete</i> file? Is it a complete record, but there can be more records like that in the file? Can there be an arbitrary number of <code>G</code> and <code>C</code> lines after the two first header lines?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559146115, "post_id": 56364452, "comment_id": 99332460, "body": "Anyway, my tip is to not try to generalize it, unless the <code>C</code> and <code>G</code> lines can occur multiple times, in which case you could generalize for those two type. Otherwise read the four lines separately, and parse the separately. Will make your code much less complex."}, {"owner": {"reputation": 311, "user_id": 5587518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51dcc3106fab02b2a56bd227d050bae?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/5587518/gregory"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559150913, "post_id": 56364452, "comment_id": 99334713, "body": "@Someprogrammerdude, yes the file will have these four lines. The C and G length is actually dependent on Nbp, which may be a problem since I will then need to dynamically allocate the array after reading this number in. Can you elaborate on how you would parse each line separately. Is it as simple as searching till I find the string &#39;G : &#39; and then using a for loop?"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 9707379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16642558a15dab8bb5d47be1f8eabd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyrei", "link": "https://stackoverflow.com/users/9707379/kyrei"}, "is_accepted": false, "score": 0, "last_activity_date": 1559284970, "last_edit_date": 1559284970, "creation_date": 1559146556, "answer_id": 56364755, "question_id": 56364452, "link": "https://stackoverflow.com/questions/56364452/read-tab-delimited-data-to-array-in-c/56364755#56364755", "title": "Read tab delimited data to array in C", "body": "<p>Looks like your issue is <code>atof()</code> in c discards any white space after the first valid number. If you want to get all of the numbers you will have to split <code>tmpstr2</code> and do each element separately in <code>atof()</code>. </p>\n\n<p>You can use <code>strtok</code> to split it into tokens then use <code>atof()</code> on each.</p>\n\n<pre><code>char temp[];\nchar *nums;\nnums = strtok(temp, \" \\t\");\nint count = 0;\nwhile (nums != NULL)\n{\n    G[count] = atof(chrs);\n    nums = strtok(NULL, \" \\t\");\n    count++;\n}\n</code></pre>\n\n<p>Of course that is if you know before hand how many numbers you are going to get.</p>\n\n<p>View this article for more info: <a href=\"https://stackoverflow.com/questions/9210528/split-string-with-delimiters-in-c\">Split string with delimiters in C</a></p>\n"}, {"tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": true, "score": 2, "last_activity_date": 1559159281, "creation_date": 1559159281, "answer_id": 56367544, "question_id": 56364452, "link": "https://stackoverflow.com/questions/56364452/read-tab-delimited-data-to-array-in-c/56367544#56367544", "title": "Read tab delimited data to array in C", "body": "<p>I am not a fan of <code>scanf</code>, and would strongly encourage you to parse the line yourself.  If you insist on using <code>scanf</code>, I recommend using the <code>sscanf</code> variant for this so you can check the line beforehand to see which array to write.  I'm not sure why you're using named arrays at all, though.  C is not very good at introspection, and you can make your program more flexible without trying to tie your input to particular symbols.  Something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define properConfigs 4\nvoid *Malloc(size_t s);\nint\nmain(int argc, char **argv)\n{\n        FILE *fp = argc &gt; 1 ? fopen(argv[1],\"r\") : stdin;\n        double *G = Malloc( properConfigs * sizeof *G );\n        double *C = Malloc( properConfigs * sizeof *G );\n        int line_count = 0;\n        char line[256];\n\n        if( fp == NULL ) {\n                perror(argv[1]);\n                return 1;\n        }\n        while( line_count += 1, fgets( line, sizeof line, fp ) != NULL ) {\n                double *target = NULL;\n                switch(line[0]) {\n                case 'G': target = G; break;\n                case 'C': target = C; break;\n                }\n                if( target == NULL || 4 != sscanf(\n                                line, \"%*s%lf%lf%lf%lf\",\n                                target, target+1, target+2, target+3)) {\n                        fprintf(stderr, \"Bad input on line %d\\n\", line_count);\n                }\n        }\n        for(int i=0; i &lt; 4; i += 1 ) {\n                printf (\"G[%d] = %g\\tC[%d] = %g\\n\", i, G[i], i, C[i]);\n        }\n\n\n        return ferror(fp);\n}\nvoid *Malloc(size_t s) {\n        void *r = malloc(s);\n        if(r == NULL) {\n                perror(\"malloc\");\n                exit(EXIT_FAILURE);\n        }\n        return r;\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 5587518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51dcc3106fab02b2a56bd227d050bae?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/5587518/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 56367544, "answer_count": 2, "score": 0, "last_activity_date": 1559284970, "creation_date": 1559145342, "last_edit_date": 1559157750, "question_id": 56364452, "link": "https://stackoverflow.com/questions/56364452/read-tab-delimited-data-to-array-in-c", "title": "Read tab delimited data to array in C", "body": "<p>I have an input file in text format that looks like:</p>\n\n<pre><code>G:  5   10  20  30\nC:  24  49  4.0 30.0\n</code></pre>\n\n<p>I'd like to set each of these to an array, array, respectively. I saw from this answer <a href=\"https://stackoverflow.com/questions/23037180/reading-input-parameters-from-a-text-file-with-c\">reading input parameters from a text file with C</a>, a way to read some of the values, but how would I get the arrays G and C?</p>\n\n<p><strong><em>EDIT</em></strong>:</p>\n\n<p>If I removed G:, and C: from the .txt file I could just run a for loop.</p>\n\n<pre><code>double *conc = (double*)malloc(properConfigs*sizeof(double));\ndouble *G = (double*)malloc(properConfigs*sizeof(double));\n\nfor (int i=0;i&lt;properConfigs;i++)\n    fscanf(inputfile,\"%lf\", &amp;G[i]);\nfor (int i=0;i&lt;properConfigs;i++)\n    fscanf(inputfile,\"%lf\", &amp;conc[i]); \n</code></pre>\n\n<p>This would work, but I'd like to be able to account for someone saving the .txt file in a different order or at some point adding more rows (with different parameters).</p>\n"}, {"tags": ["python", "c", "cython"], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 7482208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28673a77dc1376a5de583d08e8bace26?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Mishalkin", "link": "https://stackoverflow.com/users/7482208/ivan-mishalkin"}, "edited": false, "score": 0, "creation_date": 1559228016, "post_id": 56370352, "comment_id": 99361573, "body": "thank you, cool answer. I try to adopt this code to my problem and instead of int I have type definition <code>typedef void* connection_t</code>. When I apply logic from the answer I get  an error: <code>Invalid base type for memoryview slice: connection_t</code>. If I am not mistaken the error occurs because unlike <code>int</code>, <code>void *</code> is not the base type. Do you have any suggestions, how to deal with this problem?"}], "tags": [], "owner": {"reputation": 622, "user_id": 6610031, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c0af37e745972b1aa14bd9abc9a1dec?s=128&d=identicon&r=PG&f=1", "display_name": "oz1", "link": "https://stackoverflow.com/users/6610031/oz1"}, "is_accepted": false, "score": 1, "last_activity_date": 1559178218, "creation_date": 1559178218, "answer_id": 56370352, "question_id": 56364422, "link": "https://stackoverflow.com/questions/56364422/is-it-possible-to-define-c-type-variable-in-python-and-pass-its-address-to-cytho/56370352#56370352", "title": "Is it possible to define c-type variable in python and pass its address to cython wrapped function", "body": "<p>I have no idea how your example makes sense in practice, but one possible way is to pass a buffer, which managed by python, to the C function. For example:</p>\n\n<pre><code>%%cython -a -f \n\n# Suppose this is the external C function needed to wrap\ncdef void c_func(int* value_to_change):\n    value_to_change[0] = 123;\n\ndef py_func(int[:] buffer_to_change):\n    c_func(&amp;buffer_to_change[0]);\n</code></pre>\n\n<hr>\n\n<pre><code>from array import array\nfrom ctypes import *\n\na = array('i', [0]);\npy_func(a)\nprint(a[0])\n\nb = (c_int*1)() # c_int array with length 1\npy_func(b)\nprint(b[0])\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 7482208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28673a77dc1376a5de583d08e8bace26?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Mishalkin", "link": "https://stackoverflow.com/users/7482208/ivan-mishalkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559178218, "creation_date": 1559145222, "question_id": 56364422, "link": "https://stackoverflow.com/questions/56364422/is-it-possible-to-define-c-type-variable-in-python-and-pass-its-address-to-cytho", "title": "Is it possible to define c-type variable in python and pass its address to cython wrapped function", "body": "<p>I am wrapping a C-library with Cython and for now I do not know how to workaround passing address to C function from python. Details below:</p>\n\n<p>I have some C-function that takes address to some defined beforehand C variable and changes its value:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void c_func(int* x) {\n*x=5;\n}\n</code></pre>\n\n<p>As a C user I can use this function in following way:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>def int var1\ndef int var2\nc_func(&amp;var1)\nc_func(&amp;var2)\n</code></pre>\n\n<p>After execution both <code>var1</code> and <code>var2</code> will be equal to 5. Now I want to wrap <code>c_func</code> with cython. I'd like to have <code>py_func</code> that might be imported from wrapper package and used, but I do not know how to define c variables from python.</p>\n\n<p>What I have already done(in jupyter):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>%load_ext cython\n\n%%cython\n\ncdef int some_int\n\ncdef extern from *:\n    \"\"\"\n    void c_func(int* x) {\n    *x=5;\n    }\n\n    \"\"\"\n    int c_func(int* x)\n\nc_func(&amp;some_int)\n\nprint(some_int)\n</code></pre>\n\n<p>What I want to get:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>%%cython\n\n# This part should be in separate pyx file\ncdef extern from *:\n    \"\"\"\n    void c_func(int* x) {\n    *x=5;\n    }\n\n    \"\"\"\n    int c_func(int* x)\n\ndef py_func(var):\n    c_func(&amp;var)\n\n# The following part is user API\nfrom wrapper import py_func\n\nvar_to_pass_in_py_func = ... # somehow defined C variable\n\npy_func(var_to_pass_in_py_func) \n\nprint(var_to_pass_in_py_func) # should print 5\n</code></pre>\n\n<p><code>var_to_pass_in_py_func</code> might not be converted to python object, but C functions wrapped with python should not conflict with it.</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559144838, "post_id": 56364265, "comment_id": 99331777, "body": "How about <code>strcspn</code>?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1559145283, "post_id": 56364265, "comment_id": 99332008, "body": "<code>for(char *c=str2; *c; c++) if (strchr(str1,*c)==0) {printf(&quot;error: %c&quot;,*c); break;} if (!*c) printf(&quot;ok&quot;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "is_accepted": true, "score": 3, "last_activity_date": 1559145713, "creation_date": 1559145713, "answer_id": 56364547, "question_id": 56364265, "link": "https://stackoverflow.com/questions/56364265/how-to-check-if-string2-has-characters-not-in-string1/56364547#56364547", "title": "How to check if string2 has characters not in string1?", "body": "<p><code>strspn</code> will return the index of the first character in String2 that is not in String1. If all the characters match, the index will be to the terminating zero.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main ( void) {\n    char *String1 = \"1234567890+-\";\n    char *String2 = \"1+a\";\n    int index = strspn ( String2, String1);\n    if ( String2[index]) {\n        printf ( \"character \\'%c\\' not found in %s\\n\", String2[index], String1);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559147163, "post_id": 56364626, "comment_id": 99332992, "body": "You forgot to initialize <code>mark</code> (not UB, but potentially wrong result), and to cast <code>*s</code> to <code>unsigned char</code> for indexing (potential UB)."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1559153640, "last_edit_date": 1559153640, "creation_date": 1559146020, "answer_id": 56364626, "question_id": 56364265, "link": "https://stackoverflow.com/questions/56364265/how-to-check-if-string2-has-characters-not-in-string1/56364626#56364626", "title": "How to check if string2 has characters not in string1?", "body": "<p>You can use a simplified version of <code>union-find</code>.</p>\n\n<p>First, you loop over <code>string1</code> and mark all the characters with <code>1</code>. I write simplified code, you can complete it.</p>\n\n<pre><code>char mark[255];\nfor(s=string1; s; s++) mark[*s]=1;\n</code></pre>\n\n<p>Next, you loop over <code>string2</code> and check if the current char is marked.</p>\n\n<pre><code>for(s=string2; s; s++) if (!mark[*s]) printf(\"%c\", *s);\n</code></pre>\n\n<p>This will print all chars from <code>string2</code> that are not in <code>string1</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 5474152, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8wclz.jpg?s=128&g=1", "display_name": "stephw", "link": "https://stackoverflow.com/users/5474152/stephw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56364547, "answer_count": 2, "score": 0, "last_activity_date": 1559153640, "creation_date": 1559144649, "question_id": 56364265, "link": "https://stackoverflow.com/questions/56364265/how-to-check-if-string2-has-characters-not-in-string1", "title": "How to check if string2 has characters not in string1?", "body": "<pre><code>char String1 = \"1234567890+-\";\nchar String2 = \"1+a\";\n</code></pre>\n\n<p>String2 is an input and I want to check if it contains any character that is not in String1.</p>\n\n<p>I have tried using <code>strpbrk(String2,String1)</code> but this returns true as long as any character in <code>String1</code> exists in <code>String2</code>.</p>\n\n<p>Is there a better way to do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 1, "creation_date": 1559144432, "post_id": 56364178, "comment_id": 99331542, "body": "Post the code as text."}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 1, "creation_date": 1559144437, "post_id": 56364178, "comment_id": 99331549, "body": "Paste code as text, not as an image."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559144561, "post_id": 56364178, "comment_id": 99331611, "body": "Where is your code? There isn&#39;t even a picture of your code. Paste your code into the question and take 2-3 minutes and learn how to format questions properly. It&#39;s really easy. Read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559144870, "post_id": 56364178, "comment_id": 99331787, "body": "There is still no code. We cannot read your mind. Please <a href=\"https://stackoverflow.com/posts/56364178/edit\">edit</a> your question and put your code <i>into your question</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1559145627, "post_id": 56364178, "comment_id": 99332202, "body": "You are using <code>scanf_s</code> with <code>%s</code> specifier incorrectly. <i>&quot;Unlike <code>scanf</code> ... <code>scanf_s</code> ... requires the buffer size to be specified for all input parameters of type c, C, s, S, or string control sets that are enclosed in []. The buffer size in characters is passed as an additional parameter immediately following the pointer to the buffer or variable.&quot;</i> The compiler should be issuing a warning about this."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559145701, "post_id": 56364178, "comment_id": 99332238, "body": "You&#39;re doing it wrong, read carefully the documentation of <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l\" rel=\"nofollow noreferrer\"><code>scanf_s</code></a>, or just use <code>scanf</code> (without the <code>_s</code>) and ignore the Microsoft warnings."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559146029, "post_id": 56364178, "comment_id": 99332413, "body": "&quot;Is this the only way to pick up a string?&quot; No, you can use <code>fgets()</code> but you need to <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input/28462221#28462221\">remove any trailing newline</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559146394, "post_id": 56364178, "comment_id": 99332585, "body": "@Jabberwocky it is better to <code>#define _CRT_SECURE_NO_WARNINGS</code> rather than hunt though warnings for relevant ones."}, {"owner": {"reputation": 1, "user_id": 11573767, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157093467213913/picture?type=large", "display_name": "Yossi Alfiya", "link": "https://stackoverflow.com/users/11573767/yossi-alfiya"}, "edited": false, "score": 0, "creation_date": 1559146604, "post_id": 56364178, "comment_id": 99332685, "body": "I added the current line you said: #define _CRT_SECURE_NO_WARNINGS And still requires me to use: s_scanf ()"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559146846, "post_id": 56364178, "comment_id": 99332808, "body": "It must be <i>before</i> the <code>#include</code> files.I also <code>#define _CRT_SECURE_NO_DEPRECATE</code> and <code>#define _CRT_NONSTDC_NO_DEPRECATE</code>."}, {"owner": {"reputation": 1, "user_id": 11573767, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157093467213913/picture?type=large", "display_name": "Yossi Alfiya", "link": "https://stackoverflow.com/users/11573767/yossi-alfiya"}, "edited": false, "score": 0, "creation_date": 1559146848, "post_id": 56364178, "comment_id": 99332810, "body": "i added and still i get this message error:                                                                                                                                                                    Severity\tCode\tDescription\tProject\tFile\tLine Error\tC4996\t&#39;scanf&#39;: This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.\tProject5\tc:\\users\\user\\documents\\visual studio 2015\\projects\\project5\\project5\\dna.c\t22"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559146870, "post_id": 56364178, "comment_id": 99332825, "body": "It must be <b><i>before</i></b> the <code>#include</code> files. But having reverted to <code>scanf</code> you must still restrict the input length with <code>scanf(&quot;%999s&quot;, str);</code> It&#39;s true that the function is unsafe, but no function is safe when used incorrectly, including MS&#39;s allegedly &quot;safe&quot; (and non-portable) version&quot;."}, {"owner": {"reputation": 1, "user_id": 11573767, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157093467213913/picture?type=large", "display_name": "Yossi Alfiya", "link": "https://stackoverflow.com/users/11573767/yossi-alfiya"}, "edited": false, "score": 0, "creation_date": 1559147454, "post_id": 56364178, "comment_id": 99333135, "body": "It works!!! Thank you. But I still did not understand why I could not pick up characters in the following way?char DNA[1000]; \tfor (i = 0; i &lt; 1000; i++) \t{  \t\tscanf(&quot;%c&quot;, &amp;DNA[i]);  \t}"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559152278, "post_id": 56364178, "comment_id": 99335247, "body": "Please see <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-the-buffer\">scanf() leaves the newline char in the buffer</a>."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 7050186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNMBy.jpg?s=128&g=1", "display_name": "Fouad", "link": "https://stackoverflow.com/users/7050186/fouad"}, "is_accepted": false, "score": 0, "last_activity_date": 1559156928, "creation_date": 1559156928, "answer_id": 56367032, "question_id": 56364178, "link": "https://stackoverflow.com/questions/56364178/char-array-in-c-not-working-with-visual-studio-2015/56367032#56367032", "title": "char array in c not working with visual studio 2015", "body": "<p>fgets can help , see this code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\nchat str[1000];\n\nfegts(str,sizeof(str),stdin);\n\nstr[strlen(str)-1]='\\0';\nreturn 0;\n\n}\n</code></pre>\n\n<p>This code will take input from console till you press enter , but take care that fgets includes the new line character('\\n') with input so we need to remove it and end the string with null character ('\\0') . </p>\n\n<p>This is the reason for this line of code <code>str[strlen(str)-1]='\\0';</code> so strlen(str) will return the length of string including new line character.</p>\n\n<h2>for example :</h2>\n\n<h2>if input was <strong>\"fo\"</strong> , so it stored in str as follow:</h2>\n\n<p>str[0] = 'f' , str[1]='o' , str[2]='\\n' and str[3]='\\0'.\nSo <strong>strlen(str)-1</strong> will return 2 , so str[2] will be assigned to null character '\\0' </p>\n\n<h2>And finally the string will be as follow:</h2>\n\n<p>str[0] = 'f' , str[1]='o' and str[2]='\\0'.</p>\n"}], "owner": {"reputation": 1, "user_id": 11573767, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157093467213913/picture?type=large", "display_name": "Yossi Alfiya", "link": "https://stackoverflow.com/users/11573767/yossi-alfiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559156928, "creation_date": 1559144348, "last_edit_date": 1559145704, "question_id": 56364178, "link": "https://stackoverflow.com/questions/56364178/char-array-in-c-not-working-with-visual-studio-2015", "title": "char array in c not working with visual studio 2015", "body": "<ol>\n<li>Is this the only way to pick up a string? Can not you take character by character into an array? </li>\n<li>I get an error accessing memory. The code and the error are attached. </li>\n</ol>\n\n\n\n<pre><code>void main()\n{\n    int counA = 0, countB = 0, Na, Nc, i, index;\n    printf(\"enter Na and Nc\\n\");\n    scanf_s(\"%d%d\", &amp;Na, &amp;Nc);\n    char DNA[1000], SEQ[1000], str[1000];\n\n    printf(\"enter mulekula\\n\");\n    scanf_s(\"%s\", str);\n}\n</code></pre>\n\n<p>input:</p>\n\n<pre><code>2\n3\nAAA\n</code></pre>\n\n<p>message I get:</p>\n\n<pre><code>exception thrown...\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1559143256, "post_id": 56363831, "comment_id": 99330867, "body": "It depends on your platform which you didn&#39;t mention. Please <a href=\"https://stackoverflow.com/posts/56363831/edit\">edit</a>  your question and tell us more."}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1559143360, "post_id": 56363831, "comment_id": 99330922, "body": "You can do that in a portable manner by using C++17"}, {"owner": {"reputation": 15, "user_id": 10474571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oIi_2FnBxto/AAAAAAAAAAI/AAAAAAAAadQ/2Ofs3RAGRBg/photo.jpg?sz=128", "display_name": "id0 SI", "link": "https://stackoverflow.com/users/10474571/id0-si"}, "reply_to_user": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1559143418, "post_id": 56363831, "comment_id": 99330966, "body": "@Ayxan only by using c"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559143811, "post_id": 56363831, "comment_id": 99331197, "body": "@id0SI which compiler/IDE/toolchain are you using?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559143900, "post_id": 56363831, "comment_id": 99331258, "body": "If you can&#39;t use <code>&lt;dirent.h&gt;</code>, then you need to investigate the operating system alternatives.  For most practical purposes, on POSIX-based systems like Unix, there is no alternative to <code>&lt;dirent.h&gt;</code> these days.  Once upon three decades or so ago, there were some alternatives, but they ceased working on up-to-date systems around the turn of the millennium."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559154554, "post_id": 56363993, "comment_id": 99336192, "body": "<code>FindFirstFile</code>, <code>FindNextFile()</code>, and <code>FindClose()</code> are part of the Win32 API and are not specific to any particular Windows compiler, so I removed the reference to Visual Studio. And link-only answers are discouraged on StackOverflow since links break over time, so I included the actual code from Microsoft&#39;s example."}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": false, "score": 4, "last_activity_date": 1559154479, "last_edit_date": 1559154479, "creation_date": 1559143690, "answer_id": 56363993, "question_id": 56363831, "link": "https://stackoverflow.com/questions/56363831/how-can-i-list-all-files-in-a-directory-on-windows-without-using-dirent-h-in-c/56363993#56363993", "title": "How can I list all files in a directory on Windows without using dirent.h in C?", "body": "<p>You want to use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/FileAPI/nf-fileapi-findfirstfilew\" rel=\"nofollow noreferrer\"><code>FindFirstFile</code></a>, <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/FileAPI/nf-fileapi-findnextfilew\" rel=\"nofollow noreferrer\"><code>FindNextFile</code></a>, and <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/FileAPI/nf-fileapi-findclose\" rel=\"nofollow noreferrer\"><code>FindClose</code></a>. Microsoft provides an example on MSDN:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/FileIO/listing-the-files-in-a-directory\" rel=\"nofollow noreferrer\">Listing the Files in a Directory</a></p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;tchar.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;strsafe.h&gt;\n#pragma comment(lib, \"User32.lib\")\n\nvoid DisplayErrorBox(LPTSTR lpszFunction);\n\nint _tmain(int argc, TCHAR *argv[])\n{\n   WIN32_FIND_DATA ffd;\n   LARGE_INTEGER filesize;\n   TCHAR szDir[MAX_PATH];\n   size_t length_of_arg;\n   HANDLE hFind = INVALID_HANDLE_VALUE;\n   DWORD dwError=0;\n\n   // If the directory is not specified as a command-line argument,\n   // print usage.\n\n   if(argc != 2)\n   {\n      _tprintf(TEXT(\"\\nUsage: %s &lt;directory name&gt;\\n\"), argv[0]);\n      return (-1);\n   }\n\n   // Check that the input path plus 3 is not longer than MAX_PATH.\n   // Three characters are for the \"\\*\" plus NULL appended below.\n\n   StringCchLength(argv[1], MAX_PATH, &amp;length_of_arg);\n\n   if (length_of_arg &gt; (MAX_PATH - 3))\n   {\n      _tprintf(TEXT(\"\\nDirectory path is too long.\\n\"));\n      return (-1);\n   }\n\n   _tprintf(TEXT(\"\\nTarget directory is %s\\n\\n\"), argv[1]);\n\n   // Prepare string for use with FindFile functions.  First, copy the\n   // string to a buffer, then append '\\*' to the directory name.\n\n   StringCchCopy(szDir, MAX_PATH, argv[1]);\n   StringCchCat(szDir, MAX_PATH, TEXT(\"\\\\*\"));\n\n   // Find the first file in the directory.\n\n   hFind = FindFirstFile(szDir, &amp;ffd);\n\n   if (INVALID_HANDLE_VALUE == hFind) \n   {\n      DisplayErrorBox(TEXT(\"FindFirstFile\"));\n      return dwError;\n   } \n\n   // List all the files in the directory with some info about them.\n\n   do\n   {\n      if (ffd.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY)\n      {\n         _tprintf(TEXT(\"  %s   &lt;DIR&gt;\\n\"), ffd.cFileName);\n      }\n      else\n      {\n         filesize.LowPart = ffd.nFileSizeLow;\n         filesize.HighPart = ffd.nFileSizeHigh;\n         _tprintf(TEXT(\"  %s   %ld bytes\\n\"), ffd.cFileName, filesize.QuadPart);\n      }\n   }\n   while (FindNextFile(hFind, &amp;ffd) != 0);\n\n   dwError = GetLastError();\n   if (dwError != ERROR_NO_MORE_FILES) \n   {\n      DisplayErrorBox(TEXT(\"FindFirstFile\"));\n   }\n\n   FindClose(hFind);\n   return dwError;\n}\n\n\nvoid DisplayErrorBox(LPTSTR lpszFunction) \n{ \n    // Retrieve the system error message for the last-error code\n\n    LPVOID lpMsgBuf;\n    LPVOID lpDisplayBuf;\n    DWORD dw = GetLastError(); \n\n    FormatMessage(\n        FORMAT_MESSAGE_ALLOCATE_BUFFER | \n        FORMAT_MESSAGE_FROM_SYSTEM |\n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        dw,\n        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n        (LPTSTR) &amp;lpMsgBuf,\n        0, NULL );\n\n    // Display the error message and clean up\n\n    lpDisplayBuf = (LPVOID)LocalAlloc(LMEM_ZEROINIT, \n        (lstrlen((LPCTSTR)lpMsgBuf)+lstrlen((LPCTSTR)lpszFunction)+40)*sizeof(TCHAR)); \n    StringCchPrintf((LPTSTR)lpDisplayBuf, \n        LocalSize(lpDisplayBuf) / sizeof(TCHAR),\n        TEXT(\"%s failed with error %d: %s\"), \n        lpszFunction, dw, lpMsgBuf); \n    MessageBox(NULL, (LPCTSTR)lpDisplayBuf, TEXT(\"Error\"), MB_OK); \n\n    LocalFree(lpMsgBuf);\n    LocalFree(lpDisplayBuf);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10474571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oIi_2FnBxto/AAAAAAAAAAI/AAAAAAAAadQ/2Ofs3RAGRBg/photo.jpg?sz=128", "display_name": "id0 SI", "link": "https://stackoverflow.com/users/10474571/id0-si"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1559154479, "creation_date": 1559143139, "last_edit_date": 1559143742, "question_id": 56363831, "link": "https://stackoverflow.com/questions/56363831/how-can-i-list-all-files-in-a-directory-on-windows-without-using-dirent-h-in-c", "title": "How can I list all files in a directory on Windows without using dirent.h in C?", "body": "<p>I can't find any way to list all files without using <code>dirent.h</code>. Does anyone have an idea or suggestions?\nI can't work with <code>dirent.h</code> because my compiler doesn't work with it, so this is why I am searching for another option</p>\n\n<p>I run and write the program on Windows 10.</p>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 1306, "user_id": 8539533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/meFoo.jpg?s=128&g=1", "display_name": "khuynh", "link": "https://stackoverflow.com/users/8539533/khuynh"}, "edited": false, "score": 2, "creation_date": 1559142146, "post_id": 56363499, "comment_id": 99330258, "body": "Are you familiar with for loops in C? <a href=\"https://www.tutorialspoint.com/cprogramming/c_for_loop.htm\" rel=\"nofollow noreferrer\">This</a> would be a good start."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 2, "creation_date": 1559142404, "post_id": 56363499, "comment_id": 99330389, "body": "The  element at position <code>a[3][4]</code> has type <code>int</code> hence you can not &quot;associate&quot; two different integers to it except you use bit manipulation and store one value into the high word and the other one into the low word but then you might need fixed width integers. Anyways it is not really clear what you are asking have you tried anything yourself yet? What exactly do you mean with &quot;associate&quot; how is the value accessed later?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1559142494, "post_id": 56363499, "comment_id": 99330434, "body": "The expression <code>a[x][y]</code> associates <code>x</code> and <code>y</code> with the array element at row <code>x</code> and column <code>y</code>\u2014the C implementation does the address arithmetic for you. What more do you want?"}, {"owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "edited": false, "score": 1, "creation_date": 1559142655, "post_id": 56363499, "comment_id": 99330520, "body": "You can use x and y to index into the array, each pair will reference a value in the int grid. To run through all combinations you can use 2 nested for loops."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559143107, "post_id": 56363499, "comment_id": 99330779, "body": "I&#39;m not sure what you&#39;re asking here. Maybe you should explain what you are <i>actually</i>  trying to achieve. What should the content of the <code>a</code> array be??"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559144665, "post_id": 56363499, "comment_id": 99331673, "body": "Do you need an array of a structure type?  <code>struct not_very_sensible { int value; int x; int y; };</code> might work, but the idea isn&#39;t very sensible.  There is no obvious reason to store the position of the value in the structure holding the value.  Maybe there&#39;s an <a href=\"http://mywiki.wooledge.org/XyProblem\" rel=\"nofollow noreferrer\">XY Problem</a> lurking here; you&#39;re trying to do something but can&#39;t, so you&#39;ve thought of an alternative way of doing it but you&#39;re having problems with that too.  Maybe you should ask about the original problem \u2014 in a new question since this one has an answer, albeit one that probably isn&#39;t useful."}], "answers": [{"comments": [{"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 2, "creation_date": 1559143707, "post_id": 56363689, "comment_id": 99331125, "body": "You should typically write <code>for (x  =  0; x &lt; 8; x++)</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 11573707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b547a3967a82fe5a0e146ab2cd5d3d70?s=128&d=identicon&r=PG", "display_name": "hari", "link": "https://stackoverflow.com/users/11573707/hari"}, "is_accepted": false, "score": 0, "last_activity_date": 1559142808, "last_edit_date": 1559142808, "creation_date": 1559142644, "answer_id": 56363689, "question_id": 56363499, "link": "https://stackoverflow.com/questions/56363499/how-can-i-associate-two-variables-to-a-position-in-a-bi-dimensional-array-in-c/56363689#56363689", "title": "How can I &quot;associate&quot; two variables to a position in a bi-dimensional array in C?", "body": "<p>Use 2 loops, 1 nested in other</p>\n\n<pre><code>for (x = 0; x &lt;= 7; x++) {\n    for (y = 0; y &lt;= 7; y++) {\n        a[x][y] = something;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11573572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q3fBsZAvrR4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzIwjMEG3zYdFpsUMiWEHRkRVi1g/mo/photo.jpg?sz=128", "display_name": "Usurper", "link": "https://stackoverflow.com/users/11573572/usurper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559142902, "creation_date": 1559141934, "last_edit_date": 1559142902, "question_id": 56363499, "link": "https://stackoverflow.com/questions/56363499/how-can-i-associate-two-variables-to-a-position-in-a-bi-dimensional-array-in-c", "title": "How can I &quot;associate&quot; two variables to a position in a bi-dimensional array in C?", "body": "<p>I have a bi-dimensional array with 8 elements in each dimension and I have two variables (x, y) with values from 0 to 7 each. I need to \"associate\" each value of those variables to the array position. Im positive that I must use pointers for this but I just can't figure it out by myself.</p>\n\n<p>As an example, I have these two variables with 2 random values from 0 to 7.</p>\n\n<pre><code>int x = 3;\nint y= 4;\n\nint a [8][8]; \n</code></pre>\n\n<p>I need to assign the <code>x=3</code> and the <code>y=4</code> to the array as the element position:\n<code>a[3][4].</code></p>\n\n<p>I will need to do this for every case, meaning, from x=0 to x=7 and y=0 to y=7, all the array position elements must be associated with the possible x and y variables values. </p>\n"}, {"tags": ["c", "winapi", "platform", "windows-api-code-pack", "getenv"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1559141363, "post_id": 56363286, "comment_id": 99329845, "body": "Maybe try the wide string version: <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/getenv-s-wgetenv-s?view=vs-2019\" rel=\"nofollow noreferrer\">_wgetenv_s</a>."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559141922, "post_id": 56363286, "comment_id": 99330128, "body": "Windows doesn&#39;t use multibyte characters, you&#39;ll have to get your program&#39;s locale correct to get the proper conversion.  Type chcp at the command prompt and tell us what you see."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "edited": false, "score": 0, "creation_date": 1559151496, "post_id": 56363286, "comment_id": 99334962, "body": "While \u201cAPPDATA\u201d is doubtless a windows environment variable I like the platform agnosticism inherent in using \u2018getenv\u2019. This is ruined by using either the windows API or MS C extensions. The proper solution should be to setup the crt to use a utf8 encoding. I recall some dev on Twitter mentioning that UTF-8 was going to be a supported ACP in a windows 10 update but I never saw anything more official so I doubt this option is practically possible yet."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "edited": false, "score": 0, "creation_date": 1559152249, "post_id": 56363286, "comment_id": 99335233, "body": "Ah. It\u2019s the April 2018 Update that allowed UTF8 to be set as the system default locale and presumably c-runtime apps would inherit that. That\u2019s a bit annoying as it\u2019s tricky to convince users that changing system settings that may detrimentally effect other apps to support your app is a good idea. Would have been nice if utf8 as a default locale could be enabled via the app manifest or something. Oh well."}], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 2, "last_activity_date": 1559144040, "last_edit_date": 1559144040, "creation_date": 1559141903, "answer_id": 56363488, "question_id": 56363286, "link": "https://stackoverflow.com/questions/56363286/getenvappdata-returns-incorrect-values-if-current-user-having-username-conta/56363488#56363488", "title": "getenv(&quot;APPDATA&quot;) returns incorrect values if current user having username containing unicode characters", "body": "<p>Actually, <code>getenv</code> is not a Windows API function. That function is provided by the C runtime. If you wish to continue with a C runtime function, then rather than using <code>getenv</code>, you should use the Unicode version, <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/getenv-wgetenv?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_wgetenv</code></a>.</p>\n\n<p>The Windows API function, which <code>getenv</code> and <code>_wgetenv</code> wrap, is <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getenvironmentvariable\" rel=\"nofollow noreferrer\"><code>GetEnvironmentVariable</code></a>. You could equally use that function, but you must make sure that you target Unicode when building, or call the Unicode version <code>GetEnvironmentVariableW</code> explicitly.</p>\n\n<p>That answers the direct question that you asked. However, it is also worth pointing out that reading the <code>APPDATA</code> variable is not the correct way to obtain that information. You should instead call <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath\" rel=\"nofollow noreferrer\"><code>SHGetKnownFolderPath</code></a> passing <code>FOLDERID_RoamingAppData</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1559143481, "creation_date": 1559143481, "answer_id": 56363928, "question_id": 56363286, "link": "https://stackoverflow.com/questions/56363286/getenvappdata-returns-incorrect-values-if-current-user-having-username-conta/56363928#56363928", "title": "getenv(&quot;APPDATA&quot;) returns incorrect values if current user having username containing unicode characters", "body": "<blockquote>\n  <p>Is there any alternative to getenv in windows?</p>\n</blockquote>\n\n<p>The most accurate way to get a user's <code>APPDATA</code> folder is to ask the OS directly, not query the environment of the calling process at all.</p>\n\n<p>You can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpathw\" rel=\"nofollow noreferrer\"><code>SHGetFolderPathW()</code></a> with <code>CSIDL_(LOCAL_)APPDATA</code>. </p>\n\n<p>On Vista and later, you can (and should) alternatively use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath\" rel=\"nofollow noreferrer\"><code>SHGetKnownFolderPath()</code></a> with <code>FOLDERID_(Roaming|Local)AppData</code>. </p>\n"}], "owner": {"reputation": 11, "user_id": 8836926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0074324b5af86cc261328597d6a6db7?s=128&d=identicon&r=PG", "display_name": "user7234", "link": "https://stackoverflow.com/users/8836926/user7234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559144040, "creation_date": 1559141234, "last_edit_date": 1559143507, "question_id": 56363286, "link": "https://stackoverflow.com/questions/56363286/getenvappdata-returns-incorrect-values-if-current-user-having-username-conta", "title": "getenv(&quot;APPDATA&quot;) returns incorrect values if current user having username containing unicode characters", "body": "<p>Windows gives an api to get environment variable values using getenv(). If current user is having username containing localised characters (i.e. multibyte characters), then getenv returns incorrect value.</p>\n\n<p>current user with username: <code>\u30c6\u30b9\u30c8</code> :\n<code>getenv(\"AppData\")</code> returns <code>C:\\Users\\???\\AppData\\Roaming</code></p>\n\n<p>It should return <code>C:\\Users\\\u30c6\u30b9\u30c8\\AppData\\Roaming</code></p>\n\n<p>Is there any alternative to <code>getenv</code> in Windows?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559139996, "post_id": 56362877, "comment_id": 99329016, "body": "What is <code>word[i]</code>? What is the format <code>&quot;%s&quot;</code> supposed to print? Which format is used to print single characters?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1559140042, "post_id": 56362877, "comment_id": 99329048, "body": "<code>printf(&quot;%s&quot;, word[i]);</code> -&gt; <code>putchar(word[i]);</code>"}, {"owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559140144, "post_id": 56362877, "comment_id": 99329113, "body": "@Someprogrammerdude word[i] is supposed to hold the string inputted by a user, and %s is the format specifier for a string"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559140148, "post_id": 56362877, "comment_id": 99329115, "body": "<code>word[i]</code> is a single <code>char</code>.   The <code>%s</code> format tells <code>printf()</code> that it is printing a string (a set of <code>char</code>s, not a single <code>char</code>).   That difference causes undefined behaviour."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559140258, "post_id": 56362877, "comment_id": 99329173, "body": "There should be a compiler warning emitted"}, {"owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1559140331, "post_id": 56362877, "comment_id": 99329231, "body": "@PSkocik that worked but I don&#39;t understand how? I thought &#39;putchar&#39; and &#39;scanf&#39; had the same functions."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559140340, "post_id": 56362877, "comment_id": 99329237, "body": "@AnttiHaapala - A compiler warning is not required.   Some compilers do it (quality of implementation, as an aid for the programmer) but they are not actually required to do so."}, {"owner": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "edited": false, "score": 2, "creation_date": 1559140381, "post_id": 56362877, "comment_id": 99329261, "body": "Just change <code>printf(&quot;%s&quot;, word[i]);</code> to <code>printf(&quot;%c&quot;, word[i]);</code>. You are printing characters, not strings"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559140405, "post_id": 56362877, "comment_id": 99329276, "body": "<code>word</code> contains a null-terminated byte string. <code>word[i]</code> is a single character (one <code>char</code>) from that string."}], "answers": [{"comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1559140508, "post_id": 56362987, "comment_id": 99329349, "body": "When looping in reverse, with a condition of <code>i &gt;= 0</code> it is necessary to use a <code>signed</code> typr (e.g. <code>int</code>).   With an <code>unsigned</code> type (like <code>size_t</code>) the condition is always true, and the loop never ends (and gives undefined behaviour)."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559140584, "post_id": 56362987, "comment_id": 99329394, "body": "@Peter you are right, I edited my answer to change the loop"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1559146918, "post_id": 56362987, "comment_id": 99332853, "body": "Why not use putchar() instead of printf()?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 1, "creation_date": 1559147100, "post_id": 56362987, "comment_id": 99332962, "body": "@BjornA. I reused the <i>printf</i> to indicate the change to the OP even to use a <i>printf</i> is very expensive for nothing to write only one character, so I do not use <i>printf</i> again for the newline :-) WHat do you mean about &quot;doesn&#39;t handle empty strings well&quot; ? I manage them well .. I mean as I want"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1559152544, "post_id": 56362987, "comment_id": 99335355, "body": "@BjornA. you edited your remark (after I answer to all of it) but you did not undo your DV supposing it was you, why ?"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1559500335, "post_id": 56362987, "comment_id": 99431424, "body": "@bruno I just had a &quot;senior moment&quot; with that brief loop-comment. All my bad. I didn&#39;t downvote anything, btw. I upvoted your comment. That was me."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1559500729, "post_id": 56362987, "comment_id": 99431516, "body": "@BjornA. ah ok, thank you for answering and sorry for my wrong supposition :-)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1559140973, "last_edit_date": 1559140973, "creation_date": 1559140285, "answer_id": 56362987, "question_id": 56362877, "link": "https://stackoverflow.com/questions/56362877/reversing-string-in-c-using-for-loop/56362987#56362987", "title": "Reversing string in C using for loop", "body": "<p>In</p>\n\n<blockquote>\n<pre><code>printf(\"%s\", word[i]);\n</code></pre>\n</blockquote>\n\n<p>%s is a wrong format because you write a character, not a string</p>\n\n<p>Out of that :</p>\n\n<ul>\n<li><p>the natural type for an index is <code>size_t</code>not <em>int</em>, use <code>size_t</code>for both <em>i</em> and <em>len</em>, and in that case change the loop to use index without supposing it can be negative</p></li>\n<li><p>if the input string has more than 19 characters <em>scanf</em> will write out of <em>word</em> with an undefined behavior, limit the size using the format %19s (19 rather than 20 to have the place for the ending null character)</p></li>\n<li><p><em>word</em> is an array, do not use a '&amp;' to give its address in <em>scanf</em></p></li>\n<li><p>check the result of <em>scanf</em> if you want to detect EOF</p></li>\n<li><p>flush the output writing a newline after the loop</p></li>\n</ul>\n\n<p>So a possible way is :</p>\n\n<pre><code>char word[20];\n\nprintf(\"Enter word: \");\nif (scanf(\"%19s\", word) == 1) {   \n  printf(\"String reversed: \"); \n\n  for (size_t i = strlen(word); i != 0; i--){\n    printf(\"%c\", word[i-1]);\n  }\n  putchar('\\n');\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56362987, "answer_count": 1, "score": -1, "last_activity_date": 1559140973, "creation_date": 1559139944, "question_id": 56362877, "link": "https://stackoverflow.com/questions/56362877/reversing-string-in-c-using-for-loop", "title": "Reversing string in C using for loop", "body": "<p>I'm a beginner in C and I don't understand why my code isn't working. The aim is simply just to reverse a string.</p>\n\n<pre><code>char word[20];\nint i, len;\n\nprintf(\"Enter word: \");\n    scanf(\"%s\", &amp;word);\n\nlen = strlen(word);\n\nprintf(\"String reversed: \"); \nfor (i = len-1; i &gt;= 0; i--){\n    printf(\"%s\", word[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "game-physics"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1559139230, "post_id": 56362266, "comment_id": 99328607, "body": "When <code>i</code> or <code>j</code> is 4, <code>i++</code> and <code>j++</code> will make them 5 respectively. You then would pass <code>map[5][j]</code> or <code>map[i][5]</code> respectively to the function. This would invoke Undefined Behavior as you access out of bounds of the array"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1559139286, "post_id": 56362266, "comment_id": 99328630, "body": "<code>while(game_running = true)</code> is always <code>true</code>. You probably want <code>while(game_running == true)</code>"}, {"owner": {"reputation": 1, "user_id": 11568970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26155ce8ca02d3f01bf4cc8c9a89087b?s=128&d=identicon&r=PG&f=1", "display_name": "Octin", "link": "https://stackoverflow.com/users/11568970/octin"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1559139503, "post_id": 56362266, "comment_id": 99328737, "body": "@Spikatrix Thanks, i know how to fix that, but the movement is really odd, it skips positions on a weird way. And thats the main issue, I can&#39;t figure out why."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559349208, "post_id": 56362266, "comment_id": 99404297, "body": "You should reduce the repetition in your code.  You have the three lines <code>system(&quot;cls&quot;);             mUpdate(map[i][j]);             mRefresh(map[i][j]);</code> repeated 4 times; you should have it just once, at the end of the loop (maybe after detecting an erroneous or irrelevant key stroke in an <code>else</code> clause, which might use <code>continue;</code> to skip the three lines)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559349358, "post_id": 56362266, "comment_id": 99404306, "body": "I think a major part of your problem is that you do not validate that <code>i</code> and <code>j</code> are within bounds of the array.  And eventually, you go trampling outside the array, and who knows what happens then.  At the very least, you could start by printing the <code>i</code> and <code>j</code> values so you know where the user is.  The name of the function <code>mUpdate()</code> is a little misleading; it is more like <code>mDisplay()</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1559358825, "post_id": 56362266, "comment_id": 99405306, "body": "Your biggest problem is you are attempting to use the <code>GetAsyncKeyState</code> function which is designed to be called after the current window receives a <code>WM_KEYDOWN</code> or <code>WM_KEYUP</code> event in a console application within a loop that is spinning wildly out of control. You are further using it incorrectly because it will return true for multiple events (when the key is down, and if the key was down since the last time a call to the function was made). So run in an endless-loop, it likely fires <b>many times for every single keypress</b>."}], "owner": {"reputation": 1, "user_id": 11568970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26155ce8ca02d3f01bf4cc8c9a89087b?s=128&d=identicon&r=PG&f=1", "display_name": "Octin", "link": "https://stackoverflow.com/users/11568970/octin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559348795, "creation_date": 1559138056, "last_edit_date": 1559348795, "question_id": 56362266, "link": "https://stackoverflow.com/questions/56362266/movement-issues-skipping-fields", "title": "Movement issues, skipping fields", "body": "<p>I'm making a game, where you (the player) are represented by a number in a 2D matrix. The problem is that when I move the player, it skips fields, and does not respond very well. The movement is very inaccurate. If you could run the program, you could get a better understanding of the issue. How can I fix this problem? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;time.h&gt;\n\nvoid delay(unsigned int mseconds)\n{\n    clock_t goal = mseconds + clock();\n    while (goal &gt; clock())\n        ;\n}\n\nint map[5][5] = {{0, 0, 0, 0, 0},\n                 {0, 0, 0, 0, 0},\n                 {0, 0, 0, 0, 0},\n                 {0, 0, 0, 0, 0},\n                 {0, 0, 0, 0, 0}};\n\nint mUpdate(int x)\n{\n    int i, j;\n    for (i = 0; i &lt; 5; i++)\n    {\n        for (j = 0; j &lt; 5; j++)\n        {\n            printf(\"%d     \", map[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nint mRefresh(int x)\n{\n    int i, j;\n    for (i = 0; i &lt; 5; i++)\n    {\n        for (j = 0; j &lt; 5; j++)\n        {\n            if (map[i][j] &gt; 0)\n            {\n                map[i][j] = 0;\n            }\n        }\n    }\n}\n\nint main()\n{\n    int c;\n    int i, j;\n    int p_num;\n    printf(\"Hey! Choose a number from 1-9 that will represent you!: \");\n    scanf(\"%d\", &amp;p_num);\n    printf(\"Choose a starting position by inputting two coordinates from 1-4!:  \");\n    scanf(\"%d %d\", &amp;i, &amp;j);\n    printf(\"\\nVery well, this is your starting position!\\n\");\n    map[i][j] = p_num;\n    mUpdate(map[i][j]);\n    printf(\"\\nYou are now the number %d !\\n\", p_num);\n    printf(\"\\nPlease wait for the map to load!\");\n    printf(\"\\nMap loading will start soon!\");\n    delay(3000);\n    for (c = 0; c &lt; 5; c++)\n    {\n        printf(\"\\nLoading.\");\n        delay(500);\n        system(\"cls\");\n        printf(\"\\nLoading..\");\n        delay(500);\n        system(\"cls\");\n        printf(\"\\nLoading...\");\n        delay(500);\n        system(\"cls\");\n    }\n    printf(\"Map loaded!\\n\");\n    printf(\"\\nUse arrow keys to move thru the matrix!\\n\");\n    mUpdate(map[i][j]);\n\n    int game_running = true;\n    while (game_running = true)\n    {\n        if (GetAsyncKeyState(VK_DOWN))\n        {\n            // delay(200);\n            map[i++][j] = p_num;\n            system(\"cls\");\n            mUpdate(map[i][j]);\n            mRefresh(map[i][j]);\n        }\n        else if (GetAsyncKeyState(VK_UP))\n        {\n            // delay(200);\n            map[i--][j] = p_num;\n            system(\"cls\");\n            mUpdate(map[i][j]);\n            mRefresh(map[i][j]);\n        }\n        else if (GetAsyncKeyState(VK_RIGHT))\n        {\n            // delay(1000);\n            map[i][j++] = p_num;\n            system(\"cls\");\n            mUpdate(map[i][j]);\n            mRefresh(map[i][j]);\n        }\n        else if (GetAsyncKeyState(VK_LEFT))\n        {\n            // delay(200);\n            map[i][j--] = p_num;\n            system(\"cls\");\n            mUpdate(map[i][j]);\n            mRefresh(map[i][j]);\n        }\n    }\n    system(\"cls\");\n}\n</code></pre>\n"}, {"tags": ["c", "hash", "segmentation-fault"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559137782, "post_id": 56362114, "comment_id": 99327661, "body": "Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including type definitions."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1559137797, "post_id": 56362114, "comment_id": 99327671, "body": "Hi, welcome to Stack Overflow. The defintiion of <code>HTHash</code> seems to be missing from your code. Please <a href=\"https://stackoverflow.com/posts/56362114/edit\">edit</a> it into the question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559138059, "post_id": 56362114, "comment_id": 99327857, "body": "In C you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">should not cast <code>malloc</code></a>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1559138151, "post_id": 56362114, "comment_id": 99327917, "body": "<code>HTCreate</code> is returning a pointer to a local variable <code>table</code>."}, {"owner": {"reputation": 13, "user_id": 11573095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2186537638130557/picture?type=large", "display_name": "\u03a0\u03b1\u03bd\u03b1\u03b3\u03b9\u03ce\u03c4\u03b7\u03c2 \u0393\u03ba\u03af\u03ba\u03b1\u03c2", "link": "https://stackoverflow.com/users/11573095/%ce%a0%ce%b1%ce%bd%ce%b1%ce%b3%ce%b9%cf%8e%cf%84%ce%b7%cf%82-%ce%93%ce%ba%ce%af%ce%ba%ce%b1%cf%82"}, "edited": false, "score": 0, "creation_date": 1559138764, "post_id": 56362114, "comment_id": 99328307, "body": "Sorry guys for forgetting the types.It&#39;s all editted now.Thanks"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559138876, "post_id": 56362114, "comment_id": 99328383, "body": "What is the use of returning <code>HTHash*</code> from <code>HTCreate</code>, instead of plain <code>HTHash</code>?"}, {"owner": {"reputation": 13, "user_id": 11573095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2186537638130557/picture?type=large", "display_name": "\u03a0\u03b1\u03bd\u03b1\u03b3\u03b9\u03ce\u03c4\u03b7\u03c2 \u0393\u03ba\u03af\u03ba\u03b1\u03c2", "link": "https://stackoverflow.com/users/11573095/%ce%a0%ce%b1%ce%bd%ce%b1%ce%b3%ce%b9%cf%8e%cf%84%ce%b7%cf%82-%ce%93%ce%ba%ce%af%ce%ba%ce%b1%cf%82"}, "edited": false, "score": 0, "creation_date": 1559139588, "post_id": 56362114, "comment_id": 99328776, "body": "It seems there is no point.I remember doing that and giving me an error of trying to return an array but I guess i had made other mistakes.It seems to be working now.Thanks for the help"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559140894, "post_id": 56362114, "comment_id": 99329573, "body": "BTW the origin of your problem is the fact that you&#39;re hiding pointer types behind <code>typedef</code>s. Don&#39;t do this, it only adds confusion."}, {"owner": {"reputation": 13, "user_id": 11573095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2186537638130557/picture?type=large", "display_name": "\u03a0\u03b1\u03bd\u03b1\u03b3\u03b9\u03ce\u03c4\u03b7\u03c2 \u0393\u03ba\u03af\u03ba\u03b1\u03c2", "link": "https://stackoverflow.com/users/11573095/%ce%a0%ce%b1%ce%bd%ce%b1%ce%b3%ce%b9%cf%8e%cf%84%ce%b7%cf%82-%ce%93%ce%ba%ce%af%ce%ba%ce%b1%cf%82"}, "edited": false, "score": 0, "creation_date": 1559141342, "post_id": 56362114, "comment_id": 99329833, "body": "Its true but those are my project rules unfortunately"}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 1, "last_activity_date": 1559197870, "last_edit_date": 1559197870, "creation_date": 1559139769, "answer_id": 56362820, "question_id": 56362114, "link": "https://stackoverflow.com/questions/56362114/invalid-read-of-size-8-at-by/56362820#56362820", "title": "Invalid read of size 8 at .. by", "body": "<p>Your problem is effectivelly in <code>HTCreate</code> function: it returns <code>&amp;table</code> which is local to the function.</p>\n\n<p>Demo:</p>\n\n<pre><code>HTHash *HTCreate(void)\n{\n    int i;\n\n    HTHash table = NULL;\n\n    printf(\"&amp;table before malloc: %p\\n\", &amp;table);\n\n    table = malloc(TABLESIZE*sizeof(TableEntry));\n\n    printf(\"&amp;table after  malloc: %p\\n\", &amp;table);\n\n    HTHash *T;\n\n    for(i=0;i&lt;TABLESIZE;i++)\n        table[i].head = NULL;\n\n    T = &amp;table;\n    return T;\n}\n</code></pre>\n\n<p>Will print:    </p>\n\n<pre><code>&amp;table before malloc: 0x7fff200eb818\n&amp;table after  malloc: 0x7fff200eb818\n</code></pre>\n\n<p>We see that <code>malloc</code> is without effect on this value.</p>\n\n<p>Since this is local to the function, using this in another function can cause anything (undefined behavior)</p>\n\n<p>The good way to return what you need from the function is to return a <code>HTHash</code> type:</p>\n\n<pre><code>HTHash HTCreate(void)\n{\n    int i;\n\n    HTHash table = malloc(TABLESIZE*sizeof(TableEntry));\n\n    for(i=0;i&lt;TABLESIZE;i++)\n        table[i].head = NULL;\n\n    return table;\n}\n</code></pre>\n\n<hr>\n\n<p>Looking what is done in it, I saw that this function can be simplified :</p>\n\n<pre><code>HTHash HTCreate(void)\n{\n    return calloc(TABLESIZE, sizeof(TableEntry));\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11573095, "user_type": "registered", "profile_image": "https://graph.facebook.com/2186537638130557/picture?type=large", "display_name": "\u03a0\u03b1\u03bd\u03b1\u03b3\u03b9\u03ce\u03c4\u03b7\u03c2 \u0393\u03ba\u03af\u03ba\u03b1\u03c2", "link": "https://stackoverflow.com/users/11573095/%ce%a0%ce%b1%ce%bd%ce%b1%ce%b3%ce%b9%cf%8e%cf%84%ce%b7%cf%82-%ce%93%ce%ba%ce%af%ce%ba%ce%b1%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56362820, "answer_count": 1, "score": 1, "last_activity_date": 1559197870, "creation_date": 1559137626, "last_edit_date": 1559138909, "question_id": 56362114, "link": "https://stackoverflow.com/questions/56362114/invalid-read-of-size-8-at-by", "title": "Invalid read of size 8 at .. by", "body": "<p>it shows invalid read of size 8 at HTSize by my main function and it seems to work(it prints  0) for an empty hash but what I believe is the issue is that the initialized hash in my HTCreate is passed as an argument in HTSize but unitialized.</p>\n\n<p>I've tried(not in the code that is shown) passing the argument as &amp;Table with the definition HTSize(HThash**) but instead of solving it the programm doesn't run and valgrind shows \"Address 0x0 is not stack'd, malloc'd or (recently) free'd\" as well. Inside the function I also put a pointer T to the hash to dereference the **hash.I work in linux.</p>\n\n<pre><code>typedef char* KeyType;\ntypedef int HTItem;\ntypedef struct node{\n    KeyType key;\n    HTItem item;\n    struct node *next;\n}List;\ntypedef struct {\n    List *head;\n}TableEntry;\ntypedef TableEntry *HTHash;\n\nHTHash* HTCreate(void);\nint HTSize(HTHash);\n\nint TABLESIZE = 10;\n\nint main(void)\n{\n    HTItem *p;\n    HTHash *Table = HTCreate();\n    printf(\"%d\\n\",HTSize(*Table));\n}\n\nHTHash* HTCreate(void)\n{\n    int i;\n    HTHash table = (HTHash)malloc(TABLESIZE*sizeof(TableEntry));\n    HTHash *T;\n    for(i=0;i&lt;TABLESIZE;i++)\n        table[i].head = NULL;\n    T = &amp;table;\n    return T;\n}\n\nint HTSize(HTHash hash)\n{\n    int i,count=0;\n    List *temp = (List*)malloc(sizeof(List));   \n    for(i=0;i&lt;TABLESIZE;i++)\n    {\n        if(hash[i].head != NULL)\n        {\n            count++;\n            temp = hash[i].head-&gt;next;\n            while(temp != NULL)\n            {\n                count++;\n                temp = temp-&gt;next;\n            }\n        }   \n    }\n    return count;   \n}\n</code></pre>\n\n<p>The mistake may be in HTCreate but Im'not sure.I checked if the hash gets initialized in the main function and it does.</p>\n"}, {"tags": ["c", "struct", "malloc", "void-pointers"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559136861, "post_id": 56361793, "comment_id": 99327085, "body": "And what does the compiler say when you run the program"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559136880, "post_id": 56361793, "comment_id": 99327097, "body": "Turn on compiler warnings and read them."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559136909, "post_id": 56361793, "comment_id": 99327111, "body": "Also it all depends a lot about what these <code>void *</code> pointers should <i>actually be typed as</i>."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1559137000, "post_id": 56361793, "comment_id": 99327166, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1559137273, "last_edit_date": 1559137273, "creation_date": 1559136839, "answer_id": 56361867, "question_id": 56361793, "link": "https://stackoverflow.com/questions/56361793/how-to-get-a-string-from-a-function-which-has-a-void-pointer/56361867#56361867", "title": "How to get a string from a function which has a void pointer?", "body": "<p>One problem is that first <code>*</code> in <code>*(char*)inspect_arr(...)</code>.</p>\n\n<p>There you dereference the pointer, getting only the first character. It's equivalent to <code>((char*)inspect_arr(...))[0]</code>.</p>\n\n<p>To make it more troublesome, you then assign this single character to the <em>pointer</em> <code>k</code>. This doesn't make <code>k</code> point to the character, it make <code>k</code> point to whatever address corresponds to that characters encoded value. With e.g. ASCII and the character <code>'d'</code> the initialization is equivalent to</p>\n\n<pre><code>char *k = 100;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11363034, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YxGVi4yjnuo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8BA8E0AlTOU0rDBSg5D40uwD9aQ/mo/photo.jpg?sz=128", "display_name": "Stefan Andersson", "link": "https://stackoverflow.com/users/11363034/stefan-andersson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559145074, "creation_date": 1559136553, "last_edit_date": 1559145074, "question_id": 56361793, "link": "https://stackoverflow.com/questions/56361793/how-to-get-a-string-from-a-function-which-has-a-void-pointer", "title": "How to get a string from a function which has a void pointer?", "body": "<p>When I try to get a string from a function which has type <code>void*</code>, I only get the first character.</p>\n\n<p>I tried to copy string manually without using <code>strcpy()</code> it gives me same problem</p>\n\n<pre><code>struct arr {\n   int first\n   int last.\n   void **val; \n};\n\n//I have a function which is called \nvoid *inspect_arr(const arr *ar, int position)\n{\n   ....\n   return ar-&gt;val[offset];\n}\n//I want to inspect the array so that I can compare the strings\nint main()\n{\n   char *str = calloc(10,sizeof(char));\n   char *k = *(char*)inspect_arr(...) //I have a string in the array\n  // strcpy(str,k);       Doesn't work\n   strcmp(str,k);         Invalid read from valgrind\n   //If array has an integer type then I would write my code like this:\n   //int a = *(int*)inspect_arr(...) but I can not do the same thing for char\n}\n</code></pre>\n\n<p>I get Segmentation fault when I run the program. </p>\n"}, {"tags": ["c", "nested-function"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1559136077, "post_id": 56361597, "comment_id": 99326563, "body": "No. And I don&#39;t see what can be done with nested functions which cannot be done without. C is imperative language and is quite different from functional ones. Yet I find the knowledge of functional programming to be a significant help in understanding concepts such as recursion and functional purity, which can enhance the C skill and not weaken it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559136106, "post_id": 56361597, "comment_id": 99326589, "body": "If you want to have closures, then you will need some kind of non-linear stack structure.  But you can probably achieve something similar by providing some storage to hold the state that you need.  You&#39;d simply have to manage that storage yourself."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559136321, "post_id": 56361597, "comment_id": 99326731, "body": "Since it is an extension, you cannot do this so that it compiles on all compilers."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1559136361, "post_id": 56361597, "comment_id": 99326757, "body": "ANSI C (which was renamed to ISO C in 1990) does not support nested functions or closures.   So if you use the gcc extension, your code will not work with other compilers."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559136504, "post_id": 56361597, "comment_id": 99326856, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4393716/is-there-a-a-way-to-achieve-closures-in-c\">Is there a a way to achieve closures in C</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559136678, "post_id": 56361597, "comment_id": 99326983, "body": "You could probably clarify your intention by showing some example code using nested functions"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1559136949, "post_id": 56361597, "comment_id": 99327133, "body": "Anyway, C is a rather low level language. From the very beginning of K&amp;R C in the 70&#39;, it was intended to be compiler friendly, not to save some typing for the programmers. You will have to turn to C++ if you want some more goodies..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1559137063, "post_id": 56361597, "comment_id": 99327202, "body": "The GCC nested functions are not proper closures, they can only refer to their environment while it is alive!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559137154, "post_id": 56361597, "comment_id": 99327261, "body": "I afraid your proposed code won&#39;t work for the reason @AnttiHaapala stated above..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559137245, "post_id": 56361597, "comment_id": 99327316, "body": "The block approach could work, you&#39;d just need to find a way to desugar it :D"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1559137374, "post_id": 56361597, "comment_id": 99327390, "body": "This could be of interest: <a href=\"https://techtalk.intersec.com/2014/11/blocks-rewriting-with-clang/\" rel=\"nofollow noreferrer\">techtalk.intersec.com/2014/11/blocks-rewriting-with-clang</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559137710, "post_id": 56361597, "comment_id": 99327609, "body": "The only difference between your example 1) and 2) is that 1) is readable and reasonably type safe, while 2) is unreadable and dangerous. Why would you want the latter? This kind of meta programming reasoning only leads to rotten code."}, {"owner": {"reputation": 227, "user_id": 5884014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c0842d9f44e3b810130a2a75054805?s=128&d=identicon&r=PG", "display_name": "Uraty", "link": "https://stackoverflow.com/users/5884014/uraty"}, "edited": false, "score": 0, "creation_date": 1559138031, "post_id": 56361597, "comment_id": 99327845, "body": "Example 1) is readable when we have just one argument in callback and calling function that has only callback as argument. When args number increases, readability dramatically decreases."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559138102, "post_id": 56361597, "comment_id": 99327883, "body": "No it doesn&#39;t, you are simply not used to it. This is all wildly subjective options. Besides, the reasoning that the callback belongs to main() is flawed from an OOD point of view. The callback should be allocated together with all other &quot;connection-related&quot; behavior. It shouldn&#39;t be in the caller."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1559138381, "post_id": 56361597, "comment_id": 99328060, "body": "If what you&#39;re worried about is readability of the function pointer, it&#39;s highly recommended to use a typedef for the function pointer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559141896, "post_id": 56361597, "comment_id": 99330116, "body": "Using C results in boilerplate code, you cannot do much about it. You have proposed another language based on C which has closures, and you want a compiler for it. Good luck. There is a mainstream C based language with closures. It is called C++. People generally use C++ rather than half-baked homebrew solutions. Perhaps you want to give it a try. If you want a C++ compiler that produces C code as an intermediate representation, there is such a thing too."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559138400, "post_id": 56362233, "comment_id": 99328077, "body": "Yes of course, good answer. This is not only common C praxis, it is much better program design than some localized &quot;closure&quot; meta programming that only serves to create tight coupling between an object and some unrelated caller."}], "tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": true, "score": 3, "last_activity_date": 1559141600, "last_edit_date": 1559141600, "creation_date": 1559137957, "answer_id": 56362233, "question_id": 56361597, "link": "https://stackoverflow.com/questions/56361597/can-i-somehow-use-nested-functions-in-ansi-c/56362233#56362233", "title": "Can I somehow use nested functions in ANSI C?", "body": "<p>For the specific example you have asked about there is an approach with C that achieves something similar to a closure in that it packages a function pointer with the data needed to be used with the function.</p>\n\n<pre><code>typedef struct {\n    char sBuff[128];              // data for the function to use\n    void (* func) (char* error);  // pointer to function to execute\n} ErrorMsg;\n\nvoid connect(ErrorMsg myMsg) {\n    ...\n    myMsg.func(myMsg.sBuff);  // call the function with the packaged data\n}\n\n// the function that we will be encapsulating with the data to be\n// used.\nvoid print_error(char* error) {\n    printf(error);\n}\n\nvoid main() {\n    ErrorMsg msg = {\"Failed connection\", print_error} ;\n    \u2026\n    connect(msg);  // invoke our function package and its data.\n}\n</code></pre>\n\n<p>And if at the time that the function package is used, you would like to add additional data, you could do so along the lines of the following.</p>\n\n<pre><code>typedef struct {\n    char sBuff[128];              // packaged data for the function to use\n    void (* func) (char* error, int iExtra);  // pointer to function to execute\n} ErrorMsg;\n\nvoid connect(ErrorMsg myMsg) {\n    ...\n    myMsg.func(myMsg.sBuff, errno);  // call the function with the packaged data and extra info\n}\n\n// the function that we will be encapsulating with the data to be\n// used.\nvoid print_error(char* error, int iExtra) {\n    printf(error, iExtra);\n}\n\nvoid main() {\n    ErrorMsg msg = {\"Failed connection: errno %d\", print_error} ;\n    \u2026\n    connect(msg);  // invoke our function package and its data.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1559139685, "creation_date": 1559139685, "answer_id": 56362791, "question_id": 56361597, "link": "https://stackoverflow.com/questions/56361597/can-i-somehow-use-nested-functions-in-ansi-c/56362791#56362791", "title": "Can I somehow use nested functions in ANSI C?", "body": "<blockquote>\n  <p>Does any existing solution present?</p>\n</blockquote>\n\n<p>It depends on what you mean.  Standard C does not provide closures, nested functions, or lambdas / blocks as language features.  But there is nothing you can do in some other language that has any or all of these that you cannot do in C without.  In fact, some languages that <em>do</em> have these features are themselves implemented in C.</p>\n\n<p>In particular, your first example is approximately the normal C idiom for generic callbacks.  The callback function accepts a pointer to an object containing any data it needs, and the callback-registration interface accepts a pointer to the appropriate object together with a pointer to the function.  When the callback is triggered, the registered data pointer is passed to it.</p>\n\n<p>Note, by the way, that this is a more general facility than closures alone afford, because the data on which the callback will operate do not need to be in scope where the function is defined.  Among other things, this permits standard, reusable callback implementations to be provided, where the association with specific data is made only at the point of callback registration.  In the event that multiple callbacks can be simultaneously associated with the same event, it also allows the same callback to be reused, with different data, for the same event.</p>\n"}], "owner": {"reputation": 227, "user_id": 5884014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c0842d9f44e3b810130a2a75054805?s=128&d=identicon&r=PG", "display_name": "Uraty", "link": "https://stackoverflow.com/users/5884014/uraty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 56362233, "answer_count": 2, "score": 1, "last_activity_date": 1559141600, "creation_date": 1559135919, "last_edit_date": 1559137083, "question_id": 56361597, "link": "https://stackoverflow.com/questions/56361597/can-i-somehow-use-nested-functions-in-ansi-c", "title": "Can I somehow use nested functions in ANSI C?", "body": "<p>I have background with high level languages, such as Java/Kotlin/Scala. Now I need to create a C library, but it's pretty hard for me to work without closures. </p>\n\n<p>There is the nice extension in GCC, called \"nested functions\", that (if I correctly understood) is exactly what I need. Also the Apple \"blocks\" extension looks interesting. But I need a code, that will work with any compiler.</p>\n\n<p>Does any existing solution present? I've seen some projects, that allow generating C code: <a href=\"https://github.com/dbohdan/compilers-targeting-c\" rel=\"nofollow noreferrer\">https://github.com/dbohdan/compilers-targeting-c</a>. But I really don't need another language, just one feature - closures. (I think that it hard to maintain completely different language and result C code will be not optimized).</p>\n\n<p><strong>UPD</strong>\nSome explanation, why do I need closures.</p>\n\n<p>Let say we have some function, <code>connect(void (*on_failed_callback)());</code>. It manages a connection in some way, and when the connection is lost, it calls the callback. And it takes 0 arguments, but I want to create some function that will bring some data with callback. If I've correctly understood, the most common used solution is to pass the callback with some arg <code>connect(void (*on_failed_callback)(void *callback_arg), void* arg);</code>. But it leads to a boilerplate code, that can be fixed by nested functions.</p>\n\n<p>So next code:</p>\n\n<pre><code>void connect(void (*on_failed_callback)(void* arg), void* arg) {\n    ...\n    on_failed_callback(arg);\n}\n\nvoid print_error(char* error) {\n    printf(error);\n}\n\nvoid main() {\n    char *msg = \"Failed connection\";\n    ...\n    connect(print_error, msg);\n}\n</code></pre>\n\n<p>Can be simplified to next:</p>\n\n<pre><code>void connect(void (*on_failed_callback)()) {\n    ...\n    on_failed_callback();\n}\n\nvoid print_error(char* error) {\n    printf(error);\n}\n\nvoid main() {\n    char* msg = \"Failed connection\";\n    ...\n    void callback() {\n       print_error(msg);\n    }\n    connect(callback);\n}\n</code></pre>\n\n<p>I mean, I want some tool/app, that analyzes my code with closures/nested functions and generates pure ANSI C code.</p>\n"}, {"tags": ["c++", "c", "arm", "interrupt-handling", "cortex-m"], "answers": [{"comments": [{"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 1, "creation_date": 1559137917, "post_id": 56362016, "comment_id": 99327763, "body": "May I summarize your answer to: no it is not possible due to the requirement to use the C calling convention?  If so that raises another question, why are we bound to this convention?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 1, "creation_date": 1559138048, "post_id": 56362016, "comment_id": 99327852, "body": "@Bart: Hard to summarize because you had multiple questions.  Your first one &quot;Is it possible to write an interrupt handler in C++ for ARM Cortex chips?&quot; the answer is Yes.  For &quot;Is there a way to not having to forward through the C function?&quot; also Yes.  For &quot;Is there a way to directly call a C++ object function when a interrupt occurs?&quot; No.  There are multiple things that &quot;C++ object function&quot; could mean and none of them are usable as interrupt handlers."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559138226, "post_id": 56362016, "comment_id": 99327964, "body": "@Bart: And as for why you are bound to this convention, it&#39;s because it is baked into the hardware.  The processor doesn&#39;t know about <code>this</code> pointers or anything like that.  In fact, interrupt handlers might not even use the C calling convention used for other functions, you might get a special calling convention by using a keyword (for example <code>__interrupt</code>, so in C++ you end up with <code>extern &quot;C&quot; __interrupt void whatever(void)</code>).  (The spelling of the keyword depends on your compiler)  The compiler will take care of this detail.  What it can&#39;t do is create a <code>this</code> pointer out of thin air."}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559138379, "post_id": 56362016, "comment_id": 99328057, "body": "Thank you for your clarification. I understand what you mean. By using a singleton or global object I implicitly stopped using this, hence working around that problem."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559140688, "post_id": 56362016, "comment_id": 99329447, "body": "@old_timer: Can you check if my edit is precise enough to avoid confusion?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559141236, "post_id": 56362016, "comment_id": 99329781, "body": "C compilers can chose their own convention there are no rules to stop them.  they can choose to use a common or recommended one or go their own way.  For the cortex-m to be able to have a c function label address in the vector table and have it work that compiler needs to conform to the convention &quot;baked&quot; into the logic.  otherwise C wont work either.   You can then use the traditional approach of wrapping your C function either with compiler specific features or on your own in assembly."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559146914, "post_id": 56362016, "comment_id": 99332850, "body": "@old_timer: Yes absolutely you can write the interrupt handler (or a forwarder) in assembly if you choose, giving it the expected name.  You can choose your own symbol names for handler functions if you write your own (or modify) the platform support code.  But most people will use the compiler-provided startup function so they get globals correctly initialized, etc before <code>main()</code> is called.  And in that common case the interrupt handlers need to use the names designated by the platform support library, which have C linkage."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559152459, "post_id": 56362016, "comment_id": 99335311, "body": "and most people are using gnu or kiel or some other that uses a compatible calling convention."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559152496, "post_id": 56362016, "comment_id": 99335329, "body": "the reset vector is a special case even for C but definitely for C++ the other vectors are the one you want to use this cortex-m feature for."}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559199373, "post_id": 56362016, "comment_id": 99348094, "body": "I think something important is mentioned here: it is compiler dependent. In the mean time I found this link to the <a href=\"https://www.iar.com/support/tech-notes/compiler/cortex-m-interrupt-vector-in-c-ewarm-6.21/\" rel=\"nofollow noreferrer\">IAR</a> website. It is an example for an interrupt vertor table in C++. I did look at it but have to undertand it yet."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1559141082, "last_edit_date": 1559141082, "creation_date": 1559137278, "answer_id": 56362016, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c/56362016#56362016", "title": "ARM Cortex-M interrupt handler in C++", "body": "<p>It is possible to write the interrupt handler in any language that compiles to native code.</p>\n\n<p>It still has to use C language linkage with the interrupt handler calling convention.  That means no member functions.  (Formally, static member functions are illegal as well, although they usually work in practice.  Non-static member functions cannot be used.)</p>\n\n<p>In C++, first enable the C language linkage with <code>extern \"C\"</code>.  Also use any compiler-specific keyword for interrupt handlers that you would have used in C, such as <code>__interrupt</code>.</p>\n\n<p>Inside the function you can use the full power of C++ -- objects, for-in loops, smart pointers, template instances, etc.  Although you still want to be careful about how much work you do in interrupt context, and C++ tends to hide the complexity so you no longer have a feel for how many machine instructions are being generated.</p>\n\n<hr>\n\n<p>On ARM Cortex M chips, there's a table of function pointers at a preset memory address.  The table may be constructed in C or assembly, and if your interrupt handlers aren't exported with the correct name, the linker won't be able to find the addresses that belong in the table.  C language linkage ensures that any name mangling is performed in a way compatible with the symbol references in the startup code.</p>\n\n<p>Other processor families use a fixed address only for the reset vector, and install other interrupt handlers by writing each handler address into a special-function register corresponding to its interrupt.  For these, only calling convention matters and not the function name/linkage.  ARM Cortex-M lets you write a special function register to find the whole vector table at an alternate address, but not to relocate individual handlers.</p>\n"}, {"comments": [{"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559139165, "post_id": 56362415, "comment_id": 99328564, "body": "Thank you for your answer, I understand what you mean. Only a static function of that class would be a valid candidate."}], "tags": [], "owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "is_accepted": false, "score": 2, "last_activity_date": 1559138529, "creation_date": 1559138529, "answer_id": 56362415, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c/56362415#56362415", "title": "ARM Cortex-M interrupt handler in C++", "body": "<blockquote>\n  <p>Is away to directly call a C++ object function when a interrupt occurs?</p>\n</blockquote>\n\n<p>In a short, no. Even if you declare your non-static method as <code>void (void)</code>, it still has an implicit argument - <code>this</code>. Interrupt handler on the other hand, has no arguments at all.</p>\n"}], "owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "accepted_answer_id": 56362016, "answer_count": 2, "score": 2, "last_activity_date": 1559898945, "creation_date": 1559135919, "last_edit_date": 1559898945, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c", "title": "ARM Cortex-M interrupt handler in C++", "body": "<p>Is it possible to write an interrupt handler in C++ for ARM Cortex chips like those of ST and NXP.</p>\n\n<p>Currently I develop a lot of code in C++ for ARM cortex chips. I am a bit fed up with having to call a static/global/singleton C++ object from a C callback function. Is there a way to not having to through the C function. </p>\n\n<p>Is there a way to directly call a C++ object functions when a interrupt occurs?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1559135471, "post_id": 56361384, "comment_id": 99326168, "body": "Why do you expect <code>if (id!=s-&gt;id)</code> to work? Neither variable changes, or is affected during the loop. Note that <code>char ch</code> should be <code>int ch</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559135534, "post_id": 56361384, "comment_id": 99326213, "body": "Indent your code properly. Your code is unreadable and therefore it&#39;s hard to understand. Also for deleting a line in a file you should read/write the files line by line, not char by char: proceed like this: for each line read in file A : if the line does not meet the deletion  criteria then write it to file B, otherwise don&#39;t."}, {"owner": {"reputation": 1, "user_id": 11470314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf4f610139ff43de83228966aa526a8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/11470314/greg"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559135632, "post_id": 56361384, "comment_id": 99326283, "body": "@WeatherVane Sorry for the mistake. I just started learning C for 2 weeks."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559135657, "post_id": 56361384, "comment_id": 99326295, "body": "When twice deleting the file with <code>remove(&quot;Customer.txt&quot;); if (remove(&quot;Customer.txt&quot;) == 0)</code> the second one won&#39;t report correctly (it was already deleted)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1559135734, "post_id": 56361384, "comment_id": 99326343, "body": "If you want to remove a line from a text file I suggest you read it line by line using <code>fgets()</code> and check its content to see what should be done with the line."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1559136497, "post_id": 56361384, "comment_id": 99326852, "body": "You might want to read the manpage for <code>fclose</code> again. Your compiler should show some warnings: <code>fclose(&quot;Backup.txt&quot;);</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559145249, "post_id": 56361384, "comment_id": 99331987, "body": "If you&#39;re working with lines, use a function that reads lines \u2014 <code>fgets()</code> or POSIX <code>getline()</code> for example.  Or, if you must, write your own function that reads a line and then returns it for the higher-level program to work on.  Working down at the character-by-character input level is mixing levels and makes life unnecessarily hard for yourself."}], "owner": {"reputation": 1, "user_id": 11470314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf4f610139ff43de83228966aa526a8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/11470314/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559141289, "creation_date": 1559135174, "last_edit_date": 1559141289, "question_id": 56361384, "link": "https://stackoverflow.com/questions/56361384/is-this-the-right-way-to-skip-a-line-in-a-text-file", "title": "Is this the right way to skip a line in a text file?", "body": "<p>Working on a project regarding a booking system. This function is to delete a line in a text file. When I run this, nothing happens.</p>\n\n<p>CustomerD.txt is for recording all students who delete the booking.\nBackup.txt is for temporary file.</p>\n\n<pre><code>int del()\n{\n    FILE *in, *out, *stay;\n    char ch, conf;\n    int  temp = 0;\n    int id;\n    in = fopen(\"Customer.txt\", \"r\");\n    out = fopen(\"Backup.txt\", \"w+\");\n    stay = fopen(\"CustomerD.txt\",\"w+\");\n    if (in == NULL)\n     {\n       printf(\"\\nCannot Open the Source file\");\n         exit(1);\n      } \n    if (out == NULL) {\n        printf(\"\\nCannot create Target File\\n\");\n        exit(1);\n        }\n     printf(\"Enter your id :\");\n    scanf(\"%d\", &amp;id);\n   ch = fgetc(in);\n   while (ch!= EOF)\n    {\n        if (id!=s-&gt;id)\n    {\n        ch = fgetc(in);\n        fputc(ch, out);\n    }\n    else {\n        ch = fgetc(in);\n        fputc(ch, stay);\n    }\n    }\n    printf(\"Your Deletion is done\");\n    fclose(\"Customer.txt\");\nfclose(\"Backup.txt\");\nfclose(\"CustomerD.txt\");\nremove(\"Customer.txt\");\nif (remove(\"Customer.txt\") == 0)\n    printf(\"Deleted successfully\");\nelse\n    printf(\"Unable to delete the file\");\nrename(\"Backup.txt\",\"Customer.txt\");\nreturn 0;\n  }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1559135102, "post_id": 56361334, "comment_id": 99325950, "body": "Sounds like the <a href=\"https://en.wikipedia.org/wiki/Tower_of_Hanoi\" rel=\"nofollow noreferrer\">Tower of Hanoi</a> puzzle."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1559135154, "post_id": 56361334, "comment_id": 99325975, "body": "Is this a <a href=\"https://stackoverflow.com/questions/1223305/tower-of-hanoi-recursive-algorithm\">Tower of Hanoi</a> problem?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559135270, "post_id": 56361334, "comment_id": 99326056, "body": "So the linked list is, effectively, a stack?"}, {"owner": {"reputation": 9, "user_id": 11572957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ba1641ef3b12ca816e1e8361f200e0?s=128&d=identicon&r=PG&f=1", "display_name": "Marin3l", "link": "https://stackoverflow.com/users/11572957/marin3l"}, "edited": false, "score": 0, "creation_date": 1559136584, "post_id": 56361334, "comment_id": 99326917, "body": "it can be used as a stack."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559223665, "post_id": 56361334, "comment_id": 99359193, "body": "OT: regarding: <code>struct silver_plate *next_node =             (struct silver_plate*)malloc(sizeof(struct(silver_plate)));</code>  1) The returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc  2)  Always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559223925, "post_id": 56361334, "comment_id": 99359364, "body": "in the <code>push()</code> function, there is a &#39;malloc()` for a pointer named <code>next_node</code>  Then all the following lines are referencing <code>new_node</code>  This is an error"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559224113, "post_id": 56361334, "comment_id": 99359476, "body": "in the <code>move()</code> function, there is a <code>malloc()</code> for a pointer named <code>new_node</code> All the following lines are referencing a <code>new_node1</code>  This is an error."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559224196, "post_id": 56361334, "comment_id": 99359512, "body": "when asking a question about a run-time problem, as this question is doing, always post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}], "owner": {"reputation": 9, "user_id": 11572957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ba1641ef3b12ca816e1e8361f200e0?s=128&d=identicon&r=PG&f=1", "display_name": "Marin3l", "link": "https://stackoverflow.com/users/11572957/marin3l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559135543, "creation_date": 1559134974, "last_edit_date": 1559135543, "question_id": 56361334, "link": "https://stackoverflow.com/questions/56361334/i-have-to-solve-a-problem-with-lists-in-c", "title": "I have to solve a problem with lists in c", "body": "<p>We have a cake with n stories put on a silver plate. We have to put it on a golden plate, but the cake is too big to do this directly, so we need to use an additional plate, a bronze one. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct silver_plate\n{\n    int story;\n    struct silver_plate *next;\n};\n\nstruct silver_plate *head;\nhead=NULL;\n\nstruct golden_plate\n{\n    int story;\n    struct golden_plate *next;\n};\n\nstruct golden_plate *head1;\nhead1=NULL;\n\n\nvoid push(struct silver_plate **head_ref,int story)\n{\n    struct silver_plate *next_node =\n            (struct silver_plate*)malloc(sizeof(struct(silver_plate)));\n\n    new_node-&gt;story=story;\n    new_node-&gt;next=(*head_ref);\n\n    (*head_ref)=new_node;\n}\n\nvoid move(struct golden_plate *head_ref)\n{\n    struct golden_plate *new_node =\n            (struct golden_plate *)malloc(sizeof(struct(golden_plate)));\n\n    new_node1-&gt;story=new_node-&gt;story;\n    new_node1-&gt;next=(*head_ref1);\n\n    (*head_ref1)=new_node1;\n}\n</code></pre>\n\n<p>I expect the output to be a list arranged with the n stories placed on the golden plate.</p>\n"}, {"tags": ["c", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1559134980, "post_id": 56360746, "comment_id": 99325856, "body": "<code>pthread_cond_wait</code> should be called in a loop to wait for the desired condition. You do this in the server loop (checking for <code>current_id</code>) but not in the client loop. The server code uses <code>pthread_cond_wait</code> to allow only one server to be current. But there is no such serialization in the client code. Remember that <code>pthread_cond_wait</code> releases the mutex while waiting, and that allows another thread to claim the mutex. (And just because you create the client threads first doesn&#39;t guarantee that they will run first.)"}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1559135591, "post_id": 56360746, "comment_id": 99326257, "body": "Also, if your clients and servers are expected to execute sequentially, they shouldn&#39;t be threads."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1559136361, "last_edit_date": 1559136361, "creation_date": 1559134838, "answer_id": 56361304, "question_id": 56360746, "link": "https://stackoverflow.com/questions/56360746/threads-synchronization-in-c-why-do-they-overlap/56361304#56361304", "title": "Threads synchronization in C: why do they overlap", "body": "<p>There is a race. <code>running_servers</code> is accessed concurrently and unprotected.</p>\n"}], "owner": {"reputation": 85, "user_id": 10873272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVrqY_EYhdQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaSRQCjqg_dpFOF3wEwtbvstKfLzQ/mo/photo.jpg?sz=128", "display_name": "Kq11", "link": "https://stackoverflow.com/users/10873272/kq11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559136361, "creation_date": 1559133163, "question_id": 56360746, "link": "https://stackoverflow.com/questions/56360746/threads-synchronization-in-c-why-do-they-overlap", "title": "Threads synchronization in C: why do they overlap", "body": "<p>I have some code, written in C, I'd like to ask you about:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n\n#define COLOR_YELLOW  \"\\x1b[33m\"\n#define COLOR_RED    \"\\x1b[31m\"\n#define COLOR_RESET   \"\\x1b[0m\"\n\nint tests = 3;\nint running_servers;\n\nint servers;\nint clients;\nint max_clients;\n\nint current_id = 0;\nint clients_handled = 0;\n\n\nvoid *server(void *arg);\nvoid *client(void *arg);\n\npthread_mutex_t server_mutex;\npthread_mutex_t client_mutex;\n\npthread_cond_t order_cond;\npthread_cond_t getting_clients;\npthread_cond_t full;\n\nint main(int argc, char *argv[]) {\n\n     if(argc != 4) { printf(\"expected 3 arguments\"); return 1; }\n\n     // INIT\n     servers = atoi(argv[1]);\n     running_servers = atoi(argv[1]);\n     clients = atoi(argv[2]);\n     max_clients = atoi(argv[3]);\n\n     pthread_mutex_init(&amp;server_mutex, NULL);\n     pthread_mutex_init(&amp;client_mutex, NULL);\n\n     pthread_cond_init(&amp;order_cond, NULL);\n     pthread_cond_init(&amp;getting_clients, NULL);\n     pthread_cond_init(&amp;full, NULL);\n\n     pthread_t *server_thread = calloc(servers, sizeof(pthread_t));\n     pthread_t *client_thread = calloc(clients, sizeof(pthread_t));\n\n\n\n     // CREATING CLIENT THREADS\n     int *arg;\n     for (int i = 0; i &lt; clients; i++) {\n         arg = malloc(sizeof(int));\n         *arg = i;\n         if (pthread_create(&amp;client_thread[i], NULL, client, (void *) arg))\n             perror(\"pthread_create error for passenger\");\n     }\n\n\n     // CREATING SERVER THREADS\n     for (int i = 0; i &lt; servers; i++) {\n         arg = malloc(sizeof(int));\n         *arg = i;\n         if (pthread_create(&amp;server_thread[i], NULL, server, (void *) arg))\n             perror(\"pthread_create error for car\");\n     }\n\n     // JOINING ENDING THREADS\n     for (int i = 0; i &lt; servers; i++)\n         if (pthread_join(server_thread[i], NULL)) perror(\"pthread_join error for car\");\n\n\n     for (int i = 0; i &lt; clients; i++)\n         if (pthread_join(client_thread[i], NULL)) perror(\"pthread_join error for passenger\");\n\n     return 0;\n}\n\n\nvoid *server(void *arg) {\n     int id = *(int *) arg;\n\n\n     printf(COLOR_RED \"SERVER: %d\" COLOR_RESET \" start working\\n\", id);\n\n     while (tests--) {\n\n         // ONLY ONE SERVER CAN WORK - SERVERS ARE RUN IN ORDER\n         pthread_mutex_lock(&amp;server_mutex);\n         while (id != current_id)\n             pthread_cond_wait(&amp;order_cond, &amp;server_mutex);\n\n\n         printf(COLOR_RED \"SERVER: %d\" COLOR_RESET \" starts\\n\", id);\n\n\n         printf(COLOR_RED \"SERVER: %d\" COLOR_RESET \" gets clients \\n\", id);  // server gets clients\n         pthread_cond_broadcast(&amp;getting_clients);\n\n\n         pthread_cond_wait(&amp;full, &amp;client_mutex);                            // server is waiting for signal (from any client)\n         printf(COLOR_RED \"SERVER: %d\" COLOR_RESET \" is full \\n\", id);       // that he has max number of clients\n\n\n\n         printf(COLOR_RED \"SERVER: %d\" COLOR_RESET \" stops \\n\", id);\n\n         current_id = (current_id + 1) % servers;\n\n         pthread_mutex_unlock(&amp;server_mutex);\n         pthread_cond_broadcast(&amp;order_cond);\n     }\n\n     running_servers -= 1;\n     return NULL;\n}\n\n\n\n\nvoid *client(void *arg) {\n     int id = *(int *) arg;\n\n\n     printf(COLOR_YELLOW \"CLIENT: %d\" COLOR_RESET \" starts\\n\", id);\n\n     while (running_servers) {\n         pthread_mutex_lock(&amp;client_mutex);                      // only one client at the time (should be)\n\n         pthread_cond_wait(&amp;getting_clients, &amp;client_mutex);\n\n         printf(COLOR_YELLOW \"CLIENT: %d\" COLOR_RESET \" has access to server %d\\n\", id,current_id);\n\n         clients_handled++;\n\n\n         for (int j = 0; j &lt; 10; j++) {                          // client writes some numbers\n             printf(\"%d:    \", id);\n             for (int i = 0; i &lt; 10; i++) {\n                 printf(\"%d  \", 10 * j + i);\n             }\n             printf(\"\\n\");\n         }\n\n         if(clients_handled == max_clients) {                    // client sends signal he is the last one server can handle\n             printf(COLOR_YELLOW \"CLIENT: %d\" COLOR_RESET \" server %d is full, shifting to next server\\n\", id, current_id);\n             clients_handled = 0;\n             pthread_cond_signal(&amp;full);\n         }\n\n         pthread_mutex_unlock(&amp;client_mutex);\n\n     }\n\n     return NULL;\n}\n</code></pre>\n\n<p>it's not pretty but it's working (sort of).</p>\n\n<p><strong>How it works:</strong>\nProgram gets 3 arguments: number of servers, number of clients, max clients in server. We have servers and clients created as threads. At the moment one client and one server should be active (for that are mutexes server_mutex and client_mutex). Server broadcast info he is active (getting_clients condition), clients are run one next to each other, client writes some numbers, if he is the last one server can handle he signals it (full cond) and server is switchet to next one. I hope you won;t have any problems with running it (as I wrote is works - sort of).</p>\n\n<p><strong>What does not work</strong></p>\n\n<ul>\n<li><p>it looks like server_mutex does his job, servers are being run one by one, but client_mutex doesn't, and I don't know why sometimes clients overlap - one client starts, while other haven't finished writing numbers.</p></li>\n<li><p>I have problem with first broadcast of getting_clients, because from unknown reason it is sometimes send while some clients are not yet created. This is especially bad, when I have like 3 servers and 2 clients, and then they may not even start. It's weird for me because client threads are being created first, and I wonder if there is any solution ( except adding sleep() between creating client threads and server threads, but I'd like to avoid that)</p></li>\n<li><p>for some reason program doesn't end, it just stops in one moment, that may be connected with previous ones, but I haven't found the sollution for that yet,</p></li>\n<li><p>do you have any ideas what to do, to make all clients be handled equally? I mean I have 3 servers and 100 clients and I wouldn't like to have the situation when few clients write all the time and there is a group which haven't got an access to server yet</p></li>\n</ul>\n\n<p>I will be grateful for any help :)</p>\n"}, {"tags": ["c", "pointers", "linked-list", "shuffle"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559133162, "post_id": 56360545, "comment_id": 99324746, "body": "Use your debugger first."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559133921, "post_id": 56360545, "comment_id": 99325220, "body": "Also compile with all warnings enabled, <code>int *id;</code> is most likely wrong, you certainly want <code>int id;</code> instead. And you probably want <code>char* name[somelength];</code> instead of <code>char* name;</code>. Read the chapters dealing with strings and the chapter dealing with pointers in your C text book."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1559134061, "post_id": 56360545, "comment_id": 99325288, "body": "You should swap <i>either</i> the data <i>or</i> the list nodes (that is the connectivity of the list); you code does both. In other words, don&#39;t touch <code>next</code> when you swap."}], "answers": [{"comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1559136216, "post_id": 56361608, "comment_id": 99326670, "body": "- can of course be further simplified by having <code>tempSong</code> not be a pointer."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1559136350, "post_id": 56361608, "comment_id": 99326751, "body": "@500-InternalServerError: Of course! I only made the minimal changes to fix the problem."}, {"owner": {"reputation": 863, "user_id": 6356090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4f80e28568316e33f41778d11ce9fe03?s=128&d=identicon&r=PG&f=1", "display_name": "itzikb", "link": "https://stackoverflow.com/users/6356090/itzikb"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1559140073, "post_id": 56361608, "comment_id": 99329069, "body": "@500-InternalServerError how can I make tempSong not as pointer? i need to allocate memory for this, can you show an example?"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 3, "last_activity_date": 1559141572, "last_edit_date": 1559141572, "creation_date": 1559135939, "answer_id": 56361608, "question_id": 56360545, "link": "https://stackoverflow.com/questions/56360545/shuffle-linked-list-in-c-with-pointers/56361608#56361608", "title": "Shuffle linked list in c with pointers", "body": "<p>The error lies in <code>swapSong</code>. There are two possible ways to swap elements in a list: </p>\n\n<ul>\n<li>either you swap data and do not touch <code>next</code> pointers</li>\n<li>or you do not touch data add change pointers</li>\n</ul>\n\n<p>The former is simpler for singly linked list with few internal data (which is your use case), the latter is more for doubly linked lists.</p>\n\n<p>Here just change <code>swapSong</code> to:</p>\n\n<pre><code>void swapSong(Song* head,Song* Source, int id) {\n    Song* tempSong = (Song*)malloc(sizeof(Song));\n    Song* currentSong = head;\n    while(currentSong &amp;&amp; currentSong-&gt;id != id){\n        currentSong = currentSong-&gt;next;\n    }\n    if (currentSong) {\n        tempSong-&gt;id = currentSong-&gt;id;\n        tempSong-&gt;name = currentSong-&gt;name;\n        tempSong-&gt;artist = currentSong-&gt;artist;\n        //tempSong-&gt;next = currentSong-&gt;next;\n        currentSong-&gt;id = Source-&gt;id;\n        currentSong-&gt;name = Source-&gt;name;\n        currentSong-&gt;artist = Source-&gt;artist;\n        //currentSong-&gt;next = Source-&gt;next;\n        Source-&gt;id = tempSong-&gt;id;\n        Source-&gt;name = tempSong-&gt;name;\n        Source-&gt;artist = tempSong-&gt;artist;\n        //Source-&gt;next = tempSong-&gt;next;\n        free(tempSong);\n    }\n    else {\n        printf(\"The list is empty.\");\n    }\n\n}\n</code></pre>\n\n<hr>\n\n<p>BTW, in <code>Song</code> struct, <code>id</code> is declared as an <code>int *</code>, while it is used as an <code>int</code>. Change to the following to remove some warnings:</p>\n\n<pre><code>typedef struct Song {\n    int id;\n    char* name;\n    char* artist;\n    struct Song* next;\n}Song;\n</code></pre>\n\n<p>And as noticed by @500-InternalServerError, you do not need to allocate anything in <code>swapSong</code>: just use a local struct:</p>\n\n<pre><code>void swapSong(Song* head,Song* Source, int id) {\n    Song* currentSong = head;\n    while(currentSong &amp;&amp; currentSong-&gt;id != id){\n        currentSong = currentSong-&gt;next;\n    }\n    if (currentSong) {\n        Song tempSong = *currentSong;\n        currentSong-&gt;id = Source-&gt;id;\n        currentSong-&gt;name = Source-&gt;name;\n        currentSong-&gt;artist = Source-&gt;artist;\n        Source-&gt;id = tempSong.id;\n        Source-&gt;name = tempSong.name;\n        Source-&gt;artist = tempSong.artist;\n    }\n    else {\n        printf(\"The list is empty.\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 6356090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4f80e28568316e33f41778d11ce9fe03?s=128&d=identicon&r=PG&f=1", "display_name": "itzikb", "link": "https://stackoverflow.com/users/6356090/itzikb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56361608, "answer_count": 1, "score": 0, "last_activity_date": 1559141572, "creation_date": 1559132524, "question_id": 56360545, "link": "https://stackoverflow.com/questions/56360545/shuffle-linked-list-in-c-with-pointers", "title": "Shuffle linked list in c with pointers", "body": "<p>I am trying to shuffle a linked list in <code>C</code>.\nI've thinking about do it by run all over the list and for each object I'll try to randomize an index and swap between them.\nit's seem the code work, but after couple of time I run the code its seem that part of the list is gone, and sometime I get kicked out from the application.</p>\n\n<p>Here is the code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void main() {\n    Song* head = createSong(1, \"aaaa\", \"aaaa\");\n    Song* song2 = createSong(2, \"bbbb\", \"bbbb\");\n    Song* song3 = createSong(3, \"cccc\", \"cccc\");\n    addSongToTheEndOfTheList(head, song2);\n    addSongToTheEndOfTheList(head, song3);\n    printPlaylist(head);\n    shuffleList(head);\n    printPlaylist(head);\n    //freePlaylist(head);\n}\nint countList(Song* head) {\n    Song* currentSong = head;\n    int i = 0;\n    if (currentSong)\n    {\n        while (currentSong-&gt;next)\n        {\n            currentSong = currentSong-&gt;next;\n            i++;\n        }       \n        i++;\n    }\n    return i;\n}\nvoid swapSong(Song* head,Song* Source, int id) {\n    Song* tempSong = (Song*)malloc(sizeof(Song));\n    Song* currentSong = head;\n    while(currentSong &amp;&amp; currentSong-&gt;id != id){\n        currentSong = currentSong-&gt;next;\n    }\n    if (currentSong) {\n        tempSong-&gt;id = currentSong-&gt;id;\n        tempSong-&gt;name = currentSong-&gt;name;\n        tempSong-&gt;artist = currentSong-&gt;artist;\n        tempSong-&gt;next = currentSong-&gt;next;\n        currentSong-&gt;id = Source-&gt;id;\n        currentSong-&gt;name = Source-&gt;name;\n        currentSong-&gt;artist = Source-&gt;artist;\n        currentSong-&gt;next = Source-&gt;next;\n        Source-&gt;id = tempSong-&gt;id;\n        Source-&gt;name = tempSong-&gt;name;\n        Source-&gt;artist = tempSong-&gt;artist;\n        Source-&gt;next = tempSong-&gt;next;\n        free(tempSong);\n    }\n    else {\n        printf(\"The list is empty.\");\n    }\n\n}\nvoid shuffleList(Song* head) {\n    Song* currentSong = head;\n    int listLength = countList(head);\n    int randNum;\n    srand(time(NULL));\n    if (currentSong) {\n        for (int i = 1; currentSong;i++) {\n            swapSong(head, currentSong, rand()%listLength+1);\n            currentSong = currentSong-&gt;next;\n        }\n    }\n    else {\n        printf(\"The list is empty.\");\n    }\n}\n</code></pre>\n\n<p>The full code is here:\n<a href=\"https://pastebin.com/fSS3rrTv\" rel=\"nofollow noreferrer\">https://pastebin.com/fSS3rrTv</a></p>\n\n<p>Hope you can help me figure it out.\nThanks!</p>\n"}, {"tags": ["c++", "c", "clang-format"], "comments": [{"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 11, "creation_date": 1559132569, "post_id": 56360525, "comment_id": 99324345, "body": "But it looks so much better with the space!"}, {"owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "reply_to_user": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 2, "creation_date": 1559132665, "post_id": 56360525, "comment_id": 99324426, "body": "I guess that&#39;s personal preference"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1559132909, "post_id": 56360525, "comment_id": 99324567, "body": "It might just not be in there if it&#39;s not a recognized code style. I tend to see styles adding more types of white space in that gap, not removing it."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559134133, "post_id": 56360525, "comment_id": 99325332, "body": "It might be that no one came up with this awful style before, hence the lack of support."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559144268, "post_id": 56360525, "comment_id": 99331462, "body": "To get that format, you&#39;ll probably need to find an alternative code formatter.  There are many to choose from.  If the one you like doesn&#39;t do what you want, you either suck it up and accept the wisdom of those who wrote it, or you switch to one that does what you want, or you modify the source for the Clang formatter so that it can be configured to do what you want, and then you try to persuade the powers that be that this is a legitimate requirement and that your code is a legitimate solution and that they should accept the change into the code base.  I suspect it may not be accepted."}, {"owner": {"reputation": 121, "user_id": 10977033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b481acf5d5db6290dcf3fa07724541d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10977033/jenny"}, "edited": false, "score": 0, "creation_date": 1571865274, "post_id": 56360525, "comment_id": 103385952, "body": "@peterzuger: Have you got this one working?"}, {"owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "reply_to_user": {"reputation": 121, "user_id": 10977033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b481acf5d5db6290dcf3fa07724541d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10977033/jenny"}, "edited": false, "score": 2, "creation_date": 1571946051, "post_id": 56360525, "comment_id": 103417215, "body": "@Jenny: No so far I have not found anything, I just have a regexp ready to replace all &quot;) {&quot; with &quot;){&quot; and a few others. All code formater&#39;s that I have found do not support this"}], "owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1586915930, "creation_date": 1559132462, "last_edit_date": 1586915930, "question_id": 56360525, "link": "https://stackoverflow.com/questions/56360525/how-to-create-format-rule-to-get-no-space-before-opening-brace", "title": "How to create format rule to get no space before opening brace?", "body": "<p>I am trying to use clang format to automatically format my code.\nBut there seems to be no option to configure the positon of the opening Brace.</p>\n\n<p>The option <em>BreakBeforeBraces</em> can be used to put the Brace on the next line,\nbut no option to disable the leading space.</p>\n\n<p>I am using clang-format 8.0.0.\nThe <a href=\"http://releases.llvm.org/8.0.0/tools/clang/docs/ClangFormatStyleOptions.html\" rel=\"nofollow noreferrer\">documentation</a> does not seem to contain any info on this.</p>\n\n<p>This is how clang formats code:</p>\n\n<pre><code>class test {\n\n};\n\nint main() {\n    if() {\n        // Here the Space before the if can be configured with:\n        // SpaceBeforeParens: SBPO_Never\n    }\n}\n</code></pre>\n\n<p>This is how I would like it to look:</p>\n\n<pre><code>class test{\n\n};\n\nint main(){\n    if(){\n        // stuff\n    }\n}\n</code></pre>\n\n<p>Is this possible with clang-format ?</p>\n"}, {"tags": ["c", "header-files"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559132614, "post_id": 56360422, "comment_id": 99324386, "body": "Looks like you probably have actual variables with storage located in your header file. Include guards don&#39;t protect against this. Put those variables in PLL.c and have <code>extern</code>-marked versions of those variable in the header. That way, both files can refer to the variable, but it only exists in one place."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559132622, "post_id": 56360422, "comment_id": 99324393, "body": "Have you <i>implemented</i> the function in the header file itself?"}], "answers": [{"comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559137055, "post_id": 56360833, "comment_id": 99327196, "body": "It&#39;s not <i>forbidden</i> to have a variable definition in a header.   However, a header that defines a variable can ONLY be included in one compilation unit.   If it is included in two or more compilation units, that variable will be defined multiple times in the program.   (According to the standard that gives undefined behaviour but, practically, it typically results in &quot;multiple definition&quot; errors when linking)."}, {"owner": {"reputation": 16, "user_id": 11572806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xjrpm.png?s=128&g=1", "display_name": "ZeeMoros", "link": "https://stackoverflow.com/users/11572806/zeemoros"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559139212, "post_id": 56360833, "comment_id": 99328596, "body": "Thank you for the correction, I wasn&#39;t aware of this, do you want to correct my answer or do you want me to do it ?"}], "tags": [], "owner": {"reputation": 16, "user_id": 11572806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xjrpm.png?s=128&g=1", "display_name": "ZeeMoros", "link": "https://stackoverflow.com/users/11572806/zeemoros"}, "is_accepted": true, "score": 0, "last_activity_date": 1559141422, "last_edit_date": 1559141422, "creation_date": 1559133418, "answer_id": 56360833, "question_id": 56360422, "link": "https://stackoverflow.com/questions/56360422/multiple-declarations-of-variable-name/56360833#56360833", "title": "Multiple Declarations of [variable name]", "body": "<p>Correction made according to the comment of @Peter</p>\n\n<p>In C you can only put variable definitions in a header if it is only included in one compilation unit. </p>\n\n<p>You seem to have two compilation unit :</p>\n\n<ul>\n<li><p>one that compiles your PLL.h and PLL.c to create PLL.o</p></li>\n<li><p>one that compiles your main.c and PLL.h to create main.o</p></li>\n</ul>\n\n<p>Both of your objects files contain the variables that you have defined in PLL.h and therefore when you hit the linker it throws an error because the variables have been declared twice (once in each object file).</p>\n\n<p>To correct this error you can either change the way you compile to merge your two compilation unit. Or (if you use an IDE that handles automatically your compilation) you can apply the following changes to avoid defining the variable in your header.</p>\n\n<p>In the header : (change the definition to a declaration)</p>\n\n<pre><code>extern int x;\n</code></pre>\n\n<p>In a source file : (define the variable)</p>\n\n<pre><code>int x;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10350161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb7f9428b8491b278840c165650e2f7?s=128&d=identicon&r=PG&f=1", "display_name": "GIJedi", "link": "https://stackoverflow.com/users/10350161/gijedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56360833, "answer_count": 1, "score": 0, "last_activity_date": 1559141422, "creation_date": 1559132167, "last_edit_date": 1559132924, "question_id": 56360422, "link": "https://stackoverflow.com/questions/56360422/multiple-declarations-of-variable-name", "title": "Multiple Declarations of [variable name]", "body": "<p>I am working on a header file that does a couple of functions for me. I include the header file in two seperate files, the c file and the main file.</p>\n\n<p>I use <code>#ifndef</code> and <code>#def</code> but it looks like it still gets compiled twice, because during the linking process I get serveral </p>\n\n<blockquote>\n  <p>multiple declarations of ...</p>\n</blockquote>\n\n<p>errors.</p>\n\n<h2>PLL header file</h2>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef PLL_HEADER\n#define PLL_HEADER\n\n/********************************************************************\n * includes\n ********************************************************************/\n#include \"board.h\"\n#include \"pin_mux.h\"\n#include \"clock_config.h\"\n#include \"PITDriver.h\"\n\n// Some more stuff\n\n#endif\n</code></pre>\n\n<h2>Here is the relevant log data</h2>\n\n<pre><code>[compiling stuff]\n\nBuilding target: PLL Function.axf\nInvoking: MCU Linker\n\n[other linker stuff]\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:45: multiple definition of `accumulateVal'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:45: first defined here\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:46: multiple definition of `getValOne'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:46: first defined here\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:47: multiple definition of `getValTwo'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:47: first defined here\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:48: multiple definition of `countTo'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:48: first defined here\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:49: multiple definition of `runUntil'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:49: first defined here\n\n./source/main.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:50: multiple definition of `currentValue'\n./source/PLL.o:C:\\Users\\mailn\\Desktop\\Work\\Sparton\\MCUXPresso Workstation\\PLL Function\\Debug/../source/PLL.h:50: first defined here\n\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [makefile:39: PLL Function.axf] Error 1\n</code></pre>\n"}, {"tags": ["c", "pointers", "math", "standards", "undefined-behavior"], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1559132937, "post_id": 56360544, "comment_id": 99324591, "body": "+1 for mentioning pointer provenance.  Also, see <a href=\"https://stackoverflow.com/a/45970808/1687119\">this answer</a> for more details."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1559134498, "post_id": 56360544, "comment_id": 99325544, "body": "@dbush Thanks for the link. I have edited it in. I also think the gcc optimization is unnecessary and wrong as the manufactured inequality doesn&#39;t carry across function call / translation unit boundaries."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559135592, "post_id": 56360544, "comment_id": 99326258, "body": "Even if you convert to an integer type, there&#39;s still stuff like ASLR on hosted systems, so I&#39;m not sure if code like this is meaningful even if well-defined."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 7, "last_activity_date": 1559134785, "last_edit_date": 1559134785, "creation_date": 1559132523, "answer_id": 56360544, "question_id": 56360316, "link": "https://stackoverflow.com/questions/56360316/c-standard-regarding-pointer-arithmetic-outside-arrays/56360544#56360544", "title": "C standard regarding pointer arithmetic outside arrays", "body": "<p>The C standard doesn't define degrees of undefinedness for undefined behavior. If it's undefined, it's always all bets are off. </p>\n\n<p>Additionally, modern compilers mess with this pointer provenance thing where the compiler even watches if a possibly valid pointer is derived correctly and if it isn't, it can adjust program behavior.</p>\n\n<p>If you want mathematical pointer arithmetic without the possibility of UB,\nyou can try and cast your pointer to <code>uintptr_t</code> prior to doing the math.</p>\n\n<hr>\n\n<p>E.g.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char a,b;\n    printf(\"&amp;a=%p\\n\", &amp;a);\n    printf(\"&amp;b=%p\\n\", &amp;b);\n    printf(\"&amp;a+1=%p\\n\", &amp;a+1);\n    printf(\"&amp;b+1=%p\\n\", &amp;b+1);\n    printf(\"%d\\n\", &amp;a+1==&amp;b || &amp;b+1==&amp;a);\n}\n</code></pre>\n\n<p>on my machine, compiled with <code>gcc -O2</code>, results in:</p>\n\n<pre><code>&amp;a=0x7ffee4e36cae\n&amp;b=0x7ffee4e36caf\n&amp;a+1=0x7ffee4e36caf\n&amp;b+1=0x7ffee4e36cb0\n0\n</code></pre>\n\n<p>I.e., <code>&amp;a+1</code> has the same numerical address as <code>&amp;b</code> but is treated as unequal to <code>&amp;b</code> because the addresses are derived from different objects.</p>\n\n<p>(This gcc optimization is somewhat controversial. It doesn't carry across function call / translation unit boundaries, clang doesn't do it, and it's not necessary as <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.9p6\" rel=\"nofollow noreferrer\">6.5.9p6</a> does allow for accidental pointer equality. See <a href=\"https://stackoverflow.com/users/1687119/dbush\">dbush</a>'s to this <a href=\"https://stackoverflow.com/users/827263/keith-thompson\">Keith Thompson's</a> <a href=\"https://stackoverflow.com/a/45970808/1687119\">answer</a> for more details.)</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559159824, "post_id": 56361550, "comment_id": 99338319, "body": "Unfortunately, compiler writers seldom document all the guarantees they offer beyond those required by the Standard, perhaps because a promise to refrain from behaving obtusely may be seen as implying a judgment that such behavior would be acceptable in the absence of such a promise.  If a compiler behaves as its author would expect all non-obtuse compilers to behave, what would be gained by documenting that unless obtuse behavior would otherwise be expected?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1559135767, "creation_date": 1559135767, "answer_id": 56361550, "question_id": 56360316, "link": "https://stackoverflow.com/questions/56360316/c-standard-regarding-pointer-arithmetic-outside-arrays/56361550#56361550", "title": "C standard regarding pointer arithmetic outside arrays", "body": "<p>The C standard has to say undefined behavior simply because things like memory mapping is beyond the scope of the standard. </p>\n\n<p>This doesn't apply only to array indexing being the only allowed form of pointer arithmetic, but also the C concept of \"effective type\", which can be described as the compiler's internal list of what types that are actually stored at any given address it knows about. And accessing parts of memory which the compiler doesn't know about is essentially undefined behavior too.</p>\n\n<p>If you look at the average embedded system, you frequently need to access addresses where there are no arrays, and as far as the compiler knows, no objects at all (memory-mapped registers etc). Therefore all such embedded C compilers have guarantees that such code behaves predictably, even though such guarantees are \"non-standard extensions\". Which in practice means that pointers boil down to integer numbers representing physical addresses.</p>\n\n<p>Best practice is to write code that is safe no matter. For example, if we are to write a program that dumps the contents of a flash memory page, we want to iterate over it byte by byte (to drop the result on some serial bus). With the average embedded systems compiler, it is safe to simply set a <code>volatile const uint8_t*</code> to the first byte of the flash page, then iterate away, regardless of what variables and types that happen to be stored there. But from C's point of view, this is undefined behavior.</p>\n\n<p>We can sate both the requirements from C and the real world by placing all variables to be allocated in that page inside one enormous <code>struct foo { ... } bar;</code>. Which we are allowed to iterate over byte by byte using a pointer to a character type like <code>uint8_t</code>. (C17 6.3.2.3/7). </p>\n\n<p>So the effort of dodging undefined behavior isn't necessarily that cumbersome. There's often work-arounds with structs, unions, converting pointers to integers etc etc.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": -1, "last_activity_date": 1559144553, "creation_date": 1559144553, "answer_id": 56364236, "question_id": 56360316, "link": "https://stackoverflow.com/questions/56360316/c-standard-regarding-pointer-arithmetic-outside-arrays/56364236#56364236", "title": "C standard regarding pointer arithmetic outside arrays", "body": "<p>The C Standards Committee saw no need to forbid compilers from behaving in silly ways that would make them unsuitable for many purposes.  Indeed, according to the published Rationale, the Committee recognized that it would be possible for implementation to behave in a way that was conforming but useless, but judged that people seeking to produce quality implementations of the language the Standard was written to describe would refrain from such silliness.  Consider the program:</p>\n\n<pre><code>void byte_copy(unsigned char *dest, unsigned char *src, int len)\n{\n  while(len--) *dest++ = *src++;\n}\nunsigned char src[10][10], dest[100];\nvoid test(int mode)\n{\n  if (mode == 0)\n    byte_copy(dest, src[0], 11);\n  else\n    byte_copy(dest, (unsigned char*)src, 100);\n}\n</code></pre>\n\n<p>It might be useful for an implementation to trap on <code>test</code> if <code>mode</code> is zero, on the basis that the programmer was probably intending to copy elements from the first row of <code>src</code>, and the authors of the Standard probably didn't want to forbid that.  On the other hand, the language would be severely broken if code like that in the <code>mode != 0</code> case couldn't be used to make a bytewise copy of objects of all types including multi-dimensional arrays, and the Committee likely recognized that.  Nonetheless, the Standard recognizes no distinction between the pointers passed in the two cases.</p>\n\n<p>Such a distinction would only be necessary if one believed that the language would be broken by allowing implementations to behave in ways that would make them useless.  Since the authors of the Standard have said that they recognize that it allows implementations to behave uselessly, but do not believe that such a possibility breaks the language, that would suggest that they might not regard a failure to define behavior of all necessary constructs as a defect in cases where they expected that quality implementations of the language the Standard was written to describe would support such constructs <em>anyway</em>.</p>\n\n<p>As to the question of whether people seeking to write quality implementations of the language the Standard was written to describe can be relied upon to refrain from such silliness, that may be hard to answer without knowing the motives of the people maintaining some compilers.</p>\n"}, {"tags": [], "owner": {"reputation": 539, "user_id": 11413329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1Efn.jpg?s=128&g=1", "display_name": "Richard at ImageCraft", "link": "https://stackoverflow.com/users/11413329/richard-at-imagecraft"}, "is_accepted": false, "score": 0, "last_activity_date": 1559173868, "creation_date": 1559173868, "answer_id": 56369935, "question_id": 56360316, "link": "https://stackoverflow.com/questions/56360316/c-standard-regarding-pointer-arithmetic-outside-arrays/56369935#56369935", "title": "C standard regarding pointer arithmetic outside arrays", "body": "<p>Actually, to prove that any arbitrary pointer arithmetic is \"unrelated to any array\" is very hard (maybe similar to the Halting Problem? Not sure) because a pointer can be assigned \"sneakily\", through global variable, pointer to pointer, looking at the map file to find the pointer's actual address and modify that etc.</p>\n\n<p>What the standard is saying is that the compiler will probably do the \"expected things\" in terms of generated code (i.e. usual pointer arithmetic), but that the resulting pointer is not guaranteed to point to anything valid. So the behavior is \"undefined\". In particular, if you declare a variable before and after an array, and if your pointer goes even one element before or after the array, you are not guarantee that you will be touching those variables or in fact, any valid memory. On a system with with memory protection, it may even crash. The actual behavior depends on the system running the code.</p>\n"}], "owner": {"reputation": 263, "user_id": 4707338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f29afc35b587d0a5b6539f7e6a3a94?s=128&d=identicon&r=PG&f=1", "display_name": "gagou7", "link": "https://stackoverflow.com/users/4707338/gagou7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1559173868, "creation_date": 1559131812, "last_edit_date": 1559133358, "question_id": 56360316, "link": "https://stackoverflow.com/questions/56360316/c-standard-regarding-pointer-arithmetic-outside-arrays", "title": "C standard regarding pointer arithmetic outside arrays", "body": "<p>I read lot of things about pointer arithmetic and undefined behavior (<a href=\"https://wiki.sei.cmu.edu/confluence/display/c/ARR37-C.+Do+not+add+or+subtract+an+integer+to+a+pointer+to+a+non-array+object\" rel=\"nofollow noreferrer\">link</a>, <a href=\"https://publications.gbdirect.co.uk/c_book/chapter5/pointers.html\" rel=\"nofollow noreferrer\">link</a>, <a href=\"https://blog.regehr.org/archives/213\" rel=\"nofollow noreferrer\">link</a>, <a href=\"https://stackoverflow.com/questions/12102880/does-pointer-arithmetic-still-work-outside-the-array\">link</a>, <a href=\"https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true/45970808#45970808\">link</a>). It always ends up to the same conclusion: Pointer arithmetic is well defined only on array type and between array[0] and array[array_size+1] (one element past the end is valid with regard to the C standard).</p>\n\n<p>My question is: Does it means that when the compiler sees a pointer arithmetic not related to any array (undefined behavior), it could emit what it want (even nothing) ? Or is it more a high level \"undefined behavior\" meaning you could reach unmapped memory, garbage data, etc and there is not guarantee about the address validity?</p>\n\n<p>In this example:</p>\n\n<pre><code>char test[10];\nchar * ptr = &amp;test[0];\nprintf(\"test[-1] : %d\", *(ptr-1))\n</code></pre>\n\n<p>By \"undefined behavior\", is it just that the value is not guarantee at all (could be garbage, unmapped memory, etc) but we can still say with certainty that we are accessing the memory address contiguous to the array 8 bytes before the start? Or is it \"undefined behavior\" in a way that the compiler can just not emit this code at all?</p>\n\n<p>Another simple use case: You want to compute the in-memory size of one function. One na\u00efve implementation could be the following code assuming that the functions are outputted in the binary in the same order, are contiguous and without any padding in between.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid func1()\n{}\n\nvoid func2()\n{}\n\nint main()\n{\n  uint8_t * ptr1 = (uint8_t*) &amp;func1;\n  uint8_t * ptr2 = (uint8_t*) &amp;func2;\n\n  printf(\"Func 1 size : %ld\", ptr2-ptr1);\n\n  return 0;\n}\n\n</code></pre>\n\n<p>Since <code>ptr1</code> and <code>ptr2</code> are not part of an array, it is considered as undefined behavior. Again, does it means the compiler could not emit those code? Or does \"undefined behavior\" means that the subtraction is meaningless depending on the system (functions not contiguous in memory, with padding, etc) but still occurs as expected? Is there any well defined way to compute the subtraction between two unrelated pointers? </p>\n"}, {"tags": ["c", "linux", "strace", "lib"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559131590, "post_id": 56360218, "comment_id": 99323771, "body": "Are you linking with your library or loading it with <code>dlopen</code>?"}, {"owner": {"reputation": 3, "user_id": 11572655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mFYrknZz_Qw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmVf0iH4moAZXnzds-mUPnOPAn6g/mo/photo.jpg?sz=128", "display_name": "Smirnoff Denis", "link": "https://stackoverflow.com/users/11572655/smirnoff-denis"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559132155, "post_id": 56360218, "comment_id": 99324095, "body": "load with &#39;dlopen&#39;"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559135151, "post_id": 56360218, "comment_id": 99325974, "body": "Then do <code>dlopen</code> fail or succeed? If it fails, with what error?"}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1559136160, "last_edit_date": 1592644375, "creation_date": 1559136160, "answer_id": 56361679, "question_id": 56360218, "link": "https://stackoverflow.com/questions/56360218/why-no-call-fstab64-after-read-and-can-this-be-a-problem/56361679#56361679", "title": "Why no call fstab64 after read? And can this be a problem?", "body": "<p>You're trying to load a 64-bit shared object into a 32-bit process.</p>\n<p>The <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF header</a> read by these two <code>read()</code> calls:</p>\n<pre><code>read(12, &quot;\\177ELF\\1\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0\\3\\0\\1\\0\\0\\0\\3409\\0&quot;...,     1024) = 1024\n</code></pre>\n<p>and</p>\n<pre><code>read(12, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0`\\210\\0\\0&quot;...,     1024) = 1024\n</code></pre>\n<p>differ.  Note that the fifth byte in the first <code>read()</code> is <code>1</code>.  That's the <strong>successful</strong> load of a 32-bit shared object.</p>\n<p>That fifth byte is <code>2</code> on the <strong>unsuccessful</strong> attempt - and that <code>2</code> means that the shared object is a 64-bit shared object.</p>\n<p>You likely need to compile and link with the <code>-m32</code> option.</p>\n"}], "owner": {"reputation": 3, "user_id": 11572655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mFYrknZz_Qw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmVf0iH4moAZXnzds-mUPnOPAn6g/mo/photo.jpg?sz=128", "display_name": "Smirnoff Denis", "link": "https://stackoverflow.com/users/11572655/smirnoff-denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56361679, "answer_count": 1, "score": -1, "last_activity_date": 1559136160, "creation_date": 1559131443, "question_id": 56360218, "link": "https://stackoverflow.com/questions/56360218/why-no-call-fstab64-after-read-and-can-this-be-a-problem", "title": "Why no call fstab64 after read? And can this be a problem?", "body": "<p>I want to create a new dynamic library instead of another, the source code of which is lost. I have created a library with exported functions, but the program does not load it. Conclusion Strace is almost the same, the only difference is that in the case of loading my library after the call to read() there is no call to fstat64().</p>\n\n<p>strace original library:</p>\n\n<pre><code>open(\"/usr/local/lpr/li2/libSA.so\", O_RDONLY) = 12\nread(12, \"\\177ELF\\1\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0\\3\\0\\1\\0\\0\\0\\3409\\0\"...,     1024) = 1024\nfstat64(12, {st_mode=S_IFREG|0644, st_size=46166, ...}) = 0\nold_mmap(NULL, 40256, PROT_READ|PROT_EXEC, MAP_PRIVATE, 12, 0) = 0x40150000\nmprotect(0x40159000, 3392, PROT_NONE)   = 0\nold_mmap(0x40159000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 12, 0x8000) = 0x40159000\nclose(12)                               = 0\n</code></pre>\n\n<p>my library:</p>\n\n<pre><code>open(\"/usr/local/lpr/li2/libSA.so\", O_RDONLY) = 12\nread(12, \"\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0`\\210\\0\\0\"...,     1024) = 1024\nclose(12)                               = 0\ntime(NULL)\n</code></pre>\n"}, {"tags": ["c", "header", "dbus"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559131144, "post_id": 56360049, "comment_id": 99323507, "body": "Is it possible to partition your code so that one file include <code>gio.h</code> and another includes <code>gdbus.h</code>, but neither includes both?  That would be the cleanest solution.  Hopefully there won&#39;t be any symbol table conflicts when you try to link the result."}, {"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559131366, "post_id": 56360049, "comment_id": 99323629, "body": "@TomKarzes That may ultimately be impossible because inside adv.c I need to make two operations. One operation uses symbols from &lt;gio.h&gt; AND the other uses symbols from gdbus.h. E"}, {"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559131452, "post_id": 56360049, "comment_id": 99323687, "body": "Even if you split them up into two files and include the libs in a mutually exclusive manner, they will indirectly appear together simultaneously in a third file, correct?"}, {"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559131778, "post_id": 56360049, "comment_id": 99323885, "body": "@TomKarzes Still you got me thinking. Let me see what I can do in that direction."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559132056, "post_id": 56360049, "comment_id": 99324037, "body": "You appear to have a deeper problem.  Not so surprisingly, I find that the BueZ sources use glib.  That explains why your two headers rely on some of the same symbols.  But that the symbol definitions do not match means that they are using <i>different versions</i> of glib.  This is unlikely to end well unless you can reconcile that difference."}, {"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559132907, "post_id": 56360049, "comment_id": 99324564, "body": "@JohnBollinger Thanks for your answer. The only reason for reusing some of their code is for making DBus calls to their own methods like RegisterAdvertisement. I would like to reuse their code which does all this without having to construct my own DBus object and exporting it, viz is a royal pain in C"}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "edited": false, "score": 0, "creation_date": 1559135382, "post_id": 56361407, "comment_id": 99326120, "body": "Philip thanks for your answer. I am not having issues trying to use GDBus  APIs. The problem is that I am trying to incorporate code from BlueZ to ccall its well known methods like RegisterAdvertisement etc..."}, {"owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "edited": false, "score": 0, "creation_date": 1559135552, "post_id": 56361407, "comment_id": 99326231, "body": "Coming up with DBus Advertisement object, exporting it and then invoking the RegisterAdvertisement is just boilerplate code which I hoped I could just copy paste borrow from BlueZ (gdbus.h and objects.c). Unfortunately that it turning out to be lot harder."}], "tags": [], "owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "is_accepted": false, "score": 0, "last_activity_date": 1559135253, "creation_date": 1559135253, "answer_id": 56361407, "question_id": 56360049, "link": "https://stackoverflow.com/questions/56360049/how-to-resolve-conflicting-types-problem-in-c/56361407#56361407", "title": "How to resolve conflicting types problem In C", "body": "<p>Don\u2019t use the <a href=\"https://git.kernel.org/pub/scm/bluetooth/bluez.git/tree/gdbus/gdbus.h\" rel=\"nofollow noreferrer\"><code>gdbus.h</code> from BlueZ</a>. It\u2019s not compatible with GLib, yet erroneously uses the GLib symbol namespace (the <code>g_</code> or <code>G</code> prefix).</p>\n\n<p>Use the <a href=\"https://developer.gnome.org/gio/stable/gdbus-convenience.html\" rel=\"nofollow noreferrer\">GDBus API from GLib itself</a>, seeing as you\u2019re already using GLib/GIO in your project.</p>\n"}], "owner": {"reputation": 1303, "user_id": 2762832, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2eecc13c573ed26c474100424c2a6b47?s=128&d=identicon&r=PG&f=1", "display_name": "Ace", "link": "https://stackoverflow.com/users/2762832/ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559135253, "creation_date": 1559130937, "question_id": 56360049, "link": "https://stackoverflow.com/questions/56360049/how-to-resolve-conflicting-types-problem-in-c", "title": "How to resolve conflicting types problem In C", "body": "<p>I am trying to re-use BlueZ code in my own C program to manage Bluetooth connection and running into compilation issues. </p>\n\n<p>When I analyzed the problem further here is what I think is happening:</p>\n\n<p>It all comes down to my program structure:</p>\n\n<pre><code>1.myadv.c includes myadv.h includes gio.h\n2. myadv.c includes \"gdbus.h\" (Helper lib)\n\n</code></pre>\n\n<p>Now the problem is gdbus.h has certain symbol definitions (typedef, methods etc...) that conflict with internal defs in gio.h</p>\n\n<p>Because of that I get compiler errors like this:</p>\n\n<pre><code>/usr/include/glib-2.0/gio/gioenums.h:1383:3: error: conflicting types for \u2018GDBusSignalFlags\u2019\n } GDBusSignalFlags;\n   ^~~~~~~~~~~~~~~~\n\nconflicting types for \u2018g_dbus_proxy_new\u2019\n void             g_dbus_proxy_new  \n\n</code></pre>\n\n<p>What is the best practice to avoid such symbol conflict errors during inclusion? Please note, I need to use both header files:</p>\n\n<ol>\n<li>gio.h (The gnome lib)</li>\n<li>gdbus.h (The dbus helper directly borrowed from BlueZ)</li>\n</ol>\n"}, {"tags": ["c", "openmp", "hpc", "reduction"], "answers": [{"comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 1, "creation_date": 1559133693, "post_id": 56360563, "comment_id": 99325085, "body": "There are a couple of additional useful resources for delving into an OpenMP implementation: 1) Compiler Explorer (<a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a>) lets you paste in a small code sample and look at the code generated by many compilers. 2) The LLVM OpenMP runtime source is available at <a href=\"http://openmp.llvm.org\" rel=\"nofollow noreferrer\">openmp.llvm.org</a>"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1559134343, "post_id": 56360563, "comment_id": 99325446, "body": "Great answer! Regarding the question whether OpenMP implementations will use tree-based reductions, I&#39;d refer to <a href=\"https://stackoverflow.com/a/35805567/620382\">stackoverflow.com/a/35805567/620382</a> (Answer: No for libgomp as of 2016)."}], "tags": [], "owner": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "is_accepted": true, "score": 4, "last_activity_date": 1559148409, "last_edit_date": 1559148409, "creation_date": 1559132584, "answer_id": 56360563, "question_id": 56359957, "link": "https://stackoverflow.com/questions/56359957/how-does-reduction-operations-in-openmp-work-under-the-hood/56360563#56360563", "title": "How does reduction operations in OpenMP work under the hood?", "body": "<p>Each thread will have its own copy of 'delta' on its stack frame:</p>\n\n<pre><code>#pragma omp parallel shared(delta, A, B, rows, colms) private(i, j)\n{\n    double local_delta; // one copy per thread\n\n    __omp_init_schedule(1, rows, &amp;lb, &amp;ub);\n    for (i=lb; i&lt;=ub; i++) {\n        for (j=1; j&lt;=colms; j++) {\n                local_delta += fabs(A[i][j]- B[i][j]);\n        }\n    }\n   __omp_reduce(&amp;delta, local_delta);  // accumulate thread's delta with shared var\n   __omp_barrier();                    // do the barrier of the for construct\n}\n</code></pre>\n\n<p>Please take the above as pseudo-code.  The actual code pattern will depend on the implementation, inlining, and all sorts of other optimization an OpenMP implementation might do.  If you want to read a bit about how things work please have a look at [1] and [2].</p>\n\n<p>The implementation of <code>__omp_reduce()</code> can either be something tree-based or sequential using either locks or atomic instructions.  OpenMP implementations are usually rather smart and choose the right algorithm for the machine and/or the number of threads being used.</p>\n\n<p>Doing the <code>delta[numthreads]</code> modification will likely reduce performance by more than 100x, as this is the typical example for false-sharing as <code>delta[0]</code> for thread 0 and <code>delta[1]</code> for thread one will be in the same cache line and this cause a lot of traffic on the cache and the memory.  A better appraoch would be to introduce patting <code>delta[numthreads * 8]</code> (assuming that <code>delta</code> is 8 bytes), so that each thread gets its own cache line.  However, then you still need to perform the final aggregation and likely the OpenMP implementation still does a better job.</p>\n\n<p>[1] <a href=\"https://www.dontknow.de/openmp-stuff/the-thing-from-another-world-or-how-do-openmp-compilers-work-part-1/\" rel=\"nofollow noreferrer\">https://www.dontknow.de/openmp-stuff/the-thing-from-another-world-or-how-do-openmp-compilers-work-part-1/</a></p>\n\n<p>[2] <a href=\"https://www.dontknow.de/openmp-stuff/thunk-you-very-much-or-how-do-openmp-compilers-work-part-2/\" rel=\"nofollow noreferrer\">https://www.dontknow.de/openmp-stuff/thunk-you-very-much-or-how-do-openmp-compilers-work-part-2/</a></p>\n"}], "owner": {"reputation": 84, "user_id": 10593130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc36714ad18c4140a1034c2f66b6877?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Hadjigeorgiou", "link": "https://stackoverflow.com/users/10593130/andreas-hadjigeorgiou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 56360563, "answer_count": 1, "score": 0, "last_activity_date": 1559148409, "creation_date": 1559130624, "question_id": 56359957, "link": "https://stackoverflow.com/questions/56359957/how-does-reduction-operations-in-openmp-work-under-the-hood", "title": "How does reduction operations in OpenMP work under the hood?", "body": "<p>I am trying to optimize the performance in a <strong><em>parallel-for</em></strong> loop where I have a reduction variable (called <em>delta</em>) and I am wondering how this is handled under the hood by the OpenMP library.</p>\n\n<p>Lets take as an example the following piece of code, where I simply declare the variable as a reduction one, at the beginning of the loop as follows:</p>\n\n<pre><code>#pragma omp parallel shared(delta, A, B, rows, colms) private(i, j)\n.\n.\n.\n    #pragma omp for reduction(+:delta)\n            for (i=1; i&lt;=rows; i++){\n                for (j=1; j&lt;=colms; j++){\n                delta += fabs(A[i][j]- B[i][j]);\n                }\n    }\n.\n.\n.\n//end of parallel region\n</code></pre>\n\n<p>I am wondering whether during the calculation each thread sets a lock when accessing the <em>delta</em> variable and furthermore whether I could increase the performance by replacing <em>delta</em> variable with an array <em>delta[number_of_threads]</em>,  where each thread will write in a different position of the array during the calculation and then sum-up all the elements after the parallel region.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 2, "last_activity_date": 1559137663, "creation_date": 1559137663, "answer_id": 56362125, "question_id": 56359883, "link": "https://stackoverflow.com/questions/56359883/real-meaning-of-the-3rd-parameter-of-ior/56362125#56362125", "title": "Real meaning of the 3rd parameter of _IOR", "body": "<p>The size of the type becomes part of the ioctl number. This is intended to catch errors where the kernel and userspace accidentally use different types (or different definitions of the same type).</p>\n\n<p>But that field has no effect on the behaviour of the ioctl (unless your driver explicitly reads it).</p>\n"}], "owner": {"reputation": 1, "user_id": 11531653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea6e2ede6ce12689c94736b2fed0faa7?s=128&d=identicon&r=PG&f=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/11531653/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559140426, "creation_date": 1559130326, "last_edit_date": 1559140426, "question_id": 56359883, "link": "https://stackoverflow.com/questions/56359883/real-meaning-of-the-3rd-parameter-of-ior", "title": "Real meaning of the 3rd parameter of _IOR", "body": "<p>I have one driver and daemon, daemon access driver using <em>ioctl</em>, I am a bit confused about the third parameter of <code>_IOR</code>:</p>\n\n<pre><code>#define _IOR(type,nr,size)  _IOC(_IOC_READ,(type),(nr),(_IOC_TYPECHECK(size)))\n</code></pre>\n\n<p>I have some code as following,\n<em>ioctl</em> cmd defetnition:</p>\n\n<pre><code>#define TEST_GET_NUM_A  _IOR(TESTIO, 0x01, uint8_t *)\n#define TEST_GET_NUM_B  _IOR(TESTIO, 0x02, uint8_t)\n</code></pre>\n\n<p><em>ioctl</em> in driver:</p>\n\n<pre><code>case TEST_GET_NUM_A:\n    rc = put_user(data-&gt;num_keys, (uint8_t __user *) arg);\n    break;\ncase TEST_GET_NUM_B:\n    rc = put_user(data-&gt;num_keys, (uint8_t __user *) arg);\n    break;\n</code></pre>\n\n<p><em>ioctl</em> in daemon:</p>\n\n<pre><code>uint8_t num_keys = 0;\nrc = ioctl(fd, TEST_GET_NUM_A/TEST_GET_NUM_B, &amp;num_keys);\nif (rc &lt; 0) {\n    ALOGE(\"ioctl failed %d\", rc);\n    close(fd);\n    return rc;\n}\n</code></pre>\n\n<p>both <code>TEST_GET_NUM_A</code> and <code>TEST_GET_NUM_B</code> work well, no crash happen. \nMy question is which one is correct one, or both?</p>\n\n<p><code>_IOR(type,nr,size)</code> size means the size of 3rd parameter in <code>ioctl(fd, TEST_GET_NUM_A/B, &amp;num_keys)</code> or means the size of the data passed from kernel to user space? </p>\n"}, {"tags": ["python", "c", "swig", "python-c-api"], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1559129677, "last_edit_date": 1592644375, "creation_date": 1559129677, "answer_id": 56359664, "question_id": 56359403, "link": "https://stackoverflow.com/questions/56359403/issue-with-swig-for-creating-python-bindings-for-c-library/56359664#56359664", "title": "Issue with SWIG for creating Python bindings for C library", "body": "<p>SWIG generates a module with <em>underscore prepended by default</em>, so you'll get a module called <code>_example</code> which needs to be in <code>_example.so</code>.</p>\n<p>This is explained in the <a href=\"http://www.swig.org/Doc2.0/Python.html#Python_nn7\" rel=\"nofollow noreferrer\">SWIG documentation 34.2.3 Hand compiling a dynamic module</a>:</p>\n<blockquote>\n<p>While the preferred approach to building an extension module is to use the distutils, some people like to integrate building extensions with a larger build system, and thus may wish to compile their modules without the distutils. To do this, you need to compile your program using commands like this (shown for Linux):</p>\n<pre><code>$ swig -python example.i\n$ gcc -O2 -fPIC -c example.c\n$ gcc -O2 -fPIC -c example_wrap.c -I/usr/local/include/python2.5\n$ gcc -shared example.o example_wrap.o -o _example.so\n</code></pre>\n<p>The exact commands for doing this vary from platform to platform. However, SWIG tries to guess the right options when it is installed. Therefore, you may want to start with one of the examples in the SWIG/Examples/python directory. If that doesn't work, you will need to read the man-pages for your compiler and linker to get the right set of options. You might also check the SWIG Wiki for additional information.</p>\n<p><strong>When linking the module, the name of the output file has to match the name of the module prefixed by an underscore. If the name of your module is <code>example</code>, then the name of the corresponding object file should be <code>_example.so</code> or <code>_examplemodule.so</code>. The name of the module is specified using the %module directive or the -module command line option.</strong></p>\n<p>Compatibility Note: In SWIG-1.3.13 and earlier releases, module names did not include the leading underscore. This is because modules were normally created as C-only extensions without the extra Python support file (instead, creating Python code was supported as an optional feature). This has been changed in SWIG-1.3.14 and is consistent with other Python extension modules. For example, the socket module actually consists of two files; <code>socket.py</code> and <code>_socket.so</code>. Many other built-in Python modules follow a similar convention.</p>\n</blockquote>\n"}], "owner": {"reputation": 59, "user_id": 11572298, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Fv4jSRnYaxk/AAAAAAAAAAI/AAAAAAAAAbA/J-C6Gm4re-g/photo.jpg?sz=128", "display_name": "Judicator", "link": "https://stackoverflow.com/users/11572298/judicator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 56359664, "answer_count": 1, "score": 3, "last_activity_date": 1559129693, "creation_date": 1559128784, "last_edit_date": 1559129693, "question_id": 56359403, "link": "https://stackoverflow.com/questions/56359403/issue-with-swig-for-creating-python-bindings-for-c-library", "title": "Issue with SWIG for creating Python bindings for C library", "body": "<p>I want to use SWIG to create Python bindings for C library, but I have some troubles with it. I used the following .c and .i files from tutorial.\nexample.c</p>\n\n<pre><code>/* Compute factorial of n */\nint fact(int n) {\n  if (n &lt;= 1)\n    return 1;\n  else\n    return n*fact(n-1);\n}\n\n/* Compute n mod m */\nint my_mod(int n, int m) {\n  return(n % m);\n}\n\ndouble My_variable;\n</code></pre>\n\n<p>example.i</p>\n\n<pre><code>%module example\n%{\nextern double My_variable;\nextern int    fact(int);\nextern int    my_mod(int n, int m);\n%}\n\nextern double My_variable;\nextern int    fact(int);\nextern int    my_mod(int n, int m);\n</code></pre>\n\n<p>Commands that I used:</p>\n\n<pre><code>$ swig -python -py3 example.i\n$ gcc -c -fpic example.c example_wrap.c -I/usr/include/python3.6\n$ gcc -shared example.o example_wrap.o -o example.so\n</code></pre>\n\n<p>And when I try to import it in python3 I am getting this</p>\n\n<pre><code>&gt;&gt;&gt; import example\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nImportError: dynamic module does not define module export function (PyInit_example)\n</code></pre>\n\n<p>Any help appreciated</p>\n"}, {"tags": ["c", "linux-kernel", "operating-system", "system-calls"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559133342, "post_id": 56359402, "comment_id": 99324857, "body": "I&#39;m lacking a <code>main</code> function. Please produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559133527, "post_id": 56359402, "comment_id": 99324973, "body": "Also, in the process of making it minimal, you can probably remove three loops from <code>SYSCALL_DEFINE1</code> and the three <code>else if</code> from <code>yanpan_oper</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9243512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68c09f9c4c8c6ca28de865596b896f9?s=128&d=identicon&r=PG", "display_name": "yanpan", "link": "https://stackoverflow.com/users/9243512/yanpan"}, "edited": false, "score": 0, "creation_date": 1559132625, "post_id": 56359593, "comment_id": 99324395, "body": "Hello, thanks for your answer. In fact, I have guessed the reason is the optimization of the compiler. As what I mentioned in question, I just change the code of addition to at every iteration, it does the addition : <code>yanpan_oper(&amp;result, result, 1, op_add)</code>.  Finally, I print the result after all addition. But the time nearly have no change. I think the compiler cannot be so intelligence. That&#39;s why I felt strange about this."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 33, "user_id": 9243512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68c09f9c4c8c6ca28de865596b896f9?s=128&d=identicon&r=PG", "display_name": "yanpan", "link": "https://stackoverflow.com/users/9243512/yanpan"}, "edited": false, "score": 0, "creation_date": 1559132871, "post_id": 56359593, "comment_id": 99324545, "body": "With that code, you have UB since you have not initialized <code>result</code> and even if you do initialize it, the computation is still theoretically possible to compute at compile time."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559133067, "post_id": 56359593, "comment_id": 99324686, "body": "A compiler is allowed to &quot;optimize&quot; calls to the function only if it is able to prove that the function has <b>no side effects</b>. While on certain values of input arguments <code>yanpan_oper</code> is actually has no side effects (not sure about output parameter <code>result</code>), I doubt that compiler is able to prove that. Without such proving, a compiler is never allowed to reduce loops: the resulted binary code calls <code>yanpan_oper</code> as many times as specified in the source code."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559133216, "post_id": 56359593, "comment_id": 99324778, "body": "@Tsyvarev True, but why not make sure that the optimizer cannot do so instead of making wild guesses about how smart it is?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559133628, "post_id": 56359593, "comment_id": 99325037, "body": "@Broman: Random values and especiall arrays of them looks like an ugly way for prevent compiler from code optimization. Of course, this are just my feelings. But in any case, it could be useful to check that <b>binary code</b>, generated from the <b>original sources</b>, actually drops the function calls. If it doesn&#39;t, then the problem of zero-time is somewhere else..."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559133822, "post_id": 56359593, "comment_id": 99325167, "body": "@Tsyvarev I agree that it is a bit ugly, but since this kind of code by it&#39;s nature is temporary I don&#39;t think it&#39;s such a big deal. But yes checking the binary code (or even better, the assembly code) is also a great thing to do."}, {"owner": {"reputation": 33, "user_id": 9243512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68c09f9c4c8c6ca28de865596b896f9?s=128&d=identicon&r=PG", "display_name": "yanpan", "link": "https://stackoverflow.com/users/9243512/yanpan"}, "edited": false, "score": 0, "creation_date": 1559134315, "post_id": 56359593, "comment_id": 99325428, "body": "@Broman I forget to say that: I used to print every result. Then the cost time can be very big. But what I am comparing is computational costs not output costs. So, maybe printing all result cannot be a proper method. I&#39;m so frustrated about this experiment..."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 33, "user_id": 9243512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68c09f9c4c8c6ca28de865596b896f9?s=128&d=identicon&r=PG", "display_name": "yanpan", "link": "https://stackoverflow.com/users/9243512/yanpan"}, "edited": false, "score": 0, "creation_date": 1559135298, "post_id": 56359593, "comment_id": 99326075, "body": "@yanpan Read my code again. There are no printouts in the code that is benchmarked. The clock stops before the prints. Also, read my <a href=\"https://stackoverflow.com/questions/56359402/why-my-time-count-of-a-system-call-in-linux-is-almost-0-us/56359593?noredirect=1#comment99324857_56359402\">comments</a> I wrote on your question."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1559131187, "last_edit_date": 1559131187, "creation_date": 1559129446, "answer_id": 56359593, "question_id": 56359402, "link": "https://stackoverflow.com/questions/56359402/why-my-time-count-of-a-system-call-in-linux-is-almost-0-us/56359593#56359593", "title": "Why my time count of a system call in linux is almost 0 us?", "body": "<p>Let's look at one loop:</p>\n\n<pre><code>for(i=0;i&lt;count;i++) // +\n{\n    int result;\n    char op_add = '+';\n    yanpan_oper(&amp;result, i, 10, &amp;op_add);\n}\n</code></pre>\n\n<p>This will call the function yanpan_oper <code>count</code> times. But each time it will overwrite the previous result stored in <code>result</code> without using that value for the computation. Chances are that the compiler just optimized the whole loop away, replacing it with just one single call to <code>yanpan_oper</code> since the for loop is actually equivalent to just executing the loop body once.</p>\n\n<p>Furthermore, the loop body ONLY affects variables inside the loop body, so not only can the compiler decide to just keep the last iteration. It can skip basically the whole code, so that what you're actually executing is this:</p>\n\n<pre><code>SYSCALL_DEFINE1(yanpan_func, int, count)\n{\n    printk(\"The count is %d.\\n\", count);\n    struct timeval tstart, tend;\n    do_gettimeofday(&amp;tstart);\n    do_gettimeofday(&amp;tend);\n    long delta_time = 1000000*(tend.tv_sec - tstart.tv_sec) + (tend.tv_usec - tstart.tv_usec);\n    printk(\"The start time is %ld.\\n\", tstart.tv_sec*1000000+tstart.tv_usec);\n    printk(\"The end time is %ld.\\n\", tend.tv_sec*1000000+tend.tv_usec);\n    printk(\"Syscall time use:%ld usec\", delta_time);\n    return delta_time;\n}\n</code></pre>\n\n<p>Here are some tips for how to fool the optimizer:</p>\n\n<pre><code>// Create input that cannot be calculated at compile time\nint input1[count];\nint input2[count];\nsrand(time(NULL));\nfor(int i=0; i&lt;count; i++) { \n    input1[i] = rand()%1000;\n    input2[i] = rand()%1000;\n}\n\n// Store the output, so that the optimizer cannot take away the loop\nint output[count];\n\n// Start timer\nfor(i=0;i&lt;count;i++) // +\n{\n    char op_add = '+';\n    yanpan_oper(&amp;output[i], input1[i], input2[i], &amp;op_add);\n}\n// End timer\n\n// Use the output to that the optimizer cannot remove the array, and thus\n// also the loop\nfor(int i=0; i&lt;count; i++) \n    printf(\"%d \", output[i]);\n</code></pre>\n\n<p>Do note that those arrays may be to big for the stack. If that's the case, use this instead:</p>\n\n<pre><code>int *input1 = malloc(count * sizeof(*input1));\nint *input2 = malloc(count * sizeof(*input2));\nsrand(time(NULL));\nfor(int i=0; i&lt;count; i++) { \n    input1[i] = rand()%1000;\n    input2[i] = rand()%1000;\n}\n\nint *output = malloc(count * sizeof(*output));\n</code></pre>\n\n<p>(Remember to check if malloc succeeded and to free the memory afterwards)</p>\n"}], "owner": {"reputation": 33, "user_id": 9243512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68c09f9c4c8c6ca28de865596b896f9?s=128&d=identicon&r=PG", "display_name": "yanpan", "link": "https://stackoverflow.com/users/9243512/yanpan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559131187, "creation_date": 1559128782, "question_id": 56359402, "link": "https://stackoverflow.com/questions/56359402/why-my-time-count-of-a-system-call-in-linux-is-almost-0-us", "title": "Why my time count of a system call in linux is almost 0 us?", "body": "<p>Nowadays, I'm working on a system kernel practice course. However, when I compare a system call with an user call, it's strange that the system call return a time count of 0 us (sometimes return 1). But I pass count=1e8 which is a quite big number.</p>\n\n<p>I'm doubt that the computations didn't happen because the result is not used. Then I change add as result = result + 1 and print the final result. However, the result is right and the time count just from 0 or 1 change to 2-6.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>long yanpan_oper(int* result,int num1,int num2,char* op)\n{\n    if(op)\n    {\n        if(*op == '+')\n        {\n            *result = num1 + num2;\n        }\n        else if(*op == '-')\n        {\n            *result = num1 - num2;\n        }\n        else if(*op == '*')\n        {\n            *result = num1*num2;\n        }\n        else if(*op == '\\\\')\n        {\n            if(num2!=0)\n                *result = num1/num2;\n            else\n                printk(\"divided number can't be zero!\\n\");\n        }else\n            printk(\"unrecongized operator %c\\n\", *op);\n    }else\n    {\n        printk(\"operation is empty.\\n\");\n    }\n    return 0;\n}\nSYSCALL_DEFINE1(yanpan_func, int, count)\n{\n    printk(\"The count is %d.\\n\", count);\n    struct timeval tstart, tend;\n    do_gettimeofday(&amp;tstart);\n    int i;\n    for(i=0;i&lt;count;i++) // +\n    {\n        int result;\n        char op_add = '+';\n        yanpan_oper(&amp;result, i, 10, &amp;op_add);\n    }\n    for(i=0;i&lt;count;i++) // -\n    {\n        int result;\n        char op_sub = '-';\n        yanpan_oper(&amp;result, i, 10, &amp;op_sub);\n    }\n    for(i=0;i&lt;count;i++) // *\n    {\n        int result;\n        char op_mul = '*';\n        yanpan_oper(&amp;result, i, 2, &amp;op_mul);\n    }\n    for(i=0;i&lt;count;i++) // '//'\n    {\n        int result;\n        char op_div = '\\\\';\n        yanpan_oper(&amp;result, i, 10, &amp;op_div);\n    }\n    do_gettimeofday(&amp;tend);\n    long delta_time = 1000000*(tend.tv_sec - tstart.tv_sec) + (tend.tv_usec - tstart.tv_usec);\n    printk(\"The start time is %ld.\\n\", tstart.tv_sec*1000000+tstart.tv_usec);\n    printk(\"The end time is %ld.\\n\", tend.tv_sec*1000000+tend.tv_usec);\n    printk(\"Syscall time use:%ld usec\", delta_time);\n    return delta_time;\n}\n</code></pre>\n\n<p>I have tried many times, but the result didn't change. The user call computation of the same amount takes around 1300 ms, can computations occur in kernel be fast like this?</p>\n"}, {"tags": ["c", "compiler-construction", "grammar", "bison", "context-free-grammar"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1559132192, "post_id": 56358948, "comment_id": 99324115, "body": "Are you sure you didn&#39;t get any warnings about conflicts? I get a conflict when I run your code through bison and the verbose output you posted contains a reduce in square brackets, which would also indicate a conflict."}, {"owner": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1559132312, "post_id": 56358948, "comment_id": 99324186, "body": "@sepp2k, I am sorry. I decided to check out, output has <code>Parser.y: conflicts: 1 shift&#47;reduce</code> I will fix that it question"}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 4, "creation_date": 1559160514, "post_id": 56359933, "comment_id": 99338584, "body": "It&#39;s a shift/reduce conflict, not a reduce/reduce conflict: reduce an empty <code>foo</code> or shift a <code>(</code> which will start a <code>foo</code>. <code>bar</code> is not possible until after a <code>foo</code> has been reduced. So there is no question that a <code>foo</code> is required; the question is whether the <code>foo</code> is empty or not. So this case is not &quot;mysterious&quot; at all."}], "tags": [], "owner": {"reputation": 147, "user_id": 2358510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aaWSZ.jpg?s=128&g=1", "display_name": "Thomas G.", "link": "https://stackoverflow.com/users/2358510/thomas-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1559130496, "creation_date": 1559130496, "answer_id": 56359933, "question_id": 56358948, "link": "https://stackoverflow.com/questions/56358948/unexpected-behavior-of-generated-bison-parser/56359933#56359933", "title": "Unexpected behavior of generated bison parser", "body": "<p>Bison generates by default LALR(1) parsers. LALR(1) stands for look ahead 1 token left to right parser.</p>\n\n<p>Your grammars is not LALR(1). On OP it is not clear if to expect a foo or a bar. That is a reduce/reduce conflict.</p>\n\n<p>Look here: \n<a href=\"https://en.wikipedia.org/wiki/LALR_parser\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/LALR_parser</a></p>\n\n<p>But generally Bison could generate an LR parser. At least a wiki entry here claims that:\n<a href=\"https://en.wikipedia.org/wiki/GNU_Bison\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/GNU_Bison</a></p>\n\n<p>Your case is a \"mysterious conflict\": <a href=\"https://www.gnu.org/software/bison/manual/html_node/Mysterious-Conflicts.html#Mysterious-Conflicts\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/bison/manual/html_node/Mysterious-Conflicts.html#Mysterious-Conflicts</a></p>\n"}, {"comments": [{"owner": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "edited": false, "score": 1, "creation_date": 1559131641, "post_id": 56360097, "comment_id": 99323804, "body": "But why does that sample work? what is the difference in grammar?"}, {"owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "reply_to_user": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "edited": false, "score": 1, "creation_date": 1559132033, "post_id": 56360097, "comment_id": 99324026, "body": "Now it accept bar_expr as input. When earlier it required foo_expr before bar_expr."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1559132910, "post_id": 56360097, "comment_id": 99324569, "body": "Note that this actually increases the number of conflicts unless you remove the empty alternative from <code>foo_expr</code>."}], "tags": [], "owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "is_accepted": false, "score": 3, "last_activity_date": 1559131803, "last_edit_date": 1559131803, "creation_date": 1559131077, "answer_id": 56360097, "question_id": 56358948, "link": "https://stackoverflow.com/questions/56358948/unexpected-behavior-of-generated-bison-parser/56360097#56360097", "title": "Unexpected behavior of generated bison parser", "body": "<p>If you want to accept just <code>(bar)</code> as input, you could use the following:</p>\n\n<pre><code>program_expr :   foo_expr bar_expr   {}\n    |            bar_expr            {}\n;    \n</code></pre>\n\n<p>instead of this:</p>\n\n<pre><code>program_expr :   foo_expr bar_expr   {}\n;\n</code></pre>\n\n<p>Test output:</p>\n\n<pre><code>&gt; echo \"(bar)\" | ./Parser \nStarting parse\nEntering state 0\nReading a token: Next token is token OP ()\nShifting token OP ()\nEntering state 1\nReading a token: Next token is token BAR ()\nShifting token BAR ()\nEntering state 6\nReading a token: Next token is token CP ()\nShifting token CP ()\nEntering state 11\nReducing stack by rule 6 (line 20):\n   $1 = token OP ()\n   $2 = token BAR ()\n   $3 = token CP ()\n-&gt; $$ = nterm bar_expr ()\nStack now 0\nEntering state 4\nReducing stack by rule 2 (line 14):\n   $1 = nterm bar_expr ()\n-&gt; $$ = nterm program_expr ()\nStack now 0\nEntering state 2\nReading a token: Now at end of input.\n....\n</code></pre>\n"}], "owner": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 56359933, "answer_count": 2, "score": 2, "last_activity_date": 1559132326, "creation_date": 1559127421, "last_edit_date": 1592644375, "question_id": 56358948, "link": "https://stackoverflow.com/questions/56358948/unexpected-behavior-of-generated-bison-parser", "title": "Unexpected behavior of generated bison parser", "body": "<p>I created parser via Flex/Bison, which unexpectedly fails during parsing. Here is simplified sample which shows problem</p>\n<p>Lexer.l:</p>\n<pre><code>%{\n#include &quot;Parser.h&quot;\n%}\n%option noyywrap nodefault\n\n%%\n&quot;foo&quot;               {   return FOO;                          }\n&quot;bar&quot;               {   return BAR;                          }\n&quot;(&quot;                 {   return OP;                           }\n&quot;)&quot;                 {   return CP;                           }\n[ \\t\\n]+            {   /*    DO NOTHING  */                 }\n.                   {   YY_FATAL_ERROR(&quot;unknown character&quot;); }\n%%\n</code></pre>\n<p>And Parser.y (with enabled tracing and verbosity):</p>\n<pre><code>%{\n#include &lt;stdio.h&gt;\nint yylex();\nvoid yyerror (char const *s);\n%}\n\n%debug\n%verbose\n%error-verbose\n%token FOO BAR OP CP\n\n%%\nprogram_expr :   foo_expr bar_expr   {}\n;\nfoo_expr :   /*  NOTHING  */  {}\n    |   OP FOO CP           {}\n;\nbar_expr :   /*  NOTHING  */  {}\n    |   OP BAR CP           {}\n;\n%%\n\nint main(int argc, char** argv)\n{\n    yydebug = 1;\n    yyparse();\n    return 0;\n}\n\nvoid yyerror (char const *s) {  fprintf(stderr, &quot;%s\\n&quot;, s); }\n</code></pre>\n<p>But generated parser will fail if I specify input like <code>(bar)</code> - parse tree in that case should contain <code>foo</code> expression which is empty. It reports:</p>\n<blockquote>\n<p>Starting parse</p>\n<p>Entering state 0</p>\n<p>Reading a token: Next token is token OP ()</p>\n<p>Shifting token OP ()</p>\n<p>Entering state 1</p>\n<p>Reading a token: Next token is token BAR ()</p>\n<p>syntax error, unexpected BAR, expecting FOO</p>\n<p>Error: popping token OP ()</p>\n<p>Stack now 0</p>\n<p>Cleanup: discarding lookahead token BAR ()</p>\n<p>Stack now 0</p>\n</blockquote>\n<p>Here is piece of text from generated description of <code>shift/reduce automata</code>:</p>\n<pre><code>state 0\n    0 $accept: . program_expr $end\n    OP  shift, and go to state 1\n    OP        [reduce using rule 2 (foo_expr)]\n    $default  reduce using rule 2 (foo_expr)\n    program_expr  go to state 2\n    foo_expr      go to state 3\n\n\nstate 1\n    3 foo_expr: OP . FOO CP\n    FOO  shift, and go to state 4\nstate 2\n    0 $accept: program_expr . $end\n    $end  shift, and go to state 5\nstate 3\n    1 program_expr: foo_expr . bar_expr\n    OP  shift, and go to state 6\n    $default  reduce using rule 4 (bar_expr)\n    bar_expr  go to state 7\n</code></pre>\n<p>But I cannot understand meaning/syntax of such states. What's problem with my grammar/parser?</p>\n"}, {"tags": ["c", "pointers", "error-handling", "compiler-errors", "inet-aton"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1559127252, "post_id": 56358739, "comment_id": 99321336, "body": "Good read <a href=\"https://beej.us/guide/bgnet/pdf/bgnet_A4_2.pdf\" rel=\"nofollow noreferrer\">inet_aton</a>. Second argument of <code>inet_aton()</code> should be <code>&amp;remote_address.sin_addr</code>"}, {"owner": {"reputation": 692, "user_id": 1714241, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Y3G0s.jpg?s=128&g=1", "display_name": "somethingSomething", "link": "https://stackoverflow.com/users/1714241/somethingsomething"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1559127328, "post_id": 56358739, "comment_id": 99321377, "body": "@Achal thank you so much for that pdf, I&#39;m sure it will do alot for me"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1559127368, "post_id": 56358739, "comment_id": 99321405, "body": "Also, remember to check the value of <code>argc</code> first!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559127808, "post_id": 56358739, "comment_id": 99321657, "body": "You might want to link to the video tutorial / give its title?"}, {"owner": {"reputation": 692, "user_id": 1714241, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Y3G0s.jpg?s=128&g=1", "display_name": "somethingSomething", "link": "https://stackoverflow.com/users/1714241/somethingsomething"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559127931, "post_id": 56358739, "comment_id": 99321727, "body": "@AnttiHaapala I&#39;ve done that"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559128101, "post_id": 56358739, "comment_id": 99321823, "body": "@somethingSomething I fixed the formatting somewhat. I saw other mistakes there as well. Really bad tutorial."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559128207, "post_id": 56358739, "comment_id": 99321877, "body": "For example the server routine reads in only the <i>first</i> line of the HTML file and the HTTP/1.1 protocol response is completely invalid."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1559127087, "creation_date": 1559127087, "answer_id": 56358836, "question_id": 56358739, "link": "https://stackoverflow.com/questions/56358739/warning-passing-argument-2-of-inet-aton-from-incompatible-pointer-type/56358836#56358836", "title": "warning: passing argument 2 of \u2018inet_aton\u2019 from incompatible pointer type........ERROR", "body": "<p>Check the types. From the <a href=\"https://linux.die.net/man/3/inet_aton\" rel=\"nofollow noreferrer\">man page</a></p>\n\n<blockquote>\n  <p><code>int inet_aton(const char *cp, struct in_addr *inp);</code></p>\n</blockquote>\n\n<p>the second argument is a pointer to <code>struct in_addr</code> type variable.</p>\n\n<p>In your code, you defined  <code>remote_address</code> as</p>\n\n<pre><code> struct sockaddr_in remote_address;\n</code></pre>\n\n<p>where <code>struct sockaddr_in</code> is defined as</p>\n\n<pre><code>struct sockaddr_in {\n    short            sin_family;   // e.g. AF_INET\n    unsigned short   sin_port;     // e.g. htons(3490)\n    struct in_addr   sin_addr;     // ***** this is the target\n    char             sin_zero[8];  // zero this if you want to\n};\n</code></pre>\n\n<p>So, your usage </p>\n\n<pre><code> inet_aton(address, &amp;remote_address.sin_addr.s_addr);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>inet_aton(address, &amp;(remote_address.sin_addr)); // explicit parenthesis to clarify type\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559128469, "post_id": 56358837, "comment_id": 99322035, "body": "As a side-note, it is however fine to cast <code>(unsigned long*)&amp;remote_address.sin_addr</code>. This is one of the few cases where such casts are ok, allowed since <code>sin_addr</code> is the first member of the struct (6.7.2.1/15). But the compiler cannot do that pointer conversion implicitly, hence the constraint violation Antti mentions."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559128590, "post_id": 56358837, "comment_id": 99322101, "body": "@Lundin the other way though ;)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559128799, "post_id": 56358837, "comment_id": 99322209, "body": "No? You can cast the address of the struct to a pointer to the type of its first member - it is well-defined. Incidentally you can also go the other way around, since the struct is an &quot;aggregate&quot; containing an unsigned long as (the first) member, but that leaves the rest of the struct members in an undefined state so it is very fishy practice."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559129212, "post_id": 56358837, "comment_id": 99322435, "body": "@Lundin yes but you&#39;ve got the cast that&#39;s the opposite of what&#39;s needed here"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 4, "last_activity_date": 1559127412, "last_edit_date": 1559127412, "creation_date": 1559127091, "answer_id": 56358837, "question_id": 56358739, "link": "https://stackoverflow.com/questions/56358739/warning-passing-argument-2-of-inet-aton-from-incompatible-pointer-type/56358837#56358837", "title": "warning: passing argument 2 of \u2018inet_aton\u2019 from incompatible pointer type........ERROR", "body": "<p>The tutorial is bad, the correct code is </p>\n\n<pre><code>inet_aton(address, &amp;remote_address.sin_addr);\n</code></pre>\n\n<p><code>remote_address.sin_addr</code> is of type <code>in_addr</code>, whose definition is</p>\n\n<pre><code>struct in_addr {\n    unsigned long s_addr;\n};\n</code></pre>\n\n<p>The <code>&amp;remote_address.sin_addr.s_addr</code> and <code>&amp;remote_address.sin_addr</code> will evaluate to the same address, but the former is of wrong type. The original will compile with <em>warning</em> in GCC with default settings, but it is a <em>constraint violation</em>!</p>\n\n<p>As for the Visual Studio code, you should look harder, or perhaps compile with <code>-Werror</code>!</p>\n\n<hr>\n\n<p>Time to look for better tutorials.</p>\n"}], "owner": {"reputation": 692, "user_id": 1714241, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Y3G0s.jpg?s=128&g=1", "display_name": "somethingSomething", "link": "https://stackoverflow.com/users/1714241/somethingsomething"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559128077, "creation_date": 1559126792, "last_edit_date": 1559128077, "question_id": 56358739, "link": "https://stackoverflow.com/questions/56358739/warning-passing-argument-2-of-inet-aton-from-incompatible-pointer-type", "title": "warning: passing argument 2 of \u2018inet_aton\u2019 from incompatible pointer type........ERROR", "body": "<p>I don't know what this error means and what to do to fix it. </p>\n\n<p>I've been following the <a href=\"https://www.youtube.com/watch?v=mStnzIEprH8\" rel=\"nofollow noreferrer\">Sock)et Programming Tutorials In C For Beginners | Part 2 by Eduonix</a> on Youtube but I haven't been able to run anything from this guy, the code is from his tutorial.</p>\n\n<p><strong>If someone could help me understand what this error means and what to do to fix it?</strong></p>\n\n<p>Here is the error:</p>\n\n<pre><code>inet_aton(address, &amp;remote_address.sin_addr.s_addr);\n                   ^\n</code></pre>\n\n<hr>\n\n<pre><code>[1007:1003 0:6758] 09:30:39 Wed May 29 [kristjan@Kundrum:pts/5 +1] ~/C_Programming\n$ gcc http_client_tcp.c -o http_client_tcp\nhttp_client_tcp.c: In function \u2018main\u2019:\nhttp_client_tcp.c:24:24: warning: passing argument 2 of \u2018inet_aton\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n     inet_aton(address, &amp;remote_address.sin_addr.s_addr);\n                        ^\nIn file included from http_client_tcp.c:8:0:\n/usr/include/arpa/inet.h:73:12: note: expected \u2018struct in_addr *\u2019 but argument is of type \u2018in_addr_t * {aka unsigned int *}\u2019\n extern int inet_aton (const char *__cp, struct in_addr *__inp) __THROW;\n            ^~~~~~~~~\n</code></pre>\n\n<p>I'm using Debian Linux 9.9 stretch and coding in Visual Studio Code but the error doesn't come in the Visual Code editor/debugger only if I compile in the shell.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#include &lt;unistd.h&gt; // for close\n\nint main(int argc, char *argv[])\n{\n    char *address;\n    address = argv[1];\n\n    int client_socket;\n    client_socket = socket(AF_INET, SOCK_STREAM, 0);\n\n    // connect to an address\n    struct sockaddr_in remote_address;\n    remote_address.sin_family = AF_INET;\n    remote_address.sin_port = htons(80);\n    inet_aton(address, &amp;remote_address.sin_addr.s_addr);\n\n    connect(client_socket, (struct sockaddr *) &amp;remote_address, sizeof(remote_address));\n\n    char request[] = \"GET / HTTP/1.1\\r\\n\\r\\n\";\n    char response[4096];\n\n    send(client_socket, request, sizeof(request), 0);\n    recv(client_socket, &amp;response, sizeof(response), 0);\n\n    printf(\"response from server: %s\\n\", response);\n    close(client_socket);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559126413, "post_id": 56358564, "comment_id": 99320889, "body": "I tried that before and it didn&#39;t work, it still works the same way as the while statement was working."}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "reply_to_user": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559126679, "post_id": 56358564, "comment_id": 99321028, "body": "I&#39;ve added a code snippet that I tested and works properly :)"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1559126696, "post_id": 56358564, "comment_id": 99321041, "body": "Additional error: The <code>while (ages[i]==-1){ break; }</code> was inside the body of <code>if (ages[i]&lt;-2 || ages[i]&gt;150){...}</code> so it was never executed."}], "tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 0, "last_activity_date": 1559126527, "last_edit_date": 1559126527, "creation_date": 1559126170, "answer_id": 56358564, "question_id": 56358484, "link": "https://stackoverflow.com/questions/56358484/how-to-stop-programme-from-reading-if-1-is-entered-and-calculate-average-accor/56358564#56358564", "title": "How to stop programme from reading if -1 is entered, and calculate average accordingly", "body": "<p>The <code>break</code> will simply stop the execution of the innermost loop.\nIn your case, this is your <code>while</code> loop.</p>\n\n<p>You can convert the <code>while</code> into an <code>if</code> statement and the <code>break</code> will have the intended effects -- it will take you out of the <code>for</code> loop, effectively stopping to read numbers!</p>\n\n<p>I would also restructure your code slightly for clarity, and to make it less messy for edge cases:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for (i=0; i&lt;10; i++) {\n    do {\n      printf(\"Enter number %d: \",i+1);\n      scanf(\"%d\", &amp;ages[i]);\n    } while (ages[i] &lt; -1 || ages[i] &gt; 150);\n    if (ages[i] == -1){\n        break;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559127301, "post_id": 56358722, "comment_id": 99321364, "body": "When I enter -1, the programme doesn&#39;t stop."}, {"owner": {"reputation": 21, "user_id": 10305653, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7c2pGyhStI/AAAAAAAAAAI/AAAAAAAAL6A/I596URVHxPs/photo.jpg?sz=128", "display_name": "Rajas Bansal", "link": "https://stackoverflow.com/users/10305653/rajas-bansal"}, "reply_to_user": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559191829, "post_id": 56358722, "comment_id": 99345674, "body": "Can you provide the exact input given, as it seems to work fine for me."}], "tags": [], "owner": {"reputation": 21, "user_id": 10305653, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7c2pGyhStI/AAAAAAAAAAI/AAAAAAAAL6A/I596URVHxPs/photo.jpg?sz=128", "display_name": "Rajas Bansal", "link": "https://stackoverflow.com/users/10305653/rajas-bansal"}, "is_accepted": false, "score": 1, "last_activity_date": 1559496204, "last_edit_date": 1559496204, "creation_date": 1559126720, "answer_id": 56358722, "question_id": 56358484, "link": "https://stackoverflow.com/questions/56358484/how-to-stop-programme-from-reading-if-1-is-entered-and-calculate-average-accor/56358722#56358722", "title": "How to stop programme from reading if -1 is entered, and calculate average accordingly", "body": "<p>The warning part of your code does not work correctly. The while looks completely misplaced and an if would have made sense instead of the while. In order to count actual number of inputs given, another counter would be preferred.</p>\n\n<pre><code>int n = 0; // Will count the actual number of inputs provided\nfor (i=0; i&lt;10; i++){\n    printf(\"Enter number %d: \",i+1);\n    scanf(\"%d\", &amp;ages[i]);\n\n    while (ages[i]&lt;-2 || ages[i]&gt;150){\n        // This will loop until a valid number is entered\n        // The logic here is subtle as age[i], which is checked by the while loop,\n        // is changed on every iteration of the warning \n        printf(\"Invalid number, enter again: \");\n        scanf(\"%d\",&amp;ages[i]);\n    }\n\n    if (ages[i] == -1) {\n        break;\n    }\n\n    n += 1;\n}\n</code></pre>\n\n<p>Use the n to calculate the average instead of 10. Moreover, while calculating the sum and the minimum, limit the index range i.e</p>\n\n<p>Change</p>\n\n<pre><code>for (int i = 0; i &lt; 10; i++)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>for (int i = 0; i &lt; n; i++)  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559132914, "post_id": 56358927, "comment_id": 99324574, "body": "entering -1 stops the programme, but it doesn&#39;t read the code for calculating average, min, max"}, {"owner": {"reputation": 3470, "user_id": 9381897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0hiHf.jpg?s=128&g=1", "display_name": "leopal", "link": "https://stackoverflow.com/users/9381897/leopal"}, "reply_to_user": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "edited": false, "score": 0, "creation_date": 1559136260, "post_id": 56358927, "comment_id": 99326697, "body": "@hi_it&#39;sme I updated my answer to include all the required parts of  OP. Please check."}], "tags": [], "owner": {"reputation": 3470, "user_id": 9381897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0hiHf.jpg?s=128&g=1", "display_name": "leopal", "link": "https://stackoverflow.com/users/9381897/leopal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559136205, "last_edit_date": 1559136205, "creation_date": 1559127348, "answer_id": 56358927, "question_id": 56358484, "link": "https://stackoverflow.com/questions/56358484/how-to-stop-programme-from-reading-if-1-is-entered-and-calculate-average-accor/56358927#56358927", "title": "How to stop programme from reading if -1 is entered, and calculate average accordingly", "body": "<p>You may use this snippet to achieve what you want. </p>\n\n<pre><code>int ages[10],i=0,input,flag=0,j,min,max,sum=0,avg;\ndo{\n    printf(\"Enter number %d: \",i+1);\n    scanf(\"%d\",&amp;input);\n    if(input == -1){\n        flag = 1;\n        break;\n    }else if(input &lt; -2 || input &gt; 150){\n        printf(\"Invalid number\\n\");\n        continue;\n    }\n    ages[i] = input;\n    i++;\n}while(i &lt; 10);\n\n// Calculating avg, min, max\nmin=ages[0];\nmax=ages[0];\nfor(j=0;j&lt;i;j++){\n    sum+=ages[j];\n    if(ages[j] &gt; max){\n        max = ages[j];\n    }else if(ages[j] &lt; min){\n        min = ages[j];\n    }\n}\navg = sum/i;\nprintf(\" Max: %d, Min: %d, Avg: %d \\n\", max,min,avg);\n</code></pre>\n\n<p>Note <code>i</code> is only increased and <code>ages</code> array is updated when a valid age has been provided. In case <code>-1</code> has been entered then we have to exit the <code>do while</code> loop. </p>\n\n<p>In case that a number  <code>&lt; -2</code> and <code>&gt; 150</code> has been provided, we invoke <code>continue</code> to move over next iteration without increasing <code>i</code> or assigning <code>ages</code> array a new value.</p>\n\n<p>This way we ensure that our array will hold valid values. <code>flag</code> indicates whether <code>-1</code> has been provided in the loop. You may omit it if you don't need it anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 0, "last_activity_date": 1559146852, "creation_date": 1559146852, "answer_id": 56364827, "question_id": 56358484, "link": "https://stackoverflow.com/questions/56358484/how-to-stop-programme-from-reading-if-1-is-entered-and-calculate-average-accor/56364827#56364827", "title": "How to stop programme from reading if -1 is entered, and calculate average accordingly", "body": "<p>Work from the outside in.  The condition of your main loop is \u201cwhile <code>i</code> is less than 10 and <code>ages[i]</code> is not -1\u201d.  That suggests the following structure:</p>\n\n<pre><code>i = 0;\ndo\n{\n  // enter data\n} while ( ages[i++] != -1 &amp;&amp; i &lt; 10 );\n</code></pre>\n\n<p>This will loop while the last entered age is not <code>-1</code> and less than 10 entries have been accepted. When this loop exits, <code>i</code> will be the number of entries in <code>ages</code>.  For example, if you enter <code>-1</code> for the third input, <code>i</code> will be 3.  If you didn't enter <code>-1</code> for any inputs, <code>i</code> will be 10.  Then your averaging operation will be</p>\n\n<pre><code>for ( int j = 0; j &lt; i; j++ )\n  // sum up ages\n// divide ages by i\n</code></pre>\n\n<p>For reading input, you can use another <code>do/while</code> loop:</p>\n\n<pre><code>do\n{\n  printf( \"Enter a number between 0 and 150, or -1 to quit: \" )\n  scanf( \"%d\", &amp;ages[i] )\n} while ( ages[i] &lt; -1 || ages[i] &gt; 150 );\n</code></pre>\n\n<p>Putting that together, you get</p>\n\n<pre><code>int i = 0;\ndo\n{\n  do\n  {\n    printf( \"Enter a number between 0 and 150, or -1 to quit: \" );\n    scanf( \"%d\", &amp;ages[i] );\n  } while ( ages[i] &lt; -1 || ages[i] &gt; 150 );\n} while ( ages[i++] != -1 &amp;&amp; i &lt; 10 );\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11544307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eswJfTm6Mws/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2iOtO0peVQQttRqwYo_PyMhLQxg/mo/photo.jpg?sz=128", "display_name": "hi_it&#39;sme", "link": "https://stackoverflow.com/users/11544307/hi-itsme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 56364827, "answer_count": 4, "score": -1, "last_activity_date": 1559496204, "creation_date": 1559125941, "last_edit_date": 1559141388, "question_id": 56358484, "link": "https://stackoverflow.com/questions/56358484/how-to-stop-programme-from-reading-if-1-is-entered-and-calculate-average-accor", "title": "How to stop programme from reading if -1 is entered, and calculate average accordingly", "body": "<p>I'm a beginner in C, and my task is to:\nWrite a program that reads in an array of up to 10 integers representing peoples ages in years and calculates and prints the maximum age and the minimum age and the average age. Your program should stop reading when either the 10th number is entered or the user enters -1. If the user enters any other negative number or a value above 150, they should be warned and prompted again for a valid age.</p>\n\n<p>My code can find the maximum and minimum numbers and calculate the average, as well as ensuring the value is between 0 to 150. However I can't get the programme to stop if -1 is entered. My average, minimum, and maximum also just consider that 10 values are entered, so I need help in counting the amount of values entered by the user before (/if) -1 is entered, so they can be accurate.</p>\n\n<pre><code>int ages[10];\nint i, j;\ndouble sum=0;\n\nfor (i=0; i&lt;10; i++){\n    printf(\"Enter number %d: \",i+1);\n    scanf(\"%d\", &amp;ages[i]);\n    if (ages[i]&lt;-2 || ages[i]&gt;150){\n        printf(\"Invalid number, enter again: \");\n            scanf(\"%d\",&amp;ages[i]);\n        while (ages[i]==-1){\n            break;\n        }\n    }\n}\n\nfor (i=0; i&lt;10; i++){\n    sum=sum+ages[i];\n}\nprintf(\"Average: %f \\n\", (sum/10));\nint min=ages[0];\nint max=ages[0];\n\nfor (j=0; j&lt;10;j++){\n    if (ages[j]&gt;max){\n       max=ages[j];\n    }\n    else if (ages[j]&lt;min){\n        min=ages[j];\n    }\n}\nprintf(\"Minimum: %d. Maximum: %d. \\n\", min, max);\n</code></pre>\n"}, {"tags": ["c", "pointers", "structure", "self-reference"], "comments": [{"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 3, "creation_date": 1559124698, "post_id": 56358083, "comment_id": 99319979, "body": "read about struct padding and alignment,sizeof(link) is 8 because you check sizeof pointer, not the struct itself. sizeof(*link) will give you correct result."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559125602, "post_id": 56358146, "comment_id": 99320439, "body": "horrible habit hiding pointers in typedefs."}, {"owner": {"reputation": 1, "user_id": 6486640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2BUbEVOU7pY/AAAAAAAAAAI/AAAAAAAAAB4/Kv0zY7E0tCQ/photo.jpg?sz=128", "display_name": "Jo&#227;o Rodrigues JR", "link": "https://stackoverflow.com/users/6486640/jo%c3%a3o-rodrigues-jr"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559126225, "post_id": 56358146, "comment_id": 99320783, "body": "But still it is in common use as an example if you are coding an win32 app and happen to use an LPSTR you are using a typedef char * PSTR, *LPSTR as it makes your code way easier to read and more simpler"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559126523, "post_id": 56358146, "comment_id": 99320944, "body": "No it makes code very difficult to read. It is a very bad practice, and use in win32 does not proof that it is good."}, {"owner": {"reputation": 1, "user_id": 6486640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2BUbEVOU7pY/AAAAAAAAAAI/AAAAAAAAAB4/Kv0zY7E0tCQ/photo.jpg?sz=128", "display_name": "Jo&#227;o Rodrigues JR", "link": "https://stackoverflow.com/users/6486640/jo%c3%a3o-rodrigues-jr"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559126981, "post_id": 56358146, "comment_id": 99321189, "body": "Then how would you do it a good pratice manner?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559127074, "post_id": 56358146, "comment_id": 99321242, "body": "just to not hide the pointers"}], "tags": [], "owner": {"reputation": 1, "user_id": 6486640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2BUbEVOU7pY/AAAAAAAAAAI/AAAAAAAAAB4/Kv0zY7E0tCQ/photo.jpg?sz=128", "display_name": "Jo&#227;o Rodrigues JR", "link": "https://stackoverflow.com/users/6486640/jo%c3%a3o-rodrigues-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559125303, "last_edit_date": 1559125303, "creation_date": 1559124771, "answer_id": 56358146, "question_id": 56358083, "link": "https://stackoverflow.com/questions/56358083/can-any-one-explain-me-how-the-size-get-allocated-in-the-following-case/56358146#56358146", "title": "Can any one explain me how the size get allocated in the following case?", "body": "<p><code>sizeof(link)</code> will always return 8 bytes because that's the size of a pointer in a 64 bits computer.</p>\n\n<p>If you want the size of the structure you need to do <code>sizeof(struct node)</code> as it will give you the size of the actual struct.</p>\n\n<p>And for a linked list type struct I would recomend you something like this</p>\n\n<pre><code> typedef struct node Node, *pnode;\n    struct node{\n       //some vars\n       pnode next;\n    }\n</code></pre>\n\n<p>Then you'll just need to declare it your main or anywhere you as</p>\n\n<pre><code>pnode list = NULL;\n\nsizeof(Node) //for memory allocation\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "is_accepted": false, "score": 0, "last_activity_date": 1559125117, "creation_date": 1559125117, "answer_id": 56358244, "question_id": 56358083, "link": "https://stackoverflow.com/questions/56358083/can-any-one-explain-me-how-the-size-get-allocated-in-the-following-case/56358244#56358244", "title": "Can any one explain me how the size get allocated in the following case?", "body": "<ol>\n<li><code>sizeof</code> return size in bytes</li>\n<li><code>int</code> have 32 bits = 4 bytes</li>\n<li>Any pointer <code>char*</code>, <code>struct any*</code> has const sizeof depends memory structure, in your case is 8.</li>\n<li>Because of memory alligment your first example has sizeof = 16, more here: <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Data_structure_alignment</a> , you can add <code>#pragma pack(1)</code> and see diffrents, should be 4 + 8 = 12</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559126762, "post_id": 56358323, "comment_id": 99321073, "body": "thank you i got a clear picture of your answer, but i struck in the place, where you said it pads the structure to multiple of 8. can you explain me in brief please."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559127079, "post_id": 56358323, "comment_id": 99321244, "body": "@selvabharathis Structure sizes are padded to a multiple of the most restrictive alignment of any of the elements within them.  For instance, if a structure contains an element that wants to be aligned on an 8-byte boundary, then the size will be padded to a multiple of 8."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559127085, "post_id": 56358323, "comment_id": 99321251, "body": "@selvabharathis One reason for this is so that it can place multiple copies of the structure in an array, and have all of them be properly aligned.  The elements of an array are placed directly adjacent to each other, so if the first array element is aligned on an 8-byte boundary, then its size must be a multiple of 8 to maintain 8-byte alignment for the next array element."}, {"owner": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559127606, "post_id": 56358323, "comment_id": 99321540, "body": "wow, i got it, thanks @tom-karzes"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559128477, "post_id": 56358323, "comment_id": 99322040, "body": "@selvabharathis Also note that if your structure contains an <code>int</code> followed by a pointer, it will need to place 4 bytes of padding <i>between</i> the two structure members in order to align the pointer.  That way, if the structure is placed on an 8-byte boundary, the pointer will be properly aligned.  So you need to take the sequence into account as well."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559128618, "post_id": 56358323, "comment_id": 99322120, "body": "@selvabharathis For instance, if a structure contains an <code>int</code>, then a pointer, then another <code>int</code>, you might think it needs to be 16 bytes long, but in fact it would need to be 24 bytes:  4 for the first <code>int</code>, then 4 padding bytes, then 8 for the pointer, then 4 for the second <code>int</code>, and finally 4 more padding bytes to pad the size of the structure as a whole.  So you get 4+4+8+4+4 = 24 bytes total.  If instead the pointer was at the start or the end, and the ints were adjacent, then the size would only be 16.  So order affects it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "edited": false, "score": 0, "creation_date": 1559128699, "post_id": 56358323, "comment_id": 99322170, "body": "@selvabharathis The answer that was listed as the duplicate goes into more detail about this."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 1, "last_activity_date": 1559125381, "creation_date": 1559125381, "answer_id": 56358323, "question_id": 56358083, "link": "https://stackoverflow.com/questions/56358083/can-any-one-explain-me-how-the-size-get-allocated-in-the-following-case/56358323#56358323", "title": "Can any one explain me how the size get allocated in the following case?", "body": "<p>On your <em>specific platform</em>, it looks like an <code>int</code> has size 4 and a pointer has size 8.  It also looks like it wants to align pointers on an 8-byte boundary.</p>\n\n<p>So if <code>struct node</code> just contains an <code>int</code>, then the its size is 4.  If it just contains a pointer, its size is 8.  If it contains both an <code>int</code> and a pointer, then it needs 12 bytes, but in order to maintain the alignment of the pointer, it pads the structure to a multiple of 8, resulting in a size of 16.</p>\n\n<p>In your final example, you have <code>link</code> defined as a pointer to a <code>struct node</code>.  In this case, it doesn't matter what a <code>struct node</code> contains.  Since <code>link</code> is just a pointer, its size will always be 8.</p>\n\n<p>Again, note that this is just a best guess for <em>your</em> platform.  None of this is guaranteed, and it can vary from one platform to another.</p>\n"}], "owner": {"reputation": 97, "user_id": 10182510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdYmH.jpg?s=128&g=1", "display_name": "selvabharathi s", "link": "https://stackoverflow.com/users/10182510/selvabharathi-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1559126056, "accepted_answer_id": 56358323, "answer_count": 3, "score": -1, "last_activity_date": 1559125652, "creation_date": 1559124528, "last_edit_date": 1559125652, "question_id": 56358083, "link": "https://stackoverflow.com/questions/56358083/can-any-one-explain-me-how-the-size-get-allocated-in-the-following-case", "closed_reason": "Duplicate", "title": "Can any one explain me how the size get allocated in the following case?", "body": "<p>I got confused with the size allocation with my gcc compiler, can any one help me how the size get allocated for the following code.</p>\n\n<pre><code>struct node\n{\n int data;\n struct node *next;\n};\n</code></pre>\n\n<p><code>sizeof(struct node)</code> it gives an output as 16.</p>\n\n<hr>\n\n<pre><code>struct node\n{\n int data;\n};\n</code></pre>\n\n<p><code>sizeof(struct node)</code> it gives an output as 4.</p>\n\n<hr>\n\n<pre><code>struct node\n{\nstruct node *next;\n};\n</code></pre>\n\n<p><code>sizeof(struct node)</code> it gives an output as 8.</p>\n\n<hr>\n\n<pre><code>struct node\n{\nint data;\nstruct node *next;\n}*link;\n</code></pre>\n\n<p><code>sizeof(link)</code> is always 8, even if i add few more elements to structure.</p>\n\n<hr>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559138486, "post_id": 56357784, "comment_id": 99328126, "body": "so what should happen there? it is reading from <code>stdin</code> but there is no <code>stdin</code> to read from!? Ignore <code>SIGTTIN</code> and get an error from <code>read</code> instead, and spam the screen full of <code>read: Input&#47;output error</code>?! Stop reading from <code>stdin</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 3, "last_activity_date": 1559126735, "last_edit_date": 1592644375, "creation_date": 1559125746, "answer_id": 56358424, "question_id": 56357784, "link": "https://stackoverflow.com/questions/56357784/how-to-locate-the-code-location-that-causes-the-application-to-receive-sigttin-u/56358424#56358424", "title": "How to locate the code location that causes the application to receive SIGTTIN under linux?", "body": "<p>You launch your program in background doing <code>./a.out &amp;</code> but your program reads from <em>stdin</em> so you have that signal</p>\n<p>From <a href=\"https://www.gnu.org/software/libc/manual/html_node/Job-Control-Signals.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/libc/manual/html_node/Job-Control-Signals.html</a> :</p>\n<blockquote>\n<p>Macro: int SIGTTIN</p>\n<p>A process cannot read from the user\u2019s terminal while it is running as a background job. When any process in a background job tries to read from the terminal, all of the processes in the job are sent a SIGTTIN signal. The default action for this signal is to stop the process. For more information about how this interacts with the terminal driver, see Access to the Terminal.</p>\n<p>locate the location of the code that produces the SIGTTIN signal?</p>\n</blockquote>\n<p>It is the <em>read</em></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8304893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3aeb874a476c0349eab23e8837ee83e?s=128&d=identicon&r=PG&f=1", "display_name": "sc liu", "link": "https://stackoverflow.com/users/8304893/sc-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1559275628, "last_edit_date": 1592644375, "creation_date": 1559275276, "answer_id": 56388507, "question_id": 56357784, "link": "https://stackoverflow.com/questions/56357784/how-to-locate-the-code-location-that-causes-the-application-to-receive-sigttin-u/56388507#56388507", "title": "How to locate the code location that causes the application to receive SIGTTIN under linux?", "body": "<h3>Thank everyone for your reply. The problem has been solved.</h3>\n<p>Sometimes I know the reason for SIGTTIN, but I can't locate the code that caused the error. For example, the program does not directly use <code>scanf, read(0, ...), cin, ...</code> system calls or library functions, which are more prominent when the program is larger or when using multiple threads.</p>\n<h3>Here's how to locate the code location that causes SIGTTIN:</h3>\n<ul>\n<li>Use ps to query the pid of your program (if you need to debug the thread, you can use <code>ps -eLf</code> to get tid).</li>\n<li>Use <code>strace -p $(YOUR PID) -e read</code> to track the system call of the program. If necessary, add the <code>-v</code> option. If you want to track the process and all its sub-threads to locate the code, use <code> Strace -fp $(YOUR PID) -e read</code>.When the program is executed in the background, all <code>read(0, ..., ...)</code> calls may cause SIGTTIN. According to the parameters or return values of <code>read(0, ..., ...)</code>, the corresponding code can be found position.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8304893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3aeb874a476c0349eab23e8837ee83e?s=128&d=identicon&r=PG&f=1", "display_name": "sc liu", "link": "https://stackoverflow.com/users/8304893/sc-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559275628, "creation_date": 1559123599, "last_edit_date": 1559127327, "question_id": 56357784, "link": "https://stackoverflow.com/questions/56357784/how-to-locate-the-code-location-that-causes-the-application-to-receive-sigttin-u", "title": "How to locate the code location that causes the application to receive SIGTTIN under linux?", "body": "<p>One of my c++ applications will hang after running for an indeterminate length of time, because it is not terminated, so it cannot be restarted by the parent process.   </p>\n\n<p>It is known that SIGTTIN can prevent the program from being suspended by <code>nohup</code> or by using <code>&lt;/dev/null</code> to redirect standard input, but this does not solve the problem fundamentally.   </p>\n\n<p>So, does anyone know how to debug or locate the location of the code that produces the SIGTTIN signal?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// this is a example, exec command to get SIGTTIN: ./a.out &amp;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n\nint main(int argc, char* argv[]) {\n        int len;\n        char buf[64];\n\n        while(1) {\n                len = read(STDIN_FILENO, buf, 64);\n                if (len &gt; 0) {\n                        write(STDOUT_FILENO, buf, len);\n                }\n                else {\n                        perror(\"read\");\n                }\n        }\n        return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "string", "scanf", "getchar"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 2, "creation_date": 1559123076, "post_id": 56357553, "comment_id": 99319041, "body": "This document: <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a> will explain you the <code>%[^\\n]s</code> syntax."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1559123119, "post_id": 56357553, "comment_id": 99319075, "body": "The <code>getchar()</code> is here to consume the remaining <code>\\n</code> from <code>stdin</code>"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1559123194, "post_id": 56357553, "comment_id": 99319119, "body": "In short: with <code>%[^\\n]s</code> syntax, your hotel name can have spaces."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1559123651, "post_id": 56357553, "comment_id": 99319412, "body": "I think it also works with <code>scanf(&quot;%[^\\n]&quot;, new_h-&gt;name);</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1559123741, "post_id": 56357553, "comment_id": 99319458, "body": "BTW: <code>&quot;%[^\\n]s&quot;</code> should be <code>&quot;%[^\\n]&quot;</code> There&#39;s no need for an <code>s</code> on the end. The <code>[^\\n]</code> is not a qualifier for a <code>%s</code> conversion. It is a conversion in and of itself."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1559127117, "post_id": 56357553, "comment_id": 99321271, "body": "Post the definition of <code>Hotel</code>. If <code>h-&gt;name</code> is not an array, the code will have undefined behavior."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559127795, "post_id": 56357553, "comment_id": 99321651, "body": "@user3386109 <code>&quot;%[^\\n]&quot;</code> is as bad as <code>gets()</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559158643, "post_id": 56357553, "comment_id": 99337827, "body": "@chux <code>%s</code> is as bad as <code>gets()</code> too."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1559127842, "post_id": 56357888, "comment_id": 99321677, "body": "The <code>s</code> in <code>&quot; %[^\\n]s&quot;</code> serves no purpose."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1559128669, "post_id": 56357888, "comment_id": 99322147, "body": "surprisingly it doesn&#39;t do much harm either :D"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559172261, "post_id": 56357888, "comment_id": 99341975, "body": "@AnttiHaapala A better use of  <code>&quot;%[^\\n]&quot;</code> uses a width like <code>&quot;%99[^\\n]&quot;</code>.  In that better use case, the <code>s</code> in  <code>&quot;%99[^\\n]s&quot;</code>  can do harm."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559189463, "post_id": 56357888, "comment_id": 99345180, "body": "True dat too :D"}], "tags": [], "owner": {"reputation": 1, "user_id": 6486640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2BUbEVOU7pY/AAAAAAAAAAI/AAAAAAAAAB4/Kv0zY7E0tCQ/photo.jpg?sz=128", "display_name": "Jo&#227;o Rodrigues JR", "link": "https://stackoverflow.com/users/6486640/jo%c3%a3o-rodrigues-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559123934, "creation_date": 1559123934, "answer_id": 56357888, "question_id": 56357553, "link": "https://stackoverflow.com/questions/56357553/scanf-and-getchar-together-to-read-string/56357888#56357888", "title": "scanf and getchar together to read string", "body": "<p>The <code>getchar()</code> function in this case would only be necessary if you were to do a following input after the hotel name, in wich case I would recommend you to just add a space before %s, something like this <code>scanf(\" %[^\\n]s\", new_h-&gt;name);</code>.</p>\n\n<p>Regarding that <code>malloc()</code> how's your definition of hotel because it has to be declared as a pointer, so you're able to allocate memory to it casting it to type pointer isn't enough and it will leed to a segfault you should declare it as</p>\n\n<pre><code>Hotel *new_h = malloc(sizeof(Hotel));\n</code></pre>\n\n<p>This is considering that you are defining hotel as something like this</p>\n\n<pre><code>typedef struct{\n    //Some vars\n}Hotel;\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11381202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IaYu6sL-4oc/AAAAAAAAAAI/AAAAAAAAAIM/Efw8OgEcsa8/photo.jpg?sz=128", "display_name": "Davide Melis", "link": "https://stackoverflow.com/users/11381202/davide-melis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559123934, "creation_date": 1559122926, "question_id": 56357553, "link": "https://stackoverflow.com/questions/56357553/scanf-and-getchar-together-to-read-string", "title": "scanf and getchar together to read string", "body": "<p>I have this code:</p>\n\n<pre><code>Hotel new_h = (Hotel*)malloc(sizeof(Hotel));\nprintf(\"\\nInsert name -&gt; \");\nscanf(\"%[^\\n]s\", new_h-&gt;name);\ngetchar();\n</code></pre>\n\n<p>First of all, how it works %[^\\n]s</p>\n\n<p>Why there isn't just %s inside scanf? </p>\n\n<p>And why there is getchar too?</p>\n"}, {"tags": ["c", "indexing", "hash", "time-complexity"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 2, "creation_date": 1559122828, "post_id": 56357378, "comment_id": 99318880, "body": "Yes.  But that time is used only once, not every time you&#39;re searching."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1559123139, "post_id": 56357378, "comment_id": 99319087, "body": "Yes, creating the hash array takes O(n), but then each query takes O(1) time. So if there are O(n) queries, the time complexity using the hash array is O(n). But performing a linear search for O(n) queries would take O(n^2) time. In other words, it makes no sense to build the hash array to satisfy one query. But it does make sense if the time saved by the queries makes up for the time used to build the table."}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 0, "creation_date": 1559123176, "post_id": 56357378, "comment_id": 99319106, "body": "In theory yes, your complexity will be O(n) + O(1) which is O(n) but in practice it will outperform your linear search (Assuming the way you&#39;re hashing doesn&#39;t cause too many collisions)."}, {"owner": {"reputation": 13, "user_id": 11509118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-As0PrTFMFYM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFFeaA8jr0vfB48mslTcvQbLf-fQ/mo/photo.jpg?sz=128", "display_name": "Sudha Mani", "link": "https://stackoverflow.com/users/11509118/sudha-mani"}, "edited": false, "score": 0, "creation_date": 1559123821, "post_id": 56357378, "comment_id": 99319509, "body": "Yes! Makes complete sense now. Thanks!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559123989, "post_id": 56357378, "comment_id": 99319606, "body": "Creating a hash array takes O(n) but creating a linear search array takes O(n) too."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1559136690, "post_id": 56357378, "comment_id": 99326990, "body": "Interesting and somewhat related, about the performance impact of preparing (sorting) an array and later using it, compared to linear search: <a href=\"http://blog.teamleadnet.com/2012/02/quicksort-binary-search-and-linear.html\" rel=\"nofollow noreferrer\">blog.teamleadnet.com/2012/02/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1559216886, "post_id": 56357559, "comment_id": 99355806, "body": "<i>&quot;maintain an array sorted by hash key, and then use a binary search&quot;</i> - the point of hashing is usually to enable use of a hash table, and when you&#39;re using that you can index directly without a binary search.  And your talk of maintaining sort order during insertion is misleading: if you have a sorted array you can binary-search to work out where to insert new elements, but then have to do an O(n) move operation on all existing elements after the insertion point to make space for the new element.  Binary search trees and hash tables allow relatively efficient insert and erase; not so arrays."}, {"owner": {"reputation": 113, "user_id": 11536834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb24956bc0be73215d5d578ee68e57fa?s=128&d=identicon&r=PG&f=1", "display_name": "user11536834", "link": "https://stackoverflow.com/users/11536834/user11536834"}, "reply_to_user": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1559234764, "post_id": 56357559, "comment_id": 99365066, "body": "Sure, it wasn&#39;t meant to be misleading though, it&#39;s a tradeoff like anything else. The advantages are 1) you don&#39;t start with a bunch of empty space with nothing in it; everything is condensed, and as it grows you 2) don&#39;t end up with a bunch of things in buckets requiring O(n) time on the bucket once you find it, or 3) need to resize the entire hash table to allow for more buckets with less things in each bucket. I find it works well for situations where stored values change often, but keys aren&#39;t created/removed often, esp. when you occasionally need to iterate over all stored values."}], "tags": [], "owner": {"reputation": 113, "user_id": 11536834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb24956bc0be73215d5d578ee68e57fa?s=128&d=identicon&r=PG&f=1", "display_name": "user11536834", "link": "https://stackoverflow.com/users/11536834/user11536834"}, "is_accepted": false, "score": 0, "last_activity_date": 1559205603, "last_edit_date": 1559205603, "creation_date": 1559122934, "answer_id": 56357559, "question_id": 56357378, "link": "https://stackoverflow.com/questions/56357378/is-the-time-complexity-of-assigning-n-values-to-an-array-of-size-n-on/56357559#56357559", "title": "Is the Time Complexity of assigning n values to an array of size n O(n)?", "body": "<p>A typical thing to do here would be to maintain an array sorted by hash key, and then use a binary search to locate elements, giving worst-case time complexity of O(log n).</p>\n\n<p>You can maintain the sort order by using the same binary search for inserting new elements as you use for finding existing elements.</p>\n\n<p>That last point is important: as noted in comments, sorting before each search degrades search time to the point where brute-force linear search is faster for small datasets. But that overhead can be eliminated; the array <em>never needs to be sorted</em> if you maintain sort order when inserting new elements.</p>\n"}], "owner": {"reputation": 13, "user_id": 11509118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-As0PrTFMFYM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFFeaA8jr0vfB48mslTcvQbLf-fQ/mo/photo.jpg?sz=128", "display_name": "Sudha Mani", "link": "https://stackoverflow.com/users/11509118/sudha-mani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559205603, "creation_date": 1559122354, "question_id": 56357378, "link": "https://stackoverflow.com/questions/56357378/is-the-time-complexity-of-assigning-n-values-to-an-array-of-size-n-on", "title": "Is the Time Complexity of assigning n values to an array of size n O(n)?", "body": "<p>I am trying Index mapping in Hashing to search an element in an array. A linear search would take O(n) to search an element in an array of size n. In hashing what we're doing is basically reducing the time complexity to O(1) by creating a 2d matrix of zeros (say hash[1000][2]) and reassigning hash[a[i]][0] to 1 if a[i] is positive and hash[-a[i]][1] if a[i] is negative. Here a[i] is the array from which we are supposed to search an element. </p>\n\n<pre><code>    for(i=0 ;i&lt;n    ;i++)\n    {\n        if(a[i]&gt;=0)\n            has[a[i]][0]=1;\n        else\n            has[-a[i]][1]=1;\n    }\n</code></pre>\n\n<p>How much time does the above code take to execute?\nEven by hashing, aren't we having a time complexity of O(n) just like linear search? Isn't what has consumed to assign n 1's in a 2d array of zeros equal to the time taken to search an element in a linear fashion?</p>\n"}, {"tags": ["c", "string", "atoi"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1559122013, "post_id": 56357256, "comment_id": 99318425, "body": "You don&#39;t need to convert anything. The individual characters of your string are alread ASCII."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1559122109, "post_id": 56357256, "comment_id": 99318479, "body": "<code>char s2[] = {};</code> this isn&#39;t C, and even if the compiler tolerates it, it probably doesn&#39;t reserve any space."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559122620, "post_id": 56357256, "comment_id": 99318761, "body": "Please <a href=\"https://stackoverflow.com/posts/56357256/edit\">edit</a> your question and show a minimal example of your input and the exact content you expect to be in <code>arr</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559129089, "post_id": 56357256, "comment_id": 99322367, "body": "As a side note, you should never use <code>atoi</code>. Make a habit of using <code>strtol</code> instead - it is the same but safer and also works with more number bases than decimal."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 0, "last_activity_date": 1559122670, "last_edit_date": 1559122670, "creation_date": 1559122372, "answer_id": 56357385, "question_id": 56357256, "link": "https://stackoverflow.com/questions/56357256/convert-string-array-to-array-with-ascii-codes/56357385#56357385", "title": "Convert string array to array with ascii codes", "body": "<p>You don't need to convert anything because the characters in <code>s2</code> are already ASCII values.</p>\n\n<p>You probably want something like this:</p>\n\n<pre><code>char s2[1024];\nfgets(s2, 1024, stdin);\nint arr[1024]; \nint i = 0;\nwhile (i &lt; strlen(s2))\n{\n  arr[i] = s2[i];\n  i++;\n}\n</code></pre>\n\n<p>If your input is say:</p>\n\n<pre><code>ABCD\n</code></pre>\n\n<p><code>arr</code> will contain following values: <code>{65, 66, 67, 68, x, x, x}</code>, where <code>x</code> stands for \"indetermined value\".</p>\n\n<p>Better version of the loop:</p>\n\n<pre><code>for (int i = 0; i &lt; strlen(s2); i++)\n{\n  arr[i] = s2[i];\n}\n</code></pre>\n\n<p>Overall better version:</p>\n\n<pre><code>#define MAXLINE 1024\n\nchar line[MAXLINE];\nfgets(line, sizeof line, stdin);\nint arr[MAXLINE]; \n\nfor (int i = 0; i &lt; strlen(s2); i++)\n{\n  arr[i] = s2[i];\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8851101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fca77dee3cfc4835c4f4770a52e6840?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8851101/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 56357385, "answer_count": 1, "score": -1, "last_activity_date": 1559122670, "creation_date": 1559121972, "last_edit_date": 1559122166, "question_id": 56357256, "link": "https://stackoverflow.com/questions/56357256/convert-string-array-to-array-with-ascii-codes", "title": "Convert string array to array with ascii codes", "body": "<p>I'm trying to convert every character of a string to its ASCII code. The string array comes from stdin.</p>\n\n<p>I'm trying to loop through the string and convert every character to ASCII with atoi() and add this ASCII code to a new int array.</p>\n\n<pre><code>char s2[1024];\nfgets(s2, 1024, stdin);\nint arr[1024]; \nint i = 0;\nwhile (i &lt; strlen(s2))\n  {\n  char * start = s2;\n  int j = 0;\n    while(start != \"\\0\")\n    {\n      arr[j++] = atoi(start);\n    }\n    i++;\n  }\n</code></pre>\n\n<p>I'm pretty new to C and I thought this could work, but I get an \"segmentation fault (core dumped)\" when I run the code. I know this error has to do something with the memory, but I don't know how to debug it.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1559120747, "post_id": 56356845, "comment_id": 99317695, "body": "What&#39;s wrong with copying from the old into the new structure? Read into the old structure and then copy the old one into the new one."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1559121059, "post_id": 56356845, "comment_id": 99317882, "body": "Yep, just write a function to populate a new struct from the old one, make sure the new fields and extra skills are zeroed or otherwise properly initialized, and write the new struct into a new file. There&#39;s no magic."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1559121086, "post_id": 56356845, "comment_id": 99317896, "body": "What exactly is the problem? What does the conversion code look like and what part are you struggling with?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11571700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kk2i-bA1gGc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVCyq-IAwi8oz7wuA-75NUMSo8QA/mo/photo.jpg?sz=128", "display_name": "Corra", "link": "https://stackoverflow.com/users/11571700/corra"}, "edited": false, "score": 0, "creation_date": 1559120878, "post_id": 56356893, "comment_id": 99317773, "body": "MAX_SKILLS is 255 and MAX_SKILLS_NEW is 500"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "reply_to_user": {"reputation": 1, "user_id": 11571700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kk2i-bA1gGc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVCyq-IAwi8oz7wuA-75NUMSo8QA/mo/photo.jpg?sz=128", "display_name": "Corra", "link": "https://stackoverflow.com/users/11571700/corra"}, "edited": false, "score": 0, "creation_date": 1559120940, "post_id": 56356893, "comment_id": 99317805, "body": "So you won&#39;t have any problem, just make a strcpy() or strncpy() to be sure to copy what you want"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1559121094, "post_id": 56356893, "comment_id": 99317904, "body": "Should it be <code>memcpy</code> instead?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "edited": false, "score": 0, "creation_date": 1559121197, "post_id": 56356893, "comment_id": 99317961, "body": "yeah, that would be a better choice"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "is_accepted": false, "score": 0, "last_activity_date": 1559120803, "creation_date": 1559120803, "answer_id": 56356893, "question_id": 56356845, "link": "https://stackoverflow.com/questions/56356845/how-can-i-can-make-the-new-structure-compatible-with-the-old-one/56356893#56356893", "title": "How can I can make the new structure compatible with the old one?", "body": "<p>You can developp a new function that has to take your <strong>struct char_file_u</strong> and add the fields in your <strong>struct char_fileNew_u</strong>.<br>\nThe only tricky point is that you have to be careful with the values of MAX_SKILLS and MAX_SKILLS_NEW, that can be different.</p>\n"}], "owner": {"reputation": 1, "user_id": 11571700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kk2i-bA1gGc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVCyq-IAwi8oz7wuA-75NUMSo8QA/mo/photo.jpg?sz=128", "display_name": "Corra", "link": "https://stackoverflow.com/users/11571700/corra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559120998, "creation_date": 1559120654, "last_edit_date": 1559120998, "question_id": 56356845, "link": "https://stackoverflow.com/questions/56356845/how-can-i-can-make-the-new-structure-compatible-with-the-old-one", "title": "How can I can make the new structure compatible with the old one?", "body": "<p>I need to read files saved in a directory with an old structure (the first one posted below) and convert them in a new structure (the second one).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct char_file_u\n{\n    int iClass;\n    struct char_skill_data skills[MAX_SKILLS]; \n}\n\nstruct char_fileNew_u\n{\n    int iClass;\n    struct char_skill_data skills[MAX_SKILLS_NEW];\n    char name[20];\n    char authcode[7];\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "opengl-compat"], "comments": [{"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 2, "creation_date": 1559126063, "post_id": 56356545, "comment_id": 99320691, "body": "Probably would be best if glGetError() was added before this chunk and also after glBegin() to determine if the error isn&#39;t from elsewhere and if <code>glBegin</code> / <code>glEnd</code> is supported."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1559156226, "post_id": 56356545, "comment_id": 99336857, "body": "Well, <code>apitrace</code> can replay files using a debug context (and iirc, <code>qapitrace</code> even does so by default), so both the origin and the reason for the error should be very easy to spot."}], "answers": [{"comments": [{"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1559121792, "post_id": 56356962, "comment_id": 99318297, "body": "This is <a href=\"https://www.khronos.org/opengl/wiki/Legacy_OpenGL\" rel=\"nofollow noreferrer\">Legacy OpenGL</a>. <code>glBegin</code>/<code>glEnd</code> sequences are deprecated, too. <code>GL_QUADS</code> and <code>glBegin</code>/<code>glEnd</code> sequences are removed in a core profile context but still valid in a compatibility profile context. That&#39;s not the point here, see <a href=\"https://www.khronos.org/opengl/wiki/OpenGL_Context\" rel=\"nofollow noreferrer\">OpenGL Context</a>."}, {"owner": {"reputation": 113, "user_id": 11536834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb24956bc0be73215d5d578ee68e57fa?s=128&d=identicon&r=PG&f=1", "display_name": "user11536834", "link": "https://stackoverflow.com/users/11536834/user11536834"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1559122081, "post_id": 56356962, "comment_id": 99318467, "body": "Fair point, if OP updates with more information to confirm that their implementation supports legacy, I&#39;ll remove the answer."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1559123540, "post_id": 56356962, "comment_id": 99319340, "body": "Ummm I am no expert in GL. I create the Context in Linux using <code>GLX</code>. What information can I provide for a better understanding?"}, {"owner": {"reputation": 113, "user_id": 11536834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb24956bc0be73215d5d578ee68e57fa?s=128&d=identicon&r=PG&f=1", "display_name": "user11536834", "link": "https://stackoverflow.com/users/11536834/user11536834"}, "edited": false, "score": 0, "creation_date": 1559124071, "post_id": 56356962, "comment_id": 99319665, "body": "If this is a new application and you don&#39;t have any particular reason to support legacy, you&#39;d probably be better off just targeting the version 3 API instead (the old stuff is deprecated for over a decade now)."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1559124230, "post_id": 56356962, "comment_id": 99319744, "body": "i am currently porting a GTK application from GTKGLext (as it is not packaged for some distros we target) to GLX and EGL. Normally I would only use EGL, but the nvidia driver has a bug with it, so I need to use a GLX fallback. I dont want to change the GL drawing code if possible"}], "tags": [], "owner": {"reputation": 113, "user_id": 11536834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb24956bc0be73215d5d578ee68e57fa?s=128&d=identicon&r=PG&f=1", "display_name": "user11536834", "link": "https://stackoverflow.com/users/11536834/user11536834"}, "is_accepted": false, "score": -1, "last_activity_date": 1559121060, "creation_date": 1559121060, "answer_id": 56356962, "question_id": 56356545, "link": "https://stackoverflow.com/questions/56356545/gl-invalid-operation-in-opengl-applications/56356962#56356962", "title": "GL_Invalid_Operation in OpenGL applications", "body": "<p>GL_QUADS is deprecated since version 3 and removed since version 3.1.</p>\n\n<p><a href=\"https://www.khronos.org/opengl/wiki/Primitive#Quads\" rel=\"nofollow noreferrer\">https://www.khronos.org/opengl/wiki/Primitive#Quads</a></p>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559137973, "creation_date": 1559119731, "last_edit_date": 1559137973, "question_id": 56356545, "link": "https://stackoverflow.com/questions/56356545/gl-invalid-operation-in-opengl-applications", "title": "GL_Invalid_Operation in OpenGL applications", "body": "<p>I am currently wiring an OpenGL application and am getting <code>GL_INVALID_OPERATION</code>. The whole GL is scattered among several files and its hard to create an example out of it, but I have created an OpenGL trace using <code>apitrace</code>. This is one chunk that created the error:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>glMatrixMode(mode = GL_PROJECTION)\nglLoadIdentity()\nglViewport(x = 0, y = 0, width = 1190, height = 746)\nglOrtho(left = 0, right = 1190, bottom = 0, top = 746, zNear = 0, zFar = 128)\nglBegin(mode = GL_QUADS)\nglColor4f(red = 0.5, green = 0.5, blue = 0.5, alpha = 1)\nglVertex3f(x = 1190, y = 746, z = 0)\nglColor4f(red = 0.5, green = 0.5, blue = 0.5, alpha = 1)\nglVertex3f(x = 0, y = 746, z = 0)\nglColor4f(red = 0.5, green = 0.5, blue = 0.5, alpha = 1)\nglVertex3f(x = 0, y = 100, z = 0)\nglColor4f(red = 0.5, green = 0.5, blue = 0.5, alpha = 1)\nglVertex3f(x = 1190, y = 100, z = 0)\nglEnd()\nglGetError() = GL_INVALID_OPERATION\n</code></pre>\n\n<p>Has someone any idea on this?</p>\n"}, {"tags": ["c++", "c", "memory-leaks", "printf"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1559119580, "post_id": 56356453, "comment_id": 99316994, "body": "When you intentionally trigger undefined behavior, you should look at the disassembly."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1559120149, "post_id": 56356453, "comment_id": 99317358, "body": "@user202729 good luck with investigating the inner workings of <code>fprintf</code> in the disassembled code."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 2, "creation_date": 1559121393, "post_id": 56356453, "comment_id": 99318082, "body": "Undefined behaviour is undefined. It could indeed be made to always fail in a predictable way - in a language with strict runtime checks to slow down the correct code of everyone else who didn&#39;t write UB in the first place. Some compilers will warn about <code>*printf</code> format string mismatches, and you can build with an address sanitizer if you want those runtime checks."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559121546, "post_id": 56356453, "comment_id": 99318169, "body": "The <code>%.*f</code> format causes <code>printf()</code> (and related functions) to expect TWO arguments, one the width and the other the floating point value to be formatted.   Your code only provides one argument following the format string, so the behaviour is undefined.    Trying to explain the reason for any particular undefined behaviour (in this case, caused by <code>printf()</code> being told to ASSUME two arguments will be provided, but only one is) is pointless."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1559121761, "post_id": 56356453, "comment_id": 99318283, "body": "Oh, and your compiler is one of those that will warn about format string problems (even though it is really old). Use <code>-Wformat</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559124046, "post_id": 56356453, "comment_id": 99319648, "body": "<i>&quot;It&#39;s just surprising that the behavior is so unpredictable.&quot;</i> Please please please get yourself out of <a href=\"https://stackoverflow.com/q/54120862/560648\">this mindset</a>!"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1559120049, "post_id": 56356573, "comment_id": 99317289, "body": "@user694733 IMHO there <i>is</i> no point in this question. It&#39;s useless to reason about undefined behaviour, especially in this case where a complex library function such as <code>fprintf</code> is involved."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1559120165, "post_id": 56356573, "comment_id": 99317368, "body": "FWIW there are &quot;pointless&quot; questions like <a href=\"https://stackoverflow.com/questions/48270127/can-a-1-a-2-a-3-ever-evaluate-to-true\">this</a>. The help center says that only practical questions are allowed however there&#39;s no close reason for &quot;impractical&quot; ones."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1559120210, "post_id": 56356573, "comment_id": 99317399, "body": "I don&#39;t think this answer helps with &quot;It&#39;s just surprising that the behavior is so unpredictable.&quot;   The answer should clearly revolve explaining why UB is random - or maybe just mark as a duplicate of one that does."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1559120420, "last_edit_date": 1559120420, "creation_date": 1559119809, "answer_id": 56356573, "question_id": 56356453, "link": "https://stackoverflow.com/questions/56356453/why-is-fprintf-causing-memory-leak-and-behaving-unpredictably-when-width-argumen/56356573#56356573", "title": "Why is fprintf causing memory leak and behaving unpredictably when width argument is missing", "body": "<p>The format string does not match the parameters, therefore the bahaviour of <code>fprintf</code> is undefined. Google \"undefined behaviour C\" for more information about \"undefined bahaviour\".</p>\n\n<p>This would be correct:</p>\n\n<pre><code>// printf 0.0 with 7 decimals\nfprintf(stdout, \"%.*f\", 7, 0.0);\n</code></pre>\n\n<p>Or maybe you just want this:</p>\n\n<pre><code>// printf 0.0 with de default format\nfprintf(stdout, \"%f\", 0.0);\n</code></pre>\n\n<hr>\n\n<p>About this part of your question: <em>Sometimes it seems to use a default width, while sometimes it fails very badly. Could this not be made to always fail or always use some default behaviour?</em></p>\n\n<p>There cannot be any default behaviour, <code>fprintf</code> is reading the arguments according to the format string. If the arguments don't match, <code>fprintf</code> ends up with seamingly random values.</p>\n\n<hr>\n\n<p>About this part of your question: <em>Another curiosity is that running it through valgrind would consistently bring about the printing of many \"0\"s case, which otherwise happens quite seldom, but the memory usage issue would never occur then either.</em>:</p>\n\n<p>This is just another manifestation of undefined behaviour, with valgrind the conditions are quite different and therefore the actual undefined bahaviour can be different.</p>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559121252, "post_id": 56356662, "comment_id": 99317993, "body": "The interesting part is why the integer is uninitialized. My understanding is that the bytes passed for <code>0.0</code> should be used for that integer. I assume that a <code>double</code> is at least as large as an <code>int</code> and only the following parameter is missing. That means the value should be random but the length should be fixed."}, {"owner": {"reputation": 352, "user_id": 2190626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1c69be9c0232fee7bb9bc140a91e41?s=128&d=identicon&r=PG", "display_name": "morten", "link": "https://stackoverflow.com/users/2190626/morten"}, "edited": false, "score": 0, "creation_date": 1559121297, "post_id": 56356662, "comment_id": 99318025, "body": "gcc -pedantic -Wall -Wextra -Werror does indeed result in compilation error. This is probably the most useful bit of information to come out of this question. I shall check if we can enable this in our build."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559121466, "post_id": 56356662, "comment_id": 99318120, "body": "@Gerhardh No, on many platforms integers and doubles use different parameter passing mechanisms. On such a system <code>fprintf</code> will first try to get the &quot;next integer&quot; argument (and get garbage), then get the &quot;next double&quot; argument (and get <code>0.0</code>)."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559121674, "post_id": 56356662, "comment_id": 99318246, "body": "@melpomene OK, that makes sense. I have seen that for normal parameter lists but not yet for variable parameters using <code>...</code>. I didn&#39;t look into asm for a while... ;)"}, {"owner": {"reputation": 352, "user_id": 2190626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1c69be9c0232fee7bb9bc140a91e41?s=128&d=identicon&r=PG", "display_name": "morten", "link": "https://stackoverflow.com/users/2190626/morten"}, "edited": false, "score": 0, "creation_date": 1559128103, "post_id": 56356662, "comment_id": 99321825, "body": "The compiler flags would probably not have helped in our case after all, since the format string was actually a parameter to the function calling fprintf."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 352, "user_id": 2190626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1c69be9c0232fee7bb9bc140a91e41?s=128&d=identicon&r=PG", "display_name": "morten", "link": "https://stackoverflow.com/users/2190626/morten"}, "edited": false, "score": 0, "creation_date": 1559128269, "post_id": 56356662, "comment_id": 99321913, "body": "@morten That sounds like a design flaw."}, {"owner": {"reputation": 352, "user_id": 2190626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1c69be9c0232fee7bb9bc140a91e41?s=128&d=identicon&r=PG", "display_name": "morten", "link": "https://stackoverflow.com/users/2190626/morten"}, "edited": false, "score": 0, "creation_date": 1559128805, "post_id": 56356662, "comment_id": 99322213, "body": "@melpomene I agree. I will see if we can enable those flags anyway ;)"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1559120069, "creation_date": 1559120069, "answer_id": 56356662, "question_id": 56356453, "link": "https://stackoverflow.com/questions/56356453/why-is-fprintf-causing-memory-leak-and-behaving-unpredictably-when-width-argumen/56356662#56356662", "title": "Why is fprintf causing memory leak and behaving unpredictably when width argument is missing", "body": "<p>Formally this is undefined behavior.</p>\n\n<p>As for what you're observing in practice:<br>\nMy guess is that <code>fprintf</code> ends up using an uninitialized integer as the number of decimal places to output. That's because it'll try to read a number from a location where the caller didn't write any particular value, so you'll just get whatever bits happen to be stored there. If that happens to be a huge number, <code>fprintf</code> will try to allocate a lot of memory to store the result string internally. That would explain the \"running out of memory\" part.</p>\n\n<p>If the uninitialized value isn't quite that big, the allocation will succeed and you'll end up with a lot of zeroes.</p>\n\n<p>And finally, if the random integer value happens to be just <code>5</code>, you'll get <code>0.00000</code>.</p>\n\n<p>Valgrind probably consistently initializes the memory your program sees, so the behavior becomes deterministic.</p>\n\n<blockquote>\n  <p>Could this not be made to always fail</p>\n</blockquote>\n\n<p>I'm pretty sure it won't even compile if you use <code>gcc -pedantic -Wall -Wextra -Werror</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "is_accepted": false, "score": 1, "last_activity_date": 1559121349, "creation_date": 1559121349, "answer_id": 56357065, "question_id": 56356453, "link": "https://stackoverflow.com/questions/56356453/why-is-fprintf-causing-memory-leak-and-behaving-unpredictably-when-width-argumen/56357065#56357065", "title": "Why is fprintf causing memory leak and behaving unpredictably when width argument is missing", "body": "<p>This is undefined behaviour in the standard. It means \"anything is fair game\" because you're doing wrong things.</p>\n\n<p>The worst part is that most certainly any compiler will warn you, but you have ignored the warning. Putting some kind of validation other than the compiler will incurr in a cost that <em>everybody</em> will pay just so you can do what's wrong. </p>\n\n<p>That's the opposite of what C and C++ stand for: you pay for what you use. If you want to pay the cost, it's up to you to do the checking.</p>\n\n<p>What's really happening depends on the ABI, compiler and architecture. It's undefined behaviour because the language gives the implementer the freedom to do what's better on every machine (meaning, sometimes faster code, sometimes shorter code).</p>\n\n<p>As an example, when you call a function on the machine, it just means that you're instructing the microprocessor to go to a certain code location.</p>\n\n<p>In some made up assembly and ABI, then, <code>printf(\"%.*f\", 5, 1);</code> will translate into something like</p>\n\n<pre><code>mov A, STR_F ; // load into register A the 32 bit address of the string \"%.*f\"\nmov B, 5 ; // load second 32 bit parameter into B \nmov F0, 1.0 ; // load first floating point parameter into register F0\ncall printf ; // call the function\n</code></pre>\n\n<p>Now, if you miss some parameter, in this case B, it will take any value that was there before.</p>\n\n<p>The thing with functions like <code>printf</code> is that they allow <em>anything</em> in their parameter list (it's <code>printf(const char*, ...)</code>, so anything is valid). That's why you shouldn't use <code>printf</code> on C++: you have better alternatives, like streams. <code>printf</code> avoids the checkings of the compiler. streams are better aware of types and are extensible to your own types. Also, that's why your code should compile without warnings.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 2, "last_activity_date": 1559123587, "last_edit_date": 1559123587, "creation_date": 1559123283, "answer_id": 56357675, "question_id": 56356453, "link": "https://stackoverflow.com/questions/56356453/why-is-fprintf-causing-memory-leak-and-behaving-unpredictably-when-width-argumen/56357675#56357675", "title": "Why is fprintf causing memory leak and behaving unpredictably when width argument is missing", "body": "<p><strong>Undefined behaviour is undefined.</strong></p>\n\n<p>However, on x86-64 System-V ABI it is <strong>well-known</strong> that arguments are <strong>not passed on stack</strong> but in registers. Floating point variables are passed in <strong>floating-point registers</strong>, and integers are passed in <strong>general-purpose registers</strong>. There is no parameter store on stack, so the width of the arguments does not matter. Since you never passed any <em>integer</em> in the variable argument part, the general purpose register corresponding to the first argument will contain whatever garbage it had from before.</p>\n\n<p>This program will show how the floating point values and integers are passed separately:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    fprintf(stdout, \"%.*f\\n\", 42, 0.0);\n    fprintf(stdout, \"%.*f\\n\", 0.0, 42);\n}\n</code></pre>\n\n<p>Compiled on x86-64, GCC  + Glibc, both <code>printf</code>s will produce the <em>same output</em>:</p>\n\n<pre><code>0.000000000000000000000000000000000000000000\n0.000000000000000000000000000000000000000000\n</code></pre>\n"}], "owner": {"reputation": 352, "user_id": 2190626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1c69be9c0232fee7bb9bc140a91e41?s=128&d=identicon&r=PG", "display_name": "morten", "link": "https://stackoverflow.com/users/2190626/morten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 56356662, "answer_count": 4, "score": 2, "last_activity_date": 1559123587, "creation_date": 1559119420, "question_id": 56356453, "link": "https://stackoverflow.com/questions/56356453/why-is-fprintf-causing-memory-leak-and-behaving-unpredictably-when-width-argumen", "title": "Why is fprintf causing memory leak and behaving unpredictably when width argument is missing", "body": "<p>The following simple program is behaving unpredictably. Sometimes it prints \"0.00000\", sometimes it prints more \"0\" than I can count. Some times it uses up all memory on the system, before the system either kills some process, or it fails with bad_alloc.</p>\n\n<pre><code>#include \"stdio.h\"\n\nint main() {\n  fprintf(stdout, \"%.*f\", 0.0);\n}\n</code></pre>\n\n<p>I'm aware that this is incorrect usage of fprintf. There should be another argument specifying the width of the formatting. It's just surprising that the behavior is so unpredictable. Sometimes it seems to use a default width, while sometimes it fails very badly. Could this not be made to always fail or always use some default behaviour?</p>\n\n<p>I came over similar usage in some code at work, and spent a lot of time figuring out what was happening. It only seemed to happen with debug builds, but would not happen while debugging with gdb. Another curiosity is that running it through valgrind would consistently bring about the printing of many \"0\"s case, which otherwise happens quite seldom, but the memory usage issue would never occur then either.</p>\n\n<p>I am running Red Hat Enterprise Linux 7, and compiled with gcc 4.8.5.</p>\n"}, {"tags": ["c", "fopen", "freopen"], "comments": [{"owner": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "edited": false, "score": 0, "creation_date": 1559118165, "post_id": 56356005, "comment_id": 99316270, "body": "Possible duplicate of: <a href=\"https://stackoverflow.com/questions/16122732/c-freopen-for-redirecting-needs-fclose\" title=\"c freopen for redirecting needs fclose\">stackoverflow.com/questions/16122732/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 11522918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f69780445bc133fff3a165132e445?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11522918/daniel"}, "reply_to_user": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "edited": false, "score": 0, "creation_date": 1559118231, "post_id": 56356005, "comment_id": 99316306, "body": "@EUS I had a look at that, but i&#39;m not using stdout or stdin here, its another file. (Sorry if that&#39;s essentially the same thing, I just don&#39;t understand)"}, {"owner": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "edited": false, "score": 0, "creation_date": 1559118381, "post_id": 56356005, "comment_id": 99316400, "body": "When the program ends both files will be automatically closed, so it is not extrictly necessary, but yes recommendable"}, {"owner": {"reputation": 723, "user_id": 10454790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KgTAEhXsikc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUzmIL0mpexoEX8YwlIRZB54Ac2SA/mo/photo.jpg?sz=128", "display_name": "Mete Han Kahraman", "link": "https://stackoverflow.com/users/10454790/mete-han-kahraman"}, "edited": false, "score": 1, "creation_date": 1559118437, "post_id": 56356005, "comment_id": 99316427, "body": "You can have multiple files opened at the same time, just make sure you close them at some point.(if some other program tries to access the files you are reading/writing problems might arise) If you are %100 sure no one else uses these files, do whatever you want."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559119856, "post_id": 56356005, "comment_id": 99317176, "body": "<code>freopen</code> closes the original file, and associates the given <code>FILE</code> pointer with the new file. Which means that the code only has one file open at a time, and therefore only one file to close. And yes, it is good practice to close a file when you&#39;re done with it."}, {"owner": {"reputation": 27, "user_id": 11522918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f69780445bc133fff3a165132e445?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11522918/daniel"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559119929, "post_id": 56356005, "comment_id": 99317210, "body": "@user3386109 Perfect! That&#39;s exactly what I couldn&#39;t confirm - I wasn&#39;t sure if the old pointer still needed to be closed or not. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1559120255, "creation_date": 1559120255, "answer_id": 56356731, "question_id": 56356005, "link": "https://stackoverflow.com/questions/56356005/do-you-need-to-fclose-both-files-after-freopen/56356731#56356731", "title": "Do you need to fclose() both files after freopen()?", "body": "<p>From the <a href=\"https://linux.die.net/man/3/freopen\" rel=\"nofollow noreferrer\">man page</a></p>\n\n<blockquote>\n  <p>The <code>freopen()</code> function opens the file whose name is the string pointed to by path and associates the stream pointed to by stream with it. <strong>The original stream (if it exists) is closed.</strong> [...]</p>\n</blockquote>\n\n<p>So, you don't need to close the previous stream explicitly, once done usage, just close the recent stream.</p>\n"}], "owner": {"reputation": 27, "user_id": 11522918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f69780445bc133fff3a165132e445?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11522918/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 56356731, "answer_count": 1, "score": 2, "last_activity_date": 1559120316, "creation_date": 1559117913, "last_edit_date": 1559120316, "question_id": 56356005, "link": "https://stackoverflow.com/questions/56356005/do-you-need-to-fclose-both-files-after-freopen", "title": "Do you need to fclose() both files after freopen()?", "body": "<p>I'm writing a code which takes one file and saves it into another with a different name - however, I am not sure whether or not I need to fclose both files or not?</p>\n\n<pre><code>FILE *logfile = fopen(\"log.txt\", \"a+\");\nwhile(1) {\n    char filename[500];\n    char logline[512]; \n    char channel[512];\n\n    //Do stuff\n\n    sprintf(filename, \"%s.log.txt\", channel);\n    freopen(filename, \"a+\", logfile);\n    log_to_file(logline, logfile);\n}\n</code></pre>\n"}, {"tags": ["c", "can-bus", "socketcan"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1559125883, "post_id": 56357858, "comment_id": 99320613, "body": "I tried CAN_RAW_JOIN_FILTERS already and it had no effect. Together, my four rules don&#39;t work with that option either. I guess, the only way for me to receive only desired CAN_IDs is to create rules for them, instead of trying to block undesired IDs."}, {"owner": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "reply_to_user": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1559126540, "post_id": 56357858, "comment_id": 99320954, "body": "Can you have a look at the setsockopt return value ? If it is -1 it means that your kernel doesn&#39;t support the option. If so, I think there are no solution left except the one where you white-list every id."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1559126783, "post_id": 56357858, "comment_id": 99321082, "body": "Yes, the return value is -1. Whitelisting it is then. Thank you nonetheless! Btw: uname -r returns &quot;4.4.38-tegra&quot;."}], "tags": [], "owner": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "is_accepted": false, "score": 2, "last_activity_date": 1559123841, "creation_date": 1559123841, "answer_id": 56357858, "question_id": 56355857, "link": "https://stackoverflow.com/questions/56355857/socketcan-filtering-of-frames-with-certain-can-ids-not-working/56357858#56357858", "title": "SocketCAN: Filtering of frames with certain CAN IDs not working", "body": "<p>When using CAN_INV_FILTER like you do, you specify \"everything goes through except ID_x\".</p>\n\n<p>When using CAN_RAW_FILTER, it will check if there is a rule which let the received ID pass. In your case, your rules are contradicting each others, this is why nothing is filtered.</p>\n\n<p>From the <a href=\"https://www.kernel.org/doc/Documentation/networking/can.txt\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>4.1.6 RAW socket option CAN_RAW_JOIN_FILTERS</p>\n  \n  <p>The CAN_RAW socket can set multiple CAN identifier specific filters\n  that   lead to multiple filters in the af_can.c filter processing.\n  These filters   are indenpendent from each other which leads to\n  logical OR'ed filters when   applied (see 4.1.1).</p>\n  \n  <p>This socket option joines the given CAN filters in the way that only\n  CAN   frames are passed to user space that matched <em>all</em> given CAN\n  filters. The   semantic for the applied filters is therefore changed\n  to a logical AND.</p>\n  \n  <p>This is useful especially when the filterset is a combination of\n  filters   where the CAN_INV_FILTER flag is set in order to notch\n  single CAN IDs or   CAN ID ranges from the incoming traffic.</p>\n</blockquote>\n\n<p>To have the expected behavior, you should replace:</p>\n\n<pre><code>setsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER, &amp;rfilter, sizeof(rfilter));\n</code></pre>\n\n<p>by:</p>\n\n<pre><code>setsockopt(s, SOL_CAN_RAW, CAN_RAW_JOIN_FILTERS, &amp;rfilter, sizeof(rfilter));\n</code></pre>\n\n<p>NB: it is possible that the CAN_RAW_JOIN_FILTERS option isn't supported by your Linux kernel</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 3877012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0sG8z.png?s=128&g=1", "display_name": "Oliver Hartkopp", "link": "https://stackoverflow.com/users/3877012/oliver-hartkopp"}, "is_accepted": false, "score": 1, "last_activity_date": 1566931090, "creation_date": 1566931090, "answer_id": 57680496, "question_id": 56355857, "link": "https://stackoverflow.com/questions/56355857/socketcan-filtering-of-frames-with-certain-can-ids-not-working/57680496#57680496", "title": "SocketCAN: Filtering of frames with certain CAN IDs not working", "body": "<p>You first need to provide the CAN filtes:</p>\n\n<pre><code>setsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER, &amp;rfilter, sizeof(rfilter));\n</code></pre>\n\n<p>and <strong>additionally</strong> an <strong>integer value</strong> to enable the CAN_RAW_JOIN_FILTERS via setsockopt()</p>\n\n<pre><code>int join_filter = 1;\nsetsockopt(s, SOL_CAN_RAW, CAN_RAW_JOIN_FILTERS, &amp;join_filter, sizeof(join_filter));\n</code></pre>\n\n<p>Btw. if you provide CAN filters to the CAN_RAW_JOIN_FILTERS to setsockopt() this is an unexpected length and should produce -EINVAL as return code.</p>\n\n<p>See candump code:\n<a href=\"https://github.com/linux-can/can-utils/commit/1a2467ed29302149d4d1253888ac1f1dfcc11d3f\" rel=\"nofollow noreferrer\">https://github.com/linux-can/can-utils/commit/1a2467ed29302149d4d1253888ac1f1dfcc11d3f</a></p>\n\n<p>And yes, Linux 4.4 supports CAN_RAW_JOIN_FILTERS :-)</p>\n"}], "owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2587, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1566931090, "creation_date": 1559117384, "question_id": 56355857, "link": "https://stackoverflow.com/questions/56355857/socketcan-filtering-of-frames-with-certain-can-ids-not-working", "title": "SocketCAN: Filtering of frames with certain CAN IDs not working", "body": "<p>I'm trying to filter CAN frames with certain IDs as described here: <a href=\"https://landlock.io/linux-doc/landlock-v8/networking/can.html#raw-protocol-sockets-with-can-filters-sock-raw\" rel=\"nofollow noreferrer\">https://landlock.io/linux-doc/landlock-v8/networking/can.html#raw-protocol-sockets-with-can-filters-sock-raw</a></p>\n\n<p>Part of my code:</p>\n\n<pre><code>struct can_filter rfilter[4];\n\nif ((s = socket(PF_CAN, SOCK_RAW, CAN_RAW)) &lt; 0) {\n    fprintf(stderr, \"Error while opening socket.\\n\");\n    exit(EXIT_FAILURE);\n}\nrfilter[0].can_id   = 0x0D6 | CAN_INV_FILTER;\nrfilter[0].can_mask = CAN_SFF_MASK;\nrfilter[1].can_id   = 0x0D8 | CAN_INV_FILTER;\nrfilter[1].can_mask = CAN_SFF_MASK;\nrfilter[2].can_id   = 0x0E4 | CAN_INV_FILTER;\nrfilter[2].can_mask = CAN_SFF_MASK;\nrfilter[3].can_id   = 0x77F | CAN_INV_FILTER;\nrfilter[3].can_mask = CAN_SFF_MASK;\nsetsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER, &amp;rfilter, sizeof(rfilter));\n</code></pre>\n\n<p>If I use only one of my four filters and comment out the other three, it's working as expected. If I use all four filters, it's not working at all. In that case I'm still receiving everything on the CANbus interface.</p>\n\n<p>So, my guess is that somehow my filters are neutralising each other?! What do I need to change to filter the CAN IDs 0x0D6, 0x0D8, 0x0E4, and 0x77F?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1559116476, "post_id": 56355582, "comment_id": 99315354, "body": "please format the code according to <a href=\"https://meta.stackexchange.com/questions/22186/how-do-i-format-my-code-blocks\" title=\"how do i format my code blocks\">meta.stackexchange.com/questions/22186/&hellip;</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1559116757, "post_id": 56355582, "comment_id": 99315506, "body": "You don&#39;t. How does <code>sock_yield</code> invoke <code>fn</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1559117529, "creation_date": 1559117529, "answer_id": 56355907, "question_id": 56355582, "link": "https://stackoverflow.com/questions/56355582/how-to-pass-a-pointer-to-a-function-with-parameters-to-another-function/56355907#56355907", "title": "How to pass &quot;a pointer to a function with parameters&quot; to another function", "body": "<p>You cannot do this. Converting between different function types is strictly speaking undefined behavior, although some compilers have non-standard extensions that allow it at some extent.</p>\n\n<p>In addition, <code>void (*fn)()</code> means a function taking any parameters, which is obsolete style C and shouldn't be used.</p>\n\n<p>So the <code>sock_yield</code> function must be rewritten. If it was meant to take a callback function as parameter, it was badly written from the start. It should take function pointers of one specific, specified format. For example:</p>\n\n<pre><code>typedef void sock_callback_t (char buf, udp_socket* sock);\n\nint sock_yield(void* s, sock_callback_t* fn); \n</code></pre>\n\n<p>Alterntatively you could write some hack where you convert between function pointers and <code>uintptr_t</code>, but it is a worse solution that should only be used if you are stuck with a badly written API.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1559117991, "creation_date": 1559117991, "answer_id": 56356031, "question_id": 56355582, "link": "https://stackoverflow.com/questions/56355582/how-to-pass-a-pointer-to-a-function-with-parameters-to-another-function/56356031#56356031", "title": "How to pass &quot;a pointer to a function with parameters&quot; to another function", "body": "<p>You cannot. C only knows raw pointer to functions. You can then give all the required parameters when you use the pointer. Example:</p>\n\n<pre><code>int double(int i) {\n    return 2*1;\n}\n\nint exec_op(int param, int (*op)()) {\n   return op(param);\n}\n</code></pre>\n\n<p>This works because in C a void parameter list means that the function can accept any parameters.</p>\n\n<p>If in your use case <code>sock_yield</code> calls the function without parameters, the only option is to use a wrapper using global parameters:</p>\n\n<pre><code>char Buf;\nudp_Socket Sock;\n\nvoid reset_wrapper(void) {\n    reset(Buf, Sock);\n}\n</code></pre>\n\n<p>and later use it that way:</p>\n\n<pre><code>    Buf = buf;\n    Sock = sock;\n    sock_yield(s, &amp;reset_wrapper);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11571195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcd497c2bfb611e7962bbd6aaec8970?s=128&d=identicon&r=PG&f=1", "display_name": "pchemaly", "link": "https://stackoverflow.com/users/11571195/pchemaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1559133354, "creation_date": 1559116385, "last_edit_date": 1559133354, "question_id": 56355582, "link": "https://stackoverflow.com/questions/56355582/how-to-pass-a-pointer-to-a-function-with-parameters-to-another-function", "title": "How to pass &quot;a pointer to a function with parameters&quot; to another function", "body": "<p>I have the following system function: </p>\n\n<pre><code>int sock_yield( void *s, void (*fn)() );\n</code></pre>\n\n<p>to which I need to pass a function that takes 2 parameters:</p>\n\n<pre><code>void reset(char buf,udp_Socket sock) {\n\n    if (-1 == udp_recv(&amp;sock, &amp;buf, sizeof(buf)));\n\n    if(buf=='R')\n    {\n\n        printf(\"\\nReceived-&gt; %c\",buf);\n\n        forceSoftReset();\n\n        forceWatchdogTimeout();\n\n    }\n\n}\n</code></pre>\n\n<p>When calling <code>sock_yield</code> function I can only pass it the name of the function without its parameter:\n<code>sock_yield(sock, reset)</code></p>\n\n<p>How to specify the parameters of <code>reset</code> to be passed to <code>sock_yield</code>?</p>\n"}, {"tags": ["c", "exit", "atexit"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1559115115, "post_id": 56355008, "comment_id": 99314627, "body": "You should mostly call <code>_exit</code> ever when in a child process after a <code>fork</code> and you must not call the original cleanup code because the clean up belongs to the parent."}], "answers": [{"tags": [], "owner": {"reputation": 332, "user_id": 10627654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UehfI.jpg?s=128&g=1", "display_name": "abbasi_ahsan", "link": "https://stackoverflow.com/users/10627654/abbasi-ahsan"}, "is_accepted": true, "score": 3, "last_activity_date": 1559114666, "last_edit_date": 1559114666, "creation_date": 1559114317, "answer_id": 56355051, "question_id": 56355008, "link": "https://stackoverflow.com/questions/56355008/how-can-i-use-atexit-function-to-cleanup-function-call/56355051#56355051", "title": "How can I use atexit() function to cleanup function call?", "body": "<p>This behavior of atexit() function is due to the use of function _exit(). This function does not call the clean-up functions like atexit() etc. If atexit() is required to be called then exit() or \u2018return\u2019 should be used instead of _exit().</p>\n\n<p>As:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid ftn(void)\n{\n    printf(\" Function called --&gt; exit\\n\");\n    return;\n}\nint main(void)\n{\n    int x = 0;\n    atexit(ftn);\n    for(;x&lt;0xffffff;x++);\n    exit(0);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": false, "score": 2, "last_activity_date": 1559114333, "creation_date": 1559114333, "answer_id": 56355057, "question_id": 56355008, "link": "https://stackoverflow.com/questions/56355008/how-can-i-use-atexit-function-to-cleanup-function-call/56355057#56355057", "title": "How can I use atexit() function to cleanup function call?", "body": "<p><code>_exit</code> close the program without calling at exit methods <a href=\"https://en.cppreference.com/w/c/program/_Exit\" rel=\"nofollow noreferrer\">Further reading</a>.</p>\n\n<p>Thus, use <code>exit(0);</code> instead of <code>_exit(0);</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid ftn(void)\n{\n    printf(\" Function called --&gt; exit\\n\");\n    return;\n}\nint main(void)\n{\n    int x = 0;\n    atexit(ftn);\n    for(;x&lt;0xffffff;x++);\n    exit(0);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1559114812, "last_edit_date": 1559114812, "creation_date": 1559114432, "answer_id": 56355082, "question_id": 56355008, "link": "https://stackoverflow.com/questions/56355008/how-can-i-use-atexit-function-to-cleanup-function-call/56355082#56355082", "title": "How can I use atexit() function to cleanup function call?", "body": "<p><a href=\"https://linux.die.net/man/3/_exit\" rel=\"nofollow noreferrer\">Quoting the man page for <code>_exit()</code></a></p>\n\n<blockquote>\n  <p>The <code>_Exit()</code> and <code>_exit()</code> functions <strong>shall not call functions registered with <code>atexit()</code></strong> nor any registered signal handlers. Whether open streams are flushed or closed, or temporary files are removed is implementation-defined. Finally, the calling process is terminated with the consequences described below.</p>\n</blockquote>\n\n<p>So what you're seeing is expected behavior.</p>\n\n<p>That said, you should include <code>unistd.h</code> (for <code>_exit()</code>)and <code>stdlib.h</code> (for <code>atexit()</code>) headers for including the prototype.</p>\n\n<p>If you want the functions registered by <code>atexit()</code> to be invoked, you should call <code>exit()</code> instead.</p>\n\n<blockquote>\n  <p>The <code>exit()</code> function shall first call all functions registered by <code>atexit()</code>, in the reverse order of their registration, [....]</p>\n</blockquote>\n"}], "owner": {"reputation": 91, "user_id": 11531526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d446b417d1c8eb5fe73e6184d84189?s=128&d=identicon&r=PG&f=1", "display_name": "AR.5", "link": "https://stackoverflow.com/users/11531526/ar-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "closed_date": 1559114866, "accepted_answer_id": 56355051, "answer_count": 3, "score": 3, "last_activity_date": 1559114909, "creation_date": 1559114185, "last_edit_date": 1559114685, "question_id": 56355008, "link": "https://stackoverflow.com/questions/56355008/how-can-i-use-atexit-function-to-cleanup-function-call", "closed_reason": "Duplicate", "title": "How can I use atexit() function to cleanup function call?", "body": "<p>I am using atexit() function inside my code to cleanup function call, but it's not working.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid ftn(void)\n{\n    printf(\" Function called --&gt; exit\\n\");\n    return;\n}\nint main(void)\n{\n    int x = 0;\n    atexit(ftn);\n    for(;x&lt;0xffffff;x++);\n    _exit(0);\n}\n</code></pre>\n\n<p>Any help regarding this will be appreciated.</p>\n"}, {"tags": ["c++", "c", "libxml2"], "answers": [{"comments": [{"owner": {"reputation": 17546, "user_id": 13022, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fe131c1359157fb83187527255bb60cc?s=128&d=identicon&r=PG", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/13022/st%c3%a9phane"}, "edited": false, "score": 0, "creation_date": 1559115691, "post_id": 56355213, "comment_id": 99314919, "body": "Something is either missing or not quite right with that code.  Where does the xmlDoc get passed in to be formatted?"}, {"owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "reply_to_user": {"reputation": 17546, "user_id": 13022, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fe131c1359157fb83187527255bb60cc?s=128&d=identicon&r=PG", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/13022/st%c3%a9phane"}, "edited": false, "score": 0, "creation_date": 1559116622, "post_id": 56355213, "comment_id": 99315442, "body": "xmlDoc gets passed in betweeen the two snippets of code; you write to buf using xmlDoc, perhaps <a href=\"http://www.xmlsoft.org/html/libxml-tree.html#xmlNodeDump\" rel=\"nofollow noreferrer\">xmlNodeDump</a> might help"}], "tags": [], "owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "is_accepted": false, "score": 0, "last_activity_date": 1559114950, "creation_date": 1559114950, "answer_id": 56355213, "question_id": 56355002, "link": "https://stackoverflow.com/questions/56355002/pretty-print-with-libxml2/56355213#56355213", "title": "Pretty print with libxml2?", "body": "<p>Stolen from <a href=\"https://stackoverflow.com/questions/27798232/is-it-possible-to-send-libxml-output-to-a-file-handle\">here</a>:</p>\n\n<pre><code>xmlBufferPtr buf;\n/* Create a new XML buffer, to which the XML document will be\n * written */\nbuf = xmlBufferCreate();\nif (buf == NULL) {\n    std::cerr &lt;&lt; \"testXmlwriterMemory: Error creating the xml buffer\" &lt;&lt; std::endl;\n    return;\n}\n\n/* Create a new XmlWriter for memory, with no compression.\n * Remark: there is no compression for this kind of xmlTextWriter */\nwriter = xmlNewTextWriterMemory(buf, 0);\nif (writer == NULL) {\n    std::cerr &lt;&lt; \"testXmlwriterMemory: Error creating the xml writer\" &lt;&lt; std::endl;\n    return;\n}\n</code></pre>\n\n<p>And then, after you have written to the buffer:</p>\n\n<pre><code>std::cout &lt;&lt; buf-&gt;content &lt;&lt; std::endl\n</code></pre>\n"}], "owner": {"reputation": 17546, "user_id": 13022, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fe131c1359157fb83187527255bb60cc?s=128&d=identicon&r=PG", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/13022/st%c3%a9phane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 603, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1586277466, "creation_date": 1559114164, "question_id": 56355002, "link": "https://stackoverflow.com/questions/56355002/pretty-print-with-libxml2", "title": "Pretty print with libxml2?", "body": "<p>Using libxml2.  I can pretty-print the XML into a file by using <code>xmlSaveFormatFileEnc()</code>.  But is there a way to do the same thing into a text string or stream?</p>\n\n<p>I'd like to avoid writing the XML out to a file and reading it back in just to get the pretty-print version of the XML.</p>\n\n<p>For the record, what I'm doing now is the following:</p>\n\n<pre><code>xmlInitParser();\nxmlKeepBlanksDefault(0);\nxmlLineNumbersDefault(1);\nxmlThrDefIndentTreeOutput(1);\nxmlThrDefTreeIndentString(\"    \");\n\nstd::string content = \".....\"; // do something here to get the XML\nxmlDoc * doc = xmlParseDoc((xmlChar*)content.c_str());\n\nxmlSaveFormatFileEnc(\"output.xml\", doc, \"utf-8\", 1); // pretty print\n</code></pre>\n"}, {"tags": ["c", "casting", "scanf"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1559114461, "post_id": 56354986, "comment_id": 99314269, "body": "Is <code>xyz</code> really aligned to 32bits? Otherwise <code>sscanf(s3, &quot;%u&quot;, (uint32_t*) &amp;(foo-&gt;xyz));</code> will have an analigned write access."}, {"owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1559115144, "post_id": 56354986, "comment_id": 99314649, "body": "@mch: you are right, <code>sizeof(Foo)</code> is 12"}, {"owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559115196, "post_id": 56354986, "comment_id": 99314681, "body": "@Broman: of course it is undefined behavior, the question is: what is actually happening? Why does this still work on this architecture?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1559118444, "post_id": 56354986, "comment_id": 99316431, "body": "As to why it happens to work regardless of alignment: <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0473m/dom1359731171041.html\" rel=\"nofollow noreferrer\">Apparently some ARM cores do support some unaligned accesses.</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559118577, "post_id": 56354986, "comment_id": 99316510, "body": "You could run into problems with endianness and alignment on some platforms.  Others will appear to work.  None of them is guaranteed to work.  One solution is to read the values into a local <code>unsigned int</code> variable and assign the value scanned to the member of the structure, possibly after range-checking the values destined for the <code>uint8_t</code> variables (and preferably after checking the result from <code>sscanf()</code> each time and dealing with any failures)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559128676, "post_id": 56354986, "comment_id": 99322154, "body": "&quot;but what about a legacy C89 compiler?&quot; --&gt; C89 does not have ` uint8_t,  uint32_t`, so scanning is just one of many problems then."}, {"owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559129277, "post_id": 56354986, "comment_id": 99322460, "body": "@chux that was obviously not the point of the question. Anyway, I replaced the fixed integer types from C99 with the plain old types."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559129327, "post_id": 56354986, "comment_id": 99322486, "body": "Poor SO etiquette to fundamental change the question as answer come in.  Rolled back."}, {"owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559129723, "post_id": 56354986, "comment_id": 99322702, "body": "@chux: that was a perfectly legitimate edit on a minor detail. I will redo the edit."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559130268, "post_id": 56354986, "comment_id": 99323002, "body": "If you feel the edit was minor, it can go either way - including leaving it as original.  Yet 3 answers all are reduced in value as they all address the original fixed width types."}, {"owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559130691, "post_id": 56354986, "comment_id": 99323239, "body": "@chux please note that your own answer is OT in either case: the question is clearly &quot;what kind of undefined behavior is causing this obvious bug to work&quot;; you answered &quot;code is UB as scan specifiers does not match arguments&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559114732, "post_id": 56355090, "comment_id": 99314416, "body": "<i>the scanf will write outside the memory allocated</i> Unless the hardware has alignment restrictions on 32-bit <code>int</code> values that don&#39;t exist for <code>char</code> values, and the original <code>char</code> value isn&#39;t properly aligned."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559115313, "post_id": 56355090, "comment_id": 99314738, "body": "@AndrewHenle Even if there is a padding (and this the implementation related thing) it is still the UB. Just imagine the build where structs are packed."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1559114475, "creation_date": 1559114475, "answer_id": 56355090, "question_id": 56354986, "link": "https://stackoverflow.com/questions/56354986/what-happens-if-arguments-passed-to-sscanf-are-cast/56355090#56355090", "title": "What happens if arguments passed to sscanf are cast", "body": "<p>In this case from the pointer point of view nothing as on the all modern machines pointers are the same for all types.</p>\n\n<p>But because you use wrong formats - the scanf will write outside the memory allocated to the variables and it is an Undefined Behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1559118306, "post_id": 56355978, "comment_id": 99316359, "body": "As an additional note for C89: just use temporary variable with correct type. Or simply use <code>strtoul</code> as there seems to be no benefit in using <code>sscanf</code>."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": false, "score": 2, "last_activity_date": 1559117816, "creation_date": 1559117816, "answer_id": 56355978, "question_id": 56354986, "link": "https://stackoverflow.com/questions/56354986/what-happens-if-arguments-passed-to-sscanf-are-cast/56355978#56355978", "title": "What happens if arguments passed to sscanf are cast", "body": "<blockquote>\n  <p>Bonus question: what is the cleanest correct way to do this? I know that now we have the %hhu format specifier (apparently introduced by C++11), but what about a legacy C89 compiler?</p>\n</blockquote>\n\n<p>The <code>&lt;stdint.h&gt;</code> header and its types were introduced in C99, so a C89 compiler won't support them except as an extension.</p>\n\n<p>The correct way to use the <code>*scanf()</code> and <code>*printf()</code> families of functions with the various fixed or minimum-width types is to use the macros from <a href=\"https://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\"><code>&lt;inttypes.h&gt;</code></a>. For example:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n  int8_t foo;\n  uint_least16_t bar;\n\n  puts(\"Enter two numbers\");\n  if (scanf(\"%\" SCNd8 \" %\" SCNuLEAST16, &amp;foo, &amp;bar) != 2) {\n    fputs(\"Input failed!\\n\", stderr);\n    return EXIT_FAILURE;\n  }\n  printf(\"You entered %\" PRId8 \" and %\" PRIuLEAST16 \"\\n\", foo, bar);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559128448, "post_id": 56356462, "comment_id": 99322024, "body": "<code>uint32_t u;</code> <code>sscanf(s2, &quot;%u&quot;, &amp;u);</code> make sense when <code>unsigned</code> is  32-bit.  Yet C does not require that."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1559119464, "creation_date": 1559119464, "answer_id": 56356462, "question_id": 56354986, "link": "https://stackoverflow.com/questions/56354986/what-happens-if-arguments-passed-to-sscanf-are-cast/56356462#56356462", "title": "What happens if arguments passed to sscanf are cast", "body": "<p>First of all, this of course invokes Undefined Behaviour.</p>\n\n<p>But that kind of horror was quite common in old code, where the C language was used as a higher level assembly language. So here are 2 possible behaviours:</p>\n\n<ul>\n<li>the structure has a 32 bits alignment. All is (rather fine) on a little endian machine: the <code>uint8_t</code> members will recieve the least significant byte of the 32 bits value and the padding bytes will be zeroed (I assume that the program does not try to store a value greater than 255 into an <code>uint8_t</code>)</li>\n<li>the structure has not a 32 bits alignement, but the architecture allows <code>scanf</code> to write into mis-aligned variables. The least significant byte of the value read for <code>qux</code> will correctly go into <code>qux</code> and the next 3 zero bytes will erase <code>xyz</code> and <code>etc</code>. On next line, <code>xyz</code> receives its value and <code>etc</code> recieves one more 0 byte. And finally <code>etc</code> will recieve its value. This could have been a rather common hack in the early 80' on an 8086 type machine.</li>\n</ul>\n\n<p>For a portable way, I would use an temporary unsigned integer:</p>\n\n<pre><code>uint32_t u;\nsscanf(s1, \"%u\", &amp;(foo-&gt;bar));\nsscanf(s2, \"%u\", &amp;u);\nfoo-&gt;qux = (uint8_t) u;\nsscanf(s3, \"%u\", &amp;u);\nfoo-&gt;xyz = (uint8_t) u;\nsscanf(s4, \"%u\", &amp;(foo-&gt;etc));\n</code></pre>\n\n<p>and trust the compiler to generate code as efficient as the <em>horror</em> way.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1559129166, "creation_date": 1559129166, "answer_id": 56359507, "question_id": 56354986, "link": "https://stackoverflow.com/questions/56354986/what-happens-if-arguments-passed-to-sscanf-are-cast/56359507#56359507", "title": "What happens if arguments passed to sscanf are cast", "body": "<p>OP code is UB as scan specifiers does not match arguments.</p>\n\n<blockquote>\n  <p>cleanest correct way to do this?</p>\n</blockquote>\n\n<p><strong>Cleaner</strong></p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\nvoid horror1(const char* s1, const char* s2, const char* s3, const char* s4, Foo* foo) {\n    sscanf(s1, \"%\" SCNu32, &amp;(foo-&gt;bar));\n    sscanf(s2, \"%\" SCNu8, &amp;(foo-&gt;qux));\n    sscanf(s2, \"%\" SCNu8, &amp;(foo-&gt;xyz));\n    sscanf(s1, \"%\" SCNu32, &amp;(foo-&gt;etc));\n}\n</code></pre>\n\n<p><strong>Cleanest</strong></p>\n\n<p>Add additional error handling if desired.</p>\n\n<pre><code>void horror2(const char* s1, const char* s2, const char* s3, const char* s4, Foo* foo) {\n    foo-&gt;bar = (uint32_t) strtoul(s1, 0, 10);\n    foo-&gt;qux = (uint8_t) strtoul(s1, 0, 10);\n    foo-&gt;xyz = (uint8_t) strtoul(s1, 0, 10);\n    foo-&gt;etc = (uint32_t) strtoul(s1, 0, 10);\n}\n</code></pre>\n"}], "owner": {"reputation": 5857, "user_id": 297373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/lwUTS.png?s=128&g=1", "display_name": "lornova", "link": "https://stackoverflow.com/users/297373/lornova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 56356462, "answer_count": 4, "score": 3, "last_activity_date": 1559130469, "creation_date": 1559114116, "last_edit_date": 1559130469, "question_id": 56354986, "link": "https://stackoverflow.com/questions/56354986/what-happens-if-arguments-passed-to-sscanf-are-cast", "title": "What happens if arguments passed to sscanf are cast", "body": "<p>While reviewing and old piece of code, I stumbled upon some coding horror like this one:</p>\n\n<pre><code>struct Foo\n{\n    unsigned int  bar;\n    unsigned char qux;\n    unsigned char xyz;\n    unsigned int  etc;\n};\n\nvoid horror(const char* s1, const char* s2, const char* s3, const char* s4, Foo* foo)\n{\n    sscanf(s1, \"%u\", &amp;(foo-&gt;bar));\n    sscanf(s2, \"%u\", (unsigned int*) &amp;(foo-&gt;qux));\n    sscanf(s3, \"%u\", (unsigned int*) &amp;(foo-&gt;xyz));\n    sscanf(s4, \"%u\", &amp;(foo-&gt;etc));\n}\n</code></pre>\n\n<p>So, what is actually happening in the second and third <code>sscanf</code>, with the argument passed being a <code>unsigned char*</code> cast to <code>unsigned int*</code>, but with the format specifier for an unsigned integer? Whatever happens is due to undefined behavior, but why is this even \"working\"?</p>\n\n<p>As far as I know, the cast effectively does nothing in this case (the actual type of the arguments passed as <code>...</code> is unknown to the called function). However this has been in production for years and it has never crashed and the surrounding values apparently are not overwritten, I suppose because the members of the structure are all aligned to 32 bits. This is even reading the correct value on the target machine (a little endian 32 bit ARM) but I think that it would no longer work on a different endianness.</p>\n\n<p>Bonus question: what is the cleanest correct way to do this? I know that now we have the <code>%hhu</code> format specifier (apparently introduced by C++11), but what about a legacy C89 compiler?</p>\n\n<hr>\n\n<p>Please note that the original question had <code>uint32_t</code> instead of <code>unsigned int</code> and <code>unsigned char</code> instead of <code>uint8_t</code> but that was just misleading and out of topic, and by the way the original code I was reviewing uses its own typedefs.</p>\n"}, {"tags": ["c", "pointers", "pass-by-value"], "comments": [{"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 2, "creation_date": 1559112012, "post_id": 56354465, "comment_id": 99313164, "body": "Classic problem of <a href=\"https://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value\">pass by value vs pass by reference</a>"}, {"owner": {"reputation": 699, "user_id": 5249411, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pWaUR.png?s=128&g=1", "display_name": "Aram Becker", "link": "https://stackoverflow.com/users/5249411/aram-becker"}, "edited": false, "score": 0, "creation_date": 1559112050, "post_id": 56354465, "comment_id": 99313183, "body": "I your code tree is a pointer to a variable. When you call tree = xxx you set the pointer to a new memory location and the original tree pointer is unaltered, pointing to the old empty tree"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10501459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3xPY4g_d4D8/AAAAAAAAAAI/AAAAAAAAA-s/QHw69Kc3_Pk/photo.jpg?sz=128", "display_name": "Fraser Langton", "link": "https://stackoverflow.com/users/10501459/fraser-langton"}, "edited": false, "score": 0, "creation_date": 1559112656, "post_id": 56354479, "comment_id": 99313455, "body": "<code>node *tree = NULL;</code> means it&#39;s a pointer does it not?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 55, "user_id": 10501459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3xPY4g_d4D8/AAAAAAAAAAI/AAAAAAAAA-s/QHw69Kc3_Pk/photo.jpg?sz=128", "display_name": "Fraser Langton", "link": "https://stackoverflow.com/users/10501459/fraser-langton"}, "edited": false, "score": 0, "creation_date": 1559112749, "post_id": 56354479, "comment_id": 99313498, "body": "@FraserLangton Yes, but check carefully, what are you trying to change from the called function, the content of the memory pointed to by the pointer, or the pointer itself? Pointer or not, all function arguments are passed by value in C."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 55, "user_id": 10501459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3xPY4g_d4D8/AAAAAAAAAAI/AAAAAAAAA-s/QHw69Kc3_Pk/photo.jpg?sz=128", "display_name": "Fraser Langton", "link": "https://stackoverflow.com/users/10501459/fraser-langton"}, "edited": false, "score": 0, "creation_date": 1559113337, "post_id": 56354479, "comment_id": 99313762, "body": "@Fraser Langton, Re &quot;<i><code>node *tree = NULL;</code> means it&#39;s a pointer does it not?</i>&quot;, Yes, but it&#39;s not a pointer to that which you want to modify. You want to modify the caller&#39;s <code>tree</code>, so you need to pass a pointer to the caller&#39;s <code>tree</code>."}, {"owner": {"reputation": 55, "user_id": 10501459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3xPY4g_d4D8/AAAAAAAAAAI/AAAAAAAAA-s/QHw69Kc3_Pk/photo.jpg?sz=128", "display_name": "Fraser Langton", "link": "https://stackoverflow.com/users/10501459/fraser-langton"}, "edited": false, "score": 0, "creation_date": 1559114409, "post_id": 56354479, "comment_id": 99314238, "body": "Got it! Thanks for the help."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 8, "last_activity_date": 1559112003, "creation_date": 1559112003, "answer_id": 56354479, "question_id": 56354465, "link": "https://stackoverflow.com/questions/56354465/values-vanishing-after-leaving-function/56354479#56354479", "title": "Values vanishing after leaving function", "body": "<p>The problem is, <code>tree</code> is passed as an argument to the function, and by-status which is a pass-by-value in C. Any change made to <code>tree</code> itself inside the function will not be reflected back to the caller.</p>\n\n<p>You need to pass a pointer to <code>tree</code>, if you want to modify <code>tree</code> from the called function.</p>\n\n<p>Something like</p>\n\n<pre><code>void insert(node** tree, int data) {\n  if (*tree == NULL) {\n    *tree = new_node(data);\n    printf(\"inner: %d\\n\", (*tree)-&gt;data);\n  }\n}\n</code></pre>\n\n<p>and call it like</p>\n\n<pre><code>insert(&amp;tree, 4321);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 699, "user_id": 5249411, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pWaUR.png?s=128&g=1", "display_name": "Aram Becker", "link": "https://stackoverflow.com/users/5249411/aram-becker"}, "is_accepted": false, "score": 1, "last_activity_date": 1559112529, "creation_date": 1559112529, "answer_id": 56354584, "question_id": 56354465, "link": "https://stackoverflow.com/questions/56354465/values-vanishing-after-leaving-function/56354584#56354584", "title": "Values vanishing after leaving function", "body": "<p>You initialize tree as a pointer</p>\n\n<pre><code>node *tree = NULL;\n</code></pre>\n\n<p>This means, that the content of the variable is a memory location where your tree is stored.</p>\n\n<p>When you pass that memory location to a function, it's value gets copied to the local variable inside the function.</p>\n\n<p>When you call</p>\n\n<pre><code>tree = new_node(data);\n</code></pre>\n\n<p>what you're doing is assigning a new memory location to the local variable of the <code>tree</code> pointer inside your function. The pointer outside your function still has the same value and points to a memory location with no nodes.</p>\n\n<p>What you'll need to do in order to edit the node inside your function is either define some kind of setter for your node, or set the data property explicitly with <code>tree-&gt;data = xxx</code>. This will alter the content of the memory <code>tree</code> is pointing to rather than altering its memory location. </p>\n"}], "owner": {"reputation": 55, "user_id": 10501459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3xPY4g_d4D8/AAAAAAAAAAI/AAAAAAAAA-s/QHw69Kc3_Pk/photo.jpg?sz=128", "display_name": "Fraser Langton", "link": "https://stackoverflow.com/users/10501459/fraser-langton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1559116706, "accepted_answer_id": 56354479, "answer_count": 2, "score": 1, "last_activity_date": 1559112529, "creation_date": 1559111899, "last_edit_date": 1559112151, "question_id": 56354465, "link": "https://stackoverflow.com/questions/56354465/values-vanishing-after-leaving-function", "closed_reason": "Duplicate", "title": "Values vanishing after leaving function", "body": "<p>I'm writing a function to insert into a tree and the data can be seen (printed) after insertion within the function but when trying to see it in main nothing happens.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>node *tree = NULL;\ninsert(tree, 4321);\nprintf(\"outer: %d\\n\", tree-&gt;data);\n\nvoid insert(node* tree, int data) {\n  if (tree == NULL) {\n    tree = new_node(data);\n    printf(\"inner: %d\\n\", tree-&gt;data);\n  }\n}\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>inner: 4321\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>inner: 4321\nouter: 4321\n</code></pre>\n"}, {"tags": ["c", "memory-management", "linux-kernel", "kmalloc", "vmalloc"], "comments": [{"owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "edited": false, "score": 1, "creation_date": 1559112671, "post_id": 56354432, "comment_id": 99313462, "body": "have you read <a href=\"https://elinux.org/images/b/b0/Introduction_to_Memory_Management_in_Linux.pdf\" rel=\"nofollow noreferrer\">this document</a>, perhaps it might help"}, {"owner": {"reputation": 197, "user_id": 3513722, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f2dfa975f29679023d7d587a470898a6?s=128&d=identicon&r=PG&f=1", "display_name": "Usr1", "link": "https://stackoverflow.com/users/3513722/usr1"}, "reply_to_user": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "edited": false, "score": 0, "creation_date": 1559210017, "post_id": 56354432, "comment_id": 99352775, "body": "I had already gone through that document but still have doubts."}], "owner": {"reputation": 197, "user_id": 3513722, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f2dfa975f29679023d7d587a470898a6?s=128&d=identicon&r=PG&f=1", "display_name": "Usr1", "link": "https://stackoverflow.com/users/3513722/usr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1559140211, "creation_date": 1559111742, "last_edit_date": 1559140211, "question_id": 56354432, "link": "https://stackoverflow.com/questions/56354432/how-kmalloc-and-vmalloc-used-in-32bit-vs-64bit-systems", "title": "How kmalloc() and vmalloc() used in 32bit vs 64bit systems?", "body": "<p>Architecture: X86, Linux</p>\n\n<p>I have gone through several threads related to <code>kmalloc()</code> and <code>vmalloc()</code> and I know the basic differences between them but still have some doubts. I need your help to understand the fundamentals.</p>\n\n<p>So As we know that in 32-bit systems the virtual address space is divided between user and kernel. The high 1GB memory addresses are allocated for kernel and the lower 3GB to user space. </p>\n\n<p>Please correct me i am wrong here:</p>\n\n<ol>\n<li><p>So out of 1GB 896MB is 1:1 mapped (physically contiguous) to the kernel logical address and 128MB is used to access the high memory addresses means accessing the physical(RAM) beyond 896 MB by mapping it into the 128MB using <code>vmalloc()</code>? (lets consider we have 2GB of RAM) </p></li>\n<li><p>And what would happen if we have only 1GB of physical RAM in point 1. The 896MB is 1:1 mapping between kernel logical address and physical addresses achieved through kmalloc(). Then what would be the use of 128MB, why do we need <code>vmalloc()</code> anymore? So lets say if we have 1GB of RAM which entirely can be accessed  through kernel logical address so does that mean that it is possible only when the amount of memory requested by a thread/process can be allocated in physically contiguous addresses. And if there is no physical contiguous memory available, in that case memory allocated will not be physically contiguous, hence we need to use <code>vmalloc()</code> to map it in 128MB of space and access it through there?</p></li>\n<li><p>What happens when we use 64-bit system? Is it true that both <code>kmalloc()</code> and <code>vmalloc()</code> can have enormous amount of address space and can access entire RAM? </p></li>\n</ol>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 4, "creation_date": 1559110728, "post_id": 56354205, "comment_id": 99312619, "body": "Put <code>%%</code> instead of <code>%</code> in your format string."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 10, "last_activity_date": 1559110886, "creation_date": 1559110886, "answer_id": 56354256, "question_id": 56354205, "link": "https://stackoverflow.com/questions/56354205/what-is-the-problem-with-putting-brackets-in-a-printf-code/56354256#56354256", "title": "What is the problem with putting brackets(&quot;(&quot;) in a printf code", "body": "<p>It's not about the parenthesis, it's about the <code>%</code>. For <code>printf()</code> format string, <code>%</code> character has a special meaning.</p>\n\n<p>From <code>C11</code>, chapter \u00a77.21.6.1</p>\n\n<blockquote>\n  <p>[...] The format is composed of zero or more directives: ordinary multibyte\n  characters <strong>(not %)</strong>, which are copied unchanged to the output stream; <strong>and conversion\n  specifications,</strong> each of which results in fetching zero or more subsequent arguments,\n  converting them, if applicable, according to the corresponding conversion specifier, and\n  then writing the result to the output stream.</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>Each conversion specification is introduced by the character <code>%</code>. [...]</p>\n</blockquote>\n\n<p>So, to print a <code>%</code> character itself, you need to put another <code>%</code> as the conversion specifier. From the list of conversion specifiers, (paragraph 8 in the same spec)</p>\n\n<blockquote>\n  <p><code>%</code>    A <code>%</code> character is written. No argument is converted. The complete\n  conversion specification shall be <code>%%</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 349, "user_id": 11571022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4pObhb_AoiM/AAAAAAAAAAI/AAAAAAAAACo/WmIRwtvUrF8/photo.jpg?sz=128", "display_name": "Learner_15", "link": "https://stackoverflow.com/users/11571022/learner-15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 56354256, "answer_count": 1, "score": 4, "last_activity_date": 1559111128, "creation_date": 1559110678, "last_edit_date": 1559111128, "question_id": 56354205, "link": "https://stackoverflow.com/questions/56354205/what-is-the-problem-with-putting-brackets-in-a-printf-code", "title": "What is the problem with putting brackets(&quot;(&quot;) in a printf code", "body": "<p>I've just started C-Programming and have a question on the following code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int num1, num2, num3;\n    int result;\n\n        printf(\"(num1 - num2) x (num2 + num3) x (num3 % num1) \\n\");\n    printf(\"Insert 3 numbers: \");\n    scanf(\"%d %d %d\", &amp;num1, &amp;num2, &amp;num3);\n\n    result = (num1 - num2) * (num2 + num3) * (num3 % num1);\n    printf(\"Answer: %d \", result);\n    return 0;\n}\n</code></pre>\n\n<p>An Error occurs whenever I put the following single line of code:</p>\n\n<pre><code>  printf(\"(num1 - num2) x (num2 + num3) x (num3 % num1) \\n\");\n</code></pre>\n\n<p>The reason I put this in was because I wanted to print this equation, but an error occurs whenever I put this in. The error message seems to say that there is a problem in the usage of brackets, but I don't get why putting brackets becomes a problem.</p>\n\n<p>I expect the output to be,</p>\n\n<pre><code>  (num1 - num2) x (num2 + num3) x (num3 % num1)\n  Insert 3 numbers: \n</code></pre>\n\n<p>But the Following Error occurs:</p>\n\n<p>\"Debug Assertion Failed\"</p>\n\n<p>...</p>\n\n<p>Expression: \"(\"'n' format specifier disabled\",')</p>\n"}, {"tags": ["microcontroller", "c"], "comments": [{"owner": {"reputation": 271, "user_id": 4474509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U8i8y.png?s=128&g=1", "display_name": "Arsenal", "link": "https://stackoverflow.com/users/4474509/arsenal"}, "edited": false, "score": 8, "creation_date": 1559112568, "post_id": 56624901, "comment_id": 99822226, "body": "I&#39;m voting to close this question as off-topic because this is a pure software question and better asked (and probably already has an answer) on StackOverflow."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 2170493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ceSSB.png?s=128&g=1", "display_name": "Warren Hill", "link": "https://stackoverflow.com/users/2170493/warren-hill"}, "edited": false, "score": 2, "creation_date": 1559114592, "post_id": 56624902, "comment_id": 99822227, "body": "Should this be posted as an answer?  Perhaps a comment on the question with a link is more appropriate.  The question is not about electronics design and should be closed anyway."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "Justme"}, "is_accepted": false, "score": 0, "last_activity_date": 1559110632, "creation_date": 1559110632, "answer_id": 56624902, "question_id": 56624901, "link": "https://stackoverflow.com/questions/56624901/in-c-both-static-local-variable-and-static-global-variable-memory-allocation/56624902#56624902", "title": "In C both static local variable and static global variable memory allocation", "body": "<p>This programming question has already been answered in stackoverflow as this has nothing to do with electronics.</p>\n\n<p>That said, local variables have precedence and will shadow a global variable. It is perfectly valid to do so. Some compilers might warn about this. If this bothers you, don't use global and local variables with same name then.</p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 1850429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aeac2c1534ffc9cd94072b3196838b9?s=128&d=identicon&r=PG", "display_name": "Jeroen3", "link": "https://stackoverflow.com/users/1850429/jeroen3"}, "is_accepted": false, "score": 2, "last_activity_date": 1559112171, "creation_date": 1559112171, "answer_id": 56624903, "question_id": 56624901, "link": "https://stackoverflow.com/questions/56624901/in-c-both-static-local-variable-and-static-global-variable-memory-allocation/56624903#56624903", "title": "In C both static local variable and static global variable memory allocation", "body": "<p>There are two things going on here.</p>\n\n<ol>\n<li><p>Variable scopes.\nThere is a public <code>x</code> and a local <code>x</code> in main. Say <code>x</code> and <code>main:x</code>. C defaults to the local one. As far as I am aware, C offers no method to access the global one when the reference has been overridden by a local one. (C++ does, ::)  </p></li>\n<li><p>Different meaning for the <code>static</code> keyword.<br>\n<strong>2.1</strong> The <code>static</code> keyword in global scope means the object <code>x</code> may not be referenced from anywhere except this file. Even with <code>extern</code> it will throw you an error. This is great, as it prevents unintended usage of \"private\" objects in a module.<br>\n<strong>2.2</strong> The <code>static</code> keyword in local scope means the object <code>x</code> will be allocated <strong>once</strong>, <strong>permanently</strong>. Any instance of <code>main()</code> uses the same <code>x</code>.<br>\nLike a global, while only being accessible from within the scope. <code>x</code> will persist even if you exit main. This also means you cannot use an initializer, it will error on the above if not 0. Since when should it do the initialization?\n<a href=\"https://stackoverflow.com/a/21152256/1850429\">Standard specifies all static objects in local scope shall be initialized</a>.<br>\nLocal statics are great if you need to carry over data to the next time the functions runs, especially with interrupts, but do not want the data to be public.</p></li>\n</ol>\n\n<p>Static is a great keyword to do basic data hiding for multi file microcontroller programs. Keeping your code clean and not littered with globals.  </p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://chiphacker.com", "http://www.chiphacker.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1300734875, "open_beta_date": 1285786800, "closed_beta_date": 1285786800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/electronics/Img/apple-touch-icon@2.png", "twitter_account": "StackElectronix", "favicon_url": "https://cdn.sstatic.net/Sites/electronics/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/electronics/Img/apple-touch-icon.png", "audience": "electronics and electrical engineering professionals, students, and enthusiasts", "site_url": "https://electronics.stackexchange.com", "api_site_parameter": "electronics", "logo_url": "https://cdn.sstatic.net/Sites/electronics/Img/logo.png", "name": "Electrical Engineering", "site_type": "main_site"}, "on_date": 1560747217, "question_id": 440871}, "owner": {"reputation": 63, "user_id": 6304635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa9dbd89540ea3edff2d82907d7a6f5?s=128&d=identicon&r=PG&f=1", "display_name": "Manju", "link": "https://stackoverflow.com/users/6304635/manju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560747217, "creation_date": 1559110059, "question_id": 56624901, "link": "https://stackoverflow.com/questions/56624901/in-c-both-static-local-variable-and-static-global-variable-memory-allocation", "title": "In C both static local variable and static global variable memory allocation", "body": "<p>In C both static local variable and static global variable with same name declaration are done in same file. They both are stored in data segment memory.</p>\n\n<p>When I compile code why it is not throwing error?</p>\n\n<p>In same memory 2 variable with same name can be stored?</p>\n\n<p>Please find code below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstatic int x = 0;\n\nvoid call()\n{\n    printf(\"Adress of gloabl static =%p\",&amp;x);  \n}\n\nint main()\n{\n    static int x = 0;\n    printf(\"Adress of local static =%p\",&amp;x);\n    call();\n}\n</code></pre>\n"}, {"tags": ["c", "atoi"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1559110121, "post_id": 56354070, "comment_id": 99312368, "body": "<a href=\"https://linux.die.net/man/3/atoi\" rel=\"nofollow noreferrer\">read the man page</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1559111295, "last_edit_date": 1559111295, "creation_date": 1559110247, "answer_id": 56354107, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype/56354107#56354107", "title": "I want to plus the number form string datatype", "body": "<p><a href=\"https://linux.die.net/man/3/atoi\" rel=\"nofollow noreferrer\"><code>atoi()</code></a> does not do what you think it does.</p>\n\n<p>A possible way to achieve what you want is to use <code>atoi()</code>, or better, <code>strtol()</code> to convert the user input to integer type, and then use the modulo operaptor to extract each digit and add them.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;ctype.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n\n int main(void){                     //correct signature\n\n     int total=0;                    // no need to be global\n     char numstr[100] = {0};         // same\n     int ret = -1;\n\n     printf(\"Num:\");\n     ret = scanf(\"%99s\",numstr);       \n     if (ret != 1){                    // basic sanity check for scanf\n         printf(\"Error in scanning\\n\");\n         exit (-1);\n     }\n\n     long int converted = strtol(numstr, NULL, 10);   // convert to integer\n     printf(\"%ld\\n\\n\", converted);\n\n     for (int i = 0; converted; i++){\n\n         total += converted %10;                // add the digit\n         converted /= 10;                       // reduce the last added digit\n     }\n\n     printf(\"%d\",total);\n     return 0;                               // return 0 is implicit for `main()`, anyways\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 3, "creation_date": 1559110563, "post_id": 56354151, "comment_id": 99312555, "body": "a better version of this would be to subtract <code>&#39;0&#39;</code>, since that doesn&#39;t rely on the ascii codes for numbers."}], "tags": [], "owner": {"reputation": 1129, "user_id": 6319901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fb677ce3a7ce11c93597c803c82fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Sorrow", "link": "https://stackoverflow.com/users/6319901/dark-sorrow"}, "is_accepted": true, "score": 2, "last_activity_date": 1559110572, "last_edit_date": 1559110572, "creation_date": 1559110467, "answer_id": 56354151, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype/56354151#56354151", "title": "I want to plus the number form string datatype", "body": "<p>You can subtract the numeric character (in ASCII) by 0x30 (i.e. ASCII character zero '0') to convert the ASCII numeric character to its decimal equivalent.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;ctype.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n char numstr[100];\n int total=0;\n main(){\n printf(\"Num:\");\n scanf(\"%s\",numstr);\n\n for(int i = 0;i&lt;strlen(numstr);i++){\n     total += numstr[i] - 0x30;\n }\n printf(\"%d\",total);\n }\n</code></pre>\n\n<p>The string \"12345\" will be</p>\n\n<pre><code>1 -&gt; 0x31 - 0x30 = 1\n2 -&gt; 0x32 - 0x30 = 2\n3 -&gt; 0x33 - 0x30 = 3\n4 -&gt; 0x34 - 0x30 = 4\n5 -&gt; 0x35 - 0x30 = 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11571043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f80cd064ba2adaf04eaf4b8df9d28c6?s=128&d=identicon&r=PG&f=1", "display_name": "clay_george", "link": "https://stackoverflow.com/users/11571043/clay-george"}, "is_accepted": false, "score": 0, "last_activity_date": 1559110611, "creation_date": 1559110611, "answer_id": 56354187, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype/56354187#56354187", "title": "I want to plus the number form string datatype", "body": "<p>Simple! Take the input as string and subtract the character by '0'. This will give you the number at that particular position. See my code below : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nchar numstr[100];\nint total=0;\nmain(){\nprintf(\"Num:\");\nscanf(\"%s\",numstr);\n\nfor(int i = 0;i&lt;strlen(numstr);i++){\n total += (numstr[i]-'0');\n}\nprintf(\"%d\",total);\n}\n</code></pre>\n\n<p>Saves the hassle of using atoi() or other functions.</p>\n"}, {"tags": [], "owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "is_accepted": false, "score": 0, "last_activity_date": 1559110636, "creation_date": 1559110636, "answer_id": 56354195, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype/56354195#56354195", "title": "I want to plus the number form string datatype", "body": "<p>A simpler approach to your problem could be to replace </p>\n\n<pre><code>total += atoi(numstr[i]);\n</code></pre>\n\n<p>with</p>\n\n<pre><code>total += numstr[i] - '0';\n</code></pre>\n\n<p>You might want to to check if isdigit(numstr[i]) is true first, for error checking.</p>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 10951967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5dac4dbd5c234f60dc91a5ebd04c1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Incze", "link": "https://stackoverflow.com/users/10951967/norbert-incze"}, "is_accepted": false, "score": 1, "last_activity_date": 1559201848, "last_edit_date": 1559201848, "creation_date": 1559110656, "answer_id": 56354199, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype/56354199#56354199", "title": "I want to plus the number form string datatype", "body": "<p>You can get the integer value of a digit character by subtracting the zero character from it.</p>\n\n<p><code>total += numstr[i] - '0';</code></p>\n\n<p>It is because the <code>0</code> character has value equal with <code>48</code> in decimal (or <code>0x30</code> in hexadecimal), <code>1</code> character is equal with <code>49</code> in decimal, <code>2</code> with <code>50</code> and so on..</p>\n\n<p>Subtracting the <code>0</code> character from itself, results in <code>0</code> (decimal). Subtracting the <code>0</code> character from character <code>1</code> results in <code>1</code> (decimal) and so on..</p>\n"}], "owner": {"reputation": 21, "user_id": 11553954, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J1FFVZoTrDQ/AAAAAAAAAAI/AAAAAAAAAqI/wpP2csSC1Qc/photo.jpg?sz=128", "display_name": "ModelZ Z", "link": "https://stackoverflow.com/users/11553954/modelz-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56354151, "answer_count": 5, "score": 1, "last_activity_date": 1559201848, "creation_date": 1559109998, "last_edit_date": 1559124365, "question_id": 56354070, "link": "https://stackoverflow.com/questions/56354070/i-want-to-plus-the-number-form-string-datatype", "title": "I want to plus the number form string datatype", "body": "<p>I have the following input as string:</p>\n\n<pre><code>Num: 12345\n</code></pre>\n\n<p>I would like to print out the sum of digits from the input (1+2+3+4+5 = 15):</p>\n\n<pre><code>total:15\n</code></pre>\n\n<p>I tried, but there is a problem with <code>atoi()</code> in the <code>for</code> loop and I got an error:</p>\n\n<blockquote>\n  <p>[Error] invalid conversion from 'char' to 'const char*'</p>\n</blockquote>\n\n<p>How can I fix that or how can I resolve it in an easier way?</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;ctype.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n char numstr[100];\n int total = 0;\n\n main(){\n     printf(\"Num:\");\n     scanf(\"%s\", numstr);\n\n     for(int i = 0; i &lt; strlen(numstr); i++){\n         total += atoi(numstr[i]);\n     }\n     printf(\"%d\", total);\n }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1559109149, "post_id": 56353862, "comment_id": 99311974, "body": "You might try to use different settings for C standard version. But according to <a href=\"https://stackoverflow.com/a/49028959/6782754\">Lundin&#39;s answer to this question</a>, I would not expect too much. VLA are a feature of C99 and even became optional with C11. VS is not known for outstanding standard conformance."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 1, "creation_date": 1559109237, "post_id": 56353862, "comment_id": 99312011, "body": "You can create a int pointer like <code>int *array</code> then use for loop to assign some value to the pointer will work same for you."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 1, "creation_date": 1559109322, "post_id": 56353862, "comment_id": 99312052, "body": "@Vaibhav Using a pointer would require allocating some memory. That is tricky given that <code>malloc</code> and <code>calloc</code> shall not be used."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1559109733, "post_id": 56353862, "comment_id": 99312227, "body": "What about <code>_alloca()</code>?"}, {"owner": {"reputation": 37, "user_id": 10784424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3V0LjIu0zxU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iH3YFQhER8POfU8CYR2G29z6KpLw/mo/photo.jpg?sz=128", "display_name": "Tejas", "link": "https://stackoverflow.com/users/10784424/tejas"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1559110794, "post_id": 56353862, "comment_id": 99312646, "body": "No,, @Vaibhav whaen I am using pointer program get terminated.."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1559113003, "post_id": 56353862, "comment_id": 99313612, "body": "How do you use the pointer? Why can&#39;t you use <code>malloc</code> or <code>calloc</code>?"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1559116231, "post_id": 56353862, "comment_id": 99315217, "body": "1. x should be <code>unsigned</code> or better <code>size_t</code> and <code>const</code> because is not change in function. 2. After validate you should use <code>malloc</code> and <code>free</code> after operations. I mean validate so you must provide max expected length, and after malloc check <code>v_X_array != NULL</code> pointer after malloc is NULL when there are not enought memory to allocate."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1559121310, "post_id": 56353862, "comment_id": 99318032, "body": "You need a compiler from 1999 or later. VS 2010 is far older than that. I guess the number 2010 stands for the number of ISO 9899:1999 violations and not the year of release."}, {"owner": {"reputation": 652, "user_id": 11224588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2898ec4197f20a99d75710d96ad85c3?s=128&d=identicon&r=PG&f=1", "display_name": "Diodacus", "link": "https://stackoverflow.com/users/11224588/diodacus"}, "edited": false, "score": 0, "creation_date": 1559212203, "post_id": 56353862, "comment_id": 99353722, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5246900/enabling-vlas-variable-length-arrays-in-ms-visual-c\">Enabling VLAs (variable length arrays) in MS Visual C++?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559822544, "post_id": 56357644, "comment_id": 99544610, "body": "If you need your C code to be portable, you cannot use MSVC. That&#39;s a bit strongly stated, but MSVC simply is not a conforming C compiler. See <a href=\"https://stackoverflow.com/questions/51960833/visual-studio-2017-does-not-supportc11-new-feature-generic\" title=\"visual studio 2017 does not supportc11 new feature generic\">stackoverflow.com/questions/51960833/&hellip;</a> among many others documenting MSVC&#39;s lack of conformance to C standards."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559822918, "post_id": 56357644, "comment_id": 99544805, "body": "@AndrewHenle: In my mind, I have the distinction between the code I write (&quot;my code&quot;) and everything else done by the system (in this case MSVC). I agree that the project itself might not be portable, but some fragments can. Example (my case): I prefer to train myself in writing portable code always. I write non-portable code only when I have no alternative."}], "tags": [], "owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "is_accepted": false, "score": -1, "last_activity_date": 1559193732, "last_edit_date": 1559193732, "creation_date": 1559123170, "answer_id": 56357644, "question_id": 56353862, "link": "https://stackoverflow.com/questions/56353862/how-do-create-a-variable-length-array-in-c-in-visual-studio-2010-enviroment/56357644#56357644", "title": "How do create a variable length array in C in Visual Studio 2010 enviroment?", "body": "<p>If you need your code to be portable, you cannot use that kind of array definition to handle memory areas.</p>\n\n<p>Without going into specific implementations, you have two generic approaches that you can use:</p>\n\n<ol>\n<li><strong>Define an array big enough for the worst case.</strong> This is tightly dependent on the application, so you are on your own.</li>\n<li><strong>Define the \"array\" using dynamic allocation.</strong> With that, you can define memory areas of any arbitrary size.</li>\n</ol>\n\n<p>If you choose option 2:</p>\n\n<p>a. Do not forget to de-allocate the memory when you no longer need it.</p>\n\n<p>b. To avoid frequent allocation and de-allocation, you may define the buffer once (perhaps bigger then necessary for the current call) and use it several times. You may and up with the same result as option 1 above - define a large array from the start.</p>\n\n<hr>\n\n<p>Since you should not use dynamic allocation (\"calloc and malloc should not be used\"), then you are left with option 1.</p>\n\n<hr>\n\n<blockquote>\n  <p>I expect the ans as <strong>v_X_array[0] = 0</strong>, v_X_array[1] =1, v_X_array[2]=2 ... <strong>v_X_array[10]=10</strong> ; for <strong>x = 10</strong>;</p>\n</blockquote>\n\n<p>You expect to store 11 values in an array which can hold only 10?</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1559822829, "post_id": 56365696, "comment_id": 99544755, "body": "Support for Variable-length arrays <a href=\"https://port70.net/~nsz/c/c99/n1256.html#6.7.5.2\" rel=\"nofollow noreferrer\">is mandatory in C per the C99 standard</a>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1598887517, "post_id": 56365696, "comment_id": 112596061, "body": "@AndrewHenle: What does the 1999 C standard have to do with a question asked in 2019 about Visual Studio 2010, which did not support the C standard?"}], "tags": [], "owner": {"reputation": 19, "user_id": 7050186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNMBy.jpg?s=128&g=1", "display_name": "Fouad", "link": "https://stackoverflow.com/users/7050186/fouad"}, "is_accepted": false, "score": -1, "last_activity_date": 1559822251, "last_edit_date": 1559822251, "creation_date": 1559150564, "answer_id": 56365696, "question_id": 56353862, "link": "https://stackoverflow.com/questions/56353862/how-do-create-a-variable-length-array-in-c-in-visual-studio-2010-enviroment/56365696#56365696", "title": "How do create a variable length array in C in Visual Studio 2010 enviroment?", "body": "<p>You can't allocate an array of an unknown size.\nSo you need to allocate it dynamically \"at run-time\".\nyou can make this allocation using \"new\" in C++ or \"malloc\" in C.</p>\n\n<p>For example:</p>\n\n<p>In C++ if you want to allocate an array of an unknown size you should do the following:</p>\n\n<pre><code>int* v_X_array = new int[x];\nint i;\nfor (i=0; i&lt;x; i++)\n{\n    v_X_array[i] = i;\n}\n</code></pre>\n\n<p>The reason that we use integer pointer is that \"new\" returns the base address of the array \"the address of the first element\", so the only thing that can store addresses is pointers.</p>\n\n<p>In C if you want to allocate an array of an unknown size you should do the following:</p>\n\n<pre><code>    int* v_X_array = (int*) malloc(x*sizeof(int));\n    int i;\n    for(i=0; i&lt;x; i++)\n    {\n        v_X_array[i] = i;\n    }\n</code></pre>\n\n<p>The <code>malloc</code> function takes a single argument which specifies the number of bytes to be allocated and returns a void pointer so the casting (int*) is required.</p>\n\n<p>For more explanations, look at the next section:</p>\n\n<p>If we need to allocate an array of 20 integers it could be as follow: \"malloc(20*sizeof(int))\" where 20 is the number of allocated elements and sizeof(int) is the size of the type you want to allocate. If successful it returns a pointer to memory allocated. If it fails, it returns a null pointer.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H72Ab.png\" rel=\"nofollow noreferrer\">Enter image description here</a></p>\n"}], "owner": {"reputation": 37, "user_id": 10784424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3V0LjIu0zxU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iH3YFQhER8POfU8CYR2G29z6KpLw/mo/photo.jpg?sz=128", "display_name": "Tejas", "link": "https://stackoverflow.com/users/10784424/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1035, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559822251, "creation_date": 1559108879, "last_edit_date": 1559822065, "question_id": 56353862, "link": "https://stackoverflow.com/questions/56353862/how-do-create-a-variable-length-array-in-c-in-visual-studio-2010-enviroment", "title": "How do create a variable length array in C in Visual Studio 2010 enviroment?", "body": "<p>I want to create a variable length array for my code in the Visual&nbsp;Studio&nbsp;2010 environment.</p>\n\n<p>I had tried the code using the array of length x, as it is passing by the user. But I am facing the error as:</p>\n\n<blockquote>\n  <p>\"error C2466:cannot allocate an array of constant size 0\" ,\"error C2133: 'v_X_array' : unknown size\".</p>\n</blockquote>\n\n<pre><code>func1(int x)\n{\n    int v_X_array[x];\n    int i;\n    for (i=0; i&lt;x; i++)\n    {\n        v_X_array[i] = i;\n    }\n}\n</code></pre>\n\n<p>I expect the answer as <code>v_X_array[0] = 0</code>, <code>v_X_array[1] =1</code>, <code>v_X_array[2]=2</code> ... <code>v_X_array[10]=10</code> ; for <code>x = 10;</code></p>\n\n<p>How can I do this?</p>\n\n<p>Note: as <code>calloc</code> and <code>malloc</code> should not be used.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1559104221, "post_id": 56353106, "comment_id": 99310654, "body": "<a href=\"https://stackoverflow.com/a/5144867/2850543\">stackoverflow.com/a/5144867/2850543</a> for streams"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1559104288, "post_id": 56353106, "comment_id": 99310669, "body": "Also, I did not vote to close this as too broad because I don&#39;t believe this is a broad question. It has a succinct, accurate answer."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559104533, "post_id": 56353106, "comment_id": 99310710, "body": "The term &quot;stream&quot; is used for a variety of things, some of which are listed in <a href=\"https://en.wikipedia.org/wiki/Stream_(computing)\" rel=\"nofollow noreferrer\">this wikipedia article</a>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559104584, "post_id": 56353106, "comment_id": 99310719, "body": "@user3386109: It is rather easy to imagine what OP meant by &quot;stream&quot;, especially in relation to &quot;buffer&quot;, and under <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> tag."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1559104771, "post_id": 56353106, "comment_id": 99310766, "body": "@Amadan Yes, did you read the article? It lists several examples of <i>&quot;what a stream is&quot;</i> which is what the OP asked."}, {"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559104926, "post_id": 56353106, "comment_id": 99310801, "body": "@user3386109 it&#39;s stack overflow, why would i bother to ask about a stream of water or something else here?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559105005, "post_id": 56353106, "comment_id": 99310814, "body": "@VanTeoLe You didn&#39;t read the article either, did you? That article doesn&#39;t say a single thing about water."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559105082, "post_id": 56353106, "comment_id": 99310831, "body": "@user3386109: I did read it, but I believe OP would be confused by the variety of related meanings. It is obvious the meanings are related once one knows them, but at this moment I strongly believe OP should focus on one of them - the one relevant to his query - and only when they need to, to investigate how it relates to others. VanTeoLe - noone mentioned a stream of water."}, {"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559105220, "post_id": 56353106, "comment_id": 99310860, "body": "@user3386109 my fault sorry"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559106470, "post_id": 56353106, "comment_id": 99311131, "body": "@user3386109 If that was in response to me, then there&#39;s a one sentence definition of a stream in the page you linked (the first sentence). If not, then carry on."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1559106645, "post_id": 56353106, "comment_id": 99311169, "body": "@MillieSmith Ok, I&#39;ll carry on. For the record, that comment was directed to the OP (specifically in response to <i>&quot;can you help me imagine what a stream is&quot;</i>), and was unrelated to your comments."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559107007, "post_id": 56353106, "comment_id": 99311259, "body": "@user3386109 Sounds good. I definitely misinterpreted, so I&#39;m sorry if you got a notification for my first message that I deleted (or if 28k rep lets you see deleted comments)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1559107476, "post_id": 56353106, "comment_id": 99311411, "body": "@MillieSmith I think only the diamond mods can see deleted comments (I certainly can&#39;t). So no worries."}], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "edited": false, "score": 0, "creation_date": 1559105011, "post_id": 56353170, "comment_id": 99310817, "body": "So metaphorically, fflush() pour water from the bucket to the tub?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "edited": false, "score": 0, "creation_date": 1559105257, "post_id": 56353170, "comment_id": 99310865, "body": "Pretty much, though it is limited to the output buffers. It is an imperfect analogy, but still quite close to reality. Also note that there are a variety of buffers - some you create yourself, some are under the hood and used by the OS, some are in hardware and you have no programmatic access to them. But the purpose is always the same - accumulate the dripping data till a process or a device is ready for it."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1559104857, "last_edit_date": 1559104857, "creation_date": 1559104537, "answer_id": 56353170, "question_id": 56353106, "link": "https://stackoverflow.com/questions/56353106/relationship-between-stream-and-buffer/56353170#56353170", "title": "Relationship between stream and buffer?", "body": "<p>A stream is either a source (input stream) or sink (output stream) of data, that is available (or provided) in time (as opposed to all at once).</p>\n\n<p>A buffer is an array (a piece of memory) that is used to store data temporarily. An input buffer is typically filled from an input stream by the OS; an output buffer (once filled by the programmer) is consumed by the OS.</p>\n\n<p>Imagine you want to fill a tub with water. You start with a water source like a water tank or public waterworks that can be transfered through a water tap. You put a bucket under the water tap and turn it on. When the bucket is full, you dump it into the tub, and put it back under the tap. You repeat that until your tub is full.</p>\n\n<p>Loading a file, for example, works almost the same way. You have a data source (the file on disk); you open an input stream (a programmatic construct that will give you data generally as fast as the disk can read them). You allocate a buffer (a small memory area) and tell the system to fill it from the stream. When it is full, you append it to the big chunk of allocated memory that you reserved for file contents, then let the buffer be filled again. When the whole file is read, you close the stream.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 7332896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lmUiUdpv39k/AAAAAAAAAAI/AAAAAAAAABM/XIy1LhaRpSs/photo.jpg?sz=128", "display_name": "sahushivam", "link": "https://stackoverflow.com/users/7332896/sahushivam"}, "is_accepted": false, "score": 1, "last_activity_date": 1559105710, "last_edit_date": 1559105710, "creation_date": 1559105362, "answer_id": 56353288, "question_id": 56353106, "link": "https://stackoverflow.com/questions/56353106/relationship-between-stream-and-buffer/56353288#56353288", "title": "Relationship between stream and buffer?", "body": "<p>Difference between a buffer and a stream is </p>\n\n<p>A <strong>Stream</strong> is a sequence of bytes of data that transfers information from or to a specified source. </p>\n\n<p>A sequence of bytes flowing into a program is called input stream. A sequence of bytes flowing out of the program is called output stream\nUse of Stream makes I/O machine independent.</p>\n\n<p>A <strong>Buffer</strong> is a sequence of bytes that are stored in memory.</p>\n\n<p>In C, I/O operations are asynchronous: you don\u2019t know when you have data nor how much of it. <strong>So a buffer is usually used to collect data from the stream</strong> (file, socket, device). When the buffer is full, consumers of that stream are notified and can consume data from the buffer until is depleted. Then wait for the buffer to be filled again before using that data. It is a place to store something temporarily, in order to mitigate differences between the input speed and output speed. While the producer is being faster than the consumer, the producer can continue to store the output in the buffer. When the consumer speeds up, it can read from the buffer. The buffer is there in the middle to bridge the gap.</p>\n\n<p>Y in your question can be a file, socket or a device(I/O).</p>\n\n<p>Hope this solves your Query :)</p>\n"}], "owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 56353170, "answer_count": 2, "score": 0, "last_activity_date": 1559117046, "creation_date": 1559103948, "question_id": 56353106, "link": "https://stackoverflow.com/questions/56353106/relationship-between-stream-and-buffer", "title": "Relationship between stream and buffer?", "body": "<p>I'm a newbie programmer, can you help me imagine what a stream is, is it a fixed array of bytes that transfer data from i.e: a file to Y? And what is Y here, a buffer or something else?\nIn what way is the buffer related to stream?</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1559101264, "post_id": 56352778, "comment_id": 99310059, "body": "By default the stack is mapped read+write but not execute.  You want <code>gcc -zexecstack</code>.  But I don&#39;t understand why you&#39;re popping whatever&#39;s on the stack before jumping, or including a <code>pop</code> <i>after</i> the jmp (which doesn&#39;t have any way to return).  Normally you&#39;d just cast it to a function pointer and call it, so the C compiler emits a <code>call</code> instruction."}, {"owner": {"reputation": 889, "user_id": 7709727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5aad459e897d2e3a8a4613be455ecb16?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Stdlib", "link": "https://stackoverflow.com/users/7709727/eric-stdlib"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559103728, "post_id": 56352778, "comment_id": 99310570, "body": "The pop instructions are just random instructions (may be replaced by other instructions later). I think the <code>-zexecstack</code> solves my problem."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559104581, "post_id": 56352778, "comment_id": 99310718, "body": "Replaced later how?  Not at runtime, because you don&#39;t have the address of that code.  If you want to use <code>call</code> instead of <code>jmp</code> and have your machine code actually return, you should <i>not</i> use inline asm for this.  You&#39;re clobbering the compiler&#39;s registers without telling it, and you inevitably clobber the red-zone where the compiler might have been keeping stuff below RSP.  Cast to a function pointer.  See the linked duplicate for the syntax for casting to a function pointer and dereferencing the result to get a return value."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 1, "creation_date": 1559106650, "post_id": 56352778, "comment_id": 99311171, "body": "Normally, the pages of your program&#39;s memory that are writable are set as non-executable, and those that are executable are set as non-writable.  You can change protections for a region of memory by calling <code>mprotect(2)</code>."}], "owner": {"reputation": 889, "user_id": 7709727, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5aad459e897d2e3a8a4613be455ecb16?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Stdlib", "link": "https://stackoverflow.com/users/7709727/eric-stdlib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1559101512, "answer_count": 0, "score": 0, "last_activity_date": 1559102971, "creation_date": 1559101151, "question_id": 56352778, "link": "https://stackoverflow.com/questions/56352778/x86-64-jumping-to-writable-address", "closed_reason": "Duplicate", "title": "x86_64 jumping to writable address", "body": "<p>I am trying to write a C program on Linux that jumps to a location that can be written by the program itself. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char* argv[]) {\n    char a[] = {0x41, 0x5c, 0x41, 0x5d, 0x41, 0x5e, 0x41, 0x5f, 0x0};\n    __asm__(\"pop %%r12;\"\n            \"jmp *%[a];\"\n            \"pop %%r11;\" : : [a] \"r\" (a) : );\n    return 0;\n}\n</code></pre>\n\n<p>Array <code>a</code> contains instruction <code>pop %r12; pop %r13; pop %r14; pop %r15</code>, and I hope to use the jmp instruction to jump to array <code>a</code>'s address and execute the instructions. </p>\n\n<p>However, this program raises segment fault when executing. I used <code>gcc</code> to compile my program and <code>gdb</code> to step through each instruction. What I find is that the program successfully jumps to array <code>a</code>'s address, but before it can execute the first instruction, the it receives signal SIGSEGV. </p>\n\n<p>Why is this happening? Does it mean that I cannot jump to a writable location? Is this a hardware limitation? (If so, how can I check whether my CPU supports this kind of jump? )</p>\n\n<p>I am using a x86_64 CPU, and the program is compiled in 64-bit mode. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1559097884, "post_id": 56352382, "comment_id": 99309457, "body": "<code>fpointer</code> gets updated inside <code>fgets</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "reply_to_user": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1559097924, "post_id": 56352382, "comment_id": 99309463, "body": "I don&#39;t understand"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1559098019, "post_id": 56352382, "comment_id": 99309488, "body": "Are you saying that <code>fgets(...); for(...) printf(...)</code> prints the same line 4 times?  Why is that surprising?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559098141, "post_id": 56352382, "comment_id": 99309513, "body": "Each <code>fgets</code> reads a single line, placing it in <code>line</code>.  If you call it 4 times, printing <code>line</code> after each call, you will print those 4 lines.  If you call it once, outside of the loop, then the loop is just going to print the first line 4 times."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "edited": false, "score": 0, "creation_date": 1559098178, "post_id": 56352382, "comment_id": 99309523, "body": "No Will, I am trying to understand how fgets() gets incremented when I haven&#39;t passed the incrementer &quot;i&quot; into it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "edited": false, "score": 0, "creation_date": 1559098250, "post_id": 56352382, "comment_id": 99309539, "body": "Thanks Tom, how do I check your answer?"}], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 6649816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TQJKUCa5q_M/AAAAAAAAAAI/AAAAAAAABDg/GQgsVqO9luU/photo.jpg?sz=128", "display_name": "Guillaume Quintard", "link": "https://stackoverflow.com/users/6649816/guillaume-quintard"}, "is_accepted": true, "score": 1, "last_activity_date": 1559098837, "creation_date": 1559098837, "answer_id": 56352513, "question_id": 56352382, "link": "https://stackoverflow.com/questions/56352382/fgets-issues-with-for-loop-in-c/56352513#56352513", "title": "fgets() issues with for loop in C", "body": "<p><code>fgets</code> will read the file using <code>fpointer</code> (think of it as a cursor), and will increment it. So every time you use <code>fgets</code> you move forward in the file.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559102744, "last_edit_date": 1559102744, "creation_date": 1559102342, "answer_id": 56352909, "question_id": 56352382, "link": "https://stackoverflow.com/questions/56352382/fgets-issues-with-for-loop-in-c/56352909#56352909", "title": "fgets() issues with for loop in C", "body": "<p>While you already have a fine answer explaining the movement of the <em>file position indicator</em> with a file-stream each time a call to <code>fgets()</code> (or any other input function is made), one additional necessary point not to be overlooked is to <em>Always check the</em> <strong>return</strong> of the input function to ensure the call succeeded <em>before</em> using the information read.</p>\n\n<p>In your case, when using the <code>for</code> loop, if there are less then 4 lines in the file, or if a stream-error occurs, you blindly pass the <code>line</code> to <code>printf</code> for output without ever knowing if it contains valid data. This is an invitation for <em>Undefined Behavior</em>. Always check the return.</p>\n\n<p>When reading data, you generally want to control the input loop with the read function itself. In other cases, such as when requesting specific user input, you want to loop continually until the needed information is provided. In both cases you are checking and using the return of the input function to determine whether the loop continues.</p>\n\n<p>To read all lines in the file, presuming that was your input, you would simply do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char line[255];\n    FILE *fpointer = fopen(\"employees.txt\", \"r\");\n\n    while (fgets(line, 255, fpointer)) {    /* control read loop with fgets */\n        line[strcspn (line, \"\\r\\n\")] = 0;   /* trim \\n from end of line */\n        puts (line);\n    }\n    fclose(fpointer);\n\n    return 0;\n}\n</code></pre>\n\n<p>If your intent is to read a specific number of lines, then simply include a counter, e.g. to read 4 lines:</p>\n\n<pre><code>int main()\n{\n    size_t n = 0;\n    char line[255];\n    FILE *fpointer = fopen(\"employees.txt\", \"r\");\n\n    /* control read loop with counter and fgets */\n    while (n &lt; 4 &amp;&amp; fgets(line, 255, fpointer)) {\n        line[strcspn (line, \"\\r\\n\")] = 0;   /* trim \\n from end of line */\n        puts (line);\n        n++;\n    }\n    fclose(fpointer);\n\n    return 0;\n}\n</code></pre>\n\n<p>That way you have incorporated the return of <code>fgets()</code> and your line-count into the loop conditional.</p>\n\n<p>(<strong>note:</strong> the use of <code>strcspn</code>, which returns the number of characters in the string NOT part of the exclude set <code>\"\\r\\n\"</code>, provides the length of the string excluding the line-ending allowing you to simply overwrite the first line-ending character with <code>'\\0'</code> or its numeric equivalent <code>0</code>. It essentially does the following:)</p>\n\n<pre><code>        size_t len = strlen (line);\n        if (len &amp;&amp; len - 1 == '\\n')\n            line[--len] = 0;        /* trim \\n from end of line */ \n</code></pre>\n\n<p>Let me know if you have further questions.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56352513, "answer_count": 2, "score": -1, "last_activity_date": 1559102744, "creation_date": 1559097750, "last_edit_date": 1559097961, "question_id": 56352382, "link": "https://stackoverflow.com/questions/56352382/fgets-issues-with-for-loop-in-c", "title": "fgets() issues with for loop in C", "body": "<p>Why am I getting the following output when fgets is outside for loop:</p>\n\n<blockquote>\n  <p>Jim, Engineer</p>\n  \n  <p>Jim, Engineer</p>\n  \n  <p>Jim, Engineer</p>\n  \n  <p>Jim, Engineer</p>\n</blockquote>\n\n<p>and the following output when fgets is inside for loop:</p>\n\n<blockquote>\n  <p>Jim, Engineer</p>\n  \n  <p>Pam, Nurse</p>\n  \n  <p>Scar, Troublemaker</p>\n  \n  <p>John, Smith</p>\n</blockquote>\n\n<pre><code>int main()\n{\n    int i;\n    char line[255];\n    FILE *fpointer = fopen(\"employees.txt\", \"r\");\n\n    for (i=0; i &lt; 4; i++){\n        fgets(line, 255, fpointer);\n        printf(\"%s\", line);\n    }\n    fclose(fpointer);\n\n    return 0\n}\n</code></pre>\n\n<p>within fget(), \"i\" is not passed as an argument so how is it still iterating over each line in the .txt file?</p>\n"}, {"tags": ["c", "libcurl"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 2, "creation_date": 1559097669, "post_id": 56352293, "comment_id": 99309427, "body": "Er, isn&#39;t that just header_out + data_out ?"}, {"owner": {"reputation": 1255, "user_id": 1861447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d61fb7b17b58891bf414b9d53e7bbb0d?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1861447/austin"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1559100584, "post_id": 56352293, "comment_id": 99309960, "body": "CURLINFO_HEADER_OUT, CURLINFO_DATA_OUT gives data only for normal case (no SSL/TLS). In case of SSL/TLS, it calls CURLINFO_SSL_DATA_OUT with binary data. Is it possible to get raw data incase of SSL/TLS?"}], "answers": [{"comments": [{"owner": {"reputation": 1255, "user_id": 1861447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d61fb7b17b58891bf414b9d53e7bbb0d?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1861447/austin"}, "edited": false, "score": 2, "creation_date": 1559209947, "post_id": 56375112, "comment_id": 99352738, "body": "Thanks for answer. I was looking to get the messages locally. I have resolved it now. It was easy. Header portion comes with CURLINFO_HEADER_IN, and for data, I used read callback where data is given to curl. With this I am able to get the complete message."}, {"owner": {"reputation": 2359, "user_id": 4614680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9b36fb2c1d356a919916f77e74f1c3c?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Ludwig", "link": "https://stackoverflow.com/users/4614680/philipp-ludwig"}, "edited": false, "score": 0, "creation_date": 1613504997, "post_id": 56375112, "comment_id": 117093860, "body": "This is not a good answer, as mitmproxy does not work with libcurl when it comes to HTTPS and the other two are not free."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 2359, "user_id": 4614680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9b36fb2c1d356a919916f77e74f1c3c?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Ludwig", "link": "https://stackoverflow.com/users/4614680/philipp-ludwig"}, "edited": false, "score": 0, "creation_date": 1614983199, "post_id": 56375112, "comment_id": 117561385, "body": "@PhilippLudwig  mitmproxy can of course also work with HTTPS traffic. I would even argue that this is the main purpose of the tool :-)  I have added a small demo to the answer.  It is based on an unmodified libcurl sample program from the libcurl website, showing the unencrypted request/response and details in mitmproxy."}, {"owner": {"reputation": 2359, "user_id": 4614680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9b36fb2c1d356a919916f77e74f1c3c?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Ludwig", "link": "https://stackoverflow.com/users/4614680/philipp-ludwig"}, "edited": false, "score": 1, "creation_date": 1615140098, "post_id": 56375112, "comment_id": 117593565, "body": "@StephanSchlecht Thank you for the Demo, I highly appreciate it!"}], "tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": false, "score": 2, "last_activity_date": 1614983179, "last_edit_date": 1614983179, "creation_date": 1559207419, "answer_id": 56375112, "question_id": 56352293, "link": "https://stackoverflow.com/questions/56352293/c-libcurl-is-it-possible-to-get-request-data-in-raw-format/56375112#56375112", "title": "C libcurl - Is it possible to get request data in raw format", "body": "<p>If you want to see what is actually transmitted, I would recommend using a man-in-the-middle HTTPS proxy.</p>\n<p>The proxy is placed between your client and the server.</p>\n<p>When a client normally communicates with a server via HTTPS, the client checks the server's certificate chain to see if it is signed by a root certificate trusted by the system.</p>\n<p>Thus any proxy between client and server could only forward the data without the possibility to have a look into the encrypted data stream.</p>\n<p>So how does it work, then?</p>\n<p>Man-in-the-middle proxies intercept traffic and create a server certificate on-the-fly. So it looks to the client as if it is communicating with the server and vice versa.</p>\n<p>However, if the client then evaluates the certificate chain, it encounters the root certificate of the proxy that it does not know and therefore does not trust, and terminates server communication immediately (if the client is configured correctly).</p>\n<p>So that the proxy can take a look at the HTTPS data, you must include the proxy root certificate in your list of trusted root certificates on your client system.</p>\n<p>The proxy can then show all data including the headers.</p>\n<p>Some typical representatives of such proxies are (incomplete list):</p>\n<ul>\n<li>mitmproxy (<a href=\"https://mitmproxy.org\" rel=\"nofollow noreferrer\">https://mitmproxy.org</a>)</li>\n<li>Charles (<a href=\"https://www.charlesproxy.com\" rel=\"nofollow noreferrer\">https://www.charlesproxy.com</a>)</li>\n<li>Fiddler (<a href=\"https://www.telerik.com/fiddler\" rel=\"nofollow noreferrer\">https://www.telerik.com/fiddler</a>)</li>\n</ul>\n<p>Different methods have different advantages and disadvantages. HTTPS proxies are especially useful when you want to analyze request and response including header quickly and efficiently.</p>\n<p><strong>Demo of mitmproxy with a libcurl program</strong></p>\n<p>For a quick demo one can use the example program from the libcurl site: <a href=\"https://curl.se/libcurl/c/simple.html\" rel=\"nofollow noreferrer\">https://curl.se/libcurl/c/simple.html</a>:</p>\n<pre><code>gcc -o simple simple.c -lcurl\nexport https_proxy=localhost:8080\n</code></pre>\n<p>In another terminal window one can start the mitmproxy. When the program is started, the request/response appears in mitmproxy and can be analyzed.</p>\n<p>It looks like this then:</p>\n<p><a href=\"https://i.stack.imgur.com/Smwd9.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Smwd9.gif\" alt=\"demo\" /></a></p>\n<p>As mentioned above, you need to configure the appropriate root certificate as described on mitmproxy's website for different operating systems.</p>\n"}, {"comments": [{"owner": {"reputation": 1255, "user_id": 1861447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d61fb7b17b58891bf414b9d53e7bbb0d?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1861447/austin"}, "edited": false, "score": 0, "creation_date": 1559604614, "post_id": 56434388, "comment_id": 99465573, "body": "Thanks for answer. Wanted it real time, and I did it as per my comment above."}], "tags": [], "owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559595034, "creation_date": 1559595034, "answer_id": 56434388, "question_id": 56352293, "link": "https://stackoverflow.com/questions/56352293/c-libcurl-is-it-possible-to-get-request-data-in-raw-format/56434388#56434388", "title": "C libcurl - Is it possible to get request data in raw format", "body": "<p>I would strongly recommend using the <a href=\"https://ec.haxx.se/tls-sslkeylogfile.html\" rel=\"nofollow noreferrer\">SSLKEYLOGFILE</a> approach which allows you to monitor and capture all curl traffic (TLS and non-TLS) using an external tool like Wireshark.</p>\n\n<p>No need to install any MITM software or extra certificates anywhere. Also works with applications linked to use libcurl, not only curl itself.</p>\n"}], "owner": {"reputation": 1255, "user_id": 1861447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d61fb7b17b58891bf414b9d53e7bbb0d?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1861447/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1614983179, "creation_date": 1559096876, "question_id": 56352293, "link": "https://stackoverflow.com/questions/56352293/c-libcurl-is-it-possible-to-get-request-data-in-raw-format", "title": "C libcurl - Is it possible to get request data in raw format", "body": "<p>In Libcurl C, using CURLOPT_DEBUGFUNCTION I can set a callback function. Libcurl calls callback and gives data for</p>\n\n<ol>\n<li>CURLINFO_HEADER_IN</li>\n<li>CURLINFO_HEADER_OUT</li>\n<li>CURLINFO_DATA_IN</li>\n<li>CURLINFO_DATA_OUT</li>\n<li>CURLINFO_SSL_DATA_IN</li>\n<li>CURLINFO_SSL_DATA_OUT</li>\n</ol>\n\n<p>The tx data that is given for CURLINFO_SSL_DATA_OUT is in binary format (encrypted). I need corresponding raw data (unencrypted).</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559096429, "post_id": 56352210, "comment_id": 99309191, "body": "I used <code>gcc -dM -E - &lt; &#47;dev&#47;null | grep -E &#39;unix&#39;</code>, which showed <code>__unix__</code>, <code>__unix</code>, and <code>unix</code> all defined with a value of 1. Then I used a good ol&#39; <code>#if defined(__unix__)</code> print statement just to make sure, which sure enough worked."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559097177, "post_id": 56352210, "comment_id": 99309347, "body": "You should reduce this to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>: Write just <code>#if defined __unix__</code> / <code>#include &lt;unistd.h&gt;</code> /  <code>#endif</code> / <code>int (*a)(const char *, const char *) = link;</code> / <code>int (*b)(const char *, const char *) = symlink;</code> and show the output of compiling that (the error messages it generates, or lack thereof), and then show the output of compiling it with <code>-E</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559099045, "post_id": 56352210, "comment_id": 99309685, "body": "I&#39;m a little surprised that compiling into an assembly file seems to work fine (why are you doing that by the way?), but compiling to an object file doesn&#39;t work. What happens if you include the same compiler flags for all builds? Does it change the preprocessed output? Does it lead to errors creating the assembly file?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559099364, "post_id": 56352210, "comment_id": 99309738, "body": "In light of <a href=\"https://stackoverflow.com/a/56352554/440558\">the answer from rici</a>, I would guess that the relevant flag is the <code>-std=c17</code> option, which causes GCC to not include the platform-specific defines needed for the functions to be declared. If you do <code>gcc -I include -E -std=c17 -o link.pp link&#47;link.c</code> (note the added flag) are the functions really declared in the generated <code>link.pp</code> file? The lesson here is to always use the same compiler options and flags to <i>all</i> build commands."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1559099478, "post_id": 56352210, "comment_id": 99309760, "body": "Woah, that worked. I wanted to see how far in the build process I could get, but I completely forgot to use the same flags. Trying to get assembler output with that <code>CFLAGS</code> variable failed too, and removing the <code>std</code> declaration like you mentioned made everything compile without a problem. I tried <code>c99</code> and <code>c11</code> with no other settings and they triggered the error, too."}], "answers": [{"comments": [{"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1559099745, "post_id": 56352554, "comment_id": 99309803, "body": "That&#39;s pretty embarrassing, I consulted the manpage but I didn&#39;t read far enough down. Thanks a lot, I haven&#39;t used feature test macros too much, but this is definitely a lesson I won&#39;t soon forget"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1559099984, "last_edit_date": 1559099984, "creation_date": 1559099233, "answer_id": 56352554, "question_id": 56352210, "link": "https://stackoverflow.com/questions/56352210/why-am-i-having-to-redeclare-an-extern-function/56352554#56352554", "title": "Why am I having to redeclare an extern function?", "body": "<p>In order for <code>symlink</code> to be declared, you need to <code>#define</code> the correct <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">feature-test macro</a>, as indicated in the <a href=\"http://man7.org/linux/man-pages/man2/symlink.2.html\" rel=\"nofollow noreferrer\"><code>symlink</code> manpage</a>:</p>\n\n<pre><code>Feature Test Macro Requirements for glibc (see feature_test_macros(7)):\n\n       symlink():\n           _XOPEN_SOURCE &gt;= 500 || _POSIX_C_SOURCE &gt;= 200112L\n               || /* Glibc versions &lt;= 2.19: */ _BSD_SOURCE\n</code></pre>\n\n<p>You should get in the habit of using feature-test macros, although the Gnu headers generally allow you to omit them if you use the default <code>-std</code> option, or any <code>-std</code> option starting with <code>gnu</code>. <code>gnu</code> \"standards\" define the <code>_GNU_SOURCE</code> feature-test macro, which effectively bypasses all feature tests. That might be considered convenient by some, but it leads to annoying portability issues.</p>\n\n<p>Although it is technically better to put the definition at the top of every source file, I find it more convenient to put <code>-D_XOPEN_SOURCE=700</code> in my <code>CFLAGS</code>, which also guarantees that the definition comes before any <code>#include</code>.</p>\n\n<p>Also, please be aware that if you want to accurately preprocess source code, you need to ensure that your CFLAGS are the same for the preprocessing command as for your compilation. Otherwise you might miss the fact that some symbols are not defined (or predefined) with stricter <code>-std</code> options.</p>\n"}], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56352554, "answer_count": 1, "score": 2, "last_activity_date": 1559099984, "creation_date": 1559096062, "last_edit_date": 1559098785, "question_id": 56352210, "link": "https://stackoverflow.com/questions/56352210/why-am-i-having-to-redeclare-an-extern-function", "title": "Why am I having to redeclare an extern function?", "body": "<p>I'm currently reading Advanced Programming in the Unix Environment by Richard Stevens, and I wrote a basic program to test out how to create filesystem links. After that worked without a problem, I decided to implement some options, starting with the ability to specify <code>-s</code> via the command line to create a symbolic link instead of a hard link. To do this, I typedef'd <code>link_fn</code>, which is set to <code>link</code> unless the user specifies <code>-s</code> in which case it is set to <code>symlink</code>.</p>\n\n<p>The problem is that I have to include <code>extern int symlink(const char* actualpath, const char* sympath);</code>, or I get the following error when I run the makefile:</p>\n\n<pre><code>link/link.c: In function \u2018main\u2019:\nlink/link.c:30:18: error: \u2018symlink\u2019 undeclared (first use in this function)\n   30 |             fn = symlink;\n      |                  ^~~~~~~\nlink/link.c:30:18: note: each undeclared identifier is reported only once for each function it appears in\nmake: *** [Makefile;31: link.o] Error 1\n</code></pre>\n\n<p>What's weird is I double-checked both the book and the man pages (<code>man 2 symlink</code>) and both of them say the <code>symlink</code> function is declared in the <code>unistd.h</code> header. My header section looks like this:</p>\n\n<pre><code>#if defined(__unix__)\n    #include &lt;unistd.h&gt;\n\n    #include &lt;dirent.h&gt;\n    #include &lt;fcntl.h&gt;\n\n    #include &lt;sys/mman.h&gt;\n    #include &lt;sys/random.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;sys/syscall.h&gt;\n    #include &lt;sys/sysctl.h&gt;\n    #include &lt;sys/sysinfo.h&gt;\n    #include &lt;sys/termios.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;sys/user.h&gt;\n#elif defined(_WIN32)\n    ...\n#endif // OS-Dependent modules\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n...\n</code></pre>\n\n<p>I first made sure <code>__unix__</code> was defined, and both the <code>symlink</code> and <code>link</code> functions work without a problem, but only as long as I declare <code>symlink</code> as external, like so:</p>\n\n<pre><code>extern int symlink(const char* actualpath, const char* sympath);\n</code></pre>\n\n<p>I then ran <code>gcc</code> with the <code>-E</code> option to see if <code>unistd.h</code> was actually being included and, sure enough, it was being included successfully and the <code>symlink</code> function was right there:</p>\n\n<pre><code>extern int symlink (const char *__from, const char *__to)\n     __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (1, 2))) ;\n</code></pre>\n\n<p>So why is it that I'm getting a compiler error when I don't declare the <code>symlink</code> function prototype myself? And why is it that the <code>link</code> function isn't giving me this problem when they're declared in the same header file, in the exact same way?</p>\n\n<p>Here is the <code>link</code> function, also from the preprocessor output I generated while debugging.</p>\n\n<pre><code>extern int link (const char *__from, const char *__to)\n     __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (1, 2))) ;\n</code></pre>\n\n<hr />\n\n<pre><code>#if defined(__unix__)\n    #include &lt;unistd.h&gt;\n\n    #include &lt;dirent.h&gt;\n    #include &lt;fcntl.h&gt;\n#elif defined(_WIN32)\n    // Removed for brevity\n#endif // OS-Dependent modules\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n#if !defined(FALSE) || !defined(TRUE)\nenum { FALSE, TRUE };\n#endif // TRUE || FALSE\n\n// Why does the compiler require this declaration, and only for symlink?\nextern int symlink(const char* actualpath, const char* sympath);\n\ntypedef int (*link_fn)(const char* path, const char* link_path);\n\nint main(int argc, char *argv[])\n{\n    if (argc == 2) {\n        if (strcmp(argv[1], \"--help\") == 0) {\n            printf(\"\\nUsage: %s &lt;Existing Filename&gt; &lt;New Filename&gt;\\n\\n\", argv[0]);\n            printf(\"Options: \\n\");\n            printf(\"  -s    Create symbolic link instead of a hard link\\n\\n\");\n\n            return EXIT_SUCCESS;\n        }\n    }\n\n    if (argc &lt; 3) {\n        fprintf(stderr, \"Usage: %s &lt;Existing Filename&gt; &lt;New Filename&gt;\\n\", argv[0]);\n\n        return EXIT_FAILURE;\n    }\n\n    link_fn fn = link;\n\n    for (size_t i = 1; i &lt; (size_t) argc - 2; ++i) {\n        if (strcmp(argv[i], \"-s\") == 0) {\n            fn = symlink;\n        }\n    }\n\n    const char* existing_path = argv[argc - 2];\n    const char* new_path      = argv[argc - 1];\n\n    errno = 0;\n\n    const int return_code = fn(existing_path, new_path);\n\n    if (return_code == -1) {\n        fprintf(stderr, \"[Error] %s\\n\", strerror(errno));\n\n        return EXIT_FAILURE;\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The program is being compiled using:</p>\n\n<pre><code>CC=gcc\nCFLAGS=\"-std=c17 -Wall -Wextra -Werror -pedantic\"\n</code></pre>\n\n<p>System Info</p>\n\n<pre><code>gcc version 9.1.0\nManjaro Linux 18.0.4\nx86-64\n</code></pre>\n\n<hr />\n\n<h1>MRE</h1>\n\n<p>Here is a minimal example, on the counsel of Eric Postpischil:</p>\n\n<pre><code>#if defined(__unix__)\n#include &lt;unistd.h&gt;\n#endif\n\nint (*a)(const char*, const char*) = link;\nint (*b)(const char*, const char*) = symlink;\n\nint main(void)\n{\n    //\n}\n</code></pre>\n\n<p>Running make yields the following output:</p>\n\n<pre><code>gcc -I include -E -o link.pp link/link.c\ngcc -I include -S -masm=intel -o link.asm link/link.c\ngcc -std=c17 -Wall -Wextra -Werror -pedantic  -I include -c -o link.o link/link.c\nlink/link.c:9:38: error: \u2018symlink\u2019 undeclared here (not in a function)\n    9 | int (*b)(const char*, const char*) = symlink;\n      |                                      ^~~~~~~\nmake: *** [Makefile;31: link.o] Error 1\n</code></pre>\n\n<p>The preprocessed output is as follows.</p>\n\n<pre><code> 1  # 1 \"link/link.c\"\n 2  # 1 \"&lt;built-in&gt;\"\n 3  # 1 \"&lt;command-line&gt;\"\n 4  # 31 \"&lt;command-line&gt;\"\n 5  # 1 \"/usr/include/stdc-predef.h\" 1 3 4\n 6  # 32 \"&lt;command-line&gt;\" 2\n 7  # 1 \"link/link.c\"\n ...\n12  # 1 \"/usr/include/unistd.h\" 1 3 4\n13  # 25 \"/usr/include/unistd.h\" 3 4\n14  # 1 \"/usr/include/features.h\" 1 3 4\n15  # 450 \"/usr/include/features.h\" 3 4\n16  # 1 \"/usr/include/sys/cdefs.h\" 1 3 4\n17  # 452 \"/usr/include/sys/cdefs.h\" 3 4\n18  # 1 \"/usr/include/bits/wordsize.h\" 1 3 4\n19  # 453 \"/usr/include/sys/cdefs.h\" 2 3 4\n20  # 1 \"/usr/include/bits/long-double.h\" 1 3 4\n21  # 454 \"/usr/include/sys/cdefs.h\" 2 3 4\n22  # 451 \"/usr/include/features.h\" 2 3 4\n23  # 474 \"/usr/include/features.h\" 3 4\n24  # 1 \"/usr/include/gnu/stubs.h\" 1 3 4\n25  # 10 \"/usr/include/gnu/stubs.h\" 3 4\n26  # 1 \"/usr/include/gnu/stubs-64.h\" 1 3 4\n27  # 11 \"/usr/include/gnu/stubs.h\" 2 3 4\n28  # 475 \"/usr/include/features.h\" 2 3 4\n29  # 26 \"/usr/include/unistd.h\" 2 3 4\n... \n32  # 202 \"/usr/include/unistd.h\" 3 4\n33  # 1 \"/usr/include/bits/posix_opt.h\" 1 3 4\n34  # 203 \"/usr/include/unistd.h\" 2 3 4\n...\n38  # 1 \"/usr/include/bits/environments.h\" 1 3 4\n39  # 22 \"/usr/include/bits/environments.h\" 3 4\n40  # 1 \"/usr/include/bits/wordsize.h\" 1 3 4\n41  # 23 \"/usr/include/bits/environments.h\" 2 3 4\n42  # 207 \"/usr/include/unistd.h\" 2 3 4\n43  # 217 \"/usr/include/unistd.h\" 3 4\n44  # 1 \"/usr/include/bits/types.h\" 1 3 4\n45  # 27 \"/usr/include/bits/types.h\" 3 4\n46  # 1 \"/usr/include/bits/wordsize.h\" 1 3 4\n47  # 28 \"/usr/include/bits/types.h\" 2 3 4\n48  # 1 \"/usr/include/bits/timesize.h\" 1 3 4\n49  # 29 \"/usr/include/bits/types.h\" 2 3 4\n...\n53  # 31 \"/usr/include/bits/types.h\" 3 4\n54  typedef unsigned char __u_char;\n</code></pre>\n\n<p>Other function declarations and enums are declared for about a thousand lines. Then, on line 1169:</p>\n\n<pre><code>  1169  extern int link (const char *__from, const char *__to)\n  1170       __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (1, 2))) ;\n  1171  \n  1172  \n  1173  \n  1174  \n  1175  extern int linkat (int __fromfd, const char *__from, int __tofd,\n  1176       const char *__to, int __flags)\n  1177       __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (2, 4))) ;\n  1178  \n  1179  \n  1180  \n  1181  \n  1182  extern int symlink (const char *__from, const char *__to)\n  1183       __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (1, 2))) ;\n</code></pre>\n\n<p>And skipping a few hundred lines of similar declarations:</p>\n\n<pre><code>  1416  \n  1417  # 6 \"link/link.c\" 2\n  1418  \n  1419  \n  1420  \n  1421  # 8 \"link/link.c\"\n  1422  int (*a)(const char*, const char*) = link;\n  1423  int (*b)(const char*, const char*) = symlink;\n  1424  \n  1425  int main(void)\n  1426  {\n  1427  \n  1428  }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559095264, "post_id": 56352106, "comment_id": 99308992, "body": "Do you want to write the 0 bytes to stdout, or skip them?"}, {"owner": {"reputation": 143, "user_id": 11532667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f14092028fbfa225dccb75743130a89?s=128&d=identicon&r=PG&f=1", "display_name": "garen96", "link": "https://stackoverflow.com/users/11532667/garen96"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559095334, "post_id": 56352106, "comment_id": 99308999, "body": "It&#39;s ok to just skip it."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559095368, "post_id": 56352106, "comment_id": 99309004, "body": "But is it also okay to not skip them? Because that\u2019s easier :)"}, {"owner": {"reputation": 143, "user_id": 11532667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f14092028fbfa225dccb75743130a89?s=128&d=identicon&r=PG&f=1", "display_name": "garen96", "link": "https://stackoverflow.com/users/11532667/garen96"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559095493, "post_id": 56352106, "comment_id": 99309024, "body": "Yeah, it does not matter, as long as it doesn&#39;t mess up the screen(stdout)."}, {"owner": {"reputation": 143, "user_id": 11532667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f14092028fbfa225dccb75743130a89?s=128&d=identicon&r=PG&f=1", "display_name": "garen96", "link": "https://stackoverflow.com/users/11532667/garen96"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1559095911, "post_id": 56352106, "comment_id": 99309117, "body": "let me try, one line without loop is ideal."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 11570190, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A_OKaH-8cRw/AAAAAAAAAAI/AAAAAAAAG9U/jJ-cpy5w3Ew/photo.jpg?sz=128", "display_name": "Paul Canniff", "link": "https://stackoverflow.com/users/11570190/paul-canniff"}, "is_accepted": false, "score": 3, "last_activity_date": 1559095723, "creation_date": 1559095723, "answer_id": 56352172, "question_id": 56352106, "link": "https://stackoverflow.com/questions/56352106/how-to-print-a-fixed-length-memory-area-which-contains-multiple-0/56352172#56352172", "title": "How to print a fixed length memory area which contains multiple \\0?", "body": "<p>Assuming you know the size of the block of memory (hard coded to 100 here):</p>\n\n<pre><code>for (int i = 0; i &lt; 100; i++)\n{\n    char c = p[i];\n    if (c != 0)\n        printf(\"%c\", c);\n}\n</code></pre>\n\n<p>Minor nit but in your sample above, the string will be \"asdfghi123\", because the memcpy for \"1234\" is only copying 3 bytes.  </p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1559108595, "post_id": 56352193, "comment_id": 99311761, "body": "Redirecting <code>stdout</code> to a file, will write 100 bytes to the file, including all the <code>&#39;\\0&#39;</code>s."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 1, "last_activity_date": 1559095915, "creation_date": 1559095915, "answer_id": 56352193, "question_id": 56352106, "link": "https://stackoverflow.com/questions/56352106/how-to-print-a-fixed-length-memory-area-which-contains-multiple-0/56352193#56352193", "title": "How to print a fixed length memory area which contains multiple \\0?", "body": "<p>Since the NUL bytes don\u2019t mess up the way the text appears (I think) and that\u2019s all you\u2019re looking for, you should be able to write all of the bytes directly to stdout:</p>\n\n<pre><code>fwrite(p, sizeof(char), 100, stdout);\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 11532667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f14092028fbfa225dccb75743130a89?s=128&d=identicon&r=PG&f=1", "display_name": "garen96", "link": "https://stackoverflow.com/users/11532667/garen96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 56352193, "answer_count": 2, "score": 0, "last_activity_date": 1559095915, "creation_date": 1559095135, "question_id": 56352106, "link": "https://stackoverflow.com/questions/56352106/how-to-print-a-fixed-length-memory-area-which-contains-multiple-0", "title": "How to print a fixed length memory area which contains multiple \\0?", "body": "<p>I have a memory area with fixed length.</p>\n\n<pre><code>char *p = malloc(100);\nmemset(p, 0 ,100);\n</code></pre>\n\n<p>I have some strings in this memory area, along with some \\0, for example</p>\n\n<pre><code>memcpy(p, \"asdf\", 4);\nmemcpy(p + 10, \"ghi\", 3);\nmemcpy(p + 20, \"1234\", 3);\n</code></pre>\n\n<p>So, there are \\0 between <code>asdf</code> and <code>ghi</code></p>\n\n<p>I want to print this memory are and the output is</p>\n\n<pre><code>asdfghi1234\n</code></pre>\n\n<p>How can I do that? Note that above code is just an example, where are these \\0 is not fixed.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7647, "user_id": 987358, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ace6dfd8c4f8c95d5a3fddc020af97f8?s=128&d=identicon&r=PG", "display_name": "Michael Butscher", "link": "https://stackoverflow.com/users/987358/michael-butscher"}, "edited": false, "score": 1, "creation_date": 1559094111, "post_id": 56351978, "comment_id": 99308803, "body": "If the command line arguments are longer than the provided arrays a buffer overflow will happen. And for the length don&#39;t forget the final 0-byte."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559095199, "post_id": 56351978, "comment_id": 99308978, "body": "<code>argc</code> is the number of valid elements in the <code>argv</code> array, <i>including</i> <code>argv[0]</code>. So if your program is expected to take three arguments, then <code>argc</code> must be at least <code>4</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559095258, "post_id": 56351978, "comment_id": 99308991, "body": "Also remember that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. That means a string of e.g. six characters needs space for <i>seven</i> to include the null-terminator."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559095338, "post_id": 56351978, "comment_id": 99309001, "body": "Lastly, besides the problem with <code>argc</code> (and possible array overflows), the code you show should not exhibit any problems. The possible problems you have is most likely in the code you <i>don&#39;t</i> show. Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that exhibits the problem to show us. Also please take some time to read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559105789, "post_id": 56351978, "comment_id": 99310985, "body": "You rarely need to copy command line arguments; just pass pointers to them."}, {"owner": {"reputation": 1, "user_id": 10355886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f4aac44947d4ad87178e1c6fcf90e?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Schaefer", "link": "https://stackoverflow.com/users/10355886/matheus-schaefer"}, "edited": false, "score": 0, "creation_date": 1559173008, "post_id": 56351978, "comment_id": 99342130, "body": "The initial <code>if</code> is to check if there are 3 or less elements, it&#39;ll leave.  I&#39;ll put some tests to make sure the argument is valid... I didn&#39;t remember the null-terminated thing with <code>char</code> arrays :("}, {"owner": {"reputation": 1, "user_id": 10355886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f4aac44947d4ad87178e1c6fcf90e?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Schaefer", "link": "https://stackoverflow.com/users/10355886/matheus-schaefer"}, "edited": false, "score": 0, "creation_date": 1559173265, "post_id": 56351978, "comment_id": 99342180, "body": "the code I didn&#39;t show was a <code>fp = fopen(input, &quot;r+&quot;);</code> I made for testing but since the <code>input</code> argument was incorrect it&#39;ll give me a segmentation fault"}, {"owner": {"reputation": 1, "user_id": 10355886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f4aac44947d4ad87178e1c6fcf90e?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Schaefer", "link": "https://stackoverflow.com/users/10355886/matheus-schaefer"}, "edited": false, "score": 0, "creation_date": 1559173673, "post_id": 56351978, "comment_id": 99342264, "body": "Well, the null-terminating thing is correct. I made all char arrays larger by 1 and they worked.  Also, I&#39;ll look into using pointers instead of copying where applicable. Thanks people!"}], "owner": {"reputation": 1, "user_id": 10355886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f4aac44947d4ad87178e1c6fcf90e?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Schaefer", "link": "https://stackoverflow.com/users/10355886/matheus-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559103561, "creation_date": 1559093791, "last_edit_date": 1559103561, "question_id": 56351978, "link": "https://stackoverflow.com/questions/56351978/how-to-fix-command-line-parameters-changing-when-after-reading-another-parameter", "title": "How to fix command line parameters changing when after reading another parameter?", "body": "<p>I'm trying to make a command-line program in <code>C89</code> that reads a file, applies changes on it and then save it. The file handling thing works fine (until now at least), but I'm struggling with reading the parameters. There are 3 parameters: </p>\n\n<ul>\n<li><p>input file,</p></li>\n<li><p>desired operation and</p></li>\n<li>output file.</li>\n</ul>\n\n<p>When it reads these parameters, they are copied into a char array to be handled later in the code. When debugging step by step (I'm currently using <code>QtCreator</code>), the first parameter is copied fine (example: \"<code>test.txt</code>\"), but when I read the second one (the operation) the first parameters turns into \"<code>\\000est.txt</code>\" (this is how it shows in debugger). Of course, if I use it as is I'll get a segmentation fault. I'm re-learning C so I'm still trying to get used to these things again.</p>\n\n<p>I tried to make a copy to another <code>char array (strcpy(newstring, input);)</code>, and prevented the problem, but doesn't seems to be a good workaround. I'd try to avoid workarounds here.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(int argc, char* argv[])\n{\n    if(argc &lt;= 3)\n    {\n        printf(\"\\nERROR: input needs to be at least &lt;input file&gt; &lt;operation&gt; &lt;output file&gt;. Exiting...\");\n        return -1;\n    }\n    char input[20];\n    char option[6];\n    char output[20];\n\n    strcpy(input, argv[1]);\n    strcpy(option, argv[2]);\n    strcpy(output, argv[3]);\n\n    //the file reading code is not here in main\n\n    return 0;\n}\n</code></pre>\n\n<p>I expected the input to be a filename (\"<code>test.txt</code>\") but I got a \"<code>\\000est.txt</code>\" when copying the second argument into another <code>char array</code>.</p>\n"}, {"tags": ["c", "stm32", "gpio"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1559126757, "post_id": 56351752, "comment_id": 99321069, "body": "At <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> you will find it states:  <i>&quot;Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it.&quot;</i>.  You have provided neither, which makes it look like a homework cheat rather then a legitimate request for assistance."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11569969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec262c19ee4398637a085c57ed4a73c?s=128&d=identicon&r=PG&f=1", "display_name": "jpg4321", "link": "https://stackoverflow.com/users/11569969/jpg4321"}, "edited": false, "score": 0, "creation_date": 1559105166, "post_id": 56352036, "comment_id": 99310851, "body": "Hey Thank-you so much for the answer , any chance you could show me an example with the code above ?"}], "tags": [], "owner": {"reputation": 539, "user_id": 11413329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1Efn.jpg?s=128&g=1", "display_name": "Richard at ImageCraft", "link": "https://stackoverflow.com/users/11413329/richard-at-imagecraft"}, "is_accepted": false, "score": 0, "last_activity_date": 1559122050, "last_edit_date": 1559122050, "creation_date": 1559094258, "answer_id": 56352036, "question_id": 56351752, "link": "https://stackoverflow.com/questions/56351752/using-the-odr-register-directly-on-stm32/56352036#56352036", "title": "Using the ODR register directly On STM32", "body": "<p>You need to understand C bitwise operations. The three are <code>^</code> (exclusive OR), <code>&amp;</code> (bitwise and), <code>|</code> (bitwise or)</p>\n\n<p>To clear a bit\n<code>GPIO-&gt;ODR &amp;= ~pin_mask;</code></p>\n\n<p>To set a bit\n<code>GPIO-&gt;ODR |= pin_mask;</code></p>\n\n<p>This should give you enough information.</p>\n"}], "owner": {"reputation": 13, "user_id": 11569969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec262c19ee4398637a085c57ed4a73c?s=128&d=identicon&r=PG&f=1", "display_name": "jpg4321", "link": "https://stackoverflow.com/users/11569969/jpg4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559126745, "creation_date": 1559091202, "last_edit_date": 1559126745, "question_id": 56351752, "link": "https://stackoverflow.com/questions/56351752/using-the-odr-register-directly-on-stm32", "title": "Using the ODR register directly On STM32", "body": "<p>Modify the code for WriteLED() to use the ODR register directly. The code should read the current\nvalue of the register and then write back a modified value depending on what LEDs are to be turns\non or off.</p>\n\n<p>Example Code Given to me</p>\n\n<pre><code>void HAL_GPIO_TogglePin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin)\n{\n/* Check the parameters */\nassert_param(IS_GPIO_PIN(GPIO_Pin));\nGPIOx-&gt;ODR \u02c6= GPIO_Pin;\n}\n</code></pre>\n\n<p>Code That Needs to be Altered</p>\n\n<pre><code>WriteLED (uint8_t LED, uint8_t State)\n{\n  // Check for correct state\n if ((State != LED_OFF) &amp;&amp; (State != LED_ON))\n  {\n    return;\n  }\n\n  // Turn on/off the LED\n  switch (LED)\n    {\n    case 'L':\n      HAL_GPIO_WritePin (LD4_GPIO_Port, LD4_Pin, State);\n      break;\n    case 'T':\n      HAL_GPIO_WritePin (LD3_GPIO_Port, LD3_Pin, State);\n      break;\n    case 'B':\n      HAL_GPIO_WritePin (LD6_GPIO_Port, LD6_Pin, State);\n      break;\n    case 'R':\n      HAL_GPIO_WritePin (LD5_GPIO_Port, LD5_Pin, State);\n      break;\n    }\n\n  return;\n}\n</code></pre>\n\n<p>What should the above code look like when outputting to ODR register</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559106761, "post_id": 56351738, "comment_id": 99311201, "body": "Please don&#39;t post pictures of text output; embed the text in the question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559106792, "post_id": 56351738, "comment_id": 99311210, "body": "Factorial 13 is too big to fit into a 32-bit integer (signed or unsigned); you get overflow.  (<code>n = 12, log2(n!) = 28.83545523407540696694, n! = 479001600</code> \u2014\u2014 <code>n = 13, log2(n!) = 32.53589495221649912738, n! = 6227020800</code>)  You also need fairly large numbers by the time you reach row 13; you need to worry about numbers with 3 digits (but the factorials are much bigger)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559107276, "post_id": 56351738, "comment_id": 99311353, "body": "When I change the computation type from <code>int</code> to <code>long</code> (on a 64-bit machine other than Windows 64-bit \u2014 <code>long long</code> would work on a 32-bit machine or Windows 64-bit, and on non-Windows 64-bit machines too), your code works OK up to 13, within limits. The primary concern might be that the numbers are right justified rather than centred in the field.  But you need to show what you expect (and get) for rows 6 and 12 (rows with 2-digit and 3-digit coefficients)."}], "answers": [{"tags": [], "owner": {"reputation": 596, "user_id": 1136142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1377d1d81c47a75c2ea993786fe68e53?s=128&d=identicon&r=PG", "display_name": "jacalvo", "link": "https://stackoverflow.com/users/1136142/jacalvo"}, "is_accepted": false, "score": 0, "last_activity_date": 1561422821, "creation_date": 1561422821, "answer_id": 56745419, "question_id": 56351738, "link": "https://stackoverflow.com/questions/56351738/i-have-some-spacing-error-in-my-pascals-triangle-using-c-programming/56745419#56745419", "title": "I have some spacing error in my pascals triangle using C programming", "body": "<p>You need to make a couple of changes to have the triangle aligned to the left as in the expected output. </p>\n\n<p>First, you are adding 3 extra spaces in the first loop with the <code>printf(\"   \")</code>, that is fixed using <code>&lt;</code> instead of <code>&lt;=</code> in the loop condition.</p>\n\n<p>Second, there are 4 extra chars added due to the <code>\"%5d \"</code> in the second <code>printf</code> call, you need to avoid that for the first iteration (when <code>r == 0</code>) using just <code>\"%d \"</code>.</p>\n\n<p>Here's how the <code>triangle()</code> function will look like after the changes:</p>\n\n<pre><code>void triangle(int numOfRows) {\n    for(int n = 0; n &lt; numOfRows; n++) {\n        for(int i = 1; i &lt; numOfRows-n; i++) {\n            printf(\"   \");\n        }\n        for(int r = 0; r &lt;= n; r++) {\n           printf(r == 0 ? \"%d \" : \"%5d \", choose(n, r));\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>And some example output (works up to 13 without a problem, at least on my 64-bit Linux with both gcc and clang):</p>\n\n<pre><code>Enter the number of rows: 3\n      1 \n   1     1 \n1     2     1 \nEnter the number of rows: 4\n         1 \n      1     1 \n   1     2     1 \n1     3     3     1 \n\nEnter the number of rows: 5\n            1 \n         1     1 \n      1     2     1 \n   1     3     3     1 \n1     4     6     4     1 \nEnter the number of rows: 13\n                                    1 \n                                 1     1 \n                              1     2     1 \n                           1     3     3     1 \n                        1     4     6     4     1 \n                     1     5    10    10     5     1 \n                  1     6    15    20    15     6     1 \n               1     7    21    35    35    21     7     1 \n            1     8    28    56    70    56    28     8     1 \n         1     9    36    84   126   126    84    36     9     1 \n      1    10    45   120   210   252   210   120    45    10     1 \n   1    11    55   165   330   462   462   330   165    55    11     1 \n1    12    66   220   495   792   924   792   495   220    66    12     1 \n\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11570180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce65a7f15ef7181c923e0f62c639d9b5?s=128&d=identicon&r=PG&f=1", "display_name": "MeowKittyCat", "link": "https://stackoverflow.com/users/11570180/meowkittycat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1561422821, "creation_date": 1559091098, "last_edit_date": 1559105248, "question_id": 56351738, "link": "https://stackoverflow.com/questions/56351738/i-have-some-spacing-error-in-my-pascals-triangle-using-c-programming", "title": "I have some spacing error in my pascals triangle using C programming", "body": "<p>The spacing is off in my code, can anyone help. I have attempted it (shown below)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint factorial(int n){\n    int fact = 1;\n\n    if(n == 0){\n        return 1;\n    } else {\n        for(int i = 1; i &lt;= n; i++){\n            fact = fact * i;\n        }\n        return fact;\n    }\n}\n\nint choose(int n, int r)\n{\n    int ans;\n\n    ans = (factorial(n))/((factorial(r))*(factorial(n-r)));\n    return ans;\n}\n\nvoid triangle(int numOfRows){\n    for(int n=0; n&lt;numOfRows; n++)\n    {\n        for(int i=1; i&lt;=numOfRows-n; i++){\n            printf(\"   \");    // Note the extra space\n        }\n        for(int r=0; r&lt;=n; r++)\n        {\n           printf(\"%5d \",choose(n,r)); // Changed to %3d\n        }    \n        printf(\"\\n\");\n    }\n}\n\nint main(){\n    int rows;\n    printf(\"Enter the number of rows: \");\n    scanf(\"%d\", &amp;rows);\n\n    while(rows &gt; 0 &amp;&amp; rows &lt;=13){\n\n        triangle(rows);\n\n        printf(\"Enter the number of rows: \");\n        scanf(\"%d\", &amp;rows);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The expected output should be: <br><a href=\"https://i.stack.imgur.com/9InVI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9InVI.png\" alt=\"enter image description here\"></a><br>\nThanks i'd appreciate it (this is also my first time using this site, so sorry for bad format stuff). </p>\n\n<p>The program needs to work up to 13 rows (which is shown in my while loop in my main functions).</p>\n"}, {"tags": ["c", "string", "printf", "cs50"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 3, "creation_date": 1559091457, "post_id": 56351708, "comment_id": 99308342, "body": "You&#39;re not 0-terminating a string."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1559092079, "post_id": 56351708, "comment_id": 99308441, "body": "Show us <code>get_string</code>."}, {"owner": {"reputation": 15720, "user_id": 19719, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3355303796cad8b9ea85993abc9030aa?s=128&d=identicon&r=PG&f=1", "display_name": "indiv", "link": "https://stackoverflow.com/users/19719/indiv"}, "edited": false, "score": 2, "creation_date": 1559092133, "post_id": 56351708, "comment_id": 99308449, "body": "<code>plaintextLength</code> is the length of the string, meaning the number of characters in the string not counting the null terminator.  That means <code>ciphertext[plaintextLength]</code> does not have room for the null terminator at the end that is required for C strings.  You need to add 1 extra location for the null terminator and set the contents of that location to 0."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1588768415, "post_id": 56351708, "comment_id": 109024698, "body": "Tje correct encipherment to <code>hello</code> is <code>ifmmp</code> and not <code>iffm</code>, as you state."}], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 13013249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba8a5fda64d7fdc68a1435b77e56d3?s=128&d=identicon&r=PG&f=1", "display_name": "Ajvar", "link": "https://stackoverflow.com/users/13013249/ajvar"}, "is_accepted": true, "score": 1, "last_activity_date": 1588514715, "creation_date": 1588514715, "answer_id": 61575759, "question_id": 56351708, "link": "https://stackoverflow.com/questions/56351708/why-does-the-output-of-the-code-changes-when-printing-a-random-text-with-printf/61575759#61575759", "title": "Why does the output of the code changes, when printing a random text with printf?", "body": "<pre><code>    int i;\n    // iterating through plaintext char by char\n    for(i = 0; i &lt; plaintextLength;i++)\n    {\n        // in case of capital letter\n        if(plaintext[i] &gt;= 65 &amp;&amp; plaintext[i] &lt;= 90)\n        {\n            ciphertext[i] = 65 + (((plaintext[i] - 65) + k) % 26);\n        } \n        // else in case of small letter\n        else if(plaintext[i] &gt;= 97 &amp;&amp; plaintext[i] &lt;= 122)\n        {\n            ciphertext[i] = 97 + (((plaintext[i] - 97) + k) % 26);\n        }\n        // else in case of non alphabetical letter\n        else\n        {\n            ciphertext[i] = plaintext[i];\n        }\n    }\n    ciphertext[i] = '\\0';\n    printf(\"ciphertext: %s\\n\", ciphertext);\n}\n</code></pre>\n\n<p><strong>In C every string uses \\0 to tell the computer that it has reached the end of a string.</strong></p>\n\n<p>Without this NULL terminating operator, the computer might try to read past the string into the memory, that is why you encounter random symbols.</p>\n\n<p>So when you are creating a string make sure to add \\0 at the end of it, this is what I did with your code here.\nI declared \"i\" outside the for loop the it doesn't cease to exist at the end of the loop.\nWhen you reach the end of the loop, \"i\" will be equal to the length of your string.</p>\n\n<p>If my plaintext is \"lol\" and the key is 5, \"i\" will be equal to 3 and the ciphertext will be \"qtq\".\nCiphertext[i] will point just after the last \"q\" since we count from 0 an this is where you want to put your \\0.</p>\n\n<p>Also there is a typo in your getstring.</p>\n\n<p>Hope my explaination is clear, if you have any question juste ask :)</p>\n"}], "owner": {"reputation": 315, "user_id": 11021795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8XwOZ.jpg?s=128&g=1", "display_name": "Hooni", "link": "https://stackoverflow.com/users/11021795/hooni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 61575759, "answer_count": 1, "score": 2, "last_activity_date": 1588514715, "creation_date": 1559090852, "last_edit_date": 1561593373, "question_id": 56351708, "link": "https://stackoverflow.com/questions/56351708/why-does-the-output-of-the-code-changes-when-printing-a-random-text-with-printf", "title": "Why does the output of the code changes, when printing a random text with printf?", "body": "<p>The following code changes the letters of the input by k. k is the first argument. For example, if the input should be changed by 2 letters the command line argument would be \"./caesar 2\", if three then \"./caesar 3\". etc.\nChanging letters means, for example, change by 2, then input 'a' becomes 'c'. Change by 3 means input \"abc\" becomes \"def\", etc.\nThe input provided by the user is being checked if (a) the number arguments is exact 2, (b) the argument is a number.</p>\n\n<p>The code executed as the code is written below the output is shortened by one letter. For example, \"hello\" changed by 1 letter becomes \"iffm\".\nIf one letter is entered only,  it shows the correct output follwed by some undefined letters. For example, 'a' becomes \"b\ufffd\ufffdP\" or \"bm>\ufffd\" or \"b;\ufffd\ufffd\ufffd\".</p>\n\n<p>When either (1) the input check (b) [if the argument is a number] is removed OR (2) a printf line with a random statement (it can even be an empty string) is inserted EXACTLY between the get_string function, when asking the user for input and the for-loop, when changing the letters the output is as intended. Or (3) if the input's last character is a special character, the output is as expected (special character is any non-alphabetical character). for example, \"hello1\" or \"hello!\" changed by one letter becomes \"ifmmp1\" or \"ifmmp!\".</p>\n\n<p>I am really desperate and I don't know what is happening and more importantly why this is happening.\nSo my questions are:\n(1) Why is output shortened by one letter? Why is the output wrong, when the input is one letter only? (I guess it's the same problem).\n(2)\n(a) Why does the output change when either the number check is removed or \n(b) a random printf line is inserted exactly between the lines mentioned above or\n(c) the last character is a non-alphabetical character?</p>\n\n<p>I really appreciate any help and please excuse any weird English as it is not my native language :). Thanks a lot! A desperate code learner :)</p>\n\n<p>This is the code:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nbool isNumber(string numberToCheck);\n\nint main(int argc, string argv[])\n{\n    // checking, if arguments are correct\n    // checking, if input is correct (i.e. 2)\n    if(argc != 2)\n    {\n        printf(\"Usage: ./cesar key\\n\");\n        exit(1);\n    }\n\n    // checking, if input is a number, if the following if statement is removed the output changes\n    if(!isNumber(argv[1]))\n    {\n        printf(\"Usage: ./caesar key\\n\");\n        exit(1);\n    }\n\n    // variables\n    int k = atoi(argv[1]);\n    string plaintext;\n    int plaintextLength;\n\n    // getting the plaintext from user input, creating ciphertext string of same length\n    plaintext = get_string(\"paintext: \");\n\n    // checking the length of the input\n    plaintextLength = strlen(plaintext);\n\n    //the output changes, when the next line is being inserted\n    printf(\"\");\n\n    // creating new empty string with plaintextLength\n    char ciphertext[plaintextLength];\n\n    // iterating through plaintext char by char\n    for(int i = 0; i &lt; plaintextLength;i++)\n    {\n        // in case of capital letter\n        if(plaintext[i] &gt;= 65 &amp;&amp; plaintext[i] &lt;= 90)\n        {\n            ciphertext[i] = 65 + (((plaintext[i] - 65) + k) % 26);\n        } \n        // else in case of small letter\n        else if(plaintext[i] &gt;= 97 &amp;&amp; plaintext[i] &lt;= 122)\n        {\n            ciphertext[i] = 97 + (((plaintext[i] - 97) + k) % 26);\n        }\n        // else in case of non alphabetical letter\n        else\n        {\n            ciphertext[i] = plaintext[i];\n        }\n    }\n    printf(\"ciphertext: %s\\n\", ciphertext);\n}\n\nbool isNumber(string numberToCheck)\n{\n    for(int i = 0;i &lt; strlen(numberToCheck); i++)\n        {\n            if(!isdigit(numberToCheck[i]))\n            {\n                return false;\n            }\n        }\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c", "gameboy"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559089448, "post_id": 56351554, "comment_id": 99308014, "body": "Are you sure it doesn&#39;t want <code>#include &lt;gb&#47;gb.h&gt;</code>?  Or does it really accept <code>\\ </code> under windows?"}, {"owner": {"reputation": 21, "user_id": 11570117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0b1c3dba7e12a047d89d27ef727ae7?s=128&d=identicon&r=PG&f=1", "display_name": "Chris64", "link": "https://stackoverflow.com/users/11570117/chris64"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559089696, "post_id": 56351554, "comment_id": 99308066, "body": "Tom! Thank you so much haha. I know this probably seemed like a super simple thing, but I&#39;ve been stuck on this for like 3 hours."}], "owner": {"reputation": 21, "user_id": 11570117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0b1c3dba7e12a047d89d27ef727ae7?s=128&d=identicon&r=PG&f=1", "display_name": "Chris64", "link": "https://stackoverflow.com/users/11570117/chris64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 640, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1559089006, "creation_date": 1559089006, "question_id": 56351554, "link": "https://stackoverflow.com/questions/56351554/i-keep-getting-a-parse-error-and-a-cant-find-error-in-visual-studio-code", "title": "I keep getting a &quot;parse error&quot; and a &quot;can&#39;t find&quot; error in Visual Studio Code", "body": "<p>I'm attempting to learn a bit of C to program games for the Game Boy from a tutorial, and I keep getting two errors: A \"parse error\" and a \"can't find\" error. Can anybody tell what's going on and how to fix it?</p>\n\n<p>I've only tried running what I have, as I am extremely new to C and don't know much.</p>\n\n<p>My main file:</p>\n\n<pre><code>#include &lt;gb\\gb.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main(){\n    printf(\"HELLO WORLD\");\n}\n</code></pre>\n\n<p>This .bat file I'm trying to use to get it to .gb:</p>\n\n<pre><code>c:\\gbdk\\bin\\lcc -Wa-l -Wl-m -Wl-j -DUSE_SFR_FOR_REG -c -o main.o main.c\nc:\\gbdk\\bin\\lcc -Wa-l -Wl-m -Wl-j -DUSE_SFR_FOR_REG -o main.gb main.o\n</code></pre>\n\n<p>This is the result of the above code:</p>\n\n<pre><code>PS C:\\Users\\cdbil\\Documents\\gameboycode\\helloworld&gt; .\\make.bat\n\nC:\\Users\\cdbil\\Documents\\gameboycode\\helloworld&gt;c:\\gbdk\\bin\\lcc -Wa-l -Wl-m -Wl-j -DUSE_SFR_FOR_REG -c -o main.o main.c\n\nmain.c(1) parse error: token -&gt; '' ; column 0\n\nC:\\Users\\cdbil\\Documents\\gameboycode\\helloworld&gt;c:\\gbdk\\bin\\lcc -Wa-l -Wl-m -Wl-j -DUSE_SFR_FOR_REG -o main.gb main.o\nc:\\gbdk\\bin\\lcc: can't find `main.o'\nPS C:\\Users\\cdbil\\Documents\\gameboycode\\helloworld&gt;\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1559088039, "post_id": 56351427, "comment_id": 99307777, "body": "It&#39;s similar to <code>a = a + b; b = a - b; a = a - b;</code>. Did you try to debug it to see the temporary values?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1559088087, "post_id": 56351427, "comment_id": 99307784, "body": "<a href=\"https://en.wikipedia.org/wiki/XOR_swap_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/XOR_swap_algorithm</a> and your version doesn&#39;t actually work. Try <code>swap_vars(my_int, my_int)</code>"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1559088288, "post_id": 56351427, "comment_id": 99307820, "body": "@ThomasSablik this is one case where debugging isn&#39;t that helpful."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1559088414, "post_id": 56351427, "comment_id": 99307841, "body": "@bolov If you check each step as binary, you will see what happens"}, {"owner": {"reputation": 11, "user_id": 11570090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-shSnAfElalY/AAAAAAAAAAI/AAAAAAAAABk/_jvNRny8GPI/photo.jpg?sz=128", "display_name": "Iyad", "link": "https://stackoverflow.com/users/11570090/iyad"}, "edited": false, "score": 0, "creation_date": 1559088416, "post_id": 56351427, "comment_id": 99307842, "body": "I think i found the answer <a href=\"https://stackoverflow.com/questions/249423/how-does-xor-variable-swapping-work\">here</a>. Thanks guys."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1559088892, "post_id": 56351427, "comment_id": 99307909, "body": "@Iyad yeah, but interpreting what you see... that&#39;s another thing, especially if you don&#39;t have math training or haven&#39;t dealt with bitwise operations."}], "owner": {"reputation": 11, "user_id": 11570090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-shSnAfElalY/AAAAAAAAAAI/AAAAAAAAABk/_jvNRny8GPI/photo.jpg?sz=128", "display_name": "Iyad", "link": "https://stackoverflow.com/users/11570090/iyad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1559088496, "answer_count": 0, "score": 0, "last_activity_date": 1559087832, "creation_date": 1559087832, "question_id": 56351427, "link": "https://stackoverflow.com/questions/56351427/i-found-code-that-can-swap-two-variable-without-a-third-one-and-i-dont-underst", "closed_reason": "Duplicate", "title": "I found code that can swap two variable without a third one, and i don&#39;t understand why it works?", "body": "<p>I was browsing Facebook when i found the following code that is supposed to swap two variables without a third one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid swap_vars (int* x, int* y) {\n    *x = *y ^ *x;\n    *y = *y ^ *x;\n    *x = *y ^ *x;\n}\n\nint main () {\n    int my_int = 1;\n    int my_int2 = 2;\n    swap_vars(&amp;my_int, &amp;my_int2);\n    printf(\"my_int = %d, my_int2 = %d. \\n\", my_int, my_int2);\n    return 0;\n}\n</code></pre>\n\n<p>And i was surprised when i discovered that it actually works, why?</p>\n"}, {"tags": ["c", "csv", "crud", "ansi"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1559091396, "post_id": 56351323, "comment_id": 99308332, "body": "You&#39;re tail while-loops make no sense. <code>my_getline</code> returns the line, dynamically allocated. You apparently don&#39;t care about that, and just leak that memory, then check the content of a pointer you long-ago already <code>free</code>d. Put another way, if this: <code>while((string_a=my_getline(file_a,line_length,i)) != ...</code> is in main loop condition (note retained return value), what on earth is this: <code>while((my_getline(file_b,line_length,j)!=NULL))</code> supposed to be doing? Right now it&#39;s a recipe for a memory leak that just happens to advance the file-get position as well."}], "owner": {"reputation": 45, "user_id": 11559122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bFDc_R-RlG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbFfGCu2wlaQfAeDhhdOsaIKzvyA/mo/photo.jpg?sz=128", "display_name": "Juan Hirschmann", "link": "https://stackoverflow.com/users/11559122/juan-hirschmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559086749, "creation_date": 1559086749, "question_id": 56351323, "link": "https://stackoverflow.com/questions/56351323/data-separation-issues-in-a-merge", "title": "Data separation issues in a merge", "body": "<p>I'm currently trying to perform a merge between two CSV text files(file_a and file_b) into a third file (file_c). All files are sorted by lowest id. However, I've observed that, when checking file_c's content, the last entry from file_a is repeated instead of showing file_b's final entry (which has the highest id). I've been trying to diagnose the problem to no avail. </p>\n\n<pre><code>status_t merge_sort(FILE * file_a,FILE * file_b,FILE*file_c,size_t line_length,registry_t * registry_a,registry_t * registry_b)\n{\n    char * string_a;\n    char * string_b;\n    size_t i;\n    size_t j;\n    char del = '|';\n    size_t fields_a;\n    size_t fields_b;\n    size_t length_a;\n    size_t length_b;\n    i=0;\n    j=0;\n    while((string_a=my_getline(file_a,line_length,i))!=NULL&amp;&amp;(string_b=my_getline(file_b,line_length,j))!=NULL)\n    {\n\n        registry_a=load_data(split(string_a,del,&amp;length_a,&amp;fields_a),registry_a);\n        registry_b=load_data(split(string_b,del,&amp;length_b,&amp;fields_b),registry_b);\n\n        if(registry_a==NULL||registry_b==NULL)\n            return ERROR_LOADING_DATA;\n\n        if(registry_a-&gt;id &gt; registry_b-&gt;id)\n        {\n\n            fprintf(file_c, \"%s\\n\",string_b);\n            free(string_b);\n            j++;\n\n        }\n\n        if (registry_a-&gt;id == registry_b-&gt;id)\n        {\n            free(string_a);\n            free(string_b);\n            return ERROR_INVALID_KEY;\n\n        }\n        if (registry_a-&gt;id &lt; registry_b-&gt;id)\n        {\n            fprintf(file_c, \"%s\\n\",string_a);\n            &gt;puts(string_b);\n</code></pre>\n\n<p><strong>Here puts(string_b) correct content is outputed</strong></p>\n\n<pre><code>            free(string_b);\n            i++;\n        }\n\n    }\n\n    free(string_a);\n    free(string_b);\n\n    while((my_getline(file_a,line_length,i)!=NULL))\n        {\n\n            fprintf(file_c, \"%s\\n\",string_a);\n            i++;\n            free(string_a);\n        }\n\n    while((my_getline(file_b,line_length,j)!=NULL))\n        {   \n        &gt;   puts(string_b);\n</code></pre>\n\n<p><strong>Here puts(string_b) outputs file_a's content</strong></p>\n\n<pre><code>            fprintf(file_c, \"%s\\n\",string_b);\n            j++;\n            free(string_b);\n        }\n\nreturn OK;\n}\n</code></pre>\n\n<p>Heres is my_getline function, which i believe could be causing this.</p>\n\n<pre><code>char * my_getline(FILE * fi,size_t line_length,size_t line_number)\n{\nsize_t i;\nchar * aux_string;\nchar * p;\nif (fi==NULL)\n    return NULL;\nif (fseek(fi, 0, SEEK_SET) != 0)\n    return NULL;\n\nif ((aux_string = malloc(line_length*sizeof(char)))==NULL)\n    return NULL;\n\ni=0;\nwhile(fgets(aux_string,line_length,fi)!=NULL)\n{\n\n    if (i==line_number)\n    {\n\n        if ((p=strchr(aux_string,'\\n'))!=NULL)\n        {\n            *p='\\0';\n        }\n\n        return aux_string;  \n    }\n    i++;\n\n}\nreturn NULL;\n</code></pre>\n\n<p>}</p>\n\n<p>Finally, I'm only allowed to use ANSI 89/99 functions. Thanks to all who read this long post!</p>\n"}, {"tags": ["c", "fork", "posix", "daemon"], "comments": [{"owner": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 1, "creation_date": 1559087109, "post_id": 56351273, "comment_id": 99307608, "body": "This is actually a really interesting question. <code>free</code>ing the memory would probably cause it to get copied (depending on how the allocator is implemented, but most of the ones I know store metadata right before the allocated memory which will get updated by <code>free</code>), which ironically will use up extra physical memory."}, {"owner": {"reputation": 1028, "user_id": 1486100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3cfc57e5e6bd9badcfef062973887444?s=128&d=identicon&r=PG", "display_name": "Tyzoid", "link": "https://stackoverflow.com/users/1486100/tyzoid"}, "reply_to_user": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 0, "creation_date": 1559087204, "post_id": 56351273, "comment_id": 99307625, "body": "@AndrewSun Yeah, I went back and forth on it too - my current thought is that it&#39;ll actually have minimal impact, because a kernel <i>could</i> avoid the copy if the parent frees (since most kernels only copy the page table to start), though I&#39;m not sure what the implications of that would be according to the applicable standards, and/or if the kernel actually does that."}, {"owner": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 1, "creation_date": 1559087368, "post_id": 56351273, "comment_id": 99307653, "body": "it would depend on how the libc memory allocator is implemented and how large the allocation is; a smart allocator might skip touching the metadata and directly return the memory to the kernel (skipping the copy) if it can release an entire page, a not-so-smart allocator might touch the metadata and then return the memory to the kernel (which would do a copy, then free it)"}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 1, "last_activity_date": 1559088285, "creation_date": 1559088285, "answer_id": 56351483, "question_id": 56351273, "link": "https://stackoverflow.com/questions/56351273/should-a-daemonising-parent-free-memory-after-forking-its-child/56351483#56351483", "title": "Should a daemonising parent free() memory after forking its child?", "body": "<p>I consider it good practice to limit the allocation of a <em>thing</em> to exactly the executable region that it is valid for.   To me, the free is part of the documentation -- this <em>thing</em> is no longer valid or accessible.   In all things programming, conciseness yields clarity; and clear programs can be improved and optimised; incoherent ones cannot.</p>\n\n<p>In terms of performance across a fork, if you are down to measuring the page-cache effect, you are probably in a very dark place.   Fundamentally, the process' pages will point to the same underlying page; if one relinquishes the page, the other gets it free-of-charge [ no point in copying if refcount == 1 ].  Realistically, all that happens is a few linked list nodes get updated, and you can't really measure it.</p>\n\n<p>That said, if you are carrying around an allocation for an entire DVD or something, yeah, you might consider mapping it <strong>shared</strong>.</p>\n"}], "owner": {"reputation": 1028, "user_id": 1486100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3cfc57e5e6bd9badcfef062973887444?s=128&d=identicon&r=PG", "display_name": "Tyzoid", "link": "https://stackoverflow.com/users/1486100/tyzoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56351483, "answer_count": 1, "score": 4, "last_activity_date": 1559088285, "creation_date": 1559086423, "last_edit_date": 1559088262, "question_id": 56351273, "link": "https://stackoverflow.com/questions/56351273/should-a-daemonising-parent-free-memory-after-forking-its-child", "title": "Should a daemonising parent free() memory after forking its child?", "body": "<p>Let's say we've got some code like this:</p>\n\n<pre><code>int main() {\n    FILE *f_conf = fopen(\"conf.conf\");\n    /* File Open Error Handling */\n\n    char *buf = malloc(128);\n    /* Malloc Error Handling */\n\n    fgets(buf, 128, f_conf);\n    fclose(f_conf);\n\n    pid_t pid = fork()\n    /* Fork Error Handling */\n\n    if (pid) {\n        free(buf); /* Should this free be called? */\n        return 0;\n    }\n\n    while (1) {\n        /* Do Stuff */\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>In general, I prefer to free memory prior to returning, since any impact to impact performance is minimal, and it helps with automated tooling to detect memory leaks. That said, the performance / best practices are less clear to me here, as it makes little sense to run these tools on a daemon. This leads me to two questions:</p>\n\n<ol>\n<li>Would freeing memory (such as <code>*buf</code>) of a parent process prior to return affect performance of the child? I'm thinking there could be some (either positive or negative) by the way copy-on-write is implemented.</li>\n<li>Is it considered good practice for the parent to <code>free</code> leftover resources?</li>\n</ol>\n"}, {"tags": ["c", "embedded", "stm32", "gpio"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1559126683, "post_id": 56351072, "comment_id": 99321033, "body": "At <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> you will find it states:  <i>&quot;Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it.&quot;</i>.  You have provided neither, which makes it look like a homework cheat rather then a legitimate request for assistance."}], "answers": [{"tags": [], "owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "is_accepted": false, "score": 1, "last_activity_date": 1559113299, "last_edit_date": 1559113299, "creation_date": 1559112447, "answer_id": 56354563, "question_id": 56351072, "link": "https://stackoverflow.com/questions/56351072/how-do-i-alter-my-current-code-to-read-directly-from-the-idr-register/56354563#56354563", "title": "How do i alter my Current code to read directly from the IDR register", "body": "<p>Before I post my solution I need to advice against reading from registers directly. Whoever is giving you this task wants to be a smart-ass and thinks that calling the HAL_GPIO_ReadPin function results in some kind of unbearable overhead which is most definitely not true. In fact, if all the port defines from JOY_A_GPIO_Port to JOY_CTR_GPIO_Port are different and optimizations are turned on, then the compiler is very likely to produce optimal code. Furthermore replacing the function call with direct register reads reduces the reuse-ability of the application code.</p>\n\n<p>Anyhow, lets apply some changes...</p>\n\n<p>Lets start off with a 1:1 translation which uses direct register access:</p>\n\n<pre><code>uint8_t ReadJoystick() \n{\n  uint8_t JoystickPosition = 0u;\n\n  // Get current joystick value\n  if ((JOY_A_GPIO_Port-&gt;IDR &amp; JOY_A_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'L';\n  else if ((JOY_B_GPIO_Port-&gt;IDR &amp; JOY_B_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'U';\n  else if ((JOY_C_GPIO_Port-&gt;IDR &amp; JOY_C_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'D';\n  else if ((JOY_D_GPIO_Port-&gt;IDR &amp; JOY_D_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'R';\n  else if ((JOY_CTR_GPIO_Port-&gt;IDR &amp; JOY_CTR_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'C';\n\n  return JoystickPosition;\n}\n</code></pre>\n\n<p>In case you haven't fully understood the code yet:</p>\n\n<ul>\n<li>xxx_Port->IDR reads the input data register for the whole port</li>\n<li>A bitwise &amp; masks the input and gives us only the specific pin we are\nlooking for</li>\n</ul>\n\n<p>As I mentioned before this is not going to bring any performance improvements whatsoever.</p>\n\n<p>However we might improve the code a little if some of the port defines are equal and point to the same memory address. In practice this is common because embedded designers are usually keen to join IO pins of an external device on a single port. E.g. lets assume JOY_A_GPIO_Port == JOY_B_GPIO_Port, then we could read the input data register of this port just once into a local variable like this:</p>\n\n<pre><code>uint8_t ReadJoystick() \n{\n  uint8_t JoystickPosition = 0;\n\n  // Read input data register for AB once\n  uint32_t ab_port = JOY_AB_GPIO_Port-&gt;IDR;\n\n  // Get current joystick value\n  if ((ab_port &amp; JOY_A_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'L';\n  else if ((ab_port &amp; JOY_B_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'U';\n  else if ((JOY_C_GPIO_Port-&gt;IDR &amp; JOY_C_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'D';\n  else if ((JOY_D_GPIO_Port-&gt;IDR &amp; JOY_D_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'R';\n  else if ((JOY_CTR_GPIO_Port-&gt;IDR &amp; JOY_CTR_Pin) == GPIO_PIN_RESET)\n    JoystickPosition = 'C';\n\n  return JoystickPosition;\n}\n</code></pre>\n\n<p>This effectively just saved us one register read. Of course the more joystick pins there are on a single port the better.</p>\n\n<p>/edit\nST provides an alternative function for reading a whole port in their \"LL\" library:</p>\n\n<pre><code>__STATIC_INLINE uint32_t LL_GPIO_ReadInputPort(GPIO_TypeDef *GPIOx)\n{\n  return (uint32_t)(READ_REG(GPIOx-&gt;IDR));\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11569969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec262c19ee4398637a085c57ed4a73c?s=128&d=identicon&r=PG&f=1", "display_name": "jpg4321", "link": "https://stackoverflow.com/users/11569969/jpg4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "closed_date": 1559129036, "answer_count": 1, "score": -3, "last_activity_date": 1559113299, "creation_date": 1559084506, "question_id": 56351072, "link": "https://stackoverflow.com/questions/56351072/how-do-i-alter-my-current-code-to-read-directly-from-the-idr-register", "closed_reason": "Needs more focus", "title": "How do i alter my Current code to read directly from the IDR register", "body": "<p>Modify the code for <strong>ReadJoystick()</strong> to read the <strong>IDR register</strong> directly for the ports associated\nwith the joystick inputs. The aim is to minimise the number of reads to the register. The code in\nthe template makes an individual call for each of the inputs pins, even though some of the pins are\non the same ports.\nYou can refer to the HAL code for inspiration. Use the defined values in the HAL for addressing\nregisters rather than creating new ones.</p>\n\n<p>Example Code Given to Me</p>\n\n<pre><code>GPIO_PinState HAL_GPIO_ReadPin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin)\n{\n    GPIO_PinState bitstatus;\n     /* Check the parameters */\n    assert_param(IS_GPIO_PIN(GPIO_Pin));\nif ((GPIOx-&gt;IDR &amp; GPIO_Pin) != (uint32_t)GPIO_PIN_RESET)\n{\n    bitstatus = GPIO_PIN_SET;\n}\nelse\n{\n    bitstatus = GPIO_PIN_RESET;\n}\nreturn bitstatus;\n</code></pre>\n\n<p>}</p>\n\n<hr>\n\n<p><strong>Code I require to Alter</strong></p>\n\n<p>// REPLACE THE FOLLOW CODE WITH YOUR SOLUTION </p>\n\n<pre><code>uint8_t\nReadJoystick ()\n{\n  uint8_t JoystickPosition = 0;\n\n  // Get current joystick value\n  if (HAL_GPIO_ReadPin (JOY_A_GPIO_Port, JOY_A_Pin) == GPIO_PIN_RESET)\n  {\n    JoystickPosition = 'L';\n  }\n  else if (HAL_GPIO_ReadPin (JOY_B_GPIO_Port, JOY_B_Pin) == \nGPIO_PIN_RESET)\n  {\nJoystickPosition = 'U';\n  }\n  else if (HAL_GPIO_ReadPin (JOY_C_GPIO_Port, JOY_C_Pin) == \n GPIO_PIN_RESET)\n   {\n     JoystickPosition = 'D';\n   }\n   else if (HAL_GPIO_ReadPin (JOY_D_GPIO_Port, JOY_D_Pin) == \n GPIO_PIN_RESET)\n    {\n      JoystickPosition = 'R';\n    }\n   else if (HAL_GPIO_ReadPin (JOY_CTR_GPIO_Port, JOY_CTR_Pin) == \nGPIO_PIN_RESET)\n  {\n    JoystickPosition = 'C';\n  }\n\n  return JoystickPosition;\n }\n</code></pre>\n\n<p>So I Understand that my current code is reading each pin although i've been asked to alter this to read directly from the IDR register. I'm really new to embedded systems programming and just looking for someone to guide me with altering this code</p>\n"}, {"tags": ["c", "arrays", "string"], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 7, "last_activity_date": 1559084719, "creation_date": 1559084719, "answer_id": 56351099, "question_id": 56350998, "link": "https://stackoverflow.com/questions/56350998/cant-understand-sizeof-2aa/56351099#56351099", "title": "Can&#39;t understand &amp;(sizeof 2[a])[a]", "body": "<p>This code is meant to confuse you, not do anything useful. Don't write code like this. Here is how it is interpreted by the compiler:</p>\n\n<ul>\n<li><code>2[a]</code> is the same as <code>a[2]</code>, which is a value of <code>char</code> type (which value exactly doesn't matter; the compiler even doesn't try to evaluate it)</li>\n<li><code>sizeof 2[a]</code> is the same as <code>sizeof(char)</code>, which is equal to 1</li>\n<li><code>&amp;(sizeof 2[a])[a]</code> is a pointer to the character <code>b</code> in the string <code>Abcdef</code> - the one which has the index 1</li>\n<li><code>printf(\"%s\",&amp;(sizeof 2[a])[a])</code> prints the string, starting at that pointer</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 5, "last_activity_date": 1559085839, "last_edit_date": 1559085839, "creation_date": 1559084990, "answer_id": 56351133, "question_id": 56350998, "link": "https://stackoverflow.com/questions/56350998/cant-understand-sizeof-2aa/56351133#56351133", "title": "Can&#39;t understand &amp;(sizeof 2[a])[a]", "body": "<p>Referring to the code excerpt:</p>\n\n<pre><code>printf(\"%s\",&amp;(sizeof 2[a])[a]);\n</code></pre>\n\n<p>First, most people don't realize it, but the <code>[]</code> operator it actually commutative.  <code>a[b]</code> is equivalent to <code>*(a + b)</code>, which is equivalent to <code>*(b + a)</code>, which is equivalent to <code>b[a]</code>.</p>\n\n<p>So <code>2[a]</code> is equivalent to <code>a[2]</code>.  Since <code>a</code> has type <code>const char []</code>, the size of an element is the same as <code>sizeof(char)</code>, which is 1.</p>\n\n<p>So we now have:</p>\n\n<pre><code>printf(\"%s\",&amp;1[a]);\n</code></pre>\n\n<p>Well, <code>1[a]</code> is equivalent to <code>a[1]</code>, or <code>*(a + 1)</code>.  Applying the address-of operator gives <code>&amp;a[1]</code>, or <code>a + 1</code> (note that <code>&amp;*x</code> is just <code>x</code>).</p>\n\n<p>So we have:</p>\n\n<pre><code>printf(\"%s\", a + 1);\n</code></pre>\n\n<p>This just prints the string pointed to by <code>a + 1</code>, i.e. everything after the first character of <code>a</code>.</p>\n\n<p>If you just reorder the <code>[]</code> operators without doing anything else, you can see that it's equivalent to:</p>\n\n<pre><code>printf(\"%s\", &amp;a[sizeof a[2]]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1559086091, "post_id": 56351166, "comment_id": 99307432, "body": "In C, <code>sizeof(&#39;c&#39;)</code> is only 1 on systems where <code>sizeof(int)</code> is 1."}, {"owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "edited": false, "score": 0, "creation_date": 1559087055, "post_id": 56351166, "comment_id": 99307602, "body": "Good to know, I updated the answer to be &quot;sizeof(char) = 1&quot; which I am hoping is the correct edit"}], "tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 3, "last_activity_date": 1559086995, "last_edit_date": 1559086995, "creation_date": 1559085266, "answer_id": 56351166, "question_id": 56350998, "link": "https://stackoverflow.com/questions/56350998/cant-understand-sizeof-2aa/56351166#56351166", "title": "Can&#39;t understand &amp;(sizeof 2[a])[a]", "body": "<p>If you break down each segment:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>&amp;(sizeof 2[a])[a]\n\n2[a] = a[2].  a[2] = a char element at position 2\n\nsizeof(char) = 1\n\n(1)[a] = a[1]\n\n&amp;(a[1]) = a reference to the 'b' in \"bcdefg\"\n</code></pre>\n\n<p>printf() then prints the char array starting with b and ending at the null terminator</p>\n"}], "owner": {"reputation": 21, "user_id": 11569963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494795159affd2916ccde8374249eda4?s=128&d=identicon&r=PG&f=1", "display_name": "Ediz G&#246;rkem Ak\u0131nc\u0131", "link": "https://stackoverflow.com/users/11569963/ediz-g%c3%b6rkem-ak%c4%b1nc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 56351099, "answer_count": 3, "score": -1, "last_activity_date": 1559086995, "creation_date": 1559083850, "last_edit_date": 1559084811, "question_id": 56350998, "link": "https://stackoverflow.com/questions/56350998/cant-understand-sizeof-2aa", "title": "Can&#39;t understand &amp;(sizeof 2[a])[a]", "body": "<p>I've got some code that outputs <code>bcdefg</code> and I can't understand why.</p>\n\n<p>I google searched but I couldn't find anything.</p>\n\n<pre><code>const char a[]=\"Abcdefg\";\nprintf(\"%s\",&amp;(sizeof 2[a])[a]);\n</code></pre>\n\n<p>Why is the output <code>bcdefg</code>, and not <code>Abcdefg</code>?</p>\n"}, {"tags": ["c", "cs50", "vigenere", "isalpha"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1559082872, "post_id": 56350858, "comment_id": 99306659, "body": "That&#39;s because you <code>return</code> from inside the loop, after the first test. Pass or fail, that&#39;s all it does."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1559084050, "post_id": 56350858, "comment_id": 99306980, "body": "<code>strlen()</code> has to iterate the string to find the end, but you then iterate the string in any case, it is simpler and more efficient to use the string terminator directly to terminate your loop:  <code>for( int i = 0; keyword[i] != 0; i++ )</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1559131141, "post_id": 56350858, "comment_id": 99323506, "body": "You might be interested in <a href=\"https://cs50.stackexchange.com\">cs50 stack exchange site</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11125802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XORCK.jpg?s=128&g=1", "display_name": "alexas", "link": "https://stackoverflow.com/users/11125802/alexas"}, "edited": false, "score": 0, "creation_date": 1559098472, "post_id": 56350895, "comment_id": 99309584, "body": "Thank you. I had switch the print commands because I thought <code>!isalpha</code> wasn&#39;t executing properly for some reason, and figured I&#39;d give it a try. What I am having real trouble with is iterating over the string to check that each character is alphabetic. I thought that was what <code>if(isalpha(keyword[i])</code> was doing, but it is not working. It is still saying <code>Success!</code> if it starts with an alphabetic character and continues on with a numeric character."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 11, "user_id": 11125802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XORCK.jpg?s=128&g=1", "display_name": "alexas", "link": "https://stackoverflow.com/users/11125802/alexas"}, "edited": false, "score": 0, "creation_date": 1559126665, "post_id": 56350895, "comment_id": 99321022, "body": "@alexa: Are you saying the code above is <i>still</i> misbehaving? If so, my only guess would be the use of a <code>string</code>, which isn&#39;t a thing in <code>C</code>. Declare <code>keyword</code> to be a <code>const char *</code> to keep it C."}, {"owner": {"reputation": 11, "user_id": 11125802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XORCK.jpg?s=128&g=1", "display_name": "alexas", "link": "https://stackoverflow.com/users/11125802/alexas"}, "edited": false, "score": 0, "creation_date": 1559135531, "post_id": 56350895, "comment_id": 99326209, "body": "Thank you! Yes, that was my issue. Oops. I understand now. It is working perfectly. :)"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 2, "last_activity_date": 1559082919, "creation_date": 1559082919, "answer_id": 56350895, "question_id": 56350858, "link": "https://stackoverflow.com/questions/56350858/how-to-get-isalpha-to-iterate-through-each-character-of-string/56350895#56350895", "title": "How to get &#39;isalpha&#39; to iterate through each character of string?", "body": "<p>Don't short circuit (by <code>return</code>ing) unless the value is non-alphabetic; save printing <code>Success</code> and returning <code>0</code> for when the whole loop completes <em>without</em> exiting due to non-alphabetic characters:</p>\n\n<pre><code>for(int i = 0, n = strlen(keyword); i &lt; n; i++)\n{\n    if(!isalpha(keyword[i]))\n    {\n        printf(\"Invalid key, must be fully alphabetic. \\n\");\n        return 1;\n    }\n}\nprintf(\"Success! \\n\");\nreturn 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1559130250, "post_id": 56359680, "comment_id": 99322994, "body": "<i><code>isalpha(int x)</code> is defined for <code>x</code> in the <code>unsigned char</code> range and EOF. Other negative <code>char</code> values are undefined behavior.</i>  And <b>another</b> reason to never, ever use CS50&#39;s misguided <code>typedef char *string;</code> bodge."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559130678, "post_id": 56359680, "comment_id": 99323233, "body": "@AndrewHenle Yes the CS50  <code>string keyword</code> seems to perpetuate incorrect <i>string</i> understanding as <code>keyword</code> is not a C string, but a pointer to  (hopefully) a string - with IDB sign-ness characters.  More of the usual problems of type-defining a pointer."}, {"owner": {"reputation": 11, "user_id": 11125802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XORCK.jpg?s=128&g=1", "display_name": "alexas", "link": "https://stackoverflow.com/users/11125802/alexas"}, "edited": false, "score": 0, "creation_date": 1559135275, "post_id": 56359680, "comment_id": 99326059, "body": "@chux Oh ok, thank you for explaining in detail! That makes much more sense. Works perfectly now. I appreciate the help and clarification."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1559130692, "last_edit_date": 1559130692, "creation_date": 1559129738, "answer_id": 56359680, "question_id": 56350858, "link": "https://stackoverflow.com/questions/56350858/how-to-get-isalpha-to-iterate-through-each-character-of-string/56359680#56359680", "title": "How to get &#39;isalpha&#39; to iterate through each character of string?", "body": "<p>Two problems</p>\n\n<p><strong>Do not always exit the loop</strong></p>\n\n<p><a href=\"https://stackoverflow.com/a/56350895/2410359\">@ShadowRanger</a></p>\n\n<p><strong>Use unsigned character values</strong></p>\n\n<p><code>isalpha(int x)</code> is defined for <code>x</code> in the <code>unsigned char</code> range and EOF.  Other negative <code>char</code> values re undefined behavior.</p>\n\n<pre><code>// if(!isalpha(keyword[i]))\nif(!isalpha((unsigned char) keyword[i]))\n</code></pre>\n\n<hr>\n\n<p>With simplified loop - <code>strlen()</code> not needed.</p>\n\n<pre><code>int alexa_alpha_test(const char *keyword) {\n  while (*keyword) {\n    if(!isalpha((unsigned char) *keyword)) {\n      printf(\"Invalid key, must be fully alphabetic. \\n\");\n      return 1;\n    }\n    keyword++; \n  }\n  printf(\"Success! \\n\");\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11125802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XORCK.jpg?s=128&g=1", "display_name": "alexas", "link": "https://stackoverflow.com/users/11125802/alexas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559130692, "creation_date": 1559082750, "question_id": 56350858, "link": "https://stackoverflow.com/questions/56350858/how-to-get-isalpha-to-iterate-through-each-character-of-string", "title": "How to get &#39;isalpha&#39; to iterate through each character of string?", "body": "<p>I am having trouble figuring out how to check each character in the keyword (argv[1]). I know I am probably missing something super obvious. :(</p>\n\n<p>I have tried saving the string to an array, declaring a new int, but still same problem.</p>\n\n<pre><code>//check to make sure 2nd argument is fully alphabetic\nstring keyword = argv[1];\n\nfor(int i = 0, n = strlen(keyword); i &lt; n; i++)\n{\n    if(isalpha(keyword[i]))\n    {\n        printf(\"Success! \\n\");\n        return 0;\n    }\n    else\n    {\n        printf(\"Invalid key, must be fully alphabetic. \\n\");\n        return 1;\n    }\n}\n</code></pre>\n\n<p>Expected output should be \"Invalid key, must be fully alphabetic.\" for anything not fully alphabetic. Instead, it only works for the beginning character, not the whole keyword.</p>\n"}, {"tags": ["c", "linux", "ipv6", "mdns"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1559128165, "post_id": 56388639, "comment_id": 99376738, "body": "Sorry about trying to remove the Linux tag in an edit. Any smart person (when reading this fully) would&#39;ve seen that it&#39;s most definitely about Linux. I&#39;ve also proposed to add the [mdns] tag. Please review."}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1559128775, "post_id": 56388639, "comment_id": 99376739, "body": "@JL2210 That&#39;s fine. It happens."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1559149264, "post_id": 56388639, "comment_id": 99376740, "body": "This the same result I found when I tried it years ago, and I don&#39;t think it has really been developed since then :-). I have a vague feeling <code>systemd-resolved</code> +  <code>nss-resolve</code> could do it.  Note that it does not enable MDNS by default (why?), but it does enable LLMNR.  I&#39;m pretty confident <i>MDNS</i> can do it, but it depends on the implementation."}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1559149716, "post_id": 56388639, "comment_id": 99376741, "body": "@sourcejedi If you&#39;ve got some steps to set that up and experiment I&#39;d be interested to see them.  I feel like  LLMNR stands a bit more of a chance.  One reason I&#39;m dubious about mDNS is that I can&#39;t see anything stating that it only resolves names for that link.  Since the DNS structure doesn&#39;t have space for link information, allowing names from outside the link to be resolved would prohibit the client from adding link information itself."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1559150881, "post_id": 56388639, "comment_id": 99376742, "body": "@PhilipCouling heh. LLMNR equally adapts the DNS packet format. But both of them are link-local multicast protocols.  It&#39;s very easy to know which link to use if you receive an LL address, it&#39;s the link you received the response packet on :-).  And any implementation of a relay could reasonably drop LL address responses.  You could try installing <code>libnss-resolve</code> on Ubuntu; the package install automatically edits nsswitch.conf.  E.g. on a pair of VMs in virt-manager, which provides a virtual network but currently does not set up IPv6 by default, so you will only have link-local IPv6..."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1559150931, "post_id": 56388639, "comment_id": 99376743, "body": "That&#39;s just a suggestion though, I don&#39;t know the results either way."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1559150999, "post_id": 56388639, "comment_id": 99376744, "body": "For LLMNR, you don&#39;t use <code>my-hostname-here.local</code>, you just use <code>my-hostname-here</code>."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563151833, "post_id": 56388639, "comment_id": 100593279, "body": "&quot;_ One reason I&#39;m dubious about mDNS is that I can&#39;t see anything stating that it only resolves names for that link._&quot; Actually, mDNS uses the <code>224.0.0.251</code> multicast group, which is a Link-Local multicast group that cannot be sent to a different network, so, by definition, it on works on the link where it is used."}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563178069, "post_id": 56388639, "comment_id": 100599557, "body": "@RonMaupin You&#39;ve fudged two concepts togeather. The protocol can only <i>communicate</i> on that link, yes.  But does that automatically mean that it will only <i>resolve names to IPs on that same link</i>.  If it does not only resolve names for IPs on that link, then how can an mDNS client infer which link a resolved name is for.  The answer would be it can&#39;t."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563179621, "post_id": 56388639, "comment_id": 100600257, "body": "&quot;<i>But does that automatically mean that it will only resolve names to IPs on that same link</i>&quot; That is exactly what the RFC prescribes. There are checks for that. Also, it needs to maintain which on interface it was received: &quot;<i>a host that wants to fully support this case needs network programming APIs that allow applications to specify on what interface to perform a link-local Multicast DNS query, and to discover on what interface a Multicast DNS response was received.</i>&quot;"}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563179810, "post_id": 56388639, "comment_id": 100600344, "body": "Based on what you wrote, I assumed you had looked at the authoritative source: <i><a href=\"https://tools.ietf.org/html/rfc6762\" rel=\"nofollow noreferrer\">RFC 6762, Multicast DNS</a></i>."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563180147, "post_id": 56388639, "comment_id": 100600476, "body": "It&#39;s in multiple sections, but in particular: &quot;<i>A host sending Multicast DNS queries to a link-local destination address (including the 224.0.0.251 and FF02::FB link-local multicast addresses) MUST only accept responses to that query that originate from the local link, and silently discard any other response packets. Without this check, it could be possible for remote rogue hosts to send spoof answer packets (perhaps unicast to the victim host), which the receiving machine could misinterpret as having originated on the local link.</i>&quot;"}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563180499, "post_id": 56388639, "comment_id": 100600638, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196456/discussion-between-philip-couling-and-ron-maupin\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1563180573, "post_id": 56388639, "comment_id": 100600669, "body": "Unfortunately, I need to go to bed right now."}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1559276467, "question_id": 521629}, "owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1563149602, "creation_date": 1559081920, "last_edit_date": 1563149602, "question_id": 56388639, "link": "https://stackoverflow.com/questions/56388639/can-mdns-be-used-to-resolve-to-a-link-local-address", "title": "Can mDNS be used to resolve to a link-local address?", "body": "<p>In an earlier discussion on the topic of IPv6 Link-local addresses I saw a comment which stated:</p>\n\n<blockquote>\n  <p>Some would argue that using addresses instead of host names should be discouraged, for any type of addresses. Using mDNS to map to link-local addresses works fine.</p>\n</blockquote>\n\n<p>The context of the discussion was that you need to specify an interface when using a link-local address.  </p>\n\n<p>I found the above comment surprising because I didn't expect mDNS to supply link information, thus I didn't expect it to \"work fine\".  I constructed a simple test (below) to see if the information supplied by <code>getaddrinfo</code> included a link and I found the following:</p>\n\n<ul>\n<li><p>Passing an address and link (eg: <code>fe80::a:a:a:a%wlp3s0</code>) to getaddrinfo resulted in a <a href=\"http://man7.org/linux/man-pages/man7/ipv6.7.html#DESCRIPTION\" rel=\"nofollow noreferrer\">sockaddr_in6</a> with <code>sin6_scope_id</code> set to <code>3</code> (the index of my wlan card).  This shows that getaddrinfo can supply link information.</p></li>\n<li><p>Passing a hostname only resolvable by mDNS (which resolves to the same link-local address) resulted in a sockaddr_in6 with <code>sin6_scope_id</code> set to <code>0</code>, i.e. no link was specified</p></li>\n<li><p>Further I've confirmed that programs including SSH which rely on <code>getaddrinfo</code> to specify a link will fail when mDNS resolves a link-local address.  But they will succeed if the IP address and link are specified explicitly.</p></li>\n</ul>\n\n<hr>\n\n<p><strong>Was the above comment wrong, or have I made a mistake in the way I test this?  Can mDNS resolve to link-local address and specify the link?</strong></p>\n\n<p>For reference I'm testing on Debian Buster Linux version 4.19.0-5-amd647</p>\n\n<p>My <code>nsswitch.conf</code> contains </p>\n\n<pre><code>hosts:          files mdns4_minimal [NOTFOUND=return] dns myhostname\n</code></pre>\n\n<hr>\n\n<p>Testcode.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;netdb.h&gt;\n\n\nint main(int arg_count, char ** args)\n{\n    struct addrinfo hints, *servinfo, *p;\n\n    for (int i=1; i&lt;arg_count; i++)\n    {\n        memset(&amp;hints, 0, sizeof hints);\n        hints.ai_family = AF_INET6; // to force IPv6\n        hints.ai_socktype = SOCK_STREAM;\n        printf(\"Checking %s\\n\", args[i]);\n        if (getaddrinfo(args[i], \"https\", &amp;hints, &amp;servinfo)) {\n            perror(\"getaddrinfo\");\n            continue;\n        }\n\n        for(p = servinfo; p != NULL; p = p-&gt;ai_next) {\n            struct sockaddr_in6 * address = ((struct sockaddr_in6 *)p-&gt;ai_addr);\n            printf(\"family %d scope %d\\n\", address-&gt;sin6_family, address-&gt;sin6_scope_id);\n        }\n        freeaddrinfo(servinfo);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "posix", "time.h"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559083801, "post_id": 56350544, "comment_id": 99306915, "body": "I gave it an up-vote, although someone&#39;s down-vote is still there."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1559087505, "post_id": 56350544, "comment_id": 99307676, "body": "If you&#39;re compiling in strict mode and want to use posix, gnu, etc. functions on Linux, you should read <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/feature_test_macros.7.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "edited": false, "score": 1, "creation_date": 1559083298, "post_id": 56350744, "comment_id": 99306781, "body": "Wow, it never occurred to me that <code>c99</code> would turn off POSIX features. It&#39;s even harder for me to follow that <code>gnu99</code> turns them on, I think of <code>-std=gnu*</code> as GNU extensions like naked <code>asm()</code> statements. But you&#39;re right, <code>gnu99</code> forces these macros and pulls in the function I&#39;m looking for."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "edited": false, "score": 1, "creation_date": 1559189665, "post_id": 56350744, "comment_id": 99345218, "body": "@iter in Standard C the user could make their own function called <code>gmtime_r</code> with a different prototype, since that name is not reserved by the standard; if the compiler didn&#39;t allow that then it would be non-conforming"}, {"owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559235632, "post_id": 56350744, "comment_id": 99365437, "body": "@M.M: interestingly, <code>arm-none-eabi-gcc</code> toolchain finds <code>gmtime_r</code> even with <code>-std=c99</code> without any feature macros. The <code>time.h</code> it pulls in has no <code>#ifdef</code> guards around <code>gmtime_r</code> or <code>localtime_r</code>."}], "tags": [], "owner": {"reputation": 21, "user_id": 7108895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fE539.png?s=128&g=1", "display_name": "bring_dat", "link": "https://stackoverflow.com/users/7108895/bring-dat"}, "is_accepted": false, "score": 1, "last_activity_date": 1559082559, "last_edit_date": 1559082559, "creation_date": 1559081917, "answer_id": 56350744, "question_id": 56350544, "link": "https://stackoverflow.com/questions/56350544/implicit-declaration-of-function-gmtime-r/56350744#56350744", "title": "implicit declaration of function \u2018gmtime_r\u2019", "body": "<p>Actually, <code>gmtime_r</code> is not part of the ISO C99 standard, it\u2019s a POSIX extension. To enable that, use <code>std=gnu99</code> standard. </p>\n\n<p>You can always verify which features are available for which standard on your system by applying technique from <a href=\"http://www.pixelbeat.org/programming/gcc/c_c++_notes.html\" rel=\"nofollow noreferrer\">this Pixelbeat article</a>:</p>\n\n<blockquote>\n  <p>It can be quite confusing sometimes to know exactly\n  what is #defined in your program, and this is especially\n  true for glibc's \"feature\" macros. These macros are documented\n  (info libc \"feature test macros\"), but it's much easier\n  to see what's defined directly using \"cpp -dD\" like:</p>\n\n<pre><code>$ echo \"#include &lt;features.h&gt;\" | cpp -dN | grep \"#define __USE_\"\n    #define __USE_ANSI\n    #define __USE_POSIX\n    #define __USE_POSIX2\n    #define __USE_POSIX199309\n    #define __USE_POSIX199506\n    #define __USE_MISC\n    #define __USE_BSD\n    #define __USE_SVID\n\n$ echo \"#include &lt;features.h&gt;\" | cpp -dN -std=c99 | grep \"#define __USE_\"\n    #define __USE_ANSI\n    #define __USE_ISOC99\n</code></pre>\n  \n  <p>Also to see all the predefined macros one can do:</p>\n\n<pre><code>$ cpp -dM /dev/null\n</code></pre>\n  \n  <p>Note also for compiler specific macros you can do:</p>\n\n<pre><code>$ gcc -E -dM - &lt; /dev/null\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1157391"}, "is_accepted": true, "score": 8, "last_activity_date": 1564916751, "last_edit_date": 1564916751, "creation_date": 1559101614, "answer_id": 56352834, "question_id": 56350544, "link": "https://stackoverflow.com/questions/56350544/implicit-declaration-of-function-gmtime-r/56352834#56352834", "title": "implicit declaration of function \u2018gmtime_r\u2019", "body": "<p>The proper way to do this is:</p>\n\n<pre><code>#define _POSIX_C_SOURCE 200112L\n#include &lt;time.h&gt;\n</code></pre>\n\n<p>This method indicates explicitly the features that a source file requires, making it self-contained. It is also portable to any POSIX system using any compiler. No special compiler flag is needed.</p>\n\n<p>With GCC this code will compile with -std=c89, -std=c99, or any other value. Importantly what -std=gnu?? enables by default might differ depending on version or platform.</p>\n\n<p>See <a href=\"http://www.gnu.org/software/libc/manual/html_node/Feature-Test-Macros.html#Feature-Test-Macros\" rel=\"nofollow noreferrer\">Feature Test Macros</a> for details.</p>\n"}], "owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "accepted_answer_id": 56352834, "answer_count": 2, "score": 1, "last_activity_date": 1564916751, "creation_date": 1559080671, "question_id": 56350544, "link": "https://stackoverflow.com/questions/56350544/implicit-declaration-of-function-gmtime-r", "title": "implicit declaration of function \u2018gmtime_r\u2019", "body": "<p>What do I need to do to make <code>gcc</code> include the declaration of <code>gmtime_r(3)</code> from <code>time.h</code>? Looking at <code>/usr/include/time.h</code>, <code>gmtime_r</code> and <code>localtime_r</code> are inside <code>#ifdef __USE_POSIX</code>.</p>\n\n<p>Do I need to do something to turn <code>__USE_POSIX</code> on, like a command-line option? I'm running with <code>-std=c99</code> now. I understand that <code>__USE_*</code> macros are not intended to be set directly by user code.</p>\n\n<pre><code>/* Return the `struct tm' representation of *TIMER\n   in Universal Coordinated Time (aka Greenwich Mean Time).  */\nextern struct tm *gmtime (const time_t *__timer) __THROW;\n\n/* Return the `struct tm' representation\n   of *TIMER in the local timezone.  */\nextern struct tm *localtime (const time_t *__timer) __THROW;\n\n#ifdef __USE_POSIX\n/* Return the `struct tm' representation of *TIMER in UTC,\n   using *TP to store the result.  */\nextern struct tm *gmtime_r (const time_t *__restrict __timer,\n                struct tm *__restrict __tp) __THROW;\n\n/* Return the `struct tm' representation of *TIMER in local time,\n   using *TP to store the result.  */\nextern struct tm *localtime_r (const time_t *__restrict __timer,\n                   struct tm *__restrict __tp) __THROW;\n#endif  /* POSIX */\n\n</code></pre>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1559076500, "post_id": 56349817, "comment_id": 99304602, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 4, "creation_date": 1559076699, "post_id": 56349817, "comment_id": 99304683, "body": "Maybe a problem of access rights. You should use perror() to have a meaningful error message."}, {"owner": {"reputation": 63, "user_id": 11239996, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3Vae46loGf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relnpgE9BDDjKQybwiLP280WGXaRQ/mo/photo.jpg?sz=128", "display_name": "Gilad Raz", "link": "https://stackoverflow.com/users/11239996/gilad-raz"}, "edited": false, "score": 0, "creation_date": 1559076755, "post_id": 56349817, "comment_id": 99304710, "body": "I edited my code sample so you can see what im doing"}, {"owner": {"reputation": 63, "user_id": 11239996, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3Vae46loGf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relnpgE9BDDjKQybwiLP280WGXaRQ/mo/photo.jpg?sz=128", "display_name": "Gilad Raz", "link": "https://stackoverflow.com/users/11239996/gilad-raz"}, "reply_to_user": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559077004, "post_id": 56349817, "comment_id": 99304801, "body": "@AlainMerigot i&#39;m getting a premission denied error. but i can open other files in the same folder using fopen"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559077090, "post_id": 56349817, "comment_id": 99304838, "body": "What folder name did you enter?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 1, "creation_date": 1559077323, "post_id": 56349817, "comment_id": 99304971, "body": "Look at the file permissions in your folder. It may also be a problem of spelling."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1559077619, "post_id": 56349817, "comment_id": 99305106, "body": "Also, check if the file is read-only."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1559078359, "post_id": 56349817, "comment_id": 99305361, "body": "If you need more info, you can check <code>errno</code> to possibly get more data on why <code>fopen()</code> failed.  I would for sure print to console what the path was (or verify in debugger) just to be sure.  I&#39;m always surprised by what gets passed into strings when i don&#39;t verify."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1559078597, "post_id": 56349817, "comment_id": 99305456, "body": "Always check the return value of fgets(): if (fgets(...) == NULL) /* indeterminate array */ (Copy Pasta from another comment, but valid reminder here.)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559079832, "post_id": 56349817, "comment_id": 99305806, "body": "regarding: <code>printf(&quot;Error&quot;);</code>  The code should use: <code>perror( &quot;fopen to write failed&quot; );</code>  So both your error message And The text reason the system thinks the error occurred are output to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1559080060, "post_id": 56349817, "comment_id": 99305873, "body": "OT: regarding: <code>directory_path[strlen(directory_path) - 1] = 0;</code>  This is a somewhat &#39;iffy&#39; way to remove a trailing newline.  Suggest: <code>directory_path[ strcspn( directory_path, &quot;\\n&quot;) ] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559080354, "post_id": 56349817, "comment_id": 99305964, "body": "regarding; <code>char directory_path[PATH_LEN] = { 0 }; char directory_file[PATH_LEN] = { 0 };</code>  The array: <code>directory_file[]</code> should be longer than the array: <code>directory_path[]</code> to allow room for the `\\` and the length of the string: &quot;log.txt&quot;  I.E. it should be another 8 (or 9) bytes longer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559080725, "post_id": 56349817, "comment_id": 99306063, "body": "regarding the text in your question: <code>fopen(path, &quot;2&quot;);</code>  This will NEVER work.  The second argument must be a valid &quot;mode&quot;"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559081627, "post_id": 56349817, "comment_id": 99306298, "body": "@user3629249 I suggest posting this in an answer instead of filling up the comments."}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083060, "post_id": 56350676, "comment_id": 99306720, "body": "regarding: <code>As another thing, fgets automatically null terminates strings. As such, directory_path[strlen(directory_path) - 1] = 0; is not needed. It may truncate the end of your path</code>  not quite true.  The OP was trying to replace the trailing newline (as read by <code>fgets()</code>) with a NUL byte"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083160, "post_id": 56350676, "comment_id": 99306740, "body": "regarding: <code>char directory_file[PATH_LEN+sizeof(LOG_NAME)+1] = { 0 };</code>  The <code>sizeof()</code> will return the length of a pointer.  The statement should be: <code>char directory_file[PATH_LEN+strlen(LOG_NAME)+1] = { 0 };</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083168, "post_id": 56350676, "comment_id": 99306744, "body": "@user3629249 Updated. How does that look?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083224, "post_id": 56350676, "comment_id": 99306758, "body": "@user3629249 No, it will return the size of the string (including the terminating null byte) plus one character (for the backslash path separator). That&#39;s the minimum amount needed to store the largest possible path entered."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083387, "post_id": 56350676, "comment_id": 99306808, "body": "the expression: <code>sizeof(LOG_NAME)</code> degrades to the address of the <code>LOG_NAME</code> so it returns a pointer, not the number of bytes in the string"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1559083438, "post_id": 56350676, "comment_id": 99306816, "body": "@user3629249 Read up on <code>sizeof</code>: If it&#39;s passed an array (which a string literal just so happens to be) then it returns the size of the array."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083517, "post_id": 56350676, "comment_id": 99306836, "body": "referencing a bare array name degrades to the address of the first byte of the array, NOT the number of bytes in the array."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559083618, "post_id": 56350676, "comment_id": 99306865, "body": "@user3629249 Run <code>sizeof(&quot;Wow, it works!&quot;)</code> in a program and tell me that it returns the same thing as <code>sizeof(char *)</code>. <code>sizeof</code> is not a normal function and degradation does not apply the same way to it."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 0, "last_activity_date": 1559083153, "last_edit_date": 1559083153, "creation_date": 1559081504, "answer_id": 56350676, "question_id": 56349817, "link": "https://stackoverflow.com/questions/56349817/fopen-function-returns-null-when-given-an-existing-path/56350676#56350676", "title": "Fopen function returns null when given an existing path", "body": "<p>You have several issues in your code:</p>\n\n<p>For one, <code>fopen(path, \"2\");</code> is not valid.\nThe <code>mode</code> argument needs to include one of <code>a</code>, <code>r</code>, and <code>w</code> and can optionally include <code>b</code> or <code>+</code>.</p>\n\n<p>As another thing, <code>directory_path[strlen(directory_path) - 1] = 0;</code> may truncate the end of your path (if it's over <code>PATH_LEN</code> characters long).</p>\n\n<p>There also may be a possible issue with buffer overflow due to the fact that you copy a string to a buffer of the same size and then concatenate two other strings to it. Therefore, you should change this line:</p>\n\n<pre><code>char directory_file[PATH_LEN] = { 0 };\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>char directory_file[PATH_LEN+sizeof(LOG_NAME)+1] = { 0 };\n</code></pre>\n\n<p>To debug this issue, you should print the string entered and ask for confirmation before using it (wrap this in <code>#ifdef DEBUG</code>).</p>\n"}], "owner": {"reputation": 63, "user_id": 11239996, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3Vae46loGf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relnpgE9BDDjKQybwiLP280WGXaRQ/mo/photo.jpg?sz=128", "display_name": "Gilad Raz", "link": "https://stackoverflow.com/users/11239996/gilad-raz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559083153, "creation_date": 1559076297, "last_edit_date": 1559076723, "question_id": 56349817, "link": "https://stackoverflow.com/questions/56349817/fopen-function-returns-null-when-given-an-existing-path", "title": "Fopen function returns null when given an existing path", "body": "<p>When trying to open a file with <code>fopen(path, \"2\");</code> i get NULL on an existing path</p>\n\n<p>iv'e tried to enter only the file name and it works but i want the program to write the file in the path...\nYes, i write the path with double backslashes <code>\"\\\\\"</code> when it's necesary.\nYes the path without doubt exists.</p>\n\n<pre><code>FILE* log;\nchar directory_path[PATH_LEN] = { 0 };\nchar directory_file[PATH_LEN] = { 0 };\n\n//directory_path is the directory, entered by  the user\n//LOG_NAME is the files name without the path - \"log.txt\"\n//#define PATH_LEN 100\n\nprintf(\"Folder to scan:  \");\nfgets(directory_path, PATH_LEN, stdin);\ndirectory_path[strlen(directory_path) - 1] = 0;\n\n//this section connects the path with the file name.\nstrcpy(directory_file, directory_path);\nstrcat(directory_file, \"\\\\\");\nstrcat(directory_file, LOG_NAME);\n\nif ((log = fopen(directory_file, \"w\")) == NULL)\n{\n    printf(\"Error\");\n}\n</code></pre>\n\n<p>My program worked until i tried to write into a file in order to create a log file. This means that the path is correct without doubt.</p>\n\n<p>Can anyone tell me the problem here?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1559074073, "post_id": 56349391, "comment_id": 99303650, "body": "Hint: It&#39;s time to learn about the <a href=\"https://en.cppreference.com/w/cpp/language/switch\" rel=\"nofollow noreferrer\"><code>switch</code> statement</a> and/or lookup tables and/or  the idea of character math (e.g. <code>horizontal = pos - &#39;A&#39; + 1</code>). <b>Remember arrays in C are zero indexed</b>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1559075593, "post_id": 56349391, "comment_id": 99304227, "body": "Even EBCDIC, a character set notorious for not having the alphabet it 26 consecutive codes, does have A-H consecutive, so indexing by (poz - &#39;A&#39;) will work fine. And you don&#39;t actually need the chess array for anything, since you&#39;re not actually placing in pieces on a board--you&#39;re just calculating which squares satisfy certain conditions."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 1, "creation_date": 1559079032, "post_id": 56349391, "comment_id": 99305582, "body": "<code>scanf(&quot;%s&quot;, &amp;poz);</code> is going to segfault or cause weird errors because <code>poz</code> is only of type <code>char</code>. You should compile with warnings turned on."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1559079089, "post_id": 56349391, "comment_id": 99305600, "body": "Are there any other pieces on the board to block the queen?  Also, you do not mention what exactly your function is supposed to return.  8 8-charcters strings output to console?  An 8x8 array internally?  Also, you would be well to convert the position to 0-7, not 1-8 as in C, arrays are indexed base 0.  Lots of issues here for an assignment due tomorrow.  Procrastination gets you &#39;F&#39; grades often..."}, {"owner": {"reputation": 1, "user_id": 11569461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LJUZW9cwMH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftfHMGue3cL1uk5kLJ88P5l7ttOw/mo/photo.jpg?sz=128", "display_name": "helloall", "link": "https://stackoverflow.com/users/11569461/helloall"}, "edited": false, "score": 0, "creation_date": 1559080708, "post_id": 56349391, "comment_id": 99306058, "body": "There is nothing else on the board. My main function is supposed to return every field the queen can go to from her position, i dont have other function i think ."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559081808, "post_id": 56349391, "comment_id": 99306346, "body": "you might want to read: <a href=\"https://en.wikipedia.org/wiki/Eight_queens_puzzle\" rel=\"nofollow noreferrer\">queensProblem</a>  for some hints."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1559083547, "post_id": 56349391, "comment_id": 99306847, "body": "So tempted to post a recursive solution to this and have him try to explain that to prof."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1559083177, "post_id": 56350835, "comment_id": 99306748, "body": "Pretty sure they want &quot;Algebreic Notation&quot; as entry - hence the letter/number combo.  Also, ranges as 0 base would be 0 to 7 yes?"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1559083710, "last_edit_date": 1559083710, "creation_date": 1559082565, "answer_id": 56350835, "question_id": 56349391, "link": "https://stackoverflow.com/questions/56349391/homework-problem-available-fields-for-queen-in-chess/56350835#56350835", "title": "Homework problem, available fields for queen in chess", "body": "<p>Strongly suggest the indexing be modified to 0...7 for both horizontal and vertical positions  Then include: (where 'r' is the row and 'c' is the column)</p>\n\n<pre><code>All positions in the column (0..7)/(c) where the queen is placed except (r)/(c) \n\nAll positions in the row (r)/(0..7) where the queen is placed except (r)/(c)\n</code></pre>\n\n<p>Then starting at the queen placement (r)/(c)</p>\n\n<pre><code>all successive positions (r+1)/(c-1) until edge of board\nall successive positions (r+1)/(c+1) until edge of board\nall successive positions (r-1)/(c-1) until edge of board\nall successive positions (r-1)/(c+1) until edge of board\n</code></pre>\n\n<p>The above is a few 'for()' statements and should be 'relatively' easy to implement.</p>\n"}], "owner": {"reputation": 1, "user_id": 11569461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LJUZW9cwMH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftfHMGue3cL1uk5kLJ88P5l7ttOw/mo/photo.jpg?sz=128", "display_name": "helloall", "link": "https://stackoverflow.com/users/11569461/helloall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1559083710, "creation_date": 1559073991, "last_edit_date": 1559074114, "question_id": 56349391, "link": "https://stackoverflow.com/questions/56349391/homework-problem-available-fields-for-queen-in-chess", "title": "Homework problem, available fields for queen in chess", "body": "<p>I have school asignment due tommorow and would apreaciate some help.  My assigment is \"Create a program that determines which chess board fields are available to the queen from the field where it is located. The chessboard is presented as a matrix 8x8. Queen's position is entered from the keyboard into [letter] [number]. And the result is saved in a string. \" </p>\n\n<p>Iam kinda stuck on how to continiue, i think i need like 8 different if's. 2 for horizontal, 2 for vertical and 4 for diagonals, but i dont know how to do them. </p>\n\n<pre><code>int main()\n{\n\n    int horizontal,vertical,i,j,current;\n    char poz;\n\n    printf(\"Enter the horizontal position of queen(A-H)\\n\");\n    scanf(\"%s\", &amp;poz);\n\n    if(poz=='A')\n    {\n        horizontal=1;\n    }\n    else if (poz=='B')\n    {\n        horizontal=2;\n    }   \n    else if (poz=='C')\n    {\n        horizontal=3;\n    }\n    else if (poz=='D')\n    {\n        horizontal=4;\n    }   \n    else if (poz=='E')\n    {\n        horizontal=5;\n    }\n    else if (poz=='F')\n    {\n        horizontal=6;\n    }\n    else if (poz=='G')\n    {\n        horizontal=7;\n    }\n    else if (poz=='H')\n    {\n        horizontal=8;\n    }\n\n    printf(\"Enter the vertical position of queen(1-8)\\n\");\n    scanf(\"%d\",&amp;vertical);\n\n    int n=8,m=8;\n\n    int chess[8][8]={\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    {1,2,3,4,5,6,7,8},\n    };\n\n    printf(\"Queen pos is %c-%d\",poz,vertical );\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 5, "creation_date": 1559073382, "post_id": 56349245, "comment_id": 99303359, "body": "Yeah conflicting types, <code>int using_name()</code> then <code>char* using_name()</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559073530, "post_id": 56349245, "comment_id": 99303433, "body": "It&#39;s a contrived example which doesn&#39;t use the return value \u2013 it&#39;s a global anyway \u2013 but the definition and the declaration must match."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1559073858, "post_id": 56349245, "comment_id": 99303574, "body": "It&#39;s got two return types and also two argument types: it&#39;s declared with no arguments, then called with a char * argument."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "edited": false, "score": 0, "creation_date": 1559073814, "post_id": 56349297, "comment_id": 99303555, "body": "That solved the conflicting issue but now when I run the script, I enter a name, and the first function repeats before moving to the next function. Could you help again pls"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559073949, "post_id": 56349297, "comment_id": 99303603, "body": "That&#39;s because you call <code>using_name()</code> twice. You call it in <code>main()</code> and again in <code>call_func()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559073979, "post_id": 56349297, "comment_id": 99303617, "body": "It should just be <code>printf(&quot;Hello %d\\n&quot;, name);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "edited": false, "score": 0, "creation_date": 1559074033, "post_id": 56349297, "comment_id": 99303635, "body": "Barmar for president!"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1559073529, "creation_date": 1559073529, "answer_id": 56349297, "question_id": 56349245, "link": "https://stackoverflow.com/questions/56349245/unable-to-return-function-parameter-due-to-conflicting-types-for-function-in-c/56349297#56349297", "title": "Unable to return function parameter due to conflicting types for &#39;function&#39; in C", "body": "<p>The return and argument types in the funnction prototype at the beginning of the program has to match the actual types when the function is defined later.</p>\n\n<p>Since <code>using_name()</code> is defined as:</p>\n\n<pre><code>char *using_name()\n</code></pre>\n\n<p>You need to change the earlier prototype to:</p>\n\n<pre><code>char *using_name();\nint call_func(char name[20]);\n</code></pre>\n\n<p>Another solution is to just put the function definitions at the beginning of the program. You only need prototypes for functions that are used before they're defined, or functions that are defined in another compilation unit (although these prototypes are usually put in a header file).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10003651"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56349297, "answer_count": 1, "score": 0, "last_activity_date": 1559076884, "creation_date": 1559073306, "last_edit_date": 1559076884, "question_id": 56349245, "link": "https://stackoverflow.com/questions/56349245/unable-to-return-function-parameter-due-to-conflicting-types-for-function-in-c", "title": "Unable to return function parameter due to conflicting types for &#39;function&#39; in C", "body": "<p>I'm new to C and I'm trying to understand how there are conflicting types for my function \"using_name\".</p>\n\n<p>I also don't understand why I have to include a '*' to name the 'using_name()' function. It is because I'm storing a value in the function address?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint using_name(), call_func(char name[20]);\nchar name[20];\n\nint main ()\n{\n    using_name();\n    call_func(name);\n\n    return 0;\n}\n\nchar* using_name()\n{\n        printf(\"What is your name: \");\n        scanf(\"%s\", name);\n        printf(\"\\n Your name is %s\", name);\n\n        return name;\n}\n\nint call_func(char name[20])\n{\n    printf(\"Hello %s\", using_name(name));\n\n}\n</code></pre>\n\n<p>Error: conflicting types for 'using_name'</p>\n"}, {"tags": ["c", "timer", "stm32", "dma", "adc"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1559076262, "post_id": 56349199, "comment_id": 99304509, "body": "Some code will definitely help."}, {"owner": {"reputation": 35, "user_id": 9387989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992bd12fd16707c953e1f3408c0db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pacin", "link": "https://stackoverflow.com/users/9387989/pacin"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1559109701, "post_id": 56349199, "comment_id": 99312213, "body": "I have added some code."}, {"owner": {"reputation": 35, "user_id": 9387989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992bd12fd16707c953e1f3408c0db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pacin", "link": "https://stackoverflow.com/users/9387989/pacin"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1562252949, "post_id": 56349199, "comment_id": 100328121, "body": "Can anybody help me, please? Maybe a hint, what the problem could be."}, {"owner": {"reputation": 35, "user_id": 9387989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992bd12fd16707c953e1f3408c0db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pacin", "link": "https://stackoverflow.com/users/9387989/pacin"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1562328114, "post_id": 56349199, "comment_id": 100350014, "body": "Thank you for your help community! The problem is solved by writing the following line after the calibration part. ADC1-&gt;CFGR1 |= ADC_CFGR1_DMAEN; Means the DMA transfer for the ADC must not be enabled before the calibration."}], "owner": {"reputation": 35, "user_id": 9387989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992bd12fd16707c953e1f3408c0db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pacin", "link": "https://stackoverflow.com/users/9387989/pacin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1559109597, "creation_date": 1559073100, "last_edit_date": 1559109597, "question_id": 56349199, "link": "https://stackoverflow.com/questions/56349199/adc-read-out-array-values-displaced-for-one-entry", "title": "ADC Read-Out-Array-Values displaced for one Entry", "body": "<p>The question is about the microcontroller STM32L031G6UxS.\nI use a Timer to trigger the ADC and then I use the DMA to transfer the data (whole sequence) into RAM.\nWith the ADC I scan Channel 1, 8 and 9. Actually the data in the Read-Out-Array should folow this direction, because SCANDIR=0 (Scan from CH0 to CHx):</p>\n\n<p>ADCReadOut[0]=ValueCH1</p>\n\n<p>ADCReadOut[1]=ValueCH8</p>\n\n<p>ADCReadOut[2]=ValueCH9</p>\n\n<p>The strange behaviour I have at the moment is the folowing:</p>\n\n<p>ADCReadOut[0]=ValueCH9</p>\n\n<p>ADCReadOut[1]=ValueCH1</p>\n\n<p>ADCReadOut[2]=ValueCH8</p>\n\n<p>As you can see the values are displaced for one entry.</p>\n\n<p>The code below shows the appropriate implementation.</p>\n\n<pre><code>#define GPIO_ADC_VP_PORT                    (ps_GPIO_PORT_A)\n#define GPIO_ADC_VP_BIT                     (u32_GPIO_PIN_1)\n#define GPIO_ADC_PREAMP_POS_PORT            (ps_GPIO_PORT_B)\n#define GPIO_ADC_PREAMP_POS_BIT             (u32_GPIO_PIN_0)\n#define GPIO_ADC_PREAMP_NEG_PORT            (ps_GPIO_PORT_B)\n#define GPIO_ADC_PREAMP_NEG_BIT             (u32_GPIO_PIN_1)\n\n#define ADC1_TRIGGER                        ( ADC_CFGR1_EXTSEL_2 )   /* TIM22 (TRGO) connected to TRG4 of ADC1 */\n#define ADC1_SMPT                           ( ADC_SMPR_SMP_1 | ADC_SMPR_SMP_0 )   /* Sampling time: 12.5 ADC clock cylce */\n#define ADC1_CHANNELS                       ( ADC_CHANNEL_1 | ADC_CHANNEL_8 | ADC_CHANNEL_9 )   /* VP, Preamp pos, Preamp neg */\n\n#define ADC1_DMA                            ( DMA1_Channel1 )\n#define DMA_DATA_COUNT                      ( 3 )\n\n...    \n\n/*--- TIM22 / ADC1 / DMA1 ---*/\nv_Timer22_Init( pb_UseEdsk_Flag );\nv_Adc1_Init( &amp;au16_ReadoutBufferAdc1[0] );\nv_Adc1_Calibrate();\n\n/*--- Enable second level hardware ---*/\n/* Enable DMA1 */\nADC1_DMA-&gt;CCR |= DMA_CCR_EN;\n\n/* Enable ADC1 */\nADC1-&gt;CR |= ADC_CR_ADEN;\n\n/* Start ADC1 and corresponding timer */\nADC1-&gt;CR |= ADC_CR_ADSTART;\nv_StartTimer22();\n\n...\n\nstatic void v_Timer22_Init( bool_t* pb_UseEdsk_Flag )\n{\n    /* OC1REF signal is used as trigger output: TRGO triggers ADC1 */\n    ADC1_TIMER-&gt;CR2 |= TIM_CR2_MMS_2;\n\n    /* Prescaler */\n    if( *pb_UseEdsk_Flag )\n    {\n         ADC1_TIMER-&gt;PSC = ADC1_TIMER_PRESCALER_EDSK;\n    }\n    else\n    {\n         ADC1_TIMER-&gt;PSC = ADC1_TIMER_PRESCALER_ANALOG;\n    }\n    /* Auto reload register */\n    ADC1_TIMER-&gt;ARR = ADC1_TIMER_RELOAD_VALUE;\n    /* Delay until ADC1 is triggerd: duty cycle off time */\n    ADC1_TIMER-&gt;CCR1 = ACD1_TIMER_CYCLE_OFF_VALUE;\n\n    /* Configure channel 1 as output */\n    ADC1_TIMER-&gt;CCMR1 &amp;= ~TIM_CCMR1_CC1S;\n    /* Configure channel 1 to PWM Mode 2 (OC1M = 0b111),\n       channel 1 is inactive as long as TIM22_CNT &lt; TIM22_CCR1 */\n    ADC1_TIMER-&gt;CCMR1 |= ( TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1 | TIM_CCMR1_OC1M_0 );\n}\n\nstatic void v_StartTimer22( void )\n{\n    /* Reset timer count register */\n    ADC1_TIMER-&gt;CNT = 0;\n    /* Start timer */\n    ADC1_TIMER-&gt;CR1 |= TIM_CR1_CEN;\n}\n\nstatic void v_Adc1_Init( uint16_t* pu16_MemAdr )\n{\n    /*--- ADC1 part ----*/    \n    /* Select PCLK divided by 1 as ADC clock */\n    ADC1-&gt;CFGR2 |= ADC_CLOCKPRESCALER_PCLK_DIV1;\n\n    /* Enable voltage regulator */\n    ADC1-&gt;CR |= ADC_CR_ADVREGEN;\n    /* Every time a trigger is received, 1 sequence is sampled */\n    ADC1-&gt;CFGR1 &amp;= ~ADC_CFGR1_DISCEN;\n    /* Insert a delay after each conversion until the DR register is read */\n    ADC1-&gt;CFGR1 |= ADC_CFGR1_WAIT;\n    /* Enable hardware trigger on rising edge */\n    ADC1-&gt;CFGR1 |= ADC_CFGR1_EXTEN_0;\n    /* Set ADC1_TIMER as trigger source */\n    ADC1-&gt;CFGR1 |= ADC1_TRIGGER;\n\n    /* DMA circular mode selected */\n    ADC1-&gt;CFGR1 |= ADC_CFGR1_DMACFG;\n    /* Enable DMA */\n    ADC1-&gt;CFGR1 |= ADC_CFGR1_DMAEN;\n\n    /* Sampling time in ADC clock cycles */\n    ADC1-&gt;SMPR |= ADC1_SMPT;\n\n    /* ADC1 Channels */\n    ADC1-&gt;CHSELR |= ADC1_CHANNELS;\n\n    /*--- DMA part ---*/\n    /* Peripheral address */\n    ADC1_DMA-&gt;CPAR = ( uint32_t )&amp;ADC1-&gt;DR;    \n    /* Memory address */\n    ADC1_DMA-&gt;CMAR = ( uint32_t )pu16_MemAdr;    \n    /* Number of data to transfer */\n    ADC1_DMA-&gt;CNDTR = DMA_DATA_COUNT;    \n    /* Priority: Very high */\n    ADC1_DMA-&gt;CCR |= DMA_CCR_PL;    \n\n    /* Disable Memory-To-Memory mode */\n    ADC1_DMA-&gt;CCR &amp;= ~DMA_CCR_MEM2MEM;\n    /* Memory size: 16-Bit */\n    ADC1_DMA-&gt;CCR |= DMA_CCR_MSIZE_0;\n    /* Peripheral size: 16-Bit */\n    ADC1_DMA-&gt;CCR |= DMA_CCR_PSIZE_0;\n    /* Enable memory increment mode */\n    ADC1_DMA-&gt;CCR |= DMA_CCR_MINC;\n    /* Disable peripheral increment mode */\n    ADC1_DMA-&gt;CCR &amp;= ~DMA_CCR_PINC;\n    /* Enable circular mode */\n    ADC1_DMA-&gt;CCR |= DMA_CCR_CIRC;\n    /* Data direction: Read from peripheral and write to memory */\n    ADC1_DMA-&gt;CCR &amp;= ~DMA_CCR_DIR;\n    /* Disable transfer complete interrupt */\n    ADC1_DMA-&gt;CCR &amp;= ~DMA_CCR_TCIE;\n}\n\nstatic void v_Adc1_Calibrate( void )\n{\n    /* Make sure that ADC1 is stabilized before the calib process starts */\n    v_SysClk_BusyWaitUs( 10 );\n\n    /* Stops ADC1 */\n    ADC1-&gt;CR |= ADC_CR_ADSTP;\n\n    /* Check if ADC1 is disabled */\n    if( ADC1-&gt;CR &amp; ADC_CR_ADEN )\n    {\n        /* Disable ADC1 */\n        ADC1-&gt;CR |= ADC_CR_ADDIS;\n    }\n\n    /* Wait until ADC1 is disabled */\n    while( ADC1-&gt;CR &amp; ADC_CR_ADEN ) {}\n\n    /* Start calibration */\n    ADC1-&gt;CR |= ADC_CR_ADCAL;\n\n    /* Wait until ADC1 is calibrate */\n    while( ADC1-&gt;CR &amp; ADC_CR_ADCAL ) {}\n}\n</code></pre>\n\n<p>Does anybody have an Idea what's wrong?\nI guess that the DMA Pointer which show on the RAM is already increased by one, when Timer, ADC and DMA starts to work. Is that generally thinkable?</p>\n"}, {"tags": ["c", "pointers", "pass-by-reference", "dereference", "addressof"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1559072799, "post_id": 56349086, "comment_id": 99303131, "body": "This is basic knowledge. I think you should read the chapter dealing with pointers in your C text book."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559073070, "post_id": 56349086, "comment_id": 99303245, "body": "<code>read_data(&amp;a, &amp;b, c);</code> passes the addresses of the three variables defined in <code>main</code> to the function. They are pointers. The third one <code>c</code> is an array, which decays to the required pointer. Note that the function parameters <code>char *char_ptr</code> and <code>char k[]</code> are essentially the same \u2013 you can&#39;t pass an array to a function."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1559073853, "post_id": 56349086, "comment_id": 99303569, "body": "<code>fscanf(stdin,&quot;%d %f %s&quot;, int_ptr, float_ptr, char_ptr); stores the data supplied by the user in the address of the pointers</code> . No.  fscanf writes the data to the location specified by the pointers, not the address of the pointers.  Each pointer holds a value, which is the address to which fscanf writes data.  The address of the pointer is irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 0, "last_activity_date": 1559079933, "creation_date": 1559079933, "answer_id": 56350435, "question_id": 56349086, "link": "https://stackoverflow.com/questions/56349086/why-passing-by-reference-works-using-only-pointers-declared-in-the-argument-list/56350435#56350435", "title": "Why passing by reference works using only pointers declared in the argument list of this C program?", "body": "<p>It's not inconsistent, you are just inferring the wrong attributes to the function.</p>\n\n<p>Note the difference between:</p>\n\n<p><strong>A function declaration:</strong></p>\n\n<pre><code>void read_data(int *int_ptr, float *float_ptr, char *char_ptr){...}\n</code></pre>\n\n<p>And a <strong>function call</strong></p>\n\n<pre><code>read_data(int_ptr, float_ptr, char_ptr);\n</code></pre>\n\n<blockquote>\n  <p>But in the program below, \"address of\" operators are passed when calling read_data(&amp;a, &amp;b, c); through the argument list of void read_data(int *int_ptr, float *float_ptr, char *char_ptr){...}, where we have \"contents of\" operators, which seems inconsistent, but works</p>\n</blockquote>\n\n<p>Your inference on what this function's argument list represents is what is causing your confusion. The function does not take \"contents of\" pointers, but rather pointers themselves. And since the \"address of\" operator returns a pointer, it is perfectly fine to call the function using <code>read_data(&amp;a, &amp;b, c)</code></p>\n"}], "owner": {"reputation": 27, "user_id": 9685503, "user_type": "registered", "profile_image": "https://graph.facebook.com/679179802257323/picture?type=large", "display_name": "Sneaky", "link": "https://stackoverflow.com/users/9685503/sneaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56350435, "answer_count": 1, "score": 0, "last_activity_date": 1559079933, "creation_date": 1559072622, "last_edit_date": 1559078755, "question_id": 56349086, "link": "https://stackoverflow.com/questions/56349086/why-passing-by-reference-works-using-only-pointers-declared-in-the-argument-list", "title": "Why passing by reference works using only pointers declared in the argument list of this C program?", "body": "<p>This is Program 3.7 from Robert Wood's \"C Programming for Scientists and Engineers\". In the code below, the pointers are not declared and initialized in the body of main(), but directly in the argument list of read_data() function.  </p>\n\n<p>Normally, when writing code, I first declare 3 pointers (int *int_ptr, float *float_ptr, char *char_ptr) and then assign the addresses of the a, b and c to them. But in the program below, \"address of\" operators are passed when calling read_data(&amp;a, &amp;b, c); through the argument list of void read_data(int *int_ptr, float *float_ptr, char *char_ptr){...}, where we have \"contents of\" operators, which seems inconsistent, but works.\nAlso, fscanf(stdin,\"%d %f %s\", int_ptr, float_ptr, char_ptr); stores the data supplied by the user in the address of the pointers, whereas I think thought that they should be written in the contents of the variables a, b and c like that:</p>\n\n<pre><code>fscanf(stdin,\"%d %f %s\", int_*ptr, *float_ptr, *char_ptr);\n</code></pre>\n\n<p>But I am wrong.</p>\n\n<p>Otherwise the program works, but if I had to write it this way, I will not be able to. So, I want you to help me understand and maybe provide alternative solution.</p>\n\n<pre><code>/* Program 3.7- Use of functions for input and output of data */\n#include &lt;stdio.h&gt;\n\nint main(void) {\n  int a;\n  float b;\n  char c[11];\n\n  /* function prototype */\n  void read_data(int *, float *, char *);\n  void write_data(int, float, char[]);\n\n  /*call the function*/\n  read_data(&amp;a, &amp;b, c);\n  write_data(a, b, c);\n\n  return (0);\n}\n\n/*Function: read_data - reads an int, float and char string*/\nvoid read_data(int *int_ptr, float *float_ptr, char *char_ptr) {\n  fprintf(stdout, \" Supply an integer, a float and a string (max. 10 chars):\");\n  fscanf(stdin, \"%d %f %s\", int_ptr, float_ptr, char_ptr);\n  return;\n}\n\n/* Function: write_data - displays an int, float and char string*/\nvoid write_data(int i, float j, char k[]) {\n  fprintf(stdout, \" The supplied data is: %d %f %s\\n\", i, j, k);\n  return;\n}\n</code></pre>\n"}, {"tags": ["c", "stack-pointer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1559072095, "post_id": 56348958, "comment_id": 99302867, "body": "Because it doesn&#39;t have to? Allocating all of the local variables at once is giving less performance overhead than moving it back and forth for every block."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1559072185, "post_id": 56348958, "comment_id": 99302893, "body": "C standard does not mention any stack. It&#39;s possible that enough memory is reserved on the stack at the start of the function. It&#39;s unusual to push and pop variables on demand: there is a stack frame."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1559072281, "post_id": 56348958, "comment_id": 99302939, "body": "It might behave differently with optimisations enabled, recycling locations in the stack frame."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 7, "creation_date": 1559072282, "post_id": 56348958, "comment_id": 99302940, "body": "Because what it does with the stack is none of your business. You may get different results with another compiler or with different compiler settings."}, {"owner": {"reputation": 163, "user_id": 5526308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2ZWnpfz6p8Q/AAAAAAAAAAI/AAAAAAAAAI4/4-c5eNsV8aQ/photo.jpg?sz=128", "display_name": "Amelia Hartman", "link": "https://stackoverflow.com/users/5526308/amelia-hartman"}, "edited": false, "score": 0, "creation_date": 1559072603, "post_id": 56348958, "comment_id": 99303053, "body": "For some reason I was under the impression that local variables were always removed from the stack when it was out of scope. I did try different optimisation settings and it does change the output, so now I understand a bit better what the compiler is doing. Thanks."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1559072708, "post_id": 56348958, "comment_id": 99303097, "body": "@AmeliaHartman From the C programmer perspective these variables cease to exist, even though the memory might be still unused by anything else, so any reference to them will result in undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559075024, "post_id": 56349170, "comment_id": 99304013, "body": "In the C standard, \u201cundefined behavior\u201d does not mean anything can happen. It means the C standard imposes no requirements on the behavior. These are different things."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1559075208, "post_id": 56349170, "comment_id": 99304078, "body": "Which in turn means that the compiler is completely free to produce any code it wants, so yes, the resulting program can be anything, even if some scenarios are way more likely than others. Still, in the end it&#39;s basically the same. You destroy the predictability of the program."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559076343, "post_id": 56349170, "comment_id": 99304541, "body": "@EricPostpischil What could possibly be the practical difference?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559095649, "post_id": 56349170, "comment_id": 99309054, "body": "No, the resulting program cannot be anything. It is restricted by physics, logic, compiler specification, operating system specification, electrical safety regulations, and more. If \u201canything\u201d could happen, then it would impossible to use the observed behavior to help figure out what went wrong. But experienced programmers learn to recognize symptoms and clues. One type of output suggests memory corruption, another suggests misinterpreted data, and so on. So that is one practical difference: \u201cAnything\u201d is not debuggable, but \u201cnot specified by C standard\u201d is debuggable."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559096050, "post_id": 56349170, "comment_id": 99309143, "body": "Another practical difference is that what is \u201cundefined behavior\u201d in the C standard may be a defined and supported language extension in a C implementation. For some extensions, using them <b>requires</b> you to write a program whose behavior is not defined by the standard. If the fact there were \u201cundefined behavior\u201d in the C standard\u2019s meaning meant anything can happen, then the extension could not work\u2014it could not be supported code. It is the fact that the C standard says <b>it</b>, and it alone, does not define the behavior that makes it possible to extend the C language so flexibly."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559107521, "post_id": 56349170, "comment_id": 99311427, "body": "&quot;Obey the laws of physic&quot;? Are you for real? If I said that the program <code>#include &lt;stdio.h&gt; int main(void) { puts(&quot;Hello World&quot;); }</code> will print &quot;Hello World&quot;, would you then say <i>&quot;No, no, no, you cannot say that with 100% certainty. The compiler might have a bug. It can be something wrong with the hardware. Natural radioactivity might flip a bit in the memory. The operating system might run out of memory. Someone might pull the plug in the middle of the execution. So this program is not guaranteed to print &#39;Hello World&#39;.&quot;</i>?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559108138, "post_id": 56349170, "comment_id": 99311612, "body": "<i>&quot;If \u201canything\u201d could happen, then it would impossible to use the observed behavior to help figure out what went wrong.&quot;</i> - And just to continue on that track, this is also actually a logical flaw. In order for this to be true, you have to make assumptions about the probability distribution among the different events."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559108251, "post_id": 56349170, "comment_id": 99311650, "body": "There is a very (very, very, very, very) small probability that the computer (or you, or basically everything else) will get spontaneously quantum teleported to Mars (or somewhere else). And actually, your fingerprint on your coffee mug might get quantum teleported to a murder weapon on the other side of earth. Does that mean that we cannot draw conclusions from finger prints on murder weapons? Of course not."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559123388, "post_id": 56349170, "comment_id": 99319240, "body": "<a href=\"https://www.wnycstudios.org/story/bit-flip\" rel=\"nofollow noreferrer\">Bit flips due to radiation</a> are a serious concern. Such a bit flip is believed to have altered initially reported election results in one case, and, as a consequence, redundancy was added to vote counting. Bit flips from radiation are also a cause of <a href=\"https://en.wikipedia.org/wiki/Soft_error#Alpha_particles_from_package_decay\" rel=\"nofollow noreferrer\">using purer materials in chip packaging</a>. So, what you treat as a joke is a serious concern. If you want to do the best engineering, you have to deal with this. The reason you can often neglect it now is because other\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559123411, "post_id": 56349170, "comment_id": 99319250, "body": "\u2026 people have already done the work to reduce the error levels significantly."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559124117, "post_id": 56349170, "comment_id": 99319686, "body": "Let\u2019s stick to the point, though. The sentence in this answer that says \u201cAccessing a variable that has gone out of scope causes <i>undefined behavior</i>, which means that anything can happen\u201d is false. It is provably false logically, factually, and practically. A false statement misinforms readers and makes the answer less useful. In particular, it leads students to falsely believe \u201cundefined behavior\u201d in the meaning of the C standard cannot be a part of C programs, but it is actually required for some extensions.\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559124121, "post_id": 56349170, "comment_id": 99319689, "body": "\u2026  And it is pointless since it is easy to state the truth instead, which is that \u201cundefined behavior\u201d means the C standard imposes no requirements on the behavior. An answer that teaches something false is not a good answer. It would be very easy to correct your answer so that the statement it makes is true instead of false."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559124414, "post_id": 56349170, "comment_id": 99319847, "body": "@EricPostpischil I&#39;m perfectly aware that bitflips is a serious concern. My objection is that it is not worth mentioning when someone asks &quot;What is the output of this program?&quot;. I can give you that you have a point that it might (but maybe not always) be worth mentioning that UB usually follows some kind of pattern that can give you clues and that many compiler extensions are UB, but I&#39;m pretty sure that everybody (by which I exclude extreme cases) will understand that no program will defy logic or laws of physics. Mentioning that is completely superfluous."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559124856, "post_id": 56349170, "comment_id": 99320070, "body": "First, nobody is asking you to mention in the answer that bit flips can occur or to state that no program will defy logic or laws of physics. The only request is that you change the false statement to a true statement. The statements about some situations in which there are differences were presented only at your request, to explain to you why it matters. Second, the statement is false. That alone is enough reason to fix it. It can be seen to false by looking up the definition of \u201cundefined behavior\u201d in the C standard., and it is known to be false for the reasons I have given."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559124989, "post_id": 56349170, "comment_id": 99320146, "body": "Third, the statement induces false beliefs in readers. It misleads them to believe that \u201cundefined behavior\u201d must be avoided. That is wrong. The C standard defines a core language (of strictly conforming programs) and invites extensions (of conforming programs). Some of those extensions lie in the region that the C standard classifies as \u201cundefined behavior\u201d in its meaning. To understand C fully, one must understand that \u201cundefined behavior\u201d is actually a necessary part of the extended language, not something that should be always avoided."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559125251, "post_id": 56349170, "comment_id": 99320275, "body": "I could fix it by changing it to &quot;anything may happen, except for things that obviously cannot happen&quot; but I don&#39;t see the point of doing that. Furthermore, while what you are saying is technically true and also important in many cases, I believe that mentioning these things every time UB is mentioned just clutters the answer and confuses people."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559125442, "post_id": 56349170, "comment_id": 99320367, "body": "Once again, nobody is asking you to mention these things. Just to say \u201c\u2026 undefined behavior, which means the C standard imposes not requirements\u201d (or, if you feel that is too technical for a particular question\u2019s level, \u201c\u2026 undefined behavior, which means the C standard does not say what the program will do\u201d). And the statement \u201canything may happen, except for things that obviously cannot happen\u201d is also false, so you should not use that."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559126099, "post_id": 56349170, "comment_id": 99320717, "body": "In my opinion, that does not highlight the dangers of UB enough. I think it makes more sense to say something that is not 100% correct, but teaches people that UB can be very dangerous."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 7, "last_activity_date": 1559073516, "last_edit_date": 1559073516, "creation_date": 1559072944, "answer_id": 56349170, "question_id": 56348958, "link": "https://stackoverflow.com/questions/56348958/why-does-c-not-decrement-the-stack-pointer-if-a-variable-leaves-the-scope/56349170#56349170", "title": "Why does C not decrement the stack pointer if a variable leaves the scope?", "body": "<p>The C standard does not even mention a stack. The compiler is free to optimize variables away when they are not needed. There is absolutely nothing in the C standard that implies that the printouts should be neither equal or not equal.</p>\n\n<p>On my computer, this manifests itself by giving different output depending on optimization level:</p>\n\n<pre><code>$ gcc c.c\n\n/tmp$ ./a.out \n0x7ffd8733c3ac\n0x7ffd8733c3a8\n\n/tmp$ gcc c.c -O3\n\n/tmp$ ./a.out \n0x7fff4e91544c\n0x7fff4e91544c\n</code></pre>\n\n<blockquote>\n  <p>In fact, the first \"int x\" is still reachable even though its scope is gone.</p>\n</blockquote>\n\n<p>Accessing a variable that has gone out of scope causes <em>undefined behavior</em>, which means that anything can happen. This includes the case where the program works as intended.</p>\n\n<p>Here is the output from your second snippet with different optimizations:</p>\n\n<pre><code>/tmp$ ./a.out \n0x7ffd4df94864\n0x7ffd4df94860\n0x7ffd4df9485c\n10 25 71\n\n/tmp$ gcc c.c -O3\n\n/tmp$ ./a.out \n0x7ffc30b4e44c\n0x7ffc30b4e44c\n0x7ffc30b4e44c\n0 0 71\n</code></pre>\n\n<p>When you get different behavior depending on optimization level, that's an almost 100% sign that your program has something that is causing undefined behavior. There is a very, very small chance that you have encountered a bug in the compiler. And apart from those two reasons, I cannot think of anything else that could be the cause.</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 5, "last_activity_date": 1559077642, "creation_date": 1559077642, "answer_id": 56350073, "question_id": 56348958, "link": "https://stackoverflow.com/questions/56348958/why-does-c-not-decrement-the-stack-pointer-if-a-variable-leaves-the-scope/56350073#56350073", "title": "Why does C not decrement the stack pointer if a variable leaves the scope?", "body": "<p>As a practical matter, when a stack does exist (as Broman's answer points out, there is no requirement for a stack to exist, although there <em>is</em> a requirement to support recursion) compilers will typically generate code that adjusts the stack pointer only once on function entry, and once again on function exit, even if there are sub-scopes within the function that limit individual variables' lifetimes.</p>\n\n<p>This might seem bizarre if you're used to writing assembly language by hand.  The most basic reason for it is, it means each variable that lives on the stack has a \"stack slot\" with a <em>fixed location</em> throughout the entire function, which gives the compiler maximum flexibility in moving machine instructions around for optimization.</p>\n"}], "owner": {"reputation": 163, "user_id": 5526308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2ZWnpfz6p8Q/AAAAAAAAAAI/AAAAAAAAAI4/4-c5eNsV8aQ/photo.jpg?sz=128", "display_name": "Amelia Hartman", "link": "https://stackoverflow.com/users/5526308/amelia-hartman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 56349170, "answer_count": 2, "score": 5, "last_activity_date": 1559078762, "creation_date": 1559071969, "last_edit_date": 1559078762, "question_id": 56348958, "link": "https://stackoverflow.com/questions/56348958/why-does-c-not-decrement-the-stack-pointer-if-a-variable-leaves-the-scope", "title": "Why does C not decrement the stack pointer if a variable leaves the scope?", "body": "<pre><code>#include &lt;stdio.h&gt;\nvoid main() {\n    {\n        int x;\n        printf(\"%p\\n\", &amp;x);\n    }\n    {\n        int x;\n        printf(\"%p\\n\", &amp;x);\n    }\n}\n</code></pre>\n\n<p>I would think running this that it would output the same thing twice. When it declares the first variable, it increments the stack pointer, but then leaves the scope, so it decrements it, and then just repeats the process the second time, so <code>int x</code> would occupy the same memory location on the stack both times.</p>\n\n<p>But this isn't the case. The stack pointer is not decremented and <code>int x</code> in both cases occupy different locations in the stack. In fact, the first <code>int x</code> is still reachable even though its scope is gone.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main() {\n    {\n        int x = 10;\n        printf(\"%p\\n\", &amp;x);\n    }\n    {\n        int x = 25;\n        printf(\"%p\\n\", &amp;x);\n    }\n    {\n        int x = 71;\n        printf(\"%p\\n\", &amp;x);\n\n        int *p = &amp;x;\n        printf(\"%i %i %i\\n\", *(p + 2), *(p + 1), *p);\n    }\n}\n</code></pre>\n\n<p>Why is this? What am I misunderstanding?</p>\n"}]