[{"tags": ["c", "function", "strlen", "strncpy"], "comments": [{"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1537401062, "post_id": 52415533, "comment_id": 91774761, "body": "You have NOT allocated space for &quot;userInput&quot;..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537401839, "post_id": 52415533, "comment_id": 91774889, "body": "<code>strncpy</code> does <b>not</b> NUL-terminate the copy. It os hardly ever what you want, regardless of what you have heard. <code>strncmp</code>, however, is useful for comparing a substring with a target."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 1, "creation_date": 1537401946, "post_id": 52415533, "comment_id": 91774913, "body": "You should look at the man page for &quot;strncpy&quot;... in some cases it does NOT null terminate the destination string."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1537402722, "post_id": 52415533, "comment_id": 91775058, "body": "Additionally, you have NOT completely verified the format of the user-input...  For example, what happens if they enter: Palin(1     This statement will cause the &quot;length&quot; calculated by &quot;stringLength - 8&quot; to go negative:                             strncpy (charsInsideParen, userInput + 6, stringLength - 8);"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1537403075, "post_id": 52415533, "comment_id": 91775133, "body": "<code>sizeof (userInput)</code> in your GetUserInput function is the size of a pointer, probably 4 or 8, not the length of the allocated memory."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1537403212, "post_id": 52415533, "comment_id": 91775159, "body": "Your &quot;fgets()&quot; call is incorrect... you are saying to read for a length of &quot;sizeof(userInput)&quot; which in GetUserInput() is defined as &quot;char *userInput&quot;, which will be 4 or 8 bytes... Perhaps, change the definition of &quot;userInput&quot; in &quot;main()&quot; to be &quot;char userInput[MAX+1]&quot;, and change your fgets to be          &quot;fgets (userInput, MAX, stdin);&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 7, "user_id": 8645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e3284f4090f66e419dc6ba4a1234b?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8645385/matthew"}, "edited": false, "score": 0, "creation_date": 1537410780, "post_id": 52416032, "comment_id": 91776805, "body": "@Matthew - I left a comment in the code for this <code>&#47;&#47;  TODO - error?  No finishing bracket</code>.  Maybe set <code>userInput</code> to an invalid command so it doesn&#39;t do any further processing?"}], "tags": [], "owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "is_accepted": false, "score": 1, "last_activity_date": 1537405796, "last_edit_date": 1537405796, "creation_date": 1537405094, "answer_id": 52416032, "question_id": 52415533, "link": "https://stackoverflow.com/questions/52415533/strlen-not-producing-right-number-and-strncpy-not-working/52416032#52416032", "title": "strlen not producing right number and strncpy not working", "body": "<p>Just to get you on the right track, I cleaned up your code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#define MAX 100\n\nvoid TestIfPalin(char *palindrome)\n{\n    // TODO\n    printf(\"TestIfPalin(%s)\\n\", palindrome);\n}\n\n// Given a user-input string of the form \"Command(argument)\"\n// split the string (by inserting \\0 characters) into two parts\n// and remove the brackets \"()\" from around the argument\nvoid DetermineWhatCommand(char *userInput)\n{\n    // look for the left-most '('\n    char *left_bracket = strchr(userInput, '(');\n    if (left_bracket != NULL)\n    {\n        // Seperate the command-name from the argument\n        *left_bracket = '\\0';\n\n        // Look for the right-most ')' in the input\n        char *right_bracket = strrchr(left_bracket+1, ')');\n        if (right_bracket != NULL)\n            *right_bracket = '\\0';  // remove the right bracket, it's not needed further\n        //else\n        //  TODO - error?  No finishing bracket\n\n        // Find the word passed to the function\n        char *argument = left_bracket+1;\n\n        if (strcmp(userInput,\"Palin\") == 0)\n            TestIfPalin(argument);\n    }\n    else\n    {\n        // No brackets - what sort of command is it?\n        // TODO - error message?\n    }\n }\n\n\nchar *GetUserInput(char *userInput)\n{\n    printf(\"&gt; \");\n    fgets(userInput, MAX, stdin);\n    userInput[strcspn(userInput, \"\\n\")] = '\\0';\n\n    return userInput;\n}\n\n\nint main()\n{\n    char userInput[MAX] = { '\\0' };\n    char exitTest[]     = \"exit\";\n\n    while(strcmp(exitTest, userInput) != 0)\n    {\n        GetUserInput(userInput);\n        if (strcmp(exitTest, userInput) != 0)\n            DetermineWhatCommand(userInput);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Functions should have a single task.  The <code>TestIfPalin()</code> shouldn't be looking for an exit command, nor should <code>getUserInput()</code>.</p>\n\n<p>You were trying to read into a non-existant <code>userInput</code> char*.  Make sure you understand the difference between char-pointers, and char-arrays.  A char-array e.g.:</p>\n\n<pre><code>char userInput[MAX];\n</code></pre>\n\n<p>Has <em>MAX</em> chars of space. Whereas:</p>\n\n<pre><code>char *userInput;\n</code></pre>\n\n<p>Has no space, and is just pointing off to wherever (possibly NULL, but that's not guaranteed).  It needs to point at something to be used.</p>\n\n<pre><code>char *userInput;\nchar buffer[MAX];\n\nstrcpy(buffer, \"bananas\");    // OK\nstrcpy(userInput, \"empty!\");  // FAILS\nuserInput = buffer; // userInput is now pointing at buffer\nstrcpy(userInput, \"empty!\");  // WORKS (overwrites 'bananas')\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e3284f4090f66e419dc6ba4a1234b?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8645385/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1537761678, "creation_date": 1537400182, "last_edit_date": 1537761678, "question_id": 52415533, "link": "https://stackoverflow.com/questions/52415533/strlen-not-producing-right-number-and-strncpy-not-working", "title": "strlen not producing right number and strncpy not working", "body": "<p>I have previously gotten this to work but when I implemented functions my chars have given me a lot of issues. I have also checked if the strlen is displaying the right number, but it is displaying something weird. If I type in a 10 character long char it will give me 73 (its goes up to 7 then restarts the count, so 14 chars will be 77). The first strncpy works but the other doesn't display anything.</p>\n"}, {"tags": ["c", "arrays", "sorting", "sizeof"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1537397223, "post_id": 52415058, "comment_id": 91773993, "body": "<code>sortArray()</code> is accessing outside the array bounds. The array only has 3 elements, but you have <code>n = 5</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1537403761, "post_id": 52415058, "comment_id": 91775288, "body": "however - do not be tempted to use sizeof inside sortArray. There is no way to find out from a passed pointer the size of the array behind it, you have to pass in the size as a parameter or have a sentinel value (-1, 0 9999, ...)"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1537397056, "post_id": 52415093, "comment_id": 91773955, "body": "Note that this only works if the array is <i>not</i> a paramerer to a function.  In that case the array decays to a pointer and <code>sizeof(array)</code> evaluates to the size of a pointer."}, {"owner": {"reputation": 8909, "user_id": 1159604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZNjba.png?s=128&g=1", "display_name": "Foggzie", "link": "https://stackoverflow.com/users/1159604/foggzie"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1537397231, "post_id": 52415093, "comment_id": 91773996, "body": "Thanks @dbush ! Updated the answer with that note"}, {"owner": {"reputation": 17, "user_id": 10388254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462ba9614660abc7396e24ef1cd83719?s=128&d=identicon&r=PG&f=1", "display_name": "cjstineb", "link": "https://stackoverflow.com/users/10388254/cjstineb"}, "edited": false, "score": 1, "creation_date": 1537397783, "post_id": 52415093, "comment_id": 91774129, "body": "Thank you guys! I am new to C, so thanks for helping a newbie out!"}], "tags": [], "owner": {"reputation": 8909, "user_id": 1159604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZNjba.png?s=128&g=1", "display_name": "Foggzie", "link": "https://stackoverflow.com/users/1159604/foggzie"}, "is_accepted": true, "score": 5, "last_activity_date": 1537397640, "last_edit_date": 1537397640, "creation_date": 1537396752, "answer_id": 52415093, "question_id": 52415058, "link": "https://stackoverflow.com/questions/52415058/why-does-sizeof-not-return-the-length-of-an-array/52415093#52415093", "title": "Why does sizeof() not return the length of an array?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Sizeof\" rel=\"nofollow noreferrer\"><code>sizeof</code></a> returns the <em>memory size</em> of what you pass it. The return value is...</p>\n\n<blockquote>\n  <p>measured in the number of char-sized storage units required for the\n  type</p>\n</blockquote>\n\n<p>In a typical 32-bit system, a <code>char</code> is one byte and <code>int</code> is four bytes so you'll get a multiple of four for an array of type <code>int</code>.</p>\n\n<p>If you'd like the <em>length</em> of the array, just divide by the size of the type:</p>\n\n<pre><code>int a[3];\nsize_t n = sizeof(a) / sizeof(a[0]);\n</code></pre>\n\n<p>Note: As <a href=\"https://stackoverflow.com/users/1687119/dbush\"><em>dbush</em></a> mentioned in the comments below:</p>\n\n<blockquote>\n  <p>...this only works if the array is not a paramerer to a\n  function. In that case the array decays to a pointer and sizeof(array)\n  evaluates to the size of a pointer.</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 10388254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462ba9614660abc7396e24ef1cd83719?s=128&d=identicon&r=PG&f=1", "display_name": "cjstineb", "link": "https://stackoverflow.com/users/10388254/cjstineb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52415093, "answer_count": 1, "score": 1, "last_activity_date": 1537403108, "creation_date": 1537396553, "last_edit_date": 1537403108, "question_id": 52415058, "link": "https://stackoverflow.com/questions/52415058/why-does-sizeof-not-return-the-length-of-an-array", "title": "Why does sizeof() not return the length of an array?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int test[3];\n    int i;\n    test[0]=5;\n    test[1]=10;\n    test[2]=7;\n\n    printf(\"array size: %d\\n\",sizeof(test));\n    sortArray(test);\n\n    for(i=0;i&lt;sizeof(test);i++) {\n        printf(\" %d \", test[i]);\n    }\n    printf(\"\\n\");\n}\n\nvoid sortArray(int number[]) {\n    int i,j,a;\n    int n = 5;\n\n    for (i = 0; i &lt; n; i++) {\n        for (j = i + 1; j &lt; n; j++) {\n            if (number[j] &lt; number[i]) {\n                a = number[i];\n                number[i] = number[j];\n                number[j] = a;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The array I am having problems with is \"test\"\nWhen I run the program the \"size\" is always a multiple of 4 of the intended size. ex: test[3] would output a size of 12. What am I doing wrong? I am using code::blocks as an ide also. </p>\n"}, {"tags": ["c", "segmentation-fault", "free"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1537395460, "post_id": 52414866, "comment_id": 91773539, "body": "valgrind should help you. Clearly you have trashed your heap in the <code>other code</code> bits. Or maybe your mallocs fail. At least test for null"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1537395564, "post_id": 52414866, "comment_id": 91773574, "body": "Agreed that the heap has been corrupted somehow, and free() is crashing because it is encountering the corrupted heap metadata.  If valgrind isn&#39;t helping, the other thing you can do is start temporarily #ifdef&#39;ing out various parts of the code and re-running the program to see if the crash goes away.  Eventually you can narrow it down to where the suspect subset of the code is small enough that the bug will become apparent."}, {"owner": {"reputation": 21, "user_id": 10388145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825ba584fb9960018d885caba44af9eb?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.", "link": "https://stackoverflow.com/users/10388145/m-a"}, "edited": false, "score": 0, "creation_date": 1537395641, "post_id": 52414866, "comment_id": 91773591, "body": "Thank you! Could you please tell me how to use valgrind for this. this is the response I get vex x86-&gt;IR: unhandled instruction bytes: 0xC5 0xF8 0x10 0x83 ==7406== valgrind: Unrecognised instruction at address 0x80cf291. ==7406==    at 0x80CF291: tivxBamCreateHandleSingleNode   ==7406== Your program just tried to execute an instruction that Valgrind ==7406== did not recognise."}, {"owner": {"reputation": 21, "user_id": 10388145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825ba584fb9960018d885caba44af9eb?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.", "link": "https://stackoverflow.com/users/10388145/m-a"}, "edited": false, "score": 0, "creation_date": 1537401037, "post_id": 52414866, "comment_id": 91774757, "body": "Thank you Jeremy, your advice worked! Thank you pm100!"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10388145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825ba584fb9960018d885caba44af9eb?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.", "link": "https://stackoverflow.com/users/10388145/m-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1537401371, "creation_date": 1537401371, "answer_id": 52415671, "question_id": 52414866, "link": "https://stackoverflow.com/questions/52414866/segfaults-when-trying-to-free-pointer/52415671#52415671", "title": "Segfaults when trying to free pointer", "body": "<p>the whole issue was, in a malloc I had casted it with a wrong type</p>\n\n<p>for buffers I had malloced it as</p>\n\n<pre><code>buffers  = (int *)malloc(sizeof(int)*node_count);\n</code></pre>\n\n<p>It should have been</p>\n\n<pre><code>buffers  = (buffer *)malloc(sizeof(buffer)*node_count);\n</code></pre>\n\n<p>buffer is a structure type in my code.</p>\n\n<p>It's so weird that it crashed in a way that is impossible to find out based on error messages.</p>\n\n<p>Thank you Jeremy! and pm100</p>\n"}], "owner": {"reputation": 21, "user_id": 10388145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825ba584fb9960018d885caba44af9eb?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.", "link": "https://stackoverflow.com/users/10388145/m-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 52415671, "answer_count": 1, "score": 0, "last_activity_date": 1562167494, "creation_date": 1537395110, "last_edit_date": 1562167494, "question_id": 52414866, "link": "https://stackoverflow.com/questions/52414866/segfaults-when-trying-to-free-pointer", "title": "Segfaults when trying to free pointer", "body": "<p>I have a code like this</p>\n\n<pre><code>void find_groupings ()\n\n  int *bandwidths;\n  int *execution_time;\n\n  bandwidths = (int *)malloc(sizeof(int)*node_count); // node_count is glbl\n  execution_time = (int *)malloc(sizeof(int)*node_count);\n  //other mallocs, other code etc\n\n  while (condition) {\n    // lot of code\n    find_bandwidths(bandwidths);\n    find_execution_time(execution_time);\n    //lot of code\n  }\n\n  free(bandwidths);\n  free(execution_time);\n\n}\n</code></pre>\n\n<p>code segfaults at line  \"free(execution_time);\"</p>\n\n<pre><code>Thread 1 \"vx_tutorial_exe\" received signal SIGSEGV, Segmentation fault.\n0xf7dd0cd9 in _int_free (av=0xf7f15780 &lt;main_arena&gt;, p=&lt;optimized out&gt;, have_lock=0) at malloc.c:4005\n4005    malloc.c: No such file or directory.\n</code></pre>\n\n<p>I can guarantee that \"execution_time\" doesn't go out of bound inside the find_execution_time()\nI believe I free every malloc I do in the code</p>\n\n<p>Also found that pointer value for execution_time is the same just before it crashes at the free() using gdb</p>\n\n<p>tried valgrind but, it doesn't help since the program segfaults</p>\n\n<p>What could be the problem here ?</p>\n"}, {"tags": ["c", "linux", "binary"], "comments": [{"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 1, "creation_date": 1537395071, "post_id": 52414820, "comment_id": 91773424, "body": "For separating the digits shouldn&#39;t you be using <code>10</code> for remainder and division and then using the <code>base</code>? And which part of code is converting it into binary?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1537395113, "post_id": 52414820, "comment_id": 91773434, "body": "By using <code>scanf(&quot;%d&quot;</code> you&#39;ve already converted the user&#39;s input to base 10. You should probably input the user&#39;s number as a string, so you can properly interpret each digit."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1537395250, "post_id": 52414820, "comment_id": 91773479, "body": "The question says <i>&quot;the bases can only range from 2-6&quot;</i>, but in the code <code>MAX_BASE</code> is 16. Which of those is correct?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537398078, "post_id": 52414820, "comment_id": 91774192, "body": "mickeyvolmouse, What do you expect <code>binary = remainder, binary;</code> to do?"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537400040, "post_id": 52414820, "comment_id": 91774559, "body": "@chux how bout that <code>else</code> clause....is OP expecting that to jump back to the <code>if</code> clause 0.o"}], "owner": {"user_type": "does_not_exist", "display_name": "user9587342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537394806, "creation_date": 1537394806, "question_id": 52414820, "link": "https://stackoverflow.com/questions/52414820/any-base-to-binary", "title": "Any Base to Binary", "body": "<p>I am having an issue getting my C program to work. I am trying to take a positive number from the user and a base and convert that into binary. The bases can only range from 2-6. I am having trouble getting the binary value to be correct. I have copied my code below, if you see any errors or know why I am not getting the correct answer please help me.</p>\n\n<pre><code>#define MIN_BASE 2\n#define MAX_BASE 16\n\nint main()\n{\n        //Variale Declarations\n        int num;\n        int base;\n        int binary;\n        int remainder;\n        int i;\n\n        printf(\"Enter a positive number: \");\n        scanf(\"%d\", &amp;num);\n\n        printf(\"Enter a base: \");\n        scanf(\"%d\", &amp;base);\n\n        if (base &gt;= MIN_BASE &amp;&amp;  base &lt;= MAX_BASE) {\n                while( num &gt; 0){\n                        remainder = num % base;\n                        num = num / base;\n                        binary = remainder, binary;\n                }\n        }\n        else {\n\n                while(base &lt; MIN_BASE || base &gt; MAX_BASE){\n                        printf(\"!! The base is invalid!!\\n\");\n                        printf(\"Enter a base: \");\n                        scanf(\"%d\", &amp;base);\n                }\n        }\n        printf(\"%d\\n\", binary);\n\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "math.h"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1537393913, "post_id": 52414646, "comment_id": 91773066, "body": "<code>log</code> is the natural logarithm.  You want <code>log10</code>."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 6, "last_activity_date": 1537393951, "creation_date": 1537393951, "answer_id": 52414678, "question_id": 52414646, "link": "https://stackoverflow.com/questions/52414646/function-log-from-math-h-returns-wrong/52414678#52414678", "title": "Function log from math.h returns wrong", "body": "<p>The <a href=\"https://en.cppreference.com/w/c/numeric/math/log\" rel=\"noreferrer\"><code>log</code></a> function is for the <em>natural</em> logarithm with base <code>e</code>.</p>\n\n<p>It seems you want <a href=\"https://en.cppreference.com/w/c/numeric/math/log10\" rel=\"noreferrer\"><code>log10</code></a> instead.</p>\n"}], "owner": {"reputation": 3, "user_id": 10388096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TnlYwEnBkvs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMQfzIQM_I9_6qqr6aj0U56fjZXzg/mo/photo.jpg?sz=128", "display_name": "San Pippo", "link": "https://stackoverflow.com/users/10388096/san-pippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52414678, "answer_count": 1, "score": 0, "last_activity_date": 1537394174, "creation_date": 1537393805, "last_edit_date": 1537394174, "question_id": 52414646, "link": "https://stackoverflow.com/questions/52414646/function-log-from-math-h-returns-wrong", "title": "Function log from math.h returns wrong", "body": "<p>I was getting wrong values from <code>log()</code>, so I wrote this program just for testing:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\nvoid main()\n{\n  printf (\"%1f\", log(10));\n}\n</code></pre>\n\n<p>This should print \"1\", but I get \"2.302585\"</p>\n\n<p>Why is this and how can I fix it?</p>\n"}, {"tags": ["css", "c", "gtk3"], "comments": [{"owner": {"reputation": 391, "user_id": 109199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d4d090e4a8574c0c8769e23d13e7e?s=128&d=identicon&r=PG", "display_name": "EMon", "link": "https://stackoverflow.com/users/109199/emon"}, "edited": false, "score": 0, "creation_date": 1537401667, "post_id": 52414202, "comment_id": 91774864, "body": "Alternately, if overlay-scrolling is disabled, a way to make the scrollbar extend the complete height of the GtkTreeView, rather than just the content area."}], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 109199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d4d090e4a8574c0c8769e23d13e7e?s=128&d=identicon&r=PG", "display_name": "EMon", "link": "https://stackoverflow.com/users/109199/emon"}, "is_accepted": true, "score": 4, "last_activity_date": 1537764164, "creation_date": 1537764164, "answer_id": 52472809, "question_id": 52414202, "link": "https://stackoverflow.com/questions/52414202/gtkscrolledwindow-how-to-always-show-the-overlay-scrollbar/52472809#52472809", "title": "GtkScrolledWindow - How to always show the overlay scrollbar", "body": "<p>The short answer is that you can't using GtkScrollableWindow as is.</p>\n\n<p>I dug into the <a href=\"https://github.com/GNOME/gtk/blob/master/gtk/gtkscrolledwindow.c\" rel=\"nofollow noreferrer\">source code of the GtkScrollableWindow</a> (search for 'opacity') to confirm that this behavior is baked-in.</p>\n\n<p>This could probably be hacked by sending a periodic \"motion\" signal to the window to trick it into keeping the scrollbar visible (ugly!), or, of course, modifying the GtkScrollableWindow source code.  Less hacky would be to implement my own GtkScrollable, or perhaps by creating a GtkOverlay and putting a GtkScrollbar on top of the GtkScrollableWindow and mapping those scrollbar actions to the window.</p>\n\n<p>This is lower priority for the project, so I may not get the opportunity to take it further, but if any reader is able to chime in with the \"best\" method, it would be appreciated for at least my curiosity :)</p>\n"}], "owner": {"reputation": 391, "user_id": 109199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d4d090e4a8574c0c8769e23d13e7e?s=128&d=identicon&r=PG", "display_name": "EMon", "link": "https://stackoverflow.com/users/109199/emon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 52472809, "answer_count": 1, "score": 2, "last_activity_date": 1537764164, "creation_date": 1537391028, "question_id": 52414202, "link": "https://stackoverflow.com/questions/52414202/gtkscrolledwindow-how-to-always-show-the-overlay-scrollbar", "title": "GtkScrolledWindow - How to always show the overlay scrollbar", "body": "<p>I am working with a GTK3 application that needs always visible, always active scrollbars with visible steppers.  I have been able to achieve this with css:</p>\n\n<pre><code>scrollbar.hover,\nscrollbar {\n    margin-left: 2px;\n    -GtkScrollbar-has-backward-stepper: 1;\n    -GtkScrollbar-has-forward-stepper: 1;\n}\n\nscrollbar trough {\n    min-width: 30px;\n}\n\nscrollbar button {\n    min-height: 30px;\n    min-width: 30px;\n}\n\nscrollbar.right slider {\n    min-height: 70px;\n    min-width: 30px;\n}\n</code></pre>\n\n<p>along with this code:</p>\n\n<pre><code>GtkWidget *sw = gtk_scrolled_window_new(NULL, NULL);\ngtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(sw), GTK_POLICY_NEVER, GTK_POLICY_ALWAYS); //never horizontal, always vertical\ng_object_set(sw, \"overlay-scrolling\", FALSE, NULL);\n</code></pre>\n\n<p><strong>However</strong> setting <code>overlay-scrolling</code> to <code>FALSE</code> means that the scrollbars are off to the side of the GtkScrolledWindow, rather than within it.  This causes layout problems for the application (a legacy application that was ported from an earlier version of gtk).</p>\n\n<p>But, if I enable overlay-scrolling, the scrollbars are hidden after a couple of seconds without motion events to the GtkScolledWindow.</p>\n\n<p>I've been using GtkInspector to mess with anything I can to try and disable hiding the scrollbars, but without success.</p>\n\n<p>A hack would be to set a timer to keep sending motion events to the window to keep the scrollbar from hiding... but that's terribly ugly.</p>\n\n<p>Any advice on where to find the secret sauce to disable overlay scrollbar hiding?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537388234, "post_id": 52413584, "comment_id": 91770921, "body": "If you really don&#39;t know where to start or need guidance and support consider mentoring or coaching try services like <a href=\"https://www.codementor.io\" rel=\"nofollow noreferrer\">Codementor</a>, <a href=\"https://www.savvy.is\" rel=\"nofollow noreferrer\">Savvy</a>, <a href=\"https://hackhands.com\" rel=\"nofollow noreferrer\">Hackhands</a>, or <a href=\"https://www.airpair.com\" rel=\"nofollow noreferrer\">airpair</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1537388925, "post_id": 52413584, "comment_id": 91771210, "body": "There is no need to complicate it with a <code>typedef struct</code> with only one member, when the list head can be (and usually is) a simple pointer to a <code>node</code> type."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1537389489, "post_id": 52413584, "comment_id": 91771450, "body": "Side note: those double quotes are concatenating those 3 strings together (which I think is not your intention). If you want to show a quote, escape it: <code>printf(&quot;please enter the numbers:\\n(to stop enter \\&quot;-1\\&quot;)\\n\\n&quot;);</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1537394956, "post_id": 52413584, "comment_id": 91773393, "body": "While not required, I usually find it helpful to add a <code>_t</code> suffix to the <code>typedef</code> namespace name, e.g. <code>typedef struct node { int data; struct *node next; } node_t;</code> At least in my mind that makes a clear distinction between the <code>struct node</code> and the <code>node_t</code> type. You will also want to visit <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.2.1p1\" rel=\"nofollow noreferrer\">C11 Standard &#167;5.1.2.2.1 Program startup p1 (draft n1570)</a>. See also: <a href=\"http://stackoverflow.com/questions/204476/\">See What should main() return in C and C++?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537389275, "post_id": 52413775, "comment_id": 91771365, "body": "You are over-complicating it. There is no need to write different code when <code>head == NULL</code>. Only the <code>else</code> code block is needed."}, {"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537389460, "post_id": 52413775, "comment_id": 91771440, "body": "@WeatherVane Wouldn&#39;t it make it simple and keep it all in a single loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537389509, "post_id": 52413775, "comment_id": 91771456, "body": "Sorry but the code doesn&#39;t use the <code>typedef</code> for <code>node</code> either."}, {"owner": {"reputation": 45, "user_id": 9230296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJTEt.jpg?s=128&g=1", "display_name": "idan bar", "link": "https://stackoverflow.com/users/9230296/idan-bar"}, "edited": false, "score": 0, "creation_date": 1537391853, "post_id": 52413775, "comment_id": 91772379, "body": "Thanks for the quick answer everyone, i got it now &quot;Observer&quot; really helped me with the detailed code, i went over it and implemented it!! :)"}, {"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "reply_to_user": {"reputation": 45, "user_id": 9230296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJTEt.jpg?s=128&g=1", "display_name": "idan bar", "link": "https://stackoverflow.com/users/9230296/idan-bar"}, "edited": false, "score": 0, "creation_date": 1537392375, "post_id": 52413775, "comment_id": 91772554, "body": "@idanbar Then you would like to go for this: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1537394106, "last_edit_date": 1537394106, "creation_date": 1537389059, "answer_id": 52413775, "question_id": 52413584, "link": "https://stackoverflow.com/questions/52413584/c-linked-list-how-to-assign-and-go-through-the-list/52413775#52413775", "title": "C - Linked List - how to assign and go through the list", "body": "<blockquote>\n  <p>but im having hard time to understand how to go through the list without changing the pointer to the head</p>\n</blockquote>\n\n<p>Head itself would be the <strong>pointer</strong> to the first node.</p>\n\n<blockquote>\n  <p>and after im done with the nodes and assignment how to get the head pointer to point back at the start of the list.</p>\n</blockquote>\n\n<p>You make the new node point to the first node &amp; then shift the pointer pointing to the first node i.e. head to point to the newly added node.</p>\n\n<ul>\n<li><strong>IMPORTANT</strong> - You are missing <code>stdlib.h</code> without which <code>malloc</code> can't be used.</li>\n</ul>\n\n<p>Here is a crude version (just for understanding):</p>\n\n<pre><code> while(/*IF YOU WANT TO ADD NODES?*/)\n {\n       if(head == NULL)\n       {\n           head = malloc((sizeof(struct node));\n           head-&gt;data = //USER INPUT;\n           head-&gt;next=NULL;\n       }\n       else\n       {\n            temp = malloc(sizeof(struct node));\n            temp-&gt;data = //USER INPUT;\n            temp-&gt;next = head;\n            head=temp;\n       }\n }\n</code></pre>\n\n<p>This entire this can be seen in several steps:</p>\n\n<p>First:      <code>head-&gt;[data||NULL]</code></p>\n\n<p>Second:     <code>temp-&gt;[data||Pointer pointing to 1st node]-&gt;(head)[data||NULL]</code></p>\n\n<blockquote>\n  <p>MOVING HEAD TO MAKE IT POINT TO THE NEW 1st NODE</p>\n</blockquote>\n\n<p>Third:      <code>head-&gt;[data||Pointer pointing to Previous 1st node]-&gt;[data||NULL]</code></p>\n\n<p><strong>Isn't it cowardly behaviour to downvote without a valid reason?</strong></p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1537401451, "creation_date": 1537401451, "answer_id": 52415687, "question_id": 52413584, "link": "https://stackoverflow.com/questions/52413584/c-linked-list-how-to-assign-and-go-through-the-list/52415687#52415687", "title": "C - Linked List - how to assign and go through the list", "body": "<p>There are a number of ways to do a linked list, from the mind-numbingly simple <em>add-at-head</em> (which ends up with a list in reverse order) to a fairly standard <em>add-at-tail</em> where you iterate over your nodes to find the end node, and add the new node there. In all cases, it is just a matter of handling your pointers correctly, allocating storage (for both your list parent struct, and each node) and validating all allocations, and then cleaning up after yourself and freeing the used memory when it is no longer needed.</p>\n\n<p>Nested structures where you have a struct holding the <code>head</code> node (and hopefully other useful data to justify the nested approach) are quite common, but there is no need for a parent struct for the list itself. The list address is simply the address of the first node.</p>\n\n<p>When learning lists, it really helps to break the tasks of managing the list down into simple separate functions. This allows you to concentrate (a bit easier) on each list operation singularly. For example, with your list, you will need to:</p>\n\n<ol>\n<li>create/allocate for each node, initialize <code>next</code> pointer <code>NULL</code> and set the <code>data</code> value;</li>\n<li>create/allocate for your list, allocating for <code>head</code> and initializing any additional information contained in the list struct;</li>\n<li>add nodes to your list, creating the list if needed and adding the node setting data to the proper value and updating any list information needed;</li>\n<li>get data out of your list; and</li>\n<li>finally freeing the memory for your nodes and your list when it is no longer needed.</li>\n</ol>\n\n<p>In your case, and continuing from my comment to your question, you can declare your structure and typedefs similar to the following:</p>\n\n<pre><code>typedef struct node {\n    int data;\n    struct node *next;\n} node_t;\n\ntypedef struct list {\n    struct node *head;\n    size_t n;           /* at least make parent hold list size */\n} list_t;\n</code></pre>\n\n<p>Here we a simply added a counter to track the number of nodes in your list as an additional, useful, piece of data to justify the outer stuct. It gives you the node count without having to iterate over the list each time to obtain in (it's just a small efficiency improvement if you need that data). You have the number of nodes in your list with a simple <code>list-&gt;n</code>.</p>\n\n<p>Following our list outline, you need a way to create nodes for your list. Whether it is the first node, or last node, you don't care. When you need a node, your <code>create_node</code> function should handle the allocation/validation and initialization. Nothing fancy is needed, e.g.</p>\n\n<pre><code>/** function to create node and set data value to data.\n *  returns new node on success, NULL otherwise.\n */\nnode_t *create_node (int data)\n{\n    node_t *newnode = malloc (sizeof *newnode);   /* allocate */\n\n    if (newnode == NULL) {  /* validate/handle error */\n        perror (\"create_node() malloc-newnode\");\n        return NULL;\n    }\n\n    newnode-&gt;data = data;   /* initialize members */\n    newnode-&gt;next = NULL;\n\n    return newnode;         /* return pointer to new node */\n}\n</code></pre>\n\n<p>Your <code>create_list</code> function simply needs to allocate for the <code>list</code> struct (and I also have it allocate the first node and initialize the values and pointer <code>0/NULL</code>). You can have it do whatever you like, e.g. add another parameter passing <code>data</code> for the fist node, etc. I simply have it create the list and first node.</p>\n\n<pre><code>/** function to create list and allocates/initilizes head, set list-&gt;n = 0.\n *  returns new list on success, NULL otherwise.\n */\nlist_t *create_list (void)\n{\n    node_t *head = NULL;\n    list_t *list = malloc (sizeof *list);   /* allocate list */\n\n    if (!list) {    /* validate/handle error */\n        perror (\"create_list() malloc-list\");\n        return NULL;\n    }\n\n    head = create_node (0);     /* create the first node */\n\n    if (!head)                  /* validate/handle error */\n        return NULL;\n\n    list-&gt;head = head;          /* initialize list values */\n    list-&gt;n = 0;\n\n    return list;                /* return list */\n}\n</code></pre>\n\n<p>Your <code>add_node</code> function can be fairly simple, but for purposes here, rather than just stopping if the list is not yet allocated, we will have the <code>add_node</code> function create the list if it doesn't exists and then add the node. This choice has important implications. Since I will handle the case where the list doesn't exist, that means the list address may change within the function. To handle this potential, I must pass the <em>address-of</em> the list as a parameter (e.g. <code>list_t **list</code> instead of simply <code>list_t *list</code>). By having the actual address of the pointer, I can change where the original pointer points and that change will be visible back in the calling function (rather changing where a copy of the pointer points which would not be seen back in the caller).</p>\n\n<p>The function needs to handle two cases (1) \"am I the first node?\" and (2) \"if I'm not the first node, then iterate to end and add there\". You can do something similar to:</p>\n\n<pre><code>/** add node to list, create list if list NULL, set node-&gt;data to data.\n *  return new node on success, NULL otherwise.\n */\nnode_t *add_node (list_t **list, int data)\n{\n    node_t *node;\n\n    if (!*list) {   /* handle list doesn't exist */\n        *list = create_list();\n        if (!*list)\n            return NULL;\n\n        node = (*list)-&gt;head;   /* (..)-&gt; required by operator precedence */\n        node-&gt;data = data;\n    }\n    else {  /* list already exists */\n        node = (*list)-&gt;head;               /* set node to list-&gt;head */\n\n        /* iterate over nodes to find last and add node at end */\n        while (node-&gt;next)\n            node = node-&gt;next;\n\n        node-&gt;next = create_node (data);    /* allocate next node */\n        node = node-&gt;next;                  /* change to new node */\n    }\n\n    (*list)-&gt;n++;   /* increment number of nodes in list */\n\n    return node;    /* return node */\n}\n</code></pre>\n\n<p>By doing it this way, I can simply declare the pointer in <code>main()</code> and initialize it <code>NULL</code> and then simply call <code>add_node(&amp;list, x)</code> in <code>main()</code> letting the list functions handle the pointers and allocation.</p>\n\n<p>Your additional list functions are just functions that iterate over each node in the list doing something with the information like printing the list or freeing all the nodes in the list. (pay careful attention to how the <em>node-to-be-freed</em> (e.g. the <code>victim</code>) is handled in the <code>free_list</code> function)</p>\n\n<pre><code>/** print the value of each node in list */\nvoid prn_list (const list_t *list)\n{\n    /* iterate over list printing data value */\n    for (node_t *node = list-&gt;head; node; node = node-&gt;next)\n        printf (\" %d\", node-&gt;data);\n    putchar ('\\n');     /* tidy up with newline */\n}\n\n/** free all nodes in list and free list */\nvoid free_list (list_t *list)\n{\n    node_t *node = list-&gt;head;      /* set node to head */\n\n    while (node) {                  /* iterate over each nod */\n        node_t *victim = node;      /* setting victim to free */\n        node = node-&gt;next;          /* change to next node */\n        free (victim);              /* free victim */\n    }\n\n    free (list);    /* free list */\n}\n</code></pre>\n\n<p>(note the two different examples of iterating over the nodes using either a <code>for</code> or <code>while</code> loop)</p>\n\n<p>Putting all the pieces together, adding <code>25</code> nodes, and printing them out before freeing all memory associated with the list, you could do something like the following:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#if ! defined (_WIN32) &amp;&amp; ! defined (_WIN64)\n #include &lt;stdlib.h&gt;    /* Linux has malloc/free in the stdlib header */\n#endif\n\ntypedef struct node {\n    int data;\n    struct node *next;\n} node_t;\n\ntypedef struct list {\n    struct node *head;\n    size_t n;           /* at least make parent hold list size */\n} list_t;\n\n/** function to create node and set data value to data.\n *  returns new node on success, NULL otherwise.\n */\nnode_t *create_node (int data)\n{\n    node_t *newnode = malloc (sizeof *newnode);   /* allocate */\n\n    if (newnode == NULL) {  /* validate/handle error */\n        perror (\"create_node() malloc-newnode\");\n        return NULL;\n    }\n\n    newnode-&gt;data = data;   /* initialize members */\n    newnode-&gt;next = NULL;\n\n    return newnode;         /* return pointer to new node */\n}\n\n/** function to create list and allocates/initilizes head, set list-&gt;n = 0.\n *  returns new list on success, NULL otherwise.\n */\nlist_t *create_list (void)\n{\n    node_t *head = NULL;\n    list_t *list = malloc (sizeof *list);   /* allocate list */\n\n    if (!list) {    /* validate/handle error */\n        perror (\"create_list() malloc-list\");\n        return NULL;\n    }\n\n    head = create_node (0);     /* create the first node */\n\n    if (!head)                  /* validate/handle error */\n        return NULL;\n\n    list-&gt;head = head;          /* initialize list values */\n    list-&gt;n = 0;\n\n    return list;                /* return list */\n}\n\n/** add node to list, create list if list NULL, set node-&gt;data to data.\n *  return new node on success, NULL otherwise.\n */\nnode_t *add_node (list_t **list, int data)\n{\n    node_t *node;\n\n    if (!*list) {   /* handle list doesn't exist */\n        *list = create_list();\n        if (!*list)\n            return NULL;\n\n        node = (*list)-&gt;head;   /* (..)-&gt; required by operator precedence */\n        node-&gt;data = data;\n    }\n    else {  /* list already exists */\n        node = (*list)-&gt;head;               /* set node to list-&gt;head */\n\n        /* iterate over nodes to find last and add node at end */\n        while (node-&gt;next)\n            node = node-&gt;next;\n\n        node-&gt;next = create_node (data);    /* allocate next node */\n        node = node-&gt;next;                  /* change to new node */\n    }\n\n    (*list)-&gt;n++;   /* increment number of nodes in list */\n\n    return node;    /* return node */\n}\n\n/** print the value of each node in list */\nvoid prn_list (const list_t *list)\n{\n    /* iterate over list printing data value */\n    for (node_t *node = list-&gt;head; node; node = node-&gt;next)\n        printf (\" %d\", node-&gt;data);\n    putchar ('\\n');     /* tidy up with newline */\n}\n\n/** free all nodes in list and free list */\nvoid free_list (list_t *list)\n{\n    node_t *node = list-&gt;head;      /* set node to head */\n\n    while (node) {                  /* iterate over each nod */\n        node_t *victim = node;      /* setting victim to free */\n        node = node-&gt;next;          /* change to next node */\n        free (victim);              /* free victim */\n    }\n\n    free (list);    /* free list */\n}\n\nint main (void)\n{\n    list_t *list = NULL;    /* just declare list and set pointer NULL */\n\n    for (int i = 0; i &lt; 25; i++)                /* add 25 nodes to list */\n        if (add_node (&amp;list, i + 1) == NULL)    /* validate each addition */\n            break;\n\n    /* print list content, beginning with number of nodes in list */\n    printf (\"list contains: %lu nodes\\n\\n\", list-&gt;n);\n    prn_list (list);    /* followed by each node value */\n    free_list (list);   /* and then delete list */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ /bin/llsingle_w_parent\nlist contains: 25 nodes\n\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/llsingle_w_parent\n==14749== Memcheck, a memory error detector\n==14749== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==14749== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==14749== Command: ./bin/llsingle_w_parent\n==14749==\nlist contains: 25 nodes\n\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n==14749==\n==14749== HEAP SUMMARY:\n==14749==     in use at exit: 0 bytes in 0 blocks\n==14749==   total heap usage: 26 allocs, 26 frees, 416 bytes allocated\n==14749==\n==14749== All heap blocks were freed -- no leaks are possible\n==14749==\n==14749== For counts of detected and suppressed errors, rerun with: -v\n==14749== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Linked-lists come in all different implementation. You should be aware of a couple of basic distinctions. You have lists that use dummy-node (e.g. dummy <code>head</code> and <code>tail</code> node that do not hold <code>data</code>, but just point to the first/last node in the list). You have <em>circular-linked-lists</em> where the last node points back to the first node (this allows iterating from any node in the list, to any node in the list in a <em>circular</em> fashion across the start and end). So when you look at \"linked-list\" code, understand that there can be many ways that lists are implemented, all have strengths and weaknesses, so you just have to match your list for the job.</p>\n\n<p>Finally, as specified in the comment, your declaration <code>void main()</code> is incorrect and is an ancient throwback to the early days of windows (like DOS 3.3 and Windows 3.1, Trumpet WinSock, and the Borland Turbo C compiler days) The proper declarations for <code>main</code> are <code>int main (void)</code> and <code>int main (int argc, char **argv)</code> (which you will see written with the equivalent <code>char *argv[]</code>). <strong>note:</strong> <code>main</code> is a function of <code>type int</code> and it returns a value. See: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.2.1p1\" rel=\"nofollow noreferrer\">C11 Standard \u00a75.1.2.2.1 Program startup p1 (draft n1570)</a>. See also: <a href=\"http://stackoverflow.com/questions/204476/\">See What should main() return in C and C++?</a></p>\n\n<p>(note: there are some embedded systems that continue to use <code>void main()</code>, but those are the exceptions, not the rule, and are non-compliant with the C-Standard)</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 45, "user_id": 9230296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJTEt.jpg?s=128&g=1", "display_name": "idan bar", "link": "https://stackoverflow.com/users/9230296/idan-bar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2887, "favorite_count": 0, "accepted_answer_id": 52415687, "answer_count": 2, "score": 0, "last_activity_date": 1537401451, "creation_date": 1537388148, "question_id": 52413584, "link": "https://stackoverflow.com/questions/52413584/c-linked-list-how-to-assign-and-go-through-the-list", "title": "C - Linked List - how to assign and go through the list", "body": "<p>i'm having trouble with building a linked list using two structs\nnode - contains data and pointer to the next, and list which contains pointer to the head of the list.</p>\n\n<p>i managed to implement it with only the node struct.</p>\n\n<p>i have initialized a struct of a list in the main function\nthan allocated memory for a list struct using malloc\nthan i allocated memory for the head which is a pointer to the first node</p>\n\n<p>sent it to another function where there the input,allocating,assigning goes,\nbut im having hard time to understand how to go through the list without changing the pointer to the head.</p>\n\n<p>and after im done with the nodes and assignment how to get the head pointer to\npoint back at the start of the list.</p>\n\n<p>should i work with copies? (node *temp) ??</p>\n\n<p>thanks everyone!</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n\ntypedef struct node\n{\n    int data;\n    struct node *next;\n}node;\n\ntypedef struct list\n{\n    struct node *head;\n}list;\n\nvoid main()\n{\n    list *list_a;\n    list_a = (list*)malloc(sizeof(list));\n    list_a-&gt;head = (node*)malloc(sizeof(node));\n\n    assignment(list_a);\n}\nvoid assignment(list *list_a)\n{\n    int data;\n\n    printf(\"please enter the numbers:\\n(to stop enter \"\"-1\"\")\\n\\n\");\n    scanf(\"%d\", &amp;data);\n\n    while (data != -1)\n    {\n        list_a-&gt;head-&gt;data = data;\n        list_a-&gt;head-&gt;next = (node*)malloc(sizeof(node));\n        list_a-&gt;head = list_a-&gt;head-&gt;next;\n\n        printf(\"enter a number:\\n\");\n        scanf(\"%d\", &amp;data);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "string", "function"], "comments": [{"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 5, "creation_date": 1537387370, "post_id": 52413358, "comment_id": 91770593, "body": "Using <code>new</code> in <code>C</code> instead of <code>C++</code>?"}, {"owner": {"reputation": 7, "user_id": 8645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e3284f4090f66e419dc6ba4a1234b?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8645385/matthew"}, "reply_to_user": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1537388187, "post_id": 52413358, "comment_id": 91770902, "body": "Yea thanks for the reminder, haven&#39;t used C in years."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537393292, "post_id": 52413358, "comment_id": 91772867, "body": "Tempting to close it as a duplicate of <a href=\"https://stackoverflow.com/questions/4570366/\">How to access a local variable from a different function using pointers?</a>, which is even tagged with C++ (as well as C)."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1537387596, "post_id": 52413416, "comment_id": 91770686, "body": "I think &quot;ends it&#39;s lifetime&quot; is better phrasing that &quot;goes out of scope&quot; because scope is static."}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": true, "score": 3, "last_activity_date": 1537387348, "creation_date": 1537387348, "answer_id": 52413416, "question_id": 52413358, "link": "https://stackoverflow.com/questions/52413358/passing-a-variable-to-one-function-to-another/52413416#52413416", "title": "Passing a variable to one function to another", "body": "<p>This</p>\n\n<pre><code>   char userInput[MAX];\n</code></pre>\n\n<p>Is on the stack - so goes out of scope when the function returns.</p>\n\n<p>Either, pass it in as a parameter or use <code>malloc</code> to bung it on the heap.</p>\n\n<p>BTW: <code>new</code> is C++ - If using C++ tag the question as so and use <code>std::string</code></p>\n\n<p>Also <code>printf(userInput);</code> is invariably wrong</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1537388255, "creation_date": 1537388255, "answer_id": 52413619, "question_id": 52413358, "link": "https://stackoverflow.com/questions/52413358/passing-a-variable-to-one-function-to-another/52413619#52413619", "title": "Passing a variable to one function to another", "body": "<p>When you use memory <strong>dynamically</strong> then it belong to the entire program rather than the scope where it has been defined.</p>\n\n<p>In the OP's code the memory is free once control goes out of the scope of the function in which memory is being allocated \"statically\" i.e. scope of function <em>GetUserInput</em>.</p>\n\n<p>Since this question has been tagged with label <strong>C</strong> despite <code>new</code> being used in it, I would be presenting your <strong>C</strong> version:</p>\n\n<pre><code>  char * GetUserInput()\n  {\n       char *userInput = malloc(MAX);\n       //YOUR FUNCTIONALITY..........\n\n       return userInput;\n  } \n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e3284f4090f66e419dc6ba4a1234b?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8645385/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52413416, "answer_count": 2, "score": 0, "last_activity_date": 1537388255, "creation_date": 1537387049, "last_edit_date": 1537387234, "question_id": 52413358, "link": "https://stackoverflow.com/questions/52413358/passing-a-variable-to-one-function-to-another", "title": "Passing a variable to one function to another", "body": "<p>Im trying to get <strong>userInput</strong> from one function than use it in another. When I test to see if the <strong>char</strong> is working in the <strong>DetermineWhatCommand</strong> function the first time I type characters I get the wrong output but after that the next entered string appears correctly.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#define MAX 100\n\n\n\n\nchar * GetUserInput(){\n  char userInput[MAX];\n  fgets(userInput, sizeof (userInput), stdin);\n  userInput[strcspn(userInput, \"\\n\")] = '\\0';\n\n   return userInput;\n}\n\nvoid DetermineWhatCommand(char *userInput){\n  printf(userInput);\n\n}\n\n\nint main() {\n\n    char * userInput;\n    userInput = new char[MAX];\n    char exitTest[] = \"exit\";\n\n    while(strcmp(exitTest, userInput) != 0){\n        userInput = GetUserInput();\n        DetermineWhatCommand(userInput);\n\n   }\n   return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Hello    //First string entered\n@        //What the output in the function looks like\nHello    //Second string entered\nHello    //What the output in the function looks like \n</code></pre>\n"}, {"tags": ["c", "sockets", "network-programming", "ip-address"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1537384630, "post_id": 52412757, "comment_id": 91769272, "body": "<a href=\"http://man7.org/linux/man-pages/man2/accept.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/accept.2.html</a> <code>The argument addr is a pointer to a sockaddr structure.  This        structure is filled in with the address of the peer socket</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1537384716, "post_id": 52412757, "comment_id": 91769306, "body": "I think he wants the local address that they connected to, not the address of the client."}, {"owner": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1537392212, "post_id": 52412757, "comment_id": 91772502, "body": "I can confirm @Barmar interpretation."}], "answers": [{"comments": [{"owner": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "edited": false, "score": 0, "creation_date": 1537392252, "post_id": 52412853, "comment_id": 91772514, "body": "I tried to follow your advice, but I get always the INADDR_ANY (0.0.0.0) address (see my edit to the question)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "edited": false, "score": 0, "creation_date": 1537392327, "post_id": 52412853, "comment_id": 91772538, "body": "You should be calling it on <code>newsockfd</code>, not <code>sockfd</code>."}, {"owner": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "edited": false, "score": 0, "creation_date": 1537392602, "post_id": 52412853, "comment_id": 91772629, "body": "Of course, my bad! Answer accepted. Can You explain why the Port No is always 8726 (instead of the expected 5666)? This happens also with <code>newsocket</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "edited": false, "score": 1, "creation_date": 1537392754, "post_id": 52412853, "comment_id": 91772685, "body": "You know how you have to call <code>htons()</code> when assigning to <code>sin_port</code>? You need to call <code>ntohs()</code> when reading it to reverse the process."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "edited": false, "score": 1, "creation_date": 1537392827, "post_id": 52412853, "comment_id": 91772707, "body": "5666 is 0x1622, 8726 is 0x2216 -- notice the relationship?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1537404891, "post_id": 52412853, "comment_id": 91775515, "body": "&quot;<i>Linux has an extension that allows you to ... get the destination address of the packet</i>&quot; - Windows has a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms741687(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>WSARecvMsg()</code></a> function which supports a similar <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winsock/ip-pktinfo\" rel=\"nofollow noreferrer\"><code>IP_PKTINFO</code> socket option</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1537420528, "post_id": 52412853, "comment_id": 91779098, "body": "@RemyLebeau That requires using winsock, not regular sockets, right?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1537425566, "post_id": 52412853, "comment_id": 91781167, "body": "@Barmar They are the same thing. Winsock is the official socket library on Windows. It supports the usual BSD-style sockets that most platforms support, as well as its own WSA extensions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1537455528, "post_id": 52412853, "comment_id": 91799401, "body": "Thanks for the clarification, I&#39;ve updated the answer."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1537455440, "last_edit_date": 1537455440, "creation_date": 1537384648, "answer_id": 52412853, "question_id": 52412757, "link": "https://stackoverflow.com/questions/52412757/how-to-get-the-ip-address-used-to-connect-to-my-server/52412853#52412853", "title": "How to get the IP address used to connect to my server?", "body": "<p>If you're using a <code>SOCK_STREAM</code> socket (i.e. TCP), not <code>SOCK_DGRAM</code> (i.e. UDP), call <a href=\"http://man7.org/linux/man-pages/man2/getsockname.2.html\" rel=\"nofollow noreferrer\"><code>getsockname()</code></a> on the socket returned by <code>accept()</code>.</p>\n\n<p>If you're using a datagram socket, I don't think there's a portable way to do it with a single socket. The traditional solution is to bind a separate socket for each local address, rather than using <code>INADDR_ANY</code>, and wait for a message on all of them using <code>epoll()</code> or <code>select()</code>. You can tell which address they connected to based on which socket the message was received on.</p>\n\n<p>Linux and Windows have an extension that allows you to do this more easily, by setting the <code>IP_PKTINFO</code> option on the socket and using <code>recvmsg()</code> to receive a packet. In the <code>msgheader.msg_control</code> you can get the destination address of the packet. See <a href=\"https://stackoverflow.com/questions/5281409/get-destination-address-of-a-received-udp-packet\">Get destination address of a received UDP packet</a></p>\n"}], "owner": {"reputation": 1812, "user_id": 1714490, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DPfJX.png?s=128&g=1", "display_name": "ZioByte", "link": "https://stackoverflow.com/users/1714490/ziobyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 52412853, "answer_count": 1, "score": 0, "last_activity_date": 1537455440, "creation_date": 1537384265, "last_edit_date": 1537392740, "question_id": 52412757, "link": "https://stackoverflow.com/questions/52412757/how-to-get-the-ip-address-used-to-connect-to-my-server", "title": "How to get the IP address used to connect to my server?", "body": "<p>I have a server listening on multiple devices (LAN, WiFi and, possibly, some VPNs).</p>\n\n<p>Listening binds a socket (AF_INET) binds INADDR_ANY to be exposed on all interfaces.</p>\n\n<p>A client then connects and interchange starts.</p>\n\n<p>At this point, how can I get information about which device was used for connection?</p>\n\n<p>Equivalently: how can I get the IP address client used to connect?</p>\n\n<p><strong>EDIT:</strong>\nFollowing @Barmar advice I tried the following:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;sys/un.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define handle_error(msg) \\\n        do { perror(msg); exit(EXIT_FAILURE); } while (0)\n\nvoid error(char *msg)\n{\n    perror(msg);\n    exit(1);\n}\n\nint main(int argc, char *argv[])\n{\n    int sockfd, newsockfd, portno;\n    unsigned clilen;\n    struct sockaddr_in serv_addr, cli_addr;\n    struct sockaddr_in myaddr;\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd &lt; 0)\n        error(\"ERROR creating socket\");\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n    portno = 5666;\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    serv_addr.sin_port = htons(portno);\n    if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n        error(\"ERROR on binding\");\n    listen(sockfd, 5);\n    clilen = sizeof(cli_addr);\n    newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n    if (newsockfd &lt; 0)\n        error(\"ERROR on accept\");\n\n    clilen = sizeof(myaddr);\n    if (getsockname(newsockfd, (struct sockaddr *)&amp;myaddr, &amp;clilen))\n        error(\"ERROR in getsockname\");\n\n    unsigned int i = myaddr.sin_addr.s_addr;\n    int p = myaddr.sin_port;\n    int a = i &amp; 0xff;\n    i &gt;&gt;= 8;\n    int b = i &amp; 0xff;\n    i &gt;&gt;= 8;\n    int c = i &amp; 0xff;\n    i &gt;&gt;= 8;\n    int d = i &amp; 0xff;\n    printf(\"my address is: %d.%d.%d.%d:%d\\n\", a, b,c, d, p);\n\n    return 0;\n}\n</code></pre>\n\n<p>... and (after a bit of debugging) it works.</p>\n\n<p>Note that Port is not the value expected (5666) but consistently 8726.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1537380980, "post_id": 52411911, "comment_id": 91767603, "body": "That smells like an ODR violation or something. You&#39;re trying to do generics/templates, which C doesn&#39;t do well."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 1, "creation_date": 1537381093, "post_id": 52411911, "comment_id": 91767654, "body": "Not clear what exactly you are asking... What were you expecting and what do you get? What do you mean by: &quot;The SqStack changed in the debugger only int ord is affected.&quot; (maybe a comma is missing somewhere?)?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1537381164, "post_id": 52411911, "comment_id": 91767684, "body": "The only &quot;generic&quot; type in C is the pointer to anything <code>void *</code>. Perhaps you can solve your problem using <code>void *</code> (and type-casts as needed)?"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1537381402, "post_id": 52411911, "comment_id": 91767813, "body": "Building on what @Someprogrammerdude said, if you want to write some stack code that will work for different types of objects, you might be best off storing a <code>void*</code> inside the stack. You can then create a stack for integers, a stack of structures, and so on. This is quite risky, as there&#39;s nothing to stop you pushing a string onto a stack of ints, or a struct onto a stack of floats. But it will let you re-use your stack code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10112804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DcmbQE6xMOE/AAAAAAAAAAI/AAAAAAAAAA4/_xusS_8wkQg/photo.jpg?sz=128", "display_name": "Evilolipop", "link": "https://stackoverflow.com/users/10112804/evilolipop"}, "edited": false, "score": 0, "creation_date": 1537423447, "post_id": 52412025, "comment_id": 91780231, "body": "So my understand is that it ignores the code inside #ifndef and paste the rests into Maze.h. However when complie StackSe.c the code inside #ifndef is not ignored. It is right?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 11, "user_id": 10112804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DcmbQE6xMOE/AAAAAAAAAAI/AAAAAAAAAA4/_xusS_8wkQg/photo.jpg?sz=128", "display_name": "Evilolipop", "link": "https://stackoverflow.com/users/10112804/evilolipop"}, "edited": false, "score": 0, "creation_date": 1537425005, "post_id": 52412025, "comment_id": 91780917, "body": "Yep, though I woudln&#39;t say &quot;ignores&quot;. The preprocessor either leaves in or removes the source code inside <code>#if...#else...#endif</code> blocks based on the condition, when it produces the actual source code which gets fed to the C compilation phase. Preprosessing phase is basically text manipulation, which happens before actual compilation phase. Compilers have switches to just do the preprosessing stage or produce the intermediate temp files, which can be helpful in solving some bugs."}], "tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": false, "score": 2, "last_activity_date": 1537381647, "last_edit_date": 1537381647, "creation_date": 1537381303, "answer_id": 52412025, "question_id": 52411911, "link": "https://stackoverflow.com/questions/52411911/different-typedef-of-the-same-struct-in-c/52412025#52412025", "title": "different typedef of the same struct in c", "body": "<p>In C (and C++), <code>#include</code> is very primitive mechanism, it is just \"copy-paste\" of the text in the included file, before actual compilation.</p>\n\n<p>So, what happens here is, you compile your <em>SequenceStack.c</em> with the <code>int*</code> pointers. The code in the functions uses that type.</p>\n\n<p>Then you pass these functions parameters, which don't match that. So it's no wonder things don't work right.</p>\n\n<p>If you want \"generic\" stack with pointers, I suggest you use <code>void*</code> pointers to the elements in <em>SequenceStack</em>. Depending on your full code, such as you need to copy/reallocate elements, you may have to add size of element to <code>SqStack</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10112804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DcmbQE6xMOE/AAAAAAAAAAI/AAAAAAAAAA4/_xusS_8wkQg/photo.jpg?sz=128", "display_name": "Evilolipop", "link": "https://stackoverflow.com/users/10112804/evilolipop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537381647, "creation_date": 1537380725, "question_id": 52411911, "link": "https://stackoverflow.com/questions/52411911/different-typedef-of-the-same-struct-in-c", "title": "different typedef of the same struct in c", "body": "<p>In SequenceStack.h, I have the following code</p>\n\n<pre><code>#ifndef SEQUENCESTACK_H\n#define SEQUENCESTACK_H\n\n#ifndef DATASTRUCTURE_MAZE_H\ntypedef int SElemType_Sq;\n#endif\n\ntypedef struct {\n    SElemType_Sq *base;\n    SElemType_Sq *top;\n    int stacksize;\n}SqStack;\n</code></pre>\n\n<p>In SequenceStack.c, I have</p>\n\n<pre><code>#include \"SequenceStack.h\"\n</code></pre>\n\n<p>which defines a stack.</p>\n\n<p>In an other program which I want to use the stack but I want to change the elemtype.</p>\n\n<p>So in Maze.h I have</p>\n\n<pre><code>#ifndef DATASTRUCTURE_MAZE_H\n#define DATASTRUCTURE_MAZE_H\n\ntypedef struct {\n    int x;\n    int y;\n}PosType;\n\ntypedef struct {\n    int ord;\n    PosType seat;\n    int di;\n}SElemType_Sq;\n\n#include \"SequenceStack.h\"\n</code></pre>\n\n<p>The SqStack changed in the debugger only int ord is affected.</p>\n\n<p>If I change SequenceStack.h to </p>\n\n<pre><code>#ifndef SEQUENCESTACK_H\n#define SEQUENCESTACK_H\n\ntypedef struct {\n    int x;\n    int y;\n}PosType;\n\ntypedef struct {\n    int ord;\n    PosType seat;\n    int di;\n}SElemType_Sq;\n\ntypedef struct {\n    SElemType_Sq *base;\n    SElemType_Sq *top;\n    int stacksize;\n}SqStack;\n</code></pre>\n\n<p>and put nothing in Maze.h, everything works fine.</p>\n\n<p>I want to know what is going wrong and why #ifndef is not working. I can give the source code.</p>\n"}, {"tags": ["c", "sockets", "ioctl"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1537380972, "post_id": 52411800, "comment_id": 91767599, "body": "What is <code>SIOCSPARAM</code> ? Does the call fail on <code>ioctl</code> or on <code>socket</code>? The line it&#39;s   just CW_LOG_ERR function printin it. EFAULT is a strange errno to get, did you clear errno before calling <code>wlan_config_vap_priv</code>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1537381198, "post_id": 52411800, "comment_id": 91767699, "body": "Using <code>strncpy(str, str2, sizeof(str))</code> is bad practice, in case <code>strlen(str2) == sizeof(str)</code> string will be not null terminated. Use <code>strscpy</code>."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1537381207, "post_id": 52411800, "comment_id": 91767705, "body": "I can&#39;t find any mention of <code>SIOCSPARAM</code>, either on Google, in man pages, in the Linux kernel source, or in C headers ..."}, {"owner": {"reputation": 2797, "user_id": 3808877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jWfYi.png?s=128&g=1", "display_name": "Jobs", "link": "https://stackoverflow.com/users/3808877/jobs"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1537381335, "post_id": 52411800, "comment_id": 91767775, "body": "I implemented SIOCSPARAM myself, so it&#39;s not a standard ioctl. @o11c"}, {"owner": {"reputation": 2797, "user_id": 3808877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jWfYi.png?s=128&g=1", "display_name": "Jobs", "link": "https://stackoverflow.com/users/3808877/jobs"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537381439, "post_id": 52411800, "comment_id": 91767831, "body": "@KamilCuk you are saying I should use sizeof(str2) instead?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537381652, "post_id": 52411800, "comment_id": 91767929, "body": "I say you shouldn&#39;t expect a null terminated string after using <code>strncpy</code> function, no matter what you use with it. If you expect strings to be null terminated, use <code>strscpy</code>. Forget about <code>strncpy</code>.     Does the negative value returned by <code>wlan_config_vap_priv</code> is returned by ioctl call or by socket call? &quot;How&quot; did you implemented ioctl call? How is SIOCSPARAM defined? What kind of system/environment is this?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1537382571, "post_id": 52411800, "comment_id": 91768337, "body": "&quot;I implemented SIOCSPARAM myself&quot;. Only you can tell why your ioctl returns an error then."}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 2, "creation_date": 1537383470, "post_id": 52411800, "comment_id": 91768750, "body": "Please include your kernel part for <code>SIOCSPARAM</code>. Otherwise this question does not provide enough information."}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537385548, "post_id": 52411800, "comment_id": 91769718, "body": "@KamilCuk <code>strscpy</code> is for Kernel. This seems like user-space code."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1537386854, "post_id": 52411800, "comment_id": 91770356, "body": "<code>strscpy</code> is not a standard C library function.  It&#39;s probably better to just learn how to use <code>strncpy</code> the right way."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1537387043, "post_id": 52411800, "comment_id": 91770451, "body": "Two functions with no information on what you pass to them, what your environment and hardware are, what your custom parts are, etc. - do not a question make. There is no point in speculating from such incomplete data."}], "answers": [{"tags": [], "owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "is_accepted": false, "score": 0, "last_activity_date": 1537385439, "last_edit_date": 1537385439, "creation_date": 1537383614, "answer_id": 52412593, "question_id": 52411800, "link": "https://stackoverflow.com/questions/52411800/call-to-ioctl-results-in-errno-indicating-bad-address/52412593#52412593", "title": "Call to ioctl() results in errno indicating &quot;Bad address&quot;", "body": "<p>Your information is incomplete because you do not have the Kernel part for <code>SIOCSPARAM</code>.</p>\n\n<p>However according to <a href=\"http://man7.org/linux/man-pages/man2/ioctl.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/ioctl.2.html</a>, this error happens when <em>argp</em> references an inaccessible memory area</p>\n\n<blockquote>\n  <p>EFAULT <em>argp</em> references an inaccessible memory area.</p>\n</blockquote>\n\n<p>Your source strings do not have size attached to them. Using <code>strncpy</code> on this string is unsafe and could be the culprit. You can try using something like <code>snprintf</code>.</p>\n"}], "owner": {"reputation": 2797, "user_id": 3808877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jWfYi.png?s=128&g=1", "display_name": "Jobs", "link": "https://stackoverflow.com/users/3808877/jobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537385439, "creation_date": 1537380336, "last_edit_date": 1537384412, "question_id": 52411800, "link": "https://stackoverflow.com/questions/52411800/call-to-ioctl-results-in-errno-indicating-bad-address", "title": "Call to ioctl() results in errno indicating &quot;Bad address&quot;", "body": "<p>I'm getting the following error:</p>\n\n<pre><code>wlan_config_vap_priv_int vap lan0 cmd cpauth val 0(0) error: Bad address\n</code></pre>\n\n<p>Which is from the print in wlan_config_vap_priv_int. Does anyone know what might be causing the \"Bad address\" error?</p>\n\n<p>From <a href=\"https://stackoverflow.com/questions/15769770/why-does-ioctl-return-bad-address\">why does ioctl return &quot;bad address&quot;</a> I suspect the culprit may be the ioctl call, but I don't see why.</p>\n\n<pre><code>int wlan_config_vap_priv(char *vap, char *cmd, char * val) {\n    int fd, ret;\n    struct ifreq ifr;\n    param_t fp;\n\n    strncpy(ifr.ifr_name, vap, IFNAMSIZ);\n    strncpy(fp.cmd, cmd, sizeof(fp.cmd));\n    strncpy(fp.val, val, sizeof(fp.val));\n    ifr.ifr_data = (void *) &amp;fp;\n    printf(\"%s:%d: config vap %s priv %s=%s\\n\", __func__, __LINE__, vap, cmd, val);\n    if((fd = socket(AF_INET, SOCK_DGRAM, 0)) &lt; 0) {\n        perror(\"socket\");\n        return -1;\n    }\n    ret = ioctl(fd, SIOCSPARAM, &amp;ifr);\n    close(fd);\n    return (ret);\n}\n\nint wlan_config_vap_priv_int(uint8_t rId, char *vap, char *cmd, int val) {\n\n    char buf[32];\n    int ret;\n\n    snprintf(buf, sizeof(buf), \"%d\", val);\n    ret = wlan_config_vap_priv(vap, cmd, buf);\n    if (ret &lt; 0) {\n        CW_LOG_ERR(\"%s vap %s cmd %s val %s(%d) error: %s\\n\",\n                    __FUNCTION__, vap, cmd, buf, val, strerror(errno));\n    }\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1584654973, "post_id": 52411743, "comment_id": 107511046, "body": "Why the edit 1.5 years later? Are none of the answers sufficient? A binary file has no concept of a &quot;Line&quot; as explained by @someprogrammerdude. Do you still have questions about that? Also, no reason to pass the <i>address of</i> <code>fp</code> in <code>push(&amp;head, &amp;fp);</code>"}, {"owner": {"reputation": 23, "user_id": 8780594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNOGf.jpg?s=128&g=1", "display_name": "P.H. Me", "link": "https://stackoverflow.com/users/8780594/p-h-me"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1584718171, "post_id": 52411743, "comment_id": 107530590, "body": "No, I don&#39;t have a question about this anymore. The reason I edited the question was because the original question contained too much information and by editing it I was hoping it would be of better help to others."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8780594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNOGf.jpg?s=128&g=1", "display_name": "P.H. Me", "link": "https://stackoverflow.com/users/8780594/p-h-me"}, "edited": false, "score": 0, "creation_date": 1537384139, "post_id": 52412115, "comment_id": 91769051, "body": "The description of my assignment says that the program should output the content of the file to the standard output AND that it must work correctly with files containing binary contents. So how would I have to go about this?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 23, "user_id": 8780594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNOGf.jpg?s=128&g=1", "display_name": "P.H. Me", "link": "https://stackoverflow.com/users/8780594/p-h-me"}, "edited": false, "score": 0, "creation_date": 1537385358, "post_id": 52412115, "comment_id": 91769616, "body": "@P.H.Me Like I said, read from your file (opened in binary mode) using <code>fread</code>, write to <code>stdout</code> with <code>fwrite</code>. Don&#39;t forget to check the return values of those functions, and not write more than you read."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1537381630, "creation_date": 1537381630, "answer_id": 52412115, "question_id": 52411743, "link": "https://stackoverflow.com/questions/52411743/how-can-i-read-any-file-into-a-linked-list/52412115#52412115", "title": "How can I read any file into a linked list?", "body": "<p>Random binary data can contain characters that are not printable. Or might contain zeroes, which is the string terminator and thus terminate your strings early. Just don't read and write raw binary data as strings or using string functions, it will simply not work as you expect.</p>\n\n<p>If you want to read and write arbitrary data of any kind, use e.g. <a href=\"https://en.cppreference.com/w/c/io/fread\" rel=\"nofollow noreferrer\"><code>fread</code></a> and <a href=\"https://en.cppreference.com/w/c/io/fwrite\" rel=\"nofollow noreferrer\"><code>fwrite</code></a> instead, and open your files in binary mode.</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1537392278, "creation_date": 1537392278, "answer_id": 52414396, "question_id": 52411743, "link": "https://stackoverflow.com/questions/52411743/how-can-i-read-any-file-into-a-linked-list/52414396#52414396", "title": "How can I read any file into a linked list?", "body": "<p>Since you are using Linux, you can use POSIX.1 <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> to read lines, including lines with embedded NUL bytes; you do need to write those lines using <code>fwrite()</code>.</p>\n\n<p>For the linked list, you should include a length field for <code>fwrite()</code>. I'd also make the linked list data element a flexible array member:</p>\n\n<pre><code>struct node {\n    struct node *next;\n    size_t       size;\n    char         data[];\n    /* Note: data[size+1], data[size] == '\\0'.\n             This is not necessary for correct operation,\n             but allows one to assume there is always at\n             least one char in data, and the data is followed\n             by a nul byte. It makes further use of this\n             structure easier. */\n};\n\nstruct node *node_new(const char *data, size_t size)\n{\n    struct node *n;\n\n    n = malloc(sizeof (struct node) + size + 1);\n    if (!n) {\n        fprintf(stderr, \"node_new(): Out of memory.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    n-&gt;next = NULL;\n    n-&gt;size = size;\n    if (size &gt; 0)\n        memcpy(n-&gt;data, data, size);\n    n-&gt;data[size] = '\\0';\n\n    return n;\n}\n</code></pre>\n\n<p>When reading lines, it is easiest to prepend the lines to the list:</p>\n\n<pre><code>struct node *list = NULL;\nstruct node *curr;\n\nchar   *line = NULL;\nsize_t  size = 0;\nssize_t len;\n\nwhile (1) {\n    len = getline(&amp;line, &amp;size, stdin);\n    if (len &lt; 0)\n        break;\n\n    curr = node_new(line, (size_t)len);\n\n    curr-&gt;next = list;\n    list = curr;\n}\n\nlist = list_reverse(list);\n</code></pre>\n\n<p>When done, you reverse the list, to get the first read line at the beginning of the list:</p>\n\n<pre><code>struct node *list_reverse(struct node *curr)\n{\n    struct node *root = NULL;\n    struct node *next;\n\n    while (curr) {\n        next = curr-&gt;next;\n\n        curr-&gt;next = root;\n        root = curr;\n\n        curr = next;\n    }\n\n    return root;\n}\n</code></pre>\n\n<p>To write each line to a stream, you use for example <code>fwrite(node-&gt;data, node-&gt;size, 1, stdout)</code>.</p>\n\n<p>If the output stream is not a local file, but a pipe or socket, <code>fwrite()</code> can return a short count. It is not an error; it only means that only part of the data could be written. To cater for those cases, you can use two helper functions: one to ensure all of the data is written, even when writing to a pipe, and another to scan through the list, using the first one to output each line:</p>\n\n<pre><code>static int fwriteall(const char *data, size_t size, FILE *out)\n{\n    size_t  n;\n\n    while (size &gt; 0) {\n        n = fwrite(data, 1, size, out);\n        if (n &gt; 0) {\n            data += n;\n            size -= n;\n        } else\n            return -1; /* Error */\n    }\n\n    return 0; /* Success */\n}\n\nint list_writeall(FILE *out, struct node *list)\n{\n    for (; list != NULL; list = list-&gt;next)\n        if (list-&gt;size &gt; 0)\n            if (fwriteall(list-&gt;data, list-&gt;size, out)\n                return -1; /* Error */\n    return 0; /* Success */\n}\n</code></pre>\n\n<hr>\n\n<p>Instead of <code>getline()</code>, you can read chunks of some predefined size using <code>fread()</code>:</p>\n\n<pre><code>struct node *read_all(FILE *in, const size_t size)\n{\n    struct node *list = NULL;\n    struct node *curr;\n    size_t       used;\n\n    while (1) {\n        curr = malloc(sizeof (struct node) + size + 1);\n        if (!curr) {\n            fprintf(stderr, \"read_all(): Out of memory.\\n\");\n            exit(EXIT_FAILURE);\n        }\n\n        size = fread(curr-&gt;data, 1, size, in);\n        if (used &gt; 0) {\n            /* Optional: Optimize memory use. */\n            if (used != size) {\n                void *temp;\n                temp = realloc(curr, sizeof (struct node) + used + 1);\n                /* Reallocation failure is not fatal. */\n                if (temp) {\n                    curr = temp;\n                    curr-&gt;size = used;\n                }\n            }\n        }\n        curr-&gt;data[used] = '\\0';\n\n        curr-&gt;next = list;\n        list = curr;\n    }\n\n    return list_reverse(list);\n}\n</code></pre>\n\n<p>The function returns the reversed list (i.e., with first line first in list). After calling the function, you should check using <code>ferror(in)</code> whether the entire input stream was read, or if there was an error. </p>\n"}], "owner": {"reputation": 23, "user_id": 8780594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNOGf.jpg?s=128&g=1", "display_name": "P.H. Me", "link": "https://stackoverflow.com/users/8780594/p-h-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1584653452, "creation_date": 1537380129, "last_edit_date": 1584653452, "question_id": 52411743, "link": "https://stackoverflow.com/questions/52411743/how-can-i-read-any-file-into-a-linked-list", "title": "How can I read any file into a linked list?", "body": "<p>I'm supposed to create a program that can read any file into a linked list. This is what I came up with so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_BUFFER_SIZE 1024\n\ntypedef struct list {\n    char *string;\n    struct list *next;\n} LIST;\n\nvoid print_list(LIST *head) {\n    LIST *current = head;\n    while (current != NULL) {\n        printf(\"%s\", current-&gt;string);\n        current = current-&gt;next;\n    }\n}\n\nvoid push(LIST **head, FILE **fp) {\n    char line[MAX_BUFFER_SIZE];\n    LIST *node, *current = *head;\n\n    while(fgets(line, sizeof(line), *fp)) {\n        node = malloc(sizeof(LIST));\n        if (node == NULL) exit(1);\n\n        node-&gt;string = strdup(line);\n        node-&gt;next = NULL;\n\n        if(current == NULL) {\n            *head = node;\n            current = node;\n        } else {\n            current-&gt;next = node;\n            current = current-&gt;next;\n        }\n    }\n}\n\nint main(int argc, char *argv[]) {\n    FILE *fp = fopen(argv[1], \"r\");\n    LIST *head = NULL;\n\n    push(&amp;head, &amp;fp);\n    fclose(fp);\n    print_list(head);\n    return 0;\n}\n</code></pre>\n\n<p>When comparing the contents of the linked list with the contents of the input file this comparison succeeds when using a .txt file but fails when using a file with binary data. This suggests that my program changes the contents of the binary file. </p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["android", "c", "openssl"], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1537383778, "creation_date": 1537383778, "answer_id": 52412640, "question_id": 52411639, "link": "https://stackoverflow.com/questions/52411639/problem-building-position-independent-executable-for-android/52412640#52412640", "title": "Problem building Position independent executable for android", "body": "<p>Seems I just needed to link libc to define this symbol.</p>\n"}], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537383778, "creation_date": 1537379674, "question_id": 52411639, "link": "https://stackoverflow.com/questions/52411639/problem-building-position-independent-executable-for-android", "title": "Problem building Position independent executable for android", "body": "<p>I'm building openssl-1.0.1g for arm-linux-androideabi as described on wiki.openssl.org and my Android target needs to run position independent executables.  I added -fPIE and -pie to my Makefile and now I can see that Elf file type is DYN (Shared object file) but when I copy the file to the target and try to run it I get the following messages;</p>\n\n<pre><code>WARNING: linker: ./openssl has text relocations. This is wasting memory and prevents security hardening. Please fix.\nCANNOT LINK EXECUTABLE: cannot locate symbol \"__exidx_end\" referenced by \"./openssl\"...\n</code></pre>\n\n<p>Any ideas what these messages mean and how to resolve them is greatly appreciated.</p>\n"}, {"tags": ["c", "linux", "networking", "arp"], "comments": [{"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1537378465, "post_id": 52411199, "comment_id": 91766388, "body": "It could be because the real host is also replying to the ARP request, and it is arriving last, forcing the requesting host to update its ARP table with the real MAC address. There can also be something like DHCP snooping and Dynamic ARP inspection on a switch."}, {"owner": {"reputation": 61, "user_id": 8390596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e60483c5070bcdc9f7fe0f47d250f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Flare Flax", "link": "https://stackoverflow.com/users/8390596/flare-flax"}, "reply_to_user": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1537379994, "post_id": 52411199, "comment_id": 91767100, "body": "@RonMaupin hmm, does that mean that I should change the timing of when the packets are sent? Interestingly when I execute an <code>arpspoof</code> command on kali linux, it arp spoofs the target correctly and the spoofed MAC address is showing up in the target&#39;s arp table."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8390596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e60483c5070bcdc9f7fe0f47d250f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Flare Flax", "link": "https://stackoverflow.com/users/8390596/flare-flax"}, "is_accepted": true, "score": 0, "last_activity_date": 1537490975, "creation_date": 1537490975, "answer_id": 52435154, "question_id": 52411199, "link": "https://stackoverflow.com/questions/52411199/target-computer-arp-cache-not-updating-when-arp-spoofing-in-c-on-linux/52435154#52435154", "title": "target computer arp cache not updating when arp spoofing in c on linux", "body": "<p>I made a stupid mistake in the code.<br>\nIn the below line:<br>\n<code>memcpy(addr.sll_addr, &amp;hwdst, ETHER_ADDR_LEN);</code> \nI was giving the pointer to the pointer as a parameter <code>&amp;hwdst</code>. Since <code>hdwst</code> is already an array from the parameter, it would just take the pointer to the first element.\nCorrect line should be:\n<code>memcpy(addr.sll_addr, hwdst, ETHER_ADDR_LEN);</code></p>\n"}], "owner": {"reputation": 61, "user_id": 8390596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e60483c5070bcdc9f7fe0f47d250f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Flare Flax", "link": "https://stackoverflow.com/users/8390596/flare-flax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 52435154, "answer_count": 1, "score": 0, "last_activity_date": 1537490975, "creation_date": 1537377720, "question_id": 52411199, "link": "https://stackoverflow.com/questions/52411199/target-computer-arp-cache-not-updating-when-arp-spoofing-in-c-on-linux", "title": "target computer arp cache not updating when arp spoofing in c on linux", "body": "<p>I am trying to make a simple arp spoofer in c on linux (mainly to better understand low level networking).\nI was so far successfull with creating an arp request and getting arp replies with mac addresses of the target and the gateway, but whenever I send out arp replies to the target/gateway, the arp table on my test computer is not updating, it still shows proper gateway mac address. It is not a network problem because kali linux arpspoof command is working properly and arp cache is updating.</p>\n\n<p>Here is my code for sending spoofed arp packets:</p>\n\n<pre><code>void arp_spoof(int sock, LOCAL_DATA localData, uint32_t pdst, unsigned char hwdst[6], uint32_t psrc)\n{\nstruct ether_arp arpPacket;\n\nstruct sockaddr_ll addr = {0};\naddr.sll_family = AF_PACKET;\naddr.sll_ifindex = localData.interface_index;\naddr.sll_halen = ETHER_ADDR_LEN;\naddr.sll_protocol = htons(ETH_P_ARP);\nmemcpy(addr.sll_addr, &amp;hwdst, ETHER_ADDR_LEN);  // destination physical address\n\n// basic info about the arp packet\narpPacket.arp_hrd = htons(ARPHRD_ETHER);\narpPacket.arp_pro = htons(ETH_P_IP);\narpPacket.arp_hln = ETHER_ADDR_LEN;\narpPacket.arp_pln = sizeof(in_addr_t);\narpPacket.arp_op = htons(ARPOP_REPLY);\n\n/*======== Resulting Structure ========\n\nSource MAC : local mac (attacker)\nSource IP  : ip of the machine attacker wants\n             destination machine to believe is the source\n\nDestination MAC : real destination physical address\nDestination IP  : real destination ip address\n\n======================================*/\n\n// Source MAC [REAL]\nmemcpy(&amp;arpPacket.arp_sha, localData.mac_address, sizeof(arpPacket.arp_sha));\n\n// Source IP [SPOOFED / FAKE]\nmemcpy(&amp;arpPacket.arp_spa, &amp;psrc, sizeof(arpPacket.arp_spa));\n\n// Destination MAC [REAL]\nmemcpy(&amp;arpPacket.arp_tha, hwdst, sizeof(arpPacket.arp_tha));\n\n// Destination ip [REAL]\nmemcpy(&amp;arpPacket.arp_tpa, &amp;pdst, sizeof(arpPacket.arp_tpa));\n\n// sending the packet to the target\nif (sendto(sock, &amp;arpPacket, sizeof(arpPacket), 0, (struct sockaddr*)&amp;addr, sizeof(addr)) == -1) {\n        printf(\"Error arp spoofing target: \");\n        PrintIpAddress(pdst);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "pointers", "stack"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1537377710, "post_id": 52411156, "comment_id": 91765996, "body": "Your code invokes <i>undefined behavior</i>. <code>n=arr; return n;</code> returns the base address of an automatic local array in <code>makestack</code>. The wheels come off as soon as you deref that now-dangling pointer anywhere in your code from that point forward. And you&#39;re leaking memory. Related, hiding <code>int *</code> in a type alias <code>stack</code> is probably the <i>most</i> unhelpful thing in this code. Stop that. I suspect you should be using a <code>struct stack</code> that contains the array and the top-index, passing instances of that thing around by address."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1537377780, "post_id": 52411156, "comment_id": 91766032, "body": "typedefs hiding pointers are invitations to bugs."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1537379811, "post_id": 52411156, "comment_id": 91767006, "body": "Is <code>typedef int *stack;</code> set in stone as part of the problem, or was it your idea?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1537397421, "post_id": 52411156, "comment_id": 91774047, "body": "Hiding pointers behind typedefs only adds confusion, Don&#39;t do it."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1537380645, "creation_date": 1537380645, "answer_id": 52411886, "question_id": 52411156, "link": "https://stackoverflow.com/questions/52411156/c-program-with-an-array-based-stack-using-pointers/52411886#52411886", "title": "C program with an array based stack using pointers", "body": "<p>You have undefined behavior because</p>\n\n<pre><code>stack n;\nint arr[20];\nn = malloc(sizeof(stack));\narr[0]=0;\nn= arr;\nreturn n;\n</code></pre>\n\n<p><code>arr</code> is local variable to <code>makestack</code> and will be destroyed once control exits <code>makestack</code>. Hence you will be referring to invalid memory going further.</p>\n\n<p>Thus change <code>makestack</code> to as below.</p>\n\n<pre><code>    stack makestack()\n    {\n            stack n = malloc(sizeof(int)*20);\n            n[0]=0;\n            return n;\n    }\n</code></pre>\n\n<blockquote>\n  <p>Note: Typedefing the pointer is erroneous avoid it.</p>\n</blockquote>\n\n<pre><code>  typedef int *stack; //bad\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7231797, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_wW53teBG5o/AAAAAAAAAAI/AAAAAAAABYA/J7vj8FkjQb4/photo.jpg?sz=128", "display_name": "Alexis VanderWilt", "link": "https://stackoverflow.com/users/7231797/alexis-vanderwilt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537380645, "creation_date": 1537377498, "question_id": 52411156, "link": "https://stackoverflow.com/questions/52411156/c-program-with-an-array-based-stack-using-pointers", "title": "C program with an array based stack using pointers", "body": "<p>This is my code and it is not working. Any ideas? I can't change the main function or any of the function names or parameters based on the assignment given I can only change the content of the functions. I'm super stuck. Any help is appreciated. I have run GDB on the push function and it seems to be working great. However, the print stack function thinks that the length of the array is 0, which is not helpful at all. Thanks so much!</p>\n\n<pre><code>typedef int *stack;\n\nvoid push (stack st, int num)\n{\n        int len = st[0];\n        st[len+1]=num;\n        st[0]++;\n\n}\nint pop(stack st)\n{\n        int len = st[0], x;\n        x = st[len];\n        st[0]--;\n        return x;\n}\nvoid printstack(stack st)\n{\n        int i, len= st[0];\n        for(i=1;i&lt;=len;i++)\n        {\n                printf(\"%d \", st[i]);\n        }\n\n}\nstack makestack()\n{\n        stack n;\n        int arr[20];\n        n = malloc(sizeof(stack));\n        arr[0]=0;\n        n= arr;\n        return n;\n}\nint main()\n{\n stack s;\n stack t;\n s = makestack();\n t = makestack();\n\n int x;\n push(s, 4);\n push(s, 6);\n push(t, 7);\n push(t, 5);\n printstack(s);\n printstack(t);\n x = pop(s);\n printf(\"%d popped from s\\n\", x);\n printstack(s);\n printstack(t);\n}\n</code></pre>\n"}, {"tags": ["c", "casting", "truncate"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1537377472, "post_id": 52411105, "comment_id": 91765880, "body": "Please read <a href=\"https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency\">Why not use Double or Float to represent currency?</a> and <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a> and <a href=\"https://stackoverflow.com/questions/21895756/why-are-floating-point-numbers-inaccurate\">Why Are Floating Point Numbers Inaccurate?</a>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1537377610, "post_id": 52411105, "comment_id": 91765952, "body": "Yes, the problem is truncation. If you want rounding, use <code>round</code> -- eg., <code>round(balanceowing * 100</code>)`. Or simplify everything by keeping the values of n cents instead of dollars so that you can do everything with integer arithmetic."}, {"owner": {"reputation": 1, "user_id": 10387075, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ywpYpSpNFaM/AAAAAAAAAAI/AAAAAAAAMS0/sNNEvRFUHPw/photo.jpg?sz=128", "display_name": "Zanibul Basith", "link": "https://stackoverflow.com/users/10387075/zanibul-basith"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537880452, "post_id": 52411105, "comment_id": 91938133, "body": "@rici Yes I did what you suggested except I did not use round. I was only allowed to use mod and integer division. After multiplying by a 100, I just divided with integers instead of 0.25. After I just casted it to a float when I printed the output to show decimals. Thanks for the suggestion"}], "owner": {"reputation": 1, "user_id": 10387075, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ywpYpSpNFaM/AAAAAAAAAAI/AAAAAAAAMS0/sNNEvRFUHPw/photo.jpg?sz=128", "display_name": "Zanibul Basith", "link": "https://stackoverflow.com/users/10387075/zanibul-basith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1537377454, "answer_count": 0, "score": 0, "last_activity_date": 1537377381, "creation_date": 1537377302, "last_edit_date": 1537377381, "question_id": 52411105, "link": "https://stackoverflow.com/questions/52411105/mod-value-going-down-by-1", "closed_reason": "Duplicate", "title": "Mod value going down by 1", "body": "<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include&lt;stdio.h&gt;\n\nint main(void)\n{   \nint loonies, quarters ;\ndouble amountdue, balanceowing, owing;\n\nprintf(\"Please enter the amount to be paid: $\");\nscanf(\"%lf\", &amp;amountdue);\n\nloonies = amountdue / 1;\nbalanceowing = (amountdue - (int)amountdue);\n\nquarters = (balanceowing / 0.25);\nowing = ((int)(balanceowing*100) % 25);\n\n\n\nprintf(\"Loonies required: %d, balance owing $%.2lf\\n\", loonies, balanceowing);\nprintf(\"Quarters required: %d, balance owing $%.2lf\", quarters , owing/100);\nreturn 0;\n\n}\n</code></pre>\n\n<p>I am to put the value 8.68 and get the output  </p>\n\n<pre><code>Please enter the amount to be paid: $8.68  \nLoonies required: 8, balance owing $0.68  \nQuarters required: 2, balance owing $0.18  \n</code></pre>\n\n<p>this is the output I am getting with my solution</p>\n\n<pre><code>Please enter the amount to be paid: $8.68  \n\nLoonies required: 8, balance owing $0.68  \nQuarters required: 2, balance owing $0.17  \n</code></pre>\n\n<p>why is the value returned by owing = 0.17?\n68 mod 25 = 18</p>\n\n<p>is this some kind of rounding or truncating?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 3, "creation_date": 1537377175, "post_id": 52411033, "comment_id": 91765746, "body": "There&#39;s no such number &quot;02&quot;. You can store the string as is, or store the number of leading zeroes in the string (if any) separately."}, {"owner": {"reputation": 1882, "user_id": 2447581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/04a70976faced8982d230073029fbe62?s=128&d=identicon&r=PG", "display_name": "phibao37", "link": "https://stackoverflow.com/users/2447581/phibao37"}, "edited": false, "score": 0, "creation_date": 1537377244, "post_id": 52411033, "comment_id": 91765773, "body": "you can store using C-string type: <a href=\"https://stackoverflow.com/a/7709467/2447581\">stackoverflow.com/a/7709467/2447581</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1537377261, "post_id": 52411033, "comment_id": 91765779, "body": "numeric types don&#39;t have a concept of leading zeros.  They don&#39;t really even have the concept of the decimal number system.  It&#39;s all just binary."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1537377303, "post_id": 52411033, "comment_id": 91765794, "body": "Numbers don&#39;t have leading zeros. There is no such number as <code>01</code> or <code>099</code>. Those are string representations."}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 1, "creation_date": 1537377662, "post_id": 52411033, "comment_id": 91765979, "body": "Since you are new in programming - just to let you know that in C, strings are arrays of <code>char</code> (<code>char c[5];</code> is a 5 letter string)"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 2, "creation_date": 1537377783, "post_id": 52411033, "comment_id": 91766033, "body": "Danger. A smart input routine would be forgiven for interpreting 010 as 8, since the leading 0 is used to designate an <b>octal</b> constant."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 3, "creation_date": 1537378506, "post_id": 52411033, "comment_id": 91766404, "body": "@LeonardoAlvesMachado Technically <code>char c[5]</code> would be a <i>4</i> letter string, because the fifth char would be the terminating NUL byte, which is generally not considered a &quot;letter&quot; (e.g., as per <code>strlen</code>). Also a string in C is specifically an array of <code>char</code> terminated by a NUL byte, whereas a <code>char c[5]</code> may also just contain five <code>char</code>s that are not a string or used as one."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 2, "creation_date": 1537378567, "post_id": 52411033, "comment_id": 91766435, "body": "@LeonardoAlvesMachado: <code>char c[5];</code> defines an array capable of holding 5 elements (of type <code>char</code>). A &quot;string&quot; needs a terminating <code>&#39;\\0&#39;</code> byte, which must be in the underlying array. So, that <code>c</code> can hold strings up to a maximum of 4 letter length."}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1537378728, "post_id": 52411033, "comment_id": 91766505, "body": "pmg and @Arkku are correct. I oversimplified it."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1537379168, "post_id": 52411033, "comment_id": 91766693, "body": "Also note that if you save the number as a string to preserve the original format but also do something with it internally after converting the string to a numerical type, you may end up hiding bugs, such as if the user types <code>010</code> and your output confirms that it is <code>010</code>, but internally it got interpreted as octal and the calculations were done with the number eight instead of the ten expected by the user."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537377290, "creation_date": 1537377290, "answer_id": 52411104, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c/52411104#52411104", "title": "Store leading zeroes in C", "body": "<p>If you've got an <code>int</code> value, internally it's always represented as a certain number of bits (or whatever your CPU uses <a href=\"https://en.wikipedia.org/wiki/Ternary_form\" rel=\"nofollow noreferrer\">to store numbers</a>) so you have no control over this.</p>\n\n<p>There's always \"leading zeroes\" in terms of the internal format, because, for example, because 2099 is actually <code>0b00000000000000000000100000110011</code> in 32-bit form. This gets more complicated due to <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endian issues</a>, but the principle still holds.</p>\n\n<p>The only time leading zeroes makes sense is if you're using <a href=\"https://en.wikipedia.org/wiki/Binary-coded_decimal\" rel=\"nofollow noreferrer\">binary coded decimal</a>, which has fallen out of style, or string notation such as produced by <code>sprintf</code> type functions.</p>\n\n<p>It's only humans that care about digits. As far as a computer's concerned it's equally difficult to add 1+1 as it is 6916863870493370158+6471945999301299985 because they're both 64-bit operations.</p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 1, "last_activity_date": 1537377458, "creation_date": 1537377458, "answer_id": 52411147, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c/52411147#52411147", "title": "Store leading zeroes in C", "body": "<p>If you store the number as an integer (e.g., <code>int</code>) or floating point type, any formatting information is inevitably lost: only the binary representation of the number is stored. (It may help to consider it as saving the <em>idea</em> of the number, e.g., \"two\", not how it looks when written.)</p>\n\n<p>You need to store any additional information elsewhere, such as by saving the original string and using that for output, or by saving the number of digits and applying that to the <code>printf</code> format. There are also decimal number libraries that can internally save the decimal representation of the number, but that is considerably heavier than using the native types.</p>\n\n<p>(Alternatively, just settle on a canonical output format and use that regardless of input. Is the goal really to preserve <em>any</em> input formatting as is, or would it suffice to always add the leading zeroes to the output?)</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1537379914, "post_id": 52411173, "comment_id": 91767055, "body": "With <code>%i</code>, leading zeros matter \u2014 017 and 17 are different values (octal 017 is 15 decimal; 17 is still 17 decimal).  This catches people writing date parsing code using <code>%i</code> to scan for the day or the month (with <code>%i</code>, an input <code>09</code> gives a zero value, and leaves the 9 to be interpreted by the next conversion specifier)."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 4, "last_activity_date": 1537381407, "last_edit_date": 1537381407, "creation_date": 1537377561, "answer_id": 52411173, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c/52411173#52411173", "title": "Store leading zeroes in C", "body": "<p>The result of using <code>scanf</code> specifiers <code>d</code>, <code>i</code>, <code>o</code>, <code>u</code>, <code>x</code>, <code>a</code>, <code>e</code>, <code>f</code>, <code>g</code> is a mathematical number. There are no leading zeros. Conceptually, there are no digits in a number; it is a pure mathematical entity. (As <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">Jonathan Leffler</a> notes, leading zeros in the input matter the <code>i</code> specifier; a leading zero changes the base to octal while interpreting the numeral. This is for input only; the result is still a number with no associated digits or base.)</p>\n\n<p>To preserve the leading zeros of a numeral, you must treat it as a string. <code>scanf</code> can be used to read strings or individual characters with the <code>s</code>, <code>c</code>, and <code>[</code> specifiers, although you might wish to use a simple get-character function such as <code>getchar</code>. You would have to count the leading zeros yourself. The remaining digits could also be handled as a string, or you could convert them to a number.</p>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 1, "last_activity_date": 1537378102, "creation_date": 1537378102, "answer_id": 52411299, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c/52411299#52411299", "title": "Store leading zeroes in C", "body": "<p>As already explained, numbers don't have leading zeros.</p>\n\n<p>You can however treat it as a string</p>\n\n<pre><code>printf(\"Enter num: \");\nchar buf[50];\nscanf(\"%s\", &amp;buf);\nprintf(\"You entered: %s\", buf);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1537378863, "creation_date": 1537378863, "answer_id": 52411472, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c/52411472#52411472", "title": "Store leading zeroes in C", "body": "<blockquote>\n  <p>how to store a number with leading zeroes  (?)<br>\n  I currently only know int, double and float</p>\n</blockquote>\n\n<p>To store an integer <strong>and</strong> the leading zero count is then 2 pieces of information.  When reading user input, record the number <strong>and</strong> its length or textual width.</p>\n\n<p><code>\" \"</code> to consume whitespace.<br>\n<code>\"%n\"</code> to record the offset of characters scanned so far.  This does not affect the return value of <code>scanf()</code>.</p>\n\n<pre><code>int num;\nint n1, n2;\nif (scanf(\" %n%d%n\", &amp;n1, &amp;num, &amp;n2) != 1) {\n  puts(\"Failed to read an int\");\n}\n</code></pre>\n\n<p>Otherwise, print it.<br>\n<code>\"0\"</code>: pad with zeros.<br>\n<code>\"*\"</code>: minimum width to print derived from argument list.</p>\n\n<pre><code>else {\n  int length = n2 - n1;\n  printf(\"%0*d\\n\", length, num);\n}\n</code></pre>\n\n<p>Input/output</p>\n\n<pre><code>  007\n007\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10386976, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g2ndEcODmFQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO0xGhGJqb5typAuKKTPcYdljdlow/mo/photo.jpg?sz=128", "display_name": "Val K", "link": "https://stackoverflow.com/users/10386976/val-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1537381407, "creation_date": 1537377016, "question_id": 52411033, "link": "https://stackoverflow.com/questions/52411033/store-leading-zeroes-in-c", "title": "Store leading zeroes in C", "body": "<p>For starters, I'm new to programming</p>\n\n<p>I'd like to know how to store a number with leading zeroes in it with scanf instead of modifying the printf. Is it related to data types? If so, what is it? and how do I use it? I currently only know int, double and float</p>\n\n<p>For example, I'd like to input the number \"02\" and receive \"02\" as the output, and when I input \"2\" the output will also be \"2\".</p>\n"}, {"tags": ["c", "ssl", "encryption", "openssl"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1537377015, "post_id": 52410981, "comment_id": 91765680, "body": "Are you mixing C language with C++?  You have both tags, and they are distinct languaes."}, {"owner": {"reputation": 7675, "user_id": 2923952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/71908bd318301d831c4b9eb6ca1c13a2?s=128&d=identicon&r=PG&f=1", "display_name": "Siler", "link": "https://stackoverflow.com/users/2923952/siler"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1537377053, "post_id": 52410981, "comment_id": 91765701, "body": "No, I just put both since the OpenSSL API can be used from either"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1537377161, "post_id": 52410981, "comment_id": 91765743, "body": "In that case you should add pascal, FORTRAN and a whole slew of other languages that will interop with a C-style interface. Best if you just tag the target language you are interested in. If you don&#39;t care about the language, use language-agnostic."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 4, "creation_date": 1537377839, "post_id": 52410981, "comment_id": 91766063, "body": "<i>Any</i> PEM can be encrypted, even public keys, though <i>typically</i> only private keys are. But maybe the issuer wants to give out a public key but limit who can actually use it via a password that is given only to authorized users."}], "answers": [{"tags": [], "owner": {"reputation": 14334, "user_id": 1380680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TRgwX.png?s=128&g=1", "display_name": "Reinier Torenbeek", "link": "https://stackoverflow.com/users/1380680/reinier-torenbeek"}, "is_accepted": true, "score": 1, "last_activity_date": 1537412602, "last_edit_date": 1537412602, "creation_date": 1537398270, "answer_id": 52415282, "question_id": 52410981, "link": "https://stackoverflow.com/questions/52410981/password-callback-for-reading-public-key-with-openssl-api/52415282#52415282", "title": "Password callback for reading public key with OpenSSL API", "body": "<p>As mentioned in <a href=\"https://stackoverflow.com/questions/52410981/password-callback-for-reading-public-key-with-openssl-api#comment91766063_52410981\">this comment</a>, any PEM-encoded data can be encrypted. Message encryption for privacy-enhanced mail (PEM) is defined in <a href=\"https://tools.ietf.org/html/rfc1421\" rel=\"nofollow noreferrer\">RFC 1421</a> and in the context of your question, it is interesting to look at the example message in \n<a href=\"https://tools.ietf.org/html/rfc1421#section-4.6\" rel=\"nofollow noreferrer\">section 4.6  Summary of Encapsulated Header Fields</a></p>\n\n<pre><code>-----BEGIN PRIVACY-ENHANCED MESSAGE-----\nProc-Type: 4,ENCRYPTED\nContent-Domain: RFC822\nDEK-Info: DES-CBC,F8143EDE5960C597\nOriginator-ID-Symmetric: linn@zendia.enet.dec.com,,\nRecipient-ID-Symmetric: linn@zendia.enet.dec.com,ptf-kmc,3\nKey-Info: DES-ECB,RSA-MD2,9FD3AAD2F2691B9A,\n          B70665BB9BF7CBCDA60195DB94F727D3\nRecipient-ID-Symmetric: pem-dev@tis.com,ptf-kmc,4\nKey-Info: DES-ECB,RSA-MD2,161A3F75DC82EF26,\n          E2EF532C65CBCFF79F83A2658132DB47\n\nLLrHB0eJzyhP+/fSStdW8okeEnv47jxe7SJ/iN72ohNcUk2jHEUSoH1nvNSIWL9M\n8tEjmF/zxB+bATMtPjCUWbz8Lr9wloXIkjHUlBLpvXR0UrUzYbkNpk0agV2IzUpk\nJ6UiRRGcDSvzrsoK+oNvqu6z7Xs5Xfz5rDqUcMlK1Z6720dcBWGGsDLpTpSCnpot\ndXd/H5LMDWnonNvPCwQUHt==\n-----END PRIVACY-ENHANCED MESSAGE-----\n</code></pre>\n\n<p>Looking at the 1.1 branch of OpenSSL it has a function <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/PEM_read_bio.html\" rel=\"nofollow noreferrer\"><code>PEM_read_bio()</code></a> that supports reading such a message and splitting it into its name (as given in the top line), header (the name-value pairs below that) and data (the base64-encoded stuff):</p>\n\n<pre><code> int PEM_read_bio(BIO *in, char **name, char **header,\n                  unsigned char **data, long *len);\n</code></pre>\n\n<p>All OpenSSL <code>PEM_read_XYZ()</code> functions at some point invoke it, from <a href=\"https://github.com/openssl/openssl/blob/OpenSSL_1_1_0i/crypto/pem/pem_lib.c#L225\" rel=\"nofollow noreferrer\"><code>PEM_bytes_read_bio()</code></a>, because they are all implemented in the same way by means of macro expansions. That function contains the following calls:</p>\n\n<pre><code>PEM_read_bio(bp, &amp;nm, &amp;header, &amp;data, &amp;len)\n</code></pre>\n\n<p>to split the message, then</p>\n\n<pre><code>PEM_get_EVP_CIPHER_INFO(header, &amp;cipher);\n</code></pre>\n\n<p>to figure out which type of encryption information is found in the header of that message and fill an <code>EVP_CIPHER_INFO</code> object with it, and then</p>\n\n<pre><code>PEM_do_header(&amp;cipher, data, &amp;len, cb, u);\n</code></pre>\n\n<p>to do the decryption of the data based on the cipher information found -- again if needed. Note the <code>cb</code> parameter which stands for callback, a mechanism to get input for any passphrase if needed.</p>\n\n<p>Now what might be confusing, is that certain private key formats, like for example PKCS#8, also have their own mechanism of storing encryption information independent of the PEM encoding. Technically speaking, it should be possible to apply encryption to such keys twice: once at the PEM level and once at the PKCS#8 level. The OpenSSL tools for generating or converting to PKCS#8 formatted keys do not seem to offer that option though. Also, none of the tools seem to expose the option of encrypting any generated public key PEM files, unless a private key is included as well.</p>\n\n<p>You can check some of the outputs to see if they match my story. First, generating an RSA key pair to a PKCS#1 format, nothing encrypted:</p>\n\n<pre><code>$ openssl genrsa\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n.................+++++\n............+++++\ne is 65537 (0x010001)\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAlcnR/w7zPoLrhuqFvcfz5fn8DFb0fEcCKOKSj+x+JJxGth9P\nrJbxkt4pRXxbMIL0fX59HN5bRvQh2g59l/kfr30kCOnclap9nRrohWyg2i7720Cw\n&lt;truncated&gt;\n</code></pre>\n\n<p>Then the same command, but using encryption, which happens at the PEM level, as you can see in the headers:</p>\n\n<pre><code>$ openssl genrsa -des3\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n.....................+++++\n....................+++++\ne is 65537 (0x010001)\nEnter pass phrase:\nVerifying - Enter pass phrase:\n-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: DES-EDE3-CBC,D90861647707F687\n\nDIupLghCjcvpLenqAAULaJj1EDvUUfc2Xc58YVh7rMTSVgLwZ+9CtnUQJcup4aUQ\na1EdGXTadwBQB2jTtiFJbH67/5D26PHXPnM+YN2rnoReOExVS7hKu3DTq7c4j6a3\n&lt;truncated&gt;\n</code></pre>\n\n<p>Finally generating a similar key but now to PKCS#8, which has its own encryption and therefore does not get encrypted at the PEM level. You can see that the PEM headers are not there.</p>\n\n<pre><code>$ openssl genpkey -algorithm RSA -des3\n.........................................+++++\n...........................................................................+++++\nEnter PEM pass phrase:\nVerifying - Enter PEM pass phrase:\n-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIIFHDBOBgkqhkiG9w0BBQ0wQTApBgkqhkiG9w0BBQwwHAQIV0Ih4bsI6egCAggA\nMAwGCCqGSIb3DQIJBQAwFAYIKoZIhvcNAwcECNOim8HAN8j5BIIEyEe05hHtc8HL\n&lt;truncated&gt;\n</code></pre>\n\n<p>If all my reasoning is correct, then the prompt \"Enter PEM pass phrase\" is inaccurate since this is not a PEM-level encryption but a PKCS#8-level encryption.</p>\n"}], "owner": {"reputation": 7675, "user_id": 2923952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/71908bd318301d831c4b9eb6ca1c13a2?s=128&d=identicon&r=PG&f=1", "display_name": "Siler", "link": "https://stackoverflow.com/users/2923952/siler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 52415282, "answer_count": 1, "score": 2, "last_activity_date": 1537412735, "creation_date": 1537376812, "last_edit_date": 1537412735, "question_id": 52410981, "link": "https://stackoverflow.com/questions/52410981/password-callback-for-reading-public-key-with-openssl-api", "title": "Password callback for reading public key with OpenSSL API", "body": "<p>When using public key cryptography, it is often customary to store private keys in an encrypted format, since they are of course supposed to be a secret.  This is reflected in the OpenSSL C API, which provides functions like <code>PEM_write_PrivateKey</code>, which takes as function arguments an optional cipher to use to encrypt the key (like AES).  Then, when reading the encrypted key back in from disk, the OpenSSL API provides functions like <code>PEM_read_PrivateKey</code>, which allows the user to provide a function pointer used as a callback so the application can provide OpenSSL with the password for the encrypted key.</p>\n\n<p>But what confuses me is that the OpenSSL API also seems to let the user provide a password callback when reading in a <em>Public</em> key.  For example, one API function signature for reading in a public key is:</p>\n\n<pre><code> EVP_PKEY *PEM_read_PUBKEY(FILE *fp, EVP_PKEY **x,\n                                        pem_password_cb *cb, void *u);\n</code></pre>\n\n<p>So what is the purpose of providing a password callback when reading in a <em>public</em> key?  AFAIK it makes no sense to encrypt a public key, since a public key is by definition supposed to be available to the general public.  So why does the OpenSSL API have a function parameter here that takes a password callback?</p>\n"}, {"tags": ["c", "function", "return"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1537377570, "post_id": 52410907, "comment_id": 91765933, "body": "if the first call to <code>find_even()</code> doesn&#39;t return -1, you call <code>find_even()</code> again as a parameter to <code>printf()</code> so it will <code>scanf()</code>for another user input. I don&#39;t think that&#39;s what you want"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1537380019, "post_id": 52410907, "comment_id": 91767109, "body": "What happens if the user enters -1 at each prompt?"}], "answers": [{"tags": [], "owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1537378694, "last_edit_date": 1537378694, "creation_date": 1537378061, "answer_id": 52411293, "question_id": 52410907, "link": "https://stackoverflow.com/questions/52410907/what-is-the-problem-with-my-code-it-is-not-returning-value-if-b-1/52411293#52411293", "title": "what is the problem with my code, it is not returning value if b!=-1", "body": "<p>The reason you do not seem to get output unless you enter -1 is because you must enter at least <code>k</code> even numbers for <code>(i&lt;k)</code> to be true.  Each time you enter a positive even number in the loop, i increments:</p>\n\n<pre><code>if (a&gt;=0 &amp;&amp; a%2 == 0){\n    b=a;\n    i++;  // here\n</code></pre>\n\n<p>So if you enter a positive even number (say 2) more than k times, you will get a result that isn't -1.</p>\n\n<p>After you return from the function, if the result is negative, you do:</p>\n\n<pre><code>printf(\"No %dth even integer exist.\",k);\n</code></pre>\n\n<p>If the result is positive, you go back into the function for a second time:</p>\n\n<pre><code>printf(\"Result = %d. \",find_even(k)); // This is going to re-enter find_even\n</code></pre>\n\n<p>I think what you want to here is save the result of the function call and act on that.  Like this:</p>\n\n<pre><code>int result = find_even(k);\nif (result&lt;0)\n    printf(\"No %dth even integer exist.\",k);\nelse\n    printf(\"Result = %d. \", result);\n</code></pre>\n\n<p>Edit:  I think I understand what you are trying to do now.  It was a bit confusing given the request and the way things line up on the screen. Add a <code>\\n</code> to the end of the <code>printf</code> to make this less confusing on the terminal:</p>\n\n<pre><code>printf(\"Enter the sequence of non negative integers and at end enter a negative integer  :\\n\");\n</code></pre>\n\n<p>Now, all the input will be aligned and make more sense.</p>\n\n<p>Also, be careful with <code>scanf()</code> as it is not the most reliable function.  It is good for tinkering, but it is unsafe for general purpose use.  Check out <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">this</a> little guide for more info on <code>scanf</code> and all of its intricacies to using it correctly.</p>\n"}], "owner": {"reputation": 21, "user_id": 7409936, "user_type": "registered", "profile_image": "https://graph.facebook.com/1215017715260048/picture?type=large", "display_name": "Shashank Shekhar", "link": "https://stackoverflow.com/users/7409936/shashank-shekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1537378694, "creation_date": 1537376523, "question_id": 52410907, "link": "https://stackoverflow.com/questions/52410907/what-is-the-problem-with-my-code-it-is-not-returning-value-if-b-1", "title": "what is the problem with my code, it is not returning value if b!=-1", "body": "<p>what is the problem with my code, it is not returning value if b!=-1 </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\nint find_even(int k){\n    int a,b,i=0;\n    scanf(\"%d\",&amp;a);\n    while (a&gt;=0){\n        if(i&lt;k){\n            if (a&gt;=0 &amp;&amp; a%2 == 0){\n                b=a;\n                i++;\n            }\n\n        }\n        scanf(\"%d\",&amp;a);\n    }\n    if (i&lt;k){\n        b=-1;\n    }\n    return b;\n\n}\n\nvoid main(){\n    int k;\n    printf(\"Enter the value of K : \");\n    scanf(\"%d\",&amp;k);\n    printf(\"Enter the sequence of non negative integers and at end enter a negative integer  : \");\n    if (find_even(k)&lt;0)\n        printf(\"No %dth even integer exist.\",k);\n    else\n        printf(\"Result = %d. \",find_even(k));\n}\n</code></pre>\n\n<p>I am trying to get the kth even digit but I am not getting any value returned whenever the value of b isn't equal to -1 </p>\n"}, {"tags": ["c", "linked-list", "append"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1537375993, "post_id": 52410653, "comment_id": 91765196, "body": "Rework your <code>print_list</code> loop to use <code>while (current != NULL) </code> instead of <code>while (current-&gt;next != NULL) </code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1537376622, "post_id": 52410653, "comment_id": 91765507, "body": "<code>append()</code> should be fine as long as <code>malloc()</code> succeeds... but <code>print_list()</code> needs work.  Remember <code>current-&gt;next</code> is <code>NULL</code> <i>for the last node</i>, and <code>current-&gt;next-&gt;next</code> is <code>NULL</code> <i>for the second to last node</i>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10382220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872f4a965ff9fca670373757dd785c49?s=128&d=identicon&r=PG&f=1", "display_name": "N.Daniels", "link": "https://stackoverflow.com/users/10382220/n-daniels"}, "is_accepted": true, "score": 0, "last_activity_date": 1537379105, "last_edit_date": 1537379105, "creation_date": 1537378286, "answer_id": 52411343, "question_id": 52410653, "link": "https://stackoverflow.com/questions/52410653/append-add-to-tail-of-linked-list-function-in-c-is-printing-incorrectly-does/52411343#52411343", "title": "Append (add to tail) of linked list function in C is printing incorrectly (does not print out last element appended)", "body": "<p>Thank you to 500 - Internal Server Error and Dmitri. </p>\n\n<p>It was a problem as simple as that. I only thought my print method was working because of the other functions, not seeing that I was actually working around that all this time and had an extra element in my list.</p>\n\n<p>I fixed it by changing my print_list methods as follows:</p>\n\n<pre><code>void print_list(node_t * head)\n{\n    node_t * current = head;\n    if(current == NULL)                     /* IF no elements in list, */\n    {\n        printf(\"-\\n\");                          /* Print empty hyphen and new line*/\n        return;\n    }\n    else \n    {\n        while (current != NULL)                 \n        {\n            if (current-&gt;next==NULL)        \n                printf(\"%c\\n\", current-&gt;data);\n            else\n                printf(\"%c-\", current-&gt;data);\n            current = current-&gt;next;                /* Move on to next element in list */\n        }\n    }\n}\n</code></pre>\n\n<p>I also could then in turn initialize my head to null in main as:</p>\n\n<pre><code>node_t * test_list = NULL;\n</code></pre>\n\n<p>instead of as: </p>\n\n<pre><code>node_t * test_list = (node_t *)malloc(sizeof(node_t))\n</code></pre>\n\n<p>Since I wanted an empty list so that my boundaries can work correctly and that I print out the last element, since  the old loop current->next != NULL stops at NULL and does not print out my last element.</p>\n"}], "owner": {"reputation": 1, "user_id": 10382220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872f4a965ff9fca670373757dd785c49?s=128&d=identicon&r=PG&f=1", "display_name": "N.Daniels", "link": "https://stackoverflow.com/users/10382220/n-daniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 52411343, "answer_count": 1, "score": 0, "last_activity_date": 1537379105, "creation_date": 1537375540, "last_edit_date": 1537375961, "question_id": 52410653, "link": "https://stackoverflow.com/questions/52410653/append-add-to-tail-of-linked-list-function-in-c-is-printing-incorrectly-does", "title": "Append (add to tail) of linked list function in C is printing incorrectly (does not print out last element appended)", "body": "<p>this is my first post so kindly point out to me if I make any mistakes with my post.</p>\n\n<p>This is a c assignment that takes commands from a text file (such as Push, Head, Append, etc) and then performs the corresponding operation for linked lists. I have a header file, a c file that has my main class and a c file with linked list functions.</p>\n\n<p>All my functions work correctly, that is my remove(), push(), printlist(), head() and tail(), except for my append (add to end of list) function. </p>\n\n<p>This is my structure in header file:</p>\n\n<pre><code>typedef struct node \n{\n    char data;\n    struct node * next;\n} node_t;\n</code></pre>\n\n<p>This is my append function: </p>\n\n<pre><code>node_t * append(node_t ** headRef, char data)\n{\n    node_t * current = *headRef;\n    node_t * newNode;\n    newNode = malloc(sizeof(node_t));\n    newNode-&gt;data = data;\n    newNode-&gt;next = NULL;\n    // special case for length 0\n    if (current == NULL) {\n        *headRef = newNode;\n    }\n    else \n    {\n        // Locate the last node\n        while (current-&gt;next != NULL) {\n            current = current-&gt;next;\n        }\n        current-&gt;next = newNode;\n    }   \n}\n</code></pre>\n\n<p>My print method (if necessary):</p>\n\n<pre><code>void print_list(node_t * head)\n{\n    node_t * current = head;\n    if(current-&gt;next == NULL)                       /* IF no elements in list, */\n    {\n        printf(\"-\\n\");                          /* Print empty hyphen and new line*/\n        return;\n    }\n    else \n    {\n        while (current-&gt;next != NULL)               \n        {\n            if(current-&gt;next-&gt;next ==NULL)              /* Otherwise if there are is one element */\n                printf(\"%c\\n\", current-&gt;data);          /* Print character and a new line (last character) */\n            else if (current-&gt;next==NULL)               /* Otherwise if there are is more than one element */\n                printf(\"%c-\\n\", current-&gt;data);         /* Print character and hyphen between characters) */\n            else\n                printf(\"%c-\", current-&gt;data);\n            current = current-&gt;next;                /* Move on to next element in list */\n        }\n    }\n}\n</code></pre>\n\n<p>And lastly this is how my main looks:</p>\n\n<pre><code>    int main(int argc, char *argv[])\n    {\n        node_t * test_list = (node_t *)malloc(sizeof(node_t));\n\n        FILE * fp;                          \n        fp = fopen(argv[1], \"r\");\n        char line[20];\n        int lngth;\n\n        while(fgets(line, 20, fp)!=NULL)                /* Loop to read every command in each file */\n        {\n            line [ strcspn(line, \"\\n\") ] = 0;               /* Removes all nextline characters from array */\n\n            //Here, I just get conditionals for the statement in the testfile\n            //............\n            else if(strncasecmp(line, \"Append\",4) ==0)      /* Check if line matches instruction 'Append' regardless of casing */\n            {\n                if(strncmp(line, \"Append\",4) ==0)       /* Now check if the line matches with casing */\n                {\n                    char letter = line[7];          /* If yes extract the alphabetical character to append */\n                    append(&amp;test_list, letter);\n                }\n                else                        /* If line casing not correct, output to stderr */\n                    fprintf (stderr, \"Input not valid\\n\");  \n            }   \n\n            else if(strcmp(line, \"PrintList\") ==0)          /* Check if line matches instruction 'PrintList' */\n                print_list(test_list);              /* If it does, print out the list */\n            //more conditionals\n            //.........\n            else                            /* Triggers if line does not match any above instructions */\n                fprintf (stderr, \"Input not valid\\n\");      /* Outputs to stderr */\n        }\n        fclose(fp);\n   }\n</code></pre>\n\n<p>It appears to see my first element in the linked list as a 0 (empty space will be printed with printf(\"%c\",node->data) for unassigned character</p>\n\n<p>Test Case Example: </p>\n\n<pre><code>Input:\n    Append A\n    PrintList\n\nOutputs:\n    (Blank line)\n</code></pre>\n\n<p>As stated before, all other functions work correct and when printing, looks like A-B-C if 3 elements of A B and C exist and empty hyphen (-) when list empty.</p>\n\n<p>Test Case 2 Example:</p>\n\n<pre><code>Input:\n    Append A\n    Append B\n    Append C\n\nOutputs:\n    -A-B\n</code></pre>\n\n<p>Please point out to me where my logic is flawed. I suspect it is with my head not initially being null, however setting it to null causes my other methods to work incorrectly, and does not help append either. </p>\n\n<p>Some research also indicates that if i initially set head to \"z' for example, the output of append for test case 1 will be z and for test case 2 will be z-a-b</p>\n\n<p>My main question is why does my append function not work correctly in conjunction with my print function, as it does not simply append all my elements as it should.</p>\n\n<p>I am compiling with gcc on ubuntu 64-bit system.</p>\n"}, {"tags": ["c", "gtk", "gtk3"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537383803, "post_id": 52409104, "comment_id": 91768900, "body": "HM, strange because <a href=\"https://pastebin.com/raw/f4XMsfBF\" rel=\"nofollow noreferrer\">even with this approach</a> still does not work for <code>CTRL</code> :|"}, {"owner": {"reputation": 330, "user_id": 7952358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-csVPwZqYROg/AAAAAAAAAAI/AAAAAAAAAAs/VT0EsSkbUgg/photo.jpg?sz=128", "display_name": "Hanlon", "link": "https://stackoverflow.com/users/7952358/hanlon"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537390201, "post_id": 52409104, "comment_id": 91771761, "body": "@Michi Any other ideas? I just need the code to loop while the <code>Ctrl</code> is being held. I thought that my code up would accomplish that, but it doesn&#39;t for some reason."}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1537679272, "post_id": 52409104, "comment_id": 91868363, "body": "Ctrl isn&#39;t a &quot;key&quot; in the meaning used by key-press-event and key-release-event; it&#39;s a &quot;modifier&quot;. You can&#39;t detect Ctrl separately with those events."}], "owner": {"reputation": 330, "user_id": 7952358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-csVPwZqYROg/AAAAAAAAAAI/AAAAAAAAAAs/VT0EsSkbUgg/photo.jpg?sz=128", "display_name": "Hanlon", "link": "https://stackoverflow.com/users/7952358/hanlon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537374503, "creation_date": 1537369978, "question_id": 52409104, "link": "https://stackoverflow.com/questions/52409104/key-release-event-not-triggered", "title": "&quot;key-release-event&quot; not triggered", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nstatic void stop(GtkWidget *window, GdkEventKey *key, gboolean *key_held)\n{\n        *key_held = FALSE;\n        g_print(\"stopped!\\n\");\n}\n\nstatic void counter(GtkWidget *window, GdkEventKey *key, gpointer user_data)\n{\n        gboolean key_held = TRUE;\n        gulong signal_ID = g_signal_connect(window, \"key-release-event\", G_CALLBACK(stop), &amp;key_held);\n\n        for (unsigned long int i = 0;key_held;i++)\n        {   \n                g_print(\"%li\\n\", i); \n        }   \n\n        g_signal_handler_disconnect(window, signal_ID);\n}\n\nint main(int argc, char **argv)\n{\n        gtk_init(&amp;argc, &amp;argv);\n\n        GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n        gtk_widget_add_events(window, GDK_KEY_PRESS_MASK | GDK_KEY_RELEASE_MASK);\n\n        g_signal_connect(window, \"delete-event\", G_CALLBACK(gtk_main_quit), NULL);\n        g_signal_connect(window, \"key-press-event\", G_CALLBACK(counter), NULL);\n\n        gtk_widget_show(window);\n\n        gtk_main();\n}\n</code></pre>\n\n<p>It's simple: the counter starts to count from 0 when the user presses a key and continues to count until the user release the key...</p>\n\n<p>Or that's at least how it's supposed to work. What actually happens is that when a user presses a key, the counter starts and doesn't stop when the user release the key. The only way to stop counting is to terminate the program. Also, not only the <code>\"key-release-event\"</code> is not triggered but <code>\"delete-event\"</code> isn't too: I have to press <kbd>Ctrl+C</kbd> to terminate the program.</p>\n"}, {"tags": ["c", "primes"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10141503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEv9V.png?s=128&g=1", "display_name": "naguam", "link": "https://stackoverflow.com/users/10141503/naguam"}, "edited": false, "score": 0, "creation_date": 1537384521, "post_id": 52412506, "comment_id": 91769227, "body": "It says It&#39;s not permitted in c89. But I agree, Your program is really good in c99 :) It learned me many things."}, {"owner": {"reputation": 55, "user_id": 10141503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEv9V.png?s=128&g=1", "display_name": "naguam", "link": "https://stackoverflow.com/users/10141503/naguam"}, "edited": false, "score": 0, "creation_date": 1537388171, "post_id": 52412506, "comment_id": 91770896, "body": "Ok Sorry, all your code is correct for c89 exept // comments. My apologizes."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 1, "last_activity_date": 1537383230, "creation_date": 1537383230, "answer_id": 52412506, "question_id": 52408727, "link": "https://stackoverflow.com/questions/52408727/c-binary-program-for-prime-numbers-does-not-want-to-run/52412506#52412506", "title": "C binary program for prime numbers does not want to run", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>is NOT efficient</li>\n<li>shows proper indentation</li>\n<li>shows meaningful variable names</li>\n<li>properly passes the allocated memory to `free_ before exiting</li>\n<li>properly checks for successful execution of <code>scanf()</code></li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>/*librairies*/\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n/*main function*/\nint main( void )\n{\n    size_t targetNum;\n    size_t i;  // index\n    size_t j;  // index\n\n\n\n    size_t *primeArray = NULL; /*pointer which will become an array (see in another after comment)*/\n\n    printf(\"Enter Your target number : \");\n    if( scanf(\"%lu\", &amp;targetNum) != 1 )\n    {\n        fprintf( stderr, \"scanf failed to read target number\\n\" );\n        exit( EXIT_FAILURE );\n    }\n\n    if ( targetNum &gt; 1 )\n    {\n        primeArray = malloc( targetNum * sizeof( size_t ) ); \n\n        if ( !primeArray )\n        { \n            perror( \"malloc failed\" );\n            exit( EXIT_FAILURE );\n        }\n\n        // initialize array of prime numbers\n        for ( i = 0; i &lt; targetNum; i++ )\n        { \n            primeArray[i] = 1;\n        }\n\n        primeArray[0] = 0;\n        primeArray[1] = 0;\n\n        // find primes and zero multiples\n        for( i = 0; i &lt; targetNum; i++ )\n        {\n            // skip any multiples of primes (which have already been zero'd\n            if( !primeArray[i] )\n            {\n                continue;\n            }\n\n            // zero multiples\n            for( j = i+i; j &lt; targetNum; j+=i )\n            {\n                primeArray[j] = 0;\n            }\n        }\n\n        // print primes\n        for ( i = 0; i &lt; targetNum; i++ )\n        {\n            if( primeArray[i] )\n            {\n                printf( \"%lu\\n\", i ); \n            }\n        }\n\n        free( primeArray );\n    } \n\n    else\n    {\n        printf(\"Your number is not valid\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>given the following input:</p>\n\n<pre><code>4\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>Enter Your target number : 4\n2\n3\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10141503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEv9V.png?s=128&g=1", "display_name": "naguam", "link": "https://stackoverflow.com/users/10141503/naguam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 52412506, "answer_count": 1, "score": -1, "last_activity_date": 1537383230, "creation_date": 1537368842, "last_edit_date": 1537369505, "question_id": 52408727, "link": "https://stackoverflow.com/questions/52408727/c-binary-program-for-prime-numbers-does-not-want-to-run", "title": "C binary program for prime numbers does not want to run", "body": "<p>I've a problem at the execution of my program.\nI compile it with gcc using: <code>gcc -std=c89 -Wall -Wextra -lm main.c</code>.\nSame problem with clang and I didn't try it with tcc yet but I will when the program will be finished.\nI would like it to be compilable with a c89 compiler, this explains some of my choices. I've no error at the compilation but a problem at the execution.\nLike what's written in some of my comments in my code, at the execution normally, I would have an error because of a division by 0 (with the k variable) but I think I have an error in the \"do...while\" loop (because the rest of my function is tested), and before the by k division.\nI took some hours to debug (especially with gdb (<code>-g</code> option add to the compilation command and <code>run -v</code> in gdb) but I'm still blocked.</p>\n\n<pre><code>/*librairies*/\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n/*main function*/\nint main(){\n    int N, b, i, j, h, k;\n    int *t; /*pointer which will become an array (see in another after comment)*/\n    float l, m, a;\n    k = 0;   /*Problem with k because we will see later an error*/\n    printf(\"Your number : \");\n    scanf(\"%d\", &amp;N);\n    if (N&gt;1){\n        a = sqrt(N);\n        b = a; /*we convert float into int and it rounds under, normal*/ \n        t = malloc(N * sizeof(int)); /*manual dynamic memory allocation for the array to respect C89*/\n        if (t==NULL){ /*t is null when you have not enough ram for a too big value for N*/\n            exit(0);\n        }\n        for (i=1;i&lt;N;i++){ /*function to fill the array with 2,3..N*/\n            j = i + 1;\n            h = i - 1;\n            t[h] = j;\n        }\n\n        do{\n            if (t[k]==0){\n                k = k + 1;\n            } else{\n                for (i=1;i&lt;N;i++){          /*problem nearby, because the division by 0 error does not come know at the execution = 0*/\n                    h = i - 1;   \n                    if (t[h]!=0){\n                        l = (float)t[h] / (float)k; /*It's going to be a problem because in the first loop, k = 0*/\n                        m = l - (int)l;\n                        if (m==0.0f){\n                            t[h] = 0;\n                        }\n                    }\n                }\n            }\n        } while (k&lt;b);\n        h = 0;\n        for (i=1;i&lt;N;i++){\n            h = i - 1; \n            printf(\"%d\\n\", t[h]); /*printf to test before continuing the program*/\n        }\n\n    } else{\n        printf(\"Your number is not valid\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Info: This program is just a personnal project to illustrate for me a math course I had (about prime numbers, and for know with the problem solved and the k problem solved, it should display:</p>\n\n<pre><code>Your number: N /*N is a valid (positive integer) stdin input*/\n0 /*and 0 until the k&lt;b prime values are passed but I will make them to be displayed*/\na prime number\n0 \nthe next prime number\n0 \nthe next prime number\n0 \nthe next prime number\n0 \nthe next prime number\n0 \n.\n.\nthe last prime number (which can be N if N is a prime one)\n</code></pre>\n\n<p>The theorem used for this program is:</p>\n\n<ul>\n<li>You choose a number</li>\n<li>You calculate its square root</li>\n<li>1, here is not a considered prime number because it divides all prime\nnumbers.</li>\n<li>You write all the numbers from 2 to the number you choose</li>\n<li>You remove every multiples of prime numbers (the prime numbers used here are those under the square root) every where in the written list (here an array where we write 0 because I don't know how to use structs (list?) for now). </li>\n<li>The numbers which stay are all prime numbers under the one you chose (rest? sorry for my bad English)</li>\n</ul>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "regex"], "comments": [{"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 0, "creation_date": 1537368529, "post_id": 52408419, "comment_id": 91760871, "body": "A <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> would be welcome. There is no indication of how your input data is formatted and your ultimate goal, but if everything is like <code>W SYSREVIEW.LOG</code> you don&#39;t need regex at all. Or at least a much simpler regex could be used."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1537368567, "post_id": 52408419, "comment_id": 91760899, "body": "What you call a <code>match</code> here is in fact a group. You will have as group amount equal to number of capturing groups in the pattern + 1 for the whole match. Besides, <code>\\.</code> should be <code>.</code> and you should remove <code>|</code> in all bracket expressions."}, {"owner": {"reputation": 1550, "user_id": 158787, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfe163077b96d47a0fcbe69c56bf5365?s=128&d=identicon&r=PG", "display_name": "GoinOff", "link": "https://stackoverflow.com/users/158787/goinoff"}, "reply_to_user": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 0, "creation_date": 1537369421, "post_id": 52408419, "comment_id": 91761454, "body": "@sidyll edited my post to show <code>TESTY.LOG</code> instead of <code>SYSREVIEW.LOG</code> for <code>temp</code>"}, {"owner": {"reputation": 1550, "user_id": 158787, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfe163077b96d47a0fcbe69c56bf5365?s=128&d=identicon&r=PG", "display_name": "GoinOff", "link": "https://stackoverflow.com/users/158787/goinoff"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537370206, "post_id": 52408419, "comment_id": 91761987, "body": "@Wiktor - Modified my regex to <code>&quot;^([WM])[[:space:]]([[:alnum:].]+)[[:space:]]*$&quot;</code> as shown in rici&#39;s post below."}], "answers": [{"comments": [{"owner": {"reputation": 1550, "user_id": 158787, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfe163077b96d47a0fcbe69c56bf5365?s=128&d=identicon&r=PG", "display_name": "GoinOff", "link": "https://stackoverflow.com/users/158787/goinoff"}, "edited": false, "score": 0, "creation_date": 1537368802, "post_id": 52408513, "comment_id": 91761042, "body": "D&#39;ohh!! Yep, that was it. Works perfect now..Similar to <code>${BASH_REMATCH[1]}</code> in bash script.."}, {"owner": {"reputation": 1550, "user_id": 158787, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfe163077b96d47a0fcbe69c56bf5365?s=128&d=identicon&r=PG", "display_name": "GoinOff", "link": "https://stackoverflow.com/users/158787/goinoff"}, "edited": false, "score": 0, "creation_date": 1537370072, "post_id": 52408513, "comment_id": 91761903, "body": "@ rici modified my regular expression to use your example with <code>[:alnum:]</code>. Thx!!"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1537369006, "last_edit_date": 1537369006, "creation_date": 1537368157, "answer_id": 52408513, "question_id": 52408419, "link": "https://stackoverflow.com/questions/52408419/c-language-regex-matching-mutiple-parts-of-a-string/52408513#52408513", "title": "c language regex matching mutiple parts of a string", "body": "<p>Match 0 is the part of the string matched by the entire regex (Perl's <code>$&amp;</code>). Match <em>i</em> for <em>i</em> &gt; 0 is the part of the match corresponding to capture number <em>i</em>, the same as Perl's <code>$1, $2, &hellip;</code>. You have two captures, so you should expect three matches. But you specify MAX_MATCH as 2, so the last match is discarded.</p>\n\n<hr>\n\n<p>Also, the regular expression</p>\n\n<pre><code>^([W|M])[[:space:]]([A-Z|0-9|\\.]{1,})[[:space:]]*$\n</code></pre>\n\n<p>is a little odd. I think you should reread the documentation about character classes in regular expressions -- in this case, it is the same in Perl as it is in Posix extended REs. <code>[W|M]</code> matches any of the three characters <kbd>W</kbd>, <kbd>|</kbd> or <kbd>M</kbd>. Similarly, <code>[A-Z|0-9|\\.]{1,}</code> matches one or more of a letter, a digit, the character <kbd>|</kbd> or the character <kbd>.</kbd>.</p>\n\n<p>The backslash is irrelevant since it only escapes the <kbd>.</kbd> in the string literal, where escaping is unnecessary. If you had compiled with warnings enabled, <code>-Wall</code>, your C compiler would probably have warned you that the escape sequence is not legal. If you had actually passed the backslash on to the regex library, it would have interpreted it as another possible match for the character class.</p>\n\n<p>Also, <code>{1,}</code> can be conveniently written as <code>+</code>, both in Perl and in Posix Extended REs.</p>\n\n<p>In short, what you probably wanted was:</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"^([WM])[[:space:]]([A-Z0-9.]+)[[:space:]]*$\", REG_EXTENDED)\n</code></pre>\n\n<p>You could also use</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"^([WM])[[:space:]]([[:alnum:].]+)[[:space:]]*$\", REG_EXTENDED)\n</code></pre>\n"}], "owner": {"reputation": 1550, "user_id": 158787, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfe163077b96d47a0fcbe69c56bf5365?s=128&d=identicon&r=PG", "display_name": "GoinOff", "link": "https://stackoverflow.com/users/158787/goinoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 52408513, "answer_count": 1, "score": 0, "last_activity_date": 1537372917, "creation_date": 1537367901, "last_edit_date": 1537372917, "question_id": 52408419, "link": "https://stackoverflow.com/questions/52408419/c-language-regex-matching-mutiple-parts-of-a-string", "title": "c language regex matching mutiple parts of a string", "body": "<p>I have a <code>c</code> program where I can't get the regular expression matching to work the way I want. Basically, I want to match the 1st char (W or M) in <code>testStr</code> and the name of the log file as the second match (TESTY.LOG).  Here is what I have so far:</p>\n\n<pre><code>#include    &lt;stdio.h&gt;\n#include    &lt;stdlib.h&gt;\n#include    &lt;regex.h&gt;\n#define     MAX_MATCHES 2\n.....\nchar testStr[20]=\"W TESTY.LOG \";\nchar temp[100];\nint reti;\nregex_t regex;\nregmatch_t matches[MAX_MATCHES];\nint i;\nint numchars;\n\n/* Compile regular expression */\nreti = regcomp(&amp;regex, \"^([W|M])[[:space:]]([A-Z|0-9|\\.]{1,})[[:space:]]*$\", REG_EXTENDED);\n/* Execute regular expression */\nreti = regexec(&amp;regex, testStr, MAX_MATCHES, matches, 0);\nif (!reti) {\n  for (i=0; i &lt; MAX_MATCHES; i++) {\n    numchars = (int)matches[i].rm_eo - (int)matches[i].rm_so;\n    strncpy(temp,testStr+matches[i].rm_so,numchars);\n    temp[numchars] = '\\0';\n  }\n}\n</code></pre>\n\n<p>When I run this in gdb, I see the following for matches:</p>\n\n<p><code>(gdb) display matches\n1: matches = {{rm_so = 0, rm_eo = 15}, {rm_so = 0, rm_eo = 1}}</code></p>\n\n<p><code>2: temp = \"W TESTY.LOG\"</code></p>\n\n<p>and</p>\n\n<p><code>2: temp = \"W\"</code></p>\n\n<p>So, I'm getting the first char OK but I am not getting just the log file name for the second match.  I use regex in perl but I'm new to regex in ansi c.  I feel like I'm missing something basic here.</p>\n"}, {"tags": ["c", "gcc"], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1537365930, "post_id": 52407632, "comment_id": 91759197, "body": "working. And for cmake I needed to escape the escape char and the double quote. Thanks"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1537366502, "post_id": 52407632, "comment_id": 91759566, "body": "Also try <code>-DMBEDTLS_CONFIG_FILE=&#39;&quot;test.h&quot;&#39;</code> which may be more palatable to cmake."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1537365465, "creation_date": 1537365465, "answer_id": 52407632, "question_id": 52407582, "link": "https://stackoverflow.com/questions/52407582/using-gcc-d-option/52407632#52407632", "title": "using GCC -D option", "body": "<p>It's the <em>shell</em> that removes the quotes from the string you pass. You need to escape the quotes to keep them in the macro:</p>\n\n<pre><code>arm-none-eabi-gcc main.c -DMBEDTLS_CONFIG_FILE=\\\"test.h\\\"\n</code></pre>\n"}], "owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52407632, "answer_count": 1, "score": 1, "last_activity_date": 1537365465, "creation_date": 1537365326, "question_id": 52407582, "link": "https://stackoverflow.com/questions/52407582/using-gcc-d-option", "title": "using GCC -D option", "body": "<p>I did a minimal c file (main.c)</p>\n\n<pre><code>#if !defined(MBEDTLS_CONFIG_FILE)\n    #error \"not defined\"\n#else\n    #include MBEDTLS_CONFIG_FILE\n#endif\n\nint main(void)\n{\n    while(1);\n}\n</code></pre>\n\n<p>now calling <code>arm-none-eabi-gcc main.c</code> gives <code>error: #error \"no defined\"</code> and this is OK.</p>\n\n<p>But calling <code>arm-none-eabi-gcc main.c -DMBEDTLS_CONFIG_FILE=\"test.h\"</code> gives <code>error: #include expects \"FILENAME\" or &lt;FILENAME&gt;</code> so it is defined but not to the value I expect.</p>\n\n<p>What is the correct syntax ? (context: this is working from the IDE but I want to move to cmake)</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1537365418, "post_id": 52407576, "comment_id": 91758853, "body": "You can, but the behavior will be implementation defined as the types are considered to be incompatible. And theoretically the pointers might have different sizes and point to different memories. The only pointer type which is compatible with any other is <code>void *</code>."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1537365581, "post_id": 52407576, "comment_id": 91758958, "body": "@EugeneSh. can it be done with or without casting?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1537365601, "post_id": 52407576, "comment_id": 91758974, "body": "This is something you can try yourself."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1537366177, "post_id": 52407576, "comment_id": 91759345, "body": "A char pointer can safely alias another object, i.e. if you have a int pointer it ok to assign it to a char pointer. See <a href=\"https://stackoverflow.com/a/35496066/4386427\">stackoverflow.com/a/35496066/4386427</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537369049, "post_id": 52408542, "comment_id": 91761200, "body": "This is overly simplistic. Assignments between <code>T1 *</code> and <code>T2 *</code> are allowed if <code>T1</code> and <code>T2</code> are compatible, even if they are different."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537372248, "post_id": 52408542, "comment_id": 91763208, "body": "&quot;unless at least one of T1 and T2 is void&quot; has a corner exception. pointer to a function. A pointer to a function and <code>void*</code> are not specified to well convert.  Even in 2018, various machines have different size function pointers and <code>void*</code>.  Your answer does well apply to <code>void*</code> and <i>object</i> pointers."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537373034, "post_id": 52408542, "comment_id": 91763667, "body": "@chux Another good point.  Answer amended again. I shouldn&#39;t try to answer in a hurry. (And speaking of function pointers, let&#39;s not get into the magical world of split I&amp;D address spaces...)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537373767, "post_id": 52408542, "comment_id": 91764067, "body": "Note about the &quot;all popular .. today&quot; in &quot;especially on machines (such as all popular ones today) with &quot;flat&quot; address spaces.  The number of embedded processors  now is  over a <a href=\"https://en.wikipedia.org/wiki/Microchip_Technology#Microcontrollers\" rel=\"nofollow noreferrer\">billion/year</a>.  A significant percentage use non-flat compatible object/function pointers."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 2, "last_activity_date": 1537372927, "last_edit_date": 1537372927, "creation_date": 1537368256, "answer_id": 52408542, "question_id": 52407576, "link": "https://stackoverflow.com/questions/52407576/can-you-assign-pointers-of-different-types-to-each-others/52408542#52408542", "title": "Can you assign pointers of different types to each others?", "body": "<p>When types <code>T1</code> and <code>T2</code> are different, assignments between <code>T1 *p1</code> and <code>T2 *p2</code> are formally disallowed, unless at least one of <code>T1</code> and <code>T2</code> is <code>void</code> and the other is an object (not function) type.</p>\n\n<p>In many cases incompatible assignments will work in practice, especially on machines (such as all popular ones today) with \"flat\" address spaces and where all pointer types share the same internal representation.</p>\n\n<p>After a \"mixed-mode\" pointer assignment, however, problems may very well occur when the pointers are dereferenced, due to (1) alignment issues and (2) <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing</a>.</p>\n\n<p>Since \"mixed mode\" pointer assignments are formally illegal and often a bad idea, most compilers will warn about them.  Most compilers allow the warnings to be suppressed with an explicit cast.  Most of the time, the cast serves only to suppress the warning; it does not introduce any actual conversion that wouldn't have been performed anyway.  (That is, changing <code>p1 = p2</code> to <code>p1 = (T1 *)p2</code> is a lot like changing <code>i = f</code> to <code>i = (int)f</code>, where <code>i</code> is an int and <code>f</code> is a float.)</p>\n\n<hr>\n\n<p>Addendum: I wrote, \"When types <code>T1</code> and <code>T2</code> are different,\" but a more precise statement would be when they are <em>incompatible</em>.  For example, types <code>char</code> and <code>unsigned char</code> are compatible, so assignment between pointers of those types is fine. See Eric Postpischil's longer answer for more details.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537372412, "post_id": 52408718, "comment_id": 91763304, "body": "1) Good this answer brings up difference between pointer to an object type and function types.  2) I&#39;d highlight the important last paragraph or put its conclusion also at the beginning."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1537369144, "last_edit_date": 1537369144, "creation_date": 1537368800, "answer_id": 52408718, "question_id": 52407576, "link": "https://stackoverflow.com/questions/52407576/can-you-assign-pointers-of-different-types-to-each-others/52408718#52408718", "title": "Can you assign pointers of different types to each others?", "body": "<p>First, let\u2019s consider assignment without casting. C 2018 6.5.16.1 1 lists constraints for simple assignment, saying that one of them must hold. The first two are for arithmetic, structure, and union types. The last two deal involve null pointer constants or <code>_Bool</code>. The middle two deal with assigning pointers to pointers:</p>\n\n<ul>\n<li><p>the left operand has atomic, qualified, or unqualified pointer type, and \u2026 both operands are pointers to qualified or unqualified versions of compatible types, and the type pointed to by the left has all the qualifiers of the type pointed to by the right</p></li>\n<li><p>the left operand has atomic, qualified, or unqualified pointer type, and \u2026 one operand is a pointer to an object type, and the other is a pointer to a qualified or unqualified version of void, and the type pointed to by the left has all the qualifiers of the type pointed to by the right</p></li>\n</ul>\n\n<p>The latter says we can assign <code>void *</code> to any object pointer and vice-versa, as long as no qualifiers (<code>const</code>, <code>volatile</code>, <code>restrict</code>, or <code>__Atomic</code>) are removed.</p>\n\n<p>The former says we can assign pointers to compatible types, as long as no qualifiers are removed. What are compatible types?</p>\n\n<p>6.2.7 1 says:</p>\n\n<ul>\n<li>Two types are compatible if they are the same.</li>\n<li>Additional rules are in 6.7.2, 6.7.3, and 6.7.6.</li>\n<li>Two structure, union, or enumerated types declared in separate translation units are compatible if they are, in essence, declared identically. (Interestingly, two such types declared in the <strong>same</strong> translation unit are not compatible.)</li>\n</ul>\n\n<p>6.7.2 4 says each enumerated type (an <code>enum</code> type) is compatible with an implementation-defined choice of <code>char</code> or a signed or unsigned integer type. So a pointer to some <code>enum</code> can be assigned to a pointer to one <code>char</code> or integer type (and vice-versa), but you cannot know which one without knowing something about the particular C implementation.</p>\n\n<p>6.7.3 11 says qualified types must have the same qualifiers to be compatible. Thus an <code>int</code> is not compatible with a <code>const int</code>, and this prevents an <code>int *</code> from being assigned to a <code>const int *</code>.</p>\n\n<p>6.7.6.1 2 says for two pointer types to be compatible, they must be identically qualified pointers to compatible types. This tells us, for example, that <code>int *</code> is not compatible with <code>char *</code>, and, therefore, by assignment constraints above, a <code>char **</code> may not be assigned to an <code>int **</code>.</p>\n\n<p>6.7.6.2 6 says for two array types to be compatible, they must have compatible element types and, if they both have integer constant sizes, they must be the same. (This allows that an array with unknown size may be compatible with an array of known size. However, additional text says that if the arrays ultimately have different sizes, using them in a context that requires them to be compatible has undefined behavior. So an assignment of pointers to such arrays may satisfy its constraints and compile without error, but the resulting program may misbehave.)</p>\n\n<p>6.7.6.3 15 presents somewhat complicated rules for the compatibility of function types. These rules are complicated because functions may be declared with or without parameter lists, with ellipses, and so on. I will omit complete discussion of these.</p>\n\n<p>Those are the rules that tell you what pointer assignments may be made without casts.</p>\n\n<p>6.5.4 discusses casts. Its constraints do not restrict which pointer types may be converted to which other pointer types. (They do prohibit other things involving pointers, such as converting a pointer type to a floating-point type.) So you can specify any pointer conversion you want in a cast, and, as long as the resulting type is compatible with the type to which it is being assigned, no assignment or cast constraint is violated. However, there is a still a question about whether the conversion is proper.</p>\n\n<p>6.3.2.3 specifies rules for pointer conversions. Those dealing with conversion from pointers to pointers (excluding integers and null pointer constants) say:</p>\n\n<ul>\n<li><p>Any pointer to an object type (not to function types) may be converted to a pointer to void and vice-versa. The result of converting an object pointer to a void pointer and back compares equal to the original.</p></li>\n<li><p>A pointer may be converted to the same type with more qualifiers, and the result compares equal to the original.</p></li>\n<li><p>A pointer to an object type may be converted to a pointer to a different object type if the resulting pointer is correctly aligned for its type (otherwise, the behavior is undefined). When converted back, the result compares equal to the original pointer. (Note that, while you are allowed to make this conversion, this rule does not say the resulting pointer may be <strong>used</strong> to access an object of the new type. There are other rules in C about that.)</p></li>\n<li><p>A pointer to a function type may be converted to a pointer to another function type. When converted back, the result compares equal to the original pointer. (As with objects, you are allowed to make this conversion, but using the resulting pointer to call an incompatible function has undefined behavior.)</p></li>\n</ul>\n\n<p>So, when casts are used, you may convert any object pointer type to any object pointer type and assign it as long as the alignment requirement is satisfied, and you may convert any function pointer type to any function pointer type and assign it.</p>\n"}], "owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 1, "accepted_answer_id": 52408542, "answer_count": 2, "score": 0, "last_activity_date": 1537372927, "creation_date": 1537365312, "question_id": 52407576, "link": "https://stackoverflow.com/questions/52407576/can-you-assign-pointers-of-different-types-to-each-others", "title": "Can you assign pointers of different types to each others?", "body": "<p>Considering</p>\n\n<pre><code>T1 *p1;\nT2 *p2;\n</code></pre>\n\n<p>Can we assign p1 to p2 or vice versa? If so, can it be done without the casting or we must use a cast?</p>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1537364677, "post_id": 52407346, "comment_id": 91758362, "body": "This code invokes undefined behaviour.in multiple places Also learn about the effective type (aka &quot;strict aliasing&quot;) rule."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 2, "creation_date": 1537365453, "post_id": 52407346, "comment_id": 91758874, "body": "UB concerns aside, is this a question about big-endian vs little-endian storage?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1537367870, "post_id": 52407346, "comment_id": 91760483, "body": "well.... <code>fourbyte = *((unsigned int *)tab);</code> ==&gt; <code>fourbyte = (unsigned int *)tab;</code>  and <code>printf(&quot;fourbyte : %u\\n&quot;, fourbyte);</code> == &gt; <code>printf(&quot;fourbyte : %u\\n&quot;, *fourbyte);</code> but there are still other problems with your approach"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1537368288, "post_id": 52407346, "comment_id": 91760704, "body": "Quote: &quot;why the unsigned int pointer point on the last byte instead of the first&quot; Read about endianess (yours are apperently little endian) BTW: There is no way the posted code can produce the said output. Please post the correct code"}, {"owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "edited": false, "score": 0, "creation_date": 1537369834, "post_id": 52407346, "comment_id": 91761731, "body": "yep i read about the endianess, that explain why this could happen, and that was more a problem of understanding this behavior, so that was just an example, but I change my way to do it because of the strict aliasing problem !"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537374095, "post_id": 52407346, "comment_id": 91764232, "body": "In such investigative code, it is more informative to use non-decimal output such as <code>printf(&quot;fourbyte : %X\\n&quot;, fourbyte);</code> (X not u).  234881024 is 0x0E000000"}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1537372688, "post_id": 52409850, "comment_id": 91763466, "body": "I agree that endianess likely explains the results in this case. It should still be emphatically pointed out that when it comes to UB, you can&#39;t count on any result representing anything. The compiler is free to format your hard drive or deliver a much deserved high voltage potential between the coders seat and ground."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537375956, "post_id": 52409850, "comment_id": 91765181, "body": "There is no portable means to determine endianess of the underlying architecture in C. Given <code>uint_8 array[sizeof(uint32_t)] = {0xa5}; uint_8 *a = array; uint32_t *b = (uint_8*)array;</code>, it is entirely possible that even if <code>(size_t)a == (size_t)b</code>, they could be pointing at entirely different ranges of memory. Nothing in the language spec says that any scalar value must have the same alignment as any other, much less the alignment of an array of type and any other type. In fact, int types and char types could be located in different virtual memory blocks."}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 0, "last_activity_date": 1537372708, "last_edit_date": 1537372708, "creation_date": 1537372434, "answer_id": 52409850, "question_id": 52407346, "link": "https://stackoverflow.com/questions/52407346/unexpected-byte-order-after-casting-pointer-to-char-into-pointer-to-int/52409850#52409850", "title": "unexpected byte order after casting pointer-to-char into pointer-to-int", "body": "<p>Your example code is running on a computer that is Little-Endian. This term means that the \"first byte\" of an integer contains the least significant bits. By contrast, a Big-Endian computer stores the most significant bits in the first byte.</p>\n\n<p>Edited to add: the way that you've demonstrated this is decidedly unsafe, as it relies upon <strong>undefined behavior</strong> to get \"direct access\" to the memory. There is a safer demonstration <a href=\"https://stackoverflow.com/questions/12791864/c-program-to-check-little-vs-big-endian\" title=\"here\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "is_accepted": false, "score": 1, "last_activity_date": 1537381519, "creation_date": 1537381519, "answer_id": 52412089, "question_id": 52407346, "link": "https://stackoverflow.com/questions/52407346/unexpected-byte-order-after-casting-pointer-to-char-into-pointer-to-int/52412089#52412089", "title": "unexpected byte order after casting pointer-to-char into pointer-to-int", "body": "<p>The correct answer here is that you should not have expected any relationship, order or otherwise. Except for unions, the C standard does not define a linear address space in which objects of different types can overlap. It is the case on many architecture/compiler-tool-chain combinations that these coincidences can occur from time to time, but you should never rely on them. The fact that by casting a pointer to a suitable scalar type yields a number comparable to others of the same type, in no-way implies that number is any particular memory address.</p>\n\n<p>So:</p>\n\n<pre><code>int* p;\nint z = 3;\nint* pz = &amp;z;\nsize_t cookie = (size_t)pz;\np = (int*)cookie;\nprintf(\"%d\", *p); // Prints 3.\n</code></pre>\n\n<p>Works because the standard says it must work when <code>cookie</code> is derived from the same type of pointer that it is being converted to. Converting to any other type is undefined behavior. Pointers do not represent memory, they reference 'storage' in the abstract. They are merely references to objects or NULL, and the standard defines how pointers to the same object must behave and how they can be converted to scalar values and back again.</p>\n\n<p>Given:</p>\n\n<pre><code>char array[5] = \"five\";\n</code></pre>\n\n<p>The standard says that <code>&amp;(array[0]) &lt; &amp;(array[1])</code> and that <code>(&amp;(array[0])) + 1) == &amp;(array[1])</code>, but it is mute on how elements in <code>array</code> are ordered in memory. The compiler writers are free to use whatever machine codes and memory layouts that they deem are appropriate for the target architecture.</p>\n\n<p>In the case of unions, which provides for some overlap of objects in storage, the standard only says that each of its fields must be suitably aligned for their types, but just about everything else about them is implementation defined. The key clause is <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.6.1p7\" rel=\"nofollow noreferrer\">6.2.6.1 p7</a>:</p>\n\n<blockquote>\n  <p>When a value is stored in a member of an object of union type, the bytes of the object representation that do not correspond to that member but do correspond to other members take unspecified values.</p>\n</blockquote>\n\n<p>The gist of all of this is that the C standard defines an abstract machine. The compiler generates an architecture specific simulation of that machine based on your code. You cannot understand the C abstract machine through simple empirical means because implementation details bleed into your data set. You must limit your observations to those that are relevant to the abstraction. Therefore, avoid undefined behavior and be very aware of implementation defined behaviors. </p>\n"}], "owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537381519, "creation_date": 1537364589, "last_edit_date": 1537370111, "question_id": 52407346, "link": "https://stackoverflow.com/questions/52407346/unexpected-byte-order-after-casting-pointer-to-char-into-pointer-to-int", "title": "unexpected byte order after casting pointer-to-char into pointer-to-int", "body": "<pre><code>unsigned char tab[4] = 14;\n</code></pre>\n\n<p>If I print as individual bytes...</p>\n\n<pre><code>printf(\"tab[1] : %u\\n\", tab[0]); // output: 0\nprintf(\"tab[2] : %u\\n\", tab[1]); // output: 0\nprintf(\"tab[3] : %u\\n\", tab[2]); // output: 0\nprintf(\"tab[4] : %u\\n\", tab[3]); // output: 14\n</code></pre>\n\n<p>If I print as an integer...</p>\n\n<pre><code>unsigned int *fourbyte;\nfourbyte = *((unsigned int *)tab);\nprintf(\"fourbyte : %u\\n\", fourbyte); // output: 234881024\n</code></pre>\n\n<p>My output in binary is : 00001110 00000000 00000000 00000000, which is the data I wanted but in this order tab[3] tab[2] tab[1] tab[0].\nAny explanation of that, why the unsigned int pointer points to the last byte instead of the first ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 6, "creation_date": 1537363662, "post_id": 52406955, "comment_id": 91757681, "body": "<code>if(args &lt; 2 || args &gt; 2)</code> == <code>if (args != 2)</code> ;)"}, {"owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1537363741, "post_id": 52406955, "comment_id": 91757733, "body": "Haha thank you. Of course :)"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1537363943, "post_id": 52406955, "comment_id": 91757874, "body": "It is not recommended to exit from a function, use a return instead"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 1, "creation_date": 1537364079, "post_id": 52406955, "comment_id": 91757968, "body": "If you use your function in e.g. a library and it suddenly stops working, because an error occured and you do <code>exit(1)</code>, it is not the expected behavoir. It is okay of course for such small examples, but this is a no-go in a large(r) codebase."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537364302, "post_id": 52406955, "comment_id": 91758108, "body": "The debugger is your friend. And for the documentation: any C textbook. You can&#39;t learn programming by copy/paste snippets. A program is not a Quilt."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1537364797, "post_id": 52406955, "comment_id": 91758441, "body": "@hellow: <code>exit</code> is fine if you <b>want</b> to exit. That&#39;s not about recommendations, but about different functionalities."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537363872, "post_id": 52407033, "comment_id": 91757828, "body": "That did the trick. Now it doesn&#39;t print any value though, so I will have to figure this out as well. Thought it should work when it entered the loop though. Hmm."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "reply_to_user": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537363916, "post_id": 52407033, "comment_id": 91757855, "body": "@kthonenice because you print <code>printf(&quot;%02x hexabytes\\n&quot;, len);</code> and not the actual buffer you read"}, {"owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537363960, "post_id": 52407033, "comment_id": 91757886, "body": "Yes, but if I try to add buffer instead of len I need to change the format from %02x?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1537364510, "post_id": 52407033, "comment_id": 91758251, "body": "Please get a textbook. This site is for <b>specific</b> questions about <b>specific</b> problems, not for tutoring. You will not learn C from asking singular questions, you need the foundations."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1537363684, "creation_date": 1537363684, "answer_id": 52407033, "question_id": 52406955, "link": "https://stackoverflow.com/questions/52406955/printing-byte-by-byte/52407033#52407033", "title": "Printing byte by byte", "body": "<p>You need to reset the file pointer to the beginning of the file:</p>\n\n<pre><code>fseek(fp, 0, SEEK_SET);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537364372, "post_id": 52407121, "comment_id": 91758154, "body": "Thank you for clarifying. I see now that my file was already at the end.   I wonder how your char byte works. The example I looked up specified the size as I did with my initial buffer, but you do something different I see. Not really sure how your fread works compared to mine, but it does seem like your implementation works as I intended mine should!"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537364478, "post_id": 52407121, "comment_id": 91758231, "body": "The loop reads one byte at a time, reading larger amounts at once is often used for performance, but then for this you still need 1 printf per byte or to format a string by other means."}, {"owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "edited": false, "score": 0, "creation_date": 1537364683, "post_id": 52407121, "comment_id": 91758365, "body": "Just have to look up some basic syntax to make sure I understand everything. But thank you for letting me know where I messed up! Much appreciated!"}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 1, "last_activity_date": 1537364276, "last_edit_date": 1537364276, "creation_date": 1537363955, "answer_id": 52407121, "question_id": 52406955, "link": "https://stackoverflow.com/questions/52406955/printing-byte-by-byte/52407121#52407121", "title": "Printing byte by byte", "body": "<p>You seek to the end of the file, so <code>fread</code> will have nothing to read. You need to seek back to the start.</p>\n\n<p>The <code>fread</code> is also being asked to read the length of the path, which seems wrong, the way your loop is set up seems to be for 1 byte at a time.</p>\n\n<pre><code>fseek(fp, 0, SEEK_END); // Seeks to end of file\nint len = ftell(fp);\n\n// Nothing to read, at end\nwhile (fread(buffer, strlen(path), 1, fp) == 1){\n    printf(\"%02x hexabytes\\n\", len);\n}\n</code></pre>\n\n<p>Simply seek again after the <code>ftell</code>.</p>\n\n<pre><code>fseek(fp, 0, SEEK_END); // Seeks to end of file\nint len = ftell(fp);\nfseek(fp, 0, SEEK_SET); // Go to start again\n// Read from start, 1 byte at a time\nchar byte;\nwhile (fread(&amp;byte, 1, 1, fp) == 1){\n    printf(\"%02X\\n\", (int)byte);\n}\n</code></pre>\n\n<p>You could also read 1000 bytes at a time (as your <code>buffer</code> is) but then you need a second loop, or you could read the entire file, but you need to dynamically allocate the buffer (<code>buffer = malloc(len);</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1537367482, "creation_date": 1537367482, "answer_id": 52408283, "question_id": 52406955, "link": "https://stackoverflow.com/questions/52406955/printing-byte-by-byte/52408283#52408283", "title": "Printing byte by byte", "body": "<p>Even if you fix the <code>fseek</code> problem, you have other issues:</p>\n\n<pre><code>while (fread(buffer, strlen(path), 1, fp) == 1){\n  printf(\"%02x hexabytes\\n\", len);\n}\n</code></pre>\n\n<p>Note that you are not reading a single byte at a time; you're reading bytes in <code>strlen(path)</code>-sized chunks at a time.</p>\n\n<p>You're also not printing the byte(s) you just read; you're printing the <em>length of the file</em>.  So assuming your file size is, say, 65536 bytes, you'll get the output</p>\n\n<pre><code>10000 hexabytes\n10000 hexabytes\n10000 hexabytes\n...\n</code></pre>\n\n<p><code>65536 / strlen(path)</code> times.  I don't think that's what you want.</p>\n\n<p>I think what you're going for is something more along these lines:</p>\n\n<pre><code>unsigned char buffer[1000]; // for arbitrary bytes, unsigned char works better.\n\nint bytes_read = 0;\n\nwhile ( (bytes_read = fread( buffer, 1, sizeof buffer, fp )) != EOF )\n{\n  for( int b = 0; b &lt; bytes_read; b++ )\n  {\n    printf( \"%02hhx\\n\", buffer[b] ); // %x expects unsigned *int*, use the\n  }                                  // hh modifier to specify unsigned char\n}\n</code></pre>\n\n<p>The expression</p>\n\n<pre><code>bytes_read = fread( buffer, 1, sizeof buffer, fp )\n</code></pre>\n\n<p>reads up to <code>sizeof buffer</code> (1000 in this case) bytes from <code>fp</code> and stores the number actually read to <code>bytes_read</code>.  If we haven't hit <code>EOF</code>, then we print the contents of <code>buffer</code>.  </p>\n"}], "owner": {"reputation": 167, "user_id": 6879352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/87b4d9e6a98c035b8c93ff76392a841d?s=128&d=identicon&r=PG&f=1", "display_name": "DonutSteve", "link": "https://stackoverflow.com/users/6879352/donutsteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "closed_date": 1537379852, "accepted_answer_id": 52407121, "answer_count": 3, "score": -3, "last_activity_date": 1537367482, "creation_date": 1537363494, "question_id": 52406955, "link": "https://stackoverflow.com/questions/52406955/printing-byte-by-byte", "closed_reason": "Needs more focus", "title": "Printing byte by byte", "body": "<p>I am trying to make a C program which opens a file and prints its byte by byte using the Hexabyte format (%02x) for each byte. </p>\n\n<p>The result should be something like this:</p>\n\n<pre><code>$ ./hexabyte file\n43\n3d\n67\n...\n</code></pre>\n\n<p>I know I want to use fread to do this, but I am not sure why this solution doesn't work:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;errno.h&gt;\n#include&lt;string.h&gt;\n\n\nint args_test(int args, char path[]){\n\n  if(args &lt; 1){\n    fprintf(stderr, \"Usage: %s path\\n\", path);\n    exit(EXIT_SUCCESS);\n  }\n  if(args &lt; 2){\n    fprintf(stderr, \"Usage: %s path\\n\", path);\n    exit(EXIT_SUCCESS);\n  }\n\n  if(args &gt; 2){\n    fprintf(stderr, \"Usage: %s path\\n\", path);\n    exit(EXIT_SUCCESS);\n  }\n\n  return 0;\n}\n\n\nint open_file(char path[]){\n  FILE *fp;\n  fp = fopen(path, \"r\");\n  char buffer[1000];\n\n  if(!fp){\n    fprintf(stderr, \"%s\\n\", strerror(errno));\n    return EXIT_FAILURE;\n  }\n\n  fseek(fp, 0, SEEK_END);\n  int len = ftell(fp);\n\n  //Why does it not reach this loop?\n  while (fread(buffer, strlen(path), 1, fp) == 1){\n    printf(\"%02x hexabytes\\n\", len);\n  }\n\n  fclose(fp);\n\n  exit(EXIT_SUCCESS);\n}\n\nint main(int args, char* argv[]){\n  if(args &lt; 2 || args &gt; 2){\n    args_test(args, argv[0]);\n  }\n  args_test(args, argv[1]);\n  open_file(argv[1]);\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>It seems like it never reaches my while loop, and therefor never prints anything </p>\n"}, {"tags": ["c", "gcc", "signal-processing", "compiler-flags"], "comments": [{"owner": {"reputation": 525, "user_id": 2747961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2f020f3f1b168067b0b1c06fb1094081?s=128&d=identicon&r=PG&f=1", "display_name": "ddz", "link": "https://stackoverflow.com/users/2747961/ddz"}, "edited": false, "score": 2, "creation_date": 1537361192, "post_id": 52406122, "comment_id": 91756069, "body": "You could try using <code>-march=name[+option...]</code> with the <code>\u2018+nodsp\u2019</code> option. An example would be <code>-march=armv8-m.main+nodsp</code>."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 1, "creation_date": 1537361256, "post_id": 52406122, "comment_id": 91756107, "body": "If you know what instructions you want it to emit, could you just write the mac in assembler?"}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1537361546, "post_id": 52406122, "comment_id": 91756303, "body": "@colin yes, I had that idea too, but I still hope it can be done using some compiler flags"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1537364108, "post_id": 52406122, "comment_id": 91757981, "body": "The gcc manual is quite fine. What did you try and why did it not work?"}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537365113, "post_id": 52406122, "comment_id": 91758649, "body": "@toohonestforthissite i have got a manual from the tricore-gcc compiler and did not find anything about such a feature."}], "owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1537360904, "creation_date": 1537360904, "question_id": 52406122, "link": "https://stackoverflow.com/questions/52406122/gcc-force-not-to-use-dsp", "title": "gcc force not to use DSP", "body": "<p>Is it possible to force a tricore-gcc (which has mostly the same flags as gcc) compiler to not use special instructions?</p>\n\n<p>I want to measure the run time of code on a microcontroller which has DSP capabilities.</p>\n\n<pre><code>uint32_t c[100],b[100],a[100];\nfor(int i=0; i&lt;100; i++){\n    c[i] += a[i]*b[i];\n}\n</code></pre>\n\n<p>for example is translated to a special MAC instruction which uses the DSP and will return the result faster than the ALU would calculate it.</p>\n\n<p>I now want to test how much faster it is, not by manually counting cycles given in the manual (because of stalls etc..). Is it somehow possible to tell the compiler not to use the DSP, or more specifically not to use one special assembly instruction?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "opencl"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1537360911, "post_id": 52406074, "comment_id": 91755930, "body": "1) Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> 2) What error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3879250"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1537361245, "post_id": 52406074, "comment_id": 91756100, "body": "The error is &quot;no matching function call to isequal&quot;."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537361347, "post_id": 52406074, "comment_id": 91756164, "body": "Is there some version of <code>isequal</code> dealing with <code>char8</code>? I didn&#39;t see one."}], "answers": [{"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537361288, "post_id": 52406198, "comment_id": 91756127, "body": "I am not sure if this answer covers the openCL touch of the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3879250"}, "edited": false, "score": 0, "creation_date": 1537361347, "post_id": 52406198, "comment_id": 91756165, "body": "This gives me the error, &quot;Implicit declaration of a function &#39;memcmp&#39; is illegal in OpenCL&quot;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537361398, "post_id": 52406198, "comment_id": 91756201, "body": "@SupremeGrandRuler You need header <code>&lt;string.h&gt;</code> for <code>memcmp</code>"}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537361612, "post_id": 52406198, "comment_id": 91756349, "body": "@Gerhardh This doesn&#39;t work in OpenCL. There is no C standard library available."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -2, "last_activity_date": 1537361157, "creation_date": 1537361157, "answer_id": 52406198, "question_id": 52406074, "link": "https://stackoverflow.com/questions/52406074/checking-whether-two-char-vectors-are-equal-in-opencl/52406198#52406198", "title": "Checking whether two char vectors are equal in OpenCL?", "body": "<p>you need to use <code>memcmp</code> function instead.</p>\n\n<p><code>#define MIN(x,y) ((x) &gt; (y) ? (y) : (x))</code></p>\n\n<p><code>memcmp(a,b, MIN(sizeof(a), sizeof(b)));</code></p>\n\n<blockquote>\n<pre><code>   #include &lt;string.h&gt;\n\n   int memcmp(const void *s1, const void *s2, size_t n);\n</code></pre>\n  \n  <p>The memcmp() function returns an integer less than, equal to, or<br>\n  greater than zero if the first n bytes of s1 is found, respectively,<br>\n  to be less than, to match, or be greater than the first n bytes of<br>\n  s2.</p>\n  \n  <p>For a nonzero return value, the sign is determined by the sign of\n  the    difference between the first pair of bytes (interpreted as\n  unsigned    char) that differ in s1 and s2.</p>\n  \n  <p>If n is zero, the return value is zero.</p>\n</blockquote>\n\n<p>Full description: <a href=\"http://man7.org/linux/man-pages/man3/memcmp.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/memcmp.3.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1537366564, "post_id": 52406571, "comment_id": 91759613, "body": "If you&#39;re going to downvote my answer, please at least leave a comment giving a reason. (Do the suggested approaches not work? Can the answer be improved in some way?)"}], "tags": [], "owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1537366763, "last_edit_date": 1537366763, "creation_date": 1537362351, "answer_id": 52406571, "question_id": 52406074, "link": "https://stackoverflow.com/questions/52406074/checking-whether-two-char-vectors-are-equal-in-opencl/52406571#52406571", "title": "Checking whether two char vectors are equal in OpenCL?", "body": "<p>OpenCL's <code>isequal()</code> function is <a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.2/docs/man/xhtml/isequal.html\" rel=\"nofollow noreferrer\">only defined for the floating-point vector &amp; scalar types</a>, so that's why your first approach doesn't work.</p>\n\n<p>Your second approach is on the right track; I believe the problem is you're comparing a <code>char8</code> (<code>a3</code>) to an <code>int</code> (<code>0</code>). You actually shouldn't need to subtract the vectors, equality should work fine (vector comparison operators yield <code>-1</code> for true, so <code>all()</code>'s test for MSB should work.):</p>\n\n<pre><code>char8 a1 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nchar8 a2 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nif (all(a1 == a2))\n    return 0;\n</code></pre>\n\n<p>Alternatively, you could change the last line of your subtraction approach to:</p>\n\n<pre><code>if (all(a3 == (char8)(0))) return 0;\n</code></pre>\n\n<p>This should also work as you're comparing a <code>char8</code> with another <code>char8</code> (with all 0s) again.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3879250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537366763, "creation_date": 1537360704, "last_edit_date": 1537361426, "question_id": 52406074, "link": "https://stackoverflow.com/questions/52406074/checking-whether-two-char-vectors-are-equal-in-opencl", "title": "Checking whether two char vectors are equal in OpenCL?", "body": "<p>I have two char8 vectors. I would like to check if they are equal.</p>\n\n<p>I am getting an error when using the all function:</p>\n\n<pre><code>char8 a1 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nchar8 a2 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nif (isequal(a1, a2)) return 0; // error on this line\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>char8 a1 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nchar8 a2 = {'a', 'b', 'c', 'd', 'e', 'f','g','h'};\nchar8 a3 = a1 - a2;\nif (all(a3 == 0)) return 0; // error: can't convert from char to int\n</code></pre>\n"}, {"tags": ["c", "file", "input", "pipe", "stdin"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537361758, "post_id": 52405804, "comment_id": 91756453, "body": "If you look yourself at the output of <code>cat .&#47;file.txt</code> how can you tell the filename? Your program gets the same info and will be able to use the same method which you use. If the file name is not visible there, then you can make it visible, by e.g first piping the file name and then the content."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537365252, "post_id": 52405804, "comment_id": 91758753, "body": "@Yunnosch how do i pipe for file name in the program."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537365373, "post_id": 52405804, "comment_id": 91758820, "body": "Maybe as simple as <code>echo .&#47;file.txt | .&#47;pargrep word</code>? To pipe name AND content  requires some commandline syntax magic or, probably easier, a short script."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537365529, "post_id": 52405804, "comment_id": 91758923, "body": "I think you might not need the file name in the case of piped input. Could you double check that the class assignment really requires that? I ask because the specific job to find the filename (if you only get the commandline as shown in the question and you can only influence the implementation of pargrep) might actually be impossible. And I would optimistically assume that your teache did not set an impossible task..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537366332, "post_id": 52405804, "comment_id": 91759454, "body": "assignment is to get the content directly from a file, file would be a large file and need to grep for a word in file and print it, just like grep but need to implement it through threads. im storing the whole file in a string array. Before storing it i got to check for the number of lines in it and then start storing it, so i go to read the file twice. stdin is not allowing me to read it twice .So, i was planning on getting the file name. any clue on how it can be solved?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "edited": false, "score": 0, "creation_date": 1537365321, "post_id": 52405890, "comment_id": 91758793, "body": "his is for an class assignment, i have to process both input from a file and piped input. Is there a way to process piped input to get the file name"}, {"owner": {"reputation": 72, "user_id": 8900754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDhvL.jpg?s=128&g=1", "display_name": "dernst", "link": "https://stackoverflow.com/users/8900754/dernst"}, "edited": false, "score": 0, "creation_date": 1537366695, "post_id": 52405890, "comment_id": 91759710, "body": "Roger is correct, there is no way for your pargrep app to determine the name of the file that is cat(ted) to the pipe. Since you need to read the file twice, you could consider writing the contents that you read from STDIN to a temporary file and then open it up again so you can read it a second time."}], "tags": [], "owner": {"reputation": 72, "user_id": 8900754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDhvL.jpg?s=128&g=1", "display_name": "dernst", "link": "https://stackoverflow.com/users/8900754/dernst"}, "is_accepted": false, "score": 0, "last_activity_date": 1537360146, "creation_date": 1537360146, "answer_id": 52405890, "question_id": 52405804, "link": "https://stackoverflow.com/questions/52405804/using-piped-input-of-a-file-not-able-to-get-the-file-name-piped-to-it-instead-o/52405890#52405890", "title": "using piped input of a file, not able to get the file name piped to it instead of the file content", "body": "<p>I wouldn't use the pipe.  I assume you are writing the program ./pargrep? I would pass the name of the file you want to process as the first argument to your pargrep program.  The second argument would then be \"word\"</p>\n\n<p>Then you would open the file by name in the program.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "edited": false, "score": 0, "creation_date": 1537365022, "post_id": 52405921, "comment_id": 91758594, "body": "this is for an class assignment, i have to process both input from a file and piped input. Is there a way to process piped input to get the file name"}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537365649, "post_id": 52405921, "comment_id": 91759007, "body": "@Roger not if you pipe the output of <code>cat</code>. Does the assignment perhaps want you to take the filename as a parameter (as dernst said), or take contents directly from stdin (which would include piping from <code>cat</code>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "edited": false, "score": 0, "creation_date": 1537366260, "post_id": 52405921, "comment_id": 91759406, "body": "assignment is to get the content directly from a file, file would be a large file and need to grep for a word in file and print it, just like grep but need to implement it through threads. im storing the whole file in a string array. Before storing it i got to check for the number of lines in it and then start storing it, so i go to read the file twice. stdin is not allowing me to read it twice. any clue on how it can be solved?"}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537366984, "post_id": 52405921, "comment_id": 91759894, "body": "@Roger, save all the data into a buffer first, then you can go over it as many times as you want."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "edited": false, "score": 0, "creation_date": 1537367690, "post_id": 52405921, "comment_id": 91760384, "body": "saving data in buffer and then to a pointer would cause an extra overhead, we are awarded marks based upon speed comparison between the actual grep and multi threaded grep. looks like that it the only way left. Thanks for ur time"}], "tags": [], "owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "is_accepted": false, "score": 0, "last_activity_date": 1537360239, "creation_date": 1537360239, "answer_id": 52405921, "question_id": 52405804, "link": "https://stackoverflow.com/questions/52405804/using-piped-input-of-a-file-not-able-to-get-the-file-name-piped-to-it-instead-o/52405921#52405921", "title": "using piped input of a file, not able to get the file name piped to it instead of the file content", "body": "<p>The problem is that <code>cat</code> outputs the contents of the file. If you want the filename, run as</p>\n\n<pre><code>echo ./file.txt | ./pargrep word\n</code></pre>\n\n<p>but better to use dernst suggestion rather than this</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9049129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537360444, "creation_date": 1537359800, "last_edit_date": 1537360444, "question_id": 52405804, "link": "https://stackoverflow.com/questions/52405804/using-piped-input-of-a-file-not-able-to-get-the-file-name-piped-to-it-instead-o", "title": "using piped input of a file, not able to get the file name piped to it instead of the file content", "body": "<p>I will be passing a text file using pipe.</p>\n\n<pre><code>cat ./file.txt | ./pargrep word\n</code></pre>\n\n<p>I tried to get the file name</p>\n\n<pre><code>fgets(buf, NULL, stdin);\n</code></pre>\n\n<p>How can I get just the file name instead of the file content, which I get when used gets. I need to read the file, which is pretty huge and need to read it twice.</p>\n"}, {"tags": ["c", "singly-linked-list"], "comments": [{"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537359025, "post_id": 52405450, "comment_id": 91754835, "body": "Would you also post code for <code>initializeList()</code>, it seems relevant"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537359086, "post_id": 52405450, "comment_id": 91754864, "body": "I&#39;m not understanding why do you need this line <code>*head = *newNode;</code>"}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537359760, "post_id": 52405450, "comment_id": 91755242, "body": "@kiranBiradar the line <code>*head = *newNode</code> is there so I can assign the head to the new node."}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537359790, "post_id": 52405450, "comment_id": 91755261, "body": "@rtpax added the <code>initializeList()</code> code"}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537360095, "post_id": 52405450, "comment_id": 91755430, "body": "I am getting different behavior than you are describing. The resulting list I get is 0-&gt;5-&gt;1. Note that the 0 comes from the uninitialized value in <code>initializeList</code>, so may vary."}, {"owner": {"reputation": 8870, "user_id": 4206079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2oZC.jpg?s=128&g=1", "display_name": "Banzay", "link": "https://stackoverflow.com/users/4206079/banzay"}, "edited": false, "score": 0, "creation_date": 1537360400, "post_id": 52405450, "comment_id": 91755606, "body": "Why you didn&#39;t define <code>number</code> for head in initializeList()? Then you&#39;re trying to compare it."}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537360761, "post_id": 52405450, "comment_id": 91755840, "body": "@rtpax I had omitted this part of the code because I thought it might not be very important. Added it back. Apologies."}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 8870, "user_id": 4206079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2oZC.jpg?s=128&g=1", "display_name": "Banzay", "link": "https://stackoverflow.com/users/4206079/banzay"}, "edited": false, "score": 0, "creation_date": 1537360780, "post_id": 52405450, "comment_id": 91755851, "body": "@Banzay see my response to rtpax above"}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537360971, "post_id": 52405450, "comment_id": 91755956, "body": "The result I get is the same though, just replacing 0 with -1"}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537361387, "post_id": 52405450, "comment_id": 91756192, "body": "@rtpax it should overwrite the -1 with a 5 initially tho"}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537361925, "post_id": 52405450, "comment_id": 91756584, "body": "ah, I didn&#39;t notice you added that check since then. Now it segfaults though. I suggest compiling using only what you have posted here to make sure what you have posted works the same as what you have personally"}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1537364281, "post_id": 52405450, "comment_id": 91758095, "body": "@rtpax the seg fault might be because of this line <code>*head-&gt;next = *newNode;</code> When I run it I get 1-&gt;1-&gt;1-&gt;1-&gt;...."}], "answers": [{"comments": [{"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 3, "creation_date": 1537362036, "post_id": 52406365, "comment_id": 91756652, "body": "he shouldn&#39;t need to add indexes to get a linked list to work"}], "tags": [], "owner": {"reputation": 41, "user_id": 7550078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cc8cefd3f909f624d585ba978758b6?s=128&d=identicon&r=PG&f=1", "display_name": "codebeast", "link": "https://stackoverflow.com/users/7550078/codebeast"}, "is_accepted": false, "score": -1, "last_activity_date": 1537361671, "creation_date": 1537361671, "answer_id": 52406365, "question_id": 52405450, "link": "https://stackoverflow.com/questions/52405450/adding-a-node-to-the-head-of-the-linked-list/52406365#52406365", "title": "Adding a node to the head of the linked list", "body": "<p>assign an index value to the node and shift the other elements by one. I mean you can add one to the each value of the other element and make in iterate in a loop. </p>\n"}, {"tags": [], "owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "is_accepted": true, "score": 1, "last_activity_date": 1537368111, "last_edit_date": 1537368111, "creation_date": 1537365509, "answer_id": 52407651, "question_id": 52405450, "link": "https://stackoverflow.com/questions/52405450/adding-a-node-to-the-head-of-the-linked-list/52407651#52407651", "title": "Adding a node to the head of the linked list", "body": "<p>I made a few edits to the <code>create</code> function to fix the problem.</p>\n\n<p>First, if the head of the list has <code>number == -1</code> then no new <code>node</code> should be allocated, since you are just replacing the number. </p>\n\n<p>Second, if you need to insert a node, the previous node needs to know where to the next node goes, so you can't just replace the previous node with the new node. You need to either point the previous node to the new node and point the new node to the displaced node; or you can copy the current node into the new node, and put the number for the new node into the current, and point it to the new node. The second works better here, since it does not require changing the head (which we can't do if it needs to go at the front).</p>\n\n<pre><code>int create(struct node *head, int number) {\n  struct node *current = head;\n\n  if (current-&gt;number == -1) {\n    current-&gt;number = number;//just replace the number, no need for anything else\n    return 1;\n  }\n\n  //allocate only if we must insert\n  struct node *newNode = malloc(sizeof(struct node));\n\n  //no longer need to check if head\n  while(current-&gt;next != NULL &amp;&amp; (current-&gt;number &lt;= number)) {\n    current = current-&gt;next;\n  }\n  if(current-&gt;next == NULL &amp;&amp; current-&gt;number &lt; number) {//check if number needs to go at the end\n    current-&gt;next = newNode;\n    newNode-&gt;next = NULL;\n    newNode-&gt;number = number;\n  } else {\n    *newNode = *current;//newNode will go after current, but with current's values\n    current-&gt;number = number;//replace current with the number to \"insert\" it\n    current-&gt;next = newNode;//point to the next node\n  }\n  return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 52407651, "answer_count": 2, "score": 1, "last_activity_date": 1537368111, "creation_date": 1537358596, "last_edit_date": 1537363883, "question_id": 52405450, "link": "https://stackoverflow.com/questions/52405450/adding-a-node-to-the-head-of-the-linked-list", "title": "Adding a node to the head of the linked list", "body": "<p>I would like to add a node in a sorted linked list based on the number. This is the struct:</p>\n\n<pre><code>struct node {\n  int number;\n  struct node *next;\n}\n</code></pre>\n\n<p>I am able to add to the sorted linked list correctly but can't get it to change head.</p>\n\n<p>Unfortunately I can't change the format of the function declaration so this is my function:</p>\n\n<pre><code>int create(struct node *head, int number) {\n   struct node *newNode = malloc(sizeof(struct node));\n   newNode-&gt;number = number;\n   struct node *current = head;\n\n   if (current-&gt;number == -1) {\n     newNode-&gt;next = NULL;\n     *head= *newNode;\n     return 1;\n   }\n\n   //Checking if head's number is bigger than init\n   if (current-&gt;number &gt; number) {\n     newNode-&gt;next = current;\n     *head = *newNode;\n   } else {\n     while(current-&gt;next != NULL &amp;&amp; (current-&gt;number &lt;= number)) {\n      current = current-&gt;next;\n     }\n    newNode-&gt;next = current-&gt;next;\n    current-&gt;next = newNode;\n   }\n   return 1;\n}\n</code></pre>\n\n<p>the call to the function is (Note I also can't change this):</p>\n\n<pre><code>struct node *list;\nlist = initializeList();\nint num;\nnum = create(list, 5);\nnum = create(list, 1);\n</code></pre>\n\n<p>After the second call, the list should be 1->5. But it becomes 1->1->1->1->.....</p>\n\n<p>Edit: Code to Initialize list:</p>\n\n<pre><code>struct node * initializeList() {\n  struct node *head;\n  head = malloc(sizeof(struct node));\n  head-&gt;next = NULL;\n  head-&gt;number = -1;\n  return head;\n}\n</code></pre>\n"}, {"tags": ["c", "variadic-functions"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1537356838, "post_id": 52404835, "comment_id": 91753543, "body": "Use vsnprintf()"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537357325, "post_id": 52404835, "comment_id": 91753834, "body": "related: <a href=\"https://stackoverflow.com/questions/46100864/is-there-a-way-to-format-a-string-directly-within-a-functions-arguments-instead\" title=\"is there a way to format a string directly within a functions arguments instead\">stackoverflow.com/questions/46100864/&hellip;</a>"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1537358584, "post_id": 52404835, "comment_id": 91754582, "body": "If you&#39;re using GCC, compile with <code>-Wall -Werror</code>."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1537359950, "post_id": 52404835, "comment_id": 91755360, "body": "@JonathonReinhart, it worked without &#39;-Wall -Werror&#39;"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1537360001, "post_id": 52404835, "comment_id": 91755390, "body": "@HansPassant, thank you so much, just curious why sprintf() did not worked?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1537360149, "post_id": 52404835, "comment_id": 91755456, "body": "Forwarding the variable length argument list requires extra magic, only the vxxxprintf functions know how to do that."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1537360369, "post_id": 52404835, "comment_id": 91755586, "body": "@HansPassant, haha got you :)"}], "answers": [{"comments": [{"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1537359407, "post_id": 52404977, "comment_id": 91755046, "body": "thank you so much, just curious why sprintf() did not worked?"}, {"owner": {"reputation": 1617, "user_id": 10310843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6bd12be19d98d9591ae768d19435fb?s=128&d=identicon&r=PG&f=1", "display_name": "likle", "link": "https://stackoverflow.com/users/10310843/likle"}, "reply_to_user": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1537430428, "post_id": 52404977, "comment_id": 91783694, "body": "If you have a <code>%u</code> in your format, sprintf will expect an unsigned integer - but in your case the parameter type was a <code>va_list</code> instead, which doesn&#39;t work. <code>sprintf</code> usually <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/sprintf.c\" rel=\"nofollow noreferrer\">creates a va_list internally</a>, just like you did, and calls <code>vsprintf</code> with it."}], "tags": [], "owner": {"reputation": 1617, "user_id": 10310843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6bd12be19d98d9591ae768d19435fb?s=128&d=identicon&r=PG&f=1", "display_name": "likle", "link": "https://stackoverflow.com/users/10310843/likle"}, "is_accepted": true, "score": 6, "last_activity_date": 1537356982, "creation_date": 1537356982, "answer_id": 52404977, "question_id": 52404835, "link": "https://stackoverflow.com/questions/52404835/calling-sprintf-under-a-variadic-function-in-c/52404977#52404977", "title": "Calling sprintf() under a variadic function in C", "body": "<p>You should use <a href=\"https://en.cppreference.com/w/c/io/vfprintf\" rel=\"noreferrer\">vsprintf</a> instead of sprintf if you are forwarding <code>va_list</code>'s:</p>\n\n<pre><code>int32_t printfDebugSerial(const char *format, ...)\n{\n  char tempBuff[256];\n  memset(tempBuff, 0, sizeof tempBuff);\n\n  va_list arg;\n  int32_t done;\n  va_start (arg, format);\n  done = (int32_t)vsprintf(tempBuff,format, arg);\n  va_end (arg);\n\n  HAL_sendToSerial((uint8_t*)tempBuff, strlen(tempBuff)); // writes bytes to serial port\n  return done;\n}\n</code></pre>\n"}], "owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 52404977, "answer_count": 1, "score": 0, "last_activity_date": 1537357127, "creation_date": 1537356495, "question_id": 52404835, "link": "https://stackoverflow.com/questions/52404835/calling-sprintf-under-a-variadic-function-in-c", "title": "Calling sprintf() under a variadic function in C", "body": "<p>I want to write a quick <code>printf()</code> kinda function for an embedded board that I am working on where the output terminal is a serial port. I tried something like this:</p>\n\n<pre><code>int32_t printfDebugSerial(const char *format, ...)\n{\n  char tempBuff[256];\n  memset(tempBuff, 0, sizeof tempBuff);\n\n  va_list arg;\n  int32_t done;\n  va_start (arg, format);\n  done = (int32_t)sprintf(tempBuff,format, arg);\n  va_end (arg);\n\n  HAL_sendToSerial((uint8_t*)tempBuff, strlen(tempBuff)); // writes bytes to serial port\n  return done;\n}\n</code></pre>\n\n<p>But the output that I got when I called it as follows:</p>\n\n<pre><code>printfDebugSerial(\"Hello = %u\", 1234);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hello = 536929228\n</code></pre>\n\n<p>then called as:</p>\n\n<pre><code>printfDebugSerial(\"Hello = %f\", 934.3245);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hello = 0.000000\n</code></pre>\n\n<p>Any help, what is wrong here?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1537358759, "post_id": 52403743, "comment_id": 91754689, "body": "<code>int **a</code> is a pointer to pointer. It&#39;s not a 2D array and cannot represent one. If you want a 2D array, use one. Sidenote: &quot;double pointer&quot; is often confused as <code>double *</code>. And never ever use casts if you don&#39;t really understand just to silence the compiler."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1537355678, "post_id": 52404236, "comment_id": 91752773, "body": "The pointer-to-pointer is not a 2D array, nor can it point to one. This is something else and it is fragmented all over the heap, which gives bad performance, for nothing gained but extra complexity. Furthermore, &quot;mangled&quot; 2D arrays like <code>a[(i * 2) + j]</code> is 1990s programming. In the current millennia we have pointer to VLA so we don&#39;t need to use that trick any longer."}, {"owner": {"reputation": 175, "user_id": 9805734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ff9b2a45d9046d42dd5927c5af93d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Monroe", "link": "https://stackoverflow.com/users/9805734/sean-monroe"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537356112, "post_id": 52404236, "comment_id": 91753062, "body": "@Lundin Thank you for the explanation. I&#39;m unfortunately one of the group who was taught a bad habit. I&#39;ll edit to discourage using my posted solution."}], "tags": [], "owner": {"reputation": 175, "user_id": 9805734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ff9b2a45d9046d42dd5927c5af93d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Monroe", "link": "https://stackoverflow.com/users/9805734/sean-monroe"}, "is_accepted": false, "score": 0, "last_activity_date": 1537356200, "last_edit_date": 1537356200, "creation_date": 1537354446, "answer_id": 52404236, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c/52404236#52404236", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p><strong>EDIT</strong></p>\n\n<p>This isn't a correct answer, as pointed out by Lundin. There are much better ways to do this I wasn't aware of!</p>\n\n<p>This line</p>\n\n<pre><code>a[i][j] = j + i*10;\n</code></pre>\n\n<p>is treating <code>a[0]</code> and <code>a[1]</code> as pointers themselves to other arrays, so it's reading their values</p>\n\n<pre><code>a[0]: 0x1976010\na[1]: 0x1976018\n</code></pre>\n\n<p>as memory locations, and segfaulting.</p>\n\n<p>If you want to dynamically allocate 2d arrays, allocate one dimension of <code>int*</code>s, then iterate through it and allocate memory to each of the indices as <code>int</code>s.</p>\n\n<pre><code>int main()\n{\n    #define DIM_X 2\n    #define DIM_Y DIM_X\n\n    int i = 0;\n    int j = 0;\n    int** x = 0;\n    void* a = malloc(sizeof(int*)*DIM_X);\n\n    x = (int**)a;\n    for (i = 0; i &lt; 2; i++)\n    {\n        x[i] = (int*)malloc(sizeof(int)*DIM_Y);\n    }\n\n    // ...\n\n    for (i = 0; i &lt; DIM_X; i++)\n    {\n        free(x[i]);\n    }\n    free(x);\n\n    return 0;\n}\n</code></pre>\n\n<p>You could also do some tricky logic to keep everything contiguous, but it may be harder to read.</p>\n\n<pre><code>for (i = 0, j = 0; i &lt; 2; i++)\n{\n    a[(i * 2) + j] = j + (i * 10);\n\n    j++;\n    if (2 &lt; j) j = 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1537355453, "post_id": 52404357, "comment_id": 91752643, "body": "You have some bugs here. The  form <code>int (*a)[ROW][COL] </code> is a bit complicated, as you have to de-reference the array pointer to get to the actual 2D array. Meaning that <code>a[i][j] = ...</code> is wrong here, it needs to be <code>(*a)[i][j] = ...</code>. It&#39;s easier to use an array pointer to the first element instead, to get rid of this complicated syntax."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537355623, "post_id": 52404357, "comment_id": 91752738, "body": "Oh Ok. So to use a[i][j] =.. i should use (*a)[COL] = malloc right? Saw your answer. Thanks!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537359921, "post_id": 52404357, "comment_id": 91755343, "body": "Yeah. Formally, using a pointer to a 2D array is the most correct form. If using it, we could for example write <code>int (*a)[ROW][COL] = malloc(sizeof *a)</code> which isn&#39;t otherwise possible. But since the syntax gets burdensome, it is often better to skip one dimension."}], "tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": false, "score": 1, "last_activity_date": 1537355639, "last_edit_date": 1537355639, "creation_date": 1537354845, "answer_id": 52404357, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c/52404357#52404357", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p>You got segmentation fault because a (a double pointer) is actually having a single pointer value.</p>\n\n<p>There are multiple ways to use 2D array. The following is one of them.</p>\n\n<pre><code>#define ROW (2)\n#define COL (3)\n\nint main()\n{\n    int (*a)[COL] = malloc(sizeof(int[ROW][COL]));\n    if(NULL == a) return -1; //Check if allocation is successfull.\n    int i, j;\n    for(i=0; i&lt;ROW; i++)  \n       for(j=0; j&lt; COL; j++)\n            a[i][j] = i*ROW + j; //Assign some values.\n    printf(\"a: %p\\n\", a);\n    printf(\"a[0][0]: %d\\n\", a[0][0]); //Printing a value.\n\n    free(a); //Free the allocated memory.\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5674389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73823ebcda49a48966af2fddf8e87592?s=128&d=identicon&r=PG&f=1", "display_name": "27Blend", "link": "https://stackoverflow.com/users/5674389/27blend"}, "edited": false, "score": 0, "creation_date": 1537415421, "post_id": 52404479, "comment_id": 91777736, "body": "Thanks! I never knew there was a POINTER TO ARRAY before... much to learn!"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1537355642, "last_edit_date": 1537355642, "creation_date": 1537355300, "answer_id": 52404479, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c/52404479#52404479", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p>If you have an existing (aka already allocated) memory area that you want to use for a 2D array (or rather for an array of array), you should not use a double pointer. Instead you should use a <strong>pointer to array of size N</strong></p>\n\n<p>Like</p>\n\n<pre><code>int (*a)[2];  // declare a as a pointer to array (size 2) of int\n</code></pre>\n\n<p>A complete program could be:</p>\n\n<pre><code>int main()\n{\n    // Allocate a memory area for holding 4 int\n    void *ptr = malloc(sizeof(int)*4);\n\n    int (*a)[2];  // a as a pointer to array (size 2) of int\n    a = ptr;      // make a point to your memory area\n\n    // Now a can be used as a \"2D array\" and data will be stored in the malloc'ed memory\n    for (int i=0; i&lt;2; ++i)\n        for (int j=0; j&lt;2; ++j)\n            a[i][j] = i*100 + j;\n\n    for (int i=0; i&lt;2; ++i)\n        for (int j=0; j&lt;2; ++j)\n            printf(\"a[%d][%d]=%d\\n\", i, j, a[i][j]);\n\n    free(ptr);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a[0][0]=0\na[0][1]=1\na[1][0]=100\na[1][1]=101\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537358983, "post_id": 52404494, "comment_id": 91754817, "body": "<code>sizeof(*a) * X</code> would be better, as it does not rely on the type of the elements and avoids the redundant usage of the inner dimension."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537360153, "post_id": 52404494, "comment_id": 91755463, "body": "@toohonestforthissite Not really, since the very same line already relies on the type in the array declaration. An alternative syntax could be used, however: <code>int (*a2)[X][Y] = malloc( sizeof *a2); int (*a)[Y] = a2[0];</code> After which free() could be called on either <code>a2</code> or <code>a</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537360522, "post_id": 52404494, "comment_id": 91755690, "body": "I talked about redundancy. With my version you can change the basse type just in one place. Such redundancy is a common error. It becomes more severe if the allocation is not in an initialiser, but an assignment e.g. combined with a null pointer test. Your alternative is uncommon, as it uses an unnecessary intermediat stage (or, if you omit the second pointer) clumsy code at leat it pullutes the namespace even more). Re. <code>free(a)</code> for the latter is formally correct, but irritating on reviews/maintenance, as the type differs from the intended during allocation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537360888, "post_id": 52404494, "comment_id": 91755921, "body": "@toohonestforthissite Using your argumentation, we should then stop writing <code>int x = (int)y;</code> and instead write <code>{typedef int typex; typex x = (typex)y;</code> ... or maybe write all code inside &quot;X macros&quot;. That&#39;s of course just silly - the bottom line when programming is <i>you must actually know what you are doing</i>. If you don&#39;t, no tricks against redundant code will help you. My experience from a whole lot of SO questions is that introducing tricks against writing redundant code far more often causes more harm/bugs than the danger they were supposed to protect against."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537363079, "post_id": 52404494, "comment_id": 91757286, "body": "It&#39;s obviously not the same, as <code>typex</code> is used here dedondantly. If anything, it would be <code>int x = (typeof(x))y;</code>, which uses a gcc extension. While not a bad idea, it comes at some typing overhead and often scalar types are not really changed as arrays might (yeah, that&#39;s weak argument, but it adds up). Can you tell me what&#39;s the problem with the commonly accepted use I propose? And what&#39;s the advantage of yours? After all that&#39;s what counts. The site is to advocate code quality, not &quot;beginner friendly&quot; sloppy code. And that&#39;s not a &quot;trick&quot;, but actually helps learning the language semantics"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1537358428, "last_edit_date": 1537358428, "creation_date": 1537355324, "answer_id": 52404494, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c/52404494#52404494", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p>When it comes to dynamic 2D arrays, there's unfortunately a lot of myths and hogwash, widely used bad practice and so on. Forget about pointer-to-pointers, is needlessly complex, error prone and slow. </p>\n\n<p>A detailed explanation of the correct way to do this can be found here: <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>.</p>\n\n<p>The correct way to allocate a 2D array dynamically is this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    const size_t X = 2;\n    const size_t Y = 2;\n\n    int (*a)[Y] = malloc( sizeof(int[X][Y]) );\n    int count = 1;\n\n    for(size_t x=0; x&lt;X; x++)\n    {\n      for(size_t y=0; y&lt;Y; y++)\n      {\n        a[x][y] = count++; // assign some value here\n        printf(\"%d \", a[x][y]);\n      }\n      printf(\"\\n\");\n    }\n\n    free(a);\n}\n</code></pre>\n\n<p>Where <code>int (*a)[Y]</code> is an array pointer to the first element of the 2D array. The first element being a 1D array of type <code>int [Y]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "is_accepted": false, "score": 0, "last_activity_date": 1537368705, "last_edit_date": 1537368705, "creation_date": 1537368150, "answer_id": 52408508, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c/52408508#52408508", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p>You have to allocate also storage for the pointers.</p>\n\n<pre><code>int main()\n{\n    int **a;  //double pointer\n    int i;\n    void *ptr = malloc(sizeof(int *)*2+sizeof(int)*4);  //2x2 array\n                            //plus 2xpointers\n    a = (int **)ptr;  //start of the array\n    for(i=0; i&lt;2; i++)  \n            a[i] = (int *)a + 2 + i * 2; //plus 2 because the first 2 elements\n                    //are your pointers\n    printf(\"a: %p\\n\", a);\n    printf(\"a[0]: %p\\n\", a[0]);\n    printf(\"a[1]: %p\\n\", a[1]);\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5674389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73823ebcda49a48966af2fddf8e87592?s=128&d=identicon&r=PG&f=1", "display_name": "27Blend", "link": "https://stackoverflow.com/users/5674389/27blend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1537472744, "accepted_answer_id": 52404479, "answer_count": 5, "score": 0, "last_activity_date": 1537368705, "creation_date": 1537352940, "question_id": 52403743, "link": "https://stackoverflow.com/questions/52403743/put-a-2d-array-into-existed-memory-using-double-pointer-in-c", "closed_reason": "Needs more focus", "title": "Put a 2D array into existed memory using double pointer in C", "body": "<p>totally a newbie in C. I'm trying to put a 2D array into an existing memory space created by <code>malloc</code>. Here is the code:</p>\n\n<pre><code>int main()\n{\n    int **a;  //double pointer\n    int i;\n    void *ptr = malloc(sizeof(int)*4);  //2x2 array\n    a = (int **)ptr;  //start of the array\n    for(i=0; i&lt;2; i++)  \n            a[i] = (int *)a + i*2;\n    printf(\"a: %p\\n\", a);\n    printf(\"a[0]: %p\\n\", a[0]);\n    printf(\"a[1]: %p\\n\", a[1]);\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>a: 0x1976010\na[0]: 0x1976010\na[1]: 0x1976018\n</code></pre>\n\n<p>but when I try to access the element:</p>\n\n<pre><code>for(i=0; i&lt;2; i++)\n    for(j=0; j&lt;2; j++)\n        a[i][j] = j + i*10;\n</code></pre>\n\n<p>I got segment fault. Where did I do wrong? Thanks in advance!</p>\n"}, {"tags": ["c++", "c", "windows", "winapi", "stack"], "comments": [{"owner": {"reputation": 335, "user_id": 4917303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-tQ6JhO6s9qg/AAAAAAAAAAI/AAAAAAAAAHg/m5MVLqdIDvs/photo.jpg?sz=128", "display_name": "Oriel Cochavi", "link": "https://stackoverflow.com/users/4917303/oriel-cochavi"}, "edited": false, "score": 0, "creation_date": 1537448164, "post_id": 52403473, "comment_id": 91794250, "body": "The question is somewhat unclear, for me at least. if you what to check the stack size of a process in win7 @RbMm answered it. if you want to write an emulator, why don&#39;t create a large stack (let&#39;s say 2MB or larger) and, create some sort of page guard to detect stack overflow, and if you do reach the stack limit either statically make it larger or do it dynamically (it will impact performance, but it&#39;s your choice of stack implementation)."}, {"owner": {"reputation": 335, "user_id": 4917303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-tQ6JhO6s9qg/AAAAAAAAAAI/AAAAAAAAAHg/m5MVLqdIDvs/photo.jpg?sz=128", "display_name": "Oriel Cochavi", "link": "https://stackoverflow.com/users/4917303/oriel-cochavi"}, "edited": false, "score": 0, "creation_date": 1537448979, "post_id": 52403473, "comment_id": 91794817, "body": "In order to find the maximum stack size on stm32, you must calculate the maximum number of nested functions called by the stm32 application. you have to add the interrupted functions call (like timer \\ watchdog) if exists to the calculation."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537356105, "post_id": 52404641, "comment_id": 91753059, "body": "The code is supposed to run on the <a href=\"https://en.wikipedia.org/wiki/STM32\" rel=\"nofollow noreferrer\">STM32</a> architecture. This proposed answer doesn&#39;t acknowledge that."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537356180, "post_id": 52404641, "comment_id": 91753100, "body": "@IInspectable - how this related to <code>stm32</code> ? and main what is wrong in my code ? concrete what is not correct ?"}, {"owner": {"reputation": 39, "user_id": 5472647, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e90721e71d24b3aa23c3c7ed65ae67fb?s=128&d=identicon&r=PG", "display_name": "charly_b", "link": "https://stackoverflow.com/users/5472647/charly-b"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537358916, "post_id": 52404641, "comment_id": 91754769, "body": "@IInspectable: The app is for stm, but i am talking about the pc simulation for the app which runs on win32...."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 39, "user_id": 5472647, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e90721e71d24b3aa23c3c7ed65ae67fb?s=128&d=identicon&r=PG", "display_name": "charly_b", "link": "https://stackoverflow.com/users/5472647/charly-b"}, "edited": false, "score": 0, "creation_date": 1537359080, "post_id": 52404641, "comment_id": 91754856, "body": "@charly_b - how i understand you need windows generic code. and i paste it - which will be work on every windows and platform."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 39, "user_id": 5472647, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e90721e71d24b3aa23c3c7ed65ae67fb?s=128&d=identicon&r=PG", "display_name": "charly_b", "link": "https://stackoverflow.com/users/5472647/charly-b"}, "edited": false, "score": 0, "creation_date": 1537361953, "post_id": 52404641, "comment_id": 91756605, "body": "@cha: <i>&quot;i just wanted to make the pc simulation working too&quot;</i> - That doesn&#39;t read like you <b>only</b> want this to run on a PC."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537362805, "post_id": 52404641, "comment_id": 91757116, "body": "@IInspectable - how the answer must acknowledge of stm32 ? what is wrong here ?"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1537357187, "last_edit_date": 1537357187, "creation_date": 1537355879, "answer_id": 52404641, "question_id": 52403473, "link": "https://stackoverflow.com/questions/52403473/get-current-used-stack-size-for-win7/52404641#52404641", "title": "Get current used stack size for win7", "body": "<blockquote>\n  <p>I need to find the current threads used stack size. (usedstacksize !=\n  maximumstacksize)</p>\n</blockquote>\n\n<p>in this case the <code>GetCurrentThreadStackLimits</code> wrong function for you at all, because it return <em>allocated</em> stack size. so <em>maximumstacksize</em> possible stack size. but usual most memory is reserved, yet not allocated. if you want exactly used stack size - you need read it from <code>NT_TIB</code> </p>\n\n<pre><code>void GetCurrentThreadUsedStackLimits(PULONG_PTR LowLimit,  PULONG_PTR HighLimit )\n{\n    NT_TIB* tib = (NT_TIB*)NtCurrentTeb();\n    *HighLimit = (ULONG_PTR)tib-&gt;StackBase;\n    *LowLimit = (ULONG_PTR)tib-&gt;StackLimit;\n}\n</code></pre>\n\n<p>the <code>HighLimit</code> will be the same which return <code>GetCurrentThreadStackLimits</code>, but <code>LowLimit</code> will be usual different - the <code>GetCurrentThreadStackLimits</code> return allocation base of stack (so it possible maximum size, when <code>NT_TIB.StackLimit</code> is currently allocated stack limit (which can grow down)</p>\n\n<hr>\n\n<p>if you want implement functionality of <code>GetCurrentThreadStackLimits</code> (but note - it not return <em>maximum</em> stack size. you can do next:</p>\n\n<pre><code>ULONG GetCurrentThreadStackLimits_old( _Out_ PULONG_PTR LowLimit, _Out_ PULONG_PTR HighLimit )\n{\n    static void (WINAPI* GetCurrentThreadStackLimits)(PULONG_PTR , PULONG_PTR);\n\n    if (!GetCurrentThreadStackLimits)\n    {\n        *(void**)&amp;GetCurrentThreadStackLimits = GetProcAddress(GetModuleHandle(L\"kernel32\"), \"GetCurrentThreadStackLimits\");\n\n        if (!GetCurrentThreadStackLimits)\n        {\n            NT_TIB* tib = (NT_TIB*)NtCurrentTeb();\n            *HighLimit = (ULONG_PTR)tib-&gt;StackBase;\n\n            MEMORY_BASIC_INFORMATION mbi;\n            if (VirtualQuery(tib-&gt;StackLimit, &amp;mbi, sizeof(mbi)))\n            {\n                *LowLimit = (ULONG_PTR)mbi.AllocationBase;\n                return 0;\n            }\n\n            return GetLastError();\n        }\n    }\n\n    GetCurrentThreadStackLimits(LowLimit, HighLimit);\n    return 0;\n}\n</code></pre>\n\n<p>so we first try get address of <code>GetCurrentThreadStackLimits</code> from <code>\"kernel32\"</code>. possible and use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/apiindex/windows-8-api-sets\" rel=\"nofollow noreferrer\"><code>\"api-ms-win-core-processthreads-l1-1-1\"</code></a> here instead <code>\"kernel32\"</code>. if we got system suplied function pointer - use it. if no (win7 -) - yourself query this limits</p>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1537568388, "post_id": 52405612, "comment_id": 91846733, "body": "Why the downvotes, if this does what the OP wants?  If you want to downvote, downvote the <i>question</i> for lack of clarity.  Also, this code will not work for 64 bit apps - return INT_PTR or similar."}], "tags": [], "owner": {"reputation": 39, "user_id": 5472647, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e90721e71d24b3aa23c3c7ed65ae67fb?s=128&d=identicon&r=PG", "display_name": "charly_b", "link": "https://stackoverflow.com/users/5472647/charly-b"}, "is_accepted": false, "score": -4, "last_activity_date": 1537359152, "creation_date": 1537359152, "answer_id": 52405612, "question_id": 52403473, "link": "https://stackoverflow.com/questions/52403473/get-current-used-stack-size-for-win7/52405612#52405612", "title": "Get current used stack size for win7", "body": "<p>i found a suprisingly easy 'quick and dirty' solution. (which is quite obvious)</p>\n\n<p>It's just declaring a local variable in a function and getting the adress of that variable:</p>\n\n<pre><code>uint GetCurrentStackAdress()\n{\n  uint aDummy;\n  return reinterpret_cast&lt;uint&gt;(&amp;aDummy);\n}\n</code></pre>\n\n<p>That should work on most systems i guess and for my diagnostic purpose its dirty enough ;-).</p>\n"}], "owner": {"reputation": 39, "user_id": 5472647, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e90721e71d24b3aa23c3c7ed65ae67fb?s=128&d=identicon&r=PG", "display_name": "charly_b", "link": "https://stackoverflow.com/users/5472647/charly-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537363004, "creation_date": 1537351975, "last_edit_date": 1537363004, "question_id": 52403473, "link": "https://stackoverflow.com/questions/52403473/get-current-used-stack-size-for-win7", "title": "Get current used stack size for win7", "body": "<p>is there a windows7 function for GetCurrentThreadStackLimits which seems to work only on windows >= 8 ? [1] and - if not - how can i achieve this info on win 7?</p>\n\n<p>I need to find the current threads used stack size. (usedstacksize != maximumstacksize)</p>\n\n<p>Thank you!</p>\n\n<p>PS: It is for diagnostic purpose. We need to find the stack size to reserve for a stm32 application and i just wanted to make the pc simulation working too.</p>\n\n<p>[1]: When calling the function the program compiles but at runtime a messagebox pops up that says \"function entry point can not be found in kernel32.dll\" The documentation states windows8 is required for this function:\n<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentthreadstacklimits\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentthreadstacklimits</a></p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1537351663, "post_id": 52403303, "comment_id": 91750321, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a> why <code>while(!feof(file))</code> is wrong"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1537351784, "post_id": 52403303, "comment_id": 91750382, "body": "please post the exact error message"}, {"owner": {"reputation": 49, "user_id": 6801416, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c43e4c48ca18d8e60baf916000abd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dapper", "link": "https://stackoverflow.com/users/6801416/dapper"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1537352081, "post_id": 52403303, "comment_id": 91750581, "body": "@StephanLechner The error can be seen here: <a href=\"https://i.imgur.com/H2dBzck.png\" rel=\"nofollow noreferrer\">i.imgur.com/H2dBzck.png</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537352109, "post_id": 52403303, "comment_id": 91750609, "body": "In VC the mode text or binary is needed. <i>&quot;If <code>t</code> or <code>b</code> is not given in mode, the default translation mode is defined by the global variable <code>_fmode</code>.&quot;</i> In your case the file should be opened in text mode, so <code>fopen(file_name, &quot;rt&quot;);</code>"}, {"owner": {"reputation": 49, "user_id": 6801416, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c43e4c48ca18d8e60baf916000abd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dapper", "link": "https://stackoverflow.com/users/6801416/dapper"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537352247, "post_id": 52403303, "comment_id": 91750716, "body": "@WeatherVane No, that will throw an error for obvious reasons."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1537352399, "post_id": 52403303, "comment_id": 91750819, "body": "What error will that throw, and for what obvious reason?"}], "answers": [{"comments": [{"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1537361812, "post_id": 52403546, "comment_id": 91756490, "body": "This is consistent with the code working in one development environment but not in another: the files are simply in different places. I&#39;d emphasize &quot;Always check the result of <code>fopen</code>&quot;."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1537362002, "last_edit_date": 1537362002, "creation_date": 1537352207, "answer_id": 52403546, "question_id": 52403303, "link": "https://stackoverflow.com/questions/52403303/stream-nullptr-visual-studio-simply-printing-values-from-txt-file-c/52403546#52403546", "title": "stream != nullptr visual studio, simply printing values from txt file (C)", "body": "<p>It is very likely that your program tries to load the file from the directory where your executable resides, and not from that where your source files are (as you intend).\nEither place the <code>ECG.txt</code>-file in the target directory or use absolute paths, e.g. <code>\"c:/myuser/myproject/ECG.txt\"</code>;</p>\n\n<p>Always check the result of <code>fopen</code>. If the result is <code>NULL</code>, then the file could not be opened (probably the reason for your runtime error). So the relevant portion of your program could loo as follows:</p>\n\n<pre><code>file = fopen(file_name, \"r\");\nif (file) {\n    int i = 0;\n    while (fscanf(file, \"%d\", &amp;i)==1) {\n        printf(\"%d \", i);\n    }\n   fclose(file);\n} else {\n   printf(\"error opening file\");\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6801416, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c43e4c48ca18d8e60baf916000abd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dapper", "link": "https://stackoverflow.com/users/6801416/dapper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537362002, "creation_date": 1537351511, "question_id": 52403303, "link": "https://stackoverflow.com/questions/52403303/stream-nullptr-visual-studio-simply-printing-values-from-txt-file-c", "title": "stream != nullptr visual studio, simply printing values from txt file (C)", "body": "<p>I am starting to program in Visual Studio (C) and I'm simply trying to print the values in the file, one by one. I can easily do this in my Eclipse version. (Which is the exact same code). My txt file is in project folder as seen here:\n<a href=\"https://i.imgur.com/SPjZOrN.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/SPjZOrN.png</a></p>\n\n<p>The code is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char **argv) {\n    int c;\n    FILE *file;\n    const char* file_name = \"ECG.txt\";\n    file = fopen(file_name, \"r\");\n    int i = 0;\n    fscanf(file, \"%d\", &amp;i);\n    while (!feof(file))\n    {\n        printf(\"%d \", i);\n        fscanf(file, \"%d\", &amp;i);\n    }\n    fclose(file);\n\n\n    return 0;\n\n}\n</code></pre>\n\n<p>When I run this, I get the error stream != nullptr how can I fix this?</p>\n"}, {"tags": ["c", "visual-studio-2015", "resharper"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1537350353, "post_id": 52402882, "comment_id": 91749514, "body": "The <code>gets</code> function have been deprecated since the C99 standard, and was removed in the C11 standard. It&#39;s <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">a dangerous function</a>, do not use it!"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1537350555, "post_id": 52402882, "comment_id": 91749631, "body": "Use <code>fgets()</code> instead."}, {"owner": {"reputation": 381, "user_id": 1988938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc91207512e8f63b898c6d97455aea73?s=128&d=identicon&r=PG&f=1", "display_name": "Applik", "link": "https://stackoverflow.com/users/1988938/applik"}, "edited": false, "score": 0, "creation_date": 1537352715, "post_id": 52402882, "comment_id": 91751012, "body": "thank you for the answer..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537359157, "post_id": 52402882, "comment_id": 91754901, "body": "C does not support <i>methods</i>. <code>gets</code> was a <i>function</i>."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1537361998, "post_id": 52402882, "comment_id": 91756632, "body": "Please post text rather than images. They may not be visible to all users -- or any searches."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537363535, "post_id": 52403388, "comment_id": 91757594, "body": "cppreference is not <b>the</b> C documentation. That would be the standard as ther only official reference."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 2, "last_activity_date": 1537351747, "creation_date": 1537351747, "answer_id": 52403388, "question_id": 52402882, "link": "https://stackoverflow.com/questions/52402882/why-gets-method-is-not-shown-in-autocomplete/52403388#52403388", "title": "Why gets method is not shown in autocomplete?", "body": "<p>From the C <a href=\"https://en.cppreference.com/w/c/io/gets\" rel=\"nofollow noreferrer\">documentation</a>:. </p>\n\n<p>The gets() function does not perform bounds checking, therefore this function is extremely vulnerable to buffer-overflow attacks. It cannot be used safely (unless the program runs in an environment which restricts what can appear on stdin). For this reason, <strong>the function has been deprecated in the third corrigendum to the C99 standard and removed altogether in the C11 standard</strong>. fgets() and gets_s() are the recommended replacements.<br>\n<strong>Never use gets().</strong></p>\n"}], "owner": {"reputation": 381, "user_id": 1988938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc91207512e8f63b898c6d97455aea73?s=128&d=identicon&r=PG&f=1", "display_name": "Applik", "link": "https://stackoverflow.com/users/1988938/applik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52403388, "answer_count": 1, "score": -3, "last_activity_date": 1537351747, "creation_date": 1537350230, "question_id": 52402882, "link": "https://stackoverflow.com/questions/52402882/why-gets-method-is-not-shown-in-autocomplete", "title": "Why gets method is not shown in autocomplete?", "body": "<p>I am using Visual Studio 2015 and ReSharper for my C programs but I can not make gets method work in this IDE. Why is this method not shown in autocomplete list?</p>\n\n<p><a href=\"https://i.stack.imgur.com/i6orr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i6orr.png\" alt=\"1st\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BeS2I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BeS2I.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "pipe", "ipc", "stdout", "stdin"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1537345648, "post_id": 52401416, "comment_id": 91746633, "body": "There are no messages in pipes, just a stream of bytes."}, {"owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1537345790, "post_id": 52401416, "comment_id": 91746718, "body": "What do you mean by no message. I have sent the message &quot;HelloWorld\\n&quot; twice in the parent process"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537346227, "post_id": 52401416, "comment_id": 91746978, "body": "Recommend to remove <code>&quot;\\n&quot;</code> from the format in <code>scanf(&quot;%s\\n&quot;,buffer);</code>.  What do you think that <code>&quot;\\n&quot;</code> does?  Likely a contributer to &quot;Only one is received&quot;."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1537346238, "post_id": 52401416, "comment_id": 91746986, "body": "@Antoun It means &quot;you seem to expect that pipes support distinct <i>messages</i>, and can deliver them one at a time, but this is not true, pipes are just streams of bytes&quot;. At least that&#39;s my interpretation."}, {"owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537348741, "post_id": 52401416, "comment_id": 91748493, "body": "Then how the program knows that this is the end of the message ?"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537348614, "post_id": 52401691, "comment_id": 91748400, "body": "It is mentioned almost in every website that this &quot;+1&quot; should be there. ie. <a href=\"https://www.geeksforgeeks.org/c-program-demonstrate-fork-and-pipe/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/c-program-demonstrate-fork-and-pipe</a>"}, {"owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537348699, "post_id": 52401691, "comment_id": 91748464, "body": "Also there is undefined behavior happens when i remove it. In my big project i use many pipes at the same time. When i remove it and send a message through all pipes. It doesn&#39;t reach to all the children !"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537349348, "post_id": 52401691, "comment_id": 91748871, "body": "@Antoun You have plenty of UB in there (unchecked error codes). Anyway, if you want to keep the nuls there, why not just skip stdio and do raw IO syscalls throughout. stdio has issues. I wouldn&#39;t use it."}, {"owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537349679, "post_id": 52401691, "comment_id": 91749051, "body": "it is an assignment i have to use stdio"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "edited": false, "score": 0, "creation_date": 1537360426, "post_id": 52401691, "comment_id": 91755627, "body": "@Antoun the +1 is because they purposefully send the terminating nul, to be used as a delimiter. You can do that if you wish, but then it means you must interpret it accordingly on the receiving end."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 3, "last_activity_date": 1537346499, "creation_date": 1537346499, "answer_id": 52401691, "question_id": 52401416, "link": "https://stackoverflow.com/questions/52401416/c-pipe-multiple-message-only-one-recieved/52401691#52401691", "title": "C pipe multiple message only one recieved", "body": "<p>The problem is the <code>strlen(arr)+1</code> part. You're sending the terminating <code>nul</code> as well and that <code>nul</code> ends up making up the second \"string\" read by <code>scanf</code>:</p>\n\n<pre><code>REC: HelloWorld\nREC: \n</code></pre>\n\n<p>If you remove the <code>+1</code>, you'll get both lines (I've also decreased the sleep times because I'm not patient enough to wait 50 seconds for the result):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc,char * argv[])\n{\n    char buffer[100]; // The pipe's buffer\n    int pipes[2];\n\n    pid_t   childpid;\n\n    if ( pipe(pipes) ){ fprintf(stderr,\"FATAL ERROR IN PIPE\"); }\n    if((childpid = fork()) == -1){ perror(\"fork\"); exit(1); }\n\n    if(childpid == 0){\n        close(pipes[1]);\n\n        dup2(pipes[0],STDIN_FILENO);\n\n        scanf(\"%s\\n\",buffer);\n        fprintf(stderr,\"REC: %s\\n\",buffer);\n        scanf(\"%s\\n\",buffer);\n        fprintf(stderr,\"REC: %s\\n\",buffer);\n        sleep(2);\n    }\n    else\n    {\n        close(pipes[0]);\n\n        // Read in a string from the pipe \n        char* arr = \"HelloWorld\\n\";\n        write(pipes[1],arr,strlen(arr)); // &lt;&lt; NO +1 \n        write(pipes[1],arr,strlen(arr)); // &lt;&lt; NO +1\n        sleep(2);\n    }\n    return 0;   \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1537358827, "post_id": 52404582, "comment_id": 91754730, "body": "It&#39;s a nice hypothesis, but practice doesn&#39;t agree (at least on the platform that I tried it on (glibc/linux, cygwin, macos))."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1537359006, "post_id": 52404582, "comment_id": 91754824, "body": "I did not have compatible platforms to try it out. So I said &quot;likely to solve&quot;. Edited the answer a bit."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1537360908, "post_id": 52404582, "comment_id": 91755929, "body": "It now works after couple of more changes. Updated the answer with live demo."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1537360879, "last_edit_date": 1537360879, "creation_date": 1537355672, "answer_id": 52404582, "question_id": 52401416, "link": "https://stackoverflow.com/questions/52401416/c-pipe-multiple-message-only-one-recieved/52404582#52404582", "title": "C pipe multiple message only one recieved", "body": "<p>One problem is with the following line:  </p>\n\n<pre><code>scanf(\"%s\\n\",buffer);\n</code></pre>\n\n<p><code>scanf</code> does not read trailing white space (including new-line characters) unless matched by a directive. But the directive exists here. So it waits for another new line after the usual new line which follows the input.</p>\n\n<p>Remove the <code>\\n</code> in both the <code>scanf</code> statements.</p>\n\n<p>Secondly, you have to modify your <code>fprintf</code> statements to add the <code>\\n</code> in them.</p>\n\n<pre><code>fprintf(stderr,\"REC: %s\\n\",buffer);\n</code></pre>\n\n<p>Thirdly, don't add 1 to the <code>strlen(arr)</code> in <code>write</code>. Modify it to:  </p>\n\n<pre><code>write(pipes[1],arr,strlen(arr));\n</code></pre>\n\n<p>It works. See <a href=\"https://tio.run/##rVLRTsIwFH3fV9zMEFszZJD4ImJCFCKJATJJfMCFjK2DxtItbacSw7djW4YDwoMP3qe707PTe25PXF/E8XZ7QXnMioTAnVQJza6X984RxOj8GCs41fAJby0bap0Tefq7oHxhMIdyBauIcmSaSCxiL15GAq5M/zENsfPtgC4Lzos0JWLa9P2wDY0GTJYEcpqTS1keWaoRMqictsK2Y6GcJjNlVShL9EcJ0xSQpSLLx4B3l5lKcz2iSpG2RITw3H530n2GXhCMAhgMYTwY91zctvSNs5dDaH8DdCDNxDvCGDodqDcPlO1AWjMTyDWcvcy@yBdVqFlpl9KVcgf8A7mYZbI0MG2GuLRmKinyVnngh97L5HEwnPUHz73h6JAl44inyK1J19st8WCc0yUEvYdbqMk3fob7bzqMkBzd@L8LsDthktjmvG//yLdORkCiRAcBIthFDVKRrUCVeYFKRMfKRE3o93KfCGPZayZYogerBvoUVFUL9jTZ06KMcKRbjP9OBDgx2TryKIgqBAdf88DZbLc/\" rel=\"nofollow noreferrer\">live demo</a>: </p>\n\n<p>Output:  </p>\n\n<pre><code>REC: HelloWorld\nREC: HelloWorld\n\nReal time: 2.082 s\nUser time: 0.043 s\nSys. time: 0.037 s\nCPU share: 3.85 %\nExit code: 0\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5605802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c03204b6de1c2c96a860c5a88f282e4?s=128&d=identicon&r=PG&f=1", "display_name": "Antoun", "link": "https://stackoverflow.com/users/5605802/antoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 52404582, "answer_count": 2, "score": 4, "last_activity_date": 1537360879, "creation_date": 1537345603, "question_id": 52401416, "link": "https://stackoverflow.com/questions/52401416/c-pipe-multiple-message-only-one-recieved", "title": "C pipe multiple message only one recieved", "body": "<p>I am trying to send two messages from the parent to the receiver. Only one is received. Receiver uses stdin and stdout for the pipe, and outputs its results into std err. Here is my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc,char * argv[])\n{\n    char buffer[100]; // The pipe's buffer\n    int pipes[2];\n\n    pid_t   childpid;\n\n    if ( pipe(pipes) ){\n        fprintf(stderr,\"FATAL ERROR IN PIPE\");\n    }\n\n\n    if((childpid = fork()) == -1){\n            perror(\"fork\");\n            exit(1);\n    }\n\n    if(childpid == 0){\n        close(pipes[1]);\n\n        dup2(pipes[0],STDIN_FILENO);\n\n        scanf(\"%s\\n\",buffer);\n        fprintf(stderr,\"REC: %s\\n\",buffer);\n        scanf(\"%s\\n\",buffer);\n        fprintf(stderr,\"REC: %s\\n\",buffer);\n        sleep(50);\n    }\n    else\n    {\n        close(pipes[0]);\n\n        // Read in a string from the pipe \n        char* arr = \"HelloWorld\\n\";\n        write(pipes[1],arr,strlen(arr)+1);\n        write(pipes[1],arr,strlen(arr)+1);  \n        sleep(50);\n    }\n    return 0;   \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1537344737, "post_id": 52401126, "comment_id": 91746125, "body": "Do you know how to print output in C? How to read input? If not then start with that, and any tutorial or book (even pretty bad ones) should tell you exactly what you want to know."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1537344865, "post_id": 52401126, "comment_id": 91746192, "body": "The answer would be no. See your implementation&#39;s manuals or the C standard for <code>printf</code>, <code>scanf</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1537344927, "post_id": 52401126, "comment_id": 91746229, "body": "Alas not. C doesn&#39;t really have the ability to implement ostream manipulators in the way that C++ does. You need to fiddle around with the <code>printf</code>-style formatters. But it <i>is</i> possible, just not as pretty as it is in C++."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1537344992, "post_id": 52401126, "comment_id": 91746263, "body": "You set the <b>d</b>ecimal base with <code>%d</code>, he<b>x</b>adecimal base with <code>%x</code> and <b>o</b>ctal base with <code>%o</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1537345821, "post_id": 52401126, "comment_id": 91746739, "body": "It is appropriate to tag questions asking how to convert code from C++ to C with both language tags. Please don&#39;t remove the C++ one, it is fine in this case."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1537347461, "post_id": 52401126, "comment_id": 91747718, "body": "Am I in the minority thinking that the closure reason here is hogwash?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1537358283, "post_id": 52401126, "comment_id": 91754401, "body": "I think this is a perfectly sensible but misunderstood question.  OP is asking about <i>scanf</i>, already knows about <code>%x</code>, and wants to know how to scan a <i>long</i> in hexadecimal, and none of the answers mention <code>%lx</code>."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1537345492, "post_id": 52401366, "comment_id": 91746544, "body": "You may as well wack the octal one in too."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537358566, "post_id": 52401366, "comment_id": 91754566, "body": "This answer is inapplicable since OP has edited to show they want input, not output."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1537359357, "post_id": 52401366, "comment_id": 91755016, "body": "Oh the joy of the moving spec."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1537429832, "post_id": 52401366, "comment_id": 91783389, "body": "@chqrlie Yes, of course, a silly typo. That&#39;s what I get for not test-running my code. :) Thanks."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1537429809, "last_edit_date": 1537429809, "creation_date": 1537345445, "answer_id": 52401366, "question_id": 52401126, "link": "https://stackoverflow.com/questions/52401126/is-there-any-equivalent-of-setbase-in-c-how-to-set-base-to-dec-hex-or-oct-in/52401366#52401366", "title": "Is there any equivalent of setbase() in C? How to set base to dec, hex or oct in c?", "body": "<p>No there is not, the standard input/output streams in C are much more low-level and do not support the concept of a base (nor the concept of outputting \"a number\", they are character streams).</p>\n\n<p>Just use <a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\"><code>printf()</code></a>:</p>\n\n<pre><code>const int number = 4711;\nprintf(\"%d in hex is %x; in octal it's %o\\n\", number, (unsigned int) number,\n       (unsigned int) number);\n</code></pre>\n\n<p>will print:</p>\n\n<pre><code>4711 in hex is 1267, in octal it's 11147\n</code></pre>\n\n<p>And no, there's no standard way of printing in binary, you're going to have to implement that on your own if you need it.</p>\n\n<p>To input, you need to match the type of the variable with the type implied by the formatting specifier:</p>\n\n<pre><code>if(scanf(\"%lx\", &amp;id) == 1)\n{\n  printf(\"the ID is %lu (0x%lx)\\n\", id, id);\n}\n</code></pre>\n\n<p>the type of hexadecimal numbers is <code>unsigned</code> with the <code>printf()</code> and <code>scanf()</code> family of functions.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537358579, "post_id": 52401510, "comment_id": 91754575, "body": "This answer is inapplicable since OP has edited to show they want input, not output."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537359453, "post_id": 52401510, "comment_id": 91755081, "body": "The answer is wrong anyway, as the non-decimal converfsion type specifiers require a, <code>unsigned int</code>, not an <code>int</code> as you pass."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1537359801, "post_id": 52401510, "comment_id": 91755266, "body": "@EricPostpischil Updated the answer to meet the updated question."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1537369100, "post_id": 52401510, "comment_id": 91761237, "body": "I suspect OP does not yet know what &quot;UB&quot; means."}, {"owner": {"reputation": 263, "user_id": 8680490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b3ac215e46ba737cbc56146bb619d6?s=128&d=identicon&r=PG&f=1", "display_name": "Jyoti Yadav", "link": "https://stackoverflow.com/users/8680490/jyoti-yadav"}, "edited": false, "score": 0, "creation_date": 1537417583, "post_id": 52401510, "comment_id": 91778238, "body": "@kiranBiradar.. I forgot to put &amp;id while writing the question. Thanks for the answer."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 263, "user_id": 8680490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b3ac215e46ba737cbc56146bb619d6?s=128&d=identicon&r=PG&f=1", "display_name": "Jyoti Yadav", "link": "https://stackoverflow.com/users/8680490/jyoti-yadav"}, "edited": false, "score": 0, "creation_date": 1537417981, "post_id": 52401510, "comment_id": 91778353, "body": "@JyotiYadav please don&#39;t edit your question unless it&#39;s required because answers seems to be useless"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 3, "last_activity_date": 1537369243, "last_edit_date": 1537369243, "creation_date": 1537345901, "answer_id": 52401510, "question_id": 52401126, "link": "https://stackoverflow.com/questions/52401126/is-there-any-equivalent-of-setbase-in-c-how-to-set-base-to-dec-hex-or-oct-in/52401510#52401510", "title": "Is there any equivalent of setbase() in C? How to set base to dec, hex or oct in c?", "body": "<p>You can use <code>%lx</code> format specifier to read in the long hex value.</p>\n\n<p>Also <code>scanf</code> wants the address of the variable to read in.</p>\n\n<p><code>scanf(\"%x\",id);</code> this will lead to <strong>Undefined Behavior</strong>. </p>\n\n<p>Hence change as below.</p>\n\n<pre><code>printf(\"Enter Aircraft Id: (eg abeb11\");\nscanf(\"%lx\",&amp;id);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1537421360, "last_edit_date": 1537421360, "creation_date": 1537420879, "answer_id": 52418102, "question_id": 52401126, "link": "https://stackoverflow.com/questions/52401126/is-there-any-equivalent-of-setbase-in-c-how-to-set-base-to-dec-hex-or-oct-in/52418102#52418102", "title": "Is there any equivalent of setbase() in C? How to set base to dec, hex or oct in c?", "body": "<p>C++ has a type safe conversion system for reading values from standard streams. <code>setbase(16)</code> is used to change the input base, not to specify the type of the target, which is handed automatically.</p>\n\n<p>in C, the <code>scanf()</code> function uses a format string to specify both the type of the target variable and how to convert it, it has no information about the actual type of the remaining arguments. <code>scanf()</code> supports decimal, octal and hexadecimal conversions:</p>\n\n<ul>\n<li><code>%d</code> converts an optionally signed value expressed in decimal into an <code>int</code> variable</li>\n<li><code>%u</code> converts an optionally signed value expressed in decimal into an <code>unsigned int</code> variable</li>\n<li><code>%o</code> converts an optionally signed value expressed in octal into an <code>unsigned int</code> variable</li>\n<li><code>%x</code> converts a optionally signed value expressed in hexadecimal into an <code>unsigned int</code> variable,</li>\n<li><code>%lx</code> does the same for an <code>unsigned long int</code> variable. There is no way to tell <code>scanf()</code> that the target variable is a <code>long int</code>, passing the address of a <code>long int</code> for <code>%lx</code> has undefined behavior, but it is accepted and works correctly for positive values on most current systems.</li>\n<li><code>%i</code> converts a optionally signed value expressed in decimal, octal or hexadecimal into an <code>int</code> variable. The base is determined from the initial prefix (after optional spaces and an optional sign): <code>0</code> for octal, <code>0x</code> for hexadecimal, otherwise decimal.</li>\n</ul>\n\n<p>Note that you should test the return value of <code>scanf()</code> to detect invalid or missing input.</p>\n\n<p>Here is a modified version:</p>\n\n<pre><code>unsigned long int id;\nprintf(\"Enter Aircraft Id (eg abeb11): \");\nif (scanf(\"%lx\", &amp;id) != 1) {\n    printf(\"Invalid input\\n\");\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 8680490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b3ac215e46ba737cbc56146bb619d6?s=128&d=identicon&r=PG&f=1", "display_name": "Jyoti Yadav", "link": "https://stackoverflow.com/users/8680490/jyoti-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1537429809, "creation_date": 1537344615, "last_edit_date": 1537420255, "question_id": 52401126, "link": "https://stackoverflow.com/questions/52401126/is-there-any-equivalent-of-setbase-in-c-how-to-set-base-to-dec-hex-or-oct-in", "title": "Is there any equivalent of setbase() in C? How to set base to dec, hex or oct in c?", "body": "<pre><code>long int id;\nprintf(\"Enter Aircraft Id: (eg abeb11\");\nscanf(\"%x\",&amp;id);\n</code></pre>\n\n<p>The <code>id\"</code> has to be read as hex value.\nbut I am getting the warning <code>format \u2018%x\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]</code></p>\n\n<p>In C++, we can use <code>setbase()</code>. \nBut I am stuck as to how to do it in C.</p>\n"}, {"tags": ["c", "memory-management", "global-variables", "freertos"], "answers": [{"comments": [{"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1537347709, "post_id": 52401114, "comment_id": 91747853, "body": "the reason why I asked this question was, actually I have 6 big structures defined in the global space. At specific size, they work fine, but when I uniformly increase their size to some bigger value, I don&#39;t see any hard fault or any stack overflow in the system but I see the data in these arrays is getting corrupted. Any idea what could be the issue, do I need to increase the _Min_Stack_Size or something?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 1, "creation_date": 1537348532, "post_id": 52401114, "comment_id": 91748361, "body": "Sounds a lot like a stack overflow, yes. The usual hints are: use debugger watchpoints to watch the arrays; enable FreeRTOS stack monitoring; try disabling tasks one at a time to see if the error goes away."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1537351341, "post_id": 52401114, "comment_id": 91750108, "body": "I have 3 tasks, each task uses 2 of those arrays. When I disabled the other 2 tasks, I witness there happens no more corruption. But I am curious why FreeRTOS did not report a stack overflow when all tasks are enabled and I see data corruption?"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1537344555, "creation_date": 1537344555, "answer_id": 52401114, "question_id": 52400875, "link": "https://stackoverflow.com/questions/52400875/storage-area-of-public-variables-in-a-freertos-environment/52401114#52401114", "title": "Storage area of public variables in a freeRTOS environment", "body": "<p>They are stored in the global memory, but not \"on the heap\" in the sense that the C compiler won't generate calls to the FreeRTOS <code>heap_x.c</code> (where <code>x</code> is one of the heap implementation numbers) to allocate this memory, it will simply stuff it into the correct section, and the linker will position that section somewhere in memory.</p>\n\n<p>The memory that is used as the heap's backing store will generally also be of the same form, i.e. we have this in <code>heap_2.c</code>:</p>\n\n<pre><code>static uint8_t ucHeap[ configTOTAL_HEAP_SIZE ];\n</code></pre>\n\n<p>that is simply declaring a global variable that is an array of the specified size; this will then be located in actual memory by the linker as would any other variable.</p>\n\n<p>This is assuming a flash-based platform, i.e. not one where the FreeRTOS program is <em>dynamically</em> loaded at run-time by some code, in that case of course that code must fit all the sections of the program into memory and might indeed allocate heap memory to do so.</p>\n"}, {"tags": [], "owner": {"reputation": 2658, "user_id": 3887835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c6f11a2a2ff629a3684515f6769637?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/3887835/richard"}, "is_accepted": false, "score": 2, "last_activity_date": 1537364246, "creation_date": 1537364246, "answer_id": 52407224, "question_id": 52400875, "link": "https://stackoverflow.com/questions/52400875/storage-area-of-public-variables-in-a-freertos-environment/52407224#52407224", "title": "Storage area of public variables in a freeRTOS environment", "body": "<p>FreeRTOS is supplied as C source code that is compiled as part of your project along with your other C source code - so unless you are specifically using a customer linker script (as would be the case if you were using a version of FreeRTOS that supports memory protection) then the answer to the original question is - where everything is stored is exactly the same as if FreeRTOS were not used as your compiler just sees C code.  So just like in any other standard C program you can increase the size of your structures until they are too large to fit on the MCU you are using - you will know when that is because [assuming your linker script is correct] the application will no longer link.  If you are seeing these structures get corrupted then it is for another reason, like stack overflow, not because they are stored in the wrong place.  Some links that might help:<br>\n<a href=\"https://www.freertos.org/a00110.html#configASSERT\" rel=\"nofollow noreferrer\">https://www.freertos.org/a00110.html#configASSERT</a><br>\n<a href=\"https://www.freertos.org/Stacks-and-stack-overflow-checking.html\" rel=\"nofollow noreferrer\">https://www.freertos.org/Stacks-and-stack-overflow-checking.html</a></p>\n"}], "owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 52401114, "answer_count": 2, "score": 0, "last_activity_date": 1537364246, "creation_date": 1537343768, "last_edit_date": 1537344445, "question_id": 52400875, "link": "https://stackoverflow.com/questions/52400875/storage-area-of-public-variables-in-a-freertos-environment", "title": "Storage area of public variables in a freeRTOS environment", "body": "<p>Where do the global public variables (not declared inside a task body) get stored in a FreeRTOS environment? </p>\n\n<p>What memory size configuration in the system will ensure that they get enough (non-overlapping) space for storage like either:</p>\n\n<ol>\n<li><p><code>configTOTAL_HEAP_SIZE</code> defined in FreeRTOSConfig.h, or</p></li>\n<li><p>these parameters defined in the linker script: <br>\n<code>_Min_Heap_Size = 0x200;   /* required amount of heap  */\n_Min_Stack_Size = 0x400;  /* required amount of stack */</code></p></li>\n</ol>\n"}, {"tags": ["c", "segmentation-fault", "gdb"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1537340314, "post_id": 52399844, "comment_id": 91743802, "body": "A core dump is just a snapshot of the moment of the crash. Information about what happened before it is not directly available, but might be indirectly derived from the memory contents. Eg. start by checking the variable values to see if it gives you a clue as to what happened."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1537340427, "post_id": 52399844, "comment_id": 91743862, "body": "<i>in other words all the functions called by &#39;alloc_real&#39; using gdb ?</i> I think <code>Cscope</code> can help you to know the function called by <code>alloc_real()</code>. Since you know the crash happened in particular function, run the <code>cscope</code> &amp; use <code>printf</code> to debug."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1537340434, "post_id": 52399844, "comment_id": 91743866, "body": "Specifically: you know that <code>alloc_real</code> was called from <code>ssr_unalloc</code>, and you know which parameters it was called with. That should give you enough information to re-create the execution flow."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 2, "creation_date": 1537340841, "post_id": 52399844, "comment_id": 91744079, "body": "You can use the <code>list</code> command to show the source code context in the current frame (0) (and you can use <code>frame FRAME_NUMBER</code> to change frames)."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1537346511, "post_id": 52399844, "comment_id": 91747160, "body": "This sounds like a job for reverse debugging. See if your gdb  supports the <code>record</code> command. Gdb doesn&#39;t record by default, so you&#39;ll need to start the process over again and hope it&#39;ll get the same error. After hitting the seg fault, you&#39;d do <code>rbreak .*</code> to set a breakpoint in every function, then <code>reverse-continue</code>, possibly multiple times as you see each function that&#39;s called."}], "owner": {"reputation": 904, "user_id": 2711402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f60d62777fda717173de19b2de003018?s=128&d=identicon&r=PG&f=1", "display_name": "Rndp13", "link": "https://stackoverflow.com/users/2711402/rndp13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537353953, "creation_date": 1537340052, "last_edit_date": 1537353953, "question_id": 52399844, "link": "https://stackoverflow.com/questions/52399844/call-stack-of-a-selected-frame", "title": "Call Stack of a Selected frame", "body": "<p>I am debugging a segmentation fault from the core file and trying to get as much info as possible. Below is a snippet of my <code>bt</code> command.</p>\n\n<pre><code>(gdb) bt\n#0  0x00000000007d4cf1 in alloc_real (vv=0x7f259e9bed20, drop_ssr=false) task_remove.c:2350\n#1  0x00000000007d54f8 in ssr_unalloc (vv=0x7f259e9bed20, skip_tree=1 '\\001', remove_from_sysmgr=0 '\\000') at task_remove.c:2541\n#2  0x00000000007e5afb in remove_done (vv=0x7f259e9bed20, status=TE_PASS, multiple_ssr=2) at task_remove.c:7058\n#3  0x00000000007ee0f4 in remove_callback (task=0x7f259e9e27d0) at task_remove.c:8790\n#4  0x00000000006fe4d5 in proc (arg=0x7f259e9e27d0) at smtproc.c:140\n#5  0x00007f25a2cab637 in ?? ()\n#6  0x00007f25a55ed998 in ?? ()\n</code></pre>\n\n<p>From <code>bt</code> I can know that the program failed in <code>task_remove.c:2350</code> while executing line no 2350 of the <code>alloc_real</code> function.\nThe code for <code>'alloc_real'</code> has several other function calls which has passed and hence removed from the stack. </p>\n\n<p>My question is, \nIs there any way/mechanism to get the <code>bt</code> of <code>frame 0</code>, or in other words all the functions called by '<code>alloc_real</code>' using gdb.</p>\n"}, {"tags": ["c", "getopt"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1537339532, "post_id": 52399680, "comment_id": 91743374, "body": "change <code>int download_main(int argc, char *argv[])</code> this to <code>int download_main(int argc, char *argv)</code> and pass params like this <code>ret = download_main(1,&quot;-C4&quot;)</code>. If you intended to pass more than one string then your prototype is correct."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537339754, "post_id": 52399680, "comment_id": 91743494, "body": "<a href=\"https://stackoverflow.com/questions/38811014/pass-multiple-strings-to-function-c\" title=\"pass multiple strings to function c\">stackoverflow.com/questions/38811014/&hellip;</a> this might help you."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1537339768, "post_id": 52399680, "comment_id": 91743500, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38811014/pass-multiple-strings-to-function-c\">Pass multiple strings to function c</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1537339842, "post_id": 52399680, "comment_id": 91743539, "body": "You are aware that <code>&#39;-C4&#39;</code> is not a string, right...?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537339885, "post_id": 52399680, "comment_id": 91743561, "body": "@kiranBiradar If the function <code>getopt</code> shall be used, it would be better not to change <code>argv</code> to a simple pointer."}, {"owner": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "edited": false, "score": 0, "creation_date": 1537339979, "post_id": 52399680, "comment_id": 91743615, "body": "I have tried your method , but not working, the program still remind me to pass the parameters."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537340145, "post_id": 52399680, "comment_id": 91743712, "body": "Please always provide a <a href=\"https://stackoverflow.com/help/mcve\">mcve</a>. For being minimal, there is no need to show us the <code>binlist</code> part. For being complete you need to show us how you call the function,"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537340220, "post_id": 52399680, "comment_id": 91743754, "body": "What is <code>&#39;-C&#39;+4</code>expected to be? Hint: It is an integer. Not an array of strings"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537340493, "post_id": 52399680, "comment_id": 91743894, "body": "@Gerhardh I did not notice Op is using <code>getopt</code>. You are right."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1537341529, "post_id": 52399680, "comment_id": 91744412, "body": "@CreateFile did you see if (argc &lt; 3) { usage(); return 0; } you got to pass atleast 3 arguments."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1537341896, "post_id": 52399680, "comment_id": 91744604, "body": "You must learn to distinguish different types of failure. Some of your errors are syntax errors that the compiler tells you. Others are runtime errors which can be found using a debugger."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1537343033, "post_id": 52399680, "comment_id": 91745226, "body": "BTW: &quot;Using a debugger&quot; means you should step through your code and see where you come along. Not just load into debugger and run it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "edited": false, "score": 0, "creation_date": 1537341186, "post_id": 52399946, "comment_id": 91744234, "body": "still not working...... the program still remain me to pass parameters."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "edited": false, "score": 0, "creation_date": 1537341344, "post_id": 52399946, "comment_id": 91744319, "body": "@CreateFile Can you post the compiler error you are getting with Gerhardh answer ?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "edited": false, "score": 0, "creation_date": 1537341441, "post_id": 52399946, "comment_id": 91744363, "body": "@CreateFile did you see <code>if (argc &lt; 3) {     usage();     return 0; }</code> you got to pass atleast 3 arguments."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "edited": false, "score": 0, "creation_date": 1537341752, "post_id": 52399946, "comment_id": 91744537, "body": "@CreateFile at least it should compile without errors. If your function tells you to add parameters, you need to rethink your check for parameters (<code>argc&lt;3</code>) as @kiranBiradar mentioned. Using a debugger you should see the reason for this within seconds. Please always use a debugger first."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537362195, "post_id": 52399946, "comment_id": 91756765, "body": "Since <code>download_main</code> is simulating a top-level main function, it is expecting the first element in the <code>argv</code> array to be its name. It uses <code>getopt</code> to parse its argument list, and that will start with <code>argv[1]</code>. So you need <code>char *args[] = {&quot;download&quot;, &quot;-C4&quot;, NULL}; ret = download_main(2, args);</code> or some such; the first element is arbitrary."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537364766, "post_id": 52399946, "comment_id": 91758418, "body": "@gerhardh: setting optind to 0 resets the scan, but it will still start at argument 1. (At least with glibc&#39;s getopt. Posix says the behaviour is unspecified.)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537365373, "post_id": 52399946, "comment_id": 91758821, "body": "@rici, you are right. I didn&#39;t know that detail. I&#39;ve updated the answer."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 1, "last_activity_date": 1537384954, "last_edit_date": 1537384954, "creation_date": 1537340418, "answer_id": 52399946, "question_id": 52399680, "link": "https://stackoverflow.com/questions/52399680/pass-parameters-to-the-function-in-c/52399946#52399946", "title": "Pass parameters to the function in C", "body": "<p>As you seem to use the same mechanism as <code>main</code> does, you must prepare your strings properly:</p>\n\n<pre><code>char *args[] = {\"download_main\", \"-C4\", NULL};\nret = download_main(2, args);\n</code></pre>\n\n<p>Update:\nAs @rici pointed out, setting <code>optind=0</code> before scanning doesn't mean that the first argument is passed by <code>getopt</code>. Therefore you must provide an additional first argument. Normally this holds the name of the program when <code>main</code> is called with argument list, but for your own function call it doesn't matter what is in that first string.</p>\n"}], "owner": {"reputation": 13, "user_id": 10383640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95593784b11026452cdfcbd1f8ea5622?s=128&d=identicon&r=PG&f=1", "display_name": "CreateFile", "link": "https://stackoverflow.com/users/10383640/createfile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537384954, "creation_date": 1537339372, "last_edit_date": 1537348115, "question_id": 52399680, "link": "https://stackoverflow.com/questions/52399680/pass-parameters-to-the-function-in-c", "title": "Pass parameters to the function in C", "body": "<p>I am writing a function in <code>C</code> to open the serial port and read the flash data in a chip. I want to pass the serial port parameters to this function and open <code>COM 4</code>. \nI have tried to use these method to call the function:</p>\n\n<ol>\n<li><p><code>ret = download_main(1,'-C'+ 4);</code> </p></li>\n<li><p><code>ret = download_main(1,'-C4');</code></p></li>\n<li><p><code>char  array_1[] = { \"-C4\"};</code><br>\n<code>ret = download_main(1, array_1);</code></p></li>\n<li><code>ret = download_main(1, \"-C4\");</code> and change function definition to <code>int download_main(int argc, char *argv)</code></li>\n<li><code>char *args[] = { \"-C4\", NULL };</code>\n<code>ret = download_main(1, args);</code></li>\n</ol>\n\n<p>but all failed to pass the parameter to this function and open the <code>COM4</code>.</p>\n\n<p><strong>Function call</strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n{\nint ret;    \n\nchar* COMx = \"com4\";\nFILE* fp;\n\nprintf(\"open com!\\n\");\n\n/** Open Com */\nif ((fp = fopen(COMx, \"wb+\")) == NULL) {\n    printf(\"Open %s Failed!\\n\", COMx);\n}\n\n/** Send \"Hello,world!\" */\nfwrite((char*)\"Hello,world!\", sizeof(\"Hello,world!\"), 1, fp);\n\n\nchar *args[] = { \"-C4\", NULL };\nret = download_main(1, args);\nreturn ret;\n}\n</code></pre>\n\n<p>the function called:</p>\n\n<pre><code>int download_main(int argc, char *argv[])\n{   \nBOOL fSuccess;\nTCHAR commPort[16];\nTCHAR *numStr;\nint len, i,ch;\nint poweroff_param;\nchar *optstring = \"C:c:r:F:f:P:w:b:B:R:A:l:h\";\nbininfo_node *bin_info = NULL;\n\nopterr = 1;\nif (argc &lt; 3)\n{\n    usage();\n    return 0;\n}\n\n\noptind = 0;\nwhile((ch=getopt(argc,argv,optstring))!=-1)\n{\n    switch(ch)\n    {\n        case 'c':\n            g_calibrate_switch = atoi(optarg);\n            if(1 == g_calibrate_switch)\n                printf(\"burn flash then entry calib mode\\n\");\n            break;\n        case 'C':\n            numStr = optarg;\n            len = _tcslen(numStr);\n            for (i = 0; i &lt; len; i++) \n            {\n                if (!_istdigit(numStr[i])) \n                {\n                    TRACE(\"Error: Invalid COM number: %s\", numStr);\n                    g_dldtool_exit_code = EXIT_CODE_COM_NUM_ERROR;\n                    goto _exit;\n                }\n            }\n            _stprintf_s(commPort, sizeof(commPort) / sizeof(TCHAR), \"\\\\\\\\.\\\\COM%s\", optarg);\n            break;\n</code></pre>\n\n<p>There is no compiling error in this program. When I debug this program, it keeps exiting with code 0 and reminding me to add parameters to the function without going through the breakpoint in the <code>download_main</code> function like below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7LTS1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7LTS1.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "restrict", "restrict-qualifier"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537339863, "post_id": 52399590, "comment_id": 91743549, "body": "Did you try adding <code>restrict</code> to <code>p</code> and <code>arr</code> in the same code?"}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537340173, "post_id": 52399590, "comment_id": 91743727, "body": "Changing <code>int *arr</code> to <code>int * restrict arr</code> had no effect."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1537340499, "post_id": 52399590, "comment_id": 91743897, "body": "Hmm, as <code>restrict</code>  <i>may</i> result in an optimization otherwise prohibited, a lack of seen optimization does not imply a useless use of <code>restrict</code>.  Just that it was useless for this compilation/options.  Good luck."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1537342827, "post_id": 52399590, "comment_id": 91745107, "body": "Why not load <code>*p</code> into a local variable once before <code>read_array</code>?"}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1537343554, "post_id": 52399590, "comment_id": 91745495, "body": "I am writing a compiler and using C as a back end. A) I would like to piggy back on GCC optimizations when possible. B) creating less local variables might reduce register pressure. If I have both <code>x</code> and <code>*p</code>, I&#39;d like GCC to know that if x cant be stored in a register then it can be recomputed from p as needed. No need to carefully spill it to and from the stack"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537345198, "post_id": 52399590, "comment_id": 91746385, "body": "I think you are lying to the compiler. You tell it no other access to the contents pointed at by <code>p</code> will happen within the scope of <code>f_restrict</code> and yet you do access it. <code>restrict</code> is a contract between the programmer and compiler, the compiler won&#39;t check for such access but rather trust the programmer. I don&#39;t believe gcc complains if you do an implicit conversion from <code>type* restrict</code> to <code>type*</code> though, which is questionable."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537359326, "post_id": 52399590, "comment_id": 91754995, "body": "@Lundin: so are you saying that the answer to my second question is NO? (If so, you could post that as an answer). Also, do you know if there is another way to get what I want?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537361078, "post_id": 52399590, "comment_id": 91756005, "body": "Ok I&#39;ll try to write an answer, but in my experience, compilers aren&#39;t all that trustworthy yet when it comes to optimizing <code>restrict</code>."}], "answers": [{"comments": [{"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1537359877, "post_id": 52405750, "comment_id": 91755316, "body": "As per my question title, do you know if there is a different thing I could try, if restrict is too restrictive for my needs? Is saving the value in a variable like Shafik suggested the only way?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1537360763, "post_id": 52405750, "comment_id": 91755842, "body": "@hugomg: I am not aware of any way to tell the compiler an object is modified only through one pointer but may be read through another. I doubt there is. A proper way to write a new compiler is to emit code in GCC\u2019s internal representation. Thus, the new front-end parses the language and writes GCC\u2019s internal language, and the existing back-end does optimization and generation of assembly/object code."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1537359617, "creation_date": 1537359617, "answer_id": 52405750, "question_id": 52399590, "link": "https://stackoverflow.com/questions/52399590/is-there-a-way-to-tell-the-c-compiler-that-a-pointer-has-no-aliasing-stores/52405750#52405750", "title": "Is there a way to tell the C compiler that a pointer has no aliasing stores?", "body": "<blockquote>\n  <p>First: Is there a way I can declare my variables to give this hint to the C compiler?</p>\n</blockquote>\n\n<p><code>int * restrict p = &amp;arr[17];</code> asserts that only <code>p</code> and pointer expressions based on <code>p</code> will be used to access any object <code>p</code> points to for the duration of the block (except for objects that are not modified in any way). This enables the optimization of <code>res += *p;</code> that you propose. The fact that GCC does not so optimize is a quality issue in GCC.</p>\n\n<blockquote>\n  <p>Second: Is my attempt to use restrict here valid? \u2026\n  Basically, I need to make sure that if I do *p = x in f then that write will be immediately noticed by other functions reading from arr[17].</p>\n</blockquote>\n\n<p>The latter property is not a valid use of <code>restrict</code>. The fact that <code>p</code> is declared <code>restrict</code> and <code>arr[17]</code> is modified via <code>p</code> means that no pointer not based on <code>p</code> should be used to access <code>arr[17]</code> during the execution of the block containing <code>p</code>, not even for reading. So, if something in <code>read_array</code> did read <code>arr[17]</code> (using <code>arr</code>, which is not based on <code>p</code>), it would be a violation of the <code>restrict</code> assertion.</p>\n"}], "owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 2, "accepted_answer_id": 52405750, "answer_count": 1, "score": 6, "last_activity_date": 1537360036, "creation_date": 1537339042, "last_edit_date": 1537360036, "question_id": 52399590, "link": "https://stackoverflow.com/questions/52399590/is-there-a-way-to-tell-the-c-compiler-that-a-pointer-has-no-aliasing-stores", "title": "Is there a way to tell the C compiler that a pointer has no aliasing stores?", "body": "<p>If the C compiler knows that a pointer is not aliased, it can perform many optimizations. For example, if I compile the following function with <code>gcc -O2</code>:</p>\n\n<pre><code>int f_noalias(int *arr, int x)\n{\n    int res = 0;\n    int *p = &amp;arr[17];\n    *p = x;\n    res += *p;\n    res += *p;\n    return res;\n}\n</code></pre>\n\n<p>the compiler knows that reading <code>*p</code> will always evaluate to <code>x</code> so the generated code is equivalent to the one generated for the following function:</p>\n\n<pre><code>int f_noalias2(int *arr, int x)\n{\n    int *p = &amp;arr[17];\n    *p = x;\n    return 2*x;\n}\n</code></pre>\n\n<p>However, if the compiler thinks the pointer might be aliased, it doesn't  perform this optimization anymore. For example, if we modify <code>f</code> so that an unknown function is called between the reads to <code>*p</code>, the generated code will dereference <code>p</code> twice. The compiler assumes that the <code>read_arr</code> function might have modified the value that <code>p</code> points to.</p>\n\n<pre><code>int f_withalias(int *arr, int x)\n{\n    int res = 0;\n    int *p = &amp;arr[17];\n    *p = x;\n    res += *p;\n    read_array(arr);\n    res += *p;\n    return res;\n}\n</code></pre>\n\n<p>In my particular program, when the <code>f</code> function is running the <code>p</code> pointer that it holds is the only one that writes to that element of the <code>arr</code> array. Other functions in the code might read from <code>arr</code> during this time, but won't write to it. (They might write other values to <code>arr</code> after <code>f</code> finishes running though.)</p>\n\n<p>So now I have three questions:</p>\n\n<p>First: <strong>Is there a way I can declare my variables to give this hint to the C compiler?</strong> I tried adding a restrict annotation to <code>p</code> but the generated code under <code>gcc -O2</code> was identical to the generated code for <code>f_withalias</code></p>\n\n<pre><code>int f_restrict(int *arr, int x)\n{\n    int res = 0;\n    int * restrict p = &amp;arr[17];\n    *p = x;\n    res += *p;\n    read_array(arr);\n    res += *p;\n    return res;\n}\n</code></pre>\n\n<p>Second: <strong>Is my attempt to use restrict here valid?</strong> My understanding is that restrict means that no other pointers can alias p, both for reading or writing. But in my case the <code>read_arr</code> function clearly can also access the <code>arr</code> array that <code>p</code> is pointing to. </p>\n\n<p>Third: <strong>If the answer to the previous question is \"no\", is there something different I can try instead of <code>restrict</code>?</strong></p>\n\n<p>Basically, I need to make sure that if I do <code>*p = x</code> in <code>f</code> then that write will be immediately noticed by other functions reading from <code>arr[17]</code>. However, I want GCC to feel free to optimize things like <code>x = *p; y = *p</code> to <code>x = *p; y = x</code>, even if there are function calls between the two reads.</p>\n"}, {"tags": ["c", "string", "segmentation-fault", "character", "strcpy"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1537338906, "post_id": 52399433, "comment_id": 91743063, "body": "<code>if (now = 1)</code> is always true and assigns the value <code>1</code> to <code>now</code>. You probably meant <code>if(now == 1)</code>. If you&#39;re using gcc, be sure to compile with <code>-Wall</code> and fix every warning."}, {"owner": {"reputation": 173, "user_id": 2319364, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/27255950392b1629e8ed7ae93b36e84f?s=128&d=identicon&r=PG", "display_name": "ceyun", "link": "https://stackoverflow.com/users/2319364/ceyun"}, "edited": false, "score": 1, "creation_date": 1537338910, "post_id": 52399433, "comment_id": 91743068, "body": "now++; will not affect the recursive code call. Make it static or global."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537339686, "post_id": 52399433, "comment_id": 91743459, "body": "It doesn&#39;t make sense to use strcpy into a string with 1 character. High probability that you write out-of-bounds somewhere. Use <code>c_exp[0] = other_character;</code> instead. Overall you have multiple beginner mistakes that could be easily avoided by using a decent compiler and listening to the warning messages you get when compiling."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1537340479, "post_id": 52399433, "comment_id": 91743888, "body": "This <code>char c_exp[] = &quot;1&quot;;</code> defines <code>c_exp</code> to be an array of 2 <code>char</code>. This size cannot be changed during run-time."}], "answers": [{"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1537340083, "post_id": 52399540, "comment_id": 91743678, "body": "Since <code>sizeof(char)</code> is <i>always</i> one, you could just <code>malloc(2)</code>."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1537340593, "post_id": 52399540, "comment_id": 91743940, "body": "@paxdiablo Done."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1537342308, "last_edit_date": 1592644375, "creation_date": 1537338841, "answer_id": 52399540, "question_id": 52399433, "link": "https://stackoverflow.com/questions/52399433/strcpy-giving-segmentation-fault/52399540#52399540", "title": "strcpy giving segmentation fault", "body": "<p>You are getting segfault because you are returning address of local variable.</p>\n<pre><code>char s[2] = {c, '\\0'};\n    return s;\n</code></pre>\n<p><code>s</code> will be destroyed once control exits  <code>chartoStr</code> function.</p>\n<p>Compiler is also warning the same</p>\n<blockquote>\n<p>warning: function returns address of local variable [-Wreturn-local-addr]</p>\n<pre><code> return s;\n ^\n</code></pre>\n</blockquote>\n<p>You don't need  <code>strcpy</code> to copy the single character you can directly assign.</p>\n<p>To solve your problem you can try as below.</p>\n<pre><code>char *chartoStr(char c)\n{\n    char *s = malloc(2);\n     s[0] = c;\n     s[1] =  '\\0';\n    return s;\n}\n</code></pre>\n<p>Don't forget to free <code>s</code> after work done.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1537343464, "last_edit_date": 1537343464, "creation_date": 1537341149, "answer_id": 52400138, "question_id": 52399433, "link": "https://stackoverflow.com/questions/52399433/strcpy-giving-segmentation-fault/52400138#52400138", "title": "strcpy giving segmentation fault", "body": "<p><code>chartoStr()</code> returns a local that is no longer available at function's end as well answered by <a href=\"https://stackoverflow.com/a/52399540/2410359\">@kiran Biradar</a></p>\n\n<pre><code>char s[2] = {c, '\\0'};\nreturn s;  // bad, UB\n</code></pre>\n\n<hr>\n\n<p>An alternative to calling <code>chartoStr()</code> it to create the <em>string</em> in the calling code using a <a href=\"https://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\">compound literal</a>  (Since C99).</p>\n\n<pre><code>// strcpy(c_exp, chartoStr(expressions[0]));\n//            v-----------------------------v---- compound literal         \nstrcpy(c_exp, (char []){expressions[0], '\\0'});\n</code></pre>\n\n<p>A nice attribute is that there is no expensive allocation nor pointer to free.  The <em>compound literal</em> is valid until the end of the block.</p>\n\n<hr>\n\n<p>Note that code could employ other improvements by saving the length <code>size_t len = strlen(c_exp)</code> once early in <code>cexpGen()</code> and using it to append.</p>\n\n<pre><code>// strcpy(c_exp, chartoStr(expressions[0]));\nc_exp[len++] = expressions[0];\nc_exp[len] = '\\0';\n</code></pre>\n\n<hr>\n\n<p><strong>Other Problems</strong> </p>\n\n<p>Take heed to <a href=\"https://stackoverflow.com/questions/52399433/strcpy-giving-segmentation-fault/52400138#comment91743888_52399433\">@alk</a> about <code>char c_exp[] = \"1\";</code></p>\n\n<p><code>while (c_exp[strlen(c_exp) - 1]) &gt; 10</code> is <em>undefined behavior</em> should <code>strlen(c_exp)</code> return 0.  Perhaps <code>while ((len = strlen(c_exp)) &gt; 0 &amp;&amp; c_exp[len - 1]) &gt; 10</code>?</p>\n\n<p><code>if (now = 1)</code> is always true. <a href=\"https://stackoverflow.com/questions/52399433/strcpy-giving-segmentation-fault/52400138#comment91743063_52399433\">@user3386109</a></p>\n"}], "owner": {"reputation": 1478, "user_id": 10176717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0303515be69a1ae26d7c8f0b85687a?s=128&d=identicon&r=PG&f=1", "display_name": "amirali", "link": "https://stackoverflow.com/users/10176717/amirali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 52400138, "answer_count": 2, "score": 1, "last_activity_date": 1537343464, "creation_date": 1537338329, "question_id": 52399433, "link": "https://stackoverflow.com/questions/52399433/strcpy-giving-segmentation-fault", "title": "strcpy giving segmentation fault", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *cexpGen();\nchar *chartoStr(char c);\n\nchar c_exp[] = \"1\";\nchar expressions[2] = {'+', '-'};\n\nint main()\n{\n    cexpGen();\n    printf(\"%s\", c_exp);\n    return 0;\n}\n\nchar *cexpGen()\n{\n    int now = 1;\n    while ((c_exp[strlen(c_exp) - 1]) &gt; 10)\n    {\n        if ((c_exp[strlen(c_exp) - 1]) == '+' || (c_exp[strlen(c_exp) - 1]) == '-')\n        {\n            strcpy(c_exp, chartoStr(((c_exp[strlen(c_exp) - 2]) + 1)));\n            continue;\n        }\n\n        if (now = 1)\n        {\n            strcpy(c_exp, chartoStr(expressions[0]));\n            now++;\n            cexpGen();\n        }\n\n        if (now = 2)\n        {\n            strcpy(c_exp, chartoStr(expressions[1]));\n            now++;\n            cexpGen();\n        }\n\n        if (now = 3)\n        {\n            strcpy(c_exp, chartoStr(((c_exp[strlen(c_exp) - 1]) + 1)));\n        }\n    }\n}\n\nchar *chartoStr(char c)\n{\n    char s[2] = {c, '\\0'};\n    return s;\n}\n</code></pre>\n\n<p>I wanted to concatenate a cahracter and an string, But we don't have the function to do that, So I've defined a function chartoStr. Also c_exp and expressions varaibles aren't in read only mode, But strcpy() gives me segmentation fault. I also tried other functions any way, Like strcat, Which didn't help. </p>\n\n<p>In case it helps, I debug it in VS Code. It opens <code>strcpy-sse2-unaligned.S</code> and shows segmentation fault in one of it's lines.</p>\n\n<p>Is launch.json or task.json files needed? I don't think they may help, So I don't  full the question with codes, But tell me if they're needed.</p>\n"}, {"tags": ["c++", "c", "arduino", "strncmp"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1537336589, "post_id": 52399011, "comment_id": 91741978, "body": "Your variable <code>incomming</code> is not a string! It&#39;s a single <code>char</code>. A string is, basically, a zero-terminated <i>array</i> of <code>char</code>. And if you only want to compare the two first letters of a string, why the long second string instead of just using plain <code>strcmp</code> and compare your input <i>string</i> to <code>&quot;el&quot;</code>?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1537343025, "post_id": 52399011, "comment_id": 91745222, "body": "How can this compile?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9664369, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155809871475667/picture?type=large", "display_name": "Shota Kvaratskhelia", "link": "https://stackoverflow.com/users/9664369/shota-kvaratskhelia"}, "edited": false, "score": 0, "creation_date": 1537769617, "post_id": 52402101, "comment_id": 91888773, "body": "Thanks, but actually this did not work for me. Instead I used the code:"}, {"owner": {"reputation": 11, "user_id": 9664369, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155809871475667/picture?type=large", "display_name": "Shota Kvaratskhelia", "link": "https://stackoverflow.com/users/9664369/shota-kvaratskhelia"}, "edited": false, "score": 0, "creation_date": 1537769668, "post_id": 52402101, "comment_id": 91888793, "body": "void loop() {   Wire.requestFrom(I2C_ESP_ADDRESS,18);  while (Wire.available()){        incoming = Wire.read(); Serial.print(incoming);  //Serial.print(incoming);   //sprintf (incomingArray, &quot;%.20&quot;, incoming);    if ( incoming == &#39;e&#39;) {     modelArray[0] = &#39;e&#39;;           for (int i = 1; i &lt; 18; i++ ){       modelArray[i] = (char) Wire.read();       Serial.print(modelArray[i-1]);     }   }"}], "tags": [], "owner": {"reputation": 5896, "user_id": 1106415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6fvK.png?s=128&g=1", "display_name": "hlt", "link": "https://stackoverflow.com/users/1106415/hlt"}, "is_accepted": false, "score": 0, "last_activity_date": 1537347952, "creation_date": 1537347952, "answer_id": 52402101, "question_id": 52399011, "link": "https://stackoverflow.com/questions/52399011/error-in-arduino-ide-using-strncmp-function/52402101#52402101", "title": "Error in Arduino IDE using strncmp function", "body": "<p>On Arduino, <a href=\"https://www.arduino.cc/en/Reference/WireRead\" rel=\"nofollow noreferrer\"><code>Wire.read()</code></a> reads a <em>single byte</em> only (<code>char</code>).</p>\n\n<p><code>strncmp</code> wants to compare two zero-terminated strings (<code>const char *</code>), and doesn't really deal with single characters, which is why you get the compiler error: It tells you that you can't just treat a <code>char</code> as if it was a <code>const char *</code>.</p>\n\n<p>When you force it to do so anyways by casting to <code>const char *</code>, it treats the value of that single byte as a pointer, and <code>strncmp</code> reads places in memory that it probably isn't supposed to (whatever is at the address given by the value of the byte). That causes the crash that you saw.</p>\n\n<p>Fundamentally, there seem to be a couple of mix-ups between <em>strings</em> (a sequence of bytes with a null byte at the end) and <em>characters</em> (just a single byte) here. In memory, the difference looks like this:</p>\n\n<pre><code>          +----+\nchar '*': | 42 |\n          +----+\n</code></pre>\n\n<p><sup></sup></p>\n\n<pre><code>              +----+----+----+----+\nstring \"***\": | 42 | 42 | 42 |  0 |\n              +----+----+----+----+\n</code></pre>\n\n<p>Both <code>incoming</code> and <code>model</code> are currently only capable of holding a single character. If you want to store multiple characters, consider using an array (<code>char incoming[SIZE]</code>, where <code>SIZE</code> is the maximum size of the data).</p>\n\n<p>Then, you can write incoming bytes to subsequent positions in the array, and ultimately compare the entire string at once using <code>strncmp</code> like you did before.</p>\n\n<p>If you are really only looking to compare individual bytes as they come in, just compare them directly (<code>incoming == 'x'</code>) or keep track of an index into your comparison string that you reset to zero at every mismatch.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9664369, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155809871475667/picture?type=large", "display_name": "Shota Kvaratskhelia", "link": "https://stackoverflow.com/users/9664369/shota-kvaratskhelia"}, "is_accepted": false, "score": 0, "last_activity_date": 1537769763, "creation_date": 1537769763, "answer_id": 52473594, "question_id": 52399011, "link": "https://stackoverflow.com/questions/52399011/error-in-arduino-ide-using-strncmp-function/52473594#52473594", "title": "Error in Arduino IDE using strncmp function", "body": "<p>So this is the correct code that worked for me:</p>\n\n<pre><code>void loop() {\n\n Wire.requestFrom(I2C_ESP_ADDRESS,18);\n while (Wire.available()){\n\n\n\n incoming = Wire.read();\nSerial.print(incoming);\n //Serial.print(incoming);\n\n //sprintf (incomingArray, \"%.20\", incoming);\n\n  if ( incoming == 'e') {\n    modelArray[0] = 'e';\n\n\n    for (int i = 1; i &lt; 18; i++ ){\n      modelArray[i] = (char) Wire.read();\n      Serial.print(modelArray[i-1]);\n    }\n  } \n\n\n\n    if ( incoming == 'a') {\n    readingArray[0] = 'a';\n   // Serial.print(\"Got Reading: \");\n\n    for (int j = 1; j &lt; 18; j++ ){\n      readingArray[j] = (char) Wire.read();\n      Serial.print(readingArray[j-1]);\n    }\n\n    Serial.println();\n\n    }\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9664369, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155809871475667/picture?type=large", "display_name": "Shota Kvaratskhelia", "link": "https://stackoverflow.com/users/9664369/shota-kvaratskhelia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537780668, "creation_date": 1537336411, "last_edit_date": 1537780668, "question_id": 52399011, "link": "https://stackoverflow.com/questions/52399011/error-in-arduino-ide-using-strncmp-function", "title": "Error in Arduino IDE using strncmp function", "body": "<p>I am using the following code to compare two strings and get the error:</p>\n\n<pre><code>&gt;  #define _EXFUN(name, proto)  name proto\n&gt; \n&gt;                               ^\n&gt; \n&gt; exit status 1 invalid conversion from 'char' to 'const char*'\n&gt; [-fpermissive]\n</code></pre>\n\n<p>As I understand strncmp function is looking for 'const char*', but when I cast the 'chat' to 'const char*' I get weird results in serial monitor:</p>\n\n<pre><code>&gt; Exception (28): epc1=0x40209035 epc2=0x00000000 epc3=0x00000000\n&gt; excvaddr=0x00000030 depc=0x00000000\n&gt; \n&gt; ctx: cont  sp: 3ffffda0 end: 3fffffd0 offset: 01a0\n&gt; \n&gt; &gt;&gt;&gt;stack&gt;&gt;&gt; 3fffff40:  40100fee 3ffe8c3c 000026fe 00000000   3fffff50:  401011c4 000026fe 3ffee75c 00000000   3fffff60:  3ffe8c70 3ffee75c\n&gt; 3ffe850c 3ffee75c   3fffff70:  3ffee6e0 3ffee7c8 40202fe8 3fffefb0  \n&gt; 3fffff80:  402014ce 00000001 00000001 402014c3   3fffff90:  00002580\n&gt; 3ffee6dc 00000014 4020292c   3fffffa0:  feefeffe 00000000 3ffee7c0\n&gt; 3ffee7c8   3fffffb0:  3fffdad0 00000000 3ffee7c0 40203074   3fffffc0: \n&gt; feefeffe feefeffe 3ffe850c 401000e5   &lt;&lt;&lt;stack&lt;&lt;&lt; ?)\u2e2e\n</code></pre>\n\n<p>The code itself:</p>\n\n<pre><code>#include &lt;Wire.h&gt;\n#define I2C_ESP_ADDRESS 8\nint count=0;\nchar model;\nchar reading;\nchar incoming;\n\nvoid setup()\n{\n    Serial.begin(9600);\n    Wire.begin(5,4);//Change to Wire.begin() for non ESP.\n    /*model[0] = \"e\";\n    model[1] = \"0\";\n    for (int i = 1; i &lt; 20; i++) {\n        model[i] = 0;\n    }*/\n}\n\nvoid loop()\n{     \n    Wire.requestFrom(I2C_ESP_ADDRESS,20);\n    while (Wire.available())\n    {\n        delay(1);\n        incoming = Wire.read();\n\n        if (strncmp(incoming,\"elxxxxxxxxxxxxxxxxxx\",2) == 1 ) {\n            model = incoming;\n        } else { \n            reading = incoming;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "linux-capabilities"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1537335855, "post_id": 52398855, "comment_id": 91741705, "body": "You can find the code for the get_cap command and see what it does."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1537335977, "post_id": 52398855, "comment_id": 91741739, "body": "<a href=\"http://man7.org/linux/man-pages/man3/libcap.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/libcap.3.html</a>?"}, {"owner": {"reputation": 131, "user_id": 4956820, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5V7WG.jpg?s=128&g=1", "display_name": "Advent", "link": "https://stackoverflow.com/users/4956820/advent"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1537337243, "post_id": 52398855, "comment_id": 91742278, "body": "@immibis: But which one is it? I found that those functions return cap_t structure which don&#39;t have something like possibility of returning capability I am looking for <a href=\"http://www.castaglia.org/proftpd/doc/devel-guide/src/lib/libcap/libcap.h.html#_cap_struct\" rel=\"nofollow noreferrer\">castaglia.org/proftpd/doc/devel-guide/src/lib/libcap/&hellip;</a>"}, {"owner": {"reputation": 131, "user_id": 4956820, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5V7WG.jpg?s=128&g=1", "display_name": "Advent", "link": "https://stackoverflow.com/users/4956820/advent"}, "edited": false, "score": 0, "creation_date": 1537337322, "post_id": 52398855, "comment_id": 91742316, "body": "@melponene: Okay, so which function will return informations required by me?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1537337982, "post_id": 52398855, "comment_id": 91742630, "body": "@Advent: Manual pages will tell you; you&#39;re expected to read them to find out what functions are available and what those that are available do.  One part of learning how to program is learning how to find information about libraries you plan to use (or are thinking about using)."}, {"owner": {"reputation": 131, "user_id": 4956820, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5V7WG.jpg?s=128&g=1", "display_name": "Advent", "link": "https://stackoverflow.com/users/4956820/advent"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537338109, "post_id": 52398855, "comment_id": 91742692, "body": "@Jonathan Leffler: Alright, I think I found it. I will post answer after I sort it out."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 4956820, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5V7WG.jpg?s=128&g=1", "display_name": "Advent", "link": "https://stackoverflow.com/users/4956820/advent"}, "is_accepted": true, "score": 1, "last_activity_date": 1537344651, "last_edit_date": 1537344651, "creation_date": 1537343756, "answer_id": 52400873, "question_id": 52398855, "link": "https://stackoverflow.com/questions/52398855/how-to-get-file-capabilities-in-linux-using-c-c-with-other-method-than-system/52400873#52400873", "title": "How to get file capabilities in Linux using C/C++ with other method than system() system call?", "body": "<p>So if I understand manual well, something like this should work:</p>\n\n<pre><code>capt_t file_cap;\ncap_flag_value_t cap_flag_value;\n\nfile_cap = cap_get_file(\"/path/\");\nif(file_cap != 0) {\n    if(cap_get_flag(file_cap, CAP_NEW_RAW, CAP_EFFECTIVE, &amp;cap_flag_value) == 0) {\n        if(cap_flag_value == CAP_SET)\n        // it works\n    }\n    else // handle error\n    if(cap_get_flag(file_cap, CAP_NEW_RAW, CAP_PERMITTED, &amp;cap_flag_value) == 0) {\n        if(cap_flag_value == CAP_SET)\n        // it works\n    }\n    else // handle error\n}\nelse // handle error\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 4956820, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/5V7WG.jpg?s=128&g=1", "display_name": "Advent", "link": "https://stackoverflow.com/users/4956820/advent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 52400873, "answer_count": 1, "score": -1, "last_activity_date": 1537344651, "creation_date": 1537335749, "last_edit_date": 1537335891, "question_id": 52398855, "link": "https://stackoverflow.com/questions/52398855/how-to-get-file-capabilities-in-linux-using-c-c-with-other-method-than-system", "title": "How to get file capabilities in Linux using C/C++ with other method than system() system call?", "body": "<p>I have a task to fulfil and part of it is to get certain file capabilities and check if they are set correctly using C/C++. I want to make sure that certain file has cap_new_raw+ep capability. What would be other way of achieving it than using system(get_cap file) and reading output (not returning value, output)?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1537335202, "post_id": 52398712, "comment_id": 91741473, "body": "Please <a href=\"https://stackoverflow.com/posts/52398712/edit\">edit</a> and add <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, including <i>complete</i> error messages. Also since you are using cpp files, you are likely using C++. If so, then remove the C tag."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1537335886, "post_id": 52398712, "comment_id": 91741711, "body": "@user694733 C and C++ use pretty much the same model here (there <i>may</i> be some wrinkles I am not aware of).  He is not asking for debugging help, but an understanding of how both C and C++ work.  I don&#39;t think we need a MCVE for this, anyone who can say &quot;ODR&quot; understands what is going on here.  C and C++ are t"}, {"owner": {"reputation": 61, "user_id": 9922806, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aSVQmwVL6eo/AAAAAAAAAAI/AAAAAAAAAAc/SPdiTxBk-7g/photo.jpg?sz=128", "display_name": "Fred Hu", "link": "https://stackoverflow.com/users/9922806/fred-hu"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1537336653, "post_id": 52398712, "comment_id": 91741999, "body": "@MartinBonner thanks, I know  &quot;ODR&quot; ,but still not very understanding of this issue."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1537337679, "post_id": 52398712, "comment_id": 91742485, "body": "@MartinBonner A difference arises if we consider equally named functions with differing signature: C refuses, C++ produces overloads..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1537337923, "post_id": 52398712, "comment_id": 91742597, "body": "@FredHu Very last paragraph: <code>struct ListNode;</code> is a declaration only. As soon as you add braces, you get a definition - in this very last example of an empty struct without any members (fine in C++, illegal in C, though)."}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537335860, "post_id": 52398798, "comment_id": 91741707, "body": "Hmmm.... well, the layout may not be passed to the linker, but the <i>names</i> are, if I&#39;m not mistaken. Perhaps focus on the difference between a <i>name</i> and an <i>object</i> (which is the difference between <code>extern int a;</code> for the name and <code>int a;</code>  for the object)."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1537335955, "post_id": 52398798, "comment_id": 91741733, "body": "Two equally named, but different structs used in two different files for two different purposes is not a problem per se (as you said: compile time thing, who would check?); the problem comes into play only if the differing structs are used to exchange data between those two translation units..."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1537335989, "post_id": 52398798, "comment_id": 91741744, "body": "@PeterA.Schneider No, the names of structs are not passed to the linker (except as they are embedded in the names of functions with name mangling, and some hidden global tables for vtables)."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1537336076, "post_id": 52398798, "comment_id": 91741774, "body": "@Aconcagua No.  That is wrong.  Two equally named but different structs are <i>undefined behaviour</i>.  Your C++ implementation is allowed to do anything it likes (and that includes &quot;appearing to work&quot;)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537336101, "post_id": 52398798, "comment_id": 91741786, "body": "@PeterA.Schneider The name of the structure is not needed by the linker (it could be saved as part of debug information though), and the members will be translated into offsets by the compiler so they&#39;re not needed either (with the same debug-info caveat)."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1537336180, "post_id": 52398798, "comment_id": 91741818, "body": "Might be worth saying that if a struct is used in two translation units it <i>must</i> be defined in both:  the usual way of doing this safely  is to put the definition in a header file and then #including it into both TUs."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 3, "creation_date": 1537336251, "post_id": 52398798, "comment_id": 91741845, "body": "@Aconcagua Martin is correct, it&#39;s even mentioned in the ODR-link I provided. Purely practically though, if the structures are not shared between TU&#39;s, it will most likely work fine though, It&#39;s still not correct."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1537337198, "post_id": 52398798, "comment_id": 91742250, "body": "@MartinBonner Well, it&#39;s made known to the linker as soon as I use objects defined elsewhere or make my own externally visible. The bare struct definition is pretty useless and is not having any impact on the generated code at all."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1537337347, "post_id": 52398798, "comment_id": 91742329, "body": "@Aconcagua Today&#39;s development environments can peek across TUs for optimization at link time via annotated object files. Integrated environments may even do that with the source code (respecting as-if). That opens a perhaps unexpected backdoor of information flow. Something around that idea is  probably the reason for the unqualified generality of the ODR."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 7, "last_activity_date": 1537335427, "creation_date": 1537335427, "answer_id": 52398798, "question_id": 52398712, "link": "https://stackoverflow.com/questions/52398712/why-c-c-the-structure-type-can-be-redefined-in-different-files-but-the-variab/52398798#52398798", "title": "Why C/C++ the structure type can be redefined in different files, but the variable and function gives an error?", "body": "<p>Basically because structures are really just compile-time things, the structure definitions themselves are not passed on to the linker.</p>\n\n<p>Global and static variables on the other hand needs to be passed on to the linker which checks that there's only a single definition of everything (it enforces the <a href=\"https://en.cppreference.com/w/cpp/language/definition#One_Definition_Rule\" rel=\"noreferrer\"><em>one definition rule</em></a>).</p>\n\n<p>Be careful with the structures though, even if you can define a structure in multiple <a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"noreferrer\">translation unit</a>, the definitions have to be an exact character by character match. If they are not then you will have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\"><em>undefined behavior</em></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1537336274, "post_id": 52398826, "comment_id": 91741851, "body": "This is wrong <code>struct ListNode { int a; };</code> is a definition not a declaration too."}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": false, "score": 2, "last_activity_date": 1537336577, "last_edit_date": 1537336577, "creation_date": 1537335636, "answer_id": 52398826, "question_id": 52398712, "link": "https://stackoverflow.com/questions/52398712/why-c-c-the-structure-type-can-be-redefined-in-different-files-but-the-variab/52398826#52398826", "title": "Why C/C++ the structure type can be redefined in different files, but the variable and function gives an error?", "body": "<p>Defining <code>struct ListNode</code> multiple times is equivalent to put the definition into a header file and include it across your project. This is fine, because the same user defined type can be defined as many times as you want.</p>\n\n<p><code>int a;</code>, however, creates an instance. And non-<code>const</code>, non-<code>static</code> symbols have external linkage by default, which means that the linker will complain upon encountering two identical global symbols <code>a</code>. You can control the linkage, with defining one of the integers (in test1.cpp and/or test2.cpp) as</p>\n\n<pre><code>static int a; // internal linkage, not visible across files\n</code></pre>\n\n<p>or by initializing it right away together with a <code>const</code> qualifier</p>\n\n<pre><code>const int a = 42; // again, internal linkage\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9922806, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aSVQmwVL6eo/AAAAAAAAAAI/AAAAAAAAAAc/SPdiTxBk-7g/photo.jpg?sz=128", "display_name": "Fred Hu", "link": "https://stackoverflow.com/users/9922806/fred-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1537343512, "creation_date": 1537334962, "last_edit_date": 1537343512, "question_id": 52398712, "link": "https://stackoverflow.com/questions/52398712/why-c-c-the-structure-type-can-be-redefined-in-different-files-but-the-variab", "title": "Why C/C++ the structure type can be redefined in different files, but the variable and function gives an error?", "body": "<p>test1.cpp:</p>\n\n<pre><code>struct ListNode\n{\n    int       m_nValue;\n    ListNode* m_pNext;\n};\n</code></pre>\n\n<p>test2.cpp: </p>\n\n<pre><code> struct ListNode\n {\n     int       m_nValue;\n     ListNode* m_pNext;\n };\n</code></pre>\n\n<p>ps: test1.cpp and test2.cpp are same project, run is ok.</p>\n\n<p>but,\ntest1.cpp:</p>\n\n<pre><code>int a;\n</code></pre>\n\n<p>test2.cpp:</p>\n\n<pre><code>int a;\n</code></pre>\n\n<p>Will be redefined\uff0cerror.</p>\n\n<pre><code>struct ListNode\n{\n    int       m_nValue;\n    ListNode* m_pNext;\n};\n</code></pre>\n\n<p>if just declaration, not definition, why</p>\n\n<p>test.cpp:</p>\n\n<pre><code> struct ListNode\n  {\n       int       m_nValue;\n       ListNode* m_pNext;\n  };\n struct ListNode\n  {\n       int       m_nValue;\n       ListNode* m_pNext;\n  };\n</code></pre>\n\n<p>is redefined?</p>\n\n<p>and what's the difference about </p>\n\n<pre><code>struct ListNode;\nstruct ListNode;\nstruct ListNode{};\n</code></pre>\n\n<p>Are they all just declaration?</p>\n"}, {"tags": ["c", "arrays", "string", "char", "allegro"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1537335140, "post_id": 52398698, "comment_id": 91741454, "body": "Make <code>string</code> an array <i>of arrays</i> of characters, and use <a href=\"http://en.cppreference.com/w/c/string/byte/strcpy\" rel=\"nofollow noreferrer\"><code>strcpy</code></a>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537335930, "post_id": 52398698, "comment_id": 91741724, "body": "Are you familiar with dynamic memory allocation via <code>malloc()</code> et al?  If so, you could use that to make copies of the strings (lines) you read.  If you&#39;ve not covered <code>malloc()</code> and <code>free()</code> yet, then use the simpler but less flexible 2D array of characters.  Don&#39;t forget to remove the newline that <code>fgets()</code> includes in the data.  (Since you&#39;ve got a comment about a string array of size 80 for 80 lines, what do you plan to write there?  Why didn&#39;t you write it?)"}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537336190, "post_id": 52398698, "comment_id": 91741824, "body": "is there a better method than <code>fgets()</code> ? and @JonathanLeffler, I didn&#39;t write it because I don&#39;t know the proper way to do it in C"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537336644, "post_id": 52398698, "comment_id": 91741991, "body": "Define &quot;better&quot;?  Using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> is using standard C and it is a good technique to use.  There are grounds for considering POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> as better in some ways, but it isn&#39;t standard C (it is standard POSIX).  It requires a slightly different approach \u2014 it allows a simpler approach to allocating the memory for your strings, but it requires knowledge which you probably don&#39;t yet have."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1537336761, "post_id": 52398698, "comment_id": 91742065, "body": "If you aren&#39;t sure how to declare a 2D array in C, it is difficult to help you without regurgitating what your text book should be telling you.  We will help honest efforts to solve a problem, but we don&#39;t simply write the code for you.  There are a number of ways that your problem could be tackled; we don&#39;t know which your course notes and lectures expect you to use."}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1537337207, "post_id": 52398698, "comment_id": 91742258, "body": "well I know that if I do <code>char array[10][80]</code> that will make an array of size 10 where each index can hold 80 characters, correct? So if I want to store 80 lines of text and none of them are more than 70 characters long, I should make <code>char array[80][70]</code>. I like the idea of using <code>strcpy</code>, like @Someprogrammerdude suggested since I understand that function. So right now in my loop I&#39;m trying <code>strcpy(array[i], input);</code> but that seems to be crashing the program. I appreciate your help!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1537337701, "post_id": 52398698, "comment_id": 91742497, "body": "Yes, using <code>char array[80][70];</code> would allow you to store up to 80 lines of up to 70 characters each, where the character count includes the terminating null byte (so up to 69 displayable characters and one null byte at the end).  It&#39;s not obvious why <code>strcpy(array[i], input)</code> would crash your program unless you get more than 80 input lines.  You should check that you don&#39;t go beyond the end of your array (that <code>i</code> does not reach or exceed 80).  Please read about creating an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  That helps us to help you better."}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "edited": false, "score": 0, "creation_date": 1537338021, "post_id": 52398698, "comment_id": 91742652, "body": "bumping it from <code>char array[80][70]</code> to <code>char array[90][70]</code> did stop it from crashing."}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "edited": false, "score": 0, "creation_date": 1537338270, "post_id": 52398698, "comment_id": 91742760, "body": "heyyyyy I think i&#39;m getting somewhere :D I am now using the 2D array to print some of the lines again."}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "edited": false, "score": 0, "creation_date": 1537338560, "post_id": 52398698, "comment_id": 91742887, "body": "YES! I was able to print out the entire document using the 2D array!"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1537338962, "post_id": 52398698, "comment_id": 91743097, "body": "Even better duplicate I think: <a href=\"https://stackoverflow.com/q/29568297/1025391\">C - how to store multiple strings in an array</a>"}, {"owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1537339693, "post_id": 52398698, "comment_id": 91743463, "body": "Thank you JonathanLeffler and @Some Programmer dude! I solved it with your guidance."}], "answers": [{"comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 3, "creation_date": 1537337356, "post_id": 52399141, "comment_id": 91742333, "body": "The style indentation presented here is not OK, and would get you a &quot;please explain&quot; in any code review and/or programming assignment."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1537337386, "post_id": 52399141, "comment_id": 91742348, "body": "Please don&#39;t put multiple statements on a single line as you show; white space (newlines) are cheap, even on Stack Overflow.  I observe that you include the newlines in the saved data.  That&#39;s permissible and allows you to omit the newline at the end of the format string in the <code>printf()</code> statement  You should check that <code>malloc()</code> succeeds before using it in <code>line[i] = strncpy( malloc( lineLen ), input, lineLen );</code>.  While that may work most of the time in test programs, it is not safe for professional development work."}, {"owner": {"reputation": 449, "user_id": 2133679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/a21z8.png?s=128&g=1", "display_name": "Andrew of Scappoose", "link": "https://stackoverflow.com/users/2133679/andrew-of-scappoose"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1537338573, "post_id": 52399141, "comment_id": 91742895, "body": "@kingsley;  Yes, it would.  But any C programmer KNOWS the meaning of curly braces,  and short lines of 80 characters or less can be seen at a glance.  The formatting is on purpose, for if the opening poster is copying this for homework, without understanding, they will get a penalty.  If they are trying to &quot;learn&quot;, about a specific detail ... they will write their own code for the homework assignment."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1537342608, "post_id": 52399141, "comment_id": 91744993, "body": "<code>strlen</code>, <code>strncpy</code>, <code>malloc</code> and copy could be replaced by <code>strdup</code>..."}], "tags": [], "owner": {"reputation": 449, "user_id": 2133679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/a21z8.png?s=128&g=1", "display_name": "Andrew of Scappoose", "link": "https://stackoverflow.com/users/2133679/andrew-of-scappoose"}, "is_accepted": false, "score": -1, "last_activity_date": 1537338786, "last_edit_date": 1537338786, "creation_date": 1537337001, "answer_id": 52399141, "question_id": 52398698, "link": "https://stackoverflow.com/questions/52398698/storing-text-lines-in-an-array-c/52399141#52399141", "title": "Storing text lines in an array, C", "body": "<p>Each line of the file is a different string, and each string is a char* pointer to an array; so what you are needing is a 1D array of char* pointers (or alternately a 2D array of char.)</p>\n\n<pre><code>char *line[ MAX_LINES ];  // 1D array of char* pointers.\n</code></pre>\n\n<p>You can either initialize a two dimensional array of char, or you can malloc the memory for each line of the 1D  char* pointers.  </p>\n\n<p>Here's an example of the malloc approach.  The variable it's stored in is called \"line\" rather than \"input\"; but you can exchange the variable names if you like, and change the print formatting to solve your particular problem.  This is just intended as an example of reading the strings into memory, in the same way you desire.  No practical system has less than 4K of heap space, so I've omitted the malloc memory check.</p>\n\n<pre><code>#include &lt;string.h&gt;                                                             \n#include &lt;malloc.h&gt;                                                             \n#include &lt;stdio.h&gt;                                                              \n\n#define MAX_LINES 10                                                            \n#define MAX_LEN   60                                                            \n\nint main( int narg, char *arg[] ) {                                             \n    char input[ MAX_LEN ];                                                      \n    char *line[ MAX_LINES ];                                                    \n    FILE *inFile;                                                               \n    int i,j;                                                                    \n\n    if ( narg != 2 ){fprintf( stderr, \"Use: %s filename\\n\", arg[0] ); return 2;}  \n    if (!(inFile=fopen(arg[1],\"r\") )){\n          fprintf( stderr, \"Can't open '%s'\\n\",arg[1]);\n          return 2;\n    }\n\n    for ( i=0; i&lt;MAX_LINES &amp;&amp; fgets(input, sizeof(input), inFile ); ++i ) {     \n        int lineLen=strlen(input) + 1;                                          \n        line[i] = strncpy( malloc( lineLen ), input, lineLen );                 \n    }                                                                           \n\n    for ( j=0; j&lt;i; ++j ) { printf( \"Line %d:%s\", j+1, line[j] ); free(line[j]); }\n    fclose(inFile);                                                             \n    return 0;                                                                   \n}        \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10383694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m5knOZiBIII/AAAAAAAAAAI/AAAAAAAAABU/o3jycE1PXJo/photo.jpg?sz=128", "display_name": "Alex Shaw", "link": "https://stackoverflow.com/users/10383694/alex-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1724, "favorite_count": 0, "closed_date": 1537370495, "answer_count": 1, "score": 0, "last_activity_date": 1537339807, "creation_date": 1537334918, "last_edit_date": 1537339807, "question_id": 52398698, "link": "https://stackoverflow.com/questions/52398698/storing-text-lines-in-an-array-c", "closed_reason": "Duplicate", "title": "Storing text lines in an array, C", "body": "<p>I am new to C and I am confused how I can read through a file and store each line to an index of an array.</p>\n\n<p>Example file:</p>\n\n<blockquote>\n  <p>What color is the sky? <br> Red <br> Orange <br> Yellow <br> Blue <br></p>\n</blockquote>\n\n<p>Desired result of code:</p>\n\n<blockquote>\n  <p>input[0] = What color is the sky? <br> input[1] = Red <br> input[2] =\n  Orange <br> input[3] = Yellow <br> input[4] = Blue <br></p>\n</blockquote>\n\n<p>Hhere is what I have so far:</p>\n\n<pre><code>char input[60];\n\n//declare string array of size 80, for 80 lines\n\nfor(int i = 0; fgets(input, sizeof(input), inFile)!=NULL; i++){ \n\n    //string[i] = input; storing this line to the string index\n\n}\n\n//later on use the string[80] that now has all lines\n</code></pre>\n\n<p>I understand that declaring <code>input[60]</code> is only determining the length of each line, not the number of lines. I am so used to thinking about strings in other coding languages, that the use of char is throwing me off. I have tried video tutorials but they didn't help me.</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1537333897, "post_id": 52398442, "comment_id": 91741048, "body": "You have 5 rows in your array and you try to write to 12 rows of it ...  you should break the loop when <code>NUM_THREADS_ctr == NUM_THREADS</code>"}, {"owner": {"reputation": 44, "user_id": 10383607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6bac284b0f59d603205ba011cbdded9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/10383607/jack"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1537334470, "post_id": 52398442, "comment_id": 91741233, "body": "Certainly an obvious check. Thanks M.M for the response, spent a good bit of time on what could be going wrong."}], "owner": {"reputation": 44, "user_id": 10383607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6bac284b0f59d603205ba011cbdded9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/10383607/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1537333553, "creation_date": 1537333553, "question_id": 52398442, "link": "https://stackoverflow.com/questions/52398442/receiving-memory-access-error-double-free-or-corruption-out", "title": "Receiving memory access error: double free or corruption (out)", "body": "<p>Facing quite the perplexing issue. I have placed print statements prior to the line, free('line'), and it seems the character array, declared as char *line, is printing as it should.</p>\n\n<p>I have created a custom strdupe function for efficiency purpose. nthread_lines represents an array of strings where each row length is variable.</p>\n\n<p>Below is the relevant code:</p>\n\n<pre><code>#define NUM_THREADS     5\n\nchar *strdupe(const char *src) {\n    size_t len = strlen(src) + 1;\n    char *s = malloc(len);\n    if (s == NULL)\n        return NULL;\n    return (char *)memcpy(s, src, len);\n}\n\nint main(int argc, char *argv[]) {\n  FILE *stream;\n  // holds NUM_THREADS amount of lines read in from file\n  char** nthread_lines;\n\n  char *line = NULL;\n  size_t len = 0;\n  ssize_t nread;\n\n  size_t NUM_THREADS_ctr = 0;\n  nthread_lines = malloc(NUM_THREADS * sizeof(char *)); \n\n   while ((nread = getline(&amp;line, &amp;len, stream)) != -1) {\n\n       nthread_lines[NUM_THREADS_ctr] = strdupe(line);\n\n       printf(\"Length of buffer %d\\n\", strlen(nthread_lines[NUM_THREADS_ctr]));\n       printf(\"Size of buffer CHECK %d\\n\", sizeof(nthread_lines[NUM_THREADS_ctr]));\n       printf(\"Check nthread_lines:%s\\n\", nthread_lines[NUM_THREADS_ctr]);\n\n       printf(\"\\n\");\n\n       printf(\"Length of buffer %d\\n\", strlen(line));\n       printf(\"Size of buffer CHECK %d\\n\", sizeof(line));               \n       printf(\"Check line:%s\\n\", line);\n\n\n\n       NUM_THREADS_ctr++;\n\n   }\n\n   printf(\"Size of buffer, len: %d\\n\", len);\n   printf(\"Length of buffer %d\\n\", strlen(line));\n   printf(\"Size of buffer CHECK %d\\n\", sizeof(line));\n   printf(\"CHECK:%s\\n\", line);\n\n\n   free(line); // cause the double free error\n   fclose(stream);\n\n   return 0;\n}\n</code></pre>\n\n<p>Below is the file i tested with:</p>\n\n<pre><code>Line 1\nLine 2\nLine 3\nLine 4\nLine 5\nLine 6\nLine 7\nLine 8\nLine 9\nLine 10\nLine 11Line 11\n</code></pre>\n"}, {"tags": ["c", "cryptography", "bcrypt"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1537357113, "post_id": 52398352, "comment_id": 91753699, "body": "It does not have a period because it does not produce a periodic sequence."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1537484571, "post_id": 52398352, "comment_id": 91812435, "body": "@JamesKPolk That&#39;s not entirely correct. It does likely  have an internal state, and if the internal state repeats you would get a so called cycle, which would be close to a &quot;period&quot; (but different initial states may produce cycles of different sizes). However, generally cycles are <i>very</i> large and the RNG may include reseeding."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1537486048, "post_id": 52398352, "comment_id": 91812742, "body": "@MaartenBodewes Yes, <i>if</i> it never reseeded then it would be periodic. But it does reseed, at least if it implements CTR-DRBG like it says it does."}], "answers": [{"tags": [], "owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1537552739, "last_edit_date": 1592644375, "creation_date": 1537552739, "answer_id": 52448916, "question_id": 52398352, "link": "https://stackoverflow.com/questions/52398352/what-is-the-theoretical-period-of-bcryptgenrandom-function/52448916#52448916", "title": "What is the theoretical period of BCryptGenRandom function?", "body": "<p>Microsoft :</p>\n<blockquote>\n<p>The default random number provider implements an algorithm for\ngenerating random numbers that complies with the <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-90a.pdf\" rel=\"nofollow noreferrer\">NIST SP800-90</a>\nstandard, specifically the CTR_DRBG portion of that standard.</p>\n</blockquote>\n<p>NIST :</p>\n<blockquote>\n<p>The seed used to instantiate the DRBG must contain sufficient entropy\nto provide an assurance of randomness. If the seed is kept secret, and\nthe algorithm is well designed, the bits output by the DRBG will be\nunpredictable, up to the instantiated security strength of the DRBG.</p>\n<p>CTR_DRBG uses an approved block cipher algorithm in the counter mode</p>\n</blockquote>\n<p>We expect maximum number of bits output from CTR_DRBG is equal to the 2^blocksize.  Interestingly, <a href=\"https://eprint.iacr.org/2006/379.pdf\" rel=\"nofollow noreferrer\">Campagna</a> shows that we cannot distinguish the output of CTR_DRBG from a true random number generator</p>\n<blockquote>\n<p>The NIST codebook-based deterministic random bit generators are\nanalyzed in the context of being indistinguishable from random. Upper\nand lower bounds based on the probability of distinguishing the output\nare proven. These bounds imply that the security of the designs are\nbounded by the codebook width, or more precisely on the property that\nthe codebooks act like a random permutation, as opposed to their\nunderlying security parameter or key length. This paper concludes that\nthese designs fail to support security parameters larger than the\ncodebook width.</p>\n</blockquote>\n"}], "owner": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1537552739, "creation_date": 1537333042, "last_edit_date": 1537484731, "question_id": 52398352, "link": "https://stackoverflow.com/questions/52398352/what-is-the-theoretical-period-of-bcryptgenrandom-function", "title": "What is the theoretical period of BCryptGenRandom function?", "body": "<p>I'm trying to use the function <code>BCryptGenRandom</code> defined in the <code>bcrypt.h</code> header file. However, I cannot find information about the security properties of this function.</p>\n\n<p>What is the theoretical period of <code>BCryptGenRandom</code> function?</p>\n\n<p>MSDN does not seem to provide this information.</p>\n"}, {"tags": ["c", "emulation", "virtualization", "cpu-registers"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1537332967, "post_id": 52398329, "comment_id": 91740763, "body": "Unclear, and off-topic since too broad. You need to read more about <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">Operating Systems</a>. Be sure to understand well the <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">ABI</a> relevant for your (emulated) system. Study existing <a href=\"https://github.com/hjl-tools/x86-psABI/wiki/X86-psABI\" rel=\"nofollow noreferrer\">x86 ABI</a>s"}, {"owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537333632, "post_id": 52398329, "comment_id": 91740955, "body": "@BasileStarynkevitch is that better?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1537333694, "post_id": 52398329, "comment_id": 91740976, "body": "Not really. You need to spend hours in reading the ABI relevant for your system. Once you have read them, you could ask a better (and more focused) question, which would probably cite some of that ABI. Actually, once you have studied your ABI, you&#39;ll have the answer to your question. You might also need to understand what <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system call</a>s exist on your (emulated) system"}, {"owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537333830, "post_id": 52398329, "comment_id": 91741027, "body": "does that apply for the archetecture the cpu is emulating or does that apply to the host the emulator is running on, for example if i want to be able to run it on ARM and X86 would i need to know how functions are called for BOTH ARM and X86, or can i just forawd them through C, or would i need to reimpliment the entire libc implimentation in my cpu machine code then somehow externally call the hosts hardware to preform the required tasks such as writing to the screen or accessing the sound card ect"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537333888, "post_id": 52398329, "comment_id": 91741047, "body": "A given architecture (e.g. x86-64) can have (and usually does have) <i>several</i> ABIs. You need to choose one and read its specification. Of course, the usual ARM ABI (for Linux) is different than the x86-64 ABI (for Linux)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537334003, "post_id": 52398329, "comment_id": 91741073, "body": "BTW a CPU emulator don&#39;t run assembler code, but machine code"}, {"owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537334060, "post_id": 52398329, "comment_id": 91741093, "body": "i know, i meant like assembling it all to machine code the cpu emulator can read and process"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "edited": false, "score": 0, "creation_date": 1537334102, "post_id": 52398329, "comment_id": 91741102, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180312/discussion-between-basile-starynkevitch-and-psp-coder\">continue this discussion in chat</a>."}, {"owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537334195, "post_id": 52398329, "comment_id": 91741134, "body": "thus would that ALSO require knowledge of the exact hardware the emulator is being ran on to call its hardware correctly, for example being ran with one type of graphics card vs a completely different type of graphics card, would i need to know how to call each type of graphics card"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1537342886, "post_id": 52398329, "comment_id": 91745136, "body": "In practice, you&#39;ll better have some operating system on your emulated hardware (and details matter, so explain <i>what</i> OS you have on your emulated system; if you don&#39;t have any, give enough details about what graphics card is emulated)"}], "owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537333332, "creation_date": 1537332886, "last_edit_date": 1537333332, "question_id": 52398329, "link": "https://stackoverflow.com/questions/52398329/in-a-cpu-emulator-is-assembly-required-to-call-a-external-function", "title": "in a cpu emulator is assembly required to call a external function", "body": "<p>in a cpu emulator is assembly required to call a external function and store there return code or is it possible to do that from within the language the emulator is coded in, for example, in gnu gas 64 bit assembly:</p>\n\n<pre><code>        .file   \"hello_world.c\"\n        .text\n        .section        .rodata\n.LC0:\n        .string \"hello world\"\n        .text\n        .globl  main\n        .type   main, @function\nmain:\n.LFB0:\n        .cfi_startproc\n        pushq   %rbp\n        .cfi_def_cfa_offset 16\n        .cfi_offset 6, -16\n        movq    %rsp, %rbp\n        .cfi_def_cfa_register 6\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        movl    $0, %eax\n        popq    %rbp\n        .cfi_def_cfa 7, 8\n        ret\n        .cfi_endproc\n.LFE0:\n        .size   main, .-main\n        .ident  \"GCC: (Ubuntu 7.3.0-16ubuntu3) 7.3.0\"\n        .section        .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>could one call puts via, say</p>\n\n<pre><code>rax = puts(/* register arguments 1 to 6 in order, plus stack arguments if any */);\n</code></pre>\n\n<p>in C, or would one be required to EXPLICITLY call puts via assembly via say calling a function, that contains inline asm, that takes viardic arguments, with the contents of each virtual cpu register, then in assembly copy those into the host registers themselves, call the desired function, then copy the host registers back into the virtual registers then return</p>\n"}, {"tags": ["c", "data-structures", "file-io", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 3303, "user_id": 3694269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc17b732422dc4655658a246ceaba6c6?s=128&d=identicon&r=PG", "display_name": "Shanu Gupta", "link": "https://stackoverflow.com/users/3694269/shanu-gupta"}, "edited": false, "score": 0, "creation_date": 1537331078, "post_id": 52397902, "comment_id": 91740242, "body": "split the lines using space and populate the record. If number of records are not humongous, old fashioned array would provide acceptable performance."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 7743976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862b79ef56991de3ab89c64844d05e55?s=128&d=identicon&r=PG&f=1", "display_name": "user18359", "link": "https://stackoverflow.com/users/7743976/user18359"}, "is_accepted": false, "score": 0, "last_activity_date": 1537333267, "creation_date": 1537333267, "answer_id": 52398395, "question_id": 52397902, "link": "https://stackoverflow.com/questions/52397902/how-can-i-read-a-text-file-into-a-structure-and-interact-with-its-members/52398395#52398395", "title": "How can I read a text file into a structure and interact with its members?", "body": "<blockquote>\n  <p><code>struct record **r = (struct record**)malloc(arrlen * sizeof(struct record*));</code></p>\n</blockquote>\n\n<p>Here, you are allocating space for <em>pointers to records</em>, not records. To allocate space for records you should instead say:</p>\n\n<pre><code>struct record *r = (struct record*)malloc(arrlen * sizeof(struct record));\n</code></pre>\n\n<p>To actually store the information from your string in one of the records, </p>\n\n<blockquote>\n  <p><code>r[i] = str;</code></p>\n</blockquote>\n\n<p>is not what you want. Use <a href=\"http://www.cplusplus.com/reference/cstdio/sscanf/\" rel=\"nofollow noreferrer\">sscanf</a> instead:</p>\n\n<pre><code>sscanf(buf, \"%s %d %f\", r[i].name, &amp;(r[i].age), &amp;(r[i].weight));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10207967, "user_type": "registered", "profile_image": "https://graph.facebook.com/2124424831104791/picture?type=large", "display_name": "S\u01a1n T&#249;ng", "link": "https://stackoverflow.com/users/10207967/s%c6%a1n-t%c3%b9ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537333267, "creation_date": 1537330233, "last_edit_date": 1537330879, "question_id": 52397902, "link": "https://stackoverflow.com/questions/52397902/how-can-i-read-a-text-file-into-a-structure-and-interact-with-its-members", "title": "How can I read a text file into a structure and interact with its members?", "body": "<p>I've been struggling with this for days and still can't find its solution.</p>\n\n<p>My text file has N lines and each line of it has the format of:</p>\n\n<pre><code>Full_name age weight\n</code></pre>\n\n<p>I have to read that file and print out the result of a query which has the format: </p>\n\n<pre><code>./find age_range weight_range order by [age/weight] [ascending/descending]\n</code></pre>\n\n<p>E.g:</p>\n\n<pre><code>./find 30 35 60.8 70.3 order by age ascending\n</code></pre>\n\n<p>My structure:</p>\n\n<pre><code>Struct record{\nchar name[20];\n  int age;\n  float weight;\n};\n</code></pre>\n\n<p>I think reading the file's records into structure is the case but I still can't find out how to do it.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst int STEPSIZE = 100;\n\nstruct record {\n    char name[20];\n  int age;\n  float weight;\n};\n\nvoid ** loadfile(char *filename, int *len);\nint main(int argc, char *argv[])\n{\n    if(argc == 1)\n    {\n        printf(\"Must supply a filename to read\\n\");\n        exit(1);\n    }\n\n    int length = 0;\n     loadfile(argv[1], &amp;length);\n\n}\n\nvoid ** loadfile(char *filename, int *len)\n{\n    FILE *f = fopen(filename, \"r\");\n    if (!f)\n    {\n    printf(\"Cannot open %s for reading\\n\", filename);\n    return NULL;\n    }\n\n    int arrlen = STEPSIZE;\n\n    //Allocate space for 100 char*\n    struct record **r = (struct record**)malloc(arrlen * sizeof(struct record*));\n\n\n    char buf[1000];\n    int i = 0;\n    while(fgets(buf, 1000, f))\n    {\n        //Check if array is full, If so, extend it\n        if(i == arrlen)\n        {\n        arrlen += STEPSIZE;\n\n        char ** newlines = realloc(r, arrlen * sizeof(struct record*));\n        if(!newlines)\n        {\n            printf(\"Cannot realloc\\n\");\n            exit(1);\n        }\n        r = (struct record**)newlines;\n        }\n\n    //Trim off newline char\n    buf[strlen(buf) - 1] = '\\0';\n\n    //Get length of buf\n    int slen = strlen(buf);\n\n    //Allocate space for the string\n    char *str = (char *)malloc((slen + 1) * sizeof(char));\n\n    //Copy string from buf to str\n    strcpy(str, buf);\n\n    //Attach str to data structure\n    r[i] = str;\n\n    i++;\n    }\n    *len = i; //  Set the length of the array of char *\n    return ;\n}\n</code></pre>\n\n<p>Please help me to improve it and find out the solution.</p>\n\n<p>Any help would be appreciated, thanks.</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1537329818, "post_id": 52397758, "comment_id": 91739917, "body": "Your question is not very clear. You can use different thread functions for different threads."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 10278161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/852cdd8f9c9bc3414b51d8eb5b5d0728?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/10278161/prem"}, "is_accepted": false, "score": 0, "last_activity_date": 1537330578, "creation_date": 1537330578, "answer_id": 52397950, "question_id": 52397758, "link": "https://stackoverflow.com/questions/52397758/how-to-assign-task-for-each-thread-without-forcefully-using-c-i-e-each-thread-ne/52397950#52397950", "title": "How to assign task for each thread without forcefully using c I.e each thread need to take some work after completion of first work ?", "body": "<p>You can define a function that is called by all the threads to pick up the work.  The pick_work() function uses mutex to ensure that each threads gets its own unique work.  Here's the pseudocode:</p>\n\n<pre><code>int currWork = 0;\n\n// Each thread calls pick_work() to figure out the work.  If the\n// return value of pick_work() is &lt; 0, the thread returns/exits.\n\n// Returns index of work assgined to caller\n// Returns -1 to indicate that there is no more work left.\nint pick_work()\n{\n    int work_index = -1;\n    pthread_mutex_lock(&amp;mutex);\n    if (currWork &lt; MAX_WORKS) {\n        work_index = currWork;\n        currWork++;\n    }\n    pthread_mutex_unlock(&amp;mutex);\n    return work_index;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 10406012, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iaNm9BiKDVg/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVRA7wmA2x-JgjtPCqHjqv3EF3SoQ/mo/photo.jpg?sz=128", "display_name": "Preeti", "link": "https://stackoverflow.com/users/10406012/preeti"}, "is_accepted": false, "score": 0, "last_activity_date": 1537987946, "creation_date": 1537987946, "answer_id": 52524338, "question_id": 52397758, "link": "https://stackoverflow.com/questions/52397758/how-to-assign-task-for-each-thread-without-forcefully-using-c-i-e-each-thread-ne/52524338#52524338", "title": "How to assign task for each thread without forcefully using c I.e each thread need to take some work after completion of first work ?", "body": "<p>In your problem, it seems you have a different range of <strong>k</strong> for each thread. So, you don't need a mutex for calculating the value of k. The only thing needed is to send the start and end value of k for each thread, which is passed to af_sum function.</p>\n\n<p>Since we cannot pass multiple arguments to a thread function, need to use a structure to group all the arguments. Will be using a pointer to the structure as an argument to the thread function.</p>\n\n<p>Following changes are needed</p>\n\n<pre><code>    typedef struct dataStruct\n    {\n            int start;\n            int end;\n    }dataStruct;\n\n    void *Data_output(void *data)\n    {\n            dataStruct *D = (dataStruct *)data;\n            for(int k = D-&gt;start; k &lt; D-&gt;end; k++)\n                af_sum(&amp;sum_Data[k], &amp;sub_Data[k], &amp;Out_Mem[k]);\n    }\n\n    int main()\n    {\n         pthread_t read_thread_id[4];\n         dataStruct D[4] = {{0, 32}, {32, 64}, {64, 96}, {96, 128}};\n         int i;\n         for (i = 0; i &lt; thread_count ; i++)\n         {\n            pthread_create (&amp;read_thread_id[i], NULL, Data_output, (void *) &amp;D[i]);\n         }\n\n         for (i = 0; i &lt; thread_count; i++)\n         {\n            pthread_join (read_thread_id[i], NULL);\n         }\n         return (0);\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10383269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/473d27471ca845f29b14d89cea1af0ee?s=128&d=identicon&r=PG&f=1", "display_name": "JacKey", "link": "https://stackoverflow.com/users/10383269/jackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537987946, "creation_date": 1537329100, "question_id": 52397758, "link": "https://stackoverflow.com/questions/52397758/how-to-assign-task-for-each-thread-without-forcefully-using-c-i-e-each-thread-ne", "title": "How to assign task for each thread without forcefully using c I.e each thread need to take some work after completion of first work ?", "body": "<p>I.e each thread need to take some work after completion of first work. Automatically each thread need to take task and run the code. can some please help on this method ?</p>\n\n<pre><code>    #include &lt;pthread.h&gt;\n\n\n    #define thread_count (4)\n    pthread_t read_thread_id[thread_count ];\n\n    float sum_Data[128]= {0,1,2,3.........128};\n    float sub_Data[128]= {0,1,2,3.........128};\n    float Out_Mem[128] ={0};\n\n\n\n\n    void af_sum(float *a, float *b, float *c)\n    {\n       c=a+b;\n       return 0;\n    }\n\n    void *Data_output(void *data)\n    {\n       int temp = (int) data;\n       int k;\n\n       if(temp==0)\n       {\n//assigning some task for thread 0\n          for(k = 0; k &lt; 32; k++)\n          {\n             af_sum(&amp;sum_Data[k], &amp;sub_Data[k], &amp;Out_Mem[k]);\n          }\n       }\n       else if(temp==1)\n       {\n//assigning some task for thread 1\n          for(k = 32; k &lt; 64; k++)\n          {\n             af_sum(&amp;sum_Data[k], &amp;sub_Data[k], &amp;Out_Mem[k]);\n          }\n       }\n       else if(temp==2)\n       {\n//assigning some task for thread 3\n          for(k = 64; k &lt; 96; k++)\n          {\n             af_sum(&amp;sum_Data[k], &amp;sub_Data[k], &amp;Out_Mem[k]);\n          }\n       }\n       else\n       {\n//assigning some task for thread 4\n          for(k = 96; k &lt; 128; k++)\n          {\n             af_sum(&amp;sum_Data[k], &amp;sub_Data[k], &amp;Out_Mem[k]);\n          }\n       }\n\n       return 0;\n\n    }\n\n\n\n    int main()\n    {\n\n       int i,k;\n       for (i = 0; i &lt; thread_count ; i++)\n       {\n          pthread_create (&amp;read_thread_id[i], NULL, Data_output, (void *) i);\n       }\n\n       for (i = 0; i &lt; AF_NUM_INSTANCE; i++)\n       {\n          pthread_join (read_thread_id[i], NULL);\n\n       }\n\n        return (0);\n    }\n</code></pre>\n\n<p>I.e each thread need to take some work after completion of first work. Automatically each thread need to take task and run the code.</p>\n"}, {"tags": ["c", "spi", "esp32"], "answers": [{"tags": [], "owner": {"reputation": 1934, "user_id": 1214172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72406a2690ddc68dd58d66423f8c08b?s=128&d=identicon&r=PG", "display_name": "Alim &#214;zdemir", "link": "https://stackoverflow.com/users/1214172/alim-%c3%96zdemir"}, "is_accepted": false, "score": 1, "last_activity_date": 1616514111, "creation_date": 1616514111, "answer_id": 66766484, "question_id": 52397263, "link": "https://stackoverflow.com/questions/52397263/esp32-connecting-to-a-separate-ic-using-spi/66766484#66766484", "title": "ESP32 connecting to a separate IC using SPI", "body": "<p>You have used &quot;1&quot; for DMA in the line</p>\n<pre><code>ret=spi_bus_initialize(HSPI_HOST, &amp;buscfg, 1);\n</code></pre>\n<p>But as mentioned in the <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/spi_master.html\" rel=\"nofollow noreferrer\">docs</a>, the DMA needs to be configured.\nFor external PSRAM available on <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/modules-and-boards.html\" rel=\"nofollow noreferrer\">these boards</a> that means something like</p>\n<pre><code>pvPortMallocCaps(20, MALLOC_CAP_DMA)\n</code></pre>\n<p>Without DMA only 32 bits data are possible per transaction.</p>\n"}], "owner": {"reputation": 53, "user_id": 6570240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12b430213d260ea6ee4aa57ba35ea2e?s=128&d=identicon&r=PG&f=1", "display_name": "aidan chelig", "link": "https://stackoverflow.com/users/6570240/aidan-chelig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1642, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1616592149, "creation_date": 1537324995, "last_edit_date": 1616592149, "question_id": 52397263, "link": "https://stackoverflow.com/questions/52397263/esp32-connecting-to-a-separate-ic-using-spi", "title": "ESP32 connecting to a separate IC using SPI", "body": "<p>I am taking a shot at writing a wrapper for the S1V30120 dectalk text synthesis IC in C language using the ESP IDF. I am running into a problem in the following code.</p>\n\n<pre><code>printf(\"Hello world!\\n\");\nesp_err_t ret;\nspi_device_handle_t spi;\nspi_bus_config_t buscfg={\n    .miso_io_num=PIN_NUM_MISO,\n    .mosi_io_num=PIN_NUM_MOSI,\n    .sclk_io_num=PIN_NUM_CLK,\n    .quadhd_io_num=-1,\n    .quadwp_io_num=-1\n};\nspi_device_interface_config_t devcfg={\n    .clock_speed_hz=750000,\n    .mode=0,\n    .spics_io_num=PIN_NUM_CS,\n    .queue_size=7\n};\nret=spi_bus_initialize(HSPI_HOST, &amp;buscfg, 1);\nassert(ret==ESP_OK);\n\nret=spi_bus_add_device(HSPI_HOST, &amp;devcfg, &amp;spi);\nuint8_t rec[20];\nassert(ret==ESP_OK);\nuint8_t cmd[] = {0xAA, 0x04, 0x00, 0x05, 0x00}; // get information command\nprintf(\"waiting for rdy\");\nwhile (gpio_get_level(PIN_NUM_RDY) == 0){};\n//create 2 transactions 1 for transmitting the GET INFORMATION command\n//and 1 for getting the data back from the ic\nspi_transaction_t t;\nspi_transaction_t r;\nmemset(&amp;t, 0, sizeof(t));\nt.length=5*8;\nt.tx_buffer=&amp;cmd;\nr.length=20*8;\nr.rx_buffer=&amp;rec;\n\nret = spi_device_transmit(spi, &amp;t);\nassert( ret == ESP_OK);\nret = spi_device_transmit(spi, &amp;r);\nassert(ret == ESP_OK);\nprintf((char*)r.rx_data);\n/* Print chip information */\nprintf(\"Restarting now.\\n\");\n</code></pre>\n\n<p>I'm pretty sure connection should be in full duplex mode and I believe that is set up correctly. the information coming back should be 20 bytes but I am getting the error </p>\n\n<pre><code>rxdata transfer &gt; 32 bits without configured DMA\n</code></pre>\n\n<p>at the moment I am following 2 pieces of code that may help.</p>\n\n<p>an example of using SPI in the esp idf:\n<a href=\"https://github.com/espressif/esp-idf/blob/3276a1316f66a923ee2e75b9bd5c7f1006d160f5/examples/peripherals/spi_master/main/spi_master_example_main.c\" rel=\"nofollow noreferrer\">https://github.com/espressif/esp-idf/blob/3276a1316f66a923ee2e75b9bd5c7f1006d160f5/examples/peripherals/spi_master/main/spi_master_example_main.c</a></p>\n\n<p>an example of using the dectalk ic in Arduino ide:\n<a href=\"https://electronza.com/arduino-due-s1v30120-text-speech-code/2/\" rel=\"nofollow noreferrer\">https://electronza.com/arduino-due-s1v30120-text-speech-code/2/</a></p>\n\n<p>the dectalk ic protocol sheet:\n<a href=\"https://github.com/MikroElektronika/Click_TextToSpeech_S1V30120/blob/master/datasheet/S1V30120%20Protocol%20Specification.pdf\" rel=\"nofollow noreferrer\">https://github.com/MikroElektronika/Click_TextToSpeech_S1V30120/blob/master/datasheet/S1V30120%20Protocol%20Specification.pdf</a></p>\n\n<p>and the SPI documentation for the esp idf:\n<a href=\"https://gitdemo.readthedocs.io/en/latest/api/peripherals/spi_master.html\" rel=\"nofollow noreferrer\">https://gitdemo.readthedocs.io/en/latest/api/peripherals/spi_master.html</a></p>\n\n<p>the protocol sheet also says something about sending 16 bytes of 0x00 after a transaction I've never seen that before though.</p>\n\n<p>I hope I was thorough enough with all this information and I thank anyone in advance who can help!</p>\n"}, {"tags": ["c", "ubuntu", "makefile", "ld"], "answers": [{"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 0, "last_activity_date": 1537324943, "creation_date": 1537324943, "answer_id": 52397255, "question_id": 52397191, "link": "https://stackoverflow.com/questions/52397191/usr-bin-x86-64-linux-gnu-ld-cannot-find/52397255#52397255", "title": "/usr/bin/x86_64-linux-gnu-ld: cannot find?", "body": "<p>The <code>-l</code> option is for linking dynamic libraries (like <code>libkeccak.so</code>). Static libraries are linked into the executable already if they're in one of the \"standard\" directories, so there's no need to provide the option <code>-lkeccak</code>.</p>\n\n<p>If you want to explicitly tell GCC to link a static library,</p>\n\n<pre><code>gcc -l:/path/to/libkeccak.a\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10323484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed632462e58f06dfbb885393e7c4f0e6?s=128&d=identicon&r=PG&f=1", "display_name": "cgjung", "link": "https://stackoverflow.com/users/10323484/cgjung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5310, "favorite_count": 0, "accepted_answer_id": 52397255, "answer_count": 1, "score": 2, "last_activity_date": 1537324961, "creation_date": 1537324432, "last_edit_date": 1537324961, "question_id": 52397191, "link": "https://stackoverflow.com/questions/52397191/usr-bin-x86-64-linux-gnu-ld-cannot-find", "title": "/usr/bin/x86_64-linux-gnu-ld: cannot find?", "body": "<p>I study C language in ubuntu 18.04(gcc 7.3)</p>\n\n<p>When the <code>make all</code> command is entered, this error occurrs:</p>\n\n<blockquote>\n  <p>/usr/bin/x86_64-linux-gnu-ld: can not find -lkeccak</p>\n</blockquote>\n\n<p>The <code>Makefile</code> is as follows.</p>\n\n<pre><code>CC=gcc\nCFLAGS=-03 -fomit-frame-pointer -msse2avx -mavx2 -march=native -std=c99\n\nall:\n    $(CC) $(CFLAGS) -c Lizard.c main.c randombytes.c sha512.c\n    $(CC) $(CFLAGS) -o Lizard Lizard.o main.o randobytes.o sha512.o -lkeccak\n\nrun: all\n    ./Lizard\n\nnew:\n    make clean\n    make all\n    ./Lizard\n</code></pre>\n\n<p>Currently the <code>libkeccak.a</code> file is in the same directory as the <code>Makefile</code> and \nit is also in the <code>/usr/include</code> directory.</p>\n\n<p>I do not know the solution method at all.</p>\n\n<p>Please, Help me.</p>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 4, "last_activity_date": 1537323365, "creation_date": 1537323365, "answer_id": 52397072, "question_id": 52397066, "link": "https://stackoverflow.com/questions/52397066/dereferencing-pointer-to-incomplete-type-of-structure-in-structure-of-assignment/52397072#52397072", "title": "Dereferencing pointer to incomplete type of structure in structure of assignment for the member", "body": "<p>You need the names for the structures, not just typedefs:</p>\n\n<pre><code>typedef struct sub_term{\n//             ^^^^^^^^\n    int sub_id;\n    int sub_data;\n    struct sub_term *next_term;\n}sub_term;\n\ntypedef struct major_term{\n//             ^^^^^^^^^^\n    char name[10];\n    struct sub_term *init_term;\n    struct sub_term *current_term;\n}major_term;\n</code></pre>\n\n<p>Defining type names with <code>typedef</code> like this</p>\n\n<pre><code>typedef struct {} MyType;\n</code></pre>\n\n<p>does not define the structure with name <code>MyType</code>. Instead, it defines the name <code>MyType</code> as an alias of an unnamed struct.</p>\n\n<p>Structure names and general type names are in two separate namespaces in C, so <code>struct MyType</code> is different from <code>MyType</code>, and they don't interfere with each other.</p>\n\n<p>When you declare a structure without defining it (i.e., providing the content of the structure), the structure is an incomplete type. In your code, you defined pointers to <code>struct sub_term</code> but you didn't define that structure (note again: <code>typedef</code>-ing does not give names to structures - it defines aliases for your unnamed structures), so the compiler complains about \"incomlete types\".</p>\n"}], "owner": {"reputation": 23, "user_id": 10381624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pPJ4I.jpg?s=128&g=1", "display_name": "bluemelancholy", "link": "https://stackoverflow.com/users/10381624/bluemelancholy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 52397072, "answer_count": 1, "score": 2, "last_activity_date": 1537323365, "creation_date": 1537323260, "question_id": 52397066, "link": "https://stackoverflow.com/questions/52397066/dereferencing-pointer-to-incomplete-type-of-structure-in-structure-of-assignment", "title": "Dereferencing pointer to incomplete type of structure in structure of assignment for the member", "body": "<p>I encountered a problem about pointer and structure.</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n</code></pre>\n\n<p>Define two structure, sub term and major term.</p>\n\n<pre><code>typedef struct{\n    int sub_id;\n    int sub_data;\n    struct sub_term *next_term;\n}sub_term;\n\ntypedef struct{\n    char name[10];\n    struct sub_term *init_term;\n    struct sub_term *current_term;\n}major_term;\n</code></pre>\n\n<p>I want to create a major term that contains sub term.</p>\n\n<pre><code>int main(void){\n\nmajor_term *Test_1;\nTest_1 = (major_term *)malloc(sizeof(major_term));\n\nTest_1-&gt;init_term = (sub_term *)malloc(sizeof(sub_term));   \nTest_1-&gt;current_term = Test_1-&gt;init_term;\n\nprintf(\"Sub term 1 id : \");\n</code></pre>\n\n<p>However, compiler notices me that \"[Error] dereferencing pointer to incomplete type\" in this line.</p>\n\n<pre><code>scanf(\"%d\",&amp;Test_1-&gt;current_term-&gt;sub_id);\n</code></pre>\n\n<p>I am new to C language and not sure the reason. \nThank you for your recommend that makes my code better !</p>\n\n<pre><code>printf(\"Sub term 1 id : \",Test_1-&gt;current_term-&gt;sub_id);\nprintf(\"Sub term 1 data: \");\nscanf(\"%d\",&amp;Test_1-&gt;current_term-&gt;sub_data);\nprintf(\"Sub term 1 data : \",Test_1-&gt;current_term-&gt;sub_data);    \n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "member"], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 7224432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a11a64240afafc7dad72d5e4e0992247?s=128&d=identicon&r=PG&f=1", "display_name": "KeizerHarm", "link": "https://stackoverflow.com/users/7224432/keizerharm"}, "edited": false, "score": 0, "creation_date": 1537322220, "post_id": 52396891, "comment_id": 91738428, "body": "Aaah, that&#39;s brilliant! Thank you! Will accept in 6 min, when StackOverflow lets me."}, {"owner": {"reputation": 300, "user_id": 7224432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a11a64240afafc7dad72d5e4e0992247?s=128&d=identicon&r=PG&f=1", "display_name": "KeizerHarm", "link": "https://stackoverflow.com/users/7224432/keizerharm"}, "edited": false, "score": 0, "creation_date": 1537322371, "post_id": 52396891, "comment_id": 91738462, "body": "But, it looks like in this code you are making only a pointer to the head_node, not the head_node itself? Strange that one can then still access it."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 300, "user_id": 7224432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a11a64240afafc7dad72d5e4e0992247?s=128&d=identicon&r=PG&f=1", "display_name": "KeizerHarm", "link": "https://stackoverflow.com/users/7224432/keizerharm"}, "edited": false, "score": 2, "creation_date": 1537322511, "post_id": 52396891, "comment_id": 91738499, "body": "@KeizerHarm The type of <code>*head_node</code> is <code>struct mylist_node</code>, i.e. an instance of the struct and not a pointer, so <code>sizeof(*head_node)</code> allocates enough bytes to hold an instance of that struct, and after the <code>malloc</code> call <code>head_node</code> points to that memory."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1537321965, "creation_date": 1537321965, "answer_id": 52396891, "question_id": 52396843, "link": "https://stackoverflow.com/questions/52396843/i-can-alter-a-struct-member-from-one-location-but-not-from-the-other/52396891#52396891", "title": "I can alter a struct member from one location but not from the other", "body": "<p>In <code>mylist_init</code>, you're storing the address of a local variable in the struct pointed to by <code>l</code>.  That variable goes out of scope when the function returns, so the memory it occupied is no longer valid, and thus the pointer that previously pointed to it now points to an invalid location.  Returning the address of a local variable a dereferencing that address invokes undefined behavior.</p>\n\n<p>Your function needs to allocate memory dynamically using <code>malloc</code> so the memory will still be valid when the function returns.  </p>\n\n<pre><code>void mylist_init(struct mylist* l){\n    struct mylist_node *head_node = malloc(sizeof(*head_node));\n    l-&gt;head_pt = head_node;\n    l-&gt;head_pt-&gt;data = 5; \n};\n</code></pre>\n\n<p>Also, don't forget to <code>free</code> the memory when you're done using it.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537322514, "post_id": 52396901, "comment_id": 91738501, "body": "Instead of <code>struct mylist_node *head_node = (struct mylist_node *)malloc(sizeof(struct mylist_node));</code>, code can use <code>struct mylist_node *head_node = malloc(sizeof *head_node);</code>  I hope you find this easier to code right, review and maintain.     `"}], "tags": [], "owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "is_accepted": false, "score": 1, "last_activity_date": 1537322037, "creation_date": 1537322037, "answer_id": 52396901, "question_id": 52396843, "link": "https://stackoverflow.com/questions/52396843/i-can-alter-a-struct-member-from-one-location-but-not-from-the-other/52396901#52396901", "title": "I can alter a struct member from one location but not from the other", "body": "<p>For starters, you have to allocate memory for your node, the way you were doing it, your node is a local variable on the stack which will likely get overwritten after the function exits.</p>\n\n<pre><code>void mylist_init(struct mylist* l)\n{\n    struct mylist_node *head_node = (struct mylist_node *)malloc(sizeof(struct mylist_node));\n    head_node.data = 5; //First try\n    l-&gt;head_pt = head_node;\n};\n</code></pre>\n"}], "owner": {"reputation": 300, "user_id": 7224432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a11a64240afafc7dad72d5e4e0992247?s=128&d=identicon&r=PG&f=1", "display_name": "KeizerHarm", "link": "https://stackoverflow.com/users/7224432/keizerharm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 52396891, "answer_count": 2, "score": 1, "last_activity_date": 1537322037, "creation_date": 1537321588, "question_id": 52396843, "link": "https://stackoverflow.com/questions/52396843/i-can-alter-a-struct-member-from-one-location-but-not-from-the-other", "title": "I can alter a struct member from one location but not from the other", "body": "<p>I am trying to implement a linked list in C - starting simple, with one list containing one node. However, I stumble upon some issues when trying to add data to the node. Here's my implementation thus far:</p>\n\n<pre><code>struct mylist_node {\n  int data;\n};\n\nstruct mylist {\n  struct mylist_node *head_pt;\n};\n\nvoid mylist_init(struct mylist* l){\n    struct mylist_node head_node;\n    head_node.data = 5; //First try\n    l-&gt;head_pt = &amp;head_node;\n    l-&gt;head_pt-&gt;data = 5; //Second try\n};\n</code></pre>\n\n<p>And my main method:</p>\n\n<pre><code>int main()\n{\n    struct mylist ml, *ml_pointer;\n    ml_pointer = &amp;ml;\n    mylist_init(ml_pointer);\n\n    printf(\"%d\\n\", ml_pointer-&gt;head_pt-&gt;data);\n    ml_pointer-&gt;head_pt-&gt;data = 4;\n    printf(\"%d\\n\", ml_pointer-&gt;head_pt-&gt;data);\n\n    return 0;\n}\n</code></pre>\n\n<p>This should print out</p>\n\n<pre><code>5\n4\n</code></pre>\n\n<p>If my knowledge of pointers is correct. However, it prints out</p>\n\n<pre><code>0\n4\n</code></pre>\n\n<p>As you can see I try to set the node data twice within the mylist_init method. Neither appears to be working - meanwhile, writing to and reading from it from my main method works just fine. What am I doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1537320913, "post_id": 52396740, "comment_id": 91738164, "body": "Since you don\u2019t declare the function signature for <code>my_gets</code> in-line or in a header the compiler assumes it returns <code>int</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537322963, "post_id": 52396740, "comment_id": 91738605, "body": "Advanced: Code also has a subtle difference between <code>fgets()</code> and <code>my_fgets()</code>. When <code>EOF</code> is returned and to was due an error (not end-of-file), the return value should be <code>NULL;</code> as in <code>return (c == EOF &amp;&amp; (cs == s || !feof(fp))? NULL: cs;</code>.  Note: file input errors are rare."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537342279, "post_id": 52396740, "comment_id": 91744791, "body": "@ClancyZeng, Another advanced corner issue: Start with <code>if (maxlen &lt;= 0) return NULL;</code> to handle pathological, but legal, input.  Else <code>*cs = &#39;\\0&#39;;</code> is a problem."}, {"owner": {"reputation": 135, "user_id": 10382916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7f11372ac33da9ac81123e781bd46?s=128&d=identicon&r=PG&f=1", "display_name": "Clancy Zeng", "link": "https://stackoverflow.com/users/10382916/clancy-zeng"}, "edited": false, "score": 0, "creation_date": 1537343839, "post_id": 52396740, "comment_id": 91745641, "body": "You are right.I never thought that point.Thank you !"}], "answers": [{"tags": [], "owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "is_accepted": true, "score": 3, "last_activity_date": 1537321494, "creation_date": 1537321494, "answer_id": 52396835, "question_id": 52396740, "link": "https://stackoverflow.com/questions/52396740/if-my-fgetsline-max-fp-null-warning-comparison-between-pointer-and/52396835#52396835", "title": "if ( (my_fgets(line, max, fp)) == NULL) warning :comparison between pointer and integer [enabled by default]", "body": "<p>You need to declare the function in either a heade file or inline in <code>my_getline.c</code>:</p>\n\n<pre><code>char *my_fgets(char *s,int maxlen,FILE *fp);\n</code></pre>\n\n<p>Is the declaration. Either put that before your <code>my_getline</code> function or in <code>my_fgets.h</code> (with include guards) and #include that header in both your <code>.c</code> files. </p>\n\n<p>Without it the compiler assumes any function it sees without a declaration returns <code>int</code></p>\n"}], "owner": {"reputation": 135, "user_id": 10382916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7f11372ac33da9ac81123e781bd46?s=128&d=identicon&r=PG&f=1", "display_name": "Clancy Zeng", "link": "https://stackoverflow.com/users/10382916/clancy-zeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 52396835, "answer_count": 1, "score": 2, "last_activity_date": 1537321494, "creation_date": 1537320708, "question_id": 52396740, "link": "https://stackoverflow.com/questions/52396740/if-my-fgetsline-max-fp-null-warning-comparison-between-pointer-and", "title": "if ( (my_fgets(line, max, fp)) == NULL) warning :comparison between pointer and integer [enabled by default]", "body": "<p>this is my code:</p>\n\n<p><code>my_fgets.c</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nchar *my_fgets(char *s,int maxlen,FILE *fp)\n{\n    register int c;\n    register char *cs;\n\n    cs = s;\n    while(--maxlen &gt;0 &amp;&amp; (c = getc(fp)) != EOF)\n        if((*cs++ = c) == '\\n')\n            break;\n    *cs = '\\0';\n    return (c == EOF &amp;&amp; cs == s)? NULL: cs;\n}\n</code></pre>\n\n<p><code>my_getline.c</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\n/* getline : read a line, return lenght */ \nint my_getline(char *line, int max,FILE *fp)\n{\n    if ( (my_fgets(line, max, fp)) == NULL)\n        return 0;\n    else\n        return strlen(line);\n}\n</code></pre>\n\n<p>When I compiled the my_getline.c , I got a warning.</p>\n\n<pre><code>[root@server0 fgets]# gcc -c my_getline.c\nmy_getline.c: In function \u2018my_getline\u2019:\nmy_getline.c:7:36: warning: comparison between pointer and integer [enabled \nby default]\n     if ( (my_fgets(line, max, fp)) == NULL)\n                                    ^\n</code></pre>\n\n<p>I don't know where this program have errors. Could you tell me?\n<strong>Thank you!</strong></p>\n"}, {"tags": ["c", "unix"], "answers": [{"tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1537321092, "creation_date": 1537321092, "answer_id": 52396789, "question_id": 52396717, "link": "https://stackoverflow.com/questions/52396717/running-a-program-in-terminal-c-file-and-not-running-to-completion/52396789#52396789", "title": "Running a Program in Terminal (C file) and Not Running to Completion", "body": "<p>You have a typo in <code>factorial2</code> causing an infinite loop:</p>\n\n<pre><code>while (i &lt;= n);{\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>while (i &lt;= n) {\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9990241, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OIh2whFcwA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0IvElWq63zFjd_n-ZkU-8k5EQWHg/mo/photo.jpg?sz=128", "display_name": "Tommy O&#39;Connell", "link": "https://stackoverflow.com/users/9990241/tommy-oconnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52396789, "answer_count": 1, "score": -1, "last_activity_date": 1537324681, "creation_date": 1537320490, "last_edit_date": 1537324681, "question_id": 52396717, "link": "https://stackoverflow.com/questions/52396717/running-a-program-in-terminal-c-file-and-not-running-to-completion", "title": "Running a Program in Terminal (C file) and Not Running to Completion", "body": "<p>I just finished my first homework assignment in a C class, and my homework file isn't running to completion.</p>\n\n<p>Here is my compiler code:</p>\n\n<pre><code>$ cd hw1\n$ gcc -o hw1 hw1.c\n$ ./hw1\n</code></pre>\n\n<p>Here is the code from hw1.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nvoid ranges() {\n  printf(\"Signed Char/n\");\n  printf(\"Minimum Value  = %d\\n\", SCHAR_MIN);\n  printf(\"Maximum Value = %d\\n\", SCHAR_MAX);\n  printf(\"Unsigned Char\\n\");\n  printf(\"Minimum Value = 0\\n\");\n  printf(\"Maximum Value = %d\\n\", UCHAR_MAX);\n  printf(\"Signed Short \\n\");\n  printf(\"Minimum value = %d\\n\", SHRT_MIN);\n  printf(\"Maximum value = %d\\n\", SHRT_MAX);\n  printf(\"Unsigned Short \\n\");\n  printf(\"Minimum Value = 0\\n\");\n  printf(\"Maximum value = %d\\n\", USHRT_MAX);\n  printf(\"Signed Integer \\n\");\n  printf(\"Minimum value = %d\\n\", INT_MIN);\n  printf(\"Maximum value = %d\\n\", INT_MAX);\n  printf(\"Unsigned Integer \\n\");\n  printf(\"Minimum Value = 0\\n\");\n  printf(\"Maximum value = %ud\\n\", UINT_MAX);\n  printf(\"Signed Long \\n\");\n  printf(\"Minimum value = %li\\n\", LONG_MIN);\n  printf(\"Maximum value = %li\\n\", LONG_MAX);\n  printf(\"Unsigned Long \\n\");\n  printf(\"Minimum Value = 0\\n\");\n  printf(\"Maximum value = %lu\\n\", ULONG_MAX);\n}\n\nint factorial1(int n) {\n  int res = 1;\n  int i;\n  for (i = 1; i &lt;= n; i++)\n    res = res * i;\n  return res;\n}\n\nint factorial2(int n) {\n  int res = 1;\n  int i = 1;\n  while (i &lt;= n);{\n    res = res * i;\n    i++;\n  }\n  return res;\n}\n\nint factorial3(int n) {\n  int res = 1;\n  int i = 1;\n  do{\n    res = res * i;\n    i++;\n      }\n  while (i &lt;= n);\n  return res;\n}\n\nint factorial4(int n) {\n  if (n &gt;= 1)\n    return n*factorial4(n-1);\n  else\n    return 1;\n}\n\n\nvoid types() {\n  char a1,b1,c1,*p1,*p2,*p3;\n  short a2,b2,c2,*p4,*p5,*p6;\n  int a3,b3,c3,*p7,*p8,*p9;\n  double a4,b4,c4,*p10,*p11,*p12;\n  p1=&amp;a1;\n  p2=&amp;b1;\n  p3=&amp;c1;\n  p4=&amp;a2;\n  p5=&amp;b2;\n  p6=&amp;c2;\n  p7=&amp;a3;\n  p8=&amp;b3;\n  p9=&amp;c3;\n  p10=&amp;a4;\n  p11=&amp;b4;\n  p12=&amp;c4;\n  printf(\"\\nAddress of %p %u\\t\", p1,p1);\n  printf(\"\\nAddress of %p %u\\t\", p2,p2);\n  printf(\"\\nAddress of %p %u\\t\", p3,p3);\n  printf(\"\\nAddress of %p %u\\t\", p4,p4);\n  printf(\"\\nAddress of %p %u\\t\", p5,p5);\n  printf(\"\\nAddress of %p %u\\t\", p6,p6);\n  printf(\"\\nAddress of %p %u\\t\", p7,p7);\n  printf(\"\\nAddress of %p %u\\t\", p8,p8);\n  printf(\"\\nAddress of %p %u\\t\", p9,p9);\n  printf(\"\\nAddress of %p %u\\t\", p10,p10);\n  printf(\"\\nAddress of %p %u\\t\", p11,p11);\n  printf(\"\\nAddress of %p %u\\n\\n\\n\\n\", p12,p12);\n}\n\n\n// test code; do not modify                                                                                                     \n\nint main() {\n\n  ranges();\n\n  printf(\"factorial1(10) = %d\\n\", factorial1(10));\n  printf(\"factorial2(10) = %d\\n\", factorial2(10));\n  printf(\"factorial3(10) = %d\\n\", factorial3(10));\n  printf(\"factorial4(10) = %d\\n\", factorial4(10));\n  printf(\"\\n\");\n\n  types();\n\n  return 0;\n}\n</code></pre>\n\n<p>However, when I run the program with $ ./hw1 the output stops after the factorial1 function.  Again, I'm new to C so is this normal? Do I need to do something to see the rest of the output?  Apologize for the newbie question and tried searching but couldn't figure out if my code is wrong or it's something else.  Here's the output:</p>\n\n<pre><code>Signed Char\nMinimum Value  = -128\nMaximum Value = 127\nUnsigned Char\nMinimum Value = 0\nMaximum Value = 255\nSigned Short \nMinimum value = -32768\nMaximum value = 32767\nUnsigned Short \nMinimum Value = 0\nMaximum value = 65535\nSigned Integer \nMinimum value = -2147483648\nMaximum value = 2147483647\nUnsigned Integer \nMinimum Value = 0\nMaximum value = 4294967295d\nSigned Long \nMinimum value = -9223372036854775808\nMaximum value = 9223372036854775807\nUnsigned Long \nMinimum Value = 0\nMaximum value = 18446744073709551615\nfactorial1(10) = 3628800\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10357700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4984264e42346b8506ed25196d019e?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/10357700/todd"}, "is_accepted": false, "score": 0, "last_activity_date": 1537324271, "last_edit_date": 1537324271, "creation_date": 1537323115, "answer_id": 52397042, "question_id": 52396522, "link": "https://stackoverflow.com/questions/52396522/adding-values-after-the-last-element-in-two-arrays/52397042#52397042", "title": "Adding values after the last element in two arrays", "body": "<p>You use <code>j</code>, <code>n</code> to record how many times does the user input.\nfor example if I input : \n    1 2\n    3 4\n    5 6\n    7 8</p>\n\n<p>your <code>a</code> and <code>b</code> will be:</p>\n\n<pre><code>a[0] = 1 ; b[0] = 2\na[1] = 3 ; b[1] = 4\na[2] = 5 ; b[2] = 6\na[3] = 7 ; b[3] = 8\n</code></pre>\n\n<p>your <code>j</code> and <code>n</code> will be 4</p>\n\n<p>Since you want to add <code>1</code> and <code>0</code> to the last elements of two arrays, there is no\nneed in <code>j++</code> and <code>n++</code> there, simply use <code>a[j] = 1.0</code> and <code>b[j] = 0.0(a[4] = 1.0, b[4] = 0.0)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10382803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87543c4bb819f1b4c2346128bb531a62?s=128&d=identicon&r=PG&f=1", "display_name": "Buracku", "link": "https://stackoverflow.com/users/10382803/buracku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537324271, "creation_date": 1537318838, "question_id": 52396522, "link": "https://stackoverflow.com/questions/52396522/adding-values-after-the-last-element-in-two-arrays", "title": "Adding values after the last element in two arrays", "body": "<p>This program continuously asks for user input in pairs of doubles and stops when the user enters CTRL-D. I simply want to add the pair 1 and 0 into arrays a and b, respectively.</p>\n\n<p>I use an interger j to keep track of how many spots are currently occupied by the pairs. Then afterwards I can increment j to add the 1 0 pair, but as you can see by the output screenshot, the 1 and 0 aren't added. What am I doing incorrect?</p>\n\n<p>Note: The 1 0 pair has to be added after the user has entered CTRL-D, not while they are giving input.</p>\n\n<pre><code>int main()\n{\n    double a[20];  //Used to represent the 'a' in a + bi.\n    double b[20];  //Used to represent the 'b' in a + bi.\n    int j=0, n=0;\n    while((scanf(\"%lf %lf\", &amp;a[j], &amp;b[j]))==2){\n        j++;\n        n++;\n    }\n\n    printf(\"Before\\n\");\n    for(int k=0;k&lt;n;k++){\n        printf(\"%f %f\\n\", a[k], b[k]);\n    }\n\n    printf(\"J: %d, N: %d\\n\", j, n);\n    j++;\n    n++;\n    printf(\"J: %d, N: %d\\n\", j, n);\n\n    a[j] = 1.0;\n    b[j] = 0.0;\n\n    printf(\"After\\n\");\n    for(int k=0;k&lt;n;k++){\n        printf(\"%f %f\\n\", a[k], b[k]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fY6mb.png\" rel=\"nofollow noreferrer\">Output</a></p>\n"}, {"tags": ["c", "pointers", "while-loop"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 4, "creation_date": 1537318685, "post_id": 52396489, "comment_id": 91737707, "body": "1) Post code as text, not pictures of text 2) Don&#39;t post links to pictures 3) There&#39;s not nearly enough code shown to know what the problem is.  Please update your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 402, "user_id": 4084636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1E6K5.jpg?s=128&g=1", "display_name": "Adrian M.", "link": "https://stackoverflow.com/users/4084636/adrian-m"}, "edited": false, "score": 0, "creation_date": 1537318856, "post_id": 52396489, "comment_id": 91737738, "body": "How are you allocating or declaring memory?"}, {"owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "edited": false, "score": 0, "creation_date": 1537335693, "post_id": 52396489, "comment_id": 91741652, "body": "we&#39;ll need to see more of your code, rather than just the looping part, like, how you&#39;re allocating memory, where else you are using the allocated memory, etc. And try to post the code itself instead of pictures of code fragments, not that it makes a difference to the problem, just that it would be easier for us to copy it and reproduce the error."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1537348112, "post_id": 52396489, "comment_id": 91748109, "body": "See <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><b>How to debug small programs</b></a> and talk to the duck... Really, it helps <code>:)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2774, "user_id": 3363228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2654f48d91375a43fa07e9ea616354?s=128&d=identicon&r=PG&f=1", "display_name": "ubadub", "link": "https://stackoverflow.com/users/3363228/ubadub"}, "edited": false, "score": 0, "creation_date": 1537329815, "post_id": 52396537, "comment_id": 91739915, "body": "Almost, but not quite. The problem only occurs when <code>temp</code> is NULL to begin with. If <code>temp</code> isn&#39;t NULL initially, then <code>temp-&gt;next != NULL</code> will return false before setting <code>temp</code> equal to NULL."}], "tags": [], "owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "is_accepted": false, "score": 1, "last_activity_date": 1537331410, "last_edit_date": 1537331410, "creation_date": 1537318992, "answer_id": 52396537, "question_id": 52396489, "link": "https://stackoverflow.com/questions/52396489/c-segmentation-fault-in-while-loop-with-pointer/52396537#52396537", "title": "C - segmentation fault in while loop with pointer", "body": "<p>Here's the code:</p>\n\n<pre><code>while (temp-&gt;next != NULL)\n{\n    temp = temp-&gt;next;\n}\n</code></pre>\n\n<p>So - what happens when <code>temp</code> starts as, or becomes NULL?  Say at the end of the linked list.</p>\n\n<p>The answer - your while loop condition is checking <code>NULL-&gt;next</code>, which is a memory violation, because your program (probably) doesn't own the memory at, say address 0x00000008 (NULL is zero, and <code>-&gt;</code> creates a memory offset when it's compiled).</p>\n\n<p>How about:</p>\n\n<pre><code>while (temp != NULL)\n{\n    temp = temp-&gt;next;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8174978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2db070313a96cbe6b40008f3eaea0a0?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/8174978/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1537338955, "creation_date": 1537318579, "last_edit_date": 1537338955, "question_id": 52396489, "link": "https://stackoverflow.com/questions/52396489/c-segmentation-fault-in-while-loop-with-pointer", "title": "C - segmentation fault in while loop with pointer", "body": "<p>I am getting segmentation fault in my while loop but I don't know why.</p>\n\n<p><img src=\"https://i.stack.imgur.com/sodIS.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c", "openssl"], "comments": [{"owner": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 0, "creation_date": 1537318974, "post_id": 52395978, "comment_id": 91737759, "body": "Hi and welcome to StackOverflow! What have you already tried? What concrete problems have you encountered? Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 80, "user_id": 2193211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b4922ce5d88980dd96119e63a73aa?s=128&d=identicon&r=PG", "display_name": "davidovv", "link": "https://stackoverflow.com/users/2193211/davidovv"}, "edited": false, "score": 0, "creation_date": 1604477367, "post_id": 52396569, "comment_id": 114356128, "body": "How to extract it in EVP_PKEY* without saving it to file?"}], "tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1537319361, "creation_date": 1537319361, "answer_id": 52396569, "question_id": 52395978, "link": "https://stackoverflow.com/questions/52395978/how-to-extract-public-key-from-private-key-using-openssl-in-c/52396569#52396569", "title": "How to extract public key from private key using openssl in C", "body": "<p>First, read the key:</p>\n\n<pre><code>EVP_PKEY *key;\nFILE *fpkey;\nOpenSSL_add_all_algorithms();\nkey = EVP_PKEY_new();\nfpkey = fopen (\"key.pem\", \"r\");\nPEM_read_PrivateKey(fpkey, &amp;key, NULL, NULL);\nfclose(fpkey);\n</code></pre>\n\n<p>Now that you have the <code>EVP_PKEY</code> structure, you can save the public key:</p>\n\n<pre><code>FILE* fppubkey = fopen(\"pubkey.pem\", \"wb\");\nPEM_write_PUBKEY(fppubkey, key);\nfclose(fppubkey);\n</code></pre>\n\n<p>Make sure to add error checking.</p>\n"}], "owner": {"reputation": 1, "user_id": 7602240, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IIHl77S6gyI/AAAAAAAAAAI/AAAAAAAAABQ/I8PUimUB4Ds/photo.jpg?sz=128", "display_name": "\u9648\u5929\u7ffc", "link": "https://stackoverflow.com/users/7602240/%e9%99%88%e5%a4%a9%e7%bf%bc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537319361, "creation_date": 1537314164, "question_id": 52395978, "link": "https://stackoverflow.com/questions/52395978/how-to-extract-public-key-from-private-key-using-openssl-in-c", "title": "How to extract public key from private key using openssl in C", "body": "<p>I know in command line that given a pem file of private key, you can extract the public key from it.</p>\n\n<p>Wondering how the similar function can be achieved using openssl's C library?</p>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1537313539, "post_id": 52395787, "comment_id": 91736756, "body": "<code>x should be 20 and y should be 30</code> is the correct way to phrase your goal.  The order <i>implies</i> which one should be changed to match the other one.  Obviously your meaning is clear here, but &quot;y should be x&quot; could cause you problems if you intend <code>x = y;</code>.  I hope that is helpful.  That&#39;s the genuine goal :)"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1537314252, "post_id": 52395787, "comment_id": 91736891, "body": "There are a few other problems here too: the first two if statements can be combined into if (argc != 3); int is signed so no need for &#39;signed int&#39;; your while loop is going to run many, many times (millions) before it completes."}], "owner": {"reputation": 21, "user_id": 10019115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b28722d9b980eed770945d23714cbca?s=128&d=identicon&r=PG&f=1", "display_name": "komoriuta", "link": "https://stackoverflow.com/users/10019115/komoriuta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1537313840, "answer_count": 0, "score": 0, "last_activity_date": 1537312697, "creation_date": 1537312460, "last_edit_date": 1537312697, "question_id": 52395787, "link": "https://stackoverflow.com/questions/52395787/how-do-i-make-command-arguments-adhere-to-the-variables-in-my-code", "closed_reason": "Duplicate", "title": "How do I make command arguments adhere to the variables in my code?", "body": "<p>I am writing a program to take in two arguments from the command line and calculate a function. Here is my code:</p>\n\n<pre><code>int main(int argc, char *argv[]){\n\n    if(argc &gt; 3){\n            printf(\"error\\n\");\n            return 1;\n    }\n    if(argc &lt; 3){\n            printf(\"error\\n\");\n            return 1;\n    }\n\n    signed int x, y;\n\n    while (x != y){\n            if (x &lt; y){\n                    x = x-y;\n            }\n            else if (y &lt; x){\n                    y = y-x;\n            }\n    }\n    return x;\n}\n</code></pre>\n\n<p>When I type, for example, \"./foo 20 30,\" how do I let my program know that 20 should be x, and 30 should be y? Thank you.</p>\n"}, {"tags": ["c", "file-io", "scanf"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1537311510, "post_id": 52395642, "comment_id": 91736325, "body": "scanf should returns the number of input items successfully matched and assigned, in your case it&#39;s 4, not 0, not 1 and EOF on error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10382668"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537311980, "post_id": 52395642, "comment_id": 91736431, "body": "Thanks @KamilCuk, that is helpful. Is there a way to identify the specific input item that the error occurred on? If the first input is incorrect for example, is there a way to identify that? Or is it just a single check that is available ex. <code>if (a !=4)</code>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1537312306, "post_id": 52395642, "comment_id": 91736509, "body": "Single check. If you want to identify the error, write your own parser. It takes time, but is a good training. Use <code>getline</code> from posix to read a line, then check for all <code>(</code>, <code>)</code> tokens, then call <code>strtol</code> on each integer with checking for errors, out of range errors and others. The <code>scanf</code> name implies it&#39;s usage, it&#39;s for <code>scan formatted [input]</code>. It assumes the input is already properly formatted and is used primary when you now the input is valid."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537316151, "post_id": 52395642, "comment_id": 91737237, "body": "You need to pass pointers to integers for <code>a1</code>, <code>b1</code> and <code>c1</code> \u2014 you don&#39;t show how they&#39;re defined, but it is probably not as <code>int a_value; int *a1 = &amp;a_value;</code> or anything similar.  The <code>arr</code> argument needs to be at least 5 characters long.  As noted, using <code>fgets()</code> or POSIX <code>getline()</code> to read the line and then <code>sscanf()</code> to parse the line is usually a good way to do things \u2014 you have the complete line of input to use in error reporting, whereas using <code>scanf()</code> or <code>fscanf()</code> directly chews up the line and leaves only the dregs for you to use in the error reporting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10382668"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537331047, "post_id": 52395642, "comment_id": 91740233, "body": "Thanks all, @KamilCuk or anyone else, I am trying to use the <code>if(a!=4)</code> to check if <code>scanf()</code> input is correct or not, but it does not seem to be working accurately. Should I be checking for more values because of the <code>%[^(]</code> portion of the code that is putting an array?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1537331900, "post_id": 52395642, "comment_id": 91740468, "body": "Just checking the value of <code>a</code> will not help in your case. As others have pointed out you need to parse the whole input to see where the format mismatch has occurred."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10382668"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1537332419, "post_id": 52395642, "comment_id": 91740603, "body": "Thanks @P.W, I think for simplicity purposes, I will just generalize if scanf() is correct or not by evaluating the whole number of input items. However, I am still unsure if the <code>%[^(]</code> is treated as a single input by scanf, or if it equivalent to the array size that is filled?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1537332879, "post_id": 52395642, "comment_id": 91740731, "body": "It matches a string of all characters not equal to the <code>(</code> and stores it in <code>arr</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1537347996, "post_id": 52395642, "comment_id": 91748038, "body": "When you include <code>(..)</code> in your <i>format-string</i>, all parenthesis must be present or a <i>matching failure</i> will occur. See <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">scanf(3) - Linux manual page</a> under the <b>Return</b> section and pay attention to what <code>scanf</code> will return if an <i>input failure</i> or <i>matching failure</i> or <code>EOF</code> is encountered, and by negative-implication what the return will be on a successful conversion of all values."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1537342174, "creation_date": 1537342174, "answer_id": 52400447, "question_id": 52395642, "link": "https://stackoverflow.com/questions/52395642/how-to-check-scanf-input-that-is-not-identifiable-by/52400447#52400447", "title": "How to check scanf input that is not identifiable by %", "body": "<p>My parser below. I use gnu extensions, <a href=\"http://man7.org/linux/man-pages/man3/fmemopen.3.html\" rel=\"nofollow noreferrer\">fmemopen</a> to open an example input in memory and <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline</a>, to read a whole line (and strerror_r).<br>\nI then parse the whole line, return negative value on error, handling all errors <a href=\"http://man7.org/linux/man-pages/man3/strtol.3.html\" rel=\"nofollow noreferrer\">strtol</a> can set, handling out of range error, wrong tokens '(' and ')', too long line, etc.  </p>\n\n<pre><code>#define _GNU_SOURCE 1\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;errno.h&gt;\n\n/**\n * if expression 'expr' is true, then:\n * print error message including custom message on a single line\n * including errno and strerror\n * then return the value \"ret\".\n */\n#define RET_ON_ERR(expr, ret, msg, ...)  do{ \\\n    if(expr) { \\\n        const int  _errno_sav = errno; \\\n        fprintf(stderr, \\\n            \"%s:%d: %s(): error: expresssion '%s' failed: \", \\\n            __FILE__, __LINE__, __func__, #expr); \\\n        if (_errno_sav) { \\\n            char buf[22]; \\\n            fprintf(stderr, \"errno: %d '%s' \", \\\n                _errno_sav, strerror_r(_errno_sav, buf, sizeof(buf))); \\\n            errno = 0; \\\n        } \\\n        fprintf(stderr, \"\" msg \"\\n\", ##__VA_ARGS__); \\\n        return (ret); \\\n    } \\\n}while(0)\n\n/**\n * Same as RET_ON_ERR but the value -__LINE__ is returned\n */\n#define RET_LINE_ON_ERR(expr, msg, ...)  RET_ON_ERR((expr), -__LINE__, msg, ##__VA_ARGS__)\n\n/**\n * Returns the array size of a statically allocated array\n */\n#define ARRAY_SIZE(arr)  (sizeof(arr)/sizeof(arr[0]))\n\n/**\n * Returns -1 and prints error message on conversion failure\n * @param val0 outputted value\n * @param ptr input string\n * @param endptr0 outputted end pointer\n * @param min minimum value to be returned\n * @param max maximum value to be returned\n * On error negative line number is returned and outputted variables are not set.\n */\nint strtol_safe(long *val0, const char ptr[], const char *endptr0[], long min, long max)\n{\n    assert(val0 != NULL);\n    assert(ptr != NULL);\n\n    RET_LINE_ON_ERR(!isdigit(ptr[0]), \"string does not start with numbers '%s'\", ptr);\n\n    // probably writing my own loop would be faster....\n    char *endptr = NULL;\n    errno = 0;\n    const long val = strtol(ptr, &amp;endptr, 10);\n    RET_LINE_ON_ERR(errno == ERANGE &amp;&amp; (val == LONG_MAX || val == LONG_MIN), \"conversion out of range\");\n    RET_LINE_ON_ERR(errno != 0, \"internal error\");\n    RET_LINE_ON_ERR(endptr == ptr, \"no digits were found\");\n\n    RET_LINE_ON_ERR(!(min &lt;= val &amp;&amp; val &lt;= max), \"%ld out of range (%ld,%ld)\", val, min, max);\n\n    *val0 = val;\n    if (endptr0 != NULL) {\n        *endptr0 = endptr;\n    }\n\n    return 0;\n}\n\n/**\n * Represents out data!\n */\nstruct data_s {\n    int a1;\n    char arr[20];\n    int b1;\n    int c1;\n};\n\n/**\n * Fill single data variable parsing 'line'\n * On error prints errorr message and returns negative value of the line where the error was found.\n */\nint data_readline(struct data_s *data, const char line[])\n{\n    assert(data != NULL);\n    assert(line != NULL);\n    int tmp;\n    long ltmp;\n\n    RET_LINE_ON_ERR(line++[0] != '(', \"line '%s' first ( not found\", line);\n\n    tmp = strtol_safe(&amp;ltmp, line, &amp;line, INT_MIN, INT_MAX);\n    RET_ON_ERR(tmp, tmp, \"error on reading first number\");\n    data-&gt;a1 = ltmp;\n\n    RET_LINE_ON_ERR(line++[0] != ')', \"line '%s' first ) was not fond\", line);\n\n    // read the second field consisting of only numbers until '(' is found\n    for (char *out = data-&gt;arr; line[0] != '('; ++line, ++out) {\n        RET_LINE_ON_ERR(!isdigit(line[0]), \n            \"the second token must consist of numbers only\");\n        RET_LINE_ON_ERR(out - data-&gt;arr &gt;= ARRAY_SIZE(data-&gt;arr),\n            \"array overflow when reading the second field from line '%s'\", line);\n        *out = line[0];\n    }\n\n    RET_LINE_ON_ERR(line++[0] != '(', \"line '%s' second ( not found\", line);\n\n    tmp = strtol_safe(&amp;ltmp, line, &amp;line, INT_MIN, INT_MAX);\n    RET_ON_ERR(tmp, tmp, \"error on reading first number\");\n    data-&gt;b1 = ltmp;\n\n    RET_LINE_ON_ERR(line++[0] != ')', \"line '%s' second ) not found\", line);\n\n    RET_LINE_ON_ERR(line++[0] != '(', \"line '%s' third ( not found\", line);\n\n    tmp = strtol_safe(&amp;ltmp, line, &amp;line, INT_MIN, INT_MAX);\n    RET_ON_ERR(tmp, tmp, \"error on reading first number\");\n    data-&gt;c1 = ltmp;\n\n    RET_LINE_ON_ERR(line++[0] != ')', \"line '%s' third ) not found\", line);\n\n    RET_LINE_ON_ERR(line[0] != '\\n' &amp;&amp; line[0] != '\\0', \n        \"line '%s' does not end after reading tokens\", line);\n\n    return 0;\n}\n\n\nint main()\n{\n    // create FILE object reading from custom buffer, just for testing\n    char buf[] = \"(4)1234(1)(1234)\";\n    FILE * const f = fmemopen(buf, ARRAY_SIZE(buf), \"r\");\n    RET_LINE_ON_ERR(f == NULL, \"error fmemopen\");\n\n    // read one line of input.\n    char *line = NULL;\n    size_t n = 0;\n    RET_LINE_ON_ERR(getline(&amp;line, &amp;n, f) &lt; 0, \"getline error\");\n\n    // read data structure\n    struct data_s data = {0};\n    int ret;\n    ret = data_readline(&amp;data, line);\n    if (ret &lt; 0) {\n        fprintf(stderr, \"error from data_readline: %d\\n\", ret);\n        exit(-1);\n    }\n\n    // print output\n    printf(\"readed first line consist of:\\n\"\n            \"a1=%d arr='%s' b1=%d c1=%d\\n\"\n            , \n            data.a1, data.arr, data.b1, data.c1\n    );\n\n    close(f);\n    return 0;\n}\n</code></pre>\n\n<p>live version available on <a href=\"https://onlinegdb.com/Sk0R9OkFX\" rel=\"nofollow noreferrer\">onlinegdb</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10382668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52400447, "answer_count": 1, "score": 0, "last_activity_date": 1537342174, "creation_date": 1537311204, "last_edit_date": 1537312186, "question_id": 52395642, "link": "https://stackoverflow.com/questions/52395642/how-to-check-scanf-input-that-is-not-identifiable-by", "title": "How to check scanf input that is not identifiable by %", "body": "<p>I have the following line of code that reads in input from a text file:</p>\n\n<pre><code>a = scanf(\"(%d)%[^(](%d)(%d)\", a1, arr, b1, c1);\n</code></pre>\n\n<p>A normal line of input from this file would be:\n(4)1234(1)(1234)</p>\n\n<p>Is there a way with <code>scanf()</code> to identify a specific input item that does not match the template format that is sent, aside from checking the <code>%d</code>? (missing a parenthesis in beginning, etc.) Ex. <code>4)1234(5)(1234)</code></p>\n\n<p>Based on my research, it seems like this may be difficult to do with <code>scanf()</code>, maybe even impossible since <code>scanf()</code> returns <code>4</code> (for this case), but I would like to see if there is a workaround that can be performed.</p>\n"}, {"tags": ["c", "hashtable"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1537310725, "post_id": 52395423, "comment_id": 91736139, "body": "Printing the <code>char*key</code> as a integer may not do what you want.  May want to print that as a <code>%s</code> string or as a <code>%p</code> pointer."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1537310874, "post_id": 52395423, "comment_id": 91736178, "body": "Also, from a speed point of view, reading in individual chars is slow.  Consider reading them in as a more CPU word sized entity to speed up the memory I/O."}, {"owner": {"reputation": 382, "user_id": 5058753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b28a867684af1ed1128e934d09125164?s=128&d=identicon&r=PG&f=1", "display_name": "DolphinGenomePyramids", "link": "https://stackoverflow.com/users/5058753/dolphingenomepyramids"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1537315881, "post_id": 52395423, "comment_id": 91737178, "body": "It&#39;s a 100k plus line file, how to speed that up? Thanks I&#39;ll edit the main question"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1537315993, "post_id": 52395423, "comment_id": 91737204, "body": "You aren&#39;t making copies of the string, so you keep passing the same pointer to your <code>insert</code> function, and it keeps on stashing it away, but the data it points at keeps changing, so it isn&#39;t really any use.  Make sure you copy (<code>strdup()</code> perhaps) the string \u2014 and update the memory management code to handle the extra memory that needs to be freed."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1537316753, "post_id": 52395423, "comment_id": 91737346, "body": "<code>if(hashArray[hashIndex]-&gt;key == key)</code> may not be the comparison you want."}], "owner": {"reputation": 382, "user_id": 5058753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b28a867684af1ed1128e934d09125164?s=128&d=identicon&r=PG&f=1", "display_name": "DolphinGenomePyramids", "link": "https://stackoverflow.com/users/5058753/dolphingenomepyramids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 917, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537315991, "creation_date": 1537309678, "last_edit_date": 1537315991, "question_id": 52395423, "link": "https://stackoverflow.com/questions/52395423/c-hash-table-with-string-keys-all-keys-are-the-last-string-in-the-file", "title": "C Hash Table with String Keys.All keys are the last string in the file", "body": "<p>I'm trying to implement a hash table with keys of strings. I don't care about the values, so they are ints of 1. I need the speed of a hash look-up so no binary searches in arrays. My key strings are not being stored correctly, they print as expected when they are inserted, but when I display the hash table's contents, the keys are all the last entry in the file.</p>\n\n<p>Please help </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define SIZE 103141 * 2\n#define MAXCHAR 1000\n\n\nstruct DataItem {\n   int data;   \n   char* key;\n};\n\nstruct DataItem* hashArray[SIZE]; \n\n\nunsigned long \nhashCode(char *key) {\n   unsigned long hash = 5381;\n   int c;\n   while (c = *key++){\n      hash = ((hash &lt;&lt;5)+ hash)+c; \n   }\n   return hash % SIZE;\n}\n\nstruct DataItem *search(char *key) {\n   unsigned long hashIndex = hashCode(key);  \n\n   //move in array until an empty \n   while(hashArray[hashIndex] != NULL) {\n      if(hashArray[hashIndex]-&gt;key == key){ return hashArray[hashIndex]; }\n      //go to next cell\n      ++hashIndex;\n      //wrap around the table\n      hashIndex %= SIZE;\n   }        \n\n   return NULL;        \n}\n\nvoid insert(char* key,int data) {\n\n   struct DataItem *item = (struct DataItem*) malloc(sizeof(struct DataItem));\n   item-&gt;data = data;  \n   item-&gt;key = key;\n   unsigned long hashIndex = hashCode(key);\n\n   //move in array until an empty or deleted cell\n   while(hashArray[hashIndex] != NULL &amp;&amp; hashArray[hashIndex]-&gt;key != NULL) {\n      //go to next cell\n      ++hashIndex;\n      //wrap around the table\n      hashIndex %= SIZE;\n   }\n\n   // this statement below prints the keys correctly \n   printf(\"%d  %s   %d\\n\",hashIndex,item-&gt;key,item-&gt;data);\n\n   hashArray[hashIndex] = item;\n}\n\nvoid display() {\n   int i = 0;\n\n   for(i = 0; i&lt;SIZE; i++) {\n\n      if(hashArray[i] != NULL)\n         // here the keys are all \"S-4TNKZ\"\n         printf(\" (%s,%d)\\n\",hashArray[i]-&gt;key,hashArray[i]-&gt;data);\n\n     else\n         printf(\" .. \\n\");\n   }\n\n}\n\nint main() {\n   struct DataItem* item;\n\n   char *probefile = \"cychp_pruned_r2_0.1.ids.txt\";\n\n   FILE *probef; char str[MAXCHAR]; char *p; char *probe_name; \n\n   probef = fopen(probefile,\"r\");\n\n\n   while (fgets(str, MAXCHAR, probef) != NULL){\n\n      p = strtok(str,\"\\n\");\n\n      insert(p,1);\n   }\n\n\n   display();\n   // this exists in the file \n   char *probe = \"S-4TNIU\";\n\n   // if I insert it here, it works\n   //insert(probe,1);\n\n   // not found\n   item = search(probe);\n\n   if(item != NULL) {\n      printf(\"Element found:%s %d\\n\", probe,item-&gt;data);\n   } else {\n      printf(\"Element not found [%s]\\n\",probe);\n   }\n\n}\n</code></pre>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1537309178, "post_id": 52395333, "comment_id": 91735733, "body": "Because <code>sizeof(anything)*CHAR_BIT = ANYTHING_BIT</code>"}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1537309297, "post_id": 52395333, "comment_id": 91735761, "body": "@EugeneSh. yea, that what I was thinking. if you want to make that an answer I&#39;ll accept it."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 4, "creation_date": 1537309301, "post_id": 52395333, "comment_id": 91735764, "body": "Only <code>CHAR_BIT</code> is standard. Vendor-specific <code>LONG_BIT</code> and <code>WORD_BIT</code> either have slightly different meanings, or are nonsense."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1537309377, "post_id": 52395333, "comment_id": 91735785, "body": "There is no mentioning about <code>LONG_BIT</code> or <code>WORD_BIT</code> in C standard."}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1537309454, "post_id": 52395333, "comment_id": 91735806, "body": "@EugeneSh. it&#39;s in POSIX."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1537309850, "post_id": 52395333, "comment_id": 91735919, "body": "&quot;Why doesn&#39;t it define an INT_BIT?&quot; --&gt; perhaps the question should be why is the &quot;Number of bits in an object of type int.&quot; defined as <code>WORD_BIT</code>  and not <code>INT_BIT</code> ?"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1537309896, "post_id": 52395333, "comment_id": 91735930, "body": "I googled and found (<a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/limits.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/7908799/xsh/limits.h.html</a>). Quote: &quot;{LONG_BIT} Number of bits in a long. Minimum Acceptable Value: 32&quot;. That doesn&#39;t seem compatible with a notion of slightly useful <code>LONG_BIT</code> as the number of value representation bits, the <i>width</i>."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1537310299, "post_id": 52395333, "comment_id": 91736024, "body": "@Cheersandhth.-Alf: That&#39;s from SUS, which imposes the additional requirement that there are no bits <i>other</i> than value representation bits."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1541871333, "post_id": 52395333, "comment_id": 93368797, "body": "Just out of curiousity, do you have an intended uses case for this?"}], "answers": [{"comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1537313776, "post_id": 52395760, "comment_id": 91736816, "body": "Except it does not work with conditional compilation."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1537314036, "post_id": 52395760, "comment_id": 91736855, "body": "@Ivan can you provide an example where you can&#39;t create a macro you need from standard C? It does not change the answer since that is the rationale provided and that won&#39;t change but I don&#39;t see it."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1537333434, "post_id": 52395760, "comment_id": 91740894, "body": "Preprocessor cannot evaluate <code>sizeof</code> operator. <code>#if CHAR_BIT*sizeof(type)</code> won&#39;t be able to go through preprocessor stage."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1537341173, "post_id": 52395760, "comment_id": 91744227, "body": "@Ivan so why not just <code>#define BLAH CHAR_BIT*sizeof(type)</code> then and use that?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1537346792, "post_id": 52395760, "comment_id": 91747319, "body": "My point is that this cannot be used with conditional compilation, for example when there is a need to select some datatype at compile time."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1541860719, "post_id": 52395760, "comment_id": 93365836, "body": "Except in the very theoretical scenario when <code>type</code> has padding bits."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 4, "last_activity_date": 1537313444, "last_edit_date": 1537313444, "creation_date": 1537312251, "answer_id": 52395760, "question_id": 52395333, "link": "https://stackoverflow.com/questions/52395333/why-isnt-there-an-int-bit/52395760#52395760", "title": "Why isn&#39;t there an INT_BIT?", "body": "<p>It looks like <code>WORD_BIT</code> is what you want to be <code>INT_BIT</code>, from the document you link to:</p>\n\n<blockquote>\n  <p><code>{WORD_BIT}</code> Number of bits in an object of <strong>type <code>int</code>.</strong></p>\n</blockquote>\n\n<p>Note that <code>CX</code> means this is an extension to standard C. </p>\n\n<p>The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf\" rel=\"nofollow noreferrer\">C99 rationale document</a> tells us the committee saw little reason for anything besides <code>CHAR_BIT</code>:</p>\n\n<blockquote>\n  <p>The macro <code>CHAR_BIT</code> makes available the number of bits in a char object. The C89 <strong>Committee saw little utility in adding such macros for other data types</strong>.</p>\n</blockquote>\n\n<p>likely because <code>CHAR_BIT*sizeof(type)</code> does what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1543170059, "last_edit_date": 1543170059, "creation_date": 1541865352, "answer_id": 53240679, "question_id": 52395333, "link": "https://stackoverflow.com/questions/52395333/why-isnt-there-an-int-bit/53240679#53240679", "title": "Why isn&#39;t there an INT_BIT?", "body": "<p>You can generate them at build time by counting the bits in the corresponding unsigned maximum.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint popcnt(unsigned long long X) { int pc=0;for(;(X&amp;1);pc++,X&gt;&gt;=1){;} return pc; }\nint main()\n{\n    if(0&gt;printf(\"#define CHAR_BIT %d\\n\", popcnt(UCHAR_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define UCHAR_BIT %d\\n\", popcnt(UCHAR_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define SCHAR_BIT %d\\n\", popcnt(UCHAR_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define SHRT_BIT %d\\n\", popcnt(USHRT_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define USHRT_BIT %d\\n\", popcnt(USHRT_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define INT_BIT %d\\n\", popcnt(UINT_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define UINT_BIT %d\\n\", popcnt(UINT_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define LONG_BIT %d\\n\", popcnt(ULONG_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define ULONG_BIT %d\\n\", popcnt(ULONG_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define LLONG_BIT %d\\n\", popcnt(ULLONG_MAX))) return EXIT_FAILURE;\n    if(0&gt;printf(\"#define ULLONG_BIT %d\\n\", popcnt(ULLONG_MAX))) return EXIT_FAILURE;\n    if(0&gt;fclose(stdout)) return EXIT_FAILURE;\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>On my platform, the above gets me:</p>\n\n<pre><code>#define CHAR_BIT 8\n#define UCHAR_BIT 8\n#define SCHAR_BIT 8\n#define SHRT_BIT 16\n#define USHRT_BIT 16\n#define INT_BIT 32\n#define UINT_BIT 32\n#define LONG_BIT 64\n#define ULONG_BIT 64\n#define LLONG_BIT 64\n#define ULLONG_BIT 64\n</code></pre>\n\n<p>(Note that these are not technically guaranteed to be <code>sizeof(the_type)*CHAR_BIT</code> as the C standard allows for padding bits in the native types.)</p>\n\n<p>If running this piece of code before before building on any platform you want to support is annoying to you, I get you.</p>\n\n<p>Using this little shell script, you can generate (once for every platform) a perfectly integer-constant-expression-preserving no-UB-invoking (hopefully) <code>popcnt</code> cpp-macro for up to N-bit integers:</p>\n\n<pre><code>#!/bin/sh -eu\ngen()\n{\n    Max=$1\n    local i=0;\n    prev='(X)'\n    #continuous popcount at compile time\n    printf '#define contpopcnt(X) %s\\n' \"(($prev&amp;1)\\\\\"\n    i=1; while [ $i -le $Max ]; do\n        #look 1 bit ahead the left shift never reaches or exceeds \n        #the width of whatever X's type might be (would be UB)\n        prev=\"(($prev&amp;2)?((X)&gt;&gt;$i):0)\"\n        printf '+(%s&amp;1)\\\\\\n' \"$prev\"\n    i=$((i+1));done\n    printf ')\\n'\n}\n\ngen 256\ncat&lt;&lt;EOF\n//#define CHAR_BIT contpopcnt(UCHAR_MAX)\n#define UCHAR_BIT contpopcnt(UCHAR_MAX)\n#define SCHAR_BIT contpopcnt(UCHAR_MAX)\n#define SHRT_BIT contpopcnt(USHRT_MAX)\n#define USHRT_BIT contpopcnt(USHRT_MAX)\n#define INT_BIT contpopcnt(UINT_MAX)\n#define UINT_BIT contpopcnt(UINT_MAX)\n#define LONG_BIT contpopcnt(ULONG_MAX)\n#define ULONG_BIT contpopcnt(ULONG_MAX)\n#define LLONG_BIT contpopcnt(ULLONG_MAX)\n#define ULLONG_BIT contpopcnt(ULLONG_MAX)\n\n//a little sanity check\n#include &lt;limits.h&gt;\n#include &lt;stdint.h&gt;\n#if CHAR_BIT!=contpopcnt(UCHAR_MAX)\n    #error \"oops\"\n#endif\nEOF\n</code></pre>\n\n<p>And the 256-bit variant of the macro is only (!) 605KB. So you don't really need those <code>*_BIT</code> macros. </p>\n\n<p>Edit:</p>\n\n<p>A much more compact way over here: <a href=\"https://stackoverflow.com/a/4589384/1084774\">https://stackoverflow.com/a/4589384/1084774</a>.</p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 1, "accepted_answer_id": 52395760, "answer_count": 2, "score": 2, "last_activity_date": 1543170059, "creation_date": 1537309101, "last_edit_date": 1537310569, "question_id": 52395333, "link": "https://stackoverflow.com/questions/52395333/why-isnt-there-an-int-bit", "title": "Why isn&#39;t there an INT_BIT?", "body": "<p>Why are there <code>_BIT</code> macros in <code>limits.h</code> for <code>CHAR_BIT</code>, <code>LONG_BIT</code>, <code>WORD_BIT</code>? Why doesn't it define an <code>INT_BIT</code>?</p>\n\n<p>Is there a reason why these macros are defined for other types, but not for <code>int</code>? Are these deprecated (out of use) with <code>sizeof</code>?</p>\n\n<p>I see these are defined by <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/limits.h.html\" rel=\"nofollow noreferrer\">POSIX for <code>limits.h</code></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1537309112, "post_id": 52395299, "comment_id": 91735717, "body": "Do you know about bitwise operators?"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1537309203, "post_id": 52395299, "comment_id": 91735741, "body": "Is <code>prt2</code> a typo? This code does a bitwise or with <code>0x80</code> and <code>prt2-&gt;indicator1</code> as operands and stores the result in <code>prt2-&gt;indicator1</code>. I&#39;m not sure how to be more concrete than that without knowing what <code>prt2-&gt;indicator1</code> is."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1537309553, "post_id": 52395299, "comment_id": 91735832, "body": "if <code>ptr1-&gt;name</code> has its 5th bit set (or &quot;bit 4&quot; from zero-based), set the 9th bit of <code>ptr2-&gt;indicator</code>.  Typically these will be &quot;flags&quot; that say something is or isn&#39;t true."}], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": true, "score": 0, "last_activity_date": 1537312405, "creation_date": 1537312405, "answer_id": 52395785, "question_id": 52395299, "link": "https://stackoverflow.com/questions/52395299/in-c-what-does-ifptr-name-0x10-mean/52395785#52395785", "title": "In C - what does if(ptr-&gt;name &amp; 0x10) mean", "body": "<blockquote>\n  <p>I'm not sure what '&amp; 0x10' is doing. Could someone kindly explain it or advise\n  me on topics to research and teach myself. Thank you.</p>\n</blockquote>\n\n<p><code>if(ptr1-&gt;name &amp; 0x10)</code></p>\n\n<p>Is taking whatever the value of <code>ptr1-&gt;name</code> is and <a href=\"https://en.wikipedia.org/wiki/Bitwise_operation#AND\" rel=\"nofollow noreferrer\">bitwise-ANDing</a> it with <code>0x10</code>.</p>\n\n<p>If you understand hex, then you know that <code>0x10</code> is 16 in decimal, and presumably you know that 16 is 2^4 which means in binary this value is <code>0b10000</code>.</p>\n\n<p>If the result of this operation is non-zero, then this tells us that the 4th bit of <code>ptr1-&gt;name</code> is set (bit numbering starts at 0, e.g 2^0 = 0x1), and will result in the execution of the line <code>prt2-&gt;indicator1  |= 0x80;</code></p>\n\n<p>Check out <a href=\"https://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B#Bitwise_operators\" rel=\"nofollow noreferrer\">bitwise operators in C</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10382569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2siO-mvJeEA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMHRou68xR5ChMYwSLVFRk8XJ_92w/mo/photo.jpg?sz=128", "display_name": "Kathy", "link": "https://stackoverflow.com/users/10382569/kathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "closed_date": 1537366611, "accepted_answer_id": 52395785, "answer_count": 1, "score": 1, "last_activity_date": 1537312405, "creation_date": 1537308905, "last_edit_date": 1537309041, "question_id": 52395299, "link": "https://stackoverflow.com/questions/52395299/in-c-what-does-ifptr-name-0x10-mean", "closed_reason": "Duplicate", "title": "In C - what does if(ptr-&gt;name &amp; 0x10) mean", "body": "<p>Newbie on C language. I understand pointers and hex format but I'm not sure what '&amp; 0x10'  is doing. Could someone kindly explain it or advise me on topics to research and teach myself. Thank you.</p>\n\n<pre><code>if(ptr1-&gt;name &amp; 0x10)\n{\n     prt2-&gt;indicator1  |= 0x80;      \n}  \n</code></pre>\n"}, {"tags": ["c", "windows", "math", "codeblocks", "bernoulli-numbers"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1537308106, "post_id": 52395092, "comment_id": 91735450, "body": "What are you actually asking about here, the compilation errors or calculation method? One question at a time please."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1537308802, "post_id": 52395092, "comment_id": 91735634, "body": "The calculation method. I fixed the compilation erros, but the answers is getting wrong. I have no idea why."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1537308893, "post_id": 52395092, "comment_id": 91735654, "body": "My principal work is Riemann Zeta function, but for negative odds numbers it&#39;s need to Bernoulli numbers. So I need this to the negative real part. The positive Real part is already done."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 1, "creation_date": 1537309607, "post_id": 52395092, "comment_id": 91735851, "body": "<a href=\"https://rosettacode.org/wiki/Bernoulli_numbers#C.2B.2B\" rel=\"nofollow noreferrer\">rosettacode.org/wiki/Bernoulli_numbers#C.2B.2B</a>"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1537312160, "post_id": 52395092, "comment_id": 91736476, "body": "&quot;but the answers is getting wrong&quot; isn&#39;t a very good problem statement. What answers do you get and what do you expect?"}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537313248, "post_id": 52395092, "comment_id": 91736697, "body": "@jwdonahue The correct numbers of Bernoulli! Did you at least read what is the numbers?"}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1537313374, "post_id": 52395092, "comment_id": 91736723, "body": "@meowgoesthedog I&#39;m having a lot of issues with this GMP library, I tried this but seems that my GMP are different. Or maybe this code was written in a old version of GMP."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1537314119, "post_id": 52395092, "comment_id": 91736866, "body": "Take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. You might get better results asking about the algorithm at the <a href=\"https://math.stackexchange.com/\">Math site</a>.  If you want to know how your code deviates from an algorithm, tell us what algorithm you are using. For me, when I read C code, I like to know what inputs you&#39;ve tried and what outputs you are getting and why they are wrong. You haven&#39;t done a very good job at explaining those things."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537316126, "post_id": 52395092, "comment_id": 91737229, "body": "@jwdonahue OMG, please. Bernoulli numbers works with even until infinite!"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 2, "creation_date": 1537316206, "post_id": 52395092, "comment_id": 91737247, "body": "Ok, so one or two input examples and the resulting erroneous outputs should be included in your post. I really do recommend that you take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 2, "creation_date": 1537316377, "post_id": 52395092, "comment_id": 91737272, "body": "I am not a mathematician, but I am a pretty damn good C coder and I&#39;ve taken a lot of crappy code written by phd&#39;s in mathematics and got it working, once they properly explained the intended algorithm and provided some input/output examples."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537316443, "post_id": 52395092, "comment_id": 91737283, "body": "@jwdonahue It&#39;s getting very wrongs results that just prove how stupid I&#39;m!"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1537316548, "post_id": 52395092, "comment_id": 91737306, "body": "LOL. Sorry, I don&#39;t think you&#39;re stupid. I think you&#39;re frustrated. Step back and review the links I provided, then if you don&#39;t like Robert&#39;s answer, <a href=\"https://stackoverflow.com/posts/52395092/edit\">edit</a> your question to help us help you."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1537317824, "post_id": 52395092, "comment_id": 91737560, "body": "I&#39;m having serious issues with GMP library on Windows. To run the @meowgoesthedog example."}, {"owner": {"reputation": 58970, "user_id": 71059, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/RRmlf.png?s=128&g=1", "display_name": "AakashM", "link": "https://stackoverflow.com/users/71059/aakashm"}, "edited": false, "score": 1, "creation_date": 1537350151, "post_id": 52395092, "comment_id": 91749359, "body": "If you just want to know the Bernoulli numbers for some other purpose, why not just look them up? <a href=\"http://oeis.org/A027641/b027641.txt\" rel=\"nofollow noreferrer\">Here are the numerators</a> and <a href=\"http://oeis.org/A027642/b027642.txt\" rel=\"nofollow noreferrer\">here are the denominators</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537316739, "post_id": 52395976, "comment_id": 91737344, "body": "While not technically the answer to the OP&#39;s question, it&#39;s strong advice. I am not sure, but I think the OP really wants to figure out how to make their code work."}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "edited": false, "score": 0, "creation_date": 1537318009, "post_id": 52395976, "comment_id": 91737597, "body": "I need just to get this Bernoulli numbers working to me get back to my principal work. Riemann Zeta&#39;s function"}, {"owner": {"reputation": 14582, "user_id": 871096, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/39b6e181c797ef3ab2119322f7cac20b?s=128&d=identicon&r=PG", "display_name": "Robert Dodier", "link": "https://stackoverflow.com/users/871096/robert-dodier"}, "reply_to_user": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "edited": false, "score": 0, "creation_date": 1537319729, "post_id": 52395976, "comment_id": 91737916, "body": "@Adrianorox Yes, I understand, that&#39;s why I&#39;m recommending that you get a package that has a built-in function for Bernoulli numbers."}, {"owner": {"reputation": 14582, "user_id": 871096, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/39b6e181c797ef3ab2119322f7cac20b?s=128&d=identicon&r=PG", "display_name": "Robert Dodier", "link": "https://stackoverflow.com/users/871096/robert-dodier"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537319939, "post_id": 52395976, "comment_id": 91737956, "body": "@jwdonahue I honestly don&#39;t think the code can be fixed. The Bernoulli numbers grow in magnitude, and B[260] is already too big to even be represented by a double float (ignoring any other problems)."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537322244, "post_id": 52395976, "comment_id": 91738433, "body": "Ah, nice catch. I was waiting for input/output examples before I bothered looking at the code."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1537322935, "post_id": 52395976, "comment_id": 91738597, "body": "So this is one of those problems that requires infinite precision to get very far. Basically the binary equivalent of decimal notation, just add as many digits as you need?"}, {"owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "edited": false, "score": 0, "creation_date": 1537325532, "post_id": 52395976, "comment_id": 91739122, "body": "No, my algorithm is giving wrong answers, I need the right numbers with something like 18~20 digits precision. In C. I know it&#39;s easier in Perl or Python, but my entire work of Zeta&#39;s function are in C. It&#39;s too late to change the language."}], "tags": [], "owner": {"reputation": 14582, "user_id": 871096, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/39b6e181c797ef3ab2119322f7cac20b?s=128&d=identicon&r=PG", "display_name": "Robert Dodier", "link": "https://stackoverflow.com/users/871096/robert-dodier"}, "is_accepted": false, "score": 1, "last_activity_date": 1537314156, "creation_date": 1537314156, "answer_id": 52395976, "question_id": 52395092, "link": "https://stackoverflow.com/questions/52395092/best-way-to-calculate-bernoullis-nth-numbers-in-c-with-codeblocks-on-windows-10/52395976#52395976", "title": "Best way to calculate Bernoulli&#39;s nTh numbers in C with CodeBlocks on Windows 10 Pro", "body": "<p>My advice is to use a library or package to carry out this computation; it is easy to write some code for a mathematical function which handles simple cases, and very difficult and time-consuming to handle all cases correctly. Presumably the calculation of Bernoulli numbers is just something you need to make progress on your real topic of interest. If so, you're better off finding an existing library or package. (Even you are having trouble with a library, it is still far easier to solve that problem instead of having to reimplement the algorithm.)</p>\n\n<p>Sage (<a href=\"https://sagemath.org\" rel=\"nofollow noreferrer\">https://sagemath.org</a>) can calculate Bernoulli numbers, and probably has a lot of other number theory stuff. See also Maxima (<a href=\"http://maxima.sourceforge.net\" rel=\"nofollow noreferrer\">http://maxima.sourceforge.net</a>) and maybe also GAP and PARI-GP (a web search will find those).</p>\n"}], "owner": {"reputation": 111, "user_id": 5066032, "user_type": "registered", "profile_image": "https://graph.facebook.com/633244460151276/picture?type=large", "display_name": "Adriano rox", "link": "https://stackoverflow.com/users/5066032/adriano-rox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1537319108, "creation_date": 1537307536, "last_edit_date": 1537319108, "question_id": 52395092, "link": "https://stackoverflow.com/questions/52395092/best-way-to-calculate-bernoullis-nth-numbers-in-c-with-codeblocks-on-windows-10", "title": "Best way to calculate Bernoulli&#39;s nTh numbers in C with CodeBlocks on Windows 10 Pro", "body": "<p>Good night, I'm working in a project that needs to calculate the Bernoulli numbers for nTh order. I tried exhaustively a lot of algorithms on internet, mostly it's in C++ what's not usefull for me. And always I'd got compilations erros or the wrong results to the numbers! What is the fastest way to calculate it? Odd's numbers is always 0.00000 and I need to calculate for any even numbers... I just need the result of the number I put on the function, don't need to list the numbers until the nTh like every algorithm I saw on the internet does. The last I tried that had compilation erros and after fixed give me wrong answers above... Yes, for people that will ask me if I put the libraries on the code, yes, I did it! The problem is not libraries, it's wrong algorithms. I'm using <strong>C</strong> on GCC mingw 32-bits on Code::Blocks for Windows 10 Pro.</p>\n\n<pre><code>#include &lt;float.h&gt;\n#include &lt;math.h&gt;\n\nvoid bernoulli_B( int iMax, double* dB )\n{\n  dB[0] = 1.0;\n  dB[1] = -0.5;\n\n\n  for( int j = 3; j &lt;= iMax; j += 2 )\n    dB[j] = 0.0;\n\n  const double eps = DBL_EPSILON;  \n  const double TwoPi = 6.2831853071795860;\n  double dCoeff = 2.0 / (TwoPi * TwoPi);\n  double d2 = 2.0;\n\n\n  for( int n = 1; n &lt;= iMax/2; n++ )\n  {\n    double   g1 = 1.0,     \n    g2 = 1.0;\n\n    for( int j = 0; j &lt; n; j++ )\n    {\n      g1 *= 4.0;    \n      g2 *= 9.0;                    \n    }\n\n    double   S1 = 1.0 - 1.0/g1,         \n    S2 = S1 + 1.0/g2,  S3;\n\n    double   T1 = S1 + 1.0/(g2 + g1),   \n    T2;\n\n    long r = 4;\n    double s = -1.0;      \n    int nSuccess = 0;\n\n    while( !nSuccess )\n    {\n\n      double r2 = double(r*r);\n      double g3 = 1.0;\n\n      for( int j = 0; j &lt; n; j++ )\n        g3 *= r2;\n\n\n      S3 = S2 + s/g3;\n      T2 = S2 + s/(g3 + g2);\n\n      if( fabs(T2-T1) &gt; eps*fabs(T2) ) \n      {\n        g2 = g3;\n        S2 = S3;\n        T1 = T2;\n        s = -s;\n        r++;\n      }\n      else       \n      {\n        nSuccess = 1;\n      }\n    }\n    d2 /= 4.0;  \n    dB[2*n] = 2.0 * dCoeff / (1.0-d2) * T2;\n    dCoeff *= -double((2*n+1)*(2*n+2)) / (TwoPi * TwoPi);\n  }\n}\n</code></pre>\n\n<p>I've never worked with this type of stuff before, but on the series I'am working requires the Bernoulli numbers. So I don't have many sure what I'm doing to find those numbers. It's not my area. <strong>Probably I made some stupid thing here</strong>. </p>\n\n<p>I'll tell you how I fall in this problem of Bernoulli, I'm originally working on Riemann Zeta's function. I made the C code but it only worked for >1, So I started to study how to calculate for Negative odd's, and I saw that Bn(Bernoulli numbers of N order) are in the formulae! I don't know how to calculate Bernoulli Numbers, and when I started to code Zeta's function I didn't know nothing about Bernoulli! </p>\n"}, {"tags": ["c++", "c", "variadic"], "answers": [{"tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 1, "last_activity_date": 1537318381, "creation_date": 1537318381, "answer_id": 52396465, "question_id": 52395049, "link": "https://stackoverflow.com/questions/52395049/how-to-call-c-functions-with-variable-number-of-arguments-from-c-code/52396465#52396465", "title": "How to call C++ functions with variable number of arguments from C code", "body": "<p>problem of call <em>c++</em> functions from <em>c</em> that it used different decoration. </p>\n\n<p>all next for <em>cl.exe (msvc) + link.exe</em> toolset, but think other compiler/linkers have analog features</p>\n\n<p>for example when you compile in <em>c++</em> function </p>\n\n<p><code>void consoleDebug(char* format, ...)</code></p>\n\n<p>in <em>obj</em> (or static <em>lib</em>) file will be <code>?consoleDebug@@YAXPEADZZ</code> symbol.\nbut when you use the same function from <em>c</em> unit - in object file will <code>_consoleDebug</code> (for <em>x86</em>) or <code>consoleDebug</code> (other platforms)</p>\n\n<p>if we declare in <em>c</em> file</p>\n\n<p><code>void consoleDebug(char* format, ...)</code></p>\n\n<p>and do call - in <em>obj</em> will be stored that external symbol <code>consoleDebug</code> (or <code>_consoleDebug</code>) used. when linker will be build code - it will search - where is <code>[_]consoleDebug</code> actually defined (in all <em>obj</em> and <em>lib</em> passed to him) and founf nothing - no such symbol. as result we got error <em>unresolved external symbol <code>[_]consoleDebug</code></em></p>\n\n<p>solution here in undocumented linker option <strong><code>/alternatename</code></strong> :</p>\n\n<pre><code>/alternatename:sym1=sym2\n</code></pre>\n\n<p>with this we say to linker (<em>link.exe</em>)  if he need <code>sym1</code> symbol and can not found it - try use <code>sym2</code> instead. with this we can create next solution:</p>\n\n<p>1 - we need know exactly symbol name in <em>c++</em> - we can get it with <a href=\"https://docs.microsoft.com/en-us/cpp/preprocessor/predefined-macros?view=vs-2017\" rel=\"nofollow noreferrer\"><code>__FUNCDNAME__</code></a> macro:</p>\n\n<p>for example:</p>\n\n<pre><code>#define _GET_NAMES_\n\n#ifdef _GET_NAMES_\n\nvoid consoleDebug(char* format, ...)\n{   \n#pragma message(__FUNCSIG__ \";\\r\\n\")\n#pragma message(\"__pragma(comment(linker, \\\"/alternatename:\" __FUNCTION__ \"=\" __FUNCDNAME__ \"\\\"))\")\n}\n\n#endif // _GET_NAMES_\n</code></pre>\n\n<p>this is temporary, fake code, need only for print <code>__FUNCDNAME__</code></p>\n\n<p>then in <em>c</em> file we declare</p>\n\n<pre><code>void __cdecl consoleDebug(char *,...);\n\n#ifdef _X86_\n__pragma(comment(linker, \"/alternatename:_consoleDebug=?consoleDebug@@YAXPADZZ\"))\n#else\n__pragma(comment(linker, \"/alternatename:consoleDebug=?consoleDebug@@YAXPEADZZ\"))\n#endif\n</code></pre>\n\n<p>and can free use <code>consoleDebug</code></p>\n\n<p>in case we have multiple functions in <em>c++</em> with same short name, say</p>\n\n<pre><code>void consoleDebug(char* format, ...);\nvoid consoleDebug(wchar_t* format, ...);\n</code></pre>\n\n<p>this is also easy work, need only bit different name this 2 api in <em>c</em> code:</p>\n\n<pre><code>void __cdecl consoleDebugA(char *,...);\n\n#ifdef _X86_\n__pragma(comment(linker, \"/alternatename:_consoleDebugA=?consoleDebug@@YAXPADZZ\"))\n#else\n__pragma(comment(linker, \"/alternatename:consoleDebugA=?consoleDebug@@YAXPEADZZ\"))\n#endif\n\n\nvoid __cdecl consoleDebugW(wchar_t *,...);\n\n#ifdef _X86_\n__pragma(comment(linker, \"/alternatename:_consoleDebugW=?consoleDebug@@YAXPA_WZZ\"))\n#else\n__pragma(comment(linker, \"/alternatename:consoleDebugW=?consoleDebug@@YAXPEA_WZZ\"))\n#endif\n</code></pre>\n\n<p>after this we can simply call like</p>\n\n<pre><code>consoleDebugA(\"str %u\\n\", 1);\nconsoleDebugW(L\"str %u\\n\", 2);\n</code></pre>\n\n<p>from <em>c</em> code.</p>\n\n<p>no any shim/wrapper code need with this. in case you use not <em>cl/link</em> but other tool-chain and can not found analog of <code>/alternatename</code> name option - possible use <em>asm</em>  file for create single <code>jmp</code> shim. say for <em>x64</em></p>\n\n<pre><code>extern ?consoleDebug@@YAXPEADZZ:proc\nextern ?consoleDebug@@YAXPEA_WZZ:proc\n\n_TEXT segment 'CODE'\n\nconsoleDebugA proc \n    jmp ?consoleDebug@@YAXPEADZZ\nconsoleDebugA endp\n\nconsoleDebugW proc\n    jmp ?consoleDebug@@YAXPEA_WZZ\nconsoleDebugW endp\n_TEXT ENDS\nEND\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537426286, "post_id": 52405863, "comment_id": 91781512, "body": "This fails to account for C++ exceptions. The behavior is undefined in case a C++ exception crosses the language boundary between C++ and C. You&#39;d have to write a C++ wrapper dealing with C++ exceptions. Doing that would make it impossible to pass the variable argument list on to the callee."}, {"owner": {"reputation": 79, "user_id": 10382530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxdsJHSc-Sc/AAAAAAAAAAI/AAAAAAAAAmA/Vy5tB7gCVYs/photo.jpg?sz=128", "display_name": "Julien Brongniart", "link": "https://stackoverflow.com/users/10382530/julien-brongniart"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537439969, "post_id": 52405863, "comment_id": 91789253, "body": "@IInspectable, agreed. In this case I got confirmation from the library developpers team that this function does not raise any exception, so I will keep this solution. Otherwise I guess I would use the suggestion from user4581301, ie &quot;Do the formatting yourself and then call consoleDebug(&quot;%s&quot;, myFormattedBuffer);&quot;"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1537441113, "post_id": 52405863, "comment_id": 91789946, "body": "I wouldn&#39;t take the developers&#39; word for this. It may be true today, but what about tomorrow? And it may not even be true today. If the function isn&#39;t allowed to have C++ exceptions escape, make them write a formal contract. In C++ you do this by using the <code>noexcept</code> specifier. As written currently, no one is checking the contract communicated to you."}], "tags": [], "owner": {"reputation": 79, "user_id": 10382530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxdsJHSc-Sc/AAAAAAAAAAI/AAAAAAAAAmA/Vy5tB7gCVYs/photo.jpg?sz=128", "display_name": "Julien Brongniart", "link": "https://stackoverflow.com/users/10382530/julien-brongniart"}, "is_accepted": false, "score": 1, "last_activity_date": 1537360049, "creation_date": 1537360049, "answer_id": 52405863, "question_id": 52395049, "link": "https://stackoverflow.com/questions/52395049/how-to-call-c-functions-with-variable-number-of-arguments-from-c-code/52405863#52405863", "title": "How to call C++ functions with variable number of arguments from C code", "body": "<p>Thanks for your help!</p>\n\n<p>I tried the suggestion from Sam Varshavchik and it works (at least in my case)! More precisely, here is what I did:</p>\n\n<pre><code>// wrapper.cpp\nextern \"C\" { void (*wrapper_consoleDebug)(char * format, ...) = consoleDebug;}\n\n// wrapper.h\nextern void (*wrapper_consoleDebug)(char * format, ...);\n\n// C file\n#include \"wrapper.h\"\n\n// in my code\nwrapper_consoleDebug(\"my logger is %s\",\"great\");\n</code></pre>\n\n<p>I did not try the other suggestions yet, but I guess they would work too.</p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 79, "user_id": 10382530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxdsJHSc-Sc/AAAAAAAAAAI/AAAAAAAAAmA/Vy5tB7gCVYs/photo.jpg?sz=128", "display_name": "Julien Brongniart", "link": "https://stackoverflow.com/users/10382530/julien-brongniart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1537365251, "creation_date": 1537307323, "last_edit_date": 1537365251, "question_id": 52395049, "link": "https://stackoverflow.com/questions/52395049/how-to-call-c-functions-with-variable-number-of-arguments-from-c-code", "title": "How to call C++ functions with variable number of arguments from C code", "body": "<p>I have to use a third-party C++ library (that I can not change) and call its API from C code.</p>\n\n<p>For most of the library APIs I use a wrapper as explained in this post:\n<a href=\"https://stackoverflow.com/questions/2744181/how-to-call-c-function-from-c\">How to call C++ function from C?</a></p>\n\n<p>But there is one API that takes a variable number of arguments.<br>\nHere is its definition (from the header file provided with the library):</p>\n\n<pre><code>void consoleDebug(char* format, ...);\n</code></pre>\n\n<p>I do not see how I can write the wrapper function for this API.<br>\nI tried this but it does not work:</p>\n\n<pre><code>extern \"C\" { \nvoid wrapper_consoleDebug(char * format, ...)\n{\n    va_list argptr;\n    va_start(argptr,format);\n    consoleDebug(format, argptr);\n    va_end(argptr);\n}\n}\n</code></pre>\n\n<p>Any idea is welcome! Thanks!</p>\n"}, {"tags": ["c", "linux", "unix", "operating-system"], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 3169603, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/518919978cd17830cb8c105193a9615a?s=128&d=identicon&r=PG&f=1", "display_name": "doubleE", "link": "https://stackoverflow.com/users/3169603/doublee"}, "edited": false, "score": 0, "creation_date": 1537308856, "post_id": 52395171, "comment_id": 91735648, "body": "Interesting...so even if the system call is blocking for some reason, it wouldn&#39;t be preempted by any thread? Wouldn&#39;t that be bad?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 795, "user_id": 3169603, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/518919978cd17830cb8c105193a9615a?s=128&d=identicon&r=PG&f=1", "display_name": "doubleE", "link": "https://stackoverflow.com/users/3169603/doublee"}, "edited": false, "score": 1, "creation_date": 1537309869, "post_id": 52395171, "comment_id": 91735923, "body": "If its blocking and a signal occurs, then it will be interrupted and return EINTR -- which may then be automatically handled by the standard library, redoing the system call.  A thread in a system call that is blocked does not use a CPU, so the OS will schedule some other thread or process on that CPU."}, {"owner": {"reputation": 795, "user_id": 3169603, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/518919978cd17830cb8c105193a9615a?s=128&d=identicon&r=PG&f=1", "display_name": "doubleE", "link": "https://stackoverflow.com/users/3169603/doublee"}, "edited": false, "score": 0, "creation_date": 1537312435, "post_id": 52395171, "comment_id": 91736531, "body": "So even OS schedules some thread, upon return, it continues where it was safely. Thanks."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1537307954, "creation_date": 1537307954, "answer_id": 52395171, "question_id": 52394961, "link": "https://stackoverflow.com/questions/52394961/nix-read-write-are-they-re-entrant/52395171#52395171", "title": "*NIX read()/write(): Are they re-entrant?", "body": "<p><code>read</code> and <code>write</code> are system calls, so from the point of view of user-space, they are \"atomic\" -- there's no way for an interrupt or thread to preempt them \"in the middle\" of execution.  Any signal will be delivered after the system call completes -- if it is an interrupting signal it may cause a \"short\" read or write (fewer bytes read or written than expected) or an <code>EINTR</code> error value, in which case the user-level program (when it resumes after the interrupt and system call) will need to deal with that.</p>\n"}], "owner": {"reputation": 795, "user_id": 3169603, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/518919978cd17830cb8c105193a9615a?s=128&d=identicon&r=PG&f=1", "display_name": "doubleE", "link": "https://stackoverflow.com/users/3169603/doublee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 52395171, "answer_count": 1, "score": 0, "last_activity_date": 1537307954, "creation_date": 1537306840, "question_id": 52394961, "link": "https://stackoverflow.com/questions/52394961/nix-read-write-are-they-re-entrant", "title": "*NIX read()/write(): Are they re-entrant?", "body": "<p>What would happen if an interrupt/thread preempts in middle of execution of  <code>read(fd,buff,size)</code> or <code>write(fd,buff,size)</code> functions and then it returns to where it was in <code>read()/write()</code>? \nCan we assume it will continue reading or writing to the file descriptor without loss of data and order?</p>\n\n<p>Assume there is no shared variables to worry about synchronization.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1537306565, "post_id": 52394904, "comment_id": 91734903, "body": "Signed integer underflow. Undefined behavior."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1537306579, "post_id": 52394904, "comment_id": 91734908, "body": "Try <code>char number=4; while(number&lt;5)  {number=number-1; printf(&quot;%d &quot; , number); }</code> for some insight."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1537306629, "post_id": 52394904, "comment_id": 91734932, "body": "Not really undefined behaviour? edit: oh, ok because <code>char</code> might not have exactly 8 bits?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1537306636, "post_id": 52394904, "comment_id": 91734936, "body": "The question will be more reasonable if you change <code>char</code> to <code>int8_t</code>. Or, you can ask about the difference between <code>char</code> and <code>int8_t</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 4, "creation_date": 1537307130, "post_id": 52394904, "comment_id": 91735121, "body": "@mkrieger1 No, because signed integer overflow is undefined."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1537307993, "post_id": 52394904, "comment_id": 91735403, "body": "For 2&#39;s complement on an 8-bit integer type, subtracting by 1 is the same as adding the binary number <code>11111111</code> (which represents -1), and the minimum integer value would be <code>10000000</code> (which represents -128). <code>char</code> is not defined to use 2&#39;s complement arithmetic, but <code>int8_t</code> is."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1537322475, "post_id": 52396404, "comment_id": 91738489, "body": "There is more to it than that. Starting from the fact the subtraction is performed after integer promotions, and up to the fact that signed integer overflow has an undefined behavior according to the standard."}], "tags": [], "owner": {"reputation": 42, "user_id": 10368485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IH40M.jpg?s=128&g=1", "display_name": "Lasidar", "link": "https://stackoverflow.com/users/10368485/lasidar"}, "is_accepted": true, "score": 1, "last_activity_date": 1537317878, "creation_date": 1537317878, "answer_id": 52396404, "question_id": 52394904, "link": "https://stackoverflow.com/questions/52394904/c-simple-program-can-you-explain-me-result/52396404#52396404", "title": "C simple program /can you explain me result?", "body": "<p>Your loop is set to iterate until number &lt; 5. What happens is the value decrements to 5, 4, 3, 2, 1, 0, -1 ... -128. When it attempts to subtract one more value, you get a wrap around to the max value the char can hold (8 bits, 127, or 0x7F). At this point, the loop condition is no longer true, so your loop exits. Therefore, your final value after the wrap around is 127.</p>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": false, "score": 0, "last_activity_date": 1537336680, "last_edit_date": 1592644375, "creation_date": 1537336680, "answer_id": 52399071, "question_id": 52394904, "link": "https://stackoverflow.com/questions/52394904/c-simple-program-can-you-explain-me-result/52399071#52399071", "title": "C simple program /can you explain me result?", "body": "<p>the condition specified in the <code>while</code> is that it should iterate as long as number is less than 5. So it starts off with decrementing, 4,3,2,1,0,-1,-2 and so on.. It goes on till -127 which is least value it can hold, then it wraps around to the the other end of the line which is 127(positive 127). the loop condition now fails, i.e, 127 is not lesser than 5 anymore. Just to observe this behavior, Give the <code>printf</code> statement within the <code>while</code>  loop, as follows:</p>\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n   char number = 4;\n   while(number&lt;5){ \n      number=number-1;\n      printf(&quot;%d||&quot; , number);\n   }\n   return 0;\n}\n</code></pre>\n<p><em><strong>here is the output:</strong></em></p>\n<blockquote>\n<p>gcc version 4.6.3</p>\n<p>3||2||1||0||-1||-2||-3||-4||-5||-6||-7||-8||-9||-10||-11||-12||-13||-14||-15||-16||-17||-18||-19||-20||-21||-22||-23||-24||-25||-26||-27||-28||-29||-30||-31||-32||-33||-34||-35||-36||-37||-38||-39||-40||-41||-42||-43||-44||-45||-46||-47||-48||-49||-50||-51||-52||-53||-54||-55||-56||-57||-58||-59||-60||-61||-62||-63||-64||-65||-66||-67||-68||-69||-70||-71||-72||-73||-74||-75||-76||-77||-78||-79||-80||-81||-82||-83||-84||-85||-86||-87||-88||-89||-90||-91||-92||-93||-94||-95||-96||-97||-98||-99||-100||-101||-102||-103||-104||-105||-106||-107||-108||-109||-110||-111||-112||-113||-114||-115||-116||-117||-118||-119||-120||-121||-122||-123||-124||-125||-126||-127||-128||127||</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 7127033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c503796cb0c515ee36f92d6344ea828?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Krbot", "link": "https://stackoverflow.com/users/7127033/mario-krbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 52396404, "answer_count": 2, "score": -1, "last_activity_date": 1537336680, "creation_date": 1537306467, "question_id": 52394904, "link": "https://stackoverflow.com/questions/52394904/c-simple-program-can-you-explain-me-result", "title": "C simple program /can you explain me result?", "body": "<p>Here is code:</p>\n\n<pre><code>char number=4;\nwhile(number&lt;5) number=number-1;\nprintf(\"%d\" , number);\n</code></pre>\n\n<p>result=127 , why ? can you explain me ? thanks</p>\n"}, {"tags": ["c", "linux", "visual-studio", "gtk", "raspberry-pi3"], "comments": [{"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537364894, "post_id": 52394667, "comment_id": 91758504, "body": "Please decide if you want to cross-compile or develop on the target. You can&#39;t do both."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537366656, "post_id": 52394667, "comment_id": 91759688, "body": "@liberforce as I commented below your answer, I did compilation on RPi just to determine that, in fact, its build configuration is invalid. <a href=\"https://blogs.msdn.microsoft.com/vcblog/2016/03/30/visual-c-for-linux-development/\" rel=\"nofollow noreferrer\">I have found here in comment of user Stefan and following</a> that they dealt with similar problem in past, but the descritpion is too enigmatic for me"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537367065, "post_id": 52394667, "comment_id": 91759971, "body": "Ok, I now understand a bit better the situation. That Linux Development plugin merely copies and builds <b>on the target</b>, doing a remote build, and not a cross-build using VC compiler. This make the whole thing overcomplicated, where pkg-config was made to just fix that problem and get the dependencies for you."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537367108, "post_id": 52394667, "comment_id": 91760006, "body": "That comment hints that you should be able to use pkg-config in the compiler and linker options, and don&#39;t have to mess with setting include dirs by hand."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537367458, "post_id": 52394667, "comment_id": 91760233, "body": "I updated my answer, now I understand a bit better what that damn plugin does."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537367945, "post_id": 52394667, "comment_id": 91760515, "body": "The old tutorial you followed doesn&#39;t apply, it&#39;s done to build on Windows for a Windows target, and you&#39;re really using Visual Studio just as an editor, as all the building is done on the Linux target, which is a completely different case. For configuration, use tutorials that assume you&#39;re building on Linux, and transpose the arguments to your VC configuration."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537368405, "post_id": 52394667, "comment_id": 91760781, "body": "@ liberforce I tried sticking randomly phrase <code>pkg-config \u2013libs gtk+-3.0</code> (with backticks, which don&#39;t show here...) into few different locations both in compiler and linker settings, but without luck, still searching for some reliable source on that. As of this old tutorial, I just deduced some analogies, and I was well aware that this is not just old but also for windows only case."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537369261, "post_id": 52394667, "comment_id": 91761338, "body": "You may replace backticks by <code>$()</code> like in <code>$(pkg-config \u2013libs gtk+-3.0)</code> (or double the backticks on stackoverflow to escape them, like this: <code>pkg-config \u2013libs gtk+-3.0</code>). Randomly doing things won&#39;t help you undestand the issue. First, you forgot one hyphen before <code>libs</code>. Long options use double hyphens: <code>--libs</code>. Second, that command gives you the command line argument to give to the linker, so search your <i>linker</i> configuration in VS and replace all configuration by this simple command. Do the same with <code>$(pkg-config \u2013cflags gtk+-3.0)</code> and the <i>compiler</i> configuration."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537371916, "post_id": 52394667, "comment_id": 91763021, "body": "@liberforce I&#39;m a little confused whether first sentence of above comment is about posting inline code in stackoverflow comments, or is it actually about putting pkg-config statement into VS settings? Putting statement with dollar sign results in immediate evaluation-something error (cannot save configuration). <a href=\"https://i.stack.imgur.com/MJzVf.jpg\" rel=\"nofollow noreferrer\">I did something like this</a>, also without backticks, in linker section - not working. Also, I have no idea where could I possibly put phrase intended for compiler."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537373393, "post_id": 52394667, "comment_id": 91763856, "body": "The <a href=\"http://www.tldp.org/LDP/abs/html/abs-guide.html#CSPARENS\" rel=\"nofollow noreferrer\"><code>$()</code></a> is a <code>bash</code> syntax that spawn a subprocess and gets its output. It&#39;s also supported by other shells. I saw in your MSDN link that the guys use the backticks, so thought that it could work too. Seems it doesn&#39;t in VS, so it&#39;s not equivalent in your case (but usually is). In that same post, someone succesfully <a href=\"https://blogs.msdn.microsoft.com/vcblog/2016/03/30/visual-c-for-linux-development/#comment-159535\" rel=\"nofollow noreferrer\">added the pkg-config command for the linker in the <b>Additional dependencies</b></a>, just below the one field tried."}, {"owner": {"reputation": 1031, "user_id": 6763393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c44926355c84effac26e3a3f1582405a?s=128&d=identicon&r=PG&f=1", "display_name": "stanthomas", "link": "https://stackoverflow.com/users/6763393/stanthomas"}, "edited": false, "score": 1, "creation_date": 1538355861, "post_id": 52394667, "comment_id": 92101890, "body": "This answer, <a href=\"https://stackoverflow.com/questions/45570103/g-cant-link-curl-lib-files/45578921#45578921\" title=\"g cant link curl lib files\">stackoverflow.com/questions/45570103/g-cant-link-curl-lib-fi&zwnj;&#8203;les/&hellip;</a> , explains how to use <code>pkg-config</code> with VSLinux . VS will not add third-party libraries to the Linux target for you, you must set them up seperately, see <a href=\"https://stackoverflow.com/questions/43552526/visual-studio-2017-c-linux-app-headers-not-copied-to-target/43577361#43577361\" title=\"visual studio 2017 c linux app headers not copied to target\">stackoverflow.com/questions/43552526/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537305951, "post_id": 52394745, "comment_id": 91734687, "body": "Yeah, I was afraid that last sentence could be unclear. I have tried all of these: #include &lt;gtk-3.0/gtk/gtk.h&gt;, &lt;gtk/gtk.h&gt;, &lt;gtk.h&gt; with different links in headers directories configuration. Also, solo include/ is apparently not good enough, as it was present before I added rest of directories and there was an avalanche of errors."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537306486, "post_id": 52394745, "comment_id": 91734871, "body": "I assume that these directories are required due to sort of &#39;hard links&#39; in headers, for example if in header there is #include &lt;gtk/gtkbuilder.h&gt; line, this file has to be searched in relation to its dependencies, otherwise it could not be found, at least in my case."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537346681, "post_id": 52394745, "comment_id": 91747260, "body": "Please use slashes and not backslashes in the includes: <a href=\"https://stackoverflow.com/a/5790259/518853\">stackoverflow.com/a/5790259/518853</a>"}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537359553, "post_id": 52394745, "comment_id": 91755136, "body": "@liberforce ok as I understand forward slashes are better because of compatibility issues, but changing to them doesn&#39;t seem to make a difference."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537364778, "post_id": 52394745, "comment_id": 91758424, "body": "@zaguoba: Yeah, my comment was for nos. It&#39;s just that it&#39;s bad practice, so shouldn&#39;t be advertised, but is not related to your problem."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 0, "last_activity_date": 1537305596, "creation_date": 1537305596, "answer_id": 52394745, "question_id": 52394667, "link": "https://stackoverflow.com/questions/52394667/gtk-h-missing-in-visual-studio-for-linux-development/52394745#52394745", "title": "gtk.h missing in Visual Studio for Linux Development", "body": "<p>With that setup, you should </p>\n\n<pre><code>#include &lt;gtk\\gtk.h&gt;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>#include &lt;gtk-3.0\\gtk\\gtk.h&gt;\n</code></pre>\n\n<p>Alternatively remove all those VC++ directories/Header files directories, and just keep one of them that ends with <code>include/</code> instead of listing up all the sub directiores.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537359213, "post_id": 52401983, "comment_id": 91754935, "body": "I have all these three lines in my code exactly like in your example, but compiler (on host OR target) still can&#39;t find gtk.h, despite it&#39;s in that very location. I also ran pkg-config command you suggested on my RPi target (<a href=\"https://pastebin.com/bSpCJb3Y\" rel=\"nofollow noreferrer\">here&#39;s result</a>) and there is way more dependencies listed than I added to VC++ additional directories; some of them are listed twice, some of them weren&#39;t copied by VS to my windows host - should I copy them manually and add to list? Is order on dependencies list important? I really know nothing about Linux and pkg-config."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537360310, "post_id": 52401983, "comment_id": 91755549, "body": "Only other thing that looks a bit odd is the entries you have in screenshot of  the include directories should normally show up enclosed in quotes `&quot;c:\\Program Files\\ ....&quot;"}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537361194, "post_id": 52401983, "comment_id": 91756072, "body": "@nos but added lines worked without quotes, that is it removed IntelliSense errors. I confirmed, that this is in fact target Raspbian configuration problem, and edited original post, could you see it?"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537364233, "post_id": 52401983, "comment_id": 91758066, "body": "AFAIK, you&#39;re cross-compiling from Windows to your RPi target, and GTK+ development files are installed on your Windows machine, so I don&#39;t see the point in  running g++ on the RPi. Either you develop on the RPi, or under Windows, but not on both."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 1, "creation_date": 1537364388, "post_id": 52401983, "comment_id": 91758171, "body": "BTW, you should <b>always</b> use <code>#include &lt;gtk&#47;gtk.h&gt;</code>. This is to make it easier to migrate to another major version of GTK+ (<code>gtk+-3.0</code> dir would become <code>gtk+-4.0</code>). Every GTK+ program does this. Instead of changing all the existing code to fix all the includes, you just change the include dir in your build configuration. So don&#39;t change that include, it makes no sense. Fix you build configuration instead."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 1, "creation_date": 1537364536, "post_id": 52401983, "comment_id": 91758263, "body": "Some <a href=\"https://people.freedesktop.org/~dbn/pkg-config-guide.html\" rel=\"nofollow noreferrer\">doc about pkg-config</a>."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537365471, "post_id": 52401983, "comment_id": 91758889, "body": "@liberforce, I attempted compilation on RPi because I tried to determine which configuration, host or target, is incorrect, and it turned out it was target&#39;s (see edited OP). Thankfully, I did not come up with headers alteration idea, as there is quite a lot of them. I deduced already, that build configuration is invalid, but how could I get it working under Visual Studio for Linux Development? (BTW +1 for this <code>&lt;gtk&#47;gtk.h&gt;</code> clarification)"}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537373698, "post_id": 52401983, "comment_id": 91764030, "body": "@liberforce I added <code>pkg-config --cflags --libs gtk+-3.0</code> (with backticks around) to Configuration Properties/C/C++/Command Line <a href=\"https://vignette.wikia.nocookie.net/walkingdead/images/d/d2/Tumblr_inline_n5j75fhP2e1qbhw0j.gif\" rel=\"nofollow noreferrer\"><b>AND.IT.COMPILED</b></a>! Could you please add this to your post, so I can mark it an answer"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 1, "creation_date": 1537373997, "post_id": 52401983, "comment_id": 91764182, "body": "It may compile, but I&#39;m not sure it&#39;s the best alternative. You should pass the <code>pkgconfig</code> calls with <code>--cflags</code> to the compiler and <code>--libs</code> to the linker. <i>Command line</i> in that context could really mean anything, and I&#39;m not sure it won&#39;t bite you later."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1537374185, "post_id": 52401983, "comment_id": 91764289, "body": "Could you please post a screenshot of that Command Line screen? Thanks. I&#39;m suprised the word &quot;compiler&quot; is absent from those settings, but maybe those MS guys are just hiding that."}, {"owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537426000, "post_id": 52401983, "comment_id": 91781374, "body": "@liberforce <a href=\"https://i.stack.imgur.com/VxAbg.jpg\" rel=\"nofollow noreferrer\">here&#39;s screenshot</a>. You were right, because it compiled with mere gtk/gtk.h included, with no other code. When I added <a href=\"https://prognotes.net/2015/06/gtk-3-c-program-using-glade-3/\" rel=\"nofollow noreferrer\">sample code from here</a>, I had to split these commands as in screenshot to get compilation and of course, it&#39;s not end of problems. I can start compiled app on RPi and it shows blank window as it should, but remote debugger from Win host can&#39;t . Also, something&#39;s wrong with signal callback (?) and closing window doesn&#39;t end process. But it&#39;s for another question."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "edited": false, "score": 0, "creation_date": 1537431614, "post_id": 52401983, "comment_id": 91784298, "body": "@zaguoba Oh right, so the <code>pkg-config</code> calls are used as additional options to the compiler and for the linker, so that looks like the right fix. I&#39;m updating my answer with your screenshot that makes it clear what the solution is. Feel free to ask an new question about your application problems."}], "tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": true, "score": 1, "last_activity_date": 1537432134, "last_edit_date": 1537432134, "creation_date": 1537347519, "answer_id": 52401983, "question_id": 52394667, "link": "https://stackoverflow.com/questions/52394667/gtk-h-missing-in-visual-studio-for-linux-development/52401983#52401983", "title": "gtk.h missing in Visual Studio for Linux Development", "body": "<p><strong>TL;DR</strong></p>\n\n<p>Use screenshot below to know where to add <code>pkg-config</code> calls in VS configuration so that it forwards it to the compiler and linker on the target.\nThanks to @zaguoba for providing these.</p>\n\n<p><strong>ORIGINAL ANSWER:</strong></p>\n\n<p>The list of directories to include is provided by <code>pkg-config</code>. For example <code>pkg-config --cflags-only-I gtk+-3.0</code> will give you the list of include directories required. Those are the ones you need to add to the directories where VC++ wil look at include files. If you add the relative path you use in the #include, to one of those paths, you are able to find the file.</p>\n\n<p>Example:</p>\n\n<p>If you add to the directories <code>C:\\Program Files\\foo\\bar\\gtk+-3.0</code></p>\n\n<p>and have in your C file:\n<code>#include &lt;gtk/gtk.h&gt;</code></p>\n\n<p>then the compiler will look for <code>C:\\Program Files\\foo\\bar\\gtk+-3.0\\gtk\\gtk.h</code>.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>This all means the 'file not found' errors are because you're really building on the target and the target has no idea what <code>C:\\Program Files\\...</code> means. Those should be paths on the target filesystem, where the compiler is called. And this is exactly what <code>pkg-config</code> provides. </p>\n\n<p>The copy of those files on the Windows machine filesystems is merely for Intellisense use, not for compiler use.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>So that's that Visual Studio 2017 Community Linux Development plugin is what need to be undestood. It's not for cross compilation from Windows to Linux, istead it merely synchronizes code to the Windows host (for Intellisense use), but <strong>builds on the target</strong>. This means that all the paths and commands are Linux paths and commands, run on the target.</p>\n\n<p>Here's the OP working configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VxAbg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VxAbg.jpg\" alt=\"Where to put pkg-config calls in Visual Studio compiler and linker configuration\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 1158734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dr4vC.jpg?s=128&g=1", "display_name": "zaguoba", "link": "https://stackoverflow.com/users/1158734/zaguoba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "accepted_answer_id": 52401983, "answer_count": 2, "score": 0, "last_activity_date": 1537432134, "creation_date": 1537305187, "last_edit_date": 1537364752, "question_id": 52394667, "link": "https://stackoverflow.com/questions/52394667/gtk-h-missing-in-visual-studio-for-linux-development", "title": "gtk.h missing in Visual Studio for Linux Development", "body": "<p>I'm currently trying to write an app for Raspberry Pi 3B under Rasbpian with aid of Linux Development plugin in Visual Studio 2017 Community. I managed to successfully deploy 'Blink' example, nobly attached by Microsoft folks, according to tutorial, and that went well. I even made some transmission over SPI thanks to wiringPi library. Then I would like to add some GUI to my app, so that one could, for example, make some transmission on click of a button on screen.</p>\n\n<p>IntelliSense hinted me, that, in fact, there is gtk-3.0 library present in toolset. It seems that libraries are being copied from target device on every connection or so and I installed gtk on my Raspberry. So I added a simple line  to this Blink example:</p>\n\n<pre><code>#include &lt;gtk-3.0/gtk/gtk.h&gt;\n</code></pre>\n\n<p>On compilation attempt, of course there was nearly 4k errors. Well, enough said, with a little hint <a href=\"http://www.tarnyko.net/en/?q=node/22\" rel=\"nofollow noreferrer\">from this old tutorial</a> and a bit of trial and error, I managed to add this set of links under Debugging/Project properties/Configuration properties/VC++ directories/Header files directories:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UoVg1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UoVg1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Everything goes in promising direction, as errors number diminished from 4k to just one:</p>\n\n<pre><code>gtk-3.0\\gtk\\gtk.h: No such file or directory\n</code></pre>\n\n<p>No matter that this file is ACTUALLY in this location:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qgwJR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qgwJR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Regardless of combination of links in configuration above and using statement composition, compiler (?) can't find this damn file. </p>\n\n<p>Please Halp</p>\n\n<h1>EDIT</h1>\n\n<p>I just confirmed, that it is indeed problem with target configuration. This is bad or good, depending on point of view. Good, because there is probably all good with VS setup. Bad, because I don't know a thing about compiling things under Linux.</p>\n\n<p>On target (Raspberry Pi 3B) all ingredients for compilation are copied by Linux Development plugin. So in Terminal I executed line:</p>\n\n<pre><code>g++ main.cpp -o Blink2onRPi\n</code></pre>\n\n<p>and got</p>\n\n<pre><code>main.cpp:4:21: fatal error: gtk/gtk.h: no such file or directory\n</code></pre>\n\n<p>Now, I altered include line in main.cpp on target RPi, to this:</p>\n\n<pre><code>#include &lt;gtk-3.0/gtk/gtk.h&gt;\n</code></pre>\n\n<p>And now its missing <code>&lt;gdk/gdk.h&gt;</code>! When this change is made on host windows device - same result, but in VS.</p>\n\n<p>As I dealt with similar problem in VS, upon setting links for IntelliSense (now apparently they're for this purpose), now probably similar dependencies have to be set somewhere on Raspbian. But where?</p>\n\n<h1>EDIT2</h1>\n\n<p>Upon execution of:</p>\n\n<pre><code>g++ main.cpp -o Blink2onRPi `pkg-config --cflags --libs gtk+-3.0`\n</code></pre>\n\n<p>on target RPi there is no more GTK-related errors, just wiringPi (also present in project) undefined references. It raises two possible questions:</p>\n\n<p>1) How can I setup wiringPi on RPi so that the project could be manually compiled on target and</p>\n\n<p>2) How/where add above line to Visual Studio, so it execute remotely with all GTK dependencies added properly on target</p>\n\n<p>Researching stock present wiringPi library (as this is Blink led example for cross-compile Linux Development) I've found, that in Project Properties/Linker/Input/Library Dependencies there is mysterious entry:</p>\n\n<pre><code>wiringPi\n</code></pre>\n\n<p>Just that, nothing more. After removing this entry, on compilation pops out same errors as before on target (which apparently lacks proper wiringPi setup) - undefined references (not mensioned any missing headers). Can this be relevant for the case? If so, how could I add there such entry which would deal with missing GTK dependencies? </p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537304736, "post_id": 52394417, "comment_id": 91734264, "body": "Aside: move <code>srand(time(NULL));</code> to the start of <code>main</code>. Call it <i>once only</i> in the program."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1537305543, "post_id": 52394417, "comment_id": 91734564, "body": "Adding a newline to flush the printf output couldn&#39;t hurt..."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1537317877, "post_id": 52394417, "comment_id": 91737568, "body": "Fixing the line <code>pthread_join(&amp;tid, NULL);</code> wouldn&#39;t hurt either.."}], "answers": [{"tags": [], "owner": {"reputation": 42, "user_id": 10368485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IH40M.jpg?s=128&g=1", "display_name": "Lasidar", "link": "https://stackoverflow.com/users/10368485/lasidar"}, "is_accepted": false, "score": 0, "last_activity_date": 1537317664, "creation_date": 1537317664, "answer_id": 52396379, "question_id": 52394417, "link": "https://stackoverflow.com/questions/52394417/need-proper-use-of-sleep-in-a-thread-task/52396379#52396379", "title": "Need proper use of sleep() in a thread task", "body": "<p>printf does not flush by default unless you end the string with a newline character. See <a href=\"https://stackoverflow.com/questions/1716296/why-does-printf-not-flush-after-the-call-unless-a-newline-is-in-the-format-strin\">Why does printf not flush after the call unless a newline is in the format string?</a>.</p>\n\n<p>You are not seeing the output because the buffer is not being flushed. Either add a new line character, or call fflush on stdout.</p>\n"}], "owner": {"reputation": 1, "user_id": 10374582, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_cUzYEvPrNU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOXMOVt_gkAc05EVTl-3K4PBekLOA/mo/photo.jpg?sz=128", "display_name": "Tech_amateur", "link": "https://stackoverflow.com/users/10374582/tech-amateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537317664, "creation_date": 1537303750, "question_id": 52394417, "link": "https://stackoverflow.com/questions/52394417/need-proper-use-of-sleep-in-a-thread-task", "title": "Need proper use of sleep() in a thread task", "body": "<p>// The thread of the periodic task is running in an infinite loop. I have included a flag and sleep(), so that it executes only for a certain time and then goes to sleep. But, after the modification, I am not getting the output \"executing thread\" at all. Please suggest, how to modify the use of the sleep function so that I get the output \"executing thread\" for the time and then it goes to sleep.//</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\nint exitflag=0;\n\nstruct task_spec_struct \n{ \n    char task_type;\n    int period,r_min,r_max;\n}s1;\n\nint gen_rand(int a, int b) \n{ \n    srand(time(NULL));\n     int x = a+(rand()%(b-a));\n      return x;\n}\n\n//task body to utilize CPU to perform computations\n\nvoid* periodic_task(void* arg)\n{\n   struct task_spec_struct *arg_struct = (struct task_spec_struct*) arg;\n\n\n  int rand_num = gen_rand(arg_struct-&gt;r_min, arg_struct-&gt;r_max);\n  while(1)\n    {\n  int i, j=0;\n  for(i=0; i&lt;rand_num; i++)\n  {\n     j=j+i;\n\n     }\n     if (exitflag==1)\n     {\n     pthread_exit(0);\n     }\n  usleep((arg_struct-&gt;period)*1000);\n  printf(\"Executing thread1\");\n  }\n\n  //pthread_exit(0);\n}\n\n\nint main(int argc, char **argv)\n{\n  int num_args = argc-1;\n\n// Creating pthread for periodic task ( runs Thread function to run periodically)\n // printf(\"\\nGive task with specifications:\");\n  s1.task_type= 'P';\n  s1.period= 300;\n  s1.r_min= 400;\n  s1.r_max= 500;\n\n    pthread_t tid;\n        pthread_attr_t attr;\n        pthread_attr_init(&amp;attr);\n        pthread_create(&amp;tid, &amp;attr, periodic_task, &amp;s1);\n        int ret=sleep(3);\n\n  if (ret==0)\n   {\n       exitflag=1;\n   }\n  pthread_join(&amp;tid, NULL);\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char", "c89"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1537303650, "post_id": 52394353, "comment_id": 91733870, "body": "Why transfer? <code>scanf(&quot;%c&quot;, aLine);</code> . or <code>scanf(&quot;%c&quot;, aLine+i);</code> is populating in a loop. Pretty expensive way to read a character sequence, but  whatever. And fyi, if all you&#39;re doing is counting characters, you generally don&#39;t need an array at all. just count them as you see them in a <code>fgetc</code> loop."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1537303841, "post_id": 52394353, "comment_id": 91733936, "body": "What does &quot;count how many characters in aLine&quot; mean? There&#39;s exactly 1."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537305381, "post_id": 52394353, "comment_id": 91734506, "body": "OP asked a <a href=\"https://stackoverflow.com/questions/52392825/c-how-to-use-while-feof-loop-to-solve-empty-input-file-problem\">similar question</a> not long ago."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1537304309, "creation_date": 1537304309, "answer_id": 52394505, "question_id": 52394353, "link": "https://stackoverflow.com/questions/52394353/how-to-transfer-a-char-in-c-to-an-array-of-char/52394505#52394505", "title": "How to transfer a char in C to an array of char?", "body": "<p>Statement <code>scanf(\"%c\",...</code> reads in a single character, so there is actually no need to count it. If you want to \"convert\" a single character into a string (for which you could then apply, for example, <code>strlen()</code>), write the character at a particular position. Don't forget to terminate the string with <code>\\0</code> (or <code>0x0</code>) such that string functions like <code>printf(\"%s\"...</code> or <code>strlen()</code> work correctly:</p>\n\n<pre><code>char aLine;\nchar inputLine[1000];\nscanf(\"%c\", &amp;aLine);\ninputLine[0] = aLine;\ninputLine[1] = '\\0';\n\nprintf(\"inputLine: '%s' has length %d\", inputLine, strlen(inputLine));\n</code></pre>\n\n<p>or simply read in a complete line at once:</p>\n\n<pre><code>char inputLine[1000];\nif (fgets(inputLine,1000,stdin)) {\n   printf(\"inputLine: '%s' has length %d\", inputLine, strlen(inputLine));\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6212742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84b4c5d955e0f8ac4ab16d091b26be76?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiwei Luo", "link": "https://stackoverflow.com/users/6212742/kaiwei-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537304309, "creation_date": 1537303488, "question_id": 52394353, "link": "https://stackoverflow.com/questions/52394353/how-to-transfer-a-char-in-c-to-an-array-of-char", "title": "How to transfer a char in C to an array of char?", "body": "<p>Say I have: </p>\n\n<pre><code>....\nchar aLine;\nchar inputLine[1000];\nscanf(\"%c\", &amp;aLine);\n....\n</code></pre>\n\n<p>Now, I want to convert aLine into an array of char so that I can count how many characters in aLine. How can i do this?</p>\n"}, {"tags": ["c", "linux", "makefile", "fork"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1537302685, "post_id": 52394094, "comment_id": 91733475, "body": "Are you sure you are sending SIGTSTP (ie. control + <b>Z</b> , not control + <b>C</b>). And the handler is the same for child and parent. Works fine on my system."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1537303085, "post_id": 52394094, "comment_id": 91733656, "body": "I don&#39;t see a reason for the <code>setpgid</code> calls at first glance [and they may be responsible for the difficulty you&#39;re having]. You probably want to do different things in parent/child. Parent: <code>signal(SIGTSTP,SIG_IGN)</code>. Child: <code>signal(SIGTSTP,SIGTSTP_Handler)</code> Also, having <code>SIGTSTP_Handler</code> send itself a signal doesn&#39;t help since it only gets invoked if the signal has already been sent to the process externally (e.g. child gets the signal and then sends the <i>same</i> signal to itself)."}, {"owner": {"reputation": 822, "user_id": 5965537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/be4da9013bd5e509538dea3d5ea751e4?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/5965537/megan"}, "edited": false, "score": 0, "creation_date": 1537304454, "post_id": 52394094, "comment_id": 91734146, "body": "Thanks for the quick response! I set the Handler for the parent so that I can catch the <code>SIGTSTP</code> and redirect it to the child. I suppose I could also just add <code>signal(SIGTSTP, SIG_IGN)</code> to the parent and do nothing for signal handling in the child. I think the problem may be that I run my code with a make command because I see the following when my program stops:  <code>[2]+  Stopped                 make</code>"}], "answers": [{"tags": [], "owner": {"reputation": 822, "user_id": 5965537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/be4da9013bd5e509538dea3d5ea751e4?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/5965537/megan"}, "is_accepted": true, "score": 0, "last_activity_date": 1537305268, "creation_date": 1537305268, "answer_id": 52394681, "question_id": 52394094, "link": "https://stackoverflow.com/questions/52394094/sigtstp-handler-terminates-both-parent-and-child-process/52394681#52394681", "title": "SIGTSTP Handler terminates both parent and child process", "body": "<p>The issue was caused because the <code>make</code> command that I started my program using was terminated by <code>ctrl-z</code>. To fix the problem you can either:</p>\n\n<p><strong>OLD Problematic Make Command:</strong></p>\n\n<p><code>gcc -o program *.c &amp;&amp; ./program</code></p>\n\n<p><strong>Potential Solutions:</strong></p>\n\n<p>(1) Remove the <code>&amp;&amp; ./program</code> line from the make command</p>\n\n<p>(2) Compile and run your program without using make</p>\n\n<p><em>I am unsure if there is anyway to still use start the program using make if you are hoping to keep your main program running in the case of a <code>SIGTSTP</code> signal</em></p>\n"}], "owner": {"reputation": 822, "user_id": 5965537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/be4da9013bd5e509538dea3d5ea751e4?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/5965537/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 52394681, "answer_count": 1, "score": 3, "last_activity_date": 1537305268, "creation_date": 1537302225, "last_edit_date": 1537304662, "question_id": 52394094, "link": "https://stackoverflow.com/questions/52394094/sigtstp-handler-terminates-both-parent-and-child-process", "title": "SIGTSTP Handler terminates both parent and child process", "body": "<p><strong>My Goal:</strong> I have a simple c program that should overwrite the default SIGTSTP handler with my own, and send a SIGTSTP only to the child process.</p>\n\n<p><strong>My Issue:</strong> The kill call within the SIGTSTP handler stops the parent process, and exits my program (not just the child). What am I doing wrong?</p>\n\n<p><strong>Edit:</strong> This problem seems to only happen when I compile and run my code using the following make command: <code>gcc -o program *.c -lreadline &amp;&amp; ./program</code>. It seems (the <code>make</code> process?) is terminated because my output contains the following line upon ctrl-z:\n<code>gcc -o sandbox *.c -lreadline &amp;&amp; ./sandbox</code>\nIs there a way to both get my program to have the desired functionality and use make?</p>\n\n<p><strong>My Code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;readline/readline.h&gt;\n\nint child;\n\nvoid handler();\n\nstatic void SIGTSTP_Handler()\n{\n  if (child != 0) {\n    kill(child, SIGTSTP);\n  }\n}\n\nint main(void)\n{\n  signal(SIGTSTP, SIGTSTP_Handler);\n\n  child = fork();\n\n  if (child == 0) {   \n    setpgid(0, getpid());\n\n    printf(\"CHILD's PID ::: [ %d ]\\n\", getpid());\n\n    printf(\"CHILD's GROUP ::: %d\\n\", getpgrp());\n\n    execlp(\"sleep\", \"sleep\", \"30\", NULL);\n\n  }\n  else {\n    setpgid(child, child);\n\n    int status;\n\n    printf(\"CHILD's PID (From Parent Perspective) ::: [ %d ]\\n\", child);\n\n    printf(\"PARENT's PID ::: %d\\n\", getpid());\n\n    printf(\"PARENT's GROUP ::: %d\\n\", getpgrp());\n\n    waitpid(child, &amp;status, WUNTRACED | WCONTINUED);\n  }\n\n  while (1);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "gtk"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537301091, "post_id": 52393818, "comment_id": 91732817, "body": "Would it be better to minimise the window, since a 0x0 window has no utility?"}, {"owner": {"reputation": 11, "user_id": 9748818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300c0f95deb2bb0b646d70e8448663b8?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZaaa", "link": "https://stackoverflow.com/users/9748818/zzzaaa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537301429, "post_id": 52393818, "comment_id": 91732965, "body": "@WeatherVane My point is that I want the user to be able to resize the window to any size they please even if theres widgets in the way"}], "answers": [{"tags": [], "owner": {"reputation": 4937, "user_id": 1545014, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/d3a08ae3ab7ee246d592730f0dd2c923?s=128&d=identicon&r=PG", "display_name": "jcoppens", "link": "https://stackoverflow.com/users/1545014/jcoppens"}, "is_accepted": false, "score": 0, "last_activity_date": 1537302468, "creation_date": 1537302468, "answer_id": 52394142, "question_id": 52393818, "link": "https://stackoverflow.com/questions/52393818/gtk3-no-resize-limits/52394142#52394142", "title": "GTK3 No resize limits", "body": "<p>If you initially use <code>set_size_request()</code> to set the window to 300x300, then it won't shrink below that. To allow users to shrink below an initial value, use <code>set_default_size()</code>. I seem to have read that the minimum size of a widget is 1x1, which seems logical, as, at 0x0 you wouldn't be able to resize it anymore. If you want less than 1x1, you can use <code>hide()</code> and just hide the contents.</p>\n\n<p><strong>But</strong> if you have any widgets inside the window, then the minimum size is determined by the widgets! (Called the 'natural size')</p>\n\n<p>To allow a window smaller that than the one determined by the widgets, you can maybe use a <code>Gtk.ScrolledWindow</code>.</p>\n\n<p>Also, recall that the outer border is drawn by the window manager, NOT by Gtk. However, you can disable the outer border by using <code>set_decorated()</code>. Not that this may not work - depending if the window manager respects this (not Gtk's fault).</p>\n"}], "owner": {"reputation": 11, "user_id": 9748818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300c0f95deb2bb0b646d70e8448663b8?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZaaa", "link": "https://stackoverflow.com/users/9748818/zzzaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537302468, "creation_date": 1537300887, "question_id": 52393818, "link": "https://stackoverflow.com/questions/52393818/gtk3-no-resize-limits", "title": "GTK3 No resize limits", "body": "<p>Currently if I make a window in GTK3</p>\n\n<p>For example 300x300</p>\n\n<p>And I put a button at the bottom, right hand corner, I can not shrink my window</p>\n\n<p>Size because this button is preventing me is there a function in gtk3 that can allow me to ignore all widgets, and resize to anything even 0x0</p>\n\n<p>And this is the user doing this with the window resize, drag and click</p>\n\n<p>And is there a way where I can set this resize limit myself, and not have this dependent on whats in my window</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537299191, "post_id": 52393435, "comment_id": 91732029, "body": "Can you include some code for context? That would help a lot."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1537299205, "post_id": 52393435, "comment_id": 91732039, "body": "Can you please post some code (in the question) as a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> for <i>one</i> function that shows what you are asking?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1537299266, "post_id": 52393435, "comment_id": 91732075, "body": "What is the relevance to the C tag?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537299269, "post_id": 52393435, "comment_id": 91732079, "body": "Calling conventions depend upon the API. So without giving your API and/or calling conventions, your question don&#39;t make much sense."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "edited": false, "score": 0, "creation_date": 1537299358, "post_id": 52393435, "comment_id": 91732128, "body": "I think that would confuse you, but if you still asking here&#39;s my &quot;universal&quot; function <a href=\"https://pastebin.com/X03AeeRQ\" rel=\"nofollow noreferrer\">pastebin.com/X03AeeRQ</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537299555, "post_id": 52393435, "comment_id": 91732226, "body": "The code you linked does not look like &quot;I&#39;m new to assembly&quot; code. Is it your code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "edited": false, "score": 0, "creation_date": 1537299606, "post_id": 52393435, "comment_id": 91732248, "body": "Yes, i have started learning yesterday :/"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1537300293, "post_id": 52393435, "comment_id": 91732517, "body": "You do not want to push anything on the stack, but you also want to return to the call site after the function has finished. You have to realize that the return address has to be stored <i>somewhere</i> because the function in principle can be called from anywhere. The call instruction saves it on the stack. You can also save it in a register, but you have to be careful not to overwrite the register in the body of the function. If you want to save it in a register, you would have to use a combination of lea and jump."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1537300367, "post_id": 52393435, "comment_id": 91732551, "body": "But my main query is why do you not want to push anything on the stack? What is the constraint? Is the constraint really necessary? This looks like an XY problem to me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "edited": false, "score": 0, "creation_date": 1537300793, "post_id": 52393435, "comment_id": 91732725, "body": "Thanks for reply, but how to use both together (lea esi &lt;Label After Jump&gt; + jmp &lt;FunctionName&gt; ) ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "edited": false, "score": 0, "creation_date": 1537303594, "post_id": 52393435, "comment_id": 91733851, "body": "I think i can solve my problem if i&#39;ll get how to replace or pop current return address"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "edited": false, "score": 0, "creation_date": 1537299481, "post_id": 52393500, "comment_id": 91732190, "body": "Ehm, how do i know if im saving a return address xd"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537306417, "post_id": 52393500, "comment_id": 91734849, "body": "@BeqaGurgenidze: If for some reason you want to avoid pushing a return address onto the stack, you could (in theory if you don&#39;t care about performance) load a return address into a register, like a RISC-style link register (like <code>lea rcx, [rel ret_addr]</code>, and have the callees return with <code>jmp rcx</code> or whatever.  But the functions you call have to be written specially to do that instead of using <code>ret</code>.  So you can avoid <code>call</code>/<code>ret</code>, using regular indirect branches, but that defeats the return-address predictor stack.  (So Ben, you were overzealous in applying the Law of Excluded Middle)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537307286, "post_id": 52393500, "comment_id": 91735166, "body": "@BeqaGurgenidze: Here&#39;s an example of what I was talking about.  <a href=\"https://stackoverflow.com/q/38542382\">mov &amp; jmp to &amp; jmp back vs call &amp; ret</a>.  My answer there explains why it&#39;s a terrible idea and you should just let <code>call</code> push a return address."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537311306, "post_id": 52393500, "comment_id": 91736283, "body": "@PeterCordes - what do you mean by &quot;defeat&quot;? Using a link register should work fine on x86, and the return stack isn&#39;t affected if you use neither <code>call</code> nor <code>ret</code>. Most likely it could be faster in some scenarios where you are OK with a custom calling convention since you are replacing a <code>call</code> and <code>ret</code> with a reg-reg <code>mov</code> (if at all - maybe you can just do that once if you call the function many times) and an indirect jump. So no memory accesses, store forwarding, speculative call limit, etc."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1537312505, "post_id": 52393500, "comment_id": 91736549, "body": "@BeeOnRope: I should have said &quot;doesn&#39;t benefit from&quot;, potentially giving you branch mispredicts on <code>jmp r15</code> where you wouldn&#39;t have any with <code>call</code> / <code>ret</code>.  Interesting point that a call-site in a loop could reuse the same link-reg value, if your custom calling convention didn&#39;t clobber it.  It could actually be good in a loop."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 2, "creation_date": 1537312665, "post_id": 52393500, "comment_id": 91736582, "body": "Yes, you are more likely to get branch mispredicts when stuff is cold (although even the <code>call&#47;ret</code> pair may soft-mispredict the <code>call</code> in that case), but if you are contemplating such a crazy thing I guess you are calling this a lot so it&#39;s somehow hot, and then I guess the indirect predictor would do fine. So I wouldn&#39;t dismiss it entirely (of course as you pointed out elsewhere the first step would just be to inline it, but maybe if you have a bazillion call sites it makes sense, or for a small JITed function, etc)."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537325692, "post_id": 52393500, "comment_id": 91739161, "body": "@PeterCordes: Pretty sure he&#39;s calling an existing function, so the return address does have to go on the stack.  But yes, there are specific cases of &quot;yes, save the return address&quot; that don&#39;t use the stack."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 0, "last_activity_date": 1537299492, "last_edit_date": 1537299492, "creation_date": 1537299362, "answer_id": 52393500, "question_id": 52393435, "link": "https://stackoverflow.com/questions/52393435/c-assembly-x86-call-alternative/52393500#52393500", "title": "C, Assembly x86 - call Alternative", "body": "<p>You've found both options.  The behavior is completely determined by this question:</p>\n\n<p><strong>Do you save a return address?</strong></p>\n\n<p>If the answer is yes, you have behavior like call, and stuff gets pushed onto the stack (at least a return address).</p>\n\n<p>If the answer is no, you don't return to the calling function, so the rest of it gets skipped (like <code>jmp</code>).</p>\n\n<p>The Law of the Excluded Middle says there are no other options.</p>\n\n<hr>\n\n<p>A possible way to get around this, is to save the return address (coming back to your trampoline) right on top of the original return address (saving that somewhere else, thread-local storage perhaps).  That way you maintain the stack layout needed by the function you are forwarding to.  Part of your post-hook then needs to put the original return address back.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7494493"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537299492, "creation_date": 1537299014, "question_id": 52393435, "link": "https://stackoverflow.com/questions/52393435/c-assembly-x86-call-alternative", "title": "C, Assembly x86 - call Alternative", "body": "<p>I'm new to assembly. I want to call two or more functions but not lose or push anything into stack. I used jmp but this one is ignoring next lines in code and leaves current function. So is it possible to do this? (Additional information: I have many functions and want to hook them (Create (pre/original/post) function). I don't want to make hook separately (this will take huge space, i want one universal), so i have created naked functions for all of them which will store some information in variables for incoming function and them will jump into universal function (naked too + assembly code), this will loop Pre hooks and calls them, then will call original... But issue is that 'call' is not the case and jmp function is just ignoring next code)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 2, "creation_date": 1537297801, "post_id": 52393100, "comment_id": 91731404, "body": "That would be a function of the linker, not the compiler. And it&#39;s just code, so it would go into the text segment."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1537298358, "post_id": 52393100, "comment_id": 91731637, "body": "It can put it wherever it wants, including nowhere if it feels it won&#39;t impact the functioning of your program. The compiler has a lot of latitude, especially when aggressive optimization is turned on."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1537299163, "post_id": 52393100, "comment_id": 91732011, "body": "Most implementations si\u0119 .text segment for all the code. It does not matter if it is static or not static. The only difference is that the compiler does not emin public symbolic information"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1537300540, "post_id": 52393100, "comment_id": 91732627, "body": "@JeffMercado to be fair, the compiler decides the section for each function while generating the object file."}], "owner": {"reputation": 13, "user_id": 6772527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uKlrj.jpg?s=128&g=1", "display_name": "Amr Abdeen", "link": "https://stackoverflow.com/users/6772527/amr-abdeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1537297794, "answer_count": 0, "score": 0, "last_activity_date": 1537297505, "creation_date": 1537297505, "question_id": 52393100, "link": "https://stackoverflow.com/questions/52393100/where-does-the-gcc-compiler-assign-the-location-of-the-static-function-in-memory", "closed_reason": "Duplicate", "title": "Where does the GCC compiler assign the location of the static Function in memory?", "body": "<p><em>Static variables</em> are assigned in data memory segment in memory. What about <strong>static functions</strong>? How does the GCC compiler assign its location? and where?</p>\n\n<pre><code>EX:\nstatic void fun1(void) \n{ \n  puts(\"fun1 called\"); \n} \n</code></pre>\n"}, {"tags": ["c", "c89", "feof"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537296487, "post_id": 52392825, "comment_id": 91730792, "body": "&quot;Now I have an empty file&quot; means what? Are you trying to read an empty file? Did this create one?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1537296710, "post_id": 52392825, "comment_id": 91730908, "body": "Send your professor back to school. <code>while(fgets(inputLineArray, 1000, stdin) != NULL) { . . . }</code>"}, {"owner": {"reputation": 121, "user_id": 6212742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84b4c5d955e0f8ac4ab16d091b26be76?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiwei Luo", "link": "https://stackoverflow.com/users/6212742/kaiwei-luo"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1537296800, "post_id": 52392825, "comment_id": 91730953, "body": "So how could I fix this? @user3121023"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 384, "user_id": 7732230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155140881081764/picture?type=large", "display_name": "Efi Shtainer", "link": "https://stackoverflow.com/users/7732230/efi-shtainer"}, "edited": false, "score": 0, "creation_date": 1537298319, "post_id": 52392825, "comment_id": 91731621, "body": "@EfiShtainer <code>stdin</code> is a predefined file which is already open. You can use any opened file, but <code>scanf</code> is reading <code>stdin</code> and <code>fscanf</code> is reading the opened file you tell it (which can be <code>stdin</code>). Whereas <code>fgets</code> always needs a file variable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1537298612, "post_id": 52392825, "comment_id": 91731744, "body": "@user3121023 in which case the <code>%*c</code> is not necessary, which consumes one trailing whitespace, however the added space before <code>%</code> consumes <i>all</i> leading whitespace."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1537314641, "post_id": 52392825, "comment_id": 91736968, "body": "<code>feof</code> doesn&#39;t read any input, so what are you supposed to use to read?  scanf?  Try using <code>while(scanf(&quot; %999[^\\n]&quot;, inputLineArray) == 1) {</code>..."}], "owner": {"reputation": 121, "user_id": 6212742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84b4c5d955e0f8ac4ab16d091b26be76?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiwei Luo", "link": "https://stackoverflow.com/users/6212742/kaiwei-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "closed_date": 1537296563, "answer_count": 0, "score": 0, "last_activity_date": 1537296324, "creation_date": 1537296324, "question_id": 52392825, "link": "https://stackoverflow.com/questions/52392825/c-how-to-use-while-feof-loop-to-solve-empty-input-file-problem", "closed_reason": "Duplicate", "title": "C - How to use while feof loop to solve empty input file problem?", "body": "<p>This is an assignment and my professor only allows us to use feof function to read a file input line by line. Now i have an empty file and I got stuck in an infinite loop.</p>\n\n<pre><code>...\nwhile(!feof(stdin)){\n    ...\n    char inputLineArray[1000];\n    scanf(\"%[^\\n]%*c\", inputLineArray);\n    ...\n}\n...\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32", "spi", "hal"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1537356331, "post_id": 52391761, "comment_id": 91753204, "body": "I&#39;m voting to close this question as off-topic because it can&#39;t be determined from outside it&#39;s a software of hardware error. Also one would require access to the <b>actual</b> hardware to tell. Debug your code and use a logic analyser coupled with code execution. Also getting rid of the HAL bloatware would simplify debugging greatly and massively decrease overhead. Finally check the datasheets/deference manuals of all devices."}, {"owner": {"reputation": 13, "user_id": 9295600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9qMaq.jpg?s=128&g=1", "display_name": "aggieTed", "link": "https://stackoverflow.com/users/9295600/aggieted"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537368791, "post_id": 52391761, "comment_id": 91761030, "body": "@toohonestforthissite After checking the hardware, there was a loose connection causing some data loss."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1537375142, "post_id": 52391761, "comment_id": 91764823, "body": "So why do you accept an answer which is not related to the problem? Answer should only be accepted if they solve the <b>actual</b> problem."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 6897611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e0b65453516d1cdc4d82a3c3632d7e?s=128&d=identicon&r=PG&f=1", "display_name": "grml", "link": "https://stackoverflow.com/users/6897611/grml"}, "is_accepted": true, "score": 0, "last_activity_date": 1537356834, "creation_date": 1537356834, "answer_id": 52404927, "question_id": 52391761, "link": "https://stackoverflow.com/questions/52391761/how-do-i-program-ad5930-serially-using-spi-and-the-stm32-hal-libraries/52404927#52404927", "title": "How do I program AD5930 serially using SPI and the STM32 HAL Libraries?", "body": "<p><code>HAL_SPI_Transmit</code> third parameter is the number of bytes to transmit. Your data buffer contains 16 bytes (8 * sizeof(uint16) = 8 * 2 bytes), but you only send 8. </p>\n"}], "owner": {"reputation": 13, "user_id": 9295600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9qMaq.jpg?s=128&g=1", "display_name": "aggieTed", "link": "https://stackoverflow.com/users/9295600/aggieted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "closed_date": 1537385099, "accepted_answer_id": 52404927, "answer_count": 1, "score": 0, "last_activity_date": 1537356834, "creation_date": 1537291486, "question_id": 52391761, "link": "https://stackoverflow.com/questions/52391761/how-do-i-program-ad5930-serially-using-spi-and-the-stm32-hal-libraries", "closed_reason": "Not suitable for this site", "title": "How do I program AD5930 serially using SPI and the STM32 HAL Libraries?", "body": "<p>I am working with an Analog Devices Waveform generator (AD5930) and am trying to program it using the spi peripheral on a STM32f767 Eval board. The waveform generator is to be programmed by loading data, in the form of 16bit words, into the devices registers using the serial clock of the SPI. The data words include register address, first 4 bits, and commands, the last twelve bits. Connections from the STM32 to the AD5930 are properly placed and when checking the lines with an oscilloscope I am can see the data, clock and control all come off the board. \nAs of right now I'm trying to send 8 16bit command words using the HAL_SPI_Transmit command. Here is whats included in my <strong>main.c</strong>: </p>\n\n<p>`</p>\n\n<pre><code>HAL_Init();\n  SystemClock_Config();\n  MX_GPIO_Init();\n  MX_SPI1_Init();`\n\n `HAL_GPIO_WritePin(GPIOA, GPIO_PIN_4, GPIO_PIN_SET);\n    HAL_Delay(5);  `\n\n    spiData[0] = 0x0E83;\n    spiData[1] = 0x13E8;\n    spiData[2] = 0x2000;\n    spiData[3] = 0x3800;\n    spiData[4] = 0x63E8;\n    spiData[5] = 0xC0C5;\n    spiData[6] = 0xD002;\n    spiData[7] = 0xA3E8;\n\n    HAL_GPIO_WritePin(GPIOA, GPIO_PIN_4, GPIO_PIN_RESET);\n    if((HAL_SPI_Transmit(&amp;hspi1,(uint8_t*)&amp;spiData,8,5)) ==HAL_TIMEOUT){\n            HAL_Delay(100);\n        }\n    while(HAL_SPI_GetState(&amp;hspi1) != HAL_SPI_STATE_READY);\n    HAL_GPIO_WritePin(GPIOA, GPIO_PIN_4, GPIO_PIN_SET);\n    HAL_Delay(1);\n\n\n        HAL_GPIO_WritePin(GPIOB, GPIO_PIN_8, GPIO_PIN_RESET);       \n    HAL_Delay(1);\n        HAL_GPIO_WritePin(GPIOB, GPIO_PIN_8, GPIO_PIN_SET);\n        HAL_Delay(1);`\n</code></pre>\n\n<p>Below are my initialization specifications: </p>\n\n<p>`</p>\n\n<pre><code>hspi1.Instance = SPI1;\n  hspi1.Init.Mode = SPI_MODE_MASTER;\n  hspi1.Init.Direction = SPI_DIRECTION_2LINES;\n  hspi1.Init.DataSize = SPI_DATASIZE_16BIT;\n  hspi1.Init.CLKPolarity = SPI_POLARITY_LOW;\n  hspi1.Init.CLKPhase = SPI_PHASE_1EDGE;\n  hspi1.Init.NSS = SPI_NSS_SOFT;\n  hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_64;\n  hspi1.Init.FirstBit = SPI_FIRSTBIT_MSB;\n  hspi1.Init.TIMode = SPI_TIMODE_DISABLE;\n  hspi1.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;\n  hspi1.Init.CRCPolynomial = 7;\n  hspi1.Init.CRCLength = SPI_CRC_LENGTH_DATASIZE;\n  hspi1.Init.NSSPMode = SPI_NSS_PULSE_DISABLE;\n  if (HAL_SPI_Init(&amp;hspi1) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n</code></pre>\n\n<p><code>\n</code></p>\n\n<pre><code>  RCC_OscInitTypeDef RCC_OscInitStruct;\n  RCC_ClkInitTypeDef RCC_ClkInitStruct;\n\n\n  __HAL_RCC_PWR_CLK_ENABLE();\n\n  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE3);\n\n  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;\n  RCC_OscInitStruct.HSIState = RCC_HSI_ON;\n  RCC_OscInitStruct.HSICalibrationValue = 16;\n  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;\n  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;\n  RCC_OscInitStruct.PLL.PLLM = 16;\n  RCC_OscInitStruct.PLL.PLLN = 192;\n  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;\n  RCC_OscInitStruct.PLL.PLLQ = 2;\n  if (HAL_RCC_OscConfig(&amp;RCC_OscInitStruct) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n\n  if (HAL_PWREx_EnableOverDrive() != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n\n  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK\n                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;\n  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;\n  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;\n  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV2;\n  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;\n\n  if (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_3) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n  HAL_SYSTICK_Config(HAL_RCC_GetHCLKFreq()/1000);\n\n  HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);\n\n\n  HAL_NVIC_SetPriority(SysTick_IRQn, 0, 0);\n\n\nGPIO_InitStruct.Pin = GPIO_PIN_5;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    GPIO_InitStruct.Pin = GPIO_PIN_7;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;\n    HAL_GPIO_Init(GPIOD, &amp;GPIO_InitStruct);\n\n  GPIO_InitStruct.Pin = LD3_Pin|LD2_Pin|GPIO_PIN_8;\n  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n  GPIO_InitStruct.Pull = GPIO_NOPULL;\n  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n  HAL_GPIO_Init(GPIOB, &amp;GPIO_InitStruct);\n\n  GPIO_InitStruct.Pin = GPIO_PIN_4;\n  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n  GPIO_InitStruct.Pull = GPIO_NOPULL;\n  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n  HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n</code></pre>\n\n<p>Pin PB8 is used as a control trigger to begin waveform generation after registers are programmed, PIN PA5 is used for SPI Clock, PD7 as SPI data or MOSI, and pin PA4 is used as Chip Select. </p>\n\n<p>What I observe on the oscilloscope(when viewing clock + data) is data being clocked in, what seems to be correct but hanging high when the clk has stopped. I dont get HAL TIMEOUT error so my assumption is the data was formatted correctly for transmission. When the program continues to run, and the trigger(Pin PB8) transitions I don't see a waveform in the output. What about my configuration may be preventing me from communicating correctly with the AD5930? </p>\n"}, {"tags": ["c", "qsort"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1537292221, "post_id": 52391737, "comment_id": 91728828, "body": "It doesn&#39;t seem your second function differentiates between <code>A-&gt;freq &gt; B-&gt;freq</code> and <code>A-&gt;freq &lt; B-&gt;freq</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1537292541, "post_id": 52391737, "comment_id": 91728967, "body": "You can put both ways of sorting in the same comparsion function. If <code>freq</code> is unequal return that result. Otherwise return the string comparison result. Beware of using <code>WordArrayB-&gt;freq - WordArrayA-&gt;freq</code> for the integer comparison, sooner or later you&#39;ll do this and an overflow will return the wrong result.  Make the explicit comparisons."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537304664, "post_id": 52392053, "comment_id": 91734234, "body": "Note: <code>B-&gt;freq - A-&gt;freq</code> has the disadvantaged of potential <code>int</code> overflow.  The answer&#39;s later solution is correct."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 2, "last_activity_date": 1537294560, "last_edit_date": 1537294560, "creation_date": 1537292745, "answer_id": 52392053, "question_id": 52391737, "link": "https://stackoverflow.com/questions/52391737/qsort-on-struct-with-number-and-char-sort-on-number-first-and-then-sort-on-alph/52392053#52392053", "title": "qsort on struct with number and char, sort on number first and then sort on alphabet with same number", "body": "<p>The problem with your second version is when <code>A-&gt;freq</code> and <code>B-&gt;freq</code> are <strong>not</strong> equal. In that case you can't just <code>return -1</code>. In that case you need to compare \n<code>A-&gt;freq</code> and <code>B-&gt;freq</code> like you did in the first function. So...</p>\n\n<p>Change</p>\n\n<pre><code>else{\n    return -1;\n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>return ( B-&gt;freq - A-&gt;freq );\n</code></pre>\n\n<p>Or better - change it to</p>\n\n<pre><code>if ( B-&gt;freq &gt; A-&gt;freq ) return 1;\nreturn -1;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10157404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z3vXgE8tLoY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbOJao7Vjp9gSAmu0IBeyYRSiB8A/mo/photo.jpg?sz=128", "display_name": "LIFENG CAO", "link": "https://stackoverflow.com/users/10157404/lifeng-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52392053, "answer_count": 1, "score": 0, "last_activity_date": 1537294560, "creation_date": 1537291426, "question_id": 52391737, "link": "https://stackoverflow.com/questions/52391737/qsort-on-struct-with-number-and-char-sort-on-number-first-and-then-sort-on-alph", "title": "qsort on struct with number and char, sort on number first and then sort on alphabet with same number", "body": "<p>Would like to qsort on struct with number and char, sort on number first and then sort on alphabet with same number\nHere is the struct i have</p>\n\n<pre><code>typedef struct{\n    char word[101];\n    int freq;\n}WordArray;\n</code></pre>\n\n<p>Here is the logic I followed: Sort on freq first ()</p>\n\n<pre><code>int cmpffunc (const void * a, const void * b)\n{\n    WordArray *WordArrayA = (WordArray *)a;\n    WordArray *WordArrayB = (WordArray *)b;\n    return ( WordArrayB-&gt;freq - WordArrayA-&gt;freq );\n}\nqsort(array, arrayLength, sizeof(WordArray), cmpffunc);\n</code></pre>\n\n<p>Which works fine, then I tried to sort on the alphabet with same freq number. Here is the thing I tried but non of them work as expected: </p>\n\n<pre><code>int cmpwfunc (const void * a, const void * b)\n{\n    WordArray *A = (WordArray *)a;\n    WordArray *B = (WordArray *)b;\n    if (A-&gt;freq == B-&gt;freq){\n        return strcmp(A-&gt;word,B-&gt;word);\n    }\n    else{\n        return -1;\n    }\n}\nqsort(array, arrayLength, sizeof(WordArray), cmpwfunc);\n</code></pre>\n\n<p>Any suggestions will be appreciated. </p>\n"}, {"tags": ["c++", "c", "linux", "sockets", "pthreads"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1537291401, "post_id": 52391701, "comment_id": 91728503, "body": "Killing a thread is risky. See <a href=\"https://stackoverflow.com/questions/2163090/when-i-kill-a-pthread-in-c-do-destructors-of-objects-on-stacks-get-called\">this question</a>."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1537291402, "post_id": 52391701, "comment_id": 91728504, "body": "Please read the tags&#39; description before applying them."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1537292063, "post_id": 52391701, "comment_id": 91728766, "body": "Wake up from <code>poll</code> more often and test a termination flag set by the other thread. If the flag says terminate, terminate. Otherwise loop around and <code>poll</code> again until you hit the broader exit condition. Thread kill should be a last resort. as it can leave you with an unstable program"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1537293399, "post_id": 52391701, "comment_id": 91729383, "body": "Since you have this tagged linux, one approach is to include an <code>eventfd()</code> descriptor in the ones you poll on, and signal it when the polling thread should exit (And have that thread do so gracefully when that fd becomes readable)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1537293653, "post_id": 52391701, "comment_id": 91729502, "body": "@Fran&#231;oisAndrieux: The linked answer (and question) makes no sense because there is no such thing as killing a thread."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1537293915, "post_id": 52391701, "comment_id": 91729606, "body": "@R.. Killing a threat is generally understood to mean to cause it&#39;s execution to stop immediately and irrevocably. Whether or not a particular threading API allows it is another question."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1537294722, "post_id": 52391701, "comment_id": 91729963, "body": "@Fran&#231;oisAndrieux: POSIX threads doesn&#39;t, and the question is tagged <code>pthreads</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1537294803, "post_id": 52391701, "comment_id": 91730014, "body": "@R.. You&#39;re right about that. Still, killing a thread is risky and still, there <i>is</i> such a thing as killing a thread. This information is still relevant to OP since this is what they are attempting to do, regardless of the impossibility of doing it with their chosen API."}], "answers": [{"comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537295543, "post_id": 52391922, "comment_id": 91730378, "body": "@R. I think it&#39;s pretty obvious what&#39;s meant. In case you don&#39;t like me call it killing, call it <i>forcibly terminate</i>"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537296118, "post_id": 52391922, "comment_id": 91730635, "body": "It&#39;s not a matter of what you call it. It&#39;s that pthreads explicitly has <i>no such operation</i> at all."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537296423, "post_id": 52391922, "comment_id": 91730768, "body": "@R. just like processes - Still, the command is called <code>kill</code>. Even there, and has always been."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537296580, "post_id": 52391922, "comment_id": 91730833, "body": "The <code>kill</code> function (and likewise the shell command) cannot kill threads. It sends a signal to a process which may (depending on whether it&#39;s ignored, caught, or blocked) result in termination of the process. Threads are not processes."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537296762, "post_id": 52391922, "comment_id": 91730929, "body": "That&#39;s what I&#39;m saying. And, still, it&#39;s called <code>kill</code>. Even if it can&#39;t kill processes. Even if it can be used to <i>wake up</i> processes which is sortof the opposite. I think you are nitpicking on terminology."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537296976, "post_id": 52391922, "comment_id": 91731029, "body": "No, I am not nitpicking terminology. There is absolutely no interface which targets a thread and causes it to terminate involuntarily. The <code>kill</code> function/command does not do this. It can only target processses."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537297728, "post_id": 52391922, "comment_id": 91731367, "body": "The posix thread functions that <i>terminate a thread</i> do this by sending a signal to it (just like <code>kill</code> does when sending a signal to a process). Most pthread libs do the same thing using non-terminating signals, so need co-operation from the thread in order to end the thread and not the whole process. So what? Still looks like <code>kill</code> to me. But arguing whether you can &quot;kill&quot; a thread or not doesn&#39;t really answer the question."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537306248, "post_id": 52391922, "comment_id": 91734791, "body": "<b>There is no POSIX thread function which terminates a thread.</b>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537312651, "post_id": 52391922, "comment_id": 91736577, "body": "@R.. <code>pthread_cancel</code> sends a [special] signal to the target thread, which intercepts it, does a bit of cleanup, and terminates. One can mask off signals via <code>pthread_sigmask</code> which is wrapper around <code>sigprocmask</code> [to prevent accidental masking of the signal that <code>pthread_cancel</code> uses] and it works on a per-<i>thread</i> basis. <code>kill(2)</code> can be given a thread id (from <code>gettid</code>) instead of a process id (from <code>getpid</code>)"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 3452, "user_id": 3242146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd208146333b85dddf7c66b86682621?s=128&d=identicon&r=PG", "display_name": "Jeff Garrett", "link": "https://stackoverflow.com/users/3242146/jeff-garrett"}, "edited": false, "score": 0, "creation_date": 1537315217, "post_id": 52391922, "comment_id": 91737061, "body": "@JeffGarrett: It sends a signal to a thread, resulting in one of (1) nothing, (2) execution of a signal handler in that thread, or (3) termination of the whole process. It can never result in termination of the target thread."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1537315314, "post_id": 52391922, "comment_id": 91737084, "body": "@CraigEstey: If you pass a tid to the <code>kill</code> function/syscall/command, it will deliver a signal to the process the thread belongs to, possibly resulting in termination of the process. It cannot cause termination of the thread whose tid was passed without causing termination of the entire process. You can test this if you don&#39;t believe me. There are <b>a lot of misconceptions</b> about this topic."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1537315500, "post_id": 52391922, "comment_id": 91737119, "body": "@CraigEstey: <code>pthread_sigmask</code> can be used to defer signals sent specifically to the thread (via <code>pthread_kill</code> and the underlying <code>tkill</code> or <code>tgkill</code> syscall, not the <code>kill</code> syscall) and to ensure that signals sent to the process rather than a specific thread get handled in a different thread, or to defer them if all threads have the signal masked. It has nothing to do with whether a thread can be killed (it can&#39;t)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1537315689, "post_id": 52391922, "comment_id": 91737149, "body": "@CraigEstey: <code>pthread_cancel</code> can be used to <i>cooperatively</i> request the cancellation of a thread. Cancellation will be acted upon only at functions which are cancellation points, and only if cancellation is enabled (it is by default, but usually isn&#39;t safe to use unless you&#39;ve used <code>pthread_cleanup_push</code>, as mentioned in my answer)."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1537326201, "post_id": 52391922, "comment_id": 91739265, "body": "@R.. <code>pthread_cancel</code> can force cancellation anytime. See manpage for <code>pthread_setcanceltype</code> [and <code>PTHREAD_CANCEL_ASYNCHRONOUS</code>]. An example: <a href=\"https://pastebin.com/jHs04Tjk\" rel=\"nofollow noreferrer\">pastebin.com/jHs04Tjk</a> It isn&#39;t necessarily wise to do this [without the callbacks]. In products I&#39;ve done, I prefer an &quot;escalation&quot; strategy (e.g.): (1) request stop via flag in a task block, (2) Send thread a signal (with custom signal handler) that wakes up thread (<code>EINTR</code>) and thread looks at its stop flag, (3) <code>pthread_cancel</code>, (4) other stuff ..."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1537332463, "post_id": 52391922, "comment_id": 91740615, "body": "@CraigEstey: Enabling or disabling cancellation, or setting it to asynchronous (which can only be done for pure computation), can happen only from the thread itself; you cannot enable cancelability for another thread. This is what <i>cooperatively</i> means in my last comment above."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 2, "last_activity_date": 1537292184, "creation_date": 1537292184, "answer_id": 52391922, "question_id": 52391701, "link": "https://stackoverflow.com/questions/52391701/pthread-kill-vs-pthread-cancel-to-terminate-a-thread-blocked-for-i-o/52391922#52391922", "title": "pthread_kill() vs pthread_cancel() to terminate a thread blocked for I/O", "body": "<p>Depending on the exact implementation of your thread library, it's very likely the thread won't even return from <code>poll</code> when being killed - so, you probably won't even achieve what you want. </p>\n\n<p>You need to be very careful not to create memory leaks, and still are very likely to create a file descriptor leak by killing the thread that owns it (note, thread resources, in contrary to processes, aren't \"cleaned up\" by the system).</p>\n\n<p>It is generally safer to use shorter timeout periods and poll a terminate flag in-between, or use signals to interrupt the system call, then terminate the thread under its own control, freeing all allocated resources.</p>\n"}, {"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1537295643, "post_id": 52392460, "comment_id": 91730433, "body": "Someone&#39;s upset about me pointing out that there&#39;s no such thing as killing a thread (in the context of POSIX threads, for which the question is tagged)."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1537294599, "creation_date": 1537294599, "answer_id": 52392460, "question_id": 52391701, "link": "https://stackoverflow.com/questions/52391701/pthread-kill-vs-pthread-cancel-to-terminate-a-thread-blocked-for-i-o/52392460#52392460", "title": "pthread_kill() vs pthread_cancel() to terminate a thread blocked for I/O", "body": "<p>There is no such thing as killing a thread.</p>\n\n<p>The poorly-named <code>pthread_kill</code> function is a threads analogue of the poorly-named <code>kill</code> function, which sends a signal to process. The name <code>kill</code> historically made sense in that the default action of many signals is to kill the process. But this default action of killing the process <strong>does not depend on whether the signal was sent to the process or a particular thread</strong> - either way, the process terminates.</p>\n\n<p>The only time <code>pthread_kill</code> is useful is when you want to invoke a signal handler on another thread. Unless you are certain that the signal handler could not have interrupted any function that is not async-signal-safe, the signal handler is limited to calling functions which are async-signal-safe, and thereby cannot even act to end the thread's lifetime (<code>pthread_exit</code> is not async-signal-safe).</p>\n\n<p>If you're okay with the thread eventually terminating as a result of the call, <code>pthread_cancel</code> is the right way to end a thread stuck in a blocking operation. In order to use it safely, though, you need to make heavy use of <code>pthread_cleanup_push</code> and <code>pthread_cleanup_pop</code>.</p>\n\n<p>If you don't want the thread to terminate, signals are your only option. You have two choices:</p>\n\n<ol>\n<li><p>Install a signal handler (can be a no-op) using <code>sigaction</code> without <code>SA_RESTART</code>, so that it causes <code>EINTR</code>. Since there are inherent race conditions in this approach (if you send the signal just before the blocking syscall is entered, rather than once it's blocked, the signal won't do anything) you need to <em>repeatedly</em> send the signal, with exponential back-off so as not to starve the target of execution time, until the target confirms via some other synchronization mechanism (a POSIX semaphore works well) that it got the message.</p></li>\n<li><p>Install a signal handler that will <code>longjmp</code>. In order to do this safely you need to control the context from which it can happen; the easiest way to do this is to keep it blocked in the signal mask normally, only unmasking it when the <code>jmp_buf</code> is valid around a blocking call. The blocking function you call needs to be async-signal-safe, and it needs to <strong>not be one which allocates or frees resources</strong> (like <code>open</code> or <code>close</code>) since you will <strong>lose knowledge of whether it completed</strong> when you handle the signal. Of course the <code>jmp_buf</code>, or a pointer to it, needs to be a thread-local object (<code>_Thread_local</code>/<code>__thread</code>) in order for this to work at all.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1537302416, "post_id": 52393413, "comment_id": 91733383, "body": "+1 and a side note: Since OP is [already] doing sockets [and, thus, already familiar with them], we could replace the pipe with an <code>AF_UNIX</code> socket. It may provide better R/T response. Dunno."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537315746, "post_id": 52393413, "comment_id": 91737157, "body": "+1, This is a really good approach when it works, but there are some operations that block that don&#39;t have an associated file descriptor you can poll."}], "tags": [], "owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "is_accepted": false, "score": 2, "last_activity_date": 1537298930, "creation_date": 1537298930, "answer_id": 52393413, "question_id": 52391701, "link": "https://stackoverflow.com/questions/52391701/pthread-kill-vs-pthread-cancel-to-terminate-a-thread-blocked-for-i-o/52393413#52393413", "title": "pthread_kill() vs pthread_cancel() to terminate a thread blocked for I/O", "body": "<p>An easy and clean option is to create a \"signal\" pipe. That is, call <code>pipe</code>, take the file descriptor for the \"read\" end and add it to your list of <code>poll</code> file descriptors (with <code>POLLIN</code>). Then, whenever you want to unblock the thread which is waiting in <code>poll</code>, just write a byte to the write end of the pipe. The pipe, having received data, will return as readable in the blocked thread. You can even specify different \"commands\" by varying the value of the byte written.</p>\n\n<p>(You'll need to read the byte from the pipe before it can be re-used of course.)</p>\n"}], "owner": {"reputation": 41, "user_id": 5967679, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xhBNx7-4qbk/AAAAAAAAAAI/AAAAAAAAABE/RQ3sM2psAjw/photo.jpg?sz=128", "display_name": "Durgesh Tanuku", "link": "https://stackoverflow.com/users/5967679/durgesh-tanuku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1475, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1537298930, "creation_date": 1537291299, "last_edit_date": 1537291519, "question_id": 52391701, "link": "https://stackoverflow.com/questions/52391701/pthread-kill-vs-pthread-cancel-to-terminate-a-thread-blocked-for-i-o", "title": "pthread_kill() vs pthread_cancel() to terminate a thread blocked for I/O", "body": "<p>In our server code we are using poll() system call for monitoring client sockets. The poll() is called with a large timeout value. So the thread calling poll() gets blocked for I/O. </p>\n\n<p>As per the flow, we have a scenario where we need to terminate thread that blocked in poll() from a different thread. I have came across pthread_kill() and pthread_cancel() functions, which can terminate the target thread blocked for I/O. </p>\n\n<p>By reading the man pages, both these functions seems to work fine. Few links on internet suggested that both of these functions are dangerous to use. </p>\n\n<p>Is there any alternative way to terminate the thread blocked for I/O ? \nIf not, which of these functions is recommended to use. </p>\n"}, {"tags": ["c", "atof"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 2, "creation_date": 1537289737, "post_id": 52391330, "comment_id": 91727752, "body": "Search for GLIBC&#39;s repository. Also it is unclear what you need to do since you haven&#39;t posted your own code."}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 2, "creation_date": 1537289917, "post_id": 52391330, "comment_id": 91727826, "body": "You should post your implementation, hard to help you without seeing that"}, {"owner": {"reputation": 129, "user_id": 10381509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a97f06b0d3d68e3f7b4efbc2b4fb4b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10381509/john"}, "edited": false, "score": 0, "creation_date": 1537289968, "post_id": 52391330, "comment_id": 91727850, "body": "I cannot copy paste my code here . Please help me ."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537289976, "post_id": 52391330, "comment_id": 91727854, "body": "Perhaps you are performing multiple operations on a <code>double</code> variable, which rarely stores an <i>exact</i> representation of the value, and so the error gets worse with each operation."}, {"owner": {"reputation": 129, "user_id": 10381509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a97f06b0d3d68e3f7b4efbc2b4fb4b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10381509/john"}, "edited": false, "score": 0, "creation_date": 1537290089, "post_id": 52391330, "comment_id": 91727897, "body": "<a href=\"https://ideone.com/e6i8M0\" rel=\"nofollow noreferrer\">ideone.com/e6i8M0</a>"}, {"owner": {"reputation": 129, "user_id": 10381509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a97f06b0d3d68e3f7b4efbc2b4fb4b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10381509/john"}, "edited": false, "score": 0, "creation_date": 1537290131, "post_id": 52391330, "comment_id": 91727920, "body": "I have given my implementation here ."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537290153, "post_id": 52391330, "comment_id": 91727935, "body": "@WeatherVane I bet he has a <code>pow(10,...</code> in a loop there :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1537290166, "post_id": 52391330, "comment_id": 91727941, "body": "<code>atof</code> returns a <code>double</code> value but you are working with <code>float</code>."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1537290168, "post_id": 52391330, "comment_id": 91727943, "body": "atof() is non-standard, consider strtof()."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1537290227, "post_id": 52391330, "comment_id": 91727971, "body": "@P__J__ right you are!"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 3, "creation_date": 1537290336, "post_id": 52391330, "comment_id": 91728033, "body": "What you&#39;re trying to do is actually a very hard problem, not an introductory programming exercise."}, {"owner": {"reputation": 129, "user_id": 10381509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a97f06b0d3d68e3f7b4efbc2b4fb4b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10381509/john"}, "edited": false, "score": 0, "creation_date": 1537290420, "post_id": 52391330, "comment_id": 91728067, "body": "Thank you everyone . Is there a link to the library implementation of atof so that I can learn more ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537290447, "post_id": 52391330, "comment_id": 91728077, "body": "@John for future reference you can add your code by pasting it into the question (note the &quot;edit&quot; link underneath) and then &quot;select&quot; all the code and click the formatting button labelled <code>{}</code>."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1537290820, "post_id": 52391330, "comment_id": 91728246, "body": "@John: Mine in musl libc is here: <a href=\"https://git.musl-libc.org/cgit/musl/tree/src/internal/floatscan.c?id=v1.1.20#n66\" rel=\"nofollow noreferrer\">git.musl-libc.org/cgit/musl/tree/src/internal/&hellip;</a> (link is to start of the decimal case, which is the interesting part). It&#39;s <b>dense</b> code, but self-contained, no external bignum libraries or anything."}, {"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 1, "creation_date": 1537291185, "post_id": 52391330, "comment_id": 91728387, "body": "Are you sure?  I don&#39;t think 1236.965 can be exactly represented in a C float (IEEE 754 32-bit - binary32) value, a quick check shows 1236.9649658203125 is the actual (closest) value that can be represented in that format.  Using this value makes sense why you see 1236.964966 (when round to 6 decimal places),  Check out this link and try it for yourself: <a href=\"https://baseconvert.com/ieee-754-floating-point\" rel=\"nofollow noreferrer\">baseconvert.com/ieee-754-floating-point</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537295382, "post_id": 52391330, "comment_id": 91730318, "body": "In <a href=\"https://stackoverflow.com/a/51304463/298225\">this answer</a>, I provided C++ code to convert any simple decimal numeral to binary floating-point correctly with round-to-nearest-ties-to-even. It is intended to demonstrate how the mathematics may be performed with elementary-school arithmetic; it is not intended for production use. This code handles only only numerals with decimal digits and a decimal point; it does not handle scientific notation. For complete production code, a good understanding of floating-point arithmetic is required first. After that, the classic paper is\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537295400, "post_id": 52391330, "comment_id": 91730325, "body": "\u2026 <a href=\"http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.31.4049\" rel=\"nofollow noreferrer\"><i>Correctly Rounded Binary-Decimal and Decimal-Binary Conversions</i></a> by David M. Gay. There is currently a copy <a href=\"https://ampl.com/REFS/rounding.pdf\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1537296366, "post_id": 52391330, "comment_id": 91730743, "body": "@HansPassant <a href=\"https://stackoverflow.com/questions/52391330/create-a-precise-atof-implementation-in-c/52392540?noredirect=1#comment91727943_52391330\">atof() is non-standard</a>  --&gt; C11 specifies it C11 7.22.1.1.  Using <code>strtof()</code> has advantages, but both are specified in the C standard library."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537299427, "post_id": 52391330, "comment_id": 91732154, "body": "@eric: there&#39;s not much point pasting a link to a deleted answer. You and I can see it but people below the <a href=\"https://stackoverflow.com/help/privileges/moderator-tools\">moderator-tools</a> privilege threshold (10k rep)  just get a generic &quot;that question has been deleted&quot; page."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1537301729, "post_id": 52391330, "comment_id": 91733083, "body": "@rici: It is the best link available at the moment. I already retrieved the code and plan to extend it to support scientific notation. After that, I expect to post it as a new answer to a suitable question."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537303557, "post_id": 52391330, "comment_id": 91733839, "body": "@eric: that seems fine but perhaps it would be better to not even bother with the link for now, since the person to whom the comment is directed can&#39;t follow it. If it were me, I&#39;d find it annoyingly frustrating so it&#39;s hard to imagine that it fits into SO&#39;s &quot;welcome newcomers&quot; policy. Anyway, hopefully this interchange serves as some kind of explanation for the OP."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 3, "creation_date": 1537291293, "post_id": 52391666, "comment_id": 91728440, "body": "The value OP is testing is sufficiently short that a naive implementation will probably give the right result. Your answer is helpful identifying one problem, but doesn&#39;t address that there are much deeper issues which are not really OP&#39;s fault but a matter of this being a deceptively hard problem."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537291991, "post_id": 52391666, "comment_id": 91728741, "body": "Floating point numbers are tricky to work with. See <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a>, <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">The Floating Point Gui.de</a>, <a href=\"https://stackoverflow.com/questions/21895756/why-are-floating-point-numbers-inaccurate\">Why Are Floating Point Numbers Inaccurate</a>, <a href=\"https://docs.python.org/2/tutorial/floatingpoint.html\" rel=\"nofollow noreferrer\">Floating-Point Numbers: Issues and Limitations</a>, and <a href=\"https://msdn.microsoft.com/en-us/library/c151dt3s.aspx\" rel=\"nofollow noreferrer\">Why Floating-Point Numbers May Lose Precision</a>."}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": true, "score": 3, "last_activity_date": 1537347840, "last_edit_date": 1537347840, "creation_date": 1537291166, "answer_id": 52391666, "question_id": 52391330, "link": "https://stackoverflow.com/questions/52391330/create-a-precise-atof-implementation-in-c/52391666#52391666", "title": "Create a precise atof() implementation in c", "body": "<p>Change all your floats to doubles. When I tested it, that gave the same result as the library function <code>atof</code> for your test case.</p>\n\n<p><code>atof</code> returns double, not float. Remember that it actually is double and not float that is the \"normal\" floating-point type in C. A floating-point literal, such as <code>3.14</code>, is of type double, and library functions such as <code>sin</code>, <code>log</code> and (the perhaps deceptively named) <code>atof</code> work with doubles.</p>\n\n<p>It will still not be \"precise\", though. The closest you can get to 1236.965 as a float is (exactly) 1236.9649658203125, and as a double 1236.964999999999918145476840436458587646484375, which will be rounded to 1236.965000 by printf. No matter how many bits you have in a binary floating-point number, 1236.965 can't be exactly represented, similar to how 1/3 can't be exactly represented with a finite number of decimal digits: 0.3333333333333333...</p>\n\n<p>And also, as seen in the discussion in comments, this is a hard problem, with many possible pitfalls if you want code that will always give the closest value.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1537295582, "post_id": 52392540, "comment_id": 91730402, "body": "<a href=\"https://stackoverflow.com/a/51304463/298225\">Actually, it is pretty easy. It can be done with techniques taught in elementary school.</a> Doing it fast with constant memory (given fixed precision and exponent range) is harder."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537295873, "post_id": 52392540, "comment_id": 91730540, "body": "@EricPostpischil Yes, this goal is easier with relaxed precision requirements.  With no relaxation, a singular challenging case area for &quot;best&quot; result is when <code>char *s</code> is a value <i>nearly exactly</i> half-way between <code>TRUE_MIN</code> and <code>TRUE_MIN</code>*2.  That takes a lot of  precision to know to round up or down - I suspect about worst case."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537296262, "post_id": 52392540, "comment_id": 91730692, "body": "There are no relaxed precision requirements. By \u201cfixed precision and exponent range\u201d in the previous comment, I meant that the constant memory requirement may require preparing tables in advance, using knowledge of the precision and exponent range of the target format. The code I point to has no limits on the input size or precision and produces a <b>correctly rounded result</b> for the target format. It handles all the near-the-midpoint cases correctly. Again, this requires only elementary-school arithmetic."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537297231, "post_id": 52392540, "comment_id": 91731143, "body": "@EricPostpischil My prior comment was not meant to imply anything about the linked content, just the raw comment. OP does have relaxed precision requirements with only seeking &quot;more &#39;correct&#39;&quot; and not &quot;correct&quot;. OP appears to tolerate some level of not best (incorrect) results.  Yes the math is elementary,"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537299473, "post_id": 52392540, "comment_id": 91732185, "body": "@EricPostpischil In review of your <a href=\"https://stackoverflow.com/a/51304463/298225\">linked answer</a>, it does nicely  well handle the non-exponential strings for <code>atof()</code>, like OP&#39;s <code>float_to_str()</code> aims to do. I&#39;d UV it had the question not been deleted.  Top bad - it is quite informative - good for CR.  Yet C&#39;s more &quot;correct&quot; <code>atof()&#47;strtod()&#47;etc.</code> do handle exponential represented strings and that obliges a wider (though not unlimited)  precision for power and multiply code.  Something hard to do well, even for someone past learner  levels."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537301130, "post_id": 52392540, "comment_id": 91732834, "body": "@EricPostpischil <code>bool RoundUp = Bits[Round] &amp;&amp; (Bits[LowBit] || Bits[Sticky]);</code> in <code>GetValue()</code> is unclear to me if that is correct when the final result in a sub-normal.  I&#39;d expect that  bits used to determine rounding would depend on <code>Exponent</code> in that region."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537301833, "post_id": 52392540, "comment_id": 91733131, "body": "I was thinking about exponential notation. I think it can be handled just by adjusting where the decimal point is, inserting virtual zeros if needed. So I am going to modify the code for that and post a new version in the future. I will look at the rounding for subnormals."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1537302174, "post_id": 52392540, "comment_id": 91733294, "body": "Note that <code>PushBitLow</code> clamps at the lower exponent bound\u2014above that, it treats leading zeros as non-signfiicant digits. Once the minimum exponent is reached, zeros become significant digits. So the clock starts ticking on how many bits there are in a significand, which I think puts the rounding and sticky bits for subnormals in the right position. I will look further."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1537300002, "last_edit_date": 1537300002, "creation_date": 1537295012, "answer_id": 52392540, "question_id": 52391330, "link": "https://stackoverflow.com/questions/52391330/create-a-precise-atof-implementation-in-c/52392540#52392540", "title": "Create a precise atof() implementation in c", "body": "<blockquote>\n  <p>how to make the user defined atof() implementation more 'correct' ?</p>\n</blockquote>\n\n<p>Easy: 1) never overflow intermediate calculation and 2) only round once (at the end).</p>\n\n<p>It is <strong>hard</strong> to do those 2 steps.</p>\n\n<p>Note: C's <code>atof()</code>, <code>strtof()</code>, etc. also handle exponential notation - in decimal and hex.</p>\n\n<hr>\n\n<p>Potential roundings</p>\n\n<pre><code>val*10\n(val*10)+(c-'0');\npow(10,j)\nval*pow(10,j)  // This last multiplication is the only tolerable one.\n</code></pre>\n\n<p>Potential overflow (even though the final answer is within range)</p>\n\n<pre><code>val*10\n(val*10)+(c-'0');\npow(10,j)\n</code></pre>\n\n<p>Using a wider type like <code>double</code> can greatly lessen the occurrence of such problems and achieve OP's \"more 'correct'\".  <em>Yet they still exist.</em></p>\n\n<p>This is <strong>not an easy problem</strong> to solved to get the best (correct) floating point result from all string inputs.</p>\n\n<hr>\n\n<p>Sample approaches to solve.  </p>\n\n<p>Avoid overflow: rather than <code>pow(10,j)</code>:</p>\n\n<pre><code>val = val*pow(5,j);  // rounds, `pow(5,j)` not expected to overflow a finite final result.\nval = val*pow(2,j);  // Does not round except at extremes\n</code></pre>\n\n<p>Code should form <code>(ival*10)+(c-'0')</code> using extended integer math in the loop for exactness.</p>\n\n<p>Yet this is just scratching the surface of the many corner cases.</p>\n\n<hr>\n\n<p><a href=\"https://stackoverflow.com/a/51304463/298225\">@Eric Postpischil</a> commented on a robust C++ code that handles non-exponential notation string input well.  It does initial math using integers and only rounds later in the process.  This linked code  is not visible unless your rep is 10,000+ as the question was deleted.</p>\n"}], "owner": {"reputation": 129, "user_id": 10381509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a97f06b0d3d68e3f7b4efbc2b4fb4b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10381509/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2696, "favorite_count": 1, "accepted_answer_id": 52391666, "answer_count": 2, "score": -1, "last_activity_date": 1537347840, "creation_date": 1537289599, "last_edit_date": 1537290117, "question_id": 52391330, "link": "https://stackoverflow.com/questions/52391330/create-a-precise-atof-implementation-in-c", "title": "Create a precise atof() implementation in c", "body": "<p>I have written an atof() implementation in c . I am facing rounding off errors in this implementation . So , putting in a test value of 1236.965 gives a result of 1236.964966 but the library atof() function reurns 1236.965000 . My question is , how to make the user defined atof() implementation more 'correct' ? </p>\n\n<p>Can the library definition of atof() be found somewhere ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nfloat str_to_float(char *);\nvoid float_to_str(float,char *);\n\nint main(){\n    int max_size;\n    float x;\n    char *arr;\n    printf(\"Enter max size of string : \");\n    scanf(\"%d\",&amp;max_size);\n    arr=malloc((max_size+1)*sizeof(char));\n    scanf(\"%s\",arr);\n    x=str_to_float(arr);\n    printf(\"%f\\n%f\",x,atof(arr));\n    return 0;\n}\n\nfloat str_to_float(char *arr){\n    int i,j,flag;\n    float val;\n    char c;\n    i=0;\n    j=0;\n    val=0;\n    flag=0;\n    while ((c = *(arr+i))!='\\0'){\n//      if ((c&lt;'0')||(c&gt;'9')) return 0;\n        if (c!='.'){\n            val =(val*10)+(c-'0');\n            if (flag == 1){\n                --j;\n            }\n        }\n        if (c=='.'){ if (flag == 1) return 0; flag=1;}\n        ++i;\n    }\n    val = val*pow(10,j);\n    return val;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char", "printf"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1537287909, "post_id": 52390791, "comment_id": 91726846, "body": "<code>strtok</code> returns <code>char*</code> so when you do <code>tok = strtok(line, &quot;,&quot;);</code> you are leaking the memory which is allocated to <code>tok</code> using <code>malloc</code> so don&#39;t allocate memory to <code>tok</code>."}, {"owner": {"reputation": 133, "user_id": 9790188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NqIWR.png?s=128&g=1", "display_name": "AC-5", "link": "https://stackoverflow.com/users/9790188/ac-5"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537288039, "post_id": 52390791, "comment_id": 91726910, "body": "@kiranBiradar Even after changing the definition of tok to: &quot;char * tok&quot;, it behaves the same way."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537288103, "post_id": 52390791, "comment_id": 91726943, "body": "Please refer to Daniel Pryden answer. My first comment just tells you the possible memory leak and doesn&#39;t solve your problem ."}], "answers": [{"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537288586, "post_id": 52390922, "comment_id": 91727209, "body": "You should also point out memory leak with <code>tok</code> pointer as a complete answer."}], "tags": [], "owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "is_accepted": true, "score": 1, "last_activity_date": 1537310139, "last_edit_date": 1537310139, "creation_date": 1537287948, "answer_id": 52390922, "question_id": 52390791, "link": "https://stackoverflow.com/questions/52390791/char-array-value-will-print-as-empty-unless-value-is-printed-when-assigned-c/52390922#52390922", "title": "Char array value will print as empty unless value is printed when assigned - C", "body": "<p><code>strtok</code> returns pointers to substrings of its input. So all your <code>tok</code> values are pointers to parts of <code>line</code>, which has automatic storage duration, and so the pointers in <code>stateCityZip</code> all become invalid once <code>zipToCity</code> returns.</p>\n\n<p>(Actually, if there is more than one line in the file, the <code>tok</code> pointers all become invalid as soon as you advance to the next line, as they now point into arbitrary substrings of the new line in the buffer.)</p>\n\n<p>Instead, you should use <code>strdup</code> to allocate a copy of the token as a new string, and save the pointer returned from <code>strdup</code> into <code>stateCityZip</code>.</p>\n\n<p>An important note: the strings allocated by <code>strdup</code> need to freed by <code>free</code>. If <code>stateCityZip</code> is global then you can get away with not freeing them (the last memory will be freed when your process exits). But if <code>zipToCity</code> ever gets called again, it will overwrite the pointers in <code>stateCityZip</code> and leak the corresponding strings. So it would probably be safest to first <code>free()</code> any strings in <code>stateCityZip</code> (if they're NULL, then that's fine, as <code>free(NULL)</code> is a no-op) before assigning new values.</p>\n\n<p>On the subject of memory allocation: your example code has a <code>malloc</code> call for <code>tok</code> which is completely superfluous, and which is guaranteed to leak, since you overwrite the pointer returned from <code>malloc</code> without ever <code>free</code>ing it.</p>\n\n<p>And, on the subject of good coding practice: <code>fopen</code> can fail. You need to check that the returned <code>FILE *</code> is not NULL. (If it is NULL, <code>errno</code> will tell you why.) And you also need to <code>fclose</code> the <code>FILE *</code>, which you don't appear to be doing either.</p>\n\n<p>More generally: none of this code appears to be doing any error checking at all. Every time you call <em>any</em> standard library function (or any function at all, for that matter!) you need to think about how that function could fail to do what it's supposed to do, how you would be able to tell (usually failure behavior is well documented, so make sure to read the docs), and what you want your program to do if it fails. What should happen if the file doesn't exist or can't be read? If it contains a line that isn't comma-delimited, or doesn't contain the expected number of fields? What should happen if you run out of memory halfway through processing the file, or if <code>strdup</code> isn't able to copy the string because you're out of heap memory? If you don't think about these problems, or forget to deal with them, you might get away with it in the \"happy case\" where everything works, but sooner or later it will come back and bite you -- often at the worst possible time.</p>\n"}], "owner": {"reputation": 133, "user_id": 9790188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NqIWR.png?s=128&g=1", "display_name": "AC-5", "link": "https://stackoverflow.com/users/9790188/ac-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 52390922, "answer_count": 1, "score": 0, "last_activity_date": 1537310139, "creation_date": 1537287513, "question_id": 52390791, "link": "https://stackoverflow.com/questions/52390791/char-array-value-will-print-as-empty-unless-value-is-printed-when-assigned-c", "title": "Char array value will print as empty unless value is printed when assigned - C", "body": "<p>I am working with two functions in my c program and am having trouble getting them to cooperate.  My first function iterates through a csv file and uses strtok() to separate tokens based on the ',' delimiter.  Each token is saved into a character array of size 3 and if a particular token does not match the goal token, the next line of input is read, tokenized, and the character array is overwritten with the new input tokens.</p>\n\n<p>Here is the global variable used:</p>\n\n<pre><code>char * stateCityZip[3];\n</code></pre>\n\n<p>Here is the code for the first function:</p>\n\n<pre><code>int zipToCity(char * zip)\n{\nchar line[1024];\nchar * tok = malloc(20 * sizeof(char));\nFILE * file = fopen(\"cityzip.csv\", \"r\");\nwhile (fgets(line, sizeof(line), file))\n{\n    //State\n    tok = strtok(line, \",\");\n    stateCityZip[0] = tok;\n    //City\n    tok = strtok(NULL, \",\");\n    stateCityZip[1] = tok;\n    //Zip\n    tok = strtok(NULL, \",\");\n    stateCityZip[2] = tok;\n\n    if (strcmp(stateCityZip[2], newZip) == 0) {\n        //printf(\"Found %s, %s\\n\", stateCityZip[0], stateCityZip[1]);\n        strlen(stateCityZip[1]));\n        return 1;\n    }\n}\nreturn 0;\n}\n</code></pre>\n\n<p>My second function is simply trying to print the values of stateCityZip.  When I print these values, however, they appear as blank.  The only way to fix this I'v found is to uncomment the </p>\n\n<pre><code>//printf(\"Found %s, %s\\n\", stateCityZip[0], stateCityZip[1]);\n</code></pre>\n\n<p>line.</p>\n\n<p>Here is the code for my second function:</p>\n\n<pre><code>int main() {\n    printf(\"City: [%s]\", stateCityZip[1]);\n    printf(\"State: [%s]\", stateCityZip[0]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>City: []\nState: []\n</code></pre>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1537289078, "post_id": 52390526, "comment_id": 91727456, "body": "What level of OpenMP conformance do you have?  You can write a custom reduction if you have OpenMP 4.0 or newer, I think.  (Obviously you&#39;d need to combine <code>x</code>, <code>y</code>, and <code>z</code> into a single struct to pass to the reduction)."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 2, "creation_date": 1537289407, "post_id": 52390526, "comment_id": 91727611, "body": "There are some older questions regarding argmin, but given the three values and outdated answers I am not closing as duplicate. <a href=\"https://stackoverflow.com/questions/24782038/omp-max-reduction-with-storage-of-index\" title=\"omp max reduction with storage of index\">stackoverflow.com/questions/24782038/&hellip;</a> <a href=\"https://stackoverflow.com/questions/20618258/how-to-implement-argmax-with-openmp\" title=\"how to implement argmax with openmp\">stackoverflow.com/questions/20618258/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 748, "user_id": 505047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b89b03ffaeb3ee9dd974edc0a3d7dfcd?s=128&d=identicon&r=PG", "display_name": "iluvatar", "link": "https://stackoverflow.com/users/505047/iluvatar"}, "edited": false, "score": 1, "creation_date": 1537301776, "post_id": 52391259, "comment_id": 91733102, "body": "Excellent. This is what I was looking for. I did not know about omp declare reduction. I just had to fix the parallel for since it should read reduction(xyz_min:value). Also, for some reason, I had to use omp_priv={0, 0, DBL_MAX} (only one brace). Thanks again."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 6, "last_activity_date": 1537305599, "last_edit_date": 1537305599, "creation_date": 1537289329, "answer_id": 52391259, "question_id": 52390526, "link": "https://stackoverflow.com/questions/52390526/openmp-argmin-reduction-for-multiple-values/52391259#52391259", "title": "OpenMP argmin reduction for multiple values", "body": "<hr>\n\n<p>You can implement an <em>argmin</em> for multiple values using user defined reduction (available since OpenMP 4.0). For that you have to put the triple in one type. It is helpful to define a convenience function.</p>\n\n<pre><code>struct xyz {\n    double x; double y; double z;\n}\n\nstruct xyz xyz_min2(struct xyz a, struct xyz b) {\n    return a.z &lt; b.z ? a : b; \n}\n\n#pragma omp declare reduction(xyz_min: struct xyz: omp_out=xyz_min2(omp_out, omp_in))\\\n    initializer(omp_priv={0, 0, DBL_MAX})\n\nstruct xyz value = {0, 0, DBL_MAX};\n#pragma omp parallel for reduction(xyz_min:value)\nfor (int trial = 0; trial &lt; NTRIALS; ++trial) {\n    struct xyz new_value = ...;\n    value = xyz_min2(value, new_value);\n}\n</code></pre>\n"}], "owner": {"reputation": 748, "user_id": 505047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b89b03ffaeb3ee9dd974edc0a3d7dfcd?s=128&d=identicon&r=PG", "display_name": "iluvatar", "link": "https://stackoverflow.com/users/505047/iluvatar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 52391259, "answer_count": 1, "score": 2, "last_activity_date": 1537305599, "creation_date": 1537286426, "last_edit_date": 1537288638, "question_id": 52390526, "link": "https://stackoverflow.com/questions/52390526/openmp-argmin-reduction-for-multiple-values", "title": "OpenMP argmin reduction for multiple values", "body": "<p>I have a routine that uses a loop to compute the minimum height of a particle given a surface of particles beneath. This routine tries random positions and compute the minimum height and then returns the <code>x, y, z</code> values, where <code>z</code> is the minimum height found. </p>\n\n<p>This routine can be parallelized with <code>omp parallel for</code>. But I am having problems figuring out how to get the triplet <code>(x, y, z)</code>, not just the minimum <code>z</code> (because the minimum <code>z</code> of course corresponds to a given <code>x, y</code> coordinates). I can actually get the smallest <code>z</code> by using a reduction operation as follows</p>\n\n<pre><code>double x = 0, y = 0, z = 1.0e300; // initially z is large\n#pragma omp parallel for reduction(min:z)\nfor(int trial = 0; trial &lt; NTRIALS; ++trial) {\n    // long routine that, at the end, computes x, y, z \n    // and selects only the x, y, z corresponding to the \n    // smallest z\n}\n</code></pre>\n\n<p>But I cannot get the corresponding <code>x</code> and <code>y</code>. At the end I just end up with a random <code>x</code> and <code>y</code> written by one of the threads. </p>\n\n<p>Is it possible to get also those values? How? I was thinking on having an array where each thread stores their value of <code>x, y, zmin</code> and then, after the reduction operation, compare each thread <code>zmin</code> with the reduced global value and then get those that correspond to the choosing one. Is there a better way in the sense that OpenMP does it so I don't need to define this dynamic array and compare floats?</p>\n"}, {"tags": ["c++", "c", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1537286158, "post_id": 52390404, "comment_id": 91725913, "body": "No, the next pointer of the (new) last node should remain at NULL."}, {"owner": {"reputation": 37, "user_id": 5677332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cb2483272feae4f9edd95e9e02f043?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Guy", "link": "https://stackoverflow.com/users/5677332/anonymous-guy"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1537286216, "post_id": 52390404, "comment_id": 91725951, "body": "Indeed, thanks. I figured it out when I posted the question."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537286271, "post_id": 52390404, "comment_id": 91725992, "body": "to point the last node?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1537286279, "post_id": 52390404, "comment_id": 91726000, "body": "This sets the new end-of-list so that if <code>Insert_End</code> is called again, the new node goes in the right spot."}, {"owner": {"reputation": 37, "user_id": 5677332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cb2483272feae4f9edd95e9e02f043?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Guy", "link": "https://stackoverflow.com/users/5677332/anonymous-guy"}, "edited": false, "score": 0, "creation_date": 1537286379, "post_id": 52390404, "comment_id": 91726059, "body": "Ohk thanks! (My previous comment got deleted accidentally... If someone from future is here, I asked about the last line&#39;s role)"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1537286387, "creation_date": 1537286387, "answer_id": 52390515, "question_id": 52390404, "link": "https://stackoverflow.com/questions/52390404/linked-list-insert-at-end-using-a-rear-pointer/52390515#52390515", "title": "Linked list - Insert at end using a rear pointer", "body": "<blockquote>\n  <p>My question is shouldn't it be np -> next = rear;</p>\n</blockquote>\n\n<p>No, because then no node would be pointing to <code>np</code>, and therefore it wouldn't be part of any list (other than the list whose head is <code>np</code>). Furthermore, <code>np</code> wouldn't be at the rear, since its <code>next</code> would be pointing at a node (the node that was <code>rear</code> previously). The example is a correct implementation.</p>\n"}, {"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1537288142, "post_id": 52390663, "comment_id": 91726965, "body": "Nice ASCII art.  IMHO, linked lists should always be drawn when debugging."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 3, "last_activity_date": 1537287421, "last_edit_date": 1537287421, "creation_date": 1537286991, "answer_id": 52390663, "question_id": 52390404, "link": "https://stackoverflow.com/questions/52390404/linked-list-insert-at-end-using-a-rear-pointer/52390663#52390663", "title": "Linked list - Insert at end using a rear pointer", "body": "<blockquote>\n  <p>My question is shouldn't it be np -> next = rear;</p>\n</blockquote>\n\n<p>No,following pictures may help you understand easily.</p>\n\n<p>When you do <code>start = rear = np;</code> for the first time all the 3 nodes may look like below.</p>\n\n<pre><code>  ------\n  |  np  |\n   ------\n  ^      ^\n  |       |\n ----      ----\n|start|   | rear|\n ----      ----\n</code></pre>\n\n<p>for the successive insertion:</p>\n\n<p>when you do         <code>rear -&gt; next = np;</code> your list may look like below.</p>\n\n<p><em>note: <code>rear</code> is still pointing to previous last node of the list and <code>np1</code> is pointing to <code>np2</code>.</em></p>\n\n<pre><code>  ------         -----\n  |  np1 | ---&gt; | np2 |\n   ------        -----\n  ^       ^\n  |       |\n ----      ----\n|start|   | rear|\n ----      ----\n</code></pre>\n\n<p>when you do         <code>rear = np;</code> your <code>rear</code> gets updated to point current last node.</p>\n\n<pre><code>  ------         -----\n  |  np1 | ---&gt; | np2 |\n   ------        -----\n  ^              ^\n  |              |\n ----           ----\n|start|        | rear|\n ----           ----\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5677332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cb2483272feae4f9edd95e9e02f043?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Guy", "link": "https://stackoverflow.com/users/5677332/anonymous-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 52390663, "answer_count": 2, "score": 0, "last_activity_date": 1537287421, "creation_date": 1537286008, "last_edit_date": 1537286531, "question_id": 52390404, "link": "https://stackoverflow.com/questions/52390404/linked-list-insert-at-end-using-a-rear-pointer", "title": "Linked list - Insert at end using a rear pointer", "body": "<p>I'm learning about linked list insertions and encountered the following code to insert a node at the end of a linked list (in a rather old and obsolete book for C++ still used I don't know why):</p>\n\n<pre><code>void Insert_End(Node * np){\n    if (start == NULL){\n        start = rear = np;\n    }\n    else{\n        rear -&gt; next = np;\n        rear = np;\n    }\n}\n</code></pre>\n\n<p>My question is shouldn't it be\n    np -> next = rear;</p>\n\n<p>PS : np is the new node being inserted at the end, rear points to the last node, start points to the first node.</p>\n"}, {"tags": ["c", "arrays", "x86", "simd", "bucket-sort"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1537289691, "post_id": 52389997, "comment_id": 91727733, "body": "Scattered stores - you&#39;ll need AVX-512 for that. It probably won&#39;t be super-efficient either."}, {"owner": {"reputation": 2156, "user_id": 1424454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/f304bc91f7ee1b184e08d1493eb578e6?s=128&d=identicon&r=PG", "display_name": "Verdagon", "link": "https://stackoverflow.com/users/1424454/verdagon"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1537290527, "post_id": 52389997, "comment_id": 91728118, "body": "Thanks for the lead, thats super interesting! After some reading, it looks like scattered stores can store a bunch of numbers to a bunch of corresponding pointers. How would I map from these numbers (0x00-0x03) to pointers? Also, why wouldn&#39;t it be efficient?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1537303760, "post_id": 52389997, "comment_id": 91733906, "body": "Because scatter stores will still bottleneck on cache misses, or if not are still limited to 1 element per clock like regular stores.  Scatter instructions also decode to a lot of uops (more than gather loads), so they cost front-end throughput.  You also have to detect conflicts (when multiple elements in a vector will go to the same bucket, you need to write them to sequential addresses, not stepping on each other, and you have to increment the per-bucket position counters by the right amounts.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1537303798, "post_id": 52389997, "comment_id": 91733924, "body": "So that&#39;s a lot of extra work that a SIMD version has to do compared to doing 1 element at a time.  Maybe with efficient <code>vpconflictd</code> (e.g. on KNL but not Skylake-avx512) you can come out ahead.  This is similar to a histogram problem (where you&#39;re incrementing an array of per-bucket counters), but harder because you have to actually still preserve each element."}, {"owner": {"reputation": 2156, "user_id": 1424454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/f304bc91f7ee1b184e08d1493eb578e6?s=128&d=identicon&r=PG", "display_name": "Verdagon", "link": "https://stackoverflow.com/users/1424454/verdagon"}, "edited": false, "score": 0, "creation_date": 1537313344, "post_id": 52389997, "comment_id": 91736717, "body": "Thanks for all this information, I super appreciate it! I was also wondering about this conflict situation, sounds like vpconflictd is the closest we can get. I&#39;ll do some reading up on the histogram problem, thanks for the lead!"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537319714, "post_id": 52396540, "comment_id": 91737914, "body": "Yeah, filter and left-packing should work well for 2, 3 or 4 buckets, if you can efficiently left-pack.  A cache-blocked multi-step approach for 4..16 buckets could be good, but copying the data around too many times will stop being worth it at some point.  Cache locality (only 2 to 4 output streams) does help the multi-step left-pack vs. a one-pass histogram of pointers.  I thought of the start of this idea while commenting on the question, but I think rejected it because I was imagining more buckets and didn&#39;t think of the multi-pass idea."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537320002, "post_id": 52396540, "comment_id": 91737974, "body": "Vertical per-element sort with packed min/max instructions can&#39;t rule out having an element for a low bucket in the most &quot;max&quot; vector.  So I don&#39;t think it saves you any work, but it might lead to better cache behaviour if you&#39;re usually doing bigger blocks of stores before touching other cache lines.  You might <code>pcmpgtd</code> / <code>pmovmskb</code> / <code>test+jcc</code> to skip the left-pack / store for the low buckets on a vector that <i>usually</i> doesn&#39;t have any elements for the low buckets, though.  (Or <code>ptest</code>/<code>jcc</code> with a mask that checks for high bits of all elements being all-zero.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537320227, "post_id": 52396540, "comment_id": 91738020, "body": "Oh, I just looked at the question again, I didn&#39;t realize how few buckets they were using.  Yeah one-step left-pack should be great.  I&#39;d probably go with 128-bit vectors for efficient left-packing because AVX2 doesn&#39;t have a lane-crossing 16-bit-element shuffle, so you need <code>pshufb</code>.  And there&#39;s no <code>vpcompressw</code>.  Hmm, unpacking to 32-bit elements might be a win here, especially with AVX512."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537322276, "post_id": 52396540, "comment_id": 91738441, "body": "I don&#39;t know what the limiting factor is without writing it all out, but it seems likely that 256-bit vectors could still be a win: especially if you can do the <code>pshufb</code> all at once with a single LUT entry that spans both lanes. Then you only have to break out the stores separately. About the vertical sort: yes you can&#39;t rule anything out, but as you suggest you can probabilistically skip many of the operations, or you can record which elements are out of place and then handle them in a different way (e.g., a scalar fixup step after you&#39;ve done the &quot;most common&quot; entry type in a SIMD loop)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537323282, "post_id": 52396540, "comment_id": 91738673, "body": "A 256-bit <code>vpshufb</code> to left-pack the 2 lanes separately still needs separate <code>popcnt</code> after splitting up the <code>vpmovmskb</code> result, and needs one wide shuffle-control vector.  I guess you can load / <code>vinserti128</code> the two halves of the shuffle mask, after you generate them separately with BMI2 <code>pdep</code>, or from a 256 * 16-byte LUT (yuck), or 256 * 8-byte LUT with <code>vpmovzxbw</code> or load + <code>vpunpcklbw</code> to repeat every byte, and <code>vpaddb</code>  to get the n, n+1 pair of indices.  Yeah maybe 256 * 16 = 4096 bytes for a LUT is a better bet, if this will be used repeatedly."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537325645, "post_id": 52396540, "comment_id": 91739148, "body": "@PeterCordes - yeah I&#39;ve tried to think of good ways to shuffle the two lanes so they can be handled efficiently &quot;as a unit&quot; as much as possible: e.g., shuffling them in opposite directions (low half to the right and high half to the left) so they &quot;meet in the middle&quot; of the vector - but then how do you store that? Or doing a lane-crossing shuffle so that you get all your elements contiguous (i.e., fill up one late entirely if the original vector was more than half full), but that seems also awkward here since there is no variable mask <code>vpermw</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1537325729, "post_id": 52396540, "comment_id": 91739168, "body": "Since we don&#39;t need to preserve order in this case (the requirement is weaker than a true &quot;filter&quot; or &quot;compress&quot; operation), <code>vpermd</code> actually seems to work for lots of configuration since you can swap &quot;full&quot; DWORDs from on lane into the other to try to fill it and make things contiguous, but some cases don&#39;t work (like 5 and 3 elements) and anyways it seems expensive. Maybe the lack of order presevation could also lead to a simplification in the LUT or other approach, but I&#39;m not seeing it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1537326232, "post_id": 52396540, "comment_id": 91739278, "body": "<a href=\"http://felixcloutier.com/x86/VPERMD:VPERMW.html\" rel=\"nofollow noreferrer\">AVX512BW <code>vpermw</code></a> is variable-mask, but costs multiple uops on SKX.  Interesting point about not preserving order, that does allow for unpack to dword, filter/left-pack, and then pack two results with in-lane <code>vpackusdw</code> or something.  Also, agreed that the OP should store the category bytes separately from the data bytes.  Sub-dword operations might as well be byte ops, unless you have AVX512BW."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537326385, "post_id": 52396540, "comment_id": 91739309, "body": "@PeterCordes - yes, but one problem is that the LUTs grow really big when you pack twice the number of elements in each vector. So using a full 256-bit wide LUT might not be an option. Perhaps generating the shuffle mask by hand using whatever tricks could work. Maybe there is also a hybrid strategy lurking out there with a smaller LUT and some ALU ops..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537326586, "post_id": 52396540, "comment_id": 91739341, "body": "Right, I was replying to the end of <a href=\"https://stackoverflow.com/questions/52389997/can-i-use-simd-to-bucket-sort-categorize/52396540?noredirect=1#comment91739148_52396540\">this comment</a> where you said &quot;there&#39;s no variable mask <code>vpermw</code>.  Maybe you meant &quot;in AVX2&quot;?  Definitely hard to use, and byte elements do actually make it harder to create masks.  So yeah, filtering them into buckets in the first place would be so much better."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1537329253, "post_id": 52396540, "comment_id": 91739811, "body": "@PeterCordes - maybe there was confusion, I wasn&#39;t disagreeing or even really referring to <code>vpermw</code> (and yes I meant in AVX2) there. I was just agreeing with you that you might as well use byte ops (in AVX2) and just saying that if you pack the payload bytes densely your LUTs will blow up. So it was about packing the payload bytes and how it might lead to to different techniques since the tradeoffs are different (you really do need byte-granular shuffles not just using byte-shuffles to shuffle WORD elements, so ... big LUTs)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1537330304, "post_id": 52396540, "comment_id": 91740036, "body": "You can always work in 8x1-byte chunks with a <code>movq</code> load / compare / <code>pmovmskb</code>.  Then you only need a 256 * 8-byte LUT, and can use it without any extra instruction to expand it.  Or <code>pdep</code>.  So denser packing doesn&#39;t <i>hurt</i>, it just might not help."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1537330515, "post_id": 52396540, "comment_id": 91740075, "body": "@PeterCordes - yes, for sure. Of course the doesn&#39;t hurt may not hold if you have to pre-process your data to get it like that, versus being able to generate it like that in the first place."}], "tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": true, "score": 3, "last_activity_date": 1537421653, "last_edit_date": 1537421653, "creation_date": 1537319031, "answer_id": 52396540, "question_id": 52389997, "link": "https://stackoverflow.com/questions/52389997/can-i-use-simd-to-bucket-sort-categorize/52396540#52396540", "title": "Can I use SIMD to bucket sort / categorize?", "body": "<p>You can do it with SIMD, but how fast it is will depend on exactly what instruction sets you have available, and how clever you are in your implementation. </p>\n\n<p>One approach is to take the array and \"sift\" it to separate out elements that belong in different buckets. For example, grab 32 bytes from your array which will have 16 16-bit elements. Use some <code>cmpgt</code> instructions to get a mask where which determines whether each element falls into the <code>00 + 01</code> bucket or the <code>02 + 03</code> bucket. Then use some kind of \"compress\" or \"filter\" operation to move all masked elements contiguously into one end a register and then same for the unmasked elements. </p>\n\n<p>Then repeat this one more time to sort out <code>00</code> from <code>01</code> and <code>02</code> from <code>03</code>.</p>\n\n<p>With AVX2 you could start with <a href=\"https://stackoverflow.com/q/36932240/149138\">this question</a> for inspiration on the \"compress\" operation. With AVX512 you could use the <code>vcompress</code> instruction to help out: it does exactly this operation but only at 32-bit or 64-bit granularity so you'd need to do a couple at least per vector.</p>\n\n<p>You could also try a vertical approach, where you load N vectors and then swap between them so that the 0th vector has the smallest elements, etc. At this point, you can use a more optimized algorithm for the compress stage (e.g,. if you vertically sort enough vectors, the vectors at the ends may be entirely starting with <code>0x00</code> etc).</p>\n\n<p>Finally, you might also consider organizing your data differently, either at the source or as a pre-processing step: separating out the \"category\" byte which is always 0-3 from the payload byte. Many of the processing steps only need to happen on one or the other, so you can potentially increase efficiency by splitting them out that way. For example, you could do the comparison operation on 32 bytes that are all categories, and then do the compress operation on the 32 payload bytes (at least in the final step where each category is unique). </p>\n\n<p>This would lead to arrays of byte elements, not 16-bit elements, where the \"category\" byte is implicit. You've cut your data size in half, which might speed up everything else you want to do with the data in the future.</p>\n\n<p>If you can't produce the source data in this format, you could use the bucketing as an opportunity to remove the tag byte as you put the payload into the right bucket, so the output is <code>uint8_t out[4][2048];</code>.  If you're doing a SIMD left-pack with a <code>pshufb</code> byte-shuffle as discussed in comments, you could choose a shuffle control vector that packs only the payload bytes into the low half.</p>\n\n<p>(Until AVX512BW, x86 SIMD doesn't have any variable-control word shuffles, only byte or dword, so you already needed a byte shuffle which can just as easily separate payloads from tags at the same time as packing payload bytes to the bottom.)</p>\n"}], "owner": {"reputation": 2156, "user_id": 1424454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/f304bc91f7ee1b184e08d1493eb578e6?s=128&d=identicon&r=PG", "display_name": "Verdagon", "link": "https://stackoverflow.com/users/1424454/verdagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 52396540, "answer_count": 1, "score": 2, "last_activity_date": 1537421653, "creation_date": 1537284540, "question_id": 52389997, "link": "https://stackoverflow.com/questions/52389997/can-i-use-simd-to-bucket-sort-categorize", "title": "Can I use SIMD to bucket sort / categorize?", "body": "<p>I'm curious about SIMD and wondering if it can handle this use case.</p>\n\n<p>Let's say I have an array of 2048 integers, like\n[0x018A, 0x004B, 0x01C0, 0x0234, 0x0098, 0x0343, 0x0222, 0x0301, 0x0398, 0x0087, 0x0167, 0x0389, 0x03F2, 0x0034, 0x0345, ...]</p>\n\n<p>Note how they all start with either 0x00, 0x01, 0x02, or 0x03. I want to split them into 4 arrays:</p>\n\n<ul>\n<li>One for all the integers starting with 0x00</li>\n<li>One for all the integers starting with 0x01</li>\n<li>One for all the integers starting with 0x02</li>\n<li>One for all the integers starting with 0x03</li>\n</ul>\n\n<p>I imagine I would have code like this:</p>\n\n<pre><code>int main() {\n   uint16_t in[2048] = ...;\n\n   // 4 arrays, one for each category\n   uint16_t out[4][2048];\n\n   // Pointers to the next available slot in each of the arrays\n   uint16_t *nextOut[4] = { out[0], out[1], out[2], out[3] };\n\n   for (uint16_t *nextIn = in; nextIn &lt; 2048; nextIn += 4) {\n\n       (*** magic simd instructions here ***)\n\n       // Equivalent non-simd code:\n       uint16_t categories[4];\n       for (int i = 0; i &lt; 4; i++) {\n           categories[i] = nextIn[i] &amp; 0xFF00;\n       }\n       for (int i = 0; i &lt; 4; i++) {\n           uint16_t category = categories[i];\n           *nextOut[category] = nextIn[i];\n           nextOut[category]++;\n       }\n   }\n   // Now I have my categoried arrays!\n}\n</code></pre>\n\n<p>I imagine that my first inner loop doesn't need SIMD, it can be just a <code>(x &amp; 0xFF00FF00FF00FF00)</code> instruction, but I wonder if we can make that second inner loop into a SIMD instruction.</p>\n\n<p>Is there any sort of SIMD instruction for this \"categorizing\" action that I'm doing?</p>\n\n<p>The \"insert\" instructions seem somewhat promising, but I'm a bit too green to understand the descriptions at <a href=\"https://software.intel.com/en-us/node/695331\" rel=\"nofollow noreferrer\">https://software.intel.com/en-us/node/695331</a>.</p>\n\n<p>If not, does anything come close?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "assembly", "sic"], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 0, "last_activity_date": 1537284551, "creation_date": 1537284551, "answer_id": 52389999, "question_id": 52389329, "link": "https://stackoverflow.com/questions/52389329/sic-xe-can-i-put-new-value-to-a-value-that-already-has-its-own-value/52389999#52389999", "title": "SIC/XE Can I put new value to a value that already has its own value?", "body": "<p>In the SIC code, <code>population</code> is not a variable. It is a name associated with an address.  The assembly code <code>population WORD 11778</code> tells the assembler to put the value 11778 in a word at the next location (in sequence as the assembler progresses through the assembly code) and to associate <code>population</code> with that address.</p>\n\n<p>Then the question is not whether you can assign a new value to <code>population</code> but whether you can store a new value to that location in memory. A brief look into SIC suggests it is a very simple computer model and there is no provision for read-only memory. In that case, yes, you can store a new value to the location of <code>population</code>.</p>\n\n<p>In typical assemblers used in production, rather than classroom exercises, there are provisions for preparing code and data in multiple <em>sections</em>. There could be one section for instructions, another section for read-only data, another section for modifiable data, and possibly other sections for special purposes. The assembler has directives for specifying which section the following lines are for. In such an assembler, if you defined data along with instructions, it would go into the code section, sometimes also called the text section. When programs are loaded, the code section is usually marked read-only. So data in such a section could not be modified after it is loaded. To have modifiable data, you would have to put it into a different section.</p>\n\n<p>SIC does not appear to support multiple sections like this. Presumably everything it assembles goes into one modifiable section.</p>\n"}], "owner": {"reputation": 85, "user_id": 10380884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nghUVb0PWgw/AAAAAAAAAAI/AAAAAAAACKw/Tg6HI3GXRk8/photo.jpg?sz=128", "display_name": "jamie 8910", "link": "https://stackoverflow.com/users/10380884/jamie-8910"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52389999, "answer_count": 1, "score": 0, "last_activity_date": 1587280178, "creation_date": 1537282367, "last_edit_date": 1587280178, "question_id": 52389329, "link": "https://stackoverflow.com/questions/52389329/sic-xe-can-i-put-new-value-to-a-value-that-already-has-its-own-value", "title": "SIC/XE Can I put new value to a value that already has its own value?", "body": "<p>Hi I'm taking a system software class on my uni and I'm making an assembly code with SIC. I've already written a code with C. So I'm translating it to SIC and I got a question about variable policy of SIC. \nCan I reuse population to store the calculated number? just like C variable? \nI think it's too basic so I couldn't get an answer when I googled it. \nThank you!</p>\n\n<pre><code>int main(void) {\n  double current_population = 11778;\n  int birth = 180;\n  int death= 120;\n  double immigrant = 53.333;\n  /*one day is 24 hours, so it's1440 minute\n    the value of birth and death, immigrant are based on a day. \n  */\n  for (int i = 0; i &lt; 7; i++) {\n    current_population = current_population + birth + immigrant - death;\n    printf(\"%d day\uc758 \uc778\uad6c : %d\\n\", i + 1,  (int)current_population);\n  }\n  return 0;\n}    \n</code></pre>\n\n<p>here is unfinished sic code (very rough) </p>\n\n<pre><code>            LDX   ZERO    \n            LDA   population\n            ADD   birth\n            SUB   death\n            ADD   immigrant\n            STA   population\npopulation  WORD  11778\nbirth       WORD  180\ndeath       WORD  120\nimmigrant   WORD  53\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1537282494, "post_id": 52389315, "comment_id": 91723592, "body": "You&#39;re not using the return value in case of <code>my_strcmp()</code> - how do you compare then?"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 1, "creation_date": 1537282506, "post_id": 52389315, "comment_id": 91723600, "body": "<code>my_strcpy</code> gets copies of the pointers, you would need to pass a <code>char **</code> if you want to modify the pointer in the function."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1537282543, "post_id": 52389315, "comment_id": 91723620, "body": "<i>&quot;proven wrong by debugger&quot;</i> - how exactly did you check? <code>dest</code> doesn&#39;t exist outside of <code>my_strcpy</code>, it cannot have a value there anymore"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1537282641, "post_id": 52389315, "comment_id": 91723682, "body": "C passes arguments <i>by value</i>, meaning the arguments in your functions are <i>copies</i>. Modifying a copy (like <code>dest++</code>) won&#39;t modify the original."}, {"owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1537283165, "post_id": 52389315, "comment_id": 91724031, "body": "@SouravGhosh i don&#39;t follow - i am not doing any kind of comparison. did you perhaps misread my functions&#39; names?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1537283226, "post_id": 52389315, "comment_id": 91724068, "body": "<code>dest</code> is a pointer that is passed to <code>my_strcpy()</code> by value.   Incrementing it within the function therefore does not affect the pointer passed.    Whatever is pointed to can be modified in a way visible to the caller, but the pointer itself that is passed cannot be.   Also, <code>my_strcpy(str2, str4)</code> gives undefined behaviour, since <code>str4</code> is longer than <code>str2</code>, and the function copies all of the data from <code>str4</code> to <code>str2</code> so runs past the end of the memory pointed to by <code>str2</code>."}, {"owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1537283258, "post_id": 52389315, "comment_id": 91724095, "body": "@Colin I was trying to use the same prototype as the original strcpy, which (AFAIK) gets char*"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "edited": false, "score": 0, "creation_date": 1537283722, "post_id": 52389542, "comment_id": 91724398, "body": "I have chosen this answer as correct because of the &quot;no rewind&quot; trick, also note <i>Some programmer dude</i> and <i>Peter</i> were saying the exact same thing and a bit earlier."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1537283409, "last_edit_date": 1537283409, "creation_date": 1537282997, "answer_id": 52389542, "question_id": 52389315, "link": "https://stackoverflow.com/questions/52389315/getting-correct-address-of-char/52389542#52389542", "title": "getting correct address of char*", "body": "<blockquote>\n  <p>Why did I have to \"rewind\" my pointer in the second function, but not\n  the first? Moreover, why didn't I had to \"rewind\" src and dest in the\n  first function</p>\n</blockquote>\n\n<p>It is because in <code>C</code> everything is pass-by-value.</p>\n\n<ol>\n<li><p>When we pass-by-value we are passing a copy of the variable to a function.</p></li>\n<li><p>When we pass-by-reference we are passing an alias of the variable to a function.\nIt is copying the value of the pointer, the address, into the function.</p></li>\n</ol>\n\n<p>Hence when you do <code>(*dest++ = *src++)</code> you are not incrementing the actual variables so your <code>str2</code> and  <code>str4</code> remains not effected.</p>\n\n<p>In case of <code>char* my_strcat(char *first, char *second)</code> you are returning local pointer which is pointing to last character in the concatenated string hence you need to rewind.</p>\n\n<p>If you don't want to rewind the pointer then just use one dummy pointer pointing to beginning of <code>tmp</code> and <code>return</code> the dummy pointer as below.</p>\n\n<pre><code>char* my_strcat(char *first, char *second){\n  int l_first = strlen(first), l_second = strlen(second);\n  char *tmp = malloc (l_first + l_second + 1);\n\n  char *result = temp;\n\n  while ((*tmp++ = *first++));\n  tmp--; // overwrite tmp's \"\\0\"\n  while ((*tmp++ = *second++)); // tmp value is end of char*\n\n  return result;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1537284519, "creation_date": 1537284519, "answer_id": 52389992, "question_id": 52389315, "link": "https://stackoverflow.com/questions/52389315/getting-correct-address-of-char/52389992#52389992", "title": "getting correct address of char*", "body": "<p>if you want the dest pointer to be changed you need to pass the reference to it:</p>\n\n<pre><code>char* my_strcat(const char **dest, const char *source){\n  size_t l_first = strlen(first), l_second = strlen(second);\n  char *tmp = malloc (l_first + l_second + 1);\n  char *result = temp;\n  const char *tmpdest = *dest;\n\n  if(tmp)\n  {\n      while ((*tmp++ = *tmpdest++));\n      tmp--; // overwrite tmp's \"\\0\"\n      while ((*tmp++ = *second++)); // tmp value is end of char*\n      *dest = result;\n  }\n  return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52389542, "answer_count": 2, "score": 0, "last_activity_date": 1537284519, "creation_date": 1537282311, "last_edit_date": 1537282659, "question_id": 52389315, "link": "https://stackoverflow.com/questions/52389315/getting-correct-address-of-char", "title": "getting correct address of char*", "body": "<p>I am trying to understand behavior of char* manipulation in C. \nHere is my driver code:</p>\n\n<pre><code>char *str1 = malloc(30);\nchar *str2 = \"hello programmers.\";\nchar *str4 = \"and have a nice day.\";\nchar *str5 = my_strcat(str2, str4);\nmy_strcpy(str1, str2);\n</code></pre>\n\n<p>and my implementation for strcpy:</p>\n\n<pre><code>void my_strcpy(char *dest, char *src){\n  while ((*dest++ = *src++)); //dest value is at end of char*\n}\n</code></pre>\n\n<p>1. when leaving my_strcpy, to my understanding, <em>dest</em> should point to the end of the string (because we kept incrementing it).</p>\n\n<p>Now lets take a look at my strcat:</p>\n\n<pre><code>char* my_strcat(char *first, char *second){\n  int l_first = strlen(first), l_second = strlen(second);\n  char *tmp = malloc (l_first + l_second + 1);\n\n  while ((*tmp++ = *first++));\n  tmp--; // overwrite tmp's \"\\0\"\n  while ((*tmp++ = *second++)); // tmp value is end of char*\n  tmp-=(l_first+l_second + 1); // rewinding pointer to string start.\n  return tmp;\n}\n</code></pre>\n\n<p>2. I had to manually \"rewind\" tmp in order for it to print properly outside the function.</p>\n\n<p><strong>My question</strong>, in short, is why do I get this behavior? I am not so sure how to describe my question, I hope it was clear enough. Why did I have to \"rewind\" my pointer in the second function, but not the first? Moreover, why didn't I had to \"rewind\" <em>src</em> and <em>dest</em> in the first function?</p>\n\n<p><strong>Possible explanations I thought of:</strong></p>\n\n<ol>\n<li>char* was passed by value to functions, and this is why I didnt had to rewind <em>src</em> and <em>dest</em> - proven wrong by debugger (checked addresses in and out of function scope).</li>\n<li>in the first function, I'm passing as <em>dest</em> a pointer that was allocated outside the scope, whereas in the second function <em>tmp</em> was allocated inside the scope.</li>\n</ol>\n\n<p>Thanks\n(I was trying to provide as much info and attempted solutions like a good SO question should be, sorry if it came out too long)</p>\n"}, {"tags": ["c", "raspberry-pi", "tcp-ip"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1537282539, "post_id": 52389255, "comment_id": 91723618, "body": "I don&#39;t think DNS is the way to go. Maybe getsockname on the listening socket? But if you&#39;re listening on all interfaces that might come back as 0.0.0.0, so you&#39;ll need to enumerate all of the known IP addresses and work out which one you want. Some ideas here: <a href=\"https://stackoverflow.com/questions/122208/get-the-ip-address-of-local-computer\" title=\"get the ip address of local computer\">stackoverflow.com/questions/122208/&hellip;</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1537283180, "post_id": 52389255, "comment_id": 91724037, "body": "What is wrong with the second output? That&#39;s a potentially valid IP address"}, {"owner": {"reputation": 5, "user_id": 10144116, "user_type": "registered", "profile_image": "https://graph.facebook.com/1972002622861942/picture?type=large", "display_name": "Krzysztof Tarnawski", "link": "https://stackoverflow.com/users/10144116/krzysztof-tarnawski"}, "edited": false, "score": 1, "creation_date": 1537291547, "post_id": 52389255, "comment_id": 91728569, "body": "my raspberry&#39;s local network IP is 192.168.40.21, I am connecting to it via SSH with this IP, so I think this is what has to be printed?"}], "answers": [{"comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1537349510, "post_id": 52393430, "comment_id": 91748951, "body": "Whilst that&#39;s correct, it&#39;s not useful if you did want to print &quot;Server is now running: connect your clients to 192.168.40.21:5000&quot;. (Which I&#39;d expected was what OP is trying to do?)"}], "tags": [], "owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "is_accepted": true, "score": 1, "last_activity_date": 1537299000, "creation_date": 1537299000, "answer_id": 52393430, "question_id": 52389255, "link": "https://stackoverflow.com/questions/52389255/c-socket-programming-getting-ip-of-server-on-raspberrypi/52393430#52393430", "title": "C socket programming, getting IP of server on raspberrypi", "body": "<p>The answer 0.0.0.0 is the correct one.</p>\n\n<p>More precisely, when you open a server socket, it does not have a specific, well-defined address. Therefore if you ask any system calls to \"find the local address this socket is listening to\" they will return the wildcard address 0.0.0.0.\nFurthermore, you can connect to the server using many different destination addresses: for example \"127.0.0.1\", \"127.1.2.3\", \"192.168.40.21\" (the address of your network interface), etc.</p>\n\n<p>If you want to listen to a specific address, you need to pass that address to <code>bind()</code>. For example, this code listens to a specific local address 127.1.2.3:</p>\n\n<pre><code>server_address.sin_family = AF_INET;\nserver_address.sin_addr.s_addr = inet_addr(\"127.1.2.3\");\nserver_address.sin_port = htons(PORT);\nif (bind(server_file_descriptor, (struct sockaddr *)&amp;server_address, sizeof(server_address)))\n   ...\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>3 - Server runs on IP: 127.1.2.3, port: 5000</p>\n</blockquote>\n\n<p>The problem is that connections to \"127.0.0.1\", \"192.168.40.21\" and all of the other addresses are now going to fail, since you have restricted the server to be reachable only on a specific address.</p>\n\n<p>However, there is a thing that does have a well-defined address in your initial example. It is the client socket created after the connection is accepted. If you add this code after the <code>accept()</code> call, you will see the address the client has connected to:</p>\n\n<pre><code>    struct sockaddr_in addr;\n    socklen_t len;\n    len = sizeof(addr);\n    getsockname(new_connection, (struct sockaddr *)&amp;addr, &amp;len);\n    printf(\"Client connected to: %s, port: %d\\n\\n\", inet_ntoa(addr.sin_addr), ntohs(addr.sin_port));\n</code></pre>\n\n<p>This address may be different for different clients: i.e. one client may connect to \"127.0.0.1\", another to \"192.168.40.21\". </p>\n"}], "owner": {"reputation": 5, "user_id": 10144116, "user_type": "registered", "profile_image": "https://graph.facebook.com/1972002622861942/picture?type=large", "display_name": "Krzysztof Tarnawski", "link": "https://stackoverflow.com/users/10144116/krzysztof-tarnawski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 1, "accepted_answer_id": 52393430, "answer_count": 1, "score": 0, "last_activity_date": 1537299000, "creation_date": 1537282124, "question_id": 52389255, "link": "https://stackoverflow.com/questions/52389255/c-socket-programming-getting-ip-of-server-on-raspberrypi", "title": "C socket programming, getting IP of server on raspberrypi", "body": "<p>I am writing a server application on Raspberry Pi with communication on TCP/IP sockets and I have trouble with showing an IP of socket I am listening on. I have found two solutions and none of them are working. </p>\n\n<p>1st solution:</p>\n\n<pre><code>char hostName[255];\nstruct hostent *host_entry;\nchar * szLocalIP;\ngethostname(hostName, 255);\nhost_entry = gethostbyname(hostName);\nszLocalIP = inet_ntoa (*(struct in_addr *)host_entry-&gt;h_addr);\nprintf(\"Server runs on IP: %s, port: %d\\n\\n\", szLocalIP, ntohs(server_address.sin_port));\n</code></pre>\n\n<p>output: <code>Server runs on IP: 0.0.0.0, port: 5000</code></p>\n\n<p>2nd solution:</p>\n\n<pre><code>struct sockaddr_in server_address;\nchar hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];\nif (getnameinfo((struct sockaddr *)&amp;server_address, server_len, hbuf, sizeof(hbuf), sbuf, sizeof(sbuf), NI_NUMERICHOST | NI_NUMERICSERV) == 0)\n         printf(\"Server runs on IP: %s, port: %s\\n\\n\", hbuf, sbuf);\n</code></pre>\n\n<p>output: <code>Server runs on IP: 127.0.1.1, port: 5000</code></p>\n\n<p>full code:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#define PORT 5000\n#define MAX_QUEUE 3\n#define NAME \"Server\"\n\nint main()\n{\n    int server_file_descriptor, new_connection;\n    long valread;\n    unsigned long counter = 1;\n    struct sockaddr_in server_address, client_address;\n    socklen_t server_len, client_len;\n    int opt = 1;\n    char buffer[1024] = {0};\n\n    char hostName[255];\n    struct hostent *host_entry;\n    char * szLocalIP;\n\n    char hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];\n\n    char *hello = \"Temperature send\";\n\n    if ((server_file_descriptor = socket(AF_INET, SOCK_STREAM, 0)) == -1)\n    {\n        perror(\"socket failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (setsockopt(server_file_descriptor, SOL_SOCKET, SO_REUSEADDR | SO_REUSEPORT, &amp;opt, sizeof(opt)))\n    {\n        perror(\"setsockopt\");\n        exit(EXIT_FAILURE);\n    }\n\n    server_address.sin_family = AF_INET;\n    server_address.sin_addr.s_addr = INADDR_ANY;\n    server_address.sin_port = htons(PORT);\n\n    server_len = sizeof(server_address);\n\n    if (bind(server_file_descriptor, (struct sockaddr *)&amp;server_address, server_len))\n    {\n        perror(\"bind failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (listen(server_file_descriptor, MAX_QUEUE))\n    {\n        perror(\"listen failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    gethostname(hostName, 255);\n    host_entry = gethostbyname(hostName);\n    szLocalIP = inet_ntoa (*(struct in_addr *)host_entry-&gt;h_addr);\n\n    if (getnameinfo((struct sockaddr *)&amp;server_address, server_len, hbuf, sizeof(hbuf), sbuf, sizeof(sbuf), NI_NUMERICHOST | NI_NUMERICSERV) == 0)\n         printf(\"1 - Server runs on IP: %s, port: %s\\n\\n\", hbuf, sbuf);\n\n    printf(\"2 - Server runs on IP: %s, port: %d\\n\\n\", szLocalIP, ntohs(server_address.sin_port));\n    printf(\"3 - Server runs on IP: %s, port: %d\\n\\n\", inet_ntoa(server_address.sin_addr), ntohs(server_address.sin_port));\n\n    client_len = sizeof(client_address);\n\n    for (;;counter++)\n    {\n        if ((new_connection = accept(server_file_descriptor, (struct sockaddr *)&amp;client_address, &amp;client_len)) == -1)\n        {\n            perror(\"accept failed\");\n            exit(EXIT_FAILURE);\n        }\n\n        printf(\"%s: got connection from %s on port: %d.\\n\", NAME, inet_ntoa(client_address.sin_addr), ntohs(client_address.sin_port));\n\n        valread = read( new_connection , buffer, 1024);\n\n        printf(\"%s sends request: %s\\n\", inet_ntoa(client_address.sin_addr), buffer);\n\n        if (strcmp(buffer, \"get_temp\") == 0)\n        {\n            send(new_connection , hello , strlen(hello) , 0 );\n            printf(\"%s: message \\\"%s\\\" send to %s.\\n\", NAME, hello, inet_ntoa(client_address.sin_addr));\n        }\n        else\n        {\n            send(new_connection , \"Unknown command\\n\" , 15 , 0 );\n            printf(\"%s: message \\\"Unknown command\\\" send to %s.\\n\", NAME, inet_ntoa(client_address.sin_addr));\n        }\n        printf(\"%s: closing connection with: %s.\\n\", NAME, inet_ntoa(client_address.sin_addr));\n        printf(\"Handled calls: %ld\\n\\n\", counter);\n        close(new_connection);\n        memset(buffer, 0, sizeof(buffer));\n    }\n}\n</code></pre>\n\n<p>output of 3rd printf is the same as 1st.</p>\n"}, {"tags": ["c", "gcc", "clang", "code-coverage"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537282429, "post_id": 52389254, "comment_id": 91723549, "body": "and if you interrupt with Ctrl+C what happens?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1537284046, "post_id": 52389254, "comment_id": 91724622, "body": "The instrumentation for dumping the info is probably implicit at end of program, isn&#39;t it? Can you do it explicitly? Then you could dump when doing the endless loop first time, at the end."}, {"owner": {"reputation": 387, "user_id": 6660335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2b63017602d68a06e5e03a519a9a3?s=128&d=identicon&r=PG&f=1", "display_name": "yodahaji", "link": "https://stackoverflow.com/users/6660335/yodahaji"}, "edited": false, "score": 0, "creation_date": 1537369487, "post_id": 52389254, "comment_id": 91761491, "body": "If I interrupt it with Crtl+C, all the information stored in the memory will lost. So I can get nothing."}, {"owner": {"reputation": 387, "user_id": 6660335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2b63017602d68a06e5e03a519a9a3?s=128&d=identicon&r=PG&f=1", "display_name": "yodahaji", "link": "https://stackoverflow.com/users/6660335/yodahaji"}, "edited": false, "score": 0, "creation_date": 1537369612, "post_id": 52389254, "comment_id": 91761579, "body": "Yeah, I use tools like llvm-cov and gcov. Both of them seem to dump the info at the end of the program. And I can not know whether or not I could do it explicitly."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 3759897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5fcf9d694740fa47974896cfe7323c?s=128&d=identicon&r=PG&f=1", "display_name": "Tobibobi", "link": "https://stackoverflow.com/users/3759897/tobibobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1540799889, "creation_date": 1540799889, "answer_id": 53041070, "question_id": 52389254, "link": "https://stackoverflow.com/questions/52389254/how-can-i-get-the-code-coverage-information-for-a-c-program-who-trapped-in-infin/53041070#53041070", "title": "How can I get the code coverage information for a C program who trapped in infinite loop?", "body": "<p>A simple solution would be to add a litle timer interrupt inside your program that will raise an exception after a few seconds of \"bad behaviour\" and cause the program to terminate nicely.</p>\n\n<p>When searching and probing in the temporary fashion you seem to be after, it is completely legit to \"hack it\" as long as you remove the hack immediately you found the error..</p>\n"}], "owner": {"reputation": 387, "user_id": 6660335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2b63017602d68a06e5e03a519a9a3?s=128&d=identicon&r=PG&f=1", "display_name": "yodahaji", "link": "https://stackoverflow.com/users/6660335/yodahaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540799889, "creation_date": 1537282123, "question_id": 52389254, "link": "https://stackoverflow.com/questions/52389254/how-can-i-get-the-code-coverage-information-for-a-c-program-who-trapped-in-infin", "title": "How can I get the code coverage information for a C program who trapped in infinite loop?", "body": "<p>I need to get the code coverage information for a amount of C programs. I only need to know whether or not each line is executed. However, some of them will never end for the sake of infinite loops. The most of tools, e.g. like gcov, llvm-cov, which could get the information for the program only after it ends. \nI set a time limitation for all the programs. If it dosen't end when its exection time is beyound the limitation, its process will be killed. However, when its process was killed, all the information stored in the memory is cleaned. So I can't get the code coverage information for those programs. How can I do that?</p>\n"}, {"tags": ["c++", "c", "stm32", "spi", "flash-memory"], "comments": [{"owner": {"reputation": 128, "user_id": 5428441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/djWH9.jpg?s=128&g=1", "display_name": "George Troulis", "link": "https://stackoverflow.com/users/5428441/george-troulis"}, "edited": false, "score": 0, "creation_date": 1537383539, "post_id": 52389000, "comment_id": 91768783, "body": "Have you tried debug mode? It is SUPER useful because you can view the values of all the registers in the device. You can also change the values of the registers in run time without having to re-upload code. Verify that the options in the QSPI registers seem normal according to the Reference Manual for your specific STM32 chip"}, {"owner": {"reputation": 73, "user_id": 10380869, "user_type": "registered", "profile_image": "https://graph.facebook.com/1895366900545473/picture?type=large", "display_name": "awyzlin", "link": "https://stackoverflow.com/users/10380869/awyzlin"}, "reply_to_user": {"reputation": 128, "user_id": 5428441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/djWH9.jpg?s=128&g=1", "display_name": "George Troulis", "link": "https://stackoverflow.com/users/5428441/george-troulis"}, "edited": false, "score": 1, "creation_date": 1537442475, "post_id": 52389000, "comment_id": 91790652, "body": "Yes, I tried debug mode. All the QSPI register values seem fine to me but it\u2019s my first time using QSPI so I might be missing something."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10380869, "user_type": "registered", "profile_image": "https://graph.facebook.com/1895366900545473/picture?type=large", "display_name": "awyzlin", "link": "https://stackoverflow.com/users/10380869/awyzlin"}, "edited": false, "score": 0, "creation_date": 1538111516, "post_id": 52523674, "comment_id": 92036549, "body": "Alexey, I used HAL_QSPI_Command() and it works! Thank you for advice."}], "tags": [], "owner": {"reputation": 458, "user_id": 5312070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e7f26feb830b626b459d5122315035?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Esaulenko", "link": "https://stackoverflow.com/users/5312070/alexey-esaulenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1537984876, "creation_date": 1537984876, "answer_id": 52523674, "question_id": 52389000, "link": "https://stackoverflow.com/questions/52389000/communication-problem-with-spi-nand-flash-memory-stm32l4-qspi/52523674#52523674", "title": "Communication problem with SPI NAND flash memory (STM32L4, QSPI)", "body": "<p>It looks like incorrect using of HAL driver.</p>\n\n<p>QSPI is more sophisticated peripheral, than conventional SPI module.</p>\n\n<p>Communication through QSPI consists several phases (instruction, address and data), as described in reference manual.</p>\n\n<p>Length of these phases should be written in <em>data length</em> and <em>communication configuration</em> registers.</p>\n\n<p>It should be done by calling <code>HAL_QSPI_Command()</code>, if you still using HAL drivers.</p>\n\n<p>You can find examples in HAL external memory driver (for example, <code>stm32h743i_eval_qspi.c</code>, but i don't know, is there an analog for STM32L476's HAL).</p>\n\n<p>Also read the very helpful document\n<code>AN4760 Application note Quad-SPI (QSPI) interface on STM32 microcontrollers</code></p>\n"}], "owner": {"reputation": 73, "user_id": 10380869, "user_type": "registered", "profile_image": "https://graph.facebook.com/1895366900545473/picture?type=large", "display_name": "awyzlin", "link": "https://stackoverflow.com/users/10380869/awyzlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "accepted_answer_id": 52523674, "answer_count": 1, "score": 2, "last_activity_date": 1538928049, "creation_date": 1537281315, "last_edit_date": 1537750123, "question_id": 52389000, "link": "https://stackoverflow.com/questions/52389000/communication-problem-with-spi-nand-flash-memory-stm32l4-qspi", "title": "Communication problem with SPI NAND flash memory (STM32L4, QSPI)", "body": "<p>I am trying to use an external flash memory (TC58CVG1S3HxAIx) with NUCLEO-L476RG board. I can\u2019t get the QSPI to work. I used STM32CubeMx to configure QSPI: </p>\n\n<pre><code>void MX_QUADSPI_Init(void)\n{\n\n  hqspi.Instance = QUADSPI;\n  hqspi.Init.ClockPrescaler = 255;\n  hqspi.Init.FifoThreshold = 1;\n  hqspi.Init.SampleShifting = QSPI_SAMPLE_SHIFTING_NONE;\n  hqspi.Init.FlashSize = 30;\n  hqspi.Init.ChipSelectHighTime = QSPI_CS_HIGH_TIME_1_CYCLE;\n  hqspi.Init.ClockMode = QSPI_CLOCK_MODE_0;\n  if (HAL_QSPI_Init(&amp;hqspi) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n}\n\nvoid HAL_QSPI_MspInit(QSPI_HandleTypeDef* qspiHandle)\n{\n\n  GPIO_InitTypeDef GPIO_InitStruct;\n  if(qspiHandle-&gt;Instance==QUADSPI)\n  {\n  /* USER CODE BEGIN QUADSPI_MspInit 0 */\n\n  /* USER CODE END QUADSPI_MspInit 0 */\n    /* QUADSPI clock enable */\n    __HAL_RCC_QSPI_CLK_ENABLE();\n\n\n    /**QUADSPI GPIO Configuration    \n    PA6     ------&gt; QUADSPI_BK1_IO3\n    PA7     ------&gt; QUADSPI_BK1_IO2\n    PB0     ------&gt; QUADSPI_BK1_IO1\n    PB1     ------&gt; QUADSPI_BK1_IO0\n    PB10     ------&gt; QUADSPI_CLK\n    PB11     ------&gt; QUADSPI_NCS \n    */\n    GPIO_InitStruct.Pin = GPIO_PIN_6|GPIO_PIN_7;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF10_QUADSPI;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    GPIO_InitStruct.Pin = GPIO_PIN_0|GPIO_PIN_1|GPIO_PIN_10|GPIO_PIN_11;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF10_QUADSPI;\n    HAL_GPIO_Init(GPIOB, &amp;GPIO_InitStruct);\n\n  /* USER CODE BEGIN QUADSPI_MspInit 1 */\n\n  /* USER CODE END QUADSPI_MspInit 1 */\n  }\n}\n</code></pre>\n\n<p>And I wrote a simple program to get id from the flash memory:</p>\n\n<pre><code>#include \"main.h\"\n#include \"stm32l4xx_hal.h\"\n#include \"quadspi.h\"\n#include \"gpio.h\"\n\nuint8_t ReadAddr = 0x9F;\nuint8_t pBuffer[3];\n\nint main(void)\n{\n  HAL_Init();\n  SystemClock_Config();\n  MX_GPIO_Init();\n  MX_QUADSPI_Init();\n\n  while (1)\n  {\n  HAL_QSPI_Transmit(&amp;hqspi, &amp;ReadAddr, 5);\n  HAL_QSPI_Receive(&amp;hqspi, pBuffer, 5);\n  }\n}\n</code></pre>\n\n<p>The qspi clock doesn\u2019t work. I checked on the oscilloscope and all I see is a straight line. If I change the qspi clock mode to high the problem is still there, but I see the line on 3V not 0V. The CS signal works, on the oscilloscope I can clearly see the time when uC should transmit and receive.</p>\n\n<p>I checked AHB3ENR register and it is properly initialized. I have no idea what else could be wrong. </p>\n\n<p><strong><em>Could somebody help me?</em></strong></p>\n"}, {"tags": ["c", "valgrind", "gcc8"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1537280891, "post_id": 52388810, "comment_id": 91722472, "body": "<code>b</code> needs room for 11 chars."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1537280915, "post_id": 52388810, "comment_id": 91722490, "body": "@JohnnyMopp You did not understand my Question,"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1537281020, "post_id": 52388810, "comment_id": 91722567, "body": "Down voters please explain."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1537281051, "post_id": 52388810, "comment_id": 91722590, "body": "with &quot;not valid code&quot;, are you referring to the message &quot;Source and destination overlap in strcpy&quot;?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1537281125, "post_id": 52388810, "comment_id": 91722647, "body": "Undefined behaviour is undefined."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1537281128, "post_id": 52388810, "comment_id": 91722653, "body": "I undid my downvote. You could make your question more clear by clearly stating the question: <b><i>&quot;Why doesn&#39;t valgrind catch this UB?&quot;</i></b>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537281179, "post_id": 52388810, "comment_id": 91722688, "body": "I removed the part with <code>strcpy</code>, which makes the Question dificult"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537281244, "post_id": 52388810, "comment_id": 91722743, "body": "If this is not a SO Question, than probably I should delete my Account here.#"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1537281313, "post_id": 52388810, "comment_id": 91722788, "body": "Your question was unclear at first. With @HolyBlackCat&#39;s comment it makes more sense now."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1537281340, "post_id": 52388810, "comment_id": 91722808, "body": "@Michi and I rolled back the question because there is nothing interesting in valgrind <i>not</i> spotting a bug."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1537281343, "post_id": 52388810, "comment_id": 91722810, "body": "It&#39;s a valid question. Though IMO the wording is slightly unclear. At the first glance it seemed like &quot;I use UB, but my code works properly, why?&quot; question, which newbies ask a lot."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537281353, "post_id": 52388810, "comment_id": 91722817, "body": "yes, that&#39;s why I removed that part,"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1537281385, "post_id": 52388810, "comment_id": 91722834, "body": "@HolyBlackCat There is a hope than :D"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1537282464, "post_id": 52388810, "comment_id": 91723575, "body": "I removed the <code>strcpy2</code> from the first excerpt - it wasn&#39;t used there"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537281860, "post_id": 52388977, "comment_id": 91723174, "body": "I can not use <code>-fsanitize=address</code>  because I get <a href=\"https://pastebin.com/raw/1jnqVkqH\" rel=\"nofollow noreferrer\">THIS</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537282073, "post_id": 52388977, "comment_id": 91723333, "body": "Strange indeed :D"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1537282248, "post_id": 52388977, "comment_id": 91723426, "body": "@Michi Try adding <code>-lasan</code> to linker flags."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1537282425, "post_id": 52388977, "comment_id": 91723544, "body": "@Michi ah, I compiled it with one command only - you should add <code>-fsanitize=address</code> to the linking <code>gcc</code> too"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537282716, "post_id": 52388977, "comment_id": 91723737, "body": "I think I am doing something wrong here because I get <code>ASan runtime does not come first in initial library list; you should either link runtime to your application or manually preload it with LD_PRELOAD.</code>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537282811, "post_id": 52388977, "comment_id": 91723801, "body": "Instead works fine with <code>-static-libasan</code>. I think, <a href=\"https://pastebin.com/raw/ux23PAnP\" rel=\"nofollow noreferrer\">because I get This</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1537285468, "post_id": 52388977, "comment_id": 91725438, "body": "The asan doesn&#39;t need valgrind"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1537281562, "last_edit_date": 1537281562, "creation_date": 1537281244, "answer_id": 52388977, "question_id": 52388810, "link": "https://stackoverflow.com/questions/52388810/why-doesnt-valgrind-memcheck-catch-this-ub/52388977#52388977", "title": "Why doesn&#39;t Valgrind memcheck catch this UB?", "body": "<p>Valgrind can catch <em>only certain kinds of errors</em>. It cannot instrument the stack, hence it would not see the error with your <code>strcpy2</code>. OTOH the <code>strcpy</code> is replaced by a version that does check if the source and destination overlap - it could catch this <strong>only</strong> because <code>a + 10 == b</code> in <strong>your</strong> compiled program!</p>\n\n<p>To catch this kind of error use GCC's <code>-fsanitize=address</code>:</p>\n\n<pre><code>% ./a.out \n=================================================================\n==3368==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff13832a2a at pc 0x557f05344da8 bp 0x7fff13832990 sp 0x7fff13832980\nREAD of size 1 at 0x7fff13832a2a thread T0\n    #0 0x557f05344da7 in strcpy2 (/a.out+0xda7)\n    #1 0x557f05344cca in main (/a.out+0xcca)\n    #2 0x7f2d400e5b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #3 0x557f05344a49 in _start (/a.out+0xa49)\n\nAddress 0x7fff13832a2a is located in stack of thread T0 at offset 106 in frame\n    #0 0x557f05344b39 in main (/a.out+0xb39)\n\n  This frame has 2 object(s):\n    [32, 42) 'a'\n    [96, 106) 'b' &lt;== Memory access at offset 106 overflows this variable\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\n[ ... many more lines follow ... ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "is_accepted": false, "score": 0, "last_activity_date": 1537286927, "creation_date": 1537286927, "answer_id": 52390646, "question_id": 52388810, "link": "https://stackoverflow.com/questions/52388810/why-doesnt-valgrind-memcheck-catch-this-ub/52390646#52390646", "title": "Why doesn&#39;t Valgrind memcheck catch this UB?", "body": "<p>I've updated the title to be more accurate concerning the Valgrind tool used.</p>\n\n<p>Valgrind <em>can</em> detect this sort of error, but as already noted, not with <code>memcheck</code>.</p>\n\n<p>If I run this example code with Valgrind <code>exp-sgcheck</code> (exp = experimental, sgcheck = stack and globals check)</p>\n\n<pre><code>valgrind --tool=exp-sgcheck ./so19\n</code></pre>\n\n<p>Then I get</p>\n\n<blockquote>\n  <p>==25056== Invalid read of size 1<br>\n  ==25056==    at 0x40059D: strcpy2 (so19.c:23)<br>\n  ==25056==    by 0x400564: main (so19.c:18)<br>\n  ==25056==  Address 0x1ffeffed1a expected vs actual:<br>\n  ==25056==  Expected: stack array \"b\" of size 10 in frame 1 back from here                                                                  </p>\n  \n  <p>==25056==  Actual:   unknown<br>\n  ==25056==  Actual:   is 0 after Expected<br>\n  ==25056==<br>\n  ==25056== Invalid write of size 1<br>\n  ==25056==    at 0x4005A0: strcpy2 (so19.c:23)<br>\n  ==25056==    by 0x400564: main (so19.c:18)<br>\n  ==25056==  Address 0x1ffeffed2a expected vs actual:<br>\n  ==25056==  Expected: stack array \"a\" of size 10 in frame 1 back from here                                                                  </p>\n  \n  <p>==25056==  Actual:   unknown<br>\n  ==25056==  Actual:   is 0 after Expected<br>\n  ==25056==<br>\n  ==25056== Invalid read of size 1<br>\n  ==25056==    at 0x4005A2: strcpy2 (so19.c:23)<br>\n  ==25056==    by 0x400564: main (so19.c:18)<br>\n  ==25056==  Address 0x1ffeffed2a expected vs actual:<br>\n  ==25056==  Expected: stack array \"a\" of size 10 in frame 1 back from here                                                                  </p>\n  \n  <p>==25056==  Actual:   unknown<br>\n  ==25056==  Actual:   is 0 after Expected<br>\n  ==25056==<br>\n  ==25056== Invalid read of size 1<br>\n  ==25056==    at 0x4E74C9C: vfprintf (in /lib64/libc-2.12.so)<br>\n  ==25056==    by 0x4E7BFF9: printf (in /lib64/libc-2.12.so)<br>\n  ==25056==    by 0x4005CD: printThis (so19.c:27)<br>\n  ==25056==    by 0x400570: main (so19.c:19)<br>\n  ==25056==  Address 0x1ffeffed2a expected vs actual:<br>\n  ==25056==  Expected: stack array \"a\" of size 10 in frame 3 back from here                                                                  </p>\n  \n  <p>==25056==  Actual:   unknown<br>\n  ==25056==  Actual:   is 0 after Expected<br>\n  ==25056==<br>\n  ==25056== Invalid read of size 1<br>\n  ==25056==    at 0x4E9E7C0: _IO_file_xsputn@@GLIBC_2.2.5 (in /lib64/libc-2.12.so)                                                  </p>\n  \n  <p>==25056==    by 0x4E74FFF: vfprintf (in /lib64/libc-2.12.so)<br>\n  ==25056==    by 0x4E7BFF9: printf (in /lib64/libc-2.12.so)<br>\n  ==25056==    by 0x4005CD: printThis (so19.c:27)<br>\n  ==25056==    by 0x400570: main (so19.c:19)<br>\n  ==25056==  Address 0x1ffeffed2a expected vs actual:<br>\n  ==25056==  Expected: stack array \"a\" of size 10 in frame 4 back from here                                                                  </p>\n  \n  <p>==25056==  Actual:   unknown<br>\n  ==25056==  Actual:   is 0 after Expected</p>\n</blockquote>\n\n<p>This is when compiled with debug information (<code>-g</code>). With an optimized build no errors are detected.</p>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 52388977, "answer_count": 2, "score": 1, "last_activity_date": 1537286927, "creation_date": 1537280790, "last_edit_date": 1537286478, "question_id": 52388810, "link": "https://stackoverflow.com/questions/52388810/why-doesnt-valgrind-memcheck-catch-this-ub", "title": "Why doesn&#39;t Valgrind memcheck catch this UB?", "body": "<p>Like the title say I really need help of understanding, why this code is treated on my system ( <code>linux mint 19</code>, <code>GCC-8.0.1</code>, <code>valgrind-3.13.0</code>, <code>c17</code> ) as NOT valid code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid printThis( const char *const ptr );\n\nint main( void) {\n\n    char a[10] = \"asds\";\n    char b[10] = \"1234567890\";\n\n    strcpy ( a, b );\n    printThis( a );\n}\n\nvoid printThis( const char *const ptr ){\n    printf(\"Copy completed! : %s\\n\", ptr );\n}\n</code></pre>\n\n<p>Valgrind reports the problem here:</p>\n\n<blockquote>\n<pre><code>==6973== Memcheck, a memory error detector\n==6973== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==6973== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==6973== Command: /home/michi/Templates/Cprogram/bin/Debug/Cprogram\n==6973== \n==6973== Source and destination overlap in strcpy(0x1ffefffd14, 0x1ffefffd1e)\n==6973==    at 0x4C32E97: strcpy (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==6973==    by 0x108724: main (main.c:12)\n==6973== \nCopy completed! : 1234567890\n==6973== \n==6973== HEAP SUMMARY:\n==6973==     in use at exit: 0 bytes in 0 blocks\n==6973==   total heap usage: 1 allocs, 1 frees, 1,024 bytes allocated\n==6973== \n==6973== All heap blocks were freed -- no leaks are possible\n==6973== \n==6973== For counts of detected and suppressed errors, rerun with: -v\n==6973== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n</blockquote>\n\n<p>and this one as Valid code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid strcpy2(char *s, char *t);\nvoid printThis( const char *const ptr );\n\nint main( void) {\n\n    char a[10] = \"asds\";\n    char b[10] = \"1234567890\";\n\n    strcpy2( a, b );\n    printThis( a );\n}\n\nvoid strcpy2(char *s, char *t) {\n    while ( ( *(s++) = *(t++) ) );\n}\n\nvoid printThis( const char *const ptr ){\n    printf(\"Copy completed! : %s\\n\", ptr );\n}\n</code></pre>\n\n<p>Valgrind output:</p>\n\n<blockquote>\n<pre><code>==7025== Memcheck, a memory error detector\n==7025== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==7025== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==7025== Command: /home/michi/Templates/Cprogram/bin/Debug/Cprogram\n==7025== \nCopy completed! : 1234567890\n==7025== \n==7025== HEAP SUMMARY:\n==7025==     in use at exit: 0 bytes in 0 blocks\n==7025==   total heap usage: 1 allocs, 1 frees, 1,024 bytes allocated\n==7025== \n==7025== All heap blocks were freed -- no leaks are possible\n==7025== \n==7025== For counts of detected and suppressed errors, rerun with: -v\n==7025== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n</blockquote>\n\n<p>Compiled with <code>O0</code>, <code>O1</code>, <code>O2</code> and <code>O3</code> and GCC flags:</p>\n\n<p><code>-Wpedantic -std=c17 -Wall -Wextra -Werror  -Wstrict-prototypes  -Wmissing-prototypes -Wmisleading-indentation -Wduplicated-cond -Wold-style-definition -Wconversion -Wshadow -Winit-self -Wfloat-equal -Wwrite-strings -O0 -g</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1537280733, "post_id": 52388743, "comment_id": 91722348, "body": "Count number of arguments  <code>int izbaciSveProste(int n, int x[], int y[])</code> it needs and how many you are passing <code>izbaciSveProste(x[i])</code>."}, {"owner": {"reputation": 4429, "user_id": 61934, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/lp04R.jpg?s=128&g=1", "display_name": "NTDLS", "link": "https://stackoverflow.com/users/61934/ntdls"}, "edited": false, "score": 0, "creation_date": 1537281369, "post_id": 52388743, "comment_id": 91722829, "body": "For the life of me I will never understand why people feel compelled to down-vote a question when they think the answer is too simple or obvious. Add some comments, an answer, maybe edit the title and be constructive."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1537281525, "post_id": 52388743, "comment_id": 91722942, "body": "Before questioning on SO people are expected to do some research that I&#39;m not finding in OP&#39;s question(I&#39;m not down voter)"}], "answers": [{"comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 3, "creation_date": 1537280810, "post_id": 52388798, "comment_id": 91722417, "body": "Is that really worth an answer? Better vote to close the question."}, {"owner": {"reputation": 4429, "user_id": 61934, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/lp04R.jpg?s=128&g=1", "display_name": "NTDLS", "link": "https://stackoverflow.com/users/61934/ntdls"}, "edited": false, "score": 0, "creation_date": 1537281221, "post_id": 52388798, "comment_id": 91722725, "body": "Its a legitimate question from a person who is clearly fresh to all this. So yes, an answer that is asked for non-nefarious purposes deserves an answer."}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1537281426, "post_id": 52388798, "comment_id": 91722874, "body": "@Gerhardh same as I wrote earlier in comment, it prints empty array even if I entered purposely 2,3 prime numbers"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1537281502, "post_id": 52388798, "comment_id": 91722926, "body": "@Arthuoff how do you enter &quot;2,3 prime numbers&quot;?  Also see my updated last paragraph"}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1537281836, "post_id": 52388798, "comment_id": 91723161, "body": "@Gerhardh randomly, let&#39;s say I want to enter 4 elements and I enter: 74, 6, 2, 3, then it should rewrite 2,3 to array y[] and print 2,3 and array y[] has 2 elements.I saw your last paragraph and I corrected my code."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537282131, "post_id": 52388798, "comment_id": 91723369, "body": "I can&#39;t see where you put any prime number into <code>y</code> You only remove them from <code>x</code>.You need to store them before removing from the array. (And of course: You need an extra counter for the destination in <code>y</code> and only print as much numbers."}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1537282427, "post_id": 52388798, "comment_id": 91723547, "body": "@Gernhardh What do you mean by store them, before removing from the array?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537282690, "post_id": 52388798, "comment_id": 91723719, "body": "Well, how do you think, the numbers could get into <code>y</code> if <i>you</i> don&#39;t put it there? You need something like <code>y[dest] = x[i];</code> (Note: <code>dest</code> is an extra counter for <code>y</code>. You also mustn&#39;t use <code>len</code> as limit for printing your prime numbers.) That is a very basic concept of programming. If you plan to use a value later, you need to store it somewhere. It doesn&#39;t get assigned to a variable unless you provide the code for it."}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1537282771, "post_id": 52388798, "comment_id": 91723771, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180275/discussion-between-arthuoff-and-gerhardh\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 2, "last_activity_date": 1537281452, "last_edit_date": 1537281452, "creation_date": 1537280750, "answer_id": 52388798, "question_id": 52388743, "link": "https://stackoverflow.com/questions/52388743/why-array-doesnt-print-correct-numbers/52388798#52388798", "title": "Why array doesn&#39;t print correct numbers?", "body": "<p>Your function prototype has 3 parameters:</p>\n\n<pre><code>int izbaciSveProste(int n, int x[], int y[])\n</code></pre>\n\n<p>When you call the function, you only provide 1:</p>\n\n<pre><code>if(izbaciSveProste(x[i]))\n</code></pre>\n\n<p>The compiler wants to get all 3.</p>\n\n<p>As your function doesn't even touch the 2 array parameters, you might simply remove them from the function definition and only take 1 integer.</p>\n\n<p>Another problem:\nYou print <code>y[i]</code> in your loop but you never assign any value to that array. </p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1537281240, "post_id": 52388808, "comment_id": 91722741, "body": "Yeah this is correct, but still it won&#39;t print anything, even if I enter 2,3 prime numbers"}], "tags": [], "owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "is_accepted": false, "score": 2, "last_activity_date": 1537280782, "creation_date": 1537280782, "answer_id": 52388808, "question_id": 52388743, "link": "https://stackoverflow.com/questions/52388743/why-array-doesnt-print-correct-numbers/52388808#52388808", "title": "Why array doesn&#39;t print correct numbers?", "body": "<p>Your function <code>int izbaciSveProste(int n, int x[], int y[])</code> requires three arguments. Your code <code>izbaciSveProste(x[i]</code> passes one argument. That's not much enough. The compiler tells you that fact with the error message:</p>\n\n<blockquote>\n  <p>error: too few arguments to function 'izbaciSveProste'</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1537282640, "answer_count": 2, "score": -1, "last_activity_date": 1537283026, "creation_date": 1537280561, "last_edit_date": 1537283026, "question_id": 52388743, "link": "https://stackoverflow.com/questions/52388743/why-array-doesnt-print-correct-numbers", "closed_reason": "Not suitable for this site", "title": "Why array doesn&#39;t print correct numbers?", "body": "<p>Following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint izbaciSveProste(int n, int x[], int y[])\n{\n    int i;\n    int flag=0;\n\n    for(i=2; i&lt;n/2; i++)\n    {\n        if(n%i ==0)\n        {\n            flag =1;\n            break;\n        }\n    }\n    if(flag==1)\n        return 0;\n    else\n        return 1;\n}\n\nint main()\n{\n    int i,j,n,x[100],y[100];\n\n    printf(\"Koliko elemenata zelite u polju?\\n\");\n    scanf(\"%d\", &amp;n);\n\n    printf(\"Enter elements in array:- \");\n    for(i=0;i&lt;n;i++)\n    {\n    scanf(\"%d\",&amp;x[i]);\n    }\n\n    int len = sizeof(x)/sizeof(x[0]);\n\n    for(i=0; i&lt;len; i++)\n    {\n        if(izbaciSveProste(x[i]))\n        {\n            for(j=i; j&lt;len; j++)\n            {\n                x[j] = x[j+1];\n            }\n            i--;\n            len--;\n        }\n    }\n    printf(\"Elementi nakon brisanja su:\\n\");\n    for(i=0; i&lt;len; i++)\n        printf(\"%d\\n\",y[i]);\n\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Purpose of this program should be to delete all prime numbers from array x[] with n elements, remaining elements should be rewritten in array y[] and show count of elements in array y[] in the end.I believe that function is okay and  error is in main() specifically in storing y[].</p>\n"}, {"tags": ["c", "arm", "embedded"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1537280914, "post_id": 52388489, "comment_id": 91722489, "body": "In the supplied example, <code>sprintf</code> obviously must fail (the last one, at least), because the signal handler ends the program. There is no reentrancy as far as I can see, at least not in the code snippet. The program is simply not done when it&#39;s halted."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1537281240, "post_id": 52388489, "comment_id": 91722740, "body": "@tofro The supplied example doesn&#39;t have a interrupt. I couldn&#39;t make a &quot;Minimal, Complete, and Verifiable Example&quot; from the hardware functions and this is just to give an idea of the working. I&#39;ll remove it as the error was never recreated in the C program."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1537281698, "post_id": 52388489, "comment_id": 91723067, "body": "<code>sprintf</code> doesn&#39;t necessary need to fail when it is interrupted. Whether that happens depends very much on what you are doing in your interrupt service routine (or signal handler, for that matter). And without you telling us these details, it is impossible to answer your question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1537286633, "post_id": 52388489, "comment_id": 91726199, "body": "<code>gps_UART_RxInterrupt_Disable();  ...   gps_UART_RxInterrupt_Enable();</code> is a problem as at the end of the routine, the interrupt enable flag is not restored to its original value should it have been initially disabled.  I&#39;d expect <code>save enable state, disable, ..., restore state.</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537383536, "post_id": 52388489, "comment_id": 91768782, "body": "It looks like you still have not understood what interrupts are, how to write the handers properly and how to debug you code yourself. Apparently the good advise given with previous questions was completely ignored. Once again: you cannopt learn embedded programming by letting others yo your job or asking questions about particular problems about badly designed code. I&#39;d normally say &quot;orry to tell&quot;, but that would be ignored as well."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537383745, "post_id": 52388489, "comment_id": 91768868, "body": "For other users: this is an obvious repost of <a href=\"https://stackoverflow.com/questions/52164135/stray-characters-seen-at-output-of-snprintf\" title=\"stray characters seen at output of snprintf\">stackoverflow.com/questions/52164135/&hellip;</a>"}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1537419299, "post_id": 52388489, "comment_id": 91778724, "body": "@toohonestforthissite I understand my mistakes and will try to improve in the future. In my defense, I had to work on a code base already written. But yes, I have to do most of the debugging and testing and not rush into an answer. Thank you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537436459, "post_id": 52388489, "comment_id": 91787130, "body": "Why are you using stdio.h and floating point? Are you sure that your STM32 is actually a PC in disguise? In case of floating point &quot;Since my MCU is a 32 bit one, to perform a 64 bit operation it will take two clock cycles&quot; doesn&#39;t make much sense. Either you have a FPU that handles this (Cortex M4:ish or bigger), or you don&#39;t (M0 to M3), in which case you most likely shouldn&#39;t be using floating point in the first place. And if you use sprintf on a buffer shared with an ISR, your program design is completely broken."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537436793, "post_id": 52388489, "comment_id": 91787352, "body": "@Lundin It&#39;s a STM32F429 (with floating point unit). But still a 32 bit MCU, so to my understanding a 64 bit operation should take 2 cycles."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1537440322, "post_id": 52388489, "comment_id": 91789461, "body": "@clmno Cycles and instructions are very different things, pretty much every instruction takes several cycles. That being said, re-entrancy of C variables has very little to do with how much data the CPU can read/write in a single instruction. That is still no guarantee of atomicity. See <a href=\"https://stackoverflow.com/a/50236144/584518\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1537281733, "post_id": 52388785, "comment_id": 91723090, "body": "I&#39;m not doing the string operation inside the interrupt routine. I&#39;ll modify the question to clear this confusion."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1537287622, "post_id": 52388785, "comment_id": 91726701, "body": "As you&#39;ve mentioned, if the sprintf is called within another interrupt routine it may fail. My scenario is similar - I have a user-level function which has sprintf and an interrupt in the background. My concern is the 64 bit data, 2 cycles, so technically an interrupt routine can occur in between those two cycles."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1537377715, "post_id": 52388785, "comment_id": 91766001, "body": "As long as the interrupt does not modify the data that <code>sprintf</code> is working on, then everything is fine. An interrupt is completely &quot;invisible&quot; in user-level functionality (if an interrupt occurrs, the registers are saved and later restored) and can occurr between the two &quot;cycles&quot; without any impact."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1537281127, "last_edit_date": 1537281127, "creation_date": 1537280701, "answer_id": 52388785, "question_id": 52388489, "link": "https://stackoverflow.com/questions/52388489/sprintf-re-entry-into-64bit-operation-in-32-bit-mcu-with-interrupts/52388785#52388785", "title": "sprintf re-entry into 64bit operation in 32 bit MCU with interrupts", "body": "<p><code>sprintf</code> will ony fail during an interrupt if it is called again during that interrupt (assuming it uses global variables that are re-used; would it use only stack variables, then it is re-entrant).</p>\n\n<p>So if your interrupt handler is calling <code>sprintf</code> and during that call a new, same or higher priority interrupt occurs then it can fail. However, during the processing of an interrupt, interrupts are normally disabled so there can't (shouldn't!) be another interupt of the same type occurring.</p>\n\n<p>But why convert this raw data during interrupt handling? Why not store/pass this data to the user-level routine via a buffer and have that functionality convert the raw data? That would be consistent with the idea that an interrupt handler should be as short (fast) as possible.</p>\n"}], "owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 52388785, "answer_count": 1, "score": -2, "last_activity_date": 1537282992, "creation_date": 1537279809, "last_edit_date": 1537282992, "question_id": 52388489, "link": "https://stackoverflow.com/questions/52388489/sprintf-re-entry-into-64bit-operation-in-32-bit-mcu-with-interrupts", "title": "sprintf re-entry into 64bit operation in 32 bit MCU with interrupts", "body": "<p>In reference to SO question: <a href=\"https://stackoverflow.com/questions/52164135/stray-characters-seen-at-output-of-snprintf\">52164135</a> <br/></p>\n\n<p><em>The setup</em>:<br/>\nI have a function which converts many <code>double</code> values into a predefined string. The input is a <code>array of struct</code> from which we concatenate two double values into a string. A double is of size 8 bytes or 64 bits and my MCU of operation is STM32, a 32 bit ARM micro-controller. <br/>\nAn <code>interrupt</code> is also running parallelly.</p>\n\n<p>The data should look like:</p>\n\n<blockquote>\n  <p>[[12.11111111,12.11111111],[12.22222222,12.22222222],...]</p>\n</blockquote>\n\n<p>But I get (very rarely):</p>\n\n<blockquote>\n  <p>[[12.11111111,12.11111111],[<strong>55.01</strong>[12.33333333,12.33333333],...]</p>\n</blockquote>\n\n<p>Note: I missed out <code>[12.22222222,12.22222222]</code></p>\n\n<p><em>sprintf is not re-entran</em>t:<br/>\nAccording to this <a href=\"https://www.avrfreaks.net/comment/392537#comment-392537\" rel=\"nofollow noreferrer\">discussion</a>, on AVRFreaks, <code>sprintf is not re-entrant.</code> (The discussion is on using sprintf in a interrupt enabled hardware environment.) Which means if an interrupt occurs in-between a  <code>sprintf</code> operation the stack fails to continue the operation it was doing.</p>\n\n<p>Since my MCU is a 32 bit one, to perform a 64 bit operation it will take two clock cycles. And if we assume an interrupt occurred in between the sprintf operation according the the above discussion <code>sprintf</code> should fail.</p>\n\n<p><strong>Question</strong><br/>\n1. Will <code>sprintf</code> fail in case it is interrupted?</p>\n\n<p>Here is the string function, an interrupt routine also runs in the background which deals with other sensor data (local and global)</p>\n\n<pre><code>/* @brief From the array of GPS structs we create a string of the format\n * [[lat,long],[lat,long],..]\n * @param   input   The input array of GPS structs\n * @param   output  The output string which will contain lat, long\n * @param   sz      Size left in the output buffer\n * @return  0       Successfully completed operation\n *          1       Failed / Error\n */\nint get_gps60secString(GPS_periodic_t input[GPS_PERIODIC_ARRAY_SIZE], \n                       char *output, size_t sz) \n{\n    int cnt = snprintf(output, sz, \"[\");\n    if (cnt &lt; 0 || cnt &gt;= sz)\n        return 1;\n    output += cnt;\n    sz -= cnt;\n\n    int i = 0;\n    for (i = 0; i &lt; GPS_PERIODIC_ARRAY_SIZE; i++) {\n        cnt = snprintf(output, sz, \"[%0.8f,%0.8f]%s\", \n                input[i].point.latitude, input[i].point.longitude, \n                i + 1 == GPS_PERIODIC_ARRAY_SIZE ? \"\" : \",\");\n        if (cnt &lt; 0 || cnt &gt;= sz)\n            return 1;\n        output += cnt;\n        sz -= cnt;\n    }\n\n    cnt = snprintf(output, sz, \"]\");\n    if (cnt &lt; 0 || cnt &gt;= sz)\n        return 1;\n    return 0; // no error\n}\n</code></pre>\n\n<p><em>What's happening inside the <strong>interrupt routine</em></strong><br/></p>\n\n<pre><code>void GPS_InterruptHandler(UART_HandleTypeDef *UartHandle)\n{\n    gps_UART_RxInterrupt_Disable();\n    GPS_t l_sGpsInfo;\n    memset(&amp;l_sGpsInfo,0,sizeof(GPS_t));\n    status=Validate_get_gpsInfo((char*)g_gps_readBuff,&amp;l_sGpsInfo,100);\n\n    MEMS_interruptHandler(); //Inertial sensor ISR\n    gps_UART_RxInterrupt_Enable();\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", "c", "unity3d", "ffi"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537275651, "post_id": 52387043, "comment_id": 91718804, "body": "<code>Assets&#47;Plugins&#47;cefsimple.dll</code> looks like a relative path and <code>DllNotFoundException</code> looks like the DLL itself isn&#39;t found... Can you set an absolute path just to check?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537275716, "post_id": 52387043, "comment_id": 91718856, "body": "another lead: doesn&#39;t your dll has dependencies with other dlls which aren&#39;t copied in the same directory?"}, {"owner": {"reputation": 23, "user_id": 10380349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f-_wvphg8es/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOca1pWDMrMobj10o-zHpPcLn_Qlg/mo/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0421\u0442\u043e\u043b\u044f\u0440", "link": "https://stackoverflow.com/users/10380349/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a1%d1%82%d0%be%d0%bb%d1%8f%d1%80"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537276347, "post_id": 52387043, "comment_id": 91719290, "body": "Thanks for quick answer. I tried to replace the path and got the following error:     <code>DllNotFoundException: C:\\Users\\rstoliar\\Documents\\CefExample\\Assets\\Plugins\\cefsim&zwnj;&#8203;ple</code>. But first error(<code>Failed to load &#39;Assets&#47;Plugins&#47;cefsimple.dll&#39; with error &#39;The specified procedure could not be found</code>) is gone."}, {"owner": {"reputation": 23, "user_id": 10380349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f-_wvphg8es/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOca1pWDMrMobj10o-zHpPcLn_Qlg/mo/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0421\u0442\u043e\u043b\u044f\u0440", "link": "https://stackoverflow.com/users/10380349/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a1%d1%82%d0%be%d0%bb%d1%8f%d1%80"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537276616, "post_id": 52387043, "comment_id": 91719494, "body": "I have copied the same files as in ordinary console application."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537276900, "post_id": 52387043, "comment_id": 91719675, "body": "definitely a dependency DLL issue. Try to open your DLL with dependency walker tool and see which ones are missing."}, {"owner": {"reputation": 23, "user_id": 10380349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f-_wvphg8es/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOca1pWDMrMobj10o-zHpPcLn_Qlg/mo/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0421\u0442\u043e\u043b\u044f\u0440", "link": "https://stackoverflow.com/users/10380349/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a1%d1%82%d0%be%d0%bb%d1%8f%d1%80"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537277212, "post_id": 52387043, "comment_id": 91719902, "body": "Thanks. Here is the result I got:  <a href=\"https://imgur.com/a/mxYCKFo\" rel=\"nofollow noreferrer\">imgur.com/a/mxYCKFo</a>  It looks like i have to put this dlls inside Plugins directory?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1537277342, "post_id": 52387043, "comment_id": 91719990, "body": "will check later, the imgur site is blocked from work ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9427267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nKYgt7NwGWI/AAAAAAAAAAI/AAAAAAAAAAs/7wNj0YA-gwc/photo.jpg?sz=128", "display_name": "Meghdad Jokar", "link": "https://stackoverflow.com/users/9427267/meghdad-jokar"}, "is_accepted": false, "score": 0, "last_activity_date": 1586851901, "last_edit_date": 1586851901, "creation_date": 1586851497, "answer_id": 61203207, "question_id": 52387043, "link": "https://stackoverflow.com/questions/52387043/unable-to-execute-extern-c-function-in-unity-5/61203207#61203207", "title": "Unable to execute extern c function in Unity 5", "body": "<p>first you most define dll import and export directives in your c  application like this:</p>\n\n<pre><code>#ifndef YOUR_SOURCE_NAME_H //header guard\n#define YOUR_SOURCE_NAME_H\n\n    #define YOUR_SOURCE_NAME_EXPORT (1)\n\n    #ifdef YOUR_SOURCE_NAME_EXPORT\n        #define DLL_USAGE_MODE extern \"C\"  __declspec(dllexport)   // export DLL information\n    #else\n        #define DLL_USAGE_MODE  extern \"C\" __declspec(dllimport)   // import DLL information\n    #endif\n\n\n#endif // YOUR_SOURCE_NAME_H\n</code></pre>\n\n<p>you most put DLL_USAGE_MODE before your function name to make it accessable from outside.\nfor example you have below function in your c DLL :</p>\n\n<pre><code>DLL_USAGE_MODE int saySomthing(const char* pText) {\n    printf(\"\\n%s\", pText);\n    return 0;\n}\n</code></pre>\n\n<p>now in your c# application:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Runtime.InteropServices;\n\nclass Program {\n    [DllImport(\"address_of_your_dll.dll\", EntryPoint = \"saySomthing\", CharSet = CharSet.Ansi, CallingConvention = CallingConvention.Cdecl)]\n    internal static extern int saySomthing(string text);\n\n    static void Main(string[] args) {\n        saySomthing(\"HelloWorld !!\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10380349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f-_wvphg8es/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOca1pWDMrMobj10o-zHpPcLn_Qlg/mo/photo.jpg?sz=128", "display_name": "\u0420\u043e\u043c\u0430\u043d \u0421\u0442\u043e\u043b\u044f\u0440", "link": "https://stackoverflow.com/users/10380349/%d0%a0%d0%be%d0%bc%d0%b0%d0%bd-%d0%a1%d1%82%d0%be%d0%bb%d1%8f%d1%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1586851901, "creation_date": 1537275125, "question_id": 52387043, "link": "https://stackoverflow.com/questions/52387043/unable-to-execute-extern-c-function-in-unity-5", "title": "Unable to execute extern c function in Unity 5", "body": "<p>Currently i am trying to embed <a href=\"https://bitbucket.org/chromiumembedded/cef/\" rel=\"nofollow noreferrer\">CEF</a> into Unity. I have managed to compile cefsimple example as dll and use it in ordinary console application by using DllImport with following code:</p>\n\n<pre><code>[DllImport(\"cefsimple\")]\npublic static extern ulong StartCustom();\nstatic void Main(string[] args)\n{\n    StartCustom();\n}\n</code></pre>\n\n<p>and corresponding C function:</p>\n\n<pre><code>extern \"C\" __declspec (dllexport) int StartCustom() {\n    return wWinMain(nullptr, nullptr, nullptr, 0);\n}\n</code></pre>\n\n<p>(All the necessary files I have moved to a folder with created .exe file)</p>\n\n<p>But if i try to do the same in Unity i am getting </p>\n\n<pre><code>Failed to load 'Assets/Plugins/cefsimple.dll' with error 'The specified procedure could not be found.\n\nDllNotFoundException: cefsimple\nLauncher.Init () (at Assets/Plugins/Launcher.cs:13)\n</code></pre>\n\n<p>Is there are any way to fix this?</p>\n"}, {"tags": ["c", "pointers", "struct", "segmentation-fault", "shuffle"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1537275506, "post_id": 52387033, "comment_id": 91718706, "body": "You&#39;ve only put one card into <code>deck.cards</code>, not all 4 cards."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1537275523, "post_id": 52387033, "comment_id": 91718720, "body": "<code>deck.cards = c_pptr;</code> has only one card in the deck. Why do you need double <code>*</code> pointers?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537275573, "post_id": 52387033, "comment_id": 91718746, "body": "Aside: after defining the suits with <code>enum</code> you ignore that and use <code>0</code>, <code>1</code> etc."}, {"owner": {"reputation": 651, "user_id": 7975962, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6afe4ed6fa4cc9687262a293560a53fb?s=128&d=identicon&r=PG&f=1", "display_name": "gunesevitan", "link": "https://stackoverflow.com/users/7975962/gunesevitan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1537275689, "post_id": 52387033, "comment_id": 91718831, "body": "@WeatherVane It&#39;s a course assignment and I am supposed to do this with pointers to pointers, so how can I add those pointers to deck after the first card just like an array?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1537276397, "post_id": 52387033, "comment_id": 91719336, "body": "You probably need  array of <code>card_t struct</code> and store the address of array in <code>deck_t struct </code> in single pointer not double pointer."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1537277448, "post_id": 52387033, "comment_id": 91720069, "body": "Besides the point, but the shuffle would be more random if it didn&#39;t touch already-shuffled cards, i.e., for each position choose a random card between that and the last card, inclusive."}], "answers": [{"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1537278084, "post_id": 52387928, "comment_id": 91720517, "body": "(BTW, having to speak of things like &quot;card pointer pointers&quot; is often a good indicator that the code might be unnecessarily complicated.)"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 1, "last_activity_date": 1537367399, "last_edit_date": 1537367399, "creation_date": 1537277964, "answer_id": 52387928, "question_id": 52387033, "link": "https://stackoverflow.com/questions/52387033/shuffling-pointers-to-pointers-to-structs/52387928#52387928", "title": "Shuffling pointers to pointers to structs", "body": "<p>You assign the cards with <code>deck.cards = c_pptr</code> but <code>c_pptr</code> is only a pointer to the first card pointer. Yet you assume that <code>cards + i</code> will magically find the other card pointer pointers related to that first card pointer, but nothing in the code supports this. Using a card analogy: you have four cards scattered in different places, you take one of those cards and then you expect to be able to draw the next card from that \"deck\", but you are holding only the one card.</p>\n\n<p>For indexing (with <code>*(cards + i)</code> or the equivalent <code>cards[i]</code>) to work, you need to allocate an <em>array</em> for the pointers to cards, populate those pointers with the addresses of your cards, and assign a pointer to the first element of the card pointer array to <code>cards</code>. The array, such as <code>card_t *card_ptrs[4]</code>, is what makes indexing work - the contents are consecutive in memory, not unlike cards in a deck.</p>\n\n<p>However, the second layer of pointers is unnecessary: you can just allocate an array of <em>cards</em> (not pointers to cards) and assign the pointer to the first card to <code>cards</code> (removing the second <code>*</code> from it and all other places you have it).</p>\n"}, {"comments": [{"owner": {"reputation": 651, "user_id": 7975962, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6afe4ed6fa4cc9687262a293560a53fb?s=128&d=identicon&r=PG&f=1", "display_name": "gunesevitan", "link": "https://stackoverflow.com/users/7975962/gunesevitan"}, "edited": false, "score": 0, "creation_date": 1537293405, "post_id": 52388091, "comment_id": 91729392, "body": "I wasn&#39;t comfortable with double either but the course enforces me to do it that way in order to teach how to shuffle pointer addresses"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 651, "user_id": 7975962, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6afe4ed6fa4cc9687262a293560a53fb?s=128&d=identicon&r=PG&f=1", "display_name": "gunesevitan", "link": "https://stackoverflow.com/users/7975962/gunesevitan"}, "edited": false, "score": 0, "creation_date": 1537338063, "post_id": 52388091, "comment_id": 91742669, "body": "@gunessun Are you saying that you are not allowed to change <code>struct deck_tag</code>? If so that information (i.e. that <code>struct deck_tag</code> must use double pointers`) should have been part of your question. For this specific application I don&#39;t see any purpose/benefit of using double pointers. Consequently my advice is to get rid of them and instead use a more simple approach. There are cases where it makes sense to use double pointers and &quot;shuffle&quot; pointers instead of shuffling elements but this is not one."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1537278833, "last_edit_date": 1537278833, "creation_date": 1537278484, "answer_id": 52388091, "question_id": 52387033, "link": "https://stackoverflow.com/questions/52387033/shuffling-pointers-to-pointers-to-structs/52388091#52388091", "title": "Shuffling pointers to pointers to structs", "body": "<p>As it has already been pointed out in comment (from Barmar &amp; Weather Vane), your code doesn't insert 4 cards into the deck. Only the first card is inserted while the remaining three cards have no relation to the deck.</p>\n\n<p>What you need to do is to use dynamic allocation so that you can allocate an array of cards. The size of the array has to match the number of cards in the deck.</p>\n\n<p>But first... It seems strange to use a double pointer in the deck. So start by changing it into a \"single\" pointer - like:</p>\n\n<pre><code>struct deck_tag {\n  card_t * cards; // Only one *\n  size_t n_cards;\n};\n</code></pre>\n\n<p>Then in <code>main</code> do something like:</p>\n\n<pre><code>int main(){\n    deck_t deck;\n    deck.n_cards = 4;\n    deck.cards = malloc(deck.n_cards * sizeof *deck.cards);\n    if (!deck.cards) exit(1);\n\n    // Now you have 4 cards in the deck and you can \n    // insert card values directly into the deck.\n    // There is no need for variables like card1, card2, card3 ...\n    deck.cards[0].suit = 1;\n    deck.cards[0].value = 1;\n\n    deck.cards[1].suit = 2;\n    deck.cards[1].value = 2;\n\n    ... and so on (or better... use loops)\n\n\n    shuffle(d_ptr); \n\n    free(deck.cards);\n    return 0;\n}\n</code></pre>\n\n<p>Also you'll need to update the shuffle code to use a \"single\" pointer.</p>\n"}], "owner": {"reputation": 651, "user_id": 7975962, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6afe4ed6fa4cc9687262a293560a53fb?s=128&d=identicon&r=PG&f=1", "display_name": "gunesevitan", "link": "https://stackoverflow.com/users/7975962/gunesevitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537367399, "creation_date": 1537275097, "last_edit_date": 1537275790, "question_id": 52387033, "link": "https://stackoverflow.com/questions/52387033/shuffling-pointers-to-pointers-to-structs", "title": "Shuffling pointers to pointers to structs", "body": "<p>There are 2 structs in my code; <code>card(value, suit)</code> and <code>deck(**cards, n)</code>, and I am trying to shuffle the cards inside the deck.</p>\n\n<p>Inside the for loop of the <code>shuffle()</code> function.</p>\n\n<p>The ith card after the first card is saved at <code>temp_card</code>.</p>\n\n<p>A random card is selected and assigned to ith card. </p>\n\n<p><code>temp_card</code> is assigned to the random card.</p>\n\n<p>The problem is program stops execution at this line probably with a segmentation fault.</p>\n\n<pre><code>**(d-&gt;cards + i) = **(d-&gt;cards + random_number);\n</code></pre>\n\n<p>I tried to debug with gdb, but it wasn't very specific. This is the code. I also added some cards and deck to <code>main()</code> in order to test it but I'm pretty new to C so I might also be screwing up the memory locations of those pointers.</p>\n\n<p>Is my approach to shuffling correct, or should I change it, and why program stops at that line, is it because the pointers I provided are invalid?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define VALUE_ACE 14\n#define VALUE_KING 13\n#define VALUE_QUEEN 12\n#define VALUE_JACK 11\n\ntypedef enum {\n  SPADES,\n  HEARTS,\n  DIAMONDS,\n  CLUBS,\n  NUM_SUITS\n} suit_t;\n\nstruct card_tag {\n  unsigned value;\n  suit_t suit;\n};\ntypedef struct card_tag card_t;\n\nstruct deck_tag {\n  card_t ** cards;\n  size_t n_cards;\n};\ntypedef struct deck_tag deck_t;\n\nvoid shuffle(deck_t * d){   \n\n    card_t temp_card;\n    int n = d-&gt;n_cards;\n    int random_number;\n\n    for (int i = 0; i &lt; n; i++){\n\n        temp_card = **(d-&gt;cards + i);\n\n        random_number = rand() % n;\n\n        **(d-&gt;cards + i) = **(d-&gt;cards + random_number);\n        **(d-&gt;cards + random_number) = temp_card;\n    }       \n}\n\nint main(){\n    deck_t deck;\n\n    card_t card1;\n    card1.suit = 1;\n    card1.value = 1;\n    card_t *c_ptr = &amp;card1;\n    card_t **c_pptr = &amp;c_ptr;\n\n    card_t card2;\n    card2.suit = 2;\n    card2.value = 2;\n    card_t *c_ptr2 = &amp;card2;\n    card_t **c_pptr2 = &amp;c_ptr2;\n\n    card_t card3;\n    card3.suit = 0;\n    card3.value = 5;\n    card_t *c_ptr3 = &amp;card3;\n    card_t **c_pptr3 = &amp;c_ptr3;\n\n    card_t card4;\n    card4.suit = 2;\n    card4.value = 2;\n    card_t *c_ptr4 = &amp;card4;\n    card_t **c_pptr4 = &amp;c_ptr4;\n\n    deck.cards = c_pptr;\n\n    deck.n_cards = 4;\n\n    deck_t *d_ptr = &amp;deck;\n\n    shuffle(d_ptr); \n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "server"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1537274915, "post_id": 52386916, "comment_id": 91718315, "body": "Except for the call to <code>socket</code> you don&#39;t check for errors. You need to do that for all calls that can fail (like e.g. <code>bind</code>, <code>accept</code> and <code>read</code>). Furthermore, do the client send the string terminator character? Perhaps you need to add it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1537275257, "post_id": 52386916, "comment_id": 91718538, "body": "On an unrelated note, the <code>read</code> function expects the second argument to be a pointer to the first element of the array, not a pointer to the actual array. Either use <code>&amp;msg_recv[0]</code>, or plain <code>msg_recv</code> as it will decay to <code>&amp;msg_recv[0]</code>. And while both <code>&amp;msg_recv</code> and <code>&amp;msg_recv[0]</code> points to the same location (lucky you!) they are semantically different as they are of different type. <code>&amp;msg_recv</code> is of type <code>char (*)[20]</code> while <code>&amp;msg_recv[0]</code> is of type <code>char *</code>."}, {"owner": {"reputation": 63, "user_id": 7071044, "user_type": "registered", "profile_image": "https://graph.facebook.com/926099354091916/picture?type=large", "display_name": "Gabriel Domene", "link": "https://stackoverflow.com/users/7071044/gabriel-domene"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1537276492, "post_id": 52386916, "comment_id": 91719406, "body": "@Someprogrammerdude thanks for the clarification in the other calls and the pointer i&#39;ll fix that! And no, the client just send the message without the terminator character. @ John3136 well, it seems to be the answer, i might run some test later, sorry if it was a duplicate (english is not my main language, so find synonyms is not that easy), and we&#39;re all passive of errors, thanks!"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1537286342, "post_id": 52386916, "comment_id": 91726041, "body": "The usual three suspects: failure to correctly and completely handle the results from system calls like read(). Failure to correctly manage the octet/byte streaming nature of TCP.  Failure to ensure that char arrays passed to library calls that require a NUL terminator are guaranteed NUL-terminated."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7071044, "user_type": "registered", "profile_image": "https://graph.facebook.com/926099354091916/picture?type=large", "display_name": "Gabriel Domene", "link": "https://stackoverflow.com/users/7071044/gabriel-domene"}, "edited": false, "score": 0, "creation_date": 1537276622, "post_id": 52387073, "comment_id": 91719499, "body": "Thanks for the tip, reading along with the link provided before, i think this might be the answer, currently i&#39;m not in PC so later i&#39;ll test and if it&#39;s right, i&#39;ll leave as the right one, thanks!"}], "tags": [], "owner": {"reputation": 728, "user_id": 5922180, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c63faa62b64336441393d7c11e1ec79a?s=128&d=identicon&r=PG&f=1", "display_name": "DrPrItay", "link": "https://stackoverflow.com/users/5922180/drpritay"}, "is_accepted": true, "score": 1, "last_activity_date": 1537275240, "creation_date": 1537275240, "answer_id": 52387073, "question_id": 52386916, "link": "https://stackoverflow.com/questions/52386916/server-socket-in-c-bug-with-n/52387073#52387073", "title": "Server socket in C, bug with &quot;\\n&quot;", "body": "<p>I'm pretty sure you guys aren't experiencing any errors, the adding of \\n does nothing more than flush your printing buffer and make it, in fact, a visible indication within your stdout or a terminal for this matter. </p>\n"}], "owner": {"reputation": 63, "user_id": 7071044, "user_type": "registered", "profile_image": "https://graph.facebook.com/926099354091916/picture?type=large", "display_name": "Gabriel Domene", "link": "https://stackoverflow.com/users/7071044/gabriel-domene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1537311600, "accepted_answer_id": 52387073, "answer_count": 1, "score": 0, "last_activity_date": 1537275240, "creation_date": 1537274756, "question_id": 52386916, "link": "https://stackoverflow.com/questions/52386916/server-socket-in-c-bug-with-n", "closed_reason": "Duplicate", "title": "Server socket in C, bug with &quot;\\n&quot;", "body": "<p>I'm taking a class in the college that require me to create a server-client application, i came up with this code but apparently it has some strange error when I remove the \"\\n\" at the end of the printf(). I already checked with my teacher and it was him who found out that this is was causing my server to freeze and display latter when we send the message, so he put \\n in the end of each print(in the beggining there wasn't). We spend a couple of hours trying to find a reason but we didn't find anything to explain, so i'm reaching for you guys(so as my teacher who is curious about), i don't know if we let something pass by.</p>\n\n<p>To create the error that i'm talking about, simply remove \\n from each printf and run the code, he'll run but not work properly (even though the port seems to be listen in the telnet command) the lines who was supposed to appear will not show.</p>\n\n<pre><code>#include &lt;strings.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main()\n{\n    //criar socket -&gt; bind -&gt; listen -&gt; connection\n    int socket_name = 0, new_conn = 0;\n    struct sockaddr_in serv_addr;\n    char msg_recv[20];\n\n    char sendBuff[1025];\n\n    socket_name = socket(AF_INET, SOCK_STREAM, 0);\n    if(socket_name &lt; 0)\n    {\n        printf(\"%s\",\"Failed to create socket, exiting\\n\");\n    }else{\n\n        printf(\"%s\", \"Success\\n\");\n\n    }\n\n    bzero(&amp;serv_addr, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    serv_addr.sin_port = htons(5000);\n    bind(socket_name, (struct sockaddr*)&amp;serv_addr, sizeof(serv_addr));\n\n    listen(socket_name, 10);\n\n    while (1)\n    {   \n        new_conn = accept(socket_name, (struct sockaddr*)NULL, NULL);\n        read(new_conn, &amp;msg_recv, sizeof(msg_recv));\n        printf(\"New: %s\\n\", msg_recv);\n        close(new_conn);\n     }   \n\n    return 0;\n}\n</code></pre>\n\n<p>I am testing with nc command, sending a message there, without a client implementation.</p>\n"}, {"tags": ["c", "string", "c-preprocessor", "directive"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1537273011, "post_id": 52386377, "comment_id": 91717077, "body": "Try escaping the newline with backslash."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1537273036, "post_id": 52386377, "comment_id": 91717102, "body": "Or put <code>\\n</code> inside the error message string."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1537273450, "post_id": 52386377, "comment_id": 91717362, "body": "Or simply <code>#error The charging pins aren&#39;t differing! One pin cannot be used for multiple purposes!</code>"}, {"owner": {"reputation": 65, "user_id": 7977981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0tV2.jpg?s=128&g=1", "display_name": "prodx", "link": "https://stackoverflow.com/users/7977981/prodx"}, "edited": false, "score": 0, "creation_date": 1537274262, "post_id": 52386377, "comment_id": 91717884, "body": "I chose the simpliest possible way and changed the &quot;can&#39;t&quot; to &quot;cannot&quot;. High level grammatical and engineering skills here."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1537274423, "post_id": 52386377, "comment_id": 91717980, "body": "Also changed the &quot;aren&#39;t&quot; to &quot;are not&quot;?"}, {"owner": {"reputation": 65, "user_id": 7977981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0tV2.jpg?s=128&g=1", "display_name": "prodx", "link": "https://stackoverflow.com/users/7977981/prodx"}, "edited": false, "score": 0, "creation_date": 1537274630, "post_id": 52386377, "comment_id": 91718127, "body": "There, I was a bit more tricky: &quot;One or multiple charing pin(s) have the same definition!&quot;. I think it&#39;s a clearer diagnostic message. However, I like the &quot;are not&quot; thing too."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7977981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0tV2.jpg?s=128&g=1", "display_name": "prodx", "link": "https://stackoverflow.com/users/7977981/prodx"}, "edited": false, "score": 0, "creation_date": 1537274706, "post_id": 52386870, "comment_id": 91718179, "body": "Exactly, that&#39;s what I did."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1537308372, "post_id": 52386870, "comment_id": 91735522, "body": "Congratulations on 100k!"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 6, "last_activity_date": 1537274719, "last_edit_date": 1537274719, "creation_date": 1537274584, "answer_id": 52386870, "question_id": 52386377, "link": "https://stackoverflow.com/questions/52386377/can-a-c-error-macro-display-multiple-line-message/52386870#52386870", "title": "Can a C #error macro display multiple line message?", "body": "<p>Unfortunately, you can't have it all. </p>\n\n<ul>\n<li>Either you have to get rid of the apostrophe so that the message only contains what's regarded as valid pre-processing tokens.</li>\n<li>Or you can write it as a string on a single line.</li>\n<li>Or you can write it two string literals and break the line with <code>\\</code>. You can't do this in the middle of a string literal, because then it wouldn't be a valid pre-processing token. This will make the output look weird though, like : <code>error: \"hello\" \"world\"</code>.</li>\n<li>Relying on pre-processor concatenation of two string literals won't work, since the error directive only looks until it spots a newline character in the source. And the error directive translates everything you type into strings anyway.</li>\n</ul>\n\n<p>The relevant translation phases are (from C17 5.1.1.2) executed in this order:</p>\n\n<blockquote>\n  <p>2) Each instance of a backslash character () immediately followed by a new-line\n  character is deleted, splicing physical source lines to form logical source lines.</p>\n  \n  <p>3) The source file is decomposed into preprocessing tokens and sequences of\n  white-space characters (including comments).</p>\n  \n  <p>4) Preprocessing directives are executed, ...</p>\n  \n  <p>6) Adjacent string literal tokens are concatenated.</p>\n</blockquote>\n\n<p><code>#error</code> is executed in step 4, earlier than string literal concatenation in step 6.</p>\n\n<p>I personally think the best solution is to skip the apostrophe:</p>\n\n<pre><code>#error The charging pins are not differing! \\\n       One pin cannot be used for multiple purposes!\n</code></pre>\n\n<p>Slight fix of English and you get the best compromise between readable source and a readable error message.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1537274605, "creation_date": 1537274605, "answer_id": 52386879, "question_id": 52386377, "link": "https://stackoverflow.com/questions/52386377/can-a-c-error-macro-display-multiple-line-message/52386879#52386879", "title": "Can a C #error macro display multiple line message?", "body": "<p>As stated <a href=\"http://gcc.gnu.org/onlinedocs/cpp/Diagnostics.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<blockquote>\n  <p>Neither \u2018#<code>error</code>\u2019 nor \u2018#<code>warning</code>\u2019 macro-expands its argument.\n  <em>Internal whitespace sequences are each replaced with a single space.</em> <strong>The line must consist of complete tokens</strong>. It is wisest to make the argument of these directives be a <strong>single string constant</strong>; this\n  avoids problems with <strong>apostrophes</strong> and the like.</p>\n</blockquote>\n\n<p>So you can use it in single line only.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//#define var 10\n#ifdef var\n#error \"The charging pins aren't differing! One pin cannot be used for multiple purposes!\"\n#endif\nint main(void){\n  printf(\"in  main() \\n\");\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7977981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0tV2.jpg?s=128&g=1", "display_name": "prodx", "link": "https://stackoverflow.com/users/7977981/prodx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 1, "accepted_answer_id": 52386870, "answer_count": 2, "score": 2, "last_activity_date": 1537274719, "creation_date": 1537272903, "question_id": 52386377, "link": "https://stackoverflow.com/questions/52386377/can-a-c-error-macro-display-multiple-line-message", "title": "Can a C #error macro display multiple line message?", "body": "<p>I tried to use the #error directive with GCC compiler like this:</p>\n\n<pre><code>#error \"The charging pins aren't differing! One pin cannot be used for multiple purposes!\"\n</code></pre>\n\n<p><a href=\"https://web.eecs.umich.edu/~prabal/teaching/eecs373-f11/readings/Preprocessor.pdf\" rel=\"nofollow noreferrer\">This</a> says, I should use double quotes, so the argument will be a single string constant and I can use an apostrophe inside of it. However, I want this string to be appeared in the source code in mutiple lines, like:</p>\n\n<pre><code>#error \"The charging pins aren't differing! \n    One pin cannot be used for multiple purposes!\"\n</code></pre>\n\n<p>Then, I got some error messages:</p>\n\n<pre><code>warning: missing terminating \" character\n#error \"The charging pins aren't differing! One pin\n\nerror: missing terminating \" character\ncannot be used for multiple purposes!\"\n</code></pre>\n\n<p>If I insert a blackslash at the end of the first line, the diagnostic message conatains all the whitespaceb between the beginning of the second line and the first word (One). If both lines are strings the diagnostic message shows the inner double quotes.</p>\n\n<p>So the question: How can I achieve this output? (or a similar wihtout double quotes, but the apostrophe included)</p>\n\n<pre><code>#error \"The charging pins aren't differing! One pin cannot be used for multiple purposes!\"\n</code></pre>\n"}, {"tags": ["c", "string", "strcpy"], "comments": [{"owner": {"reputation": 2933, "user_id": 3291022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z6iSB.jpg?s=128&g=1", "display_name": "Alexey Voytenko", "link": "https://stackoverflow.com/users/3291022/alexey-voytenko"}, "edited": false, "score": 1, "creation_date": 1537269933, "post_id": 52385351, "comment_id": 91715031, "body": "As an exercise, try to implement safe strcpy with char count - it should stop when number exceed n (10 in your case) - strnspy (<a href=\"https://en.cppreference.com/w/cpp/string/byte/strncpy\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte/strncpy</a>)."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1537269947, "post_id": 52385351, "comment_id": 91715045, "body": "<code>b</code> array is shorter with 1 byte to hold <code>&#39;\\0&#39;</code>. Make it <code>char b[11]</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1537270227, "post_id": 52385351, "comment_id": 91715224, "body": "Your <code>s</code> and <code>t</code> names are <b>highly</b> misleading. Please reconsider. The image you have posted is totally irrelevant. You should not post any images of code or error messages, <a href=\"http://idownvotedbecau.se/imageofanexception/\" rel=\"nofollow noreferrer\">see here</a>."}, {"owner": {"reputation": 2933, "user_id": 3291022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z6iSB.jpg?s=128&g=1", "display_name": "Alexey Voytenko", "link": "https://stackoverflow.com/users/3291022/alexey-voytenko"}, "edited": false, "score": 0, "creation_date": 1537270636, "post_id": 52385351, "comment_id": 91715519, "body": "&quot;How exactly &#39;\\0&#39; affects this process?&quot; - you move at runtime over the *t memory searching for 0 and because there is no 0, go over the allowed region and cause access violation. Step by step instruction:  <a href=\"https://medium.com/@larissafeng/understanding-while-s-t-abb2cc518f96\" rel=\"nofollow noreferrer\">medium.com/@larissafeng/understanding-while-s-t-abb2cc518f96</a>"}, {"owner": {"reputation": 159, "user_id": 6543053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b06e5ee7cce99f2d373d71f311b128dc?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/6543053/user"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1537272197, "post_id": 52385351, "comment_id": 91716542, "body": "@n.m. Thanks for the advice!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1537281974, "post_id": 52385351, "comment_id": 91723271, "body": "I must apologise about the <code>s, t</code> thing. It&#39;s not wrong per se. Lots of people write <code>strcpy</code>-like functions with *s=*t` or equivalent, inkluding K&amp;R. It just drives me nuts. People, <code>s</code> is supposed to stand for &quot;source&quot; and <code>t</code> for &quot;target&quot;! If you must have one-letter variable names, and you must have the letters in alphabetical order, use <code>p, q</code> or something! Better yet, use more sensible names like <code>dst</code> and <code>src</code>, or longer."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1537269501, "creation_date": 1537269501, "answer_id": 52385401, "question_id": 52385351, "link": "https://stackoverflow.com/questions/52385351/c-string-at-the-end-of-0/52385401#52385401", "title": "C string at the end of &#39;\\0&#39;", "body": "<p><code>char b[10] = \"1234567890\";</code> doesn't contain a NUL-terminator so</p>\n\n<pre><code>while ((*s++ = *t++));\n</code></pre>\n\n<p>does not terminate correctly (formally the program behaviour is <em>undefined</em>). Note that the constant <code>\"1234567890\"</code> is a <code>char[11]</code> type; the compiler allows you to assign it to a smaller array, with elements removed automatically.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1537270367, "post_id": 52385480, "comment_id": 91715336, "body": "@Bathsheba Oh. Thanks, I had forgotten about this whole rep thing! :) As for this particular quirk, I actually didn&#39;t know about it myself until some years ago when I learnt it from SO <a href=\"https://stackoverflow.com/questions/31296727/inconsistent-gcc-diagnostic-for-string-initialization\">here</a>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537270564, "post_id": 52385480, "comment_id": 91715476, "body": "@Lundin I have a problem. I compile OPs code with: <code>-Wpedantic -std=c17 -Wall -Wextra -Werror -Wstrict-prototypes  -Wmissing-prototypes -Wmisleading-indentation -Wduplicated-cond -Wold-style-definition -Wconversion -Wshadow -Winit-self -Wfloat-equal -Wwrite-strings -Wcast-align=strict -O0 -g -Wformat</code> and valgrind Does not catch this problem. Even with <code>O0, O1, O2 and O3</code> Why? <a href=\"https://pastebin.com/raw/535Wfx8E\" rel=\"nofollow noreferrer\">This is the Output from valgrind</a>. I use<code>GCC-8.0.1</code>"}, {"owner": {"reputation": 159, "user_id": 6543053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b06e5ee7cce99f2d373d71f311b128dc?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/6543053/user"}, "edited": false, "score": 0, "creation_date": 1537270727, "post_id": 52385480, "comment_id": 91715569, "body": "Wow you are god of C! It helped a lot"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537271143, "post_id": 52385480, "comment_id": 91715833, "body": "@Michi Because as I said, the code conforms to the C standard, so gcc doesn&#39;t give an error on purpose. Neither does clang or icc, just tested with max warnings (various embedded systems compilers do, however). I don&#39;t believe a C++ compiler would allow it though, g++ gives an error. Valgrind isn&#39;t likely to catch it since it isn&#39;t a memory leak. This evil little rule likely goes all the way back to the old Unix string format, that didn&#39;t use null terminators. Pre-standard C used to allow such strings too, before C settled and was standardized."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537271243, "post_id": 52385480, "comment_id": 91715903, "body": "@Lundin OK, but this is a major problem. What happens with <code>a</code> in the <code>printf()</code> call? Does <code>a</code> get null terminated? If yes why there are still 10 chars?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537271382, "post_id": 52385480, "comment_id": 91716006, "body": "@Michi You get undefined behavior. If you by luck have a byte with value 0 (ressembling a null terminator) after the string in memory, it will work as expected. If not, printf might print trailing garbage or crash. Or you get some access violation error from the OS. Anything can happen."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537271450, "post_id": 52385480, "comment_id": 91716050, "body": "@Lundin The OPs code is clearly <code>UB</code>. and it should be catch by compiler or Valgrind. I feel sad about this.4"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537271563, "post_id": 52385480, "comment_id": 91716130, "body": "@Lundin <code>a</code> is not null terminated , so the <code>printf</code> call should be a problem for <code>valgrind</code>"}, {"owner": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "edited": false, "score": 0, "creation_date": 1537271650, "post_id": 52385480, "comment_id": 91716182, "body": "<code>As for this particular quirk, I actually didn&#39;t know about it myself until some years ago when I learnt it from SO </code> You meant to say even I can gain good amount of knowledge answering on SO? as of now I have very little knowledge about <code>c</code>. @Lundin"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1537278893, "post_id": 52385480, "comment_id": 91721074, "body": "@Michi Valgrind does catch this. OP&#39;s code reports &quot;Invalid write of size 1&quot; within <code>strcpy2</code>.  If I comment out the <code>strcpy2</code> call, it completes with no errors (since the original contents of <code>a</code> <i>are</i> nul-terminated).  If I additionally change the <code>printf</code> call to print the contents of <code>b</code>, I get &quot;Conditional jump or move depends on uninitialized value&quot; from inside the guts of <code>printf</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1537280102, "post_id": 52385480, "comment_id": 91721890, "body": "@zwol Yes, I know that, but the actual OPs code it is not seen by the Compiler or Valgrind. This is a big problem. <a href=\"https://ideone.com/e9IxU8\" rel=\"nofollow noreferrer\">A code like this should never be treated as a valid</a>. On my system ( linux mint 19, Gcc-8.0.1, valgrind-3.13.0) It is possible and it is treated as a valid code <a href=\"https://pastebin.com/raw/R9Q1LD1H\" rel=\"nofollow noreferrer\">whit all optimization levels Turned ON</a>"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 7, "last_activity_date": 1537269741, "creation_date": 1537269741, "answer_id": 52385480, "question_id": 52385351, "link": "https://stackoverflow.com/questions/52385351/c-string-at-the-end-of-0/52385480#52385480", "title": "C string at the end of &#39;\\0&#39;", "body": "<p>On the line <code>char b[10] = \"1234567890\";</code>, the string literal <code>\"1234567890\"</code> is exactly 10 characters + 1 null terminator. There is no room left in the array, so it doesn't get null terminated.</p>\n\n<p>Normally, the compiler would warn you for providing an initializer which is too large, but this specific case is a very special pitfall. In the C standard's rules for initialization, we find this little evil rule (C17 6.7.9 \u00a714, emphasis mine):</p>\n\n<blockquote>\n  <p>An array of character type may be initialized by a character string literal or UTF\u22128 string\n  literal, optionally enclosed in braces. Successive bytes of the string literal (including the\n  terminating null character <strong>if there is room</strong> or if the array is of unknown size) initialize the\n  elements of the array.</p>\n</blockquote>\n\n<p>There is no room in your case, so you don't get a null character. And because of this weird little rule, the compiler doesn't warn against it either, because the code conforms to the C standard. </p>\n"}], "owner": {"reputation": 159, "user_id": 6543053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b06e5ee7cce99f2d373d71f311b128dc?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/6543053/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1401, "favorite_count": 1, "accepted_answer_id": 52385480, "answer_count": 2, "score": 1, "last_activity_date": 1537275616, "creation_date": 1537269267, "last_edit_date": 1537275616, "question_id": 52385351, "link": "https://stackoverflow.com/questions/52385351/c-string-at-the-end-of-0", "title": "C string at the end of &#39;\\0&#39;", "body": "<p>While writing c code, I tried to write <code>strcpy</code> code of my own, and I faced this issue.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid strcpy2(char *s, char *t);\n\nint main() {\n    char a[10] = \"asds\";\n    char b[10] = \"1234567890\";\n\n    strcpy2(a, b);\n    printf(\"Copy completed! : %s\", a);\n    return 0;\n}\n\nvoid strcpy2(char *s, char *t) {\n    while ((*s++ = *t++));\n}\n</code></pre>\n\n<blockquote>\n  <p>Error code : Process finished with exit code -1073741819 (0xC0000005)</p>\n</blockquote>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/questions/4711449/what-does-the-0-symbol-mean-in-a-c-string\">this question</a> on the s.o, I learned string should ends with '\\0', but why the above code doesn't work even though it does not cause error when it is declared? (It worked well when char b[10] = \"123456789\")</p>\n\n<p>So, How exactly '\\0' affects this process and eventually cause the error? (Runtime? Compile time? etc)\n(I only know '\\0' should be the end of the string)</p>\n"}, {"tags": ["c", "libusb", "libusb-1.0"], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1537269652, "last_edit_date": 1537269652, "creation_date": 1537269257, "answer_id": 52385347, "question_id": 52385240, "link": "https://stackoverflow.com/questions/52385240/error-when-using-user-data-in-libusb-fill-interrupt-transfer-callback/52385347#52385347", "title": "Error when using &quot;user_data&quot; in libusb_fill_interrupt_transfer callback", "body": "<p>Use <code>transfer-&gt;user_data</code>. From <a href=\"http://libusb.sourceforge.net/api-1.0/structlibusb__transfer.html\" rel=\"nofollow noreferrer\">libusb_transfer structure doc</a> :</p>\n\n<blockquote>\n  <p>Data Fields<br>\n   void *     user_data<br>\n      User context data to pass to the callback function. </p>\n</blockquote>\n\n<p>I don't know what is the type of <code>pairing</code> but it would look like this:</p>\n\n<pre><code>int main() {\n   ...\n   struct pairing_type_s *pairing = pairing_init();\n   ...\n   libusb_fill_interrupt_transfer(pairing-&gt;transfer, dctx-&gt;devh, 0x84, pairing-&gt;buffer,\n    sizeof(pairing-&gt;buffer), cb_aknowledgement, pairing, 0);\n    ...\n}\n\n// Then later:\n\nstatic void cb_aknowledgement(struct libusb_transfer *transfer)\n{\n     assert(transfer != NULL);\n     struct pairing_type_s *pairing = transfer-&gt;user_data;\n     assert(pairing != NULL);\n     // use pairing like a pro\n     ...\n}\n</code></pre>\n\n<p>But you can also be more pro, if you ensure that you always call <code>libusb_fill_interrupt_transfer</code> with <code>pairing-&gt;transfer</code> with <code>cb_aknowledgement</code> and use <code>container_of</code> macro:</p>\n\n<pre><code>int main() {\n   ...\n   struct pairing_type_s *pairing = pairing_init();\n   ...\n   libusb_fill_interrupt_transfer(pairing-&gt;transfer, dctx-&gt;devh, 0x84, pairing-&gt;buffer,\n    sizeof(pairing-&gt;buffer), cb_aknowledgement, NULL, 0);\n    ...\n}\n\n// Then later:\n\nstatic void cb_aknowledgement(struct libusb_transfer *transfer)\n{\n     assert(transfer != NULL);\n     struct pairing_type_s *pairing = container_of(transfer, struct pairing_type_s, transfer);\n     assert(pairing != NULL);\n     // use pairing like a pro\n     ...\n}\n</code></pre>\n\n<p>But I would prefer the first method in this case, as it's more readable and more errorless.</p>\n"}], "owner": {"reputation": 31, "user_id": 7561956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b403e9c0e7d8438980c3de44b8ffe8?s=128&d=identicon&r=PG&f=1", "display_name": "stojo304", "link": "https://stackoverflow.com/users/7561956/stojo304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 52385347, "answer_count": 1, "score": 0, "last_activity_date": 1537270852, "creation_date": 1537268935, "last_edit_date": 1537270852, "question_id": 52385240, "link": "https://stackoverflow.com/questions/52385240/error-when-using-user-data-in-libusb-fill-interrupt-transfer-callback", "title": "Error when using &quot;user_data&quot; in libusb_fill_interrupt_transfer callback", "body": "<p>I'm using libusb-1.0 to pair a BLE dongle to an RCU. </p>\n\n<p>For this, I write a pairing request to the dongle interface succesfully. \nTo listen to the dongle response I'm using the function <a href=\"http://libusb.sourceforge.net/api-1.0/group__libusb__asyncio.html#ga90f53cea1124a7566df1aa1202b77510\" rel=\"nofollow noreferrer\"><code>libusb_fill_interrupt_transfer</code></a> and I pass a callback, which will be executed when receiving the response.\nThis function accepts a parameter, as mentionned in the documentation (<code>void *user_data</code>), that can be used in the callback. But when I try to use this parameter, I get a compilation error.</p>\n\n<blockquote>\n  <p>undeclared (first use in this function)</p>\n</blockquote>\n\n<p>Following the call of the previous function and the declaration of my callback :</p>\n\n<pre><code>libusb_fill_interrupt_transfer(pairing-&gt;transfer, dctx-&gt;devh, 0x84, pairing-&gt;buffer,\n    sizeof(pairing-&gt;buffer), cb_aknowledgement, pairing, 0);\n\nstatic void cb_aknowledgement(struct libusb_transfer *transfer)\n{\n    if (pairing-&gt;transfer-&gt;status != LIBUSB_TRANSFER_COMPLETED) {\n        printf( \"img transfer status %d?\\n\", pairing-&gt;transfer-&gt;status);\n        libusb_free_transfer(pairing-&gt;transfer);\n        pairing-&gt;transfer = NULL;\n        return;\n    }\n\n    if(pairing-&gt;buffer[0]!=0x05 || pairing-&gt;buffer[1]!=0x21)\n    {\n        printf( \"wrong command recieved\\n\");\n        libusb_free_transfer(pairing-&gt;transfer);\n        pairing-&gt;transfer = NULL;\n        return;\n    }\n\n    printf(\"I've read data  \\n\");\n    printf(\"USB Report Id           =  0x%x \\n\",pairing-&gt;buffer[0]);\n    printf(\"Command                 =  0x%x \\n\",pairing-&gt;buffer[1]);\n    printf(\"Acknowledgement type    =  0x%x \\n\",pairing-&gt;buffer[2]);\n    return ;\n}\n</code></pre>\n\n<p>The question is: How can I use the <code>user_data</code> I passed as a parameter to the callback?</p>\n"}]